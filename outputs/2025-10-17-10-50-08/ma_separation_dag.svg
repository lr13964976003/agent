<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MA_Separation_MoE_Attention Pages: 1 -->
<svg width="960pt" height="1440pt"
 viewBox="0.00 0.00 960.07 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.3 0.3) rotate(0) translate(4 4731.91)">
<title>MA_Separation_MoE_Attention</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4731.91 3153.5,-4731.91 3153.5,4 -4,4"/>
<text text-anchor="middle" x="1574.75" y="-54" font-family="Times,serif" font-size="20.00">MA Separation: 4&#45;Layer MoE Transformer</text>
<text text-anchor="middle" x="1574.75" y="-32" font-family="Times,serif" font-size="20.00">12 Attention GPUs + 4 MoE GPUs</text>
<text text-anchor="middle" x="1574.75" y="-10" font-family="Times,serif" font-size="20.00">Sequence: 2048 tokens, Batch: 1024, Hidden: 4096</text>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="1559" cy="-4690.43" rx="292.07" ry="37.45"/>
<text text-anchor="middle" x="1559" y="-4701.73" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="1559" y="-4686.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="1559" y="-4671.73" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer1_qkv_gpu0 -->
<g id="node2" class="node">
<title>layer1_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="245,-4616.95 17,-4616.95 17,-4533.95 245,-4533.95 245,-4616.95"/>
<text text-anchor="middle" x="131" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="131" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="131" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="131" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 0&#45;2</text>
<text text-anchor="middle" x="131" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1276.68,-4680.74C957.99,-4669.65 459.73,-4648.1 274,-4616.95 267.82,-4615.92 261.53,-4614.71 255.2,-4613.38"/>
<polygon fill="black" stroke="black" points="255.75,-4609.92 245.23,-4611.19 254.25,-4616.76 255.75,-4609.92"/>
</g>
<!-- layer1_qkv_gpu1 -->
<g id="node5" class="node">
<title>layer1_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="511,-4616.95 283,-4616.95 283,-4533.95 511,-4533.95 511,-4616.95"/>
<text text-anchor="middle" x="397" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="397" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="397" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="397" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 3&#45;5</text>
<text text-anchor="middle" x="397" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1271.47,-4683.85C1067.48,-4676.25 787.9,-4658.46 545,-4616.95 537.16,-4615.61 529.13,-4614.04 521.07,-4612.29"/>
<polygon fill="black" stroke="black" points="521.76,-4608.86 511.24,-4610.09 520.23,-4615.69 521.76,-4608.86"/>
</g>
<!-- layer1_qkv_gpu2 -->
<g id="node8" class="node">
<title>layer1_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="782,-4616.95 554,-4616.95 554,-4533.95 782,-4533.95 782,-4616.95"/>
<text text-anchor="middle" x="668" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="668" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="668" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="668" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 6&#45;8</text>
<text text-anchor="middle" x="668" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1285.8,-4677.13C1139.96,-4667.13 958.04,-4649.14 798,-4616.95 796.04,-4616.56 794.08,-4616.15 792.1,-4615.72"/>
<polygon fill="black" stroke="black" points="792.68,-4612.26 782.15,-4613.45 791.12,-4619.09 792.68,-4612.26"/>
</g>
<!-- layer1_qkv_gpu3 -->
<g id="node11" class="node">
<title>layer1_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1035,-4616.95 807,-4616.95 807,-4533.95 1035,-4533.95 1035,-4616.95"/>
<text text-anchor="middle" x="921" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="921" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="921" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="921" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 9&#45;11</text>
<text text-anchor="middle" x="921" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1344.44,-4664.93C1255.88,-4653.09 1152.5,-4637.04 1060,-4616.95 1055.06,-4615.88 1050.04,-4614.73 1044.98,-4613.51"/>
<polygon fill="black" stroke="black" points="1045.76,-4610.1 1035.21,-4611.1 1044.08,-4616.89 1045.76,-4610.1"/>
</g>
<!-- layer1_qkv_gpu4 -->
<g id="node14" class="node">
<title>layer1_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1297,-4616.95 1069,-4616.95 1069,-4533.95 1297,-4533.95 1297,-4616.95"/>
<text text-anchor="middle" x="1183" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="1183" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1183" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1183" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 12&#45;14</text>
<text text-anchor="middle" x="1183" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu4 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1444.06,-4655.97C1402.7,-4643.82 1355.72,-4629.9 1313,-4616.95 1311.05,-4616.36 1309.08,-4615.76 1307.1,-4615.16"/>
<polygon fill="black" stroke="black" points="1307.7,-4611.68 1297.11,-4612.11 1305.65,-4618.38 1307.7,-4611.68"/>
</g>
<!-- layer1_qkv_gpu5 -->
<g id="node17" class="node">
<title>layer1_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1550,-4616.95 1322,-4616.95 1322,-4533.95 1550,-4533.95 1550,-4616.95"/>
<text text-anchor="middle" x="1436" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="1436" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1436" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1436" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 15&#45;17</text>
<text text-anchor="middle" x="1436" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu5 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1519.4,-4653.06C1509.35,-4643.82 1498.39,-4633.76 1487.82,-4624.05"/>
<polygon fill="black" stroke="black" points="1489.95,-4621.25 1480.21,-4617.06 1485.21,-4626.41 1489.95,-4621.25"/>
</g>
<!-- layer1_qkv_gpu6 -->
<g id="node20" class="node">
<title>layer1_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1803,-4616.95 1575,-4616.95 1575,-4533.95 1803,-4533.95 1803,-4616.95"/>
<text text-anchor="middle" x="1689" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="1689" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1689" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1689" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 18&#45;20</text>
<text text-anchor="middle" x="1689" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu6 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1600.85,-4653.06C1611.58,-4643.73 1623.29,-4633.56 1634.56,-4623.77"/>
<polygon fill="black" stroke="black" points="1637.02,-4626.26 1642.27,-4617.06 1632.43,-4620.98 1637.02,-4626.26"/>
</g>
<!-- layer1_qkv_gpu7 -->
<g id="node23" class="node">
<title>layer1_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2060,-4616.95 1832,-4616.95 1832,-4533.95 2060,-4533.95 2060,-4616.95"/>
<text text-anchor="middle" x="1946" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="1946" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1946" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1946" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 21&#45;23</text>
<text text-anchor="middle" x="1946" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu7 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1676.88,-4656.04C1719.49,-4643.87 1767.95,-4629.92 1812,-4616.95 1815.37,-4615.96 1818.78,-4614.95 1822.22,-4613.93"/>
<polygon fill="black" stroke="black" points="1823.4,-4617.24 1831.99,-4611.03 1821.41,-4610.52 1823.4,-4617.24"/>
</g>
<!-- layer1_qkv_gpu8 -->
<g id="node26" class="node">
<title>layer1_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2319,-4616.95 2091,-4616.95 2091,-4533.95 2319,-4533.95 2319,-4616.95"/>
<text text-anchor="middle" x="2205" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU8</text>
<text text-anchor="middle" x="2205" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2205" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2205" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 24&#45;26</text>
<text text-anchor="middle" x="2205" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu8 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu8</title>
<path fill="none" stroke="black" d="M1777.73,-4665.58C1868.4,-4653.82 1974.32,-4637.66 2069,-4616.95 2072.88,-4616.1 2076.82,-4615.2 2080.78,-4614.25"/>
<polygon fill="black" stroke="black" points="2081.8,-4617.61 2090.67,-4611.82 2080.13,-4610.81 2081.8,-4617.61"/>
</g>
<!-- layer1_qkv_gpu9 -->
<g id="node29" class="node">
<title>layer1_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2579,-4616.95 2351,-4616.95 2351,-4533.95 2579,-4533.95 2579,-4616.95"/>
<text text-anchor="middle" x="2465" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU9</text>
<text text-anchor="middle" x="2465" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2465" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2465" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 27&#45;29</text>
<text text-anchor="middle" x="2465" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu9 -->
<g id="edge10" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu9</title>
<path fill="none" stroke="black" d="M1830.85,-4676.66C1978.83,-4666.5 2164.57,-4648.5 2328,-4616.95 2332.18,-4616.15 2336.41,-4615.27 2340.67,-4614.33"/>
<polygon fill="black" stroke="black" points="2341.7,-4617.68 2350.66,-4612.03 2340.13,-4610.86 2341.7,-4617.68"/>
</g>
<!-- layer1_qkv_gpu10 -->
<g id="node32" class="node">
<title>layer1_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2842,-4616.95 2614,-4616.95 2614,-4533.95 2842,-4533.95 2842,-4616.95"/>
<text text-anchor="middle" x="2728" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU10</text>
<text text-anchor="middle" x="2728" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2728" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2728" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 30&#45;32</text>
<text text-anchor="middle" x="2728" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu10 -->
<g id="edge11" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1848.48,-4685.33C2055.78,-4678.45 2340.82,-4660.9 2588,-4616.95 2593.29,-4616.01 2598.67,-4614.95 2604.09,-4613.79"/>
<polygon fill="black" stroke="black" points="2604.87,-4617.2 2613.86,-4611.6 2603.34,-4610.37 2604.87,-4617.2"/>
</g>
<!-- layer1_qkv_gpu11 -->
<g id="node35" class="node">
<title>layer1_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3109,-4616.95 2881,-4616.95 2881,-4533.95 3109,-4533.95 3109,-4616.95"/>
<text text-anchor="middle" x="2995" y="-4601.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU11</text>
<text text-anchor="middle" x="2995" y="-4586.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2995" y="-4571.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2995" y="-4556.75" font-family="Times,serif" font-size="14.00">Heads: 33&#45;35</text>
<text text-anchor="middle" x="2995" y="-4541.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- input&#45;&gt;layer1_qkv_gpu11 -->
<g id="edge12" class="edge">
<title>input&#45;&gt;layer1_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1841.42,-4680.78C2161.78,-4669.7 2663.95,-4648.12 2851,-4616.95 2857.54,-4615.86 2864.21,-4614.59 2870.91,-4613.18"/>
<polygon fill="black" stroke="black" points="2871.74,-4616.58 2880.75,-4611.01 2870.24,-4609.74 2871.74,-4616.58"/>
</g>
<!-- layer1_attn_gpu0 -->
<g id="node3" class="node">
<title>layer1_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="245.5,-4497.95 2.5,-4497.95 2.5,-4429.95 245.5,-4429.95 245.5,-4497.95"/>
<text text-anchor="middle" x="124" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="124" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="124" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="124" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_qkv_gpu0&#45;&gt;layer1_attn_gpu0 -->
<g id="edge13" class="edge">
<title>layer1_qkv_gpu0&#45;&gt;layer1_attn_gpu0</title>
<path fill="none" stroke="black" d="M128.39,-4533.68C127.86,-4525.38 127.3,-4516.62 126.77,-4508.24"/>
<polygon fill="black" stroke="black" points="130.26,-4508.01 126.13,-4498.25 123.27,-4508.46 130.26,-4508.01"/>
</g>
<!-- layer1_attn_norm_gpu0 -->
<g id="node4" class="node">
<title>layer1_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="244,-4393.95 0,-4393.95 0,-4325.95 244,-4325.95 244,-4393.95"/>
<text text-anchor="middle" x="122" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="122" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="122" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="122" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_gpu0&#45;&gt;layer1_attn_norm_gpu0 -->
<g id="edge14" class="edge">
<title>layer1_attn_gpu0&#45;&gt;layer1_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M123.35,-4429.84C123.19,-4421.73 123.02,-4412.94 122.85,-4404.43"/>
<polygon fill="black" stroke="black" points="126.35,-4404.18 122.65,-4394.25 119.35,-4404.32 126.35,-4404.18"/>
</g>
<!-- layer1_attn_aggregate -->
<g id="node38" class="node">
<title>layer1_attn_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="1563,-4289.95 1340,-4221.95 1563,-4153.95 1786,-4221.95 1563,-4289.95"/>
<text text-anchor="middle" x="1563" y="-4240.75" font-family="Times,serif" font-size="14.00">L1_Attention_Aggregate</text>
<text text-anchor="middle" x="1563" y="-4225.75" font-family="Times,serif" font-size="14.00">Input: 12×[1024,2048,4096]</text>
<text text-anchor="middle" x="1563" y="-4210.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1563" y="-4195.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce across GPUs 0&#45;11</text>
</g>
<!-- layer1_attn_norm_gpu0&#45;&gt;layer1_attn_aggregate -->
<g id="edge15" class="edge">
<title>layer1_attn_norm_gpu0&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M244.24,-4327.47C247.18,-4326.93 250.11,-4326.43 253,-4325.95 636.63,-4263.01 1090,-4238.23 1350.27,-4228.69"/>
<polygon fill="black" stroke="black" points="1350.73,-4232.17 1360.6,-4228.31 1350.48,-4225.18 1350.73,-4232.17"/>
</g>
<!-- layer1_attn_gpu1 -->
<g id="node6" class="node">
<title>layer1_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="506.5,-4497.95 263.5,-4497.95 263.5,-4429.95 506.5,-4429.95 506.5,-4497.95"/>
<text text-anchor="middle" x="385" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="385" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="385" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="385" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_qkv_gpu1&#45;&gt;layer1_attn_gpu1 -->
<g id="edge16" class="edge">
<title>layer1_qkv_gpu1&#45;&gt;layer1_attn_gpu1</title>
<path fill="none" stroke="black" d="M392.53,-4533.68C391.62,-4525.38 390.66,-4516.62 389.74,-4508.24"/>
<polygon fill="black" stroke="black" points="393.22,-4507.81 388.65,-4498.25 386.26,-4508.57 393.22,-4507.81"/>
</g>
<!-- layer1_attn_norm_gpu1 -->
<g id="node7" class="node">
<title>layer1_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="506,-4393.95 262,-4393.95 262,-4325.95 506,-4325.95 506,-4393.95"/>
<text text-anchor="middle" x="384" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="384" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="384" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="384" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_gpu1&#45;&gt;layer1_attn_norm_gpu1 -->
<g id="edge17" class="edge">
<title>layer1_attn_gpu1&#45;&gt;layer1_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M384.68,-4429.84C384.6,-4421.73 384.51,-4412.94 384.43,-4404.43"/>
<polygon fill="black" stroke="black" points="387.92,-4404.22 384.33,-4394.25 380.92,-4404.29 387.92,-4404.22"/>
</g>
<!-- layer1_attn_norm_gpu1&#45;&gt;layer1_attn_aggregate -->
<g id="edge18" class="edge">
<title>layer1_attn_norm_gpu1&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M506.25,-4327.55C509.19,-4326.99 512.11,-4326.46 515,-4325.95 808.95,-4274.78 1154.03,-4246.99 1365.59,-4233.57"/>
<polygon fill="black" stroke="black" points="1366.11,-4237.04 1375.87,-4232.92 1365.67,-4230.06 1366.11,-4237.04"/>
</g>
<!-- layer1_attn_gpu2 -->
<g id="node9" class="node">
<title>layer1_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="768.5,-4497.95 525.5,-4497.95 525.5,-4429.95 768.5,-4429.95 768.5,-4497.95"/>
<text text-anchor="middle" x="647" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="647" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="647" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="647" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_qkv_gpu2&#45;&gt;layer1_attn_gpu2 -->
<g id="edge19" class="edge">
<title>layer1_qkv_gpu2&#45;&gt;layer1_attn_gpu2</title>
<path fill="none" stroke="black" d="M660.18,-4533.68C658.59,-4525.38 656.91,-4516.62 655.3,-4508.24"/>
<polygon fill="black" stroke="black" points="658.71,-4507.41 653.39,-4498.25 651.83,-4508.73 658.71,-4507.41"/>
</g>
<!-- layer1_attn_norm_gpu2 -->
<g id="node10" class="node">
<title>layer1_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="768,-4393.95 524,-4393.95 524,-4325.95 768,-4325.95 768,-4393.95"/>
<text text-anchor="middle" x="646" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="646" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="646" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="646" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_gpu2&#45;&gt;layer1_attn_norm_gpu2 -->
<g id="edge20" class="edge">
<title>layer1_attn_gpu2&#45;&gt;layer1_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M646.68,-4429.84C646.6,-4421.73 646.51,-4412.94 646.43,-4404.43"/>
<polygon fill="black" stroke="black" points="649.92,-4404.22 646.33,-4394.25 642.92,-4404.29 649.92,-4404.22"/>
</g>
<!-- layer1_attn_norm_gpu2&#45;&gt;layer1_attn_aggregate -->
<g id="edge21" class="edge">
<title>layer1_attn_norm_gpu2&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M768.28,-4327.67C771.21,-4327.08 774.12,-4326.5 777,-4325.95 984.52,-4286.36 1225.78,-4257.21 1385.7,-4240.22"/>
<polygon fill="black" stroke="black" points="1386.54,-4243.65 1396.12,-4239.12 1385.8,-4236.69 1386.54,-4243.65"/>
</g>
<!-- layer1_attn_gpu3 -->
<g id="node12" class="node">
<title>layer1_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1030.5,-4497.95 787.5,-4497.95 787.5,-4429.95 1030.5,-4429.95 1030.5,-4497.95"/>
<text text-anchor="middle" x="909" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="909" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="909" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="909" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_qkv_gpu3&#45;&gt;layer1_attn_gpu3 -->
<g id="edge22" class="edge">
<title>layer1_qkv_gpu3&#45;&gt;layer1_attn_gpu3</title>
<path fill="none" stroke="black" d="M916.53,-4533.68C915.62,-4525.38 914.66,-4516.62 913.74,-4508.24"/>
<polygon fill="black" stroke="black" points="917.22,-4507.81 912.65,-4498.25 910.26,-4508.57 917.22,-4507.81"/>
</g>
<!-- layer1_attn_norm_gpu3 -->
<g id="node13" class="node">
<title>layer1_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1030,-4393.95 786,-4393.95 786,-4325.95 1030,-4325.95 1030,-4393.95"/>
<text text-anchor="middle" x="908" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="908" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="908" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="908" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_gpu3&#45;&gt;layer1_attn_norm_gpu3 -->
<g id="edge23" class="edge">
<title>layer1_attn_gpu3&#45;&gt;layer1_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M908.68,-4429.84C908.6,-4421.73 908.51,-4412.94 908.43,-4404.43"/>
<polygon fill="black" stroke="black" points="911.92,-4404.22 908.33,-4394.25 904.92,-4404.29 911.92,-4404.22"/>
</g>
<!-- layer1_attn_norm_gpu3&#45;&gt;layer1_attn_aggregate -->
<g id="edge24" class="edge">
<title>layer1_attn_norm_gpu3&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M1030.33,-4327.92C1033.25,-4327.25 1036.14,-4326.59 1039,-4325.95 1165.42,-4297.63 1309.96,-4269.53 1415.17,-4249.86"/>
<polygon fill="black" stroke="black" points="1416.04,-4253.26 1425.23,-4247.98 1414.75,-4246.38 1416.04,-4253.26"/>
</g>
<!-- layer1_attn_gpu4 -->
<g id="node15" class="node">
<title>layer1_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1292.5,-4497.95 1049.5,-4497.95 1049.5,-4429.95 1292.5,-4429.95 1292.5,-4497.95"/>
<text text-anchor="middle" x="1171" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="1171" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1171" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1171" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_qkv_gpu4&#45;&gt;layer1_attn_gpu4 -->
<g id="edge25" class="edge">
<title>layer1_qkv_gpu4&#45;&gt;layer1_attn_gpu4</title>
<path fill="none" stroke="black" d="M1178.53,-4533.68C1177.62,-4525.38 1176.66,-4516.62 1175.74,-4508.24"/>
<polygon fill="black" stroke="black" points="1179.22,-4507.81 1174.65,-4498.25 1172.26,-4508.57 1179.22,-4507.81"/>
</g>
<!-- layer1_attn_norm_gpu4 -->
<g id="node16" class="node">
<title>layer1_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1292,-4393.95 1048,-4393.95 1048,-4325.95 1292,-4325.95 1292,-4393.95"/>
<text text-anchor="middle" x="1170" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="1170" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1170" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1170" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_gpu4&#45;&gt;layer1_attn_norm_gpu4 -->
<g id="edge26" class="edge">
<title>layer1_attn_gpu4&#45;&gt;layer1_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M1170.68,-4429.84C1170.6,-4421.73 1170.51,-4412.94 1170.43,-4404.43"/>
<polygon fill="black" stroke="black" points="1173.92,-4404.22 1170.33,-4394.25 1166.92,-4404.29 1173.92,-4404.22"/>
</g>
<!-- layer1_attn_norm_gpu4&#45;&gt;layer1_attn_aggregate -->
<g id="edge27" class="edge">
<title>layer1_attn_norm_gpu4&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M1265.39,-4325.94C1321.12,-4306.66 1391.78,-4282.2 1450.26,-4261.97"/>
<polygon fill="black" stroke="black" points="1451.61,-4265.21 1459.91,-4258.63 1449.32,-4258.59 1451.61,-4265.21"/>
</g>
<!-- layer1_attn_gpu5 -->
<g id="node18" class="node">
<title>layer1_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1553.5,-4497.95 1310.5,-4497.95 1310.5,-4429.95 1553.5,-4429.95 1553.5,-4497.95"/>
<text text-anchor="middle" x="1432" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="1432" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1432" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1432" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_qkv_gpu5&#45;&gt;layer1_attn_gpu5 -->
<g id="edge28" class="edge">
<title>layer1_qkv_gpu5&#45;&gt;layer1_attn_gpu5</title>
<path fill="none" stroke="black" d="M1434.51,-4533.68C1434.21,-4525.47 1433.89,-4516.81 1433.59,-4508.51"/>
<polygon fill="black" stroke="black" points="1437.08,-4508.12 1433.22,-4498.25 1430.08,-4508.37 1437.08,-4508.12"/>
</g>
<!-- layer1_attn_norm_gpu5 -->
<g id="node19" class="node">
<title>layer1_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1554,-4393.95 1310,-4393.95 1310,-4325.95 1554,-4325.95 1554,-4393.95"/>
<text text-anchor="middle" x="1432" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="1432" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1432" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1432" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_gpu5&#45;&gt;layer1_attn_norm_gpu5 -->
<g id="edge29" class="edge">
<title>layer1_attn_gpu5&#45;&gt;layer1_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M1432,-4429.84C1432,-4421.73 1432,-4412.94 1432,-4404.43"/>
<polygon fill="black" stroke="black" points="1435.5,-4404.25 1432,-4394.25 1428.5,-4404.25 1435.5,-4404.25"/>
</g>
<!-- layer1_attn_norm_gpu5&#45;&gt;layer1_attn_aggregate -->
<g id="edge30" class="edge">
<title>layer1_attn_norm_gpu5&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M1464.05,-4325.68C1476.67,-4312.57 1491.57,-4297.11 1505.92,-4282.21"/>
<polygon fill="black" stroke="black" points="1508.49,-4284.59 1512.91,-4274.96 1503.45,-4279.73 1508.49,-4284.59"/>
</g>
<!-- layer1_attn_gpu6 -->
<g id="node21" class="node">
<title>layer1_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1814.5,-4497.95 1571.5,-4497.95 1571.5,-4429.95 1814.5,-4429.95 1814.5,-4497.95"/>
<text text-anchor="middle" x="1693" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="1693" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1693" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1693" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_qkv_gpu6&#45;&gt;layer1_attn_gpu6 -->
<g id="edge31" class="edge">
<title>layer1_qkv_gpu6&#45;&gt;layer1_attn_gpu6</title>
<path fill="none" stroke="black" d="M1690.49,-4533.68C1690.79,-4525.47 1691.11,-4516.81 1691.41,-4508.51"/>
<polygon fill="black" stroke="black" points="1694.92,-4508.37 1691.78,-4498.25 1687.92,-4508.12 1694.92,-4508.37"/>
</g>
<!-- layer1_attn_norm_gpu6 -->
<g id="node22" class="node">
<title>layer1_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1816,-4393.95 1572,-4393.95 1572,-4325.95 1816,-4325.95 1816,-4393.95"/>
<text text-anchor="middle" x="1694" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="1694" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1694" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1694" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_gpu6&#45;&gt;layer1_attn_norm_gpu6 -->
<g id="edge32" class="edge">
<title>layer1_attn_gpu6&#45;&gt;layer1_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M1693.32,-4429.84C1693.4,-4421.73 1693.49,-4412.94 1693.57,-4404.43"/>
<polygon fill="black" stroke="black" points="1697.08,-4404.29 1693.67,-4394.25 1690.08,-4404.22 1697.08,-4404.29"/>
</g>
<!-- layer1_attn_norm_gpu6&#45;&gt;layer1_attn_aggregate -->
<g id="edge33" class="edge">
<title>layer1_attn_norm_gpu6&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M1661.95,-4325.68C1649.33,-4312.57 1634.43,-4297.11 1620.08,-4282.21"/>
<polygon fill="black" stroke="black" points="1622.55,-4279.73 1613.09,-4274.96 1617.51,-4284.59 1622.55,-4279.73"/>
</g>
<!-- layer1_attn_gpu7 -->
<g id="node24" class="node">
<title>layer1_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2076.5,-4497.95 1833.5,-4497.95 1833.5,-4429.95 2076.5,-4429.95 2076.5,-4497.95"/>
<text text-anchor="middle" x="1955" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="1955" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1955" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1955" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_qkv_gpu7&#45;&gt;layer1_attn_gpu7 -->
<g id="edge34" class="edge">
<title>layer1_qkv_gpu7&#45;&gt;layer1_attn_gpu7</title>
<path fill="none" stroke="black" d="M1949.35,-4533.68C1950.03,-4525.38 1950.75,-4516.62 1951.44,-4508.24"/>
<polygon fill="black" stroke="black" points="1954.93,-4508.51 1952.26,-4498.25 1947.96,-4507.93 1954.93,-4508.51"/>
</g>
<!-- layer1_attn_norm_gpu7 -->
<g id="node25" class="node">
<title>layer1_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2078,-4393.95 1834,-4393.95 1834,-4325.95 2078,-4325.95 2078,-4393.95"/>
<text text-anchor="middle" x="1956" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="1956" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1956" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1956" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_gpu7&#45;&gt;layer1_attn_norm_gpu7 -->
<g id="edge35" class="edge">
<title>layer1_attn_gpu7&#45;&gt;layer1_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M1955.32,-4429.84C1955.4,-4421.73 1955.49,-4412.94 1955.57,-4404.43"/>
<polygon fill="black" stroke="black" points="1959.08,-4404.29 1955.67,-4394.25 1952.08,-4404.22 1959.08,-4404.29"/>
</g>
<!-- layer1_attn_norm_gpu7&#45;&gt;layer1_attn_aggregate -->
<g id="edge36" class="edge">
<title>layer1_attn_norm_gpu7&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M1860.61,-4325.94C1804.88,-4306.66 1734.22,-4282.2 1675.74,-4261.97"/>
<polygon fill="black" stroke="black" points="1676.68,-4258.59 1666.09,-4258.63 1674.39,-4265.21 1676.68,-4258.59"/>
</g>
<!-- layer1_attn_gpu8 -->
<g id="node27" class="node">
<title>layer1_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2338.5,-4497.95 2095.5,-4497.95 2095.5,-4429.95 2338.5,-4429.95 2338.5,-4497.95"/>
<text text-anchor="middle" x="2217" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU8</text>
<text text-anchor="middle" x="2217" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2217" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2217" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_qkv_gpu8&#45;&gt;layer1_attn_gpu8 -->
<g id="edge37" class="edge">
<title>layer1_qkv_gpu8&#45;&gt;layer1_attn_gpu8</title>
<path fill="none" stroke="black" d="M2209.47,-4533.68C2210.38,-4525.38 2211.34,-4516.62 2212.26,-4508.24"/>
<polygon fill="black" stroke="black" points="2215.74,-4508.57 2213.35,-4498.25 2208.78,-4507.81 2215.74,-4508.57"/>
</g>
<!-- layer1_attn_norm_gpu8 -->
<g id="node28" class="node">
<title>layer1_attn_norm_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2340,-4393.95 2096,-4393.95 2096,-4325.95 2340,-4325.95 2340,-4393.95"/>
<text text-anchor="middle" x="2218" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="2218" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2218" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2218" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_attn_gpu8&#45;&gt;layer1_attn_norm_gpu8 -->
<g id="edge38" class="edge">
<title>layer1_attn_gpu8&#45;&gt;layer1_attn_norm_gpu8</title>
<path fill="none" stroke="black" d="M2217.32,-4429.84C2217.4,-4421.73 2217.49,-4412.94 2217.57,-4404.43"/>
<polygon fill="black" stroke="black" points="2221.08,-4404.29 2217.67,-4394.25 2214.08,-4404.22 2221.08,-4404.29"/>
</g>
<!-- layer1_attn_norm_gpu8&#45;&gt;layer1_attn_aggregate -->
<g id="edge39" class="edge">
<title>layer1_attn_norm_gpu8&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M2095.67,-4327.92C2092.75,-4327.25 2089.86,-4326.59 2087,-4325.95 1960.58,-4297.63 1816.04,-4269.53 1710.83,-4249.86"/>
<polygon fill="black" stroke="black" points="1711.25,-4246.38 1700.77,-4247.98 1709.96,-4253.26 1711.25,-4246.38"/>
</g>
<!-- layer1_attn_gpu9 -->
<g id="node30" class="node">
<title>layer1_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2600.5,-4497.95 2357.5,-4497.95 2357.5,-4429.95 2600.5,-4429.95 2600.5,-4497.95"/>
<text text-anchor="middle" x="2479" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU9</text>
<text text-anchor="middle" x="2479" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2479" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2479" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_qkv_gpu9&#45;&gt;layer1_attn_gpu9 -->
<g id="edge40" class="edge">
<title>layer1_qkv_gpu9&#45;&gt;layer1_attn_gpu9</title>
<path fill="none" stroke="black" d="M2470.21,-4533.68C2471.27,-4525.38 2472.39,-4516.62 2473.47,-4508.24"/>
<polygon fill="black" stroke="black" points="2476.95,-4508.62 2474.74,-4498.25 2470,-4507.73 2476.95,-4508.62"/>
</g>
<!-- layer1_attn_norm_gpu9 -->
<g id="node31" class="node">
<title>layer1_attn_norm_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2602,-4393.95 2358,-4393.95 2358,-4325.95 2602,-4325.95 2602,-4393.95"/>
<text text-anchor="middle" x="2480" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="2480" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2480" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2480" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_attn_gpu9&#45;&gt;layer1_attn_norm_gpu9 -->
<g id="edge41" class="edge">
<title>layer1_attn_gpu9&#45;&gt;layer1_attn_norm_gpu9</title>
<path fill="none" stroke="black" d="M2479.32,-4429.84C2479.4,-4421.73 2479.49,-4412.94 2479.57,-4404.43"/>
<polygon fill="black" stroke="black" points="2483.08,-4404.29 2479.67,-4394.25 2476.08,-4404.22 2483.08,-4404.29"/>
</g>
<!-- layer1_attn_norm_gpu9&#45;&gt;layer1_attn_aggregate -->
<g id="edge42" class="edge">
<title>layer1_attn_norm_gpu9&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M2357.72,-4327.67C2354.79,-4327.08 2351.88,-4326.5 2349,-4325.95 2141.48,-4286.36 1900.22,-4257.21 1740.3,-4240.22"/>
<polygon fill="black" stroke="black" points="1740.2,-4236.69 1729.88,-4239.12 1739.46,-4243.65 1740.2,-4236.69"/>
</g>
<!-- layer1_attn_gpu10 -->
<g id="node33" class="node">
<title>layer1_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2872,-4497.95 2620,-4497.95 2620,-4429.95 2872,-4429.95 2872,-4497.95"/>
<text text-anchor="middle" x="2746" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU10</text>
<text text-anchor="middle" x="2746" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2746" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2746" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_qkv_gpu10&#45;&gt;layer1_attn_gpu10 -->
<g id="edge43" class="edge">
<title>layer1_qkv_gpu10&#45;&gt;layer1_attn_gpu10</title>
<path fill="none" stroke="black" d="M2734.7,-4533.68C2736.07,-4525.38 2737.51,-4516.62 2738.88,-4508.24"/>
<polygon fill="black" stroke="black" points="2742.36,-4508.69 2740.53,-4498.25 2735.45,-4507.55 2742.36,-4508.69"/>
</g>
<!-- layer1_attn_norm_gpu10 -->
<g id="node34" class="node">
<title>layer1_attn_norm_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2873.5,-4393.95 2620.5,-4393.95 2620.5,-4325.95 2873.5,-4325.95 2873.5,-4393.95"/>
<text text-anchor="middle" x="2747" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="2747" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2747" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2747" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_attn_gpu10&#45;&gt;layer1_attn_norm_gpu10 -->
<g id="edge44" class="edge">
<title>layer1_attn_gpu10&#45;&gt;layer1_attn_norm_gpu10</title>
<path fill="none" stroke="black" d="M2746.32,-4429.84C2746.4,-4421.73 2746.49,-4412.94 2746.57,-4404.43"/>
<polygon fill="black" stroke="black" points="2750.08,-4404.29 2746.67,-4394.25 2743.08,-4404.22 2750.08,-4404.29"/>
</g>
<!-- layer1_attn_norm_gpu10&#45;&gt;layer1_attn_aggregate -->
<g id="edge45" class="edge">
<title>layer1_attn_norm_gpu10&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M2620.43,-4327.63C2617.26,-4327.04 2614.11,-4326.48 2611,-4325.95 2316.39,-4275.99 1970.77,-4247.84 1759.37,-4234.01"/>
<polygon fill="black" stroke="black" points="1759.3,-4230.5 1749.09,-4233.35 1758.84,-4237.49 1759.3,-4230.5"/>
</g>
<!-- layer1_attn_gpu11 -->
<g id="node36" class="node">
<title>layer1_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3143,-4497.95 2891,-4497.95 2891,-4429.95 3143,-4429.95 3143,-4497.95"/>
<text text-anchor="middle" x="3017" y="-4482.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU11</text>
<text text-anchor="middle" x="3017" y="-4467.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="3017" y="-4452.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3017" y="-4437.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_qkv_gpu11&#45;&gt;layer1_attn_gpu11 -->
<g id="edge46" class="edge">
<title>layer1_qkv_gpu11&#45;&gt;layer1_attn_gpu11</title>
<path fill="none" stroke="black" d="M3003.19,-4533.68C3004.86,-4525.38 3006.62,-4516.62 3008.3,-4508.24"/>
<polygon fill="black" stroke="black" points="3011.77,-4508.75 3010.31,-4498.25 3004.91,-4507.37 3011.77,-4508.75"/>
</g>
<!-- layer1_attn_norm_gpu11 -->
<g id="node37" class="node">
<title>layer1_attn_norm_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3144.5,-4393.95 2891.5,-4393.95 2891.5,-4325.95 3144.5,-4325.95 3144.5,-4393.95"/>
<text text-anchor="middle" x="3018" y="-4378.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="3018" y="-4363.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="3018" y="-4348.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3018" y="-4333.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_attn_gpu11&#45;&gt;layer1_attn_norm_gpu11 -->
<g id="edge47" class="edge">
<title>layer1_attn_gpu11&#45;&gt;layer1_attn_norm_gpu11</title>
<path fill="none" stroke="black" d="M3017.32,-4429.84C3017.4,-4421.73 3017.49,-4412.94 3017.57,-4404.43"/>
<polygon fill="black" stroke="black" points="3021.08,-4404.29 3017.67,-4394.25 3014.08,-4404.22 3021.08,-4404.29"/>
</g>
<!-- layer1_attn_norm_gpu11&#45;&gt;layer1_attn_aggregate -->
<g id="edge48" class="edge">
<title>layer1_attn_norm_gpu11&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M2891.45,-4327.54C2888.27,-4326.98 2885.12,-4326.45 2882,-4325.95 2494.2,-4264.17 2036.09,-4238.97 1774.55,-4229.05"/>
<polygon fill="black" stroke="black" points="1774.29,-4225.53 1764.17,-4228.66 1774.03,-4232.53 1774.29,-4225.53"/>
</g>
<!-- layer1_moe_broadcast -->
<g id="node39" class="node">
<title>layer1_moe_broadcast</title>
<polygon fill="yellow" stroke="black" points="1795.47,-4117.95 1425.66,-4117.95 1330.53,-3981.95 1700.34,-3981.95 1795.47,-4117.95"/>
<text text-anchor="middle" x="1563" y="-4068.75" font-family="Times,serif" font-size="14.00">L1_Broadcast_to_MoE</text>
<text text-anchor="middle" x="1563" y="-4053.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1563" y="-4038.75" font-family="Times,serif" font-size="14.00">Output: 4×[1024,2048,4096]</text>
<text text-anchor="middle" x="1563" y="-4023.75" font-family="Times,serif" font-size="14.00">Broadcast to GPUs 12&#45;15</text>
</g>
<!-- layer1_attn_aggregate&#45;&gt;layer1_moe_broadcast -->
<g id="edge49" class="edge">
<title>layer1_attn_aggregate&#45;&gt;layer1_moe_broadcast</title>
<path fill="none" stroke="black" d="M1563,-4153.76C1563,-4145.45 1563,-4136.9 1563,-4128.45"/>
<polygon fill="black" stroke="black" points="1566.5,-4128.21 1563,-4118.21 1559.5,-4128.21 1566.5,-4128.21"/>
</g>
<!-- layer1_gate_gpu12 -->
<g id="node40" class="node">
<title>layer1_gate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="629,-3945.95 385,-3945.95 385,-3862.95 629,-3862.95 629,-3945.95"/>
<text text-anchor="middle" x="507" y="-3930.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU12</text>
<text text-anchor="middle" x="507" y="-3915.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="507" y="-3900.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="507" y="-3885.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="507" y="-3870.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_moe_broadcast&#45;&gt;layer1_gate_gpu12 -->
<g id="edge50" class="edge">
<title>layer1_moe_broadcast&#45;&gt;layer1_gate_gpu12</title>
<path fill="none" stroke="black" d="M1357.83,-4021.07C1145.43,-3992.21 819.92,-3947.98 639.31,-3923.43"/>
<polygon fill="black" stroke="black" points="639.6,-3919.94 629.22,-3922.06 638.66,-3926.88 639.6,-3919.94"/>
</g>
<!-- layer1_gate_gpu13 -->
<g id="node47" class="node">
<title>layer1_gate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1397,-3945.95 1153,-3945.95 1153,-3862.95 1397,-3862.95 1397,-3945.95"/>
<text text-anchor="middle" x="1275" y="-3930.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU13</text>
<text text-anchor="middle" x="1275" y="-3915.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1275" y="-3900.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1275" y="-3885.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="1275" y="-3870.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_moe_broadcast&#45;&gt;layer1_gate_gpu13 -->
<g id="edge60" class="edge">
<title>layer1_moe_broadcast&#45;&gt;layer1_gate_gpu13</title>
<path fill="none" stroke="black" d="M1428.28,-3981.82C1406.95,-3971.2 1385.35,-3960.44 1365.36,-3950.47"/>
<polygon fill="black" stroke="black" points="1366.8,-3947.28 1356.29,-3945.96 1363.68,-3953.55 1366.8,-3947.28"/>
</g>
<!-- layer1_gate_gpu14 -->
<g id="node54" class="node">
<title>layer1_gate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1973,-3945.95 1729,-3945.95 1729,-3862.95 1973,-3862.95 1973,-3945.95"/>
<text text-anchor="middle" x="1851" y="-3930.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU14</text>
<text text-anchor="middle" x="1851" y="-3915.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1851" y="-3900.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1851" y="-3885.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="1851" y="-3870.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_moe_broadcast&#45;&gt;layer1_gate_gpu14 -->
<g id="edge70" class="edge">
<title>layer1_moe_broadcast&#45;&gt;layer1_gate_gpu14</title>
<path fill="none" stroke="black" d="M1697.72,-3981.82C1719.05,-3971.2 1740.65,-3960.44 1760.64,-3950.47"/>
<polygon fill="black" stroke="black" points="1762.32,-3953.55 1769.71,-3945.96 1759.2,-3947.28 1762.32,-3953.55"/>
</g>
<!-- layer1_gate_gpu15 -->
<g id="node61" class="node">
<title>layer1_gate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2741,-3945.95 2497,-3945.95 2497,-3862.95 2741,-3862.95 2741,-3945.95"/>
<text text-anchor="middle" x="2619" y="-3930.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU15</text>
<text text-anchor="middle" x="2619" y="-3915.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2619" y="-3900.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="2619" y="-3885.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="2619" y="-3870.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_moe_broadcast&#45;&gt;layer1_gate_gpu15 -->
<g id="edge80" class="edge">
<title>layer1_moe_broadcast&#45;&gt;layer1_gate_gpu15</title>
<path fill="none" stroke="black" d="M1731.49,-4026.06C1941.3,-3997.55 2295.33,-3949.44 2486.69,-3923.43"/>
<polygon fill="black" stroke="black" points="2487.37,-3926.87 2496.81,-3922.06 2486.43,-3919.94 2487.37,-3926.87"/>
</g>
<!-- layer1_expert12_0 -->
<g id="node41" class="node">
<title>layer1_expert12_0</title>
<polygon fill="lightgreen" stroke="black" points="210,-3826.95 36,-3826.95 36,-3743.95 210,-3743.95 210,-3826.95"/>
<text text-anchor="middle" x="123" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU12</text>
<text text-anchor="middle" x="123" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="123" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="123" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="123" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_gate_gpu12&#45;&gt;layer1_expert12_0 -->
<g id="edge51" class="edge">
<title>layer1_gate_gpu12&#45;&gt;layer1_expert12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M384.66,-3874.97C335.66,-3862.59 278.72,-3846.96 219.67,-3827.07"/>
<polygon fill="black" stroke="black" points="220.77,-3823.75 210.18,-3823.84 218.52,-3830.37 220.77,-3823.75"/>
</g>
<!-- layer1_expert12_1 -->
<g id="node42" class="node">
<title>layer1_expert12_1</title>
<polygon fill="lightgreen" stroke="black" points="402,-3826.95 228,-3826.95 228,-3743.95 402,-3743.95 402,-3826.95"/>
<text text-anchor="middle" x="315" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU12</text>
<text text-anchor="middle" x="315" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="315" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="315" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="315" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_gate_gpu12&#45;&gt;layer1_expert12_1 -->
<g id="edge52" class="edge">
<title>layer1_gate_gpu12&#45;&gt;layer1_expert12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M440.39,-3862.86C424.15,-3852.97 406.68,-3842.32 390.08,-3832.21"/>
<polygon fill="black" stroke="black" points="391.86,-3829.19 381.5,-3826.97 388.21,-3835.17 391.86,-3829.19"/>
</g>
<!-- layer1_expert12_2 -->
<g id="node43" class="node">
<title>layer1_expert12_2</title>
<polygon fill="lightgreen" stroke="black" points="594,-3826.95 420,-3826.95 420,-3743.95 594,-3743.95 594,-3826.95"/>
<text text-anchor="middle" x="507" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU12</text>
<text text-anchor="middle" x="507" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="507" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="507" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="507" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_gate_gpu12&#45;&gt;layer1_expert12_2 -->
<g id="edge53" class="edge">
<title>layer1_gate_gpu12&#45;&gt;layer1_expert12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M507,-3862.86C507,-3854.6 507,-3845.82 507,-3837.26"/>
<polygon fill="black" stroke="black" points="510.5,-3836.97 507,-3826.97 503.5,-3836.97 510.5,-3836.97"/>
</g>
<!-- layer1_expert12_3 -->
<g id="node44" class="node">
<title>layer1_expert12_3</title>
<polygon fill="lightgreen" stroke="black" points="786,-3826.95 612,-3826.95 612,-3743.95 786,-3743.95 786,-3826.95"/>
<text text-anchor="middle" x="699" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU12</text>
<text text-anchor="middle" x="699" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="699" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="699" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="699" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_gate_gpu12&#45;&gt;layer1_expert12_3 -->
<g id="edge54" class="edge">
<title>layer1_gate_gpu12&#45;&gt;layer1_expert12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M573.61,-3862.86C589.85,-3852.97 607.32,-3842.32 623.92,-3832.21"/>
<polygon fill="black" stroke="black" points="625.79,-3835.17 632.5,-3826.97 622.14,-3829.19 625.79,-3835.17"/>
</g>
<!-- layer1_moe_aggregate_gpu12 -->
<g id="node45" class="node">
<title>layer1_moe_aggregate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="613,-3707.95 401,-3707.95 401,-3639.95 613,-3639.95 613,-3707.95"/>
<text text-anchor="middle" x="507" y="-3692.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU12</text>
<text text-anchor="middle" x="507" y="-3677.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="507" y="-3662.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="507" y="-3647.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_expert12_0&#45;&gt;layer1_moe_aggregate_gpu12 -->
<g id="edge55" class="edge">
<title>layer1_expert12_0&#45;&gt;layer1_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M210.15,-3746.97C213.12,-3745.92 216.08,-3744.91 219,-3743.95 274.76,-3725.65 338.05,-3709.95 391.08,-3698.17"/>
<polygon fill="black" stroke="black" points="391.84,-3701.59 400.85,-3696.02 390.33,-3694.75 391.84,-3701.59"/>
</g>
<!-- layer1_expert12_1&#45;&gt;layer1_moe_aggregate_gpu12 -->
<g id="edge56" class="edge">
<title>layer1_expert12_1&#45;&gt;layer1_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M386.22,-3743.84C403.85,-3733.78 422.68,-3723.04 440.1,-3713.11"/>
<polygon fill="black" stroke="black" points="442.11,-3715.99 449.06,-3708 438.64,-3709.91 442.11,-3715.99"/>
</g>
<!-- layer1_expert12_2&#45;&gt;layer1_moe_aggregate_gpu12 -->
<g id="edge57" class="edge">
<title>layer1_expert12_2&#45;&gt;layer1_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M507,-3743.68C507,-3735.47 507,-3726.81 507,-3718.51"/>
<polygon fill="black" stroke="black" points="510.5,-3718.25 507,-3708.25 503.5,-3718.25 510.5,-3718.25"/>
</g>
<!-- layer1_expert12_3&#45;&gt;layer1_moe_aggregate_gpu12 -->
<g id="edge58" class="edge">
<title>layer1_expert12_3&#45;&gt;layer1_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M627.78,-3743.84C610.15,-3733.78 591.32,-3723.04 573.9,-3713.11"/>
<polygon fill="black" stroke="black" points="575.36,-3709.91 564.94,-3708 571.89,-3715.99 575.36,-3709.91"/>
</g>
<!-- layer1_moe_norm_gpu12 -->
<g id="node46" class="node">
<title>layer1_moe_norm_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="1282.5,-3603.95 1029.5,-3603.95 1029.5,-3535.95 1282.5,-3535.95 1282.5,-3603.95"/>
<text text-anchor="middle" x="1156" y="-3588.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="1156" y="-3573.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1156" y="-3558.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1156" y="-3543.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_moe_aggregate_gpu12&#45;&gt;layer1_moe_norm_gpu12 -->
<g id="edge59" class="edge">
<title>layer1_moe_aggregate_gpu12&#45;&gt;layer1_moe_norm_gpu12</title>
<path fill="none" stroke="black" d="M613.08,-3656.28C723.89,-3638.87 898.13,-3611.48 1019.22,-3592.45"/>
<polygon fill="black" stroke="black" points="1019.97,-3595.88 1029.31,-3590.87 1018.88,-3588.96 1019.97,-3595.88"/>
</g>
<!-- layer2_qkv_gpu0 -->
<g id="node68" class="node">
<title>layer2_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="324,-3499.95 96,-3499.95 96,-3416.95 324,-3416.95 324,-3499.95"/>
<text text-anchor="middle" x="210" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="210" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="210" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="210" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 0&#45;2</text>
<text text-anchor="middle" x="210" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu0 -->
<g id="edge90" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1029.21,-3567.5C868.61,-3563.61 583.7,-3549.81 333.99,-3500.01"/>
<polygon fill="black" stroke="black" points="334.5,-3496.54 324,-3498 333.11,-3503.41 334.5,-3496.54"/>
</g>
<!-- layer2_qkv_gpu1 -->
<g id="node71" class="node">
<title>layer2_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="570,-3499.95 342,-3499.95 342,-3416.95 570,-3416.95 570,-3499.95"/>
<text text-anchor="middle" x="456" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="456" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="456" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="456" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 3&#45;5</text>
<text text-anchor="middle" x="456" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu1 -->
<g id="edge91" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1029.28,-3561.08C913.97,-3552.24 739.24,-3534.65 580.01,-3500.05"/>
<polygon fill="black" stroke="black" points="580.55,-3496.59 570.03,-3497.86 579.05,-3503.42 580.55,-3496.59"/>
</g>
<!-- layer2_qkv_gpu2 -->
<g id="node74" class="node">
<title>layer2_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="816,-3499.95 588,-3499.95 588,-3416.95 816,-3416.95 816,-3499.95"/>
<text text-anchor="middle" x="702" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="702" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="702" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="702" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 6&#45;8</text>
<text text-anchor="middle" x="702" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu2 -->
<g id="edge92" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1029.47,-3546.05C970.12,-3534.46 898.37,-3519.25 825.89,-3500.11"/>
<polygon fill="black" stroke="black" points="826.68,-3496.7 816.12,-3497.51 824.88,-3503.47 826.68,-3496.7"/>
</g>
<!-- layer2_qkv_gpu3 -->
<g id="node77" class="node">
<title>layer2_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1062,-3499.95 834,-3499.95 834,-3416.95 1062,-3416.95 1062,-3499.95"/>
<text text-anchor="middle" x="948" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="948" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="948" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="948" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 9&#45;11</text>
<text text-anchor="middle" x="948" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu3 -->
<g id="edge93" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1093.31,-3535.95C1074.74,-3526.18 1054.08,-3515.3 1034.29,-3504.88"/>
<polygon fill="black" stroke="black" points="1035.75,-3501.7 1025.28,-3500.13 1032.49,-3507.89 1035.75,-3501.7"/>
</g>
<!-- layer2_qkv_gpu4 -->
<g id="node80" class="node">
<title>layer2_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1308,-3499.95 1080,-3499.95 1080,-3416.95 1308,-3416.95 1308,-3499.95"/>
<text text-anchor="middle" x="1194" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="1194" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1194" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1194" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 12&#45;14</text>
<text text-anchor="middle" x="1194" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu4 -->
<g id="edge94" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1167.5,-3535.8C1170.36,-3527.57 1173.48,-3518.57 1176.55,-3509.72"/>
<polygon fill="black" stroke="black" points="1179.88,-3510.83 1179.85,-3500.23 1173.26,-3508.53 1179.88,-3510.83"/>
</g>
<!-- layer2_qkv_gpu5 -->
<g id="node83" class="node">
<title>layer2_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1554,-3499.95 1326,-3499.95 1326,-3416.95 1554,-3416.95 1554,-3499.95"/>
<text text-anchor="middle" x="1440" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="1440" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1440" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1440" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 15&#45;17</text>
<text text-anchor="middle" x="1440" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu5 -->
<g id="edge95" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1241.59,-3535.95C1267.93,-3525.8 1297.36,-3514.45 1325.33,-3503.67"/>
<polygon fill="black" stroke="black" points="1326.67,-3506.9 1334.75,-3500.04 1324.16,-3500.37 1326.67,-3506.9"/>
</g>
<!-- layer2_qkv_gpu6 -->
<g id="node86" class="node">
<title>layer2_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1800,-3499.95 1572,-3499.95 1572,-3416.95 1800,-3416.95 1800,-3499.95"/>
<text text-anchor="middle" x="1686" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="1686" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1686" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1686" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 18&#45;20</text>
<text text-anchor="middle" x="1686" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu6 -->
<g id="edge96" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1282.74,-3537.55C1285.52,-3537 1288.27,-3536.47 1291,-3535.95 1407.69,-3514.04 1442.31,-3526.44 1562.04,-3500.04"/>
<polygon fill="black" stroke="black" points="1562.97,-3503.42 1571.95,-3497.81 1561.43,-3496.59 1562.97,-3503.42"/>
</g>
<!-- layer2_qkv_gpu7 -->
<g id="node89" class="node">
<title>layer2_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2046,-3499.95 1818,-3499.95 1818,-3416.95 2046,-3416.95 2046,-3499.95"/>
<text text-anchor="middle" x="1932" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="1932" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1932" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1932" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 21&#45;23</text>
<text text-anchor="middle" x="1932" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu7 -->
<g id="edge97" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1282.7,-3537.32C1285.49,-3536.84 1288.26,-3536.38 1291,-3535.95 1515.8,-3500.93 1580.71,-3543.16 1807.79,-3500.04"/>
<polygon fill="black" stroke="black" points="1808.52,-3503.46 1817.67,-3498.13 1807.19,-3496.59 1808.52,-3503.46"/>
</g>
<!-- layer2_qkv_gpu8 -->
<g id="node92" class="node">
<title>layer2_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2292,-3499.95 2064,-3499.95 2064,-3416.95 2292,-3416.95 2292,-3499.95"/>
<text text-anchor="middle" x="2178" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU8</text>
<text text-anchor="middle" x="2178" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2178" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2178" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 24&#45;26</text>
<text text-anchor="middle" x="2178" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu8 -->
<g id="edge98" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu8</title>
<path fill="none" stroke="black" d="M1282.69,-3537.23C1285.48,-3536.78 1288.25,-3536.35 1291,-3535.95 1624.16,-3487.84 1718.87,-3560.24 2053.71,-3500.04"/>
<polygon fill="black" stroke="black" points="2054.48,-3503.45 2063.69,-3498.22 2053.22,-3496.57 2054.48,-3503.45"/>
</g>
<!-- layer2_qkv_gpu9 -->
<g id="node95" class="node">
<title>layer2_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2538,-3499.95 2310,-3499.95 2310,-3416.95 2538,-3416.95 2538,-3499.95"/>
<text text-anchor="middle" x="2424" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU9</text>
<text text-anchor="middle" x="2424" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2424" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2424" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 27&#45;29</text>
<text text-anchor="middle" x="2424" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu9 -->
<g id="edge99" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu9</title>
<path fill="none" stroke="black" d="M1282.69,-3537.19C1285.48,-3536.75 1288.25,-3536.33 1291,-3535.95 1732.66,-3474.76 1857.01,-3577.46 2299.84,-3500"/>
<polygon fill="black" stroke="black" points="2300.46,-3503.45 2309.7,-3498.26 2299.24,-3496.56 2300.46,-3503.45"/>
</g>
<!-- layer2_qkv_gpu10 -->
<g id="node98" class="node">
<title>layer2_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2784,-3499.95 2556,-3499.95 2556,-3416.95 2784,-3416.95 2784,-3499.95"/>
<text text-anchor="middle" x="2670" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU10</text>
<text text-anchor="middle" x="2670" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2670" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2670" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 30&#45;32</text>
<text text-anchor="middle" x="2670" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu10 -->
<g id="edge100" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1282.68,-3537.16C1285.48,-3536.73 1288.25,-3536.32 1291,-3535.95 1564.47,-3499.03 2255.51,-3546.97 2545.55,-3500"/>
<polygon fill="black" stroke="black" points="2546.42,-3503.4 2555.7,-3498.29 2545.26,-3496.5 2546.42,-3503.4"/>
</g>
<!-- layer2_qkv_gpu11 -->
<g id="node101" class="node">
<title>layer2_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3030,-3499.95 2802,-3499.95 2802,-3416.95 3030,-3416.95 3030,-3499.95"/>
<text text-anchor="middle" x="2916" y="-3484.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU11</text>
<text text-anchor="middle" x="2916" y="-3469.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2916" y="-3454.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2916" y="-3439.75" font-family="Times,serif" font-size="14.00">Heads: 33&#45;35</text>
<text text-anchor="middle" x="2916" y="-3424.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu11 -->
<g id="edge101" class="edge">
<title>layer1_moe_norm_gpu12&#45;&gt;layer2_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1282.68,-3537.15C1285.47,-3536.72 1288.25,-3536.32 1291,-3535.95 1618.74,-3492.49 2447.6,-3555.52 2791.67,-3499.98"/>
<polygon fill="black" stroke="black" points="2792.42,-3503.41 2801.7,-3498.31 2791.26,-3496.5 2792.42,-3503.41"/>
</g>
<!-- layer1_expert13_4 -->
<g id="node48" class="node">
<title>layer1_expert13_4</title>
<polygon fill="lightgreen" stroke="black" points="978,-3826.95 804,-3826.95 804,-3743.95 978,-3743.95 978,-3826.95"/>
<text text-anchor="middle" x="891" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU13</text>
<text text-anchor="middle" x="891" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="891" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="891" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="891" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_gate_gpu13&#45;&gt;layer1_expert13_4 -->
<g id="edge61" class="edge">
<title>layer1_gate_gpu13&#45;&gt;layer1_expert13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1152.66,-3874.97C1103.66,-3862.59 1046.72,-3846.96 987.67,-3827.07"/>
<polygon fill="black" stroke="black" points="988.77,-3823.75 978.18,-3823.84 986.52,-3830.37 988.77,-3823.75"/>
</g>
<!-- layer1_expert13_5 -->
<g id="node49" class="node">
<title>layer1_expert13_5</title>
<polygon fill="lightgreen" stroke="black" points="1170,-3826.95 996,-3826.95 996,-3743.95 1170,-3743.95 1170,-3826.95"/>
<text text-anchor="middle" x="1083" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU13</text>
<text text-anchor="middle" x="1083" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1083" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1083" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1083" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_gate_gpu13&#45;&gt;layer1_expert13_5 -->
<g id="edge62" class="edge">
<title>layer1_gate_gpu13&#45;&gt;layer1_expert13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1208.39,-3862.86C1192.15,-3852.97 1174.68,-3842.32 1158.08,-3832.21"/>
<polygon fill="black" stroke="black" points="1159.86,-3829.19 1149.5,-3826.97 1156.21,-3835.17 1159.86,-3829.19"/>
</g>
<!-- layer1_expert13_6 -->
<g id="node50" class="node">
<title>layer1_expert13_6</title>
<polygon fill="lightgreen" stroke="black" points="1362,-3826.95 1188,-3826.95 1188,-3743.95 1362,-3743.95 1362,-3826.95"/>
<text text-anchor="middle" x="1275" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU13</text>
<text text-anchor="middle" x="1275" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1275" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1275" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1275" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_gate_gpu13&#45;&gt;layer1_expert13_6 -->
<g id="edge63" class="edge">
<title>layer1_gate_gpu13&#45;&gt;layer1_expert13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1275,-3862.86C1275,-3854.6 1275,-3845.82 1275,-3837.26"/>
<polygon fill="black" stroke="black" points="1278.5,-3836.97 1275,-3826.97 1271.5,-3836.97 1278.5,-3836.97"/>
</g>
<!-- layer1_expert13_7 -->
<g id="node51" class="node">
<title>layer1_expert13_7</title>
<polygon fill="lightgreen" stroke="black" points="1554,-3826.95 1380,-3826.95 1380,-3743.95 1554,-3743.95 1554,-3826.95"/>
<text text-anchor="middle" x="1467" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU13</text>
<text text-anchor="middle" x="1467" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1467" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1467" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1467" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_gate_gpu13&#45;&gt;layer1_expert13_7 -->
<g id="edge64" class="edge">
<title>layer1_gate_gpu13&#45;&gt;layer1_expert13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1341.61,-3862.86C1357.85,-3852.97 1375.32,-3842.32 1391.92,-3832.21"/>
<polygon fill="black" stroke="black" points="1393.79,-3835.17 1400.5,-3826.97 1390.14,-3829.19 1393.79,-3835.17"/>
</g>
<!-- layer1_moe_aggregate_gpu13 -->
<g id="node52" class="node">
<title>layer1_moe_aggregate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1381,-3707.95 1169,-3707.95 1169,-3639.95 1381,-3639.95 1381,-3707.95"/>
<text text-anchor="middle" x="1275" y="-3692.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU13</text>
<text text-anchor="middle" x="1275" y="-3677.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="1275" y="-3662.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1275" y="-3647.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_expert13_4&#45;&gt;layer1_moe_aggregate_gpu13 -->
<g id="edge65" class="edge">
<title>layer1_expert13_4&#45;&gt;layer1_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M978.15,-3746.97C981.12,-3745.92 984.08,-3744.91 987,-3743.95 1042.76,-3725.65 1106.05,-3709.95 1159.08,-3698.17"/>
<polygon fill="black" stroke="black" points="1159.84,-3701.59 1168.85,-3696.02 1158.33,-3694.75 1159.84,-3701.59"/>
</g>
<!-- layer1_expert13_5&#45;&gt;layer1_moe_aggregate_gpu13 -->
<g id="edge66" class="edge">
<title>layer1_expert13_5&#45;&gt;layer1_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1154.22,-3743.84C1171.85,-3733.78 1190.68,-3723.04 1208.1,-3713.11"/>
<polygon fill="black" stroke="black" points="1210.11,-3715.99 1217.06,-3708 1206.64,-3709.91 1210.11,-3715.99"/>
</g>
<!-- layer1_expert13_6&#45;&gt;layer1_moe_aggregate_gpu13 -->
<g id="edge67" class="edge">
<title>layer1_expert13_6&#45;&gt;layer1_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1275,-3743.68C1275,-3735.47 1275,-3726.81 1275,-3718.51"/>
<polygon fill="black" stroke="black" points="1278.5,-3718.25 1275,-3708.25 1271.5,-3718.25 1278.5,-3718.25"/>
</g>
<!-- layer1_expert13_7&#45;&gt;layer1_moe_aggregate_gpu13 -->
<g id="edge68" class="edge">
<title>layer1_expert13_7&#45;&gt;layer1_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1395.78,-3743.84C1378.15,-3733.78 1359.32,-3723.04 1341.9,-3713.11"/>
<polygon fill="black" stroke="black" points="1343.36,-3709.91 1332.94,-3708 1339.89,-3715.99 1343.36,-3709.91"/>
</g>
<!-- layer1_moe_norm_gpu13 -->
<g id="node53" class="node">
<title>layer1_moe_norm_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1553.5,-3603.95 1300.5,-3603.95 1300.5,-3535.95 1553.5,-3535.95 1553.5,-3603.95"/>
<text text-anchor="middle" x="1427" y="-3588.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="1427" y="-3573.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1427" y="-3558.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1427" y="-3543.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_moe_aggregate_gpu13&#45;&gt;layer1_moe_norm_gpu13 -->
<g id="edge69" class="edge">
<title>layer1_moe_aggregate_gpu13&#45;&gt;layer1_moe_norm_gpu13</title>
<path fill="none" stroke="black" d="M1324.35,-3639.84C1338.63,-3630.26 1354.34,-3619.71 1369.08,-3609.82"/>
<polygon fill="black" stroke="black" points="1371.28,-3612.56 1377.64,-3604.08 1367.38,-3606.74 1371.28,-3612.56"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu0 -->
<g id="edge102" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1300.47,-3537.37C1297.29,-3536.86 1294.13,-3536.39 1291,-3535.95 872.26,-3477.88 754.2,-3573.8 334.28,-3500.03"/>
<polygon fill="black" stroke="black" points="334.76,-3496.56 324.31,-3498.25 333.54,-3503.45 334.76,-3496.56"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu1 -->
<g id="edge103" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1300.47,-3537.43C1297.28,-3536.9 1294.13,-3536.41 1291,-3535.95 980.81,-3490.89 892.38,-3556.58 580.55,-3500.09"/>
<polygon fill="black" stroke="black" points="580.78,-3496.57 570.31,-3498.2 579.52,-3503.45 580.78,-3496.57"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu2 -->
<g id="edge104" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1300.45,-3537.54C1297.27,-3536.98 1294.12,-3536.45 1291,-3535.95 1089.05,-3503.87 1030.51,-3539.58 826.18,-3500.04"/>
<polygon fill="black" stroke="black" points="826.82,-3496.6 816.33,-3498.1 825.47,-3503.47 826.82,-3496.6"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu3 -->
<g id="edge105" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1300.38,-3537.9C1297.23,-3537.23 1294.1,-3536.58 1291,-3535.95 1197.03,-3516.89 1169.03,-3523.08 1072,-3500.08"/>
<polygon fill="black" stroke="black" points="1072.62,-3496.63 1062.07,-3497.68 1070.97,-3503.43 1072.62,-3496.63"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu4 -->
<g id="edge106" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1356.78,-3535.95C1335.7,-3526.04 1312.2,-3515 1289.77,-3504.46"/>
<polygon fill="black" stroke="black" points="1291.1,-3501.22 1280.56,-3500.13 1288.13,-3507.56 1291.1,-3501.22"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu5 -->
<g id="edge107" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1430.94,-3535.8C1431.89,-3527.75 1432.94,-3518.95 1433.96,-3510.29"/>
<polygon fill="black" stroke="black" points="1437.46,-3510.57 1435.16,-3500.23 1430.5,-3509.75 1437.46,-3510.57"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu6 -->
<g id="edge108" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1505.06,-3535.95C1528.81,-3525.91 1555.31,-3514.71 1580.54,-3504.04"/>
<polygon fill="black" stroke="black" points="1581.93,-3507.25 1589.78,-3500.13 1579.2,-3500.8 1581.93,-3507.25"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu7 -->
<g id="edge109" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1553.75,-3537.6C1556.53,-3537.03 1559.28,-3536.48 1562,-3535.95 1667.7,-3515.38 1699.19,-3524.8 1807.89,-3500.09"/>
<polygon fill="black" stroke="black" points="1808.99,-3503.42 1817.94,-3497.75 1807.41,-3496.6 1808.99,-3503.42"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu8 -->
<g id="edge110" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu8</title>
<path fill="none" stroke="black" d="M1553.71,-3537.33C1556.49,-3536.85 1559.26,-3536.39 1562,-3535.95 1775.73,-3502.27 1837.62,-3541.41 2053.6,-3500.08"/>
<polygon fill="black" stroke="black" points="2054.52,-3503.47 2063.67,-3498.12 2053.18,-3496.59 2054.52,-3503.47"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu9 -->
<g id="edge111" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu9</title>
<path fill="none" stroke="black" d="M1553.69,-3537.24C1556.48,-3536.78 1559.25,-3536.35 1562,-3535.95 1884.08,-3489.18 1975.8,-3558.47 2299.55,-3500.07"/>
<polygon fill="black" stroke="black" points="2300.48,-3503.45 2309.69,-3498.21 2299.22,-3496.57 2300.48,-3503.45"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu10 -->
<g id="edge112" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1553.69,-3537.19C1556.48,-3536.75 1559.25,-3536.34 1562,-3535.95 1992.61,-3476.09 2113.97,-3575.69 2545.76,-3500.02"/>
<polygon fill="black" stroke="black" points="2546.46,-3503.45 2555.7,-3498.26 2545.24,-3496.56 2546.46,-3503.45"/>
</g>
<!-- layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu11 -->
<g id="edge113" class="edge">
<title>layer1_moe_norm_gpu13&#45;&gt;layer2_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1553.68,-3537.17C1556.48,-3536.73 1559.25,-3536.33 1562,-3535.95 2101.09,-3463.01 2252.05,-3592.93 2791.71,-3500.02"/>
<polygon fill="black" stroke="black" points="2792.45,-3503.45 2801.7,-3498.29 2791.25,-3496.55 2792.45,-3503.45"/>
</g>
<!-- layer1_expert14_8 -->
<g id="node55" class="node">
<title>layer1_expert14_8</title>
<polygon fill="lightgreen" stroke="black" points="1746,-3826.95 1572,-3826.95 1572,-3743.95 1746,-3743.95 1746,-3826.95"/>
<text text-anchor="middle" x="1659" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU14</text>
<text text-anchor="middle" x="1659" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1659" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1659" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1659" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_gate_gpu14&#45;&gt;layer1_expert14_8 -->
<g id="edge71" class="edge">
<title>layer1_gate_gpu14&#45;&gt;layer1_expert14_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1784.39,-3862.86C1768.15,-3852.97 1750.68,-3842.32 1734.08,-3832.21"/>
<polygon fill="black" stroke="black" points="1735.86,-3829.19 1725.5,-3826.97 1732.21,-3835.17 1735.86,-3829.19"/>
</g>
<!-- layer1_expert14_9 -->
<g id="node56" class="node">
<title>layer1_expert14_9</title>
<polygon fill="lightgreen" stroke="black" points="1938,-3826.95 1764,-3826.95 1764,-3743.95 1938,-3743.95 1938,-3826.95"/>
<text text-anchor="middle" x="1851" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU14</text>
<text text-anchor="middle" x="1851" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1851" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1851" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1851" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_gate_gpu14&#45;&gt;layer1_expert14_9 -->
<g id="edge72" class="edge">
<title>layer1_gate_gpu14&#45;&gt;layer1_expert14_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1851,-3862.86C1851,-3854.6 1851,-3845.82 1851,-3837.26"/>
<polygon fill="black" stroke="black" points="1854.5,-3836.97 1851,-3826.97 1847.5,-3836.97 1854.5,-3836.97"/>
</g>
<!-- layer1_expert14_10 -->
<g id="node57" class="node">
<title>layer1_expert14_10</title>
<polygon fill="lightgreen" stroke="black" points="2130,-3826.95 1956,-3826.95 1956,-3743.95 2130,-3743.95 2130,-3826.95"/>
<text text-anchor="middle" x="2043" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU14</text>
<text text-anchor="middle" x="2043" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2043" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2043" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2043" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_gate_gpu14&#45;&gt;layer1_expert14_10 -->
<g id="edge73" class="edge">
<title>layer1_gate_gpu14&#45;&gt;layer1_expert14_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1917.61,-3862.86C1933.85,-3852.97 1951.32,-3842.32 1967.92,-3832.21"/>
<polygon fill="black" stroke="black" points="1969.79,-3835.17 1976.5,-3826.97 1966.14,-3829.19 1969.79,-3835.17"/>
</g>
<!-- layer1_expert14_11 -->
<g id="node58" class="node">
<title>layer1_expert14_11</title>
<polygon fill="lightgreen" stroke="black" points="2322,-3826.95 2148,-3826.95 2148,-3743.95 2322,-3743.95 2322,-3826.95"/>
<text text-anchor="middle" x="2235" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU14</text>
<text text-anchor="middle" x="2235" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2235" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2235" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2235" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_gate_gpu14&#45;&gt;layer1_expert14_11 -->
<g id="edge74" class="edge">
<title>layer1_gate_gpu14&#45;&gt;layer1_expert14_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1973.34,-3874.97C2022.34,-3862.59 2079.28,-3846.96 2138.33,-3827.07"/>
<polygon fill="black" stroke="black" points="2139.48,-3830.37 2147.82,-3823.84 2137.23,-3823.75 2139.48,-3830.37"/>
</g>
<!-- layer1_moe_aggregate_gpu14 -->
<g id="node59" class="node">
<title>layer1_moe_aggregate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1957,-3707.95 1745,-3707.95 1745,-3639.95 1957,-3639.95 1957,-3707.95"/>
<text text-anchor="middle" x="1851" y="-3692.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU14</text>
<text text-anchor="middle" x="1851" y="-3677.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="1851" y="-3662.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1851" y="-3647.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_expert14_8&#45;&gt;layer1_moe_aggregate_gpu14 -->
<g id="edge75" class="edge">
<title>layer1_expert14_8&#45;&gt;layer1_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1730.22,-3743.84C1747.85,-3733.78 1766.68,-3723.04 1784.1,-3713.11"/>
<polygon fill="black" stroke="black" points="1786.11,-3715.99 1793.06,-3708 1782.64,-3709.91 1786.11,-3715.99"/>
</g>
<!-- layer1_expert14_9&#45;&gt;layer1_moe_aggregate_gpu14 -->
<g id="edge76" class="edge">
<title>layer1_expert14_9&#45;&gt;layer1_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1851,-3743.68C1851,-3735.47 1851,-3726.81 1851,-3718.51"/>
<polygon fill="black" stroke="black" points="1854.5,-3718.25 1851,-3708.25 1847.5,-3718.25 1854.5,-3718.25"/>
</g>
<!-- layer1_expert14_10&#45;&gt;layer1_moe_aggregate_gpu14 -->
<g id="edge77" class="edge">
<title>layer1_expert14_10&#45;&gt;layer1_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1971.78,-3743.84C1954.15,-3733.78 1935.32,-3723.04 1917.9,-3713.11"/>
<polygon fill="black" stroke="black" points="1919.36,-3709.91 1908.94,-3708 1915.89,-3715.99 1919.36,-3709.91"/>
</g>
<!-- layer1_expert14_11&#45;&gt;layer1_moe_aggregate_gpu14 -->
<g id="edge78" class="edge">
<title>layer1_expert14_11&#45;&gt;layer1_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M2147.85,-3746.97C2144.88,-3745.92 2141.92,-3744.91 2139,-3743.95 2083.24,-3725.65 2019.95,-3709.95 1966.92,-3698.17"/>
<polygon fill="black" stroke="black" points="1967.67,-3694.75 1957.15,-3696.02 1966.16,-3701.59 1967.67,-3694.75"/>
</g>
<!-- layer1_moe_norm_gpu14 -->
<g id="node60" class="node">
<title>layer1_moe_norm_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1824.5,-3603.95 1571.5,-3603.95 1571.5,-3535.95 1824.5,-3535.95 1824.5,-3603.95"/>
<text text-anchor="middle" x="1698" y="-3588.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="1698" y="-3573.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1698" y="-3558.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1698" y="-3543.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_moe_aggregate_gpu14&#45;&gt;layer1_moe_norm_gpu14 -->
<g id="edge79" class="edge">
<title>layer1_moe_aggregate_gpu14&#45;&gt;layer1_moe_norm_gpu14</title>
<path fill="none" stroke="black" d="M1801.33,-3639.84C1786.96,-3630.26 1771.14,-3619.71 1756.3,-3609.82"/>
<polygon fill="black" stroke="black" points="1757.95,-3606.71 1747.69,-3604.08 1754.07,-3612.54 1757.95,-3606.71"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu0 -->
<g id="edge114" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1571.48,-3537.34C1568.29,-3536.84 1565.13,-3536.37 1562,-3535.95 1023.72,-3463.57 873.07,-3592.79 334.27,-3500.02"/>
<polygon fill="black" stroke="black" points="334.75,-3496.55 324.3,-3498.29 333.55,-3503.45 334.75,-3496.55"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu1 -->
<g id="edge115" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1571.47,-3537.37C1568.29,-3536.86 1565.13,-3536.39 1562,-3535.95 1132.21,-3476.56 1011.15,-3575.56 580.22,-3500.02"/>
<polygon fill="black" stroke="black" points="580.76,-3496.56 570.3,-3498.26 579.54,-3503.45 580.76,-3496.56"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu2 -->
<g id="edge116" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1571.47,-3537.42C1568.29,-3536.9 1565.13,-3536.4 1562,-3535.95 1240.75,-3489.56 1149.31,-3558.34 826.42,-3500.06"/>
<polygon fill="black" stroke="black" points="826.78,-3496.57 816.31,-3498.21 825.52,-3503.45 826.78,-3496.57"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu3 -->
<g id="edge117" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1571.45,-3537.52C1568.27,-3536.97 1565.12,-3536.44 1562,-3535.95 1349.11,-3502.55 1287.49,-3541.28 1072.36,-3500.07"/>
<polygon fill="black" stroke="black" points="1072.82,-3496.6 1062.33,-3498.11 1071.48,-3503.47 1072.82,-3496.6"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu4 -->
<g id="edge118" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1571.4,-3537.83C1568.24,-3537.18 1565.1,-3536.56 1562,-3535.95 1457.13,-3515.57 1425.93,-3524.68 1318.04,-3500.07"/>
<polygon fill="black" stroke="black" points="1318.59,-3496.61 1308.06,-3497.75 1317.01,-3503.42 1318.59,-3496.61"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu5 -->
<g id="edge119" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1620.24,-3535.95C1596.69,-3525.96 1570.42,-3514.81 1545.38,-3504.18"/>
<polygon fill="black" stroke="black" points="1546.42,-3500.82 1535.85,-3500.13 1543.69,-3507.26 1546.42,-3500.82"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu6 -->
<g id="edge120" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1694.37,-3535.8C1693.48,-3527.75 1692.52,-3518.95 1691.57,-3510.29"/>
<polygon fill="black" stroke="black" points="1695.04,-3509.79 1690.47,-3500.23 1688.08,-3510.55 1695.04,-3509.79"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu7 -->
<g id="edge121" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1768.53,-3535.95C1789.7,-3526.04 1813.29,-3515 1835.82,-3504.46"/>
<polygon fill="black" stroke="black" points="1837.49,-3507.54 1845.07,-3500.13 1834.52,-3501.2 1837.49,-3507.54"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu8 -->
<g id="edge122" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu8</title>
<path fill="none" stroke="black" d="M1824.77,-3537.66C1827.53,-3537.07 1830.28,-3536.51 1833,-3535.95 1927.8,-3516.71 1956.09,-3523.2 2053.92,-3500.1"/>
<polygon fill="black" stroke="black" points="2055.02,-3503.43 2063.93,-3497.69 2053.39,-3496.63 2055.02,-3503.43"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu9 -->
<g id="edge123" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu9</title>
<path fill="none" stroke="black" d="M1824.71,-3537.34C1827.49,-3536.86 1830.26,-3536.39 1833,-3535.95 2035.79,-3503.59 2094.61,-3539.71 2299.78,-3500.05"/>
<polygon fill="black" stroke="black" points="2300.53,-3503.47 2309.67,-3498.1 2299.18,-3496.6 2300.53,-3503.47"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu10 -->
<g id="edge124" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1824.69,-3537.24C1827.48,-3536.79 1830.25,-3536.35 1833,-3535.95 2144.02,-3490.52 2232.74,-3556.71 2545.42,-3500.09"/>
<polygon fill="black" stroke="black" points="2546.48,-3503.45 2555.69,-3498.2 2545.22,-3496.57 2546.48,-3503.45"/>
</g>
<!-- layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu11 -->
<g id="edge125" class="edge">
<title>layer1_moe_norm_gpu14&#45;&gt;layer2_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1824.69,-3537.2C1827.48,-3536.75 1830.25,-3536.34 1833,-3535.95 2252.57,-3477.42 2370.92,-3573.93 2791.7,-3500.03"/>
<polygon fill="black" stroke="black" points="2792.46,-3503.45 2801.69,-3498.25 2791.24,-3496.56 2792.46,-3503.45"/>
</g>
<!-- layer1_expert15_12 -->
<g id="node62" class="node">
<title>layer1_expert15_12</title>
<polygon fill="lightgreen" stroke="black" points="2514,-3826.95 2340,-3826.95 2340,-3743.95 2514,-3743.95 2514,-3826.95"/>
<text text-anchor="middle" x="2427" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU15</text>
<text text-anchor="middle" x="2427" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2427" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2427" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2427" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_gate_gpu15&#45;&gt;layer1_expert15_12 -->
<g id="edge81" class="edge">
<title>layer1_gate_gpu15&#45;&gt;layer1_expert15_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2552.39,-3862.86C2536.15,-3852.97 2518.68,-3842.32 2502.08,-3832.21"/>
<polygon fill="black" stroke="black" points="2503.86,-3829.19 2493.5,-3826.97 2500.21,-3835.17 2503.86,-3829.19"/>
</g>
<!-- layer1_expert15_13 -->
<g id="node63" class="node">
<title>layer1_expert15_13</title>
<polygon fill="lightgreen" stroke="black" points="2706,-3826.95 2532,-3826.95 2532,-3743.95 2706,-3743.95 2706,-3826.95"/>
<text text-anchor="middle" x="2619" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU15</text>
<text text-anchor="middle" x="2619" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2619" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2619" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2619" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_gate_gpu15&#45;&gt;layer1_expert15_13 -->
<g id="edge82" class="edge">
<title>layer1_gate_gpu15&#45;&gt;layer1_expert15_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2619,-3862.86C2619,-3854.6 2619,-3845.82 2619,-3837.26"/>
<polygon fill="black" stroke="black" points="2622.5,-3836.97 2619,-3826.97 2615.5,-3836.97 2622.5,-3836.97"/>
</g>
<!-- layer1_expert15_14 -->
<g id="node64" class="node">
<title>layer1_expert15_14</title>
<polygon fill="lightgreen" stroke="black" points="2898,-3826.95 2724,-3826.95 2724,-3743.95 2898,-3743.95 2898,-3826.95"/>
<text text-anchor="middle" x="2811" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU15</text>
<text text-anchor="middle" x="2811" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2811" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2811" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2811" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_gate_gpu15&#45;&gt;layer1_expert15_14 -->
<g id="edge83" class="edge">
<title>layer1_gate_gpu15&#45;&gt;layer1_expert15_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2685.61,-3862.86C2701.85,-3852.97 2719.32,-3842.32 2735.92,-3832.21"/>
<polygon fill="black" stroke="black" points="2737.79,-3835.17 2744.5,-3826.97 2734.14,-3829.19 2737.79,-3835.17"/>
</g>
<!-- layer1_expert15_15 -->
<g id="node65" class="node">
<title>layer1_expert15_15</title>
<polygon fill="lightgreen" stroke="black" points="3090,-3826.95 2916,-3826.95 2916,-3743.95 3090,-3743.95 3090,-3826.95"/>
<text text-anchor="middle" x="3003" y="-3811.75" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU15</text>
<text text-anchor="middle" x="3003" y="-3796.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3003" y="-3781.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3003" y="-3766.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3003" y="-3751.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_gate_gpu15&#45;&gt;layer1_expert15_15 -->
<g id="edge84" class="edge">
<title>layer1_gate_gpu15&#45;&gt;layer1_expert15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2741.34,-3874.97C2790.34,-3862.59 2847.28,-3846.96 2906.33,-3827.07"/>
<polygon fill="black" stroke="black" points="2907.48,-3830.37 2915.82,-3823.84 2905.23,-3823.75 2907.48,-3830.37"/>
</g>
<!-- layer1_moe_aggregate_gpu15 -->
<g id="node66" class="node">
<title>layer1_moe_aggregate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2725,-3707.95 2513,-3707.95 2513,-3639.95 2725,-3639.95 2725,-3707.95"/>
<text text-anchor="middle" x="2619" y="-3692.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU15</text>
<text text-anchor="middle" x="2619" y="-3677.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="2619" y="-3662.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2619" y="-3647.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_expert15_12&#45;&gt;layer1_moe_aggregate_gpu15 -->
<g id="edge85" class="edge">
<title>layer1_expert15_12&#45;&gt;layer1_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2498.22,-3743.84C2515.85,-3733.78 2534.68,-3723.04 2552.1,-3713.11"/>
<polygon fill="black" stroke="black" points="2554.11,-3715.99 2561.06,-3708 2550.64,-3709.91 2554.11,-3715.99"/>
</g>
<!-- layer1_expert15_13&#45;&gt;layer1_moe_aggregate_gpu15 -->
<g id="edge86" class="edge">
<title>layer1_expert15_13&#45;&gt;layer1_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2619,-3743.68C2619,-3735.47 2619,-3726.81 2619,-3718.51"/>
<polygon fill="black" stroke="black" points="2622.5,-3718.25 2619,-3708.25 2615.5,-3718.25 2622.5,-3718.25"/>
</g>
<!-- layer1_expert15_14&#45;&gt;layer1_moe_aggregate_gpu15 -->
<g id="edge87" class="edge">
<title>layer1_expert15_14&#45;&gt;layer1_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2739.78,-3743.84C2722.15,-3733.78 2703.32,-3723.04 2685.9,-3713.11"/>
<polygon fill="black" stroke="black" points="2687.36,-3709.91 2676.94,-3708 2683.89,-3715.99 2687.36,-3709.91"/>
</g>
<!-- layer1_expert15_15&#45;&gt;layer1_moe_aggregate_gpu15 -->
<g id="edge88" class="edge">
<title>layer1_expert15_15&#45;&gt;layer1_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2915.85,-3746.97C2912.88,-3745.92 2909.92,-3744.91 2907,-3743.95 2851.24,-3725.65 2787.95,-3709.95 2734.92,-3698.17"/>
<polygon fill="black" stroke="black" points="2735.67,-3694.75 2725.15,-3696.02 2734.16,-3701.59 2735.67,-3694.75"/>
</g>
<!-- layer1_moe_norm_gpu15 -->
<g id="node67" class="node">
<title>layer1_moe_norm_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2095.5,-3603.95 1842.5,-3603.95 1842.5,-3535.95 2095.5,-3535.95 2095.5,-3603.95"/>
<text text-anchor="middle" x="1969" y="-3588.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="1969" y="-3573.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1969" y="-3558.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1969" y="-3543.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_moe_aggregate_gpu15&#45;&gt;layer1_moe_norm_gpu15 -->
<g id="edge89" class="edge">
<title>layer1_moe_aggregate_gpu15&#45;&gt;layer1_moe_norm_gpu15</title>
<path fill="none" stroke="black" d="M2512.76,-3656.28C2401.69,-3638.85 2226.99,-3611.44 2105.7,-3592.4"/>
<polygon fill="black" stroke="black" points="2106.02,-3588.91 2095.6,-3590.82 2104.94,-3595.83 2106.02,-3588.91"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu0 -->
<g id="edge126" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1842.48,-3537.32C1839.3,-3536.82 1836.13,-3536.37 1833,-3535.95 1505.66,-3492.82 677.94,-3555.46 334.32,-3499.98"/>
<polygon fill="black" stroke="black" points="334.74,-3496.5 324.3,-3498.31 333.58,-3503.41 334.74,-3496.5"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu1 -->
<g id="edge127" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1842.48,-3537.34C1839.29,-3536.84 1836.13,-3536.37 1833,-3535.95 1559.93,-3499.32 870.02,-3546.91 580.43,-3500"/>
<polygon fill="black" stroke="black" points="580.74,-3496.5 570.3,-3498.29 579.58,-3503.4 580.74,-3496.5"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu2 -->
<g id="edge128" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1842.47,-3537.36C1839.29,-3536.86 1836.13,-3536.38 1833,-3535.95 1392.27,-3475.25 1268.16,-3577.27 826.46,-3500.06"/>
<polygon fill="black" stroke="black" points="826.76,-3496.56 816.3,-3498.26 825.54,-3503.45 826.76,-3496.56"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu3 -->
<g id="edge129" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1842.47,-3537.41C1839.29,-3536.89 1836.13,-3536.4 1833,-3535.95 1500.68,-3488.23 1406.24,-3560.11 1072.26,-3500.03"/>
<polygon fill="black" stroke="black" points="1072.78,-3496.57 1062.31,-3498.22 1071.52,-3503.45 1072.78,-3496.57"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu4 -->
<g id="edge130" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1842.45,-3537.51C1839.28,-3536.96 1836.12,-3536.44 1833,-3535.95 1609.04,-3501.22 1544.41,-3543.03 1318.18,-3500.03"/>
<polygon fill="black" stroke="black" points="1318.81,-3496.59 1308.33,-3498.13 1317.48,-3503.46 1318.81,-3496.59"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu5 -->
<g id="edge131" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1842.41,-3537.77C1839.24,-3537.14 1836.1,-3536.54 1833,-3535.95 1717.15,-3514.24 1682.8,-3526.32 1563.9,-3500.02"/>
<polygon fill="black" stroke="black" points="1564.57,-3496.59 1554.05,-3497.8 1563.03,-3503.42 1564.57,-3496.59"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu6 -->
<g id="edge132" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1883.71,-3535.95C1857.46,-3525.8 1828.13,-3514.45 1800.27,-3503.67"/>
<polygon fill="black" stroke="black" points="1801.47,-3500.38 1790.88,-3500.04 1798.95,-3506.91 1801.47,-3500.38"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu7 -->
<g id="edge133" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1957.8,-3535.8C1955.02,-3527.57 1951.98,-3518.57 1948.99,-3509.72"/>
<polygon fill="black" stroke="black" points="1952.3,-3508.58 1945.78,-3500.23 1945.66,-3510.82 1952.3,-3508.58"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu8 -->
<g id="edge134" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2031.99,-3535.95C2050.65,-3526.18 2071.41,-3515.3 2091.29,-3504.88"/>
<polygon fill="black" stroke="black" points="2093.12,-3507.88 2100.35,-3500.13 2089.87,-3501.68 2093.12,-3507.88"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu9 -->
<g id="edge135" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2095.52,-3546.15C2155.12,-3534.56 2227.25,-3519.33 2300.07,-3500.13"/>
<polygon fill="black" stroke="black" points="2301.12,-3503.47 2309.88,-3497.52 2299.32,-3496.7 2301.12,-3503.47"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu10 -->
<g id="edge136" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu10</title>
<path fill="none" stroke="black" d="M2095.65,-3561.12C2211.16,-3552.31 2386.35,-3534.72 2545.96,-3500.06"/>
<polygon fill="black" stroke="black" points="2546.95,-3503.42 2555.97,-3497.86 2545.45,-3496.59 2546.95,-3503.42"/>
</g>
<!-- layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu11 -->
<g id="edge137" class="edge">
<title>layer1_moe_norm_gpu15&#45;&gt;layer2_qkv_gpu11</title>
<path fill="none" stroke="black" d="M2095.59,-3567.53C2256.32,-3563.66 2541.81,-3549.9 2791.99,-3500.02"/>
<polygon fill="black" stroke="black" points="2792.89,-3503.41 2802,-3498 2791.5,-3496.54 2792.89,-3503.41"/>
</g>
<!-- layer2_attn_gpu0 -->
<g id="node69" class="node">
<title>layer2_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="246.5,-3380.95 3.5,-3380.95 3.5,-3312.95 246.5,-3312.95 246.5,-3380.95"/>
<text text-anchor="middle" x="125" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="125" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="125" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="125" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_qkv_gpu0&#45;&gt;layer2_attn_gpu0 -->
<g id="edge138" class="edge">
<title>layer2_qkv_gpu0&#45;&gt;layer2_attn_gpu0</title>
<path fill="none" stroke="black" d="M178.35,-3416.68C171.41,-3407.74 164.06,-3398.27 157.1,-3389.31"/>
<polygon fill="black" stroke="black" points="159.75,-3387.01 150.85,-3381.25 154.22,-3391.3 159.75,-3387.01"/>
</g>
<!-- layer2_attn_norm_gpu0 -->
<g id="node70" class="node">
<title>layer2_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="245,-3276.95 1,-3276.95 1,-3208.95 245,-3208.95 245,-3276.95"/>
<text text-anchor="middle" x="123" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="123" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="123" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="123" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_gpu0&#45;&gt;layer2_attn_norm_gpu0 -->
<g id="edge139" class="edge">
<title>layer2_attn_gpu0&#45;&gt;layer2_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M124.35,-3312.84C124.19,-3304.73 124.02,-3295.94 123.85,-3287.43"/>
<polygon fill="black" stroke="black" points="127.35,-3287.18 123.65,-3277.25 120.35,-3287.32 127.35,-3287.18"/>
</g>
<!-- layer2_attn_aggregate -->
<g id="node104" class="node">
<title>layer2_attn_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="1564,-3172.95 1341,-3104.95 1564,-3036.95 1787,-3104.95 1564,-3172.95"/>
<text text-anchor="middle" x="1564" y="-3123.75" font-family="Times,serif" font-size="14.00">L2_Attention_Aggregate</text>
<text text-anchor="middle" x="1564" y="-3108.75" font-family="Times,serif" font-size="14.00">Input: 12×[1024,2048,4096]</text>
<text text-anchor="middle" x="1564" y="-3093.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1564" y="-3078.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce across GPUs 0&#45;11</text>
</g>
<!-- layer2_attn_norm_gpu0&#45;&gt;layer2_attn_aggregate -->
<g id="edge140" class="edge">
<title>layer2_attn_norm_gpu0&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M245.24,-3210.47C248.18,-3209.93 251.11,-3209.43 254,-3208.95 637.63,-3146.01 1091,-3121.23 1351.27,-3111.69"/>
<polygon fill="black" stroke="black" points="1351.73,-3115.17 1361.6,-3111.31 1351.48,-3108.18 1351.73,-3115.17"/>
</g>
<!-- layer2_attn_gpu1 -->
<g id="node72" class="node">
<title>layer2_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="508.5,-3380.95 265.5,-3380.95 265.5,-3312.95 508.5,-3312.95 508.5,-3380.95"/>
<text text-anchor="middle" x="387" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="387" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="387" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="387" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_qkv_gpu1&#45;&gt;layer2_attn_gpu1 -->
<g id="edge141" class="edge">
<title>layer2_qkv_gpu1&#45;&gt;layer2_attn_gpu1</title>
<path fill="none" stroke="black" d="M430.31,-3416.68C424.79,-3407.92 418.95,-3398.66 413.41,-3389.86"/>
<polygon fill="black" stroke="black" points="416.28,-3387.85 407.98,-3381.25 410.35,-3391.58 416.28,-3387.85"/>
</g>
<!-- layer2_attn_norm_gpu1 -->
<g id="node73" class="node">
<title>layer2_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="507,-3276.95 263,-3276.95 263,-3208.95 507,-3208.95 507,-3276.95"/>
<text text-anchor="middle" x="385" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="385" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="385" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="385" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_gpu1&#45;&gt;layer2_attn_norm_gpu1 -->
<g id="edge142" class="edge">
<title>layer2_attn_gpu1&#45;&gt;layer2_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M386.35,-3312.84C386.19,-3304.73 386.02,-3295.94 385.85,-3287.43"/>
<polygon fill="black" stroke="black" points="389.35,-3287.18 385.65,-3277.25 382.35,-3287.32 389.35,-3287.18"/>
</g>
<!-- layer2_attn_norm_gpu1&#45;&gt;layer2_attn_aggregate -->
<g id="edge143" class="edge">
<title>layer2_attn_norm_gpu1&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M507.25,-3210.55C510.19,-3209.99 513.11,-3209.46 516,-3208.95 809.95,-3157.78 1155.03,-3129.99 1366.59,-3116.57"/>
<polygon fill="black" stroke="black" points="1367.11,-3120.04 1376.87,-3115.92 1366.67,-3113.06 1367.11,-3120.04"/>
</g>
<!-- layer2_attn_gpu2 -->
<g id="node75" class="node">
<title>layer2_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="770.5,-3380.95 527.5,-3380.95 527.5,-3312.95 770.5,-3312.95 770.5,-3380.95"/>
<text text-anchor="middle" x="649" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="649" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="649" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="649" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_qkv_gpu2&#45;&gt;layer2_attn_gpu2 -->
<g id="edge144" class="edge">
<title>layer2_qkv_gpu2&#45;&gt;layer2_attn_gpu2</title>
<path fill="none" stroke="black" d="M682.26,-3416.68C678.11,-3408.11 673.73,-3399.04 669.55,-3390.41"/>
<polygon fill="black" stroke="black" points="672.62,-3388.73 665.12,-3381.25 666.32,-3391.78 672.62,-3388.73"/>
</g>
<!-- layer2_attn_norm_gpu2 -->
<g id="node76" class="node">
<title>layer2_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="769,-3276.95 525,-3276.95 525,-3208.95 769,-3208.95 769,-3276.95"/>
<text text-anchor="middle" x="647" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="647" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="647" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="647" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_gpu2&#45;&gt;layer2_attn_norm_gpu2 -->
<g id="edge145" class="edge">
<title>layer2_attn_gpu2&#45;&gt;layer2_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M648.35,-3312.84C648.19,-3304.73 648.02,-3295.94 647.85,-3287.43"/>
<polygon fill="black" stroke="black" points="651.35,-3287.18 647.65,-3277.25 644.35,-3287.32 651.35,-3287.18"/>
</g>
<!-- layer2_attn_norm_gpu2&#45;&gt;layer2_attn_aggregate -->
<g id="edge146" class="edge">
<title>layer2_attn_norm_gpu2&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M769.28,-3210.67C772.21,-3210.08 775.12,-3209.5 778,-3208.95 985.52,-3169.36 1226.78,-3140.21 1386.7,-3123.22"/>
<polygon fill="black" stroke="black" points="1387.54,-3126.65 1397.12,-3122.12 1386.8,-3119.69 1387.54,-3126.65"/>
</g>
<!-- layer2_attn_gpu3 -->
<g id="node78" class="node">
<title>layer2_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1031.5,-3380.95 788.5,-3380.95 788.5,-3312.95 1031.5,-3312.95 1031.5,-3380.95"/>
<text text-anchor="middle" x="910" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="910" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="910" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="910" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_qkv_gpu3&#45;&gt;layer2_attn_gpu3 -->
<g id="edge147" class="edge">
<title>layer2_qkv_gpu3&#45;&gt;layer2_attn_gpu3</title>
<path fill="none" stroke="black" d="M933.85,-3416.68C930.94,-3408.29 927.86,-3399.43 924.92,-3390.96"/>
<polygon fill="black" stroke="black" points="928.14,-3389.55 921.56,-3381.25 921.53,-3391.85 928.14,-3389.55"/>
</g>
<!-- layer2_attn_norm_gpu3 -->
<g id="node79" class="node">
<title>layer2_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1031,-3276.95 787,-3276.95 787,-3208.95 1031,-3208.95 1031,-3276.95"/>
<text text-anchor="middle" x="909" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="909" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="909" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="909" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_gpu3&#45;&gt;layer2_attn_norm_gpu3 -->
<g id="edge148" class="edge">
<title>layer2_attn_gpu3&#45;&gt;layer2_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M909.68,-3312.84C909.6,-3304.73 909.51,-3295.94 909.43,-3287.43"/>
<polygon fill="black" stroke="black" points="912.92,-3287.22 909.33,-3277.25 905.92,-3287.29 912.92,-3287.22"/>
</g>
<!-- layer2_attn_norm_gpu3&#45;&gt;layer2_attn_aggregate -->
<g id="edge149" class="edge">
<title>layer2_attn_norm_gpu3&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M1031.33,-3210.92C1034.25,-3210.25 1037.14,-3209.59 1040,-3208.95 1166.42,-3180.63 1310.96,-3152.53 1416.17,-3132.86"/>
<polygon fill="black" stroke="black" points="1417.04,-3136.26 1426.23,-3130.98 1415.75,-3129.38 1417.04,-3136.26"/>
</g>
<!-- layer2_attn_gpu4 -->
<g id="node81" class="node">
<title>layer2_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1293.5,-3380.95 1050.5,-3380.95 1050.5,-3312.95 1293.5,-3312.95 1293.5,-3380.95"/>
<text text-anchor="middle" x="1172" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="1172" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1172" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1172" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_qkv_gpu4&#45;&gt;layer2_attn_gpu4 -->
<g id="edge150" class="edge">
<title>layer2_qkv_gpu4&#45;&gt;layer2_attn_gpu4</title>
<path fill="none" stroke="black" d="M1185.81,-3416.68C1184.14,-3408.38 1182.38,-3399.62 1180.7,-3391.24"/>
<polygon fill="black" stroke="black" points="1184.09,-3390.37 1178.69,-3381.25 1177.23,-3391.75 1184.09,-3390.37"/>
</g>
<!-- layer2_attn_norm_gpu4 -->
<g id="node82" class="node">
<title>layer2_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1293,-3276.95 1049,-3276.95 1049,-3208.95 1293,-3208.95 1293,-3276.95"/>
<text text-anchor="middle" x="1171" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="1171" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1171" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1171" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_attn_gpu4&#45;&gt;layer2_attn_norm_gpu4 -->
<g id="edge151" class="edge">
<title>layer2_attn_gpu4&#45;&gt;layer2_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M1171.68,-3312.84C1171.6,-3304.73 1171.51,-3295.94 1171.43,-3287.43"/>
<polygon fill="black" stroke="black" points="1174.92,-3287.22 1171.33,-3277.25 1167.92,-3287.29 1174.92,-3287.22"/>
</g>
<!-- layer2_attn_norm_gpu4&#45;&gt;layer2_attn_aggregate -->
<g id="edge152" class="edge">
<title>layer2_attn_norm_gpu4&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M1266.39,-3208.94C1322.12,-3189.66 1392.78,-3165.2 1451.26,-3144.97"/>
<polygon fill="black" stroke="black" points="1452.61,-3148.21 1460.91,-3141.63 1450.32,-3141.59 1452.61,-3148.21"/>
</g>
<!-- layer2_attn_gpu5 -->
<g id="node84" class="node">
<title>layer2_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1554.5,-3380.95 1311.5,-3380.95 1311.5,-3312.95 1554.5,-3312.95 1554.5,-3380.95"/>
<text text-anchor="middle" x="1433" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="1433" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1433" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1433" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_qkv_gpu5&#45;&gt;layer2_attn_gpu5 -->
<g id="edge153" class="edge">
<title>layer2_qkv_gpu5&#45;&gt;layer2_attn_gpu5</title>
<path fill="none" stroke="black" d="M1437.39,-3416.68C1436.86,-3408.38 1436.3,-3399.62 1435.77,-3391.24"/>
<polygon fill="black" stroke="black" points="1439.26,-3391.01 1435.13,-3381.25 1432.27,-3391.46 1439.26,-3391.01"/>
</g>
<!-- layer2_attn_norm_gpu5 -->
<g id="node85" class="node">
<title>layer2_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1555,-3276.95 1311,-3276.95 1311,-3208.95 1555,-3208.95 1555,-3276.95"/>
<text text-anchor="middle" x="1433" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="1433" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1433" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1433" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_attn_gpu5&#45;&gt;layer2_attn_norm_gpu5 -->
<g id="edge154" class="edge">
<title>layer2_attn_gpu5&#45;&gt;layer2_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M1433,-3312.84C1433,-3304.73 1433,-3295.94 1433,-3287.43"/>
<polygon fill="black" stroke="black" points="1436.5,-3287.25 1433,-3277.25 1429.5,-3287.25 1436.5,-3287.25"/>
</g>
<!-- layer2_attn_norm_gpu5&#45;&gt;layer2_attn_aggregate -->
<g id="edge155" class="edge">
<title>layer2_attn_norm_gpu5&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M1465.05,-3208.68C1477.67,-3195.57 1492.57,-3180.11 1506.92,-3165.21"/>
<polygon fill="black" stroke="black" points="1509.49,-3167.59 1513.91,-3157.96 1504.45,-3162.73 1509.49,-3167.59"/>
</g>
<!-- layer2_attn_gpu6 -->
<g id="node87" class="node">
<title>layer2_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1815.5,-3380.95 1572.5,-3380.95 1572.5,-3312.95 1815.5,-3312.95 1815.5,-3380.95"/>
<text text-anchor="middle" x="1694" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="1694" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1694" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1694" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_qkv_gpu6&#45;&gt;layer2_attn_gpu6 -->
<g id="edge156" class="edge">
<title>layer2_qkv_gpu6&#45;&gt;layer2_attn_gpu6</title>
<path fill="none" stroke="black" d="M1688.98,-3416.68C1689.59,-3408.38 1690.23,-3399.62 1690.84,-3391.24"/>
<polygon fill="black" stroke="black" points="1694.33,-3391.48 1691.57,-3381.25 1687.35,-3390.97 1694.33,-3391.48"/>
</g>
<!-- layer2_attn_norm_gpu6 -->
<g id="node88" class="node">
<title>layer2_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1817,-3276.95 1573,-3276.95 1573,-3208.95 1817,-3208.95 1817,-3276.95"/>
<text text-anchor="middle" x="1695" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="1695" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1695" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1695" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_attn_gpu6&#45;&gt;layer2_attn_norm_gpu6 -->
<g id="edge157" class="edge">
<title>layer2_attn_gpu6&#45;&gt;layer2_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M1694.32,-3312.84C1694.4,-3304.73 1694.49,-3295.94 1694.57,-3287.43"/>
<polygon fill="black" stroke="black" points="1698.08,-3287.29 1694.67,-3277.25 1691.08,-3287.22 1698.08,-3287.29"/>
</g>
<!-- layer2_attn_norm_gpu6&#45;&gt;layer2_attn_aggregate -->
<g id="edge158" class="edge">
<title>layer2_attn_norm_gpu6&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M1662.95,-3208.68C1650.33,-3195.57 1635.43,-3180.11 1621.08,-3165.21"/>
<polygon fill="black" stroke="black" points="1623.55,-3162.73 1614.09,-3157.96 1618.51,-3167.59 1623.55,-3162.73"/>
</g>
<!-- layer2_attn_gpu7 -->
<g id="node90" class="node">
<title>layer2_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2077.5,-3380.95 1834.5,-3380.95 1834.5,-3312.95 2077.5,-3312.95 2077.5,-3380.95"/>
<text text-anchor="middle" x="1956" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="1956" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1956" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1956" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_qkv_gpu7&#45;&gt;layer2_attn_gpu7 -->
<g id="edge159" class="edge">
<title>layer2_qkv_gpu7&#45;&gt;layer2_attn_gpu7</title>
<path fill="none" stroke="black" d="M1940.94,-3416.68C1942.76,-3408.38 1944.68,-3399.62 1946.51,-3391.24"/>
<polygon fill="black" stroke="black" points="1949.98,-3391.77 1948.7,-3381.25 1943.14,-3390.27 1949.98,-3391.77"/>
</g>
<!-- layer2_attn_norm_gpu7 -->
<g id="node91" class="node">
<title>layer2_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2079,-3276.95 1835,-3276.95 1835,-3208.95 2079,-3208.95 2079,-3276.95"/>
<text text-anchor="middle" x="1957" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="1957" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1957" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1957" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_attn_gpu7&#45;&gt;layer2_attn_norm_gpu7 -->
<g id="edge160" class="edge">
<title>layer2_attn_gpu7&#45;&gt;layer2_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M1956.32,-3312.84C1956.4,-3304.73 1956.49,-3295.94 1956.57,-3287.43"/>
<polygon fill="black" stroke="black" points="1960.08,-3287.29 1956.67,-3277.25 1953.08,-3287.22 1960.08,-3287.29"/>
</g>
<!-- layer2_attn_norm_gpu7&#45;&gt;layer2_attn_aggregate -->
<g id="edge161" class="edge">
<title>layer2_attn_norm_gpu7&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M1861.61,-3208.94C1805.88,-3189.66 1735.22,-3165.2 1676.74,-3144.97"/>
<polygon fill="black" stroke="black" points="1677.68,-3141.59 1667.09,-3141.63 1675.39,-3148.21 1677.68,-3141.59"/>
</g>
<!-- layer2_attn_gpu8 -->
<g id="node93" class="node">
<title>layer2_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2339.5,-3380.95 2096.5,-3380.95 2096.5,-3312.95 2339.5,-3312.95 2339.5,-3380.95"/>
<text text-anchor="middle" x="2218" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU8</text>
<text text-anchor="middle" x="2218" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2218" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2218" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_qkv_gpu8&#45;&gt;layer2_attn_gpu8 -->
<g id="edge162" class="edge">
<title>layer2_qkv_gpu8&#45;&gt;layer2_attn_gpu8</title>
<path fill="none" stroke="black" d="M2192.89,-3416.68C2195.99,-3408.2 2199.27,-3399.24 2202.39,-3390.68"/>
<polygon fill="black" stroke="black" points="2205.69,-3391.85 2205.84,-3381.25 2199.12,-3389.44 2205.69,-3391.85"/>
</g>
<!-- layer2_attn_norm_gpu8 -->
<g id="node94" class="node">
<title>layer2_attn_norm_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2341,-3276.95 2097,-3276.95 2097,-3208.95 2341,-3208.95 2341,-3276.95"/>
<text text-anchor="middle" x="2219" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="2219" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2219" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2219" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_attn_gpu8&#45;&gt;layer2_attn_norm_gpu8 -->
<g id="edge163" class="edge">
<title>layer2_attn_gpu8&#45;&gt;layer2_attn_norm_gpu8</title>
<path fill="none" stroke="black" d="M2218.32,-3312.84C2218.4,-3304.73 2218.49,-3295.94 2218.57,-3287.43"/>
<polygon fill="black" stroke="black" points="2222.08,-3287.29 2218.67,-3277.25 2215.08,-3287.22 2222.08,-3287.29"/>
</g>
<!-- layer2_attn_norm_gpu8&#45;&gt;layer2_attn_aggregate -->
<g id="edge164" class="edge">
<title>layer2_attn_norm_gpu8&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M2096.67,-3210.92C2093.75,-3210.25 2090.86,-3209.59 2088,-3208.95 1961.58,-3180.63 1817.04,-3152.53 1711.83,-3132.86"/>
<polygon fill="black" stroke="black" points="1712.25,-3129.38 1701.77,-3130.98 1710.96,-3136.26 1712.25,-3129.38"/>
</g>
<!-- layer2_attn_gpu9 -->
<g id="node96" class="node">
<title>layer2_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2601.5,-3380.95 2358.5,-3380.95 2358.5,-3312.95 2601.5,-3312.95 2601.5,-3380.95"/>
<text text-anchor="middle" x="2480" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU9</text>
<text text-anchor="middle" x="2480" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2480" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2480" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_qkv_gpu9&#45;&gt;layer2_attn_gpu9 -->
<g id="edge165" class="edge">
<title>layer2_qkv_gpu9&#45;&gt;layer2_attn_gpu9</title>
<path fill="none" stroke="black" d="M2444.85,-3416.68C2449.24,-3408.11 2453.87,-3399.04 2458.29,-3390.41"/>
<polygon fill="black" stroke="black" points="2461.53,-3391.75 2462.97,-3381.25 2455.3,-3388.56 2461.53,-3391.75"/>
</g>
<!-- layer2_attn_norm_gpu9 -->
<g id="node97" class="node">
<title>layer2_attn_norm_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2603,-3276.95 2359,-3276.95 2359,-3208.95 2603,-3208.95 2603,-3276.95"/>
<text text-anchor="middle" x="2481" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="2481" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2481" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2481" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_attn_gpu9&#45;&gt;layer2_attn_norm_gpu9 -->
<g id="edge166" class="edge">
<title>layer2_attn_gpu9&#45;&gt;layer2_attn_norm_gpu9</title>
<path fill="none" stroke="black" d="M2480.32,-3312.84C2480.4,-3304.73 2480.49,-3295.94 2480.57,-3287.43"/>
<polygon fill="black" stroke="black" points="2484.08,-3287.29 2480.67,-3277.25 2477.08,-3287.22 2484.08,-3287.29"/>
</g>
<!-- layer2_attn_norm_gpu9&#45;&gt;layer2_attn_aggregate -->
<g id="edge167" class="edge">
<title>layer2_attn_norm_gpu9&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M2358.72,-3210.67C2355.79,-3210.08 2352.88,-3209.5 2350,-3208.95 2142.48,-3169.36 1901.22,-3140.21 1741.3,-3123.22"/>
<polygon fill="black" stroke="black" points="1741.2,-3119.69 1730.88,-3122.12 1740.46,-3126.65 1741.2,-3119.69"/>
</g>
<!-- layer2_attn_gpu10 -->
<g id="node99" class="node">
<title>layer2_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2873,-3380.95 2621,-3380.95 2621,-3312.95 2873,-3312.95 2873,-3380.95"/>
<text text-anchor="middle" x="2747" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU10</text>
<text text-anchor="middle" x="2747" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2747" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2747" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_qkv_gpu10&#45;&gt;layer2_attn_gpu10 -->
<g id="edge168" class="edge">
<title>layer2_qkv_gpu10&#45;&gt;layer2_attn_gpu10</title>
<path fill="none" stroke="black" d="M2698.67,-3416.68C2704.89,-3407.83 2711.48,-3398.46 2717.73,-3389.58"/>
<polygon fill="black" stroke="black" points="2720.69,-3391.45 2723.58,-3381.25 2714.97,-3387.42 2720.69,-3391.45"/>
</g>
<!-- layer2_attn_norm_gpu10 -->
<g id="node100" class="node">
<title>layer2_attn_norm_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2874.5,-3276.95 2621.5,-3276.95 2621.5,-3208.95 2874.5,-3208.95 2874.5,-3276.95"/>
<text text-anchor="middle" x="2748" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="2748" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2748" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2748" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_attn_gpu10&#45;&gt;layer2_attn_norm_gpu10 -->
<g id="edge169" class="edge">
<title>layer2_attn_gpu10&#45;&gt;layer2_attn_norm_gpu10</title>
<path fill="none" stroke="black" d="M2747.32,-3312.84C2747.4,-3304.73 2747.49,-3295.94 2747.57,-3287.43"/>
<polygon fill="black" stroke="black" points="2751.08,-3287.29 2747.67,-3277.25 2744.08,-3287.22 2751.08,-3287.29"/>
</g>
<!-- layer2_attn_norm_gpu10&#45;&gt;layer2_attn_aggregate -->
<g id="edge170" class="edge">
<title>layer2_attn_norm_gpu10&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M2621.43,-3210.63C2618.26,-3210.04 2615.11,-3209.48 2612,-3208.95 2317.39,-3158.99 1971.77,-3130.84 1760.37,-3117.01"/>
<polygon fill="black" stroke="black" points="1760.3,-3113.5 1750.09,-3116.35 1759.84,-3120.49 1760.3,-3113.5"/>
</g>
<!-- layer2_attn_gpu11 -->
<g id="node102" class="node">
<title>layer2_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3144,-3380.95 2892,-3380.95 2892,-3312.95 3144,-3312.95 3144,-3380.95"/>
<text text-anchor="middle" x="3018" y="-3365.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU11</text>
<text text-anchor="middle" x="3018" y="-3350.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="3018" y="-3335.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3018" y="-3320.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_qkv_gpu11&#45;&gt;layer2_attn_gpu11 -->
<g id="edge171" class="edge">
<title>layer2_qkv_gpu11&#45;&gt;layer2_attn_gpu11</title>
<path fill="none" stroke="black" d="M2953.98,-3416.68C2962.48,-3407.56 2971.49,-3397.88 2979.99,-3388.76"/>
<polygon fill="black" stroke="black" points="2982.73,-3390.96 2986.98,-3381.25 2977.6,-3386.18 2982.73,-3390.96"/>
</g>
<!-- layer2_attn_norm_gpu11 -->
<g id="node103" class="node">
<title>layer2_attn_norm_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3145.5,-3276.95 2892.5,-3276.95 2892.5,-3208.95 3145.5,-3208.95 3145.5,-3276.95"/>
<text text-anchor="middle" x="3019" y="-3261.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="3019" y="-3246.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="3019" y="-3231.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3019" y="-3216.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_attn_gpu11&#45;&gt;layer2_attn_norm_gpu11 -->
<g id="edge172" class="edge">
<title>layer2_attn_gpu11&#45;&gt;layer2_attn_norm_gpu11</title>
<path fill="none" stroke="black" d="M3018.32,-3312.84C3018.4,-3304.73 3018.49,-3295.94 3018.57,-3287.43"/>
<polygon fill="black" stroke="black" points="3022.08,-3287.29 3018.67,-3277.25 3015.08,-3287.22 3022.08,-3287.29"/>
</g>
<!-- layer2_attn_norm_gpu11&#45;&gt;layer2_attn_aggregate -->
<g id="edge173" class="edge">
<title>layer2_attn_norm_gpu11&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M2892.45,-3210.54C2889.27,-3209.98 2886.12,-3209.45 2883,-3208.95 2495.2,-3147.17 2037.09,-3121.97 1775.55,-3112.05"/>
<polygon fill="black" stroke="black" points="1775.29,-3108.53 1765.17,-3111.66 1775.03,-3115.53 1775.29,-3108.53"/>
</g>
<!-- layer2_moe_broadcast -->
<g id="node105" class="node">
<title>layer2_moe_broadcast</title>
<polygon fill="yellow" stroke="black" points="1796.47,-3000.95 1426.66,-3000.95 1331.53,-2864.95 1701.34,-2864.95 1796.47,-3000.95"/>
<text text-anchor="middle" x="1564" y="-2951.75" font-family="Times,serif" font-size="14.00">L2_Broadcast_to_MoE</text>
<text text-anchor="middle" x="1564" y="-2936.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1564" y="-2921.75" font-family="Times,serif" font-size="14.00">Output: 4×[1024,2048,4096]</text>
<text text-anchor="middle" x="1564" y="-2906.75" font-family="Times,serif" font-size="14.00">Broadcast to GPUs 12&#45;15</text>
</g>
<!-- layer2_attn_aggregate&#45;&gt;layer2_moe_broadcast -->
<g id="edge174" class="edge">
<title>layer2_attn_aggregate&#45;&gt;layer2_moe_broadcast</title>
<path fill="none" stroke="black" d="M1564,-3036.76C1564,-3028.45 1564,-3019.9 1564,-3011.45"/>
<polygon fill="black" stroke="black" points="1567.5,-3011.21 1564,-3001.21 1560.5,-3011.21 1567.5,-3011.21"/>
</g>
<!-- layer2_gate_gpu12 -->
<g id="node106" class="node">
<title>layer2_gate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="630,-2828.95 386,-2828.95 386,-2745.95 630,-2745.95 630,-2828.95"/>
<text text-anchor="middle" x="508" y="-2813.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU12</text>
<text text-anchor="middle" x="508" y="-2798.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="508" y="-2783.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="508" y="-2768.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="508" y="-2753.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_moe_broadcast&#45;&gt;layer2_gate_gpu12 -->
<g id="edge175" class="edge">
<title>layer2_moe_broadcast&#45;&gt;layer2_gate_gpu12</title>
<path fill="none" stroke="black" d="M1358.83,-2904.07C1146.43,-2875.21 820.92,-2830.98 640.31,-2806.43"/>
<polygon fill="black" stroke="black" points="640.6,-2802.94 630.22,-2805.06 639.66,-2809.88 640.6,-2802.94"/>
</g>
<!-- layer2_gate_gpu13 -->
<g id="node113" class="node">
<title>layer2_gate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1398,-2828.95 1154,-2828.95 1154,-2745.95 1398,-2745.95 1398,-2828.95"/>
<text text-anchor="middle" x="1276" y="-2813.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU13</text>
<text text-anchor="middle" x="1276" y="-2798.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1276" y="-2783.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1276" y="-2768.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="1276" y="-2753.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_moe_broadcast&#45;&gt;layer2_gate_gpu13 -->
<g id="edge185" class="edge">
<title>layer2_moe_broadcast&#45;&gt;layer2_gate_gpu13</title>
<path fill="none" stroke="black" d="M1429.28,-2864.82C1407.95,-2854.2 1386.35,-2843.44 1366.36,-2833.47"/>
<polygon fill="black" stroke="black" points="1367.8,-2830.28 1357.29,-2828.96 1364.68,-2836.55 1367.8,-2830.28"/>
</g>
<!-- layer2_gate_gpu14 -->
<g id="node120" class="node">
<title>layer2_gate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1974,-2828.95 1730,-2828.95 1730,-2745.95 1974,-2745.95 1974,-2828.95"/>
<text text-anchor="middle" x="1852" y="-2813.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU14</text>
<text text-anchor="middle" x="1852" y="-2798.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1852" y="-2783.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1852" y="-2768.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="1852" y="-2753.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_moe_broadcast&#45;&gt;layer2_gate_gpu14 -->
<g id="edge195" class="edge">
<title>layer2_moe_broadcast&#45;&gt;layer2_gate_gpu14</title>
<path fill="none" stroke="black" d="M1698.72,-2864.82C1720.05,-2854.2 1741.65,-2843.44 1761.64,-2833.47"/>
<polygon fill="black" stroke="black" points="1763.32,-2836.55 1770.71,-2828.96 1760.2,-2830.28 1763.32,-2836.55"/>
</g>
<!-- layer2_gate_gpu15 -->
<g id="node127" class="node">
<title>layer2_gate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2742,-2828.95 2498,-2828.95 2498,-2745.95 2742,-2745.95 2742,-2828.95"/>
<text text-anchor="middle" x="2620" y="-2813.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU15</text>
<text text-anchor="middle" x="2620" y="-2798.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2620" y="-2783.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="2620" y="-2768.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="2620" y="-2753.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_moe_broadcast&#45;&gt;layer2_gate_gpu15 -->
<g id="edge205" class="edge">
<title>layer2_moe_broadcast&#45;&gt;layer2_gate_gpu15</title>
<path fill="none" stroke="black" d="M1732.49,-2909.06C1942.3,-2880.55 2296.33,-2832.44 2487.69,-2806.43"/>
<polygon fill="black" stroke="black" points="2488.37,-2809.87 2497.81,-2805.06 2487.43,-2802.94 2488.37,-2809.87"/>
</g>
<!-- layer2_expert12_0 -->
<g id="node107" class="node">
<title>layer2_expert12_0</title>
<polygon fill="lightgreen" stroke="black" points="211,-2709.95 37,-2709.95 37,-2626.95 211,-2626.95 211,-2709.95"/>
<text text-anchor="middle" x="124" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU12</text>
<text text-anchor="middle" x="124" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="124" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="124" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="124" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_0 -->
<g id="edge176" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M385.66,-2757.97C336.66,-2745.59 279.72,-2729.96 220.67,-2710.07"/>
<polygon fill="black" stroke="black" points="221.77,-2706.75 211.18,-2706.84 219.52,-2713.37 221.77,-2706.75"/>
</g>
<!-- layer2_expert12_1 -->
<g id="node108" class="node">
<title>layer2_expert12_1</title>
<polygon fill="lightgreen" stroke="black" points="403,-2709.95 229,-2709.95 229,-2626.95 403,-2626.95 403,-2709.95"/>
<text text-anchor="middle" x="316" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU12</text>
<text text-anchor="middle" x="316" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="316" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="316" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="316" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_1 -->
<g id="edge177" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M441.39,-2745.86C425.15,-2735.97 407.68,-2725.32 391.08,-2715.21"/>
<polygon fill="black" stroke="black" points="392.86,-2712.19 382.5,-2709.97 389.21,-2718.17 392.86,-2712.19"/>
</g>
<!-- layer2_expert12_2 -->
<g id="node109" class="node">
<title>layer2_expert12_2</title>
<polygon fill="lightgreen" stroke="black" points="595,-2709.95 421,-2709.95 421,-2626.95 595,-2626.95 595,-2709.95"/>
<text text-anchor="middle" x="508" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU12</text>
<text text-anchor="middle" x="508" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="508" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="508" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="508" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_2 -->
<g id="edge178" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M508,-2745.86C508,-2737.6 508,-2728.82 508,-2720.26"/>
<polygon fill="black" stroke="black" points="511.5,-2719.97 508,-2709.97 504.5,-2719.97 511.5,-2719.97"/>
</g>
<!-- layer2_expert12_3 -->
<g id="node110" class="node">
<title>layer2_expert12_3</title>
<polygon fill="lightgreen" stroke="black" points="787,-2709.95 613,-2709.95 613,-2626.95 787,-2626.95 787,-2709.95"/>
<text text-anchor="middle" x="700" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU12</text>
<text text-anchor="middle" x="700" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="700" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="700" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="700" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_3 -->
<g id="edge179" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M574.61,-2745.86C590.85,-2735.97 608.32,-2725.32 624.92,-2715.21"/>
<polygon fill="black" stroke="black" points="626.79,-2718.17 633.5,-2709.97 623.14,-2712.19 626.79,-2718.17"/>
</g>
<!-- layer2_moe_aggregate_gpu12 -->
<g id="node111" class="node">
<title>layer2_moe_aggregate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="614,-2590.95 402,-2590.95 402,-2522.95 614,-2522.95 614,-2590.95"/>
<text text-anchor="middle" x="508" y="-2575.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU12</text>
<text text-anchor="middle" x="508" y="-2560.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="508" y="-2545.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="508" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_expert12_0&#45;&gt;layer2_moe_aggregate_gpu12 -->
<g id="edge180" class="edge">
<title>layer2_expert12_0&#45;&gt;layer2_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M211.15,-2629.97C214.12,-2628.92 217.08,-2627.91 220,-2626.95 275.76,-2608.65 339.05,-2592.95 392.08,-2581.17"/>
<polygon fill="black" stroke="black" points="392.84,-2584.59 401.85,-2579.02 391.33,-2577.75 392.84,-2584.59"/>
</g>
<!-- layer2_expert12_1&#45;&gt;layer2_moe_aggregate_gpu12 -->
<g id="edge181" class="edge">
<title>layer2_expert12_1&#45;&gt;layer2_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M387.22,-2626.84C404.85,-2616.78 423.68,-2606.04 441.1,-2596.11"/>
<polygon fill="black" stroke="black" points="443.11,-2598.99 450.06,-2591 439.64,-2592.91 443.11,-2598.99"/>
</g>
<!-- layer2_expert12_2&#45;&gt;layer2_moe_aggregate_gpu12 -->
<g id="edge182" class="edge">
<title>layer2_expert12_2&#45;&gt;layer2_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M508,-2626.68C508,-2618.47 508,-2609.81 508,-2601.51"/>
<polygon fill="black" stroke="black" points="511.5,-2601.25 508,-2591.25 504.5,-2601.25 511.5,-2601.25"/>
</g>
<!-- layer2_expert12_3&#45;&gt;layer2_moe_aggregate_gpu12 -->
<g id="edge183" class="edge">
<title>layer2_expert12_3&#45;&gt;layer2_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M628.78,-2626.84C611.15,-2616.78 592.32,-2606.04 574.9,-2596.11"/>
<polygon fill="black" stroke="black" points="576.36,-2592.91 565.94,-2591 572.89,-2598.99 576.36,-2592.91"/>
</g>
<!-- layer2_moe_norm_gpu12 -->
<g id="node112" class="node">
<title>layer2_moe_norm_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="1284.5,-2486.95 1031.5,-2486.95 1031.5,-2418.95 1284.5,-2418.95 1284.5,-2486.95"/>
<text text-anchor="middle" x="1158" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="1158" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1158" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1158" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_moe_aggregate_gpu12&#45;&gt;layer2_moe_norm_gpu12 -->
<g id="edge184" class="edge">
<title>layer2_moe_aggregate_gpu12&#45;&gt;layer2_moe_norm_gpu12</title>
<path fill="none" stroke="black" d="M614.24,-2539.28C725.31,-2521.85 900.01,-2494.44 1021.3,-2475.4"/>
<polygon fill="black" stroke="black" points="1022.06,-2478.83 1031.4,-2473.82 1020.98,-2471.91 1022.06,-2478.83"/>
</g>
<!-- layer3_qkv_gpu0 -->
<g id="node134" class="node">
<title>layer3_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="326,-2382.95 98,-2382.95 98,-2299.95 326,-2299.95 326,-2382.95"/>
<text text-anchor="middle" x="212" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="212" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="212" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="212" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 0&#45;2</text>
<text text-anchor="middle" x="212" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu0 -->
<g id="edge215" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1031.21,-2450.5C870.61,-2446.61 585.7,-2432.81 335.99,-2383.01"/>
<polygon fill="black" stroke="black" points="336.5,-2379.54 326,-2381 335.11,-2386.41 336.5,-2379.54"/>
</g>
<!-- layer3_qkv_gpu1 -->
<g id="node137" class="node">
<title>layer3_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="572,-2382.95 344,-2382.95 344,-2299.95 572,-2299.95 572,-2382.95"/>
<text text-anchor="middle" x="458" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="458" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="458" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="458" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 3&#45;5</text>
<text text-anchor="middle" x="458" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu1 -->
<g id="edge216" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1031.28,-2444.08C915.97,-2435.24 741.24,-2417.65 582.01,-2383.05"/>
<polygon fill="black" stroke="black" points="582.55,-2379.59 572.03,-2380.86 581.05,-2386.42 582.55,-2379.59"/>
</g>
<!-- layer3_qkv_gpu2 -->
<g id="node140" class="node">
<title>layer3_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="818,-2382.95 590,-2382.95 590,-2299.95 818,-2299.95 818,-2382.95"/>
<text text-anchor="middle" x="704" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="704" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="704" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="704" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 6&#45;8</text>
<text text-anchor="middle" x="704" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu2 -->
<g id="edge217" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1031.47,-2429.05C972.12,-2417.46 900.37,-2402.25 827.89,-2383.11"/>
<polygon fill="black" stroke="black" points="828.68,-2379.7 818.12,-2380.51 826.88,-2386.47 828.68,-2379.7"/>
</g>
<!-- layer3_qkv_gpu3 -->
<g id="node143" class="node">
<title>layer3_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1064,-2382.95 836,-2382.95 836,-2299.95 1064,-2299.95 1064,-2382.95"/>
<text text-anchor="middle" x="950" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="950" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="950" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="950" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 9&#45;11</text>
<text text-anchor="middle" x="950" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu3 -->
<g id="edge218" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1095.31,-2418.95C1076.74,-2409.18 1056.08,-2398.3 1036.29,-2387.88"/>
<polygon fill="black" stroke="black" points="1037.75,-2384.7 1027.28,-2383.13 1034.49,-2390.89 1037.75,-2384.7"/>
</g>
<!-- layer3_qkv_gpu4 -->
<g id="node146" class="node">
<title>layer3_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1310,-2382.95 1082,-2382.95 1082,-2299.95 1310,-2299.95 1310,-2382.95"/>
<text text-anchor="middle" x="1196" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="1196" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1196" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1196" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 12&#45;14</text>
<text text-anchor="middle" x="1196" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu4 -->
<g id="edge219" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1169.5,-2418.8C1172.36,-2410.57 1175.48,-2401.57 1178.55,-2392.72"/>
<polygon fill="black" stroke="black" points="1181.88,-2393.83 1181.85,-2383.23 1175.26,-2391.53 1181.88,-2393.83"/>
</g>
<!-- layer3_qkv_gpu5 -->
<g id="node149" class="node">
<title>layer3_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1556,-2382.95 1328,-2382.95 1328,-2299.95 1556,-2299.95 1556,-2382.95"/>
<text text-anchor="middle" x="1442" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="1442" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1442" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1442" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 15&#45;17</text>
<text text-anchor="middle" x="1442" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu5 -->
<g id="edge220" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1243.59,-2418.95C1269.93,-2408.8 1299.36,-2397.45 1327.33,-2386.67"/>
<polygon fill="black" stroke="black" points="1328.67,-2389.9 1336.75,-2383.04 1326.16,-2383.37 1328.67,-2389.9"/>
</g>
<!-- layer3_qkv_gpu6 -->
<g id="node152" class="node">
<title>layer3_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1802,-2382.95 1574,-2382.95 1574,-2299.95 1802,-2299.95 1802,-2382.95"/>
<text text-anchor="middle" x="1688" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="1688" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1688" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1688" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 18&#45;20</text>
<text text-anchor="middle" x="1688" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu6 -->
<g id="edge221" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1284.74,-2420.55C1287.52,-2420 1290.27,-2419.47 1293,-2418.95 1409.69,-2397.04 1444.31,-2409.44 1564.04,-2383.04"/>
<polygon fill="black" stroke="black" points="1564.97,-2386.42 1573.95,-2380.81 1563.43,-2379.59 1564.97,-2386.42"/>
</g>
<!-- layer3_qkv_gpu7 -->
<g id="node155" class="node">
<title>layer3_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2048,-2382.95 1820,-2382.95 1820,-2299.95 2048,-2299.95 2048,-2382.95"/>
<text text-anchor="middle" x="1934" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="1934" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1934" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1934" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 21&#45;23</text>
<text text-anchor="middle" x="1934" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu7 -->
<g id="edge222" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1284.7,-2420.32C1287.49,-2419.84 1290.26,-2419.38 1293,-2418.95 1517.8,-2383.93 1582.71,-2426.16 1809.79,-2383.04"/>
<polygon fill="black" stroke="black" points="1810.52,-2386.46 1819.67,-2381.13 1809.19,-2379.59 1810.52,-2386.46"/>
</g>
<!-- layer3_qkv_gpu8 -->
<g id="node158" class="node">
<title>layer3_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2294,-2382.95 2066,-2382.95 2066,-2299.95 2294,-2299.95 2294,-2382.95"/>
<text text-anchor="middle" x="2180" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU8</text>
<text text-anchor="middle" x="2180" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2180" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2180" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 24&#45;26</text>
<text text-anchor="middle" x="2180" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu8 -->
<g id="edge223" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu8</title>
<path fill="none" stroke="black" d="M1284.69,-2420.23C1287.48,-2419.78 1290.25,-2419.35 1293,-2418.95 1626.16,-2370.84 1720.87,-2443.24 2055.71,-2383.04"/>
<polygon fill="black" stroke="black" points="2056.48,-2386.45 2065.69,-2381.22 2055.22,-2379.57 2056.48,-2386.45"/>
</g>
<!-- layer3_qkv_gpu9 -->
<g id="node161" class="node">
<title>layer3_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2540,-2382.95 2312,-2382.95 2312,-2299.95 2540,-2299.95 2540,-2382.95"/>
<text text-anchor="middle" x="2426" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU9</text>
<text text-anchor="middle" x="2426" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2426" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2426" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 27&#45;29</text>
<text text-anchor="middle" x="2426" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu9 -->
<g id="edge224" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu9</title>
<path fill="none" stroke="black" d="M1284.69,-2420.19C1287.48,-2419.75 1290.25,-2419.33 1293,-2418.95 1734.66,-2357.76 1859.01,-2460.46 2301.84,-2383"/>
<polygon fill="black" stroke="black" points="2302.46,-2386.45 2311.7,-2381.26 2301.24,-2379.56 2302.46,-2386.45"/>
</g>
<!-- layer3_qkv_gpu10 -->
<g id="node164" class="node">
<title>layer3_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2786,-2382.95 2558,-2382.95 2558,-2299.95 2786,-2299.95 2786,-2382.95"/>
<text text-anchor="middle" x="2672" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU10</text>
<text text-anchor="middle" x="2672" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2672" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2672" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 30&#45;32</text>
<text text-anchor="middle" x="2672" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu10 -->
<g id="edge225" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1284.68,-2420.16C1287.48,-2419.73 1290.25,-2419.32 1293,-2418.95 1566.47,-2382.03 2257.51,-2429.97 2547.55,-2383"/>
<polygon fill="black" stroke="black" points="2548.42,-2386.4 2557.7,-2381.29 2547.26,-2379.5 2548.42,-2386.4"/>
</g>
<!-- layer3_qkv_gpu11 -->
<g id="node167" class="node">
<title>layer3_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3032,-2382.95 2804,-2382.95 2804,-2299.95 3032,-2299.95 3032,-2382.95"/>
<text text-anchor="middle" x="2918" y="-2367.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU11</text>
<text text-anchor="middle" x="2918" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2918" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2918" y="-2322.75" font-family="Times,serif" font-size="14.00">Heads: 33&#45;35</text>
<text text-anchor="middle" x="2918" y="-2307.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu11 -->
<g id="edge226" class="edge">
<title>layer2_moe_norm_gpu12&#45;&gt;layer3_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1284.68,-2420.15C1287.47,-2419.72 1290.25,-2419.32 1293,-2418.95 1620.74,-2375.49 2449.6,-2438.52 2793.67,-2382.98"/>
<polygon fill="black" stroke="black" points="2794.42,-2386.41 2803.7,-2381.31 2793.26,-2379.5 2794.42,-2386.41"/>
</g>
<!-- layer2_expert13_4 -->
<g id="node114" class="node">
<title>layer2_expert13_4</title>
<polygon fill="lightgreen" stroke="black" points="979,-2709.95 805,-2709.95 805,-2626.95 979,-2626.95 979,-2709.95"/>
<text text-anchor="middle" x="892" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU13</text>
<text text-anchor="middle" x="892" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="892" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="892" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="892" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_4 -->
<g id="edge186" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.66,-2757.97C1104.66,-2745.59 1047.72,-2729.96 988.67,-2710.07"/>
<polygon fill="black" stroke="black" points="989.77,-2706.75 979.18,-2706.84 987.52,-2713.37 989.77,-2706.75"/>
</g>
<!-- layer2_expert13_5 -->
<g id="node115" class="node">
<title>layer2_expert13_5</title>
<polygon fill="lightgreen" stroke="black" points="1171,-2709.95 997,-2709.95 997,-2626.95 1171,-2626.95 1171,-2709.95"/>
<text text-anchor="middle" x="1084" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU13</text>
<text text-anchor="middle" x="1084" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1084" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1084" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1084" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_5 -->
<g id="edge187" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1209.39,-2745.86C1193.15,-2735.97 1175.68,-2725.32 1159.08,-2715.21"/>
<polygon fill="black" stroke="black" points="1160.86,-2712.19 1150.5,-2709.97 1157.21,-2718.17 1160.86,-2712.19"/>
</g>
<!-- layer2_expert13_6 -->
<g id="node116" class="node">
<title>layer2_expert13_6</title>
<polygon fill="lightgreen" stroke="black" points="1363,-2709.95 1189,-2709.95 1189,-2626.95 1363,-2626.95 1363,-2709.95"/>
<text text-anchor="middle" x="1276" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU13</text>
<text text-anchor="middle" x="1276" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1276" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1276" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1276" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_6 -->
<g id="edge188" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1276,-2745.86C1276,-2737.6 1276,-2728.82 1276,-2720.26"/>
<polygon fill="black" stroke="black" points="1279.5,-2719.97 1276,-2709.97 1272.5,-2719.97 1279.5,-2719.97"/>
</g>
<!-- layer2_expert13_7 -->
<g id="node117" class="node">
<title>layer2_expert13_7</title>
<polygon fill="lightgreen" stroke="black" points="1555,-2709.95 1381,-2709.95 1381,-2626.95 1555,-2626.95 1555,-2709.95"/>
<text text-anchor="middle" x="1468" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU13</text>
<text text-anchor="middle" x="1468" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1468" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1468" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1468" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_7 -->
<g id="edge189" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1342.61,-2745.86C1358.85,-2735.97 1376.32,-2725.32 1392.92,-2715.21"/>
<polygon fill="black" stroke="black" points="1394.79,-2718.17 1401.5,-2709.97 1391.14,-2712.19 1394.79,-2718.17"/>
</g>
<!-- layer2_moe_aggregate_gpu13 -->
<g id="node118" class="node">
<title>layer2_moe_aggregate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1382,-2590.95 1170,-2590.95 1170,-2522.95 1382,-2522.95 1382,-2590.95"/>
<text text-anchor="middle" x="1276" y="-2575.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU13</text>
<text text-anchor="middle" x="1276" y="-2560.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="1276" y="-2545.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1276" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_expert13_4&#45;&gt;layer2_moe_aggregate_gpu13 -->
<g id="edge190" class="edge">
<title>layer2_expert13_4&#45;&gt;layer2_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M979.15,-2629.97C982.12,-2628.92 985.08,-2627.91 988,-2626.95 1043.76,-2608.65 1107.05,-2592.95 1160.08,-2581.17"/>
<polygon fill="black" stroke="black" points="1160.84,-2584.59 1169.85,-2579.02 1159.33,-2577.75 1160.84,-2584.59"/>
</g>
<!-- layer2_expert13_5&#45;&gt;layer2_moe_aggregate_gpu13 -->
<g id="edge191" class="edge">
<title>layer2_expert13_5&#45;&gt;layer2_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1155.22,-2626.84C1172.85,-2616.78 1191.68,-2606.04 1209.1,-2596.11"/>
<polygon fill="black" stroke="black" points="1211.11,-2598.99 1218.06,-2591 1207.64,-2592.91 1211.11,-2598.99"/>
</g>
<!-- layer2_expert13_6&#45;&gt;layer2_moe_aggregate_gpu13 -->
<g id="edge192" class="edge">
<title>layer2_expert13_6&#45;&gt;layer2_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1276,-2626.68C1276,-2618.47 1276,-2609.81 1276,-2601.51"/>
<polygon fill="black" stroke="black" points="1279.5,-2601.25 1276,-2591.25 1272.5,-2601.25 1279.5,-2601.25"/>
</g>
<!-- layer2_expert13_7&#45;&gt;layer2_moe_aggregate_gpu13 -->
<g id="edge193" class="edge">
<title>layer2_expert13_7&#45;&gt;layer2_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1396.78,-2626.84C1379.15,-2616.78 1360.32,-2606.04 1342.9,-2596.11"/>
<polygon fill="black" stroke="black" points="1344.36,-2592.91 1333.94,-2591 1340.89,-2598.99 1344.36,-2592.91"/>
</g>
<!-- layer2_moe_norm_gpu13 -->
<g id="node119" class="node">
<title>layer2_moe_norm_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1555.5,-2486.95 1302.5,-2486.95 1302.5,-2418.95 1555.5,-2418.95 1555.5,-2486.95"/>
<text text-anchor="middle" x="1429" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="1429" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1429" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1429" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_moe_aggregate_gpu13&#45;&gt;layer2_moe_norm_gpu13 -->
<g id="edge194" class="edge">
<title>layer2_moe_aggregate_gpu13&#45;&gt;layer2_moe_norm_gpu13</title>
<path fill="none" stroke="black" d="M1325.67,-2522.84C1340.04,-2513.26 1355.86,-2502.71 1370.7,-2492.82"/>
<polygon fill="black" stroke="black" points="1372.93,-2495.54 1379.31,-2487.08 1369.05,-2489.71 1372.93,-2495.54"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu0 -->
<g id="edge227" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1302.47,-2420.37C1299.29,-2419.86 1296.13,-2419.39 1293,-2418.95 874.26,-2360.88 756.2,-2456.8 336.28,-2383.03"/>
<polygon fill="black" stroke="black" points="336.76,-2379.56 326.31,-2381.25 335.54,-2386.45 336.76,-2379.56"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu1 -->
<g id="edge228" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1302.47,-2420.43C1299.28,-2419.9 1296.13,-2419.41 1293,-2418.95 982.81,-2373.89 894.38,-2439.58 582.55,-2383.09"/>
<polygon fill="black" stroke="black" points="582.78,-2379.57 572.31,-2381.2 581.52,-2386.45 582.78,-2379.57"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu2 -->
<g id="edge229" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1302.45,-2420.54C1299.27,-2419.98 1296.12,-2419.45 1293,-2418.95 1091.05,-2386.87 1032.51,-2422.58 828.18,-2383.04"/>
<polygon fill="black" stroke="black" points="828.82,-2379.6 818.33,-2381.1 827.47,-2386.47 828.82,-2379.6"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu3 -->
<g id="edge230" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1302.38,-2420.9C1299.23,-2420.23 1296.1,-2419.58 1293,-2418.95 1199.03,-2399.89 1171.03,-2406.08 1074,-2383.08"/>
<polygon fill="black" stroke="black" points="1074.62,-2379.63 1064.07,-2380.68 1072.97,-2386.43 1074.62,-2379.63"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu4 -->
<g id="edge231" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1358.78,-2418.95C1337.7,-2409.04 1314.2,-2398 1291.77,-2387.46"/>
<polygon fill="black" stroke="black" points="1293.1,-2384.22 1282.56,-2383.13 1290.13,-2390.56 1293.1,-2384.22"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu5 -->
<g id="edge232" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1432.94,-2418.8C1433.89,-2410.75 1434.94,-2401.95 1435.96,-2393.29"/>
<polygon fill="black" stroke="black" points="1439.46,-2393.57 1437.16,-2383.23 1432.5,-2392.75 1439.46,-2393.57"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu6 -->
<g id="edge233" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1507.06,-2418.95C1530.81,-2408.91 1557.31,-2397.71 1582.54,-2387.04"/>
<polygon fill="black" stroke="black" points="1583.93,-2390.25 1591.78,-2383.13 1581.2,-2383.8 1583.93,-2390.25"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu7 -->
<g id="edge234" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1555.75,-2420.6C1558.53,-2420.03 1561.28,-2419.48 1564,-2418.95 1669.7,-2398.38 1701.19,-2407.8 1809.89,-2383.09"/>
<polygon fill="black" stroke="black" points="1810.99,-2386.42 1819.94,-2380.75 1809.41,-2379.6 1810.99,-2386.42"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu8 -->
<g id="edge235" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu8</title>
<path fill="none" stroke="black" d="M1555.71,-2420.33C1558.49,-2419.85 1561.26,-2419.39 1564,-2418.95 1777.73,-2385.27 1839.62,-2424.41 2055.6,-2383.08"/>
<polygon fill="black" stroke="black" points="2056.52,-2386.47 2065.67,-2381.12 2055.18,-2379.59 2056.52,-2386.47"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu9 -->
<g id="edge236" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu9</title>
<path fill="none" stroke="black" d="M1555.69,-2420.24C1558.48,-2419.78 1561.25,-2419.35 1564,-2418.95 1886.08,-2372.18 1977.8,-2441.47 2301.55,-2383.07"/>
<polygon fill="black" stroke="black" points="2302.48,-2386.45 2311.69,-2381.21 2301.22,-2379.57 2302.48,-2386.45"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu10 -->
<g id="edge237" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1555.69,-2420.19C1558.48,-2419.75 1561.25,-2419.34 1564,-2418.95 1994.61,-2359.09 2115.97,-2458.69 2547.76,-2383.02"/>
<polygon fill="black" stroke="black" points="2548.46,-2386.45 2557.7,-2381.26 2547.24,-2379.56 2548.46,-2386.45"/>
</g>
<!-- layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu11 -->
<g id="edge238" class="edge">
<title>layer2_moe_norm_gpu13&#45;&gt;layer3_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1555.68,-2420.17C1558.48,-2419.73 1561.25,-2419.33 1564,-2418.95 2103.09,-2346.01 2254.05,-2475.93 2793.71,-2383.02"/>
<polygon fill="black" stroke="black" points="2794.45,-2386.45 2803.7,-2381.29 2793.25,-2379.55 2794.45,-2386.45"/>
</g>
<!-- layer2_expert14_8 -->
<g id="node121" class="node">
<title>layer2_expert14_8</title>
<polygon fill="lightgreen" stroke="black" points="1747,-2709.95 1573,-2709.95 1573,-2626.95 1747,-2626.95 1747,-2709.95"/>
<text text-anchor="middle" x="1660" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU14</text>
<text text-anchor="middle" x="1660" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1660" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1660" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1660" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_8 -->
<g id="edge196" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1785.39,-2745.86C1769.15,-2735.97 1751.68,-2725.32 1735.08,-2715.21"/>
<polygon fill="black" stroke="black" points="1736.86,-2712.19 1726.5,-2709.97 1733.21,-2718.17 1736.86,-2712.19"/>
</g>
<!-- layer2_expert14_9 -->
<g id="node122" class="node">
<title>layer2_expert14_9</title>
<polygon fill="lightgreen" stroke="black" points="1939,-2709.95 1765,-2709.95 1765,-2626.95 1939,-2626.95 1939,-2709.95"/>
<text text-anchor="middle" x="1852" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU14</text>
<text text-anchor="middle" x="1852" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1852" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1852" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1852" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_9 -->
<g id="edge197" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1852,-2745.86C1852,-2737.6 1852,-2728.82 1852,-2720.26"/>
<polygon fill="black" stroke="black" points="1855.5,-2719.97 1852,-2709.97 1848.5,-2719.97 1855.5,-2719.97"/>
</g>
<!-- layer2_expert14_10 -->
<g id="node123" class="node">
<title>layer2_expert14_10</title>
<polygon fill="lightgreen" stroke="black" points="2131,-2709.95 1957,-2709.95 1957,-2626.95 2131,-2626.95 2131,-2709.95"/>
<text text-anchor="middle" x="2044" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU14</text>
<text text-anchor="middle" x="2044" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2044" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2044" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2044" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_10 -->
<g id="edge198" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1918.61,-2745.86C1934.85,-2735.97 1952.32,-2725.32 1968.92,-2715.21"/>
<polygon fill="black" stroke="black" points="1970.79,-2718.17 1977.5,-2709.97 1967.14,-2712.19 1970.79,-2718.17"/>
</g>
<!-- layer2_expert14_11 -->
<g id="node124" class="node">
<title>layer2_expert14_11</title>
<polygon fill="lightgreen" stroke="black" points="2323,-2709.95 2149,-2709.95 2149,-2626.95 2323,-2626.95 2323,-2709.95"/>
<text text-anchor="middle" x="2236" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU14</text>
<text text-anchor="middle" x="2236" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2236" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2236" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2236" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_11 -->
<g id="edge199" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1974.34,-2757.97C2023.34,-2745.59 2080.28,-2729.96 2139.33,-2710.07"/>
<polygon fill="black" stroke="black" points="2140.48,-2713.37 2148.82,-2706.84 2138.23,-2706.75 2140.48,-2713.37"/>
</g>
<!-- layer2_moe_aggregate_gpu14 -->
<g id="node125" class="node">
<title>layer2_moe_aggregate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1958,-2590.95 1746,-2590.95 1746,-2522.95 1958,-2522.95 1958,-2590.95"/>
<text text-anchor="middle" x="1852" y="-2575.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU14</text>
<text text-anchor="middle" x="1852" y="-2560.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="1852" y="-2545.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1852" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_expert14_8&#45;&gt;layer2_moe_aggregate_gpu14 -->
<g id="edge200" class="edge">
<title>layer2_expert14_8&#45;&gt;layer2_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1731.22,-2626.84C1748.85,-2616.78 1767.68,-2606.04 1785.1,-2596.11"/>
<polygon fill="black" stroke="black" points="1787.11,-2598.99 1794.06,-2591 1783.64,-2592.91 1787.11,-2598.99"/>
</g>
<!-- layer2_expert14_9&#45;&gt;layer2_moe_aggregate_gpu14 -->
<g id="edge201" class="edge">
<title>layer2_expert14_9&#45;&gt;layer2_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1852,-2626.68C1852,-2618.47 1852,-2609.81 1852,-2601.51"/>
<polygon fill="black" stroke="black" points="1855.5,-2601.25 1852,-2591.25 1848.5,-2601.25 1855.5,-2601.25"/>
</g>
<!-- layer2_expert14_10&#45;&gt;layer2_moe_aggregate_gpu14 -->
<g id="edge202" class="edge">
<title>layer2_expert14_10&#45;&gt;layer2_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1972.78,-2626.84C1955.15,-2616.78 1936.32,-2606.04 1918.9,-2596.11"/>
<polygon fill="black" stroke="black" points="1920.36,-2592.91 1909.94,-2591 1916.89,-2598.99 1920.36,-2592.91"/>
</g>
<!-- layer2_expert14_11&#45;&gt;layer2_moe_aggregate_gpu14 -->
<g id="edge203" class="edge">
<title>layer2_expert14_11&#45;&gt;layer2_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M2148.85,-2629.97C2145.88,-2628.92 2142.92,-2627.91 2140,-2626.95 2084.24,-2608.65 2020.95,-2592.95 1967.92,-2581.17"/>
<polygon fill="black" stroke="black" points="1968.67,-2577.75 1958.15,-2579.02 1967.16,-2584.59 1968.67,-2577.75"/>
</g>
<!-- layer2_moe_norm_gpu14 -->
<g id="node126" class="node">
<title>layer2_moe_norm_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1826.5,-2486.95 1573.5,-2486.95 1573.5,-2418.95 1826.5,-2418.95 1826.5,-2486.95"/>
<text text-anchor="middle" x="1700" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="1700" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1700" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1700" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_moe_aggregate_gpu14&#45;&gt;layer2_moe_norm_gpu14 -->
<g id="edge204" class="edge">
<title>layer2_moe_aggregate_gpu14&#45;&gt;layer2_moe_norm_gpu14</title>
<path fill="none" stroke="black" d="M1802.65,-2522.84C1788.37,-2513.26 1772.66,-2502.71 1757.92,-2492.82"/>
<polygon fill="black" stroke="black" points="1759.62,-2489.74 1749.36,-2487.08 1755.72,-2495.56 1759.62,-2489.74"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu0 -->
<g id="edge239" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1573.48,-2420.34C1570.29,-2419.84 1567.13,-2419.37 1564,-2418.95 1025.72,-2346.57 875.07,-2475.79 336.27,-2383.02"/>
<polygon fill="black" stroke="black" points="336.75,-2379.55 326.3,-2381.29 335.55,-2386.45 336.75,-2379.55"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu1 -->
<g id="edge240" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1573.47,-2420.37C1570.29,-2419.86 1567.13,-2419.39 1564,-2418.95 1134.21,-2359.56 1013.15,-2458.56 582.22,-2383.02"/>
<polygon fill="black" stroke="black" points="582.76,-2379.56 572.3,-2381.26 581.54,-2386.45 582.76,-2379.56"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu2 -->
<g id="edge241" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1573.47,-2420.42C1570.29,-2419.9 1567.13,-2419.4 1564,-2418.95 1242.75,-2372.56 1151.31,-2441.34 828.42,-2383.06"/>
<polygon fill="black" stroke="black" points="828.78,-2379.57 818.31,-2381.21 827.52,-2386.45 828.78,-2379.57"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu3 -->
<g id="edge242" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1573.45,-2420.52C1570.27,-2419.97 1567.12,-2419.44 1564,-2418.95 1351.11,-2385.55 1289.49,-2424.28 1074.36,-2383.07"/>
<polygon fill="black" stroke="black" points="1074.82,-2379.6 1064.33,-2381.11 1073.48,-2386.47 1074.82,-2379.6"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu4 -->
<g id="edge243" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1573.4,-2420.83C1570.24,-2420.18 1567.1,-2419.56 1564,-2418.95 1459.13,-2398.57 1427.93,-2407.68 1320.04,-2383.07"/>
<polygon fill="black" stroke="black" points="1320.59,-2379.61 1310.06,-2380.75 1319.01,-2386.42 1320.59,-2379.61"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu5 -->
<g id="edge244" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1622.24,-2418.95C1598.69,-2408.96 1572.42,-2397.81 1547.38,-2387.18"/>
<polygon fill="black" stroke="black" points="1548.42,-2383.82 1537.85,-2383.13 1545.69,-2390.26 1548.42,-2383.82"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu6 -->
<g id="edge245" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1696.37,-2418.8C1695.48,-2410.75 1694.52,-2401.95 1693.57,-2393.29"/>
<polygon fill="black" stroke="black" points="1697.04,-2392.79 1692.47,-2383.23 1690.08,-2393.55 1697.04,-2392.79"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu7 -->
<g id="edge246" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1770.53,-2418.95C1791.7,-2409.04 1815.29,-2398 1837.82,-2387.46"/>
<polygon fill="black" stroke="black" points="1839.49,-2390.54 1847.07,-2383.13 1836.52,-2384.2 1839.49,-2390.54"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu8 -->
<g id="edge247" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu8</title>
<path fill="none" stroke="black" d="M1826.77,-2420.66C1829.53,-2420.07 1832.28,-2419.51 1835,-2418.95 1929.8,-2399.71 1958.09,-2406.2 2055.92,-2383.1"/>
<polygon fill="black" stroke="black" points="2057.02,-2386.43 2065.93,-2380.69 2055.39,-2379.63 2057.02,-2386.43"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu9 -->
<g id="edge248" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu9</title>
<path fill="none" stroke="black" d="M1826.71,-2420.34C1829.49,-2419.86 1832.26,-2419.39 1835,-2418.95 2037.79,-2386.59 2096.61,-2422.71 2301.78,-2383.05"/>
<polygon fill="black" stroke="black" points="2302.53,-2386.47 2311.67,-2381.1 2301.18,-2379.6 2302.53,-2386.47"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu10 -->
<g id="edge249" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1826.69,-2420.24C1829.48,-2419.79 1832.25,-2419.35 1835,-2418.95 2146.02,-2373.52 2234.74,-2439.71 2547.42,-2383.09"/>
<polygon fill="black" stroke="black" points="2548.48,-2386.45 2557.69,-2381.2 2547.22,-2379.57 2548.48,-2386.45"/>
</g>
<!-- layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu11 -->
<g id="edge250" class="edge">
<title>layer2_moe_norm_gpu14&#45;&gt;layer3_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1826.69,-2420.2C1829.48,-2419.75 1832.25,-2419.34 1835,-2418.95 2254.57,-2360.42 2372.92,-2456.93 2793.7,-2383.03"/>
<polygon fill="black" stroke="black" points="2794.46,-2386.45 2803.69,-2381.25 2793.24,-2379.56 2794.46,-2386.45"/>
</g>
<!-- layer2_expert15_12 -->
<g id="node128" class="node">
<title>layer2_expert15_12</title>
<polygon fill="lightgreen" stroke="black" points="2515,-2709.95 2341,-2709.95 2341,-2626.95 2515,-2626.95 2515,-2709.95"/>
<text text-anchor="middle" x="2428" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU15</text>
<text text-anchor="middle" x="2428" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2428" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2428" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2428" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_12 -->
<g id="edge206" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2553.39,-2745.86C2537.15,-2735.97 2519.68,-2725.32 2503.08,-2715.21"/>
<polygon fill="black" stroke="black" points="2504.86,-2712.19 2494.5,-2709.97 2501.21,-2718.17 2504.86,-2712.19"/>
</g>
<!-- layer2_expert15_13 -->
<g id="node129" class="node">
<title>layer2_expert15_13</title>
<polygon fill="lightgreen" stroke="black" points="2707,-2709.95 2533,-2709.95 2533,-2626.95 2707,-2626.95 2707,-2709.95"/>
<text text-anchor="middle" x="2620" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU15</text>
<text text-anchor="middle" x="2620" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2620" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2620" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2620" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_13 -->
<g id="edge207" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2620,-2745.86C2620,-2737.6 2620,-2728.82 2620,-2720.26"/>
<polygon fill="black" stroke="black" points="2623.5,-2719.97 2620,-2709.97 2616.5,-2719.97 2623.5,-2719.97"/>
</g>
<!-- layer2_expert15_14 -->
<g id="node130" class="node">
<title>layer2_expert15_14</title>
<polygon fill="lightgreen" stroke="black" points="2899,-2709.95 2725,-2709.95 2725,-2626.95 2899,-2626.95 2899,-2709.95"/>
<text text-anchor="middle" x="2812" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU15</text>
<text text-anchor="middle" x="2812" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2812" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2812" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2812" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_14 -->
<g id="edge208" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2686.61,-2745.86C2702.85,-2735.97 2720.32,-2725.32 2736.92,-2715.21"/>
<polygon fill="black" stroke="black" points="2738.79,-2718.17 2745.5,-2709.97 2735.14,-2712.19 2738.79,-2718.17"/>
</g>
<!-- layer2_expert15_15 -->
<g id="node131" class="node">
<title>layer2_expert15_15</title>
<polygon fill="lightgreen" stroke="black" points="3091,-2709.95 2917,-2709.95 2917,-2626.95 3091,-2626.95 3091,-2709.95"/>
<text text-anchor="middle" x="3004" y="-2694.75" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU15</text>
<text text-anchor="middle" x="3004" y="-2679.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3004" y="-2664.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3004" y="-2649.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3004" y="-2634.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_15 -->
<g id="edge209" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2742.34,-2757.97C2791.34,-2745.59 2848.28,-2729.96 2907.33,-2710.07"/>
<polygon fill="black" stroke="black" points="2908.48,-2713.37 2916.82,-2706.84 2906.23,-2706.75 2908.48,-2713.37"/>
</g>
<!-- layer2_moe_aggregate_gpu15 -->
<g id="node132" class="node">
<title>layer2_moe_aggregate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2726,-2590.95 2514,-2590.95 2514,-2522.95 2726,-2522.95 2726,-2590.95"/>
<text text-anchor="middle" x="2620" y="-2575.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU15</text>
<text text-anchor="middle" x="2620" y="-2560.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="2620" y="-2545.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2620" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_expert15_12&#45;&gt;layer2_moe_aggregate_gpu15 -->
<g id="edge210" class="edge">
<title>layer2_expert15_12&#45;&gt;layer2_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2499.22,-2626.84C2516.85,-2616.78 2535.68,-2606.04 2553.1,-2596.11"/>
<polygon fill="black" stroke="black" points="2555.11,-2598.99 2562.06,-2591 2551.64,-2592.91 2555.11,-2598.99"/>
</g>
<!-- layer2_expert15_13&#45;&gt;layer2_moe_aggregate_gpu15 -->
<g id="edge211" class="edge">
<title>layer2_expert15_13&#45;&gt;layer2_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2620,-2626.68C2620,-2618.47 2620,-2609.81 2620,-2601.51"/>
<polygon fill="black" stroke="black" points="2623.5,-2601.25 2620,-2591.25 2616.5,-2601.25 2623.5,-2601.25"/>
</g>
<!-- layer2_expert15_14&#45;&gt;layer2_moe_aggregate_gpu15 -->
<g id="edge212" class="edge">
<title>layer2_expert15_14&#45;&gt;layer2_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2740.78,-2626.84C2723.15,-2616.78 2704.32,-2606.04 2686.9,-2596.11"/>
<polygon fill="black" stroke="black" points="2688.36,-2592.91 2677.94,-2591 2684.89,-2598.99 2688.36,-2592.91"/>
</g>
<!-- layer2_expert15_15&#45;&gt;layer2_moe_aggregate_gpu15 -->
<g id="edge213" class="edge">
<title>layer2_expert15_15&#45;&gt;layer2_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2916.85,-2629.97C2913.88,-2628.92 2910.92,-2627.91 2908,-2626.95 2852.24,-2608.65 2788.95,-2592.95 2735.92,-2581.17"/>
<polygon fill="black" stroke="black" points="2736.67,-2577.75 2726.15,-2579.02 2735.16,-2584.59 2736.67,-2577.75"/>
</g>
<!-- layer2_moe_norm_gpu15 -->
<g id="node133" class="node">
<title>layer2_moe_norm_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2097.5,-2486.95 1844.5,-2486.95 1844.5,-2418.95 2097.5,-2418.95 2097.5,-2486.95"/>
<text text-anchor="middle" x="1971" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="1971" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1971" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1971" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_moe_aggregate_gpu15&#45;&gt;layer2_moe_norm_gpu15 -->
<g id="edge214" class="edge">
<title>layer2_moe_aggregate_gpu15&#45;&gt;layer2_moe_norm_gpu15</title>
<path fill="none" stroke="black" d="M2513.92,-2539.28C2403.11,-2521.87 2228.87,-2494.48 2107.78,-2475.45"/>
<polygon fill="black" stroke="black" points="2108.12,-2471.96 2097.69,-2473.87 2107.03,-2478.88 2108.12,-2471.96"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu0 -->
<g id="edge251" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1844.48,-2420.32C1841.3,-2419.82 1838.13,-2419.37 1835,-2418.95 1507.66,-2375.82 679.94,-2438.46 336.32,-2382.98"/>
<polygon fill="black" stroke="black" points="336.74,-2379.5 326.3,-2381.31 335.58,-2386.41 336.74,-2379.5"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu1 -->
<g id="edge252" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1844.48,-2420.34C1841.29,-2419.84 1838.13,-2419.37 1835,-2418.95 1561.93,-2382.32 872.02,-2429.91 582.43,-2383"/>
<polygon fill="black" stroke="black" points="582.74,-2379.5 572.3,-2381.29 581.58,-2386.4 582.74,-2379.5"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu2 -->
<g id="edge253" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1844.47,-2420.36C1841.29,-2419.86 1838.13,-2419.38 1835,-2418.95 1394.27,-2358.25 1270.16,-2460.27 828.46,-2383.06"/>
<polygon fill="black" stroke="black" points="828.76,-2379.56 818.3,-2381.26 827.54,-2386.45 828.76,-2379.56"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu3 -->
<g id="edge254" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1844.47,-2420.41C1841.29,-2419.89 1838.13,-2419.4 1835,-2418.95 1502.68,-2371.23 1408.24,-2443.11 1074.26,-2383.03"/>
<polygon fill="black" stroke="black" points="1074.78,-2379.57 1064.31,-2381.22 1073.52,-2386.45 1074.78,-2379.57"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu4 -->
<g id="edge255" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1844.45,-2420.51C1841.28,-2419.96 1838.12,-2419.44 1835,-2418.95 1611.04,-2384.22 1546.41,-2426.03 1320.18,-2383.03"/>
<polygon fill="black" stroke="black" points="1320.81,-2379.59 1310.33,-2381.13 1319.48,-2386.46 1320.81,-2379.59"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu5 -->
<g id="edge256" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1844.41,-2420.77C1841.24,-2420.14 1838.1,-2419.54 1835,-2418.95 1719.15,-2397.24 1684.8,-2409.32 1565.9,-2383.02"/>
<polygon fill="black" stroke="black" points="1566.57,-2379.59 1556.05,-2380.8 1565.03,-2386.42 1566.57,-2379.59"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu6 -->
<g id="edge257" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1885.71,-2418.95C1859.46,-2408.8 1830.13,-2397.45 1802.27,-2386.67"/>
<polygon fill="black" stroke="black" points="1803.47,-2383.38 1792.88,-2383.04 1800.95,-2389.91 1803.47,-2383.38"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu7 -->
<g id="edge258" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1959.8,-2418.8C1957.02,-2410.57 1953.98,-2401.57 1950.99,-2392.72"/>
<polygon fill="black" stroke="black" points="1954.3,-2391.58 1947.78,-2383.23 1947.66,-2393.82 1954.3,-2391.58"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu8 -->
<g id="edge259" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2033.99,-2418.95C2052.65,-2409.18 2073.41,-2398.3 2093.29,-2387.88"/>
<polygon fill="black" stroke="black" points="2095.12,-2390.88 2102.35,-2383.13 2091.87,-2384.68 2095.12,-2390.88"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu9 -->
<g id="edge260" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2097.52,-2429.15C2157.12,-2417.56 2229.25,-2402.33 2302.07,-2383.13"/>
<polygon fill="black" stroke="black" points="2303.12,-2386.47 2311.88,-2380.52 2301.32,-2379.7 2303.12,-2386.47"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu10 -->
<g id="edge261" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu10</title>
<path fill="none" stroke="black" d="M2097.65,-2444.12C2213.16,-2435.31 2388.35,-2417.72 2547.96,-2383.06"/>
<polygon fill="black" stroke="black" points="2548.95,-2386.42 2557.97,-2380.86 2547.45,-2379.59 2548.95,-2386.42"/>
</g>
<!-- layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu11 -->
<g id="edge262" class="edge">
<title>layer2_moe_norm_gpu15&#45;&gt;layer3_qkv_gpu11</title>
<path fill="none" stroke="black" d="M2097.59,-2450.53C2258.32,-2446.66 2543.81,-2432.9 2793.99,-2383.02"/>
<polygon fill="black" stroke="black" points="2794.89,-2386.41 2804,-2381 2793.5,-2379.54 2794.89,-2386.41"/>
</g>
<!-- layer3_attn_gpu0 -->
<g id="node135" class="node">
<title>layer3_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="248.5,-2263.95 5.5,-2263.95 5.5,-2195.95 248.5,-2195.95 248.5,-2263.95"/>
<text text-anchor="middle" x="127" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="127" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="127" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="127" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_qkv_gpu0&#45;&gt;layer3_attn_gpu0 -->
<g id="edge263" class="edge">
<title>layer3_qkv_gpu0&#45;&gt;layer3_attn_gpu0</title>
<path fill="none" stroke="black" d="M180.35,-2299.68C173.41,-2290.74 166.06,-2281.27 159.1,-2272.31"/>
<polygon fill="black" stroke="black" points="161.75,-2270.01 152.85,-2264.25 156.22,-2274.3 161.75,-2270.01"/>
</g>
<!-- layer3_attn_norm_gpu0 -->
<g id="node136" class="node">
<title>layer3_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="247,-2159.95 3,-2159.95 3,-2091.95 247,-2091.95 247,-2159.95"/>
<text text-anchor="middle" x="125" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="125" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="125" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="125" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_gpu0&#45;&gt;layer3_attn_norm_gpu0 -->
<g id="edge264" class="edge">
<title>layer3_attn_gpu0&#45;&gt;layer3_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M126.35,-2195.84C126.19,-2187.73 126.02,-2178.94 125.85,-2170.43"/>
<polygon fill="black" stroke="black" points="129.35,-2170.18 125.65,-2160.25 122.35,-2170.32 129.35,-2170.18"/>
</g>
<!-- layer3_attn_aggregate -->
<g id="node170" class="node">
<title>layer3_attn_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="1566,-2055.95 1343,-1987.95 1566,-1919.95 1789,-1987.95 1566,-2055.95"/>
<text text-anchor="middle" x="1566" y="-2006.75" font-family="Times,serif" font-size="14.00">L3_Attention_Aggregate</text>
<text text-anchor="middle" x="1566" y="-1991.75" font-family="Times,serif" font-size="14.00">Input: 12×[1024,2048,4096]</text>
<text text-anchor="middle" x="1566" y="-1976.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1566" y="-1961.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce across GPUs 0&#45;11</text>
</g>
<!-- layer3_attn_norm_gpu0&#45;&gt;layer3_attn_aggregate -->
<g id="edge265" class="edge">
<title>layer3_attn_norm_gpu0&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M247.24,-2093.47C250.18,-2092.93 253.11,-2092.43 256,-2091.95 639.63,-2029.01 1093,-2004.23 1353.27,-1994.69"/>
<polygon fill="black" stroke="black" points="1353.73,-1998.17 1363.6,-1994.31 1353.48,-1991.18 1353.73,-1998.17"/>
</g>
<!-- layer3_attn_gpu1 -->
<g id="node138" class="node">
<title>layer3_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="509.5,-2263.95 266.5,-2263.95 266.5,-2195.95 509.5,-2195.95 509.5,-2263.95"/>
<text text-anchor="middle" x="388" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="388" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="388" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="388" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_qkv_gpu1&#45;&gt;layer3_attn_gpu1 -->
<g id="edge266" class="edge">
<title>layer3_qkv_gpu1&#45;&gt;layer3_attn_gpu1</title>
<path fill="none" stroke="black" d="M431.93,-2299.68C426.34,-2290.92 420.41,-2281.66 414.79,-2272.86"/>
<polygon fill="black" stroke="black" points="417.62,-2270.79 409.29,-2264.25 411.72,-2274.56 417.62,-2270.79"/>
</g>
<!-- layer3_attn_norm_gpu1 -->
<g id="node139" class="node">
<title>layer3_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="509,-2159.95 265,-2159.95 265,-2091.95 509,-2091.95 509,-2159.95"/>
<text text-anchor="middle" x="387" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="387" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="387" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="387" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_gpu1&#45;&gt;layer3_attn_norm_gpu1 -->
<g id="edge267" class="edge">
<title>layer3_attn_gpu1&#45;&gt;layer3_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M387.68,-2195.84C387.6,-2187.73 387.51,-2178.94 387.43,-2170.43"/>
<polygon fill="black" stroke="black" points="390.92,-2170.22 387.33,-2160.25 383.92,-2170.29 390.92,-2170.22"/>
</g>
<!-- layer3_attn_norm_gpu1&#45;&gt;layer3_attn_aggregate -->
<g id="edge268" class="edge">
<title>layer3_attn_norm_gpu1&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M509.25,-2093.55C512.19,-2092.99 515.11,-2092.46 518,-2091.95 811.95,-2040.78 1157.03,-2012.99 1368.59,-1999.57"/>
<polygon fill="black" stroke="black" points="1369.11,-2003.04 1378.87,-1998.92 1368.67,-1996.06 1369.11,-2003.04"/>
</g>
<!-- layer3_attn_gpu2 -->
<g id="node141" class="node">
<title>layer3_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="771.5,-2263.95 528.5,-2263.95 528.5,-2195.95 771.5,-2195.95 771.5,-2263.95"/>
<text text-anchor="middle" x="650" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="650" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="650" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="650" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_qkv_gpu2&#45;&gt;layer3_attn_gpu2 -->
<g id="edge269" class="edge">
<title>layer3_qkv_gpu2&#45;&gt;layer3_attn_gpu2</title>
<path fill="none" stroke="black" d="M683.89,-2299.68C679.66,-2291.11 675.19,-2282.04 670.94,-2273.41"/>
<polygon fill="black" stroke="black" points="673.98,-2271.67 666.42,-2264.25 667.71,-2274.77 673.98,-2271.67"/>
</g>
<!-- layer3_attn_norm_gpu2 -->
<g id="node142" class="node">
<title>layer3_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="771,-2159.95 527,-2159.95 527,-2091.95 771,-2091.95 771,-2159.95"/>
<text text-anchor="middle" x="649" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="649" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="649" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="649" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_gpu2&#45;&gt;layer3_attn_norm_gpu2 -->
<g id="edge270" class="edge">
<title>layer3_attn_gpu2&#45;&gt;layer3_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M649.68,-2195.84C649.6,-2187.73 649.51,-2178.94 649.43,-2170.43"/>
<polygon fill="black" stroke="black" points="652.92,-2170.22 649.33,-2160.25 645.92,-2170.29 652.92,-2170.22"/>
</g>
<!-- layer3_attn_norm_gpu2&#45;&gt;layer3_attn_aggregate -->
<g id="edge271" class="edge">
<title>layer3_attn_norm_gpu2&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M771.28,-2093.67C774.21,-2093.08 777.12,-2092.5 780,-2091.95 987.52,-2052.36 1228.78,-2023.21 1388.7,-2006.22"/>
<polygon fill="black" stroke="black" points="1389.54,-2009.65 1399.12,-2005.12 1388.8,-2002.69 1389.54,-2009.65"/>
</g>
<!-- layer3_attn_gpu3 -->
<g id="node144" class="node">
<title>layer3_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1033.5,-2263.95 790.5,-2263.95 790.5,-2195.95 1033.5,-2195.95 1033.5,-2263.95"/>
<text text-anchor="middle" x="912" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="912" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="912" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="912" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_qkv_gpu3&#45;&gt;layer3_attn_gpu3 -->
<g id="edge272" class="edge">
<title>layer3_qkv_gpu3&#45;&gt;layer3_attn_gpu3</title>
<path fill="none" stroke="black" d="M935.85,-2299.68C932.94,-2291.29 929.86,-2282.43 926.92,-2273.96"/>
<polygon fill="black" stroke="black" points="930.14,-2272.55 923.56,-2264.25 923.53,-2274.85 930.14,-2272.55"/>
</g>
<!-- layer3_attn_norm_gpu3 -->
<g id="node145" class="node">
<title>layer3_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1033,-2159.95 789,-2159.95 789,-2091.95 1033,-2091.95 1033,-2159.95"/>
<text text-anchor="middle" x="911" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="911" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="911" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="911" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_gpu3&#45;&gt;layer3_attn_norm_gpu3 -->
<g id="edge273" class="edge">
<title>layer3_attn_gpu3&#45;&gt;layer3_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M911.68,-2195.84C911.6,-2187.73 911.51,-2178.94 911.43,-2170.43"/>
<polygon fill="black" stroke="black" points="914.92,-2170.22 911.33,-2160.25 907.92,-2170.29 914.92,-2170.22"/>
</g>
<!-- layer3_attn_norm_gpu3&#45;&gt;layer3_attn_aggregate -->
<g id="edge274" class="edge">
<title>layer3_attn_norm_gpu3&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M1033.33,-2093.92C1036.25,-2093.25 1039.14,-2092.59 1042,-2091.95 1168.42,-2063.63 1312.96,-2035.53 1418.17,-2015.86"/>
<polygon fill="black" stroke="black" points="1419.04,-2019.26 1428.23,-2013.98 1417.75,-2012.38 1419.04,-2019.26"/>
</g>
<!-- layer3_attn_gpu4 -->
<g id="node147" class="node">
<title>layer3_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1295.5,-2263.95 1052.5,-2263.95 1052.5,-2195.95 1295.5,-2195.95 1295.5,-2263.95"/>
<text text-anchor="middle" x="1174" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="1174" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1174" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1174" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_qkv_gpu4&#45;&gt;layer3_attn_gpu4 -->
<g id="edge275" class="edge">
<title>layer3_qkv_gpu4&#45;&gt;layer3_attn_gpu4</title>
<path fill="none" stroke="black" d="M1187.81,-2299.68C1186.14,-2291.38 1184.38,-2282.62 1182.7,-2274.24"/>
<polygon fill="black" stroke="black" points="1186.09,-2273.37 1180.69,-2264.25 1179.23,-2274.75 1186.09,-2273.37"/>
</g>
<!-- layer3_attn_norm_gpu4 -->
<g id="node148" class="node">
<title>layer3_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1295,-2159.95 1051,-2159.95 1051,-2091.95 1295,-2091.95 1295,-2159.95"/>
<text text-anchor="middle" x="1173" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="1173" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1173" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1173" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_attn_gpu4&#45;&gt;layer3_attn_norm_gpu4 -->
<g id="edge276" class="edge">
<title>layer3_attn_gpu4&#45;&gt;layer3_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M1173.68,-2195.84C1173.6,-2187.73 1173.51,-2178.94 1173.43,-2170.43"/>
<polygon fill="black" stroke="black" points="1176.92,-2170.22 1173.33,-2160.25 1169.92,-2170.29 1176.92,-2170.22"/>
</g>
<!-- layer3_attn_norm_gpu4&#45;&gt;layer3_attn_aggregate -->
<g id="edge277" class="edge">
<title>layer3_attn_norm_gpu4&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M1268.39,-2091.94C1324.12,-2072.66 1394.78,-2048.2 1453.26,-2027.97"/>
<polygon fill="black" stroke="black" points="1454.61,-2031.21 1462.91,-2024.63 1452.32,-2024.59 1454.61,-2031.21"/>
</g>
<!-- layer3_attn_gpu5 -->
<g id="node150" class="node">
<title>layer3_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1556.5,-2263.95 1313.5,-2263.95 1313.5,-2195.95 1556.5,-2195.95 1556.5,-2263.95"/>
<text text-anchor="middle" x="1435" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="1435" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1435" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1435" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_qkv_gpu5&#45;&gt;layer3_attn_gpu5 -->
<g id="edge278" class="edge">
<title>layer3_qkv_gpu5&#45;&gt;layer3_attn_gpu5</title>
<path fill="none" stroke="black" d="M1439.39,-2299.68C1438.86,-2291.38 1438.3,-2282.62 1437.77,-2274.24"/>
<polygon fill="black" stroke="black" points="1441.26,-2274.01 1437.13,-2264.25 1434.27,-2274.46 1441.26,-2274.01"/>
</g>
<!-- layer3_attn_norm_gpu5 -->
<g id="node151" class="node">
<title>layer3_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1557,-2159.95 1313,-2159.95 1313,-2091.95 1557,-2091.95 1557,-2159.95"/>
<text text-anchor="middle" x="1435" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="1435" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1435" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1435" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_attn_gpu5&#45;&gt;layer3_attn_norm_gpu5 -->
<g id="edge279" class="edge">
<title>layer3_attn_gpu5&#45;&gt;layer3_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M1435,-2195.84C1435,-2187.73 1435,-2178.94 1435,-2170.43"/>
<polygon fill="black" stroke="black" points="1438.5,-2170.25 1435,-2160.25 1431.5,-2170.25 1438.5,-2170.25"/>
</g>
<!-- layer3_attn_norm_gpu5&#45;&gt;layer3_attn_aggregate -->
<g id="edge280" class="edge">
<title>layer3_attn_norm_gpu5&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M1467.05,-2091.68C1479.67,-2078.57 1494.57,-2063.11 1508.92,-2048.21"/>
<polygon fill="black" stroke="black" points="1511.49,-2050.59 1515.91,-2040.96 1506.45,-2045.73 1511.49,-2050.59"/>
</g>
<!-- layer3_attn_gpu6 -->
<g id="node153" class="node">
<title>layer3_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1817.5,-2263.95 1574.5,-2263.95 1574.5,-2195.95 1817.5,-2195.95 1817.5,-2263.95"/>
<text text-anchor="middle" x="1696" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="1696" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1696" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1696" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_qkv_gpu6&#45;&gt;layer3_attn_gpu6 -->
<g id="edge281" class="edge">
<title>layer3_qkv_gpu6&#45;&gt;layer3_attn_gpu6</title>
<path fill="none" stroke="black" d="M1690.98,-2299.68C1691.59,-2291.38 1692.23,-2282.62 1692.84,-2274.24"/>
<polygon fill="black" stroke="black" points="1696.33,-2274.48 1693.57,-2264.25 1689.35,-2273.97 1696.33,-2274.48"/>
</g>
<!-- layer3_attn_norm_gpu6 -->
<g id="node154" class="node">
<title>layer3_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1819,-2159.95 1575,-2159.95 1575,-2091.95 1819,-2091.95 1819,-2159.95"/>
<text text-anchor="middle" x="1697" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="1697" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1697" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1697" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_attn_gpu6&#45;&gt;layer3_attn_norm_gpu6 -->
<g id="edge282" class="edge">
<title>layer3_attn_gpu6&#45;&gt;layer3_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M1696.32,-2195.84C1696.4,-2187.73 1696.49,-2178.94 1696.57,-2170.43"/>
<polygon fill="black" stroke="black" points="1700.08,-2170.29 1696.67,-2160.25 1693.08,-2170.22 1700.08,-2170.29"/>
</g>
<!-- layer3_attn_norm_gpu6&#45;&gt;layer3_attn_aggregate -->
<g id="edge283" class="edge">
<title>layer3_attn_norm_gpu6&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M1664.95,-2091.68C1652.33,-2078.57 1637.43,-2063.11 1623.08,-2048.21"/>
<polygon fill="black" stroke="black" points="1625.55,-2045.73 1616.09,-2040.96 1620.51,-2050.59 1625.55,-2045.73"/>
</g>
<!-- layer3_attn_gpu7 -->
<g id="node156" class="node">
<title>layer3_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2079.5,-2263.95 1836.5,-2263.95 1836.5,-2195.95 2079.5,-2195.95 2079.5,-2263.95"/>
<text text-anchor="middle" x="1958" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="1958" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1958" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1958" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_qkv_gpu7&#45;&gt;layer3_attn_gpu7 -->
<g id="edge284" class="edge">
<title>layer3_qkv_gpu7&#45;&gt;layer3_attn_gpu7</title>
<path fill="none" stroke="black" d="M1942.94,-2299.68C1944.76,-2291.38 1946.68,-2282.62 1948.51,-2274.24"/>
<polygon fill="black" stroke="black" points="1951.98,-2274.77 1950.7,-2264.25 1945.14,-2273.27 1951.98,-2274.77"/>
</g>
<!-- layer3_attn_norm_gpu7 -->
<g id="node157" class="node">
<title>layer3_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2081,-2159.95 1837,-2159.95 1837,-2091.95 2081,-2091.95 2081,-2159.95"/>
<text text-anchor="middle" x="1959" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="1959" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1959" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1959" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_attn_gpu7&#45;&gt;layer3_attn_norm_gpu7 -->
<g id="edge285" class="edge">
<title>layer3_attn_gpu7&#45;&gt;layer3_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M1958.32,-2195.84C1958.4,-2187.73 1958.49,-2178.94 1958.57,-2170.43"/>
<polygon fill="black" stroke="black" points="1962.08,-2170.29 1958.67,-2160.25 1955.08,-2170.22 1962.08,-2170.29"/>
</g>
<!-- layer3_attn_norm_gpu7&#45;&gt;layer3_attn_aggregate -->
<g id="edge286" class="edge">
<title>layer3_attn_norm_gpu7&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M1863.61,-2091.94C1807.88,-2072.66 1737.22,-2048.2 1678.74,-2027.97"/>
<polygon fill="black" stroke="black" points="1679.68,-2024.59 1669.09,-2024.63 1677.39,-2031.21 1679.68,-2024.59"/>
</g>
<!-- layer3_attn_gpu8 -->
<g id="node159" class="node">
<title>layer3_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2341.5,-2263.95 2098.5,-2263.95 2098.5,-2195.95 2341.5,-2195.95 2341.5,-2263.95"/>
<text text-anchor="middle" x="2220" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU8</text>
<text text-anchor="middle" x="2220" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2220" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2220" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_qkv_gpu8&#45;&gt;layer3_attn_gpu8 -->
<g id="edge287" class="edge">
<title>layer3_qkv_gpu8&#45;&gt;layer3_attn_gpu8</title>
<path fill="none" stroke="black" d="M2194.89,-2299.68C2197.99,-2291.2 2201.27,-2282.24 2204.39,-2273.68"/>
<polygon fill="black" stroke="black" points="2207.69,-2274.85 2207.84,-2264.25 2201.12,-2272.44 2207.69,-2274.85"/>
</g>
<!-- layer3_attn_norm_gpu8 -->
<g id="node160" class="node">
<title>layer3_attn_norm_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2343,-2159.95 2099,-2159.95 2099,-2091.95 2343,-2091.95 2343,-2159.95"/>
<text text-anchor="middle" x="2221" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="2221" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2221" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2221" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_attn_gpu8&#45;&gt;layer3_attn_norm_gpu8 -->
<g id="edge288" class="edge">
<title>layer3_attn_gpu8&#45;&gt;layer3_attn_norm_gpu8</title>
<path fill="none" stroke="black" d="M2220.32,-2195.84C2220.4,-2187.73 2220.49,-2178.94 2220.57,-2170.43"/>
<polygon fill="black" stroke="black" points="2224.08,-2170.29 2220.67,-2160.25 2217.08,-2170.22 2224.08,-2170.29"/>
</g>
<!-- layer3_attn_norm_gpu8&#45;&gt;layer3_attn_aggregate -->
<g id="edge289" class="edge">
<title>layer3_attn_norm_gpu8&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M2098.67,-2093.92C2095.75,-2093.25 2092.86,-2092.59 2090,-2091.95 1963.58,-2063.63 1819.04,-2035.53 1713.83,-2015.86"/>
<polygon fill="black" stroke="black" points="1714.25,-2012.38 1703.77,-2013.98 1712.96,-2019.26 1714.25,-2012.38"/>
</g>
<!-- layer3_attn_gpu9 -->
<g id="node162" class="node">
<title>layer3_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2603.5,-2263.95 2360.5,-2263.95 2360.5,-2195.95 2603.5,-2195.95 2603.5,-2263.95"/>
<text text-anchor="middle" x="2482" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU9</text>
<text text-anchor="middle" x="2482" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2482" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2482" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_qkv_gpu9&#45;&gt;layer3_attn_gpu9 -->
<g id="edge290" class="edge">
<title>layer3_qkv_gpu9&#45;&gt;layer3_attn_gpu9</title>
<path fill="none" stroke="black" d="M2446.85,-2299.68C2451.24,-2291.11 2455.87,-2282.04 2460.29,-2273.41"/>
<polygon fill="black" stroke="black" points="2463.53,-2274.75 2464.97,-2264.25 2457.3,-2271.56 2463.53,-2274.75"/>
</g>
<!-- layer3_attn_norm_gpu9 -->
<g id="node163" class="node">
<title>layer3_attn_norm_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2605,-2159.95 2361,-2159.95 2361,-2091.95 2605,-2091.95 2605,-2159.95"/>
<text text-anchor="middle" x="2483" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="2483" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2483" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2483" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_attn_gpu9&#45;&gt;layer3_attn_norm_gpu9 -->
<g id="edge291" class="edge">
<title>layer3_attn_gpu9&#45;&gt;layer3_attn_norm_gpu9</title>
<path fill="none" stroke="black" d="M2482.32,-2195.84C2482.4,-2187.73 2482.49,-2178.94 2482.57,-2170.43"/>
<polygon fill="black" stroke="black" points="2486.08,-2170.29 2482.67,-2160.25 2479.08,-2170.22 2486.08,-2170.29"/>
</g>
<!-- layer3_attn_norm_gpu9&#45;&gt;layer3_attn_aggregate -->
<g id="edge292" class="edge">
<title>layer3_attn_norm_gpu9&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M2360.72,-2093.67C2357.79,-2093.08 2354.88,-2092.5 2352,-2091.95 2144.48,-2052.36 1903.22,-2023.21 1743.3,-2006.22"/>
<polygon fill="black" stroke="black" points="1743.2,-2002.69 1732.88,-2005.12 1742.46,-2009.65 1743.2,-2002.69"/>
</g>
<!-- layer3_attn_gpu10 -->
<g id="node165" class="node">
<title>layer3_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2875,-2263.95 2623,-2263.95 2623,-2195.95 2875,-2195.95 2875,-2263.95"/>
<text text-anchor="middle" x="2749" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU10</text>
<text text-anchor="middle" x="2749" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2749" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2749" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_qkv_gpu10&#45;&gt;layer3_attn_gpu10 -->
<g id="edge293" class="edge">
<title>layer3_qkv_gpu10&#45;&gt;layer3_attn_gpu10</title>
<path fill="none" stroke="black" d="M2700.67,-2299.68C2706.89,-2290.83 2713.48,-2281.46 2719.73,-2272.58"/>
<polygon fill="black" stroke="black" points="2722.69,-2274.45 2725.58,-2264.25 2716.97,-2270.42 2722.69,-2274.45"/>
</g>
<!-- layer3_attn_norm_gpu10 -->
<g id="node166" class="node">
<title>layer3_attn_norm_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2876.5,-2159.95 2623.5,-2159.95 2623.5,-2091.95 2876.5,-2091.95 2876.5,-2159.95"/>
<text text-anchor="middle" x="2750" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="2750" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2750" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2750" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_attn_gpu10&#45;&gt;layer3_attn_norm_gpu10 -->
<g id="edge294" class="edge">
<title>layer3_attn_gpu10&#45;&gt;layer3_attn_norm_gpu10</title>
<path fill="none" stroke="black" d="M2749.32,-2195.84C2749.4,-2187.73 2749.49,-2178.94 2749.57,-2170.43"/>
<polygon fill="black" stroke="black" points="2753.08,-2170.29 2749.67,-2160.25 2746.08,-2170.22 2753.08,-2170.29"/>
</g>
<!-- layer3_attn_norm_gpu10&#45;&gt;layer3_attn_aggregate -->
<g id="edge295" class="edge">
<title>layer3_attn_norm_gpu10&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M2623.43,-2093.63C2620.26,-2093.04 2617.11,-2092.48 2614,-2091.95 2319.39,-2041.99 1973.77,-2013.84 1762.37,-2000.01"/>
<polygon fill="black" stroke="black" points="1762.3,-1996.5 1752.09,-1999.35 1761.84,-2003.49 1762.3,-1996.5"/>
</g>
<!-- layer3_attn_gpu11 -->
<g id="node168" class="node">
<title>layer3_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3146,-2263.95 2894,-2263.95 2894,-2195.95 3146,-2195.95 3146,-2263.95"/>
<text text-anchor="middle" x="3020" y="-2248.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU11</text>
<text text-anchor="middle" x="3020" y="-2233.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="3020" y="-2218.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3020" y="-2203.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_qkv_gpu11&#45;&gt;layer3_attn_gpu11 -->
<g id="edge296" class="edge">
<title>layer3_qkv_gpu11&#45;&gt;layer3_attn_gpu11</title>
<path fill="none" stroke="black" d="M2955.98,-2299.68C2964.48,-2290.56 2973.49,-2280.88 2981.99,-2271.76"/>
<polygon fill="black" stroke="black" points="2984.73,-2273.96 2988.98,-2264.25 2979.6,-2269.18 2984.73,-2273.96"/>
</g>
<!-- layer3_attn_norm_gpu11 -->
<g id="node169" class="node">
<title>layer3_attn_norm_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3147.5,-2159.95 2894.5,-2159.95 2894.5,-2091.95 3147.5,-2091.95 3147.5,-2159.95"/>
<text text-anchor="middle" x="3021" y="-2144.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="3021" y="-2129.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="3021" y="-2114.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3021" y="-2099.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_attn_gpu11&#45;&gt;layer3_attn_norm_gpu11 -->
<g id="edge297" class="edge">
<title>layer3_attn_gpu11&#45;&gt;layer3_attn_norm_gpu11</title>
<path fill="none" stroke="black" d="M3020.32,-2195.84C3020.4,-2187.73 3020.49,-2178.94 3020.57,-2170.43"/>
<polygon fill="black" stroke="black" points="3024.08,-2170.29 3020.67,-2160.25 3017.08,-2170.22 3024.08,-2170.29"/>
</g>
<!-- layer3_attn_norm_gpu11&#45;&gt;layer3_attn_aggregate -->
<g id="edge298" class="edge">
<title>layer3_attn_norm_gpu11&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M2894.45,-2093.54C2891.27,-2092.98 2888.12,-2092.45 2885,-2091.95 2497.2,-2030.17 2039.09,-2004.97 1777.55,-1995.05"/>
<polygon fill="black" stroke="black" points="1777.29,-1991.53 1767.17,-1994.66 1777.03,-1998.53 1777.29,-1991.53"/>
</g>
<!-- layer3_moe_broadcast -->
<g id="node171" class="node">
<title>layer3_moe_broadcast</title>
<polygon fill="yellow" stroke="black" points="1798.47,-1883.95 1428.66,-1883.95 1333.53,-1747.95 1703.34,-1747.95 1798.47,-1883.95"/>
<text text-anchor="middle" x="1566" y="-1834.75" font-family="Times,serif" font-size="14.00">L3_Broadcast_to_MoE</text>
<text text-anchor="middle" x="1566" y="-1819.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1566" y="-1804.75" font-family="Times,serif" font-size="14.00">Output: 4×[1024,2048,4096]</text>
<text text-anchor="middle" x="1566" y="-1789.75" font-family="Times,serif" font-size="14.00">Broadcast to GPUs 12&#45;15</text>
</g>
<!-- layer3_attn_aggregate&#45;&gt;layer3_moe_broadcast -->
<g id="edge299" class="edge">
<title>layer3_attn_aggregate&#45;&gt;layer3_moe_broadcast</title>
<path fill="none" stroke="black" d="M1566,-1919.76C1566,-1911.45 1566,-1902.9 1566,-1894.45"/>
<polygon fill="black" stroke="black" points="1569.5,-1894.21 1566,-1884.21 1562.5,-1894.21 1569.5,-1894.21"/>
</g>
<!-- layer3_gate_gpu12 -->
<g id="node172" class="node">
<title>layer3_gate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="632,-1711.95 388,-1711.95 388,-1628.95 632,-1628.95 632,-1711.95"/>
<text text-anchor="middle" x="510" y="-1696.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU12</text>
<text text-anchor="middle" x="510" y="-1681.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="510" y="-1666.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="510" y="-1651.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="510" y="-1636.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_moe_broadcast&#45;&gt;layer3_gate_gpu12 -->
<g id="edge300" class="edge">
<title>layer3_moe_broadcast&#45;&gt;layer3_gate_gpu12</title>
<path fill="none" stroke="black" d="M1360.83,-1787.07C1148.43,-1758.21 822.92,-1713.98 642.31,-1689.43"/>
<polygon fill="black" stroke="black" points="642.6,-1685.94 632.22,-1688.06 641.66,-1692.88 642.6,-1685.94"/>
</g>
<!-- layer3_gate_gpu13 -->
<g id="node179" class="node">
<title>layer3_gate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1400,-1711.95 1156,-1711.95 1156,-1628.95 1400,-1628.95 1400,-1711.95"/>
<text text-anchor="middle" x="1278" y="-1696.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU13</text>
<text text-anchor="middle" x="1278" y="-1681.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1278" y="-1666.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1278" y="-1651.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="1278" y="-1636.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_moe_broadcast&#45;&gt;layer3_gate_gpu13 -->
<g id="edge310" class="edge">
<title>layer3_moe_broadcast&#45;&gt;layer3_gate_gpu13</title>
<path fill="none" stroke="black" d="M1431.28,-1747.82C1409.95,-1737.2 1388.35,-1726.44 1368.36,-1716.47"/>
<polygon fill="black" stroke="black" points="1369.8,-1713.28 1359.29,-1711.96 1366.68,-1719.55 1369.8,-1713.28"/>
</g>
<!-- layer3_gate_gpu14 -->
<g id="node186" class="node">
<title>layer3_gate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1976,-1711.95 1732,-1711.95 1732,-1628.95 1976,-1628.95 1976,-1711.95"/>
<text text-anchor="middle" x="1854" y="-1696.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU14</text>
<text text-anchor="middle" x="1854" y="-1681.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1854" y="-1666.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1854" y="-1651.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="1854" y="-1636.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_moe_broadcast&#45;&gt;layer3_gate_gpu14 -->
<g id="edge320" class="edge">
<title>layer3_moe_broadcast&#45;&gt;layer3_gate_gpu14</title>
<path fill="none" stroke="black" d="M1700.72,-1747.82C1722.05,-1737.2 1743.65,-1726.44 1763.64,-1716.47"/>
<polygon fill="black" stroke="black" points="1765.32,-1719.55 1772.71,-1711.96 1762.2,-1713.28 1765.32,-1719.55"/>
</g>
<!-- layer3_gate_gpu15 -->
<g id="node193" class="node">
<title>layer3_gate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2744,-1711.95 2500,-1711.95 2500,-1628.95 2744,-1628.95 2744,-1711.95"/>
<text text-anchor="middle" x="2622" y="-1696.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU15</text>
<text text-anchor="middle" x="2622" y="-1681.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2622" y="-1666.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="2622" y="-1651.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="2622" y="-1636.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_moe_broadcast&#45;&gt;layer3_gate_gpu15 -->
<g id="edge330" class="edge">
<title>layer3_moe_broadcast&#45;&gt;layer3_gate_gpu15</title>
<path fill="none" stroke="black" d="M1734.49,-1792.06C1944.3,-1763.55 2298.33,-1715.44 2489.69,-1689.43"/>
<polygon fill="black" stroke="black" points="2490.37,-1692.87 2499.81,-1688.06 2489.43,-1685.94 2490.37,-1692.87"/>
</g>
<!-- layer3_expert12_0 -->
<g id="node173" class="node">
<title>layer3_expert12_0</title>
<polygon fill="lightgreen" stroke="black" points="213,-1592.95 39,-1592.95 39,-1509.95 213,-1509.95 213,-1592.95"/>
<text text-anchor="middle" x="126" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU12</text>
<text text-anchor="middle" x="126" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="126" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="126" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="126" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_0 -->
<g id="edge301" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M387.66,-1640.97C338.66,-1628.59 281.72,-1612.96 222.67,-1593.07"/>
<polygon fill="black" stroke="black" points="223.77,-1589.75 213.18,-1589.84 221.52,-1596.37 223.77,-1589.75"/>
</g>
<!-- layer3_expert12_1 -->
<g id="node174" class="node">
<title>layer3_expert12_1</title>
<polygon fill="lightgreen" stroke="black" points="405,-1592.95 231,-1592.95 231,-1509.95 405,-1509.95 405,-1592.95"/>
<text text-anchor="middle" x="318" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU12</text>
<text text-anchor="middle" x="318" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="318" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="318" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="318" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_1 -->
<g id="edge302" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M443.39,-1628.86C427.15,-1618.97 409.68,-1608.32 393.08,-1598.21"/>
<polygon fill="black" stroke="black" points="394.86,-1595.19 384.5,-1592.97 391.21,-1601.17 394.86,-1595.19"/>
</g>
<!-- layer3_expert12_2 -->
<g id="node175" class="node">
<title>layer3_expert12_2</title>
<polygon fill="lightgreen" stroke="black" points="597,-1592.95 423,-1592.95 423,-1509.95 597,-1509.95 597,-1592.95"/>
<text text-anchor="middle" x="510" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU12</text>
<text text-anchor="middle" x="510" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="510" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="510" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="510" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_2 -->
<g id="edge303" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M510,-1628.86C510,-1620.6 510,-1611.82 510,-1603.26"/>
<polygon fill="black" stroke="black" points="513.5,-1602.97 510,-1592.97 506.5,-1602.97 513.5,-1602.97"/>
</g>
<!-- layer3_expert12_3 -->
<g id="node176" class="node">
<title>layer3_expert12_3</title>
<polygon fill="lightgreen" stroke="black" points="789,-1592.95 615,-1592.95 615,-1509.95 789,-1509.95 789,-1592.95"/>
<text text-anchor="middle" x="702" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU12</text>
<text text-anchor="middle" x="702" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="702" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="702" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="702" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_3 -->
<g id="edge304" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M576.61,-1628.86C592.85,-1618.97 610.32,-1608.32 626.92,-1598.21"/>
<polygon fill="black" stroke="black" points="628.79,-1601.17 635.5,-1592.97 625.14,-1595.19 628.79,-1601.17"/>
</g>
<!-- layer3_moe_aggregate_gpu12 -->
<g id="node177" class="node">
<title>layer3_moe_aggregate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="616,-1473.95 404,-1473.95 404,-1405.95 616,-1405.95 616,-1473.95"/>
<text text-anchor="middle" x="510" y="-1458.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU12</text>
<text text-anchor="middle" x="510" y="-1443.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="510" y="-1428.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="510" y="-1413.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_expert12_0&#45;&gt;layer3_moe_aggregate_gpu12 -->
<g id="edge305" class="edge">
<title>layer3_expert12_0&#45;&gt;layer3_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M213.15,-1512.97C216.12,-1511.92 219.08,-1510.91 222,-1509.95 277.76,-1491.65 341.05,-1475.95 394.08,-1464.17"/>
<polygon fill="black" stroke="black" points="394.84,-1467.59 403.85,-1462.02 393.33,-1460.75 394.84,-1467.59"/>
</g>
<!-- layer3_expert12_1&#45;&gt;layer3_moe_aggregate_gpu12 -->
<g id="edge306" class="edge">
<title>layer3_expert12_1&#45;&gt;layer3_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M389.22,-1509.84C406.85,-1499.78 425.68,-1489.04 443.1,-1479.11"/>
<polygon fill="black" stroke="black" points="445.11,-1481.99 452.06,-1474 441.64,-1475.91 445.11,-1481.99"/>
</g>
<!-- layer3_expert12_2&#45;&gt;layer3_moe_aggregate_gpu12 -->
<g id="edge307" class="edge">
<title>layer3_expert12_2&#45;&gt;layer3_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M510,-1509.68C510,-1501.47 510,-1492.81 510,-1484.51"/>
<polygon fill="black" stroke="black" points="513.5,-1484.25 510,-1474.25 506.5,-1484.25 513.5,-1484.25"/>
</g>
<!-- layer3_expert12_3&#45;&gt;layer3_moe_aggregate_gpu12 -->
<g id="edge308" class="edge">
<title>layer3_expert12_3&#45;&gt;layer3_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M630.78,-1509.84C613.15,-1499.78 594.32,-1489.04 576.9,-1479.11"/>
<polygon fill="black" stroke="black" points="578.36,-1475.91 567.94,-1474 574.89,-1481.99 578.36,-1475.91"/>
</g>
<!-- layer3_moe_norm_gpu12 -->
<g id="node178" class="node">
<title>layer3_moe_norm_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="1286.5,-1369.95 1033.5,-1369.95 1033.5,-1301.95 1286.5,-1301.95 1286.5,-1369.95"/>
<text text-anchor="middle" x="1160" y="-1354.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="1160" y="-1339.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1160" y="-1324.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1160" y="-1309.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_moe_aggregate_gpu12&#45;&gt;layer3_moe_norm_gpu12 -->
<g id="edge309" class="edge">
<title>layer3_moe_aggregate_gpu12&#45;&gt;layer3_moe_norm_gpu12</title>
<path fill="none" stroke="black" d="M616.24,-1422.28C727.31,-1404.85 902.01,-1377.44 1023.3,-1358.4"/>
<polygon fill="black" stroke="black" points="1024.06,-1361.83 1033.4,-1356.82 1022.98,-1354.91 1024.06,-1361.83"/>
</g>
<!-- layer4_qkv_gpu0 -->
<g id="node200" class="node">
<title>layer4_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="328,-1265.95 100,-1265.95 100,-1182.95 328,-1182.95 328,-1265.95"/>
<text text-anchor="middle" x="214" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="214" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="214" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="214" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 0&#45;2</text>
<text text-anchor="middle" x="214" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu0 -->
<g id="edge340" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1033.21,-1333.5C872.61,-1329.61 587.7,-1315.81 337.99,-1266.01"/>
<polygon fill="black" stroke="black" points="338.5,-1262.54 328,-1264 337.11,-1269.41 338.5,-1262.54"/>
</g>
<!-- layer4_qkv_gpu1 -->
<g id="node203" class="node">
<title>layer4_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="574,-1265.95 346,-1265.95 346,-1182.95 574,-1182.95 574,-1265.95"/>
<text text-anchor="middle" x="460" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="460" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="460" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="460" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 3&#45;5</text>
<text text-anchor="middle" x="460" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu1 -->
<g id="edge341" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1033.28,-1327.08C917.97,-1318.24 743.24,-1300.65 584.01,-1266.05"/>
<polygon fill="black" stroke="black" points="584.55,-1262.59 574.03,-1263.86 583.05,-1269.42 584.55,-1262.59"/>
</g>
<!-- layer4_qkv_gpu2 -->
<g id="node206" class="node">
<title>layer4_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="820,-1265.95 592,-1265.95 592,-1182.95 820,-1182.95 820,-1265.95"/>
<text text-anchor="middle" x="706" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="706" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="706" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="706" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 6&#45;8</text>
<text text-anchor="middle" x="706" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu2 -->
<g id="edge342" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1033.47,-1312.05C974.12,-1300.46 902.37,-1285.25 829.89,-1266.11"/>
<polygon fill="black" stroke="black" points="830.68,-1262.7 820.12,-1263.51 828.88,-1269.47 830.68,-1262.7"/>
</g>
<!-- layer4_qkv_gpu3 -->
<g id="node209" class="node">
<title>layer4_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1066,-1265.95 838,-1265.95 838,-1182.95 1066,-1182.95 1066,-1265.95"/>
<text text-anchor="middle" x="952" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="952" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="952" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="952" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 9&#45;11</text>
<text text-anchor="middle" x="952" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu3 -->
<g id="edge343" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1097.31,-1301.95C1078.74,-1292.18 1058.08,-1281.3 1038.29,-1270.88"/>
<polygon fill="black" stroke="black" points="1039.75,-1267.7 1029.28,-1266.13 1036.49,-1273.89 1039.75,-1267.7"/>
</g>
<!-- layer4_qkv_gpu4 -->
<g id="node212" class="node">
<title>layer4_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1312,-1265.95 1084,-1265.95 1084,-1182.95 1312,-1182.95 1312,-1265.95"/>
<text text-anchor="middle" x="1198" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="1198" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1198" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1198" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 12&#45;14</text>
<text text-anchor="middle" x="1198" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu4 -->
<g id="edge344" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1171.5,-1301.8C1174.36,-1293.57 1177.48,-1284.57 1180.55,-1275.72"/>
<polygon fill="black" stroke="black" points="1183.88,-1276.83 1183.85,-1266.23 1177.26,-1274.53 1183.88,-1276.83"/>
</g>
<!-- layer4_qkv_gpu5 -->
<g id="node215" class="node">
<title>layer4_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1558,-1265.95 1330,-1265.95 1330,-1182.95 1558,-1182.95 1558,-1265.95"/>
<text text-anchor="middle" x="1444" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="1444" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1444" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1444" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 15&#45;17</text>
<text text-anchor="middle" x="1444" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu5 -->
<g id="edge345" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1245.59,-1301.95C1271.93,-1291.8 1301.36,-1280.45 1329.33,-1269.67"/>
<polygon fill="black" stroke="black" points="1330.67,-1272.9 1338.75,-1266.04 1328.16,-1266.37 1330.67,-1272.9"/>
</g>
<!-- layer4_qkv_gpu6 -->
<g id="node218" class="node">
<title>layer4_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1804,-1265.95 1576,-1265.95 1576,-1182.95 1804,-1182.95 1804,-1265.95"/>
<text text-anchor="middle" x="1690" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="1690" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1690" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1690" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 18&#45;20</text>
<text text-anchor="middle" x="1690" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu6 -->
<g id="edge346" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1286.74,-1303.55C1289.52,-1303 1292.27,-1302.47 1295,-1301.95 1411.69,-1280.04 1446.31,-1292.44 1566.04,-1266.04"/>
<polygon fill="black" stroke="black" points="1566.97,-1269.42 1575.95,-1263.81 1565.43,-1262.59 1566.97,-1269.42"/>
</g>
<!-- layer4_qkv_gpu7 -->
<g id="node221" class="node">
<title>layer4_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2050,-1265.95 1822,-1265.95 1822,-1182.95 2050,-1182.95 2050,-1265.95"/>
<text text-anchor="middle" x="1936" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="1936" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1936" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1936" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 21&#45;23</text>
<text text-anchor="middle" x="1936" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu7 -->
<g id="edge347" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1286.7,-1303.32C1289.49,-1302.84 1292.26,-1302.38 1295,-1301.95 1519.8,-1266.93 1584.71,-1309.16 1811.79,-1266.04"/>
<polygon fill="black" stroke="black" points="1812.52,-1269.46 1821.67,-1264.13 1811.19,-1262.59 1812.52,-1269.46"/>
</g>
<!-- layer4_qkv_gpu8 -->
<g id="node224" class="node">
<title>layer4_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2296,-1265.95 2068,-1265.95 2068,-1182.95 2296,-1182.95 2296,-1265.95"/>
<text text-anchor="middle" x="2182" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU8</text>
<text text-anchor="middle" x="2182" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2182" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2182" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 24&#45;26</text>
<text text-anchor="middle" x="2182" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu8 -->
<g id="edge348" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu8</title>
<path fill="none" stroke="black" d="M1286.69,-1303.23C1289.48,-1302.78 1292.25,-1302.35 1295,-1301.95 1628.16,-1253.84 1722.87,-1326.24 2057.71,-1266.04"/>
<polygon fill="black" stroke="black" points="2058.48,-1269.45 2067.69,-1264.22 2057.22,-1262.57 2058.48,-1269.45"/>
</g>
<!-- layer4_qkv_gpu9 -->
<g id="node227" class="node">
<title>layer4_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2542,-1265.95 2314,-1265.95 2314,-1182.95 2542,-1182.95 2542,-1265.95"/>
<text text-anchor="middle" x="2428" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU9</text>
<text text-anchor="middle" x="2428" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2428" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2428" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 27&#45;29</text>
<text text-anchor="middle" x="2428" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu9 -->
<g id="edge349" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu9</title>
<path fill="none" stroke="black" d="M1286.69,-1303.19C1289.48,-1302.75 1292.25,-1302.33 1295,-1301.95 1736.66,-1240.76 1861.01,-1343.46 2303.84,-1266"/>
<polygon fill="black" stroke="black" points="2304.46,-1269.45 2313.7,-1264.26 2303.24,-1262.56 2304.46,-1269.45"/>
</g>
<!-- layer4_qkv_gpu10 -->
<g id="node230" class="node">
<title>layer4_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2788,-1265.95 2560,-1265.95 2560,-1182.95 2788,-1182.95 2788,-1265.95"/>
<text text-anchor="middle" x="2674" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU10</text>
<text text-anchor="middle" x="2674" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2674" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2674" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 30&#45;32</text>
<text text-anchor="middle" x="2674" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu10 -->
<g id="edge350" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1286.68,-1303.16C1289.48,-1302.73 1292.25,-1302.32 1295,-1301.95 1568.47,-1265.03 2259.51,-1312.97 2549.55,-1266"/>
<polygon fill="black" stroke="black" points="2550.42,-1269.4 2559.7,-1264.29 2549.26,-1262.5 2550.42,-1269.4"/>
</g>
<!-- layer4_qkv_gpu11 -->
<g id="node233" class="node">
<title>layer4_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3034,-1265.95 2806,-1265.95 2806,-1182.95 3034,-1182.95 3034,-1265.95"/>
<text text-anchor="middle" x="2920" y="-1250.75" font-family="Times,serif" font-size="14.00">L4_QKV_Projection_GPU11</text>
<text text-anchor="middle" x="2920" y="-1235.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2920" y="-1220.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2920" y="-1205.75" font-family="Times,serif" font-size="14.00">Heads: 33&#45;35</text>
<text text-anchor="middle" x="2920" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu11 -->
<g id="edge351" class="edge">
<title>layer3_moe_norm_gpu12&#45;&gt;layer4_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1286.68,-1303.15C1289.47,-1302.72 1292.25,-1302.32 1295,-1301.95 1622.74,-1258.49 2451.6,-1321.52 2795.67,-1265.98"/>
<polygon fill="black" stroke="black" points="2796.42,-1269.41 2805.7,-1264.31 2795.26,-1262.5 2796.42,-1269.41"/>
</g>
<!-- layer3_expert13_4 -->
<g id="node180" class="node">
<title>layer3_expert13_4</title>
<polygon fill="lightgreen" stroke="black" points="981,-1592.95 807,-1592.95 807,-1509.95 981,-1509.95 981,-1592.95"/>
<text text-anchor="middle" x="894" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU13</text>
<text text-anchor="middle" x="894" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="894" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="894" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="894" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_4 -->
<g id="edge311" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1155.66,-1640.97C1106.66,-1628.59 1049.72,-1612.96 990.67,-1593.07"/>
<polygon fill="black" stroke="black" points="991.77,-1589.75 981.18,-1589.84 989.52,-1596.37 991.77,-1589.75"/>
</g>
<!-- layer3_expert13_5 -->
<g id="node181" class="node">
<title>layer3_expert13_5</title>
<polygon fill="lightgreen" stroke="black" points="1173,-1592.95 999,-1592.95 999,-1509.95 1173,-1509.95 1173,-1592.95"/>
<text text-anchor="middle" x="1086" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU13</text>
<text text-anchor="middle" x="1086" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1086" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1086" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1086" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_5 -->
<g id="edge312" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1211.39,-1628.86C1195.15,-1618.97 1177.68,-1608.32 1161.08,-1598.21"/>
<polygon fill="black" stroke="black" points="1162.86,-1595.19 1152.5,-1592.97 1159.21,-1601.17 1162.86,-1595.19"/>
</g>
<!-- layer3_expert13_6 -->
<g id="node182" class="node">
<title>layer3_expert13_6</title>
<polygon fill="lightgreen" stroke="black" points="1365,-1592.95 1191,-1592.95 1191,-1509.95 1365,-1509.95 1365,-1592.95"/>
<text text-anchor="middle" x="1278" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU13</text>
<text text-anchor="middle" x="1278" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1278" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1278" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1278" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_6 -->
<g id="edge313" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1278,-1628.86C1278,-1620.6 1278,-1611.82 1278,-1603.26"/>
<polygon fill="black" stroke="black" points="1281.5,-1602.97 1278,-1592.97 1274.5,-1602.97 1281.5,-1602.97"/>
</g>
<!-- layer3_expert13_7 -->
<g id="node183" class="node">
<title>layer3_expert13_7</title>
<polygon fill="lightgreen" stroke="black" points="1557,-1592.95 1383,-1592.95 1383,-1509.95 1557,-1509.95 1557,-1592.95"/>
<text text-anchor="middle" x="1470" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU13</text>
<text text-anchor="middle" x="1470" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1470" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1470" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1470" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_7 -->
<g id="edge314" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1344.61,-1628.86C1360.85,-1618.97 1378.32,-1608.32 1394.92,-1598.21"/>
<polygon fill="black" stroke="black" points="1396.79,-1601.17 1403.5,-1592.97 1393.14,-1595.19 1396.79,-1601.17"/>
</g>
<!-- layer3_moe_aggregate_gpu13 -->
<g id="node184" class="node">
<title>layer3_moe_aggregate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1384,-1473.95 1172,-1473.95 1172,-1405.95 1384,-1405.95 1384,-1473.95"/>
<text text-anchor="middle" x="1278" y="-1458.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU13</text>
<text text-anchor="middle" x="1278" y="-1443.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="1278" y="-1428.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1278" y="-1413.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_expert13_4&#45;&gt;layer3_moe_aggregate_gpu13 -->
<g id="edge315" class="edge">
<title>layer3_expert13_4&#45;&gt;layer3_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M981.15,-1512.97C984.12,-1511.92 987.08,-1510.91 990,-1509.95 1045.76,-1491.65 1109.05,-1475.95 1162.08,-1464.17"/>
<polygon fill="black" stroke="black" points="1162.84,-1467.59 1171.85,-1462.02 1161.33,-1460.75 1162.84,-1467.59"/>
</g>
<!-- layer3_expert13_5&#45;&gt;layer3_moe_aggregate_gpu13 -->
<g id="edge316" class="edge">
<title>layer3_expert13_5&#45;&gt;layer3_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1157.22,-1509.84C1174.85,-1499.78 1193.68,-1489.04 1211.1,-1479.11"/>
<polygon fill="black" stroke="black" points="1213.11,-1481.99 1220.06,-1474 1209.64,-1475.91 1213.11,-1481.99"/>
</g>
<!-- layer3_expert13_6&#45;&gt;layer3_moe_aggregate_gpu13 -->
<g id="edge317" class="edge">
<title>layer3_expert13_6&#45;&gt;layer3_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1278,-1509.68C1278,-1501.47 1278,-1492.81 1278,-1484.51"/>
<polygon fill="black" stroke="black" points="1281.5,-1484.25 1278,-1474.25 1274.5,-1484.25 1281.5,-1484.25"/>
</g>
<!-- layer3_expert13_7&#45;&gt;layer3_moe_aggregate_gpu13 -->
<g id="edge318" class="edge">
<title>layer3_expert13_7&#45;&gt;layer3_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1398.78,-1509.84C1381.15,-1499.78 1362.32,-1489.04 1344.9,-1479.11"/>
<polygon fill="black" stroke="black" points="1346.36,-1475.91 1335.94,-1474 1342.89,-1481.99 1346.36,-1475.91"/>
</g>
<!-- layer3_moe_norm_gpu13 -->
<g id="node185" class="node">
<title>layer3_moe_norm_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1557.5,-1369.95 1304.5,-1369.95 1304.5,-1301.95 1557.5,-1301.95 1557.5,-1369.95"/>
<text text-anchor="middle" x="1431" y="-1354.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="1431" y="-1339.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1431" y="-1324.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1431" y="-1309.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_moe_aggregate_gpu13&#45;&gt;layer3_moe_norm_gpu13 -->
<g id="edge319" class="edge">
<title>layer3_moe_aggregate_gpu13&#45;&gt;layer3_moe_norm_gpu13</title>
<path fill="none" stroke="black" d="M1327.67,-1405.84C1342.04,-1396.26 1357.86,-1385.71 1372.7,-1375.82"/>
<polygon fill="black" stroke="black" points="1374.93,-1378.54 1381.31,-1370.08 1371.05,-1372.71 1374.93,-1378.54"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu0 -->
<g id="edge352" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1304.47,-1303.37C1301.29,-1302.86 1298.13,-1302.39 1295,-1301.95 876.26,-1243.88 758.2,-1339.8 338.28,-1266.03"/>
<polygon fill="black" stroke="black" points="338.76,-1262.56 328.31,-1264.25 337.54,-1269.45 338.76,-1262.56"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu1 -->
<g id="edge353" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1304.47,-1303.43C1301.28,-1302.9 1298.13,-1302.41 1295,-1301.95 984.81,-1256.89 896.38,-1322.58 584.55,-1266.09"/>
<polygon fill="black" stroke="black" points="584.78,-1262.57 574.31,-1264.2 583.52,-1269.45 584.78,-1262.57"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu2 -->
<g id="edge354" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1304.45,-1303.54C1301.27,-1302.98 1298.12,-1302.45 1295,-1301.95 1093.05,-1269.87 1034.51,-1305.58 830.18,-1266.04"/>
<polygon fill="black" stroke="black" points="830.82,-1262.6 820.33,-1264.1 829.47,-1269.47 830.82,-1262.6"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu3 -->
<g id="edge355" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1304.38,-1303.9C1301.23,-1303.23 1298.1,-1302.58 1295,-1301.95 1201.03,-1282.89 1173.03,-1289.08 1076,-1266.08"/>
<polygon fill="black" stroke="black" points="1076.62,-1262.63 1066.07,-1263.68 1074.97,-1269.43 1076.62,-1262.63"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu4 -->
<g id="edge356" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1360.78,-1301.95C1339.7,-1292.04 1316.2,-1281 1293.77,-1270.46"/>
<polygon fill="black" stroke="black" points="1295.1,-1267.22 1284.56,-1266.13 1292.13,-1273.56 1295.1,-1267.22"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu5 -->
<g id="edge357" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1434.94,-1301.8C1435.89,-1293.75 1436.94,-1284.95 1437.96,-1276.29"/>
<polygon fill="black" stroke="black" points="1441.46,-1276.57 1439.16,-1266.23 1434.5,-1275.75 1441.46,-1276.57"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu6 -->
<g id="edge358" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1509.06,-1301.95C1532.81,-1291.91 1559.31,-1280.71 1584.54,-1270.04"/>
<polygon fill="black" stroke="black" points="1585.93,-1273.25 1593.78,-1266.13 1583.2,-1266.8 1585.93,-1273.25"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu7 -->
<g id="edge359" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1557.75,-1303.6C1560.53,-1303.03 1563.28,-1302.48 1566,-1301.95 1671.7,-1281.38 1703.19,-1290.8 1811.89,-1266.09"/>
<polygon fill="black" stroke="black" points="1812.99,-1269.42 1821.94,-1263.75 1811.41,-1262.6 1812.99,-1269.42"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu8 -->
<g id="edge360" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu8</title>
<path fill="none" stroke="black" d="M1557.71,-1303.33C1560.49,-1302.85 1563.26,-1302.39 1566,-1301.95 1779.73,-1268.27 1841.62,-1307.41 2057.6,-1266.08"/>
<polygon fill="black" stroke="black" points="2058.52,-1269.47 2067.67,-1264.12 2057.18,-1262.59 2058.52,-1269.47"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu9 -->
<g id="edge361" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu9</title>
<path fill="none" stroke="black" d="M1557.69,-1303.24C1560.48,-1302.78 1563.25,-1302.35 1566,-1301.95 1888.08,-1255.18 1979.8,-1324.47 2303.55,-1266.07"/>
<polygon fill="black" stroke="black" points="2304.48,-1269.45 2313.69,-1264.21 2303.22,-1262.57 2304.48,-1269.45"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu10 -->
<g id="edge362" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1557.69,-1303.19C1560.48,-1302.75 1563.25,-1302.34 1566,-1301.95 1996.61,-1242.09 2117.97,-1341.69 2549.76,-1266.02"/>
<polygon fill="black" stroke="black" points="2550.46,-1269.45 2559.7,-1264.26 2549.24,-1262.56 2550.46,-1269.45"/>
</g>
<!-- layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu11 -->
<g id="edge363" class="edge">
<title>layer3_moe_norm_gpu13&#45;&gt;layer4_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1557.68,-1303.17C1560.48,-1302.73 1563.25,-1302.33 1566,-1301.95 2105.09,-1229.01 2256.05,-1358.93 2795.71,-1266.02"/>
<polygon fill="black" stroke="black" points="2796.45,-1269.45 2805.7,-1264.29 2795.25,-1262.55 2796.45,-1269.45"/>
</g>
<!-- layer3_expert14_8 -->
<g id="node187" class="node">
<title>layer3_expert14_8</title>
<polygon fill="lightgreen" stroke="black" points="1749,-1592.95 1575,-1592.95 1575,-1509.95 1749,-1509.95 1749,-1592.95"/>
<text text-anchor="middle" x="1662" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU14</text>
<text text-anchor="middle" x="1662" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1662" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1662" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1662" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_8 -->
<g id="edge321" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1787.39,-1628.86C1771.15,-1618.97 1753.68,-1608.32 1737.08,-1598.21"/>
<polygon fill="black" stroke="black" points="1738.86,-1595.19 1728.5,-1592.97 1735.21,-1601.17 1738.86,-1595.19"/>
</g>
<!-- layer3_expert14_9 -->
<g id="node188" class="node">
<title>layer3_expert14_9</title>
<polygon fill="lightgreen" stroke="black" points="1941,-1592.95 1767,-1592.95 1767,-1509.95 1941,-1509.95 1941,-1592.95"/>
<text text-anchor="middle" x="1854" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU14</text>
<text text-anchor="middle" x="1854" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1854" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1854" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1854" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_9 -->
<g id="edge322" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1854,-1628.86C1854,-1620.6 1854,-1611.82 1854,-1603.26"/>
<polygon fill="black" stroke="black" points="1857.5,-1602.97 1854,-1592.97 1850.5,-1602.97 1857.5,-1602.97"/>
</g>
<!-- layer3_expert14_10 -->
<g id="node189" class="node">
<title>layer3_expert14_10</title>
<polygon fill="lightgreen" stroke="black" points="2133,-1592.95 1959,-1592.95 1959,-1509.95 2133,-1509.95 2133,-1592.95"/>
<text text-anchor="middle" x="2046" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU14</text>
<text text-anchor="middle" x="2046" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2046" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2046" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2046" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_10 -->
<g id="edge323" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1920.61,-1628.86C1936.85,-1618.97 1954.32,-1608.32 1970.92,-1598.21"/>
<polygon fill="black" stroke="black" points="1972.79,-1601.17 1979.5,-1592.97 1969.14,-1595.19 1972.79,-1601.17"/>
</g>
<!-- layer3_expert14_11 -->
<g id="node190" class="node">
<title>layer3_expert14_11</title>
<polygon fill="lightgreen" stroke="black" points="2325,-1592.95 2151,-1592.95 2151,-1509.95 2325,-1509.95 2325,-1592.95"/>
<text text-anchor="middle" x="2238" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU14</text>
<text text-anchor="middle" x="2238" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2238" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2238" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2238" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_11 -->
<g id="edge324" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1976.34,-1640.97C2025.34,-1628.59 2082.28,-1612.96 2141.33,-1593.07"/>
<polygon fill="black" stroke="black" points="2142.48,-1596.37 2150.82,-1589.84 2140.23,-1589.75 2142.48,-1596.37"/>
</g>
<!-- layer3_moe_aggregate_gpu14 -->
<g id="node191" class="node">
<title>layer3_moe_aggregate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1960,-1473.95 1748,-1473.95 1748,-1405.95 1960,-1405.95 1960,-1473.95"/>
<text text-anchor="middle" x="1854" y="-1458.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU14</text>
<text text-anchor="middle" x="1854" y="-1443.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="1854" y="-1428.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1854" y="-1413.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_expert14_8&#45;&gt;layer3_moe_aggregate_gpu14 -->
<g id="edge325" class="edge">
<title>layer3_expert14_8&#45;&gt;layer3_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1733.22,-1509.84C1750.85,-1499.78 1769.68,-1489.04 1787.1,-1479.11"/>
<polygon fill="black" stroke="black" points="1789.11,-1481.99 1796.06,-1474 1785.64,-1475.91 1789.11,-1481.99"/>
</g>
<!-- layer3_expert14_9&#45;&gt;layer3_moe_aggregate_gpu14 -->
<g id="edge326" class="edge">
<title>layer3_expert14_9&#45;&gt;layer3_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1854,-1509.68C1854,-1501.47 1854,-1492.81 1854,-1484.51"/>
<polygon fill="black" stroke="black" points="1857.5,-1484.25 1854,-1474.25 1850.5,-1484.25 1857.5,-1484.25"/>
</g>
<!-- layer3_expert14_10&#45;&gt;layer3_moe_aggregate_gpu14 -->
<g id="edge327" class="edge">
<title>layer3_expert14_10&#45;&gt;layer3_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1974.78,-1509.84C1957.15,-1499.78 1938.32,-1489.04 1920.9,-1479.11"/>
<polygon fill="black" stroke="black" points="1922.36,-1475.91 1911.94,-1474 1918.89,-1481.99 1922.36,-1475.91"/>
</g>
<!-- layer3_expert14_11&#45;&gt;layer3_moe_aggregate_gpu14 -->
<g id="edge328" class="edge">
<title>layer3_expert14_11&#45;&gt;layer3_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M2150.85,-1512.97C2147.88,-1511.92 2144.92,-1510.91 2142,-1509.95 2086.24,-1491.65 2022.95,-1475.95 1969.92,-1464.17"/>
<polygon fill="black" stroke="black" points="1970.67,-1460.75 1960.15,-1462.02 1969.16,-1467.59 1970.67,-1460.75"/>
</g>
<!-- layer3_moe_norm_gpu14 -->
<g id="node192" class="node">
<title>layer3_moe_norm_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1828.5,-1369.95 1575.5,-1369.95 1575.5,-1301.95 1828.5,-1301.95 1828.5,-1369.95"/>
<text text-anchor="middle" x="1702" y="-1354.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="1702" y="-1339.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1702" y="-1324.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1702" y="-1309.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_moe_aggregate_gpu14&#45;&gt;layer3_moe_norm_gpu14 -->
<g id="edge329" class="edge">
<title>layer3_moe_aggregate_gpu14&#45;&gt;layer3_moe_norm_gpu14</title>
<path fill="none" stroke="black" d="M1804.65,-1405.84C1790.37,-1396.26 1774.66,-1385.71 1759.92,-1375.82"/>
<polygon fill="black" stroke="black" points="1761.62,-1372.74 1751.36,-1370.08 1757.72,-1378.56 1761.62,-1372.74"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu0 -->
<g id="edge364" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1575.48,-1303.34C1572.29,-1302.84 1569.13,-1302.37 1566,-1301.95 1027.72,-1229.57 877.07,-1358.79 338.27,-1266.02"/>
<polygon fill="black" stroke="black" points="338.75,-1262.55 328.3,-1264.29 337.55,-1269.45 338.75,-1262.55"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu1 -->
<g id="edge365" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1575.47,-1303.37C1572.29,-1302.86 1569.13,-1302.39 1566,-1301.95 1136.21,-1242.56 1015.15,-1341.56 584.22,-1266.02"/>
<polygon fill="black" stroke="black" points="584.76,-1262.56 574.3,-1264.26 583.54,-1269.45 584.76,-1262.56"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu2 -->
<g id="edge366" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1575.47,-1303.42C1572.29,-1302.9 1569.13,-1302.4 1566,-1301.95 1244.75,-1255.56 1153.31,-1324.34 830.42,-1266.06"/>
<polygon fill="black" stroke="black" points="830.78,-1262.57 820.31,-1264.21 829.52,-1269.45 830.78,-1262.57"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu3 -->
<g id="edge367" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1575.45,-1303.52C1572.27,-1302.97 1569.12,-1302.44 1566,-1301.95 1353.11,-1268.55 1291.49,-1307.28 1076.36,-1266.07"/>
<polygon fill="black" stroke="black" points="1076.82,-1262.6 1066.33,-1264.11 1075.48,-1269.47 1076.82,-1262.6"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu4 -->
<g id="edge368" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1575.4,-1303.83C1572.24,-1303.18 1569.1,-1302.56 1566,-1301.95 1461.13,-1281.57 1429.93,-1290.68 1322.04,-1266.07"/>
<polygon fill="black" stroke="black" points="1322.59,-1262.61 1312.06,-1263.75 1321.01,-1269.42 1322.59,-1262.61"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu5 -->
<g id="edge369" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1624.24,-1301.95C1600.69,-1291.96 1574.42,-1280.81 1549.38,-1270.18"/>
<polygon fill="black" stroke="black" points="1550.42,-1266.82 1539.85,-1266.13 1547.69,-1273.26 1550.42,-1266.82"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu6 -->
<g id="edge370" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1698.37,-1301.8C1697.48,-1293.75 1696.52,-1284.95 1695.57,-1276.29"/>
<polygon fill="black" stroke="black" points="1699.04,-1275.79 1694.47,-1266.23 1692.08,-1276.55 1699.04,-1275.79"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu7 -->
<g id="edge371" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1772.53,-1301.95C1793.7,-1292.04 1817.29,-1281 1839.82,-1270.46"/>
<polygon fill="black" stroke="black" points="1841.49,-1273.54 1849.07,-1266.13 1838.52,-1267.2 1841.49,-1273.54"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu8 -->
<g id="edge372" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu8</title>
<path fill="none" stroke="black" d="M1828.77,-1303.66C1831.53,-1303.07 1834.28,-1302.51 1837,-1301.95 1931.8,-1282.71 1960.09,-1289.2 2057.92,-1266.1"/>
<polygon fill="black" stroke="black" points="2059.02,-1269.43 2067.93,-1263.69 2057.39,-1262.63 2059.02,-1269.43"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu9 -->
<g id="edge373" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu9</title>
<path fill="none" stroke="black" d="M1828.71,-1303.34C1831.49,-1302.86 1834.26,-1302.39 1837,-1301.95 2039.79,-1269.59 2098.61,-1305.71 2303.78,-1266.05"/>
<polygon fill="black" stroke="black" points="2304.53,-1269.47 2313.67,-1264.1 2303.18,-1262.6 2304.53,-1269.47"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu10 -->
<g id="edge374" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1828.69,-1303.24C1831.48,-1302.79 1834.25,-1302.35 1837,-1301.95 2148.02,-1256.52 2236.74,-1322.71 2549.42,-1266.09"/>
<polygon fill="black" stroke="black" points="2550.48,-1269.45 2559.69,-1264.2 2549.22,-1262.57 2550.48,-1269.45"/>
</g>
<!-- layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu11 -->
<g id="edge375" class="edge">
<title>layer3_moe_norm_gpu14&#45;&gt;layer4_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1828.69,-1303.2C1831.48,-1302.75 1834.25,-1302.34 1837,-1301.95 2256.57,-1243.42 2374.92,-1339.93 2795.7,-1266.03"/>
<polygon fill="black" stroke="black" points="2796.46,-1269.45 2805.69,-1264.25 2795.24,-1262.56 2796.46,-1269.45"/>
</g>
<!-- layer3_expert15_12 -->
<g id="node194" class="node">
<title>layer3_expert15_12</title>
<polygon fill="lightgreen" stroke="black" points="2517,-1592.95 2343,-1592.95 2343,-1509.95 2517,-1509.95 2517,-1592.95"/>
<text text-anchor="middle" x="2430" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU15</text>
<text text-anchor="middle" x="2430" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2430" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2430" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2430" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_12 -->
<g id="edge331" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2555.39,-1628.86C2539.15,-1618.97 2521.68,-1608.32 2505.08,-1598.21"/>
<polygon fill="black" stroke="black" points="2506.86,-1595.19 2496.5,-1592.97 2503.21,-1601.17 2506.86,-1595.19"/>
</g>
<!-- layer3_expert15_13 -->
<g id="node195" class="node">
<title>layer3_expert15_13</title>
<polygon fill="lightgreen" stroke="black" points="2709,-1592.95 2535,-1592.95 2535,-1509.95 2709,-1509.95 2709,-1592.95"/>
<text text-anchor="middle" x="2622" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU15</text>
<text text-anchor="middle" x="2622" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2622" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2622" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2622" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_13 -->
<g id="edge332" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2622,-1628.86C2622,-1620.6 2622,-1611.82 2622,-1603.26"/>
<polygon fill="black" stroke="black" points="2625.5,-1602.97 2622,-1592.97 2618.5,-1602.97 2625.5,-1602.97"/>
</g>
<!-- layer3_expert15_14 -->
<g id="node196" class="node">
<title>layer3_expert15_14</title>
<polygon fill="lightgreen" stroke="black" points="2901,-1592.95 2727,-1592.95 2727,-1509.95 2901,-1509.95 2901,-1592.95"/>
<text text-anchor="middle" x="2814" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU15</text>
<text text-anchor="middle" x="2814" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2814" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2814" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2814" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_14 -->
<g id="edge333" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2688.61,-1628.86C2704.85,-1618.97 2722.32,-1608.32 2738.92,-1598.21"/>
<polygon fill="black" stroke="black" points="2740.79,-1601.17 2747.5,-1592.97 2737.14,-1595.19 2740.79,-1601.17"/>
</g>
<!-- layer3_expert15_15 -->
<g id="node197" class="node">
<title>layer3_expert15_15</title>
<polygon fill="lightgreen" stroke="black" points="3093,-1592.95 2919,-1592.95 2919,-1509.95 3093,-1509.95 3093,-1592.95"/>
<text text-anchor="middle" x="3006" y="-1577.75" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU15</text>
<text text-anchor="middle" x="3006" y="-1562.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3006" y="-1547.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3006" y="-1532.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3006" y="-1517.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_15 -->
<g id="edge334" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2744.34,-1640.97C2793.34,-1628.59 2850.28,-1612.96 2909.33,-1593.07"/>
<polygon fill="black" stroke="black" points="2910.48,-1596.37 2918.82,-1589.84 2908.23,-1589.75 2910.48,-1596.37"/>
</g>
<!-- layer3_moe_aggregate_gpu15 -->
<g id="node198" class="node">
<title>layer3_moe_aggregate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2728,-1473.95 2516,-1473.95 2516,-1405.95 2728,-1405.95 2728,-1473.95"/>
<text text-anchor="middle" x="2622" y="-1458.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU15</text>
<text text-anchor="middle" x="2622" y="-1443.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="2622" y="-1428.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2622" y="-1413.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_expert15_12&#45;&gt;layer3_moe_aggregate_gpu15 -->
<g id="edge335" class="edge">
<title>layer3_expert15_12&#45;&gt;layer3_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2501.22,-1509.84C2518.85,-1499.78 2537.68,-1489.04 2555.1,-1479.11"/>
<polygon fill="black" stroke="black" points="2557.11,-1481.99 2564.06,-1474 2553.64,-1475.91 2557.11,-1481.99"/>
</g>
<!-- layer3_expert15_13&#45;&gt;layer3_moe_aggregate_gpu15 -->
<g id="edge336" class="edge">
<title>layer3_expert15_13&#45;&gt;layer3_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2622,-1509.68C2622,-1501.47 2622,-1492.81 2622,-1484.51"/>
<polygon fill="black" stroke="black" points="2625.5,-1484.25 2622,-1474.25 2618.5,-1484.25 2625.5,-1484.25"/>
</g>
<!-- layer3_expert15_14&#45;&gt;layer3_moe_aggregate_gpu15 -->
<g id="edge337" class="edge">
<title>layer3_expert15_14&#45;&gt;layer3_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2742.78,-1509.84C2725.15,-1499.78 2706.32,-1489.04 2688.9,-1479.11"/>
<polygon fill="black" stroke="black" points="2690.36,-1475.91 2679.94,-1474 2686.89,-1481.99 2690.36,-1475.91"/>
</g>
<!-- layer3_expert15_15&#45;&gt;layer3_moe_aggregate_gpu15 -->
<g id="edge338" class="edge">
<title>layer3_expert15_15&#45;&gt;layer3_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2918.85,-1512.97C2915.88,-1511.92 2912.92,-1510.91 2910,-1509.95 2854.24,-1491.65 2790.95,-1475.95 2737.92,-1464.17"/>
<polygon fill="black" stroke="black" points="2738.67,-1460.75 2728.15,-1462.02 2737.16,-1467.59 2738.67,-1460.75"/>
</g>
<!-- layer3_moe_norm_gpu15 -->
<g id="node199" class="node">
<title>layer3_moe_norm_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2099.5,-1369.95 1846.5,-1369.95 1846.5,-1301.95 2099.5,-1301.95 2099.5,-1369.95"/>
<text text-anchor="middle" x="1973" y="-1354.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="1973" y="-1339.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1973" y="-1324.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1973" y="-1309.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_moe_aggregate_gpu15&#45;&gt;layer3_moe_norm_gpu15 -->
<g id="edge339" class="edge">
<title>layer3_moe_aggregate_gpu15&#45;&gt;layer3_moe_norm_gpu15</title>
<path fill="none" stroke="black" d="M2515.92,-1422.28C2405.11,-1404.87 2230.87,-1377.48 2109.78,-1358.45"/>
<polygon fill="black" stroke="black" points="2110.12,-1354.96 2099.69,-1356.87 2109.03,-1361.88 2110.12,-1354.96"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu0 -->
<g id="edge376" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1846.48,-1303.32C1843.3,-1302.82 1840.13,-1302.37 1837,-1301.95 1509.66,-1258.82 681.94,-1321.46 338.32,-1265.98"/>
<polygon fill="black" stroke="black" points="338.74,-1262.5 328.3,-1264.31 337.58,-1269.41 338.74,-1262.5"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu1 -->
<g id="edge377" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1846.48,-1303.34C1843.29,-1302.84 1840.13,-1302.37 1837,-1301.95 1563.93,-1265.32 874.02,-1312.91 584.43,-1266"/>
<polygon fill="black" stroke="black" points="584.74,-1262.5 574.3,-1264.29 583.58,-1269.4 584.74,-1262.5"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu2 -->
<g id="edge378" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1846.47,-1303.36C1843.29,-1302.86 1840.13,-1302.38 1837,-1301.95 1396.27,-1241.25 1272.16,-1343.27 830.46,-1266.06"/>
<polygon fill="black" stroke="black" points="830.76,-1262.56 820.3,-1264.26 829.54,-1269.45 830.76,-1262.56"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu3 -->
<g id="edge379" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1846.47,-1303.41C1843.29,-1302.89 1840.13,-1302.4 1837,-1301.95 1504.68,-1254.23 1410.24,-1326.11 1076.26,-1266.03"/>
<polygon fill="black" stroke="black" points="1076.78,-1262.57 1066.31,-1264.22 1075.52,-1269.45 1076.78,-1262.57"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu4 -->
<g id="edge380" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1846.45,-1303.51C1843.28,-1302.96 1840.12,-1302.44 1837,-1301.95 1613.04,-1267.22 1548.41,-1309.03 1322.18,-1266.03"/>
<polygon fill="black" stroke="black" points="1322.81,-1262.59 1312.33,-1264.13 1321.48,-1269.46 1322.81,-1262.59"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu5 -->
<g id="edge381" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1846.41,-1303.77C1843.24,-1303.14 1840.1,-1302.54 1837,-1301.95 1721.15,-1280.24 1686.8,-1292.32 1567.9,-1266.02"/>
<polygon fill="black" stroke="black" points="1568.57,-1262.59 1558.05,-1263.8 1567.03,-1269.42 1568.57,-1262.59"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu6 -->
<g id="edge382" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1887.71,-1301.95C1861.46,-1291.8 1832.13,-1280.45 1804.27,-1269.67"/>
<polygon fill="black" stroke="black" points="1805.47,-1266.38 1794.88,-1266.04 1802.95,-1272.91 1805.47,-1266.38"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu7 -->
<g id="edge383" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1961.8,-1301.8C1959.02,-1293.57 1955.98,-1284.57 1952.99,-1275.72"/>
<polygon fill="black" stroke="black" points="1956.3,-1274.58 1949.78,-1266.23 1949.66,-1276.82 1956.3,-1274.58"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu8 -->
<g id="edge384" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2035.99,-1301.95C2054.65,-1292.18 2075.41,-1281.3 2095.29,-1270.88"/>
<polygon fill="black" stroke="black" points="2097.12,-1273.88 2104.35,-1266.13 2093.87,-1267.68 2097.12,-1273.88"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu9 -->
<g id="edge385" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2099.52,-1312.15C2159.12,-1300.56 2231.25,-1285.33 2304.07,-1266.13"/>
<polygon fill="black" stroke="black" points="2305.12,-1269.47 2313.88,-1263.52 2303.32,-1262.7 2305.12,-1269.47"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu10 -->
<g id="edge386" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu10</title>
<path fill="none" stroke="black" d="M2099.65,-1327.12C2215.16,-1318.31 2390.35,-1300.72 2549.96,-1266.06"/>
<polygon fill="black" stroke="black" points="2550.95,-1269.42 2559.97,-1263.86 2549.45,-1262.59 2550.95,-1269.42"/>
</g>
<!-- layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu11 -->
<g id="edge387" class="edge">
<title>layer3_moe_norm_gpu15&#45;&gt;layer4_qkv_gpu11</title>
<path fill="none" stroke="black" d="M2099.59,-1333.53C2260.32,-1329.66 2545.81,-1315.9 2795.99,-1266.02"/>
<polygon fill="black" stroke="black" points="2796.89,-1269.41 2806,-1264 2795.5,-1262.54 2796.89,-1269.41"/>
</g>
<!-- layer4_attn_gpu0 -->
<g id="node201" class="node">
<title>layer4_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="250.5,-1146.95 7.5,-1146.95 7.5,-1078.95 250.5,-1078.95 250.5,-1146.95"/>
<text text-anchor="middle" x="129" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="129" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="129" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="129" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer4_qkv_gpu0&#45;&gt;layer4_attn_gpu0 -->
<g id="edge388" class="edge">
<title>layer4_qkv_gpu0&#45;&gt;layer4_attn_gpu0</title>
<path fill="none" stroke="black" d="M182.35,-1182.68C175.41,-1173.74 168.06,-1164.27 161.1,-1155.31"/>
<polygon fill="black" stroke="black" points="163.75,-1153.01 154.85,-1147.25 158.22,-1157.3 163.75,-1153.01"/>
</g>
<!-- layer4_attn_norm_gpu0 -->
<g id="node202" class="node">
<title>layer4_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="249,-1042.95 5,-1042.95 5,-974.95 249,-974.95 249,-1042.95"/>
<text text-anchor="middle" x="127" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="127" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="127" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="127" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer4_attn_gpu0&#45;&gt;layer4_attn_norm_gpu0 -->
<g id="edge389" class="edge">
<title>layer4_attn_gpu0&#45;&gt;layer4_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M128.35,-1078.84C128.19,-1070.73 128.02,-1061.94 127.85,-1053.43"/>
<polygon fill="black" stroke="black" points="131.35,-1053.18 127.65,-1043.25 124.35,-1053.32 131.35,-1053.18"/>
</g>
<!-- layer4_attn_aggregate -->
<g id="node236" class="node">
<title>layer4_attn_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="1568,-938.95 1345,-870.95 1568,-802.95 1791,-870.95 1568,-938.95"/>
<text text-anchor="middle" x="1568" y="-889.75" font-family="Times,serif" font-size="14.00">L4_Attention_Aggregate</text>
<text text-anchor="middle" x="1568" y="-874.75" font-family="Times,serif" font-size="14.00">Input: 12×[1024,2048,4096]</text>
<text text-anchor="middle" x="1568" y="-859.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1568" y="-844.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce across GPUs 0&#45;11</text>
</g>
<!-- layer4_attn_norm_gpu0&#45;&gt;layer4_attn_aggregate -->
<g id="edge390" class="edge">
<title>layer4_attn_norm_gpu0&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M249.24,-976.47C252.18,-975.93 255.11,-975.43 258,-974.95 641.63,-912.01 1095,-887.23 1355.27,-877.69"/>
<polygon fill="black" stroke="black" points="1355.73,-881.17 1365.6,-877.31 1355.48,-874.18 1355.73,-881.17"/>
</g>
<!-- layer4_attn_gpu1 -->
<g id="node204" class="node">
<title>layer4_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="512.5,-1146.95 269.5,-1146.95 269.5,-1078.95 512.5,-1078.95 512.5,-1146.95"/>
<text text-anchor="middle" x="391" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="391" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="391" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="391" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer4_qkv_gpu1&#45;&gt;layer4_attn_gpu1 -->
<g id="edge391" class="edge">
<title>layer4_qkv_gpu1&#45;&gt;layer4_attn_gpu1</title>
<path fill="none" stroke="black" d="M434.31,-1182.68C428.79,-1173.92 422.95,-1164.66 417.41,-1155.86"/>
<polygon fill="black" stroke="black" points="420.28,-1153.85 411.98,-1147.25 414.35,-1157.58 420.28,-1153.85"/>
</g>
<!-- layer4_attn_norm_gpu1 -->
<g id="node205" class="node">
<title>layer4_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="511,-1042.95 267,-1042.95 267,-974.95 511,-974.95 511,-1042.95"/>
<text text-anchor="middle" x="389" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="389" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="389" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="389" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer4_attn_gpu1&#45;&gt;layer4_attn_norm_gpu1 -->
<g id="edge392" class="edge">
<title>layer4_attn_gpu1&#45;&gt;layer4_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M390.35,-1078.84C390.19,-1070.73 390.02,-1061.94 389.85,-1053.43"/>
<polygon fill="black" stroke="black" points="393.35,-1053.18 389.65,-1043.25 386.35,-1053.32 393.35,-1053.18"/>
</g>
<!-- layer4_attn_norm_gpu1&#45;&gt;layer4_attn_aggregate -->
<g id="edge393" class="edge">
<title>layer4_attn_norm_gpu1&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M511.25,-976.55C514.19,-975.99 517.11,-975.46 520,-974.95 813.95,-923.78 1159.03,-895.99 1370.59,-882.57"/>
<polygon fill="black" stroke="black" points="1371.11,-886.04 1380.87,-881.92 1370.67,-879.06 1371.11,-886.04"/>
</g>
<!-- layer4_attn_gpu2 -->
<g id="node207" class="node">
<title>layer4_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="773.5,-1146.95 530.5,-1146.95 530.5,-1078.95 773.5,-1078.95 773.5,-1146.95"/>
<text text-anchor="middle" x="652" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="652" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="652" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="652" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer4_qkv_gpu2&#45;&gt;layer4_attn_gpu2 -->
<g id="edge394" class="edge">
<title>layer4_qkv_gpu2&#45;&gt;layer4_attn_gpu2</title>
<path fill="none" stroke="black" d="M685.89,-1182.68C681.66,-1174.11 677.19,-1165.04 672.94,-1156.41"/>
<polygon fill="black" stroke="black" points="675.98,-1154.67 668.42,-1147.25 669.71,-1157.77 675.98,-1154.67"/>
</g>
<!-- layer4_attn_norm_gpu2 -->
<g id="node208" class="node">
<title>layer4_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="773,-1042.95 529,-1042.95 529,-974.95 773,-974.95 773,-1042.95"/>
<text text-anchor="middle" x="651" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="651" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="651" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="651" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer4_attn_gpu2&#45;&gt;layer4_attn_norm_gpu2 -->
<g id="edge395" class="edge">
<title>layer4_attn_gpu2&#45;&gt;layer4_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M651.68,-1078.84C651.6,-1070.73 651.51,-1061.94 651.43,-1053.43"/>
<polygon fill="black" stroke="black" points="654.92,-1053.22 651.33,-1043.25 647.92,-1053.29 654.92,-1053.22"/>
</g>
<!-- layer4_attn_norm_gpu2&#45;&gt;layer4_attn_aggregate -->
<g id="edge396" class="edge">
<title>layer4_attn_norm_gpu2&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M773.28,-976.67C776.21,-976.08 779.12,-975.5 782,-974.95 989.52,-935.36 1230.78,-906.21 1390.7,-889.22"/>
<polygon fill="black" stroke="black" points="1391.54,-892.65 1401.12,-888.12 1390.8,-885.69 1391.54,-892.65"/>
</g>
<!-- layer4_attn_gpu3 -->
<g id="node210" class="node">
<title>layer4_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1035.5,-1146.95 792.5,-1146.95 792.5,-1078.95 1035.5,-1078.95 1035.5,-1146.95"/>
<text text-anchor="middle" x="914" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="914" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="914" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="914" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer4_qkv_gpu3&#45;&gt;layer4_attn_gpu3 -->
<g id="edge397" class="edge">
<title>layer4_qkv_gpu3&#45;&gt;layer4_attn_gpu3</title>
<path fill="none" stroke="black" d="M937.85,-1182.68C934.94,-1174.29 931.86,-1165.43 928.92,-1156.96"/>
<polygon fill="black" stroke="black" points="932.14,-1155.55 925.56,-1147.25 925.53,-1157.85 932.14,-1155.55"/>
</g>
<!-- layer4_attn_norm_gpu3 -->
<g id="node211" class="node">
<title>layer4_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1035,-1042.95 791,-1042.95 791,-974.95 1035,-974.95 1035,-1042.95"/>
<text text-anchor="middle" x="913" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="913" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="913" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="913" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer4_attn_gpu3&#45;&gt;layer4_attn_norm_gpu3 -->
<g id="edge398" class="edge">
<title>layer4_attn_gpu3&#45;&gt;layer4_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M913.68,-1078.84C913.6,-1070.73 913.51,-1061.94 913.43,-1053.43"/>
<polygon fill="black" stroke="black" points="916.92,-1053.22 913.33,-1043.25 909.92,-1053.29 916.92,-1053.22"/>
</g>
<!-- layer4_attn_norm_gpu3&#45;&gt;layer4_attn_aggregate -->
<g id="edge399" class="edge">
<title>layer4_attn_norm_gpu3&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M1035.33,-976.92C1038.25,-976.25 1041.14,-975.59 1044,-974.95 1170.42,-946.63 1314.96,-918.53 1420.17,-898.86"/>
<polygon fill="black" stroke="black" points="1421.04,-902.26 1430.23,-896.98 1419.75,-895.38 1421.04,-902.26"/>
</g>
<!-- layer4_attn_gpu4 -->
<g id="node213" class="node">
<title>layer4_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1296.5,-1146.95 1053.5,-1146.95 1053.5,-1078.95 1296.5,-1078.95 1296.5,-1146.95"/>
<text text-anchor="middle" x="1175" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="1175" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1175" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1175" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_qkv_gpu4&#45;&gt;layer4_attn_gpu4 -->
<g id="edge400" class="edge">
<title>layer4_qkv_gpu4&#45;&gt;layer4_attn_gpu4</title>
<path fill="none" stroke="black" d="M1189.44,-1182.68C1187.69,-1174.38 1185.85,-1165.62 1184.09,-1157.24"/>
<polygon fill="black" stroke="black" points="1187.48,-1156.32 1181.99,-1147.25 1180.62,-1157.76 1187.48,-1156.32"/>
</g>
<!-- layer4_attn_norm_gpu4 -->
<g id="node214" class="node">
<title>layer4_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1297,-1042.95 1053,-1042.95 1053,-974.95 1297,-974.95 1297,-1042.95"/>
<text text-anchor="middle" x="1175" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="1175" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1175" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1175" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_attn_gpu4&#45;&gt;layer4_attn_norm_gpu4 -->
<g id="edge401" class="edge">
<title>layer4_attn_gpu4&#45;&gt;layer4_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M1175,-1078.84C1175,-1070.73 1175,-1061.94 1175,-1053.43"/>
<polygon fill="black" stroke="black" points="1178.5,-1053.25 1175,-1043.25 1171.5,-1053.25 1178.5,-1053.25"/>
</g>
<!-- layer4_attn_norm_gpu4&#45;&gt;layer4_attn_aggregate -->
<g id="edge402" class="edge">
<title>layer4_attn_norm_gpu4&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M1270.39,-974.94C1326.12,-955.66 1396.78,-931.2 1455.26,-910.97"/>
<polygon fill="black" stroke="black" points="1456.61,-914.21 1464.91,-907.63 1454.32,-907.59 1456.61,-914.21"/>
</g>
<!-- layer4_attn_gpu5 -->
<g id="node216" class="node">
<title>layer4_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1558.5,-1146.95 1315.5,-1146.95 1315.5,-1078.95 1558.5,-1078.95 1558.5,-1146.95"/>
<text text-anchor="middle" x="1437" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="1437" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1437" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1437" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_qkv_gpu5&#45;&gt;layer4_attn_gpu5 -->
<g id="edge403" class="edge">
<title>layer4_qkv_gpu5&#45;&gt;layer4_attn_gpu5</title>
<path fill="none" stroke="black" d="M1441.39,-1182.68C1440.86,-1174.38 1440.3,-1165.62 1439.77,-1157.24"/>
<polygon fill="black" stroke="black" points="1443.26,-1157.01 1439.13,-1147.25 1436.27,-1157.46 1443.26,-1157.01"/>
</g>
<!-- layer4_attn_norm_gpu5 -->
<g id="node217" class="node">
<title>layer4_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1559,-1042.95 1315,-1042.95 1315,-974.95 1559,-974.95 1559,-1042.95"/>
<text text-anchor="middle" x="1437" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="1437" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1437" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1437" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_attn_gpu5&#45;&gt;layer4_attn_norm_gpu5 -->
<g id="edge404" class="edge">
<title>layer4_attn_gpu5&#45;&gt;layer4_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M1437,-1078.84C1437,-1070.73 1437,-1061.94 1437,-1053.43"/>
<polygon fill="black" stroke="black" points="1440.5,-1053.25 1437,-1043.25 1433.5,-1053.25 1440.5,-1053.25"/>
</g>
<!-- layer4_attn_norm_gpu5&#45;&gt;layer4_attn_aggregate -->
<g id="edge405" class="edge">
<title>layer4_attn_norm_gpu5&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M1469.05,-974.68C1481.67,-961.57 1496.57,-946.11 1510.92,-931.21"/>
<polygon fill="black" stroke="black" points="1513.49,-933.59 1517.91,-923.96 1508.45,-928.73 1513.49,-933.59"/>
</g>
<!-- layer4_attn_gpu6 -->
<g id="node219" class="node">
<title>layer4_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1819.5,-1146.95 1576.5,-1146.95 1576.5,-1078.95 1819.5,-1078.95 1819.5,-1146.95"/>
<text text-anchor="middle" x="1698" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="1698" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1698" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1698" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_qkv_gpu6&#45;&gt;layer4_attn_gpu6 -->
<g id="edge406" class="edge">
<title>layer4_qkv_gpu6&#45;&gt;layer4_attn_gpu6</title>
<path fill="none" stroke="black" d="M1692.98,-1182.68C1693.59,-1174.38 1694.23,-1165.62 1694.84,-1157.24"/>
<polygon fill="black" stroke="black" points="1698.33,-1157.48 1695.57,-1147.25 1691.35,-1156.97 1698.33,-1157.48"/>
</g>
<!-- layer4_attn_norm_gpu6 -->
<g id="node220" class="node">
<title>layer4_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="1821,-1042.95 1577,-1042.95 1577,-974.95 1821,-974.95 1821,-1042.95"/>
<text text-anchor="middle" x="1699" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="1699" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1699" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1699" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_attn_gpu6&#45;&gt;layer4_attn_norm_gpu6 -->
<g id="edge407" class="edge">
<title>layer4_attn_gpu6&#45;&gt;layer4_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M1698.32,-1078.84C1698.4,-1070.73 1698.49,-1061.94 1698.57,-1053.43"/>
<polygon fill="black" stroke="black" points="1702.08,-1053.29 1698.67,-1043.25 1695.08,-1053.22 1702.08,-1053.29"/>
</g>
<!-- layer4_attn_norm_gpu6&#45;&gt;layer4_attn_aggregate -->
<g id="edge408" class="edge">
<title>layer4_attn_norm_gpu6&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M1666.95,-974.68C1654.33,-961.57 1639.43,-946.11 1625.08,-931.21"/>
<polygon fill="black" stroke="black" points="1627.55,-928.73 1618.09,-923.96 1622.51,-933.59 1627.55,-928.73"/>
</g>
<!-- layer4_attn_gpu7 -->
<g id="node222" class="node">
<title>layer4_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2081.5,-1146.95 1838.5,-1146.95 1838.5,-1078.95 2081.5,-1078.95 2081.5,-1146.95"/>
<text text-anchor="middle" x="1960" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="1960" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="1960" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1960" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_qkv_gpu7&#45;&gt;layer4_attn_gpu7 -->
<g id="edge409" class="edge">
<title>layer4_qkv_gpu7&#45;&gt;layer4_attn_gpu7</title>
<path fill="none" stroke="black" d="M1944.94,-1182.68C1946.76,-1174.38 1948.68,-1165.62 1950.51,-1157.24"/>
<polygon fill="black" stroke="black" points="1953.98,-1157.77 1952.7,-1147.25 1947.14,-1156.27 1953.98,-1157.77"/>
</g>
<!-- layer4_attn_norm_gpu7 -->
<g id="node223" class="node">
<title>layer4_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2083,-1042.95 1839,-1042.95 1839,-974.95 2083,-974.95 2083,-1042.95"/>
<text text-anchor="middle" x="1961" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="1961" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1961" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1961" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_attn_gpu7&#45;&gt;layer4_attn_norm_gpu7 -->
<g id="edge410" class="edge">
<title>layer4_attn_gpu7&#45;&gt;layer4_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M1960.32,-1078.84C1960.4,-1070.73 1960.49,-1061.94 1960.57,-1053.43"/>
<polygon fill="black" stroke="black" points="1964.08,-1053.29 1960.67,-1043.25 1957.08,-1053.22 1964.08,-1053.29"/>
</g>
<!-- layer4_attn_norm_gpu7&#45;&gt;layer4_attn_aggregate -->
<g id="edge411" class="edge">
<title>layer4_attn_norm_gpu7&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M1865.61,-974.94C1809.88,-955.66 1739.22,-931.2 1680.74,-910.97"/>
<polygon fill="black" stroke="black" points="1681.68,-907.59 1671.09,-907.63 1679.39,-914.21 1681.68,-907.59"/>
</g>
<!-- layer4_attn_gpu8 -->
<g id="node225" class="node">
<title>layer4_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2343.5,-1146.95 2100.5,-1146.95 2100.5,-1078.95 2343.5,-1078.95 2343.5,-1146.95"/>
<text text-anchor="middle" x="2222" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU8</text>
<text text-anchor="middle" x="2222" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2222" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2222" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer4_qkv_gpu8&#45;&gt;layer4_attn_gpu8 -->
<g id="edge412" class="edge">
<title>layer4_qkv_gpu8&#45;&gt;layer4_attn_gpu8</title>
<path fill="none" stroke="black" d="M2196.89,-1182.68C2199.99,-1174.2 2203.27,-1165.24 2206.39,-1156.68"/>
<polygon fill="black" stroke="black" points="2209.69,-1157.85 2209.84,-1147.25 2203.12,-1155.44 2209.69,-1157.85"/>
</g>
<!-- layer4_attn_norm_gpu8 -->
<g id="node226" class="node">
<title>layer4_attn_norm_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2345,-1042.95 2101,-1042.95 2101,-974.95 2345,-974.95 2345,-1042.95"/>
<text text-anchor="middle" x="2223" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="2223" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2223" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2223" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer4_attn_gpu8&#45;&gt;layer4_attn_norm_gpu8 -->
<g id="edge413" class="edge">
<title>layer4_attn_gpu8&#45;&gt;layer4_attn_norm_gpu8</title>
<path fill="none" stroke="black" d="M2222.32,-1078.84C2222.4,-1070.73 2222.49,-1061.94 2222.57,-1053.43"/>
<polygon fill="black" stroke="black" points="2226.08,-1053.29 2222.67,-1043.25 2219.08,-1053.22 2226.08,-1053.29"/>
</g>
<!-- layer4_attn_norm_gpu8&#45;&gt;layer4_attn_aggregate -->
<g id="edge414" class="edge">
<title>layer4_attn_norm_gpu8&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M2100.67,-976.92C2097.75,-976.25 2094.86,-975.59 2092,-974.95 1965.58,-946.63 1821.04,-918.53 1715.83,-898.86"/>
<polygon fill="black" stroke="black" points="1716.25,-895.38 1705.77,-896.98 1714.96,-902.26 1716.25,-895.38"/>
</g>
<!-- layer4_attn_gpu9 -->
<g id="node228" class="node">
<title>layer4_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2605.5,-1146.95 2362.5,-1146.95 2362.5,-1078.95 2605.5,-1078.95 2605.5,-1146.95"/>
<text text-anchor="middle" x="2484" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU9</text>
<text text-anchor="middle" x="2484" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2484" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2484" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer4_qkv_gpu9&#45;&gt;layer4_attn_gpu9 -->
<g id="edge415" class="edge">
<title>layer4_qkv_gpu9&#45;&gt;layer4_attn_gpu9</title>
<path fill="none" stroke="black" d="M2448.85,-1182.68C2453.24,-1174.11 2457.87,-1165.04 2462.29,-1156.41"/>
<polygon fill="black" stroke="black" points="2465.53,-1157.75 2466.97,-1147.25 2459.3,-1154.56 2465.53,-1157.75"/>
</g>
<!-- layer4_attn_norm_gpu9 -->
<g id="node229" class="node">
<title>layer4_attn_norm_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2607,-1042.95 2363,-1042.95 2363,-974.95 2607,-974.95 2607,-1042.95"/>
<text text-anchor="middle" x="2485" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="2485" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2485" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2485" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer4_attn_gpu9&#45;&gt;layer4_attn_norm_gpu9 -->
<g id="edge416" class="edge">
<title>layer4_attn_gpu9&#45;&gt;layer4_attn_norm_gpu9</title>
<path fill="none" stroke="black" d="M2484.32,-1078.84C2484.4,-1070.73 2484.49,-1061.94 2484.57,-1053.43"/>
<polygon fill="black" stroke="black" points="2488.08,-1053.29 2484.67,-1043.25 2481.08,-1053.22 2488.08,-1053.29"/>
</g>
<!-- layer4_attn_norm_gpu9&#45;&gt;layer4_attn_aggregate -->
<g id="edge417" class="edge">
<title>layer4_attn_norm_gpu9&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M2362.72,-976.67C2359.79,-976.08 2356.88,-975.5 2354,-974.95 2146.48,-935.36 1905.22,-906.21 1745.3,-889.22"/>
<polygon fill="black" stroke="black" points="1745.2,-885.69 1734.88,-888.12 1744.46,-892.65 1745.2,-885.69"/>
</g>
<!-- layer4_attn_gpu10 -->
<g id="node231" class="node">
<title>layer4_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2877,-1146.95 2625,-1146.95 2625,-1078.95 2877,-1078.95 2877,-1146.95"/>
<text text-anchor="middle" x="2751" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU10</text>
<text text-anchor="middle" x="2751" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="2751" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2751" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer4_qkv_gpu10&#45;&gt;layer4_attn_gpu10 -->
<g id="edge418" class="edge">
<title>layer4_qkv_gpu10&#45;&gt;layer4_attn_gpu10</title>
<path fill="none" stroke="black" d="M2702.67,-1182.68C2708.89,-1173.83 2715.48,-1164.46 2721.73,-1155.58"/>
<polygon fill="black" stroke="black" points="2724.69,-1157.45 2727.58,-1147.25 2718.97,-1153.42 2724.69,-1157.45"/>
</g>
<!-- layer4_attn_norm_gpu10 -->
<g id="node232" class="node">
<title>layer4_attn_norm_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="2878.5,-1042.95 2625.5,-1042.95 2625.5,-974.95 2878.5,-974.95 2878.5,-1042.95"/>
<text text-anchor="middle" x="2752" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="2752" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2752" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2752" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer4_attn_gpu10&#45;&gt;layer4_attn_norm_gpu10 -->
<g id="edge419" class="edge">
<title>layer4_attn_gpu10&#45;&gt;layer4_attn_norm_gpu10</title>
<path fill="none" stroke="black" d="M2751.32,-1078.84C2751.4,-1070.73 2751.49,-1061.94 2751.57,-1053.43"/>
<polygon fill="black" stroke="black" points="2755.08,-1053.29 2751.67,-1043.25 2748.08,-1053.22 2755.08,-1053.29"/>
</g>
<!-- layer4_attn_norm_gpu10&#45;&gt;layer4_attn_aggregate -->
<g id="edge420" class="edge">
<title>layer4_attn_norm_gpu10&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M2625.43,-976.63C2622.26,-976.04 2619.11,-975.48 2616,-974.95 2321.39,-924.99 1975.77,-896.84 1764.37,-883.01"/>
<polygon fill="black" stroke="black" points="1764.3,-879.5 1754.09,-882.35 1763.84,-886.49 1764.3,-879.5"/>
</g>
<!-- layer4_attn_gpu11 -->
<g id="node234" class="node">
<title>layer4_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3148,-1146.95 2896,-1146.95 2896,-1078.95 3148,-1078.95 3148,-1146.95"/>
<text text-anchor="middle" x="3022" y="-1131.75" font-family="Times,serif" font-size="14.00">L4_Multi&#45;Head_Attention_GPU11</text>
<text text-anchor="middle" x="3022" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024, 2048, 3*4096]</text>
<text text-anchor="middle" x="3022" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3022" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer4_qkv_gpu11&#45;&gt;layer4_attn_gpu11 -->
<g id="edge421" class="edge">
<title>layer4_qkv_gpu11&#45;&gt;layer4_attn_gpu11</title>
<path fill="none" stroke="black" d="M2957.98,-1182.68C2966.48,-1173.56 2975.49,-1163.88 2983.99,-1154.76"/>
<polygon fill="black" stroke="black" points="2986.73,-1156.96 2990.98,-1147.25 2981.6,-1152.18 2986.73,-1156.96"/>
</g>
<!-- layer4_attn_norm_gpu11 -->
<g id="node235" class="node">
<title>layer4_attn_norm_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3149.5,-1042.95 2896.5,-1042.95 2896.5,-974.95 3149.5,-974.95 3149.5,-1042.95"/>
<text text-anchor="middle" x="3023" y="-1027.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="3023" y="-1012.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="3023" y="-997.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3023" y="-982.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer4_attn_gpu11&#45;&gt;layer4_attn_norm_gpu11 -->
<g id="edge422" class="edge">
<title>layer4_attn_gpu11&#45;&gt;layer4_attn_norm_gpu11</title>
<path fill="none" stroke="black" d="M3022.32,-1078.84C3022.4,-1070.73 3022.49,-1061.94 3022.57,-1053.43"/>
<polygon fill="black" stroke="black" points="3026.08,-1053.29 3022.67,-1043.25 3019.08,-1053.22 3026.08,-1053.29"/>
</g>
<!-- layer4_attn_norm_gpu11&#45;&gt;layer4_attn_aggregate -->
<g id="edge423" class="edge">
<title>layer4_attn_norm_gpu11&#45;&gt;layer4_attn_aggregate</title>
<path fill="none" stroke="black" d="M2896.45,-976.54C2893.27,-975.98 2890.12,-975.45 2887,-974.95 2499.2,-913.17 2041.09,-887.97 1779.55,-878.05"/>
<polygon fill="black" stroke="black" points="1779.29,-874.53 1769.17,-877.66 1779.03,-881.53 1779.29,-874.53"/>
</g>
<!-- layer4_moe_broadcast -->
<g id="node237" class="node">
<title>layer4_moe_broadcast</title>
<polygon fill="yellow" stroke="black" points="1800.47,-766.95 1430.66,-766.95 1335.53,-630.95 1705.34,-630.95 1800.47,-766.95"/>
<text text-anchor="middle" x="1568" y="-717.75" font-family="Times,serif" font-size="14.00">L4_Broadcast_to_MoE</text>
<text text-anchor="middle" x="1568" y="-702.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1568" y="-687.75" font-family="Times,serif" font-size="14.00">Output: 4×[1024,2048,4096]</text>
<text text-anchor="middle" x="1568" y="-672.75" font-family="Times,serif" font-size="14.00">Broadcast to GPUs 12&#45;15</text>
</g>
<!-- layer4_attn_aggregate&#45;&gt;layer4_moe_broadcast -->
<g id="edge424" class="edge">
<title>layer4_attn_aggregate&#45;&gt;layer4_moe_broadcast</title>
<path fill="none" stroke="black" d="M1568,-802.76C1568,-794.45 1568,-785.9 1568,-777.45"/>
<polygon fill="black" stroke="black" points="1571.5,-777.21 1568,-767.21 1564.5,-777.21 1571.5,-777.21"/>
</g>
<!-- layer4_gate_gpu12 -->
<g id="node238" class="node">
<title>layer4_gate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="634,-594.95 390,-594.95 390,-511.95 634,-511.95 634,-594.95"/>
<text text-anchor="middle" x="512" y="-579.75" font-family="Times,serif" font-size="14.00">L4_Gate_GPU12</text>
<text text-anchor="middle" x="512" y="-564.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="512" y="-549.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="512" y="-534.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="512" y="-519.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_moe_broadcast&#45;&gt;layer4_gate_gpu12 -->
<g id="edge425" class="edge">
<title>layer4_moe_broadcast&#45;&gt;layer4_gate_gpu12</title>
<path fill="none" stroke="black" d="M1362.83,-670.07C1150.43,-641.21 824.92,-596.98 644.31,-572.43"/>
<polygon fill="black" stroke="black" points="644.6,-568.94 634.22,-571.06 643.66,-575.88 644.6,-568.94"/>
</g>
<!-- layer4_gate_gpu13 -->
<g id="node245" class="node">
<title>layer4_gate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1402,-594.95 1158,-594.95 1158,-511.95 1402,-511.95 1402,-594.95"/>
<text text-anchor="middle" x="1280" y="-579.75" font-family="Times,serif" font-size="14.00">L4_Gate_GPU13</text>
<text text-anchor="middle" x="1280" y="-564.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1280" y="-549.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1280" y="-534.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="1280" y="-519.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_moe_broadcast&#45;&gt;layer4_gate_gpu13 -->
<g id="edge435" class="edge">
<title>layer4_moe_broadcast&#45;&gt;layer4_gate_gpu13</title>
<path fill="none" stroke="black" d="M1433.28,-630.82C1411.95,-620.2 1390.35,-609.44 1370.36,-599.47"/>
<polygon fill="black" stroke="black" points="1371.8,-596.28 1361.29,-594.96 1368.68,-602.55 1371.8,-596.28"/>
</g>
<!-- layer4_gate_gpu14 -->
<g id="node252" class="node">
<title>layer4_gate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1978,-594.95 1734,-594.95 1734,-511.95 1978,-511.95 1978,-594.95"/>
<text text-anchor="middle" x="1856" y="-579.75" font-family="Times,serif" font-size="14.00">L4_Gate_GPU14</text>
<text text-anchor="middle" x="1856" y="-564.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1856" y="-549.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1856" y="-534.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="1856" y="-519.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_moe_broadcast&#45;&gt;layer4_gate_gpu14 -->
<g id="edge445" class="edge">
<title>layer4_moe_broadcast&#45;&gt;layer4_gate_gpu14</title>
<path fill="none" stroke="black" d="M1702.72,-630.82C1724.05,-620.2 1745.65,-609.44 1765.64,-599.47"/>
<polygon fill="black" stroke="black" points="1767.32,-602.55 1774.71,-594.96 1764.2,-596.28 1767.32,-602.55"/>
</g>
<!-- layer4_gate_gpu15 -->
<g id="node259" class="node">
<title>layer4_gate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2746,-594.95 2502,-594.95 2502,-511.95 2746,-511.95 2746,-594.95"/>
<text text-anchor="middle" x="2624" y="-579.75" font-family="Times,serif" font-size="14.00">L4_Gate_GPU15</text>
<text text-anchor="middle" x="2624" y="-564.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2624" y="-549.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="2624" y="-534.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="2624" y="-519.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_moe_broadcast&#45;&gt;layer4_gate_gpu15 -->
<g id="edge455" class="edge">
<title>layer4_moe_broadcast&#45;&gt;layer4_gate_gpu15</title>
<path fill="none" stroke="black" d="M1736.49,-675.06C1946.3,-646.55 2300.33,-598.44 2491.69,-572.43"/>
<polygon fill="black" stroke="black" points="2492.37,-575.87 2501.81,-571.06 2491.43,-568.94 2492.37,-575.87"/>
</g>
<!-- layer4_expert12_0 -->
<g id="node239" class="node">
<title>layer4_expert12_0</title>
<polygon fill="lightgreen" stroke="black" points="215,-475.95 41,-475.95 41,-392.95 215,-392.95 215,-475.95"/>
<text text-anchor="middle" x="128" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert0_GPU12</text>
<text text-anchor="middle" x="128" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="128" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="128" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="128" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_gate_gpu12&#45;&gt;layer4_expert12_0 -->
<g id="edge426" class="edge">
<title>layer4_gate_gpu12&#45;&gt;layer4_expert12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389.66,-523.97C340.66,-511.59 283.72,-495.96 224.67,-476.07"/>
<polygon fill="black" stroke="black" points="225.77,-472.75 215.18,-472.84 223.52,-479.37 225.77,-472.75"/>
</g>
<!-- layer4_expert12_1 -->
<g id="node240" class="node">
<title>layer4_expert12_1</title>
<polygon fill="lightgreen" stroke="black" points="407,-475.95 233,-475.95 233,-392.95 407,-392.95 407,-475.95"/>
<text text-anchor="middle" x="320" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert1_GPU12</text>
<text text-anchor="middle" x="320" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="320" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="320" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="320" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_gate_gpu12&#45;&gt;layer4_expert12_1 -->
<g id="edge427" class="edge">
<title>layer4_gate_gpu12&#45;&gt;layer4_expert12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445.39,-511.86C429.15,-501.97 411.68,-491.32 395.08,-481.21"/>
<polygon fill="black" stroke="black" points="396.86,-478.19 386.5,-475.97 393.21,-484.17 396.86,-478.19"/>
</g>
<!-- layer4_expert12_2 -->
<g id="node241" class="node">
<title>layer4_expert12_2</title>
<polygon fill="lightgreen" stroke="black" points="599,-475.95 425,-475.95 425,-392.95 599,-392.95 599,-475.95"/>
<text text-anchor="middle" x="512" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert2_GPU12</text>
<text text-anchor="middle" x="512" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="512" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="512" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="512" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_gate_gpu12&#45;&gt;layer4_expert12_2 -->
<g id="edge428" class="edge">
<title>layer4_gate_gpu12&#45;&gt;layer4_expert12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M512,-511.86C512,-503.6 512,-494.82 512,-486.26"/>
<polygon fill="black" stroke="black" points="515.5,-485.97 512,-475.97 508.5,-485.97 515.5,-485.97"/>
</g>
<!-- layer4_expert12_3 -->
<g id="node242" class="node">
<title>layer4_expert12_3</title>
<polygon fill="lightgreen" stroke="black" points="791,-475.95 617,-475.95 617,-392.95 791,-392.95 791,-475.95"/>
<text text-anchor="middle" x="704" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert3_GPU12</text>
<text text-anchor="middle" x="704" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="704" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="704" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="704" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_gate_gpu12&#45;&gt;layer4_expert12_3 -->
<g id="edge429" class="edge">
<title>layer4_gate_gpu12&#45;&gt;layer4_expert12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M578.61,-511.86C594.85,-501.97 612.32,-491.32 628.92,-481.21"/>
<polygon fill="black" stroke="black" points="630.79,-484.17 637.5,-475.97 627.14,-478.19 630.79,-484.17"/>
</g>
<!-- layer4_moe_aggregate_gpu12 -->
<g id="node243" class="node">
<title>layer4_moe_aggregate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="618,-356.95 406,-356.95 406,-288.95 618,-288.95 618,-356.95"/>
<text text-anchor="middle" x="512" y="-341.75" font-family="Times,serif" font-size="14.00">L4_MoE_Aggregate_GPU12</text>
<text text-anchor="middle" x="512" y="-326.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="512" y="-311.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="512" y="-296.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_expert12_0&#45;&gt;layer4_moe_aggregate_gpu12 -->
<g id="edge430" class="edge">
<title>layer4_expert12_0&#45;&gt;layer4_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M215.15,-395.97C218.12,-394.92 221.08,-393.91 224,-392.95 279.76,-374.65 343.05,-358.95 396.08,-347.17"/>
<polygon fill="black" stroke="black" points="396.84,-350.59 405.85,-345.02 395.33,-343.75 396.84,-350.59"/>
</g>
<!-- layer4_expert12_1&#45;&gt;layer4_moe_aggregate_gpu12 -->
<g id="edge431" class="edge">
<title>layer4_expert12_1&#45;&gt;layer4_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M391.22,-392.84C408.85,-382.78 427.68,-372.04 445.1,-362.11"/>
<polygon fill="black" stroke="black" points="447.11,-364.99 454.06,-357 443.64,-358.91 447.11,-364.99"/>
</g>
<!-- layer4_expert12_2&#45;&gt;layer4_moe_aggregate_gpu12 -->
<g id="edge432" class="edge">
<title>layer4_expert12_2&#45;&gt;layer4_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M512,-392.68C512,-384.47 512,-375.81 512,-367.51"/>
<polygon fill="black" stroke="black" points="515.5,-367.25 512,-357.25 508.5,-367.25 515.5,-367.25"/>
</g>
<!-- layer4_expert12_3&#45;&gt;layer4_moe_aggregate_gpu12 -->
<g id="edge433" class="edge">
<title>layer4_expert12_3&#45;&gt;layer4_moe_aggregate_gpu12</title>
<path fill="none" stroke="black" d="M632.78,-392.84C615.15,-382.78 596.32,-372.04 578.9,-362.11"/>
<polygon fill="black" stroke="black" points="580.36,-358.91 569.94,-357 576.89,-364.99 580.36,-358.91"/>
</g>
<!-- layer4_moe_norm_gpu12 -->
<g id="node244" class="node">
<title>layer4_moe_norm_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="963.5,-252.95 710.5,-252.95 710.5,-184.95 963.5,-184.95 963.5,-252.95"/>
<text text-anchor="middle" x="837" y="-237.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="837" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="837" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="837" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_moe_aggregate_gpu12&#45;&gt;layer4_moe_norm_gpu12 -->
<g id="edge434" class="edge">
<title>layer4_moe_aggregate_gpu12&#45;&gt;layer4_moe_norm_gpu12</title>
<path fill="none" stroke="black" d="M617.52,-288.84C650.84,-278.38 687.81,-266.78 721.77,-256.12"/>
<polygon fill="black" stroke="black" points="723.24,-259.32 731.73,-252.99 721.14,-252.65 723.24,-259.32"/>
</g>
<!-- output -->
<g id="node266" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="1491" cy="-111.48" rx="292.07" ry="37.45"/>
<text text-anchor="middle" x="1491" y="-122.78" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="1491" y="-107.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="1491" y="-92.78" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- layer4_moe_norm_gpu12&#45;&gt;output -->
<g id="edge465" class="edge">
<title>layer4_moe_norm_gpu12&#45;&gt;output</title>
<path fill="none" stroke="black" d="M963.87,-197.49C1060.14,-181.97 1194.01,-160.38 1302.74,-142.84"/>
<polygon fill="black" stroke="black" points="1303.54,-146.26 1312.85,-141.21 1302.42,-139.35 1303.54,-146.26"/>
</g>
<!-- layer4_expert13_4 -->
<g id="node246" class="node">
<title>layer4_expert13_4</title>
<polygon fill="lightgreen" stroke="black" points="983,-475.95 809,-475.95 809,-392.95 983,-392.95 983,-475.95"/>
<text text-anchor="middle" x="896" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert4_GPU13</text>
<text text-anchor="middle" x="896" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="896" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="896" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="896" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_gate_gpu13&#45;&gt;layer4_expert13_4 -->
<g id="edge436" class="edge">
<title>layer4_gate_gpu13&#45;&gt;layer4_expert13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1157.66,-523.97C1108.66,-511.59 1051.72,-495.96 992.67,-476.07"/>
<polygon fill="black" stroke="black" points="993.77,-472.75 983.18,-472.84 991.52,-479.37 993.77,-472.75"/>
</g>
<!-- layer4_expert13_5 -->
<g id="node247" class="node">
<title>layer4_expert13_5</title>
<polygon fill="lightgreen" stroke="black" points="1175,-475.95 1001,-475.95 1001,-392.95 1175,-392.95 1175,-475.95"/>
<text text-anchor="middle" x="1088" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert5_GPU13</text>
<text text-anchor="middle" x="1088" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1088" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1088" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1088" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_gate_gpu13&#45;&gt;layer4_expert13_5 -->
<g id="edge437" class="edge">
<title>layer4_gate_gpu13&#45;&gt;layer4_expert13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1213.39,-511.86C1197.15,-501.97 1179.68,-491.32 1163.08,-481.21"/>
<polygon fill="black" stroke="black" points="1164.86,-478.19 1154.5,-475.97 1161.21,-484.17 1164.86,-478.19"/>
</g>
<!-- layer4_expert13_6 -->
<g id="node248" class="node">
<title>layer4_expert13_6</title>
<polygon fill="lightgreen" stroke="black" points="1367,-475.95 1193,-475.95 1193,-392.95 1367,-392.95 1367,-475.95"/>
<text text-anchor="middle" x="1280" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert6_GPU13</text>
<text text-anchor="middle" x="1280" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1280" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1280" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1280" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_gate_gpu13&#45;&gt;layer4_expert13_6 -->
<g id="edge438" class="edge">
<title>layer4_gate_gpu13&#45;&gt;layer4_expert13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1280,-511.86C1280,-503.6 1280,-494.82 1280,-486.26"/>
<polygon fill="black" stroke="black" points="1283.5,-485.97 1280,-475.97 1276.5,-485.97 1283.5,-485.97"/>
</g>
<!-- layer4_expert13_7 -->
<g id="node249" class="node">
<title>layer4_expert13_7</title>
<polygon fill="lightgreen" stroke="black" points="1559,-475.95 1385,-475.95 1385,-392.95 1559,-392.95 1559,-475.95"/>
<text text-anchor="middle" x="1472" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert7_GPU13</text>
<text text-anchor="middle" x="1472" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1472" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1472" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1472" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_gate_gpu13&#45;&gt;layer4_expert13_7 -->
<g id="edge439" class="edge">
<title>layer4_gate_gpu13&#45;&gt;layer4_expert13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1346.61,-511.86C1362.85,-501.97 1380.32,-491.32 1396.92,-481.21"/>
<polygon fill="black" stroke="black" points="1398.79,-484.17 1405.5,-475.97 1395.14,-478.19 1398.79,-484.17"/>
</g>
<!-- layer4_moe_aggregate_gpu13 -->
<g id="node250" class="node">
<title>layer4_moe_aggregate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1386,-356.95 1174,-356.95 1174,-288.95 1386,-288.95 1386,-356.95"/>
<text text-anchor="middle" x="1280" y="-341.75" font-family="Times,serif" font-size="14.00">L4_MoE_Aggregate_GPU13</text>
<text text-anchor="middle" x="1280" y="-326.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="1280" y="-311.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1280" y="-296.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_expert13_4&#45;&gt;layer4_moe_aggregate_gpu13 -->
<g id="edge440" class="edge">
<title>layer4_expert13_4&#45;&gt;layer4_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M983.15,-395.97C986.12,-394.92 989.08,-393.91 992,-392.95 1047.76,-374.65 1111.05,-358.95 1164.08,-347.17"/>
<polygon fill="black" stroke="black" points="1164.84,-350.59 1173.85,-345.02 1163.33,-343.75 1164.84,-350.59"/>
</g>
<!-- layer4_expert13_5&#45;&gt;layer4_moe_aggregate_gpu13 -->
<g id="edge441" class="edge">
<title>layer4_expert13_5&#45;&gt;layer4_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1159.22,-392.84C1176.85,-382.78 1195.68,-372.04 1213.1,-362.11"/>
<polygon fill="black" stroke="black" points="1215.11,-364.99 1222.06,-357 1211.64,-358.91 1215.11,-364.99"/>
</g>
<!-- layer4_expert13_6&#45;&gt;layer4_moe_aggregate_gpu13 -->
<g id="edge442" class="edge">
<title>layer4_expert13_6&#45;&gt;layer4_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1280,-392.68C1280,-384.47 1280,-375.81 1280,-367.51"/>
<polygon fill="black" stroke="black" points="1283.5,-367.25 1280,-357.25 1276.5,-367.25 1283.5,-367.25"/>
</g>
<!-- layer4_expert13_7&#45;&gt;layer4_moe_aggregate_gpu13 -->
<g id="edge443" class="edge">
<title>layer4_expert13_7&#45;&gt;layer4_moe_aggregate_gpu13</title>
<path fill="none" stroke="black" d="M1400.78,-392.84C1383.15,-382.78 1364.32,-372.04 1346.9,-362.11"/>
<polygon fill="black" stroke="black" points="1348.36,-358.91 1337.94,-357 1344.89,-364.99 1348.36,-358.91"/>
</g>
<!-- layer4_moe_norm_gpu13 -->
<g id="node251" class="node">
<title>layer4_moe_norm_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1482.5,-252.95 1229.5,-252.95 1229.5,-184.95 1482.5,-184.95 1482.5,-252.95"/>
<text text-anchor="middle" x="1356" y="-237.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="1356" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1356" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1356" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_moe_aggregate_gpu13&#45;&gt;layer4_moe_norm_gpu13 -->
<g id="edge444" class="edge">
<title>layer4_moe_aggregate_gpu13&#45;&gt;layer4_moe_norm_gpu13</title>
<path fill="none" stroke="black" d="M1304.68,-288.84C1311.18,-280.11 1318.28,-270.58 1325.07,-261.47"/>
<polygon fill="black" stroke="black" points="1328.02,-263.36 1331.19,-253.25 1322.41,-259.18 1328.02,-263.36"/>
</g>
<!-- layer4_moe_norm_gpu13&#45;&gt;output -->
<g id="edge466" class="edge">
<title>layer4_moe_norm_gpu13&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1398.34,-184.87C1410.4,-175.45 1423.7,-165.06 1436.37,-155.16"/>
<polygon fill="black" stroke="black" points="1438.86,-157.65 1444.59,-148.74 1434.55,-152.14 1438.86,-157.65"/>
</g>
<!-- layer4_expert14_8 -->
<g id="node253" class="node">
<title>layer4_expert14_8</title>
<polygon fill="lightgreen" stroke="black" points="1751,-475.95 1577,-475.95 1577,-392.95 1751,-392.95 1751,-475.95"/>
<text text-anchor="middle" x="1664" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert8_GPU14</text>
<text text-anchor="middle" x="1664" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1664" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1664" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1664" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_gate_gpu14&#45;&gt;layer4_expert14_8 -->
<g id="edge446" class="edge">
<title>layer4_gate_gpu14&#45;&gt;layer4_expert14_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1789.39,-511.86C1773.15,-501.97 1755.68,-491.32 1739.08,-481.21"/>
<polygon fill="black" stroke="black" points="1740.86,-478.19 1730.5,-475.97 1737.21,-484.17 1740.86,-478.19"/>
</g>
<!-- layer4_expert14_9 -->
<g id="node254" class="node">
<title>layer4_expert14_9</title>
<polygon fill="lightgreen" stroke="black" points="1943,-475.95 1769,-475.95 1769,-392.95 1943,-392.95 1943,-475.95"/>
<text text-anchor="middle" x="1856" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert9_GPU14</text>
<text text-anchor="middle" x="1856" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1856" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1856" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1856" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_gate_gpu14&#45;&gt;layer4_expert14_9 -->
<g id="edge447" class="edge">
<title>layer4_gate_gpu14&#45;&gt;layer4_expert14_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1856,-511.86C1856,-503.6 1856,-494.82 1856,-486.26"/>
<polygon fill="black" stroke="black" points="1859.5,-485.97 1856,-475.97 1852.5,-485.97 1859.5,-485.97"/>
</g>
<!-- layer4_expert14_10 -->
<g id="node255" class="node">
<title>layer4_expert14_10</title>
<polygon fill="lightgreen" stroke="black" points="2135,-475.95 1961,-475.95 1961,-392.95 2135,-392.95 2135,-475.95"/>
<text text-anchor="middle" x="2048" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert10_GPU14</text>
<text text-anchor="middle" x="2048" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2048" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2048" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2048" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_gate_gpu14&#45;&gt;layer4_expert14_10 -->
<g id="edge448" class="edge">
<title>layer4_gate_gpu14&#45;&gt;layer4_expert14_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1922.61,-511.86C1938.85,-501.97 1956.32,-491.32 1972.92,-481.21"/>
<polygon fill="black" stroke="black" points="1974.79,-484.17 1981.5,-475.97 1971.14,-478.19 1974.79,-484.17"/>
</g>
<!-- layer4_expert14_11 -->
<g id="node256" class="node">
<title>layer4_expert14_11</title>
<polygon fill="lightgreen" stroke="black" points="2327,-475.95 2153,-475.95 2153,-392.95 2327,-392.95 2327,-475.95"/>
<text text-anchor="middle" x="2240" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert11_GPU14</text>
<text text-anchor="middle" x="2240" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2240" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2240" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2240" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_gate_gpu14&#45;&gt;layer4_expert14_11 -->
<g id="edge449" class="edge">
<title>layer4_gate_gpu14&#45;&gt;layer4_expert14_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1978.34,-523.97C2027.34,-511.59 2084.28,-495.96 2143.33,-476.07"/>
<polygon fill="black" stroke="black" points="2144.48,-479.37 2152.82,-472.84 2142.23,-472.75 2144.48,-479.37"/>
</g>
<!-- layer4_moe_aggregate_gpu14 -->
<g id="node257" class="node">
<title>layer4_moe_aggregate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1962,-356.95 1750,-356.95 1750,-288.95 1962,-288.95 1962,-356.95"/>
<text text-anchor="middle" x="1856" y="-341.75" font-family="Times,serif" font-size="14.00">L4_MoE_Aggregate_GPU14</text>
<text text-anchor="middle" x="1856" y="-326.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="1856" y="-311.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1856" y="-296.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_expert14_8&#45;&gt;layer4_moe_aggregate_gpu14 -->
<g id="edge450" class="edge">
<title>layer4_expert14_8&#45;&gt;layer4_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1735.22,-392.84C1752.85,-382.78 1771.68,-372.04 1789.1,-362.11"/>
<polygon fill="black" stroke="black" points="1791.11,-364.99 1798.06,-357 1787.64,-358.91 1791.11,-364.99"/>
</g>
<!-- layer4_expert14_9&#45;&gt;layer4_moe_aggregate_gpu14 -->
<g id="edge451" class="edge">
<title>layer4_expert14_9&#45;&gt;layer4_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1856,-392.68C1856,-384.47 1856,-375.81 1856,-367.51"/>
<polygon fill="black" stroke="black" points="1859.5,-367.25 1856,-357.25 1852.5,-367.25 1859.5,-367.25"/>
</g>
<!-- layer4_expert14_10&#45;&gt;layer4_moe_aggregate_gpu14 -->
<g id="edge452" class="edge">
<title>layer4_expert14_10&#45;&gt;layer4_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M1976.78,-392.84C1959.15,-382.78 1940.32,-372.04 1922.9,-362.11"/>
<polygon fill="black" stroke="black" points="1924.36,-358.91 1913.94,-357 1920.89,-364.99 1924.36,-358.91"/>
</g>
<!-- layer4_expert14_11&#45;&gt;layer4_moe_aggregate_gpu14 -->
<g id="edge453" class="edge">
<title>layer4_expert14_11&#45;&gt;layer4_moe_aggregate_gpu14</title>
<path fill="none" stroke="black" d="M2152.85,-395.97C2149.88,-394.92 2146.92,-393.91 2144,-392.95 2088.24,-374.65 2024.95,-358.95 1971.92,-347.17"/>
<polygon fill="black" stroke="black" points="1972.67,-343.75 1962.15,-345.02 1971.16,-350.59 1972.67,-343.75"/>
</g>
<!-- layer4_moe_norm_gpu14 -->
<g id="node258" class="node">
<title>layer4_moe_norm_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="1905.5,-252.95 1652.5,-252.95 1652.5,-184.95 1905.5,-184.95 1905.5,-252.95"/>
<text text-anchor="middle" x="1779" y="-237.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="1779" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1779" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1779" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_moe_aggregate_gpu14&#45;&gt;layer4_moe_norm_gpu14 -->
<g id="edge454" class="edge">
<title>layer4_moe_aggregate_gpu14&#45;&gt;layer4_moe_norm_gpu14</title>
<path fill="none" stroke="black" d="M1831,-288.84C1824.41,-280.11 1817.22,-270.58 1810.34,-261.47"/>
<polygon fill="black" stroke="black" points="1812.96,-259.13 1804.14,-253.25 1807.37,-263.34 1812.96,-259.13"/>
</g>
<!-- layer4_moe_norm_gpu14&#45;&gt;output -->
<g id="edge467" class="edge">
<title>layer4_moe_norm_gpu14&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1688.67,-184.87C1658.84,-173.95 1625.43,-161.71 1594.69,-150.45"/>
<polygon fill="black" stroke="black" points="1595.83,-147.14 1585.24,-146.99 1593.43,-153.72 1595.83,-147.14"/>
</g>
<!-- layer4_expert15_12 -->
<g id="node260" class="node">
<title>layer4_expert15_12</title>
<polygon fill="lightgreen" stroke="black" points="2519,-475.95 2345,-475.95 2345,-392.95 2519,-392.95 2519,-475.95"/>
<text text-anchor="middle" x="2432" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert12_GPU15</text>
<text text-anchor="middle" x="2432" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2432" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2432" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2432" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_gate_gpu15&#45;&gt;layer4_expert15_12 -->
<g id="edge456" class="edge">
<title>layer4_gate_gpu15&#45;&gt;layer4_expert15_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2557.39,-511.86C2541.15,-501.97 2523.68,-491.32 2507.08,-481.21"/>
<polygon fill="black" stroke="black" points="2508.86,-478.19 2498.5,-475.97 2505.21,-484.17 2508.86,-478.19"/>
</g>
<!-- layer4_expert15_13 -->
<g id="node261" class="node">
<title>layer4_expert15_13</title>
<polygon fill="lightgreen" stroke="black" points="2711,-475.95 2537,-475.95 2537,-392.95 2711,-392.95 2711,-475.95"/>
<text text-anchor="middle" x="2624" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert13_GPU15</text>
<text text-anchor="middle" x="2624" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2624" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2624" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2624" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_gate_gpu15&#45;&gt;layer4_expert15_13 -->
<g id="edge457" class="edge">
<title>layer4_gate_gpu15&#45;&gt;layer4_expert15_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2624,-511.86C2624,-503.6 2624,-494.82 2624,-486.26"/>
<polygon fill="black" stroke="black" points="2627.5,-485.97 2624,-475.97 2620.5,-485.97 2627.5,-485.97"/>
</g>
<!-- layer4_expert15_14 -->
<g id="node262" class="node">
<title>layer4_expert15_14</title>
<polygon fill="lightgreen" stroke="black" points="2903,-475.95 2729,-475.95 2729,-392.95 2903,-392.95 2903,-475.95"/>
<text text-anchor="middle" x="2816" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert14_GPU15</text>
<text text-anchor="middle" x="2816" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2816" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2816" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2816" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_gate_gpu15&#45;&gt;layer4_expert15_14 -->
<g id="edge458" class="edge">
<title>layer4_gate_gpu15&#45;&gt;layer4_expert15_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2690.61,-511.86C2706.85,-501.97 2724.32,-491.32 2740.92,-481.21"/>
<polygon fill="black" stroke="black" points="2742.79,-484.17 2749.5,-475.97 2739.14,-478.19 2742.79,-484.17"/>
</g>
<!-- layer4_expert15_15 -->
<g id="node263" class="node">
<title>layer4_expert15_15</title>
<polygon fill="lightgreen" stroke="black" points="3095,-475.95 2921,-475.95 2921,-392.95 3095,-392.95 3095,-475.95"/>
<text text-anchor="middle" x="3008" y="-460.75" font-family="Times,serif" font-size="14.00">L4_Expert15_GPU15</text>
<text text-anchor="middle" x="3008" y="-445.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3008" y="-430.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3008" y="-415.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3008" y="-400.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_gate_gpu15&#45;&gt;layer4_expert15_15 -->
<g id="edge459" class="edge">
<title>layer4_gate_gpu15&#45;&gt;layer4_expert15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2746.34,-523.97C2795.34,-511.59 2852.28,-495.96 2911.33,-476.07"/>
<polygon fill="black" stroke="black" points="2912.48,-479.37 2920.82,-472.84 2910.23,-472.75 2912.48,-479.37"/>
</g>
<!-- layer4_moe_aggregate_gpu15 -->
<g id="node264" class="node">
<title>layer4_moe_aggregate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2730,-356.95 2518,-356.95 2518,-288.95 2730,-288.95 2730,-356.95"/>
<text text-anchor="middle" x="2624" y="-341.75" font-family="Times,serif" font-size="14.00">L4_MoE_Aggregate_GPU15</text>
<text text-anchor="middle" x="2624" y="-326.75" font-family="Times,serif" font-size="14.00">Input: 4×[tokens,4096]</text>
<text text-anchor="middle" x="2624" y="-311.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2624" y="-296.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_expert15_12&#45;&gt;layer4_moe_aggregate_gpu15 -->
<g id="edge460" class="edge">
<title>layer4_expert15_12&#45;&gt;layer4_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2503.22,-392.84C2520.85,-382.78 2539.68,-372.04 2557.1,-362.11"/>
<polygon fill="black" stroke="black" points="2559.11,-364.99 2566.06,-357 2555.64,-358.91 2559.11,-364.99"/>
</g>
<!-- layer4_expert15_13&#45;&gt;layer4_moe_aggregate_gpu15 -->
<g id="edge461" class="edge">
<title>layer4_expert15_13&#45;&gt;layer4_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2624,-392.68C2624,-384.47 2624,-375.81 2624,-367.51"/>
<polygon fill="black" stroke="black" points="2627.5,-367.25 2624,-357.25 2620.5,-367.25 2627.5,-367.25"/>
</g>
<!-- layer4_expert15_14&#45;&gt;layer4_moe_aggregate_gpu15 -->
<g id="edge462" class="edge">
<title>layer4_expert15_14&#45;&gt;layer4_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2744.78,-392.84C2727.15,-382.78 2708.32,-372.04 2690.9,-362.11"/>
<polygon fill="black" stroke="black" points="2692.36,-358.91 2681.94,-357 2688.89,-364.99 2692.36,-358.91"/>
</g>
<!-- layer4_expert15_15&#45;&gt;layer4_moe_aggregate_gpu15 -->
<g id="edge463" class="edge">
<title>layer4_expert15_15&#45;&gt;layer4_moe_aggregate_gpu15</title>
<path fill="none" stroke="black" d="M2920.85,-395.97C2917.88,-394.92 2914.92,-393.91 2912,-392.95 2856.24,-374.65 2792.95,-358.95 2739.92,-347.17"/>
<polygon fill="black" stroke="black" points="2740.67,-343.75 2730.15,-345.02 2739.16,-350.59 2740.67,-343.75"/>
</g>
<!-- layer4_moe_norm_gpu15 -->
<g id="node265" class="node">
<title>layer4_moe_norm_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="2501.5,-252.95 2248.5,-252.95 2248.5,-184.95 2501.5,-184.95 2501.5,-252.95"/>
<text text-anchor="middle" x="2375" y="-237.75" font-family="Times,serif" font-size="14.00">L4_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="2375" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="2375" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2375" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_moe_aggregate_gpu15&#45;&gt;layer4_moe_norm_gpu15 -->
<g id="edge464" class="edge">
<title>layer4_moe_aggregate_gpu15&#45;&gt;layer4_moe_norm_gpu15</title>
<path fill="none" stroke="black" d="M2543.16,-288.84C2518.24,-278.63 2490.66,-267.33 2465.16,-256.88"/>
<polygon fill="black" stroke="black" points="2466.44,-253.63 2455.86,-253.08 2463.79,-260.11 2466.44,-253.63"/>
</g>
<!-- layer4_moe_norm_gpu15&#45;&gt;output -->
<g id="edge468" class="edge">
<title>layer4_moe_norm_gpu15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2248.34,-202.84C2108.39,-186.14 1880.41,-158.94 1711.09,-138.74"/>
<polygon fill="black" stroke="black" points="1711.39,-135.25 1701.05,-137.54 1710.56,-142.2 1711.39,-135.25"/>
</g>
</g>
</svg>
