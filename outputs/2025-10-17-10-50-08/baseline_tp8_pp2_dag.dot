digraph TP8_PP2_Baseline {
	graph [bb="0,0,68830,2908",
		fontsize=20,
		label="Baseline: TP=8, PP=2 Hybrid
16 GPUs total
Tensor Parallelism 8 per stage, Pipeline 2 stages",
		lheight=0.92,
		lp="34415,37",
		lwidth=6.90,
		rankdir=TB,
		size="30,20"
	];
	node [fillcolor=lightcoral,
		label="\N",
		shape=diamond,
		style=filled
	];
	input	[fillcolor=lightblue,
		height=1.041,
		label="INPUT
Input: [batch_size=1024, seq_len=2048, hidden=4096]
GPU: 0-7",
		pos="11688,2859",
		shape=ellipse,
		width=8.1121];
	layer0_qkv_gpu0	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 0-3
TP Slice: 0
GPU: 0",
		pos="10832,2725",
		shape=rectangle,
		width=2.9167];
	input -> layer0_qkv_gpu0	[pos="e,10937,2767.2 11425,2842.8 11286,2830.9 11113,2810.1 10962,2774 10957,2772.8 10951,2771.5 10946,2770.1"];
	layer0_qkv_gpu1	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 4-7
TP Slice: 1
GPU: 1",
		pos="11076,2725",
		shape=rectangle,
		width=2.9167];
	input -> layer0_qkv_gpu1	[pos="e,11181,2764.3 11496,2830.9 11409,2816.9 11306,2797.7 11214,2774 11207,2772 11199,2769.7 11191,2767.3"];
	layer0_qkv_gpu2	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 8-11
TP Slice: 2
GPU: 2",
		pos="11328,2725",
		shape=rectangle,
		width=2.9167];
	input -> layer0_qkv_gpu2	[pos="e,11434,2764.6 11594,2823.5 11548,2806.6 11492,2786 11443,2768.1"];
	layer0_qkv_gpu3	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 12-15
TP Slice: 3
GPU: 3",
		pos="11582,2725",
		shape=rectangle,
		width=2.9167];
	input -> layer0_qkv_gpu3	[pos="e,11621,2774.2 11659,2821.6 11649,2809.3 11638,2795.4 11627,2782"];
	layer0_qkv_gpu4	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 16-19
TP Slice: 4
GPU: 4",
		pos="11818,2725",
		shape=rectangle,
		width=2.9167];
	input -> layer0_qkv_gpu4	[pos="e,11771,2774.2 11724,2821.6 11737,2809.2 11750,2795.1 11764,2781.6"];
	layer0_qkv_gpu5	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 20-23
TP Slice: 5
GPU: 5",
		pos="12072,2725",
		shape=rectangle,
		width=2.9167];
	input -> layer0_qkv_gpu5	[pos="e,11966,2762.3 11788,2823.7 11832,2808.5 11885,2790.4 11932,2774 11940,2771.3 11949,2768.5 11957,2765.6"];
	layer0_qkv_gpu6	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 24-27
TP Slice: 6
GPU: 6",
		pos="12340,2725",
		shape=rectangle,
		width=2.9167];
	input -> layer0_qkv_gpu6	[pos="e,12235,2760.7 11884,2831.1 11976,2816.9 12087,2797.5 12186,2774 12199,2770.9 12212,2767.3 12225,2763.5"];
	layer0_qkv_gpu7	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 28-31
TP Slice: 7
GPU: 7",
		pos="12594,2725",
		shape=rectangle,
		width=2.9167];
	input -> layer0_qkv_gpu7	[pos="e,12488,2765.1 11955,2843.5 12103,2831.7 12291,2810.8 12454,2774 12462,2772.2 12470,2770.2 12479,2767.9"];
	stage0_header	[fillcolor=lightblue,
		height=0.8575,
		label="Stage 0 (GPUs 0-7)
Layers 0-1",
		peripheries=2,
		pos="23578,2859",
		shape=ellipse,
		width=3.1163];
	layer0_attn_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Multi-Head_Attention_GPU0
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 0",
		pos="10790,2598.5",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu0 -> layer0_attn_gpu0	[pos="e,10804,2640.2 10816,2675.9 10813,2667.3 10810,2658.4 10807,2649.8"];
	layer0_attn_proj_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU0
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 0",
		pos="10790,2453",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu0 -> layer0_attn_proj_gpu0	[pos="e,10790,2487.1 10790,2556.8 10790,2538.2 10790,2516.1 10790,2497.2"];
	layer0_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU0
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 0",
		pos="10786,2135.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_proj_gpu0 -> layer0_attn_norm_gpu0	[pos="e,10787,2169.7 10790,2418.8 10789,2361.4 10788,2243.6 10787,2179.8"];
	layer0_allreduce_attn	[height=1.8889,
		label="L0_All-Reduce_Attention
Input: 8Ã—[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce",
		pos="11702,2281",
		width=5.6389];
	layer0_attn_proj_gpu0 -> layer0_allreduce_attn	[pos="e,11531,2291.5 10855,2418.8 10881,2406.5 10913,2393.4 10942,2385 11136,2330.5 11365,2304.5 11521,2292.3"];
	layer0_gate_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU0
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 0",
		pos="1546.5,2016.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu0 -> layer0_gate_gpu0	[pos="e,1668.8,2019.4 10664,2133.2 10015,2126.1 6894.9,2091.6 4343.5,2058 3317.7,2044.5 2080.3,2025.7 1679,2019.5"];
	layer0_expert0_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="82.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_0	[pos="e,165.13,1936.8 1424.3,2014.3 1137.7,2010.7 428,1996.3 175.02,1939.1",
		style=dashed];
	layer0_expert0_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="265.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_1	[pos="e,348.14,1936.7 1424.1,2013.1 1166.4,2007.2 575,1988.8 358.18,1939.1",
		style=dashed];
	layer0_expert0_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="448.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_2	[pos="e,531.15,1936.7 1424.3,2011.4 1198.1,2003.1 721.86,1981.3 541.08,1939.1",
		style=dashed];
	layer0_expert0_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="631.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_3	[pos="e,714.17,1936.6 1424.4,2009 1232.8,1998.1 869.32,1974 724.23,1939.1",
		style=dashed];
	layer0_expert0_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="814.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_4	[pos="e,897.19,1936.5 1424.2,2011.8 1296,2005.4 1089.2,1988.2 906.95,1939.2",
		style=dashed];
	layer0_expert0_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="997.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_5	[pos="e,1080.2,1936.4 1424,2003.6 1333.2,1992.8 1206.8,1973.5 1090.1,1939.3",
		style=dashed];
	layer0_expert0_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="1180.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_6	[pos="e,1263.1,1935.9 1424.5,1985.7 1378.9,1973.6 1326.9,1958.5 1272.6,1939.3",
		style=dashed];
	layer0_expert0_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="1363.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_7	[pos="e,1426.9,1939 1483,1974.9 1467.7,1965.1 1451.2,1954.6 1435.5,1944.5",
		style=dashed];
	layer0_expert0_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="1546.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_8	[pos="e,1546.5,1939 1546.5,1974.9 1546.5,1966.6 1546.5,1957.9 1546.5,1949.3",
		style=dashed];
	layer0_expert0_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="1729.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_9	[pos="e,1666.1,1939 1610,1974.9 1625.3,1965.1 1641.8,1954.6 1657.5,1944.5",
		style=dashed];
	layer0_expert0_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="1912.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_10	[pos="e,1830,1935.5 1668.7,1985.4 1716.5,1972.5 1771.6,1956.5 1820.5,1939 1820.6,1939 1820.7,1938.9 1820.8,1938.9",
		style=dashed];
	layer0_expert0_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="2095.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_11	[pos="e,2012.9,1936 1668.6,2003.4 1759.2,1992.5 1885.4,1973.2 2003,1938.9",
		style=dashed];
	layer0_expert0_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="2278.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_12	[pos="e,2195.9,1936.2 1668.6,2011.6 1796.6,2005.1 2003,1987.8 2186.1,1938.9",
		style=dashed];
	layer0_expert0_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="2461.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_13	[pos="e,2378.9,1936.3 1668.9,2009 1860.3,1997.9 2222.9,1973.6 2368.8,1938.8",
		style=dashed];
	layer0_expert0_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="2644.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_14	[pos="e,2562,1936.4 1668.6,2011.4 1894.5,2002.9 2370.2,1980.9 2552,1938.8",
		style=dashed];
	layer0_expert0_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="2827.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu0 -> layer0_expert0_15	[pos="e,2745,1936.4 1668.8,2013 1926.3,2007 2517.7,1988.3 2735.2,1938.7",
		style=dashed];
	layer0_moe_agg_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_MoE_Aggregate_GPU0
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 0",
		pos="1637.5,1752",
		shape=rectangle,
		width=2.8194];
	layer0_expert0_0 -> layer0_moe_agg_gpu0	[pos="e,1535.8,1755.6 165.15,1858.3 167.94,1857.5 170.73,1856.7 173.5,1856 429.43,1792.2 1229,1764.2 1525.4,1755.9"];
	layer0_expert0_1 -> layer0_moe_agg_gpu0	[pos="e,1536,1756.7 348.15,1858.3 350.95,1857.5 353.74,1856.7 356.5,1856 576.5,1799.9 1256.2,1767.9 1525.8,1757.1"];
	layer0_expert0_2 -> layer0_moe_agg_gpu0	[pos="e,1535.6,1758.3 531.17,1858.4 533.96,1857.5 536.74,1856.7 539.5,1856 723.69,1807.8 1284.4,1772.3 1525.5,1758.9"];
	layer0_expert0_3 -> layer0_moe_agg_gpu0	[pos="e,1535.8,1754.4 714.18,1858.4 716.97,1857.6 719.75,1856.7 722.5,1856 1004.8,1779.3 1351,1759.6 1525.5,1754.6"];
	layer0_expert0_4 -> layer0_moe_agg_gpu0	[pos="e,1535.9,1758.3 897.21,1858.5 899.99,1857.6 902.76,1856.8 905.5,1856 1119.8,1794.6 1380.3,1769.1 1525.6,1759"];
	layer0_expert0_5 -> layer0_moe_agg_gpu0	[pos="e,1535.9,1764.8 1080,1858.8 1082.9,1857.8 1085.7,1856.9 1088.5,1856 1236.5,1809.9 1413.6,1781.2 1525.9,1766.2"];
	layer0_expert0_6 -> layer0_moe_agg_gpu0	[pos="e,1535.7,1777.4 1263.1,1859.1 1265.9,1858 1268.7,1857 1271.5,1856 1355.4,1825.7 1452.8,1798.7 1526,1779.9"];
	layer0_expert0_7 -> layer0_moe_agg_gpu0	[pos="e,1559.8,1793.7 1440.9,1856 1475.1,1838.1 1515.3,1817 1550.5,1798.6"];
	layer0_expert0_8 -> layer0_moe_agg_gpu0	[pos="e,1611.6,1793.8 1572.3,1855.8 1582.8,1839.3 1595,1820 1606,1802.7"];
	layer0_expert0_9 -> layer0_moe_agg_gpu0	[pos="e,1663.7,1793.8 1703.4,1855.8 1692.8,1839.3 1680.5,1820 1669.4,1802.7"];
	layer0_expert0_10 -> layer0_moe_agg_gpu0	[pos="e,1715.5,1793.7 1834.8,1856 1800.4,1838 1759.8,1816.8 1724.4,1798.3"];
	layer0_expert0_11 -> layer0_moe_agg_gpu0	[pos="e,1739.3,1777.6 2013,1859.5 2009.8,1858.3 2006.6,1857.1 2003.5,1856 1919.5,1825.9 1822.2,1798.8 1749,1780"];
	layer0_expert0_12 -> layer0_moe_agg_gpu0	[pos="e,1739.1,1765 2195.8,1859.1 2192.7,1858 2189.6,1857 2186.5,1856 2038.5,1810.2 1861.3,1781.4 1749.1,1766.3"];
	layer0_expert0_13 -> layer0_moe_agg_gpu0	[pos="e,1739.1,1758.5 2378.9,1858.9 2375.7,1857.9 2372.6,1856.9 2369.5,1856 2155.1,1795 1894.6,1769.3 1749.3,1759.2"];
	layer0_expert0_14 -> layer0_moe_agg_gpu0	[pos="e,1739.2,1754.5 2561.9,1858.8 2558.8,1857.8 2555.6,1856.8 2552.5,1856 2270.1,1779.8 1923.9,1759.9 1749.4,1754.8"];
	layer0_expert0_15 -> layer0_moe_agg_gpu0	[pos="e,1739.3,1758.4 2744.9,1858.7 2741.8,1857.7 2738.6,1856.8 2735.5,1856 2551.2,1808.1 1990.5,1772.5 1749.5,1758.9"];
	layer0_output_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU0
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 0",
		pos="5871.5,1408",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu0 -> layer0_output_gpu0	[pos="e,5749.2,1418.9 1739,1742.8 2307.8,1696.9 5096,1471.6 5739,1419.7"];
	layer0_allreduce_moe	[height=1.8889,
		label="L0_All-Reduce_MoE
Input: 8Ã—[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce",
		pos="11960,1580",
		width=5.6389];
	layer0_moe_agg_gpu0 -> layer0_allreduce_moe	[pos="e,11766,1582.9 1739.2,1748.2 2105.6,1738.2 3392.5,1703.9 4454.5,1684 7352.1,1629.7 10879,1592 11756,1583.1"];
	layer0_attn_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Multi-Head_Attention_GPU1
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 1",
		pos="11052,2598.5",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu1 -> layer0_attn_gpu1	[pos="e,11059,2640.2 11066,2675.9 11065,2667.4 11063,2658.6 11061,2650.1"];
	layer0_attn_proj_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU1
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 1",
		pos="11052,2453",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu1 -> layer0_attn_proj_gpu1	[pos="e,11052,2487.1 11052,2556.8 11052,2538.2 11052,2516.1 11052,2497.2"];
	layer0_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU1
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 1",
		pos="11048,2135.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_proj_gpu1 -> layer0_attn_norm_gpu1	[pos="e,11049,2169.7 11051,2418.8 11051,2361.4 11050,2243.6 11049,2179.8"];
	layer0_attn_proj_gpu1 -> layer0_allreduce_attn	[pos="e,11564,2302.6 11118,2418.8 11144,2406.9 11175,2394.1 11204,2385 11319,2348.2 11453,2321.3 11554,2304.2"];
	layer0_gate_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU1
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 1",
		pos="4474.5,2016.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu1 -> layer0_gate_gpu1	[pos="e,4596.8,2019.5 10953,2101.4 10941,2098.4 10929,2095.8 10918,2094 10717,2062.8 7474.1,2060.5 7271.5,2058 6245.7,2045.5 5008.3,2026.1 \
4607,2019.6"];
	layer0_expert1_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="3010.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_0	[pos="e,3093.1,1936.8 4352.3,2014.3 4065.7,2010.7 3356,1996.3 3103,1939.1",
		style=dashed];
	layer0_expert1_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="3193.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_1	[pos="e,3276.1,1936.7 4352.1,2013.1 4094.4,2007.2 3503,1988.8 3286.2,1939.1",
		style=dashed];
	layer0_expert1_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="3376.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_2	[pos="e,3459.2,1936.7 4352.3,2011.4 4126.1,2003.1 3649.9,1981.3 3469.1,1939.1",
		style=dashed];
	layer0_expert1_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="3559.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_3	[pos="e,3642.2,1936.6 4352.4,2009 4160.8,1998.1 3797.3,1974 3652.2,1939.1",
		style=dashed];
	layer0_expert1_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="3742.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_4	[pos="e,3825.2,1936.5 4352.2,2011.8 4224,2005.4 4017.2,1988.2 3834.9,1939.2",
		style=dashed];
	layer0_expert1_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="3925.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_5	[pos="e,4008.2,1936.4 4352,2003.6 4261.2,1992.8 4134.8,1973.5 4018.1,1939.3",
		style=dashed];
	layer0_expert1_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="4108.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_6	[pos="e,4191.1,1935.9 4352.5,1985.7 4306.9,1973.6 4254.9,1958.5 4200.6,1939.3",
		style=dashed];
	layer0_expert1_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="4291.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_7	[pos="e,4354.9,1939 4411,1974.9 4395.7,1965.1 4379.2,1954.6 4363.5,1944.5",
		style=dashed];
	layer0_expert1_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="4474.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_8	[pos="e,4474.5,1939 4474.5,1974.9 4474.5,1966.6 4474.5,1957.9 4474.5,1949.3",
		style=dashed];
	layer0_expert1_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="4657.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_9	[pos="e,4594.1,1939 4538,1974.9 4553.3,1965.1 4569.8,1954.6 4585.5,1944.5",
		style=dashed];
	layer0_expert1_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="4840.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_10	[pos="e,4758,1935.5 4596.7,1985.4 4644.5,1972.5 4699.6,1956.5 4748.5,1939 4748.6,1939 4748.7,1938.9 4748.8,1938.9",
		style=dashed];
	layer0_expert1_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="5023.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_11	[pos="e,4940.9,1936 4596.6,2003.4 4687.2,1992.5 4813.4,1973.2 4931,1938.9",
		style=dashed];
	layer0_expert1_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="5206.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_12	[pos="e,5123.9,1936.2 4596.6,2011.6 4724.6,2005.1 4931,1987.8 5114.1,1938.9",
		style=dashed];
	layer0_expert1_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="5389.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_13	[pos="e,5306.9,1936.3 4596.9,2009 4788.3,1997.9 5150.9,1973.6 5296.8,1938.8",
		style=dashed];
	layer0_expert1_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="5572.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_14	[pos="e,5490,1936.4 4596.6,2011.4 4822.5,2002.9 5298.2,1980.9 5480,1938.8",
		style=dashed];
	layer0_expert1_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="5755.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu1 -> layer0_expert1_15	[pos="e,5673,1936.4 4596.8,2013 4854.3,2007 5445.7,1988.3 5663.2,1938.7",
		style=dashed];
	layer0_moe_agg_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_MoE_Aggregate_GPU1
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 1",
		pos="4565.5,1752",
		shape=rectangle,
		width=2.8194];
	layer0_expert1_0 -> layer0_moe_agg_gpu1	[pos="e,4463.8,1755.6 3093.1,1858.3 3095.9,1857.5 3098.7,1856.7 3101.5,1856 3357.4,1792.2 4157,1764.2 4453.4,1755.9"];
	layer0_expert1_1 -> layer0_moe_agg_gpu1	[pos="e,4464,1756.7 3276.2,1858.3 3278.9,1857.5 3281.7,1856.7 3284.5,1856 3504.5,1799.9 4184.2,1767.9 4453.8,1757.1"];
	layer0_expert1_2 -> layer0_moe_agg_gpu1	[pos="e,4463.6,1758.3 3459.2,1858.4 3462,1857.5 3464.7,1856.7 3467.5,1856 3651.7,1807.8 4212.4,1772.3 4453.5,1758.9"];
	layer0_expert1_3 -> layer0_moe_agg_gpu1	[pos="e,4463.8,1754.4 3642.2,1858.4 3645,1857.6 3647.7,1856.7 3650.5,1856 3932.8,1779.3 4279,1759.6 4453.5,1754.6"];
	layer0_expert1_4 -> layer0_moe_agg_gpu1	[pos="e,4463.9,1758.3 3825.2,1858.5 3828,1857.6 3830.8,1856.8 3833.5,1856 4047.8,1794.6 4308.3,1769.1 4453.6,1759"];
	layer0_expert1_5 -> layer0_moe_agg_gpu1	[pos="e,4463.9,1764.8 4008,1858.8 4010.9,1857.8 4013.7,1856.9 4016.5,1856 4164.5,1809.9 4341.6,1781.2 4453.9,1766.2"];
	layer0_expert1_6 -> layer0_moe_agg_gpu1	[pos="e,4463.7,1777.4 4191.1,1859.1 4193.9,1858 4196.7,1857 4199.5,1856 4283.4,1825.7 4380.8,1798.7 4454,1779.9"];
	layer0_expert1_7 -> layer0_moe_agg_gpu1	[pos="e,4487.8,1793.7 4368.9,1856 4403.1,1838.1 4443.3,1817 4478.5,1798.6"];
	layer0_expert1_8 -> layer0_moe_agg_gpu1	[pos="e,4539.6,1793.8 4500.3,1855.8 4510.8,1839.3 4523,1820 4534,1802.7"];
	layer0_expert1_9 -> layer0_moe_agg_gpu1	[pos="e,4591.7,1793.8 4631.4,1855.8 4620.8,1839.3 4608.5,1820 4597.4,1802.7"];
	layer0_expert1_10 -> layer0_moe_agg_gpu1	[pos="e,4643.5,1793.7 4762.8,1856 4728.4,1838 4687.8,1816.8 4652.4,1798.3"];
	layer0_expert1_11 -> layer0_moe_agg_gpu1	[pos="e,4667.3,1777.6 4941,1859.5 4937.8,1858.3 4934.6,1857.1 4931.5,1856 4847.5,1825.9 4750.2,1798.8 4677,1780"];
	layer0_expert1_12 -> layer0_moe_agg_gpu1	[pos="e,4667.1,1765 5123.8,1859.1 5120.7,1858 5117.6,1857 5114.5,1856 4966.5,1810.2 4789.3,1781.4 4677.1,1766.3"];
	layer0_expert1_13 -> layer0_moe_agg_gpu1	[pos="e,4667.1,1758.5 5306.9,1858.9 5303.7,1857.9 5300.6,1856.9 5297.5,1856 5083.1,1795 4822.6,1769.3 4677.3,1759.2"];
	layer0_expert1_14 -> layer0_moe_agg_gpu1	[pos="e,4667.2,1754.5 5489.9,1858.8 5486.8,1857.8 5483.6,1856.8 5480.5,1856 5198.1,1779.8 4851.9,1759.9 4677.4,1754.8"];
	layer0_expert1_15 -> layer0_moe_agg_gpu1	[pos="e,4667.3,1758.4 5672.9,1858.7 5669.8,1857.7 5666.6,1856.8 5663.5,1856 5479.2,1808.1 4918.5,1772.5 4677.5,1758.9"];
	layer0_output_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU1
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 1",
		pos="8802.5,1408",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu1 -> layer0_output_gpu1	[pos="e,8680.4,1418.9 4667.1,1742.8 5236.3,1696.9 8027.2,1471.6 8670.2,1419.7"];
	layer0_moe_agg_gpu1 -> layer0_allreduce_moe	[pos="e,11773,1585.1 4667.2,1748.5 5033.6,1739.7 6320.6,1708.6 7382.5,1684 9077.9,1644.8 11127,1599.4 11763,1585.4"];
	layer0_attn_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Multi-Head_Attention_GPU2
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 2",
		pos="11312,2598.5",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu2 -> layer0_attn_gpu2	[pos="e,11318,2640.2 11322,2675.9 11321,2667.5 11320,2658.8 11319,2650.3"];
	layer0_attn_proj_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU2
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 2",
		pos="11312,2453",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu2 -> layer0_attn_proj_gpu2	[pos="e,11312,2487.1 11312,2556.8 11312,2538.2 11312,2516.1 11312,2497.2"];
	layer0_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU2
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 2",
		pos="11310,2135.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_proj_gpu2 -> layer0_attn_norm_gpu2	[pos="e,11311,2169.7 11312,2418.8 11312,2361.4 11311,2243.6 11311,2179.8"];
	layer0_attn_proj_gpu2 -> layer0_allreduce_attn	[pos="e,11615,2319.8 11387,2418.8 11412,2408 11439,2396 11464,2385 11511,2364.8 11562,2342.5 11605,2323.8"];
	layer0_gate_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU2
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 2",
		pos="7402.5,2016.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu2 -> layer0_gate_gpu2	[pos="e,7524.6,2019 11214,2101.4 11203,2098.4 11191,2095.8 11180,2094 10996,2064.4 8183,2027.3 7534.9,2019.1"];
	layer0_expert2_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="5938.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_0	[pos="e,6021.1,1936.8 7280.3,2014.3 6993.7,2010.7 6284,1996.3 6031,1939.1",
		style=dashed];
	layer0_expert2_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="6121.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_1	[pos="e,6204.1,1936.7 7280.1,2013.1 7022.4,2007.2 6431,1988.8 6214.2,1939.1",
		style=dashed];
	layer0_expert2_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="6304.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_2	[pos="e,6387.2,1936.7 7280.3,2011.4 7054.1,2003.1 6577.9,1981.3 6397.1,1939.1",
		style=dashed];
	layer0_expert2_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="6487.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_3	[pos="e,6570.2,1936.6 7280.4,2009 7088.8,1998.1 6725.3,1974 6580.2,1939.1",
		style=dashed];
	layer0_expert2_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="6670.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_4	[pos="e,6753.2,1936.5 7280.2,2011.8 7152,2005.4 6945.2,1988.2 6762.9,1939.2",
		style=dashed];
	layer0_expert2_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="6853.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_5	[pos="e,6936.2,1936.4 7280,2003.6 7189.2,1992.8 7062.8,1973.5 6946.1,1939.3",
		style=dashed];
	layer0_expert2_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="7036.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_6	[pos="e,7119.1,1935.9 7280.5,1985.7 7234.9,1973.6 7182.9,1958.5 7128.6,1939.3",
		style=dashed];
	layer0_expert2_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="7219.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_7	[pos="e,7282.9,1939 7339,1974.9 7323.7,1965.1 7307.2,1954.6 7291.5,1944.5",
		style=dashed];
	layer0_expert2_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="7402.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_8	[pos="e,7402.5,1939 7402.5,1974.9 7402.5,1966.6 7402.5,1957.9 7402.5,1949.3",
		style=dashed];
	layer0_expert2_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="7585.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_9	[pos="e,7522.1,1939 7466,1974.9 7481.3,1965.1 7497.8,1954.6 7513.5,1944.5",
		style=dashed];
	layer0_expert2_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="7768.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_10	[pos="e,7686,1935.5 7524.7,1985.4 7572.5,1972.5 7627.6,1956.5 7676.5,1939 7676.6,1939 7676.7,1938.9 7676.8,1938.9",
		style=dashed];
	layer0_expert2_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="7951.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_11	[pos="e,7868.9,1936 7524.6,2003.4 7615.2,1992.5 7741.4,1973.2 7859,1938.9",
		style=dashed];
	layer0_expert2_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="8134.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_12	[pos="e,8051.9,1936.2 7524.6,2011.6 7652.6,2005.1 7859,1987.8 8042.1,1938.9",
		style=dashed];
	layer0_expert2_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="8317.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_13	[pos="e,8234.9,1936.3 7524.9,2009 7716.3,1997.9 8078.9,1973.6 8224.8,1938.8",
		style=dashed];
	layer0_expert2_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="8500.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_14	[pos="e,8418,1936.4 7524.6,2011.4 7750.5,2002.9 8226.2,1980.9 8408,1938.8",
		style=dashed];
	layer0_expert2_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="8683.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu2 -> layer0_expert2_15	[pos="e,8601,1936.4 7524.8,2013 7782.3,2007 8373.7,1988.3 8591.2,1938.7",
		style=dashed];
	layer0_moe_agg_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_MoE_Aggregate_GPU2
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 2",
		pos="7493.5,1752",
		shape=rectangle,
		width=2.8194];
	layer0_expert2_0 -> layer0_moe_agg_gpu2	[pos="e,7391.8,1755.6 6021.1,1858.3 6023.9,1857.5 6026.7,1856.7 6029.5,1856 6285.4,1792.2 7085,1764.2 7381.4,1755.9"];
	layer0_expert2_1 -> layer0_moe_agg_gpu2	[pos="e,7392,1756.7 6204.2,1858.3 6206.9,1857.5 6209.7,1856.7 6212.5,1856 6432.5,1799.9 7112.2,1767.9 7381.8,1757.1"];
	layer0_expert2_2 -> layer0_moe_agg_gpu2	[pos="e,7391.6,1758.3 6387.2,1858.4 6390,1857.5 6392.7,1856.7 6395.5,1856 6579.7,1807.8 7140.4,1772.3 7381.5,1758.9"];
	layer0_expert2_3 -> layer0_moe_agg_gpu2	[pos="e,7391.8,1754.4 6570.2,1858.4 6573,1857.6 6575.7,1856.7 6578.5,1856 6860.8,1779.3 7207,1759.6 7381.5,1754.6"];
	layer0_expert2_4 -> layer0_moe_agg_gpu2	[pos="e,7391.9,1758.3 6753.2,1858.5 6756,1857.6 6758.8,1856.8 6761.5,1856 6975.8,1794.6 7236.3,1769.1 7381.6,1759"];
	layer0_expert2_5 -> layer0_moe_agg_gpu2	[pos="e,7391.9,1764.8 6936,1858.8 6938.9,1857.8 6941.7,1856.9 6944.5,1856 7092.5,1809.9 7269.6,1781.2 7381.9,1766.2"];
	layer0_expert2_6 -> layer0_moe_agg_gpu2	[pos="e,7391.7,1777.4 7119.1,1859.1 7121.9,1858 7124.7,1857 7127.5,1856 7211.4,1825.7 7308.8,1798.7 7382,1779.9"];
	layer0_expert2_7 -> layer0_moe_agg_gpu2	[pos="e,7415.8,1793.7 7296.9,1856 7331.1,1838.1 7371.3,1817 7406.5,1798.6"];
	layer0_expert2_8 -> layer0_moe_agg_gpu2	[pos="e,7467.6,1793.8 7428.3,1855.8 7438.8,1839.3 7451,1820 7462,1802.7"];
	layer0_expert2_9 -> layer0_moe_agg_gpu2	[pos="e,7519.7,1793.8 7559.4,1855.8 7548.8,1839.3 7536.5,1820 7525.4,1802.7"];
	layer0_expert2_10 -> layer0_moe_agg_gpu2	[pos="e,7571.5,1793.7 7690.8,1856 7656.4,1838 7615.8,1816.8 7580.4,1798.3"];
	layer0_expert2_11 -> layer0_moe_agg_gpu2	[pos="e,7595.3,1777.6 7869,1859.5 7865.8,1858.3 7862.6,1857.1 7859.5,1856 7775.5,1825.9 7678.2,1798.8 7605,1780"];
	layer0_expert2_12 -> layer0_moe_agg_gpu2	[pos="e,7595.1,1765 8051.8,1859.1 8048.7,1858 8045.6,1857 8042.5,1856 7894.5,1810.2 7717.3,1781.4 7605.1,1766.3"];
	layer0_expert2_13 -> layer0_moe_agg_gpu2	[pos="e,7595.1,1758.5 8234.9,1858.9 8231.7,1857.9 8228.6,1856.9 8225.5,1856 8011.1,1795 7750.6,1769.3 7605.3,1759.2"];
	layer0_expert2_14 -> layer0_moe_agg_gpu2	[pos="e,7595.2,1754.5 8417.9,1858.8 8414.8,1857.8 8411.6,1856.8 8408.5,1856 8126.1,1779.8 7779.9,1759.9 7605.4,1754.8"];
	layer0_expert2_15 -> layer0_moe_agg_gpu2	[pos="e,7595.3,1758.4 8600.9,1858.7 8597.8,1857.7 8594.6,1856.8 8591.5,1856 8407.2,1808.1 7846.5,1772.5 7605.5,1758.9"];
	layer0_output_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU2
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 2",
		pos="10400,1408",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu2 -> layer0_output_gpu2	[pos="e,10277,1423.4 7595.2,1739 8035,1687.3 9772.6,1482.8 10267,1424.5"];
	layer0_moe_agg_gpu2 -> layer0_allreduce_moe	[pos="e,11781,1587.8 7595.2,1747.1 8169.3,1725.3 11007,1617.3 11771,1588.2"];
	layer0_attn_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Multi-Head_Attention_GPU3
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 3",
		pos="11574,2598.5",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu3 -> layer0_attn_gpu3	[pos="e,11576,2640.2 11578,2675.9 11578,2667.5 11577,2658.8 11577,2650.3"];
	layer0_attn_proj_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU3
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 3",
		pos="11574,2453",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu3 -> layer0_attn_proj_gpu3	[pos="e,11574,2487.1 11574,2556.8 11574,2538.2 11574,2516.1 11574,2497.2"];
	layer0_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU3
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 3",
		pos="11572,2135.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_proj_gpu3 -> layer0_attn_norm_gpu3	[pos="e,11524,2169.9 11537,2418.6 11519,2400.1 11500,2375.4 11490,2349 11470,2292 11466,2268.4 11490,2213 11496,2199.5 11506,2187.3 11516,\
2176.8"];
	layer0_attn_proj_gpu3 -> layer0_allreduce_attn	[pos="e,11662,2335.5 11599,2418.8 11615,2397.5 11636,2369 11656,2343.6"];
	layer0_gate_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU3
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 3",
		pos="10330,2016.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu3 -> layer0_gate_gpu3	[pos="e,10453,2016.7 11474,2101.4 11463,2098.5 11452,2096 11442,2094 11093,2028.9 10673,2017.9 10463,2016.8"];
	layer0_expert3_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="8866.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_0	[pos="e,8949.1,1936.8 10208,2014.3 9921.7,2010.7 9212,1996.3 8959,1939.1",
		style=dashed];
	layer0_expert3_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="9049.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_1	[pos="e,9132.1,1936.7 10208,2013.1 9950.4,2007.2 9359,1988.8 9142.2,1939.1",
		style=dashed];
	layer0_expert3_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="9232.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_2	[pos="e,9315.2,1936.7 10208,2011.4 9982.1,2003.1 9505.9,1981.3 9325.1,1939.1",
		style=dashed];
	layer0_expert3_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="9415.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_3	[pos="e,9498.2,1936.6 10208,2009 10017,1998.1 9653.3,1974 9508.2,1939.1",
		style=dashed];
	layer0_expert3_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="9598.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_4	[pos="e,9681.2,1936.5 10208,2011.8 10080,2005.4 9873.2,1988.2 9690.9,1939.2",
		style=dashed];
	layer0_expert3_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="9781.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_5	[pos="e,9864.2,1936.4 10208,2003.6 10117,1992.8 9990.8,1973.5 9874.1,1939.3",
		style=dashed];
	layer0_expert3_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="9964.5,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_6	[pos="e,10047,1935.9 10208,1985.7 10163,1973.6 10111,1958.5 10057,1939.3",
		style=dashed];
	layer0_expert3_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="10148,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_7	[pos="e,10211,1939 10267,1974.9 10252,1965.1 10235,1954.6 10219,1944.5",
		style=dashed];
	layer0_expert3_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="10330,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_8	[pos="e,10330,1939 10330,1974.9 10330,1966.6 10330,1957.9 10330,1949.3",
		style=dashed];
	layer0_expert3_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="10514,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_9	[pos="e,10450,1939 10394,1974.9 10409,1965.1 10426,1954.6 10442,1944.5",
		style=dashed];
	layer0_expert3_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="10696,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_10	[pos="e,10614,1935.5 10453,1985.4 10501,1972.5 10556,1956.5 10604,1939 10605,1939 10605,1938.9 10605,1938.9",
		style=dashed];
	layer0_expert3_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="10880,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_11	[pos="e,10797,1936 10453,2003.4 10543,1992.5 10669,1973.2 10787,1938.9",
		style=dashed];
	layer0_expert3_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="11062,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_12	[pos="e,10980,1936.2 10453,2011.6 10581,2005.1 10787,1987.8 10970,1938.9",
		style=dashed];
	layer0_expert3_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="11246,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_13	[pos="e,11163,1936.3 10453,2009 10644,1997.9 11007,1973.6 11153,1938.8",
		style=dashed];
	layer0_expert3_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="11428,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_14	[pos="e,11346,1936.4 10453,2011.4 10678,2002.9 11154,1980.9 11336,1938.8",
		style=dashed];
	layer0_expert3_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="11612,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu3 -> layer0_expert3_15	[pos="e,11529,1936.4 10453,2013 10710,2007 11302,1988.3 11519,1938.7",
		style=dashed];
	layer0_moe_agg_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_MoE_Aggregate_GPU3
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 3",
		pos="10422,1752",
		shape=rectangle,
		width=2.8194];
	layer0_expert3_0 -> layer0_moe_agg_gpu3	[pos="e,10320,1755.6 8949.1,1858.3 8951.9,1857.5 8954.7,1856.7 8957.5,1856 9213.4,1792.2 10013,1764.2 10309,1755.9"];
	layer0_expert3_1 -> layer0_moe_agg_gpu3	[pos="e,10320,1756.7 9132.2,1858.3 9134.9,1857.5 9137.7,1856.7 9140.5,1856 9360.5,1799.9 10040,1767.9 10310,1757.1"];
	layer0_expert3_2 -> layer0_moe_agg_gpu3	[pos="e,10320,1758.3 9315.2,1858.4 9318,1857.5 9320.7,1856.7 9323.5,1856 9507.7,1807.8 10068,1772.3 10309,1758.9"];
	layer0_expert3_3 -> layer0_moe_agg_gpu3	[pos="e,10320,1754.4 9498.2,1858.4 9501,1857.6 9503.7,1856.7 9506.5,1856 9788.8,1779.3 10135,1759.6 10310,1754.6"];
	layer0_expert3_4 -> layer0_moe_agg_gpu3	[pos="e,10320,1758.3 9681.2,1858.5 9684,1857.6 9686.8,1856.8 9689.5,1856 9903.8,1794.6 10164,1769.1 10310,1759"];
	layer0_expert3_5 -> layer0_moe_agg_gpu3	[pos="e,10320,1764.8 9864,1858.8 9866.9,1857.8 9869.7,1856.9 9872.5,1856 10020,1809.9 10198,1781.2 10310,1766.2"];
	layer0_expert3_6 -> layer0_moe_agg_gpu3	[pos="e,10320,1777.4 10047,1859.1 10050,1858 10053,1857 10056,1856 10139,1825.7 10237,1798.7 10310,1779.9"];
	layer0_expert3_7 -> layer0_moe_agg_gpu3	[pos="e,10344,1793.7 10225,1856 10259,1838.1 10299,1817 10334,1798.6"];
	layer0_expert3_8 -> layer0_moe_agg_gpu3	[pos="e,10396,1793.8 10356,1855.8 10367,1839.3 10379,1820 10390,1802.7"];
	layer0_expert3_9 -> layer0_moe_agg_gpu3	[pos="e,10448,1793.8 10487,1855.8 10477,1839.3 10464,1820 10453,1802.7"];
	layer0_expert3_10 -> layer0_moe_agg_gpu3	[pos="e,10499,1793.7 10619,1856 10584,1838 10544,1816.8 10508,1798.3"];
	layer0_expert3_11 -> layer0_moe_agg_gpu3	[pos="e,10523,1777.6 10797,1859.5 10794,1858.3 10791,1857.1 10788,1856 10704,1825.9 10606,1798.8 10533,1780"];
	layer0_expert3_12 -> layer0_moe_agg_gpu3	[pos="e,10523,1765 10980,1859.1 10977,1858 10974,1857 10970,1856 10822,1810.2 10645,1781.4 10533,1766.3"];
	layer0_expert3_13 -> layer0_moe_agg_gpu3	[pos="e,10523,1758.5 11163,1858.9 11160,1857.9 11157,1856.9 11154,1856 10939,1795 10679,1769.3 10533,1759.2"];
	layer0_expert3_14 -> layer0_moe_agg_gpu3	[pos="e,10523,1754.5 11346,1858.8 11343,1857.8 11340,1856.8 11336,1856 11054,1779.8 10708,1759.9 10533,1754.8"];
	layer0_expert3_15 -> layer0_moe_agg_gpu3	[pos="e,10523,1758.4 11529,1858.7 11526,1857.7 11523,1856.8 11520,1856 11335,1808.1 10775,1772.5 10534,1758.9"];
	layer0_output_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU3
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 3",
		pos="11328,1408",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu3 -> layer0_output_gpu3	[pos="e,11241,1442 10523,1712.6 10699,1646.2 11059,1510.8 11231,1445.6"];
	layer0_moe_agg_gpu3 -> layer0_allreduce_moe	[pos="e,11810,1597.6 10523,1739.8 10785,1710.9 11483,1633.8 11800,1598.8"];
	layer0_attn_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Multi-Head_Attention_GPU4
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 4",
		pos="11834,2598.5",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu4 -> layer0_attn_gpu4	[pos="e,11829,2640.2 11825,2675.9 11826,2667.5 11827,2658.8 11828,2650.3"];
	layer0_attn_proj_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU4
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 4",
		pos="11834,2453",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu4 -> layer0_attn_proj_gpu4	[pos="e,11834,2487.1 11834,2556.8 11834,2538.2 11834,2516.1 11834,2497.2"];
	layer0_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU4
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 4",
		pos="11834,2135.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_proj_gpu4 -> layer0_attn_norm_gpu4	[pos="e,11882,2169.7 11870,2418.8 11887,2400.2 11905,2375.3 11914,2349 11934,2291.8 11938,2268.6 11914,2213 11909,2199.5 11899,2187.3 \
11889,2176.7"];
	layer0_attn_proj_gpu4 -> layer0_allreduce_attn	[pos="e,11744,2335.5 11809,2418.8 11792,2397.5 11770,2369 11750,2343.6"];
	layer0_gate_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU4
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 4",
		pos="13076,2016.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu4 -> layer0_gate_gpu4	[pos="e,12953,2016.8 11933,2101.4 11944,2098.5 11955,2096 11966,2094 12314,2029 12734,2017.9 12943,2016.8"];
	layer0_expert4_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="11794,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_0	[pos="e,11877,1936.7 12953,2013.1 12695,2007.2 12104,1988.8 11887,1939.1",
		style=dashed];
	layer0_expert4_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="11978,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_1	[pos="e,12060,1936.7 12953,2011.4 12727,2003.1 12251,1981.3 12070,1939.1",
		style=dashed];
	layer0_expert4_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="12160,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_2	[pos="e,12243,1936.6 12953,2009 12762,1998.1 12398,1974 12253,1939.1",
		style=dashed];
	layer0_expert4_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="12344,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_3	[pos="e,12426,1936.5 12953,2011.8 12825,2005.4 12618,1988.2 12436,1939.2",
		style=dashed];
	layer0_expert4_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="12526,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_4	[pos="e,12609,1936.4 12953,2003.6 12862,1992.8 12736,1973.5 12619,1939.3",
		style=dashed];
	layer0_expert4_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="12710,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_5	[pos="e,12792,1935.9 12953,1985.7 12908,1973.6 12856,1958.5 12802,1939.3",
		style=dashed];
	layer0_expert4_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="12892,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_6	[pos="e,12956,1939 13012,1974.9 12997,1965.1 12980,1954.6 12964,1944.5",
		style=dashed];
	layer0_expert4_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="13076,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_7	[pos="e,13076,1939 13076,1974.9 13076,1966.6 13076,1957.9 13076,1949.3",
		style=dashed];
	layer0_expert4_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="13258,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_8	[pos="e,13195,1939 13139,1974.9 13154,1965.1 13171,1954.6 13187,1944.5",
		style=dashed];
	layer0_expert4_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="13442,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_9	[pos="e,13359,1935.5 13198,1985.4 13246,1972.5 13301,1956.5 13350,1939 13350,1939 13350,1938.9 13350,1938.9",
		style=dashed];
	layer0_expert4_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="13624,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_10	[pos="e,13542,1936 13198,2003.4 13288,1992.5 13414,1973.2 13532,1938.9",
		style=dashed];
	layer0_expert4_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="13808,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_11	[pos="e,13725,1936.2 13198,2011.6 13326,2005.1 13532,1987.8 13715,1938.9",
		style=dashed];
	layer0_expert4_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="13990,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_12	[pos="e,13908,1936.3 13198,2009 13389,1997.9 13752,1973.6 13898,1938.8",
		style=dashed];
	layer0_expert4_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="14174,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_13	[pos="e,14091,1936.4 13198,2011.4 13423,2002.9 13899,1980.9 14081,1938.8",
		style=dashed];
	layer0_expert4_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="14356,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_14	[pos="e,14274,1936.4 13198,2013 13455,2007 14047,1988.3 14264,1938.7",
		style=dashed];
	layer0_expert4_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="14540,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu4 -> layer0_expert4_15	[pos="e,14457,1936.5 13198,2014.3 13484,2010.5 14193,1995.8 14447,1938.8",
		style=dashed];
	layer0_moe_agg_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_MoE_Aggregate_GPU4
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 4",
		pos="12984,1752",
		shape=rectangle,
		width=2.8194];
	layer0_expert4_0 -> layer0_moe_agg_gpu4	[pos="e,12882,1758.3 11877,1858.4 11880,1857.5 11883,1856.7 11886,1856 12070,1807.8 12630,1772.3 12871,1758.9"];
	layer0_expert4_1 -> layer0_moe_agg_gpu4	[pos="e,12882,1754.4 12060,1858.4 12063,1857.6 12066,1856.7 12068,1856 12351,1779.3 12697,1759.6 12872,1754.6"];
	layer0_expert4_2 -> layer0_moe_agg_gpu4	[pos="e,12882,1758.3 12243,1858.5 12246,1857.6 12249,1856.8 12252,1856 12466,1794.6 12726,1769.1 12872,1759"];
	layer0_expert4_3 -> layer0_moe_agg_gpu4	[pos="e,12882,1764.8 12426,1858.8 12429,1857.8 12432,1856.9 12434,1856 12582,1809.9 12760,1781.2 12872,1766.2"];
	layer0_expert4_4 -> layer0_moe_agg_gpu4	[pos="e,12882,1777.4 12609,1859.1 12612,1858 12615,1857 12618,1856 12701,1825.7 12799,1798.7 12872,1779.9"];
	layer0_expert4_5 -> layer0_moe_agg_gpu4	[pos="e,12906,1793.7 12787,1856 12821,1838.1 12861,1817 12896,1798.6"];
	layer0_expert4_6 -> layer0_moe_agg_gpu4	[pos="e,12958,1793.8 12918,1855.8 12929,1839.3 12941,1820 12952,1802.7"];
	layer0_expert4_7 -> layer0_moe_agg_gpu4	[pos="e,13010,1793.8 13049,1855.8 13039,1839.3 13026,1820 13015,1802.7"];
	layer0_expert4_8 -> layer0_moe_agg_gpu4	[pos="e,13061,1793.7 13181,1856 13146,1838 13106,1816.8 13070,1798.3"];
	layer0_expert4_9 -> layer0_moe_agg_gpu4	[pos="e,13085,1777.6 13359,1859.5 13356,1858.3 13353,1857.1 13350,1856 13266,1825.9 13168,1798.8 13095,1780"];
	layer0_expert4_10 -> layer0_moe_agg_gpu4	[pos="e,13085,1765 13542,1859.1 13539,1858 13536,1857 13532,1856 13384,1810.2 13207,1781.4 13095,1766.3"];
	layer0_expert4_11 -> layer0_moe_agg_gpu4	[pos="e,13085,1758.5 13725,1858.9 13722,1857.9 13719,1856.9 13716,1856 13501,1795 13241,1769.3 13095,1759.2"];
	layer0_expert4_12 -> layer0_moe_agg_gpu4	[pos="e,13085,1754.5 13908,1858.8 13905,1857.8 13902,1856.8 13898,1856 13616,1779.8 13270,1759.9 13095,1754.8"];
	layer0_expert4_13 -> layer0_moe_agg_gpu4	[pos="e,13085,1758.4 14091,1858.7 14088,1857.7 14085,1856.8 14082,1856 13897,1808.1 13337,1772.5 13096,1758.9"];
	layer0_expert4_14 -> layer0_moe_agg_gpu4	[pos="e,13085,1756.8 14274,1858.6 14271,1857.7 14268,1856.8 14264,1856 14044,1800.4 13365,1768.1 13095,1757.2"];
	layer0_expert4_15 -> layer0_moe_agg_gpu4	[pos="e,13085,1755.6 14457,1858.6 14454,1857.6 14451,1856.8 14448,1856 14191,1792.7 13392,1764.4 13096,1755.9"];
	layer0_output_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU4
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 4",
		pos="12260,1408",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu4 -> layer0_output_gpu4	[pos="e,12329,1442 12898,1710.4 12756,1643.5 12476,1511.1 12339,1446.4"];
	layer0_moe_agg_gpu4 -> layer0_allreduce_moe	[pos="e,12094,1603.3 12882,1734.1 12699,1703.7 12314,1639.8 12105,1604.9"];
	layer0_attn_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Multi-Head_Attention_GPU5
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 5",
		pos="12096,2598.5",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu5 -> layer0_attn_gpu5	[pos="e,12088,2640.2 12081,2675.9 12082,2667.4 12084,2658.6 12086,2650.1"];
	layer0_attn_proj_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU5
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 5",
		pos="12096,2453",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu5 -> layer0_attn_proj_gpu5	[pos="e,12096,2487.1 12096,2556.8 12096,2538.2 12096,2516.1 12096,2497.2"];
	layer0_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU5
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 5",
		pos="12096,2135.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_proj_gpu5 -> layer0_attn_norm_gpu5	[pos="e,12096,2169.7 12096,2418.8 12096,2361.4 12096,2243.6 12096,2179.8"];
	layer0_attn_proj_gpu5 -> layer0_allreduce_attn	[pos="e,11791,2319.6 12021,2418.9 11996,2408.1 11969,2396 11944,2385 11896,2364.6 11844,2342.2 11800,2323.5"];
	layer0_gate_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU5
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 5",
		pos="16004,2016.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu5 -> layer0_gate_gpu5	[pos="e,15881,2019 12193,2101.4 12204,2098.4 12216,2095.8 12228,2094 12411,2064.4 15223,2027.3 15871,2019.1"];
	layer0_expert5_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="14722,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_0	[pos="e,14805,1936.7 15881,2013.1 15623,2007.2 15032,1988.8 14815,1939.1",
		style=dashed];
	layer0_expert5_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="14906,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_1	[pos="e,14988,1936.7 15881,2011.4 15655,2003.1 15179,1981.3 14998,1939.1",
		style=dashed];
	layer0_expert5_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="15088,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_2	[pos="e,15171,1936.6 15881,2009 15690,1998.1 15326,1974 15181,1939.1",
		style=dashed];
	layer0_expert5_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="15272,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_3	[pos="e,15354,1936.5 15881,2011.8 15753,2005.4 15546,1988.2 15364,1939.2",
		style=dashed];
	layer0_expert5_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="15454,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_4	[pos="e,15537,1936.4 15881,2003.6 15790,1992.8 15664,1973.5 15547,1939.3",
		style=dashed];
	layer0_expert5_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="15638,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_5	[pos="e,15720,1935.9 15881,1985.7 15836,1973.6 15784,1958.5 15730,1939.3",
		style=dashed];
	layer0_expert5_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="15820,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_6	[pos="e,15884,1939 15940,1974.9 15925,1965.1 15908,1954.6 15892,1944.5",
		style=dashed];
	layer0_expert5_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="16004,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_7	[pos="e,16004,1939 16004,1974.9 16004,1966.6 16004,1957.9 16004,1949.3",
		style=dashed];
	layer0_expert5_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="16186,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_8	[pos="e,16123,1939 16067,1974.9 16082,1965.1 16099,1954.6 16115,1944.5",
		style=dashed];
	layer0_expert5_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="16370,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_9	[pos="e,16287,1935.5 16126,1985.4 16174,1972.5 16229,1956.5 16278,1939 16278,1939 16278,1938.9 16278,1938.9",
		style=dashed];
	layer0_expert5_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="16552,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_10	[pos="e,16470,1936 16126,2003.4 16216,1992.5 16342,1973.2 16460,1938.9",
		style=dashed];
	layer0_expert5_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="16736,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_11	[pos="e,16653,1936.2 16126,2011.6 16254,2005.1 16460,1987.8 16643,1938.9",
		style=dashed];
	layer0_expert5_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="16918,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_12	[pos="e,16836,1936.3 16126,2009 16317,1997.9 16680,1973.6 16826,1938.8",
		style=dashed];
	layer0_expert5_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="17102,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_13	[pos="e,17019,1936.4 16126,2011.4 16351,2002.9 16827,1980.9 17009,1938.8",
		style=dashed];
	layer0_expert5_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="17284,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_14	[pos="e,17202,1936.4 16126,2013 16383,2007 16975,1988.3 17192,1938.7",
		style=dashed];
	layer0_expert5_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="17468,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu5 -> layer0_expert5_15	[pos="e,17385,1936.5 16126,2014.3 16412,2010.5 17121,1995.8 17375,1938.8",
		style=dashed];
	layer0_moe_agg_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_MoE_Aggregate_GPU5
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 5",
		pos="15912,1752",
		shape=rectangle,
		width=2.8194];
	layer0_expert5_0 -> layer0_moe_agg_gpu5	[pos="e,15810,1758.3 14805,1858.4 14808,1857.5 14811,1856.7 14814,1856 14998,1807.8 15558,1772.3 15799,1758.9"];
	layer0_expert5_1 -> layer0_moe_agg_gpu5	[pos="e,15810,1754.4 14988,1858.4 14991,1857.6 14994,1856.7 14996,1856 15279,1779.3 15625,1759.6 15800,1754.6"];
	layer0_expert5_2 -> layer0_moe_agg_gpu5	[pos="e,15810,1758.3 15171,1858.5 15174,1857.6 15177,1856.8 15180,1856 15394,1794.6 15654,1769.1 15800,1759"];
	layer0_expert5_3 -> layer0_moe_agg_gpu5	[pos="e,15810,1764.8 15354,1858.8 15357,1857.8 15360,1856.9 15362,1856 15510,1809.9 15688,1781.2 15800,1766.2"];
	layer0_expert5_4 -> layer0_moe_agg_gpu5	[pos="e,15810,1777.4 15537,1859.1 15540,1858 15543,1857 15546,1856 15629,1825.7 15727,1798.7 15800,1779.9"];
	layer0_expert5_5 -> layer0_moe_agg_gpu5	[pos="e,15834,1793.7 15715,1856 15749,1838.1 15789,1817 15824,1798.6"];
	layer0_expert5_6 -> layer0_moe_agg_gpu5	[pos="e,15886,1793.8 15846,1855.8 15857,1839.3 15869,1820 15880,1802.7"];
	layer0_expert5_7 -> layer0_moe_agg_gpu5	[pos="e,15938,1793.8 15977,1855.8 15967,1839.3 15954,1820 15943,1802.7"];
	layer0_expert5_8 -> layer0_moe_agg_gpu5	[pos="e,15989,1793.7 16109,1856 16074,1838 16034,1816.8 15998,1798.3"];
	layer0_expert5_9 -> layer0_moe_agg_gpu5	[pos="e,16013,1777.6 16287,1859.5 16284,1858.3 16281,1857.1 16278,1856 16194,1825.9 16096,1798.8 16023,1780"];
	layer0_expert5_10 -> layer0_moe_agg_gpu5	[pos="e,16013,1765 16470,1859.1 16467,1858 16464,1857 16460,1856 16312,1810.2 16135,1781.4 16023,1766.3"];
	layer0_expert5_11 -> layer0_moe_agg_gpu5	[pos="e,16013,1758.5 16653,1858.9 16650,1857.9 16647,1856.9 16644,1856 16429,1795 16169,1769.3 16023,1759.2"];
	layer0_expert5_12 -> layer0_moe_agg_gpu5	[pos="e,16013,1754.5 16836,1858.8 16833,1857.8 16830,1856.8 16826,1856 16544,1779.8 16198,1759.9 16023,1754.8"];
	layer0_expert5_13 -> layer0_moe_agg_gpu5	[pos="e,16013,1758.4 17019,1858.7 17016,1857.7 17013,1856.8 17010,1856 16825,1808.1 16265,1772.5 16024,1758.9"];
	layer0_expert5_14 -> layer0_moe_agg_gpu5	[pos="e,16013,1756.8 17202,1858.6 17199,1857.7 17196,1856.8 17192,1856 16972,1800.4 16293,1768.1 16023,1757.2"];
	layer0_expert5_15 -> layer0_moe_agg_gpu5	[pos="e,16013,1755.6 17385,1858.6 17382,1857.6 17379,1856.8 17376,1856 17119,1792.7 16320,1764.4 16024,1755.9"];
	layer0_output_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU5
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 5",
		pos="13466,1408",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu5 -> layer0_output_gpu5	[pos="e,13589,1426.1 15810,1736.8 15422,1682.6 14035,1488.5 13599,1427.5"];
	layer0_moe_agg_gpu5 -> layer0_allreduce_moe	[pos="e,12138,1588.6 15810,1746.6 15282,1723.9 12846,1619.1 12148,1589.1"];
	layer0_attn_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Multi-Head_Attention_GPU6
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 6",
		pos="12356,2598.5",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu6 -> layer0_attn_gpu6	[pos="e,12351,2640.2 12347,2675.9 12348,2667.5 12349,2658.8 12350,2650.3"];
	layer0_attn_proj_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU6
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 6",
		pos="12356,2453",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu6 -> layer0_attn_proj_gpu6	[pos="e,12356,2487.1 12356,2556.8 12356,2538.2 12356,2516.1 12356,2497.2"];
	layer0_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU6
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 6",
		pos="12358,2135.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_proj_gpu6 -> layer0_attn_norm_gpu6	[pos="e,12358,2169.7 12357,2418.8 12357,2361.4 12358,2243.6 12358,2179.8"];
	layer0_attn_proj_gpu6 -> layer0_allreduce_attn	[pos="e,11842,2302.4 12290,2418.8 12264,2406.9 12233,2394.1 12204,2385 12088,2347.9 11953,2321 11852,2304"];
	layer0_gate_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU6
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 6",
		pos="18932,2016.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu6 -> layer0_gate_gpu6	[pos="e,18809,2019.5 12454,2101.4 12466,2098.4 12478,2095.8 12490,2094 12690,2062.8 15932,2060.5 16134,2058 17160,2045.5 18398,2026.1 \
18799,2019.6"];
	layer0_expert6_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="17650,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_0	[pos="e,17733,1936.7 18809,2013.1 18551,2007.2 17960,1988.8 17743,1939.1",
		style=dashed];
	layer0_expert6_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="17834,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_1	[pos="e,17916,1936.7 18809,2011.4 18583,2003.1 18107,1981.3 17926,1939.1",
		style=dashed];
	layer0_expert6_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="18016,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_2	[pos="e,18099,1936.6 18809,2009 18618,1998.1 18254,1974 18109,1939.1",
		style=dashed];
	layer0_expert6_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="18200,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_3	[pos="e,18282,1936.5 18809,2011.8 18681,2005.4 18474,1988.2 18292,1939.2",
		style=dashed];
	layer0_expert6_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="18382,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_4	[pos="e,18465,1936.4 18809,2003.6 18718,1992.8 18592,1973.5 18475,1939.3",
		style=dashed];
	layer0_expert6_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="18566,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_5	[pos="e,18648,1935.9 18809,1985.7 18764,1973.6 18712,1958.5 18658,1939.3",
		style=dashed];
	layer0_expert6_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="18748,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_6	[pos="e,18812,1939 18868,1974.9 18853,1965.1 18836,1954.6 18820,1944.5",
		style=dashed];
	layer0_expert6_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="18932,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_7	[pos="e,18932,1939 18932,1974.9 18932,1966.6 18932,1957.9 18932,1949.3",
		style=dashed];
	layer0_expert6_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="19114,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_8	[pos="e,19051,1939 18995,1974.9 19010,1965.1 19027,1954.6 19043,1944.5",
		style=dashed];
	layer0_expert6_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="19298,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_9	[pos="e,19215,1935.5 19054,1985.4 19102,1972.5 19157,1956.5 19206,1939 19206,1939 19206,1938.9 19206,1938.9",
		style=dashed];
	layer0_expert6_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="19480,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_10	[pos="e,19398,1936 19054,2003.4 19144,1992.5 19270,1973.2 19388,1938.9",
		style=dashed];
	layer0_expert6_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="19664,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_11	[pos="e,19581,1936.2 19054,2011.6 19182,2005.1 19388,1987.8 19571,1938.9",
		style=dashed];
	layer0_expert6_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="19846,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_12	[pos="e,19764,1936.3 19054,2009 19245,1997.9 19608,1973.6 19754,1938.8",
		style=dashed];
	layer0_expert6_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="20030,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_13	[pos="e,19947,1936.4 19054,2011.4 19279,2002.9 19755,1980.9 19937,1938.8",
		style=dashed];
	layer0_expert6_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="20212,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_14	[pos="e,20130,1936.4 19054,2013 19311,2007 19903,1988.3 20120,1938.7",
		style=dashed];
	layer0_expert6_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="20396,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu6 -> layer0_expert6_15	[pos="e,20313,1936.5 19054,2014.3 19340,2010.5 20049,1995.8 20303,1938.8",
		style=dashed];
	layer0_moe_agg_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_MoE_Aggregate_GPU6
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 6",
		pos="18840,1752",
		shape=rectangle,
		width=2.8194];
	layer0_expert6_0 -> layer0_moe_agg_gpu6	[pos="e,18738,1758.3 17733,1858.4 17736,1857.5 17739,1856.7 17742,1856 17926,1807.8 18486,1772.3 18727,1758.9"];
	layer0_expert6_1 -> layer0_moe_agg_gpu6	[pos="e,18738,1754.4 17916,1858.4 17919,1857.6 17922,1856.7 17924,1856 18207,1779.3 18553,1759.6 18728,1754.6"];
	layer0_expert6_2 -> layer0_moe_agg_gpu6	[pos="e,18738,1758.3 18099,1858.5 18102,1857.6 18105,1856.8 18108,1856 18322,1794.6 18582,1769.1 18728,1759"];
	layer0_expert6_3 -> layer0_moe_agg_gpu6	[pos="e,18738,1764.8 18282,1858.8 18285,1857.8 18288,1856.9 18290,1856 18438,1809.9 18616,1781.2 18728,1766.2"];
	layer0_expert6_4 -> layer0_moe_agg_gpu6	[pos="e,18738,1777.4 18465,1859.1 18468,1858 18471,1857 18474,1856 18557,1825.7 18655,1798.7 18728,1779.9"];
	layer0_expert6_5 -> layer0_moe_agg_gpu6	[pos="e,18762,1793.7 18643,1856 18677,1838.1 18717,1817 18752,1798.6"];
	layer0_expert6_6 -> layer0_moe_agg_gpu6	[pos="e,18814,1793.8 18774,1855.8 18785,1839.3 18797,1820 18808,1802.7"];
	layer0_expert6_7 -> layer0_moe_agg_gpu6	[pos="e,18866,1793.8 18905,1855.8 18895,1839.3 18882,1820 18871,1802.7"];
	layer0_expert6_8 -> layer0_moe_agg_gpu6	[pos="e,18917,1793.7 19037,1856 19002,1838 18962,1816.8 18926,1798.3"];
	layer0_expert6_9 -> layer0_moe_agg_gpu6	[pos="e,18941,1777.6 19215,1859.5 19212,1858.3 19209,1857.1 19206,1856 19122,1825.9 19024,1798.8 18951,1780"];
	layer0_expert6_10 -> layer0_moe_agg_gpu6	[pos="e,18941,1765 19398,1859.1 19395,1858 19392,1857 19388,1856 19240,1810.2 19063,1781.4 18951,1766.3"];
	layer0_expert6_11 -> layer0_moe_agg_gpu6	[pos="e,18941,1758.5 19581,1858.9 19578,1857.9 19575,1856.9 19572,1856 19357,1795 19097,1769.3 18951,1759.2"];
	layer0_expert6_12 -> layer0_moe_agg_gpu6	[pos="e,18941,1754.5 19764,1858.8 19761,1857.8 19758,1856.8 19754,1856 19472,1779.8 19126,1759.9 18951,1754.8"];
	layer0_expert6_13 -> layer0_moe_agg_gpu6	[pos="e,18941,1758.4 19947,1858.7 19944,1857.7 19941,1856.8 19938,1856 19753,1808.1 19193,1772.5 18952,1758.9"];
	layer0_expert6_14 -> layer0_moe_agg_gpu6	[pos="e,18941,1756.8 20130,1858.6 20127,1857.7 20124,1856.8 20120,1856 19900,1800.4 19221,1768.1 18951,1757.2"];
	layer0_expert6_15 -> layer0_moe_agg_gpu6	[pos="e,18941,1755.6 20313,1858.6 20310,1857.6 20307,1856.8 20304,1856 20047,1792.7 19248,1764.4 18952,1755.9"];
	layer0_output_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU6
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 6",
		pos="15266,1408",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu6 -> layer0_output_gpu6	[pos="e,15388,1420.7 18738,1741.3 18230,1692.7 15971,1476.5 15398,1421.7"];
	layer0_moe_agg_gpu6 -> layer0_allreduce_moe	[pos="e,12147,1585.6 18738,1748.5 17979,1729.7 13191,1611.4 12157,1585.9"];
	layer0_attn_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Multi-Head_Attention_GPU7
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 7",
		pos="12618,2598.5",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu7 -> layer0_attn_gpu7	[pos="e,12610,2640.2 12603,2675.9 12604,2667.4 12606,2658.6 12608,2650.1"];
	layer0_attn_proj_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU7
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 7",
		pos="12618,2453",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu7 -> layer0_attn_proj_gpu7	[pos="e,12618,2487.1 12618,2556.8 12618,2538.2 12618,2516.1 12618,2497.2"];
	layer0_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU7
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 7",
		pos="12620,2135.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_proj_gpu7 -> layer0_attn_norm_gpu7	[pos="e,12620,2169.7 12618,2418.8 12618,2361.4 12619,2243.6 12620,2179.8"];
	layer0_attn_proj_gpu7 -> layer0_allreduce_attn	[pos="e,11875,2291.4 12553,2418.8 12527,2406.4 12495,2393.4 12466,2385 12271,2330.3 12041,2304.3 11885,2292.2"];
	layer0_gate_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU7
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 7",
		pos="21860,2016.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu7 -> layer0_gate_gpu7	[pos="e,21737,2019.4 12743,2133.2 13392,2126.1 16512,2091.6 19062,2058 20088,2044.5 21326,2025.7 21727,2019.5"];
	layer0_expert7_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="20578,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_0	[pos="e,20661,1936.7 21737,2013.1 21479,2007.2 20888,1988.8 20671,1939.1",
		style=dashed];
	layer0_expert7_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="20762,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_1	[pos="e,20844,1936.7 21737,2011.4 21511,2003.1 21035,1981.3 20854,1939.1",
		style=dashed];
	layer0_expert7_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="20944,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_2	[pos="e,21027,1936.6 21737,2009 21546,1998.1 21182,1974 21037,1939.1",
		style=dashed];
	layer0_expert7_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="21128,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_3	[pos="e,21210,1936.5 21737,2011.8 21609,2005.4 21402,1988.2 21220,1939.2",
		style=dashed];
	layer0_expert7_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="21310,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_4	[pos="e,21393,1936.4 21737,2003.6 21646,1992.8 21520,1973.5 21403,1939.3",
		style=dashed];
	layer0_expert7_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="21494,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_5	[pos="e,21576,1935.9 21737,1985.7 21692,1973.6 21640,1958.5 21586,1939.3",
		style=dashed];
	layer0_expert7_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="21676,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_6	[pos="e,21740,1939 21796,1974.9 21781,1965.1 21764,1954.6 21748,1944.5",
		style=dashed];
	layer0_expert7_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="21860,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_7	[pos="e,21860,1939 21860,1974.9 21860,1966.6 21860,1957.9 21860,1949.3",
		style=dashed];
	layer0_expert7_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="22042,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_8	[pos="e,21979,1939 21923,1974.9 21938,1965.1 21955,1954.6 21971,1944.5",
		style=dashed];
	layer0_expert7_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="22226,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_9	[pos="e,22143,1935.7 21982,1977.5 21985,1976.6 21988,1975.8 21990,1975 22051,1958.1 22070,1960 22133,1939",
		style=dashed];
	layer0_expert7_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="22408,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_10	[pos="e,22326,1936.2 21982,1976.9 21985,1976.2 21988,1975.6 21990,1975 22130,1946 22174,1975.4 22316,1938.9",
		style=dashed];
	layer0_expert7_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="22592,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_11	[pos="e,22509,1936.4 21982,1976.8 21985,1976.1 21988,1975.5 21990,1975 22210,1933.8 22277,1991.7 22499,1938.8",
		style=dashed];
	layer0_expert7_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="22774,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_12	[pos="e,22692,1936.5 21982,1976.7 21985,1976.1 21988,1975.5 21990,1975 22290,1921.7 22381,2008.3 22682,1938.8",
		style=dashed];
	layer0_expert7_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="22958,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_13	[pos="e,22875,1936.5 21982,1976.7 21985,1976.1 21988,1975.5 21990,1975 22371,1909.5 22484,2024.9 22865,1938.8",
		style=dashed];
	layer0_expert7_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="23140,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_14	[pos="e,23058,1936.5 21982,1976.6 21985,1976 21988,1975.5 21990,1975 22219,1936.4 22803,1989.8 23048,1938.7",
		style=dashed];
	layer0_expert7_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="23324,1897.5",
		shape=rectangle,
		width=2.2917];
	layer0_gate_gpu7 -> layer0_expert7_15	[pos="e,23241,1936.6 21982,1976.6 21985,1976 21988,1975.5 21990,1975 22259,1930.4 22946,1998.1 23231,1938.8",
		style=dashed];
	layer0_moe_agg_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_MoE_Aggregate_GPU7
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 7",
		pos="21768,1752",
		shape=rectangle,
		width=2.8194];
	layer0_expert7_0 -> layer0_moe_agg_gpu7	[pos="e,21666,1758.3 20661,1858.4 20664,1857.5 20667,1856.7 20670,1856 20854,1807.8 21414,1772.3 21655,1758.9"];
	layer0_expert7_1 -> layer0_moe_agg_gpu7	[pos="e,21666,1754.4 20844,1858.4 20847,1857.6 20850,1856.7 20852,1856 21135,1779.3 21481,1759.6 21656,1754.6"];
	layer0_expert7_2 -> layer0_moe_agg_gpu7	[pos="e,21666,1758.3 21027,1858.5 21030,1857.6 21033,1856.8 21036,1856 21250,1794.6 21510,1769.1 21656,1759"];
	layer0_expert7_3 -> layer0_moe_agg_gpu7	[pos="e,21666,1764.8 21210,1858.8 21213,1857.8 21216,1856.9 21218,1856 21366,1809.9 21544,1781.2 21656,1766.2"];
	layer0_expert7_4 -> layer0_moe_agg_gpu7	[pos="e,21666,1777.4 21393,1859.1 21396,1858 21399,1857 21402,1856 21485,1825.7 21583,1798.7 21656,1779.9"];
	layer0_expert7_5 -> layer0_moe_agg_gpu7	[pos="e,21690,1793.7 21571,1856 21605,1838.1 21645,1817 21680,1798.6"];
	layer0_expert7_6 -> layer0_moe_agg_gpu7	[pos="e,21742,1793.8 21702,1855.8 21713,1839.3 21725,1820 21736,1802.7"];
	layer0_expert7_7 -> layer0_moe_agg_gpu7	[pos="e,21794,1793.8 21833,1855.8 21823,1839.3 21810,1820 21799,1802.7"];
	layer0_expert7_8 -> layer0_moe_agg_gpu7	[pos="e,21845,1793.7 21965,1856 21930,1838 21890,1816.8 21854,1798.3"];
	layer0_expert7_9 -> layer0_moe_agg_gpu7	[pos="e,21869,1777.6 22143,1859.5 22140,1858.3 22137,1857.1 22134,1856 22050,1825.9 21952,1798.8 21879,1780"];
	layer0_expert7_10 -> layer0_moe_agg_gpu7	[pos="e,21869,1765 22326,1859.1 22323,1858 22320,1857 22316,1856 22168,1810.2 21991,1781.4 21879,1766.3"];
	layer0_expert7_11 -> layer0_moe_agg_gpu7	[pos="e,21869,1758.5 22509,1858.9 22506,1857.9 22503,1856.9 22500,1856 22285,1795 22025,1769.3 21879,1759.2"];
	layer0_expert7_12 -> layer0_moe_agg_gpu7	[pos="e,21869,1754.5 22692,1858.8 22689,1857.8 22686,1856.8 22682,1856 22400,1779.8 22054,1759.9 21879,1754.8"];
	layer0_expert7_13 -> layer0_moe_agg_gpu7	[pos="e,21869,1758.4 22875,1858.7 22872,1857.7 22869,1856.8 22866,1856 22681,1808.1 22121,1772.5 21880,1758.9"];
	layer0_expert7_14 -> layer0_moe_agg_gpu7	[pos="e,21869,1756.8 23058,1858.6 23055,1857.7 23052,1856.8 23048,1856 22828,1800.4 22149,1768.1 21879,1757.2"];
	layer0_expert7_15 -> layer0_moe_agg_gpu7	[pos="e,21869,1755.6 23241,1858.6 23238,1857.6 23235,1856.8 23232,1856 22975,1792.7 22176,1764.4 21880,1755.9"];
	layer0_output_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU7
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 7",
		pos="17494,1408",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu7 -> layer0_output_gpu7	[pos="e,17617,1418.8 21666,1742.9 21093,1697 18274,1471.4 17627,1419.6"];
	layer0_moe_agg_gpu7 -> layer0_allreduce_moe	[pos="e,12154,1583.2 21666,1748.2 21299,1738.4 20012,1704.5 18950,1684 16266,1632.3 13002,1593 12164,1583.3"];
	layer0_allreduce_attn -> layer0_attn_norm_gpu0	[pos="e,10887,2169.5 11541,2266.9 11382,2252 11131,2223.6 10918,2177 10911,2175.5 10904,2173.9 10897,2172.2"];
	layer0_allreduce_attn -> layer0_attn_norm_gpu1	[pos="e,11152,2169.6 11569,2257.7 11463,2239 11311,2210.1 11180,2177 11174,2175.5 11168,2174 11162,2172.4"];
	layer0_allreduce_attn -> layer0_attn_norm_gpu2	[pos="e,11401,2169.6 11607,2245 11547,2223.2 11471,2195.2 11410,2173.1"];
	layer0_allreduce_attn -> layer0_attn_norm_gpu3	[pos="e,11603,2169.9 11656,2228.2 11640,2211.5 11624,2193.2 11610,2177.4"];
	layer0_allreduce_attn -> layer0_attn_norm_gpu4	[pos="e,11804,2169.7 11750,2228.6 11765,2211.7 11782,2193.2 11797,2177.3"];
	layer0_allreduce_attn -> layer0_attn_norm_gpu5	[pos="e,12006,2169.6 11798,2245.1 11858,2223.3 11935,2195.2 11996,2173.1"];
	layer0_allreduce_attn -> layer0_attn_norm_gpu6	[pos="e,12255,2169.6 11836,2257.8 11943,2239.1 12096,2210.2 12228,2177 12233,2175.5 12239,2174 12245,2172.4"];
	layer0_allreduce_attn -> layer0_attn_norm_gpu7	[pos="e,12520,2169.5 11864,2267 12024,2252.2 12275,2223.7 12490,2177 12496,2175.5 12503,2173.9 12510,2172.2"];
	layer0_allreduce_moe -> layer0_output_gpu0	[pos="e,5993.7,1412.4 11776,1573.8 10857,1548.2 6791.7,1434.7 6004,1412.7"];
	layer0_allreduce_moe -> layer0_output_gpu1	[pos="e,8924.8,1415.6 11788,1569.7 11223,1539.3 9437,1443.2 8935,1416.1"];
	layer0_allreduce_moe -> layer0_output_gpu2	[pos="e,10522,1422.3 11809,1562.5 11504,1529.3 10820,1454.8 10532,1423.4"];
	layer0_allreduce_moe -> layer0_output_gpu3	[pos="e,11451,1441.9 11849,1549.1 11741,1519.9 11576,1475.5 11461,1444.5"];
	layer0_allreduce_moe -> layer0_output_gpu4	[pos="e,12201,1442.2 12035,1536.8 12083,1509.3 12145,1473.8 12192,1447.2"];
	layer0_allreduce_moe -> layer0_output_gpu5	[pos="e,13344,1422.8 12110,1562.1 12405,1528.8 13055,1455.5 13334,1423.9"];
	layer0_allreduce_moe -> layer0_output_gpu6	[pos="e,15143,1415.3 12134,1570.1 12720,1540 14614,1442.5 15133,1415.8"];
	layer0_allreduce_moe -> layer0_output_gpu7	[pos="e,17372,1413 12145,1573.6 12659,1558.5 14154,1514.5 15396,1476 16140,1453 17031,1424.1 17362,1413.3"];
	layer1_qkv_gpu0	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 0-3
TP Slice: 0
GPU: 0",
		pos="32786,2859",
		shape=rectangle,
		width=2.9167];
	layer1_attn_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Multi-Head_Attention_GPU0
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 0",
		pos="32786,2725",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu0 -> layer1_attn_gpu0	[pos="e,32786,2766.8 32786,2810 32786,2799.2 32786,2787.8 32786,2777"];
	layer1_attn_proj_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU0
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 0",
		pos="32786,2598.5",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu0 -> layer1_attn_proj_gpu0	[pos="e,32786,2632.9 32786,2683.2 32786,2670.4 32786,2656.1 32786,2643"];
	layer1_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU0
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 0",
		pos="32786,2281",
		shape=rectangle,
		width=3.3889];
	layer1_attn_proj_gpu0 -> layer1_attn_norm_gpu0	[pos="e,32786,2315.2 32786,2564.3 32786,2506.9 32786,2389.1 32786,2325.3"];
	layer1_allreduce_attn	[height=1.8889,
		label="L1_All-Reduce_Attention
Input: 8Ã—[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce",
		pos="33702,2453",
		width=5.6389];
	layer1_attn_proj_gpu0 -> layer1_allreduce_attn	[pos="e,33548,2469.3 32887,2569.2 32905,2564.8 32923,2560.5 32940,2557 33145,2516.5 33383,2487.1 33538,2470.3"];
	layer1_gate_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU0
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 0",
		pos="23546,2135.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu0 -> layer1_gate_gpu0	[pos="e,23669,2138.4 32663,2278.1 31655,2262.4 24725,2154.8 23679,2138.6"];
	layer1_expert0_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="22082,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_0	[pos="e,22165,2055.8 23424,2133.3 23138,2129.7 22428,2115.3 22175,2058.1",
		style=dashed];
	layer1_expert0_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="22266,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_1	[pos="e,22348,2055.7 23424,2132.1 23166,2126.2 22575,2107.8 22358,2058.1",
		style=dashed];
	layer1_expert0_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="22448,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_2	[pos="e,22531,2055.7 23424,2130.4 23198,2122.1 22722,2100.3 22541,2058.1",
		style=dashed];
	layer1_expert0_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="22632,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_3	[pos="e,22714,2055.6 23424,2128 23233,2117.1 22869,2093 22724,2058.1",
		style=dashed];
	layer1_expert0_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="22814,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_4	[pos="e,22897,2055.5 23424,2130.8 23296,2124.4 23089,2107.2 22907,2058.2",
		style=dashed];
	layer1_expert0_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="22998,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_5	[pos="e,23080,2055.4 23424,2122.6 23333,2111.8 23207,2092.5 23090,2058.3",
		style=dashed];
	layer1_expert0_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="23180,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_6	[pos="e,23263,2054.9 23424,2104.7 23379,2092.6 23327,2077.5 23273,2058.3",
		style=dashed];
	layer1_expert0_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="23364,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_7	[pos="e,23427,2058 23483,2093.9 23468,2084.1 23451,2073.6 23435,2063.5",
		style=dashed];
	layer1_expert0_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="23546,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_8	[pos="e,23546,2058 23546,2093.9 23546,2085.6 23546,2076.9 23546,2068.3",
		style=dashed];
	layer1_expert0_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="23730,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_9	[pos="e,23666,2058 23610,2093.9 23625,2084.1 23642,2073.6 23658,2063.5",
		style=dashed];
	layer1_expert0_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="23912,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_10	[pos="e,23830,2054.5 23669,2104.4 23717,2091.5 23772,2075.5 23820,2058 23821,2058 23821,2057.9 23821,2057.9",
		style=dashed];
	layer1_expert0_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="24096,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_11	[pos="e,24013,2055 23669,2122.4 23759,2111.5 23885,2092.2 24003,2057.9",
		style=dashed];
	layer1_expert0_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="24278,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_12	[pos="e,24196,2055.2 23669,2130.6 23797,2124.1 24003,2106.8 24186,2057.9",
		style=dashed];
	layer1_expert0_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="24462,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_13	[pos="e,24379,2055.3 23669,2128 23860,2116.9 24223,2092.6 24369,2057.8",
		style=dashed];
	layer1_expert0_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="24644,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_14	[pos="e,24562,2055.4 23669,2130.4 23894,2121.9 24370,2099.9 24552,2057.8",
		style=dashed];
	layer1_expert0_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU0
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 0",
		pos="24828,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu0 -> layer1_expert0_15	[pos="e,24745,2055.4 23669,2132 23926,2126 24518,2107.3 24735,2057.7",
		style=dashed];
	layer1_moe_agg_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_MoE_Aggregate_GPU0
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 0",
		pos="23638,1897.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert0_0 -> layer1_moe_agg_gpu0	[pos="e,23537,1920.2 22165,1977.1 22168,1976.4 22171,1975.6 22174,1975 22443,1913.8 23140,1967.6 23414,1939 23451,1935.2 23491,1928.7 \
23527,1922.1"];
	layer1_expert0_1 -> layer1_moe_agg_gpu0	[pos="e,23537,1920.1 22348,1977.2 22351,1976.4 22354,1975.6 22356,1975 22586,1922.2 23181,1964 23414,1939 23451,1935.1 23491,1928.6 23527,\
1922"];
	layer1_expert0_2 -> layer1_moe_agg_gpu0	[pos="e,23537,1919.9 22531,1977.2 22534,1976.4 22537,1975.7 22540,1975 22729,1930.6 23221,1960.4 23414,1939 23451,1934.9 23491,1928.4 \
23527,1921.8"];
	layer1_expert0_3 -> layer1_moe_agg_gpu0	[pos="e,23537,1919.7 22714,1977.2 22717,1976.4 22720,1975.7 22722,1975 23022,1903.2 23109,1974.5 23414,1939 23451,1934.7 23491,1928.2 \
23527,1921.6"];
	layer1_expert0_4 -> layer1_moe_agg_gpu0	[pos="e,23537,1919.3 22897,1977.3 22900,1976.5 22903,1975.7 22906,1975 23126,1920.1 23189,1967.2 23414,1939 23451,1934.4 23491,1927.7 \
23527,1921.1"];
	layer1_expert0_5 -> layer1_moe_agg_gpu0	[pos="e,23537,1918.4 23080,1977.4 23083,1976.6 23086,1975.7 23088,1975 23229,1936.9 23270,1960 23414,1939 23451,1933.7 23491,1926.8 23527,\
1920.2"];
	layer1_expert0_6 -> layer1_moe_agg_gpu0	[pos="e,23537,1917.2 23263,1977.9 23266,1976.9 23269,1975.9 23272,1975 23318,1960 23437,1936.1 23527,1919.1"];
	layer1_expert0_7 -> layer1_moe_agg_gpu0	[pos="e,23539,1939.1 23446,1978.6 23449,1977.3 23452,1976.2 23454,1975 23479,1964.5 23505,1953.4 23530,1943.1"];
	layer1_expert0_8 -> layer1_moe_agg_gpu0	[pos="e,23607,1939 23578,1974.9 23585,1965.9 23593,1956.3 23600,1947.1"];
	layer1_expert0_9 -> layer1_moe_agg_gpu0	[pos="e,23670,1939 23698,1974.9 23691,1965.9 23683,1956.3 23676,1947.1"];
	layer1_expert0_10 -> layer1_moe_agg_gpu0	[pos="e,23736,1939.1 23830,1979 23827,1977.6 23824,1976.3 23820,1975 23796,1964.6 23770,1953.5 23745,1943"];
	layer1_expert0_11 -> layer1_moe_agg_gpu0	[pos="e,23740,1914 24013,1978.2 24010,1977 24007,1976 24004,1975 23920,1948.3 23823,1928.5 23750,1915.7"];
	layer1_expert0_12 -> layer1_moe_agg_gpu0	[pos="e,23740,1904.3 24196,1977.9 24193,1976.8 24190,1975.9 24186,1975 24039,1933.1 23863,1913.7 23751,1905.1"];
	layer1_expert0_13 -> layer1_moe_agg_gpu0	[pos="e,23740,1899.3 24379,1977.7 24376,1976.7 24373,1975.8 24370,1975 24155,1918.2 23896,1903.2 23750,1899.5"];
	layer1_expert0_14 -> layer1_moe_agg_gpu0	[pos="e,23740,1902.8 24562,1977.7 24559,1976.7 24556,1975.8 24552,1975 24404,1937.1 23960,1912.9 23750,1903.2"];
	layer1_expert0_15 -> layer1_moe_agg_gpu0	[pos="e,23740,1901.1 24745,1977.6 24742,1976.6 24739,1975.8 24736,1975 24551,1929.5 23991,1908.5 23750,1901.4"];
	layer1_output_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU0
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 0",
		pos="32766,1580",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu0 -> layer1_output_gpu0	[pos="e,32643,1583.2 23740,1891.5 24257,1866 26643,1750 28598,1684 30186,1630.3 32116,1592.9 32633,1583.4"];
	layer1_allreduce_moe	[height=1.8889,
		label="L1_All-Reduce_MoE
Input: 8Ã—[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce",
		pos="33800,1752",
		width=5.6389];
	layer1_moe_agg_gpu0 -> layer1_allreduce_moe	[pos="e,33608,1755.7 23740,1895 24107,1889.7 25394,1871.1 26456,1856 29289,1815.8 32737,1767.8 33598,1755.8"];
	pipeline_stage0_1	[fillcolor=yellow,
		height=1.8889,
		label="Pipeline_Stage0_to_1
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Cross-stage communication",
		pos="33682,1408",
		shape=parallelogram,
		width=6.1629];
	layer1_output_gpu0 -> pipeline_stage0_1	[pos="e,33510,1414.7 32820,1545.9 32843,1533.4 32870,1520.2 32896,1512 33097,1449.5 33338,1425 33500,1415.3"];
	layer1_qkv_gpu1	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 4-7
TP Slice: 1
GPU: 1",
		pos="33050,2859",
		shape=rectangle,
		width=2.9167];
	layer1_attn_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Multi-Head_Attention_GPU1
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 1",
		pos="33050,2725",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu1 -> layer1_attn_gpu1	[pos="e,33050,2766.8 33050,2810 33050,2799.2 33050,2787.8 33050,2777"];
	layer1_attn_proj_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU1
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 1",
		pos="33050,2598.5",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu1 -> layer1_attn_proj_gpu1	[pos="e,33050,2632.9 33050,2683.2 33050,2670.4 33050,2656.1 33050,2643"];
	layer1_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU1
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 1",
		pos="33048,2281",
		shape=rectangle,
		width=3.3889];
	layer1_attn_proj_gpu1 -> layer1_attn_norm_gpu1	[pos="e,33048,2315.2 33049,2564.3 33049,2506.9 33048,2389.1 33048,2325.3"];
	layer1_attn_proj_gpu1 -> layer1_allreduce_attn	[pos="e,33575,2478.3 33150,2570.1 33167,2565.6 33185,2561 33202,2557 33324,2528.3 33464,2499.9 33565,2480.2"];
	layer1_gate_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU1
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 1",
		pos="26474,2135.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu1 -> layer1_gate_gpu1	[pos="e,26597,2138.5 32996,2246.9 32973,2233.6 32944,2219.9 32916,2213 32818,2188.8 29373,2178.2 29272,2177 28246,2164.5 27008,2145.1 \
26607,2138.6"];
	layer1_expert1_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="25010,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_0	[pos="e,25093,2055.8 26352,2133.3 26066,2129.7 25356,2115.3 25103,2058.1",
		style=dashed];
	layer1_expert1_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="25194,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_1	[pos="e,25276,2055.7 26352,2132.1 26094,2126.2 25503,2107.8 25286,2058.1",
		style=dashed];
	layer1_expert1_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="25376,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_2	[pos="e,25459,2055.7 26352,2130.4 26126,2122.1 25650,2100.3 25469,2058.1",
		style=dashed];
	layer1_expert1_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="25560,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_3	[pos="e,25642,2055.6 26352,2128 26161,2117.1 25797,2093 25652,2058.1",
		style=dashed];
	layer1_expert1_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="25742,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_4	[pos="e,25825,2055.5 26352,2130.8 26224,2124.4 26017,2107.2 25835,2058.2",
		style=dashed];
	layer1_expert1_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="25926,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_5	[pos="e,26008,2055.4 26352,2122.6 26261,2111.8 26135,2092.5 26018,2058.3",
		style=dashed];
	layer1_expert1_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="26108,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_6	[pos="e,26191,2054.9 26352,2104.7 26307,2092.6 26255,2077.5 26201,2058.3",
		style=dashed];
	layer1_expert1_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="26292,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_7	[pos="e,26355,2058 26411,2093.9 26396,2084.1 26379,2073.6 26363,2063.5",
		style=dashed];
	layer1_expert1_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="26474,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_8	[pos="e,26474,2058 26474,2093.9 26474,2085.6 26474,2076.9 26474,2068.3",
		style=dashed];
	layer1_expert1_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="26658,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_9	[pos="e,26594,2058 26538,2093.9 26553,2084.1 26570,2073.6 26586,2063.5",
		style=dashed];
	layer1_expert1_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="26840,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_10	[pos="e,26758,2054.5 26597,2104.4 26645,2091.5 26700,2075.5 26748,2058 26749,2058 26749,2057.9 26749,2057.9",
		style=dashed];
	layer1_expert1_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="27024,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_11	[pos="e,26941,2055 26597,2122.4 26687,2111.5 26813,2092.2 26931,2057.9",
		style=dashed];
	layer1_expert1_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="27206,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_12	[pos="e,27124,2055.2 26597,2130.6 26725,2124.1 26931,2106.8 27114,2057.9",
		style=dashed];
	layer1_expert1_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="27390,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_13	[pos="e,27307,2055.3 26597,2128 26788,2116.9 27151,2092.6 27297,2057.8",
		style=dashed];
	layer1_expert1_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="27572,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_14	[pos="e,27490,2055.4 26597,2130.4 26822,2121.9 27298,2099.9 27480,2057.8",
		style=dashed];
	layer1_expert1_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU1
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 1",
		pos="27756,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu1 -> layer1_expert1_15	[pos="e,27673,2055.4 26597,2132 26854,2126 27446,2107.3 27663,2057.7",
		style=dashed];
	layer1_moe_agg_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_MoE_Aggregate_GPU1
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 1",
		pos="26566,1897.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert1_0 -> layer1_moe_agg_gpu1	[pos="e,26465,1899 25093,1977.2 25096,1976.4 25099,1975.7 25102,1975 25358,1913.5 26158,1901.4 26455,1899.1"];
	layer1_expert1_1 -> layer1_moe_agg_gpu1	[pos="e,26465,1899.9 25276,1977.3 25279,1976.4 25282,1975.7 25284,1975 25505,1921.3 26185,1904.6 26455,1900.1"];
	layer1_expert1_2 -> layer1_moe_agg_gpu1	[pos="e,26465,1901.1 25459,1977.3 25462,1976.5 25465,1975.7 25468,1975 25652,1929 26213,1908.3 26454,1901.4"];
	layer1_expert1_3 -> layer1_moe_agg_gpu1	[pos="e,26465,1902.7 25642,1977.3 25645,1976.5 25648,1975.7 25650,1975 25800,1936.7 26245,1912.7 26455,1903.2"];
	layer1_expert1_4 -> layer1_moe_agg_gpu1	[pos="e,26465,1899.1 25825,1977.4 25828,1976.5 25831,1975.7 25834,1975 26048,1917.6 26309,1902.9 26455,1899.3"];
	layer1_expert1_5 -> layer1_moe_agg_gpu1	[pos="e,26465,1904.1 26008,1977.5 26011,1976.6 26014,1975.8 26016,1975 26165,1932.6 26342,1913.3 26455,1904.8"];
	layer1_expert1_6 -> layer1_moe_agg_gpu1	[pos="e,26465,1913.7 26191,1977.9 26194,1976.9 26197,1975.9 26200,1975 26283,1947.9 26381,1928.1 26455,1915.4"];
	layer1_expert1_7 -> layer1_moe_agg_gpu1	[pos="e,26467,1939.1 26374,1978.6 26377,1977.3 26380,1976.2 26382,1975 26407,1964.5 26433,1953.4 26458,1943.1"];
	layer1_expert1_8 -> layer1_moe_agg_gpu1	[pos="e,26535,1939 26506,1974.9 26513,1965.9 26521,1956.3 26528,1947.1"];
	layer1_expert1_9 -> layer1_moe_agg_gpu1	[pos="e,26598,1939 26626,1974.9 26619,1965.9 26611,1956.3 26604,1947.1"];
	layer1_expert1_10 -> layer1_moe_agg_gpu1	[pos="e,26664,1939.1 26758,1979 26755,1977.6 26752,1976.3 26748,1975 26724,1964.6 26698,1953.5 26673,1943"];
	layer1_expert1_11 -> layer1_moe_agg_gpu1	[pos="e,26668,1914 26941,1978.2 26938,1977 26935,1976 26932,1975 26848,1948.3 26751,1928.5 26678,1915.7"];
	layer1_expert1_12 -> layer1_moe_agg_gpu1	[pos="e,26668,1904.3 27124,1977.9 27121,1976.8 27118,1975.9 27114,1975 26967,1933.1 26791,1913.7 26679,1905.1"];
	layer1_expert1_13 -> layer1_moe_agg_gpu1	[pos="e,26668,1899.3 27307,1977.7 27304,1976.7 27301,1975.8 27298,1975 27083,1918.2 26824,1903.2 26678,1899.5"];
	layer1_expert1_14 -> layer1_moe_agg_gpu1	[pos="e,26668,1902.8 27490,1977.7 27487,1976.7 27484,1975.8 27480,1975 27332,1937.1 26888,1912.9 26678,1903.2"];
	layer1_expert1_15 -> layer1_moe_agg_gpu1	[pos="e,26668,1901.1 27673,1977.6 27670,1976.6 27667,1975.8 27664,1975 27479,1929.5 26919,1908.5 26678,1901.4"];
	layer1_output_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU1
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 1",
		pos="33028,1580",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu1 -> layer1_output_gpu1	[pos="e,32976,1614.2 26668,1893.5 26965,1884.4 27858,1856 28598,1820 29610,1770.7 29861,1723.3 30874,1684 31099,1675.3 32679,1702.6 32896,\
1648 32921,1641.9 32946,1630.7 32967,1619.1"];
	layer1_moe_agg_gpu1 -> layer1_allreduce_moe	[pos="e,33614,1757.6 26668,1894.9 27144,1887.3 29194,1854.2 30874,1820 31902,1799.1 33132,1769.4 33604,1757.9"];
	layer1_output_gpu1 -> pipeline_stage0_1	[pos="e,33520,1429 33084,1545.9 33106,1533.7 33133,1520.8 33158,1512 33273,1472.5 33406,1446.5 33510,1430.5"];
	layer1_qkv_gpu2	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 8-11
TP Slice: 2
GPU: 2",
		pos="33312,2859",
		shape=rectangle,
		width=2.9167];
	layer1_attn_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Multi-Head_Attention_GPU2
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 2",
		pos="33312,2725",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu2 -> layer1_attn_gpu2	[pos="e,33312,2766.8 33312,2810 33312,2799.2 33312,2787.8 33312,2777"];
	layer1_attn_proj_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU2
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 2",
		pos="33312,2598.5",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu2 -> layer1_attn_proj_gpu2	[pos="e,33312,2632.9 33312,2683.2 33312,2670.4 33312,2656.1 33312,2643"];
	layer1_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU2
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 2",
		pos="33310,2281",
		shape=rectangle,
		width=3.3889];
	layer1_attn_proj_gpu2 -> layer1_attn_norm_gpu2	[pos="e,33310,2315.2 33311,2564.3 33311,2506.9 33310,2389.1 33310,2325.3"];
	layer1_attn_proj_gpu2 -> layer1_allreduce_attn	[pos="e,33607,2489.1 33402,2564.4 33460,2543 33536,2515 33597,2492.6"];
	layer1_gate_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU2
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 2",
		pos="29402,2135.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu2 -> layer1_gate_gpu2	[pos="e,29525,2138.2 33258,2246.9 33235,2233.7 33206,2220 33178,2213 33088,2190.3 30194,2147.8 29535,2138.4"];
	layer1_expert2_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="27938,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_0	[pos="e,28021,2055.8 29280,2133.3 28994,2129.7 28284,2115.3 28031,2058.1",
		style=dashed];
	layer1_expert2_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="28122,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_1	[pos="e,28204,2055.7 29280,2132.1 29022,2126.2 28431,2107.8 28214,2058.1",
		style=dashed];
	layer1_expert2_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="28304,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_2	[pos="e,28387,2055.7 29280,2130.4 29054,2122.1 28578,2100.3 28397,2058.1",
		style=dashed];
	layer1_expert2_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="28488,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_3	[pos="e,28570,2055.6 29280,2128 29089,2117.1 28725,2093 28580,2058.1",
		style=dashed];
	layer1_expert2_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="28670,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_4	[pos="e,28753,2055.5 29280,2130.8 29152,2124.4 28945,2107.2 28763,2058.2",
		style=dashed];
	layer1_expert2_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="28854,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_5	[pos="e,28936,2055.4 29280,2122.6 29189,2111.8 29063,2092.5 28946,2058.3",
		style=dashed];
	layer1_expert2_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="29036,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_6	[pos="e,29119,2054.9 29280,2104.7 29235,2092.6 29183,2077.5 29129,2058.3",
		style=dashed];
	layer1_expert2_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="29220,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_7	[pos="e,29283,2058 29339,2093.9 29324,2084.1 29307,2073.6 29291,2063.5",
		style=dashed];
	layer1_expert2_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="29402,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_8	[pos="e,29402,2058 29402,2093.9 29402,2085.6 29402,2076.9 29402,2068.3",
		style=dashed];
	layer1_expert2_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="29586,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_9	[pos="e,29522,2058 29466,2093.9 29481,2084.1 29498,2073.6 29514,2063.5",
		style=dashed];
	layer1_expert2_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="29768,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_10	[pos="e,29686,2054.5 29525,2104.4 29573,2091.5 29628,2075.5 29676,2058 29677,2058 29677,2057.9 29677,2057.9",
		style=dashed];
	layer1_expert2_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="29952,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_11	[pos="e,29869,2055 29525,2122.4 29615,2111.5 29741,2092.2 29859,2057.9",
		style=dashed];
	layer1_expert2_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="30134,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_12	[pos="e,30052,2055.2 29525,2130.6 29653,2124.1 29859,2106.8 30042,2057.9",
		style=dashed];
	layer1_expert2_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="30318,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_13	[pos="e,30235,2055.3 29525,2128 29716,2116.9 30079,2092.6 30225,2057.8",
		style=dashed];
	layer1_expert2_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="30500,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_14	[pos="e,30418,2055.4 29525,2130.4 29750,2121.9 30226,2099.9 30408,2057.8",
		style=dashed];
	layer1_expert2_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU2
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 2",
		pos="30684,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu2 -> layer1_expert2_15	[pos="e,30601,2055.4 29525,2132 29782,2126 30374,2107.3 30591,2057.7",
		style=dashed];
	layer1_moe_agg_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_MoE_Aggregate_GPU2
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 2",
		pos="29494,1897.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert2_0 -> layer1_moe_agg_gpu2	[pos="e,29393,1899 28021,1977.2 28024,1976.4 28027,1975.7 28030,1975 28286,1913.5 29086,1901.4 29383,1899.1"];
	layer1_expert2_1 -> layer1_moe_agg_gpu2	[pos="e,29393,1899.9 28204,1977.3 28207,1976.4 28210,1975.7 28212,1975 28433,1921.3 29113,1904.6 29383,1900.1"];
	layer1_expert2_2 -> layer1_moe_agg_gpu2	[pos="e,29393,1901.1 28387,1977.3 28390,1976.5 28393,1975.7 28396,1975 28580,1929 29141,1908.3 29382,1901.4"];
	layer1_expert2_3 -> layer1_moe_agg_gpu2	[pos="e,29393,1902.7 28570,1977.3 28573,1976.5 28576,1975.7 28578,1975 28728,1936.7 29173,1912.7 29383,1903.2"];
	layer1_expert2_4 -> layer1_moe_agg_gpu2	[pos="e,29393,1899.1 28753,1977.4 28756,1976.5 28759,1975.7 28762,1975 28976,1917.6 29237,1902.9 29383,1899.3"];
	layer1_expert2_5 -> layer1_moe_agg_gpu2	[pos="e,29393,1904.1 28936,1977.5 28939,1976.6 28942,1975.8 28944,1975 29093,1932.6 29270,1913.3 29383,1904.8"];
	layer1_expert2_6 -> layer1_moe_agg_gpu2	[pos="e,29393,1913.7 29119,1977.9 29122,1976.9 29125,1975.9 29128,1975 29211,1947.9 29309,1928.1 29383,1915.4"];
	layer1_expert2_7 -> layer1_moe_agg_gpu2	[pos="e,29395,1939.1 29302,1978.6 29305,1977.3 29308,1976.2 29310,1975 29335,1964.5 29361,1953.4 29386,1943.1"];
	layer1_expert2_8 -> layer1_moe_agg_gpu2	[pos="e,29463,1939 29434,1974.9 29441,1965.9 29449,1956.3 29456,1947.1"];
	layer1_expert2_9 -> layer1_moe_agg_gpu2	[pos="e,29526,1939 29554,1974.9 29547,1965.9 29539,1956.3 29532,1947.1"];
	layer1_expert2_10 -> layer1_moe_agg_gpu2	[pos="e,29592,1939.1 29686,1979 29683,1977.6 29680,1976.3 29676,1975 29652,1964.6 29626,1953.5 29601,1943"];
	layer1_expert2_11 -> layer1_moe_agg_gpu2	[pos="e,29596,1914 29869,1978.2 29866,1977 29863,1976 29860,1975 29776,1948.3 29679,1928.5 29606,1915.7"];
	layer1_expert2_12 -> layer1_moe_agg_gpu2	[pos="e,29596,1904.3 30052,1977.9 30049,1976.8 30046,1975.9 30042,1975 29895,1933.1 29719,1913.7 29607,1905.1"];
	layer1_expert2_13 -> layer1_moe_agg_gpu2	[pos="e,29596,1899.3 30235,1977.7 30232,1976.7 30229,1975.8 30226,1975 30011,1918.2 29752,1903.2 29606,1899.5"];
	layer1_expert2_14 -> layer1_moe_agg_gpu2	[pos="e,29596,1902.8 30418,1977.7 30415,1976.7 30412,1975.8 30408,1975 30260,1937.1 29816,1912.9 29606,1903.2"];
	layer1_expert2_15 -> layer1_moe_agg_gpu2	[pos="e,29596,1901.1 30601,1977.6 30598,1976.6 30595,1975.8 30592,1975 30407,1929.5 29847,1908.5 29606,1901.4"];
	layer1_output_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU2
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 2",
		pos="33290,1580",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu2 -> layer1_output_gpu2	[pos="e,33237,1614.1 29596,1891.5 29825,1880.3 30397,1851.2 30874,1820 31001,1811.7 33036,1682.4 33158,1648 33182,1641.3 33207,1630.2 \
33228,1618.9"];
	layer1_moe_agg_gpu2 -> layer1_allreduce_moe	[pos="e,33623,1760.6 29596,1893.9 29945,1884.9 31129,1853.7 32108,1820 32655,1801.2 33301,1774.3 33613,1761"];
	layer1_output_gpu2 -> pipeline_stage0_1	[pos="e,33542,1461.4 33351,1545.9 33373,1534.6 33398,1522.3 33420,1512 33456,1495.8 33496,1479.7 33532,1465.1"];
	layer1_qkv_gpu3	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 12-15
TP Slice: 3
GPU: 3",
		pos="33574,2859",
		shape=rectangle,
		width=2.9167];
	layer1_attn_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Multi-Head_Attention_GPU3
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 3",
		pos="33574,2725",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu3 -> layer1_attn_gpu3	[pos="e,33574,2766.8 33574,2810 33574,2799.2 33574,2787.8 33574,2777"];
	layer1_attn_proj_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU3
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 3",
		pos="33574,2598.5",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu3 -> layer1_attn_proj_gpu3	[pos="e,33574,2632.9 33574,2683.2 33574,2670.4 33574,2656.1 33574,2643"];
	layer1_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU3
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 3",
		pos="33572,2281",
		shape=rectangle,
		width=3.3889];
	layer1_attn_proj_gpu3 -> layer1_attn_norm_gpu3	[pos="e,33536,2315.1 33524,2564.3 33511,2552.4 33498,2537.7 33490,2521 33466,2465.6 33471,2442.1 33490,2385 33498,2362.1 33514,2340.4 \
33529,2322.8"];
	layer1_attn_proj_gpu3 -> layer1_allreduce_attn	[pos="e,33656,2505.7 33603,2564.2 33617,2549.1 33633,2530.8 33649,2513.5"];
	layer1_gate_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU3
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 3",
		pos="32330,2135.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu3 -> layer1_gate_gpu3	[pos="e,32453,2138.7 33519,2247 33496,2234.1 33468,2220.6 33440,2213 33260,2162.9 32717,2144.8 32463,2139"];
	layer1_expert3_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="30866,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_0	[pos="e,30949,2055.8 32208,2133.3 31922,2129.7 31212,2115.3 30959,2058.1",
		style=dashed];
	layer1_expert3_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="31050,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_1	[pos="e,31132,2055.7 32208,2132.1 31950,2126.2 31359,2107.8 31142,2058.1",
		style=dashed];
	layer1_expert3_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="31232,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_2	[pos="e,31315,2055.7 32208,2130.4 31982,2122.1 31506,2100.3 31325,2058.1",
		style=dashed];
	layer1_expert3_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="31416,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_3	[pos="e,31498,2055.6 32208,2128 32017,2117.1 31653,2093 31508,2058.1",
		style=dashed];
	layer1_expert3_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="31598,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_4	[pos="e,31681,2055.5 32208,2130.8 32080,2124.4 31873,2107.2 31691,2058.2",
		style=dashed];
	layer1_expert3_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="31782,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_5	[pos="e,31864,2055.4 32208,2122.6 32117,2111.8 31991,2092.5 31874,2058.3",
		style=dashed];
	layer1_expert3_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="31964,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_6	[pos="e,32047,2054.9 32208,2104.7 32163,2092.6 32111,2077.5 32057,2058.3",
		style=dashed];
	layer1_expert3_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="32148,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_7	[pos="e,32211,2058 32267,2093.9 32252,2084.1 32235,2073.6 32219,2063.5",
		style=dashed];
	layer1_expert3_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="32330,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_8	[pos="e,32330,2058 32330,2093.9 32330,2085.6 32330,2076.9 32330,2068.3",
		style=dashed];
	layer1_expert3_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="32514,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_9	[pos="e,32450,2058 32394,2093.9 32409,2084.1 32426,2073.6 32442,2063.5",
		style=dashed];
	layer1_expert3_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="32696,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_10	[pos="e,32614,2054.5 32453,2104.4 32501,2091.5 32556,2075.5 32604,2058 32605,2058 32605,2057.9 32605,2057.9",
		style=dashed];
	layer1_expert3_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="32880,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_11	[pos="e,32797,2055 32453,2122.4 32543,2111.5 32669,2092.2 32787,2057.9",
		style=dashed];
	layer1_expert3_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="33062,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_12	[pos="e,32980,2055.2 32453,2130.6 32581,2124.1 32787,2106.8 32970,2057.9",
		style=dashed];
	layer1_expert3_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="33246,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_13	[pos="e,33163,2055.3 32453,2128 32644,2116.9 33007,2092.6 33153,2057.8",
		style=dashed];
	layer1_expert3_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="33428,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_14	[pos="e,33346,2055.4 32453,2130.4 32678,2121.9 33154,2099.9 33336,2057.8",
		style=dashed];
	layer1_expert3_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU3
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 3",
		pos="33612,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu3 -> layer1_expert3_15	[pos="e,33529,2055.4 32453,2132 32710,2126 33302,2107.3 33519,2057.7",
		style=dashed];
	layer1_moe_agg_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_MoE_Aggregate_GPU3
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 3",
		pos="32422,1897.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert3_0 -> layer1_moe_agg_gpu3	[pos="e,32321,1899 30949,1977.2 30952,1976.4 30955,1975.7 30958,1975 31214,1913.5 32014,1901.4 32311,1899.1"];
	layer1_expert3_1 -> layer1_moe_agg_gpu3	[pos="e,32321,1899.9 31132,1977.3 31135,1976.4 31138,1975.7 31140,1975 31361,1921.3 32041,1904.6 32311,1900.1"];
	layer1_expert3_2 -> layer1_moe_agg_gpu3	[pos="e,32321,1901.1 31315,1977.3 31318,1976.5 31321,1975.7 31324,1975 31508,1929 32069,1908.3 32310,1901.4"];
	layer1_expert3_3 -> layer1_moe_agg_gpu3	[pos="e,32321,1902.7 31498,1977.3 31501,1976.5 31504,1975.7 31506,1975 31656,1936.7 32101,1912.7 32311,1903.2"];
	layer1_expert3_4 -> layer1_moe_agg_gpu3	[pos="e,32321,1899.1 31681,1977.4 31684,1976.5 31687,1975.7 31690,1975 31904,1917.6 32165,1902.9 32311,1899.3"];
	layer1_expert3_5 -> layer1_moe_agg_gpu3	[pos="e,32321,1904.1 31864,1977.5 31867,1976.6 31870,1975.8 31872,1975 32021,1932.6 32198,1913.3 32311,1904.8"];
	layer1_expert3_6 -> layer1_moe_agg_gpu3	[pos="e,32321,1913.7 32047,1977.9 32050,1976.9 32053,1975.9 32056,1975 32139,1947.9 32237,1928.1 32311,1915.4"];
	layer1_expert3_7 -> layer1_moe_agg_gpu3	[pos="e,32323,1939.1 32230,1978.6 32233,1977.3 32236,1976.2 32238,1975 32263,1964.5 32289,1953.4 32314,1943.1"];
	layer1_expert3_8 -> layer1_moe_agg_gpu3	[pos="e,32391,1939 32362,1974.9 32369,1965.9 32377,1956.3 32384,1947.1"];
	layer1_expert3_9 -> layer1_moe_agg_gpu3	[pos="e,32454,1939 32482,1974.9 32475,1965.9 32467,1956.3 32460,1947.1"];
	layer1_expert3_10 -> layer1_moe_agg_gpu3	[pos="e,32520,1939.1 32614,1979 32611,1977.6 32608,1976.3 32604,1975 32580,1964.6 32554,1953.5 32529,1943"];
	layer1_expert3_11 -> layer1_moe_agg_gpu3	[pos="e,32524,1914 32797,1978.2 32794,1977 32791,1976 32788,1975 32704,1948.3 32607,1928.5 32534,1915.7"];
	layer1_expert3_12 -> layer1_moe_agg_gpu3	[pos="e,32524,1904.3 32980,1977.9 32977,1976.8 32974,1975.9 32970,1975 32823,1933.1 32647,1913.7 32535,1905.1"];
	layer1_expert3_13 -> layer1_moe_agg_gpu3	[pos="e,32524,1899.3 33163,1977.7 33160,1976.7 33157,1975.8 33154,1975 32939,1918.2 32680,1903.2 32534,1899.5"];
	layer1_expert3_14 -> layer1_moe_agg_gpu3	[pos="e,32524,1902.8 33346,1977.7 33343,1976.7 33340,1975.8 33336,1975 33188,1937.1 32744,1912.9 32534,1903.2"];
	layer1_expert3_15 -> layer1_moe_agg_gpu3	[pos="e,32524,1901.1 33529,1977.6 33526,1976.6 33523,1975.8 33520,1975 33335,1929.5 32775,1908.5 32534,1901.4"];
	layer1_output_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU3
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 3",
		pos="33552,1580",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu3 -> layer1_output_gpu3	[pos="e,33494,1614.1 32524,1879.1 32707,1846.1 33103,1766.9 33420,1648 33442,1640 33464,1629.3 33485,1618.9"];
	layer1_moe_agg_gpu3 -> layer1_allreduce_moe	[pos="e,33648,1768.9 32524,1885.9 32761,1861.3 33350,1799.9 33638,1770"];
	layer1_output_gpu3 -> pipeline_stage0_1	[pos="e,33631,1476.2 33577,1545.8 33591,1528.3 33608,1505.9 33624,1484.4"];
	layer1_qkv_gpu4	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 16-19
TP Slice: 4
GPU: 4",
		pos="33834,2859",
		shape=rectangle,
		width=2.9167];
	layer1_attn_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Multi-Head_Attention_GPU4
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 4",
		pos="33834,2725",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu4 -> layer1_attn_gpu4	[pos="e,33834,2766.8 33834,2810 33834,2799.2 33834,2787.8 33834,2777"];
	layer1_attn_proj_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU4
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 4",
		pos="33834,2598.5",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu4 -> layer1_attn_proj_gpu4	[pos="e,33834,2632.9 33834,2683.2 33834,2670.4 33834,2656.1 33834,2643"];
	layer1_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU4
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 4",
		pos="33834,2281",
		shape=rectangle,
		width=3.3889];
	layer1_attn_proj_gpu4 -> layer1_attn_norm_gpu4	[pos="e,33869,2315.1 33882,2564.3 33895,2552.3 33907,2537.6 33914,2521 33938,2465.4 33934,2442.1 33914,2385 33907,2362.1 33891,2340.4 \
33876,2322.8"];
	layer1_attn_proj_gpu4 -> layer1_allreduce_attn	[pos="e,33750,2505.4 33804,2564.2 33790,2548.9 33773,2530.3 33757,2512.8"];
	layer1_gate_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU4
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 4",
		pos="35076,2135.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu4 -> layer1_gate_gpu4	[pos="e,34953,2138.7 33886,2247 33909,2234.1 33937,2220.5 33964,2213 34145,2162.9 34690,2144.8 34943,2139"];
	layer1_expert4_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="33794,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_0	[pos="e,33877,2055.7 34953,2132.1 34695,2126.2 34104,2107.8 33887,2058.1",
		style=dashed];
	layer1_expert4_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="33978,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_1	[pos="e,34060,2055.7 34953,2130.4 34727,2122.1 34251,2100.3 34070,2058.1",
		style=dashed];
	layer1_expert4_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="34160,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_2	[pos="e,34243,2055.6 34953,2128 34762,2117.1 34398,2093 34253,2058.1",
		style=dashed];
	layer1_expert4_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="34344,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_3	[pos="e,34426,2055.5 34953,2130.8 34825,2124.4 34618,2107.2 34436,2058.2",
		style=dashed];
	layer1_expert4_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="34526,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_4	[pos="e,34609,2055.4 34953,2122.6 34862,2111.8 34736,2092.5 34619,2058.3",
		style=dashed];
	layer1_expert4_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="34710,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_5	[pos="e,34792,2054.9 34953,2104.7 34908,2092.6 34856,2077.5 34802,2058.3",
		style=dashed];
	layer1_expert4_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="34892,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_6	[pos="e,34956,2058 35012,2093.9 34997,2084.1 34980,2073.6 34964,2063.5",
		style=dashed];
	layer1_expert4_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="35076,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_7	[pos="e,35076,2058 35076,2093.9 35076,2085.6 35076,2076.9 35076,2068.3",
		style=dashed];
	layer1_expert4_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="35258,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_8	[pos="e,35195,2058 35139,2093.9 35154,2084.1 35171,2073.6 35187,2063.5",
		style=dashed];
	layer1_expert4_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="35442,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_9	[pos="e,35359,2054.5 35198,2104.4 35246,2091.5 35301,2075.5 35350,2058 35350,2058 35350,2057.9 35350,2057.9",
		style=dashed];
	layer1_expert4_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="35624,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_10	[pos="e,35542,2055 35198,2122.4 35288,2111.5 35414,2092.2 35532,2057.9",
		style=dashed];
	layer1_expert4_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="35808,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_11	[pos="e,35725,2055.2 35198,2130.6 35326,2124.1 35532,2106.8 35715,2057.9",
		style=dashed];
	layer1_expert4_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="35990,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_12	[pos="e,35908,2055.3 35198,2128 35389,2116.9 35752,2092.6 35898,2057.8",
		style=dashed];
	layer1_expert4_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="36174,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_13	[pos="e,36091,2055.4 35198,2130.4 35423,2121.9 35899,2099.9 36081,2057.8",
		style=dashed];
	layer1_expert4_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="36356,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_14	[pos="e,36274,2055.4 35198,2132 35455,2126 36047,2107.3 36264,2057.7",
		style=dashed];
	layer1_expert4_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU4
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 4",
		pos="36540,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu4 -> layer1_expert4_15	[pos="e,36457,2055.5 35198,2133.3 35484,2129.5 36193,2114.8 36447,2057.8",
		style=dashed];
	layer1_moe_agg_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_MoE_Aggregate_GPU4
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 4",
		pos="34984,1897.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert4_0 -> layer1_moe_agg_gpu4	[pos="e,34882,1901.1 33877,1977.3 33880,1976.5 33883,1975.7 33886,1975 34070,1929.1 34631,1908.3 34871,1901.4"];
	layer1_expert4_1 -> layer1_moe_agg_gpu4	[pos="e,34882,1902.7 34060,1977.3 34063,1976.5 34066,1975.7 34068,1975 34218,1936.8 34662,1912.7 34872,1903.2"];
	layer1_expert4_2 -> layer1_moe_agg_gpu4	[pos="e,34882,1899.1 34243,1977.4 34246,1976.5 34249,1975.7 34252,1975 34466,1917.6 34726,1902.9 34872,1899.3"];
	layer1_expert4_3 -> layer1_moe_agg_gpu4	[pos="e,34882,1904.1 34426,1977.5 34429,1976.6 34432,1975.8 34434,1975 34582,1932.7 34760,1913.4 34872,1904.9"];
	layer1_expert4_4 -> layer1_moe_agg_gpu4	[pos="e,34882,1913.8 34609,1977.9 34612,1976.9 34615,1975.9 34618,1975 34701,1948 34798,1928.2 34872,1915.5"];
	layer1_expert4_5 -> layer1_moe_agg_gpu4	[pos="e,34885,1939.2 34792,1978.6 34795,1977.4 34798,1976.2 34800,1975 34825,1964.5 34851,1953.5 34876,1943.1"];
	layer1_expert4_6 -> layer1_moe_agg_gpu4	[pos="e,34952,1939 34924,1974.9 34931,1965.9 34939,1956.3 34946,1947.1"];
	layer1_expert4_7 -> layer1_moe_agg_gpu4	[pos="e,35015,1939 35044,1974.9 35037,1965.9 35029,1956.3 35022,1947.1"];
	layer1_expert4_8 -> layer1_moe_agg_gpu4	[pos="e,35081,1939.1 35176,1979 35173,1977.6 35170,1976.3 35166,1975 35142,1964.5 35116,1953.4 35091,1943"];
	layer1_expert4_9 -> layer1_moe_agg_gpu4	[pos="e,35085,1913.9 35359,1978.1 35356,1977 35353,1976 35350,1975 35266,1948.2 35169,1928.4 35095,1915.6"];
	layer1_expert4_10 -> layer1_moe_agg_gpu4	[pos="e,35085,1904.2 35542,1977.9 35539,1976.8 35536,1975.9 35532,1975 35385,1933 35207,1913.6 35095,1905"];
	layer1_expert4_11 -> layer1_moe_agg_gpu4	[pos="e,35085,1899.2 35725,1977.7 35722,1976.7 35719,1975.8 35716,1975 35501,1918.1 35241,1903.2 35095,1899.5"];
	layer1_expert4_12 -> layer1_moe_agg_gpu4	[pos="e,35085,1902.8 35908,1977.7 35905,1976.7 35902,1975.8 35898,1975 35749,1937.1 35305,1912.9 35095,1903.2"];
	layer1_expert4_13 -> layer1_moe_agg_gpu4	[pos="e,35085,1901.1 36091,1977.6 36088,1976.6 36085,1975.8 36082,1975 35897,1929.4 35336,1908.5 35095,1901.4"];
	layer1_expert4_14 -> layer1_moe_agg_gpu4	[pos="e,35085,1899.9 36274,1977.6 36271,1976.6 36268,1975.8 36264,1975 36044,1921.7 35365,1904.8 35095,1900.1"];
	layer1_expert4_15 -> layer1_moe_agg_gpu4	[pos="e,35085,1899.1 36457,1977.5 36454,1976.6 36451,1975.7 36448,1975 36191,1914 35392,1901.6 35096,1899.1"];
	layer1_output_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU4
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 4",
		pos="33814,1580",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu4 -> layer1_output_gpu4	[pos="e,33878,1614.1 34882,1893.7 34658,1886.8 34138,1865.9 34074,1820 34019,1781.7 34058,1732.1 34012,1684 34011,1682.7 33943,1647.6 \
33887,1618.7"];
	layer1_moe_agg_gpu4 -> layer1_allreduce_moe	[pos="e,33898,1787.3 34882,1895.5 34705,1892.1 34332,1878 34024,1820 33985,1812.8 33944,1801.6 33908,1790.3"];
	layer1_output_gpu4 -> pipeline_stage0_1	[pos="e,33734,1476.2 33788,1545.8 33774,1528.3 33757,1505.9 33741,1484.4"];
	layer1_qkv_gpu5	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 20-23
TP Slice: 5
GPU: 5",
		pos="34096,2859",
		shape=rectangle,
		width=2.9167];
	layer1_attn_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Multi-Head_Attention_GPU5
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 5",
		pos="34096,2725",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu5 -> layer1_attn_gpu5	[pos="e,34096,2766.8 34096,2810 34096,2799.2 34096,2787.8 34096,2777"];
	layer1_attn_proj_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU5
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 5",
		pos="34096,2598.5",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu5 -> layer1_attn_proj_gpu5	[pos="e,34096,2632.9 34096,2683.2 34096,2670.4 34096,2656.1 34096,2643"];
	layer1_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU5
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 5",
		pos="34096,2281",
		shape=rectangle,
		width=3.3889];
	layer1_attn_proj_gpu5 -> layer1_attn_norm_gpu5	[pos="e,34096,2315.2 34096,2564.3 34096,2506.9 34096,2389.1 34096,2325.3"];
	layer1_attn_proj_gpu5 -> layer1_allreduce_attn	[pos="e,33799,2489.1 34005,2564.4 33946,2543 33870,2515 33808,2492.6"];
	layer1_gate_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU5
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 5",
		pos="38004,2135.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu5 -> layer1_gate_gpu5	[pos="e,37881,2138.2 34147,2246.9 34170,2233.7 34199,2220 34226,2213 34317,2190.3 37212,2147.8 37871,2138.4"];
	layer1_expert5_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="36722,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_0	[pos="e,36805,2055.7 37881,2132.1 37623,2126.2 37032,2107.8 36815,2058.1",
		style=dashed];
	layer1_expert5_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="36906,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_1	[pos="e,36988,2055.7 37881,2130.4 37655,2122.1 37179,2100.3 36998,2058.1",
		style=dashed];
	layer1_expert5_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="37088,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_2	[pos="e,37171,2055.6 37881,2128 37690,2117.1 37326,2093 37181,2058.1",
		style=dashed];
	layer1_expert5_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="37272,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_3	[pos="e,37354,2055.5 37881,2130.8 37753,2124.4 37546,2107.2 37364,2058.2",
		style=dashed];
	layer1_expert5_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="37454,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_4	[pos="e,37537,2055.4 37881,2122.6 37790,2111.8 37664,2092.5 37547,2058.3",
		style=dashed];
	layer1_expert5_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="37638,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_5	[pos="e,37720,2054.9 37881,2104.7 37836,2092.6 37784,2077.5 37730,2058.3",
		style=dashed];
	layer1_expert5_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="37820,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_6	[pos="e,37884,2058 37940,2093.9 37925,2084.1 37908,2073.6 37892,2063.5",
		style=dashed];
	layer1_expert5_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="38004,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_7	[pos="e,38004,2058 38004,2093.9 38004,2085.6 38004,2076.9 38004,2068.3",
		style=dashed];
	layer1_expert5_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="38186,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_8	[pos="e,38123,2058 38067,2093.9 38082,2084.1 38099,2073.6 38115,2063.5",
		style=dashed];
	layer1_expert5_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="38370,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_9	[pos="e,38287,2054.5 38126,2104.4 38174,2091.5 38229,2075.5 38278,2058 38278,2058 38278,2057.9 38278,2057.9",
		style=dashed];
	layer1_expert5_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="38552,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_10	[pos="e,38470,2055 38126,2122.4 38216,2111.5 38342,2092.2 38460,2057.9",
		style=dashed];
	layer1_expert5_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="38736,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_11	[pos="e,38653,2055.2 38126,2130.6 38254,2124.1 38460,2106.8 38643,2057.9",
		style=dashed];
	layer1_expert5_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="38918,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_12	[pos="e,38836,2055.3 38126,2128 38317,2116.9 38680,2092.6 38826,2057.8",
		style=dashed];
	layer1_expert5_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="39102,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_13	[pos="e,39019,2055.4 38126,2130.4 38351,2121.9 38827,2099.9 39009,2057.8",
		style=dashed];
	layer1_expert5_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="39284,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_14	[pos="e,39202,2055.4 38126,2132 38383,2126 38975,2107.3 39192,2057.7",
		style=dashed];
	layer1_expert5_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU5
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 5",
		pos="39468,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu5 -> layer1_expert5_15	[pos="e,39385,2055.5 38126,2133.3 38412,2129.5 39121,2114.8 39375,2057.8",
		style=dashed];
	layer1_moe_agg_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_MoE_Aggregate_GPU5
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 5",
		pos="37912,1897.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert5_0 -> layer1_moe_agg_gpu5	[pos="e,37811,1901.1 36805,1977.3 36808,1976.5 36811,1975.7 36814,1975 36998,1929 37559,1908.3 37800,1901.4"];
	layer1_expert5_1 -> layer1_moe_agg_gpu5	[pos="e,37811,1902.7 36988,1977.3 36991,1976.5 36994,1975.7 36996,1975 37146,1936.7 37591,1912.7 37801,1903.2"];
	layer1_expert5_2 -> layer1_moe_agg_gpu5	[pos="e,37811,1899.1 37171,1977.4 37174,1976.5 37177,1975.7 37180,1975 37394,1917.6 37655,1902.9 37801,1899.3"];
	layer1_expert5_3 -> layer1_moe_agg_gpu5	[pos="e,37811,1904.1 37354,1977.5 37357,1976.6 37360,1975.8 37362,1975 37511,1932.6 37688,1913.3 37801,1904.8"];
	layer1_expert5_4 -> layer1_moe_agg_gpu5	[pos="e,37811,1913.7 37537,1977.9 37540,1976.9 37543,1975.9 37546,1975 37629,1947.9 37727,1928.1 37801,1915.4"];
	layer1_expert5_5 -> layer1_moe_agg_gpu5	[pos="e,37813,1939.1 37720,1978.6 37723,1977.3 37726,1976.2 37728,1975 37753,1964.5 37779,1953.4 37804,1943.1"];
	layer1_expert5_6 -> layer1_moe_agg_gpu5	[pos="e,37881,1939 37852,1974.9 37859,1965.9 37867,1956.3 37874,1947.1"];
	layer1_expert5_7 -> layer1_moe_agg_gpu5	[pos="e,37944,1939 37972,1974.9 37965,1965.9 37957,1956.3 37950,1947.1"];
	layer1_expert5_8 -> layer1_moe_agg_gpu5	[pos="e,38010,1939.1 38104,1979 38101,1977.6 38098,1976.3 38094,1975 38070,1964.6 38044,1953.5 38019,1943"];
	layer1_expert5_9 -> layer1_moe_agg_gpu5	[pos="e,38014,1914 38287,1978.2 38284,1977 38281,1976 38278,1975 38194,1948.3 38097,1928.5 38024,1915.7"];
	layer1_expert5_10 -> layer1_moe_agg_gpu5	[pos="e,38014,1904.3 38470,1977.9 38467,1976.8 38464,1975.9 38460,1975 38313,1933.1 38137,1913.7 38025,1905.1"];
	layer1_expert5_11 -> layer1_moe_agg_gpu5	[pos="e,38014,1899.3 38653,1977.7 38650,1976.7 38647,1975.8 38644,1975 38429,1918.2 38170,1903.2 38024,1899.5"];
	layer1_expert5_12 -> layer1_moe_agg_gpu5	[pos="e,38014,1902.8 38836,1977.7 38833,1976.7 38830,1975.8 38826,1975 38678,1937.1 38234,1912.9 38024,1903.2"];
	layer1_expert5_13 -> layer1_moe_agg_gpu5	[pos="e,38014,1901.1 39019,1977.6 39016,1976.6 39013,1975.8 39010,1975 38825,1929.5 38265,1908.5 38024,1901.4"];
	layer1_expert5_14 -> layer1_moe_agg_gpu5	[pos="e,38014,1899.9 39202,1977.6 39199,1976.6 39196,1975.8 39192,1975 38972,1921.8 38294,1904.8 38025,1900.1"];
	layer1_expert5_15 -> layer1_moe_agg_gpu5	[pos="e,38014,1899.1 39385,1977.5 39382,1976.6 39379,1975.7 39376,1975 39119,1914.1 38321,1901.7 38024,1899.1"];
	layer1_output_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU5
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 5",
		pos="34076,1580",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu5 -> layer1_output_gpu5	[pos="e,34128,1614 37811,1895.2 37289,1887.8 34913,1843.5 34206,1648 34183,1641.4 34158,1630.2 34137,1618.9"];
	layer1_moe_agg_gpu5 -> layer1_allreduce_moe	[pos="e,33906,1784.7 37811,1895.1 37221,1886.9 34264,1844.9 34074,1820 34021,1813.1 33964,1800.1 33916,1787.3"];
	layer1_output_gpu5 -> pipeline_stage0_1	[pos="e,33860,1476.1 34014,1545.9 33992,1534.6 33967,1522.3 33944,1512 33920,1501.1 33895,1490.3 33869,1479.9"];
	layer1_qkv_gpu6	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 24-27
TP Slice: 6
GPU: 6",
		pos="34358,2859",
		shape=rectangle,
		width=2.9167];
	layer1_attn_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Multi-Head_Attention_GPU6
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 6",
		pos="34358,2725",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu6 -> layer1_attn_gpu6	[pos="e,34358,2766.8 34358,2810 34358,2799.2 34358,2787.8 34358,2777"];
	layer1_attn_proj_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU6
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 6",
		pos="34358,2598.5",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu6 -> layer1_attn_proj_gpu6	[pos="e,34358,2632.9 34358,2683.2 34358,2670.4 34358,2656.1 34358,2643"];
	layer1_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU6
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 6",
		pos="34358,2281",
		shape=rectangle,
		width=3.3889];
	layer1_attn_proj_gpu6 -> layer1_attn_norm_gpu6	[pos="e,34358,2315.2 34358,2564.3 34358,2506.9 34358,2389.1 34358,2325.3"];
	layer1_attn_proj_gpu6 -> layer1_allreduce_attn	[pos="e,33831,2478.2 34257,2570.1 34240,2565.6 34222,2561 34204,2557 34082,2528.2 33942,2499.8 33841,2480.2"];
	layer1_gate_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU6
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 6",
		pos="40932,2135.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu6 -> layer1_gate_gpu6	[pos="e,40809,2138.5 34409,2246.9 34432,2233.6 34461,2219.9 34488,2213 34587,2188.8 38033,2178.2 38134,2177 39160,2164.5 40398,2145.1 \
40799,2138.6"];
	layer1_expert6_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="39650,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_0	[pos="e,39733,2055.7 40809,2132.1 40551,2126.2 39960,2107.8 39743,2058.1",
		style=dashed];
	layer1_expert6_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="39834,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_1	[pos="e,39916,2055.7 40809,2130.4 40583,2122.1 40107,2100.3 39926,2058.1",
		style=dashed];
	layer1_expert6_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="40016,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_2	[pos="e,40099,2055.6 40809,2128 40618,2117.1 40254,2093 40109,2058.1",
		style=dashed];
	layer1_expert6_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="40200,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_3	[pos="e,40282,2055.5 40809,2130.8 40681,2124.4 40474,2107.2 40292,2058.2",
		style=dashed];
	layer1_expert6_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="40382,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_4	[pos="e,40465,2055.4 40809,2122.6 40718,2111.8 40592,2092.5 40475,2058.3",
		style=dashed];
	layer1_expert6_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="40566,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_5	[pos="e,40648,2054.9 40809,2104.7 40764,2092.6 40712,2077.5 40658,2058.3",
		style=dashed];
	layer1_expert6_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="40748,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_6	[pos="e,40812,2058 40868,2093.9 40853,2084.1 40836,2073.6 40820,2063.5",
		style=dashed];
	layer1_expert6_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="40932,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_7	[pos="e,40932,2058 40932,2093.9 40932,2085.6 40932,2076.9 40932,2068.3",
		style=dashed];
	layer1_expert6_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="41114,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_8	[pos="e,41051,2058 40995,2093.9 41010,2084.1 41027,2073.6 41043,2063.5",
		style=dashed];
	layer1_expert6_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="41298,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_9	[pos="e,41215,2054.5 41054,2104.4 41102,2091.5 41157,2075.5 41206,2058 41206,2058 41206,2057.9 41206,2057.9",
		style=dashed];
	layer1_expert6_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="41480,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_10	[pos="e,41398,2055 41054,2122.4 41144,2111.5 41270,2092.2 41388,2057.9",
		style=dashed];
	layer1_expert6_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="41664,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_11	[pos="e,41581,2055.2 41054,2130.6 41182,2124.1 41388,2106.8 41571,2057.9",
		style=dashed];
	layer1_expert6_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="41846,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_12	[pos="e,41764,2055.3 41054,2128 41245,2116.9 41608,2092.6 41754,2057.8",
		style=dashed];
	layer1_expert6_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="42030,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_13	[pos="e,41947,2055.4 41054,2130.4 41279,2121.9 41755,2099.9 41937,2057.8",
		style=dashed];
	layer1_expert6_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="42212,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_14	[pos="e,42130,2055.4 41054,2132 41311,2126 41903,2107.3 42120,2057.7",
		style=dashed];
	layer1_expert6_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU6
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 6",
		pos="42396,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu6 -> layer1_expert6_15	[pos="e,42313,2055.5 41054,2133.3 41340,2129.5 42049,2114.8 42303,2057.8",
		style=dashed];
	layer1_moe_agg_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_MoE_Aggregate_GPU6
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 6",
		pos="40840,1897.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert6_0 -> layer1_moe_agg_gpu6	[pos="e,40739,1901.1 39733,1977.3 39736,1976.5 39739,1975.7 39742,1975 39926,1929 40487,1908.3 40728,1901.4"];
	layer1_expert6_1 -> layer1_moe_agg_gpu6	[pos="e,40739,1902.7 39916,1977.3 39919,1976.5 39922,1975.7 39924,1975 40074,1936.7 40519,1912.7 40729,1903.2"];
	layer1_expert6_2 -> layer1_moe_agg_gpu6	[pos="e,40739,1899.1 40099,1977.4 40102,1976.5 40105,1975.7 40108,1975 40322,1917.6 40583,1902.9 40729,1899.3"];
	layer1_expert6_3 -> layer1_moe_agg_gpu6	[pos="e,40739,1904.1 40282,1977.5 40285,1976.6 40288,1975.8 40290,1975 40439,1932.6 40616,1913.3 40729,1904.8"];
	layer1_expert6_4 -> layer1_moe_agg_gpu6	[pos="e,40739,1913.7 40465,1977.9 40468,1976.9 40471,1975.9 40474,1975 40557,1947.9 40655,1928.1 40729,1915.4"];
	layer1_expert6_5 -> layer1_moe_agg_gpu6	[pos="e,40741,1939.1 40648,1978.6 40651,1977.3 40654,1976.2 40656,1975 40681,1964.5 40707,1953.4 40732,1943.1"];
	layer1_expert6_6 -> layer1_moe_agg_gpu6	[pos="e,40809,1939 40780,1974.9 40787,1965.9 40795,1956.3 40802,1947.1"];
	layer1_expert6_7 -> layer1_moe_agg_gpu6	[pos="e,40872,1939 40900,1974.9 40893,1965.9 40885,1956.3 40878,1947.1"];
	layer1_expert6_8 -> layer1_moe_agg_gpu6	[pos="e,40938,1939.1 41032,1979 41029,1977.6 41026,1976.3 41022,1975 40998,1964.6 40972,1953.5 40947,1943"];
	layer1_expert6_9 -> layer1_moe_agg_gpu6	[pos="e,40942,1914 41215,1978.2 41212,1977 41209,1976 41206,1975 41122,1948.3 41025,1928.5 40952,1915.7"];
	layer1_expert6_10 -> layer1_moe_agg_gpu6	[pos="e,40942,1904.3 41398,1977.9 41395,1976.8 41392,1975.9 41388,1975 41241,1933.1 41065,1913.7 40953,1905.1"];
	layer1_expert6_11 -> layer1_moe_agg_gpu6	[pos="e,40942,1899.3 41581,1977.7 41578,1976.7 41575,1975.8 41572,1975 41357,1918.2 41098,1903.2 40952,1899.5"];
	layer1_expert6_12 -> layer1_moe_agg_gpu6	[pos="e,40942,1902.8 41764,1977.7 41761,1976.7 41758,1975.8 41754,1975 41606,1937.1 41162,1912.9 40952,1903.2"];
	layer1_expert6_13 -> layer1_moe_agg_gpu6	[pos="e,40942,1901.1 41947,1977.6 41944,1976.6 41941,1975.8 41938,1975 41753,1929.5 41193,1908.5 40952,1901.4"];
	layer1_expert6_14 -> layer1_moe_agg_gpu6	[pos="e,40942,1899.9 42130,1977.6 42127,1976.6 42124,1975.8 42120,1975 41900,1921.8 41222,1904.8 40953,1900.1"];
	layer1_expert6_15 -> layer1_moe_agg_gpu6	[pos="e,40942,1899.1 42313,1977.5 42310,1976.6 42307,1975.7 42304,1975 42047,1914.1 41249,1901.7 40952,1899.1"];
	layer1_output_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU6
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 6",
		pos="34338,1580",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu6 -> layer1_output_gpu6	[pos="e,34390,1614.1 40739,1894.9 40353,1888.9 38942,1864.7 37780,1820 37734,1818.2 34513,1659.9 34468,1648 34445,1641.6 34420,1630.4 \
34399,1619"];
	layer1_moe_agg_gpu6 -> layer1_allreduce_moe	[pos="e,33989,1756.8 40739,1894.4 39969,1878.7 35054,1778.5 33999,1757.1"];
	layer1_output_gpu6 -> pipeline_stage0_1	[pos="e,33876,1433.9 34281,1545.9 34259,1533.7 34232,1520.8 34206,1512 34104,1476.4 33985,1451.7 33886,1435.5"];
	layer1_qkv_gpu7	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 28-31
TP Slice: 7
GPU: 7",
		pos="34620,2859",
		shape=rectangle,
		width=2.9167];
	layer1_attn_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Multi-Head_Attention_GPU7
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 7",
		pos="34620,2725",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu7 -> layer1_attn_gpu7	[pos="e,34620,2766.8 34620,2810 34620,2799.2 34620,2787.8 34620,2777"];
	layer1_attn_proj_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU7
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 7",
		pos="34620,2598.5",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu7 -> layer1_attn_proj_gpu7	[pos="e,34620,2632.9 34620,2683.2 34620,2670.4 34620,2656.1 34620,2643"];
	layer1_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU7
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 7",
		pos="34620,2281",
		shape=rectangle,
		width=3.3889];
	layer1_attn_proj_gpu7 -> layer1_attn_norm_gpu7	[pos="e,34620,2315.2 34620,2564.3 34620,2506.9 34620,2389.1 34620,2325.3"];
	layer1_attn_proj_gpu7 -> layer1_allreduce_attn	[pos="e,33857,2469.2 34519,2569 34502,2564.6 34484,2560.4 34466,2557 34262,2516.3 34023,2486.9 33868,2470.2"];
	layer1_gate_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU7
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 7",
		pos="43860,2135.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu7 -> layer1_gate_gpu7	[pos="e,43737,2138.4 34742,2278.1 35750,2262.4 42681,2154.8 43727,2138.6"];
	layer1_expert7_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="42578,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_0	[pos="e,42661,2055.7 43737,2132.1 43479,2126.2 42888,2107.8 42671,2058.1",
		style=dashed];
	layer1_expert7_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="42762,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_1	[pos="e,42844,2055.7 43737,2130.4 43511,2122.1 43035,2100.3 42854,2058.1",
		style=dashed];
	layer1_expert7_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="42944,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_2	[pos="e,43027,2055.6 43737,2128 43546,2117.1 43182,2093 43037,2058.1",
		style=dashed];
	layer1_expert7_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="43128,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_3	[pos="e,43210,2055.5 43737,2130.8 43609,2124.4 43402,2107.2 43220,2058.2",
		style=dashed];
	layer1_expert7_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="43310,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_4	[pos="e,43393,2055.4 43737,2122.6 43646,2111.8 43520,2092.5 43403,2058.3",
		style=dashed];
	layer1_expert7_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="43494,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_5	[pos="e,43576,2054.9 43737,2104.7 43692,2092.6 43640,2077.5 43586,2058.3",
		style=dashed];
	layer1_expert7_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="43676,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_6	[pos="e,43740,2058 43796,2093.9 43781,2084.1 43764,2073.6 43748,2063.5",
		style=dashed];
	layer1_expert7_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="43860,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_7	[pos="e,43860,2058 43860,2093.9 43860,2085.6 43860,2076.9 43860,2068.3",
		style=dashed];
	layer1_expert7_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="44042,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_8	[pos="e,43979,2058 43923,2093.9 43938,2084.1 43955,2073.6 43971,2063.5",
		style=dashed];
	layer1_expert7_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="44226,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_9	[pos="e,44143,2054.5 43982,2104.4 44030,2091.5 44085,2075.5 44134,2058 44134,2058 44134,2057.9 44134,2057.9",
		style=dashed];
	layer1_expert7_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="44408,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_10	[pos="e,44326,2055 43982,2122.4 44072,2111.5 44198,2092.2 44316,2057.9",
		style=dashed];
	layer1_expert7_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="44592,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_11	[pos="e,44509,2055.2 43982,2130.6 44110,2124.1 44316,2106.8 44499,2057.9",
		style=dashed];
	layer1_expert7_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="44774,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_12	[pos="e,44692,2055.3 43982,2128 44173,2116.9 44536,2092.6 44682,2057.8",
		style=dashed];
	layer1_expert7_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="44958,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_13	[pos="e,44875,2055.4 43982,2130.4 44207,2121.9 44683,2099.9 44865,2057.8",
		style=dashed];
	layer1_expert7_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="45140,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_14	[pos="e,45058,2055.4 43982,2132 44239,2126 44831,2107.3 45048,2057.7",
		style=dashed];
	layer1_expert7_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU7
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 7",
		pos="45324,2016.5",
		shape=rectangle,
		width=2.2917];
	layer1_gate_gpu7 -> layer1_expert7_15	[pos="e,45241,2055.5 43982,2133.3 44268,2129.5 44977,2114.8 45231,2057.8",
		style=dashed];
	layer1_moe_agg_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_MoE_Aggregate_GPU7
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 7",
		pos="43768,1897.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert7_0 -> layer1_moe_agg_gpu7	[pos="e,43667,1901.1 42661,1977.3 42664,1976.5 42667,1975.7 42670,1975 42854,1929 43415,1908.3 43656,1901.4"];
	layer1_expert7_1 -> layer1_moe_agg_gpu7	[pos="e,43667,1902.7 42844,1977.3 42847,1976.5 42850,1975.7 42852,1975 43002,1936.7 43447,1912.7 43657,1903.2"];
	layer1_expert7_2 -> layer1_moe_agg_gpu7	[pos="e,43667,1899.1 43027,1977.4 43030,1976.5 43033,1975.7 43036,1975 43250,1917.6 43511,1902.9 43657,1899.3"];
	layer1_expert7_3 -> layer1_moe_agg_gpu7	[pos="e,43667,1904.1 43210,1977.5 43213,1976.6 43216,1975.8 43218,1975 43367,1932.6 43544,1913.3 43657,1904.8"];
	layer1_expert7_4 -> layer1_moe_agg_gpu7	[pos="e,43667,1913.7 43393,1977.9 43396,1976.9 43399,1975.9 43402,1975 43485,1947.9 43583,1928.1 43657,1915.4"];
	layer1_expert7_5 -> layer1_moe_agg_gpu7	[pos="e,43669,1939.1 43576,1978.6 43579,1977.3 43582,1976.2 43584,1975 43609,1964.5 43635,1953.4 43660,1943.1"];
	layer1_expert7_6 -> layer1_moe_agg_gpu7	[pos="e,43737,1939 43708,1974.9 43715,1965.9 43723,1956.3 43730,1947.1"];
	layer1_expert7_7 -> layer1_moe_agg_gpu7	[pos="e,43800,1939 43828,1974.9 43821,1965.9 43813,1956.3 43806,1947.1"];
	layer1_expert7_8 -> layer1_moe_agg_gpu7	[pos="e,43866,1939.1 43960,1979 43957,1977.6 43954,1976.3 43950,1975 43926,1964.6 43900,1953.5 43875,1943"];
	layer1_expert7_9 -> layer1_moe_agg_gpu7	[pos="e,43870,1914 44143,1978.2 44140,1977 44137,1976 44134,1975 44050,1948.3 43953,1928.5 43880,1915.7"];
	layer1_expert7_10 -> layer1_moe_agg_gpu7	[pos="e,43870,1904.3 44326,1977.9 44323,1976.8 44320,1975.9 44316,1975 44169,1933.1 43993,1913.7 43881,1905.1"];
	layer1_expert7_11 -> layer1_moe_agg_gpu7	[pos="e,43870,1899.3 44509,1977.7 44506,1976.7 44503,1975.8 44500,1975 44285,1918.2 44026,1903.2 43880,1899.5"];
	layer1_expert7_12 -> layer1_moe_agg_gpu7	[pos="e,43870,1902.8 44692,1977.7 44689,1976.7 44686,1975.8 44682,1975 44534,1937.1 44090,1912.9 43880,1903.2"];
	layer1_expert7_13 -> layer1_moe_agg_gpu7	[pos="e,43870,1901.1 44875,1977.6 44872,1976.6 44869,1975.8 44866,1975 44681,1929.5 44121,1908.5 43880,1901.4"];
	layer1_expert7_14 -> layer1_moe_agg_gpu7	[pos="e,43870,1899.9 45058,1977.6 45055,1976.6 45052,1975.8 45048,1975 44828,1921.8 44150,1904.8 43881,1900.1"];
	layer1_expert7_15 -> layer1_moe_agg_gpu7	[pos="e,43870,1899.1 45241,1977.5 45238,1976.6 45235,1975.7 45232,1975 44975,1914.1 44177,1901.7 43880,1899.1"];
	layer1_output_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU7
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 7",
		pos="34600,1580",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu7 -> layer1_output_gpu7	[pos="e,34722,1585.2 43667,1893 42740,1861.1 35782,1621.7 34732,1585.6"];
	layer1_moe_agg_gpu7 -> layer1_allreduce_moe	[pos="e,33990,1756.6 43667,1894.9 43300,1889.3 42013,1869.7 40950,1856 39542,1837.9 39189,1839.9 37780,1820 36330,1799.6 34583,1767.6 \
34000,1756.7"];
	layer1_output_gpu7 -> pipeline_stage0_1	[pos="e,33864,1415.2 34545,1545.9 34522,1533.4 34495,1520.2 34468,1512 34271,1450.7 34035,1425.9 33874,1415.8"];
	layer1_allreduce_attn -> layer1_attn_norm_gpu0	[pos="e,32840,2315.1 33521,2445.8 33359,2436.1 33118,2411.5 32916,2349 32894,2341.9 32870,2330.9 32849,2319.9"];
	layer1_allreduce_attn -> layer1_attn_norm_gpu1	[pos="e,33104,2315.1 33555,2434.3 33449,2418.7 33302,2391.8 33178,2349 33156,2341.3 33133,2330.5 33113,2319.8"];
	layer1_allreduce_attn -> layer1_attn_norm_gpu2	[pos="e,33371,2315.1 33607,2416.9 33557,2398 33495,2373.5 33440,2349 33421,2340.1 33400,2329.7 33380,2319.8"];
	layer1_allreduce_attn -> layer1_attn_norm_gpu3	[pos="e,33597,2315.1 33661,2398.7 33643,2374.3 33621,2345.9 33603,2323.2"];
	layer1_allreduce_attn -> layer1_attn_norm_gpu4	[pos="e,33808,2315.1 33744,2398.7 33762,2374.3 33784,2345.9 33802,2323.2"];
	layer1_allreduce_attn -> layer1_attn_norm_gpu5	[pos="e,34034,2315.1 33798,2416.9 33848,2398 33910,2373.5 33964,2349 33984,2340.1 34005,2329.7 34025,2319.8"];
	layer1_allreduce_attn -> layer1_attn_norm_gpu6	[pos="e,34301,2315.1 33850,2434.3 33956,2418.7 34103,2391.8 34226,2349 34249,2341.3 34272,2330.5 34292,2319.8"];
	layer1_allreduce_attn -> layer1_attn_norm_gpu7	[pos="e,34565,2315.1 33884,2445.8 34046,2436.1 34287,2411.5 34488,2349 34511,2341.9 34535,2330.9 34556,2319.9"];
	layer1_allreduce_moe -> layer1_output_gpu0	[pos="e,32819,1614.1 33606,1748.9 33421,1742.2 33134,1719.7 32896,1648 32873,1641 32849,1630 32828,1618.9"];
	layer1_allreduce_moe -> layer1_output_gpu1	[pos="e,33083,1614 33636,1738.9 33504,1725.9 33316,1699.6 33158,1648 33136,1640.6 33112,1629.7 33092,1618.8"];
	layer1_allreduce_moe -> layer1_output_gpu2	[pos="e,33348,1614 33679,1724.8 33603,1706.9 33505,1680.5 33420,1648 33399,1639.8 33377,1629.1 33357,1618.8"];
	layer1_allreduce_moe -> layer1_output_gpu3	[pos="e,33600,1614.2 33734,1705.9 33695,1679.1 33646,1645.5 33608,1619.8"];
	layer1_allreduce_moe -> layer1_output_gpu4	[pos="e,33811,1614.3 33806,1685.3 33807,1664.9 33809,1642.9 33810,1624.4"];
	layer1_allreduce_moe -> layer1_output_gpu5	[pos="e,34022,1614.2 33871,1707.4 33915,1680.3 33971,1645.7 34013,1619.5"];
	layer1_allreduce_moe -> layer1_output_gpu6	[pos="e,34280,1614.1 33928,1726.4 34009,1708.9 34115,1682.3 34206,1648 34228,1639.9 34250,1629.3 34271,1618.8"];
	layer1_allreduce_moe -> layer1_output_gpu7	[pos="e,34544,1614.1 33968,1740.1 34105,1727.6 34303,1701.5 34468,1648 34491,1640.7 34515,1629.8 34535,1618.9"];
	stage1_header	[fillcolor=lightblue,
		height=0.8575,
		label="Stage 1 (GPUs 8-15)
Layers 2-3",
		peripheries=2,
		pos="45404,2859",
		shape=ellipse,
		width=3.2931];
	layer2_qkv_gpu8	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU8
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 0-3
TP Slice: 0
GPU: 8",
		pos="32796,1255",
		shape=rectangle,
		width=2.9167];
	layer2_attn_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Multi-Head_Attention_GPU8
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 8",
		pos="32750,1128.5",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu8 -> layer2_attn_gpu8	[pos="e,32766,1170.2 32779,1205.9 32776,1197.3 32772,1188.4 32769,1179.8"];
	layer2_attn_proj_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU8
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 8",
		pos="32750,1017",
		shape=rectangle,
		width=2.7778];
	layer2_attn_gpu8 -> layer2_attn_proj_gpu8	[pos="e,32750,1051.3 32750,1086.7 32750,1078.5 32750,1069.9 32750,1061.6"];
	layer2_attn_norm_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU8
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 8",
		pos="32748,741",
		shape=rectangle,
		width=3.3889];
	layer2_attn_proj_gpu8 -> layer2_attn_norm_gpu8	[pos="e,32748,775.17 32750,982.95 32750,933.47 32749,840.12 32748,785.27"];
	layer2_allreduce_attn	[height=1.8889,
		label="L2_All-Reduce_Attention
Input: 8Ã—[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce",
		pos="33682,879",
		width=5.6389];
	layer2_attn_proj_gpu8 -> layer2_allreduce_attn	[pos="e,33531,896.26 32851,992.99 32868,989.4 32886,985.92 32902,983 33115,945.94 33362,915.39 33521,897.43"];
	layer2_gate_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU8
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 8",
		pos="23526,629.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu8 -> layer2_gate_gpu8	[pos="e,23649,632.43 32625,738.86 31976,732.75 28867,703.07 26324,671 25298,658.06 24060,638.9 23659,632.59"];
	layer2_expert8_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="22062,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_0	[pos="e,22145,549.76 23404,627.34 23118,623.72 22408,609.31 22155,552.07",
		style=dashed];
	layer2_expert8_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="22246,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_1	[pos="e,22328,549.73 23404,626.1 23146,620.18 22555,601.75 22338,552.11",
		style=dashed];
	layer2_expert8_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="22428,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_2	[pos="e,22511,549.68 23404,624.44 23178,616.08 22702,594.29 22521,552.1",
		style=dashed];
	layer2_expert8_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="22612,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_3	[pos="e,22694,549.62 23404,622.05 23213,611.12 22849,586.96 22704,552.15",
		style=dashed];
	layer2_expert8_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="22794,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_4	[pos="e,22877,549.53 23404,624.77 23276,618.4 23069,601.17 22887,552.19",
		style=dashed];
	layer2_expert8_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="22978,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_5	[pos="e,23060,549.36 23404,616.58 23313,605.76 23187,586.52 23070,552.28",
		style=dashed];
	layer2_expert8_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="23160,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_6	[pos="e,23243,548.89 23404,598.69 23359,586.56 23307,571.48 23253,552.26",
		style=dashed];
	layer2_expert8_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="23344,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_7	[pos="e,23407,552.02 23463,587.91 23448,578.11 23431,567.56 23415,557.53",
		style=dashed];
	layer2_expert8_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="23526,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_8	[pos="e,23526,552.02 23526,587.91 23526,579.65 23526,570.86 23526,562.3",
		style=dashed];
	layer2_expert8_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="23710,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_9	[pos="e,23646,552.02 23590,587.91 23605,578.11 23622,567.56 23638,557.53",
		style=dashed];
	layer2_expert8_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="23892,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_10	[pos="e,23810,548.49 23649,598.37 23697,585.55 23752,569.51 23800,552 23801,551.97 23801,551.93 23801,551.9",
		style=dashed];
	layer2_expert8_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="24076,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_11	[pos="e,23993,549.01 23649,616.42 23739,605.52 23865,586.25 23983,551.94",
		style=dashed];
	layer2_expert8_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="24258,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_12	[pos="e,24176,549.2 23649,624.6 23777,618.1 23983,600.76 24166,551.85",
		style=dashed];
	layer2_expert8_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="24442,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_13	[pos="e,24359,549.3 23649,621.96 23840,610.93 24203,586.64 24349,551.83",
		style=dashed];
	layer2_expert8_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="24624,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_14	[pos="e,24542,549.37 23649,624.37 23874,615.9 24350,593.94 24532,551.78",
		style=dashed];
	layer2_expert8_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="24808,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu8 -> layer2_expert8_15	[pos="e,24725,549.42 23649,626.04 23906,619.99 24498,601.3 24715,551.73",
		style=dashed];
	layer2_moe_agg_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_MoE_Aggregate_GPU8
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 8",
		pos="23618,391.5",
		shape=rectangle,
		width=2.8194];
	layer2_expert8_0 -> layer2_moe_agg_gpu8	[pos="e,23517,392.99 22145,471.23 22148,470.41 22151,469.67 22154,469 22410,407.47 23210,395.43 23507,393.07"];
	layer2_expert8_1 -> layer2_moe_agg_gpu8	[pos="e,23517,393.88 22328,471.26 22331,470.43 22334,469.68 22336,469 22557,415.25 23237,398.62 23507,394.05"];
	layer2_expert8_2 -> layer2_moe_agg_gpu8	[pos="e,23517,395.07 22511,471.29 22514,470.46 22517,469.69 22520,469 22704,423.03 23265,402.31 23506,395.36"];
	layer2_expert8_3 -> layer2_moe_agg_gpu8	[pos="e,23517,396.7 22694,471.34 22697,470.49 22700,469.71 22702,469 22852,430.73 23297,406.67 23507,397.16"];
	layer2_expert8_4 -> layer2_moe_agg_gpu8	[pos="e,23517,393.09 22877,471.42 22880,470.55 22883,469.74 22886,469 23100,411.57 23361,396.86 23507,393.33"];
	layer2_expert8_5 -> layer2_moe_agg_gpu8	[pos="e,23517,398.09 23060,471.54 23063,470.64 23066,469.78 23068,469 23217,426.62 23394,407.34 23507,398.83"];
	layer2_expert8_6 -> layer2_moe_agg_gpu8	[pos="e,23517,407.68 23243,471.87 23246,470.86 23249,469.9 23252,469 23335,441.94 23433,422.11 23507,409.42"];
	layer2_expert8_7 -> layer2_moe_agg_gpu8	[pos="e,23519,433.14 23426,472.55 23429,471.35 23432,470.16 23434,469 23459,458.51 23485,447.44 23510,437.08"];
	layer2_expert8_8 -> layer2_moe_agg_gpu8	[pos="e,23587,433.02 23558,468.91 23565,459.92 23573,450.32 23580,441.05"];
	layer2_expert8_9 -> layer2_moe_agg_gpu8	[pos="e,23650,433.02 23678,468.91 23671,459.92 23663,450.32 23656,441.05"];
	layer2_expert8_10 -> layer2_moe_agg_gpu8	[pos="e,23716,433.09 23810,473.01 23807,471.65 23804,470.31 23800,469 23776,458.55 23750,447.45 23725,437.04"];
	layer2_expert8_11 -> layer2_moe_agg_gpu8	[pos="e,23720,407.98 23993,472.15 23990,471.04 23987,469.99 23984,469 23900,442.3 23803,422.5 23730,409.74"];
	layer2_expert8_12 -> layer2_moe_agg_gpu8	[pos="e,23720,398.29 24176,471.88 24173,470.85 24170,469.88 24166,469 24019,427.14 23843,407.74 23731,399.07"];
	layer2_expert8_13 -> layer2_moe_agg_gpu8	[pos="e,23720,393.26 24359,471.74 24356,470.75 24353,469.83 24350,469 24135,412.17 23876,397.24 23730,393.51"];
	layer2_expert8_14 -> layer2_moe_agg_gpu8	[pos="e,23720,396.78 24542,471.66 24539,470.69 24536,469.8 24532,469 24384,431.12 23940,406.88 23730,397.24"];
	layer2_expert8_15 -> layer2_moe_agg_gpu8	[pos="e,23720,395.13 24725,471.6 24722,470.65 24719,469.77 24716,469 24531,423.47 23971,402.51 23730,395.43"];
	layer2_output_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU8
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 8",
		pos="26574,108",
		shape=rectangle,
		width=3.3889];
	layer2_moe_agg_gpu8 -> layer2_output_gpu8	[pos="e,26452,120.65 23720,380.81 24165,338.43 25940,169.38 26442,121.62"];
	layer2_allreduce_moe	[height=1.8889,
		label="L2_All-Reduce_MoE
Input: 8Ã—[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce",
		pos="33592,246",
		width=5.6389];
	layer2_moe_agg_gpu8 -> layer2_allreduce_moe	[pos="e,33400,249.76 23720,389.04 24675,375.3 32068,268.93 33390,249.91"];
	layer2_qkv_gpu9	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU9
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 4-7
TP Slice: 1
GPU: 9",
		pos="33040,1255",
		shape=rectangle,
		width=2.9167];
	layer2_attn_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Multi-Head_Attention_GPU9
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 9",
		pos="33012,1128.5",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu9 -> layer2_attn_gpu9	[pos="e,33021,1170.2 33029,1205.9 33027,1197.4 33025,1188.6 33023,1180.1"];
	layer2_attn_proj_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU9
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 9",
		pos="33012,1017",
		shape=rectangle,
		width=2.7778];
	layer2_attn_gpu9 -> layer2_attn_proj_gpu9	[pos="e,33012,1051.3 33012,1086.7 33012,1078.5 33012,1069.9 33012,1061.6"];
	layer2_attn_norm_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU9
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 9",
		pos="33010,741",
		shape=rectangle,
		width=3.3889];
	layer2_attn_proj_gpu9 -> layer2_attn_norm_gpu9	[pos="e,33010,775.17 33011,982.95 33011,933.47 33010,840.12 33010,785.27"];
	layer2_attn_proj_gpu9 -> layer2_allreduce_attn	[pos="e,33555,904.55 33112,994 33129,990.28 33147,986.49 33164,983 33293,956.12 33441,926.92 33545,906.5"];
	layer2_gate_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU9
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 9",
		pos="26454,629.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu9 -> layer2_gate_gpu9	[pos="e,26577,632.47 32887,708.25 32884,707.79 32881,707.38 32878,707 32679,681.21 29453,673.46 29252,671 28226,658.48 26988,639.05 26587,\
632.63"];
	layer2_expert9_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="24990,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_0	[pos="e,25073,549.76 26332,627.34 26046,623.72 25336,609.31 25083,552.07",
		style=dashed];
	layer2_expert9_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="25174,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_1	[pos="e,25256,549.73 26332,626.1 26074,620.18 25483,601.75 25266,552.11",
		style=dashed];
	layer2_expert9_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="25356,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_2	[pos="e,25439,549.68 26332,624.44 26106,616.08 25630,594.29 25449,552.1",
		style=dashed];
	layer2_expert9_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="25540,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_3	[pos="e,25622,549.62 26332,622.05 26141,611.12 25777,586.96 25632,552.15",
		style=dashed];
	layer2_expert9_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="25722,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_4	[pos="e,25805,549.53 26332,624.77 26204,618.4 25997,601.17 25815,552.19",
		style=dashed];
	layer2_expert9_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="25906,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_5	[pos="e,25988,549.36 26332,616.58 26241,605.76 26115,586.52 25998,552.28",
		style=dashed];
	layer2_expert9_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="26088,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_6	[pos="e,26171,548.89 26332,598.69 26287,586.56 26235,571.48 26181,552.26",
		style=dashed];
	layer2_expert9_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="26272,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_7	[pos="e,26335,552.02 26391,587.91 26376,578.11 26359,567.56 26343,557.53",
		style=dashed];
	layer2_expert9_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="26454,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_8	[pos="e,26454,552.02 26454,587.91 26454,579.65 26454,570.86 26454,562.3",
		style=dashed];
	layer2_expert9_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="26638,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_9	[pos="e,26574,552.02 26518,587.91 26533,578.11 26550,567.56 26566,557.53",
		style=dashed];
	layer2_expert9_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="26820,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_10	[pos="e,26738,548.49 26577,598.37 26625,585.55 26680,569.51 26728,552 26729,551.97 26729,551.93 26729,551.9",
		style=dashed];
	layer2_expert9_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="27004,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_11	[pos="e,26921,549.01 26577,616.42 26667,605.52 26793,586.25 26911,551.94",
		style=dashed];
	layer2_expert9_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="27186,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_12	[pos="e,27104,549.2 26577,624.6 26705,618.1 26911,600.76 27094,551.85",
		style=dashed];
	layer2_expert9_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="27370,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_13	[pos="e,27287,549.3 26577,621.96 26768,610.93 27131,586.64 27277,551.83",
		style=dashed];
	layer2_expert9_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="27552,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_14	[pos="e,27470,549.37 26577,624.37 26802,615.9 27278,593.94 27460,551.78",
		style=dashed];
	layer2_expert9_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="27736,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu9 -> layer2_expert9_15	[pos="e,27653,549.42 26577,626.04 26834,619.99 27426,601.3 27643,551.73",
		style=dashed];
	layer2_moe_agg_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_MoE_Aggregate_GPU9
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 9",
		pos="26546,391.5",
		shape=rectangle,
		width=2.8194];
	layer2_expert9_0 -> layer2_moe_agg_gpu9	[pos="e,26444,393 25073,471.23 25076,470.41 25079,469.67 25082,469 25338,407.53 26137,395.45 26433,393.08"];
	layer2_expert9_1 -> layer2_moe_agg_gpu9	[pos="e,26444,393.89 25256,471.26 25259,470.43 25262,469.68 25264,469 25485,415.29 26164,398.63 26434,394.06"];
	layer2_expert9_2 -> layer2_moe_agg_gpu9	[pos="e,26444,395.07 25439,471.29 25442,470.46 25445,469.69 25448,469 25632,423.06 26193,402.33 26433,395.36"];
	layer2_expert9_3 -> layer2_moe_agg_gpu9	[pos="e,26444,396.71 25622,471.34 25625,470.49 25628,469.71 25630,469 25780,430.76 26224,406.69 26434,397.16"];
	layer2_expert9_4 -> layer2_moe_agg_gpu9	[pos="e,26444,393.11 25805,471.42 25808,470.55 25811,469.74 25814,469 26028,411.63 26288,396.9 26434,393.35"];
	layer2_expert9_5 -> layer2_moe_agg_gpu9	[pos="e,26444,398.13 25988,471.54 25991,470.64 25994,469.78 25996,469 26144,426.71 26322,407.41 26434,398.87"];
	layer2_expert9_6 -> layer2_moe_agg_gpu9	[pos="e,26444,407.78 26171,471.87 26174,470.87 26177,469.9 26180,469 26263,442.04 26360,422.22 26434,409.52"];
	layer2_expert9_7 -> layer2_moe_agg_gpu9	[pos="e,26447,433.18 26354,472.56 26357,471.35 26360,470.16 26362,469 26387,458.54 26413,447.48 26438,437.11"];
	layer2_expert9_8 -> layer2_moe_agg_gpu9	[pos="e,26514,433.02 26486,468.91 26493,459.92 26501,450.32 26508,441.05"];
	layer2_expert9_9 -> layer2_moe_agg_gpu9	[pos="e,26577,433.02 26606,468.91 26599,459.92 26591,450.32 26584,441.05"];
	layer2_expert9_10 -> layer2_moe_agg_gpu9	[pos="e,26643,433.05 26738,473 26735,471.64 26732,470.31 26728,469 26704,458.53 26678,447.42 26653,437.01"];
	layer2_expert9_11 -> layer2_moe_agg_gpu9	[pos="e,26647,407.89 26921,472.15 26918,471.04 26915,469.99 26912,469 26828,442.21 26731,422.38 26657,409.64"];
	layer2_expert9_12 -> layer2_moe_agg_gpu9	[pos="e,26647,398.25 27104,471.88 27101,470.85 27098,469.88 27094,469 26947,427.01 26769,407.63 26657,399"];
	layer2_expert9_13 -> layer2_moe_agg_gpu9	[pos="e,26647,393.24 27287,471.74 27284,470.75 27281,469.83 27278,469 27063,412.07 26803,397.17 26657,393.48"];
	layer2_expert9_14 -> layer2_moe_agg_gpu9	[pos="e,26647,396.77 27470,471.66 27467,470.69 27464,469.8 27460,469 27311,431.09 26867,406.87 26657,397.24"];
	layer2_expert9_15 -> layer2_moe_agg_gpu9	[pos="e,26647,395.12 27653,471.6 27650,470.65 27647,469.77 27644,469 27459,423.44 26898,402.5 26657,395.42"];
	layer2_output_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU9
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 9",
		pos="30176,108",
		shape=rectangle,
		width=3.3889];
	layer2_moe_agg_gpu9 -> layer2_output_gpu9	[pos="e,30053,118.48 26647,382.6 27161,342.78 29464,164.15 30043,119.26"];
	layer2_moe_agg_gpu9 -> layer2_allreduce_moe	[pos="e,33403,250.85 26647,388.43 27418,372.74 32337,272.55 33392,251.06"];
	layer2_qkv_gpu10	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU10
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 8-11
TP Slice: 2
GPU: 10",
		pos="33298,1255",
		shape=rectangle,
		width=2.9167];
	layer2_attn_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Multi-Head_Attention_GPU10
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 10",
		pos="33278,1128.5",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu10 -> layer2_attn_gpu10	[pos="e,33284,1170.2 33290,1205.9 33289,1197.5 33287,1188.8 33286,1180.3"];
	layer2_attn_proj_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU10
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 10",
		pos="33278,1017",
		shape=rectangle,
		width=2.9028];
	layer2_attn_gpu10 -> layer2_attn_proj_gpu10	[pos="e,33278,1051.3 33278,1086.7 33278,1078.5 33278,1069.9 33278,1061.6"];
	layer2_attn_norm_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU10
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 10",
		pos="33276,741",
		shape=rectangle,
		width=3.5139];
	layer2_attn_proj_gpu10 -> layer2_attn_norm_gpu10	[pos="e,33277,775.17 33277,982.95 33277,933.47 33277,840.12 33277,785.27"];
	layer2_attn_proj_gpu10 -> layer2_allreduce_attn	[pos="e,33582,913.64 33376,982.99 33435,963.03 33511,937.54 33573,916.91"];
	layer2_gate_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU10
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 10",
		pos="29382,629.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu10 -> layer2_gate_gpu10	[pos="e,29505,632.24 33150,708.35 33147,707.86 33144,707.41 33140,707 32957,683.21 30160,641.69 29515,632.38"];
	layer2_expert10_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="27918,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_0	[pos="e,28001,549.76 29260,627.34 28974,623.72 28264,609.31 28011,552.07",
		style=dashed];
	layer2_expert10_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="28102,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_1	[pos="e,28184,549.73 29260,626.1 29002,620.18 28411,601.75 28194,552.11",
		style=dashed];
	layer2_expert10_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="28284,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_2	[pos="e,28367,549.68 29260,624.44 29034,616.08 28558,594.29 28377,552.1",
		style=dashed];
	layer2_expert10_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="28468,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_3	[pos="e,28550,549.62 29260,622.05 29069,611.12 28705,586.96 28560,552.15",
		style=dashed];
	layer2_expert10_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="28650,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_4	[pos="e,28733,549.53 29260,624.77 29132,618.4 28925,601.17 28743,552.19",
		style=dashed];
	layer2_expert10_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="28834,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_5	[pos="e,28916,549.36 29260,616.58 29169,605.76 29043,586.52 28926,552.28",
		style=dashed];
	layer2_expert10_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="29016,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_6	[pos="e,29099,548.89 29260,598.69 29215,586.56 29163,571.48 29109,552.26",
		style=dashed];
	layer2_expert10_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="29200,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_7	[pos="e,29263,552.02 29319,587.91 29304,578.11 29287,567.56 29271,557.53",
		style=dashed];
	layer2_expert10_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="29382,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_8	[pos="e,29382,552.02 29382,587.91 29382,579.65 29382,570.86 29382,562.3",
		style=dashed];
	layer2_expert10_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="29566,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_9	[pos="e,29502,552.02 29446,587.91 29461,578.11 29478,567.56 29494,557.53",
		style=dashed];
	layer2_expert10_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="29748,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_10	[pos="e,29666,548.49 29505,598.37 29553,585.55 29608,569.51 29656,552 29657,551.97 29657,551.93 29657,551.9",
		style=dashed];
	layer2_expert10_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="29932,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_11	[pos="e,29849,549.01 29505,616.42 29595,605.52 29721,586.25 29839,551.94",
		style=dashed];
	layer2_expert10_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="30114,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_12	[pos="e,30032,549.2 29505,624.6 29633,618.1 29839,600.76 30022,551.85",
		style=dashed];
	layer2_expert10_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="30298,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_13	[pos="e,30215,549.3 29505,621.96 29696,610.93 30059,586.64 30205,551.83",
		style=dashed];
	layer2_expert10_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="30480,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_14	[pos="e,30398,549.37 29505,624.37 29730,615.9 30206,593.94 30388,551.78",
		style=dashed];
	layer2_expert10_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="30664,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu10 -> layer2_expert10_15	[pos="e,30581,549.42 29505,626.04 29762,619.99 30354,601.3 30571,551.73",
		style=dashed];
	layer2_moe_agg_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_MoE_Aggregate_GPU10
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 10",
		pos="29474,391.5",
		shape=rectangle,
		width=2.9444];
	layer2_expert10_0 -> layer2_moe_agg_gpu10	[pos="e,29367,393.03 28001,471.23 28004,470.41 28007,469.67 28010,469 28265,407.81 29058,395.56 29357,393.11"];
	layer2_expert10_1 -> layer2_moe_agg_gpu10	[pos="e,29367,393.97 28184,471.26 28187,470.43 28190,469.68 28192,469 28411,415.62 29084,398.83 29357,394.14"];
	layer2_expert10_2 -> layer2_moe_agg_gpu10	[pos="e,29367,395.2 28367,471.29 28370,470.46 28373,469.69 28376,469 28559,423.35 29114,402.59 29357,395.5"];
	layer2_expert10_3 -> layer2_moe_agg_gpu10	[pos="e,29367,396.92 28550,471.34 28553,470.49 28556,469.71 28558,469 28706,431.06 29146,407.06 29357,397.38"];
	layer2_expert10_4 -> layer2_moe_agg_gpu10	[pos="e,29367,393.21 28733,471.42 28736,470.55 28739,469.74 28742,469 28954,412.24 29211,397.21 29357,393.46"];
	layer2_expert10_5 -> layer2_moe_agg_gpu10	[pos="e,29367,398.45 28916,471.54 28919,470.64 28922,469.78 28924,469 29070,427.26 29245,407.91 29357,399.21"];
	layer2_expert10_6 -> layer2_moe_agg_gpu10	[pos="e,29367,408.52 29099,471.87 29102,470.87 29105,469.9 29108,469 29189,442.56 29285,423 29357,410.27"];
	layer2_expert10_7 -> layer2_moe_agg_gpu10	[pos="e,29375,433.18 29282,472.56 29285,471.35 29288,470.16 29290,469 29315,458.54 29341,447.48 29366,437.11"];
	layer2_expert10_8 -> layer2_moe_agg_gpu10	[pos="e,29442,433.02 29414,468.91 29421,459.92 29429,450.32 29436,441.05"];
	layer2_expert10_9 -> layer2_moe_agg_gpu10	[pos="e,29505,433.02 29534,468.91 29527,459.92 29519,450.32 29512,441.05"];
	layer2_expert10_10 -> layer2_moe_agg_gpu10	[pos="e,29571,433.05 29666,473 29663,471.64 29660,470.31 29656,469 29632,458.53 29606,447.42 29581,437.01"];
	layer2_expert10_11 -> layer2_moe_agg_gpu10	[pos="e,29580,408.63 29849,472.15 29846,471.04 29843,469.99 29840,469 29758,442.73 29662,423.16 29590,410.39"];
	layer2_expert10_12 -> layer2_moe_agg_gpu10	[pos="e,29580,398.57 30032,471.88 30029,470.85 30026,469.88 30022,469 29876,427.55 29702,408.14 29590,399.34"];
	layer2_expert10_13 -> layer2_moe_agg_gpu10	[pos="e,29580,393.34 30215,471.74 30212,470.75 30209,469.83 30206,469 29993,412.67 29736,397.49 29590,393.6"];
	layer2_expert10_14 -> layer2_moe_agg_gpu10	[pos="e,29580,396.97 30398,471.66 30395,470.69 30392,469.8 30388,469 30240,431.36 29801,407.21 29590,397.44"];
	layer2_expert10_15 -> layer2_moe_agg_gpu10	[pos="e,29580,395.25 30581,471.6 30578,470.65 30575,469.77 30572,469 30388,423.72 29833,402.76 29590,395.55"];
	layer2_output_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU10
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 10",
		pos="32112,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu10 -> layer2_output_gpu10	[pos="e,31986,122.5 29580,379.16 29995,334.82 31511,173.2 31976,123.58"];
	layer2_moe_agg_gpu10 -> layer2_allreduce_moe	[pos="e,33410,253.32 29580,386.8 30132,367.56 32678,278.84 33400,253.67"];
	layer2_qkv_gpu11	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU11
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 12-15
TP Slice: 3
GPU: 11",
		pos="33558,1255",
		shape=rectangle,
		width=2.9167];
	layer2_attn_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Multi-Head_Attention_GPU11
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 11",
		pos="33548,1128.5",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu11 -> layer2_attn_gpu11	[pos="e,33551,1170.2 33554,1205.9 33553,1197.5 33552,1188.8 33552,1180.3"];
	layer2_attn_proj_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU11
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 11",
		pos="33548,1017",
		shape=rectangle,
		width=2.9028];
	layer2_attn_gpu11 -> layer2_attn_proj_gpu11	[pos="e,33548,1051.3 33548,1086.7 33548,1078.5 33548,1069.9 33548,1061.6"];
	layer2_attn_norm_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU11
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 11",
		pos="33548,741",
		shape=rectangle,
		width=3.5139];
	layer2_attn_proj_gpu11 -> layer2_attn_norm_gpu11	[pos="e,33498,775.31 33498,982.69 33487,972.64 33477,960.6 33470,947 33446,891.81 33446,866.19 33470,811 33475,800.48 33482,790.9 33491,\
782.44"];
	layer2_attn_proj_gpu11 -> layer2_allreduce_attn	[pos="e,33632,930.43 33581,982.73 33594,969.21 33610,953.2 33625,937.88"];
	layer2_gate_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU11
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 11",
		pos="32310,629.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu11 -> layer2_gate_gpu11	[pos="e,32433,632.27 33421,708.55 33418,708 33415,707.48 33412,707 33065,653.24 32650,637.25 32443,632.5"];
	layer2_expert11_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="30846,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_0	[pos="e,30929,549.76 32188,627.34 31902,623.72 31192,609.31 30939,552.07",
		style=dashed];
	layer2_expert11_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="31030,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_1	[pos="e,31112,549.73 32188,626.1 31930,620.18 31339,601.75 31122,552.11",
		style=dashed];
	layer2_expert11_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="31212,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_2	[pos="e,31295,549.68 32188,624.44 31962,616.08 31486,594.29 31305,552.1",
		style=dashed];
	layer2_expert11_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="31396,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_3	[pos="e,31478,549.62 32188,622.05 31997,611.12 31633,586.96 31488,552.15",
		style=dashed];
	layer2_expert11_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="31578,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_4	[pos="e,31661,549.53 32188,624.77 32060,618.4 31853,601.17 31671,552.19",
		style=dashed];
	layer2_expert11_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="31762,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_5	[pos="e,31844,549.36 32188,616.58 32097,605.76 31971,586.52 31854,552.28",
		style=dashed];
	layer2_expert11_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="31944,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_6	[pos="e,32027,548.89 32188,598.69 32143,586.56 32091,571.48 32037,552.26",
		style=dashed];
	layer2_expert11_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="32128,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_7	[pos="e,32191,552.02 32247,587.91 32232,578.11 32215,567.56 32199,557.53",
		style=dashed];
	layer2_expert11_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="32310,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_8	[pos="e,32310,552.02 32310,587.91 32310,579.65 32310,570.86 32310,562.3",
		style=dashed];
	layer2_expert11_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="32494,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_9	[pos="e,32430,552.02 32374,587.91 32389,578.11 32406,567.56 32422,557.53",
		style=dashed];
	layer2_expert11_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="32676,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_10	[pos="e,32594,548.49 32433,598.37 32481,585.55 32536,569.51 32584,552 32585,551.97 32585,551.93 32585,551.9",
		style=dashed];
	layer2_expert11_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="32860,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_11	[pos="e,32777,549.01 32433,616.42 32523,605.52 32649,586.25 32767,551.94",
		style=dashed];
	layer2_expert11_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="33042,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_12	[pos="e,32960,549.2 32433,624.6 32561,618.1 32767,600.76 32950,551.85",
		style=dashed];
	layer2_expert11_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="33226,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_13	[pos="e,33143,549.3 32433,621.96 32624,610.93 32987,586.64 33133,551.83",
		style=dashed];
	layer2_expert11_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="33408,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_14	[pos="e,33326,549.37 32433,624.37 32658,615.9 33134,593.94 33316,551.78",
		style=dashed];
	layer2_expert11_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="33592,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu11 -> layer2_expert11_15	[pos="e,33509,549.42 32433,626.04 32690,619.99 33282,601.3 33499,551.73",
		style=dashed];
	layer2_moe_agg_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_MoE_Aggregate_GPU11
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 11",
		pos="32402,391.5",
		shape=rectangle,
		width=2.9444];
	layer2_expert11_0 -> layer2_moe_agg_gpu11	[pos="e,32295,393.03 30929,471.23 30932,470.41 30935,469.67 30938,469 31193,407.81 31986,395.56 32285,393.11"];
	layer2_expert11_1 -> layer2_moe_agg_gpu11	[pos="e,32295,393.97 31112,471.26 31115,470.43 31118,469.68 31120,469 31339,415.62 32012,398.83 32285,394.14"];
	layer2_expert11_2 -> layer2_moe_agg_gpu11	[pos="e,32295,395.2 31295,471.29 31298,470.46 31301,469.69 31304,469 31487,423.35 32042,402.59 32285,395.5"];
	layer2_expert11_3 -> layer2_moe_agg_gpu11	[pos="e,32295,396.92 31478,471.34 31481,470.49 31484,469.71 31486,469 31634,431.06 32074,407.06 32285,397.38"];
	layer2_expert11_4 -> layer2_moe_agg_gpu11	[pos="e,32295,393.21 31661,471.42 31664,470.55 31667,469.74 31670,469 31882,412.24 32139,397.21 32285,393.46"];
	layer2_expert11_5 -> layer2_moe_agg_gpu11	[pos="e,32295,398.45 31844,471.54 31847,470.64 31850,469.78 31852,469 31998,427.26 32173,407.91 32285,399.21"];
	layer2_expert11_6 -> layer2_moe_agg_gpu11	[pos="e,32295,408.52 32027,471.87 32030,470.87 32033,469.9 32036,469 32117,442.56 32213,423 32285,410.27"];
	layer2_expert11_7 -> layer2_moe_agg_gpu11	[pos="e,32303,433.18 32210,472.56 32213,471.35 32216,470.16 32218,469 32243,458.54 32269,447.48 32294,437.11"];
	layer2_expert11_8 -> layer2_moe_agg_gpu11	[pos="e,32370,433.02 32342,468.91 32349,459.92 32357,450.32 32364,441.05"];
	layer2_expert11_9 -> layer2_moe_agg_gpu11	[pos="e,32433,433.02 32462,468.91 32455,459.92 32447,450.32 32440,441.05"];
	layer2_expert11_10 -> layer2_moe_agg_gpu11	[pos="e,32499,433.05 32594,473 32591,471.64 32588,470.31 32584,469 32560,458.53 32534,447.42 32509,437.01"];
	layer2_expert11_11 -> layer2_moe_agg_gpu11	[pos="e,32508,408.63 32777,472.15 32774,471.04 32771,469.99 32768,469 32686,442.73 32590,423.16 32518,410.39"];
	layer2_expert11_12 -> layer2_moe_agg_gpu11	[pos="e,32508,398.57 32960,471.88 32957,470.85 32954,469.88 32950,469 32804,427.55 32630,408.14 32518,399.34"];
	layer2_expert11_13 -> layer2_moe_agg_gpu11	[pos="e,32508,393.34 33143,471.74 33140,470.75 33137,469.83 33134,469 32921,412.67 32664,397.49 32518,393.6"];
	layer2_expert11_14 -> layer2_moe_agg_gpu11	[pos="e,32508,396.97 33326,471.66 33323,470.69 33320,469.8 33316,469 33168,431.36 32729,407.21 32518,397.44"];
	layer2_expert11_15 -> layer2_moe_agg_gpu11	[pos="e,32508,395.25 33509,471.6 33506,470.65 33503,469.77 33500,469 33316,423.72 32761,402.76 32518,395.55"];
	layer2_output_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU11
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 11",
		pos="33218,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu11 -> layer2_output_gpu11	[pos="e,33123,142.02 32508,353.84 32665,299.77 32957,199.23 33113,145.34"];
	layer2_moe_agg_gpu11 -> layer2_allreduce_moe	[pos="e,33444,264.77 32508,377.7 32718,352.36 33188,295.69 33434,265.99"];
	layer2_qkv_gpu12	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU12
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 16-19
TP Slice: 4
GPU: 12",
		pos="33806,1255",
		shape=rectangle,
		width=2.9167];
	layer2_attn_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Multi-Head_Attention_GPU12
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 12",
		pos="33818,1128.5",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu12 -> layer2_attn_gpu12	[pos="e,33814,1170.2 33811,1205.9 33811,1197.5 33812,1188.8 33813,1180.3"];
	layer2_attn_proj_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU12
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 12",
		pos="33818,1017",
		shape=rectangle,
		width=2.9028];
	layer2_attn_gpu12 -> layer2_attn_proj_gpu12	[pos="e,33818,1051.3 33818,1086.7 33818,1078.5 33818,1069.9 33818,1061.6"];
	layer2_attn_norm_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU12
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 12",
		pos="33818,741",
		shape=rectangle,
		width=3.5139];
	layer2_attn_proj_gpu12 -> layer2_attn_norm_gpu12	[pos="e,33867,775.05 33867,982.69 33878,972.64 33888,960.6 33894,947 33919,891.81 33919,866.27 33894,811 33890,800.41 33883,790.76 33874,\
782.24"];
	layer2_attn_proj_gpu12 -> layer2_allreduce_attn	[pos="e,33733,930.43 33784,982.73 33771,969.21 33755,953.2 33740,937.88"];
	layer2_gate_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU12
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 12",
		pos="35056,629.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu12 -> layer2_gate_gpu12	[pos="e,34933,632.2 33945,708.36 33948,707.88 33951,707.43 33954,707 34301,652.91 34716,637.06 34923,632.42"];
	layer2_expert12_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="33774,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_0	[pos="e,33857,549.73 34933,626.1 34675,620.18 34084,601.75 33867,552.11",
		style=dashed];
	layer2_expert12_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="33958,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_1	[pos="e,34040,549.68 34933,624.44 34707,616.08 34231,594.29 34050,552.1",
		style=dashed];
	layer2_expert12_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="34140,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_2	[pos="e,34223,549.62 34933,622.05 34742,611.12 34378,586.96 34233,552.15",
		style=dashed];
	layer2_expert12_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="34324,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_3	[pos="e,34406,549.53 34933,624.77 34805,618.4 34598,601.17 34416,552.19",
		style=dashed];
	layer2_expert12_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="34506,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_4	[pos="e,34589,549.36 34933,616.58 34842,605.76 34716,586.52 34599,552.28",
		style=dashed];
	layer2_expert12_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="34690,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_5	[pos="e,34772,548.89 34933,598.69 34888,586.56 34836,571.48 34782,552.26",
		style=dashed];
	layer2_expert12_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="34872,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_6	[pos="e,34936,552.02 34992,587.91 34977,578.11 34960,567.56 34944,557.53",
		style=dashed];
	layer2_expert12_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="35056,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_7	[pos="e,35056,552.02 35056,587.91 35056,579.65 35056,570.86 35056,562.3",
		style=dashed];
	layer2_expert12_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="35238,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_8	[pos="e,35175,552.02 35119,587.91 35134,578.11 35151,567.56 35167,557.53",
		style=dashed];
	layer2_expert12_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="35422,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_9	[pos="e,35339,548.49 35178,598.37 35226,585.55 35281,569.51 35330,552 35330,551.97 35330,551.93 35330,551.9",
		style=dashed];
	layer2_expert12_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="35604,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_10	[pos="e,35522,549.01 35178,616.42 35268,605.52 35394,586.25 35512,551.94",
		style=dashed];
	layer2_expert12_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="35788,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_11	[pos="e,35705,549.2 35178,624.6 35306,618.1 35512,600.76 35695,551.85",
		style=dashed];
	layer2_expert12_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="35970,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_12	[pos="e,35888,549.3 35178,621.96 35369,610.93 35732,586.64 35878,551.83",
		style=dashed];
	layer2_expert12_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="36154,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_13	[pos="e,36071,549.37 35178,624.37 35403,615.9 35879,593.94 36061,551.78",
		style=dashed];
	layer2_expert12_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="36336,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_14	[pos="e,36254,549.42 35178,626.04 35435,619.99 36027,601.3 36244,551.73",
		style=dashed];
	layer2_expert12_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="36520,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu12 -> layer2_expert12_15	[pos="e,36437,549.45 35178,627.27 35464,623.51 36173,608.8 36427,551.76",
		style=dashed];
	layer2_moe_agg_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_MoE_Aggregate_GPU12
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 12",
		pos="34964,391.5",
		shape=rectangle,
		width=2.9444];
	layer2_expert12_0 -> layer2_moe_agg_gpu12	[pos="e,34857,395.2 33857,471.29 33860,470.46 33863,469.69 33866,469 34049,423.35 34604,402.59 34847,395.5"];
	layer2_expert12_1 -> layer2_moe_agg_gpu12	[pos="e,34857,396.92 34040,471.34 34043,470.49 34046,469.71 34048,469 34196,431.06 34636,407.06 34847,397.38"];
	layer2_expert12_2 -> layer2_moe_agg_gpu12	[pos="e,34857,393.21 34223,471.42 34226,470.55 34229,469.74 34232,469 34444,412.24 34701,397.21 34847,393.46"];
	layer2_expert12_3 -> layer2_moe_agg_gpu12	[pos="e,34857,398.45 34406,471.54 34409,470.64 34412,469.78 34414,469 34560,427.26 34735,407.91 34847,399.21"];
	layer2_expert12_4 -> layer2_moe_agg_gpu12	[pos="e,34857,408.52 34589,471.87 34592,470.87 34595,469.9 34598,469 34679,442.56 34775,423 34847,410.27"];
	layer2_expert12_5 -> layer2_moe_agg_gpu12	[pos="e,34865,433.18 34772,472.56 34775,471.35 34778,470.16 34780,469 34805,458.54 34831,447.48 34856,437.11"];
	layer2_expert12_6 -> layer2_moe_agg_gpu12	[pos="e,34932,433.02 34904,468.91 34911,459.92 34919,450.32 34926,441.05"];
	layer2_expert12_7 -> layer2_moe_agg_gpu12	[pos="e,34995,433.02 35024,468.91 35017,459.92 35009,450.32 35002,441.05"];
	layer2_expert12_8 -> layer2_moe_agg_gpu12	[pos="e,35061,433.05 35156,473 35153,471.64 35150,470.31 35146,469 35122,458.53 35096,447.42 35071,437.01"];
	layer2_expert12_9 -> layer2_moe_agg_gpu12	[pos="e,35070,408.63 35339,472.15 35336,471.04 35333,469.99 35330,469 35248,442.73 35152,423.16 35080,410.39"];
	layer2_expert12_10 -> layer2_moe_agg_gpu12	[pos="e,35070,398.57 35522,471.88 35519,470.85 35516,469.88 35512,469 35366,427.55 35192,408.14 35080,399.34"];
	layer2_expert12_11 -> layer2_moe_agg_gpu12	[pos="e,35070,393.34 35705,471.74 35702,470.75 35699,469.83 35696,469 35483,412.67 35226,397.49 35080,393.6"];
	layer2_expert12_12 -> layer2_moe_agg_gpu12	[pos="e,35070,396.97 35888,471.66 35885,470.69 35882,469.8 35878,469 35730,431.36 35291,407.21 35080,397.44"];
	layer2_expert12_13 -> layer2_moe_agg_gpu12	[pos="e,35070,395.25 36071,471.6 36068,470.65 36065,469.77 36062,469 35878,423.72 35323,402.76 35080,395.55"];
	layer2_expert12_14 -> layer2_moe_agg_gpu12	[pos="e,35070,394.02 36254,471.56 36251,470.62 36248,469.76 36244,469 36025,416.06 35353,399.02 35080,394.2"];
	layer2_expert12_15 -> layer2_moe_agg_gpu12	[pos="e,35070,393.09 36437,471.53 36434,470.6 36431,469.75 36428,469 36172,408.33 35379,395.76 35080,393.17"];
	layer2_output_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU12
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 12",
		pos="34520,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu12 -> layer2_output_gpu12	[pos="e,34572,142.15 34899,349.87 34814,295.75 34664,200.7 34580,147.62"];
	layer2_moe_agg_gpu12 -> layer2_allreduce_moe	[pos="e,33744,262.95 34857,379.39 34619,354.42 34038,293.73 33754,263.99"];
	layer2_qkv_gpu13	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU13
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 20-23
TP Slice: 5
GPU: 13",
		pos="34066,1255",
		shape=rectangle,
		width=2.9167];
	layer2_attn_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Multi-Head_Attention_GPU13
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 13",
		pos="34088,1128.5",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu13 -> layer2_attn_gpu13	[pos="e,34080,1170.2 34074,1205.9 34075,1197.5 34077,1188.8 34079,1180.3"];
	layer2_attn_proj_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU13
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 13",
		pos="34088,1017",
		shape=rectangle,
		width=2.9028];
	layer2_attn_gpu13 -> layer2_attn_proj_gpu13	[pos="e,34088,1051.3 34088,1086.7 34088,1078.5 34088,1069.9 34088,1061.6"];
	layer2_attn_norm_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU13
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 13",
		pos="34090,741",
		shape=rectangle,
		width=3.5139];
	layer2_attn_proj_gpu13 -> layer2_attn_norm_gpu13	[pos="e,34089,775.17 34088,982.95 34088,933.47 34089,840.12 34089,785.27"];
	layer2_attn_proj_gpu13 -> layer2_allreduce_attn	[pos="e,33783,913.64 33989,982.99 33930,963.03 33854,937.54 33792,916.91"];
	layer2_gate_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU13
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 13",
		pos="37984,629.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu13 -> layer2_gate_gpu13	[pos="e,37861,632.23 34216,708.18 34219,707.75 34222,707.36 34224,707 34408,683.05 37205,641.65 37851,632.38"];
	layer2_expert13_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="36702,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_0	[pos="e,36785,549.73 37861,626.1 37603,620.18 37012,601.75 36795,552.11",
		style=dashed];
	layer2_expert13_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="36886,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_1	[pos="e,36968,549.68 37861,624.44 37635,616.08 37159,594.29 36978,552.1",
		style=dashed];
	layer2_expert13_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="37068,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_2	[pos="e,37151,549.62 37861,622.05 37670,611.12 37306,586.96 37161,552.15",
		style=dashed];
	layer2_expert13_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="37252,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_3	[pos="e,37334,549.53 37861,624.77 37733,618.4 37526,601.17 37344,552.19",
		style=dashed];
	layer2_expert13_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="37434,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_4	[pos="e,37517,549.36 37861,616.58 37770,605.76 37644,586.52 37527,552.28",
		style=dashed];
	layer2_expert13_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="37618,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_5	[pos="e,37700,548.89 37861,598.69 37816,586.56 37764,571.48 37710,552.26",
		style=dashed];
	layer2_expert13_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="37800,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_6	[pos="e,37864,552.02 37920,587.91 37905,578.11 37888,567.56 37872,557.53",
		style=dashed];
	layer2_expert13_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="37984,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_7	[pos="e,37984,552.02 37984,587.91 37984,579.65 37984,570.86 37984,562.3",
		style=dashed];
	layer2_expert13_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="38166,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_8	[pos="e,38103,552.02 38047,587.91 38062,578.11 38079,567.56 38095,557.53",
		style=dashed];
	layer2_expert13_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="38350,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_9	[pos="e,38267,548.49 38106,598.37 38154,585.55 38209,569.51 38258,552 38258,551.97 38258,551.93 38258,551.9",
		style=dashed];
	layer2_expert13_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="38532,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_10	[pos="e,38450,549.01 38106,616.42 38196,605.52 38322,586.25 38440,551.94",
		style=dashed];
	layer2_expert13_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="38716,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_11	[pos="e,38633,549.2 38106,624.6 38234,618.1 38440,600.76 38623,551.85",
		style=dashed];
	layer2_expert13_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="38898,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_12	[pos="e,38816,549.3 38106,621.96 38297,610.93 38660,586.64 38806,551.83",
		style=dashed];
	layer2_expert13_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="39082,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_13	[pos="e,38999,549.37 38106,624.37 38331,615.9 38807,593.94 38989,551.78",
		style=dashed];
	layer2_expert13_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="39264,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_14	[pos="e,39182,549.42 38106,626.04 38363,619.99 38955,601.3 39172,551.73",
		style=dashed];
	layer2_expert13_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="39448,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu13 -> layer2_expert13_15	[pos="e,39365,549.45 38106,627.27 38392,623.51 39101,608.8 39355,551.76",
		style=dashed];
	layer2_moe_agg_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_MoE_Aggregate_GPU13
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 13",
		pos="37892,391.5",
		shape=rectangle,
		width=2.9444];
	layer2_expert13_0 -> layer2_moe_agg_gpu13	[pos="e,37785,395.2 36785,471.29 36788,470.46 36791,469.69 36794,469 36977,423.35 37532,402.59 37775,395.5"];
	layer2_expert13_1 -> layer2_moe_agg_gpu13	[pos="e,37785,396.92 36968,471.34 36971,470.49 36974,469.71 36976,469 37124,431.06 37564,407.06 37775,397.38"];
	layer2_expert13_2 -> layer2_moe_agg_gpu13	[pos="e,37785,393.21 37151,471.42 37154,470.55 37157,469.74 37160,469 37372,412.24 37629,397.21 37775,393.46"];
	layer2_expert13_3 -> layer2_moe_agg_gpu13	[pos="e,37785,398.45 37334,471.54 37337,470.64 37340,469.78 37342,469 37488,427.26 37663,407.91 37775,399.21"];
	layer2_expert13_4 -> layer2_moe_agg_gpu13	[pos="e,37785,408.52 37517,471.87 37520,470.87 37523,469.9 37526,469 37607,442.56 37703,423 37775,410.27"];
	layer2_expert13_5 -> layer2_moe_agg_gpu13	[pos="e,37793,433.18 37700,472.56 37703,471.35 37706,470.16 37708,469 37733,458.54 37759,447.48 37784,437.11"];
	layer2_expert13_6 -> layer2_moe_agg_gpu13	[pos="e,37860,433.02 37832,468.91 37839,459.92 37847,450.32 37854,441.05"];
	layer2_expert13_7 -> layer2_moe_agg_gpu13	[pos="e,37923,433.02 37952,468.91 37945,459.92 37937,450.32 37930,441.05"];
	layer2_expert13_8 -> layer2_moe_agg_gpu13	[pos="e,37989,433.05 38084,473 38081,471.64 38078,470.31 38074,469 38050,458.53 38024,447.42 37999,437.01"];
	layer2_expert13_9 -> layer2_moe_agg_gpu13	[pos="e,37998,408.63 38267,472.15 38264,471.04 38261,469.99 38258,469 38176,442.73 38080,423.16 38008,410.39"];
	layer2_expert13_10 -> layer2_moe_agg_gpu13	[pos="e,37998,398.57 38450,471.88 38447,470.85 38444,469.88 38440,469 38294,427.55 38120,408.14 38008,399.34"];
	layer2_expert13_11 -> layer2_moe_agg_gpu13	[pos="e,37998,393.34 38633,471.74 38630,470.75 38627,469.83 38624,469 38411,412.67 38154,397.49 38008,393.6"];
	layer2_expert13_12 -> layer2_moe_agg_gpu13	[pos="e,37998,396.97 38816,471.66 38813,470.69 38810,469.8 38806,469 38658,431.36 38219,407.21 38008,397.44"];
	layer2_expert13_13 -> layer2_moe_agg_gpu13	[pos="e,37998,395.25 38999,471.6 38996,470.65 38993,469.77 38990,469 38806,423.72 38251,402.76 38008,395.55"];
	layer2_expert13_14 -> layer2_moe_agg_gpu13	[pos="e,37998,394.02 39182,471.56 39179,470.62 39176,469.76 39172,469 38953,416.06 38281,399.02 38008,394.2"];
	layer2_expert13_15 -> layer2_moe_agg_gpu13	[pos="e,37998,393.09 39365,471.53 39362,470.6 39359,469.75 39356,469 39100,408.33 38307,395.76 38008,393.17"];
	layer2_output_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU13
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 13",
		pos="36634,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu13 -> layer2_output_gpu13	[pos="e,36760,137.34 37785,366.74 37558,315.79 37023,196.09 36770,139.57"];
	layer2_moe_agg_gpu13 -> layer2_allreduce_moe	[pos="e,33774,253.07 37785,386.96 37217,367.99 34529,278.28 33784,253.41"];
	layer2_qkv_gpu14	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU14
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 24-27
TP Slice: 6
GPU: 14",
		pos="34330,1255",
		shape=rectangle,
		width=2.9167];
	layer2_attn_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Multi-Head_Attention_GPU14
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 14",
		pos="34358,1128.5",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu14 -> layer2_attn_gpu14	[pos="e,34349,1170.2 34341,1205.9 34343,1197.4 34345,1188.6 34347,1180.1"];
	layer2_attn_proj_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU14
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 14",
		pos="34358,1017",
		shape=rectangle,
		width=2.9028];
	layer2_attn_gpu14 -> layer2_attn_proj_gpu14	[pos="e,34358,1051.3 34358,1086.7 34358,1078.5 34358,1069.9 34358,1061.6"];
	layer2_attn_norm_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU14
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 14",
		pos="34360,741",
		shape=rectangle,
		width=3.5139];
	layer2_attn_proj_gpu14 -> layer2_attn_norm_gpu14	[pos="e,34360,775.17 34358,982.95 34358,933.47 34359,840.12 34360,785.27"];
	layer2_attn_proj_gpu14 -> layer2_allreduce_attn	[pos="e,33809,904.75 34253,993.83 34235,990.18 34217,986.46 34200,983 34071,956.55 33923,927.27 33819,906.71"];
	layer2_gate_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU14
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 14",
		pos="40912,629.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu14 -> layer2_gate_gpu14	[pos="e,40789,632.47 34487,708.14 34490,707.73 34493,707.35 34496,707 34895,656.93 37712,675.91 38114,671 39140,658.47 40378,639.04 40779,\
632.63"];
	layer2_expert14_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="39630,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_0	[pos="e,39713,549.73 40789,626.1 40531,620.18 39940,601.75 39723,552.11",
		style=dashed];
	layer2_expert14_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="39814,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_1	[pos="e,39896,549.68 40789,624.44 40563,616.08 40087,594.29 39906,552.1",
		style=dashed];
	layer2_expert14_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="39996,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_2	[pos="e,40079,549.62 40789,622.05 40598,611.12 40234,586.96 40089,552.15",
		style=dashed];
	layer2_expert14_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="40180,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_3	[pos="e,40262,549.53 40789,624.77 40661,618.4 40454,601.17 40272,552.19",
		style=dashed];
	layer2_expert14_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="40362,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_4	[pos="e,40445,549.36 40789,616.58 40698,605.76 40572,586.52 40455,552.28",
		style=dashed];
	layer2_expert14_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="40546,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_5	[pos="e,40628,548.89 40789,598.69 40744,586.56 40692,571.48 40638,552.26",
		style=dashed];
	layer2_expert14_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="40728,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_6	[pos="e,40792,552.02 40848,587.91 40833,578.11 40816,567.56 40800,557.53",
		style=dashed];
	layer2_expert14_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="40912,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_7	[pos="e,40912,552.02 40912,587.91 40912,579.65 40912,570.86 40912,562.3",
		style=dashed];
	layer2_expert14_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="41094,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_8	[pos="e,41031,552.02 40975,587.91 40990,578.11 41007,567.56 41023,557.53",
		style=dashed];
	layer2_expert14_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="41278,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_9	[pos="e,41195,548.49 41034,598.37 41082,585.55 41137,569.51 41186,552 41186,551.97 41186,551.93 41186,551.9",
		style=dashed];
	layer2_expert14_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="41460,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_10	[pos="e,41378,549.01 41034,616.42 41124,605.52 41250,586.25 41368,551.94",
		style=dashed];
	layer2_expert14_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="41644,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_11	[pos="e,41561,549.2 41034,624.6 41162,618.1 41368,600.76 41551,551.85",
		style=dashed];
	layer2_expert14_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="41826,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_12	[pos="e,41744,549.3 41034,621.96 41225,610.93 41588,586.64 41734,551.83",
		style=dashed];
	layer2_expert14_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="42010,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_13	[pos="e,41927,549.37 41034,624.37 41259,615.9 41735,593.94 41917,551.78",
		style=dashed];
	layer2_expert14_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="42192,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_14	[pos="e,42110,549.42 41034,626.04 41291,619.99 41883,601.3 42100,551.73",
		style=dashed];
	layer2_expert14_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="42376,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu14 -> layer2_expert14_15	[pos="e,42293,549.45 41034,627.27 41320,623.51 42029,608.8 42283,551.76",
		style=dashed];
	layer2_moe_agg_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_MoE_Aggregate_GPU14
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 14",
		pos="40820,391.5",
		shape=rectangle,
		width=2.9444];
	layer2_expert14_0 -> layer2_moe_agg_gpu14	[pos="e,40713,395.2 39713,471.29 39716,470.46 39719,469.69 39722,469 39905,423.35 40460,402.59 40703,395.5"];
	layer2_expert14_1 -> layer2_moe_agg_gpu14	[pos="e,40713,396.92 39896,471.34 39899,470.49 39902,469.71 39904,469 40052,431.06 40492,407.06 40703,397.38"];
	layer2_expert14_2 -> layer2_moe_agg_gpu14	[pos="e,40713,393.21 40079,471.42 40082,470.55 40085,469.74 40088,469 40300,412.24 40557,397.21 40703,393.46"];
	layer2_expert14_3 -> layer2_moe_agg_gpu14	[pos="e,40713,398.45 40262,471.54 40265,470.64 40268,469.78 40270,469 40416,427.26 40591,407.91 40703,399.21"];
	layer2_expert14_4 -> layer2_moe_agg_gpu14	[pos="e,40713,408.52 40445,471.87 40448,470.87 40451,469.9 40454,469 40535,442.56 40631,423 40703,410.27"];
	layer2_expert14_5 -> layer2_moe_agg_gpu14	[pos="e,40721,433.18 40628,472.56 40631,471.35 40634,470.16 40636,469 40661,458.54 40687,447.48 40712,437.11"];
	layer2_expert14_6 -> layer2_moe_agg_gpu14	[pos="e,40788,433.02 40760,468.91 40767,459.92 40775,450.32 40782,441.05"];
	layer2_expert14_7 -> layer2_moe_agg_gpu14	[pos="e,40851,433.02 40880,468.91 40873,459.92 40865,450.32 40858,441.05"];
	layer2_expert14_8 -> layer2_moe_agg_gpu14	[pos="e,40917,433.05 41012,473 41009,471.64 41006,470.31 41002,469 40978,458.53 40952,447.42 40927,437.01"];
	layer2_expert14_9 -> layer2_moe_agg_gpu14	[pos="e,40926,408.63 41195,472.15 41192,471.04 41189,469.99 41186,469 41104,442.73 41008,423.16 40936,410.39"];
	layer2_expert14_10 -> layer2_moe_agg_gpu14	[pos="e,40926,398.57 41378,471.88 41375,470.85 41372,469.88 41368,469 41222,427.55 41048,408.14 40936,399.34"];
	layer2_expert14_11 -> layer2_moe_agg_gpu14	[pos="e,40926,393.34 41561,471.74 41558,470.75 41555,469.83 41552,469 41339,412.67 41082,397.49 40936,393.6"];
	layer2_expert14_12 -> layer2_moe_agg_gpu14	[pos="e,40926,396.97 41744,471.66 41741,470.69 41738,469.8 41734,469 41586,431.36 41147,407.21 40936,397.44"];
	layer2_expert14_13 -> layer2_moe_agg_gpu14	[pos="e,40926,395.25 41927,471.6 41924,470.65 41921,469.77 41918,469 41734,423.72 41179,402.76 40936,395.55"];
	layer2_expert14_14 -> layer2_moe_agg_gpu14	[pos="e,40926,394.02 42110,471.56 42107,470.62 42104,469.76 42100,469 41881,416.06 41209,399.02 40936,394.2"];
	layer2_expert14_15 -> layer2_moe_agg_gpu14	[pos="e,40926,393.09 42293,471.53 42290,470.6 42287,469.75 42284,469 42028,408.33 41235,395.76 40936,393.17"];
	layer2_output_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU14
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 14",
		pos="39038,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu14 -> layer2_output_gpu14	[pos="e,39165,129 40713,373.73 40406,325.21 39517,184.67 39175,130.57"];
	layer2_moe_agg_gpu14 -> layer2_allreduce_moe	[pos="e,33781,250.75 40713,388.4 39916,372.57 34862,272.22 33791,250.96"];
	layer2_qkv_gpu15	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU15
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 28-31
TP Slice: 7
GPU: 15",
		pos="34598,1255",
		shape=rectangle,
		width=2.9167];
	layer2_attn_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Multi-Head_Attention_GPU15
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 15",
		pos="34628,1128.5",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu15 -> layer2_attn_gpu15	[pos="e,34618,1170.2 34609,1205.9 34611,1197.4 34613,1188.6 34615,1180.1"];
	layer2_attn_proj_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU15
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 15",
		pos="34628,1017",
		shape=rectangle,
		width=2.9028];
	layer2_attn_gpu15 -> layer2_attn_proj_gpu15	[pos="e,34628,1051.3 34628,1086.7 34628,1078.5 34628,1069.9 34628,1061.6"];
	layer2_attn_norm_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU15
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 15",
		pos="34632,741",
		shape=rectangle,
		width=3.5139];
	layer2_attn_proj_gpu15 -> layer2_attn_norm_gpu15	[pos="e,34631,775.17 34628,982.95 34629,933.47 34630,840.12 34631,785.27"];
	layer2_attn_proj_gpu15 -> layer2_allreduce_attn	[pos="e,33834,896.3 34523,992.86 34506,989.33 34488,985.9 34470,983 34255,946.31 34004,915.56 33844,897.47"];
	layer2_gate_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU15
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 15",
		pos="43840,629.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu15 -> layer2_gate_gpu15	[pos="e,43717,632.43 34758,738.81 35416,732.61 38510,702.96 41042,671 42068,658.05 43306,638.9 43707,632.59"];
	layer2_expert15_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="42558,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_0	[pos="e,42641,549.73 43717,626.1 43459,620.18 42868,601.75 42651,552.11",
		style=dashed];
	layer2_expert15_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="42742,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_1	[pos="e,42824,549.68 43717,624.44 43491,616.08 43015,594.29 42834,552.1",
		style=dashed];
	layer2_expert15_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="42924,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_2	[pos="e,43007,549.62 43717,622.05 43526,611.12 43162,586.96 43017,552.15",
		style=dashed];
	layer2_expert15_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="43108,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_3	[pos="e,43190,549.53 43717,624.77 43589,618.4 43382,601.17 43200,552.19",
		style=dashed];
	layer2_expert15_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="43290,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_4	[pos="e,43373,549.36 43717,616.58 43626,605.76 43500,586.52 43383,552.28",
		style=dashed];
	layer2_expert15_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="43474,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_5	[pos="e,43556,548.89 43717,598.69 43672,586.56 43620,571.48 43566,552.26",
		style=dashed];
	layer2_expert15_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="43656,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_6	[pos="e,43720,552.02 43776,587.91 43761,578.11 43744,567.56 43728,557.53",
		style=dashed];
	layer2_expert15_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="43840,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_7	[pos="e,43840,552.02 43840,587.91 43840,579.65 43840,570.86 43840,562.3",
		style=dashed];
	layer2_expert15_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="44022,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_8	[pos="e,43959,552.02 43903,587.91 43918,578.11 43935,567.56 43951,557.53",
		style=dashed];
	layer2_expert15_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="44206,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_9	[pos="e,44123,548.49 43962,598.37 44010,585.55 44065,569.51 44114,552 44114,551.97 44114,551.93 44114,551.9",
		style=dashed];
	layer2_expert15_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="44388,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_10	[pos="e,44306,549.01 43962,616.42 44052,605.52 44178,586.25 44296,551.94",
		style=dashed];
	layer2_expert15_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="44572,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_11	[pos="e,44489,549.2 43962,624.6 44090,618.1 44296,600.76 44479,551.85",
		style=dashed];
	layer2_expert15_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="44754,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_12	[pos="e,44672,549.3 43962,621.96 44153,610.93 44516,586.64 44662,551.83",
		style=dashed];
	layer2_expert15_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="44938,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_13	[pos="e,44855,549.37 43962,624.37 44187,615.9 44663,593.94 44845,551.78",
		style=dashed];
	layer2_expert15_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="45120,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_14	[pos="e,45038,549.42 43962,626.04 44219,619.99 44811,601.3 45028,551.73",
		style=dashed];
	layer2_expert15_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="45304,510.5",
		shape=rectangle,
		width=2.2917];
	layer2_gate_gpu15 -> layer2_expert15_15	[pos="e,45221,549.45 43962,627.27 44248,623.51 44957,608.8 45211,551.76",
		style=dashed];
	layer2_moe_agg_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_MoE_Aggregate_GPU15
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 15",
		pos="43748,391.5",
		shape=rectangle,
		width=2.9444];
	layer2_expert15_0 -> layer2_moe_agg_gpu15	[pos="e,43641,395.2 42641,471.29 42644,470.46 42647,469.69 42650,469 42833,423.35 43388,402.59 43631,395.5"];
	layer2_expert15_1 -> layer2_moe_agg_gpu15	[pos="e,43641,396.92 42824,471.34 42827,470.49 42830,469.71 42832,469 42980,431.06 43420,407.06 43631,397.38"];
	layer2_expert15_2 -> layer2_moe_agg_gpu15	[pos="e,43641,393.21 43007,471.42 43010,470.55 43013,469.74 43016,469 43228,412.24 43485,397.21 43631,393.46"];
	layer2_expert15_3 -> layer2_moe_agg_gpu15	[pos="e,43641,398.45 43190,471.54 43193,470.64 43196,469.78 43198,469 43344,427.26 43519,407.91 43631,399.21"];
	layer2_expert15_4 -> layer2_moe_agg_gpu15	[pos="e,43641,408.52 43373,471.87 43376,470.87 43379,469.9 43382,469 43463,442.56 43559,423 43631,410.27"];
	layer2_expert15_5 -> layer2_moe_agg_gpu15	[pos="e,43649,433.18 43556,472.56 43559,471.35 43562,470.16 43564,469 43589,458.54 43615,447.48 43640,437.11"];
	layer2_expert15_6 -> layer2_moe_agg_gpu15	[pos="e,43716,433.02 43688,468.91 43695,459.92 43703,450.32 43710,441.05"];
	layer2_expert15_7 -> layer2_moe_agg_gpu15	[pos="e,43779,433.02 43808,468.91 43801,459.92 43793,450.32 43786,441.05"];
	layer2_expert15_8 -> layer2_moe_agg_gpu15	[pos="e,43845,433.05 43940,473 43937,471.64 43934,470.31 43930,469 43906,458.53 43880,447.42 43855,437.01"];
	layer2_expert15_9 -> layer2_moe_agg_gpu15	[pos="e,43854,408.63 44123,472.15 44120,471.04 44117,469.99 44114,469 44032,442.73 43936,423.16 43864,410.39"];
	layer2_expert15_10 -> layer2_moe_agg_gpu15	[pos="e,43854,398.57 44306,471.88 44303,470.85 44300,469.88 44296,469 44150,427.55 43976,408.14 43864,399.34"];
	layer2_expert15_11 -> layer2_moe_agg_gpu15	[pos="e,43854,393.34 44489,471.74 44486,470.75 44483,469.83 44480,469 44267,412.67 44010,397.49 43864,393.6"];
	layer2_expert15_12 -> layer2_moe_agg_gpu15	[pos="e,43854,396.97 44672,471.66 44669,470.69 44666,469.8 44662,469 44514,431.36 44075,407.21 43864,397.44"];
	layer2_expert15_13 -> layer2_moe_agg_gpu15	[pos="e,43854,395.25 44855,471.6 44852,470.65 44849,469.77 44846,469 44662,423.72 44107,402.76 43864,395.55"];
	layer2_expert15_14 -> layer2_moe_agg_gpu15	[pos="e,43854,394.02 45038,471.56 45035,470.62 45032,469.76 45028,469 44809,416.06 44137,399.02 43864,394.2"];
	layer2_expert15_15 -> layer2_moe_agg_gpu15	[pos="e,43854,393.09 45221,471.53 45218,470.6 45215,469.75 45212,469 44956,408.33 44163,395.76 43864,393.17"];
	layer2_output_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU15
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 15",
		pos="40376,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu15 -> layer2_output_gpu15	[pos="e,40503,119.57 43641,381.61 43146,340.25 41068,166.73 40513,120.41"];
	layer2_moe_agg_gpu15 -> layer2_allreduce_moe	[pos="e,33784,249.67 43641,388.96 43270,383.56 41991,365.01 40934,350 38102,309.74 34655,261.78 33794,249.81"];
	layer2_allreduce_attn -> layer2_attn_norm_gpu8	[pos="e,32870,773.29 33526,863.5 33365,847.39 33109,818.09 32880,775.15"];
	layer2_allreduce_attn -> layer2_attn_norm_gpu9	[pos="e,33132,773.06 33550,855.14 33443,836 33287,807.07 33142,775.25"];
	layer2_allreduce_attn -> layer2_attn_norm_gpu10	[pos="e,33375,775.04 33582,844.47 33522,824.39 33446,798.85 33385,778.29"];
	layer2_allreduce_attn -> layer2_attn_norm_gpu11	[pos="e,33581,775.35 33632,827.36 33618,812.57 33602,796.6 33588,782.52"];
	layer2_allreduce_attn -> layer2_attn_norm_gpu12	[pos="e,33785,775.13 33733,827.75 33748,812.8 33764,796.62 33778,782.38"];
	layer2_allreduce_attn -> layer2_attn_norm_gpu13	[pos="e,33991,775.04 33783,844.47 33843,824.39 33919,798.85 33981,778.29"];
	layer2_allreduce_attn -> layer2_attn_norm_gpu14	[pos="e,34234,772.95 33814,854.92 33922,835.6 34078,806.52 34224,775.12"];
	layer2_allreduce_attn -> layer2_attn_norm_gpu15	[pos="e,34505,773.21 33839,863.41 34001,847.12 34261,817.58 34495,775.05"];
	layer2_allreduce_moe -> layer2_output_gpu8	[pos="e,26697,111.37 33402,241.33 32383,221.58 27570,128.29 26707,111.57"];
	layer2_allreduce_moe -> layer2_output_gpu9	[pos="e,30298,113.86 33413,237.88 32806,213.75 30838,135.38 30308,114.28"];
	layer2_allreduce_moe -> layer2_output_gpu10	[pos="e,32239,120.65 33434,230.54 33143,203.76 32524,146.86 32249,121.57"];
	layer2_allreduce_moe -> layer2_output_gpu11	[pos="e,33309,142.03 33495,209.98 33441,190.19 33373,165.48 33318,145.46"];
	layer2_allreduce_moe -> layer2_output_gpu12	[pos="e,34393,127.57 33731,224.6 33907,198.81 34208,154.67 34383,129.05"];
	layer2_allreduce_moe -> layer2_output_gpu13	[pos="e,36507,114.66 33768,237.1 34320,212.43 36004,137.13 36497,115.11"];
	layer2_allreduce_moe -> layer2_output_gpu14	[pos="e,38912,112.16 33778,240.35 34632,219.03 38161,130.92 38902,112.42"];
	layer2_allreduce_moe -> layer2_output_gpu15	[pos="e,40250,112.85 33783,242.09 34496,231.13 37060,190.49 39174,142 39560,133.13 40016,119.84 40240,113.16"];
	layer3_qkv_gpu8	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU8
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 0-3
TP Slice: 0
GPU: 8",
		pos="56192,2859",
		shape=rectangle,
		width=2.9167];
	layer3_attn_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Multi-Head_Attention_GPU8
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 8",
		pos="56192,2725",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu8 -> layer3_attn_gpu8	[pos="e,56192,2766.8 56192,2810 56192,2799.2 56192,2787.8 56192,2777"];
	layer3_attn_proj_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU8
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 8",
		pos="56192,2598.5",
		shape=rectangle,
		width=2.7778];
	layer3_attn_gpu8 -> layer3_attn_proj_gpu8	[pos="e,56192,2632.9 56192,2683.2 56192,2670.4 56192,2656.1 56192,2643"];
	layer3_attn_norm_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU8
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 8",
		pos="56192,2281",
		shape=rectangle,
		width=3.3889];
	layer3_attn_proj_gpu8 -> layer3_attn_norm_gpu8	[pos="e,56192,2315.2 56192,2564.3 56192,2506.9 56192,2389.1 56192,2325.3"];
	layer3_allreduce_attn	[height=1.8889,
		label="L3_All-Reduce_Attention
Input: 8Ã—[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce",
		pos="57032,2453",
		width=5.6389];
	layer3_attn_proj_gpu8 -> layer3_allreduce_attn	[pos="e,56883,2471.5 56293,2569.3 56310,2564.9 56328,2560.6 56346,2557 56525,2519.8 56734,2490.4 56874,2472.7"];
	layer3_gate_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU8
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 8",
		pos="46970,2135.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu8 -> layer3_gate_gpu8	[pos="e,47093,2138.4 56069,2278.1 55063,2262.4 48149,2154.8 47103,2138.6"];
	layer3_expert8_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="45506,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_0	[pos="e,45589,2055.8 46848,2133.3 46562,2129.7 45852,2115.3 45599,2058.1",
		style=dashed];
	layer3_expert8_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="45690,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_1	[pos="e,45772,2055.7 46848,2132.1 46590,2126.2 45999,2107.8 45782,2058.1",
		style=dashed];
	layer3_expert8_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="45872,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_2	[pos="e,45955,2055.7 46848,2130.4 46622,2122.1 46146,2100.3 45965,2058.1",
		style=dashed];
	layer3_expert8_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="46056,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_3	[pos="e,46138,2055.6 46848,2128 46657,2117.1 46293,2093 46148,2058.1",
		style=dashed];
	layer3_expert8_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="46238,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_4	[pos="e,46321,2055.5 46848,2130.8 46720,2124.4 46513,2107.2 46331,2058.2",
		style=dashed];
	layer3_expert8_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="46422,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_5	[pos="e,46504,2055.4 46848,2122.6 46757,2111.8 46631,2092.5 46514,2058.3",
		style=dashed];
	layer3_expert8_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="46604,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_6	[pos="e,46687,2054.9 46848,2104.7 46803,2092.6 46751,2077.5 46697,2058.3",
		style=dashed];
	layer3_expert8_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="46788,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_7	[pos="e,46851,2058 46907,2093.9 46892,2084.1 46875,2073.6 46859,2063.5",
		style=dashed];
	layer3_expert8_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="46970,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_8	[pos="e,46970,2058 46970,2093.9 46970,2085.6 46970,2076.9 46970,2068.3",
		style=dashed];
	layer3_expert8_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="47154,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_9	[pos="e,47090,2058 47034,2093.9 47049,2084.1 47066,2073.6 47082,2063.5",
		style=dashed];
	layer3_expert8_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="47336,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_10	[pos="e,47254,2054.9 47093,2104.7 47138,2092.6 47190,2077.5 47244,2058.3",
		style=dashed];
	layer3_expert8_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="47520,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_11	[pos="e,47437,2055.4 47093,2122.6 47184,2111.8 47310,2092.5 47427,2058.3",
		style=dashed];
	layer3_expert8_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="47702,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_12	[pos="e,47620,2055.5 47093,2130.8 47221,2124.4 47428,2107.2 47610,2058.2",
		style=dashed];
	layer3_expert8_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="47886,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_13	[pos="e,47803,2055.6 47093,2128 47284,2117.1 47648,2093 47793,2058.1",
		style=dashed];
	layer3_expert8_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="48068,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_14	[pos="e,47986,2055.7 47093,2130.4 47319,2122.1 47795,2100.3 47976,2058.1",
		style=dashed];
	layer3_expert8_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU8
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 8",
		pos="48252,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu8 -> layer3_expert8_15	[pos="e,48169,2055.7 47093,2132.1 47351,2126.2 47942,2107.8 48159,2058.1",
		style=dashed];
	layer3_moe_agg_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_MoE_Aggregate_GPU8
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 8",
		pos="47062,1897.5",
		shape=rectangle,
		width=2.8194];
	layer3_expert8_0 -> layer3_moe_agg_gpu8	[pos="e,46961,1899 45589,1977.2 45592,1976.4 45595,1975.7 45598,1975 45854,1913.5 46654,1901.4 46951,1899.1"];
	layer3_expert8_1 -> layer3_moe_agg_gpu8	[pos="e,46961,1899.9 45772,1977.3 45775,1976.4 45778,1975.7 45780,1975 46001,1921.3 46681,1904.6 46951,1900.1"];
	layer3_expert8_2 -> layer3_moe_agg_gpu8	[pos="e,46961,1901.1 45955,1977.3 45958,1976.5 45961,1975.7 45964,1975 46148,1929 46709,1908.3 46950,1901.4"];
	layer3_expert8_3 -> layer3_moe_agg_gpu8	[pos="e,46961,1902.7 46138,1977.3 46141,1976.5 46144,1975.7 46146,1975 46296,1936.7 46741,1912.7 46951,1903.2"];
	layer3_expert8_4 -> layer3_moe_agg_gpu8	[pos="e,46961,1899.1 46321,1977.4 46324,1976.5 46327,1975.7 46330,1975 46544,1917.6 46805,1902.9 46951,1899.3"];
	layer3_expert8_5 -> layer3_moe_agg_gpu8	[pos="e,46961,1904.1 46504,1977.5 46507,1976.6 46510,1975.8 46512,1975 46661,1932.6 46838,1913.3 46951,1904.8"];
	layer3_expert8_6 -> layer3_moe_agg_gpu8	[pos="e,46961,1913.7 46687,1977.9 46690,1976.9 46693,1975.9 46696,1975 46779,1947.9 46877,1928.1 46951,1915.4"];
	layer3_expert8_7 -> layer3_moe_agg_gpu8	[pos="e,46963,1939.1 46870,1978.6 46873,1977.3 46876,1976.2 46878,1975 46903,1964.5 46929,1953.4 46954,1943.1"];
	layer3_expert8_8 -> layer3_moe_agg_gpu8	[pos="e,47031,1939 47002,1974.9 47009,1965.9 47017,1956.3 47024,1947.1"];
	layer3_expert8_9 -> layer3_moe_agg_gpu8	[pos="e,47094,1939 47122,1974.9 47115,1965.9 47107,1956.3 47100,1947.1"];
	layer3_expert8_10 -> layer3_moe_agg_gpu8	[pos="e,47161,1939.2 47254,1978.6 47251,1977.4 47248,1976.2 47246,1975 47221,1964.5 47195,1953.5 47170,1943.1"];
	layer3_expert8_11 -> layer3_moe_agg_gpu8	[pos="e,47164,1913.8 47437,1977.9 47434,1976.9 47431,1975.9 47428,1975 47345,1948 47248,1928.2 47174,1915.5"];
	layer3_expert8_12 -> layer3_moe_agg_gpu8	[pos="e,47164,1904.1 47620,1977.5 47617,1976.6 47614,1975.8 47612,1975 47464,1932.7 47286,1913.4 47174,1904.9"];
	layer3_expert8_13 -> layer3_moe_agg_gpu8	[pos="e,47164,1899.1 47803,1977.4 47800,1976.5 47797,1975.7 47794,1975 47580,1917.6 47320,1902.9 47174,1899.3"];
	layer3_expert8_14 -> layer3_moe_agg_gpu8	[pos="e,47164,1902.7 47986,1977.3 47983,1976.5 47980,1975.7 47978,1975 47828,1936.8 47384,1912.7 47174,1903.2"];
	layer3_expert8_15 -> layer3_moe_agg_gpu8	[pos="e,47164,1901.1 48169,1977.3 48166,1976.5 48163,1975.7 48160,1975 47976,1929.1 47415,1908.3 47175,1901.4"];
	layer3_output_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU8
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 8",
		pos="56204,1580",
		shape=rectangle,
		width=3.3889];
	layer3_moe_agg_gpu8 -> layer3_output_gpu8	[pos="e,56082,1582.2 47164,1890.3 47633,1861.8 49638,1742.6 51284,1684 53185,1616.3 55500,1588.5 56072,1582.3"];
	layer3_allreduce_moe	[height=1.8889,
		label="L3_All-Reduce_MoE
Input: 8Ã—[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce",
		pos="57130,1752",
		width=5.6389];
	layer3_moe_agg_gpu8 -> layer3_allreduce_moe	[pos="e,56938,1755.7 47164,1895 47531,1889.7 48818,1871.2 49880,1856 52673,1816.1 56073,1768 56928,1755.9"];
	output	[fillcolor=lightblue,
		height=1.041,
		label="OUTPUT
Input: [batch_size=1024, seq_len=2048, hidden=4096]
GPU: 8-15",
		pos="57140,1408",
		shape=ellipse,
		width=8.1121];
	layer3_output_gpu8 -> output	[pos="e,56865,1420.7 56259,1545.9 56282,1533.4 56309,1520.2 56336,1512 56503,1460.1 56698,1434.3 56854,1421.5"];
	layer3_qkv_gpu9	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU9
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 4-7
TP Slice: 1
GPU: 9",
		pos="56454,2859",
		shape=rectangle,
		width=2.9167];
	layer3_attn_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Multi-Head_Attention_GPU9
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 9",
		pos="56454,2725",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu9 -> layer3_attn_gpu9	[pos="e,56454,2766.8 56454,2810 56454,2799.2 56454,2787.8 56454,2777"];
	layer3_attn_proj_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU9
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 9",
		pos="56454,2598.5",
		shape=rectangle,
		width=2.7778];
	layer3_attn_gpu9 -> layer3_attn_proj_gpu9	[pos="e,56454,2632.9 56454,2683.2 56454,2670.4 56454,2656.1 56454,2643"];
	layer3_attn_norm_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU9
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 9",
		pos="56454,2281",
		shape=rectangle,
		width=3.3889];
	layer3_attn_proj_gpu9 -> layer3_attn_norm_gpu9	[pos="e,56454,2315.2 56454,2564.3 56454,2506.9 56454,2389.1 56454,2325.3"];
	layer3_attn_proj_gpu9 -> layer3_allreduce_attn	[pos="e,56914,2481.8 56555,2570.6 56572,2566 56590,2561.3 56608,2557 56707,2531.7 56820,2504.3 56904,2484.1"];
	layer3_gate_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU9
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 9",
		pos="49898,2135.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu9 -> layer3_gate_gpu9	[pos="e,50021,2138.5 56402,2246.9 56379,2233.6 56350,2219.9 56322,2213 56225,2188.9 52796,2178.2 52696,2177 51670,2164.5 50432,2145 50031,\
2138.6"];
	layer3_expert9_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="48434,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_0	[pos="e,48517,2055.5 49776,2133.3 49490,2129.5 48781,2114.8 48527,2057.8",
		style=dashed];
	layer3_expert9_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="48618,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_1	[pos="e,48700,2055.4 49776,2132 49519,2126 48927,2107.3 48710,2057.7",
		style=dashed];
	layer3_expert9_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="48800,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_2	[pos="e,48883,2055.4 49776,2130.4 49551,2121.9 49075,2099.9 48893,2057.8",
		style=dashed];
	layer3_expert9_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="48984,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_3	[pos="e,49066,2055.3 49776,2128 49585,2116.9 49222,2092.6 49076,2057.8",
		style=dashed];
	layer3_expert9_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="49166,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_4	[pos="e,49249,2055.2 49776,2130.6 49648,2124.1 49442,2106.8 49259,2057.9",
		style=dashed];
	layer3_expert9_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="49350,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_5	[pos="e,49432,2055 49776,2122.4 49686,2111.5 49560,2092.2 49442,2057.9",
		style=dashed];
	layer3_expert9_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="49532,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_6	[pos="e,49615,2054.5 49776,2104.4 49728,2091.5 49673,2075.5 49624,2058 49624,2058 49624,2057.9 49624,2057.9",
		style=dashed];
	layer3_expert9_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="49716,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_7	[pos="e,49779,2058 49835,2093.9 49820,2084.1 49803,2073.6 49787,2063.5",
		style=dashed];
	layer3_expert9_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="49898,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_8	[pos="e,49898,2058 49898,2093.9 49898,2085.6 49898,2076.9 49898,2068.3",
		style=dashed];
	layer3_expert9_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="50082,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_9	[pos="e,50018,2058 49962,2093.9 49977,2084.1 49994,2073.6 50010,2063.5",
		style=dashed];
	layer3_expert9_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="50264,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_10	[pos="e,50182,2054.9 50021,2104.7 50066,2092.6 50118,2077.5 50172,2058.3",
		style=dashed];
	layer3_expert9_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="50448,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_11	[pos="e,50365,2055.4 50021,2122.6 50112,2111.8 50238,2092.5 50355,2058.3",
		style=dashed];
	layer3_expert9_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="50630,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_12	[pos="e,50548,2055.5 50021,2130.8 50149,2124.4 50356,2107.2 50538,2058.2",
		style=dashed];
	layer3_expert9_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="50814,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_13	[pos="e,50731,2055.6 50021,2128 50212,2117.1 50576,2093 50721,2058.1",
		style=dashed];
	layer3_expert9_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="50996,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_14	[pos="e,50914,2055.7 50021,2130.4 50247,2122.1 50723,2100.3 50904,2058.1",
		style=dashed];
	layer3_expert9_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU9
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 9",
		pos="51180,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu9 -> layer3_expert9_15	[pos="e,51097,2055.7 50021,2132.1 50279,2126.2 50870,2107.8 51087,2058.1",
		style=dashed];
	layer3_moe_agg_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_MoE_Aggregate_GPU9
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 9",
		pos="49990,1897.5",
		shape=rectangle,
		width=2.8194];
	layer3_expert9_0 -> layer3_moe_agg_gpu9	[pos="e,49888,1899.1 48517,1977.5 48520,1976.6 48523,1975.7 48526,1975 48783,1914.1 49581,1901.7 49878,1899.1"];
	layer3_expert9_1 -> layer3_moe_agg_gpu9	[pos="e,49888,1899.9 48700,1977.6 48703,1976.6 48706,1975.8 48710,1975 48930,1921.8 49608,1904.8 49877,1900.1"];
	layer3_expert9_2 -> layer3_moe_agg_gpu9	[pos="e,49888,1901.1 48883,1977.6 48886,1976.6 48889,1975.8 48892,1975 49077,1929.5 49637,1908.5 49878,1901.4"];
	layer3_expert9_3 -> layer3_moe_agg_gpu9	[pos="e,49888,1902.8 49066,1977.7 49069,1976.7 49072,1975.8 49076,1975 49224,1937.1 49668,1912.9 49878,1903.2"];
	layer3_expert9_4 -> layer3_moe_agg_gpu9	[pos="e,49888,1899.3 49249,1977.7 49252,1976.7 49255,1975.8 49258,1975 49473,1918.2 49732,1903.2 49878,1899.5"];
	layer3_expert9_5 -> layer3_moe_agg_gpu9	[pos="e,49888,1904.3 49432,1977.9 49435,1976.8 49438,1975.9 49442,1975 49589,1933.1 49765,1913.7 49877,1905.1"];
	layer3_expert9_6 -> layer3_moe_agg_gpu9	[pos="e,49888,1914 49615,1978.2 49618,1977 49621,1976 49624,1975 49708,1948.3 49805,1928.5 49878,1915.7"];
	layer3_expert9_7 -> layer3_moe_agg_gpu9	[pos="e,49892,1939.1 49798,1979 49801,1977.6 49804,1976.3 49808,1975 49832,1964.6 49858,1953.5 49883,1943"];
	layer3_expert9_8 -> layer3_moe_agg_gpu9	[pos="e,49958,1939 49930,1974.9 49937,1965.9 49945,1956.3 49952,1947.1"];
	layer3_expert9_9 -> layer3_moe_agg_gpu9	[pos="e,50021,1939 50050,1974.9 50043,1965.9 50035,1956.3 50028,1947.1"];
	layer3_expert9_10 -> layer3_moe_agg_gpu9	[pos="e,50089,1939.1 50182,1978.6 50179,1977.3 50176,1976.2 50174,1975 50149,1964.5 50123,1953.4 50098,1943.1"];
	layer3_expert9_11 -> layer3_moe_agg_gpu9	[pos="e,50091,1913.7 50365,1977.9 50362,1976.9 50359,1975.9 50356,1975 50273,1947.9 50175,1928.1 50101,1915.4"];
	layer3_expert9_12 -> layer3_moe_agg_gpu9	[pos="e,50091,1904.1 50548,1977.5 50545,1976.6 50542,1975.8 50540,1975 50391,1932.6 50214,1913.3 50101,1904.8"];
	layer3_expert9_13 -> layer3_moe_agg_gpu9	[pos="e,50091,1899.1 50731,1977.4 50728,1976.5 50725,1975.7 50722,1975 50508,1917.6 50247,1902.9 50101,1899.3"];
	layer3_expert9_14 -> layer3_moe_agg_gpu9	[pos="e,50091,1902.7 50914,1977.3 50911,1976.5 50908,1975.7 50906,1975 50756,1936.7 50311,1912.7 50101,1903.2"];
	layer3_expert9_15 -> layer3_moe_agg_gpu9	[pos="e,50091,1901.1 51097,1977.3 51094,1976.5 51091,1975.7 51088,1975 50904,1929 50343,1908.3 50102,1901.4"];
	layer3_output_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU9
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 9",
		pos="56466,1580",
		shape=rectangle,
		width=3.3889];
	layer3_moe_agg_gpu9 -> layer3_output_gpu9	[pos="e,56415,1614.2 50091,1890.1 50558,1860.8 52547,1739 54180,1684 54299,1680 56219,1677 56336,1648 56360,1641.9 56385,1630.7 56406,\
1619.1"];
	layer3_moe_agg_gpu9 -> layer3_allreduce_moe	[pos="e,56942,1756.8 50091,1894.5 50868,1878.8 55867,1778.4 56931,1757"];
	layer3_output_gpu9 -> output	[pos="e,56932,1434.4 56523,1545.8 56546,1533.7 56573,1520.8 56598,1512 56702,1476.5 56822,1452.1 56922,1436"];
	layer3_qkv_gpu10	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU10
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 8-11
TP Slice: 2
GPU: 10",
		pos="56720,2859",
		shape=rectangle,
		width=2.9167];
	layer3_attn_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Multi-Head_Attention_GPU10
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 10",
		pos="56720,2725",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu10 -> layer3_attn_gpu10	[pos="e,56720,2766.8 56720,2810 56720,2799.2 56720,2787.8 56720,2777"];
	layer3_attn_proj_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU10
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 10",
		pos="56720,2598.5",
		shape=rectangle,
		width=2.9028];
	layer3_attn_gpu10 -> layer3_attn_proj_gpu10	[pos="e,56720,2632.9 56720,2683.2 56720,2670.4 56720,2656.1 56720,2643"];
	layer3_attn_norm_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU10
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 10",
		pos="56720,2281",
		shape=rectangle,
		width=3.5139];
	layer3_attn_proj_gpu10 -> layer3_attn_norm_gpu10	[pos="e,56720,2315.2 56720,2564.3 56720,2506.9 56720,2389.1 56720,2325.3"];
	layer3_attn_proj_gpu10 -> layer3_allreduce_attn	[pos="e,56947,2492.9 56792,2564.4 56836,2544.4 56891,2518.7 56938,2497.2"];
	layer3_gate_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU10
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 10",
		pos="52826,2135.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu10 -> layer3_gate_gpu10	[pos="e,52949,2138.3 56667,2246.9 56643,2233.7 56613,2220 56584,2213 56495,2191.1 53616,2148 52959,2138.4"];
	layer3_expert10_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="51362,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_0	[pos="e,51445,2055.5 52704,2133.3 52418,2129.5 51709,2114.8 51455,2057.8",
		style=dashed];
	layer3_expert10_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="51546,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_1	[pos="e,51628,2055.4 52704,2132 52447,2126 51855,2107.3 51638,2057.7",
		style=dashed];
	layer3_expert10_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="51728,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_2	[pos="e,51811,2055.4 52704,2130.4 52479,2121.9 52003,2099.9 51821,2057.8",
		style=dashed];
	layer3_expert10_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="51912,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_3	[pos="e,51994,2055.3 52704,2128 52513,2116.9 52150,2092.6 52004,2057.8",
		style=dashed];
	layer3_expert10_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="52094,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_4	[pos="e,52177,2055.2 52704,2130.6 52576,2124.1 52370,2106.8 52187,2057.9",
		style=dashed];
	layer3_expert10_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="52278,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_5	[pos="e,52360,2055 52704,2122.4 52614,2111.5 52488,2092.2 52370,2057.9",
		style=dashed];
	layer3_expert10_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="52460,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_6	[pos="e,52543,2054.5 52704,2104.4 52656,2091.5 52601,2075.5 52552,2058 52552,2058 52552,2057.9 52552,2057.9",
		style=dashed];
	layer3_expert10_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="52644,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_7	[pos="e,52707,2058 52763,2093.9 52748,2084.1 52731,2073.6 52715,2063.5",
		style=dashed];
	layer3_expert10_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="52826,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_8	[pos="e,52826,2058 52826,2093.9 52826,2085.6 52826,2076.9 52826,2068.3",
		style=dashed];
	layer3_expert10_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="53010,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_9	[pos="e,52946,2058 52890,2093.9 52905,2084.1 52922,2073.6 52938,2063.5",
		style=dashed];
	layer3_expert10_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="53192,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_10	[pos="e,53110,2054.9 52949,2104.7 52994,2092.6 53046,2077.5 53100,2058.3",
		style=dashed];
	layer3_expert10_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="53376,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_11	[pos="e,53293,2055.4 52949,2122.6 53040,2111.8 53166,2092.5 53283,2058.3",
		style=dashed];
	layer3_expert10_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="53558,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_12	[pos="e,53476,2055.5 52949,2130.8 53077,2124.4 53284,2107.2 53466,2058.2",
		style=dashed];
	layer3_expert10_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="53742,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_13	[pos="e,53659,2055.6 52949,2128 53140,2117.1 53504,2093 53649,2058.1",
		style=dashed];
	layer3_expert10_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="53924,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_14	[pos="e,53842,2055.7 52949,2130.4 53175,2122.1 53651,2100.3 53832,2058.1",
		style=dashed];
	layer3_expert10_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU10
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 10",
		pos="54108,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu10 -> layer3_expert10_15	[pos="e,54025,2055.7 52949,2132.1 53207,2126.2 53798,2107.8 54015,2058.1",
		style=dashed];
	layer3_moe_agg_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_MoE_Aggregate_GPU10
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 10",
		pos="52918,1897.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert10_0 -> layer3_moe_agg_gpu10	[pos="e,52811,1899.1 51445,1977.5 51448,1976.6 51451,1975.7 51454,1975 51709,1914.4 52502,1901.8 52801,1899.2"];
	layer3_expert10_1 -> layer3_moe_agg_gpu10	[pos="e,52811,1900 51628,1977.6 51631,1976.6 51634,1975.8 51638,1975 51856,1922.1 52528,1905 52801,1900.2"];
	layer3_expert10_2 -> layer3_moe_agg_gpu10	[pos="e,52811,1901.3 51811,1977.6 51814,1976.6 51817,1975.8 51820,1975 52004,1929.8 52558,1908.8 52801,1901.6"];
	layer3_expert10_3 -> layer3_moe_agg_gpu10	[pos="e,52811,1903 51994,1977.7 51997,1976.7 52000,1975.8 52004,1975 52151,1937.4 52590,1913.2 52801,1903.4"];
	layer3_expert10_4 -> layer3_moe_agg_gpu10	[pos="e,52811,1899.4 52177,1977.7 52180,1976.7 52183,1975.8 52186,1975 52398,1918.8 52655,1903.6 52801,1899.6"];
	layer3_expert10_5 -> layer3_moe_agg_gpu10	[pos="e,52811,1904.6 52360,1977.9 52363,1976.8 52366,1975.9 52370,1975 52515,1933.6 52689,1914.2 52801,1905.4"];
	layer3_expert10_6 -> layer3_moe_agg_gpu10	[pos="e,52811,1914.7 52543,1978.2 52546,1977 52549,1976 52552,1975 52634,1948.8 52729,1929.3 52801,1916.5"];
	layer3_expert10_7 -> layer3_moe_agg_gpu10	[pos="e,52820,1939.1 52726,1979 52729,1977.6 52732,1976.3 52736,1975 52760,1964.6 52786,1953.5 52811,1943"];
	layer3_expert10_8 -> layer3_moe_agg_gpu10	[pos="e,52886,1939 52858,1974.9 52865,1965.9 52873,1956.3 52880,1947.1"];
	layer3_expert10_9 -> layer3_moe_agg_gpu10	[pos="e,52949,1939 52978,1974.9 52971,1965.9 52963,1956.3 52956,1947.1"];
	layer3_expert10_10 -> layer3_moe_agg_gpu10	[pos="e,53017,1939.1 53110,1978.6 53107,1977.3 53104,1976.2 53102,1975 53077,1964.5 53051,1953.4 53026,1943.1"];
	layer3_expert10_11 -> layer3_moe_agg_gpu10	[pos="e,53024,1914.5 53293,1977.9 53290,1976.9 53287,1975.9 53284,1975 53202,1948.5 53107,1929 53034,1916.2"];
	layer3_expert10_12 -> layer3_moe_agg_gpu10	[pos="e,53024,1904.4 53476,1977.5 53473,1976.6 53470,1975.8 53468,1975 53321,1933.2 53146,1913.9 53034,1905.2"];
	layer3_expert10_13 -> layer3_moe_agg_gpu10	[pos="e,53024,1899.2 53659,1977.4 53656,1976.5 53653,1975.7 53650,1975 53438,1918.2 53180,1903.2 53034,1899.4"];
	layer3_expert10_14 -> layer3_moe_agg_gpu10	[pos="e,53024,1902.9 53842,1977.3 53839,1976.5 53836,1975.7 53834,1975 53685,1937 53246,1913 53034,1903.4"];
	layer3_expert10_15 -> layer3_moe_agg_gpu10	[pos="e,53024,1901.2 54025,1977.3 54022,1976.5 54019,1975.7 54016,1975 53833,1929.3 53278,1908.6 53034,1901.5"];
	layer3_output_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU10
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 10",
		pos="56734,1580",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu10 -> layer3_output_gpu10	[pos="e,56679,1614 53024,1889.9 53618,1852.8 56509,1671.9 56598,1648 56622,1641.4 56648,1630.1 56670,1618.7"];
	layer3_moe_agg_gpu10 -> layer3_allreduce_moe	[pos="e,56949,1759.2 53024,1892.9 53585,1873.8 56205,1784.5 56939,1759.5"];
	layer3_output_gpu10 -> output	[pos="e,57043,1443.4 56798,1545.9 56820,1534.7 56846,1522.4 56870,1512 56923,1488.8 56983,1465.5 57033,1447"];
	layer3_qkv_gpu11	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU11
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 12-15
TP Slice: 3
GPU: 11",
		pos="56992,2859",
		shape=rectangle,
		width=2.9167];
	layer3_attn_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Multi-Head_Attention_GPU11
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 11",
		pos="56992,2725",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu11 -> layer3_attn_gpu11	[pos="e,56992,2766.8 56992,2810 56992,2799.2 56992,2787.8 56992,2777"];
	layer3_attn_proj_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU11
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 11",
		pos="56992,2598.5",
		shape=rectangle,
		width=2.9028];
	layer3_attn_gpu11 -> layer3_attn_proj_gpu11	[pos="e,56992,2632.9 56992,2683.2 56992,2670.4 56992,2656.1 56992,2643"];
	layer3_attn_norm_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU11
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 11",
		pos="56992,2281",
		shape=rectangle,
		width=3.5139];
	layer3_attn_proj_gpu11 -> layer3_attn_norm_gpu11	[pos="e,56921,2315.1 56887,2573.1 56860,2561.7 56835,2545.1 56820,2521 56787,2470.3 56790,2437.6 56820,2385 56830,2365.9 56872,2340.5 \
56912,2319.7"];
	layer3_attn_proj_gpu11 -> layer3_allreduce_attn	[pos="e,57014,2515.6 57001,2564.2 57004,2552.6 57008,2539 57012,2525.4"];
	layer3_gate_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU11
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 11",
		pos="55754,2135.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu11 -> layer3_gate_gpu11	[pos="e,55877,2139 56937,2246.8 56913,2234 56884,2220.5 56856,2213 56677,2164.4 56139,2145.6 55887,2139.3"];
	layer3_expert11_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="54290,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_0	[pos="e,54373,2055.5 55632,2133.3 55346,2129.5 54637,2114.8 54383,2057.8",
		style=dashed];
	layer3_expert11_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="54474,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_1	[pos="e,54556,2055.4 55632,2132 55375,2126 54783,2107.3 54566,2057.7",
		style=dashed];
	layer3_expert11_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="54656,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_2	[pos="e,54739,2055.4 55632,2130.4 55407,2121.9 54931,2099.9 54749,2057.8",
		style=dashed];
	layer3_expert11_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="54840,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_3	[pos="e,54922,2055.3 55632,2128 55441,2116.9 55078,2092.6 54932,2057.8",
		style=dashed];
	layer3_expert11_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="55022,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_4	[pos="e,55105,2055.2 55632,2130.6 55504,2124.1 55298,2106.8 55115,2057.9",
		style=dashed];
	layer3_expert11_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="55206,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_5	[pos="e,55288,2055 55632,2122.4 55542,2111.5 55416,2092.2 55298,2057.9",
		style=dashed];
	layer3_expert11_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="55388,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_6	[pos="e,55471,2054.5 55632,2104.4 55584,2091.5 55529,2075.5 55480,2058 55480,2058 55480,2057.9 55480,2057.9",
		style=dashed];
	layer3_expert11_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="55572,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_7	[pos="e,55635,2058 55691,2093.9 55676,2084.1 55659,2073.6 55643,2063.5",
		style=dashed];
	layer3_expert11_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="55754,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_8	[pos="e,55754,2058 55754,2093.9 55754,2085.6 55754,2076.9 55754,2068.3",
		style=dashed];
	layer3_expert11_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="55938,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_9	[pos="e,55874,2058 55818,2093.9 55833,2084.1 55850,2073.6 55866,2063.5",
		style=dashed];
	layer3_expert11_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="56120,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_10	[pos="e,56038,2054.9 55877,2104.7 55922,2092.6 55974,2077.5 56028,2058.3",
		style=dashed];
	layer3_expert11_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="56304,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_11	[pos="e,56221,2055.4 55877,2122.6 55968,2111.8 56094,2092.5 56211,2058.3",
		style=dashed];
	layer3_expert11_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="56486,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_12	[pos="e,56404,2055.5 55877,2130.8 56005,2124.4 56212,2107.2 56394,2058.2",
		style=dashed];
	layer3_expert11_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="56670,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_13	[pos="e,56587,2055.6 55877,2128 56068,2117.1 56432,2093 56577,2058.1",
		style=dashed];
	layer3_expert11_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="56852,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_14	[pos="e,56770,2055.7 55877,2130.4 56103,2122.1 56579,2100.3 56760,2058.1",
		style=dashed];
	layer3_expert11_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU11
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 11",
		pos="57036,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu11 -> layer3_expert11_15	[pos="e,56953,2055.7 55877,2132.1 56135,2126.2 56726,2107.8 56943,2058.1",
		style=dashed];
	layer3_moe_agg_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_MoE_Aggregate_GPU11
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 11",
		pos="55846,1897.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert11_0 -> layer3_moe_agg_gpu11	[pos="e,55739,1899.1 54373,1977.5 54376,1976.6 54379,1975.7 54382,1975 54637,1914.4 55430,1901.8 55729,1899.2"];
	layer3_expert11_1 -> layer3_moe_agg_gpu11	[pos="e,55739,1900 54556,1977.6 54559,1976.6 54562,1975.8 54566,1975 54784,1922.1 55456,1905 55729,1900.2"];
	layer3_expert11_2 -> layer3_moe_agg_gpu11	[pos="e,55739,1901.3 54739,1977.6 54742,1976.6 54745,1975.8 54748,1975 54932,1929.8 55486,1908.8 55729,1901.6"];
	layer3_expert11_3 -> layer3_moe_agg_gpu11	[pos="e,55739,1903 54922,1977.7 54925,1976.7 54928,1975.8 54932,1975 55079,1937.4 55518,1913.2 55729,1903.4"];
	layer3_expert11_4 -> layer3_moe_agg_gpu11	[pos="e,55739,1899.4 55105,1977.7 55108,1976.7 55111,1975.8 55114,1975 55326,1918.8 55583,1903.6 55729,1899.6"];
	layer3_expert11_5 -> layer3_moe_agg_gpu11	[pos="e,55739,1904.6 55288,1977.9 55291,1976.8 55294,1975.9 55298,1975 55443,1933.6 55617,1914.2 55729,1905.4"];
	layer3_expert11_6 -> layer3_moe_agg_gpu11	[pos="e,55739,1914.7 55471,1978.2 55474,1977 55477,1976 55480,1975 55562,1948.8 55657,1929.3 55729,1916.5"];
	layer3_expert11_7 -> layer3_moe_agg_gpu11	[pos="e,55748,1939.1 55654,1979 55657,1977.6 55660,1976.3 55664,1975 55688,1964.6 55714,1953.5 55739,1943"];
	layer3_expert11_8 -> layer3_moe_agg_gpu11	[pos="e,55814,1939 55786,1974.9 55793,1965.9 55801,1956.3 55808,1947.1"];
	layer3_expert11_9 -> layer3_moe_agg_gpu11	[pos="e,55877,1939 55906,1974.9 55899,1965.9 55891,1956.3 55884,1947.1"];
	layer3_expert11_10 -> layer3_moe_agg_gpu11	[pos="e,55945,1939.1 56038,1978.6 56035,1977.3 56032,1976.2 56030,1975 56005,1964.5 55979,1953.4 55954,1943.1"];
	layer3_expert11_11 -> layer3_moe_agg_gpu11	[pos="e,55952,1914.5 56221,1977.9 56218,1976.9 56215,1975.9 56212,1975 56130,1948.5 56035,1929 55962,1916.2"];
	layer3_expert11_12 -> layer3_moe_agg_gpu11	[pos="e,55952,1904.4 56404,1977.5 56401,1976.6 56398,1975.8 56396,1975 56249,1933.2 56074,1913.9 55962,1905.2"];
	layer3_expert11_13 -> layer3_moe_agg_gpu11	[pos="e,55952,1899.2 56587,1977.4 56584,1976.5 56581,1975.7 56578,1975 56366,1918.2 56108,1903.2 55962,1899.4"];
	layer3_expert11_14 -> layer3_moe_agg_gpu11	[pos="e,55952,1902.9 56770,1977.3 56767,1976.5 56764,1975.7 56762,1975 56613,1937 56174,1913 55962,1903.4"];
	layer3_expert11_15 -> layer3_moe_agg_gpu11	[pos="e,55952,1901.2 56953,1977.3 56950,1976.5 56947,1975.7 56944,1975 56761,1929.3 56206,1908.6 55962,1901.5"];
	layer3_output_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU11
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 11",
		pos="57004,1580",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu11 -> layer3_output_gpu11	[pos="e,56945,1614.1 55952,1878.8 56140,1845.6 56544,1766.5 56870,1648 56892,1639.9 56915,1629.2 56936,1618.8"];
	layer3_moe_agg_gpu11 -> layer3_allreduce_moe	[pos="e,57030,1786.4 55952,1895.8 56142,1893.1 56553,1880 56894,1820 56935,1812.6 56981,1800.9 57020,1789.2"];
	layer3_output_gpu11 -> output	[pos="e,57111,1445.3 57031,1545.8 57052,1519.4 57081,1482.2 57104,1453.3"];
	layer3_qkv_gpu12	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU12
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 16-19
TP Slice: 4
GPU: 12",
		pos="57262,2859",
		shape=rectangle,
		width=2.9167];
	layer3_attn_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Multi-Head_Attention_GPU12
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 12",
		pos="57262,2725",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu12 -> layer3_attn_gpu12	[pos="e,57262,2766.8 57262,2810 57262,2799.2 57262,2787.8 57262,2777"];
	layer3_attn_proj_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU12
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 12",
		pos="57262,2598.5",
		shape=rectangle,
		width=2.9028];
	layer3_attn_gpu12 -> layer3_attn_proj_gpu12	[pos="e,57262,2632.9 57262,2683.2 57262,2670.4 57262,2656.1 57262,2643"];
	layer3_attn_norm_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU12
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 12",
		pos="57262,2281",
		shape=rectangle,
		width=3.5139];
	layer3_attn_proj_gpu12 -> layer3_attn_norm_gpu12	[pos="e,57262,2315.2 57262,2564.3 57262,2506.9 57262,2389.1 57262,2325.3"];
	layer3_attn_proj_gpu12 -> layer3_allreduce_attn	[pos="e,57102,2497.5 57209,2564.4 57180,2546.2 57143,2523.2 57110,2502.9"];
	layer3_gate_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU12
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 12",
		pos="58500,2135.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu12 -> layer3_gate_gpu12	[pos="e,58377,2139.1 57317,2246.8 57342,2234 57371,2220.5 57398,2213 57578,2164.7 58115,2145.7 58367,2139.3"];
	layer3_expert12_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="57218,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_0	[pos="e,57301,2055.4 58377,2132 58120,2126 57528,2107.3 57311,2057.7",
		style=dashed];
	layer3_expert12_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="57402,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_1	[pos="e,57484,2055.4 58377,2130.4 58152,2121.9 57676,2099.9 57494,2057.8",
		style=dashed];
	layer3_expert12_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="57584,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_2	[pos="e,57667,2055.3 58377,2128 58186,2116.9 57823,2092.6 57677,2057.8",
		style=dashed];
	layer3_expert12_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="57768,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_3	[pos="e,57850,2055.2 58377,2130.6 58249,2124.1 58043,2106.8 57860,2057.9",
		style=dashed];
	layer3_expert12_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="57950,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_4	[pos="e,58033,2055 58377,2122.4 58287,2111.5 58161,2092.2 58043,2057.9",
		style=dashed];
	layer3_expert12_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="58134,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_5	[pos="e,58216,2054.5 58377,2104.4 58329,2091.5 58274,2075.5 58226,2058 58225,2058 58225,2057.9 58225,2057.9",
		style=dashed];
	layer3_expert12_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="58316,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_6	[pos="e,58380,2058 58436,2093.9 58421,2084.1 58404,2073.6 58388,2063.5",
		style=dashed];
	layer3_expert12_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="58500,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_7	[pos="e,58500,2058 58500,2093.9 58500,2085.6 58500,2076.9 58500,2068.3",
		style=dashed];
	layer3_expert12_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="58682,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_8	[pos="e,58619,2058 58563,2093.9 58578,2084.1 58595,2073.6 58611,2063.5",
		style=dashed];
	layer3_expert12_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="58866,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_9	[pos="e,58783,2054.9 58622,2104.7 58667,2092.6 58719,2077.5 58773,2058.3",
		style=dashed];
	layer3_expert12_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="59048,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_10	[pos="e,58966,2055.4 58622,2122.6 58713,2111.8 58839,2092.5 58956,2058.3",
		style=dashed];
	layer3_expert12_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="59232,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_11	[pos="e,59149,2055.5 58622,2130.8 58750,2124.4 58957,2107.2 59139,2058.2",
		style=dashed];
	layer3_expert12_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="59414,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_12	[pos="e,59332,2055.6 58622,2128 58813,2117.1 59177,2093 59322,2058.1",
		style=dashed];
	layer3_expert12_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="59598,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_13	[pos="e,59515,2055.7 58622,2130.4 58848,2122.1 59324,2100.3 59505,2058.1",
		style=dashed];
	layer3_expert12_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="59780,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_14	[pos="e,59698,2055.7 58622,2132.1 58880,2126.2 59471,2107.8 59688,2058.1",
		style=dashed];
	layer3_expert12_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU12
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 12",
		pos="59964,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu12 -> layer3_expert12_15	[pos="e,59881,2055.8 58622,2133.3 58908,2129.7 59618,2115.3 59871,2058.1",
		style=dashed];
	layer3_moe_agg_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_MoE_Aggregate_GPU12
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 12",
		pos="58408,1897.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert12_0 -> layer3_moe_agg_gpu12	[pos="e,58301,1901.3 57301,1977.6 57304,1976.6 57307,1975.8 57310,1975 57494,1929.8 58048,1908.8 58291,1901.6"];
	layer3_expert12_1 -> layer3_moe_agg_gpu12	[pos="e,58301,1903 57484,1977.7 57487,1976.7 57490,1975.8 57494,1975 57641,1937.4 58080,1913.2 58291,1903.4"];
	layer3_expert12_2 -> layer3_moe_agg_gpu12	[pos="e,58301,1899.4 57667,1977.7 57670,1976.7 57673,1975.8 57676,1975 57888,1918.8 58145,1903.6 58291,1899.6"];
	layer3_expert12_3 -> layer3_moe_agg_gpu12	[pos="e,58301,1904.6 57850,1977.9 57853,1976.8 57856,1975.9 57860,1975 58005,1933.6 58179,1914.2 58291,1905.4"];
	layer3_expert12_4 -> layer3_moe_agg_gpu12	[pos="e,58301,1914.7 58033,1978.2 58036,1977 58039,1976 58042,1975 58124,1948.8 58219,1929.3 58291,1916.5"];
	layer3_expert12_5 -> layer3_moe_agg_gpu12	[pos="e,58310,1939.1 58216,1979 58219,1977.6 58222,1976.3 58226,1975 58250,1964.6 58276,1953.5 58301,1943"];
	layer3_expert12_6 -> layer3_moe_agg_gpu12	[pos="e,58376,1939 58348,1974.9 58355,1965.9 58363,1956.3 58370,1947.1"];
	layer3_expert12_7 -> layer3_moe_agg_gpu12	[pos="e,58439,1939 58468,1974.9 58461,1965.9 58453,1956.3 58446,1947.1"];
	layer3_expert12_8 -> layer3_moe_agg_gpu12	[pos="e,58507,1939.1 58600,1978.6 58597,1977.3 58594,1976.2 58592,1975 58567,1964.5 58541,1953.4 58516,1943.1"];
	layer3_expert12_9 -> layer3_moe_agg_gpu12	[pos="e,58514,1914.5 58783,1977.9 58780,1976.9 58777,1975.9 58774,1975 58692,1948.5 58597,1929 58524,1916.2"];
	layer3_expert12_10 -> layer3_moe_agg_gpu12	[pos="e,58514,1904.4 58966,1977.5 58963,1976.6 58960,1975.8 58958,1975 58811,1933.2 58636,1913.9 58524,1905.2"];
	layer3_expert12_11 -> layer3_moe_agg_gpu12	[pos="e,58514,1899.2 59149,1977.4 59146,1976.5 59143,1975.7 59140,1975 58928,1918.2 58670,1903.2 58524,1899.4"];
	layer3_expert12_12 -> layer3_moe_agg_gpu12	[pos="e,58514,1902.9 59332,1977.3 59329,1976.5 59326,1975.7 59324,1975 59175,1937 58736,1913 58524,1903.4"];
	layer3_expert12_13 -> layer3_moe_agg_gpu12	[pos="e,58514,1901.2 59515,1977.3 59512,1976.5 59509,1975.7 59506,1975 59323,1929.3 58768,1908.6 58524,1901.5"];
	layer3_expert12_14 -> layer3_moe_agg_gpu12	[pos="e,58514,1900 59698,1977.3 59695,1976.4 59692,1975.7 59690,1975 59470,1921.6 58797,1904.8 58524,1900.1"];
	layer3_expert12_15 -> layer3_moe_agg_gpu12	[pos="e,58514,1899 59881,1977.2 59878,1976.4 59875,1975.7 59872,1975 59617,1913.8 58823,1901.5 58524,1899.1"];
	layer3_output_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU12
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 12",
		pos="57276,1580",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu12 -> layer3_output_gpu12	[pos="e,57321,1614 58301,1890 58134,1879 57815,1854.2 57708,1820 57561,1773.5 57408,1674.7 57329,1619.8"];
	layer3_moe_agg_gpu12 -> layer3_allreduce_moe	[pos="e,57274,1772.1 58301,1886.5 58156,1872.6 57887,1846.2 57658,1820 57532,1805.5 57389,1787.2 57284,1773.4"];
	layer3_output_gpu12 -> output	[pos="e,57169,1445.3 57249,1545.8 57228,1519.4 57198,1482.2 57175,1453.3"];
	layer3_qkv_gpu13	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU13
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 20-23
TP Slice: 5
GPU: 13",
		pos="57532,2859",
		shape=rectangle,
		width=2.9167];
	layer3_attn_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Multi-Head_Attention_GPU13
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 13",
		pos="57532,2725",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu13 -> layer3_attn_gpu13	[pos="e,57532,2766.8 57532,2810 57532,2799.2 57532,2787.8 57532,2777"];
	layer3_attn_proj_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU13
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 13",
		pos="57532,2598.5",
		shape=rectangle,
		width=2.9028];
	layer3_attn_gpu13 -> layer3_attn_proj_gpu13	[pos="e,57532,2632.9 57532,2683.2 57532,2670.4 57532,2656.1 57532,2643"];
	layer3_attn_norm_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU13
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 13",
		pos="57534,2281",
		shape=rectangle,
		width=3.5139];
	layer3_attn_proj_gpu13 -> layer3_attn_norm_gpu13	[pos="e,57533,2315.2 57533,2564.3 57533,2506.9 57533,2389.1 57533,2325.3"];
	layer3_attn_proj_gpu13 -> layer3_allreduce_attn	[pos="e,57140,2484.9 57428,2567.5 57346,2544.2 57234,2511.9 57149,2487.7"];
	layer3_gate_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU13
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 13",
		pos="61428,2135.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu13 -> layer3_gate_gpu13	[pos="e,61305,2138.3 57587,2246.9 57611,2233.7 57641,2220 57670,2213 57759,2191.1 60638,2148 61295,2138.4"];
	layer3_expert13_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="60146,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_0	[pos="e,60229,2055.4 61305,2132 61048,2126 60456,2107.3 60239,2057.7",
		style=dashed];
	layer3_expert13_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="60330,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_1	[pos="e,60412,2055.4 61305,2130.4 61080,2121.9 60604,2099.9 60422,2057.8",
		style=dashed];
	layer3_expert13_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="60512,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_2	[pos="e,60595,2055.3 61305,2128 61114,2116.9 60751,2092.6 60605,2057.8",
		style=dashed];
	layer3_expert13_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="60696,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_3	[pos="e,60778,2055.2 61305,2130.6 61177,2124.1 60971,2106.8 60788,2057.9",
		style=dashed];
	layer3_expert13_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="60878,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_4	[pos="e,60961,2055 61305,2122.4 61215,2111.5 61089,2092.2 60971,2057.9",
		style=dashed];
	layer3_expert13_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="61062,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_5	[pos="e,61144,2054.5 61305,2104.4 61257,2091.5 61202,2075.5 61154,2058 61153,2058 61153,2057.9 61153,2057.9",
		style=dashed];
	layer3_expert13_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="61244,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_6	[pos="e,61308,2058 61364,2093.9 61349,2084.1 61332,2073.6 61316,2063.5",
		style=dashed];
	layer3_expert13_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="61428,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_7	[pos="e,61428,2058 61428,2093.9 61428,2085.6 61428,2076.9 61428,2068.3",
		style=dashed];
	layer3_expert13_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="61610,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_8	[pos="e,61547,2058 61491,2093.9 61506,2084.1 61523,2073.6 61539,2063.5",
		style=dashed];
	layer3_expert13_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="61794,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_9	[pos="e,61711,2054.9 61550,2104.7 61595,2092.6 61647,2077.5 61701,2058.3",
		style=dashed];
	layer3_expert13_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="61976,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_10	[pos="e,61894,2055.4 61550,2122.6 61641,2111.8 61767,2092.5 61884,2058.3",
		style=dashed];
	layer3_expert13_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="62160,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_11	[pos="e,62077,2055.5 61550,2130.8 61678,2124.4 61885,2107.2 62067,2058.2",
		style=dashed];
	layer3_expert13_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="62342,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_12	[pos="e,62260,2055.6 61550,2128 61741,2117.1 62105,2093 62250,2058.1",
		style=dashed];
	layer3_expert13_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="62526,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_13	[pos="e,62443,2055.7 61550,2130.4 61776,2122.1 62252,2100.3 62433,2058.1",
		style=dashed];
	layer3_expert13_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="62708,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_14	[pos="e,62626,2055.7 61550,2132.1 61808,2126.2 62399,2107.8 62616,2058.1",
		style=dashed];
	layer3_expert13_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU13
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 13",
		pos="62892,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu13 -> layer3_expert13_15	[pos="e,62809,2055.8 61550,2133.3 61836,2129.7 62546,2115.3 62799,2058.1",
		style=dashed];
	layer3_moe_agg_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_MoE_Aggregate_GPU13
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 13",
		pos="61336,1897.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert13_0 -> layer3_moe_agg_gpu13	[pos="e,61229,1901.3 60229,1977.6 60232,1976.6 60235,1975.8 60238,1975 60422,1929.8 60976,1908.8 61219,1901.6"];
	layer3_expert13_1 -> layer3_moe_agg_gpu13	[pos="e,61229,1903 60412,1977.7 60415,1976.7 60418,1975.8 60422,1975 60569,1937.4 61008,1913.2 61219,1903.4"];
	layer3_expert13_2 -> layer3_moe_agg_gpu13	[pos="e,61229,1899.4 60595,1977.7 60598,1976.7 60601,1975.8 60604,1975 60816,1918.8 61073,1903.6 61219,1899.6"];
	layer3_expert13_3 -> layer3_moe_agg_gpu13	[pos="e,61229,1904.6 60778,1977.9 60781,1976.8 60784,1975.9 60788,1975 60933,1933.6 61107,1914.2 61219,1905.4"];
	layer3_expert13_4 -> layer3_moe_agg_gpu13	[pos="e,61229,1914.7 60961,1978.2 60964,1977 60967,1976 60970,1975 61052,1948.8 61147,1929.3 61219,1916.5"];
	layer3_expert13_5 -> layer3_moe_agg_gpu13	[pos="e,61238,1939.1 61144,1979 61147,1977.6 61150,1976.3 61154,1975 61178,1964.6 61204,1953.5 61229,1943"];
	layer3_expert13_6 -> layer3_moe_agg_gpu13	[pos="e,61304,1939 61276,1974.9 61283,1965.9 61291,1956.3 61298,1947.1"];
	layer3_expert13_7 -> layer3_moe_agg_gpu13	[pos="e,61367,1939 61396,1974.9 61389,1965.9 61381,1956.3 61374,1947.1"];
	layer3_expert13_8 -> layer3_moe_agg_gpu13	[pos="e,61435,1939.1 61528,1978.6 61525,1977.3 61522,1976.2 61520,1975 61495,1964.5 61469,1953.4 61444,1943.1"];
	layer3_expert13_9 -> layer3_moe_agg_gpu13	[pos="e,61442,1914.5 61711,1977.9 61708,1976.9 61705,1975.9 61702,1975 61620,1948.5 61525,1929 61452,1916.2"];
	layer3_expert13_10 -> layer3_moe_agg_gpu13	[pos="e,61442,1904.4 61894,1977.5 61891,1976.6 61888,1975.8 61886,1975 61739,1933.2 61564,1913.9 61452,1905.2"];
	layer3_expert13_11 -> layer3_moe_agg_gpu13	[pos="e,61442,1899.2 62077,1977.4 62074,1976.5 62071,1975.7 62068,1975 61856,1918.2 61598,1903.2 61452,1899.4"];
	layer3_expert13_12 -> layer3_moe_agg_gpu13	[pos="e,61442,1902.9 62260,1977.3 62257,1976.5 62254,1975.7 62252,1975 62103,1937 61664,1913 61452,1903.4"];
	layer3_expert13_13 -> layer3_moe_agg_gpu13	[pos="e,61442,1901.2 62443,1977.3 62440,1976.5 62437,1975.7 62434,1975 62251,1929.3 61696,1908.6 61452,1901.5"];
	layer3_expert13_14 -> layer3_moe_agg_gpu13	[pos="e,61442,1900 62626,1977.3 62623,1976.4 62620,1975.7 62618,1975 62398,1921.6 61725,1904.8 61452,1900.1"];
	layer3_expert13_15 -> layer3_moe_agg_gpu13	[pos="e,61442,1899 62809,1977.2 62806,1976.4 62803,1975.7 62800,1975 62545,1913.8 61751,1901.5 61452,1899.1"];
	layer3_output_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU13
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 13",
		pos="57546,1580",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu13 -> layer3_output_gpu13	[pos="e,57601,1614 61229,1894.8 60704,1885.7 58378,1835.1 57682,1648 57658,1641.4 57632,1630.1 57610,1618.7"];
	layer3_moe_agg_gpu13 -> layer3_allreduce_moe	[pos="e,57271,1773.1 61229,1895.6 60708,1891.1 58419,1868.7 57708,1820 57562,1810.1 57397,1790 57281,1774.4"];
	layer3_output_gpu13 -> output	[pos="e,57237,1443.4 57483,1546 57461,1534.7 57435,1522.4 57412,1512 57358,1488.7 57297,1465.4 57247,1446.9"];
	layer3_qkv_gpu14	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU14
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 24-27
TP Slice: 6
GPU: 14",
		pos="57804,2859",
		shape=rectangle,
		width=2.9167];
	layer3_attn_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Multi-Head_Attention_GPU14
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 14",
		pos="57804,2725",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu14 -> layer3_attn_gpu14	[pos="e,57804,2766.8 57804,2810 57804,2799.2 57804,2787.8 57804,2777"];
	layer3_attn_proj_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU14
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 14",
		pos="57804,2598.5",
		shape=rectangle,
		width=2.9028];
	layer3_attn_gpu14 -> layer3_attn_proj_gpu14	[pos="e,57804,2632.9 57804,2683.2 57804,2670.4 57804,2656.1 57804,2643"];
	layer3_attn_norm_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU14
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 14",
		pos="57804,2281",
		shape=rectangle,
		width=3.5139];
	layer3_attn_proj_gpu14 -> layer3_attn_norm_gpu14	[pos="e,57804,2315.2 57804,2564.3 57804,2506.9 57804,2389.1 57804,2325.3"];
	layer3_attn_proj_gpu14 -> layer3_allreduce_attn	[pos="e,57172,2474 57699,2569.1 57681,2564.8 57663,2560.6 57646,2557 57489,2523.6 57307,2494.2 57182,2475.5"];
	layer3_gate_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU14
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 14",
		pos="64356,2135.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu14 -> layer3_gate_gpu14	[pos="e,64233,2138.5 57858,2246.9 57882,2233.6 57912,2219.9 57940,2213 58136,2166.4 61358,2179.5 61558,2177 62584,2164.5 63822,2145 64223,\
2138.6"];
	layer3_expert14_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="63074,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_0	[pos="e,63157,2055.4 64233,2132 63976,2126 63384,2107.3 63167,2057.7",
		style=dashed];
	layer3_expert14_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="63258,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_1	[pos="e,63340,2055.4 64233,2130.4 64008,2121.9 63532,2099.9 63350,2057.8",
		style=dashed];
	layer3_expert14_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="63440,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_2	[pos="e,63523,2055.3 64233,2128 64042,2116.9 63679,2092.6 63533,2057.8",
		style=dashed];
	layer3_expert14_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="63624,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_3	[pos="e,63706,2055.2 64233,2130.6 64105,2124.1 63899,2106.8 63716,2057.9",
		style=dashed];
	layer3_expert14_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="63806,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_4	[pos="e,63889,2055 64233,2122.4 64143,2111.5 64017,2092.2 63899,2057.9",
		style=dashed];
	layer3_expert14_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="63990,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_5	[pos="e,64072,2054.5 64233,2104.4 64185,2091.5 64130,2075.5 64082,2058 64081,2058 64081,2057.9 64081,2057.9",
		style=dashed];
	layer3_expert14_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="64172,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_6	[pos="e,64236,2058 64292,2093.9 64277,2084.1 64260,2073.6 64244,2063.5",
		style=dashed];
	layer3_expert14_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="64356,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_7	[pos="e,64356,2058 64356,2093.9 64356,2085.6 64356,2076.9 64356,2068.3",
		style=dashed];
	layer3_expert14_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="64538,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_8	[pos="e,64475,2058 64419,2093.9 64434,2084.1 64451,2073.6 64467,2063.5",
		style=dashed];
	layer3_expert14_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="64722,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_9	[pos="e,64639,2054.9 64478,2104.7 64523,2092.6 64575,2077.5 64629,2058.3",
		style=dashed];
	layer3_expert14_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="64904,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_10	[pos="e,64822,2055.4 64478,2122.6 64569,2111.8 64695,2092.5 64812,2058.3",
		style=dashed];
	layer3_expert14_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="65088,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_11	[pos="e,65005,2055.5 64478,2130.8 64606,2124.4 64813,2107.2 64995,2058.2",
		style=dashed];
	layer3_expert14_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="65270,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_12	[pos="e,65188,2055.6 64478,2128 64669,2117.1 65033,2093 65178,2058.1",
		style=dashed];
	layer3_expert14_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="65454,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_13	[pos="e,65371,2055.7 64478,2130.4 64704,2122.1 65180,2100.3 65361,2058.1",
		style=dashed];
	layer3_expert14_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="65636,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_14	[pos="e,65554,2055.7 64478,2132.1 64736,2126.2 65327,2107.8 65544,2058.1",
		style=dashed];
	layer3_expert14_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU14
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 14",
		pos="65820,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu14 -> layer3_expert14_15	[pos="e,65737,2055.8 64478,2133.3 64764,2129.7 65474,2115.3 65727,2058.1",
		style=dashed];
	layer3_moe_agg_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_MoE_Aggregate_GPU14
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 14",
		pos="64264,1897.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert14_0 -> layer3_moe_agg_gpu14	[pos="e,64157,1901.3 63157,1977.6 63160,1976.6 63163,1975.8 63166,1975 63350,1929.8 63904,1908.8 64147,1901.6"];
	layer3_expert14_1 -> layer3_moe_agg_gpu14	[pos="e,64157,1903 63340,1977.7 63343,1976.7 63346,1975.8 63350,1975 63497,1937.4 63936,1913.2 64147,1903.4"];
	layer3_expert14_2 -> layer3_moe_agg_gpu14	[pos="e,64157,1899.4 63523,1977.7 63526,1976.7 63529,1975.8 63532,1975 63744,1918.8 64001,1903.6 64147,1899.6"];
	layer3_expert14_3 -> layer3_moe_agg_gpu14	[pos="e,64157,1904.6 63706,1977.9 63709,1976.8 63712,1975.9 63716,1975 63861,1933.6 64035,1914.2 64147,1905.4"];
	layer3_expert14_4 -> layer3_moe_agg_gpu14	[pos="e,64157,1914.7 63889,1978.2 63892,1977 63895,1976 63898,1975 63980,1948.8 64075,1929.3 64147,1916.5"];
	layer3_expert14_5 -> layer3_moe_agg_gpu14	[pos="e,64166,1939.1 64072,1979 64075,1977.6 64078,1976.3 64082,1975 64106,1964.6 64132,1953.5 64157,1943"];
	layer3_expert14_6 -> layer3_moe_agg_gpu14	[pos="e,64232,1939 64204,1974.9 64211,1965.9 64219,1956.3 64226,1947.1"];
	layer3_expert14_7 -> layer3_moe_agg_gpu14	[pos="e,64295,1939 64324,1974.9 64317,1965.9 64309,1956.3 64302,1947.1"];
	layer3_expert14_8 -> layer3_moe_agg_gpu14	[pos="e,64363,1939.1 64456,1978.6 64453,1977.3 64450,1976.2 64448,1975 64423,1964.5 64397,1953.4 64372,1943.1"];
	layer3_expert14_9 -> layer3_moe_agg_gpu14	[pos="e,64370,1914.5 64639,1977.9 64636,1976.9 64633,1975.9 64630,1975 64548,1948.5 64453,1929 64380,1916.2"];
	layer3_expert14_10 -> layer3_moe_agg_gpu14	[pos="e,64370,1904.4 64822,1977.5 64819,1976.6 64816,1975.8 64814,1975 64667,1933.2 64492,1913.9 64380,1905.2"];
	layer3_expert14_11 -> layer3_moe_agg_gpu14	[pos="e,64370,1899.2 65005,1977.4 65002,1976.5 64999,1975.7 64996,1975 64784,1918.2 64526,1903.2 64380,1899.4"];
	layer3_expert14_12 -> layer3_moe_agg_gpu14	[pos="e,64370,1902.9 65188,1977.3 65185,1976.5 65182,1975.7 65180,1975 65031,1937 64592,1913 64380,1903.4"];
	layer3_expert14_13 -> layer3_moe_agg_gpu14	[pos="e,64370,1901.2 65371,1977.3 65368,1976.5 65365,1975.7 65362,1975 65179,1929.3 64624,1908.6 64380,1901.5"];
	layer3_expert14_14 -> layer3_moe_agg_gpu14	[pos="e,64370,1900 65554,1977.3 65551,1976.4 65548,1975.7 65546,1975 65326,1921.6 64653,1904.8 64380,1900.1"];
	layer3_expert14_15 -> layer3_moe_agg_gpu14	[pos="e,64370,1899 65737,1977.2 65734,1976.4 65731,1975.7 65728,1975 65473,1913.8 64679,1901.5 64380,1899.1"];
	layer3_output_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU14
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 14",
		pos="57818,1580",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu14 -> layer3_output_gpu14	[pos="e,57872,1614 64157,1894.9 63768,1888.6 62381,1864.4 61238,1820 61193,1818.2 57998,1659.5 57954,1648 57929,1641.5 57903,1630.3 57881,\
1618.8"];
	layer3_moe_agg_gpu14 -> layer3_allreduce_moe	[pos="e,57319,1756.8 64157,1894.4 63367,1878.5 58391,1778.4 57330,1757"];
	layer3_output_gpu14 -> output	[pos="e,57346,1434.6 57760,1545.9 57736,1533.7 57709,1520.8 57682,1512 57578,1476.7 57457,1452.3 57356,1436.2"];
	layer3_qkv_gpu15	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU15
Input: [1024,2048,4096]
Output: [1024,2048,3*512]
Heads: 28-31
TP Slice: 7
GPU: 15",
		pos="58074,2859",
		shape=rectangle,
		width=2.9167];
	layer3_attn_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Multi-Head_Attention_GPU15
Input: [1024,2048,512]x8
Output: [1024,2048,512]
TP Reduction
GPU: 15",
		pos="58074,2725",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu15 -> layer3_attn_gpu15	[pos="e,58074,2766.8 58074,2810 58074,2799.2 58074,2787.8 58074,2777"];
	layer3_attn_proj_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU15
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 15",
		pos="58074,2598.5",
		shape=rectangle,
		width=2.9028];
	layer3_attn_gpu15 -> layer3_attn_proj_gpu15	[pos="e,58074,2632.9 58074,2683.2 58074,2670.4 58074,2656.1 58074,2643"];
	layer3_attn_norm_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU15
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 15",
		pos="58076,2281",
		shape=rectangle,
		width=3.5139];
	layer3_attn_proj_gpu15 -> layer3_attn_norm_gpu15	[pos="e,58075,2315.2 58075,2564.3 58075,2506.9 58075,2389.1 58075,2325.3"];
	layer3_attn_proj_gpu15 -> layer3_allreduce_attn	[pos="e,57195,2466.3 57970,2568.4 57952,2564.2 57935,2560.2 57918,2557 57672,2511.3 57384,2482.3 57205,2467.1"];
	layer3_gate_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU15
Input: [1024,2048,512]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 15",
		pos="67284,2135.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu15 -> layer3_gate_gpu15	[pos="e,67161,2138.4 58202,2278 59224,2262.1 66108,2154.8 67151,2138.6"];
	layer3_expert15_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="66002,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_0	[pos="e,66085,2055.4 67161,2132 66904,2126 66312,2107.3 66095,2057.7",
		style=dashed];
	layer3_expert15_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="66186,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_1	[pos="e,66268,2055.4 67161,2130.4 66936,2121.9 66460,2099.9 66278,2057.8",
		style=dashed];
	layer3_expert15_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="66368,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_2	[pos="e,66451,2055.3 67161,2128 66970,2116.9 66607,2092.6 66461,2057.8",
		style=dashed];
	layer3_expert15_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="66552,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_3	[pos="e,66634,2055.2 67161,2130.6 67033,2124.1 66827,2106.8 66644,2057.9",
		style=dashed];
	layer3_expert15_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="66734,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_4	[pos="e,66817,2055 67161,2122.4 67071,2111.5 66945,2092.2 66827,2057.9",
		style=dashed];
	layer3_expert15_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="66918,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_5	[pos="e,67000,2054.5 67161,2104.4 67113,2091.5 67058,2075.5 67010,2058 67009,2058 67009,2057.9 67009,2057.9",
		style=dashed];
	layer3_expert15_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="67100,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_6	[pos="e,67164,2058 67220,2093.9 67205,2084.1 67188,2073.6 67172,2063.5",
		style=dashed];
	layer3_expert15_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="67284,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_7	[pos="e,67284,2058 67284,2093.9 67284,2085.6 67284,2076.9 67284,2068.3",
		style=dashed];
	layer3_expert15_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="67466,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_8	[pos="e,67403,2058 67347,2093.9 67362,2084.1 67379,2073.6 67395,2063.5",
		style=dashed];
	layer3_expert15_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="67650,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_9	[pos="e,67567,2054.9 67406,2104.7 67451,2092.6 67503,2077.5 67557,2058.3",
		style=dashed];
	layer3_expert15_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="67832,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_10	[pos="e,67750,2055.4 67406,2122.6 67497,2111.8 67623,2092.5 67740,2058.3",
		style=dashed];
	layer3_expert15_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="68016,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_11	[pos="e,67933,2055.5 67406,2130.8 67534,2124.4 67741,2107.2 67923,2058.2",
		style=dashed];
	layer3_expert15_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="68198,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_12	[pos="e,68116,2055.6 67406,2128 67597,2117.1 67961,2093 68106,2058.1",
		style=dashed];
	layer3_expert15_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="68382,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_13	[pos="e,68299,2055.7 67406,2130.4 67632,2122.1 68108,2100.3 68289,2058.1",
		style=dashed];
	layer3_expert15_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="68564,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_14	[pos="e,68482,2055.7 67406,2132.1 67664,2126.2 68255,2107.8 68472,2058.1",
		style=dashed];
	layer3_expert15_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU15
Input: [tokens,512]
Output: [tokens,512]
TP slice
GPU: 15",
		pos="68748,2016.5",
		shape=rectangle,
		width=2.2917];
	layer3_gate_gpu15 -> layer3_expert15_15	[pos="e,68665,2055.8 67406,2133.3 67692,2129.7 68402,2115.3 68655,2058.1",
		style=dashed];
	layer3_moe_agg_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_MoE_Aggregate_GPU15
Input: 16Ã—[tokens,512]
Output: [1024,2048,512]
TP Reduction
GPU: 15",
		pos="67192,1897.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert15_0 -> layer3_moe_agg_gpu15	[pos="e,67085,1901.3 66085,1977.6 66088,1976.6 66091,1975.8 66094,1975 66278,1929.8 66832,1908.8 67075,1901.6"];
	layer3_expert15_1 -> layer3_moe_agg_gpu15	[pos="e,67085,1903 66268,1977.7 66271,1976.7 66274,1975.8 66278,1975 66425,1937.4 66864,1913.2 67075,1903.4"];
	layer3_expert15_2 -> layer3_moe_agg_gpu15	[pos="e,67085,1899.4 66451,1977.7 66454,1976.7 66457,1975.8 66460,1975 66672,1918.8 66929,1903.6 67075,1899.6"];
	layer3_expert15_3 -> layer3_moe_agg_gpu15	[pos="e,67085,1904.6 66634,1977.9 66637,1976.8 66640,1975.9 66644,1975 66789,1933.6 66963,1914.2 67075,1905.4"];
	layer3_expert15_4 -> layer3_moe_agg_gpu15	[pos="e,67085,1914.7 66817,1978.2 66820,1977 66823,1976 66826,1975 66908,1948.8 67003,1929.3 67075,1916.5"];
	layer3_expert15_5 -> layer3_moe_agg_gpu15	[pos="e,67094,1939.1 67000,1979 67003,1977.6 67006,1976.3 67010,1975 67034,1964.6 67060,1953.5 67085,1943"];
	layer3_expert15_6 -> layer3_moe_agg_gpu15	[pos="e,67160,1939 67132,1974.9 67139,1965.9 67147,1956.3 67154,1947.1"];
	layer3_expert15_7 -> layer3_moe_agg_gpu15	[pos="e,67223,1939 67252,1974.9 67245,1965.9 67237,1956.3 67230,1947.1"];
	layer3_expert15_8 -> layer3_moe_agg_gpu15	[pos="e,67291,1939.1 67384,1978.6 67381,1977.3 67378,1976.2 67376,1975 67351,1964.5 67325,1953.4 67300,1943.1"];
	layer3_expert15_9 -> layer3_moe_agg_gpu15	[pos="e,67298,1914.5 67567,1977.9 67564,1976.9 67561,1975.9 67558,1975 67476,1948.5 67381,1929 67308,1916.2"];
	layer3_expert15_10 -> layer3_moe_agg_gpu15	[pos="e,67298,1904.4 67750,1977.5 67747,1976.6 67744,1975.8 67742,1975 67595,1933.2 67420,1913.9 67308,1905.2"];
	layer3_expert15_11 -> layer3_moe_agg_gpu15	[pos="e,67298,1899.2 67933,1977.4 67930,1976.5 67927,1975.7 67924,1975 67712,1918.2 67454,1903.2 67308,1899.4"];
	layer3_expert15_12 -> layer3_moe_agg_gpu15	[pos="e,67298,1902.9 68116,1977.3 68113,1976.5 68110,1975.7 68108,1975 67959,1937 67520,1913 67308,1903.4"];
	layer3_expert15_13 -> layer3_moe_agg_gpu15	[pos="e,67298,1901.2 68299,1977.3 68296,1976.5 68293,1975.7 68290,1975 68107,1929.3 67552,1908.6 67308,1901.5"];
	layer3_expert15_14 -> layer3_moe_agg_gpu15	[pos="e,67298,1900 68482,1977.3 68479,1976.4 68476,1975.7 68474,1975 68254,1921.6 67581,1904.8 67308,1900.1"];
	layer3_expert15_15 -> layer3_moe_agg_gpu15	[pos="e,67298,1899 68665,1977.2 68662,1976.4 68659,1975.7 68656,1975 68401,1913.8 67607,1901.5 67308,1899.1"];
	layer3_output_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU15
Input: [1024,2048,512]x2
Output: [1024,2048,512]
GPU: 15",
		pos="58088,1580",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu15 -> layer3_output_gpu15	[pos="e,58215,1585.4 67085,1892.8 66147,1860.3 59284,1622.4 58225,1585.7"];
	layer3_moe_agg_gpu15 -> layer3_allreduce_moe	[pos="e,57320,1756.4 67085,1894.9 66714,1889.1 65435,1869.7 64378,1856 62983,1838 62634,1839.4 61238,1820 59737,1799.1 57926,1767.3 57331,\
1756.6"];
	layer3_output_gpu15 -> output	[pos="e,57414,1420.9 58032,1545.9 58009,1533.4 57981,1520.2 57954,1512 57782,1460.3 57583,1434.5 57425,1421.7"];
	layer3_allreduce_attn -> layer3_attn_norm_gpu8	[pos="e,56246,2315.1 56859,2442.8 56713,2431.3 56500,2405.7 56322,2349 56300,2341.7 56276,2330.8 56255,2319.9"];
	layer3_allreduce_attn -> layer3_attn_norm_gpu9	[pos="e,56511,2315.2 56897,2429.8 56807,2412.8 56687,2386 56586,2349 56564,2341.1 56541,2330.3 56520,2319.8"];
	layer3_allreduce_attn -> layer3_attn_norm_gpu10	[pos="e,56781,2315.1 56955,2410.4 56905,2382.8 56839,2346.8 56790,2320"];
	layer3_allreduce_attn -> layer3_attn_norm_gpu11	[pos="e,56999,2315.2 57017,2389.7 57012,2368.2 57006,2344.7 57002,2325.1"];
	layer3_allreduce_attn -> layer3_attn_norm_gpu12	[pos="e,57218,2315 57094,2405.8 57130,2379.3 57175,2346.5 57209,2321.3"];
	layer3_allreduce_attn -> layer3_attn_norm_gpu13	[pos="e,57473,2315.2 57150,2424.7 57223,2406.5 57317,2380.2 57398,2349 57420,2340.7 57443,2330 57464,2319.7"];
	layer3_allreduce_attn -> layer3_attn_norm_gpu14	[pos="e,57747,2315.2 57194,2439.3 57325,2425.9 57512,2399.5 57670,2349 57693,2341.6 57717,2330.7 57738,2319.8"];
	layer3_allreduce_attn -> layer3_attn_norm_gpu15	[pos="e,58020,2315.1 57224,2449.4 57411,2442.5 57700,2419.9 57940,2349 57964,2342 57989,2330.9 58011,2319.8"];
	layer3_allreduce_moe -> layer3_output_gpu8	[pos="e,56259,1614.1 56948,1745.1 56784,1735.7 56539,1711.2 56336,1648 56313,1640.9 56289,1629.9 56268,1619"];
	layer3_allreduce_moe -> layer3_output_gpu9	[pos="e,56523,1614.1 56982,1733.6 56874,1718.2 56725,1691.2 56598,1648 56576,1640.3 56553,1629.5 56532,1618.8"];
	layer3_allreduce_moe -> layer3_output_gpu10	[pos="e,56798,1614.1 57035,1715.7 56986,1696.6 56924,1672.1 56870,1648 56849,1638.9 56827,1628.5 56807,1618.6"];
	layer3_allreduce_moe -> layer3_output_gpu11	[pos="e,57029,1614.2 57091,1697.2 57073,1673.1 57052,1645 57035,1622.5"];
	layer3_allreduce_moe -> layer3_output_gpu12	[pos="e,57247,1614.2 57175,1698.6 57196,1674 57221,1645.1 57240,1622.1"];
	layer3_allreduce_moe -> layer3_output_gpu13	[pos="e,57483,1614.1 57230,1717.4 57285,1698.4 57352,1673.4 57412,1648 57432,1639.1 57454,1628.7 57474,1618.7"];
	layer3_allreduce_moe -> layer3_output_gpu14	[pos="e,57760,1614.2 57281,1734.3 57394,1719.2 57550,1692.2 57682,1648 57705,1640.3 57729,1629.5 57751,1618.8"];
	layer3_allreduce_moe -> layer3_output_gpu15	[pos="e,58032,1614.1 57315,1745.6 57484,1736.5 57740,1712.3 57954,1648 57977,1640.9 58002,1629.9 58023,1618.8"];
	pipeline_stage0_1 -> layer2_qkv_gpu8	[pos="e,32902,1297 33496,1393 33342,1378.7 33118,1351.7 32926,1304 32922,1302.8 32916,1301.4 32911,1299.9"];
	pipeline_stage0_1 -> layer2_qkv_gpu9	[pos="e,33146,1292.7 33481,1371 33390,1353.2 33281,1330 33184,1304 33175,1301.5 33165,1298.6 33156,1295.7"];
	pipeline_stage0_1 -> layer2_qkv_gpu10	[pos="e,33404,1297.4 33512,1340 33479,1326.9 33444,1313.4 33413,1301.1"];
	pipeline_stage0_1 -> layer2_qkv_gpu11	[pos="e,33598,1304.3 33627,1339.9 33619,1330.6 33611,1321.2 33604,1312.2"];
	pipeline_stage0_1 -> layer2_qkv_gpu12	[pos="e,33767,1304.3 33738,1339.9 33745,1330.6 33753,1321.2 33760,1312.2"];
	pipeline_stage0_1 -> layer2_qkv_gpu13	[pos="e,33960,1297.4 33822,1352.1 33864,1335.3 33910,1317.1 33951,1301.1"];
	pipeline_stage0_1 -> layer2_qkv_gpu14	[pos="e,34225,1291 33840,1378.8 33938,1360 34067,1333.5 34180,1304 34191,1300.9 34203,1297.5 34216,1293.9"];
	pipeline_stage0_1 -> layer2_qkv_gpu15	[pos="e,34492,1291.5 33849,1392.7 34004,1377.4 34242,1349.1 34444,1304 34457,1301.2 34470,1297.9 34483,1294.3"];
}
