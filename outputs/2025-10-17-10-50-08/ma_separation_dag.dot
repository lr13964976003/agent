digraph MA_Separation_MoE_Attention {
	graph [bb="0,0,3149.5,4727.9",
		fontsize=20,
		label="MA Separation: 4-Layer MoE Transformer
12 Attention GPUs + 4 MoE GPUs
Sequence: 2048 tokens, Batch: 1024, Hidden: 4096",
		lheight=0.92,
		lp="1574.8,37",
		lwidth=7.25,
		rankdir=TB,
		size="30,20"
	];
	node [fillcolor=lightcoral,
		label="\N",
		shape=diamond,
		style=filled
	];
	input	[fillcolor=lightblue,
		height=1.041,
		label="INPUT
Input: [batch_size=1024, seq_len=2048, hidden=4096]
GPU: all",
		pos="1559,4690.4",
		shape=ellipse,
		width=8.1121];
	layer1_qkv_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU0
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 0-2
GPU: 0",
		pos="131,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu0	[pos="e,245.23,4611.2 1276.7,4680.7 957.99,4669.7 459.73,4648.1 274,4617 267.82,4615.9 261.53,4614.7 255.2,4613.4"];
	layer1_qkv_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU1
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 3-5
GPU: 1",
		pos="397,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu1	[pos="e,511.24,4610.1 1271.5,4683.8 1067.5,4676.2 787.9,4658.5 545,4617 537.16,4615.6 529.13,4614 521.07,4612.3"];
	layer1_qkv_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU2
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 6-8
GPU: 2",
		pos="668,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu2	[pos="e,782.15,4613.5 1285.8,4677.1 1140,4667.1 958.04,4649.1 798,4617 796.04,4616.6 794.08,4616.1 792.1,4615.7"];
	layer1_qkv_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU3
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 9-11
GPU: 3",
		pos="921,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu3	[pos="e,1035.2,4611.1 1344.4,4664.9 1255.9,4653.1 1152.5,4637 1060,4617 1055.1,4615.9 1050,4614.7 1045,4613.5"];
	layer1_qkv_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU4
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 12-14
GPU: 4",
		pos="1183,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu4	[pos="e,1297.1,4612.1 1444.1,4656 1402.7,4643.8 1355.7,4629.9 1313,4617 1311,4616.4 1309.1,4615.8 1307.1,4615.2"];
	layer1_qkv_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU5
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 15-17
GPU: 5",
		pos="1436,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu5	[pos="e,1480.2,4617.1 1519.4,4653.1 1509.3,4643.8 1498.4,4633.8 1487.8,4624.1"];
	layer1_qkv_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU6
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 18-20
GPU: 6",
		pos="1689,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu6	[pos="e,1642.3,4617.1 1600.8,4653.1 1611.6,4643.7 1623.3,4633.6 1634.6,4623.8"];
	layer1_qkv_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU7
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 21-23
GPU: 7",
		pos="1946,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu7	[pos="e,1832,4611 1676.9,4656 1719.5,4643.9 1767.9,4629.9 1812,4617 1815.4,4616 1818.8,4615 1822.2,4613.9"];
	layer1_qkv_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU8
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 24-26
GPU: 8",
		pos="2205,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu8	[pos="e,2090.7,4611.8 1777.7,4665.6 1868.4,4653.8 1974.3,4637.7 2069,4617 2072.9,4616.1 2076.8,4615.2 2080.8,4614.3"];
	layer1_qkv_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU9
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 27-29
GPU: 9",
		pos="2465,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu9	[pos="e,2350.7,4612 1830.8,4676.7 1978.8,4666.5 2164.6,4648.5 2328,4617 2332.2,4616.1 2336.4,4615.3 2340.7,4614.3"];
	layer1_qkv_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU10
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 30-32
GPU: 10",
		pos="2728,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu10	[pos="e,2613.9,4611.6 1848.5,4685.3 2055.8,4678.5 2340.8,4660.9 2588,4617 2593.3,4616 2598.7,4614.9 2604.1,4613.8"];
	layer1_qkv_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_QKV_Projection_GPU11
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 33-35
GPU: 11",
		pos="2995,4575.5",
		shape=rectangle,
		width=3.1667];
	input -> layer1_qkv_gpu11	[pos="e,2880.8,4611 1841.4,4680.8 2161.8,4669.7 2664,4648.1 2851,4617 2857.5,4615.9 2864.2,4614.6 2870.9,4613.2"];
	layer1_attn_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU0
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 0",
		pos="124,4464",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu0 -> layer1_attn_gpu0	[pos="e,126.13,4498.3 128.39,4533.7 127.86,4525.4 127.3,4516.6 126.77,4508.2"];
	layer1_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="122,4360",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu0 -> layer1_attn_norm_gpu0	[pos="e,122.65,4394.3 123.35,4429.8 123.19,4421.7 123.02,4412.9 122.85,4404.4"];
	layer1_attn_aggregate	[height=1.8889,
		label="L1_Attention_Aggregate
Input: 12×[1024,2048,4096]
Output: [1024,2048,4096]
All-Reduce across GPUs 0-11",
		pos="1563,4222",
		width=6.1944];
	layer1_attn_norm_gpu0 -> layer1_attn_aggregate	[pos="e,1360.6,4228.3 244.24,4327.5 247.18,4326.9 250.11,4326.4 253,4326 636.63,4263 1090,4238.2 1350.3,4228.7"];
	layer1_attn_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU1
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 1",
		pos="385,4464",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu1 -> layer1_attn_gpu1	[pos="e,388.65,4498.3 392.53,4533.7 391.62,4525.4 390.66,4516.6 389.74,4508.2"];
	layer1_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="384,4360",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu1 -> layer1_attn_norm_gpu1	[pos="e,384.33,4394.3 384.68,4429.8 384.6,4421.7 384.51,4412.9 384.43,4404.4"];
	layer1_attn_norm_gpu1 -> layer1_attn_aggregate	[pos="e,1375.9,4232.9 506.25,4327.5 509.19,4327 512.11,4326.5 515,4326 808.95,4274.8 1154,4247 1365.6,4233.6"];
	layer1_attn_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU2
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 2",
		pos="647,4464",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu2 -> layer1_attn_gpu2	[pos="e,653.39,4498.3 660.18,4533.7 658.59,4525.4 656.91,4516.6 655.3,4508.2"];
	layer1_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="646,4360",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu2 -> layer1_attn_norm_gpu2	[pos="e,646.33,4394.3 646.68,4429.8 646.6,4421.7 646.51,4412.9 646.43,4404.4"];
	layer1_attn_norm_gpu2 -> layer1_attn_aggregate	[pos="e,1396.1,4239.1 768.28,4327.7 771.21,4327.1 774.12,4326.5 777,4326 984.52,4286.4 1225.8,4257.2 1385.7,4240.2"];
	layer1_attn_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU3
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 3",
		pos="909,4464",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu3 -> layer1_attn_gpu3	[pos="e,912.65,4498.3 916.53,4533.7 915.62,4525.4 914.66,4516.6 913.74,4508.2"];
	layer1_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="908,4360",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu3 -> layer1_attn_norm_gpu3	[pos="e,908.33,4394.3 908.68,4429.8 908.6,4421.7 908.51,4412.9 908.43,4404.4"];
	layer1_attn_norm_gpu3 -> layer1_attn_aggregate	[pos="e,1425.2,4248 1030.3,4327.9 1033.2,4327.3 1036.1,4326.6 1039,4326 1165.4,4297.6 1310,4269.5 1415.2,4249.9"];
	layer1_attn_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU4
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 4",
		pos="1171,4464",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu4 -> layer1_attn_gpu4	[pos="e,1174.6,4498.3 1178.5,4533.7 1177.6,4525.4 1176.7,4516.6 1175.7,4508.2"];
	layer1_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="1170,4360",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu4 -> layer1_attn_norm_gpu4	[pos="e,1170.3,4394.3 1170.7,4429.8 1170.6,4421.7 1170.5,4412.9 1170.4,4404.4"];
	layer1_attn_norm_gpu4 -> layer1_attn_aggregate	[pos="e,1459.9,4258.6 1265.4,4325.9 1321.1,4306.7 1391.8,4282.2 1450.3,4262"];
	layer1_attn_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU5
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 5",
		pos="1432,4464",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu5 -> layer1_attn_gpu5	[pos="e,1433.2,4498.3 1434.5,4533.7 1434.2,4525.5 1433.9,4516.8 1433.6,4508.5"];
	layer1_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="1432,4360",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu5 -> layer1_attn_norm_gpu5	[pos="e,1432,4394.3 1432,4429.8 1432,4421.7 1432,4412.9 1432,4404.4"];
	layer1_attn_norm_gpu5 -> layer1_attn_aggregate	[pos="e,1512.9,4275 1464,4325.7 1476.7,4312.6 1491.6,4297.1 1505.9,4282.2"];
	layer1_attn_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU6
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 6",
		pos="1693,4464",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu6 -> layer1_attn_gpu6	[pos="e,1691.8,4498.3 1690.5,4533.7 1690.8,4525.5 1691.1,4516.8 1691.4,4508.5"];
	layer1_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="1694,4360",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu6 -> layer1_attn_norm_gpu6	[pos="e,1693.7,4394.3 1693.3,4429.8 1693.4,4421.7 1693.5,4412.9 1693.6,4404.4"];
	layer1_attn_norm_gpu6 -> layer1_attn_aggregate	[pos="e,1613.1,4275 1662,4325.7 1649.3,4312.6 1634.4,4297.1 1620.1,4282.2"];
	layer1_attn_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU7
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 7",
		pos="1955,4464",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu7 -> layer1_attn_gpu7	[pos="e,1952.3,4498.3 1949.4,4533.7 1950,4525.4 1950.8,4516.6 1951.4,4508.2"];
	layer1_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="1956,4360",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu7 -> layer1_attn_norm_gpu7	[pos="e,1955.7,4394.3 1955.3,4429.8 1955.4,4421.7 1955.5,4412.9 1955.6,4404.4"];
	layer1_attn_norm_gpu7 -> layer1_attn_aggregate	[pos="e,1666.1,4258.6 1860.6,4325.9 1804.9,4306.7 1734.2,4282.2 1675.7,4262"];
	layer1_attn_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU8
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 8",
		pos="2217,4464",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu8 -> layer1_attn_gpu8	[pos="e,2213.4,4498.3 2209.5,4533.7 2210.4,4525.4 2211.3,4516.6 2212.3,4508.2"];
	layer1_attn_norm_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU8
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 8",
		pos="2218,4360",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu8 -> layer1_attn_norm_gpu8	[pos="e,2217.7,4394.3 2217.3,4429.8 2217.4,4421.7 2217.5,4412.9 2217.6,4404.4"];
	layer1_attn_norm_gpu8 -> layer1_attn_aggregate	[pos="e,1700.8,4248 2095.7,4327.9 2092.8,4327.3 2089.9,4326.6 2087,4326 1960.6,4297.6 1816,4269.5 1710.8,4249.9"];
	layer1_attn_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU9
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 9",
		pos="2479,4464",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu9 -> layer1_attn_gpu9	[pos="e,2474.7,4498.3 2470.2,4533.7 2471.3,4525.4 2472.4,4516.6 2473.5,4508.2"];
	layer1_attn_norm_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU9
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 9",
		pos="2480,4360",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu9 -> layer1_attn_norm_gpu9	[pos="e,2479.7,4394.3 2479.3,4429.8 2479.4,4421.7 2479.5,4412.9 2479.6,4404.4"];
	layer1_attn_norm_gpu9 -> layer1_attn_aggregate	[pos="e,1729.9,4239.1 2357.7,4327.7 2354.8,4327.1 2351.9,4326.5 2349,4326 2141.5,4286.4 1900.2,4257.2 1740.3,4240.2"];
	layer1_attn_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU10
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 10",
		pos="2746,4464",
		shape=rectangle,
		width=3.5];
	layer1_qkv_gpu10 -> layer1_attn_gpu10	[pos="e,2740.5,4498.3 2734.7,4533.7 2736.1,4525.4 2737.5,4516.6 2738.9,4508.2"];
	layer1_attn_norm_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU10
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 10",
		pos="2747,4360",
		shape=rectangle,
		width=3.5139];
	layer1_attn_gpu10 -> layer1_attn_norm_gpu10	[pos="e,2746.7,4394.3 2746.3,4429.8 2746.4,4421.7 2746.5,4412.9 2746.6,4404.4"];
	layer1_attn_norm_gpu10 -> layer1_attn_aggregate	[pos="e,1749.1,4233.3 2620.4,4327.6 2617.3,4327 2614.1,4326.5 2611,4326 2316.4,4276 1970.8,4247.8 1759.4,4234"];
	layer1_attn_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU11
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 11",
		pos="3017,4464",
		shape=rectangle,
		width=3.5];
	layer1_qkv_gpu11 -> layer1_attn_gpu11	[pos="e,3010.3,4498.3 3003.2,4533.7 3004.9,4525.4 3006.6,4516.6 3008.3,4508.2"];
	layer1_attn_norm_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU11
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 11",
		pos="3018,4360",
		shape=rectangle,
		width=3.5139];
	layer1_attn_gpu11 -> layer1_attn_norm_gpu11	[pos="e,3017.7,4394.3 3017.3,4429.8 3017.4,4421.7 3017.5,4412.9 3017.6,4404.4"];
	layer1_attn_norm_gpu11 -> layer1_attn_aggregate	[pos="e,1764.2,4228.7 2891.4,4327.5 2888.3,4327 2885.1,4326.5 2882,4326 2494.2,4264.2 2036.1,4239 1774.5,4229"];
	layer1_moe_broadcast	[fillcolor=yellow,
		height=1.8889,
		label="L1_Broadcast_to_MoE
Input: [1024,2048,4096]
Output: 4×[1024,2048,4096]
Broadcast to GPUs 12-15",
		pos="1563,4050",
		shape=parallelogram,
		width=6.4509];
	layer1_attn_aggregate -> layer1_moe_broadcast	[pos="e,1563,4118.2 1563,4153.8 1563,4145.5 1563,4136.9 1563,4128.4"];
	layer1_gate_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU12
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 12",
		pos="507,3904.5",
		shape=rectangle,
		width=3.3889];
	layer1_moe_broadcast -> layer1_gate_gpu12	[pos="e,629.22,3922.1 1357.8,4021.1 1145.4,3992.2 819.92,3948 639.31,3923.4"];
	layer1_gate_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU13
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 13",
		pos="1275,3904.5",
		shape=rectangle,
		width=3.3889];
	layer1_moe_broadcast -> layer1_gate_gpu13	[pos="e,1356.3,3946 1428.3,3981.8 1406.9,3971.2 1385.3,3960.4 1365.4,3950.5"];
	layer1_gate_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU14
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 14",
		pos="1851,3904.5",
		shape=rectangle,
		width=3.3889];
	layer1_moe_broadcast -> layer1_gate_gpu14	[pos="e,1769.7,3946 1697.7,3981.8 1719.1,3971.2 1740.7,3960.4 1760.6,3950.5"];
	layer1_gate_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU15
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 15",
		pos="2619,3904.5",
		shape=rectangle,
		width=3.3889];
	layer1_moe_broadcast -> layer1_gate_gpu15	[pos="e,2496.8,3922.1 1731.5,4026.1 1941.3,3997.5 2295.3,3949.4 2486.7,3923.4"];
	layer1_expert12_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="123,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu12 -> layer1_expert12_0	[pos="e,210.18,3823.8 384.66,3875 335.66,3862.6 278.72,3847 219.67,3827.1",
		style=dashed];
	layer1_expert12_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="315,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu12 -> layer1_expert12_1	[pos="e,381.5,3827 440.39,3862.9 424.15,3853 406.68,3842.3 390.08,3832.2",
		style=dashed];
	layer1_expert12_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="507,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu12 -> layer1_expert12_2	[pos="e,507,3827 507,3862.9 507,3854.6 507,3845.8 507,3837.3",
		style=dashed];
	layer1_expert12_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="699,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu12 -> layer1_expert12_3	[pos="e,632.5,3827 573.61,3862.9 589.85,3853 607.32,3842.3 623.92,3832.2",
		style=dashed];
	layer1_moe_aggregate_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU12
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 12",
		pos="507,3674",
		shape=rectangle,
		width=2.9444];
	layer1_expert12_0 -> layer1_moe_aggregate_gpu12	[pos="e,400.85,3696 210.15,3747 213.12,3745.9 216.08,3744.9 219,3744 274.76,3725.6 338.05,3709.9 391.08,3698.2"];
	layer1_expert12_1 -> layer1_moe_aggregate_gpu12	[pos="e,449.06,3708 386.22,3743.8 403.85,3733.8 422.68,3723 440.1,3713.1"];
	layer1_expert12_2 -> layer1_moe_aggregate_gpu12	[pos="e,507,3708.3 507,3743.7 507,3735.5 507,3726.8 507,3718.5"];
	layer1_expert12_3 -> layer1_moe_aggregate_gpu12	[pos="e,564.94,3708 627.78,3743.8 610.15,3733.8 591.32,3723 573.9,3713.1"];
	layer1_moe_norm_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU12
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 12",
		pos="1156,3570",
		shape=rectangle,
		width=3.5139];
	layer1_moe_aggregate_gpu12 -> layer1_moe_norm_gpu12	[pos="e,1029.3,3590.9 613.08,3656.3 723.89,3638.9 898.13,3611.5 1019.2,3592.4"];
	layer2_qkv_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU0
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 0-2
GPU: 0",
		pos="210,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu0	[pos="e,324,3498 1029.2,3567.5 868.61,3563.6 583.7,3549.8 333.99,3500"];
	layer2_qkv_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU1
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 3-5
GPU: 1",
		pos="456,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu1	[pos="e,570.03,3497.9 1029.3,3561.1 913.97,3552.2 739.24,3534.7 580.01,3500.1"];
	layer2_qkv_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU2
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 6-8
GPU: 2",
		pos="702,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu2	[pos="e,816.12,3497.5 1029.5,3546 970.12,3534.5 898.37,3519.3 825.89,3500.1"];
	layer2_qkv_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU3
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 9-11
GPU: 3",
		pos="948,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu3	[pos="e,1025.3,3500.1 1093.3,3536 1074.7,3526.2 1054.1,3515.3 1034.3,3504.9"];
	layer2_qkv_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU4
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 12-14
GPU: 4",
		pos="1194,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu4	[pos="e,1179.8,3500.2 1167.5,3535.8 1170.4,3527.6 1173.5,3518.6 1176.6,3509.7"];
	layer2_qkv_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU5
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 15-17
GPU: 5",
		pos="1440,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu5	[pos="e,1334.7,3500 1241.6,3536 1267.9,3525.8 1297.4,3514.4 1325.3,3503.7"];
	layer2_qkv_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU6
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 18-20
GPU: 6",
		pos="1686,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu6	[pos="e,1572,3497.8 1282.7,3537.5 1285.5,3537 1288.3,3536.5 1291,3536 1407.7,3514 1442.3,3526.4 1562,3500"];
	layer2_qkv_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU7
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 21-23
GPU: 7",
		pos="1932,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu7	[pos="e,1817.7,3498.1 1282.7,3537.3 1285.5,3536.8 1288.3,3536.4 1291,3536 1515.8,3500.9 1580.7,3543.2 1807.8,3500"];
	layer2_qkv_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU8
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 24-26
GPU: 8",
		pos="2178,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu8	[pos="e,2063.7,3498.2 1282.7,3537.2 1285.5,3536.8 1288.3,3536.3 1291,3536 1624.2,3487.8 1718.9,3560.2 2053.7,3500"];
	layer2_qkv_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU9
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 27-29
GPU: 9",
		pos="2424,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu9	[pos="e,2309.7,3498.3 1282.7,3537.2 1285.5,3536.7 1288.3,3536.3 1291,3536 1732.7,3474.8 1857,3577.5 2299.8,3500"];
	layer2_qkv_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU10
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 30-32
GPU: 10",
		pos="2670,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu10	[pos="e,2555.7,3498.3 1282.7,3537.2 1285.5,3536.7 1288.3,3536.3 1291,3536 1564.5,3499 2255.5,3547 2545.6,3500"];
	layer2_qkv_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_QKV_Projection_GPU11
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 33-35
GPU: 11",
		pos="2916,3458.5",
		shape=rectangle,
		width=3.1667];
	layer1_moe_norm_gpu12 -> layer2_qkv_gpu11	[pos="e,2801.7,3498.3 1282.7,3537.1 1285.5,3536.7 1288.2,3536.3 1291,3536 1618.7,3492.5 2447.6,3555.5 2791.7,3500"];
	layer1_expert13_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="891,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu13 -> layer1_expert13_4	[pos="e,978.18,3823.8 1152.7,3875 1103.7,3862.6 1046.7,3847 987.67,3827.1",
		style=dashed];
	layer1_expert13_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1083,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu13 -> layer1_expert13_5	[pos="e,1149.5,3827 1208.4,3862.9 1192.2,3853 1174.7,3842.3 1158.1,3832.2",
		style=dashed];
	layer1_expert13_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1275,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu13 -> layer1_expert13_6	[pos="e,1275,3827 1275,3862.9 1275,3854.6 1275,3845.8 1275,3837.3",
		style=dashed];
	layer1_expert13_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1467,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu13 -> layer1_expert13_7	[pos="e,1400.5,3827 1341.6,3862.9 1357.8,3853 1375.3,3842.3 1391.9,3832.2",
		style=dashed];
	layer1_moe_aggregate_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU13
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 13",
		pos="1275,3674",
		shape=rectangle,
		width=2.9444];
	layer1_expert13_4 -> layer1_moe_aggregate_gpu13	[pos="e,1168.9,3696 978.15,3747 981.12,3745.9 984.08,3744.9 987,3744 1042.8,3725.6 1106.1,3709.9 1159.1,3698.2"];
	layer1_expert13_5 -> layer1_moe_aggregate_gpu13	[pos="e,1217.1,3708 1154.2,3743.8 1171.9,3733.8 1190.7,3723 1208.1,3713.1"];
	layer1_expert13_6 -> layer1_moe_aggregate_gpu13	[pos="e,1275,3708.3 1275,3743.7 1275,3735.5 1275,3726.8 1275,3718.5"];
	layer1_expert13_7 -> layer1_moe_aggregate_gpu13	[pos="e,1332.9,3708 1395.8,3743.8 1378.1,3733.8 1359.3,3723 1341.9,3713.1"];
	layer1_moe_norm_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU13
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 13",
		pos="1427,3570",
		shape=rectangle,
		width=3.5139];
	layer1_moe_aggregate_gpu13 -> layer1_moe_norm_gpu13	[pos="e,1377.6,3604.1 1324.4,3639.8 1338.6,3630.3 1354.3,3619.7 1369.1,3609.8"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu0	[pos="e,324.31,3498.3 1300.5,3537.4 1297.3,3536.9 1294.1,3536.4 1291,3536 872.26,3477.9 754.2,3573.8 334.28,3500"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu1	[pos="e,570.31,3498.2 1300.5,3537.4 1297.3,3536.9 1294.1,3536.4 1291,3536 980.81,3490.9 892.38,3556.6 580.55,3500.1"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu2	[pos="e,816.33,3498.1 1300.4,3537.5 1297.3,3537 1294.1,3536.4 1291,3536 1089.1,3503.9 1030.5,3539.6 826.18,3500"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu3	[pos="e,1062.1,3497.7 1300.4,3537.9 1297.2,3537.2 1294.1,3536.6 1291,3536 1197,3516.9 1169,3523.1 1072,3500.1"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu4	[pos="e,1280.6,3500.1 1356.8,3536 1335.7,3526 1312.2,3515 1289.8,3504.5"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu5	[pos="e,1435.2,3500.2 1430.9,3535.8 1431.9,3527.7 1432.9,3519 1434,3510.3"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu6	[pos="e,1589.8,3500.1 1505.1,3536 1528.8,3525.9 1555.3,3514.7 1580.5,3504"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu7	[pos="e,1817.9,3497.8 1553.8,3537.6 1556.5,3537 1559.3,3536.5 1562,3536 1667.7,3515.4 1699.2,3524.8 1807.9,3500.1"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu8	[pos="e,2063.7,3498.1 1553.7,3537.3 1556.5,3536.8 1559.3,3536.4 1562,3536 1775.7,3502.3 1837.6,3541.4 2053.6,3500.1"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu9	[pos="e,2309.7,3498.2 1553.7,3537.2 1556.5,3536.8 1559.3,3536.4 1562,3536 1884.1,3489.2 1975.8,3558.5 2299.5,3500.1"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu10	[pos="e,2555.7,3498.3 1553.7,3537.2 1556.5,3536.7 1559.3,3536.3 1562,3536 1992.6,3476.1 2114,3575.7 2545.8,3500"];
	layer1_moe_norm_gpu13 -> layer2_qkv_gpu11	[pos="e,2801.7,3498.3 1553.7,3537.2 1556.5,3536.7 1559.3,3536.3 1562,3536 2101.1,3463 2252,3592.9 2791.7,3500"];
	layer1_expert14_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="1659,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu14 -> layer1_expert14_8	[pos="e,1725.5,3827 1784.4,3862.9 1768.2,3853 1750.7,3842.3 1734.1,3832.2",
		style=dashed];
	layer1_expert14_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="1851,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu14 -> layer1_expert14_9	[pos="e,1851,3827 1851,3862.9 1851,3854.6 1851,3845.8 1851,3837.3",
		style=dashed];
	layer1_expert14_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="2043,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu14 -> layer1_expert14_10	[pos="e,1976.5,3827 1917.6,3862.9 1933.8,3853 1951.3,3842.3 1967.9,3832.2",
		style=dashed];
	layer1_expert14_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="2235,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu14 -> layer1_expert14_11	[pos="e,2147.8,3823.8 1973.3,3875 2022.3,3862.6 2079.3,3847 2138.3,3827.1",
		style=dashed];
	layer1_moe_aggregate_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU14
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 14",
		pos="1851,3674",
		shape=rectangle,
		width=2.9444];
	layer1_expert14_8 -> layer1_moe_aggregate_gpu14	[pos="e,1793.1,3708 1730.2,3743.8 1747.9,3733.8 1766.7,3723 1784.1,3713.1"];
	layer1_expert14_9 -> layer1_moe_aggregate_gpu14	[pos="e,1851,3708.3 1851,3743.7 1851,3735.5 1851,3726.8 1851,3718.5"];
	layer1_expert14_10 -> layer1_moe_aggregate_gpu14	[pos="e,1908.9,3708 1971.8,3743.8 1954.1,3733.8 1935.3,3723 1917.9,3713.1"];
	layer1_expert14_11 -> layer1_moe_aggregate_gpu14	[pos="e,1957.1,3696 2147.9,3747 2144.9,3745.9 2141.9,3744.9 2139,3744 2083.2,3725.6 2019.9,3709.9 1966.9,3698.2"];
	layer1_moe_norm_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU14
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 14",
		pos="1698,3570",
		shape=rectangle,
		width=3.5139];
	layer1_moe_aggregate_gpu14 -> layer1_moe_norm_gpu14	[pos="e,1747.7,3604.1 1801.3,3639.8 1787,3630.3 1771.1,3619.7 1756.3,3609.8"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu0	[pos="e,324.3,3498.3 1571.5,3537.3 1568.3,3536.8 1565.1,3536.4 1562,3536 1023.7,3463.6 873.07,3592.8 334.27,3500"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu1	[pos="e,570.3,3498.3 1571.5,3537.4 1568.3,3536.9 1565.1,3536.4 1562,3536 1132.2,3476.6 1011.2,3575.6 580.22,3500"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu2	[pos="e,816.31,3498.2 1571.5,3537.4 1568.3,3536.9 1565.1,3536.4 1562,3536 1240.7,3489.6 1149.3,3558.3 826.42,3500.1"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu3	[pos="e,1062.3,3498.1 1571.5,3537.5 1568.3,3537 1565.1,3536.4 1562,3536 1349.1,3502.6 1287.5,3541.3 1072.4,3500.1"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu4	[pos="e,1308.1,3497.7 1571.4,3537.8 1568.2,3537.2 1565.1,3536.6 1562,3536 1457.1,3515.6 1425.9,3524.7 1318,3500.1"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu5	[pos="e,1535.9,3500.1 1620.2,3536 1596.7,3526 1570.4,3514.8 1545.4,3504.2"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu6	[pos="e,1690.5,3500.2 1694.4,3535.8 1693.5,3527.7 1692.5,3519 1691.6,3510.3"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu7	[pos="e,1845.1,3500.1 1768.5,3536 1789.7,3526 1813.3,3515 1835.8,3504.5"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu8	[pos="e,2063.9,3497.7 1824.8,3537.7 1827.5,3537.1 1830.3,3536.5 1833,3536 1927.8,3516.7 1956.1,3523.2 2053.9,3500.1"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu9	[pos="e,2309.7,3498.1 1824.7,3537.3 1827.5,3536.9 1830.3,3536.4 1833,3536 2035.8,3503.6 2094.6,3539.7 2299.8,3500"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu10	[pos="e,2555.7,3498.2 1824.7,3537.2 1827.5,3536.8 1830.3,3536.4 1833,3536 2144,3490.5 2232.7,3556.7 2545.4,3500.1"];
	layer1_moe_norm_gpu14 -> layer2_qkv_gpu11	[pos="e,2801.7,3498.3 1824.7,3537.2 1827.5,3536.8 1830.3,3536.3 1833,3536 2252.6,3477.4 2370.9,3573.9 2791.7,3500"];
	layer1_expert15_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2427,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu15 -> layer1_expert15_12	[pos="e,2493.5,3827 2552.4,3862.9 2536.2,3853 2518.7,3842.3 2502.1,3832.2",
		style=dashed];
	layer1_expert15_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2619,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu15 -> layer1_expert15_13	[pos="e,2619,3827 2619,3862.9 2619,3854.6 2619,3845.8 2619,3837.3",
		style=dashed];
	layer1_expert15_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2811,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu15 -> layer1_expert15_14	[pos="e,2744.5,3827 2685.6,3862.9 2701.8,3853 2719.3,3842.3 2735.9,3832.2",
		style=dashed];
	layer1_expert15_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="3003,3785.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu15 -> layer1_expert15_15	[pos="e,2915.8,3823.8 2741.3,3875 2790.3,3862.6 2847.3,3847 2906.3,3827.1",
		style=dashed];
	layer1_moe_aggregate_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU15
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 15",
		pos="2619,3674",
		shape=rectangle,
		width=2.9444];
	layer1_expert15_12 -> layer1_moe_aggregate_gpu15	[pos="e,2561.1,3708 2498.2,3743.8 2515.9,3733.8 2534.7,3723 2552.1,3713.1"];
	layer1_expert15_13 -> layer1_moe_aggregate_gpu15	[pos="e,2619,3708.3 2619,3743.7 2619,3735.5 2619,3726.8 2619,3718.5"];
	layer1_expert15_14 -> layer1_moe_aggregate_gpu15	[pos="e,2676.9,3708 2739.8,3743.8 2722.1,3733.8 2703.3,3723 2685.9,3713.1"];
	layer1_expert15_15 -> layer1_moe_aggregate_gpu15	[pos="e,2725.1,3696 2915.9,3747 2912.9,3745.9 2909.9,3744.9 2907,3744 2851.2,3725.6 2787.9,3709.9 2734.9,3698.2"];
	layer1_moe_norm_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU15
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 15",
		pos="1969,3570",
		shape=rectangle,
		width=3.5139];
	layer1_moe_aggregate_gpu15 -> layer1_moe_norm_gpu15	[pos="e,2095.6,3590.8 2512.8,3656.3 2401.7,3638.9 2227,3611.4 2105.7,3592.4"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu0	[pos="e,324.3,3498.3 1842.5,3537.3 1839.3,3536.8 1836.1,3536.4 1833,3536 1505.7,3492.8 677.94,3555.5 334.32,3500"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu1	[pos="e,570.3,3498.3 1842.5,3537.3 1839.3,3536.8 1836.1,3536.4 1833,3536 1559.9,3499.3 870.02,3546.9 580.43,3500"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu2	[pos="e,816.3,3498.3 1842.5,3537.4 1839.3,3536.9 1836.1,3536.4 1833,3536 1392.3,3475.2 1268.2,3577.3 826.46,3500.1"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu3	[pos="e,1062.3,3498.2 1842.5,3537.4 1839.3,3536.9 1836.1,3536.4 1833,3536 1500.7,3488.2 1406.2,3560.1 1072.3,3500"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu4	[pos="e,1308.3,3498.1 1842.5,3537.5 1839.3,3537 1836.1,3536.4 1833,3536 1609,3501.2 1544.4,3543 1318.2,3500"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu5	[pos="e,1554,3497.8 1842.4,3537.8 1839.2,3537.1 1836.1,3536.5 1833,3536 1717.1,3514.2 1682.8,3526.3 1563.9,3500"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu6	[pos="e,1790.9,3500 1883.7,3536 1857.5,3525.8 1828.1,3514.4 1800.3,3503.7"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu7	[pos="e,1945.8,3500.2 1957.8,3535.8 1955,3527.6 1952,3518.6 1949,3509.7"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu8	[pos="e,2100.4,3500.1 2032,3536 2050.6,3526.2 2071.4,3515.3 2091.3,3504.9"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu9	[pos="e,2309.9,3497.5 2095.5,3546.2 2155.1,3534.6 2227.2,3519.3 2300.1,3500.1"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu10	[pos="e,2556,3497.9 2095.7,3561.1 2211.2,3552.3 2386.3,3534.7 2546,3500.1"];
	layer1_moe_norm_gpu15 -> layer2_qkv_gpu11	[pos="e,2802,3498 2095.6,3567.5 2256.3,3563.7 2541.8,3549.9 2792,3500"];
	layer2_attn_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU0
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 0",
		pos="125,3347",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu0 -> layer2_attn_gpu0	[pos="e,150.85,3381.3 178.35,3416.7 171.41,3407.7 164.06,3398.3 157.1,3389.3"];
	layer2_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="123,3243",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu0 -> layer2_attn_norm_gpu0	[pos="e,123.65,3277.3 124.35,3312.8 124.19,3304.7 124.02,3295.9 123.85,3287.4"];
	layer2_attn_aggregate	[height=1.8889,
		label="L2_Attention_Aggregate
Input: 12×[1024,2048,4096]
Output: [1024,2048,4096]
All-Reduce across GPUs 0-11",
		pos="1564,3105",
		width=6.1944];
	layer2_attn_norm_gpu0 -> layer2_attn_aggregate	[pos="e,1361.6,3111.3 245.24,3210.5 248.18,3209.9 251.11,3209.4 254,3209 637.63,3146 1091,3121.2 1351.3,3111.7"];
	layer2_attn_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU1
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 1",
		pos="387,3347",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu1 -> layer2_attn_gpu1	[pos="e,407.98,3381.3 430.31,3416.7 424.79,3407.9 418.95,3398.7 413.41,3389.9"];
	layer2_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="385,3243",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu1 -> layer2_attn_norm_gpu1	[pos="e,385.65,3277.3 386.35,3312.8 386.19,3304.7 386.02,3295.9 385.85,3287.4"];
	layer2_attn_norm_gpu1 -> layer2_attn_aggregate	[pos="e,1376.9,3115.9 507.25,3210.5 510.19,3210 513.11,3209.5 516,3209 809.95,3157.8 1155,3130 1366.6,3116.6"];
	layer2_attn_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU2
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 2",
		pos="649,3347",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu2 -> layer2_attn_gpu2	[pos="e,665.12,3381.3 682.26,3416.7 678.11,3408.1 673.73,3399 669.55,3390.4"];
	layer2_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="647,3243",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu2 -> layer2_attn_norm_gpu2	[pos="e,647.65,3277.3 648.35,3312.8 648.19,3304.7 648.02,3295.9 647.85,3287.4"];
	layer2_attn_norm_gpu2 -> layer2_attn_aggregate	[pos="e,1397.1,3122.1 769.28,3210.7 772.21,3210.1 775.12,3209.5 778,3209 985.52,3169.4 1226.8,3140.2 1386.7,3123.2"];
	layer2_attn_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU3
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 3",
		pos="910,3347",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu3 -> layer2_attn_gpu3	[pos="e,921.56,3381.3 933.85,3416.7 930.94,3408.3 927.86,3399.4 924.92,3391"];
	layer2_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="909,3243",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu3 -> layer2_attn_norm_gpu3	[pos="e,909.33,3277.3 909.68,3312.8 909.6,3304.7 909.51,3295.9 909.43,3287.4"];
	layer2_attn_norm_gpu3 -> layer2_attn_aggregate	[pos="e,1426.2,3131 1031.3,3210.9 1034.2,3210.3 1037.1,3209.6 1040,3209 1166.4,3180.6 1311,3152.5 1416.2,3132.9"];
	layer2_attn_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU4
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 4",
		pos="1172,3347",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu4 -> layer2_attn_gpu4	[pos="e,1178.7,3381.3 1185.8,3416.7 1184.1,3408.4 1182.4,3399.6 1180.7,3391.2"];
	layer2_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="1171,3243",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu4 -> layer2_attn_norm_gpu4	[pos="e,1171.3,3277.3 1171.7,3312.8 1171.6,3304.7 1171.5,3295.9 1171.4,3287.4"];
	layer2_attn_norm_gpu4 -> layer2_attn_aggregate	[pos="e,1460.9,3141.6 1266.4,3208.9 1322.1,3189.7 1392.8,3165.2 1451.3,3145"];
	layer2_attn_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU5
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 5",
		pos="1433,3347",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu5 -> layer2_attn_gpu5	[pos="e,1435.1,3381.3 1437.4,3416.7 1436.9,3408.4 1436.3,3399.6 1435.8,3391.2"];
	layer2_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="1433,3243",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu5 -> layer2_attn_norm_gpu5	[pos="e,1433,3277.3 1433,3312.8 1433,3304.7 1433,3295.9 1433,3287.4"];
	layer2_attn_norm_gpu5 -> layer2_attn_aggregate	[pos="e,1513.9,3158 1465,3208.7 1477.7,3195.6 1492.6,3180.1 1506.9,3165.2"];
	layer2_attn_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU6
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 6",
		pos="1694,3347",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu6 -> layer2_attn_gpu6	[pos="e,1691.6,3381.3 1689,3416.7 1689.6,3408.4 1690.2,3399.6 1690.8,3391.2"];
	layer2_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="1695,3243",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu6 -> layer2_attn_norm_gpu6	[pos="e,1694.7,3277.3 1694.3,3312.8 1694.4,3304.7 1694.5,3295.9 1694.6,3287.4"];
	layer2_attn_norm_gpu6 -> layer2_attn_aggregate	[pos="e,1614.1,3158 1663,3208.7 1650.3,3195.6 1635.4,3180.1 1621.1,3165.2"];
	layer2_attn_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU7
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 7",
		pos="1956,3347",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu7 -> layer2_attn_gpu7	[pos="e,1948.7,3381.3 1940.9,3416.7 1942.8,3408.4 1944.7,3399.6 1946.5,3391.2"];
	layer2_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="1957,3243",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu7 -> layer2_attn_norm_gpu7	[pos="e,1956.7,3277.3 1956.3,3312.8 1956.4,3304.7 1956.5,3295.9 1956.6,3287.4"];
	layer2_attn_norm_gpu7 -> layer2_attn_aggregate	[pos="e,1667.1,3141.6 1861.6,3208.9 1805.9,3189.7 1735.2,3165.2 1676.7,3145"];
	layer2_attn_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU8
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 8",
		pos="2218,3347",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu8 -> layer2_attn_gpu8	[pos="e,2205.8,3381.3 2192.9,3416.7 2196,3408.2 2199.3,3399.2 2202.4,3390.7"];
	layer2_attn_norm_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU8
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 8",
		pos="2219,3243",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu8 -> layer2_attn_norm_gpu8	[pos="e,2218.7,3277.3 2218.3,3312.8 2218.4,3304.7 2218.5,3295.9 2218.6,3287.4"];
	layer2_attn_norm_gpu8 -> layer2_attn_aggregate	[pos="e,1701.8,3131 2096.7,3210.9 2093.8,3210.3 2090.9,3209.6 2088,3209 1961.6,3180.6 1817,3152.5 1711.8,3132.9"];
	layer2_attn_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU9
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 9",
		pos="2480,3347",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu9 -> layer2_attn_gpu9	[pos="e,2463,3381.3 2444.9,3416.7 2449.2,3408.1 2453.9,3399 2458.3,3390.4"];
	layer2_attn_norm_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU9
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 9",
		pos="2481,3243",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu9 -> layer2_attn_norm_gpu9	[pos="e,2480.7,3277.3 2480.3,3312.8 2480.4,3304.7 2480.5,3295.9 2480.6,3287.4"];
	layer2_attn_norm_gpu9 -> layer2_attn_aggregate	[pos="e,1730.9,3122.1 2358.7,3210.7 2355.8,3210.1 2352.9,3209.5 2350,3209 2142.5,3169.4 1901.2,3140.2 1741.3,3123.2"];
	layer2_attn_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU10
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 10",
		pos="2747,3347",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu10 -> layer2_attn_gpu10	[pos="e,2723.6,3381.3 2698.7,3416.7 2704.9,3407.8 2711.5,3398.5 2717.7,3389.6"];
	layer2_attn_norm_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU10
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 10",
		pos="2748,3243",
		shape=rectangle,
		width=3.5139];
	layer2_attn_gpu10 -> layer2_attn_norm_gpu10	[pos="e,2747.7,3277.3 2747.3,3312.8 2747.4,3304.7 2747.5,3295.9 2747.6,3287.4"];
	layer2_attn_norm_gpu10 -> layer2_attn_aggregate	[pos="e,1750.1,3116.3 2621.4,3210.6 2618.3,3210 2615.1,3209.5 2612,3209 2317.4,3159 1971.8,3130.8 1760.4,3117"];
	layer2_attn_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU11
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 11",
		pos="3018,3347",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu11 -> layer2_attn_gpu11	[pos="e,2987,3381.3 2954,3416.7 2962.5,3407.6 2971.5,3397.9 2980,3388.8"];
	layer2_attn_norm_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU11
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 11",
		pos="3019,3243",
		shape=rectangle,
		width=3.5139];
	layer2_attn_gpu11 -> layer2_attn_norm_gpu11	[pos="e,3018.7,3277.3 3018.3,3312.8 3018.4,3304.7 3018.5,3295.9 3018.6,3287.4"];
	layer2_attn_norm_gpu11 -> layer2_attn_aggregate	[pos="e,1765.2,3111.7 2892.4,3210.5 2889.3,3210 2886.1,3209.5 2883,3209 2495.2,3147.2 2037.1,3122 1775.5,3112"];
	layer2_moe_broadcast	[fillcolor=yellow,
		height=1.8889,
		label="L2_Broadcast_to_MoE
Input: [1024,2048,4096]
Output: 4×[1024,2048,4096]
Broadcast to GPUs 12-15",
		pos="1564,2933",
		shape=parallelogram,
		width=6.4509];
	layer2_attn_aggregate -> layer2_moe_broadcast	[pos="e,1564,3001.2 1564,3036.8 1564,3028.5 1564,3019.9 1564,3011.4"];
	layer2_gate_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU12
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 12",
		pos="508,2787.5",
		shape=rectangle,
		width=3.3889];
	layer2_moe_broadcast -> layer2_gate_gpu12	[pos="e,630.22,2805.1 1358.8,2904.1 1146.4,2875.2 820.92,2831 640.31,2806.4"];
	layer2_gate_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU13
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 13",
		pos="1276,2787.5",
		shape=rectangle,
		width=3.3889];
	layer2_moe_broadcast -> layer2_gate_gpu13	[pos="e,1357.3,2829 1429.3,2864.8 1407.9,2854.2 1386.3,2843.4 1366.4,2833.5"];
	layer2_gate_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU14
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 14",
		pos="1852,2787.5",
		shape=rectangle,
		width=3.3889];
	layer2_moe_broadcast -> layer2_gate_gpu14	[pos="e,1770.7,2829 1698.7,2864.8 1720.1,2854.2 1741.7,2843.4 1761.6,2833.5"];
	layer2_gate_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU15
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 15",
		pos="2620,2787.5",
		shape=rectangle,
		width=3.3889];
	layer2_moe_broadcast -> layer2_gate_gpu15	[pos="e,2497.8,2805.1 1732.5,2909.1 1942.3,2880.5 2296.3,2832.4 2487.7,2806.4"];
	layer2_expert12_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="124,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_0	[pos="e,211.18,2706.8 385.66,2758 336.66,2745.6 279.72,2730 220.67,2710.1",
		style=dashed];
	layer2_expert12_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="316,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_1	[pos="e,382.5,2710 441.39,2745.9 425.15,2736 407.68,2725.3 391.08,2715.2",
		style=dashed];
	layer2_expert12_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="508,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_2	[pos="e,508,2710 508,2745.9 508,2737.6 508,2728.8 508,2720.3",
		style=dashed];
	layer2_expert12_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="700,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_3	[pos="e,633.5,2710 574.61,2745.9 590.85,2736 608.32,2725.3 624.92,2715.2",
		style=dashed];
	layer2_moe_aggregate_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU12
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 12",
		pos="508,2557",
		shape=rectangle,
		width=2.9444];
	layer2_expert12_0 -> layer2_moe_aggregate_gpu12	[pos="e,401.85,2579 211.15,2630 214.12,2628.9 217.08,2627.9 220,2627 275.76,2608.6 339.05,2592.9 392.08,2581.2"];
	layer2_expert12_1 -> layer2_moe_aggregate_gpu12	[pos="e,450.06,2591 387.22,2626.8 404.85,2616.8 423.68,2606 441.1,2596.1"];
	layer2_expert12_2 -> layer2_moe_aggregate_gpu12	[pos="e,508,2591.3 508,2626.7 508,2618.5 508,2609.8 508,2601.5"];
	layer2_expert12_3 -> layer2_moe_aggregate_gpu12	[pos="e,565.94,2591 628.78,2626.8 611.15,2616.8 592.32,2606 574.9,2596.1"];
	layer2_moe_norm_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU12
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 12",
		pos="1158,2453",
		shape=rectangle,
		width=3.5139];
	layer2_moe_aggregate_gpu12 -> layer2_moe_norm_gpu12	[pos="e,1031.4,2473.8 614.24,2539.3 725.31,2521.9 900.01,2494.4 1021.3,2475.4"];
	layer3_qkv_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU0
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 0-2
GPU: 0",
		pos="212,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu0	[pos="e,326,2381 1031.2,2450.5 870.61,2446.6 585.7,2432.8 335.99,2383"];
	layer3_qkv_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU1
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 3-5
GPU: 1",
		pos="458,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu1	[pos="e,572.03,2380.9 1031.3,2444.1 915.97,2435.2 741.24,2417.7 582.01,2383.1"];
	layer3_qkv_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU2
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 6-8
GPU: 2",
		pos="704,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu2	[pos="e,818.12,2380.5 1031.5,2429 972.12,2417.5 900.37,2402.3 827.89,2383.1"];
	layer3_qkv_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU3
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 9-11
GPU: 3",
		pos="950,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu3	[pos="e,1027.3,2383.1 1095.3,2419 1076.7,2409.2 1056.1,2398.3 1036.3,2387.9"];
	layer3_qkv_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU4
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 12-14
GPU: 4",
		pos="1196,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu4	[pos="e,1181.8,2383.2 1169.5,2418.8 1172.4,2410.6 1175.5,2401.6 1178.6,2392.7"];
	layer3_qkv_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU5
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 15-17
GPU: 5",
		pos="1442,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu5	[pos="e,1336.7,2383 1243.6,2419 1269.9,2408.8 1299.4,2397.4 1327.3,2386.7"];
	layer3_qkv_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU6
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 18-20
GPU: 6",
		pos="1688,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu6	[pos="e,1574,2380.8 1284.7,2420.5 1287.5,2420 1290.3,2419.5 1293,2419 1409.7,2397 1444.3,2409.4 1564,2383"];
	layer3_qkv_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU7
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 21-23
GPU: 7",
		pos="1934,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu7	[pos="e,1819.7,2381.1 1284.7,2420.3 1287.5,2419.8 1290.3,2419.4 1293,2419 1517.8,2383.9 1582.7,2426.2 1809.8,2383"];
	layer3_qkv_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU8
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 24-26
GPU: 8",
		pos="2180,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu8	[pos="e,2065.7,2381.2 1284.7,2420.2 1287.5,2419.8 1290.3,2419.3 1293,2419 1626.2,2370.8 1720.9,2443.2 2055.7,2383"];
	layer3_qkv_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU9
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 27-29
GPU: 9",
		pos="2426,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu9	[pos="e,2311.7,2381.3 1284.7,2420.2 1287.5,2419.7 1290.3,2419.3 1293,2419 1734.7,2357.8 1859,2460.5 2301.8,2383"];
	layer3_qkv_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU10
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 30-32
GPU: 10",
		pos="2672,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu10	[pos="e,2557.7,2381.3 1284.7,2420.2 1287.5,2419.7 1290.3,2419.3 1293,2419 1566.5,2382 2257.5,2430 2547.6,2383"];
	layer3_qkv_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_QKV_Projection_GPU11
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 33-35
GPU: 11",
		pos="2918,2341.5",
		shape=rectangle,
		width=3.1667];
	layer2_moe_norm_gpu12 -> layer3_qkv_gpu11	[pos="e,2803.7,2381.3 1284.7,2420.1 1287.5,2419.7 1290.2,2419.3 1293,2419 1620.7,2375.5 2449.6,2438.5 2793.7,2383"];
	layer2_expert13_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="892,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_4	[pos="e,979.18,2706.8 1153.7,2758 1104.7,2745.6 1047.7,2730 988.67,2710.1",
		style=dashed];
	layer2_expert13_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1084,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_5	[pos="e,1150.5,2710 1209.4,2745.9 1193.2,2736 1175.7,2725.3 1159.1,2715.2",
		style=dashed];
	layer2_expert13_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1276,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_6	[pos="e,1276,2710 1276,2745.9 1276,2737.6 1276,2728.8 1276,2720.3",
		style=dashed];
	layer2_expert13_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1468,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_7	[pos="e,1401.5,2710 1342.6,2745.9 1358.8,2736 1376.3,2725.3 1392.9,2715.2",
		style=dashed];
	layer2_moe_aggregate_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU13
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 13",
		pos="1276,2557",
		shape=rectangle,
		width=2.9444];
	layer2_expert13_4 -> layer2_moe_aggregate_gpu13	[pos="e,1169.9,2579 979.15,2630 982.12,2628.9 985.08,2627.9 988,2627 1043.8,2608.6 1107.1,2592.9 1160.1,2581.2"];
	layer2_expert13_5 -> layer2_moe_aggregate_gpu13	[pos="e,1218.1,2591 1155.2,2626.8 1172.9,2616.8 1191.7,2606 1209.1,2596.1"];
	layer2_expert13_6 -> layer2_moe_aggregate_gpu13	[pos="e,1276,2591.3 1276,2626.7 1276,2618.5 1276,2609.8 1276,2601.5"];
	layer2_expert13_7 -> layer2_moe_aggregate_gpu13	[pos="e,1333.9,2591 1396.8,2626.8 1379.1,2616.8 1360.3,2606 1342.9,2596.1"];
	layer2_moe_norm_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU13
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 13",
		pos="1429,2453",
		shape=rectangle,
		width=3.5139];
	layer2_moe_aggregate_gpu13 -> layer2_moe_norm_gpu13	[pos="e,1379.3,2487.1 1325.7,2522.8 1340,2513.3 1355.9,2502.7 1370.7,2492.8"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu0	[pos="e,326.31,2381.3 1302.5,2420.4 1299.3,2419.9 1296.1,2419.4 1293,2419 874.26,2360.9 756.2,2456.8 336.28,2383"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu1	[pos="e,572.31,2381.2 1302.5,2420.4 1299.3,2419.9 1296.1,2419.4 1293,2419 982.81,2373.9 894.38,2439.6 582.55,2383.1"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu2	[pos="e,818.33,2381.1 1302.4,2420.5 1299.3,2420 1296.1,2419.4 1293,2419 1091.1,2386.9 1032.5,2422.6 828.18,2383"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu3	[pos="e,1064.1,2380.7 1302.4,2420.9 1299.2,2420.2 1296.1,2419.6 1293,2419 1199,2399.9 1171,2406.1 1074,2383.1"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu4	[pos="e,1282.6,2383.1 1358.8,2419 1337.7,2409 1314.2,2398 1291.8,2387.5"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu5	[pos="e,1437.2,2383.2 1432.9,2418.8 1433.9,2410.7 1434.9,2402 1436,2393.3"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu6	[pos="e,1591.8,2383.1 1507.1,2419 1530.8,2408.9 1557.3,2397.7 1582.5,2387"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu7	[pos="e,1819.9,2380.8 1555.8,2420.6 1558.5,2420 1561.3,2419.5 1564,2419 1669.7,2398.4 1701.2,2407.8 1809.9,2383.1"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu8	[pos="e,2065.7,2381.1 1555.7,2420.3 1558.5,2419.8 1561.3,2419.4 1564,2419 1777.7,2385.3 1839.6,2424.4 2055.6,2383.1"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu9	[pos="e,2311.7,2381.2 1555.7,2420.2 1558.5,2419.8 1561.3,2419.4 1564,2419 1886.1,2372.2 1977.8,2441.5 2301.5,2383.1"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu10	[pos="e,2557.7,2381.3 1555.7,2420.2 1558.5,2419.7 1561.3,2419.3 1564,2419 1994.6,2359.1 2116,2458.7 2547.8,2383"];
	layer2_moe_norm_gpu13 -> layer3_qkv_gpu11	[pos="e,2803.7,2381.3 1555.7,2420.2 1558.5,2419.7 1561.3,2419.3 1564,2419 2103.1,2346 2254,2475.9 2793.7,2383"];
	layer2_expert14_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="1660,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_8	[pos="e,1726.5,2710 1785.4,2745.9 1769.2,2736 1751.7,2725.3 1735.1,2715.2",
		style=dashed];
	layer2_expert14_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="1852,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_9	[pos="e,1852,2710 1852,2745.9 1852,2737.6 1852,2728.8 1852,2720.3",
		style=dashed];
	layer2_expert14_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="2044,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_10	[pos="e,1977.5,2710 1918.6,2745.9 1934.8,2736 1952.3,2725.3 1968.9,2715.2",
		style=dashed];
	layer2_expert14_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="2236,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_11	[pos="e,2148.8,2706.8 1974.3,2758 2023.3,2745.6 2080.3,2730 2139.3,2710.1",
		style=dashed];
	layer2_moe_aggregate_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU14
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 14",
		pos="1852,2557",
		shape=rectangle,
		width=2.9444];
	layer2_expert14_8 -> layer2_moe_aggregate_gpu14	[pos="e,1794.1,2591 1731.2,2626.8 1748.9,2616.8 1767.7,2606 1785.1,2596.1"];
	layer2_expert14_9 -> layer2_moe_aggregate_gpu14	[pos="e,1852,2591.3 1852,2626.7 1852,2618.5 1852,2609.8 1852,2601.5"];
	layer2_expert14_10 -> layer2_moe_aggregate_gpu14	[pos="e,1909.9,2591 1972.8,2626.8 1955.1,2616.8 1936.3,2606 1918.9,2596.1"];
	layer2_expert14_11 -> layer2_moe_aggregate_gpu14	[pos="e,1958.1,2579 2148.9,2630 2145.9,2628.9 2142.9,2627.9 2140,2627 2084.2,2608.6 2020.9,2592.9 1967.9,2581.2"];
	layer2_moe_norm_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU14
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 14",
		pos="1700,2453",
		shape=rectangle,
		width=3.5139];
	layer2_moe_aggregate_gpu14 -> layer2_moe_norm_gpu14	[pos="e,1749.4,2487.1 1802.6,2522.8 1788.4,2513.3 1772.7,2502.7 1757.9,2492.8"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu0	[pos="e,326.3,2381.3 1573.5,2420.3 1570.3,2419.8 1567.1,2419.4 1564,2419 1025.7,2346.6 875.07,2475.8 336.27,2383"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu1	[pos="e,572.3,2381.3 1573.5,2420.4 1570.3,2419.9 1567.1,2419.4 1564,2419 1134.2,2359.6 1013.2,2458.6 582.22,2383"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu2	[pos="e,818.31,2381.2 1573.5,2420.4 1570.3,2419.9 1567.1,2419.4 1564,2419 1242.7,2372.6 1151.3,2441.3 828.42,2383.1"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu3	[pos="e,1064.3,2381.1 1573.5,2420.5 1570.3,2420 1567.1,2419.4 1564,2419 1351.1,2385.6 1289.5,2424.3 1074.4,2383.1"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu4	[pos="e,1310.1,2380.7 1573.4,2420.8 1570.2,2420.2 1567.1,2419.6 1564,2419 1459.1,2398.6 1427.9,2407.7 1320,2383.1"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu5	[pos="e,1537.9,2383.1 1622.2,2419 1598.7,2409 1572.4,2397.8 1547.4,2387.2"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu6	[pos="e,1692.5,2383.2 1696.4,2418.8 1695.5,2410.7 1694.5,2402 1693.6,2393.3"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu7	[pos="e,1847.1,2383.1 1770.5,2419 1791.7,2409 1815.3,2398 1837.8,2387.5"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu8	[pos="e,2065.9,2380.7 1826.8,2420.7 1829.5,2420.1 1832.3,2419.5 1835,2419 1929.8,2399.7 1958.1,2406.2 2055.9,2383.1"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu9	[pos="e,2311.7,2381.1 1826.7,2420.3 1829.5,2419.9 1832.3,2419.4 1835,2419 2037.8,2386.6 2096.6,2422.7 2301.8,2383"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu10	[pos="e,2557.7,2381.2 1826.7,2420.2 1829.5,2419.8 1832.3,2419.4 1835,2419 2146,2373.5 2234.7,2439.7 2547.4,2383.1"];
	layer2_moe_norm_gpu14 -> layer3_qkv_gpu11	[pos="e,2803.7,2381.3 1826.7,2420.2 1829.5,2419.8 1832.3,2419.3 1835,2419 2254.6,2360.4 2372.9,2456.9 2793.7,2383"];
	layer2_expert15_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2428,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_12	[pos="e,2494.5,2710 2553.4,2745.9 2537.2,2736 2519.7,2725.3 2503.1,2715.2",
		style=dashed];
	layer2_expert15_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2620,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_13	[pos="e,2620,2710 2620,2745.9 2620,2737.6 2620,2728.8 2620,2720.3",
		style=dashed];
	layer2_expert15_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2812,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_14	[pos="e,2745.5,2710 2686.6,2745.9 2702.8,2736 2720.3,2725.3 2736.9,2715.2",
		style=dashed];
	layer2_expert15_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="3004,2668.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_15	[pos="e,2916.8,2706.8 2742.3,2758 2791.3,2745.6 2848.3,2730 2907.3,2710.1",
		style=dashed];
	layer2_moe_aggregate_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU15
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 15",
		pos="2620,2557",
		shape=rectangle,
		width=2.9444];
	layer2_expert15_12 -> layer2_moe_aggregate_gpu15	[pos="e,2562.1,2591 2499.2,2626.8 2516.9,2616.8 2535.7,2606 2553.1,2596.1"];
	layer2_expert15_13 -> layer2_moe_aggregate_gpu15	[pos="e,2620,2591.3 2620,2626.7 2620,2618.5 2620,2609.8 2620,2601.5"];
	layer2_expert15_14 -> layer2_moe_aggregate_gpu15	[pos="e,2677.9,2591 2740.8,2626.8 2723.1,2616.8 2704.3,2606 2686.9,2596.1"];
	layer2_expert15_15 -> layer2_moe_aggregate_gpu15	[pos="e,2726.1,2579 2916.9,2630 2913.9,2628.9 2910.9,2627.9 2908,2627 2852.2,2608.6 2788.9,2592.9 2735.9,2581.2"];
	layer2_moe_norm_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU15
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 15",
		pos="1971,2453",
		shape=rectangle,
		width=3.5139];
	layer2_moe_aggregate_gpu15 -> layer2_moe_norm_gpu15	[pos="e,2097.7,2473.9 2513.9,2539.3 2403.1,2521.9 2228.9,2494.5 2107.8,2475.4"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu0	[pos="e,326.3,2381.3 1844.5,2420.3 1841.3,2419.8 1838.1,2419.4 1835,2419 1507.7,2375.8 679.94,2438.5 336.32,2383"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu1	[pos="e,572.3,2381.3 1844.5,2420.3 1841.3,2419.8 1838.1,2419.4 1835,2419 1561.9,2382.3 872.02,2429.9 582.43,2383"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu2	[pos="e,818.3,2381.3 1844.5,2420.4 1841.3,2419.9 1838.1,2419.4 1835,2419 1394.3,2358.2 1270.2,2460.3 828.46,2383.1"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu3	[pos="e,1064.3,2381.2 1844.5,2420.4 1841.3,2419.9 1838.1,2419.4 1835,2419 1502.7,2371.2 1408.2,2443.1 1074.3,2383"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu4	[pos="e,1310.3,2381.1 1844.5,2420.5 1841.3,2420 1838.1,2419.4 1835,2419 1611,2384.2 1546.4,2426 1320.2,2383"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu5	[pos="e,1556,2380.8 1844.4,2420.8 1841.2,2420.1 1838.1,2419.5 1835,2419 1719.1,2397.2 1684.8,2409.3 1565.9,2383"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu6	[pos="e,1792.9,2383 1885.7,2419 1859.5,2408.8 1830.1,2397.4 1802.3,2386.7"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu7	[pos="e,1947.8,2383.2 1959.8,2418.8 1957,2410.6 1954,2401.6 1951,2392.7"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu8	[pos="e,2102.4,2383.1 2034,2419 2052.6,2409.2 2073.4,2398.3 2093.3,2387.9"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu9	[pos="e,2311.9,2380.5 2097.5,2429.2 2157.1,2417.6 2229.2,2402.3 2302.1,2383.1"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu10	[pos="e,2558,2380.9 2097.7,2444.1 2213.2,2435.3 2388.3,2417.7 2548,2383.1"];
	layer2_moe_norm_gpu15 -> layer3_qkv_gpu11	[pos="e,2804,2381 2097.6,2450.5 2258.3,2446.7 2543.8,2432.9 2794,2383"];
	layer3_attn_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU0
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 0",
		pos="127,2230",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu0 -> layer3_attn_gpu0	[pos="e,152.85,2264.3 180.35,2299.7 173.41,2290.7 166.06,2281.3 159.1,2272.3"];
	layer3_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="125,2126",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu0 -> layer3_attn_norm_gpu0	[pos="e,125.65,2160.3 126.35,2195.8 126.19,2187.7 126.02,2178.9 125.85,2170.4"];
	layer3_attn_aggregate	[height=1.8889,
		label="L3_Attention_Aggregate
Input: 12×[1024,2048,4096]
Output: [1024,2048,4096]
All-Reduce across GPUs 0-11",
		pos="1566,1988",
		width=6.1944];
	layer3_attn_norm_gpu0 -> layer3_attn_aggregate	[pos="e,1363.6,1994.3 247.24,2093.5 250.18,2092.9 253.11,2092.4 256,2092 639.63,2029 1093,2004.2 1353.3,1994.7"];
	layer3_attn_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU1
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 1",
		pos="388,2230",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu1 -> layer3_attn_gpu1	[pos="e,409.29,2264.3 431.93,2299.7 426.34,2290.9 420.41,2281.7 414.79,2272.9"];
	layer3_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="387,2126",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu1 -> layer3_attn_norm_gpu1	[pos="e,387.33,2160.3 387.68,2195.8 387.6,2187.7 387.51,2178.9 387.43,2170.4"];
	layer3_attn_norm_gpu1 -> layer3_attn_aggregate	[pos="e,1378.9,1998.9 509.25,2093.5 512.19,2093 515.11,2092.5 518,2092 811.95,2040.8 1157,2013 1368.6,1999.6"];
	layer3_attn_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU2
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 2",
		pos="650,2230",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu2 -> layer3_attn_gpu2	[pos="e,666.42,2264.3 683.89,2299.7 679.66,2291.1 675.19,2282 670.94,2273.4"];
	layer3_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="649,2126",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu2 -> layer3_attn_norm_gpu2	[pos="e,649.33,2160.3 649.68,2195.8 649.6,2187.7 649.51,2178.9 649.43,2170.4"];
	layer3_attn_norm_gpu2 -> layer3_attn_aggregate	[pos="e,1399.1,2005.1 771.28,2093.7 774.21,2093.1 777.12,2092.5 780,2092 987.52,2052.4 1228.8,2023.2 1388.7,2006.2"];
	layer3_attn_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU3
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 3",
		pos="912,2230",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu3 -> layer3_attn_gpu3	[pos="e,923.56,2264.3 935.85,2299.7 932.94,2291.3 929.86,2282.4 926.92,2274"];
	layer3_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="911,2126",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu3 -> layer3_attn_norm_gpu3	[pos="e,911.33,2160.3 911.68,2195.8 911.6,2187.7 911.51,2178.9 911.43,2170.4"];
	layer3_attn_norm_gpu3 -> layer3_attn_aggregate	[pos="e,1428.2,2014 1033.3,2093.9 1036.2,2093.3 1039.1,2092.6 1042,2092 1168.4,2063.6 1313,2035.5 1418.2,2015.9"];
	layer3_attn_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU4
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 4",
		pos="1174,2230",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu4 -> layer3_attn_gpu4	[pos="e,1180.7,2264.3 1187.8,2299.7 1186.1,2291.4 1184.4,2282.6 1182.7,2274.2"];
	layer3_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="1173,2126",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu4 -> layer3_attn_norm_gpu4	[pos="e,1173.3,2160.3 1173.7,2195.8 1173.6,2187.7 1173.5,2178.9 1173.4,2170.4"];
	layer3_attn_norm_gpu4 -> layer3_attn_aggregate	[pos="e,1462.9,2024.6 1268.4,2091.9 1324.1,2072.7 1394.8,2048.2 1453.3,2028"];
	layer3_attn_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU5
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 5",
		pos="1435,2230",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu5 -> layer3_attn_gpu5	[pos="e,1437.1,2264.3 1439.4,2299.7 1438.9,2291.4 1438.3,2282.6 1437.8,2274.2"];
	layer3_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="1435,2126",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu5 -> layer3_attn_norm_gpu5	[pos="e,1435,2160.3 1435,2195.8 1435,2187.7 1435,2178.9 1435,2170.4"];
	layer3_attn_norm_gpu5 -> layer3_attn_aggregate	[pos="e,1515.9,2041 1467,2091.7 1479.7,2078.6 1494.6,2063.1 1508.9,2048.2"];
	layer3_attn_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU6
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 6",
		pos="1696,2230",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu6 -> layer3_attn_gpu6	[pos="e,1693.6,2264.3 1691,2299.7 1691.6,2291.4 1692.2,2282.6 1692.8,2274.2"];
	layer3_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="1697,2126",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu6 -> layer3_attn_norm_gpu6	[pos="e,1696.7,2160.3 1696.3,2195.8 1696.4,2187.7 1696.5,2178.9 1696.6,2170.4"];
	layer3_attn_norm_gpu6 -> layer3_attn_aggregate	[pos="e,1616.1,2041 1665,2091.7 1652.3,2078.6 1637.4,2063.1 1623.1,2048.2"];
	layer3_attn_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU7
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 7",
		pos="1958,2230",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu7 -> layer3_attn_gpu7	[pos="e,1950.7,2264.3 1942.9,2299.7 1944.8,2291.4 1946.7,2282.6 1948.5,2274.2"];
	layer3_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="1959,2126",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu7 -> layer3_attn_norm_gpu7	[pos="e,1958.7,2160.3 1958.3,2195.8 1958.4,2187.7 1958.5,2178.9 1958.6,2170.4"];
	layer3_attn_norm_gpu7 -> layer3_attn_aggregate	[pos="e,1669.1,2024.6 1863.6,2091.9 1807.9,2072.7 1737.2,2048.2 1678.7,2028"];
	layer3_attn_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU8
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 8",
		pos="2220,2230",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu8 -> layer3_attn_gpu8	[pos="e,2207.8,2264.3 2194.9,2299.7 2198,2291.2 2201.3,2282.2 2204.4,2273.7"];
	layer3_attn_norm_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU8
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 8",
		pos="2221,2126",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu8 -> layer3_attn_norm_gpu8	[pos="e,2220.7,2160.3 2220.3,2195.8 2220.4,2187.7 2220.5,2178.9 2220.6,2170.4"];
	layer3_attn_norm_gpu8 -> layer3_attn_aggregate	[pos="e,1703.8,2014 2098.7,2093.9 2095.8,2093.3 2092.9,2092.6 2090,2092 1963.6,2063.6 1819,2035.5 1713.8,2015.9"];
	layer3_attn_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU9
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 9",
		pos="2482,2230",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu9 -> layer3_attn_gpu9	[pos="e,2465,2264.3 2446.9,2299.7 2451.2,2291.1 2455.9,2282 2460.3,2273.4"];
	layer3_attn_norm_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU9
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 9",
		pos="2483,2126",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu9 -> layer3_attn_norm_gpu9	[pos="e,2482.7,2160.3 2482.3,2195.8 2482.4,2187.7 2482.5,2178.9 2482.6,2170.4"];
	layer3_attn_norm_gpu9 -> layer3_attn_aggregate	[pos="e,1732.9,2005.1 2360.7,2093.7 2357.8,2093.1 2354.9,2092.5 2352,2092 2144.5,2052.4 1903.2,2023.2 1743.3,2006.2"];
	layer3_attn_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU10
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 10",
		pos="2749,2230",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu10 -> layer3_attn_gpu10	[pos="e,2725.6,2264.3 2700.7,2299.7 2706.9,2290.8 2713.5,2281.5 2719.7,2272.6"];
	layer3_attn_norm_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU10
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 10",
		pos="2750,2126",
		shape=rectangle,
		width=3.5139];
	layer3_attn_gpu10 -> layer3_attn_norm_gpu10	[pos="e,2749.7,2160.3 2749.3,2195.8 2749.4,2187.7 2749.5,2178.9 2749.6,2170.4"];
	layer3_attn_norm_gpu10 -> layer3_attn_aggregate	[pos="e,1752.1,1999.3 2623.4,2093.6 2620.3,2093 2617.1,2092.5 2614,2092 2319.4,2042 1973.8,2013.8 1762.4,2000"];
	layer3_attn_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU11
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 11",
		pos="3020,2230",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu11 -> layer3_attn_gpu11	[pos="e,2989,2264.3 2956,2299.7 2964.5,2290.6 2973.5,2280.9 2982,2271.8"];
	layer3_attn_norm_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU11
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 11",
		pos="3021,2126",
		shape=rectangle,
		width=3.5139];
	layer3_attn_gpu11 -> layer3_attn_norm_gpu11	[pos="e,3020.7,2160.3 3020.3,2195.8 3020.4,2187.7 3020.5,2178.9 3020.6,2170.4"];
	layer3_attn_norm_gpu11 -> layer3_attn_aggregate	[pos="e,1767.2,1994.7 2894.4,2093.5 2891.3,2093 2888.1,2092.5 2885,2092 2497.2,2030.2 2039.1,2005 1777.5,1995"];
	layer3_moe_broadcast	[fillcolor=yellow,
		height=1.8889,
		label="L3_Broadcast_to_MoE
Input: [1024,2048,4096]
Output: 4×[1024,2048,4096]
Broadcast to GPUs 12-15",
		pos="1566,1816",
		shape=parallelogram,
		width=6.4509];
	layer3_attn_aggregate -> layer3_moe_broadcast	[pos="e,1566,1884.2 1566,1919.8 1566,1911.5 1566,1902.9 1566,1894.4"];
	layer3_gate_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU12
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 12",
		pos="510,1670.5",
		shape=rectangle,
		width=3.3889];
	layer3_moe_broadcast -> layer3_gate_gpu12	[pos="e,632.22,1688.1 1360.8,1787.1 1148.4,1758.2 822.92,1714 642.31,1689.4"];
	layer3_gate_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU13
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 13",
		pos="1278,1670.5",
		shape=rectangle,
		width=3.3889];
	layer3_moe_broadcast -> layer3_gate_gpu13	[pos="e,1359.3,1712 1431.3,1747.8 1409.9,1737.2 1388.3,1726.4 1368.4,1716.5"];
	layer3_gate_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU14
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 14",
		pos="1854,1670.5",
		shape=rectangle,
		width=3.3889];
	layer3_moe_broadcast -> layer3_gate_gpu14	[pos="e,1772.7,1712 1700.7,1747.8 1722.1,1737.2 1743.7,1726.4 1763.6,1716.5"];
	layer3_gate_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU15
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 15",
		pos="2622,1670.5",
		shape=rectangle,
		width=3.3889];
	layer3_moe_broadcast -> layer3_gate_gpu15	[pos="e,2499.8,1688.1 1734.5,1792.1 1944.3,1763.5 2298.3,1715.4 2489.7,1689.4"];
	layer3_expert12_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="126,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_0	[pos="e,213.18,1589.8 387.66,1641 338.66,1628.6 281.72,1613 222.67,1593.1",
		style=dashed];
	layer3_expert12_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="318,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_1	[pos="e,384.5,1593 443.39,1628.9 427.15,1619 409.68,1608.3 393.08,1598.2",
		style=dashed];
	layer3_expert12_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="510,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_2	[pos="e,510,1593 510,1628.9 510,1620.6 510,1611.8 510,1603.3",
		style=dashed];
	layer3_expert12_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="702,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_3	[pos="e,635.5,1593 576.61,1628.9 592.85,1619 610.32,1608.3 626.92,1598.2",
		style=dashed];
	layer3_moe_aggregate_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU12
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 12",
		pos="510,1440",
		shape=rectangle,
		width=2.9444];
	layer3_expert12_0 -> layer3_moe_aggregate_gpu12	[pos="e,403.85,1462 213.15,1513 216.12,1511.9 219.08,1510.9 222,1510 277.76,1491.6 341.05,1475.9 394.08,1464.2"];
	layer3_expert12_1 -> layer3_moe_aggregate_gpu12	[pos="e,452.06,1474 389.22,1509.8 406.85,1499.8 425.68,1489 443.1,1479.1"];
	layer3_expert12_2 -> layer3_moe_aggregate_gpu12	[pos="e,510,1474.3 510,1509.7 510,1501.5 510,1492.8 510,1484.5"];
	layer3_expert12_3 -> layer3_moe_aggregate_gpu12	[pos="e,567.94,1474 630.78,1509.8 613.15,1499.8 594.32,1489 576.9,1479.1"];
	layer3_moe_norm_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU12
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 12",
		pos="1160,1336",
		shape=rectangle,
		width=3.5139];
	layer3_moe_aggregate_gpu12 -> layer3_moe_norm_gpu12	[pos="e,1033.4,1356.8 616.24,1422.3 727.31,1404.9 902.01,1377.4 1023.3,1358.4"];
	layer4_qkv_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU0
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 0-2
GPU: 0",
		pos="214,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu0	[pos="e,328,1264 1033.2,1333.5 872.61,1329.6 587.7,1315.8 337.99,1266"];
	layer4_qkv_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU1
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 3-5
GPU: 1",
		pos="460,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu1	[pos="e,574.03,1263.9 1033.3,1327.1 917.97,1318.2 743.24,1300.7 584.01,1266.1"];
	layer4_qkv_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU2
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 6-8
GPU: 2",
		pos="706,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu2	[pos="e,820.12,1263.5 1033.5,1312 974.12,1300.5 902.37,1285.3 829.89,1266.1"];
	layer4_qkv_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU3
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 9-11
GPU: 3",
		pos="952,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu3	[pos="e,1029.3,1266.1 1097.3,1302 1078.7,1292.2 1058.1,1281.3 1038.3,1270.9"];
	layer4_qkv_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU4
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 12-14
GPU: 4",
		pos="1198,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu4	[pos="e,1183.8,1266.2 1171.5,1301.8 1174.4,1293.6 1177.5,1284.6 1180.6,1275.7"];
	layer4_qkv_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU5
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 15-17
GPU: 5",
		pos="1444,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu5	[pos="e,1338.7,1266 1245.6,1302 1271.9,1291.8 1301.4,1280.4 1329.3,1269.7"];
	layer4_qkv_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU6
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 18-20
GPU: 6",
		pos="1690,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu6	[pos="e,1576,1263.8 1286.7,1303.5 1289.5,1303 1292.3,1302.5 1295,1302 1411.7,1280 1446.3,1292.4 1566,1266"];
	layer4_qkv_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU7
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 21-23
GPU: 7",
		pos="1936,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu7	[pos="e,1821.7,1264.1 1286.7,1303.3 1289.5,1302.8 1292.3,1302.4 1295,1302 1519.8,1266.9 1584.7,1309.2 1811.8,1266"];
	layer4_qkv_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU8
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 24-26
GPU: 8",
		pos="2182,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu8	[pos="e,2067.7,1264.2 1286.7,1303.2 1289.5,1302.8 1292.3,1302.3 1295,1302 1628.2,1253.8 1722.9,1326.2 2057.7,1266"];
	layer4_qkv_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU9
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 27-29
GPU: 9",
		pos="2428,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu9	[pos="e,2313.7,1264.3 1286.7,1303.2 1289.5,1302.7 1292.3,1302.3 1295,1302 1736.7,1240.8 1861,1343.5 2303.8,1266"];
	layer4_qkv_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU10
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 30-32
GPU: 10",
		pos="2674,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu10	[pos="e,2559.7,1264.3 1286.7,1303.2 1289.5,1302.7 1292.3,1302.3 1295,1302 1568.5,1265 2259.5,1313 2549.6,1266"];
	layer4_qkv_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_QKV_Projection_GPU11
Input: [1024, 2048, 4096]
Output: [1024, 2048, 3*4096]
Heads: 33-35
GPU: 11",
		pos="2920,1224.5",
		shape=rectangle,
		width=3.1667];
	layer3_moe_norm_gpu12 -> layer4_qkv_gpu11	[pos="e,2805.7,1264.3 1286.7,1303.1 1289.5,1302.7 1292.2,1302.3 1295,1302 1622.7,1258.5 2451.6,1321.5 2795.7,1266"];
	layer3_expert13_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="894,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_4	[pos="e,981.18,1589.8 1155.7,1641 1106.7,1628.6 1049.7,1613 990.67,1593.1",
		style=dashed];
	layer3_expert13_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1086,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_5	[pos="e,1152.5,1593 1211.4,1628.9 1195.2,1619 1177.7,1608.3 1161.1,1598.2",
		style=dashed];
	layer3_expert13_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1278,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_6	[pos="e,1278,1593 1278,1628.9 1278,1620.6 1278,1611.8 1278,1603.3",
		style=dashed];
	layer3_expert13_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1470,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_7	[pos="e,1403.5,1593 1344.6,1628.9 1360.8,1619 1378.3,1608.3 1394.9,1598.2",
		style=dashed];
	layer3_moe_aggregate_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU13
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 13",
		pos="1278,1440",
		shape=rectangle,
		width=2.9444];
	layer3_expert13_4 -> layer3_moe_aggregate_gpu13	[pos="e,1171.9,1462 981.15,1513 984.12,1511.9 987.08,1510.9 990,1510 1045.8,1491.6 1109.1,1475.9 1162.1,1464.2"];
	layer3_expert13_5 -> layer3_moe_aggregate_gpu13	[pos="e,1220.1,1474 1157.2,1509.8 1174.9,1499.8 1193.7,1489 1211.1,1479.1"];
	layer3_expert13_6 -> layer3_moe_aggregate_gpu13	[pos="e,1278,1474.3 1278,1509.7 1278,1501.5 1278,1492.8 1278,1484.5"];
	layer3_expert13_7 -> layer3_moe_aggregate_gpu13	[pos="e,1335.9,1474 1398.8,1509.8 1381.1,1499.8 1362.3,1489 1344.9,1479.1"];
	layer3_moe_norm_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU13
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 13",
		pos="1431,1336",
		shape=rectangle,
		width=3.5139];
	layer3_moe_aggregate_gpu13 -> layer3_moe_norm_gpu13	[pos="e,1381.3,1370.1 1327.7,1405.8 1342,1396.3 1357.9,1385.7 1372.7,1375.8"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu0	[pos="e,328.31,1264.3 1304.5,1303.4 1301.3,1302.9 1298.1,1302.4 1295,1302 876.26,1243.9 758.2,1339.8 338.28,1266"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu1	[pos="e,574.31,1264.2 1304.5,1303.4 1301.3,1302.9 1298.1,1302.4 1295,1302 984.81,1256.9 896.38,1322.6 584.55,1266.1"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu2	[pos="e,820.33,1264.1 1304.4,1303.5 1301.3,1303 1298.1,1302.4 1295,1302 1093.1,1269.9 1034.5,1305.6 830.18,1266"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu3	[pos="e,1066.1,1263.7 1304.4,1303.9 1301.2,1303.2 1298.1,1302.6 1295,1302 1201,1282.9 1173,1289.1 1076,1266.1"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu4	[pos="e,1284.6,1266.1 1360.8,1302 1339.7,1292 1316.2,1281 1293.8,1270.5"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu5	[pos="e,1439.2,1266.2 1434.9,1301.8 1435.9,1293.7 1436.9,1285 1438,1276.3"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu6	[pos="e,1593.8,1266.1 1509.1,1302 1532.8,1291.9 1559.3,1280.7 1584.5,1270"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu7	[pos="e,1821.9,1263.8 1557.8,1303.6 1560.5,1303 1563.3,1302.5 1566,1302 1671.7,1281.4 1703.2,1290.8 1811.9,1266.1"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu8	[pos="e,2067.7,1264.1 1557.7,1303.3 1560.5,1302.8 1563.3,1302.4 1566,1302 1779.7,1268.3 1841.6,1307.4 2057.6,1266.1"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu9	[pos="e,2313.7,1264.2 1557.7,1303.2 1560.5,1302.8 1563.3,1302.4 1566,1302 1888.1,1255.2 1979.8,1324.5 2303.5,1266.1"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu10	[pos="e,2559.7,1264.3 1557.7,1303.2 1560.5,1302.7 1563.3,1302.3 1566,1302 1996.6,1242.1 2118,1341.7 2549.8,1266"];
	layer3_moe_norm_gpu13 -> layer4_qkv_gpu11	[pos="e,2805.7,1264.3 1557.7,1303.2 1560.5,1302.7 1563.3,1302.3 1566,1302 2105.1,1229 2256,1358.9 2795.7,1266"];
	layer3_expert14_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="1662,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_8	[pos="e,1728.5,1593 1787.4,1628.9 1771.2,1619 1753.7,1608.3 1737.1,1598.2",
		style=dashed];
	layer3_expert14_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="1854,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_9	[pos="e,1854,1593 1854,1628.9 1854,1620.6 1854,1611.8 1854,1603.3",
		style=dashed];
	layer3_expert14_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="2046,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_10	[pos="e,1979.5,1593 1920.6,1628.9 1936.8,1619 1954.3,1608.3 1970.9,1598.2",
		style=dashed];
	layer3_expert14_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="2238,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_11	[pos="e,2150.8,1589.8 1976.3,1641 2025.3,1628.6 2082.3,1613 2141.3,1593.1",
		style=dashed];
	layer3_moe_aggregate_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU14
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 14",
		pos="1854,1440",
		shape=rectangle,
		width=2.9444];
	layer3_expert14_8 -> layer3_moe_aggregate_gpu14	[pos="e,1796.1,1474 1733.2,1509.8 1750.9,1499.8 1769.7,1489 1787.1,1479.1"];
	layer3_expert14_9 -> layer3_moe_aggregate_gpu14	[pos="e,1854,1474.3 1854,1509.7 1854,1501.5 1854,1492.8 1854,1484.5"];
	layer3_expert14_10 -> layer3_moe_aggregate_gpu14	[pos="e,1911.9,1474 1974.8,1509.8 1957.1,1499.8 1938.3,1489 1920.9,1479.1"];
	layer3_expert14_11 -> layer3_moe_aggregate_gpu14	[pos="e,1960.1,1462 2150.9,1513 2147.9,1511.9 2144.9,1510.9 2142,1510 2086.2,1491.6 2022.9,1475.9 1969.9,1464.2"];
	layer3_moe_norm_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU14
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 14",
		pos="1702,1336",
		shape=rectangle,
		width=3.5139];
	layer3_moe_aggregate_gpu14 -> layer3_moe_norm_gpu14	[pos="e,1751.4,1370.1 1804.6,1405.8 1790.4,1396.3 1774.7,1385.7 1759.9,1375.8"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu0	[pos="e,328.3,1264.3 1575.5,1303.3 1572.3,1302.8 1569.1,1302.4 1566,1302 1027.7,1229.6 877.07,1358.8 338.27,1266"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu1	[pos="e,574.3,1264.3 1575.5,1303.4 1572.3,1302.9 1569.1,1302.4 1566,1302 1136.2,1242.6 1015.2,1341.6 584.22,1266"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu2	[pos="e,820.31,1264.2 1575.5,1303.4 1572.3,1302.9 1569.1,1302.4 1566,1302 1244.7,1255.6 1153.3,1324.3 830.42,1266.1"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu3	[pos="e,1066.3,1264.1 1575.5,1303.5 1572.3,1303 1569.1,1302.4 1566,1302 1353.1,1268.6 1291.5,1307.3 1076.4,1266.1"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu4	[pos="e,1312.1,1263.7 1575.4,1303.8 1572.2,1303.2 1569.1,1302.6 1566,1302 1461.1,1281.6 1429.9,1290.7 1322,1266.1"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu5	[pos="e,1539.9,1266.1 1624.2,1302 1600.7,1292 1574.4,1280.8 1549.4,1270.2"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu6	[pos="e,1694.5,1266.2 1698.4,1301.8 1697.5,1293.7 1696.5,1285 1695.6,1276.3"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu7	[pos="e,1849.1,1266.1 1772.5,1302 1793.7,1292 1817.3,1281 1839.8,1270.5"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu8	[pos="e,2067.9,1263.7 1828.8,1303.7 1831.5,1303.1 1834.3,1302.5 1837,1302 1931.8,1282.7 1960.1,1289.2 2057.9,1266.1"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu9	[pos="e,2313.7,1264.1 1828.7,1303.3 1831.5,1302.9 1834.3,1302.4 1837,1302 2039.8,1269.6 2098.6,1305.7 2303.8,1266"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu10	[pos="e,2559.7,1264.2 1828.7,1303.2 1831.5,1302.8 1834.3,1302.4 1837,1302 2148,1256.5 2236.7,1322.7 2549.4,1266.1"];
	layer3_moe_norm_gpu14 -> layer4_qkv_gpu11	[pos="e,2805.7,1264.3 1828.7,1303.2 1831.5,1302.8 1834.3,1302.3 1837,1302 2256.6,1243.4 2374.9,1339.9 2795.7,1266"];
	layer3_expert15_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2430,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_12	[pos="e,2496.5,1593 2555.4,1628.9 2539.2,1619 2521.7,1608.3 2505.1,1598.2",
		style=dashed];
	layer3_expert15_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2622,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_13	[pos="e,2622,1593 2622,1628.9 2622,1620.6 2622,1611.8 2622,1603.3",
		style=dashed];
	layer3_expert15_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2814,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_14	[pos="e,2747.5,1593 2688.6,1628.9 2704.8,1619 2722.3,1608.3 2738.9,1598.2",
		style=dashed];
	layer3_expert15_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="3006,1551.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_15	[pos="e,2918.8,1589.8 2744.3,1641 2793.3,1628.6 2850.3,1613 2909.3,1593.1",
		style=dashed];
	layer3_moe_aggregate_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU15
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 15",
		pos="2622,1440",
		shape=rectangle,
		width=2.9444];
	layer3_expert15_12 -> layer3_moe_aggregate_gpu15	[pos="e,2564.1,1474 2501.2,1509.8 2518.9,1499.8 2537.7,1489 2555.1,1479.1"];
	layer3_expert15_13 -> layer3_moe_aggregate_gpu15	[pos="e,2622,1474.3 2622,1509.7 2622,1501.5 2622,1492.8 2622,1484.5"];
	layer3_expert15_14 -> layer3_moe_aggregate_gpu15	[pos="e,2679.9,1474 2742.8,1509.8 2725.1,1499.8 2706.3,1489 2688.9,1479.1"];
	layer3_expert15_15 -> layer3_moe_aggregate_gpu15	[pos="e,2728.1,1462 2918.9,1513 2915.9,1511.9 2912.9,1510.9 2910,1510 2854.2,1491.6 2790.9,1475.9 2737.9,1464.2"];
	layer3_moe_norm_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU15
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 15",
		pos="1973,1336",
		shape=rectangle,
		width=3.5139];
	layer3_moe_aggregate_gpu15 -> layer3_moe_norm_gpu15	[pos="e,2099.7,1356.9 2515.9,1422.3 2405.1,1404.9 2230.9,1377.5 2109.8,1358.4"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu0	[pos="e,328.3,1264.3 1846.5,1303.3 1843.3,1302.8 1840.1,1302.4 1837,1302 1509.7,1258.8 681.94,1321.5 338.32,1266"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu1	[pos="e,574.3,1264.3 1846.5,1303.3 1843.3,1302.8 1840.1,1302.4 1837,1302 1563.9,1265.3 874.02,1312.9 584.43,1266"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu2	[pos="e,820.3,1264.3 1846.5,1303.4 1843.3,1302.9 1840.1,1302.4 1837,1302 1396.3,1241.2 1272.2,1343.3 830.46,1266.1"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu3	[pos="e,1066.3,1264.2 1846.5,1303.4 1843.3,1302.9 1840.1,1302.4 1837,1302 1504.7,1254.2 1410.2,1326.1 1076.3,1266"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu4	[pos="e,1312.3,1264.1 1846.5,1303.5 1843.3,1303 1840.1,1302.4 1837,1302 1613,1267.2 1548.4,1309 1322.2,1266"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu5	[pos="e,1558,1263.8 1846.4,1303.8 1843.2,1303.1 1840.1,1302.5 1837,1302 1721.1,1280.2 1686.8,1292.3 1567.9,1266"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu6	[pos="e,1794.9,1266 1887.7,1302 1861.5,1291.8 1832.1,1280.4 1804.3,1269.7"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu7	[pos="e,1949.8,1266.2 1961.8,1301.8 1959,1293.6 1956,1284.6 1953,1275.7"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu8	[pos="e,2104.4,1266.1 2036,1302 2054.6,1292.2 2075.4,1281.3 2095.3,1270.9"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu9	[pos="e,2313.9,1263.5 2099.5,1312.2 2159.1,1300.6 2231.2,1285.3 2304.1,1266.1"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu10	[pos="e,2560,1263.9 2099.7,1327.1 2215.2,1318.3 2390.3,1300.7 2550,1266.1"];
	layer3_moe_norm_gpu15 -> layer4_qkv_gpu11	[pos="e,2806,1264 2099.6,1333.5 2260.3,1329.7 2545.8,1315.9 2796,1266"];
	layer4_attn_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU0
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 0",
		pos="129,1113",
		shape=rectangle,
		width=3.375];
	layer4_qkv_gpu0 -> layer4_attn_gpu0	[pos="e,154.85,1147.3 182.35,1182.7 175.41,1173.7 168.06,1164.3 161.1,1155.3"];
	layer4_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="127,1009",
		shape=rectangle,
		width=3.3889];
	layer4_attn_gpu0 -> layer4_attn_norm_gpu0	[pos="e,127.65,1043.3 128.35,1078.8 128.19,1070.7 128.02,1061.9 127.85,1053.4"];
	layer4_attn_aggregate	[height=1.8889,
		label="L4_Attention_Aggregate
Input: 12×[1024,2048,4096]
Output: [1024,2048,4096]
All-Reduce across GPUs 0-11",
		pos="1568,870.95",
		width=6.1944];
	layer4_attn_norm_gpu0 -> layer4_attn_aggregate	[pos="e,1365.6,877.31 249.24,976.47 252.18,975.93 255.11,975.43 258,974.95 641.63,912.01 1095,887.23 1355.3,877.69"];
	layer4_attn_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU1
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 1",
		pos="391,1113",
		shape=rectangle,
		width=3.375];
	layer4_qkv_gpu1 -> layer4_attn_gpu1	[pos="e,411.98,1147.3 434.31,1182.7 428.79,1173.9 422.95,1164.7 417.41,1155.9"];
	layer4_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="389,1009",
		shape=rectangle,
		width=3.3889];
	layer4_attn_gpu1 -> layer4_attn_norm_gpu1	[pos="e,389.65,1043.3 390.35,1078.8 390.19,1070.7 390.02,1061.9 389.85,1053.4"];
	layer4_attn_norm_gpu1 -> layer4_attn_aggregate	[pos="e,1380.9,881.92 511.25,976.55 514.19,975.99 517.11,975.46 520,974.95 813.95,923.78 1159,895.99 1370.6,882.57"];
	layer4_attn_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU2
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 2",
		pos="652,1113",
		shape=rectangle,
		width=3.375];
	layer4_qkv_gpu2 -> layer4_attn_gpu2	[pos="e,668.42,1147.3 685.89,1182.7 681.66,1174.1 677.19,1165 672.94,1156.4"];
	layer4_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="651,1009",
		shape=rectangle,
		width=3.3889];
	layer4_attn_gpu2 -> layer4_attn_norm_gpu2	[pos="e,651.33,1043.3 651.68,1078.8 651.6,1070.7 651.51,1061.9 651.43,1053.4"];
	layer4_attn_norm_gpu2 -> layer4_attn_aggregate	[pos="e,1401.1,888.12 773.28,976.67 776.21,976.08 779.12,975.5 782,974.95 989.52,935.36 1230.8,906.21 1390.7,889.22"];
	layer4_attn_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU3
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 3",
		pos="914,1113",
		shape=rectangle,
		width=3.375];
	layer4_qkv_gpu3 -> layer4_attn_gpu3	[pos="e,925.56,1147.3 937.85,1182.7 934.94,1174.3 931.86,1165.4 928.92,1157"];
	layer4_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="913,1009",
		shape=rectangle,
		width=3.3889];
	layer4_attn_gpu3 -> layer4_attn_norm_gpu3	[pos="e,913.33,1043.3 913.68,1078.8 913.6,1070.7 913.51,1061.9 913.43,1053.4"];
	layer4_attn_norm_gpu3 -> layer4_attn_aggregate	[pos="e,1430.2,896.98 1035.3,976.92 1038.2,976.25 1041.1,975.59 1044,974.95 1170.4,946.63 1315,918.53 1420.2,898.86"];
	layer4_attn_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU4
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 4",
		pos="1175,1113",
		shape=rectangle,
		width=3.375];
	layer4_qkv_gpu4 -> layer4_attn_gpu4	[pos="e,1182,1147.3 1189.4,1182.7 1187.7,1174.4 1185.9,1165.6 1184.1,1157.2"];
	layer4_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="1175,1009",
		shape=rectangle,
		width=3.3889];
	layer4_attn_gpu4 -> layer4_attn_norm_gpu4	[pos="e,1175,1043.3 1175,1078.8 1175,1070.7 1175,1061.9 1175,1053.4"];
	layer4_attn_norm_gpu4 -> layer4_attn_aggregate	[pos="e,1464.9,907.63 1270.4,974.94 1326.1,955.66 1396.8,931.2 1455.3,910.97"];
	layer4_attn_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU5
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 5",
		pos="1437,1113",
		shape=rectangle,
		width=3.375];
	layer4_qkv_gpu5 -> layer4_attn_gpu5	[pos="e,1439.1,1147.3 1441.4,1182.7 1440.9,1174.4 1440.3,1165.6 1439.8,1157.2"];
	layer4_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="1437,1009",
		shape=rectangle,
		width=3.3889];
	layer4_attn_gpu5 -> layer4_attn_norm_gpu5	[pos="e,1437,1043.3 1437,1078.8 1437,1070.7 1437,1061.9 1437,1053.4"];
	layer4_attn_norm_gpu5 -> layer4_attn_aggregate	[pos="e,1517.9,923.96 1469,974.68 1481.7,961.57 1496.6,946.11 1510.9,931.21"];
	layer4_attn_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU6
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 6",
		pos="1698,1113",
		shape=rectangle,
		width=3.375];
	layer4_qkv_gpu6 -> layer4_attn_gpu6	[pos="e,1695.6,1147.3 1693,1182.7 1693.6,1174.4 1694.2,1165.6 1694.8,1157.2"];
	layer4_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="1699,1009",
		shape=rectangle,
		width=3.3889];
	layer4_attn_gpu6 -> layer4_attn_norm_gpu6	[pos="e,1698.7,1043.3 1698.3,1078.8 1698.4,1070.7 1698.5,1061.9 1698.6,1053.4"];
	layer4_attn_norm_gpu6 -> layer4_attn_aggregate	[pos="e,1618.1,923.96 1667,974.68 1654.3,961.57 1639.4,946.11 1625.1,931.21"];
	layer4_attn_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU7
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 7",
		pos="1960,1113",
		shape=rectangle,
		width=3.375];
	layer4_qkv_gpu7 -> layer4_attn_gpu7	[pos="e,1952.7,1147.3 1944.9,1182.7 1946.8,1174.4 1948.7,1165.6 1950.5,1157.2"];
	layer4_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="1961,1009",
		shape=rectangle,
		width=3.3889];
	layer4_attn_gpu7 -> layer4_attn_norm_gpu7	[pos="e,1960.7,1043.3 1960.3,1078.8 1960.4,1070.7 1960.5,1061.9 1960.6,1053.4"];
	layer4_attn_norm_gpu7 -> layer4_attn_aggregate	[pos="e,1671.1,907.63 1865.6,974.94 1809.9,955.66 1739.2,931.2 1680.7,910.97"];
	layer4_attn_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU8
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 8",
		pos="2222,1113",
		shape=rectangle,
		width=3.375];
	layer4_qkv_gpu8 -> layer4_attn_gpu8	[pos="e,2209.8,1147.3 2196.9,1182.7 2200,1174.2 2203.3,1165.2 2206.4,1156.7"];
	layer4_attn_norm_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU8
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 8",
		pos="2223,1009",
		shape=rectangle,
		width=3.3889];
	layer4_attn_gpu8 -> layer4_attn_norm_gpu8	[pos="e,2222.7,1043.3 2222.3,1078.8 2222.4,1070.7 2222.5,1061.9 2222.6,1053.4"];
	layer4_attn_norm_gpu8 -> layer4_attn_aggregate	[pos="e,1705.8,896.98 2100.7,976.92 2097.8,976.25 2094.9,975.59 2092,974.95 1965.6,946.63 1821,918.53 1715.8,898.86"];
	layer4_attn_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU9
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 9",
		pos="2484,1113",
		shape=rectangle,
		width=3.375];
	layer4_qkv_gpu9 -> layer4_attn_gpu9	[pos="e,2467,1147.3 2448.9,1182.7 2453.2,1174.1 2457.9,1165 2462.3,1156.4"];
	layer4_attn_norm_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU9
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 9",
		pos="2485,1009",
		shape=rectangle,
		width=3.3889];
	layer4_attn_gpu9 -> layer4_attn_norm_gpu9	[pos="e,2484.7,1043.3 2484.3,1078.8 2484.4,1070.7 2484.5,1061.9 2484.6,1053.4"];
	layer4_attn_norm_gpu9 -> layer4_attn_aggregate	[pos="e,1734.9,888.12 2362.7,976.67 2359.8,976.08 2356.9,975.5 2354,974.95 2146.5,935.36 1905.2,906.21 1745.3,889.22"];
	layer4_attn_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU10
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 10",
		pos="2751,1113",
		shape=rectangle,
		width=3.5];
	layer4_qkv_gpu10 -> layer4_attn_gpu10	[pos="e,2727.6,1147.3 2702.7,1182.7 2708.9,1173.8 2715.5,1164.5 2721.7,1155.6"];
	layer4_attn_norm_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU10
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 10",
		pos="2752,1009",
		shape=rectangle,
		width=3.5139];
	layer4_attn_gpu10 -> layer4_attn_norm_gpu10	[pos="e,2751.7,1043.3 2751.3,1078.8 2751.4,1070.7 2751.5,1061.9 2751.6,1053.4"];
	layer4_attn_norm_gpu10 -> layer4_attn_aggregate	[pos="e,1754.1,882.35 2625.4,976.63 2622.3,976.04 2619.1,975.48 2616,974.95 2321.4,924.99 1975.8,896.84 1764.4,883.01"];
	layer4_attn_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Multi-Head_Attention_GPU11
Input: [1024, 2048, 3*4096]
Output: [1024, 2048, 4096]
GPU: 11",
		pos="3022,1113",
		shape=rectangle,
		width=3.5];
	layer4_qkv_gpu11 -> layer4_attn_gpu11	[pos="e,2991,1147.3 2958,1182.7 2966.5,1173.6 2975.5,1163.9 2984,1154.8"];
	layer4_attn_norm_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU11
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 11",
		pos="3023,1009",
		shape=rectangle,
		width=3.5139];
	layer4_attn_gpu11 -> layer4_attn_norm_gpu11	[pos="e,3022.7,1043.3 3022.3,1078.8 3022.4,1070.7 3022.5,1061.9 3022.6,1053.4"];
	layer4_attn_norm_gpu11 -> layer4_attn_aggregate	[pos="e,1769.2,877.66 2896.4,976.54 2893.3,975.98 2890.1,975.45 2887,974.95 2499.2,913.17 2041.1,887.97 1779.5,878.05"];
	layer4_moe_broadcast	[fillcolor=yellow,
		height=1.8889,
		label="L4_Broadcast_to_MoE
Input: [1024,2048,4096]
Output: 4×[1024,2048,4096]
Broadcast to GPUs 12-15",
		pos="1568,698.95",
		shape=parallelogram,
		width=6.4509];
	layer4_attn_aggregate -> layer4_moe_broadcast	[pos="e,1568,767.21 1568,802.76 1568,794.45 1568,785.9 1568,777.45"];
	layer4_gate_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Gate_GPU12
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 12",
		pos="512,553.45",
		shape=rectangle,
		width=3.3889];
	layer4_moe_broadcast -> layer4_gate_gpu12	[pos="e,634.22,571.06 1362.8,670.07 1150.4,641.21 824.92,596.98 644.31,572.43"];
	layer4_gate_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Gate_GPU13
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 13",
		pos="1280,553.45",
		shape=rectangle,
		width=3.3889];
	layer4_moe_broadcast -> layer4_gate_gpu13	[pos="e,1361.3,594.96 1433.3,630.82 1411.9,620.2 1390.3,609.44 1370.4,599.47"];
	layer4_gate_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Gate_GPU14
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 14",
		pos="1856,553.45",
		shape=rectangle,
		width=3.3889];
	layer4_moe_broadcast -> layer4_gate_gpu14	[pos="e,1774.7,594.96 1702.7,630.82 1724.1,620.2 1745.7,609.44 1765.6,599.47"];
	layer4_gate_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Gate_GPU15
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 15",
		pos="2624,553.45",
		shape=rectangle,
		width=3.3889];
	layer4_moe_broadcast -> layer4_gate_gpu15	[pos="e,2501.8,571.06 1736.5,675.06 1946.3,646.55 2300.3,598.44 2491.7,572.43"];
	layer4_expert12_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert0_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="128,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu12 -> layer4_expert12_0	[pos="e,215.18,472.84 389.66,523.97 340.66,511.59 283.72,495.96 224.67,476.07",
		style=dashed];
	layer4_expert12_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert1_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="320,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu12 -> layer4_expert12_1	[pos="e,386.5,475.97 445.39,511.86 429.15,501.97 411.68,491.32 395.08,481.21",
		style=dashed];
	layer4_expert12_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert2_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="512,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu12 -> layer4_expert12_2	[pos="e,512,475.97 512,511.86 512,503.6 512,494.82 512,486.26",
		style=dashed];
	layer4_expert12_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert3_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="704,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu12 -> layer4_expert12_3	[pos="e,637.5,475.97 578.61,511.86 594.85,501.97 612.32,491.32 628.92,481.21",
		style=dashed];
	layer4_moe_aggregate_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_MoE_Aggregate_GPU12
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 12",
		pos="512,322.95",
		shape=rectangle,
		width=2.9444];
	layer4_expert12_0 -> layer4_moe_aggregate_gpu12	[pos="e,405.85,345.02 215.15,395.97 218.12,394.92 221.08,393.91 224,392.95 279.76,374.65 343.05,358.95 396.08,347.17"];
	layer4_expert12_1 -> layer4_moe_aggregate_gpu12	[pos="e,454.06,357 391.22,392.84 408.85,382.78 427.68,372.04 445.1,362.11"];
	layer4_expert12_2 -> layer4_moe_aggregate_gpu12	[pos="e,512,357.25 512,392.68 512,384.47 512,375.81 512,367.51"];
	layer4_expert12_3 -> layer4_moe_aggregate_gpu12	[pos="e,569.94,357 632.78,392.84 615.15,382.78 596.32,372.04 578.9,362.11"];
	layer4_moe_norm_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU12
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 12",
		pos="837,218.95",
		shape=rectangle,
		width=3.5139];
	layer4_moe_aggregate_gpu12 -> layer4_moe_norm_gpu12	[pos="e,731.73,252.99 617.52,288.84 650.84,278.38 687.81,266.78 721.77,256.12"];
	output	[fillcolor=lightblue,
		height=1.041,
		label="OUTPUT
Input: [batch_size=1024, seq_len=2048, hidden=4096]
GPU: 12-15",
		pos="1491,111.48",
		shape=ellipse,
		width=8.1121];
	layer4_moe_norm_gpu12 -> output	[pos="e,1312.9,141.21 963.87,197.49 1060.1,181.97 1194,160.38 1302.7,142.84"];
	layer4_expert13_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert4_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="896,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu13 -> layer4_expert13_4	[pos="e,983.18,472.84 1157.7,523.97 1108.7,511.59 1051.7,495.96 992.67,476.07",
		style=dashed];
	layer4_expert13_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert5_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1088,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu13 -> layer4_expert13_5	[pos="e,1154.5,475.97 1213.4,511.86 1197.2,501.97 1179.7,491.32 1163.1,481.21",
		style=dashed];
	layer4_expert13_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert6_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1280,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu13 -> layer4_expert13_6	[pos="e,1280,475.97 1280,511.86 1280,503.6 1280,494.82 1280,486.26",
		style=dashed];
	layer4_expert13_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert7_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="1472,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu13 -> layer4_expert13_7	[pos="e,1405.5,475.97 1346.6,511.86 1362.8,501.97 1380.3,491.32 1396.9,481.21",
		style=dashed];
	layer4_moe_aggregate_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_MoE_Aggregate_GPU13
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 13",
		pos="1280,322.95",
		shape=rectangle,
		width=2.9444];
	layer4_expert13_4 -> layer4_moe_aggregate_gpu13	[pos="e,1173.9,345.02 983.15,395.97 986.12,394.92 989.08,393.91 992,392.95 1047.8,374.65 1111.1,358.95 1164.1,347.17"];
	layer4_expert13_5 -> layer4_moe_aggregate_gpu13	[pos="e,1222.1,357 1159.2,392.84 1176.9,382.78 1195.7,372.04 1213.1,362.11"];
	layer4_expert13_6 -> layer4_moe_aggregate_gpu13	[pos="e,1280,357.25 1280,392.68 1280,384.47 1280,375.81 1280,367.51"];
	layer4_expert13_7 -> layer4_moe_aggregate_gpu13	[pos="e,1337.9,357 1400.8,392.84 1383.1,382.78 1364.3,372.04 1346.9,362.11"];
	layer4_moe_norm_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU13
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 13",
		pos="1356,218.95",
		shape=rectangle,
		width=3.5139];
	layer4_moe_aggregate_gpu13 -> layer4_moe_norm_gpu13	[pos="e,1331.2,253.25 1304.7,288.84 1311.2,280.11 1318.3,270.58 1325.1,261.47"];
	layer4_moe_norm_gpu13 -> output	[pos="e,1444.6,148.74 1398.3,184.87 1410.4,175.45 1423.7,165.06 1436.4,155.16"];
	layer4_expert14_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert8_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="1664,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu14 -> layer4_expert14_8	[pos="e,1730.5,475.97 1789.4,511.86 1773.2,501.97 1755.7,491.32 1739.1,481.21",
		style=dashed];
	layer4_expert14_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert9_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="1856,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu14 -> layer4_expert14_9	[pos="e,1856,475.97 1856,511.86 1856,503.6 1856,494.82 1856,486.26",
		style=dashed];
	layer4_expert14_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert10_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="2048,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu14 -> layer4_expert14_10	[pos="e,1981.5,475.97 1922.6,511.86 1938.8,501.97 1956.3,491.32 1972.9,481.21",
		style=dashed];
	layer4_expert14_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert11_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="2240,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu14 -> layer4_expert14_11	[pos="e,2152.8,472.84 1978.3,523.97 2027.3,511.59 2084.3,495.96 2143.3,476.07",
		style=dashed];
	layer4_moe_aggregate_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_MoE_Aggregate_GPU14
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 14",
		pos="1856,322.95",
		shape=rectangle,
		width=2.9444];
	layer4_expert14_8 -> layer4_moe_aggregate_gpu14	[pos="e,1798.1,357 1735.2,392.84 1752.9,382.78 1771.7,372.04 1789.1,362.11"];
	layer4_expert14_9 -> layer4_moe_aggregate_gpu14	[pos="e,1856,357.25 1856,392.68 1856,384.47 1856,375.81 1856,367.51"];
	layer4_expert14_10 -> layer4_moe_aggregate_gpu14	[pos="e,1913.9,357 1976.8,392.84 1959.1,382.78 1940.3,372.04 1922.9,362.11"];
	layer4_expert14_11 -> layer4_moe_aggregate_gpu14	[pos="e,1962.1,345.02 2152.9,395.97 2149.9,394.92 2146.9,393.91 2144,392.95 2088.2,374.65 2024.9,358.95 1971.9,347.17"];
	layer4_moe_norm_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU14
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 14",
		pos="1779,218.95",
		shape=rectangle,
		width=3.5139];
	layer4_moe_aggregate_gpu14 -> layer4_moe_norm_gpu14	[pos="e,1804.1,253.25 1831,288.84 1824.4,280.11 1817.2,270.58 1810.3,261.47"];
	layer4_moe_norm_gpu14 -> output	[pos="e,1585.2,146.99 1688.7,184.87 1658.8,173.95 1625.4,161.71 1594.7,150.45"];
	layer4_expert15_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert12_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2432,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu15 -> layer4_expert15_12	[pos="e,2498.5,475.97 2557.4,511.86 2541.2,501.97 2523.7,491.32 2507.1,481.21",
		style=dashed];
	layer4_expert15_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert13_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2624,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu15 -> layer4_expert15_13	[pos="e,2624,475.97 2624,511.86 2624,503.6 2624,494.82 2624,486.26",
		style=dashed];
	layer4_expert15_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert14_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="2816,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu15 -> layer4_expert15_14	[pos="e,2749.5,475.97 2690.6,511.86 2706.8,501.97 2724.3,491.32 2740.9,481.21",
		style=dashed];
	layer4_expert15_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L4_Expert15_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="3008,434.45",
		shape=rectangle,
		width=2.4167];
	layer4_gate_gpu15 -> layer4_expert15_15	[pos="e,2920.8,472.84 2746.3,523.97 2795.3,511.59 2852.3,495.96 2911.3,476.07",
		style=dashed];
	layer4_moe_aggregate_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_MoE_Aggregate_GPU15
Input: 4×[tokens,4096]
Output: [1024,2048,4096]
GPU: 15",
		pos="2624,322.95",
		shape=rectangle,
		width=2.9444];
	layer4_expert15_12 -> layer4_moe_aggregate_gpu15	[pos="e,2566.1,357 2503.2,392.84 2520.9,382.78 2539.7,372.04 2557.1,362.11"];
	layer4_expert15_13 -> layer4_moe_aggregate_gpu15	[pos="e,2624,357.25 2624,392.68 2624,384.47 2624,375.81 2624,367.51"];
	layer4_expert15_14 -> layer4_moe_aggregate_gpu15	[pos="e,2681.9,357 2744.8,392.84 2727.1,382.78 2708.3,372.04 2690.9,362.11"];
	layer4_expert15_15 -> layer4_moe_aggregate_gpu15	[pos="e,2730.1,345.02 2920.9,395.97 2917.9,394.92 2914.9,393.91 2912,392.95 2856.2,374.65 2792.9,358.95 2739.9,347.17"];
	layer4_moe_norm_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L4_Residual+LayerNorm_GPU15
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 15",
		pos="2375,218.95",
		shape=rectangle,
		width=3.5139];
	layer4_moe_aggregate_gpu15 -> layer4_moe_norm_gpu15	[pos="e,2455.9,253.08 2543.2,288.84 2518.2,278.63 2490.7,267.33 2465.2,256.88"];
	layer4_moe_norm_gpu15 -> output	[pos="e,1701,137.54 2248.3,202.84 2108.4,186.14 1880.4,158.94 1711.1,138.74"];
}
