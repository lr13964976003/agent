<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: PP2_Standalone Pages: 1 -->
<svg width="2160pt" height="54pt"
 viewBox="0.00 0.00 2160.00 53.66" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.03 0.03) rotate(0) translate(4 1789.95)">
<title>PP2_Standalone</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1789.95 72213,-1789.95 72213,4 -4,4"/>
<text text-anchor="middle" x="36104.5" y="-54" font-family="Times,serif" font-size="20.00">Standalone Pipeline Parallelism 2</text>
<text text-anchor="middle" x="36104.5" y="-32" font-family="Times,serif" font-size="20.00">16 GPUs total</text>
<text text-anchor="middle" x="36104.5" y="-10" font-family="Times,serif" font-size="20.00">2 stages × 8 GPUs each</text>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="12592" cy="-1744.48" rx="292.07" ry="37.45"/>
<text text-anchor="middle" x="12592" y="-1755.78" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="12592" y="-1740.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="12592" y="-1725.78" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer0_qkv_gpu0 -->
<g id="node3" class="node">
<title>layer0_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="7475,-1667 7263,-1667 7263,-1599 7475,-1599 7475,-1667"/>
<text text-anchor="middle" x="7369" y="-1651.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="7369" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7369" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="7369" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M12299.99,-1743.07C11288.96,-1741.11 7973.54,-1729.91 7499,-1667 7494.46,-1666.4 7489.86,-1665.69 7485.22,-1664.91"/>
<polygon fill="black" stroke="black" points="7485.49,-1661.4 7475.02,-1663.06 7484.24,-1668.29 7485.49,-1661.4"/>
</g>
<!-- layer0_qkv_gpu1 -->
<g id="node25" class="node">
<title>layer0_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="7720,-1667 7508,-1667 7508,-1599 7720,-1599 7720,-1667"/>
<text text-anchor="middle" x="7614" y="-1651.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="7614" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7614" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="7614" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu1</title>
<path fill="none" stroke="black" d="M12305.12,-1737.17C11358.82,-1716.36 8360.71,-1650.42 7730.82,-1636.57"/>
<polygon fill="black" stroke="black" points="7730.45,-1633.06 7720.37,-1636.34 7730.29,-1640.06 7730.45,-1633.06"/>
</g>
<!-- layer0_qkv_gpu2 -->
<g id="node47" class="node">
<title>layer0_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="10932,-1667 10720,-1667 10720,-1599 10932,-1599 10932,-1667"/>
<text text-anchor="middle" x="10826" y="-1651.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="10826" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10826" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="10826" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu2</title>
<path fill="none" stroke="black" d="M12331.9,-1727.35C11942.28,-1703.2 11222.94,-1658.61 10942.36,-1641.21"/>
<polygon fill="black" stroke="black" points="10942.36,-1637.71 10932.16,-1640.58 10941.93,-1644.69 10942.36,-1637.71"/>
</g>
<!-- layer0_qkv_gpu3 -->
<g id="node69" class="node">
<title>layer0_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11935,-1667 11723,-1667 11723,-1599 11935,-1599 11935,-1667"/>
<text text-anchor="middle" x="11829" y="-1651.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="11829" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11829" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="11829" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu3</title>
<path fill="none" stroke="black" d="M12400.94,-1716.06C12257.64,-1695.5 12066.14,-1668.03 11945.16,-1650.67"/>
<polygon fill="black" stroke="black" points="11945.52,-1647.18 11935.13,-1649.23 11944.53,-1654.11 11945.52,-1647.18"/>
</g>
<!-- layer0_qkv_gpu4 -->
<g id="node91" class="node">
<title>layer0_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12828,-1667 12616,-1667 12616,-1599 12828,-1599 12828,-1667"/>
<text text-anchor="middle" x="12722" y="-1651.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="12722" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12722" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="12722" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu4 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu4</title>
<path fill="none" stroke="black" d="M12634.93,-1707.33C12647.67,-1696.6 12661.69,-1684.79 12674.69,-1673.84"/>
<polygon fill="black" stroke="black" points="12677.24,-1676.27 12682.63,-1667.15 12672.73,-1670.92 12677.24,-1676.27"/>
</g>
<!-- layer0_qkv_gpu5 -->
<g id="node113" class="node">
<title>layer0_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="14070,-1667 13858,-1667 13858,-1599 14070,-1599 14070,-1667"/>
<text text-anchor="middle" x="13964" y="-1651.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="13964" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13964" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="13964" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu5 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu5</title>
<path fill="none" stroke="black" d="M12836.5,-1723.97C13134.3,-1700.2 13625.12,-1661.04 13847.75,-1643.28"/>
<polygon fill="black" stroke="black" points="13848.14,-1646.76 13857.83,-1642.47 13847.58,-1639.78 13848.14,-1646.76"/>
</g>
<!-- layer0_qkv_gpu6 -->
<g id="node135" class="node">
<title>layer0_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="15355,-1667 15143,-1667 15143,-1599 15355,-1599 15355,-1667"/>
<text text-anchor="middle" x="15249" y="-1651.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="15249" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="15249" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="15249" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu6 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu6</title>
<path fill="none" stroke="black" d="M12867.89,-1732.11C13440.61,-1708.51 14737.99,-1655.06 15132.82,-1638.79"/>
<polygon fill="black" stroke="black" points="15132.98,-1642.28 15142.83,-1638.37 15132.69,-1635.29 15132.98,-1642.28"/>
</g>
<!-- layer0_qkv_gpu7 -->
<g id="node157" class="node">
<title>layer0_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="18786,-1667 18574,-1667 18574,-1599 18786,-1599 18786,-1667"/>
<text text-anchor="middle" x="18680" y="-1651.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="18680" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="18680" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="18680" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu7 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu7</title>
<path fill="none" stroke="black" d="M12880.27,-1738.29C13974,-1718.63 17842.02,-1649.07 18563.61,-1636.09"/>
<polygon fill="black" stroke="black" points="18563.82,-1639.59 18573.75,-1635.91 18563.69,-1632.59 18563.82,-1639.59"/>
</g>
<!-- stage0_boundary -->
<g id="node2" class="node">
<title>stage0_boundary</title>
<ellipse fill="lightblue" stroke="black" cx="19237" cy="-1744.48" rx="102.56" ry="37.46"/>
<ellipse fill="none" stroke="black" cx="19237" cy="-1744.48" rx="106.56" ry="41.45"/>
<text text-anchor="middle" x="19237" y="-1755.78" font-family="Times,serif" font-size="14.00">Stage 0 Boundary</text>
<text text-anchor="middle" x="19237" y="-1740.78" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
<text text-anchor="middle" x="19237" y="-1725.78" font-family="Times,serif" font-size="14.00">Layers 0&#45;1</text>
</g>
<!-- layer0_attn_gpu0 -->
<g id="node4" class="node">
<title>layer0_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="6756.5,-1563 6513.5,-1563 6513.5,-1495 6756.5,-1495 6756.5,-1563"/>
<text text-anchor="middle" x="6635" y="-1547.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="6635" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="6635" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6635" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_qkv_gpu0&#45;&gt;layer0_attn_gpu0 -->
<g id="edge9" class="edge">
<title>layer0_qkv_gpu0&#45;&gt;layer0_attn_gpu0</title>
<path fill="none" stroke="black" d="M7262.8,-1624.23C7143.85,-1614.53 6945.32,-1595.39 6766.53,-1563.21"/>
<polygon fill="black" stroke="black" points="6767.14,-1559.76 6756.68,-1561.42 6765.89,-1566.65 6767.14,-1559.76"/>
</g>
<!-- layer0_attn_norm_gpu0 -->
<g id="node5" class="node">
<title>layer0_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3587,-1451.5 3343,-1451.5 3343,-1383.5 3587,-1383.5 3587,-1451.5"/>
<text text-anchor="middle" x="3465" y="-1436.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="3465" y="-1421.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="3465" y="-1406.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3465" y="-1391.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_gpu0&#45;&gt;layer0_attn_norm_gpu0 -->
<g id="edge10" class="edge">
<title>layer0_attn_gpu0&#45;&gt;layer0_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M6513.16,-1523.79C6012.61,-1506.5 4116.46,-1441 3597.18,-1423.07"/>
<polygon fill="black" stroke="black" points="3597.14,-1419.56 3587.03,-1422.72 3596.9,-1426.56 3597.14,-1419.56"/>
</g>
<!-- layer0_gate_gpu0 -->
<g id="node6" class="node">
<title>layer0_gate_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1745,-1340 1501,-1340 1501,-1257 1745,-1257 1745,-1340"/>
<text text-anchor="middle" x="1623" y="-1324.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU0</text>
<text text-anchor="middle" x="1623" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1623" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1623" y="-1279.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="1623" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_norm_gpu0&#45;&gt;layer0_gate_gpu0 -->
<g id="edge11" class="edge">
<title>layer0_attn_norm_gpu0&#45;&gt;layer0_gate_gpu0</title>
<path fill="none" stroke="black" d="M3342.71,-1408.73C3011.4,-1387.69 2098.38,-1329.7 1755.47,-1307.91"/>
<polygon fill="black" stroke="black" points="1755.44,-1304.41 1745.24,-1307.26 1755,-1311.39 1755.44,-1304.41"/>
</g>
<!-- layer0_expert0_0 -->
<g id="node7" class="node">
<title>layer0_expert0_0</title>
<polygon fill="lightgreen" stroke="black" points="174,-1221 0,-1221 0,-1138 174,-1138 174,-1221"/>
<text text-anchor="middle" x="87" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU0</text>
<text text-anchor="middle" x="87" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="87" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="87" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="87" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_0 -->
<g id="edge12" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.8,-1296.41C1204.21,-1292.92 451.59,-1278.7 184.29,-1221.01"/>
<polygon fill="black" stroke="black" points="184.74,-1217.52 174.22,-1218.76 183.22,-1224.35 184.74,-1217.52"/>
</g>
<!-- layer0_expert0_1 -->
<g id="node8" class="node">
<title>layer0_expert0_1</title>
<polygon fill="lightgreen" stroke="black" points="366,-1221 192,-1221 192,-1138 366,-1138 366,-1221"/>
<text text-anchor="middle" x="279" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU0</text>
<text text-anchor="middle" x="279" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="279" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="279" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="279" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_1 -->
<g id="edge13" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.82,-1295.24C1233.95,-1289.47 605.25,-1271.11 376.17,-1220.99"/>
<polygon fill="black" stroke="black" points="376.75,-1217.53 366.22,-1218.73 375.2,-1224.35 376.75,-1217.53"/>
</g>
<!-- layer0_expert0_2 -->
<g id="node9" class="node">
<title>layer0_expert0_2</title>
<polygon fill="lightgreen" stroke="black" points="558,-1221 384,-1221 384,-1138 558,-1138 558,-1221"/>
<text text-anchor="middle" x="471" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU0</text>
<text text-anchor="middle" x="471" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="471" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="471" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="471" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_2 -->
<g id="edge14" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.92,-1293.65C1266.28,-1285.46 759.38,-1263.62 568.19,-1220.99"/>
<polygon fill="black" stroke="black" points="568.77,-1217.54 558.23,-1218.69 567.19,-1224.35 568.77,-1217.54"/>
</g>
<!-- layer0_expert0_3 -->
<g id="node10" class="node">
<title>layer0_expert0_3</title>
<polygon fill="lightgreen" stroke="black" points="750,-1221 576,-1221 576,-1138 750,-1138 750,-1221"/>
<text text-anchor="middle" x="663" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU0</text>
<text text-anchor="middle" x="663" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="663" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="663" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="663" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_3 -->
<g id="edge15" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.77,-1291.36C1301.25,-1280.58 913.31,-1256.2 760,-1220.96"/>
<polygon fill="black" stroke="black" points="760.79,-1217.55 750.25,-1218.63 759.16,-1224.36 760.79,-1217.55"/>
</g>
<!-- layer0_expert0_4 -->
<g id="node11" class="node">
<title>layer0_expert0_4</title>
<polygon fill="lightgreen" stroke="black" points="942,-1221 768,-1221 768,-1138 942,-1138 942,-1221"/>
<text text-anchor="middle" x="855" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU0</text>
<text text-anchor="middle" x="855" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="855" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="855" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="855" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_4 -->
<g id="edge16" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.91,-1294.05C1367.03,-1287.91 1146.46,-1270.84 951.84,-1221"/>
<polygon fill="black" stroke="black" points="952.57,-1217.57 942.01,-1218.45 950.81,-1224.35 952.57,-1217.57"/>
</g>
<!-- layer0_expert0_5 -->
<g id="node12" class="node">
<title>layer0_expert0_5</title>
<polygon fill="lightgreen" stroke="black" points="1134,-1221 960,-1221 960,-1138 1134,-1138 1134,-1221"/>
<text text-anchor="middle" x="1047" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU0</text>
<text text-anchor="middle" x="1047" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1047" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1047" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1047" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_5 -->
<g id="edge17" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.91,-1286.26C1405.32,-1275.56 1269.37,-1256.14 1143.84,-1221.05"/>
<polygon fill="black" stroke="black" points="1144.63,-1217.64 1134.06,-1218.28 1142.72,-1224.37 1144.63,-1217.64"/>
</g>
<!-- layer0_expert0_6 -->
<g id="node13" class="node">
<title>layer0_expert0_6</title>
<polygon fill="lightgreen" stroke="black" points="1326,-1221 1152,-1221 1152,-1138 1326,-1138 1326,-1221"/>
<text text-anchor="middle" x="1239" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU0</text>
<text text-anchor="middle" x="1239" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1239" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1239" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1239" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_6 -->
<g id="edge18" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.66,-1269.02C1451.66,-1256.63 1394.72,-1241.01 1335.67,-1221.12"/>
<polygon fill="black" stroke="black" points="1336.77,-1217.79 1326.18,-1217.89 1334.52,-1224.42 1336.77,-1217.79"/>
</g>
<!-- layer0_expert0_7 -->
<g id="node14" class="node">
<title>layer0_expert0_7</title>
<polygon fill="lightgreen" stroke="black" points="1518,-1221 1344,-1221 1344,-1138 1518,-1138 1518,-1221"/>
<text text-anchor="middle" x="1431" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU0</text>
<text text-anchor="middle" x="1431" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1431" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1431" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1431" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_7 -->
<g id="edge19" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1556.39,-1256.91C1540.15,-1247.02 1522.68,-1236.37 1506.08,-1226.25"/>
<polygon fill="black" stroke="black" points="1507.86,-1223.24 1497.5,-1221.02 1504.21,-1229.21 1507.86,-1223.24"/>
</g>
<!-- layer0_expert0_8 -->
<g id="node15" class="node">
<title>layer0_expert0_8</title>
<polygon fill="lightgreen" stroke="black" points="1710,-1221 1536,-1221 1536,-1138 1710,-1138 1710,-1221"/>
<text text-anchor="middle" x="1623" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU0</text>
<text text-anchor="middle" x="1623" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1623" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1623" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1623" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_8 -->
<g id="edge20" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1623,-1256.91C1623,-1248.65 1623,-1239.86 1623,-1231.3"/>
<polygon fill="black" stroke="black" points="1626.5,-1231.02 1623,-1221.02 1619.5,-1231.02 1626.5,-1231.02"/>
</g>
<!-- layer0_expert0_9 -->
<g id="node16" class="node">
<title>layer0_expert0_9</title>
<polygon fill="lightgreen" stroke="black" points="1902,-1221 1728,-1221 1728,-1138 1902,-1138 1902,-1221"/>
<text text-anchor="middle" x="1815" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU0</text>
<text text-anchor="middle" x="1815" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1815" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1815" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1815" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_9 -->
<g id="edge21" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1689.61,-1256.91C1705.85,-1247.02 1723.32,-1236.37 1739.92,-1226.25"/>
<polygon fill="black" stroke="black" points="1741.79,-1229.21 1748.5,-1221.02 1738.14,-1223.24 1741.79,-1229.21"/>
</g>
<!-- layer0_expert0_10 -->
<g id="node17" class="node">
<title>layer0_expert0_10</title>
<polygon fill="lightgreen" stroke="black" points="2094,-1221 1920,-1221 1920,-1138 2094,-1138 2094,-1221"/>
<text text-anchor="middle" x="2007" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU0</text>
<text text-anchor="middle" x="2007" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2007" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2007" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2007" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_10 -->
<g id="edge22" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.34,-1269.02C1794.34,-1256.63 1851.28,-1241.01 1910.33,-1221.12"/>
<polygon fill="black" stroke="black" points="1911.48,-1224.42 1919.82,-1217.89 1909.23,-1217.79 1911.48,-1224.42"/>
</g>
<!-- layer0_expert0_11 -->
<g id="node18" class="node">
<title>layer0_expert0_11</title>
<polygon fill="lightgreen" stroke="black" points="2286,-1221 2112,-1221 2112,-1138 2286,-1138 2286,-1221"/>
<text text-anchor="middle" x="2199" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU0</text>
<text text-anchor="middle" x="2199" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2199" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2199" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2199" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_11 -->
<g id="edge23" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.09,-1286.26C1840.68,-1275.56 1976.63,-1256.14 2102.16,-1221.05"/>
<polygon fill="black" stroke="black" points="2103.28,-1224.37 2111.94,-1218.28 2101.37,-1217.64 2103.28,-1224.37"/>
</g>
<!-- layer0_expert0_12 -->
<g id="node19" class="node">
<title>layer0_expert0_12</title>
<polygon fill="lightgreen" stroke="black" points="2478,-1221 2304,-1221 2304,-1138 2478,-1138 2478,-1221"/>
<text text-anchor="middle" x="2391" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU0</text>
<text text-anchor="middle" x="2391" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2391" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2391" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2391" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_12 -->
<g id="edge24" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.09,-1294.05C1878.97,-1287.91 2099.54,-1270.84 2294.16,-1221"/>
<polygon fill="black" stroke="black" points="2295.19,-1224.35 2303.99,-1218.45 2293.43,-1217.57 2295.19,-1224.35"/>
</g>
<!-- layer0_expert0_13 -->
<g id="node20" class="node">
<title>layer0_expert0_13</title>
<polygon fill="lightgreen" stroke="black" points="2670,-1221 2496,-1221 2496,-1138 2670,-1138 2670,-1221"/>
<text text-anchor="middle" x="2583" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU0</text>
<text text-anchor="middle" x="2583" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2583" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2583" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2583" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_13 -->
<g id="edge25" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.23,-1291.36C1944.75,-1280.58 2332.69,-1256.2 2486,-1220.96"/>
<polygon fill="black" stroke="black" points="2486.84,-1224.36 2495.75,-1218.63 2485.21,-1217.55 2486.84,-1224.36"/>
</g>
<!-- layer0_expert0_14 -->
<g id="node21" class="node">
<title>layer0_expert0_14</title>
<polygon fill="lightgreen" stroke="black" points="2862,-1221 2688,-1221 2688,-1138 2862,-1138 2862,-1221"/>
<text text-anchor="middle" x="2775" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU0</text>
<text text-anchor="middle" x="2775" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2775" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2775" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2775" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_14 -->
<g id="edge26" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.08,-1293.65C1979.72,-1285.46 2486.62,-1263.62 2677.81,-1220.99"/>
<polygon fill="black" stroke="black" points="2678.81,-1224.35 2687.77,-1218.69 2677.23,-1217.54 2678.81,-1224.35"/>
</g>
<!-- layer0_expert0_15 -->
<g id="node22" class="node">
<title>layer0_expert0_15</title>
<polygon fill="lightgreen" stroke="black" points="3054,-1221 2880,-1221 2880,-1138 3054,-1138 3054,-1221"/>
<text text-anchor="middle" x="2967" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU0</text>
<text text-anchor="middle" x="2967" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2967" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2967" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2967" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_15 -->
<g id="edge27" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.18,-1295.24C2012.05,-1289.47 2640.75,-1271.11 2869.83,-1220.99"/>
<polygon fill="black" stroke="black" points="2870.8,-1224.35 2879.78,-1218.73 2869.25,-1217.53 2870.8,-1224.35"/>
</g>
<!-- layer0_moe_agg_gpu0 -->
<g id="node23" class="node">
<title>layer0_moe_agg_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1628.5,-1102 1425.5,-1102 1425.5,-1034 1628.5,-1034 1628.5,-1102"/>
<text text-anchor="middle" x="1527" y="-1086.8" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU0</text>
<text text-anchor="middle" x="1527" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="1527" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1527" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_expert0_0&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge28" class="edge">
<title>layer0_expert0_0&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M174.22,-1140.23C177.16,-1139.42 180.09,-1138.67 183,-1138 416.11,-1084.58 1135.88,-1072.47 1414.88,-1069.77"/>
<polygon fill="black" stroke="black" points="1415.06,-1073.27 1425.02,-1069.67 1414.99,-1066.27 1415.06,-1073.27"/>
</g>
<!-- layer0_expert0_1&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge29" class="edge">
<title>layer0_expert0_1&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M366.22,-1140.27C369.16,-1139.44 372.09,-1138.68 375,-1138 570.44,-1092.34 1165.55,-1075.89 1415.05,-1070.89"/>
<polygon fill="black" stroke="black" points="1415.3,-1074.39 1425.23,-1070.69 1415.16,-1067.39 1415.3,-1074.39"/>
</g>
<!-- layer0_expert0_2&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge30" class="edge">
<title>layer0_expert0_2&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M558.23,-1140.31C561.17,-1139.47 564.1,-1138.7 567,-1138 725.15,-1100.05 1197.85,-1079.92 1415.3,-1072.45"/>
<polygon fill="black" stroke="black" points="1415.59,-1075.94 1425.46,-1072.1 1415.35,-1068.95 1415.59,-1075.94"/>
</g>
<!-- layer0_expert0_3&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge31" class="edge">
<title>layer0_expert0_3&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M750.25,-1140.38C753.18,-1139.52 756.1,-1138.72 759,-1138 987.24,-1081.08 1263.98,-1069.79 1415.11,-1068.31"/>
<polygon fill="black" stroke="black" points="1415.36,-1071.81 1425.33,-1068.22 1415.3,-1064.81 1415.36,-1071.81"/>
</g>
<!-- layer0_expert0_4&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge32" class="edge">
<title>layer0_expert0_4&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M942.01,-1140.57C945.03,-1139.65 948.03,-1138.79 951,-1138 1108.85,-1096.14 1297.82,-1079.63 1415.16,-1073.14"/>
<polygon fill="black" stroke="black" points="1415.44,-1076.63 1425.24,-1072.6 1415.07,-1069.64 1415.44,-1076.63"/>
</g>
<!-- layer0_expert0_5&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge33" class="edge">
<title>layer0_expert0_5&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1134.08,-1140.8C1137.07,-1139.81 1140.05,-1138.87 1143,-1138 1232.8,-1111.35 1337.64,-1093.36 1415.06,-1082.44"/>
<polygon fill="black" stroke="black" points="1415.9,-1085.86 1425.32,-1081.02 1414.93,-1078.93 1415.9,-1085.86"/>
</g>
<!-- layer0_expert0_6&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge34" class="edge">
<title>layer0_expert0_6&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1326.04,-1141.54C1329.06,-1140.33 1332.05,-1139.15 1335,-1138 1363.16,-1127.01 1393.89,-1115.68 1422.34,-1105.45"/>
<polygon fill="black" stroke="black" points="1423.66,-1108.7 1431.89,-1102.03 1421.3,-1102.11 1423.66,-1108.7"/>
</g>
<!-- layer0_expert0_7&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge35" class="edge">
<title>layer0_expert0_7&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1466.75,-1137.73C1474.66,-1128.7 1483.06,-1119.12 1490.98,-1110.08"/>
<polygon fill="black" stroke="black" points="1493.85,-1112.13 1497.81,-1102.3 1488.58,-1107.51 1493.85,-1112.13"/>
</g>
<!-- layer0_expert0_8&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge36" class="edge">
<title>layer0_expert0_8&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1587.25,-1137.73C1579.34,-1128.7 1570.94,-1119.12 1563.02,-1110.08"/>
<polygon fill="black" stroke="black" points="1565.42,-1107.51 1556.19,-1102.3 1560.15,-1112.13 1565.42,-1107.51"/>
</g>
<!-- layer0_expert0_9&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge37" class="edge">
<title>layer0_expert0_9&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1727.96,-1141.54C1724.94,-1140.33 1721.95,-1139.15 1719,-1138 1690.84,-1127.01 1660.11,-1115.68 1631.66,-1105.45"/>
<polygon fill="black" stroke="black" points="1632.7,-1102.11 1622.11,-1102.03 1630.34,-1108.7 1632.7,-1102.11"/>
</g>
<!-- layer0_expert0_10&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge38" class="edge">
<title>layer0_expert0_10&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1919.92,-1140.8C1916.93,-1139.81 1913.95,-1138.87 1911,-1138 1821.2,-1111.35 1716.36,-1093.36 1638.94,-1082.44"/>
<polygon fill="black" stroke="black" points="1639.07,-1078.93 1628.68,-1081.02 1638.1,-1085.86 1639.07,-1078.93"/>
</g>
<!-- layer0_expert0_11&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge39" class="edge">
<title>layer0_expert0_11&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2111.99,-1140.57C2108.97,-1139.65 2105.97,-1138.79 2103,-1138 1945.15,-1096.14 1756.18,-1079.63 1638.84,-1073.14"/>
<polygon fill="black" stroke="black" points="1638.93,-1069.64 1628.76,-1072.6 1638.56,-1076.63 1638.93,-1069.64"/>
</g>
<!-- layer0_expert0_12&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge40" class="edge">
<title>layer0_expert0_12&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2303.75,-1140.38C2300.82,-1139.52 2297.9,-1138.72 2295,-1138 2066.76,-1081.08 1790.02,-1069.79 1638.89,-1068.31"/>
<polygon fill="black" stroke="black" points="1638.7,-1064.81 1628.67,-1068.22 1638.64,-1071.81 1638.7,-1064.81"/>
</g>
<!-- layer0_expert0_13&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge41" class="edge">
<title>layer0_expert0_13&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2495.77,-1140.31C2492.83,-1139.47 2489.9,-1138.7 2487,-1138 2328.85,-1100.05 1856.15,-1079.92 1638.7,-1072.45"/>
<polygon fill="black" stroke="black" points="1638.65,-1068.95 1628.54,-1072.1 1638.41,-1075.94 1638.65,-1068.95"/>
</g>
<!-- layer0_expert0_14&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge42" class="edge">
<title>layer0_expert0_14&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2687.78,-1140.27C2684.84,-1139.44 2681.91,-1138.68 2679,-1138 2483.56,-1092.34 1888.45,-1075.89 1638.95,-1070.89"/>
<polygon fill="black" stroke="black" points="1638.84,-1067.39 1628.77,-1070.69 1638.7,-1074.39 1638.84,-1067.39"/>
</g>
<!-- layer0_expert0_15&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge43" class="edge">
<title>layer0_expert0_15&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2879.78,-1140.23C2876.84,-1139.42 2873.91,-1138.67 2871,-1138 2637.89,-1084.58 1918.12,-1072.47 1639.12,-1069.77"/>
<polygon fill="black" stroke="black" points="1639.01,-1066.27 1628.98,-1069.67 1638.94,-1073.27 1639.01,-1066.27"/>
</g>
<!-- layer0_output_gpu0 -->
<g id="node24" class="node">
<title>layer0_output_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1649,-949 1405,-949 1405,-881 1649,-881 1649,-949"/>
<text text-anchor="middle" x="1527" y="-933.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="1527" y="-918.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="1527" y="-903.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1527" y="-888.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_moe_agg_gpu0&#45;&gt;layer0_output_gpu0 -->
<g id="edge44" class="edge">
<title>layer0_moe_agg_gpu0&#45;&gt;layer0_output_gpu0</title>
<path fill="none" stroke="black" d="M1527,-1033.86C1527,-1011.93 1527,-982.95 1527,-959.21"/>
<polygon fill="black" stroke="black" points="1530.5,-959.06 1527,-949.06 1523.5,-959.06 1530.5,-959.06"/>
</g>
<!-- layer0_attn_gpu1 -->
<g id="node26" class="node">
<title>layer0_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="7017.5,-1563 6774.5,-1563 6774.5,-1495 7017.5,-1495 7017.5,-1563"/>
<text text-anchor="middle" x="6896" y="-1547.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="6896" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="6896" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6896" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_qkv_gpu1&#45;&gt;layer0_attn_gpu1 -->
<g id="edge45" class="edge">
<title>layer0_qkv_gpu1&#45;&gt;layer0_attn_gpu1</title>
<path fill="none" stroke="black" d="M7507.83,-1603.84C7499.8,-1602.08 7491.79,-1600.44 7484,-1599 7328.58,-1570.28 7147.73,-1551.17 7028.06,-1540.48"/>
<polygon fill="black" stroke="black" points="7028.03,-1536.97 7017.76,-1539.57 7027.41,-1543.94 7028.03,-1536.97"/>
</g>
<!-- layer0_attn_norm_gpu1 -->
<g id="node27" class="node">
<title>layer0_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="6659,-1451.5 6415,-1451.5 6415,-1383.5 6659,-1383.5 6659,-1451.5"/>
<text text-anchor="middle" x="6537" y="-1436.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="6537" y="-1421.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="6537" y="-1406.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6537" y="-1391.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_gpu1&#45;&gt;layer0_attn_norm_gpu1 -->
<g id="edge46" class="edge">
<title>layer0_attn_gpu1&#45;&gt;layer0_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M6787.8,-1495C6745.86,-1482.21 6697.72,-1467.52 6654.91,-1454.46"/>
<polygon fill="black" stroke="black" points="6655.87,-1451.1 6645.29,-1451.53 6653.83,-1457.79 6655.87,-1451.1"/>
</g>
<!-- layer0_gate_gpu1 -->
<g id="node28" class="node">
<title>layer0_gate_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4817,-1340 4573,-1340 4573,-1257 4817,-1257 4817,-1340"/>
<text text-anchor="middle" x="4695" y="-1324.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU1</text>
<text text-anchor="middle" x="4695" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4695" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="4695" y="-1279.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="4695" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_norm_gpu1&#45;&gt;layer0_gate_gpu1 -->
<g id="edge47" class="edge">
<title>layer0_attn_norm_gpu1&#45;&gt;layer0_gate_gpu1</title>
<path fill="none" stroke="black" d="M6414.71,-1408.73C6083.4,-1387.69 5170.38,-1329.7 4827.47,-1307.91"/>
<polygon fill="black" stroke="black" points="4827.44,-1304.41 4817.24,-1307.26 4827,-1311.39 4827.44,-1304.41"/>
</g>
<!-- layer0_expert1_0 -->
<g id="node29" class="node">
<title>layer0_expert1_0</title>
<polygon fill="lightgreen" stroke="black" points="3246,-1221 3072,-1221 3072,-1138 3246,-1138 3246,-1221"/>
<text text-anchor="middle" x="3159" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU1</text>
<text text-anchor="middle" x="3159" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3159" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3159" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3159" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_0 -->
<g id="edge48" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.8,-1296.41C4276.21,-1292.92 3523.59,-1278.7 3256.29,-1221.01"/>
<polygon fill="black" stroke="black" points="3256.74,-1217.52 3246.22,-1218.76 3255.22,-1224.35 3256.74,-1217.52"/>
</g>
<!-- layer0_expert1_1 -->
<g id="node30" class="node">
<title>layer0_expert1_1</title>
<polygon fill="lightgreen" stroke="black" points="3438,-1221 3264,-1221 3264,-1138 3438,-1138 3438,-1221"/>
<text text-anchor="middle" x="3351" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU1</text>
<text text-anchor="middle" x="3351" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3351" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3351" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3351" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_1 -->
<g id="edge49" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.82,-1295.24C4305.95,-1289.47 3677.25,-1271.11 3448.17,-1220.99"/>
<polygon fill="black" stroke="black" points="3448.75,-1217.53 3438.22,-1218.73 3447.2,-1224.35 3448.75,-1217.53"/>
</g>
<!-- layer0_expert1_2 -->
<g id="node31" class="node">
<title>layer0_expert1_2</title>
<polygon fill="lightgreen" stroke="black" points="3630,-1221 3456,-1221 3456,-1138 3630,-1138 3630,-1221"/>
<text text-anchor="middle" x="3543" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU1</text>
<text text-anchor="middle" x="3543" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3543" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3543" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3543" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_2 -->
<g id="edge50" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.92,-1293.65C4338.28,-1285.46 3831.38,-1263.62 3640.19,-1220.99"/>
<polygon fill="black" stroke="black" points="3640.77,-1217.54 3630.23,-1218.69 3639.19,-1224.35 3640.77,-1217.54"/>
</g>
<!-- layer0_expert1_3 -->
<g id="node32" class="node">
<title>layer0_expert1_3</title>
<polygon fill="lightgreen" stroke="black" points="3822,-1221 3648,-1221 3648,-1138 3822,-1138 3822,-1221"/>
<text text-anchor="middle" x="3735" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU1</text>
<text text-anchor="middle" x="3735" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3735" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3735" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3735" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_3 -->
<g id="edge51" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.77,-1291.36C4373.25,-1280.58 3985.31,-1256.2 3832,-1220.96"/>
<polygon fill="black" stroke="black" points="3832.79,-1217.55 3822.25,-1218.63 3831.16,-1224.36 3832.79,-1217.55"/>
</g>
<!-- layer0_expert1_4 -->
<g id="node33" class="node">
<title>layer0_expert1_4</title>
<polygon fill="lightgreen" stroke="black" points="4014,-1221 3840,-1221 3840,-1138 4014,-1138 4014,-1221"/>
<text text-anchor="middle" x="3927" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU1</text>
<text text-anchor="middle" x="3927" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3927" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3927" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3927" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_4 -->
<g id="edge52" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.91,-1294.05C4439.03,-1287.91 4218.46,-1270.84 4023.84,-1221"/>
<polygon fill="black" stroke="black" points="4024.57,-1217.57 4014.01,-1218.45 4022.81,-1224.35 4024.57,-1217.57"/>
</g>
<!-- layer0_expert1_5 -->
<g id="node34" class="node">
<title>layer0_expert1_5</title>
<polygon fill="lightgreen" stroke="black" points="4206,-1221 4032,-1221 4032,-1138 4206,-1138 4206,-1221"/>
<text text-anchor="middle" x="4119" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU1</text>
<text text-anchor="middle" x="4119" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4119" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4119" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4119" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_5 -->
<g id="edge53" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.91,-1286.26C4477.32,-1275.56 4341.37,-1256.14 4215.84,-1221.05"/>
<polygon fill="black" stroke="black" points="4216.63,-1217.64 4206.06,-1218.28 4214.72,-1224.37 4216.63,-1217.64"/>
</g>
<!-- layer0_expert1_6 -->
<g id="node35" class="node">
<title>layer0_expert1_6</title>
<polygon fill="lightgreen" stroke="black" points="4398,-1221 4224,-1221 4224,-1138 4398,-1138 4398,-1221"/>
<text text-anchor="middle" x="4311" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU1</text>
<text text-anchor="middle" x="4311" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4311" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4311" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4311" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_6 -->
<g id="edge54" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.66,-1269.02C4523.66,-1256.63 4466.72,-1241.01 4407.67,-1221.12"/>
<polygon fill="black" stroke="black" points="4408.77,-1217.79 4398.18,-1217.89 4406.52,-1224.42 4408.77,-1217.79"/>
</g>
<!-- layer0_expert1_7 -->
<g id="node36" class="node">
<title>layer0_expert1_7</title>
<polygon fill="lightgreen" stroke="black" points="4590,-1221 4416,-1221 4416,-1138 4590,-1138 4590,-1221"/>
<text text-anchor="middle" x="4503" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU1</text>
<text text-anchor="middle" x="4503" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4503" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4503" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4503" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_7 -->
<g id="edge55" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4628.39,-1256.91C4612.15,-1247.02 4594.68,-1236.37 4578.08,-1226.25"/>
<polygon fill="black" stroke="black" points="4579.86,-1223.24 4569.5,-1221.02 4576.21,-1229.21 4579.86,-1223.24"/>
</g>
<!-- layer0_expert1_8 -->
<g id="node37" class="node">
<title>layer0_expert1_8</title>
<polygon fill="lightgreen" stroke="black" points="4782,-1221 4608,-1221 4608,-1138 4782,-1138 4782,-1221"/>
<text text-anchor="middle" x="4695" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU1</text>
<text text-anchor="middle" x="4695" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4695" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4695" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4695" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_8 -->
<g id="edge56" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4695,-1256.91C4695,-1248.65 4695,-1239.86 4695,-1231.3"/>
<polygon fill="black" stroke="black" points="4698.5,-1231.02 4695,-1221.02 4691.5,-1231.02 4698.5,-1231.02"/>
</g>
<!-- layer0_expert1_9 -->
<g id="node38" class="node">
<title>layer0_expert1_9</title>
<polygon fill="lightgreen" stroke="black" points="4974,-1221 4800,-1221 4800,-1138 4974,-1138 4974,-1221"/>
<text text-anchor="middle" x="4887" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU1</text>
<text text-anchor="middle" x="4887" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4887" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4887" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4887" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_9 -->
<g id="edge57" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4761.61,-1256.91C4777.85,-1247.02 4795.32,-1236.37 4811.92,-1226.25"/>
<polygon fill="black" stroke="black" points="4813.79,-1229.21 4820.5,-1221.02 4810.14,-1223.24 4813.79,-1229.21"/>
</g>
<!-- layer0_expert1_10 -->
<g id="node39" class="node">
<title>layer0_expert1_10</title>
<polygon fill="lightgreen" stroke="black" points="5166,-1221 4992,-1221 4992,-1138 5166,-1138 5166,-1221"/>
<text text-anchor="middle" x="5079" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU1</text>
<text text-anchor="middle" x="5079" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5079" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5079" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5079" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_10 -->
<g id="edge58" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.34,-1269.02C4866.34,-1256.63 4923.28,-1241.01 4982.33,-1221.12"/>
<polygon fill="black" stroke="black" points="4983.48,-1224.42 4991.82,-1217.89 4981.23,-1217.79 4983.48,-1224.42"/>
</g>
<!-- layer0_expert1_11 -->
<g id="node40" class="node">
<title>layer0_expert1_11</title>
<polygon fill="lightgreen" stroke="black" points="5358,-1221 5184,-1221 5184,-1138 5358,-1138 5358,-1221"/>
<text text-anchor="middle" x="5271" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU1</text>
<text text-anchor="middle" x="5271" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5271" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5271" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5271" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_11 -->
<g id="edge59" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.09,-1286.26C4912.68,-1275.56 5048.63,-1256.14 5174.16,-1221.05"/>
<polygon fill="black" stroke="black" points="5175.28,-1224.37 5183.94,-1218.28 5173.37,-1217.64 5175.28,-1224.37"/>
</g>
<!-- layer0_expert1_12 -->
<g id="node41" class="node">
<title>layer0_expert1_12</title>
<polygon fill="lightgreen" stroke="black" points="5550,-1221 5376,-1221 5376,-1138 5550,-1138 5550,-1221"/>
<text text-anchor="middle" x="5463" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU1</text>
<text text-anchor="middle" x="5463" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5463" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5463" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5463" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_12 -->
<g id="edge60" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.09,-1294.05C4950.97,-1287.91 5171.54,-1270.84 5366.16,-1221"/>
<polygon fill="black" stroke="black" points="5367.19,-1224.35 5375.99,-1218.45 5365.43,-1217.57 5367.19,-1224.35"/>
</g>
<!-- layer0_expert1_13 -->
<g id="node42" class="node">
<title>layer0_expert1_13</title>
<polygon fill="lightgreen" stroke="black" points="5742,-1221 5568,-1221 5568,-1138 5742,-1138 5742,-1221"/>
<text text-anchor="middle" x="5655" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU1</text>
<text text-anchor="middle" x="5655" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5655" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5655" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5655" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_13 -->
<g id="edge61" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.23,-1291.36C5016.75,-1280.58 5404.69,-1256.2 5558,-1220.96"/>
<polygon fill="black" stroke="black" points="5558.84,-1224.36 5567.75,-1218.63 5557.21,-1217.55 5558.84,-1224.36"/>
</g>
<!-- layer0_expert1_14 -->
<g id="node43" class="node">
<title>layer0_expert1_14</title>
<polygon fill="lightgreen" stroke="black" points="5934,-1221 5760,-1221 5760,-1138 5934,-1138 5934,-1221"/>
<text text-anchor="middle" x="5847" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU1</text>
<text text-anchor="middle" x="5847" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5847" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5847" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5847" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_14 -->
<g id="edge62" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.08,-1293.65C5051.72,-1285.46 5558.62,-1263.62 5749.81,-1220.99"/>
<polygon fill="black" stroke="black" points="5750.81,-1224.35 5759.77,-1218.69 5749.23,-1217.54 5750.81,-1224.35"/>
</g>
<!-- layer0_expert1_15 -->
<g id="node44" class="node">
<title>layer0_expert1_15</title>
<polygon fill="lightgreen" stroke="black" points="6126,-1221 5952,-1221 5952,-1138 6126,-1138 6126,-1221"/>
<text text-anchor="middle" x="6039" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU1</text>
<text text-anchor="middle" x="6039" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6039" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6039" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6039" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_15 -->
<g id="edge63" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.18,-1295.24C5084.05,-1289.47 5712.75,-1271.11 5941.83,-1220.99"/>
<polygon fill="black" stroke="black" points="5942.8,-1224.35 5951.78,-1218.73 5941.25,-1217.53 5942.8,-1224.35"/>
</g>
<!-- layer0_moe_agg_gpu1 -->
<g id="node45" class="node">
<title>layer0_moe_agg_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4700.5,-1102 4497.5,-1102 4497.5,-1034 4700.5,-1034 4700.5,-1102"/>
<text text-anchor="middle" x="4599" y="-1086.8" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU1</text>
<text text-anchor="middle" x="4599" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="4599" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4599" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_expert1_0&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge64" class="edge">
<title>layer0_expert1_0&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3246.22,-1140.23C3249.16,-1139.42 3252.09,-1138.67 3255,-1138 3488.11,-1084.58 4207.88,-1072.47 4486.88,-1069.77"/>
<polygon fill="black" stroke="black" points="4487.06,-1073.27 4497.02,-1069.67 4486.99,-1066.27 4487.06,-1073.27"/>
</g>
<!-- layer0_expert1_1&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge65" class="edge">
<title>layer0_expert1_1&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3438.22,-1140.27C3441.16,-1139.44 3444.09,-1138.68 3447,-1138 3642.44,-1092.34 4237.55,-1075.89 4487.05,-1070.89"/>
<polygon fill="black" stroke="black" points="4487.3,-1074.39 4497.23,-1070.69 4487.16,-1067.39 4487.3,-1074.39"/>
</g>
<!-- layer0_expert1_2&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge66" class="edge">
<title>layer0_expert1_2&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3630.23,-1140.31C3633.17,-1139.47 3636.1,-1138.7 3639,-1138 3797.15,-1100.05 4269.85,-1079.92 4487.3,-1072.45"/>
<polygon fill="black" stroke="black" points="4487.59,-1075.94 4497.46,-1072.1 4487.35,-1068.95 4487.59,-1075.94"/>
</g>
<!-- layer0_expert1_3&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge67" class="edge">
<title>layer0_expert1_3&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3822.25,-1140.38C3825.18,-1139.52 3828.1,-1138.72 3831,-1138 4059.24,-1081.08 4335.98,-1069.79 4487.11,-1068.31"/>
<polygon fill="black" stroke="black" points="4487.36,-1071.81 4497.33,-1068.22 4487.3,-1064.81 4487.36,-1071.81"/>
</g>
<!-- layer0_expert1_4&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge68" class="edge">
<title>layer0_expert1_4&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4014.01,-1140.57C4017.03,-1139.65 4020.03,-1138.79 4023,-1138 4180.85,-1096.14 4369.82,-1079.63 4487.16,-1073.14"/>
<polygon fill="black" stroke="black" points="4487.44,-1076.63 4497.24,-1072.6 4487.07,-1069.64 4487.44,-1076.63"/>
</g>
<!-- layer0_expert1_5&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge69" class="edge">
<title>layer0_expert1_5&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4206.08,-1140.8C4209.07,-1139.81 4212.05,-1138.87 4215,-1138 4304.8,-1111.35 4409.64,-1093.36 4487.06,-1082.44"/>
<polygon fill="black" stroke="black" points="4487.9,-1085.86 4497.32,-1081.02 4486.93,-1078.93 4487.9,-1085.86"/>
</g>
<!-- layer0_expert1_6&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge70" class="edge">
<title>layer0_expert1_6&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4398.04,-1141.54C4401.06,-1140.33 4404.05,-1139.15 4407,-1138 4435.16,-1127.01 4465.89,-1115.68 4494.34,-1105.45"/>
<polygon fill="black" stroke="black" points="4495.66,-1108.7 4503.89,-1102.03 4493.3,-1102.11 4495.66,-1108.7"/>
</g>
<!-- layer0_expert1_7&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge71" class="edge">
<title>layer0_expert1_7&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4538.75,-1137.73C4546.66,-1128.7 4555.06,-1119.12 4562.98,-1110.08"/>
<polygon fill="black" stroke="black" points="4565.85,-1112.13 4569.81,-1102.3 4560.58,-1107.51 4565.85,-1112.13"/>
</g>
<!-- layer0_expert1_8&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge72" class="edge">
<title>layer0_expert1_8&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4659.25,-1137.73C4651.34,-1128.7 4642.94,-1119.12 4635.02,-1110.08"/>
<polygon fill="black" stroke="black" points="4637.42,-1107.51 4628.19,-1102.3 4632.15,-1112.13 4637.42,-1107.51"/>
</g>
<!-- layer0_expert1_9&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge73" class="edge">
<title>layer0_expert1_9&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4799.96,-1141.54C4796.94,-1140.33 4793.95,-1139.15 4791,-1138 4762.84,-1127.01 4732.11,-1115.68 4703.66,-1105.45"/>
<polygon fill="black" stroke="black" points="4704.7,-1102.11 4694.11,-1102.03 4702.34,-1108.7 4704.7,-1102.11"/>
</g>
<!-- layer0_expert1_10&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge74" class="edge">
<title>layer0_expert1_10&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4991.92,-1140.8C4988.93,-1139.81 4985.95,-1138.87 4983,-1138 4893.2,-1111.35 4788.36,-1093.36 4710.94,-1082.44"/>
<polygon fill="black" stroke="black" points="4711.07,-1078.93 4700.68,-1081.02 4710.1,-1085.86 4711.07,-1078.93"/>
</g>
<!-- layer0_expert1_11&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge75" class="edge">
<title>layer0_expert1_11&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5183.99,-1140.57C5180.97,-1139.65 5177.97,-1138.79 5175,-1138 5017.15,-1096.14 4828.18,-1079.63 4710.84,-1073.14"/>
<polygon fill="black" stroke="black" points="4710.93,-1069.64 4700.76,-1072.6 4710.56,-1076.63 4710.93,-1069.64"/>
</g>
<!-- layer0_expert1_12&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge76" class="edge">
<title>layer0_expert1_12&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5375.75,-1140.38C5372.82,-1139.52 5369.9,-1138.72 5367,-1138 5138.76,-1081.08 4862.02,-1069.79 4710.89,-1068.31"/>
<polygon fill="black" stroke="black" points="4710.7,-1064.81 4700.67,-1068.22 4710.64,-1071.81 4710.7,-1064.81"/>
</g>
<!-- layer0_expert1_13&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge77" class="edge">
<title>layer0_expert1_13&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5567.77,-1140.31C5564.83,-1139.47 5561.9,-1138.7 5559,-1138 5400.85,-1100.05 4928.15,-1079.92 4710.7,-1072.45"/>
<polygon fill="black" stroke="black" points="4710.65,-1068.95 4700.54,-1072.1 4710.41,-1075.94 4710.65,-1068.95"/>
</g>
<!-- layer0_expert1_14&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge78" class="edge">
<title>layer0_expert1_14&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5759.78,-1140.27C5756.84,-1139.44 5753.91,-1138.68 5751,-1138 5555.56,-1092.34 4960.45,-1075.89 4710.95,-1070.89"/>
<polygon fill="black" stroke="black" points="4710.84,-1067.39 4700.77,-1070.69 4710.7,-1074.39 4710.84,-1067.39"/>
</g>
<!-- layer0_expert1_15&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge79" class="edge">
<title>layer0_expert1_15&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5951.78,-1140.23C5948.84,-1139.42 5945.91,-1138.67 5943,-1138 5709.89,-1084.58 4990.12,-1072.47 4711.12,-1069.77"/>
<polygon fill="black" stroke="black" points="4711.01,-1066.27 4700.98,-1069.67 4710.94,-1073.27 4711.01,-1066.27"/>
</g>
<!-- layer0_output_gpu1 -->
<g id="node46" class="node">
<title>layer0_output_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4721,-949 4477,-949 4477,-881 4721,-881 4721,-949"/>
<text text-anchor="middle" x="4599" y="-933.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="4599" y="-918.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="4599" y="-903.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4599" y="-888.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_moe_agg_gpu1&#45;&gt;layer0_output_gpu1 -->
<g id="edge80" class="edge">
<title>layer0_moe_agg_gpu1&#45;&gt;layer0_output_gpu1</title>
<path fill="none" stroke="black" d="M4599,-1033.86C4599,-1011.93 4599,-982.95 4599,-959.21"/>
<polygon fill="black" stroke="black" points="4602.5,-959.06 4599,-949.06 4595.5,-959.06 4602.5,-959.06"/>
</g>
<!-- layer0_attn_gpu2 -->
<g id="node48" class="node">
<title>layer0_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="9199.5,-1563 8956.5,-1563 8956.5,-1495 9199.5,-1495 9199.5,-1563"/>
<text text-anchor="middle" x="9078" y="-1547.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="9078" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="9078" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="9078" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_qkv_gpu2&#45;&gt;layer0_attn_gpu2 -->
<g id="edge81" class="edge">
<title>layer0_qkv_gpu2&#45;&gt;layer0_attn_gpu2</title>
<path fill="none" stroke="black" d="M10719.94,-1625.81C10416.21,-1608.09 9543.57,-1557.17 9209.91,-1537.7"/>
<polygon fill="black" stroke="black" points="9209.9,-1534.19 9199.71,-1537.1 9209.49,-1541.18 9209.9,-1534.19"/>
</g>
<!-- layer0_attn_norm_gpu2 -->
<g id="node49" class="node">
<title>layer0_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="8326,-1451.5 8082,-1451.5 8082,-1383.5 8326,-1383.5 8326,-1451.5"/>
<text text-anchor="middle" x="8204" y="-1436.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="8204" y="-1421.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="8204" y="-1406.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="8204" y="-1391.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_gpu2&#45;&gt;layer0_attn_norm_gpu2 -->
<g id="edge82" class="edge">
<title>layer0_attn_gpu2&#45;&gt;layer0_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M8956.47,-1512.77C8793.41,-1492.35 8504.87,-1456.19 8336.42,-1435.09"/>
<polygon fill="black" stroke="black" points="8336.61,-1431.59 8326.25,-1433.82 8335.74,-1438.53 8336.61,-1431.59"/>
</g>
<!-- layer0_gate_gpu2 -->
<g id="node50" class="node">
<title>layer0_gate_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7889,-1340 7645,-1340 7645,-1257 7889,-1257 7889,-1340"/>
<text text-anchor="middle" x="7767" y="-1324.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU2</text>
<text text-anchor="middle" x="7767" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7767" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="7767" y="-1279.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="7767" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_norm_gpu2&#45;&gt;layer0_gate_gpu2 -->
<g id="edge83" class="edge">
<title>layer0_attn_norm_gpu2&#45;&gt;layer0_gate_gpu2</title>
<path fill="none" stroke="black" d="M8081.98,-1383.83C8025.05,-1368.59 7957.18,-1350.42 7899.04,-1334.85"/>
<polygon fill="black" stroke="black" points="7899.62,-1331.38 7889.06,-1332.18 7897.81,-1338.15 7899.62,-1331.38"/>
</g>
<!-- layer0_expert2_0 -->
<g id="node51" class="node">
<title>layer0_expert2_0</title>
<polygon fill="lightgreen" stroke="black" points="6318,-1221 6144,-1221 6144,-1138 6318,-1138 6318,-1221"/>
<text text-anchor="middle" x="6231" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU2</text>
<text text-anchor="middle" x="6231" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6231" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6231" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6231" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_0 -->
<g id="edge84" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.8,-1296.41C7348.21,-1292.92 6595.59,-1278.7 6328.29,-1221.01"/>
<polygon fill="black" stroke="black" points="6328.74,-1217.52 6318.22,-1218.76 6327.22,-1224.35 6328.74,-1217.52"/>
</g>
<!-- layer0_expert2_1 -->
<g id="node52" class="node">
<title>layer0_expert2_1</title>
<polygon fill="lightgreen" stroke="black" points="6510,-1221 6336,-1221 6336,-1138 6510,-1138 6510,-1221"/>
<text text-anchor="middle" x="6423" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU2</text>
<text text-anchor="middle" x="6423" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6423" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6423" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6423" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_1 -->
<g id="edge85" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.82,-1295.24C7377.95,-1289.47 6749.25,-1271.11 6520.17,-1220.99"/>
<polygon fill="black" stroke="black" points="6520.75,-1217.53 6510.22,-1218.73 6519.2,-1224.35 6520.75,-1217.53"/>
</g>
<!-- layer0_expert2_2 -->
<g id="node53" class="node">
<title>layer0_expert2_2</title>
<polygon fill="lightgreen" stroke="black" points="6702,-1221 6528,-1221 6528,-1138 6702,-1138 6702,-1221"/>
<text text-anchor="middle" x="6615" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU2</text>
<text text-anchor="middle" x="6615" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6615" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6615" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6615" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_2 -->
<g id="edge86" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.92,-1293.65C7410.28,-1285.46 6903.38,-1263.62 6712.19,-1220.99"/>
<polygon fill="black" stroke="black" points="6712.77,-1217.54 6702.23,-1218.69 6711.19,-1224.35 6712.77,-1217.54"/>
</g>
<!-- layer0_expert2_3 -->
<g id="node54" class="node">
<title>layer0_expert2_3</title>
<polygon fill="lightgreen" stroke="black" points="6894,-1221 6720,-1221 6720,-1138 6894,-1138 6894,-1221"/>
<text text-anchor="middle" x="6807" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU2</text>
<text text-anchor="middle" x="6807" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6807" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6807" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6807" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_3 -->
<g id="edge87" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.77,-1291.36C7445.25,-1280.58 7057.31,-1256.2 6904,-1220.96"/>
<polygon fill="black" stroke="black" points="6904.79,-1217.55 6894.25,-1218.63 6903.16,-1224.36 6904.79,-1217.55"/>
</g>
<!-- layer0_expert2_4 -->
<g id="node55" class="node">
<title>layer0_expert2_4</title>
<polygon fill="lightgreen" stroke="black" points="7086,-1221 6912,-1221 6912,-1138 7086,-1138 7086,-1221"/>
<text text-anchor="middle" x="6999" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU2</text>
<text text-anchor="middle" x="6999" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6999" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6999" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6999" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_4 -->
<g id="edge88" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.91,-1294.05C7511.03,-1287.91 7290.46,-1270.84 7095.84,-1221"/>
<polygon fill="black" stroke="black" points="7096.57,-1217.57 7086.01,-1218.45 7094.81,-1224.35 7096.57,-1217.57"/>
</g>
<!-- layer0_expert2_5 -->
<g id="node56" class="node">
<title>layer0_expert2_5</title>
<polygon fill="lightgreen" stroke="black" points="7278,-1221 7104,-1221 7104,-1138 7278,-1138 7278,-1221"/>
<text text-anchor="middle" x="7191" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU2</text>
<text text-anchor="middle" x="7191" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7191" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7191" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7191" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_5 -->
<g id="edge89" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.91,-1286.26C7549.32,-1275.56 7413.37,-1256.14 7287.84,-1221.05"/>
<polygon fill="black" stroke="black" points="7288.63,-1217.64 7278.06,-1218.28 7286.72,-1224.37 7288.63,-1217.64"/>
</g>
<!-- layer0_expert2_6 -->
<g id="node57" class="node">
<title>layer0_expert2_6</title>
<polygon fill="lightgreen" stroke="black" points="7470,-1221 7296,-1221 7296,-1138 7470,-1138 7470,-1221"/>
<text text-anchor="middle" x="7383" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU2</text>
<text text-anchor="middle" x="7383" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7383" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7383" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7383" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_6 -->
<g id="edge90" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.66,-1269.02C7595.66,-1256.63 7538.72,-1241.01 7479.67,-1221.12"/>
<polygon fill="black" stroke="black" points="7480.77,-1217.79 7470.18,-1217.89 7478.52,-1224.42 7480.77,-1217.79"/>
</g>
<!-- layer0_expert2_7 -->
<g id="node58" class="node">
<title>layer0_expert2_7</title>
<polygon fill="lightgreen" stroke="black" points="7662,-1221 7488,-1221 7488,-1138 7662,-1138 7662,-1221"/>
<text text-anchor="middle" x="7575" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU2</text>
<text text-anchor="middle" x="7575" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7575" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7575" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7575" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_7 -->
<g id="edge91" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7700.39,-1256.91C7684.15,-1247.02 7666.68,-1236.37 7650.08,-1226.25"/>
<polygon fill="black" stroke="black" points="7651.86,-1223.24 7641.5,-1221.02 7648.21,-1229.21 7651.86,-1223.24"/>
</g>
<!-- layer0_expert2_8 -->
<g id="node59" class="node">
<title>layer0_expert2_8</title>
<polygon fill="lightgreen" stroke="black" points="7854,-1221 7680,-1221 7680,-1138 7854,-1138 7854,-1221"/>
<text text-anchor="middle" x="7767" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU2</text>
<text text-anchor="middle" x="7767" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7767" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7767" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7767" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_8 -->
<g id="edge92" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7767,-1256.91C7767,-1248.65 7767,-1239.86 7767,-1231.3"/>
<polygon fill="black" stroke="black" points="7770.5,-1231.02 7767,-1221.02 7763.5,-1231.02 7770.5,-1231.02"/>
</g>
<!-- layer0_expert2_9 -->
<g id="node60" class="node">
<title>layer0_expert2_9</title>
<polygon fill="lightgreen" stroke="black" points="8046,-1221 7872,-1221 7872,-1138 8046,-1138 8046,-1221"/>
<text text-anchor="middle" x="7959" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU2</text>
<text text-anchor="middle" x="7959" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7959" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7959" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7959" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_9 -->
<g id="edge93" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7833.61,-1256.91C7849.85,-1247.02 7867.32,-1236.37 7883.92,-1226.25"/>
<polygon fill="black" stroke="black" points="7885.79,-1229.21 7892.5,-1221.02 7882.14,-1223.24 7885.79,-1229.21"/>
</g>
<!-- layer0_expert2_10 -->
<g id="node61" class="node">
<title>layer0_expert2_10</title>
<polygon fill="lightgreen" stroke="black" points="8238,-1221 8064,-1221 8064,-1138 8238,-1138 8238,-1221"/>
<text text-anchor="middle" x="8151" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU2</text>
<text text-anchor="middle" x="8151" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8151" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8151" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8151" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_10 -->
<g id="edge94" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.34,-1269.02C7938.34,-1256.63 7995.28,-1241.01 8054.33,-1221.12"/>
<polygon fill="black" stroke="black" points="8055.48,-1224.42 8063.82,-1217.89 8053.23,-1217.79 8055.48,-1224.42"/>
</g>
<!-- layer0_expert2_11 -->
<g id="node62" class="node">
<title>layer0_expert2_11</title>
<polygon fill="lightgreen" stroke="black" points="8430,-1221 8256,-1221 8256,-1138 8430,-1138 8430,-1221"/>
<text text-anchor="middle" x="8343" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU2</text>
<text text-anchor="middle" x="8343" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8343" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8343" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8343" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_11 -->
<g id="edge95" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.09,-1286.26C7984.68,-1275.56 8120.63,-1256.14 8246.16,-1221.05"/>
<polygon fill="black" stroke="black" points="8247.28,-1224.37 8255.94,-1218.28 8245.37,-1217.64 8247.28,-1224.37"/>
</g>
<!-- layer0_expert2_12 -->
<g id="node63" class="node">
<title>layer0_expert2_12</title>
<polygon fill="lightgreen" stroke="black" points="8622,-1221 8448,-1221 8448,-1138 8622,-1138 8622,-1221"/>
<text text-anchor="middle" x="8535" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU2</text>
<text text-anchor="middle" x="8535" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8535" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8535" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8535" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_12 -->
<g id="edge96" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.09,-1294.05C8022.97,-1287.91 8243.54,-1270.84 8438.16,-1221"/>
<polygon fill="black" stroke="black" points="8439.19,-1224.35 8447.99,-1218.45 8437.43,-1217.57 8439.19,-1224.35"/>
</g>
<!-- layer0_expert2_13 -->
<g id="node64" class="node">
<title>layer0_expert2_13</title>
<polygon fill="lightgreen" stroke="black" points="8814,-1221 8640,-1221 8640,-1138 8814,-1138 8814,-1221"/>
<text text-anchor="middle" x="8727" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU2</text>
<text text-anchor="middle" x="8727" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8727" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8727" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8727" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_13 -->
<g id="edge97" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.23,-1291.36C8088.75,-1280.58 8476.69,-1256.2 8630,-1220.96"/>
<polygon fill="black" stroke="black" points="8630.84,-1224.36 8639.75,-1218.63 8629.21,-1217.55 8630.84,-1224.36"/>
</g>
<!-- layer0_expert2_14 -->
<g id="node65" class="node">
<title>layer0_expert2_14</title>
<polygon fill="lightgreen" stroke="black" points="9006,-1221 8832,-1221 8832,-1138 9006,-1138 9006,-1221"/>
<text text-anchor="middle" x="8919" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU2</text>
<text text-anchor="middle" x="8919" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8919" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8919" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8919" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_14 -->
<g id="edge98" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.08,-1293.65C8123.72,-1285.46 8630.62,-1263.62 8821.81,-1220.99"/>
<polygon fill="black" stroke="black" points="8822.81,-1224.35 8831.77,-1218.69 8821.23,-1217.54 8822.81,-1224.35"/>
</g>
<!-- layer0_expert2_15 -->
<g id="node66" class="node">
<title>layer0_expert2_15</title>
<polygon fill="lightgreen" stroke="black" points="9198,-1221 9024,-1221 9024,-1138 9198,-1138 9198,-1221"/>
<text text-anchor="middle" x="9111" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU2</text>
<text text-anchor="middle" x="9111" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9111" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9111" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9111" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_15 -->
<g id="edge99" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.18,-1295.24C8156.05,-1289.47 8784.75,-1271.11 9013.83,-1220.99"/>
<polygon fill="black" stroke="black" points="9014.8,-1224.35 9023.78,-1218.73 9013.25,-1217.53 9014.8,-1224.35"/>
</g>
<!-- layer0_moe_agg_gpu2 -->
<g id="node67" class="node">
<title>layer0_moe_agg_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7772.5,-1102 7569.5,-1102 7569.5,-1034 7772.5,-1034 7772.5,-1102"/>
<text text-anchor="middle" x="7671" y="-1086.8" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU2</text>
<text text-anchor="middle" x="7671" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="7671" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7671" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_expert2_0&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge100" class="edge">
<title>layer0_expert2_0&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6318.22,-1140.23C6321.16,-1139.42 6324.09,-1138.67 6327,-1138 6560.11,-1084.58 7279.88,-1072.47 7558.88,-1069.77"/>
<polygon fill="black" stroke="black" points="7559.06,-1073.27 7569.02,-1069.67 7558.99,-1066.27 7559.06,-1073.27"/>
</g>
<!-- layer0_expert2_1&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge101" class="edge">
<title>layer0_expert2_1&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6510.22,-1140.27C6513.16,-1139.44 6516.09,-1138.68 6519,-1138 6714.44,-1092.34 7309.55,-1075.89 7559.05,-1070.89"/>
<polygon fill="black" stroke="black" points="7559.3,-1074.39 7569.23,-1070.69 7559.16,-1067.39 7559.3,-1074.39"/>
</g>
<!-- layer0_expert2_2&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge102" class="edge">
<title>layer0_expert2_2&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6702.23,-1140.31C6705.17,-1139.47 6708.1,-1138.7 6711,-1138 6869.15,-1100.05 7341.85,-1079.92 7559.3,-1072.45"/>
<polygon fill="black" stroke="black" points="7559.59,-1075.94 7569.46,-1072.1 7559.35,-1068.95 7559.59,-1075.94"/>
</g>
<!-- layer0_expert2_3&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge103" class="edge">
<title>layer0_expert2_3&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6894.25,-1140.38C6897.18,-1139.52 6900.1,-1138.72 6903,-1138 7131.24,-1081.08 7407.98,-1069.79 7559.11,-1068.31"/>
<polygon fill="black" stroke="black" points="7559.36,-1071.81 7569.33,-1068.22 7559.3,-1064.81 7559.36,-1071.81"/>
</g>
<!-- layer0_expert2_4&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge104" class="edge">
<title>layer0_expert2_4&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7086.01,-1140.57C7089.03,-1139.65 7092.03,-1138.79 7095,-1138 7252.85,-1096.14 7441.82,-1079.63 7559.16,-1073.14"/>
<polygon fill="black" stroke="black" points="7559.44,-1076.63 7569.24,-1072.6 7559.07,-1069.64 7559.44,-1076.63"/>
</g>
<!-- layer0_expert2_5&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge105" class="edge">
<title>layer0_expert2_5&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7278.08,-1140.8C7281.07,-1139.81 7284.05,-1138.87 7287,-1138 7376.8,-1111.35 7481.64,-1093.36 7559.06,-1082.44"/>
<polygon fill="black" stroke="black" points="7559.9,-1085.86 7569.32,-1081.02 7558.93,-1078.93 7559.9,-1085.86"/>
</g>
<!-- layer0_expert2_6&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge106" class="edge">
<title>layer0_expert2_6&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7470.04,-1141.54C7473.06,-1140.33 7476.05,-1139.15 7479,-1138 7507.16,-1127.01 7537.89,-1115.68 7566.34,-1105.45"/>
<polygon fill="black" stroke="black" points="7567.66,-1108.7 7575.89,-1102.03 7565.3,-1102.11 7567.66,-1108.7"/>
</g>
<!-- layer0_expert2_7&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge107" class="edge">
<title>layer0_expert2_7&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7610.75,-1137.73C7618.66,-1128.7 7627.06,-1119.12 7634.98,-1110.08"/>
<polygon fill="black" stroke="black" points="7637.85,-1112.13 7641.81,-1102.3 7632.58,-1107.51 7637.85,-1112.13"/>
</g>
<!-- layer0_expert2_8&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge108" class="edge">
<title>layer0_expert2_8&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7731.25,-1137.73C7723.34,-1128.7 7714.94,-1119.12 7707.02,-1110.08"/>
<polygon fill="black" stroke="black" points="7709.42,-1107.51 7700.19,-1102.3 7704.15,-1112.13 7709.42,-1107.51"/>
</g>
<!-- layer0_expert2_9&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge109" class="edge">
<title>layer0_expert2_9&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7871.96,-1141.54C7868.94,-1140.33 7865.95,-1139.15 7863,-1138 7834.84,-1127.01 7804.11,-1115.68 7775.66,-1105.45"/>
<polygon fill="black" stroke="black" points="7776.7,-1102.11 7766.11,-1102.03 7774.34,-1108.7 7776.7,-1102.11"/>
</g>
<!-- layer0_expert2_10&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge110" class="edge">
<title>layer0_expert2_10&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8063.92,-1140.8C8060.93,-1139.81 8057.95,-1138.87 8055,-1138 7965.2,-1111.35 7860.36,-1093.36 7782.94,-1082.44"/>
<polygon fill="black" stroke="black" points="7783.07,-1078.93 7772.68,-1081.02 7782.1,-1085.86 7783.07,-1078.93"/>
</g>
<!-- layer0_expert2_11&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge111" class="edge">
<title>layer0_expert2_11&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8255.99,-1140.57C8252.97,-1139.65 8249.97,-1138.79 8247,-1138 8089.15,-1096.14 7900.18,-1079.63 7782.84,-1073.14"/>
<polygon fill="black" stroke="black" points="7782.93,-1069.64 7772.76,-1072.6 7782.56,-1076.63 7782.93,-1069.64"/>
</g>
<!-- layer0_expert2_12&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge112" class="edge">
<title>layer0_expert2_12&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8447.75,-1140.38C8444.82,-1139.52 8441.9,-1138.72 8439,-1138 8210.76,-1081.08 7934.02,-1069.79 7782.89,-1068.31"/>
<polygon fill="black" stroke="black" points="7782.7,-1064.81 7772.67,-1068.22 7782.64,-1071.81 7782.7,-1064.81"/>
</g>
<!-- layer0_expert2_13&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge113" class="edge">
<title>layer0_expert2_13&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8639.77,-1140.31C8636.83,-1139.47 8633.9,-1138.7 8631,-1138 8472.85,-1100.05 8000.15,-1079.92 7782.7,-1072.45"/>
<polygon fill="black" stroke="black" points="7782.65,-1068.95 7772.54,-1072.1 7782.41,-1075.94 7782.65,-1068.95"/>
</g>
<!-- layer0_expert2_14&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge114" class="edge">
<title>layer0_expert2_14&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8831.78,-1140.27C8828.84,-1139.44 8825.91,-1138.68 8823,-1138 8627.56,-1092.34 8032.45,-1075.89 7782.95,-1070.89"/>
<polygon fill="black" stroke="black" points="7782.84,-1067.39 7772.77,-1070.69 7782.7,-1074.39 7782.84,-1067.39"/>
</g>
<!-- layer0_expert2_15&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge115" class="edge">
<title>layer0_expert2_15&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M9023.78,-1140.23C9020.84,-1139.42 9017.91,-1138.67 9015,-1138 8781.89,-1084.58 8062.12,-1072.47 7783.12,-1069.77"/>
<polygon fill="black" stroke="black" points="7783.01,-1066.27 7772.98,-1069.67 7782.94,-1073.27 7783.01,-1066.27"/>
</g>
<!-- layer0_output_gpu2 -->
<g id="node68" class="node">
<title>layer0_output_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7793,-949 7549,-949 7549,-881 7793,-881 7793,-949"/>
<text text-anchor="middle" x="7671" y="-933.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="7671" y="-918.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="7671" y="-903.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7671" y="-888.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_moe_agg_gpu2&#45;&gt;layer0_output_gpu2 -->
<g id="edge116" class="edge">
<title>layer0_moe_agg_gpu2&#45;&gt;layer0_output_gpu2</title>
<path fill="none" stroke="black" d="M7671,-1033.86C7671,-1011.93 7671,-982.95 7671,-959.21"/>
<polygon fill="black" stroke="black" points="7674.5,-959.06 7671,-949.06 7667.5,-959.06 7674.5,-959.06"/>
</g>
<!-- layer0_attn_gpu3 -->
<g id="node70" class="node">
<title>layer0_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11288.5,-1563 11045.5,-1563 11045.5,-1495 11288.5,-1495 11288.5,-1563"/>
<text text-anchor="middle" x="11167" y="-1547.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="11167" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="11167" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11167" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_qkv_gpu3&#45;&gt;layer0_attn_gpu3 -->
<g id="edge117" class="edge">
<title>layer0_qkv_gpu3&#45;&gt;layer0_attn_gpu3</title>
<path fill="none" stroke="black" d="M11722.64,-1615.61C11607.25,-1597.83 11422.91,-1569.43 11298.51,-1550.26"/>
<polygon fill="black" stroke="black" points="11298.96,-1546.79 11288.54,-1548.73 11297.89,-1553.71 11298.96,-1546.79"/>
</g>
<!-- layer0_attn_norm_gpu3 -->
<g id="node71" class="node">
<title>layer0_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11125,-1451.5 10881,-1451.5 10881,-1383.5 11125,-1383.5 11125,-1451.5"/>
<text text-anchor="middle" x="11003" y="-1436.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="11003" y="-1421.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11003" y="-1406.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11003" y="-1391.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_gpu3&#45;&gt;layer0_attn_norm_gpu3 -->
<g id="edge118" class="edge">
<title>layer0_attn_gpu3&#45;&gt;layer0_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M11117.35,-1494.85C11099.53,-1482.95 11079.28,-1469.43 11060.82,-1457.11"/>
<polygon fill="black" stroke="black" points="11062.74,-1454.18 11052.48,-1451.54 11058.85,-1460 11062.74,-1454.18"/>
</g>
<!-- layer0_gate_gpu3 -->
<g id="node72" class="node">
<title>layer0_gate_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10961,-1340 10717,-1340 10717,-1257 10961,-1257 10961,-1340"/>
<text text-anchor="middle" x="10839" y="-1324.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU3</text>
<text text-anchor="middle" x="10839" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10839" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="10839" y="-1279.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="10839" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_norm_gpu3&#45;&gt;layer0_gate_gpu3 -->
<g id="edge119" class="edge">
<title>layer0_attn_norm_gpu3&#45;&gt;layer0_gate_gpu3</title>
<path fill="none" stroke="black" d="M10956.44,-1383.29C10940.25,-1371.73 10921.77,-1358.55 10904.34,-1346.11"/>
<polygon fill="black" stroke="black" points="10906.05,-1343.04 10895.88,-1340.08 10901.99,-1348.74 10906.05,-1343.04"/>
</g>
<!-- layer0_expert3_0 -->
<g id="node73" class="node">
<title>layer0_expert3_0</title>
<polygon fill="lightgreen" stroke="black" points="9390,-1221 9216,-1221 9216,-1138 9390,-1138 9390,-1221"/>
<text text-anchor="middle" x="9303" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU3</text>
<text text-anchor="middle" x="9303" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9303" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9303" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9303" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_0 -->
<g id="edge120" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.8,-1296.41C10420.21,-1292.92 9667.59,-1278.7 9400.29,-1221.01"/>
<polygon fill="black" stroke="black" points="9400.74,-1217.52 9390.22,-1218.76 9399.22,-1224.35 9400.74,-1217.52"/>
</g>
<!-- layer0_expert3_1 -->
<g id="node74" class="node">
<title>layer0_expert3_1</title>
<polygon fill="lightgreen" stroke="black" points="9582,-1221 9408,-1221 9408,-1138 9582,-1138 9582,-1221"/>
<text text-anchor="middle" x="9495" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU3</text>
<text text-anchor="middle" x="9495" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9495" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9495" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9495" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_1 -->
<g id="edge121" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.82,-1295.24C10449.95,-1289.47 9821.25,-1271.11 9592.17,-1220.99"/>
<polygon fill="black" stroke="black" points="9592.75,-1217.53 9582.22,-1218.73 9591.2,-1224.35 9592.75,-1217.53"/>
</g>
<!-- layer0_expert3_2 -->
<g id="node75" class="node">
<title>layer0_expert3_2</title>
<polygon fill="lightgreen" stroke="black" points="9774,-1221 9600,-1221 9600,-1138 9774,-1138 9774,-1221"/>
<text text-anchor="middle" x="9687" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU3</text>
<text text-anchor="middle" x="9687" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9687" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9687" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9687" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_2 -->
<g id="edge122" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.92,-1293.65C10482.28,-1285.46 9975.38,-1263.62 9784.19,-1220.99"/>
<polygon fill="black" stroke="black" points="9784.77,-1217.54 9774.23,-1218.69 9783.19,-1224.35 9784.77,-1217.54"/>
</g>
<!-- layer0_expert3_3 -->
<g id="node76" class="node">
<title>layer0_expert3_3</title>
<polygon fill="lightgreen" stroke="black" points="9966,-1221 9792,-1221 9792,-1138 9966,-1138 9966,-1221"/>
<text text-anchor="middle" x="9879" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU3</text>
<text text-anchor="middle" x="9879" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9879" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9879" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9879" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_3 -->
<g id="edge123" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.77,-1291.36C10517.25,-1280.58 10129.31,-1256.2 9976,-1220.96"/>
<polygon fill="black" stroke="black" points="9976.79,-1217.55 9966.25,-1218.63 9975.16,-1224.36 9976.79,-1217.55"/>
</g>
<!-- layer0_expert3_4 -->
<g id="node77" class="node">
<title>layer0_expert3_4</title>
<polygon fill="lightgreen" stroke="black" points="10158,-1221 9984,-1221 9984,-1138 10158,-1138 10158,-1221"/>
<text text-anchor="middle" x="10071" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU3</text>
<text text-anchor="middle" x="10071" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10071" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10071" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10071" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_4 -->
<g id="edge124" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.91,-1294.05C10583.03,-1287.91 10362.46,-1270.84 10167.84,-1221"/>
<polygon fill="black" stroke="black" points="10168.57,-1217.57 10158.01,-1218.45 10166.81,-1224.35 10168.57,-1217.57"/>
</g>
<!-- layer0_expert3_5 -->
<g id="node78" class="node">
<title>layer0_expert3_5</title>
<polygon fill="lightgreen" stroke="black" points="10350,-1221 10176,-1221 10176,-1138 10350,-1138 10350,-1221"/>
<text text-anchor="middle" x="10263" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU3</text>
<text text-anchor="middle" x="10263" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10263" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10263" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10263" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_5 -->
<g id="edge125" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.91,-1286.26C10621.32,-1275.56 10485.37,-1256.14 10359.84,-1221.05"/>
<polygon fill="black" stroke="black" points="10360.63,-1217.64 10350.06,-1218.28 10358.72,-1224.37 10360.63,-1217.64"/>
</g>
<!-- layer0_expert3_6 -->
<g id="node79" class="node">
<title>layer0_expert3_6</title>
<polygon fill="lightgreen" stroke="black" points="10542,-1221 10368,-1221 10368,-1138 10542,-1138 10542,-1221"/>
<text text-anchor="middle" x="10455" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU3</text>
<text text-anchor="middle" x="10455" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10455" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10455" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10455" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_6 -->
<g id="edge126" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.66,-1269.02C10667.66,-1256.63 10610.72,-1241.01 10551.67,-1221.12"/>
<polygon fill="black" stroke="black" points="10552.77,-1217.79 10542.18,-1217.89 10550.52,-1224.42 10552.77,-1217.79"/>
</g>
<!-- layer0_expert3_7 -->
<g id="node80" class="node">
<title>layer0_expert3_7</title>
<polygon fill="lightgreen" stroke="black" points="10734,-1221 10560,-1221 10560,-1138 10734,-1138 10734,-1221"/>
<text text-anchor="middle" x="10647" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU3</text>
<text text-anchor="middle" x="10647" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10647" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10647" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10647" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_7 -->
<g id="edge127" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10772.39,-1256.91C10756.15,-1247.02 10738.68,-1236.37 10722.08,-1226.25"/>
<polygon fill="black" stroke="black" points="10723.86,-1223.24 10713.5,-1221.02 10720.21,-1229.21 10723.86,-1223.24"/>
</g>
<!-- layer0_expert3_8 -->
<g id="node81" class="node">
<title>layer0_expert3_8</title>
<polygon fill="lightgreen" stroke="black" points="10926,-1221 10752,-1221 10752,-1138 10926,-1138 10926,-1221"/>
<text text-anchor="middle" x="10839" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU3</text>
<text text-anchor="middle" x="10839" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10839" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10839" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10839" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_8 -->
<g id="edge128" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10839,-1256.91C10839,-1248.65 10839,-1239.86 10839,-1231.3"/>
<polygon fill="black" stroke="black" points="10842.5,-1231.02 10839,-1221.02 10835.5,-1231.02 10842.5,-1231.02"/>
</g>
<!-- layer0_expert3_9 -->
<g id="node82" class="node">
<title>layer0_expert3_9</title>
<polygon fill="lightgreen" stroke="black" points="11118,-1221 10944,-1221 10944,-1138 11118,-1138 11118,-1221"/>
<text text-anchor="middle" x="11031" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU3</text>
<text text-anchor="middle" x="11031" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11031" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11031" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11031" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_9 -->
<g id="edge129" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10905.61,-1256.91C10921.85,-1247.02 10939.32,-1236.37 10955.92,-1226.25"/>
<polygon fill="black" stroke="black" points="10957.79,-1229.21 10964.5,-1221.02 10954.14,-1223.24 10957.79,-1229.21"/>
</g>
<!-- layer0_expert3_10 -->
<g id="node83" class="node">
<title>layer0_expert3_10</title>
<polygon fill="lightgreen" stroke="black" points="11310,-1221 11136,-1221 11136,-1138 11310,-1138 11310,-1221"/>
<text text-anchor="middle" x="11223" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU3</text>
<text text-anchor="middle" x="11223" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11223" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11223" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11223" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_10 -->
<g id="edge130" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.34,-1269.02C11010.34,-1256.63 11067.28,-1241.01 11126.33,-1221.12"/>
<polygon fill="black" stroke="black" points="11127.48,-1224.42 11135.82,-1217.89 11125.23,-1217.79 11127.48,-1224.42"/>
</g>
<!-- layer0_expert3_11 -->
<g id="node84" class="node">
<title>layer0_expert3_11</title>
<polygon fill="lightgreen" stroke="black" points="11502,-1221 11328,-1221 11328,-1138 11502,-1138 11502,-1221"/>
<text text-anchor="middle" x="11415" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU3</text>
<text text-anchor="middle" x="11415" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11415" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11415" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11415" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_11 -->
<g id="edge131" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.09,-1286.26C11056.68,-1275.56 11192.63,-1256.14 11318.16,-1221.05"/>
<polygon fill="black" stroke="black" points="11319.28,-1224.37 11327.94,-1218.28 11317.37,-1217.64 11319.28,-1224.37"/>
</g>
<!-- layer0_expert3_12 -->
<g id="node85" class="node">
<title>layer0_expert3_12</title>
<polygon fill="lightgreen" stroke="black" points="11694,-1221 11520,-1221 11520,-1138 11694,-1138 11694,-1221"/>
<text text-anchor="middle" x="11607" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU3</text>
<text text-anchor="middle" x="11607" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11607" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11607" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11607" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_12 -->
<g id="edge132" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.09,-1294.05C11094.97,-1287.91 11315.54,-1270.84 11510.16,-1221"/>
<polygon fill="black" stroke="black" points="11511.19,-1224.35 11519.99,-1218.45 11509.43,-1217.57 11511.19,-1224.35"/>
</g>
<!-- layer0_expert3_13 -->
<g id="node86" class="node">
<title>layer0_expert3_13</title>
<polygon fill="lightgreen" stroke="black" points="11886,-1221 11712,-1221 11712,-1138 11886,-1138 11886,-1221"/>
<text text-anchor="middle" x="11799" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU3</text>
<text text-anchor="middle" x="11799" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11799" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11799" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11799" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_13 -->
<g id="edge133" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.23,-1291.36C11160.75,-1280.58 11548.69,-1256.2 11702,-1220.96"/>
<polygon fill="black" stroke="black" points="11702.84,-1224.36 11711.75,-1218.63 11701.21,-1217.55 11702.84,-1224.36"/>
</g>
<!-- layer0_expert3_14 -->
<g id="node87" class="node">
<title>layer0_expert3_14</title>
<polygon fill="lightgreen" stroke="black" points="12078,-1221 11904,-1221 11904,-1138 12078,-1138 12078,-1221"/>
<text text-anchor="middle" x="11991" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU3</text>
<text text-anchor="middle" x="11991" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11991" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11991" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11991" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_14 -->
<g id="edge134" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.08,-1293.65C11195.72,-1285.46 11702.62,-1263.62 11893.81,-1220.99"/>
<polygon fill="black" stroke="black" points="11894.81,-1224.35 11903.77,-1218.69 11893.23,-1217.54 11894.81,-1224.35"/>
</g>
<!-- layer0_expert3_15 -->
<g id="node88" class="node">
<title>layer0_expert3_15</title>
<polygon fill="lightgreen" stroke="black" points="12270,-1221 12096,-1221 12096,-1138 12270,-1138 12270,-1221"/>
<text text-anchor="middle" x="12183" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU3</text>
<text text-anchor="middle" x="12183" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12183" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12183" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12183" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_15 -->
<g id="edge135" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.18,-1295.24C11228.05,-1289.47 11856.75,-1271.11 12085.83,-1220.99"/>
<polygon fill="black" stroke="black" points="12086.8,-1224.35 12095.78,-1218.73 12085.25,-1217.53 12086.8,-1224.35"/>
</g>
<!-- layer0_moe_agg_gpu3 -->
<g id="node89" class="node">
<title>layer0_moe_agg_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10844.5,-1102 10641.5,-1102 10641.5,-1034 10844.5,-1034 10844.5,-1102"/>
<text text-anchor="middle" x="10743" y="-1086.8" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU3</text>
<text text-anchor="middle" x="10743" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="10743" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10743" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_expert3_0&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge136" class="edge">
<title>layer0_expert3_0&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9390.22,-1140.23C9393.16,-1139.42 9396.09,-1138.67 9399,-1138 9632.11,-1084.58 10351.88,-1072.47 10630.88,-1069.77"/>
<polygon fill="black" stroke="black" points="10631.06,-1073.27 10641.02,-1069.67 10630.99,-1066.27 10631.06,-1073.27"/>
</g>
<!-- layer0_expert3_1&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge137" class="edge">
<title>layer0_expert3_1&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9582.22,-1140.27C9585.16,-1139.44 9588.09,-1138.68 9591,-1138 9786.44,-1092.34 10381.55,-1075.89 10631.05,-1070.89"/>
<polygon fill="black" stroke="black" points="10631.3,-1074.39 10641.23,-1070.69 10631.16,-1067.39 10631.3,-1074.39"/>
</g>
<!-- layer0_expert3_2&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge138" class="edge">
<title>layer0_expert3_2&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9774.23,-1140.31C9777.17,-1139.47 9780.1,-1138.7 9783,-1138 9941.15,-1100.05 10413.85,-1079.92 10631.3,-1072.45"/>
<polygon fill="black" stroke="black" points="10631.59,-1075.94 10641.46,-1072.1 10631.35,-1068.95 10631.59,-1075.94"/>
</g>
<!-- layer0_expert3_3&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge139" class="edge">
<title>layer0_expert3_3&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9966.25,-1140.38C9969.18,-1139.52 9972.1,-1138.72 9975,-1138 10203.24,-1081.08 10479.98,-1069.79 10631.11,-1068.31"/>
<polygon fill="black" stroke="black" points="10631.36,-1071.81 10641.33,-1068.22 10631.3,-1064.81 10631.36,-1071.81"/>
</g>
<!-- layer0_expert3_4&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge140" class="edge">
<title>layer0_expert3_4&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10158.01,-1140.57C10161.03,-1139.65 10164.03,-1138.79 10167,-1138 10324.85,-1096.14 10513.82,-1079.63 10631.16,-1073.14"/>
<polygon fill="black" stroke="black" points="10631.44,-1076.63 10641.24,-1072.6 10631.07,-1069.64 10631.44,-1076.63"/>
</g>
<!-- layer0_expert3_5&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge141" class="edge">
<title>layer0_expert3_5&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10350.08,-1140.8C10353.07,-1139.81 10356.05,-1138.87 10359,-1138 10448.8,-1111.35 10553.64,-1093.36 10631.06,-1082.44"/>
<polygon fill="black" stroke="black" points="10631.9,-1085.86 10641.32,-1081.02 10630.93,-1078.93 10631.9,-1085.86"/>
</g>
<!-- layer0_expert3_6&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge142" class="edge">
<title>layer0_expert3_6&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10542.04,-1141.54C10545.06,-1140.33 10548.05,-1139.15 10551,-1138 10579.16,-1127.01 10609.89,-1115.68 10638.34,-1105.45"/>
<polygon fill="black" stroke="black" points="10639.66,-1108.7 10647.89,-1102.03 10637.3,-1102.11 10639.66,-1108.7"/>
</g>
<!-- layer0_expert3_7&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge143" class="edge">
<title>layer0_expert3_7&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10682.75,-1137.73C10690.66,-1128.7 10699.06,-1119.12 10706.98,-1110.08"/>
<polygon fill="black" stroke="black" points="10709.85,-1112.13 10713.81,-1102.3 10704.58,-1107.51 10709.85,-1112.13"/>
</g>
<!-- layer0_expert3_8&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge144" class="edge">
<title>layer0_expert3_8&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10803.25,-1137.73C10795.34,-1128.7 10786.94,-1119.12 10779.02,-1110.08"/>
<polygon fill="black" stroke="black" points="10781.42,-1107.51 10772.19,-1102.3 10776.15,-1112.13 10781.42,-1107.51"/>
</g>
<!-- layer0_expert3_9&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge145" class="edge">
<title>layer0_expert3_9&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10943.96,-1141.54C10940.94,-1140.33 10937.95,-1139.15 10935,-1138 10906.84,-1127.01 10876.11,-1115.68 10847.66,-1105.45"/>
<polygon fill="black" stroke="black" points="10848.7,-1102.11 10838.11,-1102.03 10846.34,-1108.7 10848.7,-1102.11"/>
</g>
<!-- layer0_expert3_10&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge146" class="edge">
<title>layer0_expert3_10&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11135.92,-1140.8C11132.93,-1139.81 11129.95,-1138.87 11127,-1138 11037.2,-1111.35 10932.36,-1093.36 10854.94,-1082.44"/>
<polygon fill="black" stroke="black" points="10855.07,-1078.93 10844.68,-1081.02 10854.1,-1085.86 10855.07,-1078.93"/>
</g>
<!-- layer0_expert3_11&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge147" class="edge">
<title>layer0_expert3_11&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11327.99,-1140.57C11324.97,-1139.65 11321.97,-1138.79 11319,-1138 11161.15,-1096.14 10972.18,-1079.63 10854.84,-1073.14"/>
<polygon fill="black" stroke="black" points="10854.93,-1069.64 10844.76,-1072.6 10854.56,-1076.63 10854.93,-1069.64"/>
</g>
<!-- layer0_expert3_12&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge148" class="edge">
<title>layer0_expert3_12&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11519.75,-1140.38C11516.82,-1139.52 11513.9,-1138.72 11511,-1138 11282.76,-1081.08 11006.02,-1069.79 10854.89,-1068.31"/>
<polygon fill="black" stroke="black" points="10854.7,-1064.81 10844.67,-1068.22 10854.64,-1071.81 10854.7,-1064.81"/>
</g>
<!-- layer0_expert3_13&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge149" class="edge">
<title>layer0_expert3_13&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11711.77,-1140.31C11708.83,-1139.47 11705.9,-1138.7 11703,-1138 11544.85,-1100.05 11072.15,-1079.92 10854.7,-1072.45"/>
<polygon fill="black" stroke="black" points="10854.65,-1068.95 10844.54,-1072.1 10854.41,-1075.94 10854.65,-1068.95"/>
</g>
<!-- layer0_expert3_14&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge150" class="edge">
<title>layer0_expert3_14&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11903.78,-1140.27C11900.84,-1139.44 11897.91,-1138.68 11895,-1138 11699.56,-1092.34 11104.45,-1075.89 10854.95,-1070.89"/>
<polygon fill="black" stroke="black" points="10854.84,-1067.39 10844.77,-1070.69 10854.7,-1074.39 10854.84,-1067.39"/>
</g>
<!-- layer0_expert3_15&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge151" class="edge">
<title>layer0_expert3_15&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M12095.78,-1140.23C12092.84,-1139.42 12089.91,-1138.67 12087,-1138 11853.89,-1084.58 11134.12,-1072.47 10855.12,-1069.77"/>
<polygon fill="black" stroke="black" points="10855.01,-1066.27 10844.98,-1069.67 10854.94,-1073.27 10855.01,-1066.27"/>
</g>
<!-- layer0_output_gpu3 -->
<g id="node90" class="node">
<title>layer0_output_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10865,-949 10621,-949 10621,-881 10865,-881 10865,-949"/>
<text text-anchor="middle" x="10743" y="-933.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="10743" y="-918.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="10743" y="-903.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10743" y="-888.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_moe_agg_gpu3&#45;&gt;layer0_output_gpu3 -->
<g id="edge152" class="edge">
<title>layer0_moe_agg_gpu3&#45;&gt;layer0_output_gpu3</title>
<path fill="none" stroke="black" d="M10743,-1033.86C10743,-1011.93 10743,-982.95 10743,-959.21"/>
<polygon fill="black" stroke="black" points="10746.5,-959.06 10743,-949.06 10739.5,-959.06 10746.5,-959.06"/>
</g>
<!-- layer0_attn_gpu4 -->
<g id="node92" class="node">
<title>layer0_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12858.5,-1563 12615.5,-1563 12615.5,-1495 12858.5,-1495 12858.5,-1563"/>
<text text-anchor="middle" x="12737" y="-1547.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="12737" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="12737" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12737" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_qkv_gpu4&#45;&gt;layer0_attn_gpu4 -->
<g id="edge153" class="edge">
<title>layer0_qkv_gpu4&#45;&gt;layer0_attn_gpu4</title>
<path fill="none" stroke="black" d="M12726.87,-1598.88C12728.06,-1590.78 12729.36,-1581.98 12730.61,-1573.47"/>
<polygon fill="black" stroke="black" points="12734.11,-1573.7 12732.1,-1563.3 12727.19,-1572.68 12734.11,-1573.7"/>
</g>
<!-- layer0_attn_norm_gpu4 -->
<g id="node93" class="node">
<title>layer0_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13186,-1451.5 12942,-1451.5 12942,-1383.5 13186,-1383.5 13186,-1451.5"/>
<text text-anchor="middle" x="13064" y="-1436.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="13064" y="-1421.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="13064" y="-1406.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13064" y="-1391.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_gpu4&#45;&gt;layer0_attn_norm_gpu4 -->
<g id="edge154" class="edge">
<title>layer0_attn_gpu4&#45;&gt;layer0_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M12835.55,-1495C12873.43,-1482.31 12916.87,-1467.77 12955.62,-1454.79"/>
<polygon fill="black" stroke="black" points="12956.99,-1458.02 12965.37,-1451.53 12954.77,-1451.39 12956.99,-1458.02"/>
</g>
<!-- layer0_gate_gpu4 -->
<g id="node94" class="node">
<title>layer0_gate_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13841,-1340 13597,-1340 13597,-1257 13841,-1257 13841,-1340"/>
<text text-anchor="middle" x="13719" y="-1324.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU4</text>
<text text-anchor="middle" x="13719" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13719" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="13719" y="-1279.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="13719" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_norm_gpu4&#45;&gt;layer0_gate_gpu4 -->
<g id="edge155" class="edge">
<title>layer0_attn_norm_gpu4&#45;&gt;layer0_gate_gpu4</title>
<path fill="none" stroke="black" d="M13186.05,-1394.7C13299.96,-1374.35 13469.51,-1344.07 13586.64,-1323.14"/>
<polygon fill="black" stroke="black" points="13587.52,-1326.54 13596.74,-1321.34 13586.29,-1319.65 13587.52,-1326.54"/>
</g>
<!-- layer0_expert4_0 -->
<g id="node95" class="node">
<title>layer0_expert4_0</title>
<polygon fill="lightgreen" stroke="black" points="12462,-1221 12288,-1221 12288,-1138 12462,-1138 12462,-1221"/>
<text text-anchor="middle" x="12375" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU4</text>
<text text-anchor="middle" x="12375" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12375" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12375" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12375" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_0 -->
<g id="edge156" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.82,-1295.24C13329.95,-1289.47 12701.25,-1271.11 12472.17,-1220.99"/>
<polygon fill="black" stroke="black" points="12472.75,-1217.53 12462.22,-1218.73 12471.2,-1224.35 12472.75,-1217.53"/>
</g>
<!-- layer0_expert4_1 -->
<g id="node96" class="node">
<title>layer0_expert4_1</title>
<polygon fill="lightgreen" stroke="black" points="12654,-1221 12480,-1221 12480,-1138 12654,-1138 12654,-1221"/>
<text text-anchor="middle" x="12567" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU4</text>
<text text-anchor="middle" x="12567" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12567" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12567" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12567" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_1 -->
<g id="edge157" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.92,-1293.65C13362.28,-1285.46 12855.38,-1263.62 12664.19,-1220.99"/>
<polygon fill="black" stroke="black" points="12664.77,-1217.54 12654.23,-1218.69 12663.19,-1224.35 12664.77,-1217.54"/>
</g>
<!-- layer0_expert4_2 -->
<g id="node97" class="node">
<title>layer0_expert4_2</title>
<polygon fill="lightgreen" stroke="black" points="12846,-1221 12672,-1221 12672,-1138 12846,-1138 12846,-1221"/>
<text text-anchor="middle" x="12759" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU4</text>
<text text-anchor="middle" x="12759" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12759" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12759" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12759" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_2 -->
<g id="edge158" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.77,-1291.36C13397.25,-1280.58 13009.31,-1256.2 12856,-1220.96"/>
<polygon fill="black" stroke="black" points="12856.79,-1217.55 12846.25,-1218.63 12855.16,-1224.36 12856.79,-1217.55"/>
</g>
<!-- layer0_expert4_3 -->
<g id="node98" class="node">
<title>layer0_expert4_3</title>
<polygon fill="lightgreen" stroke="black" points="13038,-1221 12864,-1221 12864,-1138 13038,-1138 13038,-1221"/>
<text text-anchor="middle" x="12951" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU4</text>
<text text-anchor="middle" x="12951" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12951" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12951" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12951" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_3 -->
<g id="edge159" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.91,-1294.05C13463.03,-1287.91 13242.46,-1270.84 13047.84,-1221"/>
<polygon fill="black" stroke="black" points="13048.57,-1217.57 13038.01,-1218.45 13046.81,-1224.35 13048.57,-1217.57"/>
</g>
<!-- layer0_expert4_4 -->
<g id="node99" class="node">
<title>layer0_expert4_4</title>
<polygon fill="lightgreen" stroke="black" points="13230,-1221 13056,-1221 13056,-1138 13230,-1138 13230,-1221"/>
<text text-anchor="middle" x="13143" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU4</text>
<text text-anchor="middle" x="13143" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13143" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13143" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13143" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_4 -->
<g id="edge160" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.91,-1286.26C13501.32,-1275.56 13365.37,-1256.14 13239.84,-1221.05"/>
<polygon fill="black" stroke="black" points="13240.63,-1217.64 13230.06,-1218.28 13238.72,-1224.37 13240.63,-1217.64"/>
</g>
<!-- layer0_expert4_5 -->
<g id="node100" class="node">
<title>layer0_expert4_5</title>
<polygon fill="lightgreen" stroke="black" points="13422,-1221 13248,-1221 13248,-1138 13422,-1138 13422,-1221"/>
<text text-anchor="middle" x="13335" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU4</text>
<text text-anchor="middle" x="13335" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13335" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13335" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13335" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_5 -->
<g id="edge161" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.66,-1269.02C13547.66,-1256.63 13490.72,-1241.01 13431.67,-1221.12"/>
<polygon fill="black" stroke="black" points="13432.77,-1217.79 13422.18,-1217.89 13430.52,-1224.42 13432.77,-1217.79"/>
</g>
<!-- layer0_expert4_6 -->
<g id="node101" class="node">
<title>layer0_expert4_6</title>
<polygon fill="lightgreen" stroke="black" points="13614,-1221 13440,-1221 13440,-1138 13614,-1138 13614,-1221"/>
<text text-anchor="middle" x="13527" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU4</text>
<text text-anchor="middle" x="13527" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13527" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13527" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13527" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_6 -->
<g id="edge162" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13652.39,-1256.91C13636.15,-1247.02 13618.68,-1236.37 13602.08,-1226.25"/>
<polygon fill="black" stroke="black" points="13603.86,-1223.24 13593.5,-1221.02 13600.21,-1229.21 13603.86,-1223.24"/>
</g>
<!-- layer0_expert4_7 -->
<g id="node102" class="node">
<title>layer0_expert4_7</title>
<polygon fill="lightgreen" stroke="black" points="13806,-1221 13632,-1221 13632,-1138 13806,-1138 13806,-1221"/>
<text text-anchor="middle" x="13719" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU4</text>
<text text-anchor="middle" x="13719" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13719" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13719" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13719" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_7 -->
<g id="edge163" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13719,-1256.91C13719,-1248.65 13719,-1239.86 13719,-1231.3"/>
<polygon fill="black" stroke="black" points="13722.5,-1231.02 13719,-1221.02 13715.5,-1231.02 13722.5,-1231.02"/>
</g>
<!-- layer0_expert4_8 -->
<g id="node103" class="node">
<title>layer0_expert4_8</title>
<polygon fill="lightgreen" stroke="black" points="13998,-1221 13824,-1221 13824,-1138 13998,-1138 13998,-1221"/>
<text text-anchor="middle" x="13911" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU4</text>
<text text-anchor="middle" x="13911" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13911" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13911" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13911" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_8 -->
<g id="edge164" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13785.61,-1256.91C13801.85,-1247.02 13819.32,-1236.37 13835.92,-1226.25"/>
<polygon fill="black" stroke="black" points="13837.79,-1229.21 13844.5,-1221.02 13834.14,-1223.24 13837.79,-1229.21"/>
</g>
<!-- layer0_expert4_9 -->
<g id="node104" class="node">
<title>layer0_expert4_9</title>
<polygon fill="lightgreen" stroke="black" points="14190,-1221 14016,-1221 14016,-1138 14190,-1138 14190,-1221"/>
<text text-anchor="middle" x="14103" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU4</text>
<text text-anchor="middle" x="14103" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14103" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14103" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14103" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_9 -->
<g id="edge165" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.34,-1269.02C13890.34,-1256.63 13947.28,-1241.01 14006.33,-1221.12"/>
<polygon fill="black" stroke="black" points="14007.48,-1224.42 14015.82,-1217.89 14005.23,-1217.79 14007.48,-1224.42"/>
</g>
<!-- layer0_expert4_10 -->
<g id="node105" class="node">
<title>layer0_expert4_10</title>
<polygon fill="lightgreen" stroke="black" points="14382,-1221 14208,-1221 14208,-1138 14382,-1138 14382,-1221"/>
<text text-anchor="middle" x="14295" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU4</text>
<text text-anchor="middle" x="14295" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14295" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14295" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14295" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_10 -->
<g id="edge166" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.09,-1286.26C13936.68,-1275.56 14072.63,-1256.14 14198.16,-1221.05"/>
<polygon fill="black" stroke="black" points="14199.28,-1224.37 14207.94,-1218.28 14197.37,-1217.64 14199.28,-1224.37"/>
</g>
<!-- layer0_expert4_11 -->
<g id="node106" class="node">
<title>layer0_expert4_11</title>
<polygon fill="lightgreen" stroke="black" points="14574,-1221 14400,-1221 14400,-1138 14574,-1138 14574,-1221"/>
<text text-anchor="middle" x="14487" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU4</text>
<text text-anchor="middle" x="14487" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14487" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14487" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14487" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_11 -->
<g id="edge167" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.09,-1294.05C13974.97,-1287.91 14195.54,-1270.84 14390.16,-1221"/>
<polygon fill="black" stroke="black" points="14391.19,-1224.35 14399.99,-1218.45 14389.43,-1217.57 14391.19,-1224.35"/>
</g>
<!-- layer0_expert4_12 -->
<g id="node107" class="node">
<title>layer0_expert4_12</title>
<polygon fill="lightgreen" stroke="black" points="14766,-1221 14592,-1221 14592,-1138 14766,-1138 14766,-1221"/>
<text text-anchor="middle" x="14679" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU4</text>
<text text-anchor="middle" x="14679" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14679" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14679" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14679" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_12 -->
<g id="edge168" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.23,-1291.36C14040.75,-1280.58 14428.69,-1256.2 14582,-1220.96"/>
<polygon fill="black" stroke="black" points="14582.84,-1224.36 14591.75,-1218.63 14581.21,-1217.55 14582.84,-1224.36"/>
</g>
<!-- layer0_expert4_13 -->
<g id="node108" class="node">
<title>layer0_expert4_13</title>
<polygon fill="lightgreen" stroke="black" points="14958,-1221 14784,-1221 14784,-1138 14958,-1138 14958,-1221"/>
<text text-anchor="middle" x="14871" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU4</text>
<text text-anchor="middle" x="14871" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14871" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14871" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14871" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_13 -->
<g id="edge169" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.08,-1293.65C14075.72,-1285.46 14582.62,-1263.62 14773.81,-1220.99"/>
<polygon fill="black" stroke="black" points="14774.81,-1224.35 14783.77,-1218.69 14773.23,-1217.54 14774.81,-1224.35"/>
</g>
<!-- layer0_expert4_14 -->
<g id="node109" class="node">
<title>layer0_expert4_14</title>
<polygon fill="lightgreen" stroke="black" points="15150,-1221 14976,-1221 14976,-1138 15150,-1138 15150,-1221"/>
<text text-anchor="middle" x="15063" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU4</text>
<text text-anchor="middle" x="15063" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15063" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15063" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15063" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_14 -->
<g id="edge170" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.18,-1295.24C14108.05,-1289.47 14736.75,-1271.11 14965.83,-1220.99"/>
<polygon fill="black" stroke="black" points="14966.8,-1224.35 14975.78,-1218.73 14965.25,-1217.53 14966.8,-1224.35"/>
</g>
<!-- layer0_expert4_15 -->
<g id="node110" class="node">
<title>layer0_expert4_15</title>
<polygon fill="lightgreen" stroke="black" points="15342,-1221 15168,-1221 15168,-1138 15342,-1138 15342,-1221"/>
<text text-anchor="middle" x="15255" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU4</text>
<text text-anchor="middle" x="15255" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15255" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15255" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15255" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_15 -->
<g id="edge171" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.2,-1296.41C14137.79,-1292.92 14890.41,-1278.7 15157.71,-1221.01"/>
<polygon fill="black" stroke="black" points="15158.78,-1224.35 15167.78,-1218.76 15157.26,-1217.52 15158.78,-1224.35"/>
</g>
<!-- layer0_moe_agg_gpu4 -->
<g id="node111" class="node">
<title>layer0_moe_agg_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13916.5,-1102 13713.5,-1102 13713.5,-1034 13916.5,-1034 13916.5,-1102"/>
<text text-anchor="middle" x="13815" y="-1086.8" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU4</text>
<text text-anchor="middle" x="13815" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="13815" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13815" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_expert4_0&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge172" class="edge">
<title>layer0_expert4_0&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12462.22,-1140.23C12465.16,-1139.42 12468.09,-1138.67 12471,-1138 12704.11,-1084.58 13423.88,-1072.47 13702.88,-1069.77"/>
<polygon fill="black" stroke="black" points="13703.06,-1073.27 13713.02,-1069.67 13702.99,-1066.27 13703.06,-1073.27"/>
</g>
<!-- layer0_expert4_1&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge173" class="edge">
<title>layer0_expert4_1&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12654.22,-1140.27C12657.16,-1139.44 12660.09,-1138.68 12663,-1138 12858.44,-1092.34 13453.55,-1075.89 13703.05,-1070.89"/>
<polygon fill="black" stroke="black" points="13703.3,-1074.39 13713.23,-1070.69 13703.16,-1067.39 13703.3,-1074.39"/>
</g>
<!-- layer0_expert4_2&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge174" class="edge">
<title>layer0_expert4_2&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12846.23,-1140.31C12849.17,-1139.47 12852.1,-1138.7 12855,-1138 13013.15,-1100.05 13485.85,-1079.92 13703.3,-1072.45"/>
<polygon fill="black" stroke="black" points="13703.59,-1075.94 13713.46,-1072.1 13703.35,-1068.95 13703.59,-1075.94"/>
</g>
<!-- layer0_expert4_3&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge175" class="edge">
<title>layer0_expert4_3&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13038.25,-1140.38C13041.18,-1139.52 13044.1,-1138.72 13047,-1138 13275.24,-1081.08 13551.98,-1069.79 13703.11,-1068.31"/>
<polygon fill="black" stroke="black" points="13703.36,-1071.81 13713.33,-1068.22 13703.3,-1064.81 13703.36,-1071.81"/>
</g>
<!-- layer0_expert4_4&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge176" class="edge">
<title>layer0_expert4_4&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13230.01,-1140.57C13233.03,-1139.65 13236.03,-1138.79 13239,-1138 13396.85,-1096.14 13585.82,-1079.63 13703.16,-1073.14"/>
<polygon fill="black" stroke="black" points="13703.44,-1076.63 13713.24,-1072.6 13703.07,-1069.64 13703.44,-1076.63"/>
</g>
<!-- layer0_expert4_5&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge177" class="edge">
<title>layer0_expert4_5&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13422.08,-1140.8C13425.07,-1139.81 13428.05,-1138.87 13431,-1138 13520.8,-1111.35 13625.64,-1093.36 13703.06,-1082.44"/>
<polygon fill="black" stroke="black" points="13703.9,-1085.86 13713.32,-1081.02 13702.93,-1078.93 13703.9,-1085.86"/>
</g>
<!-- layer0_expert4_6&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge178" class="edge">
<title>layer0_expert4_6&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13614.04,-1141.54C13617.06,-1140.33 13620.05,-1139.15 13623,-1138 13651.16,-1127.01 13681.89,-1115.68 13710.34,-1105.45"/>
<polygon fill="black" stroke="black" points="13711.66,-1108.7 13719.89,-1102.03 13709.3,-1102.11 13711.66,-1108.7"/>
</g>
<!-- layer0_expert4_7&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge179" class="edge">
<title>layer0_expert4_7&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13754.75,-1137.73C13762.66,-1128.7 13771.06,-1119.12 13778.98,-1110.08"/>
<polygon fill="black" stroke="black" points="13781.85,-1112.13 13785.81,-1102.3 13776.58,-1107.51 13781.85,-1112.13"/>
</g>
<!-- layer0_expert4_8&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge180" class="edge">
<title>layer0_expert4_8&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13875.25,-1137.73C13867.34,-1128.7 13858.94,-1119.12 13851.02,-1110.08"/>
<polygon fill="black" stroke="black" points="13853.42,-1107.51 13844.19,-1102.3 13848.15,-1112.13 13853.42,-1107.51"/>
</g>
<!-- layer0_expert4_9&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge181" class="edge">
<title>layer0_expert4_9&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14015.96,-1141.54C14012.94,-1140.33 14009.95,-1139.15 14007,-1138 13978.84,-1127.01 13948.11,-1115.68 13919.66,-1105.45"/>
<polygon fill="black" stroke="black" points="13920.7,-1102.11 13910.11,-1102.03 13918.34,-1108.7 13920.7,-1102.11"/>
</g>
<!-- layer0_expert4_10&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge182" class="edge">
<title>layer0_expert4_10&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14207.92,-1140.8C14204.93,-1139.81 14201.95,-1138.87 14199,-1138 14109.2,-1111.35 14004.36,-1093.36 13926.94,-1082.44"/>
<polygon fill="black" stroke="black" points="13927.07,-1078.93 13916.68,-1081.02 13926.1,-1085.86 13927.07,-1078.93"/>
</g>
<!-- layer0_expert4_11&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge183" class="edge">
<title>layer0_expert4_11&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14399.99,-1140.57C14396.97,-1139.65 14393.97,-1138.79 14391,-1138 14233.15,-1096.14 14044.18,-1079.63 13926.84,-1073.14"/>
<polygon fill="black" stroke="black" points="13926.93,-1069.64 13916.76,-1072.6 13926.56,-1076.63 13926.93,-1069.64"/>
</g>
<!-- layer0_expert4_12&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge184" class="edge">
<title>layer0_expert4_12&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14591.75,-1140.38C14588.82,-1139.52 14585.9,-1138.72 14583,-1138 14354.76,-1081.08 14078.02,-1069.79 13926.89,-1068.31"/>
<polygon fill="black" stroke="black" points="13926.7,-1064.81 13916.67,-1068.22 13926.64,-1071.81 13926.7,-1064.81"/>
</g>
<!-- layer0_expert4_13&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge185" class="edge">
<title>layer0_expert4_13&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14783.77,-1140.31C14780.83,-1139.47 14777.9,-1138.7 14775,-1138 14616.85,-1100.05 14144.15,-1079.92 13926.7,-1072.45"/>
<polygon fill="black" stroke="black" points="13926.65,-1068.95 13916.54,-1072.1 13926.41,-1075.94 13926.65,-1068.95"/>
</g>
<!-- layer0_expert4_14&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge186" class="edge">
<title>layer0_expert4_14&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14975.78,-1140.27C14972.84,-1139.44 14969.91,-1138.68 14967,-1138 14771.56,-1092.34 14176.45,-1075.89 13926.95,-1070.89"/>
<polygon fill="black" stroke="black" points="13926.84,-1067.39 13916.77,-1070.69 13926.7,-1074.39 13926.84,-1067.39"/>
</g>
<!-- layer0_expert4_15&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge187" class="edge">
<title>layer0_expert4_15&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M15167.78,-1140.23C15164.84,-1139.42 15161.91,-1138.67 15159,-1138 14925.89,-1084.58 14206.12,-1072.47 13927.12,-1069.77"/>
<polygon fill="black" stroke="black" points="13927.01,-1066.27 13916.98,-1069.67 13926.94,-1073.27 13927.01,-1066.27"/>
</g>
<!-- layer0_output_gpu4 -->
<g id="node112" class="node">
<title>layer0_output_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13937,-949 13693,-949 13693,-881 13937,-881 13937,-949"/>
<text text-anchor="middle" x="13815" y="-933.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="13815" y="-918.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="13815" y="-903.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13815" y="-888.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_moe_agg_gpu4&#45;&gt;layer0_output_gpu4 -->
<g id="edge188" class="edge">
<title>layer0_moe_agg_gpu4&#45;&gt;layer0_output_gpu4</title>
<path fill="none" stroke="black" d="M13815,-1033.86C13815,-1011.93 13815,-982.95 13815,-959.21"/>
<polygon fill="black" stroke="black" points="13818.5,-959.06 13815,-949.06 13811.5,-959.06 13818.5,-959.06"/>
</g>
<!-- layer0_attn_gpu5 -->
<g id="node114" class="node">
<title>layer0_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="15513.5,-1563 15270.5,-1563 15270.5,-1495 15513.5,-1495 15513.5,-1563"/>
<text text-anchor="middle" x="15392" y="-1547.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="15392" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="15392" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15392" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_qkv_gpu5&#45;&gt;layer0_attn_gpu5 -->
<g id="edge189" class="edge">
<title>layer0_qkv_gpu5&#45;&gt;layer0_attn_gpu5</title>
<path fill="none" stroke="black" d="M14070.17,-1624.42C14326.6,-1606.1 14979.25,-1559.48 15260.15,-1539.42"/>
<polygon fill="black" stroke="black" points="15260.66,-1542.89 15270.39,-1538.69 15260.17,-1535.91 15260.66,-1542.89"/>
</g>
<!-- layer0_attn_norm_gpu5 -->
<g id="node115" class="node">
<title>layer0_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16228,-1451.5 15984,-1451.5 15984,-1383.5 16228,-1383.5 16228,-1451.5"/>
<text text-anchor="middle" x="16106" y="-1436.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="16106" y="-1421.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="16106" y="-1406.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16106" y="-1391.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_gpu5&#45;&gt;layer0_attn_norm_gpu5 -->
<g id="edge190" class="edge">
<title>layer0_attn_gpu5&#45;&gt;layer0_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M15513.52,-1509.36C15641.36,-1489.76 15841.92,-1459 15973.68,-1438.79"/>
<polygon fill="black" stroke="black" points="15974.48,-1442.21 15983.83,-1437.24 15973.42,-1435.29 15974.48,-1442.21"/>
</g>
<!-- layer0_gate_gpu5 -->
<g id="node116" class="node">
<title>layer0_gate_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16913,-1340 16669,-1340 16669,-1257 16913,-1257 16913,-1340"/>
<text text-anchor="middle" x="16791" y="-1324.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU5</text>
<text text-anchor="middle" x="16791" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="16791" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="16791" y="-1279.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="16791" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_norm_gpu5&#45;&gt;layer0_gate_gpu5 -->
<g id="edge191" class="edge">
<title>layer0_attn_norm_gpu5&#45;&gt;layer0_gate_gpu5</title>
<path fill="none" stroke="black" d="M16228.07,-1395.65C16349.22,-1374.96 16534.35,-1343.34 16658.89,-1322.06"/>
<polygon fill="black" stroke="black" points="16659.61,-1325.49 16668.87,-1320.36 16658.43,-1318.59 16659.61,-1325.49"/>
</g>
<!-- layer0_expert5_0 -->
<g id="node117" class="node">
<title>layer0_expert5_0</title>
<polygon fill="lightgreen" stroke="black" points="15534,-1221 15360,-1221 15360,-1138 15534,-1138 15534,-1221"/>
<text text-anchor="middle" x="15447" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU5</text>
<text text-anchor="middle" x="15447" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15447" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15447" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15447" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_0 -->
<g id="edge192" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.82,-1295.24C16401.95,-1289.47 15773.25,-1271.11 15544.17,-1220.99"/>
<polygon fill="black" stroke="black" points="15544.75,-1217.53 15534.22,-1218.73 15543.2,-1224.35 15544.75,-1217.53"/>
</g>
<!-- layer0_expert5_1 -->
<g id="node118" class="node">
<title>layer0_expert5_1</title>
<polygon fill="lightgreen" stroke="black" points="15726,-1221 15552,-1221 15552,-1138 15726,-1138 15726,-1221"/>
<text text-anchor="middle" x="15639" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU5</text>
<text text-anchor="middle" x="15639" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15639" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15639" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15639" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_1 -->
<g id="edge193" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.92,-1293.65C16434.28,-1285.46 15927.38,-1263.62 15736.19,-1220.99"/>
<polygon fill="black" stroke="black" points="15736.77,-1217.54 15726.23,-1218.69 15735.19,-1224.35 15736.77,-1217.54"/>
</g>
<!-- layer0_expert5_2 -->
<g id="node119" class="node">
<title>layer0_expert5_2</title>
<polygon fill="lightgreen" stroke="black" points="15918,-1221 15744,-1221 15744,-1138 15918,-1138 15918,-1221"/>
<text text-anchor="middle" x="15831" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU5</text>
<text text-anchor="middle" x="15831" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15831" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15831" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15831" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_2 -->
<g id="edge194" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.77,-1291.36C16469.25,-1280.58 16081.31,-1256.2 15928,-1220.96"/>
<polygon fill="black" stroke="black" points="15928.79,-1217.55 15918.25,-1218.63 15927.16,-1224.36 15928.79,-1217.55"/>
</g>
<!-- layer0_expert5_3 -->
<g id="node120" class="node">
<title>layer0_expert5_3</title>
<polygon fill="lightgreen" stroke="black" points="16110,-1221 15936,-1221 15936,-1138 16110,-1138 16110,-1221"/>
<text text-anchor="middle" x="16023" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU5</text>
<text text-anchor="middle" x="16023" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16023" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16023" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16023" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_3 -->
<g id="edge195" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.91,-1294.05C16535.03,-1287.91 16314.46,-1270.84 16119.84,-1221"/>
<polygon fill="black" stroke="black" points="16120.57,-1217.57 16110.01,-1218.45 16118.81,-1224.35 16120.57,-1217.57"/>
</g>
<!-- layer0_expert5_4 -->
<g id="node121" class="node">
<title>layer0_expert5_4</title>
<polygon fill="lightgreen" stroke="black" points="16302,-1221 16128,-1221 16128,-1138 16302,-1138 16302,-1221"/>
<text text-anchor="middle" x="16215" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU5</text>
<text text-anchor="middle" x="16215" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16215" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16215" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16215" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_4 -->
<g id="edge196" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.91,-1286.26C16573.32,-1275.56 16437.37,-1256.14 16311.84,-1221.05"/>
<polygon fill="black" stroke="black" points="16312.63,-1217.64 16302.06,-1218.28 16310.72,-1224.37 16312.63,-1217.64"/>
</g>
<!-- layer0_expert5_5 -->
<g id="node122" class="node">
<title>layer0_expert5_5</title>
<polygon fill="lightgreen" stroke="black" points="16494,-1221 16320,-1221 16320,-1138 16494,-1138 16494,-1221"/>
<text text-anchor="middle" x="16407" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU5</text>
<text text-anchor="middle" x="16407" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16407" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16407" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16407" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_5 -->
<g id="edge197" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.66,-1269.02C16619.66,-1256.63 16562.72,-1241.01 16503.67,-1221.12"/>
<polygon fill="black" stroke="black" points="16504.77,-1217.79 16494.18,-1217.89 16502.52,-1224.42 16504.77,-1217.79"/>
</g>
<!-- layer0_expert5_6 -->
<g id="node123" class="node">
<title>layer0_expert5_6</title>
<polygon fill="lightgreen" stroke="black" points="16686,-1221 16512,-1221 16512,-1138 16686,-1138 16686,-1221"/>
<text text-anchor="middle" x="16599" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU5</text>
<text text-anchor="middle" x="16599" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16599" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16599" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16599" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_6 -->
<g id="edge198" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16724.39,-1256.91C16708.15,-1247.02 16690.68,-1236.37 16674.08,-1226.25"/>
<polygon fill="black" stroke="black" points="16675.86,-1223.24 16665.5,-1221.02 16672.21,-1229.21 16675.86,-1223.24"/>
</g>
<!-- layer0_expert5_7 -->
<g id="node124" class="node">
<title>layer0_expert5_7</title>
<polygon fill="lightgreen" stroke="black" points="16878,-1221 16704,-1221 16704,-1138 16878,-1138 16878,-1221"/>
<text text-anchor="middle" x="16791" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU5</text>
<text text-anchor="middle" x="16791" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16791" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16791" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16791" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_7 -->
<g id="edge199" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16791,-1256.91C16791,-1248.65 16791,-1239.86 16791,-1231.3"/>
<polygon fill="black" stroke="black" points="16794.5,-1231.02 16791,-1221.02 16787.5,-1231.02 16794.5,-1231.02"/>
</g>
<!-- layer0_expert5_8 -->
<g id="node125" class="node">
<title>layer0_expert5_8</title>
<polygon fill="lightgreen" stroke="black" points="17070,-1221 16896,-1221 16896,-1138 17070,-1138 17070,-1221"/>
<text text-anchor="middle" x="16983" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU5</text>
<text text-anchor="middle" x="16983" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16983" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16983" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16983" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_8 -->
<g id="edge200" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16857.61,-1256.91C16873.85,-1247.02 16891.32,-1236.37 16907.92,-1226.25"/>
<polygon fill="black" stroke="black" points="16909.79,-1229.21 16916.5,-1221.02 16906.14,-1223.24 16909.79,-1229.21"/>
</g>
<!-- layer0_expert5_9 -->
<g id="node126" class="node">
<title>layer0_expert5_9</title>
<polygon fill="lightgreen" stroke="black" points="17262,-1221 17088,-1221 17088,-1138 17262,-1138 17262,-1221"/>
<text text-anchor="middle" x="17175" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU5</text>
<text text-anchor="middle" x="17175" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17175" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17175" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17175" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_9 -->
<g id="edge201" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.34,-1269.02C16962.34,-1256.63 17019.28,-1241.01 17078.33,-1221.12"/>
<polygon fill="black" stroke="black" points="17079.48,-1224.42 17087.82,-1217.89 17077.23,-1217.79 17079.48,-1224.42"/>
</g>
<!-- layer0_expert5_10 -->
<g id="node127" class="node">
<title>layer0_expert5_10</title>
<polygon fill="lightgreen" stroke="black" points="17454,-1221 17280,-1221 17280,-1138 17454,-1138 17454,-1221"/>
<text text-anchor="middle" x="17367" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU5</text>
<text text-anchor="middle" x="17367" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17367" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17367" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17367" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_10 -->
<g id="edge202" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.09,-1286.26C17008.68,-1275.56 17144.63,-1256.14 17270.16,-1221.05"/>
<polygon fill="black" stroke="black" points="17271.28,-1224.37 17279.94,-1218.28 17269.37,-1217.64 17271.28,-1224.37"/>
</g>
<!-- layer0_expert5_11 -->
<g id="node128" class="node">
<title>layer0_expert5_11</title>
<polygon fill="lightgreen" stroke="black" points="17646,-1221 17472,-1221 17472,-1138 17646,-1138 17646,-1221"/>
<text text-anchor="middle" x="17559" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU5</text>
<text text-anchor="middle" x="17559" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17559" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17559" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17559" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_11 -->
<g id="edge203" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.09,-1294.05C17046.97,-1287.91 17267.54,-1270.84 17462.16,-1221"/>
<polygon fill="black" stroke="black" points="17463.19,-1224.35 17471.99,-1218.45 17461.43,-1217.57 17463.19,-1224.35"/>
</g>
<!-- layer0_expert5_12 -->
<g id="node129" class="node">
<title>layer0_expert5_12</title>
<polygon fill="lightgreen" stroke="black" points="17838,-1221 17664,-1221 17664,-1138 17838,-1138 17838,-1221"/>
<text text-anchor="middle" x="17751" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU5</text>
<text text-anchor="middle" x="17751" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17751" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17751" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17751" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_12 -->
<g id="edge204" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.23,-1291.36C17112.75,-1280.58 17500.69,-1256.2 17654,-1220.96"/>
<polygon fill="black" stroke="black" points="17654.84,-1224.36 17663.75,-1218.63 17653.21,-1217.55 17654.84,-1224.36"/>
</g>
<!-- layer0_expert5_13 -->
<g id="node130" class="node">
<title>layer0_expert5_13</title>
<polygon fill="lightgreen" stroke="black" points="18030,-1221 17856,-1221 17856,-1138 18030,-1138 18030,-1221"/>
<text text-anchor="middle" x="17943" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU5</text>
<text text-anchor="middle" x="17943" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17943" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17943" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17943" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_13 -->
<g id="edge205" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.08,-1293.65C17147.72,-1285.46 17654.62,-1263.62 17845.81,-1220.99"/>
<polygon fill="black" stroke="black" points="17846.81,-1224.35 17855.77,-1218.69 17845.23,-1217.54 17846.81,-1224.35"/>
</g>
<!-- layer0_expert5_14 -->
<g id="node131" class="node">
<title>layer0_expert5_14</title>
<polygon fill="lightgreen" stroke="black" points="18222,-1221 18048,-1221 18048,-1138 18222,-1138 18222,-1221"/>
<text text-anchor="middle" x="18135" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU5</text>
<text text-anchor="middle" x="18135" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18135" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18135" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18135" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_14 -->
<g id="edge206" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.18,-1295.24C17180.05,-1289.47 17808.75,-1271.11 18037.83,-1220.99"/>
<polygon fill="black" stroke="black" points="18038.8,-1224.35 18047.78,-1218.73 18037.25,-1217.53 18038.8,-1224.35"/>
</g>
<!-- layer0_expert5_15 -->
<g id="node132" class="node">
<title>layer0_expert5_15</title>
<polygon fill="lightgreen" stroke="black" points="18414,-1221 18240,-1221 18240,-1138 18414,-1138 18414,-1221"/>
<text text-anchor="middle" x="18327" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU5</text>
<text text-anchor="middle" x="18327" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18327" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18327" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18327" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_15 -->
<g id="edge207" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.2,-1296.41C17209.79,-1292.92 17962.41,-1278.7 18229.71,-1221.01"/>
<polygon fill="black" stroke="black" points="18230.78,-1224.35 18239.78,-1218.76 18229.26,-1217.52 18230.78,-1224.35"/>
</g>
<!-- layer0_moe_agg_gpu5 -->
<g id="node133" class="node">
<title>layer0_moe_agg_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16988.5,-1102 16785.5,-1102 16785.5,-1034 16988.5,-1034 16988.5,-1102"/>
<text text-anchor="middle" x="16887" y="-1086.8" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU5</text>
<text text-anchor="middle" x="16887" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="16887" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16887" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_expert5_0&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge208" class="edge">
<title>layer0_expert5_0&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15534.22,-1140.23C15537.16,-1139.42 15540.09,-1138.67 15543,-1138 15776.11,-1084.58 16495.88,-1072.47 16774.88,-1069.77"/>
<polygon fill="black" stroke="black" points="16775.06,-1073.27 16785.02,-1069.67 16774.99,-1066.27 16775.06,-1073.27"/>
</g>
<!-- layer0_expert5_1&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge209" class="edge">
<title>layer0_expert5_1&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15726.22,-1140.27C15729.16,-1139.44 15732.09,-1138.68 15735,-1138 15930.44,-1092.34 16525.55,-1075.89 16775.05,-1070.89"/>
<polygon fill="black" stroke="black" points="16775.3,-1074.39 16785.23,-1070.69 16775.16,-1067.39 16775.3,-1074.39"/>
</g>
<!-- layer0_expert5_2&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge210" class="edge">
<title>layer0_expert5_2&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15918.23,-1140.31C15921.17,-1139.47 15924.1,-1138.7 15927,-1138 16085.15,-1100.05 16557.85,-1079.92 16775.3,-1072.45"/>
<polygon fill="black" stroke="black" points="16775.59,-1075.94 16785.46,-1072.1 16775.35,-1068.95 16775.59,-1075.94"/>
</g>
<!-- layer0_expert5_3&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge211" class="edge">
<title>layer0_expert5_3&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16110.25,-1140.38C16113.18,-1139.52 16116.1,-1138.72 16119,-1138 16347.24,-1081.08 16623.98,-1069.79 16775.11,-1068.31"/>
<polygon fill="black" stroke="black" points="16775.36,-1071.81 16785.33,-1068.22 16775.3,-1064.81 16775.36,-1071.81"/>
</g>
<!-- layer0_expert5_4&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge212" class="edge">
<title>layer0_expert5_4&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16302.01,-1140.57C16305.03,-1139.65 16308.03,-1138.79 16311,-1138 16468.85,-1096.14 16657.82,-1079.63 16775.16,-1073.14"/>
<polygon fill="black" stroke="black" points="16775.44,-1076.63 16785.24,-1072.6 16775.07,-1069.64 16775.44,-1076.63"/>
</g>
<!-- layer0_expert5_5&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge213" class="edge">
<title>layer0_expert5_5&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16494.08,-1140.8C16497.07,-1139.81 16500.05,-1138.87 16503,-1138 16592.8,-1111.35 16697.64,-1093.36 16775.06,-1082.44"/>
<polygon fill="black" stroke="black" points="16775.9,-1085.86 16785.32,-1081.02 16774.93,-1078.93 16775.9,-1085.86"/>
</g>
<!-- layer0_expert5_6&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge214" class="edge">
<title>layer0_expert5_6&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16686.04,-1141.54C16689.06,-1140.33 16692.05,-1139.15 16695,-1138 16723.16,-1127.01 16753.89,-1115.68 16782.34,-1105.45"/>
<polygon fill="black" stroke="black" points="16783.66,-1108.7 16791.89,-1102.03 16781.3,-1102.11 16783.66,-1108.7"/>
</g>
<!-- layer0_expert5_7&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge215" class="edge">
<title>layer0_expert5_7&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16826.75,-1137.73C16834.66,-1128.7 16843.06,-1119.12 16850.98,-1110.08"/>
<polygon fill="black" stroke="black" points="16853.85,-1112.13 16857.81,-1102.3 16848.58,-1107.51 16853.85,-1112.13"/>
</g>
<!-- layer0_expert5_8&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge216" class="edge">
<title>layer0_expert5_8&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16947.25,-1137.73C16939.34,-1128.7 16930.94,-1119.12 16923.02,-1110.08"/>
<polygon fill="black" stroke="black" points="16925.42,-1107.51 16916.19,-1102.3 16920.15,-1112.13 16925.42,-1107.51"/>
</g>
<!-- layer0_expert5_9&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge217" class="edge">
<title>layer0_expert5_9&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17087.96,-1141.54C17084.94,-1140.33 17081.95,-1139.15 17079,-1138 17050.84,-1127.01 17020.11,-1115.68 16991.66,-1105.45"/>
<polygon fill="black" stroke="black" points="16992.7,-1102.11 16982.11,-1102.03 16990.34,-1108.7 16992.7,-1102.11"/>
</g>
<!-- layer0_expert5_10&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge218" class="edge">
<title>layer0_expert5_10&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17279.92,-1140.8C17276.93,-1139.81 17273.95,-1138.87 17271,-1138 17181.2,-1111.35 17076.36,-1093.36 16998.94,-1082.44"/>
<polygon fill="black" stroke="black" points="16999.07,-1078.93 16988.68,-1081.02 16998.1,-1085.86 16999.07,-1078.93"/>
</g>
<!-- layer0_expert5_11&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge219" class="edge">
<title>layer0_expert5_11&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17471.99,-1140.57C17468.97,-1139.65 17465.97,-1138.79 17463,-1138 17305.15,-1096.14 17116.18,-1079.63 16998.84,-1073.14"/>
<polygon fill="black" stroke="black" points="16998.93,-1069.64 16988.76,-1072.6 16998.56,-1076.63 16998.93,-1069.64"/>
</g>
<!-- layer0_expert5_12&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge220" class="edge">
<title>layer0_expert5_12&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17663.75,-1140.38C17660.82,-1139.52 17657.9,-1138.72 17655,-1138 17426.76,-1081.08 17150.02,-1069.79 16998.89,-1068.31"/>
<polygon fill="black" stroke="black" points="16998.7,-1064.81 16988.67,-1068.22 16998.64,-1071.81 16998.7,-1064.81"/>
</g>
<!-- layer0_expert5_13&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge221" class="edge">
<title>layer0_expert5_13&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17855.77,-1140.31C17852.83,-1139.47 17849.9,-1138.7 17847,-1138 17688.85,-1100.05 17216.15,-1079.92 16998.7,-1072.45"/>
<polygon fill="black" stroke="black" points="16998.65,-1068.95 16988.54,-1072.1 16998.41,-1075.94 16998.65,-1068.95"/>
</g>
<!-- layer0_expert5_14&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge222" class="edge">
<title>layer0_expert5_14&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M18047.78,-1140.27C18044.84,-1139.44 18041.91,-1138.68 18039,-1138 17843.56,-1092.34 17248.45,-1075.89 16998.95,-1070.89"/>
<polygon fill="black" stroke="black" points="16998.84,-1067.39 16988.77,-1070.69 16998.7,-1074.39 16998.84,-1067.39"/>
</g>
<!-- layer0_expert5_15&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge223" class="edge">
<title>layer0_expert5_15&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M18239.78,-1140.23C18236.84,-1139.42 18233.91,-1138.67 18231,-1138 17997.89,-1084.58 17278.12,-1072.47 16999.12,-1069.77"/>
<polygon fill="black" stroke="black" points="16999.01,-1066.27 16988.98,-1069.67 16998.94,-1073.27 16999.01,-1066.27"/>
</g>
<!-- layer0_output_gpu5 -->
<g id="node134" class="node">
<title>layer0_output_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="17009,-949 16765,-949 16765,-881 17009,-881 17009,-949"/>
<text text-anchor="middle" x="16887" y="-933.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="16887" y="-918.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="16887" y="-903.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16887" y="-888.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_moe_agg_gpu5&#45;&gt;layer0_output_gpu5 -->
<g id="edge224" class="edge">
<title>layer0_moe_agg_gpu5&#45;&gt;layer0_output_gpu5</title>
<path fill="none" stroke="black" d="M16887,-1033.86C16887,-1011.93 16887,-982.95 16887,-959.21"/>
<polygon fill="black" stroke="black" points="16890.5,-959.06 16887,-949.06 16883.5,-959.06 16890.5,-959.06"/>
</g>
<!-- layer0_attn_gpu6 -->
<g id="node136" class="node">
<title>layer0_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="17505.5,-1563 17262.5,-1563 17262.5,-1495 17505.5,-1495 17505.5,-1563"/>
<text text-anchor="middle" x="17384" y="-1547.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="17384" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="17384" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="17384" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_qkv_gpu6&#45;&gt;layer0_attn_gpu6 -->
<g id="edge225" class="edge">
<title>layer0_qkv_gpu6&#45;&gt;layer0_attn_gpu6</title>
<path fill="none" stroke="black" d="M15355.24,-1626.92C15711.07,-1609.92 16860.5,-1555.01 17251.99,-1536.31"/>
<polygon fill="black" stroke="black" points="17252.4,-1539.79 17262.23,-1535.82 17252.07,-1532.8 17252.4,-1539.79"/>
</g>
<!-- layer0_attn_norm_gpu6 -->
<g id="node137" class="node">
<title>layer0_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="18930,-1451.5 18686,-1451.5 18686,-1383.5 18930,-1383.5 18930,-1451.5"/>
<text text-anchor="middle" x="18808" y="-1436.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="18808" y="-1421.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="18808" y="-1406.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="18808" y="-1391.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_gpu6&#45;&gt;layer0_attn_norm_gpu6 -->
<g id="edge226" class="edge">
<title>layer0_attn_gpu6&#45;&gt;layer0_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M17505.72,-1518.64C17771.34,-1498.22 18401.13,-1449.79 18675.93,-1428.66"/>
<polygon fill="black" stroke="black" points="18676.25,-1432.14 18685.96,-1427.88 18675.72,-1425.16 18676.25,-1432.14"/>
</g>
<!-- layer0_gate_gpu6 -->
<g id="node138" class="node">
<title>layer0_gate_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="19985,-1340 19741,-1340 19741,-1257 19985,-1257 19985,-1340"/>
<text text-anchor="middle" x="19863" y="-1324.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU6</text>
<text text-anchor="middle" x="19863" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="19863" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="19863" y="-1279.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="19863" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_norm_gpu6&#45;&gt;layer0_gate_gpu6 -->
<g id="edge227" class="edge">
<title>layer0_attn_norm_gpu6&#45;&gt;layer0_gate_gpu6</title>
<path fill="none" stroke="black" d="M18930.05,-1402.96C19129.77,-1380.82 19524.76,-1337.01 19730.85,-1314.16"/>
<polygon fill="black" stroke="black" points="19731.27,-1317.63 19740.83,-1313.05 19730.5,-1310.67 19731.27,-1317.63"/>
</g>
<!-- layer0_expert6_0 -->
<g id="node139" class="node">
<title>layer0_expert6_0</title>
<polygon fill="lightgreen" stroke="black" points="18606,-1221 18432,-1221 18432,-1138 18606,-1138 18606,-1221"/>
<text text-anchor="middle" x="18519" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU6</text>
<text text-anchor="middle" x="18519" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18519" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18519" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18519" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_0 -->
<g id="edge228" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.82,-1295.24C19473.95,-1289.47 18845.25,-1271.11 18616.17,-1220.99"/>
<polygon fill="black" stroke="black" points="18616.75,-1217.53 18606.22,-1218.73 18615.2,-1224.35 18616.75,-1217.53"/>
</g>
<!-- layer0_expert6_1 -->
<g id="node140" class="node">
<title>layer0_expert6_1</title>
<polygon fill="lightgreen" stroke="black" points="18798,-1221 18624,-1221 18624,-1138 18798,-1138 18798,-1221"/>
<text text-anchor="middle" x="18711" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU6</text>
<text text-anchor="middle" x="18711" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18711" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18711" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18711" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_1 -->
<g id="edge229" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.92,-1293.65C19506.28,-1285.46 18999.38,-1263.62 18808.19,-1220.99"/>
<polygon fill="black" stroke="black" points="18808.77,-1217.54 18798.23,-1218.69 18807.19,-1224.35 18808.77,-1217.54"/>
</g>
<!-- layer0_expert6_2 -->
<g id="node141" class="node">
<title>layer0_expert6_2</title>
<polygon fill="lightgreen" stroke="black" points="18990,-1221 18816,-1221 18816,-1138 18990,-1138 18990,-1221"/>
<text text-anchor="middle" x="18903" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU6</text>
<text text-anchor="middle" x="18903" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18903" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18903" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18903" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_2 -->
<g id="edge230" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.77,-1291.36C19541.25,-1280.58 19153.31,-1256.2 19000,-1220.96"/>
<polygon fill="black" stroke="black" points="19000.79,-1217.55 18990.25,-1218.63 18999.16,-1224.36 19000.79,-1217.55"/>
</g>
<!-- layer0_expert6_3 -->
<g id="node142" class="node">
<title>layer0_expert6_3</title>
<polygon fill="lightgreen" stroke="black" points="19182,-1221 19008,-1221 19008,-1138 19182,-1138 19182,-1221"/>
<text text-anchor="middle" x="19095" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU6</text>
<text text-anchor="middle" x="19095" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19095" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19095" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19095" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_3 -->
<g id="edge231" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.91,-1294.05C19607.03,-1287.91 19386.46,-1270.84 19191.84,-1221"/>
<polygon fill="black" stroke="black" points="19192.57,-1217.57 19182.01,-1218.45 19190.81,-1224.35 19192.57,-1217.57"/>
</g>
<!-- layer0_expert6_4 -->
<g id="node143" class="node">
<title>layer0_expert6_4</title>
<polygon fill="lightgreen" stroke="black" points="19374,-1221 19200,-1221 19200,-1138 19374,-1138 19374,-1221"/>
<text text-anchor="middle" x="19287" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU6</text>
<text text-anchor="middle" x="19287" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19287" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19287" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19287" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_4 -->
<g id="edge232" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.91,-1286.26C19645.32,-1275.56 19509.37,-1256.14 19383.84,-1221.05"/>
<polygon fill="black" stroke="black" points="19384.63,-1217.64 19374.06,-1218.28 19382.72,-1224.37 19384.63,-1217.64"/>
</g>
<!-- layer0_expert6_5 -->
<g id="node144" class="node">
<title>layer0_expert6_5</title>
<polygon fill="lightgreen" stroke="black" points="19566,-1221 19392,-1221 19392,-1138 19566,-1138 19566,-1221"/>
<text text-anchor="middle" x="19479" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU6</text>
<text text-anchor="middle" x="19479" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19479" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19479" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19479" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_5 -->
<g id="edge233" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.66,-1269.02C19691.66,-1256.63 19634.72,-1241.01 19575.67,-1221.12"/>
<polygon fill="black" stroke="black" points="19576.77,-1217.79 19566.18,-1217.89 19574.52,-1224.42 19576.77,-1217.79"/>
</g>
<!-- layer0_expert6_6 -->
<g id="node145" class="node">
<title>layer0_expert6_6</title>
<polygon fill="lightgreen" stroke="black" points="19758,-1221 19584,-1221 19584,-1138 19758,-1138 19758,-1221"/>
<text text-anchor="middle" x="19671" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU6</text>
<text text-anchor="middle" x="19671" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19671" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19671" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19671" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_6 -->
<g id="edge234" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19796.39,-1256.91C19780.15,-1247.02 19762.68,-1236.37 19746.08,-1226.25"/>
<polygon fill="black" stroke="black" points="19747.86,-1223.24 19737.5,-1221.02 19744.21,-1229.21 19747.86,-1223.24"/>
</g>
<!-- layer0_expert6_7 -->
<g id="node146" class="node">
<title>layer0_expert6_7</title>
<polygon fill="lightgreen" stroke="black" points="19950,-1221 19776,-1221 19776,-1138 19950,-1138 19950,-1221"/>
<text text-anchor="middle" x="19863" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU6</text>
<text text-anchor="middle" x="19863" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19863" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19863" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19863" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_7 -->
<g id="edge235" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19863,-1256.91C19863,-1248.65 19863,-1239.86 19863,-1231.3"/>
<polygon fill="black" stroke="black" points="19866.5,-1231.02 19863,-1221.02 19859.5,-1231.02 19866.5,-1231.02"/>
</g>
<!-- layer0_expert6_8 -->
<g id="node147" class="node">
<title>layer0_expert6_8</title>
<polygon fill="lightgreen" stroke="black" points="20142,-1221 19968,-1221 19968,-1138 20142,-1138 20142,-1221"/>
<text text-anchor="middle" x="20055" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU6</text>
<text text-anchor="middle" x="20055" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20055" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20055" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20055" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_8 -->
<g id="edge236" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19929.61,-1256.91C19945.85,-1247.02 19963.32,-1236.37 19979.92,-1226.25"/>
<polygon fill="black" stroke="black" points="19981.79,-1229.21 19988.5,-1221.02 19978.14,-1223.24 19981.79,-1229.21"/>
</g>
<!-- layer0_expert6_9 -->
<g id="node148" class="node">
<title>layer0_expert6_9</title>
<polygon fill="lightgreen" stroke="black" points="20334,-1221 20160,-1221 20160,-1138 20334,-1138 20334,-1221"/>
<text text-anchor="middle" x="20247" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU6</text>
<text text-anchor="middle" x="20247" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20247" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20247" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20247" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_9 -->
<g id="edge237" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.34,-1269.02C20034.34,-1256.63 20091.28,-1241.01 20150.33,-1221.12"/>
<polygon fill="black" stroke="black" points="20151.48,-1224.42 20159.82,-1217.89 20149.23,-1217.79 20151.48,-1224.42"/>
</g>
<!-- layer0_expert6_10 -->
<g id="node149" class="node">
<title>layer0_expert6_10</title>
<polygon fill="lightgreen" stroke="black" points="20526,-1221 20352,-1221 20352,-1138 20526,-1138 20526,-1221"/>
<text text-anchor="middle" x="20439" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU6</text>
<text text-anchor="middle" x="20439" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20439" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20439" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20439" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_10 -->
<g id="edge238" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.09,-1286.26C20080.68,-1275.56 20216.63,-1256.14 20342.16,-1221.05"/>
<polygon fill="black" stroke="black" points="20343.28,-1224.37 20351.94,-1218.28 20341.37,-1217.64 20343.28,-1224.37"/>
</g>
<!-- layer0_expert6_11 -->
<g id="node150" class="node">
<title>layer0_expert6_11</title>
<polygon fill="lightgreen" stroke="black" points="20718,-1221 20544,-1221 20544,-1138 20718,-1138 20718,-1221"/>
<text text-anchor="middle" x="20631" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU6</text>
<text text-anchor="middle" x="20631" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20631" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20631" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20631" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_11 -->
<g id="edge239" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.09,-1294.05C20118.97,-1287.91 20339.54,-1270.84 20534.16,-1221"/>
<polygon fill="black" stroke="black" points="20535.19,-1224.35 20543.99,-1218.45 20533.43,-1217.57 20535.19,-1224.35"/>
</g>
<!-- layer0_expert6_12 -->
<g id="node151" class="node">
<title>layer0_expert6_12</title>
<polygon fill="lightgreen" stroke="black" points="20910,-1221 20736,-1221 20736,-1138 20910,-1138 20910,-1221"/>
<text text-anchor="middle" x="20823" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU6</text>
<text text-anchor="middle" x="20823" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20823" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20823" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20823" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_12 -->
<g id="edge240" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.23,-1291.36C20184.75,-1280.58 20572.69,-1256.2 20726,-1220.96"/>
<polygon fill="black" stroke="black" points="20726.84,-1224.36 20735.75,-1218.63 20725.21,-1217.55 20726.84,-1224.36"/>
</g>
<!-- layer0_expert6_13 -->
<g id="node152" class="node">
<title>layer0_expert6_13</title>
<polygon fill="lightgreen" stroke="black" points="21102,-1221 20928,-1221 20928,-1138 21102,-1138 21102,-1221"/>
<text text-anchor="middle" x="21015" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU6</text>
<text text-anchor="middle" x="21015" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21015" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21015" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21015" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_13 -->
<g id="edge241" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.08,-1293.65C20219.72,-1285.46 20726.62,-1263.62 20917.81,-1220.99"/>
<polygon fill="black" stroke="black" points="20918.81,-1224.35 20927.77,-1218.69 20917.23,-1217.54 20918.81,-1224.35"/>
</g>
<!-- layer0_expert6_14 -->
<g id="node153" class="node">
<title>layer0_expert6_14</title>
<polygon fill="lightgreen" stroke="black" points="21294,-1221 21120,-1221 21120,-1138 21294,-1138 21294,-1221"/>
<text text-anchor="middle" x="21207" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU6</text>
<text text-anchor="middle" x="21207" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21207" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21207" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21207" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_14 -->
<g id="edge242" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.18,-1295.24C20252.05,-1289.47 20880.75,-1271.11 21109.83,-1220.99"/>
<polygon fill="black" stroke="black" points="21110.8,-1224.35 21119.78,-1218.73 21109.25,-1217.53 21110.8,-1224.35"/>
</g>
<!-- layer0_expert6_15 -->
<g id="node154" class="node">
<title>layer0_expert6_15</title>
<polygon fill="lightgreen" stroke="black" points="21486,-1221 21312,-1221 21312,-1138 21486,-1138 21486,-1221"/>
<text text-anchor="middle" x="21399" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU6</text>
<text text-anchor="middle" x="21399" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21399" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21399" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21399" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_15 -->
<g id="edge243" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.2,-1296.41C20281.79,-1292.92 21034.41,-1278.7 21301.71,-1221.01"/>
<polygon fill="black" stroke="black" points="21302.78,-1224.35 21311.78,-1218.76 21301.26,-1217.52 21302.78,-1224.35"/>
</g>
<!-- layer0_moe_agg_gpu6 -->
<g id="node155" class="node">
<title>layer0_moe_agg_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20060.5,-1102 19857.5,-1102 19857.5,-1034 20060.5,-1034 20060.5,-1102"/>
<text text-anchor="middle" x="19959" y="-1086.8" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU6</text>
<text text-anchor="middle" x="19959" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="19959" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="19959" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_expert6_0&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge244" class="edge">
<title>layer0_expert6_0&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18606.22,-1140.23C18609.16,-1139.42 18612.09,-1138.67 18615,-1138 18848.11,-1084.58 19567.88,-1072.47 19846.88,-1069.77"/>
<polygon fill="black" stroke="black" points="19847.06,-1073.27 19857.02,-1069.67 19846.99,-1066.27 19847.06,-1073.27"/>
</g>
<!-- layer0_expert6_1&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge245" class="edge">
<title>layer0_expert6_1&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18798.22,-1140.27C18801.16,-1139.44 18804.09,-1138.68 18807,-1138 19002.44,-1092.34 19597.55,-1075.89 19847.05,-1070.89"/>
<polygon fill="black" stroke="black" points="19847.3,-1074.39 19857.23,-1070.69 19847.16,-1067.39 19847.3,-1074.39"/>
</g>
<!-- layer0_expert6_2&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge246" class="edge">
<title>layer0_expert6_2&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18990.23,-1140.31C18993.17,-1139.47 18996.1,-1138.7 18999,-1138 19157.15,-1100.05 19629.85,-1079.92 19847.3,-1072.45"/>
<polygon fill="black" stroke="black" points="19847.59,-1075.94 19857.46,-1072.1 19847.35,-1068.95 19847.59,-1075.94"/>
</g>
<!-- layer0_expert6_3&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge247" class="edge">
<title>layer0_expert6_3&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19182.25,-1140.38C19185.18,-1139.52 19188.1,-1138.72 19191,-1138 19419.24,-1081.08 19695.98,-1069.79 19847.11,-1068.31"/>
<polygon fill="black" stroke="black" points="19847.36,-1071.81 19857.33,-1068.22 19847.3,-1064.81 19847.36,-1071.81"/>
</g>
<!-- layer0_expert6_4&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge248" class="edge">
<title>layer0_expert6_4&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19374.01,-1140.57C19377.03,-1139.65 19380.03,-1138.79 19383,-1138 19540.85,-1096.14 19729.82,-1079.63 19847.16,-1073.14"/>
<polygon fill="black" stroke="black" points="19847.44,-1076.63 19857.24,-1072.6 19847.07,-1069.64 19847.44,-1076.63"/>
</g>
<!-- layer0_expert6_5&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge249" class="edge">
<title>layer0_expert6_5&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19566.08,-1140.8C19569.07,-1139.81 19572.05,-1138.87 19575,-1138 19664.8,-1111.35 19769.64,-1093.36 19847.06,-1082.44"/>
<polygon fill="black" stroke="black" points="19847.9,-1085.86 19857.32,-1081.02 19846.93,-1078.93 19847.9,-1085.86"/>
</g>
<!-- layer0_expert6_6&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge250" class="edge">
<title>layer0_expert6_6&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19758.04,-1141.54C19761.06,-1140.33 19764.05,-1139.15 19767,-1138 19795.16,-1127.01 19825.89,-1115.68 19854.34,-1105.45"/>
<polygon fill="black" stroke="black" points="19855.66,-1108.7 19863.89,-1102.03 19853.3,-1102.11 19855.66,-1108.7"/>
</g>
<!-- layer0_expert6_7&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge251" class="edge">
<title>layer0_expert6_7&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19898.75,-1137.73C19906.66,-1128.7 19915.06,-1119.12 19922.98,-1110.08"/>
<polygon fill="black" stroke="black" points="19925.85,-1112.13 19929.81,-1102.3 19920.58,-1107.51 19925.85,-1112.13"/>
</g>
<!-- layer0_expert6_8&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge252" class="edge">
<title>layer0_expert6_8&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20019.25,-1137.73C20011.34,-1128.7 20002.94,-1119.12 19995.02,-1110.08"/>
<polygon fill="black" stroke="black" points="19997.42,-1107.51 19988.19,-1102.3 19992.15,-1112.13 19997.42,-1107.51"/>
</g>
<!-- layer0_expert6_9&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge253" class="edge">
<title>layer0_expert6_9&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20159.96,-1141.54C20156.94,-1140.33 20153.95,-1139.15 20151,-1138 20122.84,-1127.01 20092.11,-1115.68 20063.66,-1105.45"/>
<polygon fill="black" stroke="black" points="20064.7,-1102.11 20054.11,-1102.03 20062.34,-1108.7 20064.7,-1102.11"/>
</g>
<!-- layer0_expert6_10&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge254" class="edge">
<title>layer0_expert6_10&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20351.92,-1140.8C20348.93,-1139.81 20345.95,-1138.87 20343,-1138 20253.2,-1111.35 20148.36,-1093.36 20070.94,-1082.44"/>
<polygon fill="black" stroke="black" points="20071.07,-1078.93 20060.68,-1081.02 20070.1,-1085.86 20071.07,-1078.93"/>
</g>
<!-- layer0_expert6_11&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge255" class="edge">
<title>layer0_expert6_11&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20543.99,-1140.57C20540.97,-1139.65 20537.97,-1138.79 20535,-1138 20377.15,-1096.14 20188.18,-1079.63 20070.84,-1073.14"/>
<polygon fill="black" stroke="black" points="20070.93,-1069.64 20060.76,-1072.6 20070.56,-1076.63 20070.93,-1069.64"/>
</g>
<!-- layer0_expert6_12&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge256" class="edge">
<title>layer0_expert6_12&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20735.75,-1140.38C20732.82,-1139.52 20729.9,-1138.72 20727,-1138 20498.76,-1081.08 20222.02,-1069.79 20070.89,-1068.31"/>
<polygon fill="black" stroke="black" points="20070.7,-1064.81 20060.67,-1068.22 20070.64,-1071.81 20070.7,-1064.81"/>
</g>
<!-- layer0_expert6_13&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge257" class="edge">
<title>layer0_expert6_13&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20927.77,-1140.31C20924.83,-1139.47 20921.9,-1138.7 20919,-1138 20760.85,-1100.05 20288.15,-1079.92 20070.7,-1072.45"/>
<polygon fill="black" stroke="black" points="20070.65,-1068.95 20060.54,-1072.1 20070.41,-1075.94 20070.65,-1068.95"/>
</g>
<!-- layer0_expert6_14&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge258" class="edge">
<title>layer0_expert6_14&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M21119.78,-1140.27C21116.84,-1139.44 21113.91,-1138.68 21111,-1138 20915.56,-1092.34 20320.45,-1075.89 20070.95,-1070.89"/>
<polygon fill="black" stroke="black" points="20070.84,-1067.39 20060.77,-1070.69 20070.7,-1074.39 20070.84,-1067.39"/>
</g>
<!-- layer0_expert6_15&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge259" class="edge">
<title>layer0_expert6_15&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M21311.78,-1140.23C21308.84,-1139.42 21305.91,-1138.67 21303,-1138 21069.89,-1084.58 20350.12,-1072.47 20071.12,-1069.77"/>
<polygon fill="black" stroke="black" points="20071.01,-1066.27 20060.98,-1069.67 20070.94,-1073.27 20071.01,-1066.27"/>
</g>
<!-- layer0_output_gpu6 -->
<g id="node156" class="node">
<title>layer0_output_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20081,-949 19837,-949 19837,-881 20081,-881 20081,-949"/>
<text text-anchor="middle" x="19959" y="-933.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="19959" y="-918.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="19959" y="-903.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="19959" y="-888.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_moe_agg_gpu6&#45;&gt;layer0_output_gpu6 -->
<g id="edge260" class="edge">
<title>layer0_moe_agg_gpu6&#45;&gt;layer0_output_gpu6</title>
<path fill="none" stroke="black" d="M19959,-1033.86C19959,-1011.93 19959,-982.95 19959,-959.21"/>
<polygon fill="black" stroke="black" points="19962.5,-959.06 19959,-949.06 19955.5,-959.06 19962.5,-959.06"/>
</g>
<!-- layer0_attn_gpu7 -->
<g id="node158" class="node">
<title>layer0_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="19884.5,-1563 19641.5,-1563 19641.5,-1495 19884.5,-1495 19884.5,-1563"/>
<text text-anchor="middle" x="19763" y="-1547.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="19763" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="19763" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="19763" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_qkv_gpu7&#45;&gt;layer0_attn_gpu7 -->
<g id="edge261" class="edge">
<title>layer0_qkv_gpu7&#45;&gt;layer0_attn_gpu7</title>
<path fill="none" stroke="black" d="M18786.31,-1621.99C18985.4,-1603.24 19413.92,-1562.88 19631.08,-1542.42"/>
<polygon fill="black" stroke="black" points="19631.63,-1545.89 19641.26,-1541.47 19630.97,-1538.92 19631.63,-1545.89"/>
</g>
<!-- layer0_attn_norm_gpu7 -->
<g id="node159" class="node">
<title>layer0_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="20597,-1451.5 20353,-1451.5 20353,-1383.5 20597,-1383.5 20597,-1451.5"/>
<text text-anchor="middle" x="20475" y="-1436.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="20475" y="-1421.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="20475" y="-1406.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="20475" y="-1391.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_gpu7&#45;&gt;layer0_attn_norm_gpu7 -->
<g id="edge262" class="edge">
<title>layer0_attn_gpu7&#45;&gt;layer0_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M19884.59,-1509.3C20011.94,-1489.71 20211.34,-1459.05 20342.6,-1438.86"/>
<polygon fill="black" stroke="black" points="20343.37,-1442.28 20352.72,-1437.31 20342.31,-1435.37 20343.37,-1442.28"/>
</g>
<!-- layer0_gate_gpu7 -->
<g id="node160" class="node">
<title>layer0_gate_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23057,-1340 22813,-1340 22813,-1257 23057,-1257 23057,-1340"/>
<text text-anchor="middle" x="22935" y="-1324.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU7</text>
<text text-anchor="middle" x="22935" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="22935" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="22935" y="-1279.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="22935" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_norm_gpu7&#45;&gt;layer0_gate_gpu7 -->
<g id="edge263" class="edge">
<title>layer0_attn_norm_gpu7&#45;&gt;layer0_gate_gpu7</title>
<path fill="none" stroke="black" d="M20597.41,-1410.68C21013.6,-1390.88 22371.96,-1326.28 22802.7,-1305.79"/>
<polygon fill="black" stroke="black" points="22802.88,-1309.29 22812.7,-1305.32 22802.55,-1302.3 22802.88,-1309.29"/>
</g>
<!-- layer0_expert7_0 -->
<g id="node161" class="node">
<title>layer0_expert7_0</title>
<polygon fill="lightgreen" stroke="black" points="21678,-1221 21504,-1221 21504,-1138 21678,-1138 21678,-1221"/>
<text text-anchor="middle" x="21591" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU7</text>
<text text-anchor="middle" x="21591" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21591" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21591" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21591" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_0 -->
<g id="edge264" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.82,-1295.24C22545.95,-1289.47 21917.25,-1271.11 21688.17,-1220.99"/>
<polygon fill="black" stroke="black" points="21688.75,-1217.53 21678.22,-1218.73 21687.2,-1224.35 21688.75,-1217.53"/>
</g>
<!-- layer0_expert7_1 -->
<g id="node162" class="node">
<title>layer0_expert7_1</title>
<polygon fill="lightgreen" stroke="black" points="21870,-1221 21696,-1221 21696,-1138 21870,-1138 21870,-1221"/>
<text text-anchor="middle" x="21783" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU7</text>
<text text-anchor="middle" x="21783" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21783" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21783" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21783" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_1 -->
<g id="edge265" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.92,-1293.65C22578.28,-1285.46 22071.38,-1263.62 21880.19,-1220.99"/>
<polygon fill="black" stroke="black" points="21880.77,-1217.54 21870.23,-1218.69 21879.19,-1224.35 21880.77,-1217.54"/>
</g>
<!-- layer0_expert7_2 -->
<g id="node163" class="node">
<title>layer0_expert7_2</title>
<polygon fill="lightgreen" stroke="black" points="22062,-1221 21888,-1221 21888,-1138 22062,-1138 22062,-1221"/>
<text text-anchor="middle" x="21975" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU7</text>
<text text-anchor="middle" x="21975" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21975" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21975" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21975" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_2 -->
<g id="edge266" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.77,-1291.36C22613.25,-1280.58 22225.31,-1256.2 22072,-1220.96"/>
<polygon fill="black" stroke="black" points="22072.79,-1217.55 22062.25,-1218.63 22071.16,-1224.36 22072.79,-1217.55"/>
</g>
<!-- layer0_expert7_3 -->
<g id="node164" class="node">
<title>layer0_expert7_3</title>
<polygon fill="lightgreen" stroke="black" points="22254,-1221 22080,-1221 22080,-1138 22254,-1138 22254,-1221"/>
<text text-anchor="middle" x="22167" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU7</text>
<text text-anchor="middle" x="22167" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22167" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22167" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22167" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_3 -->
<g id="edge267" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.91,-1294.05C22679.03,-1287.91 22458.46,-1270.84 22263.84,-1221"/>
<polygon fill="black" stroke="black" points="22264.57,-1217.57 22254.01,-1218.45 22262.81,-1224.35 22264.57,-1217.57"/>
</g>
<!-- layer0_expert7_4 -->
<g id="node165" class="node">
<title>layer0_expert7_4</title>
<polygon fill="lightgreen" stroke="black" points="22446,-1221 22272,-1221 22272,-1138 22446,-1138 22446,-1221"/>
<text text-anchor="middle" x="22359" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU7</text>
<text text-anchor="middle" x="22359" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22359" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22359" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22359" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_4 -->
<g id="edge268" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.91,-1286.26C22717.32,-1275.56 22581.37,-1256.14 22455.84,-1221.05"/>
<polygon fill="black" stroke="black" points="22456.63,-1217.64 22446.06,-1218.28 22454.72,-1224.37 22456.63,-1217.64"/>
</g>
<!-- layer0_expert7_5 -->
<g id="node166" class="node">
<title>layer0_expert7_5</title>
<polygon fill="lightgreen" stroke="black" points="22638,-1221 22464,-1221 22464,-1138 22638,-1138 22638,-1221"/>
<text text-anchor="middle" x="22551" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU7</text>
<text text-anchor="middle" x="22551" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22551" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22551" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22551" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_5 -->
<g id="edge269" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.66,-1269.02C22763.66,-1256.63 22706.72,-1241.01 22647.67,-1221.12"/>
<polygon fill="black" stroke="black" points="22648.77,-1217.79 22638.18,-1217.89 22646.52,-1224.42 22648.77,-1217.79"/>
</g>
<!-- layer0_expert7_6 -->
<g id="node167" class="node">
<title>layer0_expert7_6</title>
<polygon fill="lightgreen" stroke="black" points="22830,-1221 22656,-1221 22656,-1138 22830,-1138 22830,-1221"/>
<text text-anchor="middle" x="22743" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU7</text>
<text text-anchor="middle" x="22743" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22743" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22743" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22743" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_6 -->
<g id="edge270" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22868.39,-1256.91C22852.15,-1247.02 22834.68,-1236.37 22818.08,-1226.25"/>
<polygon fill="black" stroke="black" points="22819.86,-1223.24 22809.5,-1221.02 22816.21,-1229.21 22819.86,-1223.24"/>
</g>
<!-- layer0_expert7_7 -->
<g id="node168" class="node">
<title>layer0_expert7_7</title>
<polygon fill="lightgreen" stroke="black" points="23022,-1221 22848,-1221 22848,-1138 23022,-1138 23022,-1221"/>
<text text-anchor="middle" x="22935" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU7</text>
<text text-anchor="middle" x="22935" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22935" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22935" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22935" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_7 -->
<g id="edge271" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22935,-1256.91C22935,-1248.65 22935,-1239.86 22935,-1231.3"/>
<polygon fill="black" stroke="black" points="22938.5,-1231.02 22935,-1221.02 22931.5,-1231.02 22938.5,-1231.02"/>
</g>
<!-- layer0_expert7_8 -->
<g id="node169" class="node">
<title>layer0_expert7_8</title>
<polygon fill="lightgreen" stroke="black" points="23214,-1221 23040,-1221 23040,-1138 23214,-1138 23214,-1221"/>
<text text-anchor="middle" x="23127" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU7</text>
<text text-anchor="middle" x="23127" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23127" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23127" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23127" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_8 -->
<g id="edge272" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23001.61,-1256.91C23017.85,-1247.02 23035.32,-1236.37 23051.92,-1226.25"/>
<polygon fill="black" stroke="black" points="23053.79,-1229.21 23060.5,-1221.02 23050.14,-1223.24 23053.79,-1229.21"/>
</g>
<!-- layer0_expert7_9 -->
<g id="node170" class="node">
<title>layer0_expert7_9</title>
<polygon fill="lightgreen" stroke="black" points="23406,-1221 23232,-1221 23232,-1138 23406,-1138 23406,-1221"/>
<text text-anchor="middle" x="23319" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU7</text>
<text text-anchor="middle" x="23319" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23319" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23319" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23319" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_9 -->
<g id="edge273" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.29,-1259.38C23060.22,-1258.57 23063.13,-1257.77 23066,-1257 23132.16,-1239.21 23153.09,-1242.65 23222.25,-1221.08"/>
<polygon fill="black" stroke="black" points="23223.4,-1224.39 23231.87,-1218.02 23221.28,-1217.71 23223.4,-1224.39"/>
</g>
<!-- layer0_expert7_10 -->
<g id="node171" class="node">
<title>layer0_expert7_10</title>
<polygon fill="lightgreen" stroke="black" points="23598,-1221 23424,-1221 23424,-1138 23598,-1138 23598,-1221"/>
<text text-anchor="middle" x="23511" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU7</text>
<text text-anchor="middle" x="23511" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23511" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23511" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23511" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_10 -->
<g id="edge274" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.18,-1258.9C23060.14,-1258.23 23063.08,-1257.6 23066,-1257 23215.5,-1226.49 23261.96,-1258.3 23413.59,-1221.12"/>
<polygon fill="black" stroke="black" points="23414.89,-1224.4 23423.74,-1218.57 23413.18,-1217.61 23414.89,-1224.4"/>
</g>
<!-- layer0_expert7_11 -->
<g id="node172" class="node">
<title>layer0_expert7_11</title>
<polygon fill="lightgreen" stroke="black" points="23790,-1221 23616,-1221 23616,-1138 23790,-1138 23790,-1221"/>
<text text-anchor="middle" x="23703" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU7</text>
<text text-anchor="middle" x="23703" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23703" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23703" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23703" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_11 -->
<g id="edge275" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.15,-1258.75C23060.12,-1258.13 23063.07,-1257.54 23066,-1257 23299.71,-1213.71 23370.59,-1274.89 23605.89,-1221.02"/>
<polygon fill="black" stroke="black" points="23606.83,-1224.39 23615.77,-1218.71 23605.24,-1217.57 23606.83,-1224.39"/>
</g>
<!-- layer0_expert7_12 -->
<g id="node173" class="node">
<title>layer0_expert7_12</title>
<polygon fill="lightgreen" stroke="black" points="23982,-1221 23808,-1221 23808,-1138 23982,-1138 23982,-1221"/>
<text text-anchor="middle" x="23895" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU7</text>
<text text-anchor="middle" x="23895" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23895" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23895" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23895" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_12 -->
<g id="edge276" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.14,-1258.68C23060.11,-1258.08 23063.07,-1257.52 23066,-1257 23383.93,-1200.97 23479.04,-1291.61 23797.81,-1221.02"/>
<polygon fill="black" stroke="black" points="23798.8,-1224.39 23807.79,-1218.77 23797.26,-1217.56 23798.8,-1224.39"/>
</g>
<!-- layer0_expert7_13 -->
<g id="node174" class="node">
<title>layer0_expert7_13</title>
<polygon fill="lightgreen" stroke="black" points="24174,-1221 24000,-1221 24000,-1138 24174,-1138 24174,-1221"/>
<text text-anchor="middle" x="24087" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU7</text>
<text text-anchor="middle" x="24087" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24087" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24087" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24087" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_13 -->
<g id="edge277" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.13,-1258.64C23060.11,-1258.05 23063.07,-1257.5 23066,-1257 23468.27,-1188.21 23587.49,-1308.44 23989.93,-1220.99"/>
<polygon fill="black" stroke="black" points="23990.78,-1224.38 23999.79,-1218.81 23989.28,-1217.55 23990.78,-1224.38"/>
</g>
<!-- layer0_expert7_14 -->
<g id="node175" class="node">
<title>layer0_expert7_14</title>
<polygon fill="lightgreen" stroke="black" points="24366,-1221 24192,-1221 24192,-1138 24366,-1138 24366,-1221"/>
<text text-anchor="middle" x="24279" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU7</text>
<text text-anchor="middle" x="24279" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24279" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24279" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24279" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_14 -->
<g id="edge278" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.13,-1258.62C23060.1,-1258.03 23063.07,-1257.49 23066,-1257 23307.71,-1216.5 23923.87,-1272.64 24181.66,-1220.97"/>
<polygon fill="black" stroke="black" points="24182.73,-1224.32 24191.8,-1218.84 24181.29,-1217.47 24182.73,-1224.32"/>
</g>
<!-- layer0_expert7_15 -->
<g id="node176" class="node">
<title>layer0_expert7_15</title>
<polygon fill="lightgreen" stroke="black" points="24558,-1221 24384,-1221 24384,-1138 24558,-1138 24558,-1221"/>
<text text-anchor="middle" x="24471" y="-1205.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU7</text>
<text text-anchor="middle" x="24471" y="-1190.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24471" y="-1175.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24471" y="-1160.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24471" y="-1145.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_15 -->
<g id="edge279" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.13,-1258.6C23060.1,-1258.02 23063.06,-1257.48 23066,-1257 23349.89,-1210.12 24074.09,-1280.99 24373.76,-1220.95"/>
<polygon fill="black" stroke="black" points="24374.73,-1224.33 24383.8,-1218.86 24373.3,-1217.47 24374.73,-1224.33"/>
</g>
<!-- layer0_moe_agg_gpu7 -->
<g id="node177" class="node">
<title>layer0_moe_agg_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23132.5,-1102 22929.5,-1102 22929.5,-1034 23132.5,-1034 23132.5,-1102"/>
<text text-anchor="middle" x="23031" y="-1086.8" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU7</text>
<text text-anchor="middle" x="23031" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="23031" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="23031" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_expert7_0&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge280" class="edge">
<title>layer0_expert7_0&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21678.22,-1140.23C21681.16,-1139.42 21684.09,-1138.67 21687,-1138 21920.11,-1084.58 22639.88,-1072.47 22918.88,-1069.77"/>
<polygon fill="black" stroke="black" points="22919.06,-1073.27 22929.02,-1069.67 22918.99,-1066.27 22919.06,-1073.27"/>
</g>
<!-- layer0_expert7_1&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge281" class="edge">
<title>layer0_expert7_1&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21870.22,-1140.27C21873.16,-1139.44 21876.09,-1138.68 21879,-1138 22074.44,-1092.34 22669.55,-1075.89 22919.05,-1070.89"/>
<polygon fill="black" stroke="black" points="22919.3,-1074.39 22929.23,-1070.69 22919.16,-1067.39 22919.3,-1074.39"/>
</g>
<!-- layer0_expert7_2&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge282" class="edge">
<title>layer0_expert7_2&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22062.23,-1140.31C22065.17,-1139.47 22068.1,-1138.7 22071,-1138 22229.15,-1100.05 22701.85,-1079.92 22919.3,-1072.45"/>
<polygon fill="black" stroke="black" points="22919.59,-1075.94 22929.46,-1072.1 22919.35,-1068.95 22919.59,-1075.94"/>
</g>
<!-- layer0_expert7_3&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge283" class="edge">
<title>layer0_expert7_3&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22254.25,-1140.38C22257.18,-1139.52 22260.1,-1138.72 22263,-1138 22491.24,-1081.08 22767.98,-1069.79 22919.11,-1068.31"/>
<polygon fill="black" stroke="black" points="22919.36,-1071.81 22929.33,-1068.22 22919.3,-1064.81 22919.36,-1071.81"/>
</g>
<!-- layer0_expert7_4&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge284" class="edge">
<title>layer0_expert7_4&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22446.01,-1140.57C22449.03,-1139.65 22452.03,-1138.79 22455,-1138 22612.85,-1096.14 22801.82,-1079.63 22919.16,-1073.14"/>
<polygon fill="black" stroke="black" points="22919.44,-1076.63 22929.24,-1072.6 22919.07,-1069.64 22919.44,-1076.63"/>
</g>
<!-- layer0_expert7_5&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge285" class="edge">
<title>layer0_expert7_5&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22638.08,-1140.8C22641.07,-1139.81 22644.05,-1138.87 22647,-1138 22736.8,-1111.35 22841.64,-1093.36 22919.06,-1082.44"/>
<polygon fill="black" stroke="black" points="22919.9,-1085.86 22929.32,-1081.02 22918.93,-1078.93 22919.9,-1085.86"/>
</g>
<!-- layer0_expert7_6&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge286" class="edge">
<title>layer0_expert7_6&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22830.04,-1141.54C22833.06,-1140.33 22836.05,-1139.15 22839,-1138 22867.16,-1127.01 22897.89,-1115.68 22926.34,-1105.45"/>
<polygon fill="black" stroke="black" points="22927.66,-1108.7 22935.89,-1102.03 22925.3,-1102.11 22927.66,-1108.7"/>
</g>
<!-- layer0_expert7_7&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge287" class="edge">
<title>layer0_expert7_7&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22970.75,-1137.73C22978.66,-1128.7 22987.06,-1119.12 22994.98,-1110.08"/>
<polygon fill="black" stroke="black" points="22997.85,-1112.13 23001.81,-1102.3 22992.58,-1107.51 22997.85,-1112.13"/>
</g>
<!-- layer0_expert7_8&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge288" class="edge">
<title>layer0_expert7_8&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23091.25,-1137.73C23083.34,-1128.7 23074.94,-1119.12 23067.02,-1110.08"/>
<polygon fill="black" stroke="black" points="23069.42,-1107.51 23060.19,-1102.3 23064.15,-1112.13 23069.42,-1107.51"/>
</g>
<!-- layer0_expert7_9&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge289" class="edge">
<title>layer0_expert7_9&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23231.96,-1141.54C23228.94,-1140.33 23225.95,-1139.15 23223,-1138 23194.84,-1127.01 23164.11,-1115.68 23135.66,-1105.45"/>
<polygon fill="black" stroke="black" points="23136.7,-1102.11 23126.11,-1102.03 23134.34,-1108.7 23136.7,-1102.11"/>
</g>
<!-- layer0_expert7_10&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge290" class="edge">
<title>layer0_expert7_10&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23423.92,-1140.8C23420.93,-1139.81 23417.95,-1138.87 23415,-1138 23325.2,-1111.35 23220.36,-1093.36 23142.94,-1082.44"/>
<polygon fill="black" stroke="black" points="23143.07,-1078.93 23132.68,-1081.02 23142.1,-1085.86 23143.07,-1078.93"/>
</g>
<!-- layer0_expert7_11&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge291" class="edge">
<title>layer0_expert7_11&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23615.99,-1140.57C23612.97,-1139.65 23609.97,-1138.79 23607,-1138 23449.15,-1096.14 23260.18,-1079.63 23142.84,-1073.14"/>
<polygon fill="black" stroke="black" points="23142.93,-1069.64 23132.76,-1072.6 23142.56,-1076.63 23142.93,-1069.64"/>
</g>
<!-- layer0_expert7_12&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge292" class="edge">
<title>layer0_expert7_12&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23807.75,-1140.38C23804.82,-1139.52 23801.9,-1138.72 23799,-1138 23570.76,-1081.08 23294.02,-1069.79 23142.89,-1068.31"/>
<polygon fill="black" stroke="black" points="23142.7,-1064.81 23132.67,-1068.22 23142.64,-1071.81 23142.7,-1064.81"/>
</g>
<!-- layer0_expert7_13&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge293" class="edge">
<title>layer0_expert7_13&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23999.77,-1140.31C23996.83,-1139.47 23993.9,-1138.7 23991,-1138 23832.85,-1100.05 23360.15,-1079.92 23142.7,-1072.45"/>
<polygon fill="black" stroke="black" points="23142.65,-1068.95 23132.54,-1072.1 23142.41,-1075.94 23142.65,-1068.95"/>
</g>
<!-- layer0_expert7_14&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge294" class="edge">
<title>layer0_expert7_14&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24191.78,-1140.27C24188.84,-1139.44 24185.91,-1138.68 24183,-1138 23987.56,-1092.34 23392.45,-1075.89 23142.95,-1070.89"/>
<polygon fill="black" stroke="black" points="23142.84,-1067.39 23132.77,-1070.69 23142.7,-1074.39 23142.84,-1067.39"/>
</g>
<!-- layer0_expert7_15&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge295" class="edge">
<title>layer0_expert7_15&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24383.78,-1140.23C24380.84,-1139.42 24377.91,-1138.67 24375,-1138 24141.89,-1084.58 23422.12,-1072.47 23143.12,-1069.77"/>
<polygon fill="black" stroke="black" points="23143.01,-1066.27 23132.98,-1069.67 23142.94,-1073.27 23143.01,-1066.27"/>
</g>
<!-- layer0_output_gpu7 -->
<g id="node178" class="node">
<title>layer0_output_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23153,-949 22909,-949 22909,-881 23153,-881 23153,-949"/>
<text text-anchor="middle" x="23031" y="-933.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="23031" y="-918.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="23031" y="-903.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="23031" y="-888.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_moe_agg_gpu7&#45;&gt;layer0_output_gpu7 -->
<g id="edge296" class="edge">
<title>layer0_moe_agg_gpu7&#45;&gt;layer0_output_gpu7</title>
<path fill="none" stroke="black" d="M23031,-1033.86C23031,-1011.93 23031,-982.95 23031,-959.21"/>
<polygon fill="black" stroke="black" points="23034.5,-959.06 23031,-949.06 23027.5,-959.06 23034.5,-959.06"/>
</g>
<!-- layer1_qkv_gpu0 -->
<g id="node179" class="node">
<title>layer1_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="24708,-1778.48 24496,-1778.48 24496,-1710.48 24708,-1710.48 24708,-1778.48"/>
<text text-anchor="middle" x="24602" y="-1763.28" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="24602" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="24602" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="24602" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_gpu0 -->
<g id="node180" class="node">
<title>layer1_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="24723.5,-1667 24480.5,-1667 24480.5,-1599 24723.5,-1599 24723.5,-1667"/>
<text text-anchor="middle" x="24602" y="-1651.8" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="24602" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="24602" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="24602" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_qkv_gpu0&#45;&gt;layer1_attn_gpu0 -->
<g id="edge297" class="edge">
<title>layer1_qkv_gpu0&#45;&gt;layer1_attn_gpu0</title>
<path fill="none" stroke="black" d="M24602,-1710.33C24602,-1699.94 24602,-1688.3 24602,-1677.31"/>
<polygon fill="black" stroke="black" points="24605.5,-1677.03 24602,-1667.03 24598.5,-1677.03 24605.5,-1677.03"/>
</g>
<!-- layer1_attn_norm_gpu0 -->
<g id="node181" class="node">
<title>layer1_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="24724,-1563 24480,-1563 24480,-1495 24724,-1495 24724,-1563"/>
<text text-anchor="middle" x="24602" y="-1547.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="24602" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="24602" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="24602" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_gpu0&#45;&gt;layer1_attn_norm_gpu0 -->
<g id="edge298" class="edge">
<title>layer1_attn_gpu0&#45;&gt;layer1_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M24602,-1598.88C24602,-1590.78 24602,-1581.98 24602,-1573.47"/>
<polygon fill="black" stroke="black" points="24605.5,-1573.3 24602,-1563.3 24598.5,-1573.3 24605.5,-1573.3"/>
</g>
<!-- layer1_gate_gpu0 -->
<g id="node182" class="node">
<title>layer1_gate_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="24724,-1459 24480,-1459 24480,-1376 24724,-1376 24724,-1459"/>
<text text-anchor="middle" x="24602" y="-1443.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU0</text>
<text text-anchor="middle" x="24602" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="24602" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="24602" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="24602" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_norm_gpu0&#45;&gt;layer1_gate_gpu0 -->
<g id="edge299" class="edge">
<title>layer1_attn_norm_gpu0&#45;&gt;layer1_gate_gpu0</title>
<path fill="none" stroke="black" d="M24602,-1494.85C24602,-1486.8 24602,-1478 24602,-1469.34"/>
<polygon fill="black" stroke="black" points="24605.5,-1469.28 24602,-1459.28 24598.5,-1469.28 24605.5,-1469.28"/>
</g>
<!-- layer1_expert0_0 -->
<g id="node183" class="node">
<title>layer1_expert0_0</title>
<polygon fill="lightgreen" stroke="black" points="23249,-1340 23075,-1340 23075,-1257 23249,-1257 23249,-1340"/>
<text text-anchor="middle" x="23162" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU0</text>
<text text-anchor="middle" x="23162" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23162" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23162" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23162" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_0 -->
<g id="edge300" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24479.85,-1414.87C24197.89,-1410.26 23507.51,-1393.9 23259.29,-1340.01"/>
<polygon fill="black" stroke="black" points="23259.75,-1336.52 23249.22,-1337.75 23258.21,-1343.35 23259.75,-1336.52"/>
</g>
<!-- layer1_expert0_1 -->
<g id="node184" class="node">
<title>layer1_expert0_1</title>
<polygon fill="lightgreen" stroke="black" points="23441,-1340 23267,-1340 23267,-1257 23441,-1257 23441,-1340"/>
<text text-anchor="middle" x="23354" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU0</text>
<text text-anchor="middle" x="23354" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23354" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23354" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23354" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_1 -->
<g id="edge301" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24479.68,-1413.51C24228.53,-1406.54 23661.38,-1386.35 23451.26,-1340.01"/>
<polygon fill="black" stroke="black" points="23451.76,-1336.53 23441.23,-1337.71 23450.2,-1343.35 23451.76,-1336.53"/>
</g>
<!-- layer1_expert0_2 -->
<g id="node185" class="node">
<title>layer1_expert0_2</title>
<polygon fill="lightgreen" stroke="black" points="23633,-1340 23459,-1340 23459,-1257 23633,-1257 23633,-1340"/>
<text text-anchor="middle" x="23546" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU0</text>
<text text-anchor="middle" x="23546" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23546" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23546" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23546" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_2 -->
<g id="edge302" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24479.94,-1411.63C24262.49,-1402.15 23815.52,-1378.91 23643.21,-1340"/>
<polygon fill="black" stroke="black" points="23643.78,-1336.54 23633.24,-1337.66 23642.17,-1343.36 23643.78,-1336.54"/>
</g>
<!-- layer1_expert0_3 -->
<g id="node186" class="node">
<title>layer1_expert0_3</title>
<polygon fill="lightgreen" stroke="black" points="23825,-1340 23651,-1340 23651,-1257 23825,-1257 23825,-1340"/>
<text text-anchor="middle" x="23738" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU0</text>
<text text-anchor="middle" x="23738" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23738" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23738" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23738" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_3 -->
<g id="edge303" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24479.67,-1415.54C24328.64,-1411.85 24064.63,-1397.19 23835.13,-1340.07"/>
<polygon fill="black" stroke="black" points="23835.81,-1336.63 23825.26,-1337.58 23834.1,-1343.42 23835.81,-1336.63"/>
</g>
<!-- layer1_expert0_4 -->
<g id="node187" class="node">
<title>layer1_expert0_4</title>
<polygon fill="lightgreen" stroke="black" points="24017,-1340 23843,-1340 23843,-1257 24017,-1257 24017,-1340"/>
<text text-anchor="middle" x="23930" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU0</text>
<text text-anchor="middle" x="23930" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23930" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23930" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23930" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_4 -->
<g id="edge304" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24479.89,-1409.76C24364.42,-1401.23 24186.78,-1382.5 24027.04,-1340.07"/>
<polygon fill="black" stroke="black" points="24027.59,-1336.6 24017.03,-1337.38 24025.77,-1343.36 24027.59,-1336.6"/>
</g>
<!-- layer1_expert0_5 -->
<g id="node188" class="node">
<title>layer1_expert0_5</title>
<polygon fill="lightgreen" stroke="black" points="24209,-1340 24035,-1340 24035,-1257 24209,-1257 24209,-1340"/>
<text text-anchor="middle" x="24122" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU0</text>
<text text-anchor="middle" x="24122" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24122" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24122" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24122" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_5 -->
<g id="edge305" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24479.8,-1398.65C24406.17,-1386.36 24310.72,-1367.72 24218.84,-1340.09"/>
<polygon fill="black" stroke="black" points="24219.69,-1336.69 24209.1,-1337.13 24217.65,-1343.39 24219.69,-1336.69"/>
</g>
<!-- layer1_expert0_6 -->
<g id="node189" class="node">
<title>layer1_expert0_6</title>
<polygon fill="lightgreen" stroke="black" points="24401,-1340 24227,-1340 24227,-1257 24401,-1257 24401,-1340"/>
<text text-anchor="middle" x="24314" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU0</text>
<text text-anchor="middle" x="24314" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24314" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24314" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24314" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_6 -->
<g id="edge306" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24499.21,-1375.99C24472.79,-1365.46 24444.27,-1354.01 24410.69,-1340.27"/>
<polygon fill="black" stroke="black" points="24411.67,-1336.88 24401.09,-1336.33 24409.01,-1343.36 24411.67,-1336.88"/>
</g>
<!-- layer1_expert0_7 -->
<g id="node190" class="node">
<title>layer1_expert0_7</title>
<polygon fill="lightgreen" stroke="black" points="24593,-1340 24419,-1340 24419,-1257 24593,-1257 24593,-1340"/>
<text text-anchor="middle" x="24506" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU0</text>
<text text-anchor="middle" x="24506" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24506" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24506" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24506" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_7 -->
<g id="edge307" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24568.69,-1375.91C24561.25,-1366.83 24553.28,-1357.12 24545.61,-1347.77"/>
<polygon fill="black" stroke="black" points="24548.3,-1345.53 24539.25,-1340.02 24542.89,-1349.97 24548.3,-1345.53"/>
</g>
<!-- layer1_expert0_8 -->
<g id="node191" class="node">
<title>layer1_expert0_8</title>
<polygon fill="lightgreen" stroke="black" points="24785,-1340 24611,-1340 24611,-1257 24785,-1257 24785,-1340"/>
<text text-anchor="middle" x="24698" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU0</text>
<text text-anchor="middle" x="24698" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24698" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24698" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24698" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_8 -->
<g id="edge308" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24635.31,-1375.91C24642.75,-1366.83 24650.72,-1357.12 24658.39,-1347.77"/>
<polygon fill="black" stroke="black" points="24661.11,-1349.97 24664.75,-1340.02 24655.7,-1345.53 24661.11,-1349.97"/>
</g>
<!-- layer1_expert0_9 -->
<g id="node192" class="node">
<title>layer1_expert0_9</title>
<polygon fill="lightgreen" stroke="black" points="24977,-1340 24803,-1340 24803,-1257 24977,-1257 24977,-1340"/>
<text text-anchor="middle" x="24890" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU0</text>
<text text-anchor="middle" x="24890" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24890" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24890" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24890" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_9 -->
<g id="edge309" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24704.79,-1375.99C24731.21,-1365.46 24759.73,-1354.01 24793.31,-1340.27"/>
<polygon fill="black" stroke="black" points="24794.99,-1343.36 24802.91,-1336.33 24792.33,-1336.88 24794.99,-1343.36"/>
</g>
<!-- layer1_expert0_10 -->
<g id="node193" class="node">
<title>layer1_expert0_10</title>
<polygon fill="lightgreen" stroke="black" points="25169,-1340 24995,-1340 24995,-1257 25169,-1257 25169,-1340"/>
<text text-anchor="middle" x="25082" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU0</text>
<text text-anchor="middle" x="25082" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="25082" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="25082" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="25082" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_10 -->
<g id="edge310" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24724.2,-1398.65C24797.83,-1386.36 24893.28,-1367.72 24985.16,-1340.09"/>
<polygon fill="black" stroke="black" points="24986.35,-1343.39 24994.9,-1337.13 24984.31,-1336.69 24986.35,-1343.39"/>
</g>
<!-- layer1_expert0_11 -->
<g id="node194" class="node">
<title>layer1_expert0_11</title>
<polygon fill="lightgreen" stroke="black" points="25361,-1340 25187,-1340 25187,-1257 25361,-1257 25361,-1340"/>
<text text-anchor="middle" x="25274" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU0</text>
<text text-anchor="middle" x="25274" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="25274" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="25274" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="25274" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_11 -->
<g id="edge311" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24724.11,-1409.76C24839.58,-1401.23 25017.22,-1382.5 25176.96,-1340.07"/>
<polygon fill="black" stroke="black" points="25178.23,-1343.36 25186.97,-1337.38 25176.41,-1336.6 25178.23,-1343.36"/>
</g>
<!-- layer1_expert0_12 -->
<g id="node195" class="node">
<title>layer1_expert0_12</title>
<polygon fill="lightgreen" stroke="black" points="25553,-1340 25379,-1340 25379,-1257 25553,-1257 25553,-1340"/>
<text text-anchor="middle" x="25466" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU0</text>
<text text-anchor="middle" x="25466" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="25466" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="25466" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="25466" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_12 -->
<g id="edge312" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24724.33,-1415.54C24875.36,-1411.85 25139.37,-1397.19 25368.87,-1340.07"/>
<polygon fill="black" stroke="black" points="25369.9,-1343.42 25378.74,-1337.58 25368.19,-1336.63 25369.9,-1343.42"/>
</g>
<!-- layer1_expert0_13 -->
<g id="node196" class="node">
<title>layer1_expert0_13</title>
<polygon fill="lightgreen" stroke="black" points="25745,-1340 25571,-1340 25571,-1257 25745,-1257 25745,-1340"/>
<text text-anchor="middle" x="25658" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU0</text>
<text text-anchor="middle" x="25658" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="25658" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="25658" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="25658" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_13 -->
<g id="edge313" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24724.06,-1411.63C24941.51,-1402.15 25388.48,-1378.91 25560.79,-1340"/>
<polygon fill="black" stroke="black" points="25561.83,-1343.36 25570.76,-1337.66 25560.22,-1336.54 25561.83,-1343.36"/>
</g>
<!-- layer1_expert0_14 -->
<g id="node197" class="node">
<title>layer1_expert0_14</title>
<polygon fill="lightgreen" stroke="black" points="25937,-1340 25763,-1340 25763,-1257 25937,-1257 25937,-1340"/>
<text text-anchor="middle" x="25850" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU0</text>
<text text-anchor="middle" x="25850" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="25850" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="25850" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="25850" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_14 -->
<g id="edge314" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24724.32,-1413.51C24975.47,-1406.54 25542.62,-1386.35 25752.74,-1340.01"/>
<polygon fill="black" stroke="black" points="25753.8,-1343.35 25762.77,-1337.71 25752.24,-1336.53 25753.8,-1343.35"/>
</g>
<!-- layer1_expert0_15 -->
<g id="node198" class="node">
<title>layer1_expert0_15</title>
<polygon fill="lightgreen" stroke="black" points="26129,-1340 25955,-1340 25955,-1257 26129,-1257 26129,-1340"/>
<text text-anchor="middle" x="26042" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU0</text>
<text text-anchor="middle" x="26042" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26042" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26042" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26042" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_15 -->
<g id="edge315" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24724.15,-1414.87C25006.11,-1410.26 25696.49,-1393.9 25944.71,-1340.01"/>
<polygon fill="black" stroke="black" points="25945.79,-1343.35 25954.78,-1337.75 25944.25,-1336.52 25945.79,-1343.35"/>
</g>
<!-- layer1_moe_agg_gpu0 -->
<g id="node199" class="node">
<title>layer1_moe_agg_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="24799.5,-1213.5 24596.5,-1213.5 24596.5,-1145.5 24799.5,-1145.5 24799.5,-1213.5"/>
<text text-anchor="middle" x="24698" y="-1198.3" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU0</text>
<text text-anchor="middle" x="24698" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="24698" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="24698" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_expert0_0&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge316" class="edge">
<title>layer1_expert0_0&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M23249.2,-1259.14C23252.14,-1258.35 23255.08,-1257.63 23258,-1257 23542.4,-1195.38 24279.89,-1268.41 24567,-1221 24575.1,-1219.66 24583.4,-1217.95 24591.69,-1215.99"/>
<polygon fill="black" stroke="black" points="24592.55,-1219.38 24601.42,-1213.58 24590.87,-1212.59 24592.55,-1219.38"/>
</g>
<!-- layer1_expert0_1&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge317" class="edge">
<title>layer1_expert0_1&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M23441.2,-1259.16C23444.15,-1258.36 23447.08,-1257.64 23450,-1257 23692.59,-1203.84 24322.06,-1262.04 24567,-1221 24575.1,-1219.64 24583.4,-1217.92 24591.69,-1215.94"/>
<polygon fill="black" stroke="black" points="24592.55,-1219.34 24601.41,-1213.52 24590.86,-1212.54 24592.55,-1219.34"/>
</g>
<!-- layer1_expert0_2&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge318" class="edge">
<title>layer1_expert0_2&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M23633.21,-1259.19C23636.15,-1258.38 23639.09,-1257.65 23642,-1257 24043.59,-1167.59 24161.46,-1290.35 24567,-1221 24574.92,-1219.64 24583.04,-1217.94 24591.15,-1216.01"/>
<polygon fill="black" stroke="black" points="24592.18,-1219.36 24601.04,-1213.54 24590.49,-1212.57 24592.18,-1219.36"/>
</g>
<!-- layer1_expert0_3&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge319" class="edge">
<title>layer1_expert0_3&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M23825.21,-1259.23C23828.16,-1258.41 23831.09,-1257.66 23834,-1257 24152.01,-1184.5 24245.78,-1277.61 24567,-1221 24574.83,-1219.62 24582.85,-1217.91 24590.88,-1215.98"/>
<polygon fill="black" stroke="black" points="24591.81,-1219.35 24600.66,-1213.52 24590.11,-1212.56 24591.81,-1219.35"/>
</g>
<!-- layer1_expert0_4&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge320" class="edge">
<title>layer1_expert0_4&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24017.23,-1259.29C24020.17,-1258.46 24023.1,-1257.69 24026,-1257 24260.47,-1201.4 24330.05,-1264.89 24567,-1221 24574.57,-1219.6 24582.32,-1217.9 24590.08,-1216.01"/>
<polygon fill="black" stroke="black" points="24591.07,-1219.37 24599.91,-1213.52 24589.35,-1212.59 24591.07,-1219.37"/>
</g>
<!-- layer1_expert0_5&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge321" class="edge">
<title>layer1_expert0_5&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24209.26,-1259.43C24212.19,-1258.56 24215.11,-1257.74 24218,-1257 24369.05,-1218.27 24414.21,-1252.18 24567,-1221 24574.06,-1219.56 24581.27,-1217.89 24588.52,-1216.08"/>
<polygon fill="black" stroke="black" points="24589.59,-1219.41 24598.39,-1213.51 24587.83,-1212.64 24589.59,-1219.41"/>
</g>
<!-- layer1_expert0_6&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge322" class="edge">
<title>layer1_expert0_6&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24401.13,-1259.98C24404.11,-1258.94 24407.07,-1257.94 24410,-1257 24478.13,-1235 24497.87,-1239.59 24567,-1221 24573.41,-1219.28 24579.98,-1217.45 24586.59,-1215.56"/>
<polygon fill="black" stroke="black" points="24587.67,-1218.89 24596.31,-1212.75 24585.73,-1212.17 24587.67,-1218.89"/>
</g>
<!-- layer1_expert0_7&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge323" class="edge">
<title>layer1_expert0_7&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24572.61,-1256.91C24592.8,-1244.6 24614.91,-1231.13 24634.87,-1218.97"/>
<polygon fill="black" stroke="black" points="24636.85,-1221.86 24643.57,-1213.67 24633.21,-1215.88 24636.85,-1221.86"/>
</g>
<!-- layer1_expert0_8&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge324" class="edge">
<title>layer1_expert0_8&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24698,-1256.91C24698,-1246.2 24698,-1234.62 24698,-1223.78"/>
<polygon fill="black" stroke="black" points="24701.5,-1223.67 24698,-1213.67 24694.5,-1223.67 24701.5,-1223.67"/>
</g>
<!-- layer1_expert0_9&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge325" class="edge">
<title>layer1_expert0_9&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24823.39,-1256.91C24803.2,-1244.6 24781.09,-1231.13 24761.13,-1218.97"/>
<polygon fill="black" stroke="black" points="24762.79,-1215.88 24752.43,-1213.67 24759.15,-1221.86 24762.79,-1215.88"/>
</g>
<!-- layer1_expert0_10&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge326" class="edge">
<title>layer1_expert0_10&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24994.82,-1260.11C24991.86,-1259.04 24988.91,-1257.99 24986,-1257 24928.63,-1237.38 24863.42,-1219.7 24809.58,-1206.28"/>
<polygon fill="black" stroke="black" points="24810.21,-1202.83 24799.66,-1203.83 24808.53,-1209.63 24810.21,-1202.83"/>
</g>
<!-- layer1_expert0_11&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge327" class="edge">
<title>layer1_expert0_11&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M25186.94,-1259.72C25183.94,-1258.76 25180.96,-1257.85 25178,-1257 25054.46,-1221.66 24908.07,-1201.29 24809.71,-1190.59"/>
<polygon fill="black" stroke="black" points="24810.06,-1187.11 24799.75,-1189.53 24809.32,-1194.07 24810.06,-1187.11"/>
</g>
<!-- layer1_expert0_12&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge328" class="edge">
<title>layer1_expert0_12&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M25378.99,-1259.55C25375.98,-1258.63 25372.97,-1257.78 25370,-1257 25177.24,-1206.49 24944.74,-1189.33 24809.89,-1183.5"/>
<polygon fill="black" stroke="black" points="24809.69,-1179.99 24799.55,-1183.07 24809.4,-1186.98 24809.69,-1179.99"/>
</g>
<!-- layer1_expert0_13&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge329" class="edge">
<title>layer1_expert0_13&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M25570.75,-1259.37C25567.82,-1258.52 25564.9,-1257.72 25562,-1257 25422.49,-1222.3 25010.48,-1196.81 24810.04,-1186.09"/>
<polygon fill="black" stroke="black" points="24809.96,-1182.58 24799.78,-1185.54 24809.58,-1189.57 24809.96,-1182.58"/>
</g>
<!-- layer1_expert0_14&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge330" class="edge">
<title>layer1_expert0_14&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M25762.77,-1259.31C25759.83,-1258.47 25756.9,-1257.7 25754,-1257 25577.34,-1214.56 25043.81,-1192.05 24809.92,-1183.99"/>
<polygon fill="black" stroke="black" points="24809.8,-1180.49 24799.69,-1183.64 24809.56,-1187.48 24809.8,-1180.49"/>
</g>
<!-- layer1_expert0_15&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge331" class="edge">
<title>layer1_expert0_15&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M25954.78,-1259.27C25951.84,-1258.44 25948.91,-1257.68 25946,-1257 25731.73,-1206.78 25073.94,-1188.12 24809.65,-1182.53"/>
<polygon fill="black" stroke="black" points="24809.72,-1179.03 24799.65,-1182.32 24809.58,-1186.03 24809.72,-1179.03"/>
</g>
<!-- layer1_output_gpu0 -->
<g id="node200" class="node">
<title>layer1_output_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="26225,-1102 25981,-1102 25981,-1034 26225,-1034 26225,-1102"/>
<text text-anchor="middle" x="26103" y="-1086.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="26103" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="26103" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="26103" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_moe_agg_gpu0&#45;&gt;layer1_output_gpu0 -->
<g id="edge332" class="edge">
<title>layer1_moe_agg_gpu0&#45;&gt;layer1_output_gpu0</title>
<path fill="none" stroke="black" d="M24799.61,-1170.58C25049.14,-1151.13 25691.95,-1101.04 25970.74,-1079.31"/>
<polygon fill="black" stroke="black" points="25971.21,-1082.78 25980.91,-1078.52 25970.67,-1075.8 25971.21,-1082.78"/>
</g>
<!-- pipeline_stage0_1 -->
<g id="node708" class="node">
<title>pipeline_stage0_1</title>
<polygon fill="yellow" stroke="black" points="35313.73,-998 34961.01,-998 34870.27,-832 35222.99,-832 35313.73,-998"/>
<text text-anchor="middle" x="35092" y="-941.3" font-family="Times,serif" font-size="14.00">Pipeline_Stage0_to_1</text>
<text text-anchor="middle" x="35092" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="35092" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="35092" y="-896.3" font-family="Times,serif" font-size="14.00">Cross&#45;stage communication</text>
<text text-anchor="middle" x="35092" y="-881.3" font-family="Times,serif" font-size="14.00">GPU: 7 &#45;&gt; 8</text>
</g>
<!-- layer1_output_gpu0&#45;&gt;pipeline_stage0_1 -->
<g id="edge585" class="edge">
<title>layer1_output_gpu0&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M26225.38,-1064.94C27201.8,-1048.54 33721.81,-939.02 34907.27,-919.1"/>
<polygon fill="black" stroke="black" points="34907.64,-922.6 34917.58,-918.93 34907.52,-915.6 34907.64,-922.6"/>
</g>
<!-- layer1_qkv_gpu1 -->
<g id="node201" class="node">
<title>layer1_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="27780,-1778.48 27568,-1778.48 27568,-1710.48 27780,-1710.48 27780,-1778.48"/>
<text text-anchor="middle" x="27674" y="-1763.28" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="27674" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="27674" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="27674" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_gpu1 -->
<g id="node202" class="node">
<title>layer1_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="27795.5,-1667 27552.5,-1667 27552.5,-1599 27795.5,-1599 27795.5,-1667"/>
<text text-anchor="middle" x="27674" y="-1651.8" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="27674" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="27674" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="27674" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_qkv_gpu1&#45;&gt;layer1_attn_gpu1 -->
<g id="edge333" class="edge">
<title>layer1_qkv_gpu1&#45;&gt;layer1_attn_gpu1</title>
<path fill="none" stroke="black" d="M27674,-1710.33C27674,-1699.94 27674,-1688.3 27674,-1677.31"/>
<polygon fill="black" stroke="black" points="27677.5,-1677.03 27674,-1667.03 27670.5,-1677.03 27677.5,-1677.03"/>
</g>
<!-- layer1_attn_norm_gpu1 -->
<g id="node203" class="node">
<title>layer1_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="27796,-1563 27552,-1563 27552,-1495 27796,-1495 27796,-1563"/>
<text text-anchor="middle" x="27674" y="-1547.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="27674" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="27674" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="27674" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_gpu1&#45;&gt;layer1_attn_norm_gpu1 -->
<g id="edge334" class="edge">
<title>layer1_attn_gpu1&#45;&gt;layer1_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M27674,-1598.88C27674,-1590.78 27674,-1581.98 27674,-1573.47"/>
<polygon fill="black" stroke="black" points="27677.5,-1573.3 27674,-1563.3 27670.5,-1573.3 27677.5,-1573.3"/>
</g>
<!-- layer1_gate_gpu1 -->
<g id="node204" class="node">
<title>layer1_gate_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="27796,-1459 27552,-1459 27552,-1376 27796,-1376 27796,-1459"/>
<text text-anchor="middle" x="27674" y="-1443.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU1</text>
<text text-anchor="middle" x="27674" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="27674" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="27674" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="27674" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_norm_gpu1&#45;&gt;layer1_gate_gpu1 -->
<g id="edge335" class="edge">
<title>layer1_attn_norm_gpu1&#45;&gt;layer1_gate_gpu1</title>
<path fill="none" stroke="black" d="M27674,-1494.85C27674,-1486.8 27674,-1478 27674,-1469.34"/>
<polygon fill="black" stroke="black" points="27677.5,-1469.28 27674,-1459.28 27670.5,-1469.28 27677.5,-1469.28"/>
</g>
<!-- layer1_expert1_0 -->
<g id="node205" class="node">
<title>layer1_expert1_0</title>
<polygon fill="lightgreen" stroke="black" points="26321,-1340 26147,-1340 26147,-1257 26321,-1257 26321,-1340"/>
<text text-anchor="middle" x="26234" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU1</text>
<text text-anchor="middle" x="26234" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26234" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26234" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26234" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_0 -->
<g id="edge336" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27551.85,-1414.87C27269.89,-1410.26 26579.51,-1393.9 26331.29,-1340.01"/>
<polygon fill="black" stroke="black" points="26331.75,-1336.52 26321.22,-1337.75 26330.21,-1343.35 26331.75,-1336.52"/>
</g>
<!-- layer1_expert1_1 -->
<g id="node206" class="node">
<title>layer1_expert1_1</title>
<polygon fill="lightgreen" stroke="black" points="26513,-1340 26339,-1340 26339,-1257 26513,-1257 26513,-1340"/>
<text text-anchor="middle" x="26426" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU1</text>
<text text-anchor="middle" x="26426" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26426" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26426" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26426" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_1 -->
<g id="edge337" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27551.68,-1413.51C27300.53,-1406.54 26733.38,-1386.35 26523.26,-1340.01"/>
<polygon fill="black" stroke="black" points="26523.76,-1336.53 26513.23,-1337.71 26522.2,-1343.35 26523.76,-1336.53"/>
</g>
<!-- layer1_expert1_2 -->
<g id="node207" class="node">
<title>layer1_expert1_2</title>
<polygon fill="lightgreen" stroke="black" points="26705,-1340 26531,-1340 26531,-1257 26705,-1257 26705,-1340"/>
<text text-anchor="middle" x="26618" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU1</text>
<text text-anchor="middle" x="26618" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26618" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26618" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26618" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_2 -->
<g id="edge338" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27551.94,-1411.63C27334.49,-1402.15 26887.52,-1378.91 26715.21,-1340"/>
<polygon fill="black" stroke="black" points="26715.78,-1336.54 26705.24,-1337.66 26714.17,-1343.36 26715.78,-1336.54"/>
</g>
<!-- layer1_expert1_3 -->
<g id="node208" class="node">
<title>layer1_expert1_3</title>
<polygon fill="lightgreen" stroke="black" points="26897,-1340 26723,-1340 26723,-1257 26897,-1257 26897,-1340"/>
<text text-anchor="middle" x="26810" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU1</text>
<text text-anchor="middle" x="26810" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26810" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26810" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26810" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_3 -->
<g id="edge339" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27551.67,-1415.54C27400.64,-1411.85 27136.63,-1397.19 26907.13,-1340.07"/>
<polygon fill="black" stroke="black" points="26907.81,-1336.63 26897.26,-1337.58 26906.1,-1343.42 26907.81,-1336.63"/>
</g>
<!-- layer1_expert1_4 -->
<g id="node209" class="node">
<title>layer1_expert1_4</title>
<polygon fill="lightgreen" stroke="black" points="27089,-1340 26915,-1340 26915,-1257 27089,-1257 27089,-1340"/>
<text text-anchor="middle" x="27002" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU1</text>
<text text-anchor="middle" x="27002" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27002" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27002" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27002" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_4 -->
<g id="edge340" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27551.89,-1409.76C27436.42,-1401.23 27258.78,-1382.5 27099.04,-1340.07"/>
<polygon fill="black" stroke="black" points="27099.59,-1336.6 27089.03,-1337.38 27097.77,-1343.36 27099.59,-1336.6"/>
</g>
<!-- layer1_expert1_5 -->
<g id="node210" class="node">
<title>layer1_expert1_5</title>
<polygon fill="lightgreen" stroke="black" points="27281,-1340 27107,-1340 27107,-1257 27281,-1257 27281,-1340"/>
<text text-anchor="middle" x="27194" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU1</text>
<text text-anchor="middle" x="27194" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27194" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27194" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27194" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_5 -->
<g id="edge341" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27551.8,-1398.65C27478.17,-1386.36 27382.72,-1367.72 27290.84,-1340.09"/>
<polygon fill="black" stroke="black" points="27291.69,-1336.69 27281.1,-1337.13 27289.65,-1343.39 27291.69,-1336.69"/>
</g>
<!-- layer1_expert1_6 -->
<g id="node211" class="node">
<title>layer1_expert1_6</title>
<polygon fill="lightgreen" stroke="black" points="27473,-1340 27299,-1340 27299,-1257 27473,-1257 27473,-1340"/>
<text text-anchor="middle" x="27386" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU1</text>
<text text-anchor="middle" x="27386" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27386" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27386" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27386" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_6 -->
<g id="edge342" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27571.21,-1375.99C27544.79,-1365.46 27516.27,-1354.01 27482.69,-1340.27"/>
<polygon fill="black" stroke="black" points="27483.67,-1336.88 27473.09,-1336.33 27481.01,-1343.36 27483.67,-1336.88"/>
</g>
<!-- layer1_expert1_7 -->
<g id="node212" class="node">
<title>layer1_expert1_7</title>
<polygon fill="lightgreen" stroke="black" points="27665,-1340 27491,-1340 27491,-1257 27665,-1257 27665,-1340"/>
<text text-anchor="middle" x="27578" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU1</text>
<text text-anchor="middle" x="27578" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27578" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27578" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27578" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_7 -->
<g id="edge343" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27640.69,-1375.91C27633.25,-1366.83 27625.28,-1357.12 27617.61,-1347.77"/>
<polygon fill="black" stroke="black" points="27620.3,-1345.53 27611.25,-1340.02 27614.89,-1349.97 27620.3,-1345.53"/>
</g>
<!-- layer1_expert1_8 -->
<g id="node213" class="node">
<title>layer1_expert1_8</title>
<polygon fill="lightgreen" stroke="black" points="27857,-1340 27683,-1340 27683,-1257 27857,-1257 27857,-1340"/>
<text text-anchor="middle" x="27770" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU1</text>
<text text-anchor="middle" x="27770" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27770" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27770" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27770" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_8 -->
<g id="edge344" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27707.31,-1375.91C27714.75,-1366.83 27722.72,-1357.12 27730.39,-1347.77"/>
<polygon fill="black" stroke="black" points="27733.11,-1349.97 27736.75,-1340.02 27727.7,-1345.53 27733.11,-1349.97"/>
</g>
<!-- layer1_expert1_9 -->
<g id="node214" class="node">
<title>layer1_expert1_9</title>
<polygon fill="lightgreen" stroke="black" points="28049,-1340 27875,-1340 27875,-1257 28049,-1257 28049,-1340"/>
<text text-anchor="middle" x="27962" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU1</text>
<text text-anchor="middle" x="27962" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27962" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27962" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27962" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_9 -->
<g id="edge345" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27776.79,-1375.99C27803.21,-1365.46 27831.73,-1354.01 27865.31,-1340.27"/>
<polygon fill="black" stroke="black" points="27866.99,-1343.36 27874.91,-1336.33 27864.33,-1336.88 27866.99,-1343.36"/>
</g>
<!-- layer1_expert1_10 -->
<g id="node215" class="node">
<title>layer1_expert1_10</title>
<polygon fill="lightgreen" stroke="black" points="28241,-1340 28067,-1340 28067,-1257 28241,-1257 28241,-1340"/>
<text text-anchor="middle" x="28154" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU1</text>
<text text-anchor="middle" x="28154" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="28154" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="28154" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="28154" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_10 -->
<g id="edge346" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27796.2,-1398.65C27869.83,-1386.36 27965.28,-1367.72 28057.16,-1340.09"/>
<polygon fill="black" stroke="black" points="28058.35,-1343.39 28066.9,-1337.13 28056.31,-1336.69 28058.35,-1343.39"/>
</g>
<!-- layer1_expert1_11 -->
<g id="node216" class="node">
<title>layer1_expert1_11</title>
<polygon fill="lightgreen" stroke="black" points="28433,-1340 28259,-1340 28259,-1257 28433,-1257 28433,-1340"/>
<text text-anchor="middle" x="28346" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU1</text>
<text text-anchor="middle" x="28346" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="28346" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="28346" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="28346" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_11 -->
<g id="edge347" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27796.11,-1409.76C27911.58,-1401.23 28089.22,-1382.5 28248.96,-1340.07"/>
<polygon fill="black" stroke="black" points="28250.23,-1343.36 28258.97,-1337.38 28248.41,-1336.6 28250.23,-1343.36"/>
</g>
<!-- layer1_expert1_12 -->
<g id="node217" class="node">
<title>layer1_expert1_12</title>
<polygon fill="lightgreen" stroke="black" points="28625,-1340 28451,-1340 28451,-1257 28625,-1257 28625,-1340"/>
<text text-anchor="middle" x="28538" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU1</text>
<text text-anchor="middle" x="28538" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="28538" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="28538" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="28538" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_12 -->
<g id="edge348" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27796.33,-1415.54C27947.36,-1411.85 28211.37,-1397.19 28440.87,-1340.07"/>
<polygon fill="black" stroke="black" points="28441.9,-1343.42 28450.74,-1337.58 28440.19,-1336.63 28441.9,-1343.42"/>
</g>
<!-- layer1_expert1_13 -->
<g id="node218" class="node">
<title>layer1_expert1_13</title>
<polygon fill="lightgreen" stroke="black" points="28817,-1340 28643,-1340 28643,-1257 28817,-1257 28817,-1340"/>
<text text-anchor="middle" x="28730" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU1</text>
<text text-anchor="middle" x="28730" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="28730" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="28730" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="28730" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_13 -->
<g id="edge349" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27796.06,-1411.63C28013.51,-1402.15 28460.48,-1378.91 28632.79,-1340"/>
<polygon fill="black" stroke="black" points="28633.83,-1343.36 28642.76,-1337.66 28632.22,-1336.54 28633.83,-1343.36"/>
</g>
<!-- layer1_expert1_14 -->
<g id="node219" class="node">
<title>layer1_expert1_14</title>
<polygon fill="lightgreen" stroke="black" points="29009,-1340 28835,-1340 28835,-1257 29009,-1257 29009,-1340"/>
<text text-anchor="middle" x="28922" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU1</text>
<text text-anchor="middle" x="28922" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="28922" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="28922" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="28922" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_14 -->
<g id="edge350" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27796.32,-1413.51C28047.47,-1406.54 28614.62,-1386.35 28824.74,-1340.01"/>
<polygon fill="black" stroke="black" points="28825.8,-1343.35 28834.77,-1337.71 28824.24,-1336.53 28825.8,-1343.35"/>
</g>
<!-- layer1_expert1_15 -->
<g id="node220" class="node">
<title>layer1_expert1_15</title>
<polygon fill="lightgreen" stroke="black" points="29201,-1340 29027,-1340 29027,-1257 29201,-1257 29201,-1340"/>
<text text-anchor="middle" x="29114" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU1</text>
<text text-anchor="middle" x="29114" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="29114" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="29114" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="29114" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_15 -->
<g id="edge351" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27796.15,-1414.87C28078.11,-1410.26 28768.49,-1393.9 29016.71,-1340.01"/>
<polygon fill="black" stroke="black" points="29017.79,-1343.35 29026.78,-1337.75 29016.25,-1336.52 29017.79,-1343.35"/>
</g>
<!-- layer1_moe_agg_gpu1 -->
<g id="node221" class="node">
<title>layer1_moe_agg_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="27871.5,-1213.5 27668.5,-1213.5 27668.5,-1145.5 27871.5,-1145.5 27871.5,-1213.5"/>
<text text-anchor="middle" x="27770" y="-1198.3" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU1</text>
<text text-anchor="middle" x="27770" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="27770" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="27770" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_expert1_0&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge352" class="edge">
<title>layer1_expert1_0&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26321.22,-1259.24C26324.16,-1258.42 26327.09,-1257.67 26330,-1257 26582.04,-1199.01 27365.23,-1184.79 27658.04,-1181.47"/>
<polygon fill="black" stroke="black" points="27658.29,-1184.97 27668.25,-1181.35 27658.21,-1177.97 27658.29,-1184.97"/>
</g>
<!-- layer1_expert1_1&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge353" class="edge">
<title>layer1_expert1_1&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26513.22,-1259.27C26516.16,-1258.44 26519.09,-1257.68 26522,-1257 26736.27,-1206.78 27394.06,-1188.12 27658.35,-1182.53"/>
<polygon fill="black" stroke="black" points="27658.42,-1186.03 27668.35,-1182.32 27658.28,-1179.03 27658.42,-1186.03"/>
</g>
<!-- layer1_expert1_2&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge354" class="edge">
<title>layer1_expert1_2&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26705.23,-1259.31C26708.17,-1258.47 26711.1,-1257.7 26714,-1257 26890.66,-1214.56 27424.19,-1192.05 27658.08,-1183.99"/>
<polygon fill="black" stroke="black" points="27658.44,-1187.48 27668.31,-1183.64 27658.2,-1180.49 27658.44,-1187.48"/>
</g>
<!-- layer1_expert1_3&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge355" class="edge">
<title>layer1_expert1_3&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26897.25,-1259.37C26900.18,-1258.52 26903.1,-1257.72 26906,-1257 27045.51,-1222.3 27457.52,-1196.81 27657.96,-1186.09"/>
<polygon fill="black" stroke="black" points="27658.42,-1189.57 27668.22,-1185.54 27658.04,-1182.58 27658.42,-1189.57"/>
</g>
<!-- layer1_expert1_4&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge356" class="edge">
<title>layer1_expert1_4&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M27089.01,-1259.55C27092.02,-1258.63 27095.03,-1257.78 27098,-1257 27290.76,-1206.49 27523.26,-1189.33 27658.11,-1183.5"/>
<polygon fill="black" stroke="black" points="27658.6,-1186.98 27668.45,-1183.07 27658.31,-1179.99 27658.6,-1186.98"/>
</g>
<!-- layer1_expert1_5&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge357" class="edge">
<title>layer1_expert1_5&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M27281.06,-1259.72C27284.06,-1258.76 27287.04,-1257.85 27290,-1257 27413.54,-1221.66 27559.93,-1201.29 27658.29,-1190.59"/>
<polygon fill="black" stroke="black" points="27658.68,-1194.07 27668.25,-1189.53 27657.94,-1187.11 27658.68,-1194.07"/>
</g>
<!-- layer1_expert1_6&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge358" class="edge">
<title>layer1_expert1_6&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M27473.18,-1260.11C27476.14,-1259.04 27479.09,-1257.99 27482,-1257 27539.37,-1237.38 27604.58,-1219.7 27658.42,-1206.28"/>
<polygon fill="black" stroke="black" points="27659.47,-1209.63 27668.34,-1203.83 27657.79,-1202.83 27659.47,-1209.63"/>
</g>
<!-- layer1_expert1_7&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge359" class="edge">
<title>layer1_expert1_7&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M27644.61,-1256.91C27664.8,-1244.6 27686.91,-1231.13 27706.87,-1218.97"/>
<polygon fill="black" stroke="black" points="27708.85,-1221.86 27715.57,-1213.67 27705.21,-1215.88 27708.85,-1221.86"/>
</g>
<!-- layer1_expert1_8&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge360" class="edge">
<title>layer1_expert1_8&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M27770,-1256.91C27770,-1246.2 27770,-1234.62 27770,-1223.78"/>
<polygon fill="black" stroke="black" points="27773.5,-1223.67 27770,-1213.67 27766.5,-1223.67 27773.5,-1223.67"/>
</g>
<!-- layer1_expert1_9&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge361" class="edge">
<title>layer1_expert1_9&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M27895.39,-1256.91C27875.2,-1244.6 27853.09,-1231.13 27833.13,-1218.97"/>
<polygon fill="black" stroke="black" points="27834.79,-1215.88 27824.43,-1213.67 27831.15,-1221.86 27834.79,-1215.88"/>
</g>
<!-- layer1_expert1_10&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge362" class="edge">
<title>layer1_expert1_10&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M28066.82,-1260.11C28063.86,-1259.04 28060.91,-1257.99 28058,-1257 28000.63,-1237.38 27935.42,-1219.7 27881.58,-1206.28"/>
<polygon fill="black" stroke="black" points="27882.21,-1202.83 27871.66,-1203.83 27880.53,-1209.63 27882.21,-1202.83"/>
</g>
<!-- layer1_expert1_11&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge363" class="edge">
<title>layer1_expert1_11&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M28258.94,-1259.72C28255.94,-1258.76 28252.96,-1257.85 28250,-1257 28126.46,-1221.66 27980.07,-1201.29 27881.71,-1190.59"/>
<polygon fill="black" stroke="black" points="27882.06,-1187.11 27871.75,-1189.53 27881.32,-1194.07 27882.06,-1187.11"/>
</g>
<!-- layer1_expert1_12&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge364" class="edge">
<title>layer1_expert1_12&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M28450.99,-1259.55C28447.98,-1258.63 28444.97,-1257.78 28442,-1257 28249.24,-1206.49 28016.74,-1189.33 27881.89,-1183.5"/>
<polygon fill="black" stroke="black" points="27881.69,-1179.99 27871.55,-1183.07 27881.4,-1186.98 27881.69,-1179.99"/>
</g>
<!-- layer1_expert1_13&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge365" class="edge">
<title>layer1_expert1_13&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M28642.75,-1259.37C28639.82,-1258.52 28636.9,-1257.72 28634,-1257 28494.49,-1222.3 28082.48,-1196.81 27882.04,-1186.09"/>
<polygon fill="black" stroke="black" points="27881.96,-1182.58 27871.78,-1185.54 27881.58,-1189.57 27881.96,-1182.58"/>
</g>
<!-- layer1_expert1_14&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge366" class="edge">
<title>layer1_expert1_14&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M28834.77,-1259.31C28831.83,-1258.47 28828.9,-1257.7 28826,-1257 28649.34,-1214.56 28115.81,-1192.05 27881.92,-1183.99"/>
<polygon fill="black" stroke="black" points="27881.8,-1180.49 27871.69,-1183.64 27881.56,-1187.48 27881.8,-1180.49"/>
</g>
<!-- layer1_expert1_15&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge367" class="edge">
<title>layer1_expert1_15&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M29026.78,-1259.27C29023.84,-1258.44 29020.91,-1257.68 29018,-1257 28803.73,-1206.78 28145.94,-1188.12 27881.65,-1182.53"/>
<polygon fill="black" stroke="black" points="27881.72,-1179.03 27871.65,-1182.32 27881.58,-1186.03 27881.72,-1179.03"/>
</g>
<!-- layer1_output_gpu1 -->
<g id="node222" class="node">
<title>layer1_output_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="29297,-1102 29053,-1102 29053,-1034 29297,-1034 29297,-1102"/>
<text text-anchor="middle" x="29175" y="-1086.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="29175" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="29175" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="29175" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_moe_agg_gpu1&#45;&gt;layer1_output_gpu1 -->
<g id="edge368" class="edge">
<title>layer1_moe_agg_gpu1&#45;&gt;layer1_output_gpu1</title>
<path fill="none" stroke="black" d="M27871.61,-1170.58C28121.14,-1151.13 28763.95,-1101.04 29042.74,-1079.31"/>
<polygon fill="black" stroke="black" points="29043.21,-1082.78 29052.91,-1078.52 29042.67,-1075.8 29043.21,-1082.78"/>
</g>
<!-- layer1_output_gpu1&#45;&gt;pipeline_stage0_1 -->
<g id="edge586" class="edge">
<title>layer1_output_gpu1&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M29297.23,-1063.88C30045.38,-1044.79 34004.23,-943.76 34908.13,-920.69"/>
<polygon fill="black" stroke="black" points="34908.39,-924.19 34918.3,-920.43 34908.21,-917.19 34908.39,-924.19"/>
</g>
<!-- layer1_qkv_gpu2 -->
<g id="node223" class="node">
<title>layer1_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="30852,-1778.48 30640,-1778.48 30640,-1710.48 30852,-1710.48 30852,-1778.48"/>
<text text-anchor="middle" x="30746" y="-1763.28" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="30746" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="30746" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="30746" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_gpu2 -->
<g id="node224" class="node">
<title>layer1_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="30867.5,-1667 30624.5,-1667 30624.5,-1599 30867.5,-1599 30867.5,-1667"/>
<text text-anchor="middle" x="30746" y="-1651.8" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="30746" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="30746" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="30746" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_qkv_gpu2&#45;&gt;layer1_attn_gpu2 -->
<g id="edge369" class="edge">
<title>layer1_qkv_gpu2&#45;&gt;layer1_attn_gpu2</title>
<path fill="none" stroke="black" d="M30746,-1710.33C30746,-1699.94 30746,-1688.3 30746,-1677.31"/>
<polygon fill="black" stroke="black" points="30749.5,-1677.03 30746,-1667.03 30742.5,-1677.03 30749.5,-1677.03"/>
</g>
<!-- layer1_attn_norm_gpu2 -->
<g id="node225" class="node">
<title>layer1_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="30868,-1563 30624,-1563 30624,-1495 30868,-1495 30868,-1563"/>
<text text-anchor="middle" x="30746" y="-1547.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="30746" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="30746" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="30746" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_gpu2&#45;&gt;layer1_attn_norm_gpu2 -->
<g id="edge370" class="edge">
<title>layer1_attn_gpu2&#45;&gt;layer1_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M30746,-1598.88C30746,-1590.78 30746,-1581.98 30746,-1573.47"/>
<polygon fill="black" stroke="black" points="30749.5,-1573.3 30746,-1563.3 30742.5,-1573.3 30749.5,-1573.3"/>
</g>
<!-- layer1_gate_gpu2 -->
<g id="node226" class="node">
<title>layer1_gate_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="30868,-1459 30624,-1459 30624,-1376 30868,-1376 30868,-1459"/>
<text text-anchor="middle" x="30746" y="-1443.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU2</text>
<text text-anchor="middle" x="30746" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="30746" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="30746" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="30746" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_norm_gpu2&#45;&gt;layer1_gate_gpu2 -->
<g id="edge371" class="edge">
<title>layer1_attn_norm_gpu2&#45;&gt;layer1_gate_gpu2</title>
<path fill="none" stroke="black" d="M30746,-1494.85C30746,-1486.8 30746,-1478 30746,-1469.34"/>
<polygon fill="black" stroke="black" points="30749.5,-1469.28 30746,-1459.28 30742.5,-1469.28 30749.5,-1469.28"/>
</g>
<!-- layer1_expert2_0 -->
<g id="node227" class="node">
<title>layer1_expert2_0</title>
<polygon fill="lightgreen" stroke="black" points="29393,-1340 29219,-1340 29219,-1257 29393,-1257 29393,-1340"/>
<text text-anchor="middle" x="29306" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU2</text>
<text text-anchor="middle" x="29306" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="29306" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="29306" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="29306" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_0 -->
<g id="edge372" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30623.85,-1414.87C30341.89,-1410.26 29651.51,-1393.9 29403.29,-1340.01"/>
<polygon fill="black" stroke="black" points="29403.75,-1336.52 29393.22,-1337.75 29402.21,-1343.35 29403.75,-1336.52"/>
</g>
<!-- layer1_expert2_1 -->
<g id="node228" class="node">
<title>layer1_expert2_1</title>
<polygon fill="lightgreen" stroke="black" points="29585,-1340 29411,-1340 29411,-1257 29585,-1257 29585,-1340"/>
<text text-anchor="middle" x="29498" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU2</text>
<text text-anchor="middle" x="29498" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="29498" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="29498" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="29498" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_1 -->
<g id="edge373" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30623.68,-1413.51C30372.53,-1406.54 29805.38,-1386.35 29595.26,-1340.01"/>
<polygon fill="black" stroke="black" points="29595.76,-1336.53 29585.23,-1337.71 29594.2,-1343.35 29595.76,-1336.53"/>
</g>
<!-- layer1_expert2_2 -->
<g id="node229" class="node">
<title>layer1_expert2_2</title>
<polygon fill="lightgreen" stroke="black" points="29777,-1340 29603,-1340 29603,-1257 29777,-1257 29777,-1340"/>
<text text-anchor="middle" x="29690" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU2</text>
<text text-anchor="middle" x="29690" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="29690" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="29690" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="29690" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_2 -->
<g id="edge374" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30623.94,-1411.63C30406.49,-1402.15 29959.52,-1378.91 29787.21,-1340"/>
<polygon fill="black" stroke="black" points="29787.78,-1336.54 29777.24,-1337.66 29786.17,-1343.36 29787.78,-1336.54"/>
</g>
<!-- layer1_expert2_3 -->
<g id="node230" class="node">
<title>layer1_expert2_3</title>
<polygon fill="lightgreen" stroke="black" points="29969,-1340 29795,-1340 29795,-1257 29969,-1257 29969,-1340"/>
<text text-anchor="middle" x="29882" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU2</text>
<text text-anchor="middle" x="29882" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="29882" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="29882" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="29882" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_3 -->
<g id="edge375" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30623.67,-1415.54C30472.64,-1411.85 30208.63,-1397.19 29979.13,-1340.07"/>
<polygon fill="black" stroke="black" points="29979.81,-1336.63 29969.26,-1337.58 29978.1,-1343.42 29979.81,-1336.63"/>
</g>
<!-- layer1_expert2_4 -->
<g id="node231" class="node">
<title>layer1_expert2_4</title>
<polygon fill="lightgreen" stroke="black" points="30161,-1340 29987,-1340 29987,-1257 30161,-1257 30161,-1340"/>
<text text-anchor="middle" x="30074" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU2</text>
<text text-anchor="middle" x="30074" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="30074" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="30074" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="30074" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_4 -->
<g id="edge376" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30623.89,-1409.76C30508.42,-1401.23 30330.78,-1382.5 30171.04,-1340.07"/>
<polygon fill="black" stroke="black" points="30171.59,-1336.6 30161.03,-1337.38 30169.77,-1343.36 30171.59,-1336.6"/>
</g>
<!-- layer1_expert2_5 -->
<g id="node232" class="node">
<title>layer1_expert2_5</title>
<polygon fill="lightgreen" stroke="black" points="30353,-1340 30179,-1340 30179,-1257 30353,-1257 30353,-1340"/>
<text text-anchor="middle" x="30266" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU2</text>
<text text-anchor="middle" x="30266" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="30266" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="30266" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="30266" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_5 -->
<g id="edge377" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30623.8,-1398.65C30550.17,-1386.36 30454.72,-1367.72 30362.84,-1340.09"/>
<polygon fill="black" stroke="black" points="30363.69,-1336.69 30353.1,-1337.13 30361.65,-1343.39 30363.69,-1336.69"/>
</g>
<!-- layer1_expert2_6 -->
<g id="node233" class="node">
<title>layer1_expert2_6</title>
<polygon fill="lightgreen" stroke="black" points="30545,-1340 30371,-1340 30371,-1257 30545,-1257 30545,-1340"/>
<text text-anchor="middle" x="30458" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU2</text>
<text text-anchor="middle" x="30458" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="30458" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="30458" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="30458" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_6 -->
<g id="edge378" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30643.21,-1375.99C30616.79,-1365.46 30588.27,-1354.01 30554.69,-1340.27"/>
<polygon fill="black" stroke="black" points="30555.67,-1336.88 30545.09,-1336.33 30553.01,-1343.36 30555.67,-1336.88"/>
</g>
<!-- layer1_expert2_7 -->
<g id="node234" class="node">
<title>layer1_expert2_7</title>
<polygon fill="lightgreen" stroke="black" points="30737,-1340 30563,-1340 30563,-1257 30737,-1257 30737,-1340"/>
<text text-anchor="middle" x="30650" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU2</text>
<text text-anchor="middle" x="30650" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="30650" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="30650" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="30650" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_7 -->
<g id="edge379" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30712.69,-1375.91C30705.25,-1366.83 30697.28,-1357.12 30689.61,-1347.77"/>
<polygon fill="black" stroke="black" points="30692.3,-1345.53 30683.25,-1340.02 30686.89,-1349.97 30692.3,-1345.53"/>
</g>
<!-- layer1_expert2_8 -->
<g id="node235" class="node">
<title>layer1_expert2_8</title>
<polygon fill="lightgreen" stroke="black" points="30929,-1340 30755,-1340 30755,-1257 30929,-1257 30929,-1340"/>
<text text-anchor="middle" x="30842" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU2</text>
<text text-anchor="middle" x="30842" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="30842" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="30842" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="30842" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_8 -->
<g id="edge380" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30779.31,-1375.91C30786.75,-1366.83 30794.72,-1357.12 30802.39,-1347.77"/>
<polygon fill="black" stroke="black" points="30805.11,-1349.97 30808.75,-1340.02 30799.7,-1345.53 30805.11,-1349.97"/>
</g>
<!-- layer1_expert2_9 -->
<g id="node236" class="node">
<title>layer1_expert2_9</title>
<polygon fill="lightgreen" stroke="black" points="31121,-1340 30947,-1340 30947,-1257 31121,-1257 31121,-1340"/>
<text text-anchor="middle" x="31034" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU2</text>
<text text-anchor="middle" x="31034" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31034" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31034" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31034" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_9 -->
<g id="edge381" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30848.79,-1375.99C30875.21,-1365.46 30903.73,-1354.01 30937.31,-1340.27"/>
<polygon fill="black" stroke="black" points="30938.99,-1343.36 30946.91,-1336.33 30936.33,-1336.88 30938.99,-1343.36"/>
</g>
<!-- layer1_expert2_10 -->
<g id="node237" class="node">
<title>layer1_expert2_10</title>
<polygon fill="lightgreen" stroke="black" points="31313,-1340 31139,-1340 31139,-1257 31313,-1257 31313,-1340"/>
<text text-anchor="middle" x="31226" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU2</text>
<text text-anchor="middle" x="31226" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31226" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31226" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31226" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_10 -->
<g id="edge382" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30868.2,-1398.65C30941.83,-1386.36 31037.28,-1367.72 31129.16,-1340.09"/>
<polygon fill="black" stroke="black" points="31130.35,-1343.39 31138.9,-1337.13 31128.31,-1336.69 31130.35,-1343.39"/>
</g>
<!-- layer1_expert2_11 -->
<g id="node238" class="node">
<title>layer1_expert2_11</title>
<polygon fill="lightgreen" stroke="black" points="31505,-1340 31331,-1340 31331,-1257 31505,-1257 31505,-1340"/>
<text text-anchor="middle" x="31418" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU2</text>
<text text-anchor="middle" x="31418" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31418" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31418" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31418" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_11 -->
<g id="edge383" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30868.11,-1409.76C30983.58,-1401.23 31161.22,-1382.5 31320.96,-1340.07"/>
<polygon fill="black" stroke="black" points="31322.23,-1343.36 31330.97,-1337.38 31320.41,-1336.6 31322.23,-1343.36"/>
</g>
<!-- layer1_expert2_12 -->
<g id="node239" class="node">
<title>layer1_expert2_12</title>
<polygon fill="lightgreen" stroke="black" points="31697,-1340 31523,-1340 31523,-1257 31697,-1257 31697,-1340"/>
<text text-anchor="middle" x="31610" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU2</text>
<text text-anchor="middle" x="31610" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31610" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31610" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31610" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_12 -->
<g id="edge384" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30868.33,-1415.54C31019.36,-1411.85 31283.37,-1397.19 31512.87,-1340.07"/>
<polygon fill="black" stroke="black" points="31513.9,-1343.42 31522.74,-1337.58 31512.19,-1336.63 31513.9,-1343.42"/>
</g>
<!-- layer1_expert2_13 -->
<g id="node240" class="node">
<title>layer1_expert2_13</title>
<polygon fill="lightgreen" stroke="black" points="31889,-1340 31715,-1340 31715,-1257 31889,-1257 31889,-1340"/>
<text text-anchor="middle" x="31802" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU2</text>
<text text-anchor="middle" x="31802" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31802" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31802" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31802" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_13 -->
<g id="edge385" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30868.06,-1411.63C31085.51,-1402.15 31532.48,-1378.91 31704.79,-1340"/>
<polygon fill="black" stroke="black" points="31705.83,-1343.36 31714.76,-1337.66 31704.22,-1336.54 31705.83,-1343.36"/>
</g>
<!-- layer1_expert2_14 -->
<g id="node241" class="node">
<title>layer1_expert2_14</title>
<polygon fill="lightgreen" stroke="black" points="32081,-1340 31907,-1340 31907,-1257 32081,-1257 32081,-1340"/>
<text text-anchor="middle" x="31994" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU2</text>
<text text-anchor="middle" x="31994" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31994" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31994" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31994" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_14 -->
<g id="edge386" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30868.32,-1413.51C31119.47,-1406.54 31686.62,-1386.35 31896.74,-1340.01"/>
<polygon fill="black" stroke="black" points="31897.8,-1343.35 31906.77,-1337.71 31896.24,-1336.53 31897.8,-1343.35"/>
</g>
<!-- layer1_expert2_15 -->
<g id="node242" class="node">
<title>layer1_expert2_15</title>
<polygon fill="lightgreen" stroke="black" points="32273,-1340 32099,-1340 32099,-1257 32273,-1257 32273,-1340"/>
<text text-anchor="middle" x="32186" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU2</text>
<text text-anchor="middle" x="32186" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="32186" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="32186" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="32186" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_15 -->
<g id="edge387" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30868.15,-1414.87C31150.11,-1410.26 31840.49,-1393.9 32088.71,-1340.01"/>
<polygon fill="black" stroke="black" points="32089.79,-1343.35 32098.78,-1337.75 32088.25,-1336.52 32089.79,-1343.35"/>
</g>
<!-- layer1_moe_agg_gpu2 -->
<g id="node243" class="node">
<title>layer1_moe_agg_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="30943.5,-1213.5 30740.5,-1213.5 30740.5,-1145.5 30943.5,-1145.5 30943.5,-1213.5"/>
<text text-anchor="middle" x="30842" y="-1198.3" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU2</text>
<text text-anchor="middle" x="30842" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="30842" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="30842" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge388" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M29393.22,-1259.24C29396.16,-1258.42 29399.09,-1257.67 29402,-1257 29654.04,-1199.01 30437.23,-1184.79 30730.04,-1181.47"/>
<polygon fill="black" stroke="black" points="30730.29,-1184.97 30740.25,-1181.35 30730.21,-1177.97 30730.29,-1184.97"/>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge389" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M29585.22,-1259.27C29588.16,-1258.44 29591.09,-1257.68 29594,-1257 29808.27,-1206.78 30466.06,-1188.12 30730.35,-1182.53"/>
<polygon fill="black" stroke="black" points="30730.42,-1186.03 30740.35,-1182.32 30730.28,-1179.03 30730.42,-1186.03"/>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge390" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M29777.23,-1259.31C29780.17,-1258.47 29783.1,-1257.7 29786,-1257 29962.66,-1214.56 30496.19,-1192.05 30730.08,-1183.99"/>
<polygon fill="black" stroke="black" points="30730.44,-1187.48 30740.31,-1183.64 30730.2,-1180.49 30730.44,-1187.48"/>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge391" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M29969.25,-1259.37C29972.18,-1258.52 29975.1,-1257.72 29978,-1257 30117.51,-1222.3 30529.52,-1196.81 30729.96,-1186.09"/>
<polygon fill="black" stroke="black" points="30730.42,-1189.57 30740.22,-1185.54 30730.04,-1182.58 30730.42,-1189.57"/>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge392" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M30161.01,-1259.55C30164.02,-1258.63 30167.03,-1257.78 30170,-1257 30362.76,-1206.49 30595.26,-1189.33 30730.11,-1183.5"/>
<polygon fill="black" stroke="black" points="30730.6,-1186.98 30740.45,-1183.07 30730.31,-1179.99 30730.6,-1186.98"/>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge393" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M30353.06,-1259.72C30356.06,-1258.76 30359.04,-1257.85 30362,-1257 30485.54,-1221.66 30631.93,-1201.29 30730.29,-1190.59"/>
<polygon fill="black" stroke="black" points="30730.68,-1194.07 30740.25,-1189.53 30729.94,-1187.11 30730.68,-1194.07"/>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge394" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M30545.18,-1260.11C30548.14,-1259.04 30551.09,-1257.99 30554,-1257 30611.37,-1237.38 30676.58,-1219.7 30730.42,-1206.28"/>
<polygon fill="black" stroke="black" points="30731.47,-1209.63 30740.34,-1203.83 30729.79,-1202.83 30731.47,-1209.63"/>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge395" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M30716.61,-1256.91C30736.8,-1244.6 30758.91,-1231.13 30778.87,-1218.97"/>
<polygon fill="black" stroke="black" points="30780.85,-1221.86 30787.57,-1213.67 30777.21,-1215.88 30780.85,-1221.86"/>
</g>
<!-- layer1_expert2_8&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge396" class="edge">
<title>layer1_expert2_8&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M30842,-1256.91C30842,-1246.2 30842,-1234.62 30842,-1223.78"/>
<polygon fill="black" stroke="black" points="30845.5,-1223.67 30842,-1213.67 30838.5,-1223.67 30845.5,-1223.67"/>
</g>
<!-- layer1_expert2_9&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge397" class="edge">
<title>layer1_expert2_9&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M30967.39,-1256.91C30947.2,-1244.6 30925.09,-1231.13 30905.13,-1218.97"/>
<polygon fill="black" stroke="black" points="30906.79,-1215.88 30896.43,-1213.67 30903.15,-1221.86 30906.79,-1215.88"/>
</g>
<!-- layer1_expert2_10&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge398" class="edge">
<title>layer1_expert2_10&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M31138.82,-1260.11C31135.86,-1259.04 31132.91,-1257.99 31130,-1257 31072.63,-1237.38 31007.42,-1219.7 30953.58,-1206.28"/>
<polygon fill="black" stroke="black" points="30954.21,-1202.83 30943.66,-1203.83 30952.53,-1209.63 30954.21,-1202.83"/>
</g>
<!-- layer1_expert2_11&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge399" class="edge">
<title>layer1_expert2_11&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M31330.94,-1259.72C31327.94,-1258.76 31324.96,-1257.85 31322,-1257 31198.46,-1221.66 31052.07,-1201.29 30953.71,-1190.59"/>
<polygon fill="black" stroke="black" points="30954.06,-1187.11 30943.75,-1189.53 30953.32,-1194.07 30954.06,-1187.11"/>
</g>
<!-- layer1_expert2_12&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge400" class="edge">
<title>layer1_expert2_12&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M31522.99,-1259.55C31519.98,-1258.63 31516.97,-1257.78 31514,-1257 31321.24,-1206.49 31088.74,-1189.33 30953.89,-1183.5"/>
<polygon fill="black" stroke="black" points="30953.69,-1179.99 30943.55,-1183.07 30953.4,-1186.98 30953.69,-1179.99"/>
</g>
<!-- layer1_expert2_13&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge401" class="edge">
<title>layer1_expert2_13&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M31714.75,-1259.37C31711.82,-1258.52 31708.9,-1257.72 31706,-1257 31566.49,-1222.3 31154.48,-1196.81 30954.04,-1186.09"/>
<polygon fill="black" stroke="black" points="30953.96,-1182.58 30943.78,-1185.54 30953.58,-1189.57 30953.96,-1182.58"/>
</g>
<!-- layer1_expert2_14&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge402" class="edge">
<title>layer1_expert2_14&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M31906.77,-1259.31C31903.83,-1258.47 31900.9,-1257.7 31898,-1257 31721.34,-1214.56 31187.81,-1192.05 30953.92,-1183.99"/>
<polygon fill="black" stroke="black" points="30953.8,-1180.49 30943.69,-1183.64 30953.56,-1187.48 30953.8,-1180.49"/>
</g>
<!-- layer1_expert2_15&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge403" class="edge">
<title>layer1_expert2_15&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M32098.78,-1259.27C32095.84,-1258.44 32092.91,-1257.68 32090,-1257 31875.73,-1206.78 31217.94,-1188.12 30953.65,-1182.53"/>
<polygon fill="black" stroke="black" points="30953.72,-1179.03 30943.65,-1182.32 30953.58,-1186.03 30953.72,-1179.03"/>
</g>
<!-- layer1_output_gpu2 -->
<g id="node244" class="node">
<title>layer1_output_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="32369,-1102 32125,-1102 32125,-1034 32369,-1034 32369,-1102"/>
<text text-anchor="middle" x="32247" y="-1086.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="32247" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="32247" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="32247" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_moe_agg_gpu2&#45;&gt;layer1_output_gpu2 -->
<g id="edge404" class="edge">
<title>layer1_moe_agg_gpu2&#45;&gt;layer1_output_gpu2</title>
<path fill="none" stroke="black" d="M30943.61,-1170.58C31193.14,-1151.13 31835.95,-1101.04 32114.74,-1079.31"/>
<polygon fill="black" stroke="black" points="32115.21,-1082.78 32124.91,-1078.52 32114.67,-1075.8 32115.21,-1082.78"/>
</g>
<!-- layer1_output_gpu2&#45;&gt;pipeline_stage0_1 -->
<g id="edge587" class="edge">
<title>layer1_output_gpu2&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M32369.25,-1060.51C32818.13,-1036.69 34377.1,-953.94 34911,-925.61"/>
<polygon fill="black" stroke="black" points="34911.3,-929.1 34921.1,-925.07 34910.93,-922.11 34911.3,-929.1"/>
</g>
<!-- layer1_qkv_gpu3 -->
<g id="node245" class="node">
<title>layer1_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="33924,-1778.48 33712,-1778.48 33712,-1710.48 33924,-1710.48 33924,-1778.48"/>
<text text-anchor="middle" x="33818" y="-1763.28" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="33818" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33818" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="33818" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_gpu3 -->
<g id="node246" class="node">
<title>layer1_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="33939.5,-1667 33696.5,-1667 33696.5,-1599 33939.5,-1599 33939.5,-1667"/>
<text text-anchor="middle" x="33818" y="-1651.8" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="33818" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="33818" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33818" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_qkv_gpu3&#45;&gt;layer1_attn_gpu3 -->
<g id="edge405" class="edge">
<title>layer1_qkv_gpu3&#45;&gt;layer1_attn_gpu3</title>
<path fill="none" stroke="black" d="M33818,-1710.33C33818,-1699.94 33818,-1688.3 33818,-1677.31"/>
<polygon fill="black" stroke="black" points="33821.5,-1677.03 33818,-1667.03 33814.5,-1677.03 33821.5,-1677.03"/>
</g>
<!-- layer1_attn_norm_gpu3 -->
<g id="node247" class="node">
<title>layer1_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="33940,-1563 33696,-1563 33696,-1495 33940,-1495 33940,-1563"/>
<text text-anchor="middle" x="33818" y="-1547.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="33818" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="33818" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33818" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_gpu3&#45;&gt;layer1_attn_norm_gpu3 -->
<g id="edge406" class="edge">
<title>layer1_attn_gpu3&#45;&gt;layer1_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M33818,-1598.88C33818,-1590.78 33818,-1581.98 33818,-1573.47"/>
<polygon fill="black" stroke="black" points="33821.5,-1573.3 33818,-1563.3 33814.5,-1573.3 33821.5,-1573.3"/>
</g>
<!-- layer1_gate_gpu3 -->
<g id="node248" class="node">
<title>layer1_gate_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="33940,-1459 33696,-1459 33696,-1376 33940,-1376 33940,-1459"/>
<text text-anchor="middle" x="33818" y="-1443.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU3</text>
<text text-anchor="middle" x="33818" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33818" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="33818" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="33818" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_norm_gpu3&#45;&gt;layer1_gate_gpu3 -->
<g id="edge407" class="edge">
<title>layer1_attn_norm_gpu3&#45;&gt;layer1_gate_gpu3</title>
<path fill="none" stroke="black" d="M33818,-1494.85C33818,-1486.8 33818,-1478 33818,-1469.34"/>
<polygon fill="black" stroke="black" points="33821.5,-1469.28 33818,-1459.28 33814.5,-1469.28 33821.5,-1469.28"/>
</g>
<!-- layer1_expert3_0 -->
<g id="node249" class="node">
<title>layer1_expert3_0</title>
<polygon fill="lightgreen" stroke="black" points="32465,-1340 32291,-1340 32291,-1257 32465,-1257 32465,-1340"/>
<text text-anchor="middle" x="32378" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU3</text>
<text text-anchor="middle" x="32378" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="32378" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="32378" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="32378" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_0 -->
<g id="edge408" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33695.85,-1414.87C33413.89,-1410.26 32723.51,-1393.9 32475.29,-1340.01"/>
<polygon fill="black" stroke="black" points="32475.75,-1336.52 32465.22,-1337.75 32474.21,-1343.35 32475.75,-1336.52"/>
</g>
<!-- layer1_expert3_1 -->
<g id="node250" class="node">
<title>layer1_expert3_1</title>
<polygon fill="lightgreen" stroke="black" points="32657,-1340 32483,-1340 32483,-1257 32657,-1257 32657,-1340"/>
<text text-anchor="middle" x="32570" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU3</text>
<text text-anchor="middle" x="32570" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="32570" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="32570" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="32570" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_1 -->
<g id="edge409" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33695.68,-1413.51C33444.53,-1406.54 32877.38,-1386.35 32667.26,-1340.01"/>
<polygon fill="black" stroke="black" points="32667.76,-1336.53 32657.23,-1337.71 32666.2,-1343.35 32667.76,-1336.53"/>
</g>
<!-- layer1_expert3_2 -->
<g id="node251" class="node">
<title>layer1_expert3_2</title>
<polygon fill="lightgreen" stroke="black" points="32849,-1340 32675,-1340 32675,-1257 32849,-1257 32849,-1340"/>
<text text-anchor="middle" x="32762" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU3</text>
<text text-anchor="middle" x="32762" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="32762" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="32762" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="32762" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_2 -->
<g id="edge410" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33695.94,-1411.63C33478.49,-1402.15 33031.52,-1378.91 32859.21,-1340"/>
<polygon fill="black" stroke="black" points="32859.78,-1336.54 32849.24,-1337.66 32858.17,-1343.36 32859.78,-1336.54"/>
</g>
<!-- layer1_expert3_3 -->
<g id="node252" class="node">
<title>layer1_expert3_3</title>
<polygon fill="lightgreen" stroke="black" points="33041,-1340 32867,-1340 32867,-1257 33041,-1257 33041,-1340"/>
<text text-anchor="middle" x="32954" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU3</text>
<text text-anchor="middle" x="32954" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="32954" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="32954" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="32954" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_3 -->
<g id="edge411" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33695.67,-1415.54C33544.64,-1411.85 33280.63,-1397.19 33051.13,-1340.07"/>
<polygon fill="black" stroke="black" points="33051.81,-1336.63 33041.26,-1337.58 33050.1,-1343.42 33051.81,-1336.63"/>
</g>
<!-- layer1_expert3_4 -->
<g id="node253" class="node">
<title>layer1_expert3_4</title>
<polygon fill="lightgreen" stroke="black" points="33233,-1340 33059,-1340 33059,-1257 33233,-1257 33233,-1340"/>
<text text-anchor="middle" x="33146" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU3</text>
<text text-anchor="middle" x="33146" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="33146" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="33146" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="33146" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_4 -->
<g id="edge412" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33695.89,-1409.76C33580.42,-1401.23 33402.78,-1382.5 33243.04,-1340.07"/>
<polygon fill="black" stroke="black" points="33243.59,-1336.6 33233.03,-1337.38 33241.77,-1343.36 33243.59,-1336.6"/>
</g>
<!-- layer1_expert3_5 -->
<g id="node254" class="node">
<title>layer1_expert3_5</title>
<polygon fill="lightgreen" stroke="black" points="33425,-1340 33251,-1340 33251,-1257 33425,-1257 33425,-1340"/>
<text text-anchor="middle" x="33338" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU3</text>
<text text-anchor="middle" x="33338" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="33338" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="33338" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="33338" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_5 -->
<g id="edge413" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33695.8,-1398.65C33622.17,-1386.36 33526.72,-1367.72 33434.84,-1340.09"/>
<polygon fill="black" stroke="black" points="33435.69,-1336.69 33425.1,-1337.13 33433.65,-1343.39 33435.69,-1336.69"/>
</g>
<!-- layer1_expert3_6 -->
<g id="node255" class="node">
<title>layer1_expert3_6</title>
<polygon fill="lightgreen" stroke="black" points="33617,-1340 33443,-1340 33443,-1257 33617,-1257 33617,-1340"/>
<text text-anchor="middle" x="33530" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU3</text>
<text text-anchor="middle" x="33530" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="33530" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="33530" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="33530" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_6 -->
<g id="edge414" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33715.21,-1375.99C33688.79,-1365.46 33660.27,-1354.01 33626.69,-1340.27"/>
<polygon fill="black" stroke="black" points="33627.67,-1336.88 33617.09,-1336.33 33625.01,-1343.36 33627.67,-1336.88"/>
</g>
<!-- layer1_expert3_7 -->
<g id="node256" class="node">
<title>layer1_expert3_7</title>
<polygon fill="lightgreen" stroke="black" points="33809,-1340 33635,-1340 33635,-1257 33809,-1257 33809,-1340"/>
<text text-anchor="middle" x="33722" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU3</text>
<text text-anchor="middle" x="33722" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="33722" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="33722" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="33722" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_7 -->
<g id="edge415" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33784.69,-1375.91C33777.25,-1366.83 33769.28,-1357.12 33761.61,-1347.77"/>
<polygon fill="black" stroke="black" points="33764.3,-1345.53 33755.25,-1340.02 33758.89,-1349.97 33764.3,-1345.53"/>
</g>
<!-- layer1_expert3_8 -->
<g id="node257" class="node">
<title>layer1_expert3_8</title>
<polygon fill="lightgreen" stroke="black" points="34001,-1340 33827,-1340 33827,-1257 34001,-1257 34001,-1340"/>
<text text-anchor="middle" x="33914" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU3</text>
<text text-anchor="middle" x="33914" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="33914" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="33914" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="33914" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_8 -->
<g id="edge416" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33851.31,-1375.91C33858.75,-1366.83 33866.72,-1357.12 33874.39,-1347.77"/>
<polygon fill="black" stroke="black" points="33877.11,-1349.97 33880.75,-1340.02 33871.7,-1345.53 33877.11,-1349.97"/>
</g>
<!-- layer1_expert3_9 -->
<g id="node258" class="node">
<title>layer1_expert3_9</title>
<polygon fill="lightgreen" stroke="black" points="34193,-1340 34019,-1340 34019,-1257 34193,-1257 34193,-1340"/>
<text text-anchor="middle" x="34106" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU3</text>
<text text-anchor="middle" x="34106" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="34106" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="34106" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="34106" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_9 -->
<g id="edge417" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33920.79,-1375.99C33947.21,-1365.46 33975.73,-1354.01 34009.31,-1340.27"/>
<polygon fill="black" stroke="black" points="34010.99,-1343.36 34018.91,-1336.33 34008.33,-1336.88 34010.99,-1343.36"/>
</g>
<!-- layer1_expert3_10 -->
<g id="node259" class="node">
<title>layer1_expert3_10</title>
<polygon fill="lightgreen" stroke="black" points="34385,-1340 34211,-1340 34211,-1257 34385,-1257 34385,-1340"/>
<text text-anchor="middle" x="34298" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU3</text>
<text text-anchor="middle" x="34298" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="34298" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="34298" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="34298" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_10 -->
<g id="edge418" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33940.2,-1398.65C34013.83,-1386.36 34109.28,-1367.72 34201.16,-1340.09"/>
<polygon fill="black" stroke="black" points="34202.35,-1343.39 34210.9,-1337.13 34200.31,-1336.69 34202.35,-1343.39"/>
</g>
<!-- layer1_expert3_11 -->
<g id="node260" class="node">
<title>layer1_expert3_11</title>
<polygon fill="lightgreen" stroke="black" points="34577,-1340 34403,-1340 34403,-1257 34577,-1257 34577,-1340"/>
<text text-anchor="middle" x="34490" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU3</text>
<text text-anchor="middle" x="34490" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="34490" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="34490" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="34490" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_11 -->
<g id="edge419" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33940.11,-1409.76C34055.58,-1401.23 34233.22,-1382.5 34392.96,-1340.07"/>
<polygon fill="black" stroke="black" points="34394.23,-1343.36 34402.97,-1337.38 34392.41,-1336.6 34394.23,-1343.36"/>
</g>
<!-- layer1_expert3_12 -->
<g id="node261" class="node">
<title>layer1_expert3_12</title>
<polygon fill="lightgreen" stroke="black" points="34769,-1340 34595,-1340 34595,-1257 34769,-1257 34769,-1340"/>
<text text-anchor="middle" x="34682" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU3</text>
<text text-anchor="middle" x="34682" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="34682" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="34682" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="34682" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_12 -->
<g id="edge420" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33940.33,-1415.54C34091.36,-1411.85 34355.37,-1397.19 34584.87,-1340.07"/>
<polygon fill="black" stroke="black" points="34585.9,-1343.42 34594.74,-1337.58 34584.19,-1336.63 34585.9,-1343.42"/>
</g>
<!-- layer1_expert3_13 -->
<g id="node262" class="node">
<title>layer1_expert3_13</title>
<polygon fill="lightgreen" stroke="black" points="34961,-1340 34787,-1340 34787,-1257 34961,-1257 34961,-1340"/>
<text text-anchor="middle" x="34874" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU3</text>
<text text-anchor="middle" x="34874" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="34874" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="34874" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="34874" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_13 -->
<g id="edge421" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33940.06,-1411.63C34157.51,-1402.15 34604.48,-1378.91 34776.79,-1340"/>
<polygon fill="black" stroke="black" points="34777.83,-1343.36 34786.76,-1337.66 34776.22,-1336.54 34777.83,-1343.36"/>
</g>
<!-- layer1_expert3_14 -->
<g id="node263" class="node">
<title>layer1_expert3_14</title>
<polygon fill="lightgreen" stroke="black" points="35153,-1340 34979,-1340 34979,-1257 35153,-1257 35153,-1340"/>
<text text-anchor="middle" x="35066" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU3</text>
<text text-anchor="middle" x="35066" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="35066" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="35066" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="35066" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_14 -->
<g id="edge422" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33940.32,-1413.51C34191.47,-1406.54 34758.62,-1386.35 34968.74,-1340.01"/>
<polygon fill="black" stroke="black" points="34969.8,-1343.35 34978.77,-1337.71 34968.24,-1336.53 34969.8,-1343.35"/>
</g>
<!-- layer1_expert3_15 -->
<g id="node264" class="node">
<title>layer1_expert3_15</title>
<polygon fill="lightgreen" stroke="black" points="35345,-1340 35171,-1340 35171,-1257 35345,-1257 35345,-1340"/>
<text text-anchor="middle" x="35258" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU3</text>
<text text-anchor="middle" x="35258" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="35258" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="35258" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="35258" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_15 -->
<g id="edge423" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33940.15,-1414.87C34222.11,-1410.26 34912.49,-1393.9 35160.71,-1340.01"/>
<polygon fill="black" stroke="black" points="35161.79,-1343.35 35170.78,-1337.75 35160.25,-1336.52 35161.79,-1343.35"/>
</g>
<!-- layer1_moe_agg_gpu3 -->
<g id="node265" class="node">
<title>layer1_moe_agg_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="34015.5,-1213.5 33812.5,-1213.5 33812.5,-1145.5 34015.5,-1145.5 34015.5,-1213.5"/>
<text text-anchor="middle" x="33914" y="-1198.3" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU3</text>
<text text-anchor="middle" x="33914" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="33914" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33914" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_expert3_0&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge424" class="edge">
<title>layer1_expert3_0&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M32465.22,-1259.24C32468.16,-1258.42 32471.09,-1257.67 32474,-1257 32726.04,-1199.01 33509.23,-1184.79 33802.04,-1181.47"/>
<polygon fill="black" stroke="black" points="33802.29,-1184.97 33812.25,-1181.35 33802.21,-1177.97 33802.29,-1184.97"/>
</g>
<!-- layer1_expert3_1&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge425" class="edge">
<title>layer1_expert3_1&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M32657.22,-1259.27C32660.16,-1258.44 32663.09,-1257.68 32666,-1257 32880.27,-1206.78 33538.06,-1188.12 33802.35,-1182.53"/>
<polygon fill="black" stroke="black" points="33802.42,-1186.03 33812.35,-1182.32 33802.28,-1179.03 33802.42,-1186.03"/>
</g>
<!-- layer1_expert3_2&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge426" class="edge">
<title>layer1_expert3_2&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M32849.23,-1259.31C32852.17,-1258.47 32855.1,-1257.7 32858,-1257 33034.66,-1214.56 33568.19,-1192.05 33802.08,-1183.99"/>
<polygon fill="black" stroke="black" points="33802.44,-1187.48 33812.31,-1183.64 33802.2,-1180.49 33802.44,-1187.48"/>
</g>
<!-- layer1_expert3_3&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge427" class="edge">
<title>layer1_expert3_3&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M33041.25,-1259.37C33044.18,-1258.52 33047.1,-1257.72 33050,-1257 33189.51,-1222.3 33601.52,-1196.81 33801.96,-1186.09"/>
<polygon fill="black" stroke="black" points="33802.42,-1189.57 33812.22,-1185.54 33802.04,-1182.58 33802.42,-1189.57"/>
</g>
<!-- layer1_expert3_4&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge428" class="edge">
<title>layer1_expert3_4&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M33233.01,-1259.55C33236.02,-1258.63 33239.03,-1257.78 33242,-1257 33434.76,-1206.49 33667.26,-1189.33 33802.11,-1183.5"/>
<polygon fill="black" stroke="black" points="33802.6,-1186.98 33812.45,-1183.07 33802.31,-1179.99 33802.6,-1186.98"/>
</g>
<!-- layer1_expert3_5&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge429" class="edge">
<title>layer1_expert3_5&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M33425.06,-1259.72C33428.06,-1258.76 33431.04,-1257.85 33434,-1257 33557.54,-1221.66 33703.93,-1201.29 33802.29,-1190.59"/>
<polygon fill="black" stroke="black" points="33802.68,-1194.07 33812.25,-1189.53 33801.94,-1187.11 33802.68,-1194.07"/>
</g>
<!-- layer1_expert3_6&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge430" class="edge">
<title>layer1_expert3_6&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M33617.18,-1260.11C33620.14,-1259.04 33623.09,-1257.99 33626,-1257 33683.37,-1237.38 33748.58,-1219.7 33802.42,-1206.28"/>
<polygon fill="black" stroke="black" points="33803.47,-1209.63 33812.34,-1203.83 33801.79,-1202.83 33803.47,-1209.63"/>
</g>
<!-- layer1_expert3_7&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge431" class="edge">
<title>layer1_expert3_7&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M33788.61,-1256.91C33808.8,-1244.6 33830.91,-1231.13 33850.87,-1218.97"/>
<polygon fill="black" stroke="black" points="33852.85,-1221.86 33859.57,-1213.67 33849.21,-1215.88 33852.85,-1221.86"/>
</g>
<!-- layer1_expert3_8&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge432" class="edge">
<title>layer1_expert3_8&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M33914,-1256.91C33914,-1246.2 33914,-1234.62 33914,-1223.78"/>
<polygon fill="black" stroke="black" points="33917.5,-1223.67 33914,-1213.67 33910.5,-1223.67 33917.5,-1223.67"/>
</g>
<!-- layer1_expert3_9&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge433" class="edge">
<title>layer1_expert3_9&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M34039.39,-1256.91C34019.2,-1244.6 33997.09,-1231.13 33977.13,-1218.97"/>
<polygon fill="black" stroke="black" points="33978.79,-1215.88 33968.43,-1213.67 33975.15,-1221.86 33978.79,-1215.88"/>
</g>
<!-- layer1_expert3_10&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge434" class="edge">
<title>layer1_expert3_10&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M34210.82,-1260.11C34207.86,-1259.04 34204.91,-1257.99 34202,-1257 34144.63,-1237.38 34079.42,-1219.7 34025.58,-1206.28"/>
<polygon fill="black" stroke="black" points="34026.21,-1202.83 34015.66,-1203.83 34024.53,-1209.63 34026.21,-1202.83"/>
</g>
<!-- layer1_expert3_11&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge435" class="edge">
<title>layer1_expert3_11&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M34402.94,-1259.72C34399.94,-1258.76 34396.96,-1257.85 34394,-1257 34270.46,-1221.66 34124.07,-1201.29 34025.71,-1190.59"/>
<polygon fill="black" stroke="black" points="34026.06,-1187.11 34015.75,-1189.53 34025.32,-1194.07 34026.06,-1187.11"/>
</g>
<!-- layer1_expert3_12&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge436" class="edge">
<title>layer1_expert3_12&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M34594.99,-1259.55C34591.98,-1258.63 34588.97,-1257.78 34586,-1257 34393.24,-1206.49 34160.74,-1189.33 34025.89,-1183.5"/>
<polygon fill="black" stroke="black" points="34025.69,-1179.99 34015.55,-1183.07 34025.4,-1186.98 34025.69,-1179.99"/>
</g>
<!-- layer1_expert3_13&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge437" class="edge">
<title>layer1_expert3_13&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M34786.75,-1259.37C34783.82,-1258.52 34780.9,-1257.72 34778,-1257 34638.49,-1222.3 34226.48,-1196.81 34026.04,-1186.09"/>
<polygon fill="black" stroke="black" points="34025.96,-1182.58 34015.78,-1185.54 34025.58,-1189.57 34025.96,-1182.58"/>
</g>
<!-- layer1_expert3_14&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge438" class="edge">
<title>layer1_expert3_14&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M34978.77,-1259.31C34975.83,-1258.47 34972.9,-1257.7 34970,-1257 34793.34,-1214.56 34259.81,-1192.05 34025.92,-1183.99"/>
<polygon fill="black" stroke="black" points="34025.8,-1180.49 34015.69,-1183.64 34025.56,-1187.48 34025.8,-1180.49"/>
</g>
<!-- layer1_expert3_15&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge439" class="edge">
<title>layer1_expert3_15&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M35170.78,-1259.27C35167.84,-1258.44 35164.91,-1257.68 35162,-1257 34947.73,-1206.78 34289.94,-1188.12 34025.65,-1182.53"/>
<polygon fill="black" stroke="black" points="34025.72,-1179.03 34015.65,-1182.32 34025.58,-1186.03 34025.72,-1179.03"/>
</g>
<!-- layer1_output_gpu3 -->
<g id="node266" class="node">
<title>layer1_output_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="34429,-1102 34185,-1102 34185,-1034 34429,-1034 34429,-1102"/>
<text text-anchor="middle" x="34307" y="-1086.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="34307" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="34307" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="34307" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_moe_agg_gpu3&#45;&gt;layer1_output_gpu3 -->
<g id="edge440" class="edge">
<title>layer1_moe_agg_gpu3&#45;&gt;layer1_output_gpu3</title>
<path fill="none" stroke="black" d="M34015.72,-1150.16C34065.39,-1136.32 34125.69,-1119.52 34178.51,-1104.8"/>
<polygon fill="black" stroke="black" points="34179.59,-1108.13 34188.28,-1102.08 34177.71,-1101.39 34179.59,-1108.13"/>
</g>
<!-- layer1_output_gpu3&#45;&gt;pipeline_stage0_1 -->
<g id="edge588" class="edge">
<title>layer1_output_gpu3&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M34429.23,-1043.49C34561.71,-1018 34774.06,-977.16 34922.59,-948.59"/>
<polygon fill="black" stroke="black" points="34923.57,-951.96 34932.72,-946.64 34922.24,-945.09 34923.57,-951.96"/>
</g>
<!-- layer1_qkv_gpu4 -->
<g id="node267" class="node">
<title>layer1_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="36996,-1778.48 36784,-1778.48 36784,-1710.48 36996,-1710.48 36996,-1778.48"/>
<text text-anchor="middle" x="36890" y="-1763.28" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="36890" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="36890" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="36890" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_gpu4 -->
<g id="node268" class="node">
<title>layer1_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="37011.5,-1667 36768.5,-1667 36768.5,-1599 37011.5,-1599 37011.5,-1667"/>
<text text-anchor="middle" x="36890" y="-1651.8" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="36890" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="36890" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="36890" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_qkv_gpu4&#45;&gt;layer1_attn_gpu4 -->
<g id="edge441" class="edge">
<title>layer1_qkv_gpu4&#45;&gt;layer1_attn_gpu4</title>
<path fill="none" stroke="black" d="M36890,-1710.33C36890,-1699.94 36890,-1688.3 36890,-1677.31"/>
<polygon fill="black" stroke="black" points="36893.5,-1677.03 36890,-1667.03 36886.5,-1677.03 36893.5,-1677.03"/>
</g>
<!-- layer1_attn_norm_gpu4 -->
<g id="node269" class="node">
<title>layer1_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="37012,-1563 36768,-1563 36768,-1495 37012,-1495 37012,-1563"/>
<text text-anchor="middle" x="36890" y="-1547.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="36890" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="36890" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="36890" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_gpu4&#45;&gt;layer1_attn_norm_gpu4 -->
<g id="edge442" class="edge">
<title>layer1_attn_gpu4&#45;&gt;layer1_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M36890,-1598.88C36890,-1590.78 36890,-1581.98 36890,-1573.47"/>
<polygon fill="black" stroke="black" points="36893.5,-1573.3 36890,-1563.3 36886.5,-1573.3 36893.5,-1573.3"/>
</g>
<!-- layer1_gate_gpu4 -->
<g id="node270" class="node">
<title>layer1_gate_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="37012,-1459 36768,-1459 36768,-1376 37012,-1376 37012,-1459"/>
<text text-anchor="middle" x="36890" y="-1443.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU4</text>
<text text-anchor="middle" x="36890" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="36890" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="36890" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="36890" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_norm_gpu4&#45;&gt;layer1_gate_gpu4 -->
<g id="edge443" class="edge">
<title>layer1_attn_norm_gpu4&#45;&gt;layer1_gate_gpu4</title>
<path fill="none" stroke="black" d="M36890,-1494.85C36890,-1486.8 36890,-1478 36890,-1469.34"/>
<polygon fill="black" stroke="black" points="36893.5,-1469.28 36890,-1459.28 36886.5,-1469.28 36893.5,-1469.28"/>
</g>
<!-- layer1_expert4_0 -->
<g id="node271" class="node">
<title>layer1_expert4_0</title>
<polygon fill="lightgreen" stroke="black" points="35537,-1340 35363,-1340 35363,-1257 35537,-1257 35537,-1340"/>
<text text-anchor="middle" x="35450" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU4</text>
<text text-anchor="middle" x="35450" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="35450" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="35450" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="35450" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_0 -->
<g id="edge444" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36767.85,-1414.87C36485.89,-1410.26 35795.51,-1393.9 35547.29,-1340.01"/>
<polygon fill="black" stroke="black" points="35547.75,-1336.52 35537.22,-1337.75 35546.21,-1343.35 35547.75,-1336.52"/>
</g>
<!-- layer1_expert4_1 -->
<g id="node272" class="node">
<title>layer1_expert4_1</title>
<polygon fill="lightgreen" stroke="black" points="35729,-1340 35555,-1340 35555,-1257 35729,-1257 35729,-1340"/>
<text text-anchor="middle" x="35642" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU4</text>
<text text-anchor="middle" x="35642" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="35642" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="35642" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="35642" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_1 -->
<g id="edge445" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36767.68,-1413.51C36516.53,-1406.54 35949.38,-1386.35 35739.26,-1340.01"/>
<polygon fill="black" stroke="black" points="35739.76,-1336.53 35729.23,-1337.71 35738.2,-1343.35 35739.76,-1336.53"/>
</g>
<!-- layer1_expert4_2 -->
<g id="node273" class="node">
<title>layer1_expert4_2</title>
<polygon fill="lightgreen" stroke="black" points="35921,-1340 35747,-1340 35747,-1257 35921,-1257 35921,-1340"/>
<text text-anchor="middle" x="35834" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU4</text>
<text text-anchor="middle" x="35834" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="35834" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="35834" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="35834" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_2 -->
<g id="edge446" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36767.94,-1411.63C36550.49,-1402.15 36103.52,-1378.91 35931.21,-1340"/>
<polygon fill="black" stroke="black" points="35931.78,-1336.54 35921.24,-1337.66 35930.17,-1343.36 35931.78,-1336.54"/>
</g>
<!-- layer1_expert4_3 -->
<g id="node274" class="node">
<title>layer1_expert4_3</title>
<polygon fill="lightgreen" stroke="black" points="36113,-1340 35939,-1340 35939,-1257 36113,-1257 36113,-1340"/>
<text text-anchor="middle" x="36026" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU4</text>
<text text-anchor="middle" x="36026" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36026" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36026" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36026" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_3 -->
<g id="edge447" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36767.67,-1415.54C36616.64,-1411.85 36352.63,-1397.19 36123.13,-1340.07"/>
<polygon fill="black" stroke="black" points="36123.81,-1336.63 36113.26,-1337.58 36122.1,-1343.42 36123.81,-1336.63"/>
</g>
<!-- layer1_expert4_4 -->
<g id="node275" class="node">
<title>layer1_expert4_4</title>
<polygon fill="lightgreen" stroke="black" points="36305,-1340 36131,-1340 36131,-1257 36305,-1257 36305,-1340"/>
<text text-anchor="middle" x="36218" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU4</text>
<text text-anchor="middle" x="36218" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36218" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36218" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36218" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_4 -->
<g id="edge448" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36767.89,-1409.76C36652.42,-1401.23 36474.78,-1382.5 36315.04,-1340.07"/>
<polygon fill="black" stroke="black" points="36315.59,-1336.6 36305.03,-1337.38 36313.77,-1343.36 36315.59,-1336.6"/>
</g>
<!-- layer1_expert4_5 -->
<g id="node276" class="node">
<title>layer1_expert4_5</title>
<polygon fill="lightgreen" stroke="black" points="36497,-1340 36323,-1340 36323,-1257 36497,-1257 36497,-1340"/>
<text text-anchor="middle" x="36410" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU4</text>
<text text-anchor="middle" x="36410" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36410" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36410" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36410" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_5 -->
<g id="edge449" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36767.8,-1398.65C36694.17,-1386.36 36598.72,-1367.72 36506.84,-1340.09"/>
<polygon fill="black" stroke="black" points="36507.69,-1336.69 36497.1,-1337.13 36505.65,-1343.39 36507.69,-1336.69"/>
</g>
<!-- layer1_expert4_6 -->
<g id="node277" class="node">
<title>layer1_expert4_6</title>
<polygon fill="lightgreen" stroke="black" points="36689,-1340 36515,-1340 36515,-1257 36689,-1257 36689,-1340"/>
<text text-anchor="middle" x="36602" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU4</text>
<text text-anchor="middle" x="36602" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36602" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36602" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36602" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_6 -->
<g id="edge450" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36787.21,-1375.99C36760.79,-1365.46 36732.27,-1354.01 36698.69,-1340.27"/>
<polygon fill="black" stroke="black" points="36699.67,-1336.88 36689.09,-1336.33 36697.01,-1343.36 36699.67,-1336.88"/>
</g>
<!-- layer1_expert4_7 -->
<g id="node278" class="node">
<title>layer1_expert4_7</title>
<polygon fill="lightgreen" stroke="black" points="36881,-1340 36707,-1340 36707,-1257 36881,-1257 36881,-1340"/>
<text text-anchor="middle" x="36794" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU4</text>
<text text-anchor="middle" x="36794" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36794" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36794" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36794" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_7 -->
<g id="edge451" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36856.69,-1375.91C36849.25,-1366.83 36841.28,-1357.12 36833.61,-1347.77"/>
<polygon fill="black" stroke="black" points="36836.3,-1345.53 36827.25,-1340.02 36830.89,-1349.97 36836.3,-1345.53"/>
</g>
<!-- layer1_expert4_8 -->
<g id="node279" class="node">
<title>layer1_expert4_8</title>
<polygon fill="lightgreen" stroke="black" points="37073,-1340 36899,-1340 36899,-1257 37073,-1257 37073,-1340"/>
<text text-anchor="middle" x="36986" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU4</text>
<text text-anchor="middle" x="36986" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36986" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36986" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36986" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_8 -->
<g id="edge452" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36923.31,-1375.91C36930.75,-1366.83 36938.72,-1357.12 36946.39,-1347.77"/>
<polygon fill="black" stroke="black" points="36949.11,-1349.97 36952.75,-1340.02 36943.7,-1345.53 36949.11,-1349.97"/>
</g>
<!-- layer1_expert4_9 -->
<g id="node280" class="node">
<title>layer1_expert4_9</title>
<polygon fill="lightgreen" stroke="black" points="37265,-1340 37091,-1340 37091,-1257 37265,-1257 37265,-1340"/>
<text text-anchor="middle" x="37178" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU4</text>
<text text-anchor="middle" x="37178" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="37178" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="37178" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="37178" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_9 -->
<g id="edge453" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36992.79,-1375.99C37019.21,-1365.46 37047.73,-1354.01 37081.31,-1340.27"/>
<polygon fill="black" stroke="black" points="37082.99,-1343.36 37090.91,-1336.33 37080.33,-1336.88 37082.99,-1343.36"/>
</g>
<!-- layer1_expert4_10 -->
<g id="node281" class="node">
<title>layer1_expert4_10</title>
<polygon fill="lightgreen" stroke="black" points="37457,-1340 37283,-1340 37283,-1257 37457,-1257 37457,-1340"/>
<text text-anchor="middle" x="37370" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU4</text>
<text text-anchor="middle" x="37370" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="37370" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="37370" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="37370" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_10 -->
<g id="edge454" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37012.2,-1398.65C37085.83,-1386.36 37181.28,-1367.72 37273.16,-1340.09"/>
<polygon fill="black" stroke="black" points="37274.35,-1343.39 37282.9,-1337.13 37272.31,-1336.69 37274.35,-1343.39"/>
</g>
<!-- layer1_expert4_11 -->
<g id="node282" class="node">
<title>layer1_expert4_11</title>
<polygon fill="lightgreen" stroke="black" points="37649,-1340 37475,-1340 37475,-1257 37649,-1257 37649,-1340"/>
<text text-anchor="middle" x="37562" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU4</text>
<text text-anchor="middle" x="37562" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="37562" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="37562" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="37562" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_11 -->
<g id="edge455" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37012.11,-1409.76C37127.58,-1401.23 37305.22,-1382.5 37464.96,-1340.07"/>
<polygon fill="black" stroke="black" points="37466.23,-1343.36 37474.97,-1337.38 37464.41,-1336.6 37466.23,-1343.36"/>
</g>
<!-- layer1_expert4_12 -->
<g id="node283" class="node">
<title>layer1_expert4_12</title>
<polygon fill="lightgreen" stroke="black" points="37841,-1340 37667,-1340 37667,-1257 37841,-1257 37841,-1340"/>
<text text-anchor="middle" x="37754" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU4</text>
<text text-anchor="middle" x="37754" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="37754" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="37754" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="37754" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_12 -->
<g id="edge456" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37012.33,-1415.54C37163.36,-1411.85 37427.37,-1397.19 37656.87,-1340.07"/>
<polygon fill="black" stroke="black" points="37657.9,-1343.42 37666.74,-1337.58 37656.19,-1336.63 37657.9,-1343.42"/>
</g>
<!-- layer1_expert4_13 -->
<g id="node284" class="node">
<title>layer1_expert4_13</title>
<polygon fill="lightgreen" stroke="black" points="38033,-1340 37859,-1340 37859,-1257 38033,-1257 38033,-1340"/>
<text text-anchor="middle" x="37946" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU4</text>
<text text-anchor="middle" x="37946" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="37946" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="37946" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="37946" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_13 -->
<g id="edge457" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37012.06,-1411.63C37229.51,-1402.15 37676.48,-1378.91 37848.79,-1340"/>
<polygon fill="black" stroke="black" points="37849.83,-1343.36 37858.76,-1337.66 37848.22,-1336.54 37849.83,-1343.36"/>
</g>
<!-- layer1_expert4_14 -->
<g id="node285" class="node">
<title>layer1_expert4_14</title>
<polygon fill="lightgreen" stroke="black" points="38225,-1340 38051,-1340 38051,-1257 38225,-1257 38225,-1340"/>
<text text-anchor="middle" x="38138" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU4</text>
<text text-anchor="middle" x="38138" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="38138" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="38138" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="38138" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_14 -->
<g id="edge458" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37012.32,-1413.51C37263.47,-1406.54 37830.62,-1386.35 38040.74,-1340.01"/>
<polygon fill="black" stroke="black" points="38041.8,-1343.35 38050.77,-1337.71 38040.24,-1336.53 38041.8,-1343.35"/>
</g>
<!-- layer1_expert4_15 -->
<g id="node286" class="node">
<title>layer1_expert4_15</title>
<polygon fill="lightgreen" stroke="black" points="38417,-1340 38243,-1340 38243,-1257 38417,-1257 38417,-1340"/>
<text text-anchor="middle" x="38330" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU4</text>
<text text-anchor="middle" x="38330" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="38330" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="38330" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="38330" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_15 -->
<g id="edge459" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37012.15,-1414.87C37294.11,-1410.26 37984.49,-1393.9 38232.71,-1340.01"/>
<polygon fill="black" stroke="black" points="38233.79,-1343.35 38242.78,-1337.75 38232.25,-1336.52 38233.79,-1343.35"/>
</g>
<!-- layer1_moe_agg_gpu4 -->
<g id="node287" class="node">
<title>layer1_moe_agg_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="36895.5,-1213.5 36692.5,-1213.5 36692.5,-1145.5 36895.5,-1145.5 36895.5,-1213.5"/>
<text text-anchor="middle" x="36794" y="-1198.3" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU4</text>
<text text-anchor="middle" x="36794" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="36794" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="36794" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_expert4_0&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge460" class="edge">
<title>layer1_expert4_0&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M35537.22,-1259.27C35540.16,-1258.44 35543.09,-1257.68 35546,-1257 35760.27,-1206.78 36418.06,-1188.12 36682.35,-1182.53"/>
<polygon fill="black" stroke="black" points="36682.42,-1186.03 36692.35,-1182.32 36682.28,-1179.03 36682.42,-1186.03"/>
</g>
<!-- layer1_expert4_1&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge461" class="edge">
<title>layer1_expert4_1&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M35729.23,-1259.31C35732.17,-1258.47 35735.1,-1257.7 35738,-1257 35914.66,-1214.56 36448.19,-1192.05 36682.08,-1183.99"/>
<polygon fill="black" stroke="black" points="36682.44,-1187.48 36692.31,-1183.64 36682.2,-1180.49 36682.44,-1187.48"/>
</g>
<!-- layer1_expert4_2&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge462" class="edge">
<title>layer1_expert4_2&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M35921.25,-1259.37C35924.18,-1258.52 35927.1,-1257.72 35930,-1257 36069.51,-1222.3 36481.52,-1196.81 36681.96,-1186.09"/>
<polygon fill="black" stroke="black" points="36682.42,-1189.57 36692.22,-1185.54 36682.04,-1182.58 36682.42,-1189.57"/>
</g>
<!-- layer1_expert4_3&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge463" class="edge">
<title>layer1_expert4_3&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M36113.01,-1259.55C36116.02,-1258.63 36119.03,-1257.78 36122,-1257 36314.76,-1206.49 36547.26,-1189.33 36682.11,-1183.5"/>
<polygon fill="black" stroke="black" points="36682.6,-1186.98 36692.45,-1183.07 36682.31,-1179.99 36682.6,-1186.98"/>
</g>
<!-- layer1_expert4_4&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge464" class="edge">
<title>layer1_expert4_4&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M36305.06,-1259.72C36308.06,-1258.76 36311.04,-1257.85 36314,-1257 36437.54,-1221.66 36583.93,-1201.29 36682.29,-1190.59"/>
<polygon fill="black" stroke="black" points="36682.68,-1194.07 36692.25,-1189.53 36681.94,-1187.11 36682.68,-1194.07"/>
</g>
<!-- layer1_expert4_5&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge465" class="edge">
<title>layer1_expert4_5&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M36497.18,-1260.11C36500.14,-1259.04 36503.09,-1257.99 36506,-1257 36563.37,-1237.38 36628.58,-1219.7 36682.42,-1206.28"/>
<polygon fill="black" stroke="black" points="36683.47,-1209.63 36692.34,-1203.83 36681.79,-1202.83 36683.47,-1209.63"/>
</g>
<!-- layer1_expert4_6&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge466" class="edge">
<title>layer1_expert4_6&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M36668.61,-1256.91C36688.8,-1244.6 36710.91,-1231.13 36730.87,-1218.97"/>
<polygon fill="black" stroke="black" points="36732.85,-1221.86 36739.57,-1213.67 36729.21,-1215.88 36732.85,-1221.86"/>
</g>
<!-- layer1_expert4_7&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge467" class="edge">
<title>layer1_expert4_7&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M36794,-1256.91C36794,-1246.2 36794,-1234.62 36794,-1223.78"/>
<polygon fill="black" stroke="black" points="36797.5,-1223.67 36794,-1213.67 36790.5,-1223.67 36797.5,-1223.67"/>
</g>
<!-- layer1_expert4_8&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge468" class="edge">
<title>layer1_expert4_8&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M36919.39,-1256.91C36899.2,-1244.6 36877.09,-1231.13 36857.13,-1218.97"/>
<polygon fill="black" stroke="black" points="36858.79,-1215.88 36848.43,-1213.67 36855.15,-1221.86 36858.79,-1215.88"/>
</g>
<!-- layer1_expert4_9&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge469" class="edge">
<title>layer1_expert4_9&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M37090.82,-1260.11C37087.86,-1259.04 37084.91,-1257.99 37082,-1257 37024.63,-1237.38 36959.42,-1219.7 36905.58,-1206.28"/>
<polygon fill="black" stroke="black" points="36906.21,-1202.83 36895.66,-1203.83 36904.53,-1209.63 36906.21,-1202.83"/>
</g>
<!-- layer1_expert4_10&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge470" class="edge">
<title>layer1_expert4_10&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M37282.94,-1259.72C37279.94,-1258.76 37276.96,-1257.85 37274,-1257 37150.46,-1221.66 37004.07,-1201.29 36905.71,-1190.59"/>
<polygon fill="black" stroke="black" points="36906.06,-1187.11 36895.75,-1189.53 36905.32,-1194.07 36906.06,-1187.11"/>
</g>
<!-- layer1_expert4_11&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge471" class="edge">
<title>layer1_expert4_11&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M37474.99,-1259.55C37471.98,-1258.63 37468.97,-1257.78 37466,-1257 37273.24,-1206.49 37040.74,-1189.33 36905.89,-1183.5"/>
<polygon fill="black" stroke="black" points="36905.69,-1179.99 36895.55,-1183.07 36905.4,-1186.98 36905.69,-1179.99"/>
</g>
<!-- layer1_expert4_12&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge472" class="edge">
<title>layer1_expert4_12&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M37666.75,-1259.37C37663.82,-1258.52 37660.9,-1257.72 37658,-1257 37518.49,-1222.3 37106.48,-1196.81 36906.04,-1186.09"/>
<polygon fill="black" stroke="black" points="36905.96,-1182.58 36895.78,-1185.54 36905.58,-1189.57 36905.96,-1182.58"/>
</g>
<!-- layer1_expert4_13&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge473" class="edge">
<title>layer1_expert4_13&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M37858.77,-1259.31C37855.83,-1258.47 37852.9,-1257.7 37850,-1257 37673.34,-1214.56 37139.81,-1192.05 36905.92,-1183.99"/>
<polygon fill="black" stroke="black" points="36905.8,-1180.49 36895.69,-1183.64 36905.56,-1187.48 36905.8,-1180.49"/>
</g>
<!-- layer1_expert4_14&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge474" class="edge">
<title>layer1_expert4_14&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M38050.78,-1259.27C38047.84,-1258.44 38044.91,-1257.68 38042,-1257 37827.73,-1206.78 37169.94,-1188.12 36905.65,-1182.53"/>
<polygon fill="black" stroke="black" points="36905.72,-1179.03 36895.65,-1182.32 36905.58,-1186.03 36905.72,-1179.03"/>
</g>
<!-- layer1_expert4_15&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge475" class="edge">
<title>layer1_expert4_15&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M38242.78,-1259.24C38239.84,-1258.42 38236.91,-1257.67 38234,-1257 37981.96,-1199.01 37198.77,-1184.79 36905.96,-1181.47"/>
<polygon fill="black" stroke="black" points="36905.79,-1177.97 36895.75,-1181.35 36905.71,-1184.97 36905.79,-1177.97"/>
</g>
<!-- layer1_output_gpu4 -->
<g id="node288" class="node">
<title>layer1_output_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="35607,-1102 35363,-1102 35363,-1034 35607,-1034 35607,-1102"/>
<text text-anchor="middle" x="35485" y="-1086.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="35485" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="35485" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="35485" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_moe_agg_gpu4&#45;&gt;layer1_output_gpu4 -->
<g id="edge476" class="edge">
<title>layer1_moe_agg_gpu4&#45;&gt;layer1_output_gpu4</title>
<path fill="none" stroke="black" d="M36692.37,-1170C36457.93,-1150.39 35879.34,-1101.99 35617.51,-1080.08"/>
<polygon fill="black" stroke="black" points="35617.44,-1076.57 35607.18,-1079.22 35616.86,-1083.54 35617.44,-1076.57"/>
</g>
<!-- layer1_output_gpu4&#45;&gt;pipeline_stage0_1 -->
<g id="edge589" class="edge">
<title>layer1_output_gpu4&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M35398.75,-1033.86C35373.57,-1024.19 35344.82,-1013.14 35315.25,-1001.78"/>
<polygon fill="black" stroke="black" points="35316.21,-998.4 35305.62,-998.08 35313.7,-1004.93 35316.21,-998.4"/>
</g>
<!-- layer1_qkv_gpu5 -->
<g id="node289" class="node">
<title>layer1_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="40068,-1778.48 39856,-1778.48 39856,-1710.48 40068,-1710.48 40068,-1778.48"/>
<text text-anchor="middle" x="39962" y="-1763.28" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="39962" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="39962" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="39962" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_gpu5 -->
<g id="node290" class="node">
<title>layer1_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="40083.5,-1667 39840.5,-1667 39840.5,-1599 40083.5,-1599 40083.5,-1667"/>
<text text-anchor="middle" x="39962" y="-1651.8" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="39962" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="39962" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="39962" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_qkv_gpu5&#45;&gt;layer1_attn_gpu5 -->
<g id="edge477" class="edge">
<title>layer1_qkv_gpu5&#45;&gt;layer1_attn_gpu5</title>
<path fill="none" stroke="black" d="M39962,-1710.33C39962,-1699.94 39962,-1688.3 39962,-1677.31"/>
<polygon fill="black" stroke="black" points="39965.5,-1677.03 39962,-1667.03 39958.5,-1677.03 39965.5,-1677.03"/>
</g>
<!-- layer1_attn_norm_gpu5 -->
<g id="node291" class="node">
<title>layer1_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="40084,-1563 39840,-1563 39840,-1495 40084,-1495 40084,-1563"/>
<text text-anchor="middle" x="39962" y="-1547.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="39962" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="39962" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="39962" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_gpu5&#45;&gt;layer1_attn_norm_gpu5 -->
<g id="edge478" class="edge">
<title>layer1_attn_gpu5&#45;&gt;layer1_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M39962,-1598.88C39962,-1590.78 39962,-1581.98 39962,-1573.47"/>
<polygon fill="black" stroke="black" points="39965.5,-1573.3 39962,-1563.3 39958.5,-1573.3 39965.5,-1573.3"/>
</g>
<!-- layer1_gate_gpu5 -->
<g id="node292" class="node">
<title>layer1_gate_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="40084,-1459 39840,-1459 39840,-1376 40084,-1376 40084,-1459"/>
<text text-anchor="middle" x="39962" y="-1443.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU5</text>
<text text-anchor="middle" x="39962" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="39962" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="39962" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="39962" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_norm_gpu5&#45;&gt;layer1_gate_gpu5 -->
<g id="edge479" class="edge">
<title>layer1_attn_norm_gpu5&#45;&gt;layer1_gate_gpu5</title>
<path fill="none" stroke="black" d="M39962,-1494.85C39962,-1486.8 39962,-1478 39962,-1469.34"/>
<polygon fill="black" stroke="black" points="39965.5,-1469.28 39962,-1459.28 39958.5,-1469.28 39965.5,-1469.28"/>
</g>
<!-- layer1_expert5_0 -->
<g id="node293" class="node">
<title>layer1_expert5_0</title>
<polygon fill="lightgreen" stroke="black" points="38609,-1340 38435,-1340 38435,-1257 38609,-1257 38609,-1340"/>
<text text-anchor="middle" x="38522" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU5</text>
<text text-anchor="middle" x="38522" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="38522" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="38522" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="38522" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_0 -->
<g id="edge480" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39839.85,-1414.87C39557.89,-1410.26 38867.51,-1393.9 38619.29,-1340.01"/>
<polygon fill="black" stroke="black" points="38619.75,-1336.52 38609.22,-1337.75 38618.21,-1343.35 38619.75,-1336.52"/>
</g>
<!-- layer1_expert5_1 -->
<g id="node294" class="node">
<title>layer1_expert5_1</title>
<polygon fill="lightgreen" stroke="black" points="38801,-1340 38627,-1340 38627,-1257 38801,-1257 38801,-1340"/>
<text text-anchor="middle" x="38714" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU5</text>
<text text-anchor="middle" x="38714" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="38714" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="38714" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="38714" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_1 -->
<g id="edge481" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39839.68,-1413.51C39588.53,-1406.54 39021.38,-1386.35 38811.26,-1340.01"/>
<polygon fill="black" stroke="black" points="38811.76,-1336.53 38801.23,-1337.71 38810.2,-1343.35 38811.76,-1336.53"/>
</g>
<!-- layer1_expert5_2 -->
<g id="node295" class="node">
<title>layer1_expert5_2</title>
<polygon fill="lightgreen" stroke="black" points="38993,-1340 38819,-1340 38819,-1257 38993,-1257 38993,-1340"/>
<text text-anchor="middle" x="38906" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU5</text>
<text text-anchor="middle" x="38906" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="38906" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="38906" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="38906" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_2 -->
<g id="edge482" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39839.94,-1411.63C39622.49,-1402.15 39175.52,-1378.91 39003.21,-1340"/>
<polygon fill="black" stroke="black" points="39003.78,-1336.54 38993.24,-1337.66 39002.17,-1343.36 39003.78,-1336.54"/>
</g>
<!-- layer1_expert5_3 -->
<g id="node296" class="node">
<title>layer1_expert5_3</title>
<polygon fill="lightgreen" stroke="black" points="39185,-1340 39011,-1340 39011,-1257 39185,-1257 39185,-1340"/>
<text text-anchor="middle" x="39098" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU5</text>
<text text-anchor="middle" x="39098" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="39098" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="39098" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="39098" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_3 -->
<g id="edge483" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39839.67,-1415.54C39688.64,-1411.85 39424.63,-1397.19 39195.13,-1340.07"/>
<polygon fill="black" stroke="black" points="39195.81,-1336.63 39185.26,-1337.58 39194.1,-1343.42 39195.81,-1336.63"/>
</g>
<!-- layer1_expert5_4 -->
<g id="node297" class="node">
<title>layer1_expert5_4</title>
<polygon fill="lightgreen" stroke="black" points="39377,-1340 39203,-1340 39203,-1257 39377,-1257 39377,-1340"/>
<text text-anchor="middle" x="39290" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU5</text>
<text text-anchor="middle" x="39290" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="39290" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="39290" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="39290" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_4 -->
<g id="edge484" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39839.89,-1409.76C39724.42,-1401.23 39546.78,-1382.5 39387.04,-1340.07"/>
<polygon fill="black" stroke="black" points="39387.59,-1336.6 39377.03,-1337.38 39385.77,-1343.36 39387.59,-1336.6"/>
</g>
<!-- layer1_expert5_5 -->
<g id="node298" class="node">
<title>layer1_expert5_5</title>
<polygon fill="lightgreen" stroke="black" points="39569,-1340 39395,-1340 39395,-1257 39569,-1257 39569,-1340"/>
<text text-anchor="middle" x="39482" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU5</text>
<text text-anchor="middle" x="39482" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="39482" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="39482" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="39482" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_5 -->
<g id="edge485" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39839.8,-1398.65C39766.17,-1386.36 39670.72,-1367.72 39578.84,-1340.09"/>
<polygon fill="black" stroke="black" points="39579.69,-1336.69 39569.1,-1337.13 39577.65,-1343.39 39579.69,-1336.69"/>
</g>
<!-- layer1_expert5_6 -->
<g id="node299" class="node">
<title>layer1_expert5_6</title>
<polygon fill="lightgreen" stroke="black" points="39761,-1340 39587,-1340 39587,-1257 39761,-1257 39761,-1340"/>
<text text-anchor="middle" x="39674" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU5</text>
<text text-anchor="middle" x="39674" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="39674" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="39674" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="39674" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_6 -->
<g id="edge486" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39859.21,-1375.99C39832.79,-1365.46 39804.27,-1354.01 39770.69,-1340.27"/>
<polygon fill="black" stroke="black" points="39771.67,-1336.88 39761.09,-1336.33 39769.01,-1343.36 39771.67,-1336.88"/>
</g>
<!-- layer1_expert5_7 -->
<g id="node300" class="node">
<title>layer1_expert5_7</title>
<polygon fill="lightgreen" stroke="black" points="39953,-1340 39779,-1340 39779,-1257 39953,-1257 39953,-1340"/>
<text text-anchor="middle" x="39866" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU5</text>
<text text-anchor="middle" x="39866" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="39866" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="39866" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="39866" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_7 -->
<g id="edge487" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39928.69,-1375.91C39921.25,-1366.83 39913.28,-1357.12 39905.61,-1347.77"/>
<polygon fill="black" stroke="black" points="39908.3,-1345.53 39899.25,-1340.02 39902.89,-1349.97 39908.3,-1345.53"/>
</g>
<!-- layer1_expert5_8 -->
<g id="node301" class="node">
<title>layer1_expert5_8</title>
<polygon fill="lightgreen" stroke="black" points="40145,-1340 39971,-1340 39971,-1257 40145,-1257 40145,-1340"/>
<text text-anchor="middle" x="40058" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU5</text>
<text text-anchor="middle" x="40058" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="40058" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="40058" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="40058" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_8 -->
<g id="edge488" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39995.31,-1375.91C40002.75,-1366.83 40010.72,-1357.12 40018.39,-1347.77"/>
<polygon fill="black" stroke="black" points="40021.11,-1349.97 40024.75,-1340.02 40015.7,-1345.53 40021.11,-1349.97"/>
</g>
<!-- layer1_expert5_9 -->
<g id="node302" class="node">
<title>layer1_expert5_9</title>
<polygon fill="lightgreen" stroke="black" points="40337,-1340 40163,-1340 40163,-1257 40337,-1257 40337,-1340"/>
<text text-anchor="middle" x="40250" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU5</text>
<text text-anchor="middle" x="40250" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="40250" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="40250" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="40250" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_9 -->
<g id="edge489" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40064.79,-1375.99C40091.21,-1365.46 40119.73,-1354.01 40153.31,-1340.27"/>
<polygon fill="black" stroke="black" points="40154.99,-1343.36 40162.91,-1336.33 40152.33,-1336.88 40154.99,-1343.36"/>
</g>
<!-- layer1_expert5_10 -->
<g id="node303" class="node">
<title>layer1_expert5_10</title>
<polygon fill="lightgreen" stroke="black" points="40529,-1340 40355,-1340 40355,-1257 40529,-1257 40529,-1340"/>
<text text-anchor="middle" x="40442" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU5</text>
<text text-anchor="middle" x="40442" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="40442" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="40442" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="40442" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_10 -->
<g id="edge490" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40084.2,-1398.65C40157.83,-1386.36 40253.28,-1367.72 40345.16,-1340.09"/>
<polygon fill="black" stroke="black" points="40346.35,-1343.39 40354.9,-1337.13 40344.31,-1336.69 40346.35,-1343.39"/>
</g>
<!-- layer1_expert5_11 -->
<g id="node304" class="node">
<title>layer1_expert5_11</title>
<polygon fill="lightgreen" stroke="black" points="40721,-1340 40547,-1340 40547,-1257 40721,-1257 40721,-1340"/>
<text text-anchor="middle" x="40634" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU5</text>
<text text-anchor="middle" x="40634" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="40634" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="40634" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="40634" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_11 -->
<g id="edge491" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40084.11,-1409.76C40199.58,-1401.23 40377.22,-1382.5 40536.96,-1340.07"/>
<polygon fill="black" stroke="black" points="40538.23,-1343.36 40546.97,-1337.38 40536.41,-1336.6 40538.23,-1343.36"/>
</g>
<!-- layer1_expert5_12 -->
<g id="node305" class="node">
<title>layer1_expert5_12</title>
<polygon fill="lightgreen" stroke="black" points="40913,-1340 40739,-1340 40739,-1257 40913,-1257 40913,-1340"/>
<text text-anchor="middle" x="40826" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU5</text>
<text text-anchor="middle" x="40826" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="40826" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="40826" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="40826" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_12 -->
<g id="edge492" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40084.33,-1415.54C40235.36,-1411.85 40499.37,-1397.19 40728.87,-1340.07"/>
<polygon fill="black" stroke="black" points="40729.9,-1343.42 40738.74,-1337.58 40728.19,-1336.63 40729.9,-1343.42"/>
</g>
<!-- layer1_expert5_13 -->
<g id="node306" class="node">
<title>layer1_expert5_13</title>
<polygon fill="lightgreen" stroke="black" points="41105,-1340 40931,-1340 40931,-1257 41105,-1257 41105,-1340"/>
<text text-anchor="middle" x="41018" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU5</text>
<text text-anchor="middle" x="41018" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41018" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41018" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41018" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_13 -->
<g id="edge493" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40084.06,-1411.63C40301.51,-1402.15 40748.48,-1378.91 40920.79,-1340"/>
<polygon fill="black" stroke="black" points="40921.83,-1343.36 40930.76,-1337.66 40920.22,-1336.54 40921.83,-1343.36"/>
</g>
<!-- layer1_expert5_14 -->
<g id="node307" class="node">
<title>layer1_expert5_14</title>
<polygon fill="lightgreen" stroke="black" points="41297,-1340 41123,-1340 41123,-1257 41297,-1257 41297,-1340"/>
<text text-anchor="middle" x="41210" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU5</text>
<text text-anchor="middle" x="41210" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41210" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41210" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41210" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_14 -->
<g id="edge494" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40084.32,-1413.51C40335.47,-1406.54 40902.62,-1386.35 41112.74,-1340.01"/>
<polygon fill="black" stroke="black" points="41113.8,-1343.35 41122.77,-1337.71 41112.24,-1336.53 41113.8,-1343.35"/>
</g>
<!-- layer1_expert5_15 -->
<g id="node308" class="node">
<title>layer1_expert5_15</title>
<polygon fill="lightgreen" stroke="black" points="41489,-1340 41315,-1340 41315,-1257 41489,-1257 41489,-1340"/>
<text text-anchor="middle" x="41402" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU5</text>
<text text-anchor="middle" x="41402" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41402" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41402" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41402" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_15 -->
<g id="edge495" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40084.15,-1414.87C40366.11,-1410.26 41056.49,-1393.9 41304.71,-1340.01"/>
<polygon fill="black" stroke="black" points="41305.79,-1343.35 41314.78,-1337.75 41304.25,-1336.52 41305.79,-1343.35"/>
</g>
<!-- layer1_moe_agg_gpu5 -->
<g id="node309" class="node">
<title>layer1_moe_agg_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="39967.5,-1213.5 39764.5,-1213.5 39764.5,-1145.5 39967.5,-1145.5 39967.5,-1213.5"/>
<text text-anchor="middle" x="39866" y="-1198.3" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU5</text>
<text text-anchor="middle" x="39866" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="39866" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="39866" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_expert5_0&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge496" class="edge">
<title>layer1_expert5_0&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M38609.22,-1259.27C38612.16,-1258.44 38615.09,-1257.68 38618,-1257 38832.27,-1206.78 39490.06,-1188.12 39754.35,-1182.53"/>
<polygon fill="black" stroke="black" points="39754.42,-1186.03 39764.35,-1182.32 39754.28,-1179.03 39754.42,-1186.03"/>
</g>
<!-- layer1_expert5_1&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge497" class="edge">
<title>layer1_expert5_1&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M38801.23,-1259.31C38804.17,-1258.47 38807.1,-1257.7 38810,-1257 38986.66,-1214.56 39520.19,-1192.05 39754.08,-1183.99"/>
<polygon fill="black" stroke="black" points="39754.44,-1187.48 39764.31,-1183.64 39754.2,-1180.49 39754.44,-1187.48"/>
</g>
<!-- layer1_expert5_2&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge498" class="edge">
<title>layer1_expert5_2&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M38993.25,-1259.37C38996.18,-1258.52 38999.1,-1257.72 39002,-1257 39141.51,-1222.3 39553.52,-1196.81 39753.96,-1186.09"/>
<polygon fill="black" stroke="black" points="39754.42,-1189.57 39764.22,-1185.54 39754.04,-1182.58 39754.42,-1189.57"/>
</g>
<!-- layer1_expert5_3&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge499" class="edge">
<title>layer1_expert5_3&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M39185.01,-1259.55C39188.02,-1258.63 39191.03,-1257.78 39194,-1257 39386.76,-1206.49 39619.26,-1189.33 39754.11,-1183.5"/>
<polygon fill="black" stroke="black" points="39754.6,-1186.98 39764.45,-1183.07 39754.31,-1179.99 39754.6,-1186.98"/>
</g>
<!-- layer1_expert5_4&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge500" class="edge">
<title>layer1_expert5_4&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M39377.06,-1259.72C39380.06,-1258.76 39383.04,-1257.85 39386,-1257 39509.54,-1221.66 39655.93,-1201.29 39754.29,-1190.59"/>
<polygon fill="black" stroke="black" points="39754.68,-1194.07 39764.25,-1189.53 39753.94,-1187.11 39754.68,-1194.07"/>
</g>
<!-- layer1_expert5_5&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge501" class="edge">
<title>layer1_expert5_5&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M39569.18,-1260.11C39572.14,-1259.04 39575.09,-1257.99 39578,-1257 39635.37,-1237.38 39700.58,-1219.7 39754.42,-1206.28"/>
<polygon fill="black" stroke="black" points="39755.47,-1209.63 39764.34,-1203.83 39753.79,-1202.83 39755.47,-1209.63"/>
</g>
<!-- layer1_expert5_6&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge502" class="edge">
<title>layer1_expert5_6&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M39740.61,-1256.91C39760.8,-1244.6 39782.91,-1231.13 39802.87,-1218.97"/>
<polygon fill="black" stroke="black" points="39804.85,-1221.86 39811.57,-1213.67 39801.21,-1215.88 39804.85,-1221.86"/>
</g>
<!-- layer1_expert5_7&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge503" class="edge">
<title>layer1_expert5_7&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M39866,-1256.91C39866,-1246.2 39866,-1234.62 39866,-1223.78"/>
<polygon fill="black" stroke="black" points="39869.5,-1223.67 39866,-1213.67 39862.5,-1223.67 39869.5,-1223.67"/>
</g>
<!-- layer1_expert5_8&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge504" class="edge">
<title>layer1_expert5_8&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M39991.39,-1256.91C39971.2,-1244.6 39949.09,-1231.13 39929.13,-1218.97"/>
<polygon fill="black" stroke="black" points="39930.79,-1215.88 39920.43,-1213.67 39927.15,-1221.86 39930.79,-1215.88"/>
</g>
<!-- layer1_expert5_9&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge505" class="edge">
<title>layer1_expert5_9&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M40162.82,-1260.11C40159.86,-1259.04 40156.91,-1257.99 40154,-1257 40096.63,-1237.38 40031.42,-1219.7 39977.58,-1206.28"/>
<polygon fill="black" stroke="black" points="39978.21,-1202.83 39967.66,-1203.83 39976.53,-1209.63 39978.21,-1202.83"/>
</g>
<!-- layer1_expert5_10&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge506" class="edge">
<title>layer1_expert5_10&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M40354.94,-1259.72C40351.94,-1258.76 40348.96,-1257.85 40346,-1257 40222.46,-1221.66 40076.07,-1201.29 39977.71,-1190.59"/>
<polygon fill="black" stroke="black" points="39978.06,-1187.11 39967.75,-1189.53 39977.32,-1194.07 39978.06,-1187.11"/>
</g>
<!-- layer1_expert5_11&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge507" class="edge">
<title>layer1_expert5_11&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M40546.99,-1259.55C40543.98,-1258.63 40540.97,-1257.78 40538,-1257 40345.24,-1206.49 40112.74,-1189.33 39977.89,-1183.5"/>
<polygon fill="black" stroke="black" points="39977.69,-1179.99 39967.55,-1183.07 39977.4,-1186.98 39977.69,-1179.99"/>
</g>
<!-- layer1_expert5_12&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge508" class="edge">
<title>layer1_expert5_12&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M40738.75,-1259.37C40735.82,-1258.52 40732.9,-1257.72 40730,-1257 40590.49,-1222.3 40178.48,-1196.81 39978.04,-1186.09"/>
<polygon fill="black" stroke="black" points="39977.96,-1182.58 39967.78,-1185.54 39977.58,-1189.57 39977.96,-1182.58"/>
</g>
<!-- layer1_expert5_13&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge509" class="edge">
<title>layer1_expert5_13&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M40930.77,-1259.31C40927.83,-1258.47 40924.9,-1257.7 40922,-1257 40745.34,-1214.56 40211.81,-1192.05 39977.92,-1183.99"/>
<polygon fill="black" stroke="black" points="39977.8,-1180.49 39967.69,-1183.64 39977.56,-1187.48 39977.8,-1180.49"/>
</g>
<!-- layer1_expert5_14&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge510" class="edge">
<title>layer1_expert5_14&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M41122.78,-1259.27C41119.84,-1258.44 41116.91,-1257.68 41114,-1257 40899.73,-1206.78 40241.94,-1188.12 39977.65,-1182.53"/>
<polygon fill="black" stroke="black" points="39977.72,-1179.03 39967.65,-1182.32 39977.58,-1186.03 39977.72,-1179.03"/>
</g>
<!-- layer1_expert5_15&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge511" class="edge">
<title>layer1_expert5_15&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M41314.78,-1259.24C41311.84,-1258.42 41308.91,-1257.67 41306,-1257 41053.96,-1199.01 40270.77,-1184.79 39977.96,-1181.47"/>
<polygon fill="black" stroke="black" points="39977.79,-1177.97 39967.75,-1181.35 39977.71,-1184.97 39977.79,-1177.97"/>
</g>
<!-- layer1_output_gpu5 -->
<g id="node310" class="node">
<title>layer1_output_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="37929,-1102 37685,-1102 37685,-1034 37929,-1034 37929,-1102"/>
<text text-anchor="middle" x="37807" y="-1086.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="37807" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="37807" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="37807" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_moe_agg_gpu5&#45;&gt;layer1_output_gpu5 -->
<g id="edge512" class="edge">
<title>layer1_moe_agg_gpu5&#45;&gt;layer1_output_gpu5</title>
<path fill="none" stroke="black" d="M39764.25,-1173.09C39423.34,-1154.96 38321.49,-1096.36 37939.14,-1076.03"/>
<polygon fill="black" stroke="black" points="37939.31,-1072.53 37929.14,-1075.5 37938.94,-1079.52 37939.31,-1072.53"/>
</g>
<!-- layer1_output_gpu5&#45;&gt;pipeline_stage0_1 -->
<g id="edge590" class="edge">
<title>layer1_output_gpu5&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M37684.62,-1060.19C37254.56,-1036.28 35810.25,-955.95 35285.03,-926.74"/>
<polygon fill="black" stroke="black" points="35284.87,-923.22 35274.69,-926.16 35284.48,-930.21 35284.87,-923.22"/>
</g>
<!-- layer1_qkv_gpu6 -->
<g id="node311" class="node">
<title>layer1_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="43140,-1778.48 42928,-1778.48 42928,-1710.48 43140,-1710.48 43140,-1778.48"/>
<text text-anchor="middle" x="43034" y="-1763.28" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="43034" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="43034" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="43034" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_gpu6 -->
<g id="node312" class="node">
<title>layer1_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="43155.5,-1667 42912.5,-1667 42912.5,-1599 43155.5,-1599 43155.5,-1667"/>
<text text-anchor="middle" x="43034" y="-1651.8" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="43034" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="43034" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="43034" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_qkv_gpu6&#45;&gt;layer1_attn_gpu6 -->
<g id="edge513" class="edge">
<title>layer1_qkv_gpu6&#45;&gt;layer1_attn_gpu6</title>
<path fill="none" stroke="black" d="M43034,-1710.33C43034,-1699.94 43034,-1688.3 43034,-1677.31"/>
<polygon fill="black" stroke="black" points="43037.5,-1677.03 43034,-1667.03 43030.5,-1677.03 43037.5,-1677.03"/>
</g>
<!-- layer1_attn_norm_gpu6 -->
<g id="node313" class="node">
<title>layer1_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="43156,-1563 42912,-1563 42912,-1495 43156,-1495 43156,-1563"/>
<text text-anchor="middle" x="43034" y="-1547.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="43034" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="43034" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="43034" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_gpu6&#45;&gt;layer1_attn_norm_gpu6 -->
<g id="edge514" class="edge">
<title>layer1_attn_gpu6&#45;&gt;layer1_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M43034,-1598.88C43034,-1590.78 43034,-1581.98 43034,-1573.47"/>
<polygon fill="black" stroke="black" points="43037.5,-1573.3 43034,-1563.3 43030.5,-1573.3 43037.5,-1573.3"/>
</g>
<!-- layer1_gate_gpu6 -->
<g id="node314" class="node">
<title>layer1_gate_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="43156,-1459 42912,-1459 42912,-1376 43156,-1376 43156,-1459"/>
<text text-anchor="middle" x="43034" y="-1443.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU6</text>
<text text-anchor="middle" x="43034" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="43034" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="43034" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="43034" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_norm_gpu6&#45;&gt;layer1_gate_gpu6 -->
<g id="edge515" class="edge">
<title>layer1_attn_norm_gpu6&#45;&gt;layer1_gate_gpu6</title>
<path fill="none" stroke="black" d="M43034,-1494.85C43034,-1486.8 43034,-1478 43034,-1469.34"/>
<polygon fill="black" stroke="black" points="43037.5,-1469.28 43034,-1459.28 43030.5,-1469.28 43037.5,-1469.28"/>
</g>
<!-- layer1_expert6_0 -->
<g id="node315" class="node">
<title>layer1_expert6_0</title>
<polygon fill="lightgreen" stroke="black" points="41681,-1340 41507,-1340 41507,-1257 41681,-1257 41681,-1340"/>
<text text-anchor="middle" x="41594" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU6</text>
<text text-anchor="middle" x="41594" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41594" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41594" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41594" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_0 -->
<g id="edge516" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42911.85,-1414.87C42629.89,-1410.26 41939.51,-1393.9 41691.29,-1340.01"/>
<polygon fill="black" stroke="black" points="41691.75,-1336.52 41681.22,-1337.75 41690.21,-1343.35 41691.75,-1336.52"/>
</g>
<!-- layer1_expert6_1 -->
<g id="node316" class="node">
<title>layer1_expert6_1</title>
<polygon fill="lightgreen" stroke="black" points="41873,-1340 41699,-1340 41699,-1257 41873,-1257 41873,-1340"/>
<text text-anchor="middle" x="41786" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU6</text>
<text text-anchor="middle" x="41786" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41786" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41786" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41786" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_1 -->
<g id="edge517" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42911.68,-1413.51C42660.53,-1406.54 42093.38,-1386.35 41883.26,-1340.01"/>
<polygon fill="black" stroke="black" points="41883.76,-1336.53 41873.23,-1337.71 41882.2,-1343.35 41883.76,-1336.53"/>
</g>
<!-- layer1_expert6_2 -->
<g id="node317" class="node">
<title>layer1_expert6_2</title>
<polygon fill="lightgreen" stroke="black" points="42065,-1340 41891,-1340 41891,-1257 42065,-1257 42065,-1340"/>
<text text-anchor="middle" x="41978" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU6</text>
<text text-anchor="middle" x="41978" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41978" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41978" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41978" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_2 -->
<g id="edge518" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42911.94,-1411.63C42694.49,-1402.15 42247.52,-1378.91 42075.21,-1340"/>
<polygon fill="black" stroke="black" points="42075.78,-1336.54 42065.24,-1337.66 42074.17,-1343.36 42075.78,-1336.54"/>
</g>
<!-- layer1_expert6_3 -->
<g id="node318" class="node">
<title>layer1_expert6_3</title>
<polygon fill="lightgreen" stroke="black" points="42257,-1340 42083,-1340 42083,-1257 42257,-1257 42257,-1340"/>
<text text-anchor="middle" x="42170" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU6</text>
<text text-anchor="middle" x="42170" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="42170" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="42170" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="42170" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_3 -->
<g id="edge519" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42911.67,-1415.54C42760.64,-1411.85 42496.63,-1397.19 42267.13,-1340.07"/>
<polygon fill="black" stroke="black" points="42267.81,-1336.63 42257.26,-1337.58 42266.1,-1343.42 42267.81,-1336.63"/>
</g>
<!-- layer1_expert6_4 -->
<g id="node319" class="node">
<title>layer1_expert6_4</title>
<polygon fill="lightgreen" stroke="black" points="42449,-1340 42275,-1340 42275,-1257 42449,-1257 42449,-1340"/>
<text text-anchor="middle" x="42362" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU6</text>
<text text-anchor="middle" x="42362" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="42362" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="42362" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="42362" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_4 -->
<g id="edge520" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42911.89,-1409.76C42796.42,-1401.23 42618.78,-1382.5 42459.04,-1340.07"/>
<polygon fill="black" stroke="black" points="42459.59,-1336.6 42449.03,-1337.38 42457.77,-1343.36 42459.59,-1336.6"/>
</g>
<!-- layer1_expert6_5 -->
<g id="node320" class="node">
<title>layer1_expert6_5</title>
<polygon fill="lightgreen" stroke="black" points="42641,-1340 42467,-1340 42467,-1257 42641,-1257 42641,-1340"/>
<text text-anchor="middle" x="42554" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU6</text>
<text text-anchor="middle" x="42554" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="42554" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="42554" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="42554" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_5 -->
<g id="edge521" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42911.8,-1398.65C42838.17,-1386.36 42742.72,-1367.72 42650.84,-1340.09"/>
<polygon fill="black" stroke="black" points="42651.69,-1336.69 42641.1,-1337.13 42649.65,-1343.39 42651.69,-1336.69"/>
</g>
<!-- layer1_expert6_6 -->
<g id="node321" class="node">
<title>layer1_expert6_6</title>
<polygon fill="lightgreen" stroke="black" points="42833,-1340 42659,-1340 42659,-1257 42833,-1257 42833,-1340"/>
<text text-anchor="middle" x="42746" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU6</text>
<text text-anchor="middle" x="42746" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="42746" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="42746" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="42746" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_6 -->
<g id="edge522" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42931.21,-1375.99C42904.79,-1365.46 42876.27,-1354.01 42842.69,-1340.27"/>
<polygon fill="black" stroke="black" points="42843.67,-1336.88 42833.09,-1336.33 42841.01,-1343.36 42843.67,-1336.88"/>
</g>
<!-- layer1_expert6_7 -->
<g id="node322" class="node">
<title>layer1_expert6_7</title>
<polygon fill="lightgreen" stroke="black" points="43025,-1340 42851,-1340 42851,-1257 43025,-1257 43025,-1340"/>
<text text-anchor="middle" x="42938" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU6</text>
<text text-anchor="middle" x="42938" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="42938" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="42938" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="42938" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_7 -->
<g id="edge523" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43000.69,-1375.91C42993.25,-1366.83 42985.28,-1357.12 42977.61,-1347.77"/>
<polygon fill="black" stroke="black" points="42980.3,-1345.53 42971.25,-1340.02 42974.89,-1349.97 42980.3,-1345.53"/>
</g>
<!-- layer1_expert6_8 -->
<g id="node323" class="node">
<title>layer1_expert6_8</title>
<polygon fill="lightgreen" stroke="black" points="43217,-1340 43043,-1340 43043,-1257 43217,-1257 43217,-1340"/>
<text text-anchor="middle" x="43130" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU6</text>
<text text-anchor="middle" x="43130" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="43130" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="43130" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="43130" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_8 -->
<g id="edge524" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43067.31,-1375.91C43074.75,-1366.83 43082.72,-1357.12 43090.39,-1347.77"/>
<polygon fill="black" stroke="black" points="43093.11,-1349.97 43096.75,-1340.02 43087.7,-1345.53 43093.11,-1349.97"/>
</g>
<!-- layer1_expert6_9 -->
<g id="node324" class="node">
<title>layer1_expert6_9</title>
<polygon fill="lightgreen" stroke="black" points="43409,-1340 43235,-1340 43235,-1257 43409,-1257 43409,-1340"/>
<text text-anchor="middle" x="43322" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU6</text>
<text text-anchor="middle" x="43322" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="43322" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="43322" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="43322" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_9 -->
<g id="edge525" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43136.79,-1375.99C43163.21,-1365.46 43191.73,-1354.01 43225.31,-1340.27"/>
<polygon fill="black" stroke="black" points="43226.99,-1343.36 43234.91,-1336.33 43224.33,-1336.88 43226.99,-1343.36"/>
</g>
<!-- layer1_expert6_10 -->
<g id="node325" class="node">
<title>layer1_expert6_10</title>
<polygon fill="lightgreen" stroke="black" points="43601,-1340 43427,-1340 43427,-1257 43601,-1257 43601,-1340"/>
<text text-anchor="middle" x="43514" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU6</text>
<text text-anchor="middle" x="43514" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="43514" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="43514" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="43514" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_10 -->
<g id="edge526" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43156.2,-1398.65C43229.83,-1386.36 43325.28,-1367.72 43417.16,-1340.09"/>
<polygon fill="black" stroke="black" points="43418.35,-1343.39 43426.9,-1337.13 43416.31,-1336.69 43418.35,-1343.39"/>
</g>
<!-- layer1_expert6_11 -->
<g id="node326" class="node">
<title>layer1_expert6_11</title>
<polygon fill="lightgreen" stroke="black" points="43793,-1340 43619,-1340 43619,-1257 43793,-1257 43793,-1340"/>
<text text-anchor="middle" x="43706" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU6</text>
<text text-anchor="middle" x="43706" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="43706" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="43706" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="43706" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_11 -->
<g id="edge527" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43156.11,-1409.76C43271.58,-1401.23 43449.22,-1382.5 43608.96,-1340.07"/>
<polygon fill="black" stroke="black" points="43610.23,-1343.36 43618.97,-1337.38 43608.41,-1336.6 43610.23,-1343.36"/>
</g>
<!-- layer1_expert6_12 -->
<g id="node327" class="node">
<title>layer1_expert6_12</title>
<polygon fill="lightgreen" stroke="black" points="43985,-1340 43811,-1340 43811,-1257 43985,-1257 43985,-1340"/>
<text text-anchor="middle" x="43898" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU6</text>
<text text-anchor="middle" x="43898" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="43898" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="43898" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="43898" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_12 -->
<g id="edge528" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43156.33,-1415.54C43307.36,-1411.85 43571.37,-1397.19 43800.87,-1340.07"/>
<polygon fill="black" stroke="black" points="43801.9,-1343.42 43810.74,-1337.58 43800.19,-1336.63 43801.9,-1343.42"/>
</g>
<!-- layer1_expert6_13 -->
<g id="node328" class="node">
<title>layer1_expert6_13</title>
<polygon fill="lightgreen" stroke="black" points="44177,-1340 44003,-1340 44003,-1257 44177,-1257 44177,-1340"/>
<text text-anchor="middle" x="44090" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU6</text>
<text text-anchor="middle" x="44090" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="44090" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="44090" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="44090" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_13 -->
<g id="edge529" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43156.06,-1411.63C43373.51,-1402.15 43820.48,-1378.91 43992.79,-1340"/>
<polygon fill="black" stroke="black" points="43993.83,-1343.36 44002.76,-1337.66 43992.22,-1336.54 43993.83,-1343.36"/>
</g>
<!-- layer1_expert6_14 -->
<g id="node329" class="node">
<title>layer1_expert6_14</title>
<polygon fill="lightgreen" stroke="black" points="44369,-1340 44195,-1340 44195,-1257 44369,-1257 44369,-1340"/>
<text text-anchor="middle" x="44282" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU6</text>
<text text-anchor="middle" x="44282" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="44282" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="44282" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="44282" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_14 -->
<g id="edge530" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43156.32,-1413.51C43407.47,-1406.54 43974.62,-1386.35 44184.74,-1340.01"/>
<polygon fill="black" stroke="black" points="44185.8,-1343.35 44194.77,-1337.71 44184.24,-1336.53 44185.8,-1343.35"/>
</g>
<!-- layer1_expert6_15 -->
<g id="node330" class="node">
<title>layer1_expert6_15</title>
<polygon fill="lightgreen" stroke="black" points="44561,-1340 44387,-1340 44387,-1257 44561,-1257 44561,-1340"/>
<text text-anchor="middle" x="44474" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU6</text>
<text text-anchor="middle" x="44474" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="44474" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="44474" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="44474" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_15 -->
<g id="edge531" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43156.15,-1414.87C43438.11,-1410.26 44128.49,-1393.9 44376.71,-1340.01"/>
<polygon fill="black" stroke="black" points="44377.79,-1343.35 44386.78,-1337.75 44376.25,-1336.52 44377.79,-1343.35"/>
</g>
<!-- layer1_moe_agg_gpu6 -->
<g id="node331" class="node">
<title>layer1_moe_agg_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="43039.5,-1213.5 42836.5,-1213.5 42836.5,-1145.5 43039.5,-1145.5 43039.5,-1213.5"/>
<text text-anchor="middle" x="42938" y="-1198.3" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU6</text>
<text text-anchor="middle" x="42938" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="42938" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="42938" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_expert6_0&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge532" class="edge">
<title>layer1_expert6_0&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M41681.22,-1259.27C41684.16,-1258.44 41687.09,-1257.68 41690,-1257 41904.27,-1206.78 42562.06,-1188.12 42826.35,-1182.53"/>
<polygon fill="black" stroke="black" points="42826.42,-1186.03 42836.35,-1182.32 42826.28,-1179.03 42826.42,-1186.03"/>
</g>
<!-- layer1_expert6_1&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge533" class="edge">
<title>layer1_expert6_1&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M41873.23,-1259.31C41876.17,-1258.47 41879.1,-1257.7 41882,-1257 42058.66,-1214.56 42592.19,-1192.05 42826.08,-1183.99"/>
<polygon fill="black" stroke="black" points="42826.44,-1187.48 42836.31,-1183.64 42826.2,-1180.49 42826.44,-1187.48"/>
</g>
<!-- layer1_expert6_2&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge534" class="edge">
<title>layer1_expert6_2&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M42065.25,-1259.37C42068.18,-1258.52 42071.1,-1257.72 42074,-1257 42213.51,-1222.3 42625.52,-1196.81 42825.96,-1186.09"/>
<polygon fill="black" stroke="black" points="42826.42,-1189.57 42836.22,-1185.54 42826.04,-1182.58 42826.42,-1189.57"/>
</g>
<!-- layer1_expert6_3&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge535" class="edge">
<title>layer1_expert6_3&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M42257.01,-1259.55C42260.02,-1258.63 42263.03,-1257.78 42266,-1257 42458.76,-1206.49 42691.26,-1189.33 42826.11,-1183.5"/>
<polygon fill="black" stroke="black" points="42826.6,-1186.98 42836.45,-1183.07 42826.31,-1179.99 42826.6,-1186.98"/>
</g>
<!-- layer1_expert6_4&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge536" class="edge">
<title>layer1_expert6_4&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M42449.06,-1259.72C42452.06,-1258.76 42455.04,-1257.85 42458,-1257 42581.54,-1221.66 42727.93,-1201.29 42826.29,-1190.59"/>
<polygon fill="black" stroke="black" points="42826.68,-1194.07 42836.25,-1189.53 42825.94,-1187.11 42826.68,-1194.07"/>
</g>
<!-- layer1_expert6_5&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge537" class="edge">
<title>layer1_expert6_5&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M42641.18,-1260.11C42644.14,-1259.04 42647.09,-1257.99 42650,-1257 42707.37,-1237.38 42772.58,-1219.7 42826.42,-1206.28"/>
<polygon fill="black" stroke="black" points="42827.47,-1209.63 42836.34,-1203.83 42825.79,-1202.83 42827.47,-1209.63"/>
</g>
<!-- layer1_expert6_6&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge538" class="edge">
<title>layer1_expert6_6&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M42812.61,-1256.91C42832.8,-1244.6 42854.91,-1231.13 42874.87,-1218.97"/>
<polygon fill="black" stroke="black" points="42876.85,-1221.86 42883.57,-1213.67 42873.21,-1215.88 42876.85,-1221.86"/>
</g>
<!-- layer1_expert6_7&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge539" class="edge">
<title>layer1_expert6_7&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M42938,-1256.91C42938,-1246.2 42938,-1234.62 42938,-1223.78"/>
<polygon fill="black" stroke="black" points="42941.5,-1223.67 42938,-1213.67 42934.5,-1223.67 42941.5,-1223.67"/>
</g>
<!-- layer1_expert6_8&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge540" class="edge">
<title>layer1_expert6_8&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M43063.39,-1256.91C43043.2,-1244.6 43021.09,-1231.13 43001.13,-1218.97"/>
<polygon fill="black" stroke="black" points="43002.79,-1215.88 42992.43,-1213.67 42999.15,-1221.86 43002.79,-1215.88"/>
</g>
<!-- layer1_expert6_9&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge541" class="edge">
<title>layer1_expert6_9&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M43234.82,-1260.11C43231.86,-1259.04 43228.91,-1257.99 43226,-1257 43168.63,-1237.38 43103.42,-1219.7 43049.58,-1206.28"/>
<polygon fill="black" stroke="black" points="43050.21,-1202.83 43039.66,-1203.83 43048.53,-1209.63 43050.21,-1202.83"/>
</g>
<!-- layer1_expert6_10&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge542" class="edge">
<title>layer1_expert6_10&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M43426.94,-1259.72C43423.94,-1258.76 43420.96,-1257.85 43418,-1257 43294.46,-1221.66 43148.07,-1201.29 43049.71,-1190.59"/>
<polygon fill="black" stroke="black" points="43050.06,-1187.11 43039.75,-1189.53 43049.32,-1194.07 43050.06,-1187.11"/>
</g>
<!-- layer1_expert6_11&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge543" class="edge">
<title>layer1_expert6_11&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M43618.99,-1259.55C43615.98,-1258.63 43612.97,-1257.78 43610,-1257 43417.24,-1206.49 43184.74,-1189.33 43049.89,-1183.5"/>
<polygon fill="black" stroke="black" points="43049.69,-1179.99 43039.55,-1183.07 43049.4,-1186.98 43049.69,-1179.99"/>
</g>
<!-- layer1_expert6_12&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge544" class="edge">
<title>layer1_expert6_12&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M43810.75,-1259.37C43807.82,-1258.52 43804.9,-1257.72 43802,-1257 43662.49,-1222.3 43250.48,-1196.81 43050.04,-1186.09"/>
<polygon fill="black" stroke="black" points="43049.96,-1182.58 43039.78,-1185.54 43049.58,-1189.57 43049.96,-1182.58"/>
</g>
<!-- layer1_expert6_13&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge545" class="edge">
<title>layer1_expert6_13&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M44002.77,-1259.31C43999.83,-1258.47 43996.9,-1257.7 43994,-1257 43817.34,-1214.56 43283.81,-1192.05 43049.92,-1183.99"/>
<polygon fill="black" stroke="black" points="43049.8,-1180.49 43039.69,-1183.64 43049.56,-1187.48 43049.8,-1180.49"/>
</g>
<!-- layer1_expert6_14&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge546" class="edge">
<title>layer1_expert6_14&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M44194.78,-1259.27C44191.84,-1258.44 44188.91,-1257.68 44186,-1257 43971.73,-1206.78 43313.94,-1188.12 43049.65,-1182.53"/>
<polygon fill="black" stroke="black" points="43049.72,-1179.03 43039.65,-1182.32 43049.58,-1186.03 43049.72,-1179.03"/>
</g>
<!-- layer1_expert6_15&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge547" class="edge">
<title>layer1_expert6_15&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M44386.78,-1259.24C44383.84,-1258.42 44380.91,-1257.67 44378,-1257 44125.96,-1199.01 43342.77,-1184.79 43049.96,-1181.47"/>
<polygon fill="black" stroke="black" points="43049.79,-1177.97 43039.75,-1181.35 43049.71,-1184.97 43049.79,-1177.97"/>
</g>
<!-- layer1_output_gpu6 -->
<g id="node332" class="node">
<title>layer1_output_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="40626,-1102 40382,-1102 40382,-1034 40626,-1034 40626,-1102"/>
<text text-anchor="middle" x="40504" y="-1086.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="40504" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="40504" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="40504" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_moe_agg_gpu6&#45;&gt;layer1_output_gpu6 -->
<g id="edge548" class="edge">
<title>layer1_moe_agg_gpu6&#45;&gt;layer1_output_gpu6</title>
<path fill="none" stroke="black" d="M42836.13,-1173.92C42449.27,-1156.51 41071.14,-1094.51 40636.39,-1074.96"/>
<polygon fill="black" stroke="black" points="40636.45,-1071.46 40626.3,-1074.5 40636.13,-1078.45 40636.45,-1071.46"/>
</g>
<!-- layer1_output_gpu6&#45;&gt;pipeline_stage0_1 -->
<g id="edge591" class="edge">
<title>layer1_output_gpu6&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M40381.76,-1063.59C39677.93,-1043.95 36143.51,-945.34 35281.71,-921.29"/>
<polygon fill="black" stroke="black" points="35281.79,-917.79 35271.7,-921.01 35281.6,-924.79 35281.79,-917.79"/>
</g>
<!-- layer1_qkv_gpu7 -->
<g id="node333" class="node">
<title>layer1_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="46212,-1778.48 46000,-1778.48 46000,-1710.48 46212,-1710.48 46212,-1778.48"/>
<text text-anchor="middle" x="46106" y="-1763.28" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="46106" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="46106" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="46106" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_gpu7 -->
<g id="node334" class="node">
<title>layer1_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="46227.5,-1667 45984.5,-1667 45984.5,-1599 46227.5,-1599 46227.5,-1667"/>
<text text-anchor="middle" x="46106" y="-1651.8" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="46106" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="46106" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="46106" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_qkv_gpu7&#45;&gt;layer1_attn_gpu7 -->
<g id="edge549" class="edge">
<title>layer1_qkv_gpu7&#45;&gt;layer1_attn_gpu7</title>
<path fill="none" stroke="black" d="M46106,-1710.33C46106,-1699.94 46106,-1688.3 46106,-1677.31"/>
<polygon fill="black" stroke="black" points="46109.5,-1677.03 46106,-1667.03 46102.5,-1677.03 46109.5,-1677.03"/>
</g>
<!-- layer1_attn_norm_gpu7 -->
<g id="node335" class="node">
<title>layer1_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="46228,-1563 45984,-1563 45984,-1495 46228,-1495 46228,-1563"/>
<text text-anchor="middle" x="46106" y="-1547.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="46106" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="46106" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="46106" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_gpu7&#45;&gt;layer1_attn_norm_gpu7 -->
<g id="edge550" class="edge">
<title>layer1_attn_gpu7&#45;&gt;layer1_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M46106,-1598.88C46106,-1590.78 46106,-1581.98 46106,-1573.47"/>
<polygon fill="black" stroke="black" points="46109.5,-1573.3 46106,-1563.3 46102.5,-1573.3 46109.5,-1573.3"/>
</g>
<!-- layer1_gate_gpu7 -->
<g id="node336" class="node">
<title>layer1_gate_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="46228,-1459 45984,-1459 45984,-1376 46228,-1376 46228,-1459"/>
<text text-anchor="middle" x="46106" y="-1443.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU7</text>
<text text-anchor="middle" x="46106" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="46106" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="46106" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="46106" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_norm_gpu7&#45;&gt;layer1_gate_gpu7 -->
<g id="edge551" class="edge">
<title>layer1_attn_norm_gpu7&#45;&gt;layer1_gate_gpu7</title>
<path fill="none" stroke="black" d="M46106,-1494.85C46106,-1486.8 46106,-1478 46106,-1469.34"/>
<polygon fill="black" stroke="black" points="46109.5,-1469.28 46106,-1459.28 46102.5,-1469.28 46109.5,-1469.28"/>
</g>
<!-- layer1_expert7_0 -->
<g id="node337" class="node">
<title>layer1_expert7_0</title>
<polygon fill="lightgreen" stroke="black" points="44753,-1340 44579,-1340 44579,-1257 44753,-1257 44753,-1340"/>
<text text-anchor="middle" x="44666" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU7</text>
<text text-anchor="middle" x="44666" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="44666" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="44666" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="44666" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_0 -->
<g id="edge552" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45983.85,-1414.87C45701.89,-1410.26 45011.51,-1393.9 44763.29,-1340.01"/>
<polygon fill="black" stroke="black" points="44763.75,-1336.52 44753.22,-1337.75 44762.21,-1343.35 44763.75,-1336.52"/>
</g>
<!-- layer1_expert7_1 -->
<g id="node338" class="node">
<title>layer1_expert7_1</title>
<polygon fill="lightgreen" stroke="black" points="44945,-1340 44771,-1340 44771,-1257 44945,-1257 44945,-1340"/>
<text text-anchor="middle" x="44858" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU7</text>
<text text-anchor="middle" x="44858" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="44858" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="44858" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="44858" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_1 -->
<g id="edge553" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45983.68,-1413.51C45732.53,-1406.54 45165.38,-1386.35 44955.26,-1340.01"/>
<polygon fill="black" stroke="black" points="44955.76,-1336.53 44945.23,-1337.71 44954.2,-1343.35 44955.76,-1336.53"/>
</g>
<!-- layer1_expert7_2 -->
<g id="node339" class="node">
<title>layer1_expert7_2</title>
<polygon fill="lightgreen" stroke="black" points="45137,-1340 44963,-1340 44963,-1257 45137,-1257 45137,-1340"/>
<text text-anchor="middle" x="45050" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU7</text>
<text text-anchor="middle" x="45050" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45050" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45050" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45050" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_2 -->
<g id="edge554" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45983.94,-1411.63C45766.49,-1402.15 45319.52,-1378.91 45147.21,-1340"/>
<polygon fill="black" stroke="black" points="45147.78,-1336.54 45137.24,-1337.66 45146.17,-1343.36 45147.78,-1336.54"/>
</g>
<!-- layer1_expert7_3 -->
<g id="node340" class="node">
<title>layer1_expert7_3</title>
<polygon fill="lightgreen" stroke="black" points="45329,-1340 45155,-1340 45155,-1257 45329,-1257 45329,-1340"/>
<text text-anchor="middle" x="45242" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU7</text>
<text text-anchor="middle" x="45242" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45242" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45242" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45242" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_3 -->
<g id="edge555" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45983.67,-1415.54C45832.64,-1411.85 45568.63,-1397.19 45339.13,-1340.07"/>
<polygon fill="black" stroke="black" points="45339.81,-1336.63 45329.26,-1337.58 45338.1,-1343.42 45339.81,-1336.63"/>
</g>
<!-- layer1_expert7_4 -->
<g id="node341" class="node">
<title>layer1_expert7_4</title>
<polygon fill="lightgreen" stroke="black" points="45521,-1340 45347,-1340 45347,-1257 45521,-1257 45521,-1340"/>
<text text-anchor="middle" x="45434" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU7</text>
<text text-anchor="middle" x="45434" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45434" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45434" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45434" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_4 -->
<g id="edge556" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45983.89,-1409.76C45868.42,-1401.23 45690.78,-1382.5 45531.04,-1340.07"/>
<polygon fill="black" stroke="black" points="45531.59,-1336.6 45521.03,-1337.38 45529.77,-1343.36 45531.59,-1336.6"/>
</g>
<!-- layer1_expert7_5 -->
<g id="node342" class="node">
<title>layer1_expert7_5</title>
<polygon fill="lightgreen" stroke="black" points="45713,-1340 45539,-1340 45539,-1257 45713,-1257 45713,-1340"/>
<text text-anchor="middle" x="45626" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU7</text>
<text text-anchor="middle" x="45626" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45626" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45626" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45626" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_5 -->
<g id="edge557" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45983.8,-1398.65C45910.17,-1386.36 45814.72,-1367.72 45722.84,-1340.09"/>
<polygon fill="black" stroke="black" points="45723.69,-1336.69 45713.1,-1337.13 45721.65,-1343.39 45723.69,-1336.69"/>
</g>
<!-- layer1_expert7_6 -->
<g id="node343" class="node">
<title>layer1_expert7_6</title>
<polygon fill="lightgreen" stroke="black" points="45905,-1340 45731,-1340 45731,-1257 45905,-1257 45905,-1340"/>
<text text-anchor="middle" x="45818" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU7</text>
<text text-anchor="middle" x="45818" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45818" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45818" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45818" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_6 -->
<g id="edge558" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46003.21,-1375.99C45976.79,-1365.46 45948.27,-1354.01 45914.69,-1340.27"/>
<polygon fill="black" stroke="black" points="45915.67,-1336.88 45905.09,-1336.33 45913.01,-1343.36 45915.67,-1336.88"/>
</g>
<!-- layer1_expert7_7 -->
<g id="node344" class="node">
<title>layer1_expert7_7</title>
<polygon fill="lightgreen" stroke="black" points="46097,-1340 45923,-1340 45923,-1257 46097,-1257 46097,-1340"/>
<text text-anchor="middle" x="46010" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU7</text>
<text text-anchor="middle" x="46010" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46010" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46010" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46010" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_7 -->
<g id="edge559" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46072.69,-1375.91C46065.25,-1366.83 46057.28,-1357.12 46049.61,-1347.77"/>
<polygon fill="black" stroke="black" points="46052.3,-1345.53 46043.25,-1340.02 46046.89,-1349.97 46052.3,-1345.53"/>
</g>
<!-- layer1_expert7_8 -->
<g id="node345" class="node">
<title>layer1_expert7_8</title>
<polygon fill="lightgreen" stroke="black" points="46289,-1340 46115,-1340 46115,-1257 46289,-1257 46289,-1340"/>
<text text-anchor="middle" x="46202" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU7</text>
<text text-anchor="middle" x="46202" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46202" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46202" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46202" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_8 -->
<g id="edge560" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46139.31,-1375.91C46146.75,-1366.83 46154.72,-1357.12 46162.39,-1347.77"/>
<polygon fill="black" stroke="black" points="46165.11,-1349.97 46168.75,-1340.02 46159.7,-1345.53 46165.11,-1349.97"/>
</g>
<!-- layer1_expert7_9 -->
<g id="node346" class="node">
<title>layer1_expert7_9</title>
<polygon fill="lightgreen" stroke="black" points="46481,-1340 46307,-1340 46307,-1257 46481,-1257 46481,-1340"/>
<text text-anchor="middle" x="46394" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU7</text>
<text text-anchor="middle" x="46394" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46394" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46394" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46394" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_9 -->
<g id="edge561" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46208.79,-1375.99C46235.21,-1365.46 46263.73,-1354.01 46297.31,-1340.27"/>
<polygon fill="black" stroke="black" points="46298.99,-1343.36 46306.91,-1336.33 46296.33,-1336.88 46298.99,-1343.36"/>
</g>
<!-- layer1_expert7_10 -->
<g id="node347" class="node">
<title>layer1_expert7_10</title>
<polygon fill="lightgreen" stroke="black" points="46673,-1340 46499,-1340 46499,-1257 46673,-1257 46673,-1340"/>
<text text-anchor="middle" x="46586" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU7</text>
<text text-anchor="middle" x="46586" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46586" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46586" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46586" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_10 -->
<g id="edge562" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46228.2,-1398.65C46301.83,-1386.36 46397.28,-1367.72 46489.16,-1340.09"/>
<polygon fill="black" stroke="black" points="46490.35,-1343.39 46498.9,-1337.13 46488.31,-1336.69 46490.35,-1343.39"/>
</g>
<!-- layer1_expert7_11 -->
<g id="node348" class="node">
<title>layer1_expert7_11</title>
<polygon fill="lightgreen" stroke="black" points="46865,-1340 46691,-1340 46691,-1257 46865,-1257 46865,-1340"/>
<text text-anchor="middle" x="46778" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU7</text>
<text text-anchor="middle" x="46778" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46778" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46778" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46778" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_11 -->
<g id="edge563" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46228.11,-1409.76C46343.58,-1401.23 46521.22,-1382.5 46680.96,-1340.07"/>
<polygon fill="black" stroke="black" points="46682.23,-1343.36 46690.97,-1337.38 46680.41,-1336.6 46682.23,-1343.36"/>
</g>
<!-- layer1_expert7_12 -->
<g id="node349" class="node">
<title>layer1_expert7_12</title>
<polygon fill="lightgreen" stroke="black" points="47057,-1340 46883,-1340 46883,-1257 47057,-1257 47057,-1340"/>
<text text-anchor="middle" x="46970" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU7</text>
<text text-anchor="middle" x="46970" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46970" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46970" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46970" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_12 -->
<g id="edge564" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46228.33,-1415.54C46379.36,-1411.85 46643.37,-1397.19 46872.87,-1340.07"/>
<polygon fill="black" stroke="black" points="46873.9,-1343.42 46882.74,-1337.58 46872.19,-1336.63 46873.9,-1343.42"/>
</g>
<!-- layer1_expert7_13 -->
<g id="node350" class="node">
<title>layer1_expert7_13</title>
<polygon fill="lightgreen" stroke="black" points="47249,-1340 47075,-1340 47075,-1257 47249,-1257 47249,-1340"/>
<text text-anchor="middle" x="47162" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU7</text>
<text text-anchor="middle" x="47162" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="47162" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="47162" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="47162" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_13 -->
<g id="edge565" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46228.06,-1411.63C46445.51,-1402.15 46892.48,-1378.91 47064.79,-1340"/>
<polygon fill="black" stroke="black" points="47065.83,-1343.36 47074.76,-1337.66 47064.22,-1336.54 47065.83,-1343.36"/>
</g>
<!-- layer1_expert7_14 -->
<g id="node351" class="node">
<title>layer1_expert7_14</title>
<polygon fill="lightgreen" stroke="black" points="47441,-1340 47267,-1340 47267,-1257 47441,-1257 47441,-1340"/>
<text text-anchor="middle" x="47354" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU7</text>
<text text-anchor="middle" x="47354" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="47354" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="47354" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="47354" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_14 -->
<g id="edge566" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46228.32,-1413.51C46479.47,-1406.54 47046.62,-1386.35 47256.74,-1340.01"/>
<polygon fill="black" stroke="black" points="47257.8,-1343.35 47266.77,-1337.71 47256.24,-1336.53 47257.8,-1343.35"/>
</g>
<!-- layer1_expert7_15 -->
<g id="node352" class="node">
<title>layer1_expert7_15</title>
<polygon fill="lightgreen" stroke="black" points="47633,-1340 47459,-1340 47459,-1257 47633,-1257 47633,-1340"/>
<text text-anchor="middle" x="47546" y="-1324.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU7</text>
<text text-anchor="middle" x="47546" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="47546" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="47546" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="47546" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_15 -->
<g id="edge567" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46228.15,-1414.87C46510.11,-1410.26 47200.49,-1393.9 47448.71,-1340.01"/>
<polygon fill="black" stroke="black" points="47449.79,-1343.35 47458.78,-1337.75 47448.25,-1336.52 47449.79,-1343.35"/>
</g>
<!-- layer1_moe_agg_gpu7 -->
<g id="node353" class="node">
<title>layer1_moe_agg_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="46111.5,-1213.5 45908.5,-1213.5 45908.5,-1145.5 46111.5,-1145.5 46111.5,-1213.5"/>
<text text-anchor="middle" x="46010" y="-1198.3" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU7</text>
<text text-anchor="middle" x="46010" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="46010" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="46010" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_expert7_0&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge568" class="edge">
<title>layer1_expert7_0&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M44753.22,-1259.27C44756.16,-1258.44 44759.09,-1257.68 44762,-1257 44976.27,-1206.78 45634.06,-1188.12 45898.35,-1182.53"/>
<polygon fill="black" stroke="black" points="45898.42,-1186.03 45908.35,-1182.32 45898.28,-1179.03 45898.42,-1186.03"/>
</g>
<!-- layer1_expert7_1&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge569" class="edge">
<title>layer1_expert7_1&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M44945.23,-1259.31C44948.17,-1258.47 44951.1,-1257.7 44954,-1257 45130.66,-1214.56 45664.19,-1192.05 45898.08,-1183.99"/>
<polygon fill="black" stroke="black" points="45898.44,-1187.48 45908.31,-1183.64 45898.2,-1180.49 45898.44,-1187.48"/>
</g>
<!-- layer1_expert7_2&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge570" class="edge">
<title>layer1_expert7_2&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M45137.25,-1259.37C45140.18,-1258.52 45143.1,-1257.72 45146,-1257 45285.51,-1222.3 45697.52,-1196.81 45897.96,-1186.09"/>
<polygon fill="black" stroke="black" points="45898.42,-1189.57 45908.22,-1185.54 45898.04,-1182.58 45898.42,-1189.57"/>
</g>
<!-- layer1_expert7_3&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge571" class="edge">
<title>layer1_expert7_3&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M45329.01,-1259.55C45332.02,-1258.63 45335.03,-1257.78 45338,-1257 45530.76,-1206.49 45763.26,-1189.33 45898.11,-1183.5"/>
<polygon fill="black" stroke="black" points="45898.6,-1186.98 45908.45,-1183.07 45898.31,-1179.99 45898.6,-1186.98"/>
</g>
<!-- layer1_expert7_4&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge572" class="edge">
<title>layer1_expert7_4&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M45521.06,-1259.72C45524.06,-1258.76 45527.04,-1257.85 45530,-1257 45653.54,-1221.66 45799.93,-1201.29 45898.29,-1190.59"/>
<polygon fill="black" stroke="black" points="45898.68,-1194.07 45908.25,-1189.53 45897.94,-1187.11 45898.68,-1194.07"/>
</g>
<!-- layer1_expert7_5&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge573" class="edge">
<title>layer1_expert7_5&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M45713.18,-1260.11C45716.14,-1259.04 45719.09,-1257.99 45722,-1257 45779.37,-1237.38 45844.58,-1219.7 45898.42,-1206.28"/>
<polygon fill="black" stroke="black" points="45899.47,-1209.63 45908.34,-1203.83 45897.79,-1202.83 45899.47,-1209.63"/>
</g>
<!-- layer1_expert7_6&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge574" class="edge">
<title>layer1_expert7_6&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M45884.61,-1256.91C45904.8,-1244.6 45926.91,-1231.13 45946.87,-1218.97"/>
<polygon fill="black" stroke="black" points="45948.85,-1221.86 45955.57,-1213.67 45945.21,-1215.88 45948.85,-1221.86"/>
</g>
<!-- layer1_expert7_7&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge575" class="edge">
<title>layer1_expert7_7&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M46010,-1256.91C46010,-1246.2 46010,-1234.62 46010,-1223.78"/>
<polygon fill="black" stroke="black" points="46013.5,-1223.67 46010,-1213.67 46006.5,-1223.67 46013.5,-1223.67"/>
</g>
<!-- layer1_expert7_8&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge576" class="edge">
<title>layer1_expert7_8&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M46135.39,-1256.91C46115.2,-1244.6 46093.09,-1231.13 46073.13,-1218.97"/>
<polygon fill="black" stroke="black" points="46074.79,-1215.88 46064.43,-1213.67 46071.15,-1221.86 46074.79,-1215.88"/>
</g>
<!-- layer1_expert7_9&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge577" class="edge">
<title>layer1_expert7_9&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M46306.82,-1260.11C46303.86,-1259.04 46300.91,-1257.99 46298,-1257 46240.63,-1237.38 46175.42,-1219.7 46121.58,-1206.28"/>
<polygon fill="black" stroke="black" points="46122.21,-1202.83 46111.66,-1203.83 46120.53,-1209.63 46122.21,-1202.83"/>
</g>
<!-- layer1_expert7_10&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge578" class="edge">
<title>layer1_expert7_10&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M46498.94,-1259.72C46495.94,-1258.76 46492.96,-1257.85 46490,-1257 46366.46,-1221.66 46220.07,-1201.29 46121.71,-1190.59"/>
<polygon fill="black" stroke="black" points="46122.06,-1187.11 46111.75,-1189.53 46121.32,-1194.07 46122.06,-1187.11"/>
</g>
<!-- layer1_expert7_11&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge579" class="edge">
<title>layer1_expert7_11&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M46690.99,-1259.55C46687.98,-1258.63 46684.97,-1257.78 46682,-1257 46489.24,-1206.49 46256.74,-1189.33 46121.89,-1183.5"/>
<polygon fill="black" stroke="black" points="46121.69,-1179.99 46111.55,-1183.07 46121.4,-1186.98 46121.69,-1179.99"/>
</g>
<!-- layer1_expert7_12&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge580" class="edge">
<title>layer1_expert7_12&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M46882.75,-1259.37C46879.82,-1258.52 46876.9,-1257.72 46874,-1257 46734.49,-1222.3 46322.48,-1196.81 46122.04,-1186.09"/>
<polygon fill="black" stroke="black" points="46121.96,-1182.58 46111.78,-1185.54 46121.58,-1189.57 46121.96,-1182.58"/>
</g>
<!-- layer1_expert7_13&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge581" class="edge">
<title>layer1_expert7_13&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M47074.77,-1259.31C47071.83,-1258.47 47068.9,-1257.7 47066,-1257 46889.34,-1214.56 46355.81,-1192.05 46121.92,-1183.99"/>
<polygon fill="black" stroke="black" points="46121.8,-1180.49 46111.69,-1183.64 46121.56,-1187.48 46121.8,-1180.49"/>
</g>
<!-- layer1_expert7_14&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge582" class="edge">
<title>layer1_expert7_14&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M47266.78,-1259.27C47263.84,-1258.44 47260.91,-1257.68 47258,-1257 47043.73,-1206.78 46385.94,-1188.12 46121.65,-1182.53"/>
<polygon fill="black" stroke="black" points="46121.72,-1179.03 46111.65,-1182.32 46121.58,-1186.03 46121.72,-1179.03"/>
</g>
<!-- layer1_expert7_15&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge583" class="edge">
<title>layer1_expert7_15&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M47458.78,-1259.24C47455.84,-1258.42 47452.91,-1257.67 47450,-1257 47197.96,-1199.01 46414.77,-1184.79 46121.96,-1181.47"/>
<polygon fill="black" stroke="black" points="46121.79,-1177.97 46111.75,-1181.35 46121.71,-1184.97 46121.79,-1177.97"/>
</g>
<!-- layer1_output_gpu7 -->
<g id="node354" class="node">
<title>layer1_output_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="43510,-1102 43266,-1102 43266,-1034 43510,-1034 43510,-1102"/>
<text text-anchor="middle" x="43388" y="-1086.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="43388" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="43388" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="43388" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_moe_agg_gpu7&#45;&gt;layer1_output_gpu7 -->
<g id="edge584" class="edge">
<title>layer1_moe_agg_gpu7&#45;&gt;layer1_output_gpu7</title>
<path fill="none" stroke="black" d="M45908.42,-1174.26C45500.24,-1157.21 43979.45,-1093.7 43520.17,-1074.52"/>
<polygon fill="black" stroke="black" points="43520.32,-1071.02 43510.18,-1074.1 43520.03,-1078.02 43520.32,-1071.02"/>
</g>
<!-- layer1_output_gpu7&#45;&gt;pipeline_stage0_1 -->
<g id="edge592" class="edge">
<title>layer1_output_gpu7&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M43265.91,-1064.78C42339.22,-1047.91 36419.51,-940.16 35281.2,-919.44"/>
<polygon fill="black" stroke="black" points="35280.94,-915.94 35270.88,-919.26 35280.82,-922.94 35280.94,-915.94"/>
</g>
<!-- stage1_boundary -->
<g id="node355" class="node">
<title>stage1_boundary</title>
<ellipse fill="lightblue" stroke="black" cx="47642" cy="-1744.48" rx="102.56" ry="37.46"/>
<ellipse fill="none" stroke="black" cx="47642" cy="-1744.48" rx="106.56" ry="41.45"/>
<text text-anchor="middle" x="47642" y="-1755.78" font-family="Times,serif" font-size="14.00">Stage 1 Boundary</text>
<text text-anchor="middle" x="47642" y="-1740.78" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
<text text-anchor="middle" x="47642" y="-1725.78" font-family="Times,serif" font-size="14.00">Layers 2&#45;3</text>
</g>
<!-- layer2_qkv_gpu8 -->
<g id="node356" class="node">
<title>layer2_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="31327,-796 31115,-796 31115,-728 31327,-728 31327,-796"/>
<text text-anchor="middle" x="31221" y="-780.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU8</text>
<text text-anchor="middle" x="31221" y="-765.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="31221" y="-750.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="31221" y="-735.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_attn_gpu8 -->
<g id="node357" class="node">
<title>layer2_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="28879.5,-692 28636.5,-692 28636.5,-624 28879.5,-624 28879.5,-692"/>
<text text-anchor="middle" x="28758" y="-676.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU8</text>
<text text-anchor="middle" x="28758" y="-661.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="28758" y="-646.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="28758" y="-631.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_qkv_gpu8&#45;&gt;layer2_attn_gpu8 -->
<g id="edge601" class="edge">
<title>layer2_qkv_gpu8&#45;&gt;layer2_attn_gpu8</title>
<path fill="none" stroke="black" d="M31114.73,-760.94C30721.3,-760.26 29347.13,-753.52 28889.6,-692.1"/>
<polygon fill="black" stroke="black" points="28890.01,-688.63 28879.63,-690.73 28889.06,-695.56 28890.01,-688.63"/>
</g>
<!-- layer2_attn_norm_gpu8 -->
<g id="node358" class="node">
<title>layer2_attn_norm_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="26250,-588 26006,-588 26006,-520 26250,-520 26250,-588"/>
<text text-anchor="middle" x="26128" y="-572.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="26128" y="-557.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="26128" y="-542.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="26128" y="-527.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_attn_gpu8&#45;&gt;layer2_attn_norm_gpu8 -->
<g id="edge602" class="edge">
<title>layer2_attn_gpu8&#45;&gt;layer2_attn_norm_gpu8</title>
<path fill="none" stroke="black" d="M28636.42,-652.28C28199.92,-635.36 26713.71,-577.72 26260.37,-560.13"/>
<polygon fill="black" stroke="black" points="26260.31,-556.63 26250.18,-559.74 26260.03,-563.62 26260.31,-556.63"/>
</g>
<!-- layer2_gate_gpu8 -->
<g id="node359" class="node">
<title>layer2_gate_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="24233,-484 23989,-484 23989,-401 24233,-401 24233,-484"/>
<text text-anchor="middle" x="24111" y="-468.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU8</text>
<text text-anchor="middle" x="24111" y="-453.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="24111" y="-438.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="24111" y="-423.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="24111" y="-408.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_attn_norm_gpu8&#45;&gt;layer2_gate_gpu8 -->
<g id="edge603" class="edge">
<title>layer2_attn_norm_gpu8&#45;&gt;layer2_gate_gpu8</title>
<path fill="none" stroke="black" d="M26005.99,-546.38C25649.63,-527.03 24612.27,-470.71 24243.23,-450.68"/>
<polygon fill="black" stroke="black" points="24243.22,-447.17 24233.04,-450.13 24242.84,-454.16 24243.22,-447.17"/>
</g>
<!-- layer2_expert8_0 -->
<g id="node360" class="node">
<title>layer2_expert8_0</title>
<polygon fill="lightgreen" stroke="black" points="22662,-365 22488,-365 22488,-282 22662,-282 22662,-365"/>
<text text-anchor="middle" x="22575" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU8</text>
<text text-anchor="middle" x="22575" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22575" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22575" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22575" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_0 -->
<g id="edge604" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23988.8,-440.41C23692.21,-436.92 22939.59,-422.7 22672.29,-365.01"/>
<polygon fill="black" stroke="black" points="22672.74,-361.52 22662.22,-362.76 22671.22,-368.35 22672.74,-361.52"/>
</g>
<!-- layer2_expert8_1 -->
<g id="node361" class="node">
<title>layer2_expert8_1</title>
<polygon fill="lightgreen" stroke="black" points="22854,-365 22680,-365 22680,-282 22854,-282 22854,-365"/>
<text text-anchor="middle" x="22767" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU8</text>
<text text-anchor="middle" x="22767" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22767" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22767" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22767" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_1 -->
<g id="edge605" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23988.82,-439.24C23721.95,-433.47 23093.25,-415.11 22864.17,-364.99"/>
<polygon fill="black" stroke="black" points="22864.75,-361.53 22854.22,-362.73 22863.2,-368.35 22864.75,-361.53"/>
</g>
<!-- layer2_expert8_2 -->
<g id="node362" class="node">
<title>layer2_expert8_2</title>
<polygon fill="lightgreen" stroke="black" points="23046,-365 22872,-365 22872,-282 23046,-282 23046,-365"/>
<text text-anchor="middle" x="22959" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU8</text>
<text text-anchor="middle" x="22959" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22959" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22959" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22959" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_2 -->
<g id="edge606" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23988.92,-437.65C23754.28,-429.46 23247.38,-407.62 23056.19,-364.99"/>
<polygon fill="black" stroke="black" points="23056.77,-361.54 23046.23,-362.69 23055.19,-368.35 23056.77,-361.54"/>
</g>
<!-- layer2_expert8_3 -->
<g id="node363" class="node">
<title>layer2_expert8_3</title>
<polygon fill="lightgreen" stroke="black" points="23238,-365 23064,-365 23064,-282 23238,-282 23238,-365"/>
<text text-anchor="middle" x="23151" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU8</text>
<text text-anchor="middle" x="23151" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23151" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23151" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23151" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_3 -->
<g id="edge607" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23988.77,-435.36C23789.25,-424.58 23401.31,-400.2 23248,-364.96"/>
<polygon fill="black" stroke="black" points="23248.79,-361.55 23238.25,-362.63 23247.16,-368.36 23248.79,-361.55"/>
</g>
<!-- layer2_expert8_4 -->
<g id="node364" class="node">
<title>layer2_expert8_4</title>
<polygon fill="lightgreen" stroke="black" points="23430,-365 23256,-365 23256,-282 23430,-282 23430,-365"/>
<text text-anchor="middle" x="23343" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU8</text>
<text text-anchor="middle" x="23343" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23343" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23343" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23343" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_4 -->
<g id="edge608" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23988.91,-438.05C23855.03,-431.91 23634.46,-414.84 23439.84,-365"/>
<polygon fill="black" stroke="black" points="23440.57,-361.57 23430.01,-362.45 23438.81,-368.35 23440.57,-361.57"/>
</g>
<!-- layer2_expert8_5 -->
<g id="node365" class="node">
<title>layer2_expert8_5</title>
<polygon fill="lightgreen" stroke="black" points="23622,-365 23448,-365 23448,-282 23622,-282 23622,-365"/>
<text text-anchor="middle" x="23535" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU8</text>
<text text-anchor="middle" x="23535" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23535" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23535" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23535" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_5 -->
<g id="edge609" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23988.91,-430.26C23893.32,-419.56 23757.37,-400.14 23631.84,-365.05"/>
<polygon fill="black" stroke="black" points="23632.63,-361.64 23622.06,-362.28 23630.72,-368.37 23632.63,-361.64"/>
</g>
<!-- layer2_expert8_6 -->
<g id="node366" class="node">
<title>layer2_expert8_6</title>
<polygon fill="lightgreen" stroke="black" points="23814,-365 23640,-365 23640,-282 23814,-282 23814,-365"/>
<text text-anchor="middle" x="23727" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU8</text>
<text text-anchor="middle" x="23727" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23727" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23727" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23727" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_6 -->
<g id="edge610" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23988.66,-413.02C23939.66,-400.63 23882.72,-385.01 23823.67,-365.12"/>
<polygon fill="black" stroke="black" points="23824.77,-361.79 23814.18,-361.89 23822.52,-368.42 23824.77,-361.79"/>
</g>
<!-- layer2_expert8_7 -->
<g id="node367" class="node">
<title>layer2_expert8_7</title>
<polygon fill="lightgreen" stroke="black" points="24006,-365 23832,-365 23832,-282 24006,-282 24006,-365"/>
<text text-anchor="middle" x="23919" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU8</text>
<text text-anchor="middle" x="23919" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23919" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23919" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23919" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_7 -->
<g id="edge611" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24044.39,-400.91C24028.15,-391.02 24010.68,-380.37 23994.08,-370.25"/>
<polygon fill="black" stroke="black" points="23995.86,-367.24 23985.5,-365.02 23992.21,-373.21 23995.86,-367.24"/>
</g>
<!-- layer2_expert8_8 -->
<g id="node368" class="node">
<title>layer2_expert8_8</title>
<polygon fill="lightgreen" stroke="black" points="24198,-365 24024,-365 24024,-282 24198,-282 24198,-365"/>
<text text-anchor="middle" x="24111" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU8</text>
<text text-anchor="middle" x="24111" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24111" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24111" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24111" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_8 -->
<g id="edge612" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24111,-400.91C24111,-392.65 24111,-383.86 24111,-375.3"/>
<polygon fill="black" stroke="black" points="24114.5,-375.02 24111,-365.02 24107.5,-375.02 24114.5,-375.02"/>
</g>
<!-- layer2_expert8_9 -->
<g id="node369" class="node">
<title>layer2_expert8_9</title>
<polygon fill="lightgreen" stroke="black" points="24390,-365 24216,-365 24216,-282 24390,-282 24390,-365"/>
<text text-anchor="middle" x="24303" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU8</text>
<text text-anchor="middle" x="24303" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24303" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24303" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24303" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_9 -->
<g id="edge613" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24177.61,-400.91C24193.85,-391.02 24211.32,-380.37 24227.92,-370.25"/>
<polygon fill="black" stroke="black" points="24229.79,-373.21 24236.5,-365.02 24226.14,-367.24 24229.79,-373.21"/>
</g>
<!-- layer2_expert8_10 -->
<g id="node370" class="node">
<title>layer2_expert8_10</title>
<polygon fill="lightgreen" stroke="black" points="24582,-365 24408,-365 24408,-282 24582,-282 24582,-365"/>
<text text-anchor="middle" x="24495" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU8</text>
<text text-anchor="middle" x="24495" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24495" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24495" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24495" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_10 -->
<g id="edge614" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24233.34,-413.02C24282.34,-400.63 24339.28,-385.01 24398.33,-365.12"/>
<polygon fill="black" stroke="black" points="24399.48,-368.42 24407.82,-361.89 24397.23,-361.79 24399.48,-368.42"/>
</g>
<!-- layer2_expert8_11 -->
<g id="node371" class="node">
<title>layer2_expert8_11</title>
<polygon fill="lightgreen" stroke="black" points="24774,-365 24600,-365 24600,-282 24774,-282 24774,-365"/>
<text text-anchor="middle" x="24687" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU8</text>
<text text-anchor="middle" x="24687" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24687" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24687" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24687" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_11 -->
<g id="edge615" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24233.09,-430.26C24328.68,-419.56 24464.63,-400.14 24590.16,-365.05"/>
<polygon fill="black" stroke="black" points="24591.28,-368.37 24599.94,-362.28 24589.37,-361.64 24591.28,-368.37"/>
</g>
<!-- layer2_expert8_12 -->
<g id="node372" class="node">
<title>layer2_expert8_12</title>
<polygon fill="lightgreen" stroke="black" points="24966,-365 24792,-365 24792,-282 24966,-282 24966,-365"/>
<text text-anchor="middle" x="24879" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU8</text>
<text text-anchor="middle" x="24879" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24879" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24879" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24879" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_12 -->
<g id="edge616" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24233.09,-438.05C24366.97,-431.91 24587.54,-414.84 24782.16,-365"/>
<polygon fill="black" stroke="black" points="24783.19,-368.35 24791.99,-362.45 24781.43,-361.57 24783.19,-368.35"/>
</g>
<!-- layer2_expert8_13 -->
<g id="node373" class="node">
<title>layer2_expert8_13</title>
<polygon fill="lightgreen" stroke="black" points="25158,-365 24984,-365 24984,-282 25158,-282 25158,-365"/>
<text text-anchor="middle" x="25071" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU8</text>
<text text-anchor="middle" x="25071" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="25071" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="25071" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="25071" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_13 -->
<g id="edge617" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24233.23,-435.36C24432.75,-424.58 24820.69,-400.2 24974,-364.96"/>
<polygon fill="black" stroke="black" points="24974.84,-368.36 24983.75,-362.63 24973.21,-361.55 24974.84,-368.36"/>
</g>
<!-- layer2_expert8_14 -->
<g id="node374" class="node">
<title>layer2_expert8_14</title>
<polygon fill="lightgreen" stroke="black" points="25350,-365 25176,-365 25176,-282 25350,-282 25350,-365"/>
<text text-anchor="middle" x="25263" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU8</text>
<text text-anchor="middle" x="25263" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="25263" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="25263" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="25263" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_14 -->
<g id="edge618" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24233.08,-437.65C24467.72,-429.46 24974.62,-407.62 25165.81,-364.99"/>
<polygon fill="black" stroke="black" points="25166.81,-368.35 25175.77,-362.69 25165.23,-361.54 25166.81,-368.35"/>
</g>
<!-- layer2_expert8_15 -->
<g id="node375" class="node">
<title>layer2_expert8_15</title>
<polygon fill="lightgreen" stroke="black" points="25542,-365 25368,-365 25368,-282 25542,-282 25542,-365"/>
<text text-anchor="middle" x="25455" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU8</text>
<text text-anchor="middle" x="25455" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="25455" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="25455" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="25455" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_15 -->
<g id="edge619" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24233.18,-439.24C24500.05,-433.47 25128.75,-415.11 25357.83,-364.99"/>
<polygon fill="black" stroke="black" points="25358.8,-368.35 25367.78,-362.73 25357.25,-361.53 25358.8,-368.35"/>
</g>
<!-- layer2_moe_agg_gpu8 -->
<g id="node376" class="node">
<title>layer2_moe_agg_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="24116.5,-246 23913.5,-246 23913.5,-178 24116.5,-178 24116.5,-246"/>
<text text-anchor="middle" x="24015" y="-230.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU8</text>
<text text-anchor="middle" x="24015" y="-215.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="24015" y="-200.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="24015" y="-185.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_expert8_0&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge620" class="edge">
<title>layer2_expert8_0&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M22662.22,-284.23C22665.16,-283.42 22668.09,-282.67 22671,-282 22904.11,-228.58 23623.88,-216.47 23902.88,-213.77"/>
<polygon fill="black" stroke="black" points="23903.06,-217.27 23913.02,-213.67 23902.99,-210.27 23903.06,-217.27"/>
</g>
<!-- layer2_expert8_1&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge621" class="edge">
<title>layer2_expert8_1&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M22854.22,-284.27C22857.16,-283.44 22860.09,-282.68 22863,-282 23058.44,-236.34 23653.55,-219.89 23903.05,-214.89"/>
<polygon fill="black" stroke="black" points="23903.3,-218.39 23913.23,-214.69 23903.16,-211.39 23903.3,-218.39"/>
</g>
<!-- layer2_expert8_2&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge622" class="edge">
<title>layer2_expert8_2&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23046.23,-284.31C23049.17,-283.47 23052.1,-282.7 23055,-282 23213.15,-244.05 23685.85,-223.92 23903.3,-216.45"/>
<polygon fill="black" stroke="black" points="23903.59,-219.94 23913.46,-216.1 23903.35,-212.95 23903.59,-219.94"/>
</g>
<!-- layer2_expert8_3&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge623" class="edge">
<title>layer2_expert8_3&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23238.25,-284.38C23241.18,-283.52 23244.1,-282.72 23247,-282 23475.24,-225.08 23751.98,-213.79 23903.11,-212.31"/>
<polygon fill="black" stroke="black" points="23903.36,-215.81 23913.33,-212.22 23903.3,-208.81 23903.36,-215.81"/>
</g>
<!-- layer2_expert8_4&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge624" class="edge">
<title>layer2_expert8_4&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23430.01,-284.57C23433.03,-283.65 23436.03,-282.79 23439,-282 23596.85,-240.14 23785.82,-223.63 23903.16,-217.14"/>
<polygon fill="black" stroke="black" points="23903.44,-220.63 23913.24,-216.6 23903.07,-213.64 23903.44,-220.63"/>
</g>
<!-- layer2_expert8_5&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge625" class="edge">
<title>layer2_expert8_5&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23622.08,-284.8C23625.07,-283.81 23628.05,-282.87 23631,-282 23720.8,-255.35 23825.64,-237.36 23903.06,-226.44"/>
<polygon fill="black" stroke="black" points="23903.9,-229.86 23913.32,-225.02 23902.93,-222.93 23903.9,-229.86"/>
</g>
<!-- layer2_expert8_6&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge626" class="edge">
<title>layer2_expert8_6&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23814.04,-285.54C23817.06,-284.33 23820.05,-283.15 23823,-282 23851.16,-271.01 23881.89,-259.68 23910.34,-249.45"/>
<polygon fill="black" stroke="black" points="23911.66,-252.7 23919.89,-246.03 23909.3,-246.11 23911.66,-252.7"/>
</g>
<!-- layer2_expert8_7&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge627" class="edge">
<title>layer2_expert8_7&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23954.75,-281.73C23962.66,-272.7 23971.06,-263.12 23978.98,-254.08"/>
<polygon fill="black" stroke="black" points="23981.85,-256.13 23985.81,-246.3 23976.58,-251.51 23981.85,-256.13"/>
</g>
<!-- layer2_expert8_8&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge628" class="edge">
<title>layer2_expert8_8&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M24075.25,-281.73C24067.34,-272.7 24058.94,-263.12 24051.02,-254.08"/>
<polygon fill="black" stroke="black" points="24053.42,-251.51 24044.19,-246.3 24048.15,-256.13 24053.42,-251.51"/>
</g>
<!-- layer2_expert8_9&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge629" class="edge">
<title>layer2_expert8_9&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M24215.96,-285.54C24212.94,-284.33 24209.95,-283.15 24207,-282 24178.84,-271.01 24148.11,-259.68 24119.66,-249.45"/>
<polygon fill="black" stroke="black" points="24120.7,-246.11 24110.11,-246.03 24118.34,-252.7 24120.7,-246.11"/>
</g>
<!-- layer2_expert8_10&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge630" class="edge">
<title>layer2_expert8_10&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M24407.92,-284.8C24404.93,-283.81 24401.95,-282.87 24399,-282 24309.2,-255.35 24204.36,-237.36 24126.94,-226.44"/>
<polygon fill="black" stroke="black" points="24127.07,-222.93 24116.68,-225.02 24126.1,-229.86 24127.07,-222.93"/>
</g>
<!-- layer2_expert8_11&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge631" class="edge">
<title>layer2_expert8_11&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M24599.99,-284.57C24596.97,-283.65 24593.97,-282.79 24591,-282 24433.15,-240.14 24244.18,-223.63 24126.84,-217.14"/>
<polygon fill="black" stroke="black" points="24126.93,-213.64 24116.76,-216.6 24126.56,-220.63 24126.93,-213.64"/>
</g>
<!-- layer2_expert8_12&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge632" class="edge">
<title>layer2_expert8_12&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M24791.75,-284.38C24788.82,-283.52 24785.9,-282.72 24783,-282 24554.76,-225.08 24278.02,-213.79 24126.89,-212.31"/>
<polygon fill="black" stroke="black" points="24126.7,-208.81 24116.67,-212.22 24126.64,-215.81 24126.7,-208.81"/>
</g>
<!-- layer2_expert8_13&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge633" class="edge">
<title>layer2_expert8_13&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M24983.77,-284.31C24980.83,-283.47 24977.9,-282.7 24975,-282 24816.85,-244.05 24344.15,-223.92 24126.7,-216.45"/>
<polygon fill="black" stroke="black" points="24126.65,-212.95 24116.54,-216.1 24126.41,-219.94 24126.65,-212.95"/>
</g>
<!-- layer2_expert8_14&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge634" class="edge">
<title>layer2_expert8_14&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M25175.78,-284.27C25172.84,-283.44 25169.91,-282.68 25167,-282 24971.56,-236.34 24376.45,-219.89 24126.95,-214.89"/>
<polygon fill="black" stroke="black" points="24126.84,-211.39 24116.77,-214.69 24126.7,-218.39 24126.84,-211.39"/>
</g>
<!-- layer2_expert8_15&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge635" class="edge">
<title>layer2_expert8_15&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M25367.78,-284.23C25364.84,-283.42 25361.91,-282.67 25359,-282 25125.89,-228.58 24406.12,-216.47 24127.12,-213.77"/>
<polygon fill="black" stroke="black" points="24127.01,-210.27 24116.98,-213.67 24126.94,-217.27 24127.01,-210.27"/>
</g>
<!-- layer2_output_gpu8 -->
<g id="node377" class="node">
<title>layer2_output_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="24137,-142 23893,-142 23893,-74 24137,-74 24137,-142"/>
<text text-anchor="middle" x="24015" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="24015" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="24015" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="24015" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_moe_agg_gpu8&#45;&gt;layer2_output_gpu8 -->
<g id="edge636" class="edge">
<title>layer2_moe_agg_gpu8&#45;&gt;layer2_output_gpu8</title>
<path fill="none" stroke="black" d="M24015,-177.88C24015,-169.78 24015,-160.98 24015,-152.47"/>
<polygon fill="black" stroke="black" points="24018.5,-152.3 24015,-142.3 24011.5,-152.3 24018.5,-152.3"/>
</g>
<!-- layer2_qkv_gpu9 -->
<g id="node378" class="node">
<title>layer2_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="31572,-796 31360,-796 31360,-728 31572,-728 31572,-796"/>
<text text-anchor="middle" x="31466" y="-780.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU9</text>
<text text-anchor="middle" x="31466" y="-765.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="31466" y="-750.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="31466" y="-735.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_attn_gpu9 -->
<g id="node379" class="node">
<title>layer2_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="29140.5,-692 28897.5,-692 28897.5,-624 29140.5,-624 29140.5,-692"/>
<text text-anchor="middle" x="29019" y="-676.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU9</text>
<text text-anchor="middle" x="29019" y="-661.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="29019" y="-646.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="29019" y="-631.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_qkv_gpu9&#45;&gt;layer2_attn_gpu9 -->
<g id="edge637" class="edge">
<title>layer2_qkv_gpu9&#45;&gt;layer2_attn_gpu9</title>
<path fill="none" stroke="black" d="M31359.96,-732.07C31351.89,-730.49 31343.84,-729.1 31336,-728 30909.41,-668.24 29576.06,-660.18 29150.76,-659.14"/>
<polygon fill="black" stroke="black" points="29150.58,-655.64 29140.58,-659.11 29150.57,-662.64 29150.58,-655.64"/>
</g>
<!-- layer2_attn_norm_gpu9 -->
<g id="node380" class="node">
<title>layer2_attn_norm_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="27917,-588 27673,-588 27673,-520 27917,-520 27917,-588"/>
<text text-anchor="middle" x="27795" y="-572.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="27795" y="-557.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="27795" y="-542.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="27795" y="-527.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_attn_gpu9&#45;&gt;layer2_attn_norm_gpu9 -->
<g id="edge638" class="edge">
<title>layer2_attn_gpu9&#45;&gt;layer2_attn_norm_gpu9</title>
<path fill="none" stroke="black" d="M28897.48,-625.58C28894.29,-625.02 28891.13,-624.49 28888,-624 28544.39,-570.34 28133.81,-558.14 27927.38,-555.54"/>
<polygon fill="black" stroke="black" points="27927.14,-552.04 27917.1,-555.42 27927.05,-559.04 27927.14,-552.04"/>
</g>
<!-- layer2_gate_gpu9 -->
<g id="node381" class="node">
<title>layer2_gate_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="27305,-484 27061,-484 27061,-401 27305,-401 27305,-484"/>
<text text-anchor="middle" x="27183" y="-468.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU9</text>
<text text-anchor="middle" x="27183" y="-453.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="27183" y="-438.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="27183" y="-423.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="27183" y="-408.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_attn_norm_gpu9&#45;&gt;layer2_gate_gpu9 -->
<g id="edge639" class="edge">
<title>layer2_attn_norm_gpu9&#45;&gt;layer2_gate_gpu9</title>
<path fill="none" stroke="black" d="M27672.99,-531.17C27569.54,-512.66 27421.45,-486.16 27315.2,-467.15"/>
<polygon fill="black" stroke="black" points="27315.51,-463.65 27305.05,-465.34 27314.28,-470.54 27315.51,-463.65"/>
</g>
<!-- layer2_expert9_0 -->
<g id="node382" class="node">
<title>layer2_expert9_0</title>
<polygon fill="lightgreen" stroke="black" points="25734,-365 25560,-365 25560,-282 25734,-282 25734,-365"/>
<text text-anchor="middle" x="25647" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU9</text>
<text text-anchor="middle" x="25647" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="25647" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="25647" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="25647" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_0 -->
<g id="edge640" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27060.8,-440.41C26764.21,-436.92 26011.59,-422.7 25744.29,-365.01"/>
<polygon fill="black" stroke="black" points="25744.74,-361.52 25734.22,-362.76 25743.22,-368.35 25744.74,-361.52"/>
</g>
<!-- layer2_expert9_1 -->
<g id="node383" class="node">
<title>layer2_expert9_1</title>
<polygon fill="lightgreen" stroke="black" points="25926,-365 25752,-365 25752,-282 25926,-282 25926,-365"/>
<text text-anchor="middle" x="25839" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU9</text>
<text text-anchor="middle" x="25839" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="25839" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="25839" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="25839" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_1 -->
<g id="edge641" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27060.82,-439.24C26793.95,-433.47 26165.25,-415.11 25936.17,-364.99"/>
<polygon fill="black" stroke="black" points="25936.75,-361.53 25926.22,-362.73 25935.2,-368.35 25936.75,-361.53"/>
</g>
<!-- layer2_expert9_2 -->
<g id="node384" class="node">
<title>layer2_expert9_2</title>
<polygon fill="lightgreen" stroke="black" points="26118,-365 25944,-365 25944,-282 26118,-282 26118,-365"/>
<text text-anchor="middle" x="26031" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU9</text>
<text text-anchor="middle" x="26031" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26031" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26031" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26031" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_2 -->
<g id="edge642" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27060.92,-437.65C26826.28,-429.46 26319.38,-407.62 26128.19,-364.99"/>
<polygon fill="black" stroke="black" points="26128.77,-361.54 26118.23,-362.69 26127.19,-368.35 26128.77,-361.54"/>
</g>
<!-- layer2_expert9_3 -->
<g id="node385" class="node">
<title>layer2_expert9_3</title>
<polygon fill="lightgreen" stroke="black" points="26310,-365 26136,-365 26136,-282 26310,-282 26310,-365"/>
<text text-anchor="middle" x="26223" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU9</text>
<text text-anchor="middle" x="26223" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26223" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26223" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26223" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_3 -->
<g id="edge643" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27060.77,-435.36C26861.25,-424.58 26473.31,-400.2 26320,-364.96"/>
<polygon fill="black" stroke="black" points="26320.79,-361.55 26310.25,-362.63 26319.16,-368.36 26320.79,-361.55"/>
</g>
<!-- layer2_expert9_4 -->
<g id="node386" class="node">
<title>layer2_expert9_4</title>
<polygon fill="lightgreen" stroke="black" points="26502,-365 26328,-365 26328,-282 26502,-282 26502,-365"/>
<text text-anchor="middle" x="26415" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU9</text>
<text text-anchor="middle" x="26415" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26415" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26415" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26415" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_4 -->
<g id="edge644" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27060.91,-438.05C26927.03,-431.91 26706.46,-414.84 26511.84,-365"/>
<polygon fill="black" stroke="black" points="26512.57,-361.57 26502.01,-362.45 26510.81,-368.35 26512.57,-361.57"/>
</g>
<!-- layer2_expert9_5 -->
<g id="node387" class="node">
<title>layer2_expert9_5</title>
<polygon fill="lightgreen" stroke="black" points="26694,-365 26520,-365 26520,-282 26694,-282 26694,-365"/>
<text text-anchor="middle" x="26607" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU9</text>
<text text-anchor="middle" x="26607" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26607" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26607" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26607" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_5 -->
<g id="edge645" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27060.91,-430.26C26965.32,-419.56 26829.37,-400.14 26703.84,-365.05"/>
<polygon fill="black" stroke="black" points="26704.63,-361.64 26694.06,-362.28 26702.72,-368.37 26704.63,-361.64"/>
</g>
<!-- layer2_expert9_6 -->
<g id="node388" class="node">
<title>layer2_expert9_6</title>
<polygon fill="lightgreen" stroke="black" points="26886,-365 26712,-365 26712,-282 26886,-282 26886,-365"/>
<text text-anchor="middle" x="26799" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU9</text>
<text text-anchor="middle" x="26799" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26799" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26799" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26799" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_6 -->
<g id="edge646" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27060.66,-413.02C27011.66,-400.63 26954.72,-385.01 26895.67,-365.12"/>
<polygon fill="black" stroke="black" points="26896.77,-361.79 26886.18,-361.89 26894.52,-368.42 26896.77,-361.79"/>
</g>
<!-- layer2_expert9_7 -->
<g id="node389" class="node">
<title>layer2_expert9_7</title>
<polygon fill="lightgreen" stroke="black" points="27078,-365 26904,-365 26904,-282 27078,-282 27078,-365"/>
<text text-anchor="middle" x="26991" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU9</text>
<text text-anchor="middle" x="26991" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="26991" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="26991" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="26991" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_7 -->
<g id="edge647" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27116.39,-400.91C27100.15,-391.02 27082.68,-380.37 27066.08,-370.25"/>
<polygon fill="black" stroke="black" points="27067.86,-367.24 27057.5,-365.02 27064.21,-373.21 27067.86,-367.24"/>
</g>
<!-- layer2_expert9_8 -->
<g id="node390" class="node">
<title>layer2_expert9_8</title>
<polygon fill="lightgreen" stroke="black" points="27270,-365 27096,-365 27096,-282 27270,-282 27270,-365"/>
<text text-anchor="middle" x="27183" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU9</text>
<text text-anchor="middle" x="27183" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27183" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27183" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27183" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_8 -->
<g id="edge648" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27183,-400.91C27183,-392.65 27183,-383.86 27183,-375.3"/>
<polygon fill="black" stroke="black" points="27186.5,-375.02 27183,-365.02 27179.5,-375.02 27186.5,-375.02"/>
</g>
<!-- layer2_expert9_9 -->
<g id="node391" class="node">
<title>layer2_expert9_9</title>
<polygon fill="lightgreen" stroke="black" points="27462,-365 27288,-365 27288,-282 27462,-282 27462,-365"/>
<text text-anchor="middle" x="27375" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU9</text>
<text text-anchor="middle" x="27375" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27375" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27375" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27375" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_9 -->
<g id="edge649" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27249.61,-400.91C27265.85,-391.02 27283.32,-380.37 27299.92,-370.25"/>
<polygon fill="black" stroke="black" points="27301.79,-373.21 27308.5,-365.02 27298.14,-367.24 27301.79,-373.21"/>
</g>
<!-- layer2_expert9_10 -->
<g id="node392" class="node">
<title>layer2_expert9_10</title>
<polygon fill="lightgreen" stroke="black" points="27654,-365 27480,-365 27480,-282 27654,-282 27654,-365"/>
<text text-anchor="middle" x="27567" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU9</text>
<text text-anchor="middle" x="27567" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27567" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27567" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27567" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_10 -->
<g id="edge650" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27305.34,-413.02C27354.34,-400.63 27411.28,-385.01 27470.33,-365.12"/>
<polygon fill="black" stroke="black" points="27471.48,-368.42 27479.82,-361.89 27469.23,-361.79 27471.48,-368.42"/>
</g>
<!-- layer2_expert9_11 -->
<g id="node393" class="node">
<title>layer2_expert9_11</title>
<polygon fill="lightgreen" stroke="black" points="27846,-365 27672,-365 27672,-282 27846,-282 27846,-365"/>
<text text-anchor="middle" x="27759" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU9</text>
<text text-anchor="middle" x="27759" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27759" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27759" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27759" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_11 -->
<g id="edge651" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27305.09,-430.26C27400.68,-419.56 27536.63,-400.14 27662.16,-365.05"/>
<polygon fill="black" stroke="black" points="27663.28,-368.37 27671.94,-362.28 27661.37,-361.64 27663.28,-368.37"/>
</g>
<!-- layer2_expert9_12 -->
<g id="node394" class="node">
<title>layer2_expert9_12</title>
<polygon fill="lightgreen" stroke="black" points="28038,-365 27864,-365 27864,-282 28038,-282 28038,-365"/>
<text text-anchor="middle" x="27951" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU9</text>
<text text-anchor="middle" x="27951" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="27951" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="27951" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="27951" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_12 -->
<g id="edge652" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27305.09,-438.05C27438.97,-431.91 27659.54,-414.84 27854.16,-365"/>
<polygon fill="black" stroke="black" points="27855.19,-368.35 27863.99,-362.45 27853.43,-361.57 27855.19,-368.35"/>
</g>
<!-- layer2_expert9_13 -->
<g id="node395" class="node">
<title>layer2_expert9_13</title>
<polygon fill="lightgreen" stroke="black" points="28230,-365 28056,-365 28056,-282 28230,-282 28230,-365"/>
<text text-anchor="middle" x="28143" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU9</text>
<text text-anchor="middle" x="28143" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="28143" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="28143" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="28143" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_13 -->
<g id="edge653" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27305.23,-435.36C27504.75,-424.58 27892.69,-400.2 28046,-364.96"/>
<polygon fill="black" stroke="black" points="28046.84,-368.36 28055.75,-362.63 28045.21,-361.55 28046.84,-368.36"/>
</g>
<!-- layer2_expert9_14 -->
<g id="node396" class="node">
<title>layer2_expert9_14</title>
<polygon fill="lightgreen" stroke="black" points="28422,-365 28248,-365 28248,-282 28422,-282 28422,-365"/>
<text text-anchor="middle" x="28335" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU9</text>
<text text-anchor="middle" x="28335" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="28335" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="28335" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="28335" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_14 -->
<g id="edge654" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27305.08,-437.65C27539.72,-429.46 28046.62,-407.62 28237.81,-364.99"/>
<polygon fill="black" stroke="black" points="28238.81,-368.35 28247.77,-362.69 28237.23,-361.54 28238.81,-368.35"/>
</g>
<!-- layer2_expert9_15 -->
<g id="node397" class="node">
<title>layer2_expert9_15</title>
<polygon fill="lightgreen" stroke="black" points="28614,-365 28440,-365 28440,-282 28614,-282 28614,-365"/>
<text text-anchor="middle" x="28527" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU9</text>
<text text-anchor="middle" x="28527" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="28527" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="28527" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="28527" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_15 -->
<g id="edge655" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27305.18,-439.24C27572.05,-433.47 28200.75,-415.11 28429.83,-364.99"/>
<polygon fill="black" stroke="black" points="28430.8,-368.35 28439.78,-362.73 28429.25,-361.53 28430.8,-368.35"/>
</g>
<!-- layer2_moe_agg_gpu9 -->
<g id="node398" class="node">
<title>layer2_moe_agg_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="27188.5,-246 26985.5,-246 26985.5,-178 27188.5,-178 27188.5,-246"/>
<text text-anchor="middle" x="27087" y="-230.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU9</text>
<text text-anchor="middle" x="27087" y="-215.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="27087" y="-200.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="27087" y="-185.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_expert9_0&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge656" class="edge">
<title>layer2_expert9_0&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M25734.22,-284.23C25737.16,-283.42 25740.09,-282.67 25743,-282 25976.11,-228.58 26695.88,-216.47 26974.88,-213.77"/>
<polygon fill="black" stroke="black" points="26975.06,-217.27 26985.02,-213.67 26974.99,-210.27 26975.06,-217.27"/>
</g>
<!-- layer2_expert9_1&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge657" class="edge">
<title>layer2_expert9_1&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M25926.22,-284.27C25929.16,-283.44 25932.09,-282.68 25935,-282 26130.44,-236.34 26725.55,-219.89 26975.05,-214.89"/>
<polygon fill="black" stroke="black" points="26975.3,-218.39 26985.23,-214.69 26975.16,-211.39 26975.3,-218.39"/>
</g>
<!-- layer2_expert9_2&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge658" class="edge">
<title>layer2_expert9_2&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26118.23,-284.31C26121.17,-283.47 26124.1,-282.7 26127,-282 26285.15,-244.05 26757.85,-223.92 26975.3,-216.45"/>
<polygon fill="black" stroke="black" points="26975.59,-219.94 26985.46,-216.1 26975.35,-212.95 26975.59,-219.94"/>
</g>
<!-- layer2_expert9_3&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge659" class="edge">
<title>layer2_expert9_3&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26310.25,-284.38C26313.18,-283.52 26316.1,-282.72 26319,-282 26547.24,-225.08 26823.98,-213.79 26975.11,-212.31"/>
<polygon fill="black" stroke="black" points="26975.36,-215.81 26985.33,-212.22 26975.3,-208.81 26975.36,-215.81"/>
</g>
<!-- layer2_expert9_4&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge660" class="edge">
<title>layer2_expert9_4&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26502.01,-284.57C26505.03,-283.65 26508.03,-282.79 26511,-282 26668.85,-240.14 26857.82,-223.63 26975.16,-217.14"/>
<polygon fill="black" stroke="black" points="26975.44,-220.63 26985.24,-216.6 26975.07,-213.64 26975.44,-220.63"/>
</g>
<!-- layer2_expert9_5&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge661" class="edge">
<title>layer2_expert9_5&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26694.08,-284.8C26697.07,-283.81 26700.05,-282.87 26703,-282 26792.8,-255.35 26897.64,-237.36 26975.06,-226.44"/>
<polygon fill="black" stroke="black" points="26975.9,-229.86 26985.32,-225.02 26974.93,-222.93 26975.9,-229.86"/>
</g>
<!-- layer2_expert9_6&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge662" class="edge">
<title>layer2_expert9_6&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26886.04,-285.54C26889.06,-284.33 26892.05,-283.15 26895,-282 26923.16,-271.01 26953.89,-259.68 26982.34,-249.45"/>
<polygon fill="black" stroke="black" points="26983.66,-252.7 26991.89,-246.03 26981.3,-246.11 26983.66,-252.7"/>
</g>
<!-- layer2_expert9_7&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge663" class="edge">
<title>layer2_expert9_7&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M27026.75,-281.73C27034.66,-272.7 27043.06,-263.12 27050.98,-254.08"/>
<polygon fill="black" stroke="black" points="27053.85,-256.13 27057.81,-246.3 27048.58,-251.51 27053.85,-256.13"/>
</g>
<!-- layer2_expert9_8&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge664" class="edge">
<title>layer2_expert9_8&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M27147.25,-281.73C27139.34,-272.7 27130.94,-263.12 27123.02,-254.08"/>
<polygon fill="black" stroke="black" points="27125.42,-251.51 27116.19,-246.3 27120.15,-256.13 27125.42,-251.51"/>
</g>
<!-- layer2_expert9_9&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge665" class="edge">
<title>layer2_expert9_9&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M27287.96,-285.54C27284.94,-284.33 27281.95,-283.15 27279,-282 27250.84,-271.01 27220.11,-259.68 27191.66,-249.45"/>
<polygon fill="black" stroke="black" points="27192.7,-246.11 27182.11,-246.03 27190.34,-252.7 27192.7,-246.11"/>
</g>
<!-- layer2_expert9_10&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge666" class="edge">
<title>layer2_expert9_10&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M27479.92,-284.8C27476.93,-283.81 27473.95,-282.87 27471,-282 27381.2,-255.35 27276.36,-237.36 27198.94,-226.44"/>
<polygon fill="black" stroke="black" points="27199.07,-222.93 27188.68,-225.02 27198.1,-229.86 27199.07,-222.93"/>
</g>
<!-- layer2_expert9_11&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge667" class="edge">
<title>layer2_expert9_11&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M27671.99,-284.57C27668.97,-283.65 27665.97,-282.79 27663,-282 27505.15,-240.14 27316.18,-223.63 27198.84,-217.14"/>
<polygon fill="black" stroke="black" points="27198.93,-213.64 27188.76,-216.6 27198.56,-220.63 27198.93,-213.64"/>
</g>
<!-- layer2_expert9_12&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge668" class="edge">
<title>layer2_expert9_12&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M27863.75,-284.38C27860.82,-283.52 27857.9,-282.72 27855,-282 27626.76,-225.08 27350.02,-213.79 27198.89,-212.31"/>
<polygon fill="black" stroke="black" points="27198.7,-208.81 27188.67,-212.22 27198.64,-215.81 27198.7,-208.81"/>
</g>
<!-- layer2_expert9_13&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge669" class="edge">
<title>layer2_expert9_13&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M28055.77,-284.31C28052.83,-283.47 28049.9,-282.7 28047,-282 27888.85,-244.05 27416.15,-223.92 27198.7,-216.45"/>
<polygon fill="black" stroke="black" points="27198.65,-212.95 27188.54,-216.1 27198.41,-219.94 27198.65,-212.95"/>
</g>
<!-- layer2_expert9_14&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge670" class="edge">
<title>layer2_expert9_14&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M28247.78,-284.27C28244.84,-283.44 28241.91,-282.68 28239,-282 28043.56,-236.34 27448.45,-219.89 27198.95,-214.89"/>
<polygon fill="black" stroke="black" points="27198.84,-211.39 27188.77,-214.69 27198.7,-218.39 27198.84,-211.39"/>
</g>
<!-- layer2_expert9_15&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge671" class="edge">
<title>layer2_expert9_15&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M28439.78,-284.23C28436.84,-283.42 28433.91,-282.67 28431,-282 28197.89,-228.58 27478.12,-216.47 27199.12,-213.77"/>
<polygon fill="black" stroke="black" points="27199.01,-210.27 27188.98,-213.67 27198.94,-217.27 27199.01,-210.27"/>
</g>
<!-- layer2_output_gpu9 -->
<g id="node399" class="node">
<title>layer2_output_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="27209,-142 26965,-142 26965,-74 27209,-74 27209,-142"/>
<text text-anchor="middle" x="27087" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="27087" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="27087" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="27087" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_moe_agg_gpu9&#45;&gt;layer2_output_gpu9 -->
<g id="edge672" class="edge">
<title>layer2_moe_agg_gpu9&#45;&gt;layer2_output_gpu9</title>
<path fill="none" stroke="black" d="M27087,-177.88C27087,-169.78 27087,-160.98 27087,-152.47"/>
<polygon fill="black" stroke="black" points="27090.5,-152.3 27087,-142.3 27083.5,-152.3 27090.5,-152.3"/>
</g>
<!-- layer2_qkv_gpu10 -->
<g id="node400" class="node">
<title>layer2_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="33494,-796 33282,-796 33282,-728 33494,-728 33494,-796"/>
<text text-anchor="middle" x="33388" y="-780.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU10</text>
<text text-anchor="middle" x="33388" y="-765.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33388" y="-750.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="33388" y="-735.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_attn_gpu10 -->
<g id="node401" class="node">
<title>layer2_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="32794,-692 32542,-692 32542,-624 32794,-624 32794,-692"/>
<text text-anchor="middle" x="32668" y="-676.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU10</text>
<text text-anchor="middle" x="32668" y="-661.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="32668" y="-646.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="32668" y="-631.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_qkv_gpu10&#45;&gt;layer2_attn_gpu10 -->
<g id="edge673" class="edge">
<title>layer2_qkv_gpu10&#45;&gt;layer2_attn_gpu10</title>
<path fill="none" stroke="black" d="M33281.76,-745.95C33155.06,-728 32943.04,-697.96 32804.36,-678.32"/>
<polygon fill="black" stroke="black" points="32804.48,-674.8 32794.08,-676.86 32803.49,-681.73 32804.48,-674.8"/>
</g>
<!-- layer2_attn_norm_gpu10 -->
<g id="node402" class="node">
<title>layer2_attn_norm_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="32434.5,-588 32181.5,-588 32181.5,-520 32434.5,-520 32434.5,-588"/>
<text text-anchor="middle" x="32308" y="-572.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="32308" y="-557.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="32308" y="-542.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="32308" y="-527.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_attn_gpu10&#45;&gt;layer2_attn_norm_gpu10 -->
<g id="edge674" class="edge">
<title>layer2_attn_gpu10&#45;&gt;layer2_attn_norm_gpu10</title>
<path fill="none" stroke="black" d="M32551.12,-623.88C32513.9,-613.34 32472.55,-601.62 32434.67,-590.89"/>
<polygon fill="black" stroke="black" points="32435.18,-587.4 32424.6,-588.04 32433.27,-594.13 32435.18,-587.4"/>
</g>
<!-- layer2_gate_gpu10 -->
<g id="node403" class="node">
<title>layer2_gate_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="30377,-484 30133,-484 30133,-401 30377,-401 30377,-484"/>
<text text-anchor="middle" x="30255" y="-468.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU10</text>
<text text-anchor="middle" x="30255" y="-453.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="30255" y="-438.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="30255" y="-423.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="30255" y="-408.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_attn_norm_gpu10&#45;&gt;layer2_gate_gpu10 -->
<g id="edge675" class="edge">
<title>layer2_attn_norm_gpu10&#45;&gt;layer2_gate_gpu10</title>
<path fill="none" stroke="black" d="M32181.12,-546.23C31815.1,-526.71 30759.7,-470.42 30387.15,-450.55"/>
<polygon fill="black" stroke="black" points="30387.3,-447.05 30377.13,-450.01 30386.93,-454.04 30387.3,-447.05"/>
</g>
<!-- layer2_expert10_0 -->
<g id="node404" class="node">
<title>layer2_expert10_0</title>
<polygon fill="lightgreen" stroke="black" points="28806,-365 28632,-365 28632,-282 28806,-282 28806,-365"/>
<text text-anchor="middle" x="28719" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU10</text>
<text text-anchor="middle" x="28719" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="28719" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="28719" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="28719" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_0 -->
<g id="edge676" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30132.8,-440.41C29836.21,-436.92 29083.59,-422.7 28816.29,-365.01"/>
<polygon fill="black" stroke="black" points="28816.74,-361.52 28806.22,-362.76 28815.22,-368.35 28816.74,-361.52"/>
</g>
<!-- layer2_expert10_1 -->
<g id="node405" class="node">
<title>layer2_expert10_1</title>
<polygon fill="lightgreen" stroke="black" points="28998,-365 28824,-365 28824,-282 28998,-282 28998,-365"/>
<text text-anchor="middle" x="28911" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU10</text>
<text text-anchor="middle" x="28911" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="28911" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="28911" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="28911" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_1 -->
<g id="edge677" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30132.82,-439.24C29865.95,-433.47 29237.25,-415.11 29008.17,-364.99"/>
<polygon fill="black" stroke="black" points="29008.75,-361.53 28998.22,-362.73 29007.2,-368.35 29008.75,-361.53"/>
</g>
<!-- layer2_expert10_2 -->
<g id="node406" class="node">
<title>layer2_expert10_2</title>
<polygon fill="lightgreen" stroke="black" points="29190,-365 29016,-365 29016,-282 29190,-282 29190,-365"/>
<text text-anchor="middle" x="29103" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU10</text>
<text text-anchor="middle" x="29103" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="29103" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="29103" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="29103" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_2 -->
<g id="edge678" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30132.92,-437.65C29898.28,-429.46 29391.38,-407.62 29200.19,-364.99"/>
<polygon fill="black" stroke="black" points="29200.77,-361.54 29190.23,-362.69 29199.19,-368.35 29200.77,-361.54"/>
</g>
<!-- layer2_expert10_3 -->
<g id="node407" class="node">
<title>layer2_expert10_3</title>
<polygon fill="lightgreen" stroke="black" points="29382,-365 29208,-365 29208,-282 29382,-282 29382,-365"/>
<text text-anchor="middle" x="29295" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU10</text>
<text text-anchor="middle" x="29295" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="29295" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="29295" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="29295" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_3 -->
<g id="edge679" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30132.77,-435.36C29933.25,-424.58 29545.31,-400.2 29392,-364.96"/>
<polygon fill="black" stroke="black" points="29392.79,-361.55 29382.25,-362.63 29391.16,-368.36 29392.79,-361.55"/>
</g>
<!-- layer2_expert10_4 -->
<g id="node408" class="node">
<title>layer2_expert10_4</title>
<polygon fill="lightgreen" stroke="black" points="29574,-365 29400,-365 29400,-282 29574,-282 29574,-365"/>
<text text-anchor="middle" x="29487" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU10</text>
<text text-anchor="middle" x="29487" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="29487" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="29487" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="29487" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_4 -->
<g id="edge680" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30132.91,-438.05C29999.03,-431.91 29778.46,-414.84 29583.84,-365"/>
<polygon fill="black" stroke="black" points="29584.57,-361.57 29574.01,-362.45 29582.81,-368.35 29584.57,-361.57"/>
</g>
<!-- layer2_expert10_5 -->
<g id="node409" class="node">
<title>layer2_expert10_5</title>
<polygon fill="lightgreen" stroke="black" points="29766,-365 29592,-365 29592,-282 29766,-282 29766,-365"/>
<text text-anchor="middle" x="29679" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU10</text>
<text text-anchor="middle" x="29679" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="29679" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="29679" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="29679" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_5 -->
<g id="edge681" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30132.91,-430.26C30037.32,-419.56 29901.37,-400.14 29775.84,-365.05"/>
<polygon fill="black" stroke="black" points="29776.63,-361.64 29766.06,-362.28 29774.72,-368.37 29776.63,-361.64"/>
</g>
<!-- layer2_expert10_6 -->
<g id="node410" class="node">
<title>layer2_expert10_6</title>
<polygon fill="lightgreen" stroke="black" points="29958,-365 29784,-365 29784,-282 29958,-282 29958,-365"/>
<text text-anchor="middle" x="29871" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU10</text>
<text text-anchor="middle" x="29871" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="29871" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="29871" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="29871" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_6 -->
<g id="edge682" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30132.66,-413.02C30083.66,-400.63 30026.72,-385.01 29967.67,-365.12"/>
<polygon fill="black" stroke="black" points="29968.77,-361.79 29958.18,-361.89 29966.52,-368.42 29968.77,-361.79"/>
</g>
<!-- layer2_expert10_7 -->
<g id="node411" class="node">
<title>layer2_expert10_7</title>
<polygon fill="lightgreen" stroke="black" points="30150,-365 29976,-365 29976,-282 30150,-282 30150,-365"/>
<text text-anchor="middle" x="30063" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU10</text>
<text text-anchor="middle" x="30063" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="30063" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="30063" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="30063" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_7 -->
<g id="edge683" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30188.39,-400.91C30172.15,-391.02 30154.68,-380.37 30138.08,-370.25"/>
<polygon fill="black" stroke="black" points="30139.86,-367.24 30129.5,-365.02 30136.21,-373.21 30139.86,-367.24"/>
</g>
<!-- layer2_expert10_8 -->
<g id="node412" class="node">
<title>layer2_expert10_8</title>
<polygon fill="lightgreen" stroke="black" points="30342,-365 30168,-365 30168,-282 30342,-282 30342,-365"/>
<text text-anchor="middle" x="30255" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU10</text>
<text text-anchor="middle" x="30255" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="30255" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="30255" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="30255" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_8 -->
<g id="edge684" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30255,-400.91C30255,-392.65 30255,-383.86 30255,-375.3"/>
<polygon fill="black" stroke="black" points="30258.5,-375.02 30255,-365.02 30251.5,-375.02 30258.5,-375.02"/>
</g>
<!-- layer2_expert10_9 -->
<g id="node413" class="node">
<title>layer2_expert10_9</title>
<polygon fill="lightgreen" stroke="black" points="30534,-365 30360,-365 30360,-282 30534,-282 30534,-365"/>
<text text-anchor="middle" x="30447" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU10</text>
<text text-anchor="middle" x="30447" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="30447" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="30447" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="30447" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_9 -->
<g id="edge685" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30321.61,-400.91C30337.85,-391.02 30355.32,-380.37 30371.92,-370.25"/>
<polygon fill="black" stroke="black" points="30373.79,-373.21 30380.5,-365.02 30370.14,-367.24 30373.79,-373.21"/>
</g>
<!-- layer2_expert10_10 -->
<g id="node414" class="node">
<title>layer2_expert10_10</title>
<polygon fill="lightgreen" stroke="black" points="30726,-365 30552,-365 30552,-282 30726,-282 30726,-365"/>
<text text-anchor="middle" x="30639" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU10</text>
<text text-anchor="middle" x="30639" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="30639" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="30639" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="30639" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_10 -->
<g id="edge686" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30377.34,-413.02C30426.34,-400.63 30483.28,-385.01 30542.33,-365.12"/>
<polygon fill="black" stroke="black" points="30543.48,-368.42 30551.82,-361.89 30541.23,-361.79 30543.48,-368.42"/>
</g>
<!-- layer2_expert10_11 -->
<g id="node415" class="node">
<title>layer2_expert10_11</title>
<polygon fill="lightgreen" stroke="black" points="30918,-365 30744,-365 30744,-282 30918,-282 30918,-365"/>
<text text-anchor="middle" x="30831" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU10</text>
<text text-anchor="middle" x="30831" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="30831" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="30831" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="30831" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_11 -->
<g id="edge687" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30377.09,-430.26C30472.68,-419.56 30608.63,-400.14 30734.16,-365.05"/>
<polygon fill="black" stroke="black" points="30735.28,-368.37 30743.94,-362.28 30733.37,-361.64 30735.28,-368.37"/>
</g>
<!-- layer2_expert10_12 -->
<g id="node416" class="node">
<title>layer2_expert10_12</title>
<polygon fill="lightgreen" stroke="black" points="31110,-365 30936,-365 30936,-282 31110,-282 31110,-365"/>
<text text-anchor="middle" x="31023" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU10</text>
<text text-anchor="middle" x="31023" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31023" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31023" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31023" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_12 -->
<g id="edge688" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30377.09,-438.05C30510.97,-431.91 30731.54,-414.84 30926.16,-365"/>
<polygon fill="black" stroke="black" points="30927.19,-368.35 30935.99,-362.45 30925.43,-361.57 30927.19,-368.35"/>
</g>
<!-- layer2_expert10_13 -->
<g id="node417" class="node">
<title>layer2_expert10_13</title>
<polygon fill="lightgreen" stroke="black" points="31302,-365 31128,-365 31128,-282 31302,-282 31302,-365"/>
<text text-anchor="middle" x="31215" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU10</text>
<text text-anchor="middle" x="31215" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31215" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31215" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31215" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_13 -->
<g id="edge689" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30377.23,-435.36C30576.75,-424.58 30964.69,-400.2 31118,-364.96"/>
<polygon fill="black" stroke="black" points="31118.84,-368.36 31127.75,-362.63 31117.21,-361.55 31118.84,-368.36"/>
</g>
<!-- layer2_expert10_14 -->
<g id="node418" class="node">
<title>layer2_expert10_14</title>
<polygon fill="lightgreen" stroke="black" points="31494,-365 31320,-365 31320,-282 31494,-282 31494,-365"/>
<text text-anchor="middle" x="31407" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU10</text>
<text text-anchor="middle" x="31407" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31407" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31407" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31407" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_14 -->
<g id="edge690" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30377.08,-437.65C30611.72,-429.46 31118.62,-407.62 31309.81,-364.99"/>
<polygon fill="black" stroke="black" points="31310.81,-368.35 31319.77,-362.69 31309.23,-361.54 31310.81,-368.35"/>
</g>
<!-- layer2_expert10_15 -->
<g id="node419" class="node">
<title>layer2_expert10_15</title>
<polygon fill="lightgreen" stroke="black" points="31686,-365 31512,-365 31512,-282 31686,-282 31686,-365"/>
<text text-anchor="middle" x="31599" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU10</text>
<text text-anchor="middle" x="31599" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31599" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31599" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31599" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_15 -->
<g id="edge691" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30377.18,-439.24C30644.05,-433.47 31272.75,-415.11 31501.83,-364.99"/>
<polygon fill="black" stroke="black" points="31502.8,-368.35 31511.78,-362.73 31501.25,-361.53 31502.8,-368.35"/>
</g>
<!-- layer2_moe_agg_gpu10 -->
<g id="node420" class="node">
<title>layer2_moe_agg_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="30265,-246 30053,-246 30053,-178 30265,-178 30265,-246"/>
<text text-anchor="middle" x="30159" y="-230.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU10</text>
<text text-anchor="middle" x="30159" y="-215.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="30159" y="-200.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="30159" y="-185.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_expert10_0&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge692" class="edge">
<title>layer2_expert10_0&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M28806.22,-284.23C28809.16,-283.42 28812.09,-282.67 28815,-282 29046.85,-228.87 29760.08,-216.61 30042.3,-213.81"/>
<polygon fill="black" stroke="black" points="30042.6,-217.31 30052.56,-213.71 30042.53,-210.31 30042.6,-217.31"/>
</g>
<!-- layer2_expert10_1&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge693" class="edge">
<title>layer2_expert10_1&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M28998.22,-284.27C29001.16,-283.44 29004.09,-282.68 29007,-282 29201.24,-236.62 29790.24,-220.09 30042.41,-214.98"/>
<polygon fill="black" stroke="black" points="30042.77,-218.48 30052.7,-214.78 30042.63,-211.48 30042.77,-218.48"/>
</g>
<!-- layer2_expert10_2&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge694" class="edge">
<title>layer2_expert10_2&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29190.23,-284.31C29193.17,-283.47 29196.1,-282.7 29199,-282 29356.05,-244.32 29823.3,-224.2 30042.73,-216.61"/>
<polygon fill="black" stroke="black" points="30043.12,-220.1 30052.99,-216.26 30042.88,-213.1 30043.12,-220.1"/>
</g>
<!-- layer2_expert10_3&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge695" class="edge">
<title>layer2_expert10_3&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29382.25,-284.38C29385.18,-283.52 29388.1,-282.72 29391,-282 29617.01,-225.63 29890.59,-214.01 30042.66,-212.35"/>
<polygon fill="black" stroke="black" points="30042.98,-215.85 30052.95,-212.25 30042.91,-208.85 30042.98,-215.85"/>
</g>
<!-- layer2_expert10_4&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge696" class="edge">
<title>layer2_expert10_4&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29574.01,-284.57C29577.03,-283.65 29580.03,-282.79 29583,-282 29738.84,-240.67 29925.02,-224.05 30042.65,-217.4"/>
<polygon fill="black" stroke="black" points="30042.96,-220.88 30052.76,-216.84 30042.58,-213.89 30042.96,-220.88"/>
</g>
<!-- layer2_expert10_5&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge697" class="edge">
<title>layer2_expert10_5&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29766.08,-284.8C29769.07,-283.81 29772.05,-282.87 29775,-282 29863.09,-255.86 29965.65,-238.04 30042.61,-227.08"/>
<polygon fill="black" stroke="black" points="30043.4,-230.5 30052.82,-225.64 30042.43,-223.57 30043.4,-230.5"/>
</g>
<!-- layer2_expert10_6&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge698" class="edge">
<title>layer2_expert10_6&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29958.04,-285.54C29961.06,-284.33 29964.05,-283.15 29967,-282 29995.16,-271.01 30025.89,-259.68 30054.34,-249.45"/>
<polygon fill="black" stroke="black" points="30055.66,-252.7 30063.89,-246.03 30053.3,-246.11 30055.66,-252.7"/>
</g>
<!-- layer2_expert10_7&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge699" class="edge">
<title>layer2_expert10_7&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M30098.75,-281.73C30106.66,-272.7 30115.06,-263.12 30122.98,-254.08"/>
<polygon fill="black" stroke="black" points="30125.85,-256.13 30129.81,-246.3 30120.58,-251.51 30125.85,-256.13"/>
</g>
<!-- layer2_expert10_8&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge700" class="edge">
<title>layer2_expert10_8&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M30219.25,-281.73C30211.34,-272.7 30202.94,-263.12 30195.02,-254.08"/>
<polygon fill="black" stroke="black" points="30197.42,-251.51 30188.19,-246.3 30192.15,-256.13 30197.42,-251.51"/>
</g>
<!-- layer2_expert10_9&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge701" class="edge">
<title>layer2_expert10_9&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M30359.96,-285.54C30356.94,-284.33 30353.95,-283.15 30351,-282 30322.84,-271.01 30292.11,-259.68 30263.66,-249.45"/>
<polygon fill="black" stroke="black" points="30264.7,-246.11 30254.11,-246.03 30262.34,-252.7 30264.7,-246.11"/>
</g>
<!-- layer2_expert10_10&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge702" class="edge">
<title>layer2_expert10_10&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M30551.92,-284.8C30548.93,-283.81 30545.95,-282.87 30543,-282 30454.91,-255.86 30352.35,-238.04 30275.39,-227.08"/>
<polygon fill="black" stroke="black" points="30275.57,-223.57 30265.18,-225.64 30274.6,-230.5 30275.57,-223.57"/>
</g>
<!-- layer2_expert10_11&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge703" class="edge">
<title>layer2_expert10_11&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M30743.99,-284.57C30740.97,-283.65 30737.97,-282.79 30735,-282 30579.16,-240.67 30392.98,-224.05 30275.35,-217.4"/>
<polygon fill="black" stroke="black" points="30275.42,-213.89 30265.24,-216.84 30275.04,-220.88 30275.42,-213.89"/>
</g>
<!-- layer2_expert10_12&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge704" class="edge">
<title>layer2_expert10_12&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M30935.75,-284.38C30932.82,-283.52 30929.9,-282.72 30927,-282 30700.99,-225.63 30427.41,-214.01 30275.34,-212.35"/>
<polygon fill="black" stroke="black" points="30275.09,-208.85 30265.05,-212.25 30275.02,-215.85 30275.09,-208.85"/>
</g>
<!-- layer2_expert10_13&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge705" class="edge">
<title>layer2_expert10_13&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M31127.77,-284.31C31124.83,-283.47 31121.9,-282.7 31119,-282 30961.95,-244.32 30494.7,-224.2 30275.27,-216.61"/>
<polygon fill="black" stroke="black" points="30275.12,-213.1 30265.01,-216.26 30274.88,-220.1 30275.12,-213.1"/>
</g>
<!-- layer2_expert10_14&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge706" class="edge">
<title>layer2_expert10_14&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M31319.78,-284.27C31316.84,-283.44 31313.91,-282.68 31311,-282 31116.76,-236.62 30527.76,-220.09 30275.59,-214.98"/>
<polygon fill="black" stroke="black" points="30275.37,-211.48 30265.3,-214.78 30275.23,-218.48 30275.37,-211.48"/>
</g>
<!-- layer2_expert10_15&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge707" class="edge">
<title>layer2_expert10_15&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M31511.78,-284.23C31508.84,-283.42 31505.91,-282.67 31503,-282 31271.15,-228.87 30557.92,-216.61 30275.7,-213.81"/>
<polygon fill="black" stroke="black" points="30275.47,-210.31 30265.44,-213.71 30275.4,-217.31 30275.47,-210.31"/>
</g>
<!-- layer2_output_gpu10 -->
<g id="node421" class="node">
<title>layer2_output_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="30285.5,-142 30032.5,-142 30032.5,-74 30285.5,-74 30285.5,-142"/>
<text text-anchor="middle" x="30159" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="30159" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="30159" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="30159" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_moe_agg_gpu10&#45;&gt;layer2_output_gpu10 -->
<g id="edge708" class="edge">
<title>layer2_moe_agg_gpu10&#45;&gt;layer2_output_gpu10</title>
<path fill="none" stroke="black" d="M30159,-177.88C30159,-169.78 30159,-160.98 30159,-152.47"/>
<polygon fill="black" stroke="black" points="30162.5,-152.3 30159,-142.3 30155.5,-152.3 30162.5,-152.3"/>
</g>
<!-- layer2_qkv_gpu11 -->
<g id="node422" class="node">
<title>layer2_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="35073,-796 34861,-796 34861,-728 35073,-728 35073,-796"/>
<text text-anchor="middle" x="34967" y="-780.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU11</text>
<text text-anchor="middle" x="34967" y="-765.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="34967" y="-750.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="34967" y="-735.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_attn_gpu11 -->
<g id="node423" class="node">
<title>layer2_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="34431,-692 34179,-692 34179,-624 34431,-624 34431,-692"/>
<text text-anchor="middle" x="34305" y="-676.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU11</text>
<text text-anchor="middle" x="34305" y="-661.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="34305" y="-646.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="34305" y="-631.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_qkv_gpu11&#45;&gt;layer2_attn_gpu11 -->
<g id="edge709" class="edge">
<title>layer2_qkv_gpu11&#45;&gt;layer2_attn_gpu11</title>
<path fill="none" stroke="black" d="M34860.64,-744.61C34746.68,-727.05 34565.45,-699.13 34441.15,-679.98"/>
<polygon fill="black" stroke="black" points="34441.59,-676.5 34431.17,-678.44 34440.52,-683.42 34441.59,-676.5"/>
</g>
<!-- layer2_attn_norm_gpu11 -->
<g id="node424" class="node">
<title>layer2_attn_norm_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="34105.5,-588 33852.5,-588 33852.5,-520 34105.5,-520 34105.5,-588"/>
<text text-anchor="middle" x="33979" y="-572.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="33979" y="-557.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="33979" y="-542.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33979" y="-527.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_attn_gpu11&#45;&gt;layer2_attn_norm_gpu11 -->
<g id="edge710" class="edge">
<title>layer2_attn_gpu11&#45;&gt;layer2_attn_norm_gpu11</title>
<path fill="none" stroke="black" d="M34199.16,-623.88C34165.59,-613.38 34128.33,-601.72 34094.14,-591.03"/>
<polygon fill="black" stroke="black" points="34095.18,-587.68 34084.59,-588.04 34093.09,-594.36 34095.18,-587.68"/>
</g>
<!-- layer2_gate_gpu11 -->
<g id="node425" class="node">
<title>layer2_gate_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="33449,-484 33205,-484 33205,-401 33449,-401 33449,-484"/>
<text text-anchor="middle" x="33327" y="-468.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU11</text>
<text text-anchor="middle" x="33327" y="-453.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33327" y="-438.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="33327" y="-423.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="33327" y="-408.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_attn_norm_gpu11&#45;&gt;layer2_gate_gpu11 -->
<g id="edge711" class="edge">
<title>layer2_attn_norm_gpu11&#45;&gt;layer2_gate_gpu11</title>
<path fill="none" stroke="black" d="M33852.13,-531.69C33738.92,-512.68 33573.78,-484.94 33459.02,-465.67"/>
<polygon fill="black" stroke="black" points="33459.56,-462.21 33449.12,-464.01 33458.4,-469.12 33459.56,-462.21"/>
</g>
<!-- layer2_expert11_0 -->
<g id="node426" class="node">
<title>layer2_expert11_0</title>
<polygon fill="lightgreen" stroke="black" points="31878,-365 31704,-365 31704,-282 31878,-282 31878,-365"/>
<text text-anchor="middle" x="31791" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU11</text>
<text text-anchor="middle" x="31791" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31791" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31791" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31791" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_0 -->
<g id="edge712" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33204.8,-440.41C32908.21,-436.92 32155.59,-422.7 31888.29,-365.01"/>
<polygon fill="black" stroke="black" points="31888.74,-361.52 31878.22,-362.76 31887.22,-368.35 31888.74,-361.52"/>
</g>
<!-- layer2_expert11_1 -->
<g id="node427" class="node">
<title>layer2_expert11_1</title>
<polygon fill="lightgreen" stroke="black" points="32070,-365 31896,-365 31896,-282 32070,-282 32070,-365"/>
<text text-anchor="middle" x="31983" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU11</text>
<text text-anchor="middle" x="31983" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="31983" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="31983" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="31983" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_1 -->
<g id="edge713" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33204.82,-439.24C32937.95,-433.47 32309.25,-415.11 32080.17,-364.99"/>
<polygon fill="black" stroke="black" points="32080.75,-361.53 32070.22,-362.73 32079.2,-368.35 32080.75,-361.53"/>
</g>
<!-- layer2_expert11_2 -->
<g id="node428" class="node">
<title>layer2_expert11_2</title>
<polygon fill="lightgreen" stroke="black" points="32262,-365 32088,-365 32088,-282 32262,-282 32262,-365"/>
<text text-anchor="middle" x="32175" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU11</text>
<text text-anchor="middle" x="32175" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="32175" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="32175" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="32175" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_2 -->
<g id="edge714" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33204.92,-437.65C32970.28,-429.46 32463.38,-407.62 32272.19,-364.99"/>
<polygon fill="black" stroke="black" points="32272.77,-361.54 32262.23,-362.69 32271.19,-368.35 32272.77,-361.54"/>
</g>
<!-- layer2_expert11_3 -->
<g id="node429" class="node">
<title>layer2_expert11_3</title>
<polygon fill="lightgreen" stroke="black" points="32454,-365 32280,-365 32280,-282 32454,-282 32454,-365"/>
<text text-anchor="middle" x="32367" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU11</text>
<text text-anchor="middle" x="32367" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="32367" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="32367" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="32367" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_3 -->
<g id="edge715" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33204.77,-435.36C33005.25,-424.58 32617.31,-400.2 32464,-364.96"/>
<polygon fill="black" stroke="black" points="32464.79,-361.55 32454.25,-362.63 32463.16,-368.36 32464.79,-361.55"/>
</g>
<!-- layer2_expert11_4 -->
<g id="node430" class="node">
<title>layer2_expert11_4</title>
<polygon fill="lightgreen" stroke="black" points="32646,-365 32472,-365 32472,-282 32646,-282 32646,-365"/>
<text text-anchor="middle" x="32559" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU11</text>
<text text-anchor="middle" x="32559" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="32559" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="32559" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="32559" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_4 -->
<g id="edge716" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33204.91,-438.05C33071.03,-431.91 32850.46,-414.84 32655.84,-365"/>
<polygon fill="black" stroke="black" points="32656.57,-361.57 32646.01,-362.45 32654.81,-368.35 32656.57,-361.57"/>
</g>
<!-- layer2_expert11_5 -->
<g id="node431" class="node">
<title>layer2_expert11_5</title>
<polygon fill="lightgreen" stroke="black" points="32838,-365 32664,-365 32664,-282 32838,-282 32838,-365"/>
<text text-anchor="middle" x="32751" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU11</text>
<text text-anchor="middle" x="32751" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="32751" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="32751" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="32751" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_5 -->
<g id="edge717" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33204.91,-430.26C33109.32,-419.56 32973.37,-400.14 32847.84,-365.05"/>
<polygon fill="black" stroke="black" points="32848.63,-361.64 32838.06,-362.28 32846.72,-368.37 32848.63,-361.64"/>
</g>
<!-- layer2_expert11_6 -->
<g id="node432" class="node">
<title>layer2_expert11_6</title>
<polygon fill="lightgreen" stroke="black" points="33030,-365 32856,-365 32856,-282 33030,-282 33030,-365"/>
<text text-anchor="middle" x="32943" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU11</text>
<text text-anchor="middle" x="32943" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="32943" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="32943" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="32943" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_6 -->
<g id="edge718" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33204.66,-413.02C33155.66,-400.63 33098.72,-385.01 33039.67,-365.12"/>
<polygon fill="black" stroke="black" points="33040.77,-361.79 33030.18,-361.89 33038.52,-368.42 33040.77,-361.79"/>
</g>
<!-- layer2_expert11_7 -->
<g id="node433" class="node">
<title>layer2_expert11_7</title>
<polygon fill="lightgreen" stroke="black" points="33222,-365 33048,-365 33048,-282 33222,-282 33222,-365"/>
<text text-anchor="middle" x="33135" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU11</text>
<text text-anchor="middle" x="33135" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="33135" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="33135" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="33135" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_7 -->
<g id="edge719" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33260.39,-400.91C33244.15,-391.02 33226.68,-380.37 33210.08,-370.25"/>
<polygon fill="black" stroke="black" points="33211.86,-367.24 33201.5,-365.02 33208.21,-373.21 33211.86,-367.24"/>
</g>
<!-- layer2_expert11_8 -->
<g id="node434" class="node">
<title>layer2_expert11_8</title>
<polygon fill="lightgreen" stroke="black" points="33414,-365 33240,-365 33240,-282 33414,-282 33414,-365"/>
<text text-anchor="middle" x="33327" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU11</text>
<text text-anchor="middle" x="33327" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="33327" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="33327" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="33327" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_8 -->
<g id="edge720" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33327,-400.91C33327,-392.65 33327,-383.86 33327,-375.3"/>
<polygon fill="black" stroke="black" points="33330.5,-375.02 33327,-365.02 33323.5,-375.02 33330.5,-375.02"/>
</g>
<!-- layer2_expert11_9 -->
<g id="node435" class="node">
<title>layer2_expert11_9</title>
<polygon fill="lightgreen" stroke="black" points="33606,-365 33432,-365 33432,-282 33606,-282 33606,-365"/>
<text text-anchor="middle" x="33519" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU11</text>
<text text-anchor="middle" x="33519" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="33519" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="33519" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="33519" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_9 -->
<g id="edge721" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33393.61,-400.91C33409.85,-391.02 33427.32,-380.37 33443.92,-370.25"/>
<polygon fill="black" stroke="black" points="33445.79,-373.21 33452.5,-365.02 33442.14,-367.24 33445.79,-373.21"/>
</g>
<!-- layer2_expert11_10 -->
<g id="node436" class="node">
<title>layer2_expert11_10</title>
<polygon fill="lightgreen" stroke="black" points="33798,-365 33624,-365 33624,-282 33798,-282 33798,-365"/>
<text text-anchor="middle" x="33711" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU11</text>
<text text-anchor="middle" x="33711" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="33711" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="33711" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="33711" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_10 -->
<g id="edge722" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33449.34,-413.02C33498.34,-400.63 33555.28,-385.01 33614.33,-365.12"/>
<polygon fill="black" stroke="black" points="33615.48,-368.42 33623.82,-361.89 33613.23,-361.79 33615.48,-368.42"/>
</g>
<!-- layer2_expert11_11 -->
<g id="node437" class="node">
<title>layer2_expert11_11</title>
<polygon fill="lightgreen" stroke="black" points="33990,-365 33816,-365 33816,-282 33990,-282 33990,-365"/>
<text text-anchor="middle" x="33903" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU11</text>
<text text-anchor="middle" x="33903" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="33903" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="33903" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="33903" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_11 -->
<g id="edge723" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33449.09,-430.26C33544.68,-419.56 33680.63,-400.14 33806.16,-365.05"/>
<polygon fill="black" stroke="black" points="33807.28,-368.37 33815.94,-362.28 33805.37,-361.64 33807.28,-368.37"/>
</g>
<!-- layer2_expert11_12 -->
<g id="node438" class="node">
<title>layer2_expert11_12</title>
<polygon fill="lightgreen" stroke="black" points="34182,-365 34008,-365 34008,-282 34182,-282 34182,-365"/>
<text text-anchor="middle" x="34095" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU11</text>
<text text-anchor="middle" x="34095" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="34095" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="34095" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="34095" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_12 -->
<g id="edge724" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33449.09,-438.05C33582.97,-431.91 33803.54,-414.84 33998.16,-365"/>
<polygon fill="black" stroke="black" points="33999.19,-368.35 34007.99,-362.45 33997.43,-361.57 33999.19,-368.35"/>
</g>
<!-- layer2_expert11_13 -->
<g id="node439" class="node">
<title>layer2_expert11_13</title>
<polygon fill="lightgreen" stroke="black" points="34374,-365 34200,-365 34200,-282 34374,-282 34374,-365"/>
<text text-anchor="middle" x="34287" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU11</text>
<text text-anchor="middle" x="34287" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="34287" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="34287" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="34287" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_13 -->
<g id="edge725" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33449.23,-435.36C33648.75,-424.58 34036.69,-400.2 34190,-364.96"/>
<polygon fill="black" stroke="black" points="34190.84,-368.36 34199.75,-362.63 34189.21,-361.55 34190.84,-368.36"/>
</g>
<!-- layer2_expert11_14 -->
<g id="node440" class="node">
<title>layer2_expert11_14</title>
<polygon fill="lightgreen" stroke="black" points="34566,-365 34392,-365 34392,-282 34566,-282 34566,-365"/>
<text text-anchor="middle" x="34479" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU11</text>
<text text-anchor="middle" x="34479" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="34479" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="34479" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="34479" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_14 -->
<g id="edge726" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33449.08,-437.65C33683.72,-429.46 34190.62,-407.62 34381.81,-364.99"/>
<polygon fill="black" stroke="black" points="34382.81,-368.35 34391.77,-362.69 34381.23,-361.54 34382.81,-368.35"/>
</g>
<!-- layer2_expert11_15 -->
<g id="node441" class="node">
<title>layer2_expert11_15</title>
<polygon fill="lightgreen" stroke="black" points="34758,-365 34584,-365 34584,-282 34758,-282 34758,-365"/>
<text text-anchor="middle" x="34671" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU11</text>
<text text-anchor="middle" x="34671" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="34671" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="34671" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="34671" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_15 -->
<g id="edge727" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33449.18,-439.24C33716.05,-433.47 34344.75,-415.11 34573.83,-364.99"/>
<polygon fill="black" stroke="black" points="34574.8,-368.35 34583.78,-362.73 34573.25,-361.53 34574.8,-368.35"/>
</g>
<!-- layer2_moe_agg_gpu11 -->
<g id="node442" class="node">
<title>layer2_moe_agg_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="33337,-246 33125,-246 33125,-178 33337,-178 33337,-246"/>
<text text-anchor="middle" x="33231" y="-230.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU11</text>
<text text-anchor="middle" x="33231" y="-215.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="33231" y="-200.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33231" y="-185.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_expert11_0&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge728" class="edge">
<title>layer2_expert11_0&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M31878.22,-284.23C31881.16,-283.42 31884.09,-282.67 31887,-282 32118.85,-228.87 32832.08,-216.61 33114.3,-213.81"/>
<polygon fill="black" stroke="black" points="33114.6,-217.31 33124.56,-213.71 33114.53,-210.31 33114.6,-217.31"/>
</g>
<!-- layer2_expert11_1&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge729" class="edge">
<title>layer2_expert11_1&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32070.22,-284.27C32073.16,-283.44 32076.09,-282.68 32079,-282 32273.24,-236.62 32862.24,-220.09 33114.41,-214.98"/>
<polygon fill="black" stroke="black" points="33114.77,-218.48 33124.7,-214.78 33114.63,-211.48 33114.77,-218.48"/>
</g>
<!-- layer2_expert11_2&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge730" class="edge">
<title>layer2_expert11_2&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32262.23,-284.31C32265.17,-283.47 32268.1,-282.7 32271,-282 32428.05,-244.32 32895.3,-224.2 33114.73,-216.61"/>
<polygon fill="black" stroke="black" points="33115.12,-220.1 33124.99,-216.26 33114.88,-213.1 33115.12,-220.1"/>
</g>
<!-- layer2_expert11_3&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge731" class="edge">
<title>layer2_expert11_3&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32454.25,-284.38C32457.18,-283.52 32460.1,-282.72 32463,-282 32689.01,-225.63 32962.59,-214.01 33114.66,-212.35"/>
<polygon fill="black" stroke="black" points="33114.98,-215.85 33124.95,-212.25 33114.91,-208.85 33114.98,-215.85"/>
</g>
<!-- layer2_expert11_4&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge732" class="edge">
<title>layer2_expert11_4&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32646.01,-284.57C32649.03,-283.65 32652.03,-282.79 32655,-282 32810.84,-240.67 32997.02,-224.05 33114.65,-217.4"/>
<polygon fill="black" stroke="black" points="33114.96,-220.88 33124.76,-216.84 33114.58,-213.89 33114.96,-220.88"/>
</g>
<!-- layer2_expert11_5&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge733" class="edge">
<title>layer2_expert11_5&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32838.08,-284.8C32841.07,-283.81 32844.05,-282.87 32847,-282 32935.09,-255.86 33037.65,-238.04 33114.61,-227.08"/>
<polygon fill="black" stroke="black" points="33115.4,-230.5 33124.82,-225.64 33114.43,-223.57 33115.4,-230.5"/>
</g>
<!-- layer2_expert11_6&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge734" class="edge">
<title>layer2_expert11_6&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M33030.04,-285.54C33033.06,-284.33 33036.05,-283.15 33039,-282 33067.16,-271.01 33097.89,-259.68 33126.34,-249.45"/>
<polygon fill="black" stroke="black" points="33127.66,-252.7 33135.89,-246.03 33125.3,-246.11 33127.66,-252.7"/>
</g>
<!-- layer2_expert11_7&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge735" class="edge">
<title>layer2_expert11_7&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M33170.75,-281.73C33178.66,-272.7 33187.06,-263.12 33194.98,-254.08"/>
<polygon fill="black" stroke="black" points="33197.85,-256.13 33201.81,-246.3 33192.58,-251.51 33197.85,-256.13"/>
</g>
<!-- layer2_expert11_8&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge736" class="edge">
<title>layer2_expert11_8&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M33291.25,-281.73C33283.34,-272.7 33274.94,-263.12 33267.02,-254.08"/>
<polygon fill="black" stroke="black" points="33269.42,-251.51 33260.19,-246.3 33264.15,-256.13 33269.42,-251.51"/>
</g>
<!-- layer2_expert11_9&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge737" class="edge">
<title>layer2_expert11_9&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M33431.96,-285.54C33428.94,-284.33 33425.95,-283.15 33423,-282 33394.84,-271.01 33364.11,-259.68 33335.66,-249.45"/>
<polygon fill="black" stroke="black" points="33336.7,-246.11 33326.11,-246.03 33334.34,-252.7 33336.7,-246.11"/>
</g>
<!-- layer2_expert11_10&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge738" class="edge">
<title>layer2_expert11_10&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M33623.92,-284.8C33620.93,-283.81 33617.95,-282.87 33615,-282 33526.91,-255.86 33424.35,-238.04 33347.39,-227.08"/>
<polygon fill="black" stroke="black" points="33347.57,-223.57 33337.18,-225.64 33346.6,-230.5 33347.57,-223.57"/>
</g>
<!-- layer2_expert11_11&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge739" class="edge">
<title>layer2_expert11_11&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M33815.99,-284.57C33812.97,-283.65 33809.97,-282.79 33807,-282 33651.16,-240.67 33464.98,-224.05 33347.35,-217.4"/>
<polygon fill="black" stroke="black" points="33347.42,-213.89 33337.24,-216.84 33347.04,-220.88 33347.42,-213.89"/>
</g>
<!-- layer2_expert11_12&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge740" class="edge">
<title>layer2_expert11_12&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M34007.75,-284.38C34004.82,-283.52 34001.9,-282.72 33999,-282 33772.99,-225.63 33499.41,-214.01 33347.34,-212.35"/>
<polygon fill="black" stroke="black" points="33347.09,-208.85 33337.05,-212.25 33347.02,-215.85 33347.09,-208.85"/>
</g>
<!-- layer2_expert11_13&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge741" class="edge">
<title>layer2_expert11_13&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M34199.77,-284.31C34196.83,-283.47 34193.9,-282.7 34191,-282 34033.95,-244.32 33566.7,-224.2 33347.27,-216.61"/>
<polygon fill="black" stroke="black" points="33347.12,-213.1 33337.01,-216.26 33346.88,-220.1 33347.12,-213.1"/>
</g>
<!-- layer2_expert11_14&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge742" class="edge">
<title>layer2_expert11_14&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M34391.78,-284.27C34388.84,-283.44 34385.91,-282.68 34383,-282 34188.76,-236.62 33599.76,-220.09 33347.59,-214.98"/>
<polygon fill="black" stroke="black" points="33347.37,-211.48 33337.3,-214.78 33347.23,-218.48 33347.37,-211.48"/>
</g>
<!-- layer2_expert11_15&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge743" class="edge">
<title>layer2_expert11_15&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M34583.78,-284.23C34580.84,-283.42 34577.91,-282.67 34575,-282 34343.15,-228.87 33629.92,-216.61 33347.7,-213.81"/>
<polygon fill="black" stroke="black" points="33347.47,-210.31 33337.44,-213.71 33347.4,-217.31 33347.47,-210.31"/>
</g>
<!-- layer2_output_gpu11 -->
<g id="node443" class="node">
<title>layer2_output_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="33357.5,-142 33104.5,-142 33104.5,-74 33357.5,-74 33357.5,-142"/>
<text text-anchor="middle" x="33231" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="33231" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="33231" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33231" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_moe_agg_gpu11&#45;&gt;layer2_output_gpu11 -->
<g id="edge744" class="edge">
<title>layer2_moe_agg_gpu11&#45;&gt;layer2_output_gpu11</title>
<path fill="none" stroke="black" d="M33231,-177.88C33231,-169.78 33231,-160.98 33231,-152.47"/>
<polygon fill="black" stroke="black" points="33234.5,-152.3 33231,-142.3 33227.5,-152.3 33234.5,-152.3"/>
</g>
<!-- layer2_qkv_gpu12 -->
<g id="node444" class="node">
<title>layer2_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="35323,-796 35111,-796 35111,-728 35323,-728 35323,-796"/>
<text text-anchor="middle" x="35217" y="-780.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU12</text>
<text text-anchor="middle" x="35217" y="-765.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="35217" y="-750.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="35217" y="-735.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_attn_gpu12 -->
<g id="node445" class="node">
<title>layer2_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="36006,-692 35754,-692 35754,-624 36006,-624 36006,-692"/>
<text text-anchor="middle" x="35880" y="-676.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU12</text>
<text text-anchor="middle" x="35880" y="-661.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="35880" y="-646.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="35880" y="-631.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_qkv_gpu12&#45;&gt;layer2_attn_gpu12 -->
<g id="edge745" class="edge">
<title>layer2_qkv_gpu12&#45;&gt;layer2_attn_gpu12</title>
<path fill="none" stroke="black" d="M35323.28,-735.64C35336.29,-732.89 35349.42,-730.26 35362,-728 35490.88,-704.8 35639.11,-685.83 35743.89,-673.69"/>
<polygon fill="black" stroke="black" points="35744.36,-677.16 35753.89,-672.53 35743.56,-670.2 35744.36,-677.16"/>
</g>
<!-- layer2_attn_norm_gpu12 -->
<g id="node446" class="node">
<title>layer2_attn_norm_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="36170.5,-588 35917.5,-588 35917.5,-520 36170.5,-520 36170.5,-588"/>
<text text-anchor="middle" x="36044" y="-572.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="36044" y="-557.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="36044" y="-542.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="36044" y="-527.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_attn_gpu12&#45;&gt;layer2_attn_norm_gpu12 -->
<g id="edge746" class="edge">
<title>layer2_attn_gpu12&#45;&gt;layer2_attn_norm_gpu12</title>
<path fill="none" stroke="black" d="M35933.25,-623.88C35948.79,-614.21 35965.92,-603.56 35981.96,-593.59"/>
<polygon fill="black" stroke="black" points="35984.1,-596.38 35990.74,-588.12 35980.4,-590.43 35984.1,-596.38"/>
</g>
<!-- layer2_gate_gpu12 -->
<g id="node447" class="node">
<title>layer2_gate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="36329,-484 36085,-484 36085,-401 36329,-401 36329,-484"/>
<text text-anchor="middle" x="36207" y="-468.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU12</text>
<text text-anchor="middle" x="36207" y="-453.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="36207" y="-438.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="36207" y="-423.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="36207" y="-408.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_attn_norm_gpu12&#45;&gt;layer2_gate_gpu12 -->
<g id="edge747" class="edge">
<title>layer2_attn_norm_gpu12&#45;&gt;layer2_gate_gpu12</title>
<path fill="none" stroke="black" d="M36093.35,-519.85C36107.5,-510.34 36123.19,-499.8 36138.28,-489.66"/>
<polygon fill="black" stroke="black" points="36140.24,-492.56 36146.59,-484.08 36136.34,-486.75 36140.24,-492.56"/>
</g>
<!-- layer2_expert12_0 -->
<g id="node448" class="node">
<title>layer2_expert12_0</title>
<polygon fill="lightgreen" stroke="black" points="34950,-365 34776,-365 34776,-282 34950,-282 34950,-365"/>
<text text-anchor="middle" x="34863" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU12</text>
<text text-anchor="middle" x="34863" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="34863" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="34863" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="34863" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_0 -->
<g id="edge748" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36084.82,-439.24C35817.95,-433.47 35189.25,-415.11 34960.17,-364.99"/>
<polygon fill="black" stroke="black" points="34960.75,-361.53 34950.22,-362.73 34959.2,-368.35 34960.75,-361.53"/>
</g>
<!-- layer2_expert12_1 -->
<g id="node449" class="node">
<title>layer2_expert12_1</title>
<polygon fill="lightgreen" stroke="black" points="35142,-365 34968,-365 34968,-282 35142,-282 35142,-365"/>
<text text-anchor="middle" x="35055" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU12</text>
<text text-anchor="middle" x="35055" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="35055" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="35055" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="35055" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_1 -->
<g id="edge749" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36084.92,-437.65C35850.28,-429.46 35343.38,-407.62 35152.19,-364.99"/>
<polygon fill="black" stroke="black" points="35152.77,-361.54 35142.23,-362.69 35151.19,-368.35 35152.77,-361.54"/>
</g>
<!-- layer2_expert12_2 -->
<g id="node450" class="node">
<title>layer2_expert12_2</title>
<polygon fill="lightgreen" stroke="black" points="35334,-365 35160,-365 35160,-282 35334,-282 35334,-365"/>
<text text-anchor="middle" x="35247" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU12</text>
<text text-anchor="middle" x="35247" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="35247" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="35247" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="35247" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_2 -->
<g id="edge750" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36084.77,-435.36C35885.25,-424.58 35497.31,-400.2 35344,-364.96"/>
<polygon fill="black" stroke="black" points="35344.79,-361.55 35334.25,-362.63 35343.16,-368.36 35344.79,-361.55"/>
</g>
<!-- layer2_expert12_3 -->
<g id="node451" class="node">
<title>layer2_expert12_3</title>
<polygon fill="lightgreen" stroke="black" points="35526,-365 35352,-365 35352,-282 35526,-282 35526,-365"/>
<text text-anchor="middle" x="35439" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU12</text>
<text text-anchor="middle" x="35439" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="35439" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="35439" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="35439" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_3 -->
<g id="edge751" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36084.91,-438.05C35951.03,-431.91 35730.46,-414.84 35535.84,-365"/>
<polygon fill="black" stroke="black" points="35536.57,-361.57 35526.01,-362.45 35534.81,-368.35 35536.57,-361.57"/>
</g>
<!-- layer2_expert12_4 -->
<g id="node452" class="node">
<title>layer2_expert12_4</title>
<polygon fill="lightgreen" stroke="black" points="35718,-365 35544,-365 35544,-282 35718,-282 35718,-365"/>
<text text-anchor="middle" x="35631" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU12</text>
<text text-anchor="middle" x="35631" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="35631" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="35631" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="35631" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_4 -->
<g id="edge752" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36084.91,-430.26C35989.32,-419.56 35853.37,-400.14 35727.84,-365.05"/>
<polygon fill="black" stroke="black" points="35728.63,-361.64 35718.06,-362.28 35726.72,-368.37 35728.63,-361.64"/>
</g>
<!-- layer2_expert12_5 -->
<g id="node453" class="node">
<title>layer2_expert12_5</title>
<polygon fill="lightgreen" stroke="black" points="35910,-365 35736,-365 35736,-282 35910,-282 35910,-365"/>
<text text-anchor="middle" x="35823" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU12</text>
<text text-anchor="middle" x="35823" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="35823" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="35823" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="35823" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_5 -->
<g id="edge753" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36084.66,-413.02C36035.66,-400.63 35978.72,-385.01 35919.67,-365.12"/>
<polygon fill="black" stroke="black" points="35920.77,-361.79 35910.18,-361.89 35918.52,-368.42 35920.77,-361.79"/>
</g>
<!-- layer2_expert12_6 -->
<g id="node454" class="node">
<title>layer2_expert12_6</title>
<polygon fill="lightgreen" stroke="black" points="36102,-365 35928,-365 35928,-282 36102,-282 36102,-365"/>
<text text-anchor="middle" x="36015" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU12</text>
<text text-anchor="middle" x="36015" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36015" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36015" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36015" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_6 -->
<g id="edge754" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36140.39,-400.91C36124.15,-391.02 36106.68,-380.37 36090.08,-370.25"/>
<polygon fill="black" stroke="black" points="36091.86,-367.24 36081.5,-365.02 36088.21,-373.21 36091.86,-367.24"/>
</g>
<!-- layer2_expert12_7 -->
<g id="node455" class="node">
<title>layer2_expert12_7</title>
<polygon fill="lightgreen" stroke="black" points="36294,-365 36120,-365 36120,-282 36294,-282 36294,-365"/>
<text text-anchor="middle" x="36207" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU12</text>
<text text-anchor="middle" x="36207" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36207" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36207" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36207" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_7 -->
<g id="edge755" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36207,-400.91C36207,-392.65 36207,-383.86 36207,-375.3"/>
<polygon fill="black" stroke="black" points="36210.5,-375.02 36207,-365.02 36203.5,-375.02 36210.5,-375.02"/>
</g>
<!-- layer2_expert12_8 -->
<g id="node456" class="node">
<title>layer2_expert12_8</title>
<polygon fill="lightgreen" stroke="black" points="36486,-365 36312,-365 36312,-282 36486,-282 36486,-365"/>
<text text-anchor="middle" x="36399" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU12</text>
<text text-anchor="middle" x="36399" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36399" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36399" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36399" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_8 -->
<g id="edge756" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36273.61,-400.91C36289.85,-391.02 36307.32,-380.37 36323.92,-370.25"/>
<polygon fill="black" stroke="black" points="36325.79,-373.21 36332.5,-365.02 36322.14,-367.24 36325.79,-373.21"/>
</g>
<!-- layer2_expert12_9 -->
<g id="node457" class="node">
<title>layer2_expert12_9</title>
<polygon fill="lightgreen" stroke="black" points="36678,-365 36504,-365 36504,-282 36678,-282 36678,-365"/>
<text text-anchor="middle" x="36591" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU12</text>
<text text-anchor="middle" x="36591" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36591" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36591" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36591" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_9 -->
<g id="edge757" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36329.34,-413.02C36378.34,-400.63 36435.28,-385.01 36494.33,-365.12"/>
<polygon fill="black" stroke="black" points="36495.48,-368.42 36503.82,-361.89 36493.23,-361.79 36495.48,-368.42"/>
</g>
<!-- layer2_expert12_10 -->
<g id="node458" class="node">
<title>layer2_expert12_10</title>
<polygon fill="lightgreen" stroke="black" points="36870,-365 36696,-365 36696,-282 36870,-282 36870,-365"/>
<text text-anchor="middle" x="36783" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU12</text>
<text text-anchor="middle" x="36783" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36783" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36783" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36783" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_10 -->
<g id="edge758" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36329.09,-430.26C36424.68,-419.56 36560.63,-400.14 36686.16,-365.05"/>
<polygon fill="black" stroke="black" points="36687.28,-368.37 36695.94,-362.28 36685.37,-361.64 36687.28,-368.37"/>
</g>
<!-- layer2_expert12_11 -->
<g id="node459" class="node">
<title>layer2_expert12_11</title>
<polygon fill="lightgreen" stroke="black" points="37062,-365 36888,-365 36888,-282 37062,-282 37062,-365"/>
<text text-anchor="middle" x="36975" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU12</text>
<text text-anchor="middle" x="36975" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="36975" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="36975" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="36975" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_11 -->
<g id="edge759" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36329.09,-438.05C36462.97,-431.91 36683.54,-414.84 36878.16,-365"/>
<polygon fill="black" stroke="black" points="36879.19,-368.35 36887.99,-362.45 36877.43,-361.57 36879.19,-368.35"/>
</g>
<!-- layer2_expert12_12 -->
<g id="node460" class="node">
<title>layer2_expert12_12</title>
<polygon fill="lightgreen" stroke="black" points="37254,-365 37080,-365 37080,-282 37254,-282 37254,-365"/>
<text text-anchor="middle" x="37167" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU12</text>
<text text-anchor="middle" x="37167" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="37167" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="37167" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="37167" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_12 -->
<g id="edge760" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36329.23,-435.36C36528.75,-424.58 36916.69,-400.2 37070,-364.96"/>
<polygon fill="black" stroke="black" points="37070.84,-368.36 37079.75,-362.63 37069.21,-361.55 37070.84,-368.36"/>
</g>
<!-- layer2_expert12_13 -->
<g id="node461" class="node">
<title>layer2_expert12_13</title>
<polygon fill="lightgreen" stroke="black" points="37446,-365 37272,-365 37272,-282 37446,-282 37446,-365"/>
<text text-anchor="middle" x="37359" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU12</text>
<text text-anchor="middle" x="37359" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="37359" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="37359" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="37359" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_13 -->
<g id="edge761" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36329.08,-437.65C36563.72,-429.46 37070.62,-407.62 37261.81,-364.99"/>
<polygon fill="black" stroke="black" points="37262.81,-368.35 37271.77,-362.69 37261.23,-361.54 37262.81,-368.35"/>
</g>
<!-- layer2_expert12_14 -->
<g id="node462" class="node">
<title>layer2_expert12_14</title>
<polygon fill="lightgreen" stroke="black" points="37638,-365 37464,-365 37464,-282 37638,-282 37638,-365"/>
<text text-anchor="middle" x="37551" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU12</text>
<text text-anchor="middle" x="37551" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="37551" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="37551" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="37551" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_14 -->
<g id="edge762" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36329.18,-439.24C36596.05,-433.47 37224.75,-415.11 37453.83,-364.99"/>
<polygon fill="black" stroke="black" points="37454.8,-368.35 37463.78,-362.73 37453.25,-361.53 37454.8,-368.35"/>
</g>
<!-- layer2_expert12_15 -->
<g id="node463" class="node">
<title>layer2_expert12_15</title>
<polygon fill="lightgreen" stroke="black" points="37830,-365 37656,-365 37656,-282 37830,-282 37830,-365"/>
<text text-anchor="middle" x="37743" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU12</text>
<text text-anchor="middle" x="37743" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="37743" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="37743" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="37743" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_15 -->
<g id="edge763" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36329.2,-440.41C36625.79,-436.92 37378.41,-422.7 37645.71,-365.01"/>
<polygon fill="black" stroke="black" points="37646.78,-368.35 37655.78,-362.76 37645.26,-361.52 37646.78,-368.35"/>
</g>
<!-- layer2_moe_agg_gpu12 -->
<g id="node464" class="node">
<title>layer2_moe_agg_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="36409,-246 36197,-246 36197,-178 36409,-178 36409,-246"/>
<text text-anchor="middle" x="36303" y="-230.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU12</text>
<text text-anchor="middle" x="36303" y="-215.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="36303" y="-200.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="36303" y="-185.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_expert12_0&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge764" class="edge">
<title>layer2_expert12_0&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M34950.22,-284.23C34953.16,-283.42 34956.09,-282.67 34959,-282 35190.85,-228.87 35904.08,-216.61 36186.3,-213.81"/>
<polygon fill="black" stroke="black" points="36186.6,-217.31 36196.56,-213.71 36186.53,-210.31 36186.6,-217.31"/>
</g>
<!-- layer2_expert12_1&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge765" class="edge">
<title>layer2_expert12_1&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35142.22,-284.27C35145.16,-283.44 35148.09,-282.68 35151,-282 35345.24,-236.62 35934.24,-220.09 36186.41,-214.98"/>
<polygon fill="black" stroke="black" points="36186.77,-218.48 36196.7,-214.78 36186.63,-211.48 36186.77,-218.48"/>
</g>
<!-- layer2_expert12_2&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge766" class="edge">
<title>layer2_expert12_2&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35334.23,-284.31C35337.17,-283.47 35340.1,-282.7 35343,-282 35500.05,-244.32 35967.3,-224.2 36186.73,-216.61"/>
<polygon fill="black" stroke="black" points="36187.12,-220.1 36196.99,-216.26 36186.88,-213.1 36187.12,-220.1"/>
</g>
<!-- layer2_expert12_3&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge767" class="edge">
<title>layer2_expert12_3&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35526.25,-284.38C35529.18,-283.52 35532.1,-282.72 35535,-282 35761.01,-225.63 36034.59,-214.01 36186.66,-212.35"/>
<polygon fill="black" stroke="black" points="36186.98,-215.85 36196.95,-212.25 36186.91,-208.85 36186.98,-215.85"/>
</g>
<!-- layer2_expert12_4&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge768" class="edge">
<title>layer2_expert12_4&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35718.01,-284.57C35721.03,-283.65 35724.03,-282.79 35727,-282 35882.84,-240.67 36069.02,-224.05 36186.65,-217.4"/>
<polygon fill="black" stroke="black" points="36186.96,-220.88 36196.76,-216.84 36186.58,-213.89 36186.96,-220.88"/>
</g>
<!-- layer2_expert12_5&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge769" class="edge">
<title>layer2_expert12_5&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35910.08,-284.8C35913.07,-283.81 35916.05,-282.87 35919,-282 36007.09,-255.86 36109.65,-238.04 36186.61,-227.08"/>
<polygon fill="black" stroke="black" points="36187.4,-230.5 36196.82,-225.64 36186.43,-223.57 36187.4,-230.5"/>
</g>
<!-- layer2_expert12_6&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge770" class="edge">
<title>layer2_expert12_6&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M36102.04,-285.54C36105.06,-284.33 36108.05,-283.15 36111,-282 36139.16,-271.01 36169.89,-259.68 36198.34,-249.45"/>
<polygon fill="black" stroke="black" points="36199.66,-252.7 36207.89,-246.03 36197.3,-246.11 36199.66,-252.7"/>
</g>
<!-- layer2_expert12_7&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge771" class="edge">
<title>layer2_expert12_7&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M36242.75,-281.73C36250.66,-272.7 36259.06,-263.12 36266.98,-254.08"/>
<polygon fill="black" stroke="black" points="36269.85,-256.13 36273.81,-246.3 36264.58,-251.51 36269.85,-256.13"/>
</g>
<!-- layer2_expert12_8&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge772" class="edge">
<title>layer2_expert12_8&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M36363.25,-281.73C36355.34,-272.7 36346.94,-263.12 36339.02,-254.08"/>
<polygon fill="black" stroke="black" points="36341.42,-251.51 36332.19,-246.3 36336.15,-256.13 36341.42,-251.51"/>
</g>
<!-- layer2_expert12_9&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge773" class="edge">
<title>layer2_expert12_9&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M36503.96,-285.54C36500.94,-284.33 36497.95,-283.15 36495,-282 36466.84,-271.01 36436.11,-259.68 36407.66,-249.45"/>
<polygon fill="black" stroke="black" points="36408.7,-246.11 36398.11,-246.03 36406.34,-252.7 36408.7,-246.11"/>
</g>
<!-- layer2_expert12_10&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge774" class="edge">
<title>layer2_expert12_10&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M36695.92,-284.8C36692.93,-283.81 36689.95,-282.87 36687,-282 36598.91,-255.86 36496.35,-238.04 36419.39,-227.08"/>
<polygon fill="black" stroke="black" points="36419.57,-223.57 36409.18,-225.64 36418.6,-230.5 36419.57,-223.57"/>
</g>
<!-- layer2_expert12_11&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge775" class="edge">
<title>layer2_expert12_11&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M36887.99,-284.57C36884.97,-283.65 36881.97,-282.79 36879,-282 36723.16,-240.67 36536.98,-224.05 36419.35,-217.4"/>
<polygon fill="black" stroke="black" points="36419.42,-213.89 36409.24,-216.84 36419.04,-220.88 36419.42,-213.89"/>
</g>
<!-- layer2_expert12_12&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge776" class="edge">
<title>layer2_expert12_12&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M37079.75,-284.38C37076.82,-283.52 37073.9,-282.72 37071,-282 36844.99,-225.63 36571.41,-214.01 36419.34,-212.35"/>
<polygon fill="black" stroke="black" points="36419.09,-208.85 36409.05,-212.25 36419.02,-215.85 36419.09,-208.85"/>
</g>
<!-- layer2_expert12_13&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge777" class="edge">
<title>layer2_expert12_13&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M37271.77,-284.31C37268.83,-283.47 37265.9,-282.7 37263,-282 37105.95,-244.32 36638.7,-224.2 36419.27,-216.61"/>
<polygon fill="black" stroke="black" points="36419.12,-213.1 36409.01,-216.26 36418.88,-220.1 36419.12,-213.1"/>
</g>
<!-- layer2_expert12_14&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge778" class="edge">
<title>layer2_expert12_14&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M37463.78,-284.27C37460.84,-283.44 37457.91,-282.68 37455,-282 37260.76,-236.62 36671.76,-220.09 36419.59,-214.98"/>
<polygon fill="black" stroke="black" points="36419.37,-211.48 36409.3,-214.78 36419.23,-218.48 36419.37,-211.48"/>
</g>
<!-- layer2_expert12_15&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge779" class="edge">
<title>layer2_expert12_15&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M37655.78,-284.23C37652.84,-283.42 37649.91,-282.67 37647,-282 37415.15,-228.87 36701.92,-216.61 36419.7,-213.81"/>
<polygon fill="black" stroke="black" points="36419.47,-210.31 36409.44,-213.71 36419.4,-217.31 36419.47,-210.31"/>
</g>
<!-- layer2_output_gpu12 -->
<g id="node465" class="node">
<title>layer2_output_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="36429.5,-142 36176.5,-142 36176.5,-74 36429.5,-74 36429.5,-142"/>
<text text-anchor="middle" x="36303" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="36303" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="36303" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="36303" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_moe_agg_gpu12&#45;&gt;layer2_output_gpu12 -->
<g id="edge780" class="edge">
<title>layer2_moe_agg_gpu12&#45;&gt;layer2_output_gpu12</title>
<path fill="none" stroke="black" d="M36303,-177.88C36303,-169.78 36303,-160.98 36303,-152.47"/>
<polygon fill="black" stroke="black" points="36306.5,-152.3 36303,-142.3 36299.5,-152.3 36306.5,-152.3"/>
</g>
<!-- layer2_qkv_gpu13 -->
<g id="node466" class="node">
<title>layer2_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="35583,-796 35371,-796 35371,-728 35583,-728 35583,-796"/>
<text text-anchor="middle" x="35477" y="-780.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU13</text>
<text text-anchor="middle" x="35477" y="-765.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="35477" y="-750.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="35477" y="-735.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_attn_gpu13 -->
<g id="node467" class="node">
<title>layer2_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="38329,-692 38077,-692 38077,-624 38329,-624 38329,-692"/>
<text text-anchor="middle" x="38203" y="-676.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU13</text>
<text text-anchor="middle" x="38203" y="-661.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="38203" y="-646.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="38203" y="-631.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_qkv_gpu13&#45;&gt;layer2_attn_gpu13 -->
<g id="edge781" class="edge">
<title>layer2_qkv_gpu13&#45;&gt;layer2_attn_gpu13</title>
<path fill="none" stroke="black" d="M35583.1,-735.05C35597.77,-732.23 35612.71,-729.75 35627,-728 36105.84,-669.45 37606.02,-660.58 38066.93,-659.24"/>
<polygon fill="black" stroke="black" points="38066.97,-662.74 38076.96,-659.21 38066.95,-655.74 38066.97,-662.74"/>
</g>
<!-- layer2_attn_norm_gpu13 -->
<g id="node468" class="node">
<title>layer2_attn_norm_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="38867.5,-588 38614.5,-588 38614.5,-520 38867.5,-520 38867.5,-588"/>
<text text-anchor="middle" x="38741" y="-572.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="38741" y="-557.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="38741" y="-542.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="38741" y="-527.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_attn_gpu13&#45;&gt;layer2_attn_norm_gpu13 -->
<g id="edge782" class="edge">
<title>layer2_attn_gpu13&#45;&gt;layer2_attn_norm_gpu13</title>
<path fill="none" stroke="black" d="M38329.14,-633.09C38411.74,-617.42 38519.67,-596.96 38604.31,-580.91"/>
<polygon fill="black" stroke="black" points="38605.08,-584.33 38614.26,-579.03 38603.78,-577.45 38605.08,-584.33"/>
</g>
<!-- layer2_gate_gpu13 -->
<g id="node469" class="node">
<title>layer2_gate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="39401,-484 39157,-484 39157,-401 39401,-401 39401,-484"/>
<text text-anchor="middle" x="39279" y="-468.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU13</text>
<text text-anchor="middle" x="39279" y="-453.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="39279" y="-438.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="39279" y="-423.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="39279" y="-408.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_attn_norm_gpu13&#45;&gt;layer2_gate_gpu13 -->
<g id="edge783" class="edge">
<title>layer2_attn_norm_gpu13&#45;&gt;layer2_gate_gpu13</title>
<path fill="none" stroke="black" d="M38867.82,-527.19C38951.79,-510.1 39061.7,-487.73 39146.75,-470.42"/>
<polygon fill="black" stroke="black" points="39147.64,-473.81 39156.74,-468.38 39146.24,-466.95 39147.64,-473.81"/>
</g>
<!-- layer2_expert13_0 -->
<g id="node470" class="node">
<title>layer2_expert13_0</title>
<polygon fill="lightgreen" stroke="black" points="38022,-365 37848,-365 37848,-282 38022,-282 38022,-365"/>
<text text-anchor="middle" x="37935" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU13</text>
<text text-anchor="middle" x="37935" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="37935" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="37935" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="37935" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_0 -->
<g id="edge784" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39156.82,-439.24C38889.95,-433.47 38261.25,-415.11 38032.17,-364.99"/>
<polygon fill="black" stroke="black" points="38032.75,-361.53 38022.22,-362.73 38031.2,-368.35 38032.75,-361.53"/>
</g>
<!-- layer2_expert13_1 -->
<g id="node471" class="node">
<title>layer2_expert13_1</title>
<polygon fill="lightgreen" stroke="black" points="38214,-365 38040,-365 38040,-282 38214,-282 38214,-365"/>
<text text-anchor="middle" x="38127" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU13</text>
<text text-anchor="middle" x="38127" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="38127" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="38127" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="38127" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_1 -->
<g id="edge785" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39156.92,-437.65C38922.28,-429.46 38415.38,-407.62 38224.19,-364.99"/>
<polygon fill="black" stroke="black" points="38224.77,-361.54 38214.23,-362.69 38223.19,-368.35 38224.77,-361.54"/>
</g>
<!-- layer2_expert13_2 -->
<g id="node472" class="node">
<title>layer2_expert13_2</title>
<polygon fill="lightgreen" stroke="black" points="38406,-365 38232,-365 38232,-282 38406,-282 38406,-365"/>
<text text-anchor="middle" x="38319" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU13</text>
<text text-anchor="middle" x="38319" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="38319" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="38319" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="38319" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_2 -->
<g id="edge786" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39156.77,-435.36C38957.25,-424.58 38569.31,-400.2 38416,-364.96"/>
<polygon fill="black" stroke="black" points="38416.79,-361.55 38406.25,-362.63 38415.16,-368.36 38416.79,-361.55"/>
</g>
<!-- layer2_expert13_3 -->
<g id="node473" class="node">
<title>layer2_expert13_3</title>
<polygon fill="lightgreen" stroke="black" points="38598,-365 38424,-365 38424,-282 38598,-282 38598,-365"/>
<text text-anchor="middle" x="38511" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU13</text>
<text text-anchor="middle" x="38511" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="38511" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="38511" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="38511" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_3 -->
<g id="edge787" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39156.91,-438.05C39023.03,-431.91 38802.46,-414.84 38607.84,-365"/>
<polygon fill="black" stroke="black" points="38608.57,-361.57 38598.01,-362.45 38606.81,-368.35 38608.57,-361.57"/>
</g>
<!-- layer2_expert13_4 -->
<g id="node474" class="node">
<title>layer2_expert13_4</title>
<polygon fill="lightgreen" stroke="black" points="38790,-365 38616,-365 38616,-282 38790,-282 38790,-365"/>
<text text-anchor="middle" x="38703" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU13</text>
<text text-anchor="middle" x="38703" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="38703" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="38703" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="38703" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_4 -->
<g id="edge788" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39156.91,-430.26C39061.32,-419.56 38925.37,-400.14 38799.84,-365.05"/>
<polygon fill="black" stroke="black" points="38800.63,-361.64 38790.06,-362.28 38798.72,-368.37 38800.63,-361.64"/>
</g>
<!-- layer2_expert13_5 -->
<g id="node475" class="node">
<title>layer2_expert13_5</title>
<polygon fill="lightgreen" stroke="black" points="38982,-365 38808,-365 38808,-282 38982,-282 38982,-365"/>
<text text-anchor="middle" x="38895" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU13</text>
<text text-anchor="middle" x="38895" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="38895" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="38895" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="38895" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_5 -->
<g id="edge789" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39156.66,-413.02C39107.66,-400.63 39050.72,-385.01 38991.67,-365.12"/>
<polygon fill="black" stroke="black" points="38992.77,-361.79 38982.18,-361.89 38990.52,-368.42 38992.77,-361.79"/>
</g>
<!-- layer2_expert13_6 -->
<g id="node476" class="node">
<title>layer2_expert13_6</title>
<polygon fill="lightgreen" stroke="black" points="39174,-365 39000,-365 39000,-282 39174,-282 39174,-365"/>
<text text-anchor="middle" x="39087" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU13</text>
<text text-anchor="middle" x="39087" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="39087" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="39087" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="39087" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_6 -->
<g id="edge790" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39212.39,-400.91C39196.15,-391.02 39178.68,-380.37 39162.08,-370.25"/>
<polygon fill="black" stroke="black" points="39163.86,-367.24 39153.5,-365.02 39160.21,-373.21 39163.86,-367.24"/>
</g>
<!-- layer2_expert13_7 -->
<g id="node477" class="node">
<title>layer2_expert13_7</title>
<polygon fill="lightgreen" stroke="black" points="39366,-365 39192,-365 39192,-282 39366,-282 39366,-365"/>
<text text-anchor="middle" x="39279" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU13</text>
<text text-anchor="middle" x="39279" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="39279" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="39279" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="39279" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_7 -->
<g id="edge791" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39279,-400.91C39279,-392.65 39279,-383.86 39279,-375.3"/>
<polygon fill="black" stroke="black" points="39282.5,-375.02 39279,-365.02 39275.5,-375.02 39282.5,-375.02"/>
</g>
<!-- layer2_expert13_8 -->
<g id="node478" class="node">
<title>layer2_expert13_8</title>
<polygon fill="lightgreen" stroke="black" points="39558,-365 39384,-365 39384,-282 39558,-282 39558,-365"/>
<text text-anchor="middle" x="39471" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU13</text>
<text text-anchor="middle" x="39471" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="39471" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="39471" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="39471" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_8 -->
<g id="edge792" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39345.61,-400.91C39361.85,-391.02 39379.32,-380.37 39395.92,-370.25"/>
<polygon fill="black" stroke="black" points="39397.79,-373.21 39404.5,-365.02 39394.14,-367.24 39397.79,-373.21"/>
</g>
<!-- layer2_expert13_9 -->
<g id="node479" class="node">
<title>layer2_expert13_9</title>
<polygon fill="lightgreen" stroke="black" points="39750,-365 39576,-365 39576,-282 39750,-282 39750,-365"/>
<text text-anchor="middle" x="39663" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU13</text>
<text text-anchor="middle" x="39663" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="39663" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="39663" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="39663" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_9 -->
<g id="edge793" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39401.34,-413.02C39450.34,-400.63 39507.28,-385.01 39566.33,-365.12"/>
<polygon fill="black" stroke="black" points="39567.48,-368.42 39575.82,-361.89 39565.23,-361.79 39567.48,-368.42"/>
</g>
<!-- layer2_expert13_10 -->
<g id="node480" class="node">
<title>layer2_expert13_10</title>
<polygon fill="lightgreen" stroke="black" points="39942,-365 39768,-365 39768,-282 39942,-282 39942,-365"/>
<text text-anchor="middle" x="39855" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU13</text>
<text text-anchor="middle" x="39855" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="39855" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="39855" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="39855" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_10 -->
<g id="edge794" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39401.09,-430.26C39496.68,-419.56 39632.63,-400.14 39758.16,-365.05"/>
<polygon fill="black" stroke="black" points="39759.28,-368.37 39767.94,-362.28 39757.37,-361.64 39759.28,-368.37"/>
</g>
<!-- layer2_expert13_11 -->
<g id="node481" class="node">
<title>layer2_expert13_11</title>
<polygon fill="lightgreen" stroke="black" points="40134,-365 39960,-365 39960,-282 40134,-282 40134,-365"/>
<text text-anchor="middle" x="40047" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU13</text>
<text text-anchor="middle" x="40047" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="40047" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="40047" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="40047" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_11 -->
<g id="edge795" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39401.09,-438.05C39534.97,-431.91 39755.54,-414.84 39950.16,-365"/>
<polygon fill="black" stroke="black" points="39951.19,-368.35 39959.99,-362.45 39949.43,-361.57 39951.19,-368.35"/>
</g>
<!-- layer2_expert13_12 -->
<g id="node482" class="node">
<title>layer2_expert13_12</title>
<polygon fill="lightgreen" stroke="black" points="40326,-365 40152,-365 40152,-282 40326,-282 40326,-365"/>
<text text-anchor="middle" x="40239" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU13</text>
<text text-anchor="middle" x="40239" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="40239" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="40239" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="40239" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_12 -->
<g id="edge796" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39401.23,-435.36C39600.75,-424.58 39988.69,-400.2 40142,-364.96"/>
<polygon fill="black" stroke="black" points="40142.84,-368.36 40151.75,-362.63 40141.21,-361.55 40142.84,-368.36"/>
</g>
<!-- layer2_expert13_13 -->
<g id="node483" class="node">
<title>layer2_expert13_13</title>
<polygon fill="lightgreen" stroke="black" points="40518,-365 40344,-365 40344,-282 40518,-282 40518,-365"/>
<text text-anchor="middle" x="40431" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU13</text>
<text text-anchor="middle" x="40431" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="40431" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="40431" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="40431" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_13 -->
<g id="edge797" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39401.08,-437.65C39635.72,-429.46 40142.62,-407.62 40333.81,-364.99"/>
<polygon fill="black" stroke="black" points="40334.81,-368.35 40343.77,-362.69 40333.23,-361.54 40334.81,-368.35"/>
</g>
<!-- layer2_expert13_14 -->
<g id="node484" class="node">
<title>layer2_expert13_14</title>
<polygon fill="lightgreen" stroke="black" points="40710,-365 40536,-365 40536,-282 40710,-282 40710,-365"/>
<text text-anchor="middle" x="40623" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU13</text>
<text text-anchor="middle" x="40623" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="40623" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="40623" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="40623" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_14 -->
<g id="edge798" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39401.18,-439.24C39668.05,-433.47 40296.75,-415.11 40525.83,-364.99"/>
<polygon fill="black" stroke="black" points="40526.8,-368.35 40535.78,-362.73 40525.25,-361.53 40526.8,-368.35"/>
</g>
<!-- layer2_expert13_15 -->
<g id="node485" class="node">
<title>layer2_expert13_15</title>
<polygon fill="lightgreen" stroke="black" points="40902,-365 40728,-365 40728,-282 40902,-282 40902,-365"/>
<text text-anchor="middle" x="40815" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU13</text>
<text text-anchor="middle" x="40815" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="40815" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="40815" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="40815" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_15 -->
<g id="edge799" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39401.2,-440.41C39697.79,-436.92 40450.41,-422.7 40717.71,-365.01"/>
<polygon fill="black" stroke="black" points="40718.78,-368.35 40727.78,-362.76 40717.26,-361.52 40718.78,-368.35"/>
</g>
<!-- layer2_moe_agg_gpu13 -->
<g id="node486" class="node">
<title>layer2_moe_agg_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="39481,-246 39269,-246 39269,-178 39481,-178 39481,-246"/>
<text text-anchor="middle" x="39375" y="-230.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU13</text>
<text text-anchor="middle" x="39375" y="-215.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="39375" y="-200.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="39375" y="-185.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_expert13_0&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge800" class="edge">
<title>layer2_expert13_0&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38022.22,-284.23C38025.16,-283.42 38028.09,-282.67 38031,-282 38262.85,-228.87 38976.08,-216.61 39258.3,-213.81"/>
<polygon fill="black" stroke="black" points="39258.6,-217.31 39268.56,-213.71 39258.53,-210.31 39258.6,-217.31"/>
</g>
<!-- layer2_expert13_1&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge801" class="edge">
<title>layer2_expert13_1&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38214.22,-284.27C38217.16,-283.44 38220.09,-282.68 38223,-282 38417.24,-236.62 39006.24,-220.09 39258.41,-214.98"/>
<polygon fill="black" stroke="black" points="39258.77,-218.48 39268.7,-214.78 39258.63,-211.48 39258.77,-218.48"/>
</g>
<!-- layer2_expert13_2&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge802" class="edge">
<title>layer2_expert13_2&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38406.23,-284.31C38409.17,-283.47 38412.1,-282.7 38415,-282 38572.05,-244.32 39039.3,-224.2 39258.73,-216.61"/>
<polygon fill="black" stroke="black" points="39259.12,-220.1 39268.99,-216.26 39258.88,-213.1 39259.12,-220.1"/>
</g>
<!-- layer2_expert13_3&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge803" class="edge">
<title>layer2_expert13_3&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38598.25,-284.38C38601.18,-283.52 38604.1,-282.72 38607,-282 38833.01,-225.63 39106.59,-214.01 39258.66,-212.35"/>
<polygon fill="black" stroke="black" points="39258.98,-215.85 39268.95,-212.25 39258.91,-208.85 39258.98,-215.85"/>
</g>
<!-- layer2_expert13_4&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge804" class="edge">
<title>layer2_expert13_4&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38790.01,-284.57C38793.03,-283.65 38796.03,-282.79 38799,-282 38954.84,-240.67 39141.02,-224.05 39258.65,-217.4"/>
<polygon fill="black" stroke="black" points="39258.96,-220.88 39268.76,-216.84 39258.58,-213.89 39258.96,-220.88"/>
</g>
<!-- layer2_expert13_5&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge805" class="edge">
<title>layer2_expert13_5&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38982.08,-284.8C38985.07,-283.81 38988.05,-282.87 38991,-282 39079.09,-255.86 39181.65,-238.04 39258.61,-227.08"/>
<polygon fill="black" stroke="black" points="39259.4,-230.5 39268.82,-225.64 39258.43,-223.57 39259.4,-230.5"/>
</g>
<!-- layer2_expert13_6&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge806" class="edge">
<title>layer2_expert13_6&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M39174.04,-285.54C39177.06,-284.33 39180.05,-283.15 39183,-282 39211.16,-271.01 39241.89,-259.68 39270.34,-249.45"/>
<polygon fill="black" stroke="black" points="39271.66,-252.7 39279.89,-246.03 39269.3,-246.11 39271.66,-252.7"/>
</g>
<!-- layer2_expert13_7&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge807" class="edge">
<title>layer2_expert13_7&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M39314.75,-281.73C39322.66,-272.7 39331.06,-263.12 39338.98,-254.08"/>
<polygon fill="black" stroke="black" points="39341.85,-256.13 39345.81,-246.3 39336.58,-251.51 39341.85,-256.13"/>
</g>
<!-- layer2_expert13_8&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge808" class="edge">
<title>layer2_expert13_8&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M39435.25,-281.73C39427.34,-272.7 39418.94,-263.12 39411.02,-254.08"/>
<polygon fill="black" stroke="black" points="39413.42,-251.51 39404.19,-246.3 39408.15,-256.13 39413.42,-251.51"/>
</g>
<!-- layer2_expert13_9&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge809" class="edge">
<title>layer2_expert13_9&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M39575.96,-285.54C39572.94,-284.33 39569.95,-283.15 39567,-282 39538.84,-271.01 39508.11,-259.68 39479.66,-249.45"/>
<polygon fill="black" stroke="black" points="39480.7,-246.11 39470.11,-246.03 39478.34,-252.7 39480.7,-246.11"/>
</g>
<!-- layer2_expert13_10&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge810" class="edge">
<title>layer2_expert13_10&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M39767.92,-284.8C39764.93,-283.81 39761.95,-282.87 39759,-282 39670.91,-255.86 39568.35,-238.04 39491.39,-227.08"/>
<polygon fill="black" stroke="black" points="39491.57,-223.57 39481.18,-225.64 39490.6,-230.5 39491.57,-223.57"/>
</g>
<!-- layer2_expert13_11&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge811" class="edge">
<title>layer2_expert13_11&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M39959.99,-284.57C39956.97,-283.65 39953.97,-282.79 39951,-282 39795.16,-240.67 39608.98,-224.05 39491.35,-217.4"/>
<polygon fill="black" stroke="black" points="39491.42,-213.89 39481.24,-216.84 39491.04,-220.88 39491.42,-213.89"/>
</g>
<!-- layer2_expert13_12&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge812" class="edge">
<title>layer2_expert13_12&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M40151.75,-284.38C40148.82,-283.52 40145.9,-282.72 40143,-282 39916.99,-225.63 39643.41,-214.01 39491.34,-212.35"/>
<polygon fill="black" stroke="black" points="39491.09,-208.85 39481.05,-212.25 39491.02,-215.85 39491.09,-208.85"/>
</g>
<!-- layer2_expert13_13&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge813" class="edge">
<title>layer2_expert13_13&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M40343.77,-284.31C40340.83,-283.47 40337.9,-282.7 40335,-282 40177.95,-244.32 39710.7,-224.2 39491.27,-216.61"/>
<polygon fill="black" stroke="black" points="39491.12,-213.1 39481.01,-216.26 39490.88,-220.1 39491.12,-213.1"/>
</g>
<!-- layer2_expert13_14&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge814" class="edge">
<title>layer2_expert13_14&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M40535.78,-284.27C40532.84,-283.44 40529.91,-282.68 40527,-282 40332.76,-236.62 39743.76,-220.09 39491.59,-214.98"/>
<polygon fill="black" stroke="black" points="39491.37,-211.48 39481.3,-214.78 39491.23,-218.48 39491.37,-211.48"/>
</g>
<!-- layer2_expert13_15&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge815" class="edge">
<title>layer2_expert13_15&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M40727.78,-284.23C40724.84,-283.42 40721.91,-282.67 40719,-282 40487.15,-228.87 39773.92,-216.61 39491.7,-213.81"/>
<polygon fill="black" stroke="black" points="39491.47,-210.31 39481.44,-213.71 39491.4,-217.31 39491.47,-210.31"/>
</g>
<!-- layer2_output_gpu13 -->
<g id="node487" class="node">
<title>layer2_output_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="39501.5,-142 39248.5,-142 39248.5,-74 39501.5,-74 39501.5,-142"/>
<text text-anchor="middle" x="39375" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="39375" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="39375" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="39375" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_moe_agg_gpu13&#45;&gt;layer2_output_gpu13 -->
<g id="edge816" class="edge">
<title>layer2_moe_agg_gpu13&#45;&gt;layer2_output_gpu13</title>
<path fill="none" stroke="black" d="M39375,-177.88C39375,-169.78 39375,-160.98 39375,-152.47"/>
<polygon fill="black" stroke="black" points="39378.5,-152.3 39375,-142.3 39371.5,-152.3 39378.5,-152.3"/>
</g>
<!-- layer2_qkv_gpu14 -->
<g id="node488" class="node">
<title>layer2_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="35848,-796 35636,-796 35636,-728 35848,-728 35848,-796"/>
<text text-anchor="middle" x="35742" y="-780.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU14</text>
<text text-anchor="middle" x="35742" y="-765.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="35742" y="-750.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="35742" y="-735.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_attn_gpu14 -->
<g id="node489" class="node">
<title>layer2_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="41027,-692 40775,-692 40775,-624 41027,-624 41027,-692"/>
<text text-anchor="middle" x="40901" y="-676.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU14</text>
<text text-anchor="middle" x="40901" y="-661.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="40901" y="-646.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="40901" y="-631.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_qkv_gpu14&#45;&gt;layer2_attn_gpu14 -->
<g id="edge817" class="edge">
<title>layer2_qkv_gpu14&#45;&gt;layer2_attn_gpu14</title>
<path fill="none" stroke="black" d="M35848.26,-735.11C35863.53,-732.22 35879.11,-729.7 35894,-728 35925.13,-724.44 39966.31,-671.26 40764.84,-660.78"/>
<polygon fill="black" stroke="black" points="40764.99,-664.28 40774.94,-660.65 40764.9,-657.28 40764.99,-664.28"/>
</g>
<!-- layer2_attn_norm_gpu14 -->
<g id="node490" class="node">
<title>layer2_attn_norm_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="41752.5,-588 41499.5,-588 41499.5,-520 41752.5,-520 41752.5,-588"/>
<text text-anchor="middle" x="41626" y="-572.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="41626" y="-557.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="41626" y="-542.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="41626" y="-527.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_attn_gpu14&#45;&gt;layer2_attn_norm_gpu14 -->
<g id="edge818" class="edge">
<title>layer2_attn_gpu14&#45;&gt;layer2_attn_norm_gpu14</title>
<path fill="none" stroke="black" d="M41027.29,-639.23C41156.38,-621.07 41356.27,-592.95 41489.1,-574.26"/>
<polygon fill="black" stroke="black" points="41489.92,-577.68 41499.34,-572.82 41488.95,-570.75 41489.92,-577.68"/>
</g>
<!-- layer2_gate_gpu14 -->
<g id="node491" class="node">
<title>layer2_gate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="42473,-484 42229,-484 42229,-401 42473,-401 42473,-484"/>
<text text-anchor="middle" x="42351" y="-468.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU14</text>
<text text-anchor="middle" x="42351" y="-453.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="42351" y="-438.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="42351" y="-423.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="42351" y="-408.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_attn_norm_gpu14&#45;&gt;layer2_gate_gpu14 -->
<g id="edge819" class="edge">
<title>layer2_attn_norm_gpu14&#45;&gt;layer2_gate_gpu14</title>
<path fill="none" stroke="black" d="M41752.7,-533.86C41883.25,-514.15 42085.87,-483.54 42218.5,-463.51"/>
<polygon fill="black" stroke="black" points="42219.36,-466.92 42228.72,-461.97 42218.31,-460 42219.36,-466.92"/>
</g>
<!-- layer2_expert14_0 -->
<g id="node492" class="node">
<title>layer2_expert14_0</title>
<polygon fill="lightgreen" stroke="black" points="41094,-365 40920,-365 40920,-282 41094,-282 41094,-365"/>
<text text-anchor="middle" x="41007" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU14</text>
<text text-anchor="middle" x="41007" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41007" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41007" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41007" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_0 -->
<g id="edge820" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42228.82,-439.24C41961.95,-433.47 41333.25,-415.11 41104.17,-364.99"/>
<polygon fill="black" stroke="black" points="41104.75,-361.53 41094.22,-362.73 41103.2,-368.35 41104.75,-361.53"/>
</g>
<!-- layer2_expert14_1 -->
<g id="node493" class="node">
<title>layer2_expert14_1</title>
<polygon fill="lightgreen" stroke="black" points="41286,-365 41112,-365 41112,-282 41286,-282 41286,-365"/>
<text text-anchor="middle" x="41199" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU14</text>
<text text-anchor="middle" x="41199" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41199" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41199" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41199" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_1 -->
<g id="edge821" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42228.92,-437.65C41994.28,-429.46 41487.38,-407.62 41296.19,-364.99"/>
<polygon fill="black" stroke="black" points="41296.77,-361.54 41286.23,-362.69 41295.19,-368.35 41296.77,-361.54"/>
</g>
<!-- layer2_expert14_2 -->
<g id="node494" class="node">
<title>layer2_expert14_2</title>
<polygon fill="lightgreen" stroke="black" points="41478,-365 41304,-365 41304,-282 41478,-282 41478,-365"/>
<text text-anchor="middle" x="41391" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU14</text>
<text text-anchor="middle" x="41391" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41391" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41391" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41391" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_2 -->
<g id="edge822" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42228.77,-435.36C42029.25,-424.58 41641.31,-400.2 41488,-364.96"/>
<polygon fill="black" stroke="black" points="41488.79,-361.55 41478.25,-362.63 41487.16,-368.36 41488.79,-361.55"/>
</g>
<!-- layer2_expert14_3 -->
<g id="node495" class="node">
<title>layer2_expert14_3</title>
<polygon fill="lightgreen" stroke="black" points="41670,-365 41496,-365 41496,-282 41670,-282 41670,-365"/>
<text text-anchor="middle" x="41583" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU14</text>
<text text-anchor="middle" x="41583" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41583" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41583" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41583" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_3 -->
<g id="edge823" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42228.91,-438.05C42095.03,-431.91 41874.46,-414.84 41679.84,-365"/>
<polygon fill="black" stroke="black" points="41680.57,-361.57 41670.01,-362.45 41678.81,-368.35 41680.57,-361.57"/>
</g>
<!-- layer2_expert14_4 -->
<g id="node496" class="node">
<title>layer2_expert14_4</title>
<polygon fill="lightgreen" stroke="black" points="41862,-365 41688,-365 41688,-282 41862,-282 41862,-365"/>
<text text-anchor="middle" x="41775" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU14</text>
<text text-anchor="middle" x="41775" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41775" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41775" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41775" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_4 -->
<g id="edge824" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42228.91,-430.26C42133.32,-419.56 41997.37,-400.14 41871.84,-365.05"/>
<polygon fill="black" stroke="black" points="41872.63,-361.64 41862.06,-362.28 41870.72,-368.37 41872.63,-361.64"/>
</g>
<!-- layer2_expert14_5 -->
<g id="node497" class="node">
<title>layer2_expert14_5</title>
<polygon fill="lightgreen" stroke="black" points="42054,-365 41880,-365 41880,-282 42054,-282 42054,-365"/>
<text text-anchor="middle" x="41967" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU14</text>
<text text-anchor="middle" x="41967" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="41967" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="41967" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="41967" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_5 -->
<g id="edge825" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42228.66,-413.02C42179.66,-400.63 42122.72,-385.01 42063.67,-365.12"/>
<polygon fill="black" stroke="black" points="42064.77,-361.79 42054.18,-361.89 42062.52,-368.42 42064.77,-361.79"/>
</g>
<!-- layer2_expert14_6 -->
<g id="node498" class="node">
<title>layer2_expert14_6</title>
<polygon fill="lightgreen" stroke="black" points="42246,-365 42072,-365 42072,-282 42246,-282 42246,-365"/>
<text text-anchor="middle" x="42159" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU14</text>
<text text-anchor="middle" x="42159" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="42159" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="42159" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="42159" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_6 -->
<g id="edge826" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42284.39,-400.91C42268.15,-391.02 42250.68,-380.37 42234.08,-370.25"/>
<polygon fill="black" stroke="black" points="42235.86,-367.24 42225.5,-365.02 42232.21,-373.21 42235.86,-367.24"/>
</g>
<!-- layer2_expert14_7 -->
<g id="node499" class="node">
<title>layer2_expert14_7</title>
<polygon fill="lightgreen" stroke="black" points="42438,-365 42264,-365 42264,-282 42438,-282 42438,-365"/>
<text text-anchor="middle" x="42351" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU14</text>
<text text-anchor="middle" x="42351" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="42351" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="42351" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="42351" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_7 -->
<g id="edge827" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42351,-400.91C42351,-392.65 42351,-383.86 42351,-375.3"/>
<polygon fill="black" stroke="black" points="42354.5,-375.02 42351,-365.02 42347.5,-375.02 42354.5,-375.02"/>
</g>
<!-- layer2_expert14_8 -->
<g id="node500" class="node">
<title>layer2_expert14_8</title>
<polygon fill="lightgreen" stroke="black" points="42630,-365 42456,-365 42456,-282 42630,-282 42630,-365"/>
<text text-anchor="middle" x="42543" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU14</text>
<text text-anchor="middle" x="42543" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="42543" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="42543" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="42543" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_8 -->
<g id="edge828" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42417.61,-400.91C42433.85,-391.02 42451.32,-380.37 42467.92,-370.25"/>
<polygon fill="black" stroke="black" points="42469.79,-373.21 42476.5,-365.02 42466.14,-367.24 42469.79,-373.21"/>
</g>
<!-- layer2_expert14_9 -->
<g id="node501" class="node">
<title>layer2_expert14_9</title>
<polygon fill="lightgreen" stroke="black" points="42822,-365 42648,-365 42648,-282 42822,-282 42822,-365"/>
<text text-anchor="middle" x="42735" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU14</text>
<text text-anchor="middle" x="42735" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="42735" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="42735" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="42735" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_9 -->
<g id="edge829" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42473.34,-413.02C42522.34,-400.63 42579.28,-385.01 42638.33,-365.12"/>
<polygon fill="black" stroke="black" points="42639.48,-368.42 42647.82,-361.89 42637.23,-361.79 42639.48,-368.42"/>
</g>
<!-- layer2_expert14_10 -->
<g id="node502" class="node">
<title>layer2_expert14_10</title>
<polygon fill="lightgreen" stroke="black" points="43014,-365 42840,-365 42840,-282 43014,-282 43014,-365"/>
<text text-anchor="middle" x="42927" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU14</text>
<text text-anchor="middle" x="42927" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="42927" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="42927" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="42927" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_10 -->
<g id="edge830" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42473.09,-430.26C42568.68,-419.56 42704.63,-400.14 42830.16,-365.05"/>
<polygon fill="black" stroke="black" points="42831.28,-368.37 42839.94,-362.28 42829.37,-361.64 42831.28,-368.37"/>
</g>
<!-- layer2_expert14_11 -->
<g id="node503" class="node">
<title>layer2_expert14_11</title>
<polygon fill="lightgreen" stroke="black" points="43206,-365 43032,-365 43032,-282 43206,-282 43206,-365"/>
<text text-anchor="middle" x="43119" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU14</text>
<text text-anchor="middle" x="43119" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="43119" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="43119" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="43119" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_11 -->
<g id="edge831" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42473.09,-438.05C42606.97,-431.91 42827.54,-414.84 43022.16,-365"/>
<polygon fill="black" stroke="black" points="43023.19,-368.35 43031.99,-362.45 43021.43,-361.57 43023.19,-368.35"/>
</g>
<!-- layer2_expert14_12 -->
<g id="node504" class="node">
<title>layer2_expert14_12</title>
<polygon fill="lightgreen" stroke="black" points="43398,-365 43224,-365 43224,-282 43398,-282 43398,-365"/>
<text text-anchor="middle" x="43311" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU14</text>
<text text-anchor="middle" x="43311" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="43311" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="43311" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="43311" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_12 -->
<g id="edge832" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42473.23,-435.36C42672.75,-424.58 43060.69,-400.2 43214,-364.96"/>
<polygon fill="black" stroke="black" points="43214.84,-368.36 43223.75,-362.63 43213.21,-361.55 43214.84,-368.36"/>
</g>
<!-- layer2_expert14_13 -->
<g id="node505" class="node">
<title>layer2_expert14_13</title>
<polygon fill="lightgreen" stroke="black" points="43590,-365 43416,-365 43416,-282 43590,-282 43590,-365"/>
<text text-anchor="middle" x="43503" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU14</text>
<text text-anchor="middle" x="43503" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="43503" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="43503" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="43503" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_13 -->
<g id="edge833" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42473.08,-437.65C42707.72,-429.46 43214.62,-407.62 43405.81,-364.99"/>
<polygon fill="black" stroke="black" points="43406.81,-368.35 43415.77,-362.69 43405.23,-361.54 43406.81,-368.35"/>
</g>
<!-- layer2_expert14_14 -->
<g id="node506" class="node">
<title>layer2_expert14_14</title>
<polygon fill="lightgreen" stroke="black" points="43782,-365 43608,-365 43608,-282 43782,-282 43782,-365"/>
<text text-anchor="middle" x="43695" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU14</text>
<text text-anchor="middle" x="43695" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="43695" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="43695" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="43695" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_14 -->
<g id="edge834" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42473.18,-439.24C42740.05,-433.47 43368.75,-415.11 43597.83,-364.99"/>
<polygon fill="black" stroke="black" points="43598.8,-368.35 43607.78,-362.73 43597.25,-361.53 43598.8,-368.35"/>
</g>
<!-- layer2_expert14_15 -->
<g id="node507" class="node">
<title>layer2_expert14_15</title>
<polygon fill="lightgreen" stroke="black" points="43974,-365 43800,-365 43800,-282 43974,-282 43974,-365"/>
<text text-anchor="middle" x="43887" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU14</text>
<text text-anchor="middle" x="43887" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="43887" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="43887" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="43887" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_15 -->
<g id="edge835" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42473.2,-440.41C42769.79,-436.92 43522.41,-422.7 43789.71,-365.01"/>
<polygon fill="black" stroke="black" points="43790.78,-368.35 43799.78,-362.76 43789.26,-361.52 43790.78,-368.35"/>
</g>
<!-- layer2_moe_agg_gpu14 -->
<g id="node508" class="node">
<title>layer2_moe_agg_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="42553,-246 42341,-246 42341,-178 42553,-178 42553,-246"/>
<text text-anchor="middle" x="42447" y="-230.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU14</text>
<text text-anchor="middle" x="42447" y="-215.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="42447" y="-200.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="42447" y="-185.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_expert14_0&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge836" class="edge">
<title>layer2_expert14_0&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41094.22,-284.23C41097.16,-283.42 41100.09,-282.67 41103,-282 41334.85,-228.87 42048.08,-216.61 42330.3,-213.81"/>
<polygon fill="black" stroke="black" points="42330.6,-217.31 42340.56,-213.71 42330.53,-210.31 42330.6,-217.31"/>
</g>
<!-- layer2_expert14_1&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge837" class="edge">
<title>layer2_expert14_1&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41286.22,-284.27C41289.16,-283.44 41292.09,-282.68 41295,-282 41489.24,-236.62 42078.24,-220.09 42330.41,-214.98"/>
<polygon fill="black" stroke="black" points="42330.77,-218.48 42340.7,-214.78 42330.63,-211.48 42330.77,-218.48"/>
</g>
<!-- layer2_expert14_2&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge838" class="edge">
<title>layer2_expert14_2&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41478.23,-284.31C41481.17,-283.47 41484.1,-282.7 41487,-282 41644.05,-244.32 42111.3,-224.2 42330.73,-216.61"/>
<polygon fill="black" stroke="black" points="42331.12,-220.1 42340.99,-216.26 42330.88,-213.1 42331.12,-220.1"/>
</g>
<!-- layer2_expert14_3&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge839" class="edge">
<title>layer2_expert14_3&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41670.25,-284.38C41673.18,-283.52 41676.1,-282.72 41679,-282 41905.01,-225.63 42178.59,-214.01 42330.66,-212.35"/>
<polygon fill="black" stroke="black" points="42330.98,-215.85 42340.95,-212.25 42330.91,-208.85 42330.98,-215.85"/>
</g>
<!-- layer2_expert14_4&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge840" class="edge">
<title>layer2_expert14_4&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41862.01,-284.57C41865.03,-283.65 41868.03,-282.79 41871,-282 42026.84,-240.67 42213.02,-224.05 42330.65,-217.4"/>
<polygon fill="black" stroke="black" points="42330.96,-220.88 42340.76,-216.84 42330.58,-213.89 42330.96,-220.88"/>
</g>
<!-- layer2_expert14_5&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge841" class="edge">
<title>layer2_expert14_5&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M42054.08,-284.8C42057.07,-283.81 42060.05,-282.87 42063,-282 42151.09,-255.86 42253.65,-238.04 42330.61,-227.08"/>
<polygon fill="black" stroke="black" points="42331.4,-230.5 42340.82,-225.64 42330.43,-223.57 42331.4,-230.5"/>
</g>
<!-- layer2_expert14_6&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge842" class="edge">
<title>layer2_expert14_6&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M42246.04,-285.54C42249.06,-284.33 42252.05,-283.15 42255,-282 42283.16,-271.01 42313.89,-259.68 42342.34,-249.45"/>
<polygon fill="black" stroke="black" points="42343.66,-252.7 42351.89,-246.03 42341.3,-246.11 42343.66,-252.7"/>
</g>
<!-- layer2_expert14_7&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge843" class="edge">
<title>layer2_expert14_7&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M42386.75,-281.73C42394.66,-272.7 42403.06,-263.12 42410.98,-254.08"/>
<polygon fill="black" stroke="black" points="42413.85,-256.13 42417.81,-246.3 42408.58,-251.51 42413.85,-256.13"/>
</g>
<!-- layer2_expert14_8&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge844" class="edge">
<title>layer2_expert14_8&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M42507.25,-281.73C42499.34,-272.7 42490.94,-263.12 42483.02,-254.08"/>
<polygon fill="black" stroke="black" points="42485.42,-251.51 42476.19,-246.3 42480.15,-256.13 42485.42,-251.51"/>
</g>
<!-- layer2_expert14_9&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge845" class="edge">
<title>layer2_expert14_9&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M42647.96,-285.54C42644.94,-284.33 42641.95,-283.15 42639,-282 42610.84,-271.01 42580.11,-259.68 42551.66,-249.45"/>
<polygon fill="black" stroke="black" points="42552.7,-246.11 42542.11,-246.03 42550.34,-252.7 42552.7,-246.11"/>
</g>
<!-- layer2_expert14_10&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge846" class="edge">
<title>layer2_expert14_10&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M42839.92,-284.8C42836.93,-283.81 42833.95,-282.87 42831,-282 42742.91,-255.86 42640.35,-238.04 42563.39,-227.08"/>
<polygon fill="black" stroke="black" points="42563.57,-223.57 42553.18,-225.64 42562.6,-230.5 42563.57,-223.57"/>
</g>
<!-- layer2_expert14_11&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge847" class="edge">
<title>layer2_expert14_11&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M43031.99,-284.57C43028.97,-283.65 43025.97,-282.79 43023,-282 42867.16,-240.67 42680.98,-224.05 42563.35,-217.4"/>
<polygon fill="black" stroke="black" points="42563.42,-213.89 42553.24,-216.84 42563.04,-220.88 42563.42,-213.89"/>
</g>
<!-- layer2_expert14_12&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge848" class="edge">
<title>layer2_expert14_12&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M43223.75,-284.38C43220.82,-283.52 43217.9,-282.72 43215,-282 42988.99,-225.63 42715.41,-214.01 42563.34,-212.35"/>
<polygon fill="black" stroke="black" points="42563.09,-208.85 42553.05,-212.25 42563.02,-215.85 42563.09,-208.85"/>
</g>
<!-- layer2_expert14_13&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge849" class="edge">
<title>layer2_expert14_13&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M43415.77,-284.31C43412.83,-283.47 43409.9,-282.7 43407,-282 43249.95,-244.32 42782.7,-224.2 42563.27,-216.61"/>
<polygon fill="black" stroke="black" points="42563.12,-213.1 42553.01,-216.26 42562.88,-220.1 42563.12,-213.1"/>
</g>
<!-- layer2_expert14_14&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge850" class="edge">
<title>layer2_expert14_14&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M43607.78,-284.27C43604.84,-283.44 43601.91,-282.68 43599,-282 43404.76,-236.62 42815.76,-220.09 42563.59,-214.98"/>
<polygon fill="black" stroke="black" points="42563.37,-211.48 42553.3,-214.78 42563.23,-218.48 42563.37,-211.48"/>
</g>
<!-- layer2_expert14_15&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge851" class="edge">
<title>layer2_expert14_15&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M43799.78,-284.23C43796.84,-283.42 43793.91,-282.67 43791,-282 43559.15,-228.87 42845.92,-216.61 42563.7,-213.81"/>
<polygon fill="black" stroke="black" points="42563.47,-210.31 42553.44,-213.71 42563.4,-217.31 42563.47,-210.31"/>
</g>
<!-- layer2_output_gpu14 -->
<g id="node509" class="node">
<title>layer2_output_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="42573.5,-142 42320.5,-142 42320.5,-74 42573.5,-74 42573.5,-142"/>
<text text-anchor="middle" x="42447" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="42447" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="42447" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="42447" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_moe_agg_gpu14&#45;&gt;layer2_output_gpu14 -->
<g id="edge852" class="edge">
<title>layer2_moe_agg_gpu14&#45;&gt;layer2_output_gpu14</title>
<path fill="none" stroke="black" d="M42447,-177.88C42447,-169.78 42447,-160.98 42447,-152.47"/>
<polygon fill="black" stroke="black" points="42450.5,-152.3 42447,-142.3 42443.5,-152.3 42450.5,-152.3"/>
</g>
<!-- layer2_qkv_gpu15 -->
<g id="node510" class="node">
<title>layer2_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="36115,-796 35903,-796 35903,-728 36115,-728 36115,-796"/>
<text text-anchor="middle" x="36009" y="-780.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU15</text>
<text text-anchor="middle" x="36009" y="-765.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="36009" y="-750.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="36009" y="-735.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_attn_gpu15 -->
<g id="node511" class="node">
<title>layer2_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="42511,-692 42259,-692 42259,-624 42511,-624 42511,-692"/>
<text text-anchor="middle" x="42385" y="-676.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU15</text>
<text text-anchor="middle" x="42385" y="-661.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="42385" y="-646.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="42385" y="-631.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_qkv_gpu15&#45;&gt;layer2_attn_gpu15 -->
<g id="edge853" class="edge">
<title>layer2_qkv_gpu15&#45;&gt;layer2_attn_gpu15</title>
<path fill="none" stroke="black" d="M36115.13,-759.97C36645.27,-754.71 39059.41,-729.74 41036,-692 41479.35,-683.53 42004.57,-669.55 42248.22,-662.83"/>
<polygon fill="black" stroke="black" points="42248.64,-666.32 42258.54,-662.55 42248.45,-659.32 42248.64,-666.32"/>
</g>
<!-- layer2_attn_norm_gpu15 -->
<g id="node512" class="node">
<title>layer2_attn_norm_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="43423.5,-588 43170.5,-588 43170.5,-520 43423.5,-520 43423.5,-588"/>
<text text-anchor="middle" x="43297" y="-572.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="43297" y="-557.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="43297" y="-542.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="43297" y="-527.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_attn_gpu15&#45;&gt;layer2_attn_norm_gpu15 -->
<g id="edge854" class="edge">
<title>layer2_attn_gpu15&#45;&gt;layer2_attn_norm_gpu15</title>
<path fill="none" stroke="black" d="M42511.33,-642.87C42681.87,-623.8 42984.58,-589.94 43160.3,-570.29"/>
<polygon fill="black" stroke="black" points="43160.84,-573.75 43170.39,-569.16 43160.06,-566.79 43160.84,-573.75"/>
</g>
<!-- layer2_gate_gpu15 -->
<g id="node513" class="node">
<title>layer2_gate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="45545,-484 45301,-484 45301,-401 45545,-401 45545,-484"/>
<text text-anchor="middle" x="45423" y="-468.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU15</text>
<text text-anchor="middle" x="45423" y="-453.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="45423" y="-438.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="45423" y="-423.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="45423" y="-408.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_attn_norm_gpu15&#45;&gt;layer2_gate_gpu15 -->
<g id="edge855" class="edge">
<title>layer2_attn_norm_gpu15&#45;&gt;layer2_gate_gpu15</title>
<path fill="none" stroke="black" d="M43423.62,-546.48C43799.65,-527.11 44907.35,-470.06 45290.67,-450.32"/>
<polygon fill="black" stroke="black" points="45290.89,-453.81 45300.69,-449.8 45290.53,-446.82 45290.89,-453.81"/>
</g>
<!-- layer2_expert15_0 -->
<g id="node514" class="node">
<title>layer2_expert15_0</title>
<polygon fill="lightgreen" stroke="black" points="44166,-365 43992,-365 43992,-282 44166,-282 44166,-365"/>
<text text-anchor="middle" x="44079" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU15</text>
<text text-anchor="middle" x="44079" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="44079" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="44079" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="44079" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_0 -->
<g id="edge856" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45300.82,-439.24C45033.95,-433.47 44405.25,-415.11 44176.17,-364.99"/>
<polygon fill="black" stroke="black" points="44176.75,-361.53 44166.22,-362.73 44175.2,-368.35 44176.75,-361.53"/>
</g>
<!-- layer2_expert15_1 -->
<g id="node515" class="node">
<title>layer2_expert15_1</title>
<polygon fill="lightgreen" stroke="black" points="44358,-365 44184,-365 44184,-282 44358,-282 44358,-365"/>
<text text-anchor="middle" x="44271" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU15</text>
<text text-anchor="middle" x="44271" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="44271" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="44271" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="44271" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_1 -->
<g id="edge857" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45300.92,-437.65C45066.28,-429.46 44559.38,-407.62 44368.19,-364.99"/>
<polygon fill="black" stroke="black" points="44368.77,-361.54 44358.23,-362.69 44367.19,-368.35 44368.77,-361.54"/>
</g>
<!-- layer2_expert15_2 -->
<g id="node516" class="node">
<title>layer2_expert15_2</title>
<polygon fill="lightgreen" stroke="black" points="44550,-365 44376,-365 44376,-282 44550,-282 44550,-365"/>
<text text-anchor="middle" x="44463" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU15</text>
<text text-anchor="middle" x="44463" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="44463" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="44463" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="44463" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_2 -->
<g id="edge858" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45300.77,-435.36C45101.25,-424.58 44713.31,-400.2 44560,-364.96"/>
<polygon fill="black" stroke="black" points="44560.79,-361.55 44550.25,-362.63 44559.16,-368.36 44560.79,-361.55"/>
</g>
<!-- layer2_expert15_3 -->
<g id="node517" class="node">
<title>layer2_expert15_3</title>
<polygon fill="lightgreen" stroke="black" points="44742,-365 44568,-365 44568,-282 44742,-282 44742,-365"/>
<text text-anchor="middle" x="44655" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU15</text>
<text text-anchor="middle" x="44655" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="44655" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="44655" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="44655" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_3 -->
<g id="edge859" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45300.91,-438.05C45167.03,-431.91 44946.46,-414.84 44751.84,-365"/>
<polygon fill="black" stroke="black" points="44752.57,-361.57 44742.01,-362.45 44750.81,-368.35 44752.57,-361.57"/>
</g>
<!-- layer2_expert15_4 -->
<g id="node518" class="node">
<title>layer2_expert15_4</title>
<polygon fill="lightgreen" stroke="black" points="44934,-365 44760,-365 44760,-282 44934,-282 44934,-365"/>
<text text-anchor="middle" x="44847" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU15</text>
<text text-anchor="middle" x="44847" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="44847" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="44847" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="44847" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_4 -->
<g id="edge860" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45300.91,-430.26C45205.32,-419.56 45069.37,-400.14 44943.84,-365.05"/>
<polygon fill="black" stroke="black" points="44944.63,-361.64 44934.06,-362.28 44942.72,-368.37 44944.63,-361.64"/>
</g>
<!-- layer2_expert15_5 -->
<g id="node519" class="node">
<title>layer2_expert15_5</title>
<polygon fill="lightgreen" stroke="black" points="45126,-365 44952,-365 44952,-282 45126,-282 45126,-365"/>
<text text-anchor="middle" x="45039" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU15</text>
<text text-anchor="middle" x="45039" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45039" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45039" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45039" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_5 -->
<g id="edge861" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45300.66,-413.02C45251.66,-400.63 45194.72,-385.01 45135.67,-365.12"/>
<polygon fill="black" stroke="black" points="45136.77,-361.79 45126.18,-361.89 45134.52,-368.42 45136.77,-361.79"/>
</g>
<!-- layer2_expert15_6 -->
<g id="node520" class="node">
<title>layer2_expert15_6</title>
<polygon fill="lightgreen" stroke="black" points="45318,-365 45144,-365 45144,-282 45318,-282 45318,-365"/>
<text text-anchor="middle" x="45231" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU15</text>
<text text-anchor="middle" x="45231" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45231" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45231" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45231" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_6 -->
<g id="edge862" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45356.39,-400.91C45340.15,-391.02 45322.68,-380.37 45306.08,-370.25"/>
<polygon fill="black" stroke="black" points="45307.86,-367.24 45297.5,-365.02 45304.21,-373.21 45307.86,-367.24"/>
</g>
<!-- layer2_expert15_7 -->
<g id="node521" class="node">
<title>layer2_expert15_7</title>
<polygon fill="lightgreen" stroke="black" points="45510,-365 45336,-365 45336,-282 45510,-282 45510,-365"/>
<text text-anchor="middle" x="45423" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU15</text>
<text text-anchor="middle" x="45423" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45423" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45423" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45423" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_7 -->
<g id="edge863" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45423,-400.91C45423,-392.65 45423,-383.86 45423,-375.3"/>
<polygon fill="black" stroke="black" points="45426.5,-375.02 45423,-365.02 45419.5,-375.02 45426.5,-375.02"/>
</g>
<!-- layer2_expert15_8 -->
<g id="node522" class="node">
<title>layer2_expert15_8</title>
<polygon fill="lightgreen" stroke="black" points="45702,-365 45528,-365 45528,-282 45702,-282 45702,-365"/>
<text text-anchor="middle" x="45615" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU15</text>
<text text-anchor="middle" x="45615" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45615" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45615" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45615" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_8 -->
<g id="edge864" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45489.61,-400.91C45505.85,-391.02 45523.32,-380.37 45539.92,-370.25"/>
<polygon fill="black" stroke="black" points="45541.79,-373.21 45548.5,-365.02 45538.14,-367.24 45541.79,-373.21"/>
</g>
<!-- layer2_expert15_9 -->
<g id="node523" class="node">
<title>layer2_expert15_9</title>
<polygon fill="lightgreen" stroke="black" points="45894,-365 45720,-365 45720,-282 45894,-282 45894,-365"/>
<text text-anchor="middle" x="45807" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU15</text>
<text text-anchor="middle" x="45807" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45807" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45807" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45807" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_9 -->
<g id="edge865" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45545.34,-413.02C45594.34,-400.63 45651.28,-385.01 45710.33,-365.12"/>
<polygon fill="black" stroke="black" points="45711.48,-368.42 45719.82,-361.89 45709.23,-361.79 45711.48,-368.42"/>
</g>
<!-- layer2_expert15_10 -->
<g id="node524" class="node">
<title>layer2_expert15_10</title>
<polygon fill="lightgreen" stroke="black" points="46086,-365 45912,-365 45912,-282 46086,-282 46086,-365"/>
<text text-anchor="middle" x="45999" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU15</text>
<text text-anchor="middle" x="45999" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="45999" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="45999" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="45999" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_10 -->
<g id="edge866" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45545.09,-430.26C45640.68,-419.56 45776.63,-400.14 45902.16,-365.05"/>
<polygon fill="black" stroke="black" points="45903.28,-368.37 45911.94,-362.28 45901.37,-361.64 45903.28,-368.37"/>
</g>
<!-- layer2_expert15_11 -->
<g id="node525" class="node">
<title>layer2_expert15_11</title>
<polygon fill="lightgreen" stroke="black" points="46278,-365 46104,-365 46104,-282 46278,-282 46278,-365"/>
<text text-anchor="middle" x="46191" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU15</text>
<text text-anchor="middle" x="46191" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46191" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46191" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46191" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_11 -->
<g id="edge867" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45545.09,-438.05C45678.97,-431.91 45899.54,-414.84 46094.16,-365"/>
<polygon fill="black" stroke="black" points="46095.19,-368.35 46103.99,-362.45 46093.43,-361.57 46095.19,-368.35"/>
</g>
<!-- layer2_expert15_12 -->
<g id="node526" class="node">
<title>layer2_expert15_12</title>
<polygon fill="lightgreen" stroke="black" points="46470,-365 46296,-365 46296,-282 46470,-282 46470,-365"/>
<text text-anchor="middle" x="46383" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU15</text>
<text text-anchor="middle" x="46383" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46383" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46383" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46383" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_12 -->
<g id="edge868" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45545.23,-435.36C45744.75,-424.58 46132.69,-400.2 46286,-364.96"/>
<polygon fill="black" stroke="black" points="46286.84,-368.36 46295.75,-362.63 46285.21,-361.55 46286.84,-368.36"/>
</g>
<!-- layer2_expert15_13 -->
<g id="node527" class="node">
<title>layer2_expert15_13</title>
<polygon fill="lightgreen" stroke="black" points="46662,-365 46488,-365 46488,-282 46662,-282 46662,-365"/>
<text text-anchor="middle" x="46575" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU15</text>
<text text-anchor="middle" x="46575" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46575" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46575" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46575" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_13 -->
<g id="edge869" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45545.08,-437.65C45779.72,-429.46 46286.62,-407.62 46477.81,-364.99"/>
<polygon fill="black" stroke="black" points="46478.81,-368.35 46487.77,-362.69 46477.23,-361.54 46478.81,-368.35"/>
</g>
<!-- layer2_expert15_14 -->
<g id="node528" class="node">
<title>layer2_expert15_14</title>
<polygon fill="lightgreen" stroke="black" points="46854,-365 46680,-365 46680,-282 46854,-282 46854,-365"/>
<text text-anchor="middle" x="46767" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU15</text>
<text text-anchor="middle" x="46767" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46767" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46767" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46767" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_14 -->
<g id="edge870" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45545.18,-439.24C45812.05,-433.47 46440.75,-415.11 46669.83,-364.99"/>
<polygon fill="black" stroke="black" points="46670.8,-368.35 46679.78,-362.73 46669.25,-361.53 46670.8,-368.35"/>
</g>
<!-- layer2_expert15_15 -->
<g id="node529" class="node">
<title>layer2_expert15_15</title>
<polygon fill="lightgreen" stroke="black" points="47046,-365 46872,-365 46872,-282 47046,-282 47046,-365"/>
<text text-anchor="middle" x="46959" y="-349.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU15</text>
<text text-anchor="middle" x="46959" y="-334.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="46959" y="-319.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="46959" y="-304.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="46959" y="-289.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_15 -->
<g id="edge871" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45545.2,-440.41C45841.79,-436.92 46594.41,-422.7 46861.71,-365.01"/>
<polygon fill="black" stroke="black" points="46862.78,-368.35 46871.78,-362.76 46861.26,-361.52 46862.78,-368.35"/>
</g>
<!-- layer2_moe_agg_gpu15 -->
<g id="node530" class="node">
<title>layer2_moe_agg_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="45625,-246 45413,-246 45413,-178 45625,-178 45625,-246"/>
<text text-anchor="middle" x="45519" y="-230.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU15</text>
<text text-anchor="middle" x="45519" y="-215.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="45519" y="-200.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="45519" y="-185.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_expert15_0&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge872" class="edge">
<title>layer2_expert15_0&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M44166.22,-284.23C44169.16,-283.42 44172.09,-282.67 44175,-282 44406.85,-228.87 45120.08,-216.61 45402.3,-213.81"/>
<polygon fill="black" stroke="black" points="45402.6,-217.31 45412.56,-213.71 45402.53,-210.31 45402.6,-217.31"/>
</g>
<!-- layer2_expert15_1&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge873" class="edge">
<title>layer2_expert15_1&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M44358.22,-284.27C44361.16,-283.44 44364.09,-282.68 44367,-282 44561.24,-236.62 45150.24,-220.09 45402.41,-214.98"/>
<polygon fill="black" stroke="black" points="45402.77,-218.48 45412.7,-214.78 45402.63,-211.48 45402.77,-218.48"/>
</g>
<!-- layer2_expert15_2&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge874" class="edge">
<title>layer2_expert15_2&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M44550.23,-284.31C44553.17,-283.47 44556.1,-282.7 44559,-282 44716.05,-244.32 45183.3,-224.2 45402.73,-216.61"/>
<polygon fill="black" stroke="black" points="45403.12,-220.1 45412.99,-216.26 45402.88,-213.1 45403.12,-220.1"/>
</g>
<!-- layer2_expert15_3&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge875" class="edge">
<title>layer2_expert15_3&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M44742.25,-284.38C44745.18,-283.52 44748.1,-282.72 44751,-282 44977.01,-225.63 45250.59,-214.01 45402.66,-212.35"/>
<polygon fill="black" stroke="black" points="45402.98,-215.85 45412.95,-212.25 45402.91,-208.85 45402.98,-215.85"/>
</g>
<!-- layer2_expert15_4&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge876" class="edge">
<title>layer2_expert15_4&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M44934.01,-284.57C44937.03,-283.65 44940.03,-282.79 44943,-282 45098.84,-240.67 45285.02,-224.05 45402.65,-217.4"/>
<polygon fill="black" stroke="black" points="45402.96,-220.88 45412.76,-216.84 45402.58,-213.89 45402.96,-220.88"/>
</g>
<!-- layer2_expert15_5&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge877" class="edge">
<title>layer2_expert15_5&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M45126.08,-284.8C45129.07,-283.81 45132.05,-282.87 45135,-282 45223.09,-255.86 45325.65,-238.04 45402.61,-227.08"/>
<polygon fill="black" stroke="black" points="45403.4,-230.5 45412.82,-225.64 45402.43,-223.57 45403.4,-230.5"/>
</g>
<!-- layer2_expert15_6&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge878" class="edge">
<title>layer2_expert15_6&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M45318.04,-285.54C45321.06,-284.33 45324.05,-283.15 45327,-282 45355.16,-271.01 45385.89,-259.68 45414.34,-249.45"/>
<polygon fill="black" stroke="black" points="45415.66,-252.7 45423.89,-246.03 45413.3,-246.11 45415.66,-252.7"/>
</g>
<!-- layer2_expert15_7&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge879" class="edge">
<title>layer2_expert15_7&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M45458.75,-281.73C45466.66,-272.7 45475.06,-263.12 45482.98,-254.08"/>
<polygon fill="black" stroke="black" points="45485.85,-256.13 45489.81,-246.3 45480.58,-251.51 45485.85,-256.13"/>
</g>
<!-- layer2_expert15_8&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge880" class="edge">
<title>layer2_expert15_8&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M45579.25,-281.73C45571.34,-272.7 45562.94,-263.12 45555.02,-254.08"/>
<polygon fill="black" stroke="black" points="45557.42,-251.51 45548.19,-246.3 45552.15,-256.13 45557.42,-251.51"/>
</g>
<!-- layer2_expert15_9&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge881" class="edge">
<title>layer2_expert15_9&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M45719.96,-285.54C45716.94,-284.33 45713.95,-283.15 45711,-282 45682.84,-271.01 45652.11,-259.68 45623.66,-249.45"/>
<polygon fill="black" stroke="black" points="45624.7,-246.11 45614.11,-246.03 45622.34,-252.7 45624.7,-246.11"/>
</g>
<!-- layer2_expert15_10&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge882" class="edge">
<title>layer2_expert15_10&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M45911.92,-284.8C45908.93,-283.81 45905.95,-282.87 45903,-282 45814.91,-255.86 45712.35,-238.04 45635.39,-227.08"/>
<polygon fill="black" stroke="black" points="45635.57,-223.57 45625.18,-225.64 45634.6,-230.5 45635.57,-223.57"/>
</g>
<!-- layer2_expert15_11&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge883" class="edge">
<title>layer2_expert15_11&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M46103.99,-284.57C46100.97,-283.65 46097.97,-282.79 46095,-282 45939.16,-240.67 45752.98,-224.05 45635.35,-217.4"/>
<polygon fill="black" stroke="black" points="45635.42,-213.89 45625.24,-216.84 45635.04,-220.88 45635.42,-213.89"/>
</g>
<!-- layer2_expert15_12&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge884" class="edge">
<title>layer2_expert15_12&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M46295.75,-284.38C46292.82,-283.52 46289.9,-282.72 46287,-282 46060.99,-225.63 45787.41,-214.01 45635.34,-212.35"/>
<polygon fill="black" stroke="black" points="45635.09,-208.85 45625.05,-212.25 45635.02,-215.85 45635.09,-208.85"/>
</g>
<!-- layer2_expert15_13&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge885" class="edge">
<title>layer2_expert15_13&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M46487.77,-284.31C46484.83,-283.47 46481.9,-282.7 46479,-282 46321.95,-244.32 45854.7,-224.2 45635.27,-216.61"/>
<polygon fill="black" stroke="black" points="45635.12,-213.1 45625.01,-216.26 45634.88,-220.1 45635.12,-213.1"/>
</g>
<!-- layer2_expert15_14&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge886" class="edge">
<title>layer2_expert15_14&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M46679.78,-284.27C46676.84,-283.44 46673.91,-282.68 46671,-282 46476.76,-236.62 45887.76,-220.09 45635.59,-214.98"/>
<polygon fill="black" stroke="black" points="45635.37,-211.48 45625.3,-214.78 45635.23,-218.48 45635.37,-211.48"/>
</g>
<!-- layer2_expert15_15&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge887" class="edge">
<title>layer2_expert15_15&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M46871.78,-284.23C46868.84,-283.42 46865.91,-282.67 46863,-282 46631.15,-228.87 45917.92,-216.61 45635.7,-213.81"/>
<polygon fill="black" stroke="black" points="45635.47,-210.31 45625.44,-213.71 45635.4,-217.31 45635.47,-210.31"/>
</g>
<!-- layer2_output_gpu15 -->
<g id="node531" class="node">
<title>layer2_output_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="45645.5,-142 45392.5,-142 45392.5,-74 45645.5,-74 45645.5,-142"/>
<text text-anchor="middle" x="45519" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="45519" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="45519" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="45519" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_moe_agg_gpu15&#45;&gt;layer2_output_gpu15 -->
<g id="edge888" class="edge">
<title>layer2_moe_agg_gpu15&#45;&gt;layer2_output_gpu15</title>
<path fill="none" stroke="black" d="M45519,-177.88C45519,-169.78 45519,-160.98 45519,-152.47"/>
<polygon fill="black" stroke="black" points="45522.5,-152.3 45519,-142.3 45515.5,-152.3 45522.5,-152.3"/>
</g>
<!-- layer3_qkv_gpu8 -->
<g id="node532" class="node">
<title>layer3_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="49284,-1778.48 49072,-1778.48 49072,-1710.48 49284,-1710.48 49284,-1778.48"/>
<text text-anchor="middle" x="49178" y="-1763.28" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU8</text>
<text text-anchor="middle" x="49178" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="49178" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="49178" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_attn_gpu8 -->
<g id="node533" class="node">
<title>layer3_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="49299.5,-1667 49056.5,-1667 49056.5,-1599 49299.5,-1599 49299.5,-1667"/>
<text text-anchor="middle" x="49178" y="-1651.8" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU8</text>
<text text-anchor="middle" x="49178" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="49178" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="49178" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_qkv_gpu8&#45;&gt;layer3_attn_gpu8 -->
<g id="edge889" class="edge">
<title>layer3_qkv_gpu8&#45;&gt;layer3_attn_gpu8</title>
<path fill="none" stroke="black" d="M49178,-1710.33C49178,-1699.94 49178,-1688.3 49178,-1677.31"/>
<polygon fill="black" stroke="black" points="49181.5,-1677.03 49178,-1667.03 49174.5,-1677.03 49181.5,-1677.03"/>
</g>
<!-- layer3_attn_norm_gpu8 -->
<g id="node534" class="node">
<title>layer3_attn_norm_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="49300,-1563 49056,-1563 49056,-1495 49300,-1495 49300,-1563"/>
<text text-anchor="middle" x="49178" y="-1547.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="49178" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="49178" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="49178" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_attn_gpu8&#45;&gt;layer3_attn_norm_gpu8 -->
<g id="edge890" class="edge">
<title>layer3_attn_gpu8&#45;&gt;layer3_attn_norm_gpu8</title>
<path fill="none" stroke="black" d="M49178,-1598.88C49178,-1590.78 49178,-1581.98 49178,-1573.47"/>
<polygon fill="black" stroke="black" points="49181.5,-1573.3 49178,-1563.3 49174.5,-1573.3 49181.5,-1573.3"/>
</g>
<!-- layer3_gate_gpu8 -->
<g id="node535" class="node">
<title>layer3_gate_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="49300,-1459 49056,-1459 49056,-1376 49300,-1376 49300,-1459"/>
<text text-anchor="middle" x="49178" y="-1443.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU8</text>
<text text-anchor="middle" x="49178" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="49178" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="49178" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="49178" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_attn_norm_gpu8&#45;&gt;layer3_gate_gpu8 -->
<g id="edge891" class="edge">
<title>layer3_attn_norm_gpu8&#45;&gt;layer3_gate_gpu8</title>
<path fill="none" stroke="black" d="M49178,-1494.85C49178,-1486.8 49178,-1478 49178,-1469.34"/>
<polygon fill="black" stroke="black" points="49181.5,-1469.28 49178,-1459.28 49174.5,-1469.28 49181.5,-1469.28"/>
</g>
<!-- layer3_expert8_0 -->
<g id="node536" class="node">
<title>layer3_expert8_0</title>
<polygon fill="lightgreen" stroke="black" points="47825,-1340 47651,-1340 47651,-1257 47825,-1257 47825,-1340"/>
<text text-anchor="middle" x="47738" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU8</text>
<text text-anchor="middle" x="47738" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="47738" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="47738" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="47738" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_0 -->
<g id="edge892" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49055.85,-1414.87C48773.89,-1410.26 48083.51,-1393.9 47835.29,-1340.01"/>
<polygon fill="black" stroke="black" points="47835.75,-1336.52 47825.22,-1337.75 47834.21,-1343.35 47835.75,-1336.52"/>
</g>
<!-- layer3_expert8_1 -->
<g id="node537" class="node">
<title>layer3_expert8_1</title>
<polygon fill="lightgreen" stroke="black" points="48017,-1340 47843,-1340 47843,-1257 48017,-1257 48017,-1340"/>
<text text-anchor="middle" x="47930" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU8</text>
<text text-anchor="middle" x="47930" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="47930" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="47930" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="47930" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_1 -->
<g id="edge893" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49055.68,-1413.51C48804.53,-1406.54 48237.38,-1386.35 48027.26,-1340.01"/>
<polygon fill="black" stroke="black" points="48027.76,-1336.53 48017.23,-1337.71 48026.2,-1343.35 48027.76,-1336.53"/>
</g>
<!-- layer3_expert8_2 -->
<g id="node538" class="node">
<title>layer3_expert8_2</title>
<polygon fill="lightgreen" stroke="black" points="48209,-1340 48035,-1340 48035,-1257 48209,-1257 48209,-1340"/>
<text text-anchor="middle" x="48122" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU8</text>
<text text-anchor="middle" x="48122" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="48122" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="48122" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="48122" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_2 -->
<g id="edge894" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49055.94,-1411.63C48838.49,-1402.15 48391.52,-1378.91 48219.21,-1340"/>
<polygon fill="black" stroke="black" points="48219.78,-1336.54 48209.24,-1337.66 48218.17,-1343.36 48219.78,-1336.54"/>
</g>
<!-- layer3_expert8_3 -->
<g id="node539" class="node">
<title>layer3_expert8_3</title>
<polygon fill="lightgreen" stroke="black" points="48401,-1340 48227,-1340 48227,-1257 48401,-1257 48401,-1340"/>
<text text-anchor="middle" x="48314" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU8</text>
<text text-anchor="middle" x="48314" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="48314" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="48314" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="48314" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_3 -->
<g id="edge895" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49055.67,-1415.54C48904.64,-1411.85 48640.63,-1397.19 48411.13,-1340.07"/>
<polygon fill="black" stroke="black" points="48411.81,-1336.63 48401.26,-1337.58 48410.1,-1343.42 48411.81,-1336.63"/>
</g>
<!-- layer3_expert8_4 -->
<g id="node540" class="node">
<title>layer3_expert8_4</title>
<polygon fill="lightgreen" stroke="black" points="48593,-1340 48419,-1340 48419,-1257 48593,-1257 48593,-1340"/>
<text text-anchor="middle" x="48506" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU8</text>
<text text-anchor="middle" x="48506" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="48506" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="48506" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="48506" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_4 -->
<g id="edge896" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49055.89,-1409.76C48940.42,-1401.23 48762.78,-1382.5 48603.04,-1340.07"/>
<polygon fill="black" stroke="black" points="48603.59,-1336.6 48593.03,-1337.38 48601.77,-1343.36 48603.59,-1336.6"/>
</g>
<!-- layer3_expert8_5 -->
<g id="node541" class="node">
<title>layer3_expert8_5</title>
<polygon fill="lightgreen" stroke="black" points="48785,-1340 48611,-1340 48611,-1257 48785,-1257 48785,-1340"/>
<text text-anchor="middle" x="48698" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU8</text>
<text text-anchor="middle" x="48698" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="48698" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="48698" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="48698" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_5 -->
<g id="edge897" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49055.8,-1398.65C48982.17,-1386.36 48886.72,-1367.72 48794.84,-1340.09"/>
<polygon fill="black" stroke="black" points="48795.69,-1336.69 48785.1,-1337.13 48793.65,-1343.39 48795.69,-1336.69"/>
</g>
<!-- layer3_expert8_6 -->
<g id="node542" class="node">
<title>layer3_expert8_6</title>
<polygon fill="lightgreen" stroke="black" points="48977,-1340 48803,-1340 48803,-1257 48977,-1257 48977,-1340"/>
<text text-anchor="middle" x="48890" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU8</text>
<text text-anchor="middle" x="48890" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="48890" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="48890" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="48890" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_6 -->
<g id="edge898" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49075.21,-1375.99C49048.79,-1365.46 49020.27,-1354.01 48986.69,-1340.27"/>
<polygon fill="black" stroke="black" points="48987.67,-1336.88 48977.09,-1336.33 48985.01,-1343.36 48987.67,-1336.88"/>
</g>
<!-- layer3_expert8_7 -->
<g id="node543" class="node">
<title>layer3_expert8_7</title>
<polygon fill="lightgreen" stroke="black" points="49169,-1340 48995,-1340 48995,-1257 49169,-1257 49169,-1340"/>
<text text-anchor="middle" x="49082" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU8</text>
<text text-anchor="middle" x="49082" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="49082" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="49082" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="49082" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_7 -->
<g id="edge899" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49144.69,-1375.91C49137.25,-1366.83 49129.28,-1357.12 49121.61,-1347.77"/>
<polygon fill="black" stroke="black" points="49124.3,-1345.53 49115.25,-1340.02 49118.89,-1349.97 49124.3,-1345.53"/>
</g>
<!-- layer3_expert8_8 -->
<g id="node544" class="node">
<title>layer3_expert8_8</title>
<polygon fill="lightgreen" stroke="black" points="49361,-1340 49187,-1340 49187,-1257 49361,-1257 49361,-1340"/>
<text text-anchor="middle" x="49274" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU8</text>
<text text-anchor="middle" x="49274" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="49274" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="49274" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="49274" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_8 -->
<g id="edge900" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49211.31,-1375.91C49218.75,-1366.83 49226.72,-1357.12 49234.39,-1347.77"/>
<polygon fill="black" stroke="black" points="49237.11,-1349.97 49240.75,-1340.02 49231.7,-1345.53 49237.11,-1349.97"/>
</g>
<!-- layer3_expert8_9 -->
<g id="node545" class="node">
<title>layer3_expert8_9</title>
<polygon fill="lightgreen" stroke="black" points="49553,-1340 49379,-1340 49379,-1257 49553,-1257 49553,-1340"/>
<text text-anchor="middle" x="49466" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU8</text>
<text text-anchor="middle" x="49466" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="49466" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="49466" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="49466" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_9 -->
<g id="edge901" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49280.79,-1375.99C49307.21,-1365.46 49335.73,-1354.01 49369.31,-1340.27"/>
<polygon fill="black" stroke="black" points="49370.99,-1343.36 49378.91,-1336.33 49368.33,-1336.88 49370.99,-1343.36"/>
</g>
<!-- layer3_expert8_10 -->
<g id="node546" class="node">
<title>layer3_expert8_10</title>
<polygon fill="lightgreen" stroke="black" points="49745,-1340 49571,-1340 49571,-1257 49745,-1257 49745,-1340"/>
<text text-anchor="middle" x="49658" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU8</text>
<text text-anchor="middle" x="49658" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="49658" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="49658" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="49658" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_10 -->
<g id="edge902" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49300.2,-1398.65C49373.83,-1386.36 49469.28,-1367.72 49561.16,-1340.09"/>
<polygon fill="black" stroke="black" points="49562.35,-1343.39 49570.9,-1337.13 49560.31,-1336.69 49562.35,-1343.39"/>
</g>
<!-- layer3_expert8_11 -->
<g id="node547" class="node">
<title>layer3_expert8_11</title>
<polygon fill="lightgreen" stroke="black" points="49937,-1340 49763,-1340 49763,-1257 49937,-1257 49937,-1340"/>
<text text-anchor="middle" x="49850" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU8</text>
<text text-anchor="middle" x="49850" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="49850" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="49850" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="49850" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_11 -->
<g id="edge903" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49300.11,-1409.76C49415.58,-1401.23 49593.22,-1382.5 49752.96,-1340.07"/>
<polygon fill="black" stroke="black" points="49754.23,-1343.36 49762.97,-1337.38 49752.41,-1336.6 49754.23,-1343.36"/>
</g>
<!-- layer3_expert8_12 -->
<g id="node548" class="node">
<title>layer3_expert8_12</title>
<polygon fill="lightgreen" stroke="black" points="50129,-1340 49955,-1340 49955,-1257 50129,-1257 50129,-1340"/>
<text text-anchor="middle" x="50042" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU8</text>
<text text-anchor="middle" x="50042" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="50042" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="50042" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="50042" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_12 -->
<g id="edge904" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49300.33,-1415.54C49451.36,-1411.85 49715.37,-1397.19 49944.87,-1340.07"/>
<polygon fill="black" stroke="black" points="49945.9,-1343.42 49954.74,-1337.58 49944.19,-1336.63 49945.9,-1343.42"/>
</g>
<!-- layer3_expert8_13 -->
<g id="node549" class="node">
<title>layer3_expert8_13</title>
<polygon fill="lightgreen" stroke="black" points="50321,-1340 50147,-1340 50147,-1257 50321,-1257 50321,-1340"/>
<text text-anchor="middle" x="50234" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU8</text>
<text text-anchor="middle" x="50234" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="50234" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="50234" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="50234" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_13 -->
<g id="edge905" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49300.06,-1411.63C49517.51,-1402.15 49964.48,-1378.91 50136.79,-1340"/>
<polygon fill="black" stroke="black" points="50137.83,-1343.36 50146.76,-1337.66 50136.22,-1336.54 50137.83,-1343.36"/>
</g>
<!-- layer3_expert8_14 -->
<g id="node550" class="node">
<title>layer3_expert8_14</title>
<polygon fill="lightgreen" stroke="black" points="50513,-1340 50339,-1340 50339,-1257 50513,-1257 50513,-1340"/>
<text text-anchor="middle" x="50426" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU8</text>
<text text-anchor="middle" x="50426" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="50426" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="50426" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="50426" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_14 -->
<g id="edge906" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49300.32,-1413.51C49551.47,-1406.54 50118.62,-1386.35 50328.74,-1340.01"/>
<polygon fill="black" stroke="black" points="50329.8,-1343.35 50338.77,-1337.71 50328.24,-1336.53 50329.8,-1343.35"/>
</g>
<!-- layer3_expert8_15 -->
<g id="node551" class="node">
<title>layer3_expert8_15</title>
<polygon fill="lightgreen" stroke="black" points="50705,-1340 50531,-1340 50531,-1257 50705,-1257 50705,-1340"/>
<text text-anchor="middle" x="50618" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU8</text>
<text text-anchor="middle" x="50618" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="50618" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="50618" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="50618" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_15 -->
<g id="edge907" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49300.15,-1414.87C49582.11,-1410.26 50272.49,-1393.9 50520.71,-1340.01"/>
<polygon fill="black" stroke="black" points="50521.79,-1343.35 50530.78,-1337.75 50520.25,-1336.52 50521.79,-1343.35"/>
</g>
<!-- layer3_moe_agg_gpu8 -->
<g id="node552" class="node">
<title>layer3_moe_agg_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="49375.5,-1213.5 49172.5,-1213.5 49172.5,-1145.5 49375.5,-1145.5 49375.5,-1213.5"/>
<text text-anchor="middle" x="49274" y="-1198.3" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU8</text>
<text text-anchor="middle" x="49274" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="49274" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="49274" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_expert8_0&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge908" class="edge">
<title>layer3_expert8_0&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M47825.22,-1259.24C47828.16,-1258.42 47831.09,-1257.67 47834,-1257 48086.04,-1199.01 48869.23,-1184.79 49162.04,-1181.47"/>
<polygon fill="black" stroke="black" points="49162.29,-1184.97 49172.25,-1181.35 49162.21,-1177.97 49162.29,-1184.97"/>
</g>
<!-- layer3_expert8_1&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge909" class="edge">
<title>layer3_expert8_1&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M48017.22,-1259.27C48020.16,-1258.44 48023.09,-1257.68 48026,-1257 48240.27,-1206.78 48898.06,-1188.12 49162.35,-1182.53"/>
<polygon fill="black" stroke="black" points="49162.42,-1186.03 49172.35,-1182.32 49162.28,-1179.03 49162.42,-1186.03"/>
</g>
<!-- layer3_expert8_2&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge910" class="edge">
<title>layer3_expert8_2&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M48209.23,-1259.31C48212.17,-1258.47 48215.1,-1257.7 48218,-1257 48394.66,-1214.56 48928.19,-1192.05 49162.08,-1183.99"/>
<polygon fill="black" stroke="black" points="49162.44,-1187.48 49172.31,-1183.64 49162.2,-1180.49 49162.44,-1187.48"/>
</g>
<!-- layer3_expert8_3&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge911" class="edge">
<title>layer3_expert8_3&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M48401.25,-1259.37C48404.18,-1258.52 48407.1,-1257.72 48410,-1257 48549.51,-1222.3 48961.52,-1196.81 49161.96,-1186.09"/>
<polygon fill="black" stroke="black" points="49162.42,-1189.57 49172.22,-1185.54 49162.04,-1182.58 49162.42,-1189.57"/>
</g>
<!-- layer3_expert8_4&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge912" class="edge">
<title>layer3_expert8_4&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M48593.01,-1259.55C48596.02,-1258.63 48599.03,-1257.78 48602,-1257 48794.76,-1206.49 49027.26,-1189.33 49162.11,-1183.5"/>
<polygon fill="black" stroke="black" points="49162.6,-1186.98 49172.45,-1183.07 49162.31,-1179.99 49162.6,-1186.98"/>
</g>
<!-- layer3_expert8_5&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge913" class="edge">
<title>layer3_expert8_5&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M48785.06,-1259.72C48788.06,-1258.76 48791.04,-1257.85 48794,-1257 48917.54,-1221.66 49063.93,-1201.29 49162.29,-1190.59"/>
<polygon fill="black" stroke="black" points="49162.68,-1194.07 49172.25,-1189.53 49161.94,-1187.11 49162.68,-1194.07"/>
</g>
<!-- layer3_expert8_6&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge914" class="edge">
<title>layer3_expert8_6&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M48977.18,-1260.11C48980.14,-1259.04 48983.09,-1257.99 48986,-1257 49043.37,-1237.38 49108.58,-1219.7 49162.42,-1206.28"/>
<polygon fill="black" stroke="black" points="49163.47,-1209.63 49172.34,-1203.83 49161.79,-1202.83 49163.47,-1209.63"/>
</g>
<!-- layer3_expert8_7&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge915" class="edge">
<title>layer3_expert8_7&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M49148.61,-1256.91C49168.8,-1244.6 49190.91,-1231.13 49210.87,-1218.97"/>
<polygon fill="black" stroke="black" points="49212.85,-1221.86 49219.57,-1213.67 49209.21,-1215.88 49212.85,-1221.86"/>
</g>
<!-- layer3_expert8_8&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge916" class="edge">
<title>layer3_expert8_8&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M49274,-1256.91C49274,-1246.2 49274,-1234.62 49274,-1223.78"/>
<polygon fill="black" stroke="black" points="49277.5,-1223.67 49274,-1213.67 49270.5,-1223.67 49277.5,-1223.67"/>
</g>
<!-- layer3_expert8_9&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge917" class="edge">
<title>layer3_expert8_9&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M49399.39,-1256.91C49379.2,-1244.6 49357.09,-1231.13 49337.13,-1218.97"/>
<polygon fill="black" stroke="black" points="49338.79,-1215.88 49328.43,-1213.67 49335.15,-1221.86 49338.79,-1215.88"/>
</g>
<!-- layer3_expert8_10&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge918" class="edge">
<title>layer3_expert8_10&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M49570.82,-1260.11C49567.86,-1259.04 49564.91,-1257.99 49562,-1257 49504.63,-1237.38 49439.42,-1219.7 49385.58,-1206.28"/>
<polygon fill="black" stroke="black" points="49386.21,-1202.83 49375.66,-1203.83 49384.53,-1209.63 49386.21,-1202.83"/>
</g>
<!-- layer3_expert8_11&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge919" class="edge">
<title>layer3_expert8_11&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M49762.94,-1259.72C49759.94,-1258.76 49756.96,-1257.85 49754,-1257 49630.46,-1221.66 49484.07,-1201.29 49385.71,-1190.59"/>
<polygon fill="black" stroke="black" points="49386.06,-1187.11 49375.75,-1189.53 49385.32,-1194.07 49386.06,-1187.11"/>
</g>
<!-- layer3_expert8_12&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge920" class="edge">
<title>layer3_expert8_12&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M49954.99,-1259.55C49951.98,-1258.63 49948.97,-1257.78 49946,-1257 49753.24,-1206.49 49520.74,-1189.33 49385.89,-1183.5"/>
<polygon fill="black" stroke="black" points="49385.69,-1179.99 49375.55,-1183.07 49385.4,-1186.98 49385.69,-1179.99"/>
</g>
<!-- layer3_expert8_13&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge921" class="edge">
<title>layer3_expert8_13&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M50146.75,-1259.37C50143.82,-1258.52 50140.9,-1257.72 50138,-1257 49998.49,-1222.3 49586.48,-1196.81 49386.04,-1186.09"/>
<polygon fill="black" stroke="black" points="49385.96,-1182.58 49375.78,-1185.54 49385.58,-1189.57 49385.96,-1182.58"/>
</g>
<!-- layer3_expert8_14&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge922" class="edge">
<title>layer3_expert8_14&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M50338.77,-1259.31C50335.83,-1258.47 50332.9,-1257.7 50330,-1257 50153.34,-1214.56 49619.81,-1192.05 49385.92,-1183.99"/>
<polygon fill="black" stroke="black" points="49385.8,-1180.49 49375.69,-1183.64 49385.56,-1187.48 49385.8,-1180.49"/>
</g>
<!-- layer3_expert8_15&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge923" class="edge">
<title>layer3_expert8_15&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M50530.78,-1259.27C50527.84,-1258.44 50524.91,-1257.68 50522,-1257 50307.73,-1206.78 49649.94,-1188.12 49385.65,-1182.53"/>
<polygon fill="black" stroke="black" points="49385.72,-1179.03 49375.65,-1182.32 49385.58,-1186.03 49385.72,-1179.03"/>
</g>
<!-- layer3_output_gpu8 -->
<g id="node553" class="node">
<title>layer3_output_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="50801,-1102 50557,-1102 50557,-1034 50801,-1034 50801,-1102"/>
<text text-anchor="middle" x="50679" y="-1086.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="50679" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="50679" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="50679" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_moe_agg_gpu8&#45;&gt;layer3_output_gpu8 -->
<g id="edge924" class="edge">
<title>layer3_moe_agg_gpu8&#45;&gt;layer3_output_gpu8</title>
<path fill="none" stroke="black" d="M49375.61,-1170.58C49625.14,-1151.13 50267.95,-1101.04 50546.74,-1079.31"/>
<polygon fill="black" stroke="black" points="50547.21,-1082.78 50556.91,-1078.52 50546.67,-1075.8 50547.21,-1082.78"/>
</g>
<!-- output -->
<g id="node709" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="59929" cy="-915" rx="292.07" ry="37.45"/>
<text text-anchor="middle" x="59929" y="-926.3" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="59929" y="-911.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="59929" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_output_gpu8&#45;&gt;output -->
<g id="edge1177" class="edge">
<title>layer3_output_gpu8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M50801.05,-1065.01C51765.91,-1049.26 58163.94,-944.81 59630.03,-920.88"/>
<polygon fill="black" stroke="black" points="59630.24,-924.38 59640.18,-920.71 59630.12,-917.38 59630.24,-924.38"/>
</g>
<!-- layer3_qkv_gpu9 -->
<g id="node554" class="node">
<title>layer3_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="52356,-1778.48 52144,-1778.48 52144,-1710.48 52356,-1710.48 52356,-1778.48"/>
<text text-anchor="middle" x="52250" y="-1763.28" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU9</text>
<text text-anchor="middle" x="52250" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="52250" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="52250" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_attn_gpu9 -->
<g id="node555" class="node">
<title>layer3_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="52371.5,-1667 52128.5,-1667 52128.5,-1599 52371.5,-1599 52371.5,-1667"/>
<text text-anchor="middle" x="52250" y="-1651.8" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU9</text>
<text text-anchor="middle" x="52250" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="52250" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="52250" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_qkv_gpu9&#45;&gt;layer3_attn_gpu9 -->
<g id="edge925" class="edge">
<title>layer3_qkv_gpu9&#45;&gt;layer3_attn_gpu9</title>
<path fill="none" stroke="black" d="M52250,-1710.33C52250,-1699.94 52250,-1688.3 52250,-1677.31"/>
<polygon fill="black" stroke="black" points="52253.5,-1677.03 52250,-1667.03 52246.5,-1677.03 52253.5,-1677.03"/>
</g>
<!-- layer3_attn_norm_gpu9 -->
<g id="node556" class="node">
<title>layer3_attn_norm_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="52372,-1563 52128,-1563 52128,-1495 52372,-1495 52372,-1563"/>
<text text-anchor="middle" x="52250" y="-1547.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="52250" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="52250" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="52250" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_attn_gpu9&#45;&gt;layer3_attn_norm_gpu9 -->
<g id="edge926" class="edge">
<title>layer3_attn_gpu9&#45;&gt;layer3_attn_norm_gpu9</title>
<path fill="none" stroke="black" d="M52250,-1598.88C52250,-1590.78 52250,-1581.98 52250,-1573.47"/>
<polygon fill="black" stroke="black" points="52253.5,-1573.3 52250,-1563.3 52246.5,-1573.3 52253.5,-1573.3"/>
</g>
<!-- layer3_gate_gpu9 -->
<g id="node557" class="node">
<title>layer3_gate_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="52372,-1459 52128,-1459 52128,-1376 52372,-1376 52372,-1459"/>
<text text-anchor="middle" x="52250" y="-1443.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU9</text>
<text text-anchor="middle" x="52250" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="52250" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="52250" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="52250" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_attn_norm_gpu9&#45;&gt;layer3_gate_gpu9 -->
<g id="edge927" class="edge">
<title>layer3_attn_norm_gpu9&#45;&gt;layer3_gate_gpu9</title>
<path fill="none" stroke="black" d="M52250,-1494.85C52250,-1486.8 52250,-1478 52250,-1469.34"/>
<polygon fill="black" stroke="black" points="52253.5,-1469.28 52250,-1459.28 52246.5,-1469.28 52253.5,-1469.28"/>
</g>
<!-- layer3_expert9_0 -->
<g id="node558" class="node">
<title>layer3_expert9_0</title>
<polygon fill="lightgreen" stroke="black" points="50897,-1340 50723,-1340 50723,-1257 50897,-1257 50897,-1340"/>
<text text-anchor="middle" x="50810" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU9</text>
<text text-anchor="middle" x="50810" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="50810" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="50810" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="50810" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_0 -->
<g id="edge928" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52127.85,-1414.87C51845.89,-1410.26 51155.51,-1393.9 50907.29,-1340.01"/>
<polygon fill="black" stroke="black" points="50907.75,-1336.52 50897.22,-1337.75 50906.21,-1343.35 50907.75,-1336.52"/>
</g>
<!-- layer3_expert9_1 -->
<g id="node559" class="node">
<title>layer3_expert9_1</title>
<polygon fill="lightgreen" stroke="black" points="51089,-1340 50915,-1340 50915,-1257 51089,-1257 51089,-1340"/>
<text text-anchor="middle" x="51002" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU9</text>
<text text-anchor="middle" x="51002" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="51002" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="51002" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="51002" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_1 -->
<g id="edge929" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52127.68,-1413.51C51876.53,-1406.54 51309.38,-1386.35 51099.26,-1340.01"/>
<polygon fill="black" stroke="black" points="51099.76,-1336.53 51089.23,-1337.71 51098.2,-1343.35 51099.76,-1336.53"/>
</g>
<!-- layer3_expert9_2 -->
<g id="node560" class="node">
<title>layer3_expert9_2</title>
<polygon fill="lightgreen" stroke="black" points="51281,-1340 51107,-1340 51107,-1257 51281,-1257 51281,-1340"/>
<text text-anchor="middle" x="51194" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU9</text>
<text text-anchor="middle" x="51194" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="51194" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="51194" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="51194" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_2 -->
<g id="edge930" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52127.94,-1411.63C51910.49,-1402.15 51463.52,-1378.91 51291.21,-1340"/>
<polygon fill="black" stroke="black" points="51291.78,-1336.54 51281.24,-1337.66 51290.17,-1343.36 51291.78,-1336.54"/>
</g>
<!-- layer3_expert9_3 -->
<g id="node561" class="node">
<title>layer3_expert9_3</title>
<polygon fill="lightgreen" stroke="black" points="51473,-1340 51299,-1340 51299,-1257 51473,-1257 51473,-1340"/>
<text text-anchor="middle" x="51386" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU9</text>
<text text-anchor="middle" x="51386" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="51386" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="51386" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="51386" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_3 -->
<g id="edge931" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52127.67,-1415.54C51976.64,-1411.85 51712.63,-1397.19 51483.13,-1340.07"/>
<polygon fill="black" stroke="black" points="51483.81,-1336.63 51473.26,-1337.58 51482.1,-1343.42 51483.81,-1336.63"/>
</g>
<!-- layer3_expert9_4 -->
<g id="node562" class="node">
<title>layer3_expert9_4</title>
<polygon fill="lightgreen" stroke="black" points="51665,-1340 51491,-1340 51491,-1257 51665,-1257 51665,-1340"/>
<text text-anchor="middle" x="51578" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU9</text>
<text text-anchor="middle" x="51578" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="51578" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="51578" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="51578" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_4 -->
<g id="edge932" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52127.89,-1409.76C52012.42,-1401.23 51834.78,-1382.5 51675.04,-1340.07"/>
<polygon fill="black" stroke="black" points="51675.59,-1336.6 51665.03,-1337.38 51673.77,-1343.36 51675.59,-1336.6"/>
</g>
<!-- layer3_expert9_5 -->
<g id="node563" class="node">
<title>layer3_expert9_5</title>
<polygon fill="lightgreen" stroke="black" points="51857,-1340 51683,-1340 51683,-1257 51857,-1257 51857,-1340"/>
<text text-anchor="middle" x="51770" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU9</text>
<text text-anchor="middle" x="51770" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="51770" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="51770" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="51770" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_5 -->
<g id="edge933" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52127.8,-1398.65C52054.17,-1386.36 51958.72,-1367.72 51866.84,-1340.09"/>
<polygon fill="black" stroke="black" points="51867.69,-1336.69 51857.1,-1337.13 51865.65,-1343.39 51867.69,-1336.69"/>
</g>
<!-- layer3_expert9_6 -->
<g id="node564" class="node">
<title>layer3_expert9_6</title>
<polygon fill="lightgreen" stroke="black" points="52049,-1340 51875,-1340 51875,-1257 52049,-1257 52049,-1340"/>
<text text-anchor="middle" x="51962" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU9</text>
<text text-anchor="middle" x="51962" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="51962" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="51962" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="51962" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_6 -->
<g id="edge934" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52147.21,-1375.99C52120.79,-1365.46 52092.27,-1354.01 52058.69,-1340.27"/>
<polygon fill="black" stroke="black" points="52059.67,-1336.88 52049.09,-1336.33 52057.01,-1343.36 52059.67,-1336.88"/>
</g>
<!-- layer3_expert9_7 -->
<g id="node565" class="node">
<title>layer3_expert9_7</title>
<polygon fill="lightgreen" stroke="black" points="52241,-1340 52067,-1340 52067,-1257 52241,-1257 52241,-1340"/>
<text text-anchor="middle" x="52154" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU9</text>
<text text-anchor="middle" x="52154" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="52154" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="52154" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="52154" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_7 -->
<g id="edge935" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52216.69,-1375.91C52209.25,-1366.83 52201.28,-1357.12 52193.61,-1347.77"/>
<polygon fill="black" stroke="black" points="52196.3,-1345.53 52187.25,-1340.02 52190.89,-1349.97 52196.3,-1345.53"/>
</g>
<!-- layer3_expert9_8 -->
<g id="node566" class="node">
<title>layer3_expert9_8</title>
<polygon fill="lightgreen" stroke="black" points="52433,-1340 52259,-1340 52259,-1257 52433,-1257 52433,-1340"/>
<text text-anchor="middle" x="52346" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU9</text>
<text text-anchor="middle" x="52346" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="52346" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="52346" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="52346" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_8 -->
<g id="edge936" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52283.31,-1375.91C52290.75,-1366.83 52298.72,-1357.12 52306.39,-1347.77"/>
<polygon fill="black" stroke="black" points="52309.11,-1349.97 52312.75,-1340.02 52303.7,-1345.53 52309.11,-1349.97"/>
</g>
<!-- layer3_expert9_9 -->
<g id="node567" class="node">
<title>layer3_expert9_9</title>
<polygon fill="lightgreen" stroke="black" points="52625,-1340 52451,-1340 52451,-1257 52625,-1257 52625,-1340"/>
<text text-anchor="middle" x="52538" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU9</text>
<text text-anchor="middle" x="52538" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="52538" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="52538" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="52538" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_9 -->
<g id="edge937" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52352.79,-1375.99C52379.21,-1365.46 52407.73,-1354.01 52441.31,-1340.27"/>
<polygon fill="black" stroke="black" points="52442.99,-1343.36 52450.91,-1336.33 52440.33,-1336.88 52442.99,-1343.36"/>
</g>
<!-- layer3_expert9_10 -->
<g id="node568" class="node">
<title>layer3_expert9_10</title>
<polygon fill="lightgreen" stroke="black" points="52817,-1340 52643,-1340 52643,-1257 52817,-1257 52817,-1340"/>
<text text-anchor="middle" x="52730" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU9</text>
<text text-anchor="middle" x="52730" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="52730" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="52730" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="52730" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_10 -->
<g id="edge938" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52372.2,-1398.65C52445.83,-1386.36 52541.28,-1367.72 52633.16,-1340.09"/>
<polygon fill="black" stroke="black" points="52634.35,-1343.39 52642.9,-1337.13 52632.31,-1336.69 52634.35,-1343.39"/>
</g>
<!-- layer3_expert9_11 -->
<g id="node569" class="node">
<title>layer3_expert9_11</title>
<polygon fill="lightgreen" stroke="black" points="53009,-1340 52835,-1340 52835,-1257 53009,-1257 53009,-1340"/>
<text text-anchor="middle" x="52922" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU9</text>
<text text-anchor="middle" x="52922" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="52922" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="52922" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="52922" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_11 -->
<g id="edge939" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52372.11,-1409.76C52487.58,-1401.23 52665.22,-1382.5 52824.96,-1340.07"/>
<polygon fill="black" stroke="black" points="52826.23,-1343.36 52834.97,-1337.38 52824.41,-1336.6 52826.23,-1343.36"/>
</g>
<!-- layer3_expert9_12 -->
<g id="node570" class="node">
<title>layer3_expert9_12</title>
<polygon fill="lightgreen" stroke="black" points="53201,-1340 53027,-1340 53027,-1257 53201,-1257 53201,-1340"/>
<text text-anchor="middle" x="53114" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU9</text>
<text text-anchor="middle" x="53114" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="53114" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="53114" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="53114" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_12 -->
<g id="edge940" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52372.33,-1415.54C52523.36,-1411.85 52787.37,-1397.19 53016.87,-1340.07"/>
<polygon fill="black" stroke="black" points="53017.9,-1343.42 53026.74,-1337.58 53016.19,-1336.63 53017.9,-1343.42"/>
</g>
<!-- layer3_expert9_13 -->
<g id="node571" class="node">
<title>layer3_expert9_13</title>
<polygon fill="lightgreen" stroke="black" points="53393,-1340 53219,-1340 53219,-1257 53393,-1257 53393,-1340"/>
<text text-anchor="middle" x="53306" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU9</text>
<text text-anchor="middle" x="53306" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="53306" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="53306" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="53306" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_13 -->
<g id="edge941" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52372.06,-1411.63C52589.51,-1402.15 53036.48,-1378.91 53208.79,-1340"/>
<polygon fill="black" stroke="black" points="53209.83,-1343.36 53218.76,-1337.66 53208.22,-1336.54 53209.83,-1343.36"/>
</g>
<!-- layer3_expert9_14 -->
<g id="node572" class="node">
<title>layer3_expert9_14</title>
<polygon fill="lightgreen" stroke="black" points="53585,-1340 53411,-1340 53411,-1257 53585,-1257 53585,-1340"/>
<text text-anchor="middle" x="53498" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU9</text>
<text text-anchor="middle" x="53498" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="53498" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="53498" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="53498" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_14 -->
<g id="edge942" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52372.32,-1413.51C52623.47,-1406.54 53190.62,-1386.35 53400.74,-1340.01"/>
<polygon fill="black" stroke="black" points="53401.8,-1343.35 53410.77,-1337.71 53400.24,-1336.53 53401.8,-1343.35"/>
</g>
<!-- layer3_expert9_15 -->
<g id="node573" class="node">
<title>layer3_expert9_15</title>
<polygon fill="lightgreen" stroke="black" points="53777,-1340 53603,-1340 53603,-1257 53777,-1257 53777,-1340"/>
<text text-anchor="middle" x="53690" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU9</text>
<text text-anchor="middle" x="53690" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="53690" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="53690" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="53690" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_15 -->
<g id="edge943" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52372.15,-1414.87C52654.11,-1410.26 53344.49,-1393.9 53592.71,-1340.01"/>
<polygon fill="black" stroke="black" points="53593.79,-1343.35 53602.78,-1337.75 53592.25,-1336.52 53593.79,-1343.35"/>
</g>
<!-- layer3_moe_agg_gpu9 -->
<g id="node574" class="node">
<title>layer3_moe_agg_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="52447.5,-1213.5 52244.5,-1213.5 52244.5,-1145.5 52447.5,-1145.5 52447.5,-1213.5"/>
<text text-anchor="middle" x="52346" y="-1198.3" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU9</text>
<text text-anchor="middle" x="52346" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="52346" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="52346" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_expert9_0&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge944" class="edge">
<title>layer3_expert9_0&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M50897.22,-1259.24C50900.16,-1258.42 50903.09,-1257.67 50906,-1257 51158.04,-1199.01 51941.23,-1184.79 52234.04,-1181.47"/>
<polygon fill="black" stroke="black" points="52234.29,-1184.97 52244.25,-1181.35 52234.21,-1177.97 52234.29,-1184.97"/>
</g>
<!-- layer3_expert9_1&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge945" class="edge">
<title>layer3_expert9_1&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M51089.22,-1259.27C51092.16,-1258.44 51095.09,-1257.68 51098,-1257 51312.27,-1206.78 51970.06,-1188.12 52234.35,-1182.53"/>
<polygon fill="black" stroke="black" points="52234.42,-1186.03 52244.35,-1182.32 52234.28,-1179.03 52234.42,-1186.03"/>
</g>
<!-- layer3_expert9_2&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge946" class="edge">
<title>layer3_expert9_2&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M51281.23,-1259.31C51284.17,-1258.47 51287.1,-1257.7 51290,-1257 51466.66,-1214.56 52000.19,-1192.05 52234.08,-1183.99"/>
<polygon fill="black" stroke="black" points="52234.44,-1187.48 52244.31,-1183.64 52234.2,-1180.49 52234.44,-1187.48"/>
</g>
<!-- layer3_expert9_3&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge947" class="edge">
<title>layer3_expert9_3&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M51473.25,-1259.37C51476.18,-1258.52 51479.1,-1257.72 51482,-1257 51621.51,-1222.3 52033.52,-1196.81 52233.96,-1186.09"/>
<polygon fill="black" stroke="black" points="52234.42,-1189.57 52244.22,-1185.54 52234.04,-1182.58 52234.42,-1189.57"/>
</g>
<!-- layer3_expert9_4&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge948" class="edge">
<title>layer3_expert9_4&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M51665.01,-1259.55C51668.02,-1258.63 51671.03,-1257.78 51674,-1257 51866.76,-1206.49 52099.26,-1189.33 52234.11,-1183.5"/>
<polygon fill="black" stroke="black" points="52234.6,-1186.98 52244.45,-1183.07 52234.31,-1179.99 52234.6,-1186.98"/>
</g>
<!-- layer3_expert9_5&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge949" class="edge">
<title>layer3_expert9_5&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M51857.06,-1259.72C51860.06,-1258.76 51863.04,-1257.85 51866,-1257 51989.54,-1221.66 52135.93,-1201.29 52234.29,-1190.59"/>
<polygon fill="black" stroke="black" points="52234.68,-1194.07 52244.25,-1189.53 52233.94,-1187.11 52234.68,-1194.07"/>
</g>
<!-- layer3_expert9_6&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge950" class="edge">
<title>layer3_expert9_6&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M52049.18,-1260.11C52052.14,-1259.04 52055.09,-1257.99 52058,-1257 52115.37,-1237.38 52180.58,-1219.7 52234.42,-1206.28"/>
<polygon fill="black" stroke="black" points="52235.47,-1209.63 52244.34,-1203.83 52233.79,-1202.83 52235.47,-1209.63"/>
</g>
<!-- layer3_expert9_7&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge951" class="edge">
<title>layer3_expert9_7&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M52220.61,-1256.91C52240.8,-1244.6 52262.91,-1231.13 52282.87,-1218.97"/>
<polygon fill="black" stroke="black" points="52284.85,-1221.86 52291.57,-1213.67 52281.21,-1215.88 52284.85,-1221.86"/>
</g>
<!-- layer3_expert9_8&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge952" class="edge">
<title>layer3_expert9_8&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M52346,-1256.91C52346,-1246.2 52346,-1234.62 52346,-1223.78"/>
<polygon fill="black" stroke="black" points="52349.5,-1223.67 52346,-1213.67 52342.5,-1223.67 52349.5,-1223.67"/>
</g>
<!-- layer3_expert9_9&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge953" class="edge">
<title>layer3_expert9_9&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M52471.39,-1256.91C52451.2,-1244.6 52429.09,-1231.13 52409.13,-1218.97"/>
<polygon fill="black" stroke="black" points="52410.79,-1215.88 52400.43,-1213.67 52407.15,-1221.86 52410.79,-1215.88"/>
</g>
<!-- layer3_expert9_10&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge954" class="edge">
<title>layer3_expert9_10&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M52642.82,-1260.11C52639.86,-1259.04 52636.91,-1257.99 52634,-1257 52576.63,-1237.38 52511.42,-1219.7 52457.58,-1206.28"/>
<polygon fill="black" stroke="black" points="52458.21,-1202.83 52447.66,-1203.83 52456.53,-1209.63 52458.21,-1202.83"/>
</g>
<!-- layer3_expert9_11&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge955" class="edge">
<title>layer3_expert9_11&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M52834.94,-1259.72C52831.94,-1258.76 52828.96,-1257.85 52826,-1257 52702.46,-1221.66 52556.07,-1201.29 52457.71,-1190.59"/>
<polygon fill="black" stroke="black" points="52458.06,-1187.11 52447.75,-1189.53 52457.32,-1194.07 52458.06,-1187.11"/>
</g>
<!-- layer3_expert9_12&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge956" class="edge">
<title>layer3_expert9_12&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M53026.99,-1259.55C53023.98,-1258.63 53020.97,-1257.78 53018,-1257 52825.24,-1206.49 52592.74,-1189.33 52457.89,-1183.5"/>
<polygon fill="black" stroke="black" points="52457.69,-1179.99 52447.55,-1183.07 52457.4,-1186.98 52457.69,-1179.99"/>
</g>
<!-- layer3_expert9_13&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge957" class="edge">
<title>layer3_expert9_13&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M53218.75,-1259.37C53215.82,-1258.52 53212.9,-1257.72 53210,-1257 53070.49,-1222.3 52658.48,-1196.81 52458.04,-1186.09"/>
<polygon fill="black" stroke="black" points="52457.96,-1182.58 52447.78,-1185.54 52457.58,-1189.57 52457.96,-1182.58"/>
</g>
<!-- layer3_expert9_14&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge958" class="edge">
<title>layer3_expert9_14&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M53410.77,-1259.31C53407.83,-1258.47 53404.9,-1257.7 53402,-1257 53225.34,-1214.56 52691.81,-1192.05 52457.92,-1183.99"/>
<polygon fill="black" stroke="black" points="52457.8,-1180.49 52447.69,-1183.64 52457.56,-1187.48 52457.8,-1180.49"/>
</g>
<!-- layer3_expert9_15&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge959" class="edge">
<title>layer3_expert9_15&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M53602.78,-1259.27C53599.84,-1258.44 53596.91,-1257.68 53594,-1257 53379.73,-1206.78 52721.94,-1188.12 52457.65,-1182.53"/>
<polygon fill="black" stroke="black" points="52457.72,-1179.03 52447.65,-1182.32 52457.58,-1186.03 52457.72,-1179.03"/>
</g>
<!-- layer3_output_gpu9 -->
<g id="node575" class="node">
<title>layer3_output_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="53870,-1102 53626,-1102 53626,-1034 53870,-1034 53870,-1102"/>
<text text-anchor="middle" x="53748" y="-1086.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="53748" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="53748" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="53748" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_moe_agg_gpu9&#45;&gt;layer3_output_gpu9 -->
<g id="edge960" class="edge">
<title>layer3_moe_agg_gpu9&#45;&gt;layer3_output_gpu9</title>
<path fill="none" stroke="black" d="M52447.67,-1170.56C52696.81,-1151.1 53337.64,-1101.05 53615.84,-1079.32"/>
<polygon fill="black" stroke="black" points="53616.29,-1082.8 53625.98,-1078.53 53615.74,-1075.82 53616.29,-1082.8"/>
</g>
<!-- layer3_output_gpu9&#45;&gt;output -->
<g id="edge1178" class="edge">
<title>layer3_output_gpu9&#45;&gt;output</title>
<path fill="none" stroke="black" d="M53870.08,-1064.02C54611.94,-1045.89 58520.28,-950.41 59633.1,-923.23"/>
<polygon fill="black" stroke="black" points="59633.33,-926.72 59643.24,-922.98 59633.16,-919.73 59633.33,-926.72"/>
</g>
<!-- layer3_qkv_gpu10 -->
<g id="node576" class="node">
<title>layer3_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="55428,-1778.48 55216,-1778.48 55216,-1710.48 55428,-1710.48 55428,-1778.48"/>
<text text-anchor="middle" x="55322" y="-1763.28" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU10</text>
<text text-anchor="middle" x="55322" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="55322" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="55322" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_attn_gpu10 -->
<g id="node577" class="node">
<title>layer3_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="55448,-1667 55196,-1667 55196,-1599 55448,-1599 55448,-1667"/>
<text text-anchor="middle" x="55322" y="-1651.8" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU10</text>
<text text-anchor="middle" x="55322" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="55322" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="55322" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_qkv_gpu10&#45;&gt;layer3_attn_gpu10 -->
<g id="edge961" class="edge">
<title>layer3_qkv_gpu10&#45;&gt;layer3_attn_gpu10</title>
<path fill="none" stroke="black" d="M55322,-1710.33C55322,-1699.94 55322,-1688.3 55322,-1677.31"/>
<polygon fill="black" stroke="black" points="55325.5,-1677.03 55322,-1667.03 55318.5,-1677.03 55325.5,-1677.03"/>
</g>
<!-- layer3_attn_norm_gpu10 -->
<g id="node578" class="node">
<title>layer3_attn_norm_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="55448.5,-1563 55195.5,-1563 55195.5,-1495 55448.5,-1495 55448.5,-1563"/>
<text text-anchor="middle" x="55322" y="-1547.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="55322" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="55322" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="55322" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_attn_gpu10&#45;&gt;layer3_attn_norm_gpu10 -->
<g id="edge962" class="edge">
<title>layer3_attn_gpu10&#45;&gt;layer3_attn_norm_gpu10</title>
<path fill="none" stroke="black" d="M55322,-1598.88C55322,-1590.78 55322,-1581.98 55322,-1573.47"/>
<polygon fill="black" stroke="black" points="55325.5,-1573.3 55322,-1563.3 55318.5,-1573.3 55325.5,-1573.3"/>
</g>
<!-- layer3_gate_gpu10 -->
<g id="node579" class="node">
<title>layer3_gate_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="55444,-1459 55200,-1459 55200,-1376 55444,-1376 55444,-1459"/>
<text text-anchor="middle" x="55322" y="-1443.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU10</text>
<text text-anchor="middle" x="55322" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="55322" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="55322" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="55322" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_attn_norm_gpu10&#45;&gt;layer3_gate_gpu10 -->
<g id="edge963" class="edge">
<title>layer3_attn_norm_gpu10&#45;&gt;layer3_gate_gpu10</title>
<path fill="none" stroke="black" d="M55322,-1494.85C55322,-1486.8 55322,-1478 55322,-1469.34"/>
<polygon fill="black" stroke="black" points="55325.5,-1469.28 55322,-1459.28 55318.5,-1469.28 55325.5,-1469.28"/>
</g>
<!-- layer3_expert10_0 -->
<g id="node580" class="node">
<title>layer3_expert10_0</title>
<polygon fill="lightgreen" stroke="black" points="53969,-1340 53795,-1340 53795,-1257 53969,-1257 53969,-1340"/>
<text text-anchor="middle" x="53882" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU10</text>
<text text-anchor="middle" x="53882" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="53882" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="53882" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="53882" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_0 -->
<g id="edge964" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55199.85,-1414.87C54917.89,-1410.26 54227.51,-1393.9 53979.29,-1340.01"/>
<polygon fill="black" stroke="black" points="53979.75,-1336.52 53969.22,-1337.75 53978.21,-1343.35 53979.75,-1336.52"/>
</g>
<!-- layer3_expert10_1 -->
<g id="node581" class="node">
<title>layer3_expert10_1</title>
<polygon fill="lightgreen" stroke="black" points="54161,-1340 53987,-1340 53987,-1257 54161,-1257 54161,-1340"/>
<text text-anchor="middle" x="54074" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU10</text>
<text text-anchor="middle" x="54074" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="54074" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="54074" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="54074" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_1 -->
<g id="edge965" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55199.68,-1413.51C54948.53,-1406.54 54381.38,-1386.35 54171.26,-1340.01"/>
<polygon fill="black" stroke="black" points="54171.76,-1336.53 54161.23,-1337.71 54170.2,-1343.35 54171.76,-1336.53"/>
</g>
<!-- layer3_expert10_2 -->
<g id="node582" class="node">
<title>layer3_expert10_2</title>
<polygon fill="lightgreen" stroke="black" points="54353,-1340 54179,-1340 54179,-1257 54353,-1257 54353,-1340"/>
<text text-anchor="middle" x="54266" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU10</text>
<text text-anchor="middle" x="54266" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="54266" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="54266" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="54266" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_2 -->
<g id="edge966" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55199.94,-1411.63C54982.49,-1402.15 54535.52,-1378.91 54363.21,-1340"/>
<polygon fill="black" stroke="black" points="54363.78,-1336.54 54353.24,-1337.66 54362.17,-1343.36 54363.78,-1336.54"/>
</g>
<!-- layer3_expert10_3 -->
<g id="node583" class="node">
<title>layer3_expert10_3</title>
<polygon fill="lightgreen" stroke="black" points="54545,-1340 54371,-1340 54371,-1257 54545,-1257 54545,-1340"/>
<text text-anchor="middle" x="54458" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU10</text>
<text text-anchor="middle" x="54458" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="54458" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="54458" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="54458" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_3 -->
<g id="edge967" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55199.67,-1415.54C55048.64,-1411.85 54784.63,-1397.19 54555.13,-1340.07"/>
<polygon fill="black" stroke="black" points="54555.81,-1336.63 54545.26,-1337.58 54554.1,-1343.42 54555.81,-1336.63"/>
</g>
<!-- layer3_expert10_4 -->
<g id="node584" class="node">
<title>layer3_expert10_4</title>
<polygon fill="lightgreen" stroke="black" points="54737,-1340 54563,-1340 54563,-1257 54737,-1257 54737,-1340"/>
<text text-anchor="middle" x="54650" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU10</text>
<text text-anchor="middle" x="54650" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="54650" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="54650" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="54650" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_4 -->
<g id="edge968" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55199.89,-1409.76C55084.42,-1401.23 54906.78,-1382.5 54747.04,-1340.07"/>
<polygon fill="black" stroke="black" points="54747.59,-1336.6 54737.03,-1337.38 54745.77,-1343.36 54747.59,-1336.6"/>
</g>
<!-- layer3_expert10_5 -->
<g id="node585" class="node">
<title>layer3_expert10_5</title>
<polygon fill="lightgreen" stroke="black" points="54929,-1340 54755,-1340 54755,-1257 54929,-1257 54929,-1340"/>
<text text-anchor="middle" x="54842" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU10</text>
<text text-anchor="middle" x="54842" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="54842" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="54842" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="54842" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_5 -->
<g id="edge969" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55199.8,-1398.65C55126.17,-1386.36 55030.72,-1367.72 54938.84,-1340.09"/>
<polygon fill="black" stroke="black" points="54939.69,-1336.69 54929.1,-1337.13 54937.65,-1343.39 54939.69,-1336.69"/>
</g>
<!-- layer3_expert10_6 -->
<g id="node586" class="node">
<title>layer3_expert10_6</title>
<polygon fill="lightgreen" stroke="black" points="55121,-1340 54947,-1340 54947,-1257 55121,-1257 55121,-1340"/>
<text text-anchor="middle" x="55034" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU10</text>
<text text-anchor="middle" x="55034" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="55034" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="55034" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="55034" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_6 -->
<g id="edge970" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55219.21,-1375.99C55192.79,-1365.46 55164.27,-1354.01 55130.69,-1340.27"/>
<polygon fill="black" stroke="black" points="55131.67,-1336.88 55121.09,-1336.33 55129.01,-1343.36 55131.67,-1336.88"/>
</g>
<!-- layer3_expert10_7 -->
<g id="node587" class="node">
<title>layer3_expert10_7</title>
<polygon fill="lightgreen" stroke="black" points="55313,-1340 55139,-1340 55139,-1257 55313,-1257 55313,-1340"/>
<text text-anchor="middle" x="55226" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU10</text>
<text text-anchor="middle" x="55226" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="55226" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="55226" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="55226" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_7 -->
<g id="edge971" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55288.69,-1375.91C55281.25,-1366.83 55273.28,-1357.12 55265.61,-1347.77"/>
<polygon fill="black" stroke="black" points="55268.3,-1345.53 55259.25,-1340.02 55262.89,-1349.97 55268.3,-1345.53"/>
</g>
<!-- layer3_expert10_8 -->
<g id="node588" class="node">
<title>layer3_expert10_8</title>
<polygon fill="lightgreen" stroke="black" points="55505,-1340 55331,-1340 55331,-1257 55505,-1257 55505,-1340"/>
<text text-anchor="middle" x="55418" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU10</text>
<text text-anchor="middle" x="55418" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="55418" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="55418" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="55418" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_8 -->
<g id="edge972" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55355.31,-1375.91C55362.75,-1366.83 55370.72,-1357.12 55378.39,-1347.77"/>
<polygon fill="black" stroke="black" points="55381.11,-1349.97 55384.75,-1340.02 55375.7,-1345.53 55381.11,-1349.97"/>
</g>
<!-- layer3_expert10_9 -->
<g id="node589" class="node">
<title>layer3_expert10_9</title>
<polygon fill="lightgreen" stroke="black" points="55697,-1340 55523,-1340 55523,-1257 55697,-1257 55697,-1340"/>
<text text-anchor="middle" x="55610" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU10</text>
<text text-anchor="middle" x="55610" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="55610" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="55610" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="55610" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_9 -->
<g id="edge973" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55424.79,-1375.99C55451.21,-1365.46 55479.73,-1354.01 55513.31,-1340.27"/>
<polygon fill="black" stroke="black" points="55514.99,-1343.36 55522.91,-1336.33 55512.33,-1336.88 55514.99,-1343.36"/>
</g>
<!-- layer3_expert10_10 -->
<g id="node590" class="node">
<title>layer3_expert10_10</title>
<polygon fill="lightgreen" stroke="black" points="55889,-1340 55715,-1340 55715,-1257 55889,-1257 55889,-1340"/>
<text text-anchor="middle" x="55802" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU10</text>
<text text-anchor="middle" x="55802" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="55802" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="55802" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="55802" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_10 -->
<g id="edge974" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55444.2,-1398.65C55517.83,-1386.36 55613.28,-1367.72 55705.16,-1340.09"/>
<polygon fill="black" stroke="black" points="55706.35,-1343.39 55714.9,-1337.13 55704.31,-1336.69 55706.35,-1343.39"/>
</g>
<!-- layer3_expert10_11 -->
<g id="node591" class="node">
<title>layer3_expert10_11</title>
<polygon fill="lightgreen" stroke="black" points="56081,-1340 55907,-1340 55907,-1257 56081,-1257 56081,-1340"/>
<text text-anchor="middle" x="55994" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU10</text>
<text text-anchor="middle" x="55994" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="55994" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="55994" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="55994" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_11 -->
<g id="edge975" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55444.11,-1409.76C55559.58,-1401.23 55737.22,-1382.5 55896.96,-1340.07"/>
<polygon fill="black" stroke="black" points="55898.23,-1343.36 55906.97,-1337.38 55896.41,-1336.6 55898.23,-1343.36"/>
</g>
<!-- layer3_expert10_12 -->
<g id="node592" class="node">
<title>layer3_expert10_12</title>
<polygon fill="lightgreen" stroke="black" points="56273,-1340 56099,-1340 56099,-1257 56273,-1257 56273,-1340"/>
<text text-anchor="middle" x="56186" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU10</text>
<text text-anchor="middle" x="56186" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="56186" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="56186" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="56186" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_12 -->
<g id="edge976" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55444.33,-1415.54C55595.36,-1411.85 55859.37,-1397.19 56088.87,-1340.07"/>
<polygon fill="black" stroke="black" points="56089.9,-1343.42 56098.74,-1337.58 56088.19,-1336.63 56089.9,-1343.42"/>
</g>
<!-- layer3_expert10_13 -->
<g id="node593" class="node">
<title>layer3_expert10_13</title>
<polygon fill="lightgreen" stroke="black" points="56465,-1340 56291,-1340 56291,-1257 56465,-1257 56465,-1340"/>
<text text-anchor="middle" x="56378" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU10</text>
<text text-anchor="middle" x="56378" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="56378" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="56378" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="56378" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_13 -->
<g id="edge977" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55444.06,-1411.63C55661.51,-1402.15 56108.48,-1378.91 56280.79,-1340"/>
<polygon fill="black" stroke="black" points="56281.83,-1343.36 56290.76,-1337.66 56280.22,-1336.54 56281.83,-1343.36"/>
</g>
<!-- layer3_expert10_14 -->
<g id="node594" class="node">
<title>layer3_expert10_14</title>
<polygon fill="lightgreen" stroke="black" points="56657,-1340 56483,-1340 56483,-1257 56657,-1257 56657,-1340"/>
<text text-anchor="middle" x="56570" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU10</text>
<text text-anchor="middle" x="56570" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="56570" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="56570" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="56570" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_14 -->
<g id="edge978" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55444.32,-1413.51C55695.47,-1406.54 56262.62,-1386.35 56472.74,-1340.01"/>
<polygon fill="black" stroke="black" points="56473.8,-1343.35 56482.77,-1337.71 56472.24,-1336.53 56473.8,-1343.35"/>
</g>
<!-- layer3_expert10_15 -->
<g id="node595" class="node">
<title>layer3_expert10_15</title>
<polygon fill="lightgreen" stroke="black" points="56849,-1340 56675,-1340 56675,-1257 56849,-1257 56849,-1340"/>
<text text-anchor="middle" x="56762" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU10</text>
<text text-anchor="middle" x="56762" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="56762" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="56762" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="56762" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_15 -->
<g id="edge979" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55444.15,-1414.87C55726.11,-1410.26 56416.49,-1393.9 56664.71,-1340.01"/>
<polygon fill="black" stroke="black" points="56665.79,-1343.35 56674.78,-1337.75 56664.25,-1336.52 56665.79,-1343.35"/>
</g>
<!-- layer3_moe_agg_gpu10 -->
<g id="node596" class="node">
<title>layer3_moe_agg_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="55524,-1213.5 55312,-1213.5 55312,-1145.5 55524,-1145.5 55524,-1213.5"/>
<text text-anchor="middle" x="55418" y="-1198.3" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU10</text>
<text text-anchor="middle" x="55418" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="55418" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="55418" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_expert10_0&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge980" class="edge">
<title>layer3_expert10_0&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M53969.22,-1259.24C53972.16,-1258.42 53975.09,-1257.67 53978,-1257 54228.76,-1199.3 55005.29,-1184.94 55301.54,-1181.52"/>
<polygon fill="black" stroke="black" points="55301.91,-1185.02 55311.87,-1181.4 55301.83,-1178.02 55301.91,-1185.02"/>
</g>
<!-- layer3_expert10_1&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge981" class="edge">
<title>layer3_expert10_1&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M54161.22,-1259.27C54164.16,-1258.44 54167.09,-1257.68 54170,-1257 54382.97,-1207.09 55034.07,-1188.35 55301.48,-1182.64"/>
<polygon fill="black" stroke="black" points="55301.68,-1186.13 55311.61,-1182.42 55301.53,-1179.14 55301.68,-1186.13"/>
</g>
<!-- layer3_expert10_2&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge982" class="edge">
<title>layer3_expert10_2&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M54353.23,-1259.31C54356.17,-1258.47 54359.1,-1257.7 54362,-1257 54537.54,-1214.83 55065.41,-1192.33 55301.58,-1184.15"/>
<polygon fill="black" stroke="black" points="55301.7,-1187.65 55311.58,-1183.81 55301.46,-1180.65 55301.7,-1187.65"/>
</g>
<!-- layer3_expert10_3&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge983" class="edge">
<title>layer3_expert10_3&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M54545.25,-1259.37C54548.18,-1258.52 54551.1,-1257.72 54554,-1257 54692.5,-1222.55 55099.58,-1197.18 55301.58,-1186.32"/>
<polygon fill="black" stroke="black" points="55301.83,-1189.82 55311.63,-1185.79 55301.46,-1182.83 55301.83,-1189.82"/>
</g>
<!-- layer3_expert10_4&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge984" class="edge">
<title>layer3_expert10_4&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M54737.01,-1259.55C54740.02,-1258.63 54743.03,-1257.78 54746,-1257 54936.54,-1207.07 55165.93,-1189.73 55301.42,-1183.7"/>
<polygon fill="black" stroke="black" points="55301.98,-1187.18 55311.82,-1183.26 55301.68,-1180.19 55301.98,-1187.18"/>
</g>
<!-- layer3_expert10_5&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge985" class="edge">
<title>layer3_expert10_5&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M54929.06,-1259.72C54932.06,-1258.76 54935.04,-1257.85 54938,-1257 55059.58,-1222.22 55203.29,-1201.94 55301.57,-1191.11"/>
<polygon fill="black" stroke="black" points="55301.97,-1194.59 55311.53,-1190.03 55301.21,-1187.63 55301.97,-1194.59"/>
</g>
<!-- layer3_expert10_6&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge986" class="edge">
<title>layer3_expert10_6&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M55121.18,-1260.11C55124.14,-1259.04 55127.09,-1257.99 55130,-1257 55185.88,-1237.9 55249.18,-1220.62 55302.18,-1207.34"/>
<polygon fill="black" stroke="black" points="55303.1,-1210.72 55311.95,-1204.91 55301.41,-1203.93 55303.1,-1210.72"/>
</g>
<!-- layer3_expert10_7&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge987" class="edge">
<title>layer3_expert10_7&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M55292.61,-1256.91C55312.8,-1244.6 55334.91,-1231.13 55354.87,-1218.97"/>
<polygon fill="black" stroke="black" points="55356.85,-1221.86 55363.57,-1213.67 55353.21,-1215.88 55356.85,-1221.86"/>
</g>
<!-- layer3_expert10_8&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge988" class="edge">
<title>layer3_expert10_8&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M55418,-1256.91C55418,-1246.2 55418,-1234.62 55418,-1223.78"/>
<polygon fill="black" stroke="black" points="55421.5,-1223.67 55418,-1213.67 55414.5,-1223.67 55421.5,-1223.67"/>
</g>
<!-- layer3_expert10_9&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge989" class="edge">
<title>layer3_expert10_9&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M55543.39,-1256.91C55523.2,-1244.6 55501.09,-1231.13 55481.13,-1218.97"/>
<polygon fill="black" stroke="black" points="55482.79,-1215.88 55472.43,-1213.67 55479.15,-1221.86 55482.79,-1215.88"/>
</g>
<!-- layer3_expert10_10&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge990" class="edge">
<title>layer3_expert10_10&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M55714.82,-1260.11C55711.86,-1259.04 55708.91,-1257.99 55706,-1257 55650.12,-1237.9 55586.82,-1220.62 55533.82,-1207.34"/>
<polygon fill="black" stroke="black" points="55534.59,-1203.93 55524.05,-1204.91 55532.9,-1210.72 55534.59,-1203.93"/>
</g>
<!-- layer3_expert10_11&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge991" class="edge">
<title>layer3_expert10_11&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M55906.94,-1259.72C55903.94,-1258.76 55900.96,-1257.85 55898,-1257 55776.42,-1222.22 55632.71,-1201.94 55534.43,-1191.11"/>
<polygon fill="black" stroke="black" points="55534.79,-1187.63 55524.47,-1190.03 55534.03,-1194.59 55534.79,-1187.63"/>
</g>
<!-- layer3_expert10_12&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge992" class="edge">
<title>layer3_expert10_12&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M56098.99,-1259.55C56095.98,-1258.63 56092.97,-1257.78 56090,-1257 55899.46,-1207.07 55670.07,-1189.73 55534.58,-1183.7"/>
<polygon fill="black" stroke="black" points="55534.32,-1180.19 55524.18,-1183.26 55534.02,-1187.18 55534.32,-1180.19"/>
</g>
<!-- layer3_expert10_13&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge993" class="edge">
<title>layer3_expert10_13&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M56290.75,-1259.37C56287.82,-1258.52 56284.9,-1257.72 56282,-1257 56143.5,-1222.55 55736.42,-1197.18 55534.42,-1186.32"/>
<polygon fill="black" stroke="black" points="55534.54,-1182.83 55524.37,-1185.79 55534.17,-1189.82 55534.54,-1182.83"/>
</g>
<!-- layer3_expert10_14&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge994" class="edge">
<title>layer3_expert10_14&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M56482.77,-1259.31C56479.83,-1258.47 56476.9,-1257.7 56474,-1257 56298.46,-1214.83 55770.59,-1192.33 55534.42,-1184.15"/>
<polygon fill="black" stroke="black" points="55534.54,-1180.65 55524.42,-1183.81 55534.3,-1187.65 55534.54,-1180.65"/>
</g>
<!-- layer3_expert10_15&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge995" class="edge">
<title>layer3_expert10_15&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M56674.78,-1259.27C56671.84,-1258.44 56668.91,-1257.68 56666,-1257 56453.03,-1207.09 55801.93,-1188.35 55534.52,-1182.64"/>
<polygon fill="black" stroke="black" points="55534.47,-1179.14 55524.39,-1182.42 55534.32,-1186.13 55534.47,-1179.14"/>
</g>
<!-- layer3_output_gpu10 -->
<g id="node597" class="node">
<title>layer3_output_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="56944.5,-1102 56691.5,-1102 56691.5,-1034 56944.5,-1034 56944.5,-1102"/>
<text text-anchor="middle" x="56818" y="-1086.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="56818" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="56818" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="56818" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_moe_agg_gpu10&#45;&gt;layer3_output_gpu10 -->
<g id="edge996" class="edge">
<title>layer3_moe_agg_gpu10&#45;&gt;layer3_output_gpu10</title>
<path fill="none" stroke="black" d="M55524.09,-1170.2C55774.58,-1150.61 56402.57,-1101.49 56681.18,-1079.7"/>
<polygon fill="black" stroke="black" points="56681.65,-1083.18 56691.35,-1078.91 56681.11,-1076.2 56681.65,-1083.18"/>
</g>
<!-- layer3_output_gpu10&#45;&gt;output -->
<g id="edge1179" class="edge">
<title>layer3_output_gpu10&#45;&gt;output</title>
<path fill="none" stroke="black" d="M56944.78,-1060.85C57405.3,-1038.49 58996.68,-961.25 59647.88,-929.64"/>
<polygon fill="black" stroke="black" points="59648.53,-933.12 59658.35,-929.14 59648.19,-926.13 59648.53,-933.12"/>
</g>
<!-- layer3_qkv_gpu11 -->
<g id="node598" class="node">
<title>layer3_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="58500,-1778.48 58288,-1778.48 58288,-1710.48 58500,-1710.48 58500,-1778.48"/>
<text text-anchor="middle" x="58394" y="-1763.28" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU11</text>
<text text-anchor="middle" x="58394" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="58394" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="58394" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_attn_gpu11 -->
<g id="node599" class="node">
<title>layer3_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="58520,-1667 58268,-1667 58268,-1599 58520,-1599 58520,-1667"/>
<text text-anchor="middle" x="58394" y="-1651.8" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU11</text>
<text text-anchor="middle" x="58394" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="58394" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="58394" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_qkv_gpu11&#45;&gt;layer3_attn_gpu11 -->
<g id="edge997" class="edge">
<title>layer3_qkv_gpu11&#45;&gt;layer3_attn_gpu11</title>
<path fill="none" stroke="black" d="M58394,-1710.33C58394,-1699.94 58394,-1688.3 58394,-1677.31"/>
<polygon fill="black" stroke="black" points="58397.5,-1677.03 58394,-1667.03 58390.5,-1677.03 58397.5,-1677.03"/>
</g>
<!-- layer3_attn_norm_gpu11 -->
<g id="node600" class="node">
<title>layer3_attn_norm_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="58520.5,-1563 58267.5,-1563 58267.5,-1495 58520.5,-1495 58520.5,-1563"/>
<text text-anchor="middle" x="58394" y="-1547.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="58394" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="58394" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="58394" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_attn_gpu11&#45;&gt;layer3_attn_norm_gpu11 -->
<g id="edge998" class="edge">
<title>layer3_attn_gpu11&#45;&gt;layer3_attn_norm_gpu11</title>
<path fill="none" stroke="black" d="M58394,-1598.88C58394,-1590.78 58394,-1581.98 58394,-1573.47"/>
<polygon fill="black" stroke="black" points="58397.5,-1573.3 58394,-1563.3 58390.5,-1573.3 58397.5,-1573.3"/>
</g>
<!-- layer3_gate_gpu11 -->
<g id="node601" class="node">
<title>layer3_gate_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="58516,-1459 58272,-1459 58272,-1376 58516,-1376 58516,-1459"/>
<text text-anchor="middle" x="58394" y="-1443.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU11</text>
<text text-anchor="middle" x="58394" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="58394" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="58394" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="58394" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_attn_norm_gpu11&#45;&gt;layer3_gate_gpu11 -->
<g id="edge999" class="edge">
<title>layer3_attn_norm_gpu11&#45;&gt;layer3_gate_gpu11</title>
<path fill="none" stroke="black" d="M58394,-1494.85C58394,-1486.8 58394,-1478 58394,-1469.34"/>
<polygon fill="black" stroke="black" points="58397.5,-1469.28 58394,-1459.28 58390.5,-1469.28 58397.5,-1469.28"/>
</g>
<!-- layer3_expert11_0 -->
<g id="node602" class="node">
<title>layer3_expert11_0</title>
<polygon fill="lightgreen" stroke="black" points="57041,-1340 56867,-1340 56867,-1257 57041,-1257 57041,-1340"/>
<text text-anchor="middle" x="56954" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU11</text>
<text text-anchor="middle" x="56954" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="56954" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="56954" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="56954" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_0 -->
<g id="edge1000" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58271.85,-1414.87C57989.89,-1410.26 57299.51,-1393.9 57051.29,-1340.01"/>
<polygon fill="black" stroke="black" points="57051.75,-1336.52 57041.22,-1337.75 57050.21,-1343.35 57051.75,-1336.52"/>
</g>
<!-- layer3_expert11_1 -->
<g id="node603" class="node">
<title>layer3_expert11_1</title>
<polygon fill="lightgreen" stroke="black" points="57233,-1340 57059,-1340 57059,-1257 57233,-1257 57233,-1340"/>
<text text-anchor="middle" x="57146" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU11</text>
<text text-anchor="middle" x="57146" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="57146" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="57146" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="57146" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_1 -->
<g id="edge1001" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58271.68,-1413.51C58020.53,-1406.54 57453.38,-1386.35 57243.26,-1340.01"/>
<polygon fill="black" stroke="black" points="57243.76,-1336.53 57233.23,-1337.71 57242.2,-1343.35 57243.76,-1336.53"/>
</g>
<!-- layer3_expert11_2 -->
<g id="node604" class="node">
<title>layer3_expert11_2</title>
<polygon fill="lightgreen" stroke="black" points="57425,-1340 57251,-1340 57251,-1257 57425,-1257 57425,-1340"/>
<text text-anchor="middle" x="57338" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU11</text>
<text text-anchor="middle" x="57338" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="57338" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="57338" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="57338" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_2 -->
<g id="edge1002" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58271.94,-1411.63C58054.49,-1402.15 57607.52,-1378.91 57435.21,-1340"/>
<polygon fill="black" stroke="black" points="57435.78,-1336.54 57425.24,-1337.66 57434.17,-1343.36 57435.78,-1336.54"/>
</g>
<!-- layer3_expert11_3 -->
<g id="node605" class="node">
<title>layer3_expert11_3</title>
<polygon fill="lightgreen" stroke="black" points="57617,-1340 57443,-1340 57443,-1257 57617,-1257 57617,-1340"/>
<text text-anchor="middle" x="57530" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU11</text>
<text text-anchor="middle" x="57530" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="57530" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="57530" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="57530" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_3 -->
<g id="edge1003" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58271.67,-1415.54C58120.64,-1411.85 57856.63,-1397.19 57627.13,-1340.07"/>
<polygon fill="black" stroke="black" points="57627.81,-1336.63 57617.26,-1337.58 57626.1,-1343.42 57627.81,-1336.63"/>
</g>
<!-- layer3_expert11_4 -->
<g id="node606" class="node">
<title>layer3_expert11_4</title>
<polygon fill="lightgreen" stroke="black" points="57809,-1340 57635,-1340 57635,-1257 57809,-1257 57809,-1340"/>
<text text-anchor="middle" x="57722" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU11</text>
<text text-anchor="middle" x="57722" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="57722" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="57722" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="57722" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_4 -->
<g id="edge1004" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58271.89,-1409.76C58156.42,-1401.23 57978.78,-1382.5 57819.04,-1340.07"/>
<polygon fill="black" stroke="black" points="57819.59,-1336.6 57809.03,-1337.38 57817.77,-1343.36 57819.59,-1336.6"/>
</g>
<!-- layer3_expert11_5 -->
<g id="node607" class="node">
<title>layer3_expert11_5</title>
<polygon fill="lightgreen" stroke="black" points="58001,-1340 57827,-1340 57827,-1257 58001,-1257 58001,-1340"/>
<text text-anchor="middle" x="57914" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU11</text>
<text text-anchor="middle" x="57914" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="57914" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="57914" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="57914" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_5 -->
<g id="edge1005" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58271.8,-1398.65C58198.17,-1386.36 58102.72,-1367.72 58010.84,-1340.09"/>
<polygon fill="black" stroke="black" points="58011.69,-1336.69 58001.1,-1337.13 58009.65,-1343.39 58011.69,-1336.69"/>
</g>
<!-- layer3_expert11_6 -->
<g id="node608" class="node">
<title>layer3_expert11_6</title>
<polygon fill="lightgreen" stroke="black" points="58193,-1340 58019,-1340 58019,-1257 58193,-1257 58193,-1340"/>
<text text-anchor="middle" x="58106" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU11</text>
<text text-anchor="middle" x="58106" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="58106" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="58106" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="58106" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_6 -->
<g id="edge1006" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58291.21,-1375.99C58264.79,-1365.46 58236.27,-1354.01 58202.69,-1340.27"/>
<polygon fill="black" stroke="black" points="58203.67,-1336.88 58193.09,-1336.33 58201.01,-1343.36 58203.67,-1336.88"/>
</g>
<!-- layer3_expert11_7 -->
<g id="node609" class="node">
<title>layer3_expert11_7</title>
<polygon fill="lightgreen" stroke="black" points="58385,-1340 58211,-1340 58211,-1257 58385,-1257 58385,-1340"/>
<text text-anchor="middle" x="58298" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU11</text>
<text text-anchor="middle" x="58298" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="58298" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="58298" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="58298" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_7 -->
<g id="edge1007" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58360.69,-1375.91C58353.25,-1366.83 58345.28,-1357.12 58337.61,-1347.77"/>
<polygon fill="black" stroke="black" points="58340.3,-1345.53 58331.25,-1340.02 58334.89,-1349.97 58340.3,-1345.53"/>
</g>
<!-- layer3_expert11_8 -->
<g id="node610" class="node">
<title>layer3_expert11_8</title>
<polygon fill="lightgreen" stroke="black" points="58577,-1340 58403,-1340 58403,-1257 58577,-1257 58577,-1340"/>
<text text-anchor="middle" x="58490" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU11</text>
<text text-anchor="middle" x="58490" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="58490" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="58490" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="58490" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_8 -->
<g id="edge1008" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58427.31,-1375.91C58434.75,-1366.83 58442.72,-1357.12 58450.39,-1347.77"/>
<polygon fill="black" stroke="black" points="58453.11,-1349.97 58456.75,-1340.02 58447.7,-1345.53 58453.11,-1349.97"/>
</g>
<!-- layer3_expert11_9 -->
<g id="node611" class="node">
<title>layer3_expert11_9</title>
<polygon fill="lightgreen" stroke="black" points="58769,-1340 58595,-1340 58595,-1257 58769,-1257 58769,-1340"/>
<text text-anchor="middle" x="58682" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU11</text>
<text text-anchor="middle" x="58682" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="58682" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="58682" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="58682" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_9 -->
<g id="edge1009" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58496.79,-1375.99C58523.21,-1365.46 58551.73,-1354.01 58585.31,-1340.27"/>
<polygon fill="black" stroke="black" points="58586.99,-1343.36 58594.91,-1336.33 58584.33,-1336.88 58586.99,-1343.36"/>
</g>
<!-- layer3_expert11_10 -->
<g id="node612" class="node">
<title>layer3_expert11_10</title>
<polygon fill="lightgreen" stroke="black" points="58961,-1340 58787,-1340 58787,-1257 58961,-1257 58961,-1340"/>
<text text-anchor="middle" x="58874" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU11</text>
<text text-anchor="middle" x="58874" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="58874" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="58874" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="58874" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_10 -->
<g id="edge1010" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58516.2,-1398.65C58589.83,-1386.36 58685.28,-1367.72 58777.16,-1340.09"/>
<polygon fill="black" stroke="black" points="58778.35,-1343.39 58786.9,-1337.13 58776.31,-1336.69 58778.35,-1343.39"/>
</g>
<!-- layer3_expert11_11 -->
<g id="node613" class="node">
<title>layer3_expert11_11</title>
<polygon fill="lightgreen" stroke="black" points="59153,-1340 58979,-1340 58979,-1257 59153,-1257 59153,-1340"/>
<text text-anchor="middle" x="59066" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU11</text>
<text text-anchor="middle" x="59066" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="59066" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="59066" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="59066" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_11 -->
<g id="edge1011" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58516.11,-1409.76C58631.58,-1401.23 58809.22,-1382.5 58968.96,-1340.07"/>
<polygon fill="black" stroke="black" points="58970.23,-1343.36 58978.97,-1337.38 58968.41,-1336.6 58970.23,-1343.36"/>
</g>
<!-- layer3_expert11_12 -->
<g id="node614" class="node">
<title>layer3_expert11_12</title>
<polygon fill="lightgreen" stroke="black" points="59345,-1340 59171,-1340 59171,-1257 59345,-1257 59345,-1340"/>
<text text-anchor="middle" x="59258" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU11</text>
<text text-anchor="middle" x="59258" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="59258" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="59258" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="59258" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_12 -->
<g id="edge1012" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58516.33,-1415.54C58667.36,-1411.85 58931.37,-1397.19 59160.87,-1340.07"/>
<polygon fill="black" stroke="black" points="59161.9,-1343.42 59170.74,-1337.58 59160.19,-1336.63 59161.9,-1343.42"/>
</g>
<!-- layer3_expert11_13 -->
<g id="node615" class="node">
<title>layer3_expert11_13</title>
<polygon fill="lightgreen" stroke="black" points="59537,-1340 59363,-1340 59363,-1257 59537,-1257 59537,-1340"/>
<text text-anchor="middle" x="59450" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU11</text>
<text text-anchor="middle" x="59450" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="59450" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="59450" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="59450" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_13 -->
<g id="edge1013" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58516.06,-1411.63C58733.51,-1402.15 59180.48,-1378.91 59352.79,-1340"/>
<polygon fill="black" stroke="black" points="59353.83,-1343.36 59362.76,-1337.66 59352.22,-1336.54 59353.83,-1343.36"/>
</g>
<!-- layer3_expert11_14 -->
<g id="node616" class="node">
<title>layer3_expert11_14</title>
<polygon fill="lightgreen" stroke="black" points="59729,-1340 59555,-1340 59555,-1257 59729,-1257 59729,-1340"/>
<text text-anchor="middle" x="59642" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU11</text>
<text text-anchor="middle" x="59642" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="59642" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="59642" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="59642" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_14 -->
<g id="edge1014" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58516.32,-1413.51C58767.47,-1406.54 59334.62,-1386.35 59544.74,-1340.01"/>
<polygon fill="black" stroke="black" points="59545.8,-1343.35 59554.77,-1337.71 59544.24,-1336.53 59545.8,-1343.35"/>
</g>
<!-- layer3_expert11_15 -->
<g id="node617" class="node">
<title>layer3_expert11_15</title>
<polygon fill="lightgreen" stroke="black" points="59921,-1340 59747,-1340 59747,-1257 59921,-1257 59921,-1340"/>
<text text-anchor="middle" x="59834" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU11</text>
<text text-anchor="middle" x="59834" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="59834" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="59834" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="59834" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_15 -->
<g id="edge1015" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58516.15,-1414.87C58798.11,-1410.26 59488.49,-1393.9 59736.71,-1340.01"/>
<polygon fill="black" stroke="black" points="59737.79,-1343.35 59746.78,-1337.75 59736.25,-1336.52 59737.79,-1343.35"/>
</g>
<!-- layer3_moe_agg_gpu11 -->
<g id="node618" class="node">
<title>layer3_moe_agg_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="58596,-1213.5 58384,-1213.5 58384,-1145.5 58596,-1145.5 58596,-1213.5"/>
<text text-anchor="middle" x="58490" y="-1198.3" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU11</text>
<text text-anchor="middle" x="58490" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="58490" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="58490" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_expert11_0&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1016" class="edge">
<title>layer3_expert11_0&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M57041.22,-1259.24C57044.16,-1258.42 57047.09,-1257.67 57050,-1257 57300.76,-1199.3 58077.29,-1184.94 58373.54,-1181.52"/>
<polygon fill="black" stroke="black" points="58373.91,-1185.02 58383.87,-1181.4 58373.83,-1178.02 58373.91,-1185.02"/>
</g>
<!-- layer3_expert11_1&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1017" class="edge">
<title>layer3_expert11_1&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M57233.22,-1259.27C57236.16,-1258.44 57239.09,-1257.68 57242,-1257 57454.97,-1207.09 58106.07,-1188.35 58373.48,-1182.64"/>
<polygon fill="black" stroke="black" points="58373.68,-1186.13 58383.61,-1182.42 58373.53,-1179.14 58373.68,-1186.13"/>
</g>
<!-- layer3_expert11_2&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1018" class="edge">
<title>layer3_expert11_2&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M57425.23,-1259.31C57428.17,-1258.47 57431.1,-1257.7 57434,-1257 57609.54,-1214.83 58137.41,-1192.33 58373.58,-1184.15"/>
<polygon fill="black" stroke="black" points="58373.7,-1187.65 58383.58,-1183.81 58373.46,-1180.65 58373.7,-1187.65"/>
</g>
<!-- layer3_expert11_3&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1019" class="edge">
<title>layer3_expert11_3&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M57617.25,-1259.37C57620.18,-1258.52 57623.1,-1257.72 57626,-1257 57764.5,-1222.55 58171.58,-1197.18 58373.58,-1186.32"/>
<polygon fill="black" stroke="black" points="58373.83,-1189.82 58383.63,-1185.79 58373.46,-1182.83 58373.83,-1189.82"/>
</g>
<!-- layer3_expert11_4&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1020" class="edge">
<title>layer3_expert11_4&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M57809.01,-1259.55C57812.02,-1258.63 57815.03,-1257.78 57818,-1257 58008.54,-1207.07 58237.93,-1189.73 58373.42,-1183.7"/>
<polygon fill="black" stroke="black" points="58373.98,-1187.18 58383.82,-1183.26 58373.68,-1180.19 58373.98,-1187.18"/>
</g>
<!-- layer3_expert11_5&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1021" class="edge">
<title>layer3_expert11_5&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M58001.06,-1259.72C58004.06,-1258.76 58007.04,-1257.85 58010,-1257 58131.58,-1222.22 58275.29,-1201.94 58373.57,-1191.11"/>
<polygon fill="black" stroke="black" points="58373.97,-1194.59 58383.53,-1190.03 58373.21,-1187.63 58373.97,-1194.59"/>
</g>
<!-- layer3_expert11_6&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1022" class="edge">
<title>layer3_expert11_6&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M58193.18,-1260.11C58196.14,-1259.04 58199.09,-1257.99 58202,-1257 58257.88,-1237.9 58321.18,-1220.62 58374.18,-1207.34"/>
<polygon fill="black" stroke="black" points="58375.1,-1210.72 58383.95,-1204.91 58373.41,-1203.93 58375.1,-1210.72"/>
</g>
<!-- layer3_expert11_7&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1023" class="edge">
<title>layer3_expert11_7&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M58364.61,-1256.91C58384.8,-1244.6 58406.91,-1231.13 58426.87,-1218.97"/>
<polygon fill="black" stroke="black" points="58428.85,-1221.86 58435.57,-1213.67 58425.21,-1215.88 58428.85,-1221.86"/>
</g>
<!-- layer3_expert11_8&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1024" class="edge">
<title>layer3_expert11_8&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M58490,-1256.91C58490,-1246.2 58490,-1234.62 58490,-1223.78"/>
<polygon fill="black" stroke="black" points="58493.5,-1223.67 58490,-1213.67 58486.5,-1223.67 58493.5,-1223.67"/>
</g>
<!-- layer3_expert11_9&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1025" class="edge">
<title>layer3_expert11_9&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M58615.39,-1256.91C58595.2,-1244.6 58573.09,-1231.13 58553.13,-1218.97"/>
<polygon fill="black" stroke="black" points="58554.79,-1215.88 58544.43,-1213.67 58551.15,-1221.86 58554.79,-1215.88"/>
</g>
<!-- layer3_expert11_10&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1026" class="edge">
<title>layer3_expert11_10&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M58786.82,-1260.11C58783.86,-1259.04 58780.91,-1257.99 58778,-1257 58722.12,-1237.9 58658.82,-1220.62 58605.82,-1207.34"/>
<polygon fill="black" stroke="black" points="58606.59,-1203.93 58596.05,-1204.91 58604.9,-1210.72 58606.59,-1203.93"/>
</g>
<!-- layer3_expert11_11&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1027" class="edge">
<title>layer3_expert11_11&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M58978.94,-1259.72C58975.94,-1258.76 58972.96,-1257.85 58970,-1257 58848.42,-1222.22 58704.71,-1201.94 58606.43,-1191.11"/>
<polygon fill="black" stroke="black" points="58606.79,-1187.63 58596.47,-1190.03 58606.03,-1194.59 58606.79,-1187.63"/>
</g>
<!-- layer3_expert11_12&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1028" class="edge">
<title>layer3_expert11_12&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M59170.99,-1259.55C59167.98,-1258.63 59164.97,-1257.78 59162,-1257 58971.46,-1207.07 58742.07,-1189.73 58606.58,-1183.7"/>
<polygon fill="black" stroke="black" points="58606.32,-1180.19 58596.18,-1183.26 58606.02,-1187.18 58606.32,-1180.19"/>
</g>
<!-- layer3_expert11_13&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1029" class="edge">
<title>layer3_expert11_13&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M59362.75,-1259.37C59359.82,-1258.52 59356.9,-1257.72 59354,-1257 59215.5,-1222.55 58808.42,-1197.18 58606.42,-1186.32"/>
<polygon fill="black" stroke="black" points="58606.54,-1182.83 58596.37,-1185.79 58606.17,-1189.82 58606.54,-1182.83"/>
</g>
<!-- layer3_expert11_14&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1030" class="edge">
<title>layer3_expert11_14&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M59554.77,-1259.31C59551.83,-1258.47 59548.9,-1257.7 59546,-1257 59370.46,-1214.83 58842.59,-1192.33 58606.42,-1184.15"/>
<polygon fill="black" stroke="black" points="58606.54,-1180.65 58596.42,-1183.81 58606.3,-1187.65 58606.54,-1180.65"/>
</g>
<!-- layer3_expert11_15&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1031" class="edge">
<title>layer3_expert11_15&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M59746.78,-1259.27C59743.84,-1258.44 59740.91,-1257.68 59738,-1257 59525.03,-1207.09 58873.93,-1188.35 58606.52,-1182.64"/>
<polygon fill="black" stroke="black" points="58606.47,-1179.14 58596.39,-1182.42 58606.32,-1186.13 58606.47,-1179.14"/>
</g>
<!-- layer3_output_gpu11 -->
<g id="node619" class="node">
<title>layer3_output_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="59268.5,-1102 59015.5,-1102 59015.5,-1034 59268.5,-1034 59268.5,-1102"/>
<text text-anchor="middle" x="59142" y="-1086.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="59142" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="59142" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="59142" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_moe_agg_gpu11&#45;&gt;layer3_output_gpu11 -->
<g id="edge1032" class="edge">
<title>layer3_moe_agg_gpu11&#45;&gt;layer3_output_gpu11</title>
<path fill="none" stroke="black" d="M58596.21,-1160.66C58707.73,-1141.93 58883.49,-1112.42 59005.3,-1091.96"/>
<polygon fill="black" stroke="black" points="59006.16,-1095.36 59015.44,-1090.26 59005,-1088.46 59006.16,-1095.36"/>
</g>
<!-- layer3_output_gpu11&#45;&gt;output -->
<g id="edge1180" class="edge">
<title>layer3_output_gpu11&#45;&gt;output</title>
<path fill="none" stroke="black" d="M59268.88,-1042.66C59402.23,-1017.07 59612.69,-976.69 59760.03,-948.42"/>
<polygon fill="black" stroke="black" points="59760.93,-951.81 59770.09,-946.49 59759.61,-944.94 59760.93,-951.81"/>
</g>
<!-- layer3_qkv_gpu12 -->
<g id="node620" class="node">
<title>layer3_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="61572,-1778.48 61360,-1778.48 61360,-1710.48 61572,-1710.48 61572,-1778.48"/>
<text text-anchor="middle" x="61466" y="-1763.28" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU12</text>
<text text-anchor="middle" x="61466" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="61466" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="61466" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_attn_gpu12 -->
<g id="node621" class="node">
<title>layer3_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="61592,-1667 61340,-1667 61340,-1599 61592,-1599 61592,-1667"/>
<text text-anchor="middle" x="61466" y="-1651.8" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU12</text>
<text text-anchor="middle" x="61466" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="61466" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="61466" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_qkv_gpu12&#45;&gt;layer3_attn_gpu12 -->
<g id="edge1033" class="edge">
<title>layer3_qkv_gpu12&#45;&gt;layer3_attn_gpu12</title>
<path fill="none" stroke="black" d="M61466,-1710.33C61466,-1699.94 61466,-1688.3 61466,-1677.31"/>
<polygon fill="black" stroke="black" points="61469.5,-1677.03 61466,-1667.03 61462.5,-1677.03 61469.5,-1677.03"/>
</g>
<!-- layer3_attn_norm_gpu12 -->
<g id="node622" class="node">
<title>layer3_attn_norm_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="61592.5,-1563 61339.5,-1563 61339.5,-1495 61592.5,-1495 61592.5,-1563"/>
<text text-anchor="middle" x="61466" y="-1547.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="61466" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="61466" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="61466" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_attn_gpu12&#45;&gt;layer3_attn_norm_gpu12 -->
<g id="edge1034" class="edge">
<title>layer3_attn_gpu12&#45;&gt;layer3_attn_norm_gpu12</title>
<path fill="none" stroke="black" d="M61466,-1598.88C61466,-1590.78 61466,-1581.98 61466,-1573.47"/>
<polygon fill="black" stroke="black" points="61469.5,-1573.3 61466,-1563.3 61462.5,-1573.3 61469.5,-1573.3"/>
</g>
<!-- layer3_gate_gpu12 -->
<g id="node623" class="node">
<title>layer3_gate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="61588,-1459 61344,-1459 61344,-1376 61588,-1376 61588,-1459"/>
<text text-anchor="middle" x="61466" y="-1443.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU12</text>
<text text-anchor="middle" x="61466" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="61466" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="61466" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="61466" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_attn_norm_gpu12&#45;&gt;layer3_gate_gpu12 -->
<g id="edge1035" class="edge">
<title>layer3_attn_norm_gpu12&#45;&gt;layer3_gate_gpu12</title>
<path fill="none" stroke="black" d="M61466,-1494.85C61466,-1486.8 61466,-1478 61466,-1469.34"/>
<polygon fill="black" stroke="black" points="61469.5,-1469.28 61466,-1459.28 61462.5,-1469.28 61469.5,-1469.28"/>
</g>
<!-- layer3_expert12_0 -->
<g id="node624" class="node">
<title>layer3_expert12_0</title>
<polygon fill="lightgreen" stroke="black" points="60113,-1340 59939,-1340 59939,-1257 60113,-1257 60113,-1340"/>
<text text-anchor="middle" x="60026" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU12</text>
<text text-anchor="middle" x="60026" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="60026" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="60026" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="60026" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_0 -->
<g id="edge1036" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61343.85,-1414.87C61061.89,-1410.26 60371.51,-1393.9 60123.29,-1340.01"/>
<polygon fill="black" stroke="black" points="60123.75,-1336.52 60113.22,-1337.75 60122.21,-1343.35 60123.75,-1336.52"/>
</g>
<!-- layer3_expert12_1 -->
<g id="node625" class="node">
<title>layer3_expert12_1</title>
<polygon fill="lightgreen" stroke="black" points="60305,-1340 60131,-1340 60131,-1257 60305,-1257 60305,-1340"/>
<text text-anchor="middle" x="60218" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU12</text>
<text text-anchor="middle" x="60218" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="60218" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="60218" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="60218" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_1 -->
<g id="edge1037" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61343.68,-1413.51C61092.53,-1406.54 60525.38,-1386.35 60315.26,-1340.01"/>
<polygon fill="black" stroke="black" points="60315.76,-1336.53 60305.23,-1337.71 60314.2,-1343.35 60315.76,-1336.53"/>
</g>
<!-- layer3_expert12_2 -->
<g id="node626" class="node">
<title>layer3_expert12_2</title>
<polygon fill="lightgreen" stroke="black" points="60497,-1340 60323,-1340 60323,-1257 60497,-1257 60497,-1340"/>
<text text-anchor="middle" x="60410" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU12</text>
<text text-anchor="middle" x="60410" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="60410" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="60410" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="60410" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_2 -->
<g id="edge1038" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61343.94,-1411.63C61126.49,-1402.15 60679.52,-1378.91 60507.21,-1340"/>
<polygon fill="black" stroke="black" points="60507.78,-1336.54 60497.24,-1337.66 60506.17,-1343.36 60507.78,-1336.54"/>
</g>
<!-- layer3_expert12_3 -->
<g id="node627" class="node">
<title>layer3_expert12_3</title>
<polygon fill="lightgreen" stroke="black" points="60689,-1340 60515,-1340 60515,-1257 60689,-1257 60689,-1340"/>
<text text-anchor="middle" x="60602" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU12</text>
<text text-anchor="middle" x="60602" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="60602" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="60602" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="60602" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_3 -->
<g id="edge1039" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61343.67,-1415.54C61192.64,-1411.85 60928.63,-1397.19 60699.13,-1340.07"/>
<polygon fill="black" stroke="black" points="60699.81,-1336.63 60689.26,-1337.58 60698.1,-1343.42 60699.81,-1336.63"/>
</g>
<!-- layer3_expert12_4 -->
<g id="node628" class="node">
<title>layer3_expert12_4</title>
<polygon fill="lightgreen" stroke="black" points="60881,-1340 60707,-1340 60707,-1257 60881,-1257 60881,-1340"/>
<text text-anchor="middle" x="60794" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU12</text>
<text text-anchor="middle" x="60794" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="60794" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="60794" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="60794" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_4 -->
<g id="edge1040" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61343.89,-1409.76C61228.42,-1401.23 61050.78,-1382.5 60891.04,-1340.07"/>
<polygon fill="black" stroke="black" points="60891.59,-1336.6 60881.03,-1337.38 60889.77,-1343.36 60891.59,-1336.6"/>
</g>
<!-- layer3_expert12_5 -->
<g id="node629" class="node">
<title>layer3_expert12_5</title>
<polygon fill="lightgreen" stroke="black" points="61073,-1340 60899,-1340 60899,-1257 61073,-1257 61073,-1340"/>
<text text-anchor="middle" x="60986" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU12</text>
<text text-anchor="middle" x="60986" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="60986" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="60986" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="60986" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_5 -->
<g id="edge1041" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61343.8,-1398.65C61270.17,-1386.36 61174.72,-1367.72 61082.84,-1340.09"/>
<polygon fill="black" stroke="black" points="61083.69,-1336.69 61073.1,-1337.13 61081.65,-1343.39 61083.69,-1336.69"/>
</g>
<!-- layer3_expert12_6 -->
<g id="node630" class="node">
<title>layer3_expert12_6</title>
<polygon fill="lightgreen" stroke="black" points="61265,-1340 61091,-1340 61091,-1257 61265,-1257 61265,-1340"/>
<text text-anchor="middle" x="61178" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU12</text>
<text text-anchor="middle" x="61178" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="61178" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="61178" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="61178" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_6 -->
<g id="edge1042" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61363.21,-1375.99C61336.79,-1365.46 61308.27,-1354.01 61274.69,-1340.27"/>
<polygon fill="black" stroke="black" points="61275.67,-1336.88 61265.09,-1336.33 61273.01,-1343.36 61275.67,-1336.88"/>
</g>
<!-- layer3_expert12_7 -->
<g id="node631" class="node">
<title>layer3_expert12_7</title>
<polygon fill="lightgreen" stroke="black" points="61457,-1340 61283,-1340 61283,-1257 61457,-1257 61457,-1340"/>
<text text-anchor="middle" x="61370" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU12</text>
<text text-anchor="middle" x="61370" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="61370" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="61370" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="61370" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_7 -->
<g id="edge1043" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61432.69,-1375.91C61425.25,-1366.83 61417.28,-1357.12 61409.61,-1347.77"/>
<polygon fill="black" stroke="black" points="61412.3,-1345.53 61403.25,-1340.02 61406.89,-1349.97 61412.3,-1345.53"/>
</g>
<!-- layer3_expert12_8 -->
<g id="node632" class="node">
<title>layer3_expert12_8</title>
<polygon fill="lightgreen" stroke="black" points="61649,-1340 61475,-1340 61475,-1257 61649,-1257 61649,-1340"/>
<text text-anchor="middle" x="61562" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU12</text>
<text text-anchor="middle" x="61562" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="61562" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="61562" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="61562" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_8 -->
<g id="edge1044" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61499.31,-1375.91C61506.75,-1366.83 61514.72,-1357.12 61522.39,-1347.77"/>
<polygon fill="black" stroke="black" points="61525.11,-1349.97 61528.75,-1340.02 61519.7,-1345.53 61525.11,-1349.97"/>
</g>
<!-- layer3_expert12_9 -->
<g id="node633" class="node">
<title>layer3_expert12_9</title>
<polygon fill="lightgreen" stroke="black" points="61841,-1340 61667,-1340 61667,-1257 61841,-1257 61841,-1340"/>
<text text-anchor="middle" x="61754" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU12</text>
<text text-anchor="middle" x="61754" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="61754" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="61754" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="61754" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_9 -->
<g id="edge1045" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61568.79,-1375.99C61595.21,-1365.46 61623.73,-1354.01 61657.31,-1340.27"/>
<polygon fill="black" stroke="black" points="61658.99,-1343.36 61666.91,-1336.33 61656.33,-1336.88 61658.99,-1343.36"/>
</g>
<!-- layer3_expert12_10 -->
<g id="node634" class="node">
<title>layer3_expert12_10</title>
<polygon fill="lightgreen" stroke="black" points="62033,-1340 61859,-1340 61859,-1257 62033,-1257 62033,-1340"/>
<text text-anchor="middle" x="61946" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU12</text>
<text text-anchor="middle" x="61946" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="61946" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="61946" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="61946" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_10 -->
<g id="edge1046" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61588.2,-1398.65C61661.83,-1386.36 61757.28,-1367.72 61849.16,-1340.09"/>
<polygon fill="black" stroke="black" points="61850.35,-1343.39 61858.9,-1337.13 61848.31,-1336.69 61850.35,-1343.39"/>
</g>
<!-- layer3_expert12_11 -->
<g id="node635" class="node">
<title>layer3_expert12_11</title>
<polygon fill="lightgreen" stroke="black" points="62225,-1340 62051,-1340 62051,-1257 62225,-1257 62225,-1340"/>
<text text-anchor="middle" x="62138" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU12</text>
<text text-anchor="middle" x="62138" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="62138" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="62138" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="62138" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_11 -->
<g id="edge1047" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61588.11,-1409.76C61703.58,-1401.23 61881.22,-1382.5 62040.96,-1340.07"/>
<polygon fill="black" stroke="black" points="62042.23,-1343.36 62050.97,-1337.38 62040.41,-1336.6 62042.23,-1343.36"/>
</g>
<!-- layer3_expert12_12 -->
<g id="node636" class="node">
<title>layer3_expert12_12</title>
<polygon fill="lightgreen" stroke="black" points="62417,-1340 62243,-1340 62243,-1257 62417,-1257 62417,-1340"/>
<text text-anchor="middle" x="62330" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU12</text>
<text text-anchor="middle" x="62330" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="62330" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="62330" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="62330" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_12 -->
<g id="edge1048" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61588.33,-1415.54C61739.36,-1411.85 62003.37,-1397.19 62232.87,-1340.07"/>
<polygon fill="black" stroke="black" points="62233.9,-1343.42 62242.74,-1337.58 62232.19,-1336.63 62233.9,-1343.42"/>
</g>
<!-- layer3_expert12_13 -->
<g id="node637" class="node">
<title>layer3_expert12_13</title>
<polygon fill="lightgreen" stroke="black" points="62609,-1340 62435,-1340 62435,-1257 62609,-1257 62609,-1340"/>
<text text-anchor="middle" x="62522" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU12</text>
<text text-anchor="middle" x="62522" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="62522" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="62522" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="62522" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_13 -->
<g id="edge1049" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61588.06,-1411.63C61805.51,-1402.15 62252.48,-1378.91 62424.79,-1340"/>
<polygon fill="black" stroke="black" points="62425.83,-1343.36 62434.76,-1337.66 62424.22,-1336.54 62425.83,-1343.36"/>
</g>
<!-- layer3_expert12_14 -->
<g id="node638" class="node">
<title>layer3_expert12_14</title>
<polygon fill="lightgreen" stroke="black" points="62801,-1340 62627,-1340 62627,-1257 62801,-1257 62801,-1340"/>
<text text-anchor="middle" x="62714" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU12</text>
<text text-anchor="middle" x="62714" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="62714" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="62714" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="62714" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_14 -->
<g id="edge1050" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61588.32,-1413.51C61839.47,-1406.54 62406.62,-1386.35 62616.74,-1340.01"/>
<polygon fill="black" stroke="black" points="62617.8,-1343.35 62626.77,-1337.71 62616.24,-1336.53 62617.8,-1343.35"/>
</g>
<!-- layer3_expert12_15 -->
<g id="node639" class="node">
<title>layer3_expert12_15</title>
<polygon fill="lightgreen" stroke="black" points="62993,-1340 62819,-1340 62819,-1257 62993,-1257 62993,-1340"/>
<text text-anchor="middle" x="62906" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU12</text>
<text text-anchor="middle" x="62906" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="62906" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="62906" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="62906" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_15 -->
<g id="edge1051" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61588.15,-1414.87C61870.11,-1410.26 62560.49,-1393.9 62808.71,-1340.01"/>
<polygon fill="black" stroke="black" points="62809.79,-1343.35 62818.78,-1337.75 62808.25,-1336.52 62809.79,-1343.35"/>
</g>
<!-- layer3_moe_agg_gpu12 -->
<g id="node640" class="node">
<title>layer3_moe_agg_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="61476,-1213.5 61264,-1213.5 61264,-1145.5 61476,-1145.5 61476,-1213.5"/>
<text text-anchor="middle" x="61370" y="-1198.3" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU12</text>
<text text-anchor="middle" x="61370" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="61370" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="61370" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_expert12_0&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1052" class="edge">
<title>layer3_expert12_0&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M60113.22,-1259.27C60116.16,-1258.44 60119.09,-1257.68 60122,-1257 60334.97,-1207.09 60986.07,-1188.35 61253.48,-1182.64"/>
<polygon fill="black" stroke="black" points="61253.68,-1186.13 61263.61,-1182.42 61253.53,-1179.14 61253.68,-1186.13"/>
</g>
<!-- layer3_expert12_1&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1053" class="edge">
<title>layer3_expert12_1&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M60305.23,-1259.31C60308.17,-1258.47 60311.1,-1257.7 60314,-1257 60489.54,-1214.83 61017.41,-1192.33 61253.58,-1184.15"/>
<polygon fill="black" stroke="black" points="61253.7,-1187.65 61263.58,-1183.81 61253.46,-1180.65 61253.7,-1187.65"/>
</g>
<!-- layer3_expert12_2&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1054" class="edge">
<title>layer3_expert12_2&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M60497.25,-1259.37C60500.18,-1258.52 60503.1,-1257.72 60506,-1257 60644.5,-1222.55 61051.58,-1197.18 61253.58,-1186.32"/>
<polygon fill="black" stroke="black" points="61253.83,-1189.82 61263.63,-1185.79 61253.46,-1182.83 61253.83,-1189.82"/>
</g>
<!-- layer3_expert12_3&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1055" class="edge">
<title>layer3_expert12_3&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M60689.01,-1259.55C60692.02,-1258.63 60695.03,-1257.78 60698,-1257 60888.54,-1207.07 61117.93,-1189.73 61253.42,-1183.7"/>
<polygon fill="black" stroke="black" points="61253.98,-1187.18 61263.82,-1183.26 61253.68,-1180.19 61253.98,-1187.18"/>
</g>
<!-- layer3_expert12_4&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1056" class="edge">
<title>layer3_expert12_4&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M60881.06,-1259.72C60884.06,-1258.76 60887.04,-1257.85 60890,-1257 61011.58,-1222.22 61155.29,-1201.94 61253.57,-1191.11"/>
<polygon fill="black" stroke="black" points="61253.97,-1194.59 61263.53,-1190.03 61253.21,-1187.63 61253.97,-1194.59"/>
</g>
<!-- layer3_expert12_5&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1057" class="edge">
<title>layer3_expert12_5&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M61073.18,-1260.11C61076.14,-1259.04 61079.09,-1257.99 61082,-1257 61137.88,-1237.9 61201.18,-1220.62 61254.18,-1207.34"/>
<polygon fill="black" stroke="black" points="61255.1,-1210.72 61263.95,-1204.91 61253.41,-1203.93 61255.1,-1210.72"/>
</g>
<!-- layer3_expert12_6&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1058" class="edge">
<title>layer3_expert12_6&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M61244.61,-1256.91C61264.8,-1244.6 61286.91,-1231.13 61306.87,-1218.97"/>
<polygon fill="black" stroke="black" points="61308.85,-1221.86 61315.57,-1213.67 61305.21,-1215.88 61308.85,-1221.86"/>
</g>
<!-- layer3_expert12_7&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1059" class="edge">
<title>layer3_expert12_7&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M61370,-1256.91C61370,-1246.2 61370,-1234.62 61370,-1223.78"/>
<polygon fill="black" stroke="black" points="61373.5,-1223.67 61370,-1213.67 61366.5,-1223.67 61373.5,-1223.67"/>
</g>
<!-- layer3_expert12_8&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1060" class="edge">
<title>layer3_expert12_8&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M61495.39,-1256.91C61475.2,-1244.6 61453.09,-1231.13 61433.13,-1218.97"/>
<polygon fill="black" stroke="black" points="61434.79,-1215.88 61424.43,-1213.67 61431.15,-1221.86 61434.79,-1215.88"/>
</g>
<!-- layer3_expert12_9&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1061" class="edge">
<title>layer3_expert12_9&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M61666.82,-1260.11C61663.86,-1259.04 61660.91,-1257.99 61658,-1257 61602.12,-1237.9 61538.82,-1220.62 61485.82,-1207.34"/>
<polygon fill="black" stroke="black" points="61486.59,-1203.93 61476.05,-1204.91 61484.9,-1210.72 61486.59,-1203.93"/>
</g>
<!-- layer3_expert12_10&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1062" class="edge">
<title>layer3_expert12_10&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M61858.94,-1259.72C61855.94,-1258.76 61852.96,-1257.85 61850,-1257 61728.42,-1222.22 61584.71,-1201.94 61486.43,-1191.11"/>
<polygon fill="black" stroke="black" points="61486.79,-1187.63 61476.47,-1190.03 61486.03,-1194.59 61486.79,-1187.63"/>
</g>
<!-- layer3_expert12_11&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1063" class="edge">
<title>layer3_expert12_11&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M62050.99,-1259.55C62047.98,-1258.63 62044.97,-1257.78 62042,-1257 61851.46,-1207.07 61622.07,-1189.73 61486.58,-1183.7"/>
<polygon fill="black" stroke="black" points="61486.32,-1180.19 61476.18,-1183.26 61486.02,-1187.18 61486.32,-1180.19"/>
</g>
<!-- layer3_expert12_12&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1064" class="edge">
<title>layer3_expert12_12&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M62242.75,-1259.37C62239.82,-1258.52 62236.9,-1257.72 62234,-1257 62095.5,-1222.55 61688.42,-1197.18 61486.42,-1186.32"/>
<polygon fill="black" stroke="black" points="61486.54,-1182.83 61476.37,-1185.79 61486.17,-1189.82 61486.54,-1182.83"/>
</g>
<!-- layer3_expert12_13&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1065" class="edge">
<title>layer3_expert12_13&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M62434.77,-1259.31C62431.83,-1258.47 62428.9,-1257.7 62426,-1257 62250.46,-1214.83 61722.59,-1192.33 61486.42,-1184.15"/>
<polygon fill="black" stroke="black" points="61486.54,-1180.65 61476.42,-1183.81 61486.3,-1187.65 61486.54,-1180.65"/>
</g>
<!-- layer3_expert12_14&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1066" class="edge">
<title>layer3_expert12_14&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M62626.78,-1259.27C62623.84,-1258.44 62620.91,-1257.68 62618,-1257 62405.03,-1207.09 61753.93,-1188.35 61486.52,-1182.64"/>
<polygon fill="black" stroke="black" points="61486.47,-1179.14 61476.39,-1182.42 61486.32,-1186.13 61486.47,-1179.14"/>
</g>
<!-- layer3_expert12_15&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1067" class="edge">
<title>layer3_expert12_15&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M62818.78,-1259.24C62815.84,-1258.42 62812.91,-1257.67 62810,-1257 62559.24,-1199.3 61782.71,-1184.94 61486.46,-1181.52"/>
<polygon fill="black" stroke="black" points="61486.17,-1178.02 61476.13,-1181.4 61486.09,-1185.02 61486.17,-1178.02"/>
</g>
<!-- layer3_output_gpu12 -->
<g id="node641" class="node">
<title>layer3_output_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="60843.5,-1102 60590.5,-1102 60590.5,-1034 60843.5,-1034 60843.5,-1102"/>
<text text-anchor="middle" x="60717" y="-1086.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="60717" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="60717" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="60717" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_moe_agg_gpu12&#45;&gt;layer3_output_gpu12 -->
<g id="edge1068" class="edge">
<title>layer3_moe_agg_gpu12&#45;&gt;layer3_output_gpu12</title>
<path fill="none" stroke="black" d="M61263.99,-1160.72C61152.28,-1141.99 60975.92,-1112.42 60853.78,-1091.94"/>
<polygon fill="black" stroke="black" points="60854.06,-1088.43 60843.61,-1090.23 60852.9,-1095.34 60854.06,-1088.43"/>
</g>
<!-- layer3_output_gpu12&#45;&gt;output -->
<g id="edge1181" class="edge">
<title>layer3_output_gpu12&#45;&gt;output</title>
<path fill="none" stroke="black" d="M60590.39,-1042.74C60456.85,-1017.15 60245.72,-976.69 60098.02,-948.39"/>
<polygon fill="black" stroke="black" points="60098.42,-944.9 60087.94,-946.46 60097.11,-951.78 60098.42,-944.9"/>
</g>
<!-- layer3_qkv_gpu13 -->
<g id="node642" class="node">
<title>layer3_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="64644,-1778.48 64432,-1778.48 64432,-1710.48 64644,-1710.48 64644,-1778.48"/>
<text text-anchor="middle" x="64538" y="-1763.28" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU13</text>
<text text-anchor="middle" x="64538" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="64538" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="64538" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_attn_gpu13 -->
<g id="node643" class="node">
<title>layer3_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="64664,-1667 64412,-1667 64412,-1599 64664,-1599 64664,-1667"/>
<text text-anchor="middle" x="64538" y="-1651.8" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU13</text>
<text text-anchor="middle" x="64538" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="64538" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="64538" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_qkv_gpu13&#45;&gt;layer3_attn_gpu13 -->
<g id="edge1069" class="edge">
<title>layer3_qkv_gpu13&#45;&gt;layer3_attn_gpu13</title>
<path fill="none" stroke="black" d="M64538,-1710.33C64538,-1699.94 64538,-1688.3 64538,-1677.31"/>
<polygon fill="black" stroke="black" points="64541.5,-1677.03 64538,-1667.03 64534.5,-1677.03 64541.5,-1677.03"/>
</g>
<!-- layer3_attn_norm_gpu13 -->
<g id="node644" class="node">
<title>layer3_attn_norm_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="64664.5,-1563 64411.5,-1563 64411.5,-1495 64664.5,-1495 64664.5,-1563"/>
<text text-anchor="middle" x="64538" y="-1547.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="64538" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="64538" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="64538" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_attn_gpu13&#45;&gt;layer3_attn_norm_gpu13 -->
<g id="edge1070" class="edge">
<title>layer3_attn_gpu13&#45;&gt;layer3_attn_norm_gpu13</title>
<path fill="none" stroke="black" d="M64538,-1598.88C64538,-1590.78 64538,-1581.98 64538,-1573.47"/>
<polygon fill="black" stroke="black" points="64541.5,-1573.3 64538,-1563.3 64534.5,-1573.3 64541.5,-1573.3"/>
</g>
<!-- layer3_gate_gpu13 -->
<g id="node645" class="node">
<title>layer3_gate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="64660,-1459 64416,-1459 64416,-1376 64660,-1376 64660,-1459"/>
<text text-anchor="middle" x="64538" y="-1443.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU13</text>
<text text-anchor="middle" x="64538" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="64538" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="64538" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="64538" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_attn_norm_gpu13&#45;&gt;layer3_gate_gpu13 -->
<g id="edge1071" class="edge">
<title>layer3_attn_norm_gpu13&#45;&gt;layer3_gate_gpu13</title>
<path fill="none" stroke="black" d="M64538,-1494.85C64538,-1486.8 64538,-1478 64538,-1469.34"/>
<polygon fill="black" stroke="black" points="64541.5,-1469.28 64538,-1459.28 64534.5,-1469.28 64541.5,-1469.28"/>
</g>
<!-- layer3_expert13_0 -->
<g id="node646" class="node">
<title>layer3_expert13_0</title>
<polygon fill="lightgreen" stroke="black" points="63185,-1340 63011,-1340 63011,-1257 63185,-1257 63185,-1340"/>
<text text-anchor="middle" x="63098" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU13</text>
<text text-anchor="middle" x="63098" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="63098" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="63098" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="63098" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_0 -->
<g id="edge1072" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64415.85,-1414.87C64133.89,-1410.26 63443.51,-1393.9 63195.29,-1340.01"/>
<polygon fill="black" stroke="black" points="63195.75,-1336.52 63185.22,-1337.75 63194.21,-1343.35 63195.75,-1336.52"/>
</g>
<!-- layer3_expert13_1 -->
<g id="node647" class="node">
<title>layer3_expert13_1</title>
<polygon fill="lightgreen" stroke="black" points="63377,-1340 63203,-1340 63203,-1257 63377,-1257 63377,-1340"/>
<text text-anchor="middle" x="63290" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU13</text>
<text text-anchor="middle" x="63290" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="63290" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="63290" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="63290" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_1 -->
<g id="edge1073" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64415.68,-1413.51C64164.53,-1406.54 63597.38,-1386.35 63387.26,-1340.01"/>
<polygon fill="black" stroke="black" points="63387.76,-1336.53 63377.23,-1337.71 63386.2,-1343.35 63387.76,-1336.53"/>
</g>
<!-- layer3_expert13_2 -->
<g id="node648" class="node">
<title>layer3_expert13_2</title>
<polygon fill="lightgreen" stroke="black" points="63569,-1340 63395,-1340 63395,-1257 63569,-1257 63569,-1340"/>
<text text-anchor="middle" x="63482" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU13</text>
<text text-anchor="middle" x="63482" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="63482" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="63482" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="63482" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_2 -->
<g id="edge1074" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64415.94,-1411.63C64198.49,-1402.15 63751.52,-1378.91 63579.21,-1340"/>
<polygon fill="black" stroke="black" points="63579.78,-1336.54 63569.24,-1337.66 63578.17,-1343.36 63579.78,-1336.54"/>
</g>
<!-- layer3_expert13_3 -->
<g id="node649" class="node">
<title>layer3_expert13_3</title>
<polygon fill="lightgreen" stroke="black" points="63761,-1340 63587,-1340 63587,-1257 63761,-1257 63761,-1340"/>
<text text-anchor="middle" x="63674" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU13</text>
<text text-anchor="middle" x="63674" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="63674" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="63674" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="63674" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_3 -->
<g id="edge1075" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64415.67,-1415.54C64264.64,-1411.85 64000.63,-1397.19 63771.13,-1340.07"/>
<polygon fill="black" stroke="black" points="63771.81,-1336.63 63761.26,-1337.58 63770.1,-1343.42 63771.81,-1336.63"/>
</g>
<!-- layer3_expert13_4 -->
<g id="node650" class="node">
<title>layer3_expert13_4</title>
<polygon fill="lightgreen" stroke="black" points="63953,-1340 63779,-1340 63779,-1257 63953,-1257 63953,-1340"/>
<text text-anchor="middle" x="63866" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU13</text>
<text text-anchor="middle" x="63866" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="63866" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="63866" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="63866" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_4 -->
<g id="edge1076" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64415.89,-1409.76C64300.42,-1401.23 64122.78,-1382.5 63963.04,-1340.07"/>
<polygon fill="black" stroke="black" points="63963.59,-1336.6 63953.03,-1337.38 63961.77,-1343.36 63963.59,-1336.6"/>
</g>
<!-- layer3_expert13_5 -->
<g id="node651" class="node">
<title>layer3_expert13_5</title>
<polygon fill="lightgreen" stroke="black" points="64145,-1340 63971,-1340 63971,-1257 64145,-1257 64145,-1340"/>
<text text-anchor="middle" x="64058" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU13</text>
<text text-anchor="middle" x="64058" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="64058" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="64058" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="64058" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_5 -->
<g id="edge1077" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64415.8,-1398.65C64342.17,-1386.36 64246.72,-1367.72 64154.84,-1340.09"/>
<polygon fill="black" stroke="black" points="64155.69,-1336.69 64145.1,-1337.13 64153.65,-1343.39 64155.69,-1336.69"/>
</g>
<!-- layer3_expert13_6 -->
<g id="node652" class="node">
<title>layer3_expert13_6</title>
<polygon fill="lightgreen" stroke="black" points="64337,-1340 64163,-1340 64163,-1257 64337,-1257 64337,-1340"/>
<text text-anchor="middle" x="64250" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU13</text>
<text text-anchor="middle" x="64250" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="64250" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="64250" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="64250" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_6 -->
<g id="edge1078" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64435.21,-1375.99C64408.79,-1365.46 64380.27,-1354.01 64346.69,-1340.27"/>
<polygon fill="black" stroke="black" points="64347.67,-1336.88 64337.09,-1336.33 64345.01,-1343.36 64347.67,-1336.88"/>
</g>
<!-- layer3_expert13_7 -->
<g id="node653" class="node">
<title>layer3_expert13_7</title>
<polygon fill="lightgreen" stroke="black" points="64529,-1340 64355,-1340 64355,-1257 64529,-1257 64529,-1340"/>
<text text-anchor="middle" x="64442" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU13</text>
<text text-anchor="middle" x="64442" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="64442" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="64442" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="64442" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_7 -->
<g id="edge1079" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64504.69,-1375.91C64497.25,-1366.83 64489.28,-1357.12 64481.61,-1347.77"/>
<polygon fill="black" stroke="black" points="64484.3,-1345.53 64475.25,-1340.02 64478.89,-1349.97 64484.3,-1345.53"/>
</g>
<!-- layer3_expert13_8 -->
<g id="node654" class="node">
<title>layer3_expert13_8</title>
<polygon fill="lightgreen" stroke="black" points="64721,-1340 64547,-1340 64547,-1257 64721,-1257 64721,-1340"/>
<text text-anchor="middle" x="64634" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU13</text>
<text text-anchor="middle" x="64634" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="64634" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="64634" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="64634" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_8 -->
<g id="edge1080" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64571.31,-1375.91C64578.75,-1366.83 64586.72,-1357.12 64594.39,-1347.77"/>
<polygon fill="black" stroke="black" points="64597.11,-1349.97 64600.75,-1340.02 64591.7,-1345.53 64597.11,-1349.97"/>
</g>
<!-- layer3_expert13_9 -->
<g id="node655" class="node">
<title>layer3_expert13_9</title>
<polygon fill="lightgreen" stroke="black" points="64913,-1340 64739,-1340 64739,-1257 64913,-1257 64913,-1340"/>
<text text-anchor="middle" x="64826" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU13</text>
<text text-anchor="middle" x="64826" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="64826" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="64826" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="64826" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_9 -->
<g id="edge1081" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64640.79,-1375.99C64667.21,-1365.46 64695.73,-1354.01 64729.31,-1340.27"/>
<polygon fill="black" stroke="black" points="64730.99,-1343.36 64738.91,-1336.33 64728.33,-1336.88 64730.99,-1343.36"/>
</g>
<!-- layer3_expert13_10 -->
<g id="node656" class="node">
<title>layer3_expert13_10</title>
<polygon fill="lightgreen" stroke="black" points="65105,-1340 64931,-1340 64931,-1257 65105,-1257 65105,-1340"/>
<text text-anchor="middle" x="65018" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU13</text>
<text text-anchor="middle" x="65018" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="65018" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="65018" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="65018" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_10 -->
<g id="edge1082" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64660.2,-1398.65C64733.83,-1386.36 64829.28,-1367.72 64921.16,-1340.09"/>
<polygon fill="black" stroke="black" points="64922.35,-1343.39 64930.9,-1337.13 64920.31,-1336.69 64922.35,-1343.39"/>
</g>
<!-- layer3_expert13_11 -->
<g id="node657" class="node">
<title>layer3_expert13_11</title>
<polygon fill="lightgreen" stroke="black" points="65297,-1340 65123,-1340 65123,-1257 65297,-1257 65297,-1340"/>
<text text-anchor="middle" x="65210" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU13</text>
<text text-anchor="middle" x="65210" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="65210" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="65210" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="65210" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_11 -->
<g id="edge1083" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64660.11,-1409.76C64775.58,-1401.23 64953.22,-1382.5 65112.96,-1340.07"/>
<polygon fill="black" stroke="black" points="65114.23,-1343.36 65122.97,-1337.38 65112.41,-1336.6 65114.23,-1343.36"/>
</g>
<!-- layer3_expert13_12 -->
<g id="node658" class="node">
<title>layer3_expert13_12</title>
<polygon fill="lightgreen" stroke="black" points="65489,-1340 65315,-1340 65315,-1257 65489,-1257 65489,-1340"/>
<text text-anchor="middle" x="65402" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU13</text>
<text text-anchor="middle" x="65402" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="65402" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="65402" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="65402" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_12 -->
<g id="edge1084" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64660.33,-1415.54C64811.36,-1411.85 65075.37,-1397.19 65304.87,-1340.07"/>
<polygon fill="black" stroke="black" points="65305.9,-1343.42 65314.74,-1337.58 65304.19,-1336.63 65305.9,-1343.42"/>
</g>
<!-- layer3_expert13_13 -->
<g id="node659" class="node">
<title>layer3_expert13_13</title>
<polygon fill="lightgreen" stroke="black" points="65681,-1340 65507,-1340 65507,-1257 65681,-1257 65681,-1340"/>
<text text-anchor="middle" x="65594" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU13</text>
<text text-anchor="middle" x="65594" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="65594" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="65594" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="65594" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_13 -->
<g id="edge1085" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64660.06,-1411.63C64877.51,-1402.15 65324.48,-1378.91 65496.79,-1340"/>
<polygon fill="black" stroke="black" points="65497.83,-1343.36 65506.76,-1337.66 65496.22,-1336.54 65497.83,-1343.36"/>
</g>
<!-- layer3_expert13_14 -->
<g id="node660" class="node">
<title>layer3_expert13_14</title>
<polygon fill="lightgreen" stroke="black" points="65873,-1340 65699,-1340 65699,-1257 65873,-1257 65873,-1340"/>
<text text-anchor="middle" x="65786" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU13</text>
<text text-anchor="middle" x="65786" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="65786" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="65786" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="65786" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_14 -->
<g id="edge1086" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64660.32,-1413.51C64911.47,-1406.54 65478.62,-1386.35 65688.74,-1340.01"/>
<polygon fill="black" stroke="black" points="65689.8,-1343.35 65698.77,-1337.71 65688.24,-1336.53 65689.8,-1343.35"/>
</g>
<!-- layer3_expert13_15 -->
<g id="node661" class="node">
<title>layer3_expert13_15</title>
<polygon fill="lightgreen" stroke="black" points="66065,-1340 65891,-1340 65891,-1257 66065,-1257 66065,-1340"/>
<text text-anchor="middle" x="65978" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU13</text>
<text text-anchor="middle" x="65978" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="65978" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="65978" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="65978" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_15 -->
<g id="edge1087" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64660.15,-1414.87C64942.11,-1410.26 65632.49,-1393.9 65880.71,-1340.01"/>
<polygon fill="black" stroke="black" points="65881.79,-1343.35 65890.78,-1337.75 65880.25,-1336.52 65881.79,-1343.35"/>
</g>
<!-- layer3_moe_agg_gpu13 -->
<g id="node662" class="node">
<title>layer3_moe_agg_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="64548,-1213.5 64336,-1213.5 64336,-1145.5 64548,-1145.5 64548,-1213.5"/>
<text text-anchor="middle" x="64442" y="-1198.3" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU13</text>
<text text-anchor="middle" x="64442" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="64442" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="64442" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_expert13_0&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1088" class="edge">
<title>layer3_expert13_0&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M63185.22,-1259.27C63188.16,-1258.44 63191.09,-1257.68 63194,-1257 63406.97,-1207.09 64058.07,-1188.35 64325.48,-1182.64"/>
<polygon fill="black" stroke="black" points="64325.68,-1186.13 64335.61,-1182.42 64325.53,-1179.14 64325.68,-1186.13"/>
</g>
<!-- layer3_expert13_1&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1089" class="edge">
<title>layer3_expert13_1&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M63377.23,-1259.31C63380.17,-1258.47 63383.1,-1257.7 63386,-1257 63561.54,-1214.83 64089.41,-1192.33 64325.58,-1184.15"/>
<polygon fill="black" stroke="black" points="64325.7,-1187.65 64335.58,-1183.81 64325.46,-1180.65 64325.7,-1187.65"/>
</g>
<!-- layer3_expert13_2&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1090" class="edge">
<title>layer3_expert13_2&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M63569.25,-1259.37C63572.18,-1258.52 63575.1,-1257.72 63578,-1257 63716.5,-1222.55 64123.58,-1197.18 64325.58,-1186.32"/>
<polygon fill="black" stroke="black" points="64325.83,-1189.82 64335.63,-1185.79 64325.46,-1182.83 64325.83,-1189.82"/>
</g>
<!-- layer3_expert13_3&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1091" class="edge">
<title>layer3_expert13_3&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M63761.01,-1259.55C63764.02,-1258.63 63767.03,-1257.78 63770,-1257 63960.54,-1207.07 64189.93,-1189.73 64325.42,-1183.7"/>
<polygon fill="black" stroke="black" points="64325.98,-1187.18 64335.82,-1183.26 64325.68,-1180.19 64325.98,-1187.18"/>
</g>
<!-- layer3_expert13_4&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1092" class="edge">
<title>layer3_expert13_4&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M63953.06,-1259.72C63956.06,-1258.76 63959.04,-1257.85 63962,-1257 64083.58,-1222.22 64227.29,-1201.94 64325.57,-1191.11"/>
<polygon fill="black" stroke="black" points="64325.97,-1194.59 64335.53,-1190.03 64325.21,-1187.63 64325.97,-1194.59"/>
</g>
<!-- layer3_expert13_5&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1093" class="edge">
<title>layer3_expert13_5&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M64145.18,-1260.11C64148.14,-1259.04 64151.09,-1257.99 64154,-1257 64209.88,-1237.9 64273.18,-1220.62 64326.18,-1207.34"/>
<polygon fill="black" stroke="black" points="64327.1,-1210.72 64335.95,-1204.91 64325.41,-1203.93 64327.1,-1210.72"/>
</g>
<!-- layer3_expert13_6&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1094" class="edge">
<title>layer3_expert13_6&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M64316.61,-1256.91C64336.8,-1244.6 64358.91,-1231.13 64378.87,-1218.97"/>
<polygon fill="black" stroke="black" points="64380.85,-1221.86 64387.57,-1213.67 64377.21,-1215.88 64380.85,-1221.86"/>
</g>
<!-- layer3_expert13_7&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1095" class="edge">
<title>layer3_expert13_7&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M64442,-1256.91C64442,-1246.2 64442,-1234.62 64442,-1223.78"/>
<polygon fill="black" stroke="black" points="64445.5,-1223.67 64442,-1213.67 64438.5,-1223.67 64445.5,-1223.67"/>
</g>
<!-- layer3_expert13_8&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1096" class="edge">
<title>layer3_expert13_8&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M64567.39,-1256.91C64547.2,-1244.6 64525.09,-1231.13 64505.13,-1218.97"/>
<polygon fill="black" stroke="black" points="64506.79,-1215.88 64496.43,-1213.67 64503.15,-1221.86 64506.79,-1215.88"/>
</g>
<!-- layer3_expert13_9&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1097" class="edge">
<title>layer3_expert13_9&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M64738.82,-1260.11C64735.86,-1259.04 64732.91,-1257.99 64730,-1257 64674.12,-1237.9 64610.82,-1220.62 64557.82,-1207.34"/>
<polygon fill="black" stroke="black" points="64558.59,-1203.93 64548.05,-1204.91 64556.9,-1210.72 64558.59,-1203.93"/>
</g>
<!-- layer3_expert13_10&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1098" class="edge">
<title>layer3_expert13_10&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M64930.94,-1259.72C64927.94,-1258.76 64924.96,-1257.85 64922,-1257 64800.42,-1222.22 64656.71,-1201.94 64558.43,-1191.11"/>
<polygon fill="black" stroke="black" points="64558.79,-1187.63 64548.47,-1190.03 64558.03,-1194.59 64558.79,-1187.63"/>
</g>
<!-- layer3_expert13_11&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1099" class="edge">
<title>layer3_expert13_11&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M65122.99,-1259.55C65119.98,-1258.63 65116.97,-1257.78 65114,-1257 64923.46,-1207.07 64694.07,-1189.73 64558.58,-1183.7"/>
<polygon fill="black" stroke="black" points="64558.32,-1180.19 64548.18,-1183.26 64558.02,-1187.18 64558.32,-1180.19"/>
</g>
<!-- layer3_expert13_12&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1100" class="edge">
<title>layer3_expert13_12&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M65314.75,-1259.37C65311.82,-1258.52 65308.9,-1257.72 65306,-1257 65167.5,-1222.55 64760.42,-1197.18 64558.42,-1186.32"/>
<polygon fill="black" stroke="black" points="64558.54,-1182.83 64548.37,-1185.79 64558.17,-1189.82 64558.54,-1182.83"/>
</g>
<!-- layer3_expert13_13&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1101" class="edge">
<title>layer3_expert13_13&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M65506.77,-1259.31C65503.83,-1258.47 65500.9,-1257.7 65498,-1257 65322.46,-1214.83 64794.59,-1192.33 64558.42,-1184.15"/>
<polygon fill="black" stroke="black" points="64558.54,-1180.65 64548.42,-1183.81 64558.3,-1187.65 64558.54,-1180.65"/>
</g>
<!-- layer3_expert13_14&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1102" class="edge">
<title>layer3_expert13_14&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M65698.78,-1259.27C65695.84,-1258.44 65692.91,-1257.68 65690,-1257 65477.03,-1207.09 64825.93,-1188.35 64558.52,-1182.64"/>
<polygon fill="black" stroke="black" points="64558.47,-1179.14 64548.39,-1182.42 64558.32,-1186.13 64558.47,-1179.14"/>
</g>
<!-- layer3_expert13_15&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1103" class="edge">
<title>layer3_expert13_15&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M65890.78,-1259.24C65887.84,-1258.42 65884.91,-1257.67 65882,-1257 65631.24,-1199.3 64854.71,-1184.94 64558.46,-1181.52"/>
<polygon fill="black" stroke="black" points="64558.17,-1178.02 64548.13,-1181.4 64558.09,-1185.02 64558.17,-1178.02"/>
</g>
<!-- layer3_output_gpu13 -->
<g id="node663" class="node">
<title>layer3_output_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="63167.5,-1102 62914.5,-1102 62914.5,-1034 63167.5,-1034 63167.5,-1102"/>
<text text-anchor="middle" x="63041" y="-1086.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="63041" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="63041" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="63041" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_moe_agg_gpu13&#45;&gt;layer3_output_gpu13 -->
<g id="edge1104" class="edge">
<title>layer3_moe_agg_gpu13&#45;&gt;layer3_output_gpu13</title>
<path fill="none" stroke="black" d="M64335.84,-1170.2C64085.16,-1150.61 63456.73,-1101.49 63177.92,-1079.7"/>
<polygon fill="black" stroke="black" points="63177.98,-1076.2 63167.74,-1078.91 63177.44,-1083.17 63177.98,-1076.2"/>
</g>
<!-- layer3_output_gpu13&#45;&gt;output -->
<g id="edge1182" class="edge">
<title>layer3_output_gpu13&#45;&gt;output</title>
<path fill="none" stroke="black" d="M62914.18,-1060.85C62453.39,-1038.49 60860.84,-961.21 60209.73,-929.62"/>
<polygon fill="black" stroke="black" points="60209.9,-926.13 60199.74,-929.14 60209.56,-933.12 60209.9,-926.13"/>
</g>
<!-- layer3_qkv_gpu14 -->
<g id="node664" class="node">
<title>layer3_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="67716,-1778.48 67504,-1778.48 67504,-1710.48 67716,-1710.48 67716,-1778.48"/>
<text text-anchor="middle" x="67610" y="-1763.28" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU14</text>
<text text-anchor="middle" x="67610" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="67610" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="67610" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_attn_gpu14 -->
<g id="node665" class="node">
<title>layer3_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="67736,-1667 67484,-1667 67484,-1599 67736,-1599 67736,-1667"/>
<text text-anchor="middle" x="67610" y="-1651.8" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU14</text>
<text text-anchor="middle" x="67610" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="67610" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="67610" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_qkv_gpu14&#45;&gt;layer3_attn_gpu14 -->
<g id="edge1105" class="edge">
<title>layer3_qkv_gpu14&#45;&gt;layer3_attn_gpu14</title>
<path fill="none" stroke="black" d="M67610,-1710.33C67610,-1699.94 67610,-1688.3 67610,-1677.31"/>
<polygon fill="black" stroke="black" points="67613.5,-1677.03 67610,-1667.03 67606.5,-1677.03 67613.5,-1677.03"/>
</g>
<!-- layer3_attn_norm_gpu14 -->
<g id="node666" class="node">
<title>layer3_attn_norm_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="67736.5,-1563 67483.5,-1563 67483.5,-1495 67736.5,-1495 67736.5,-1563"/>
<text text-anchor="middle" x="67610" y="-1547.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="67610" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="67610" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="67610" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_attn_gpu14&#45;&gt;layer3_attn_norm_gpu14 -->
<g id="edge1106" class="edge">
<title>layer3_attn_gpu14&#45;&gt;layer3_attn_norm_gpu14</title>
<path fill="none" stroke="black" d="M67610,-1598.88C67610,-1590.78 67610,-1581.98 67610,-1573.47"/>
<polygon fill="black" stroke="black" points="67613.5,-1573.3 67610,-1563.3 67606.5,-1573.3 67613.5,-1573.3"/>
</g>
<!-- layer3_gate_gpu14 -->
<g id="node667" class="node">
<title>layer3_gate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="67732,-1459 67488,-1459 67488,-1376 67732,-1376 67732,-1459"/>
<text text-anchor="middle" x="67610" y="-1443.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU14</text>
<text text-anchor="middle" x="67610" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="67610" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="67610" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="67610" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_attn_norm_gpu14&#45;&gt;layer3_gate_gpu14 -->
<g id="edge1107" class="edge">
<title>layer3_attn_norm_gpu14&#45;&gt;layer3_gate_gpu14</title>
<path fill="none" stroke="black" d="M67610,-1494.85C67610,-1486.8 67610,-1478 67610,-1469.34"/>
<polygon fill="black" stroke="black" points="67613.5,-1469.28 67610,-1459.28 67606.5,-1469.28 67613.5,-1469.28"/>
</g>
<!-- layer3_expert14_0 -->
<g id="node668" class="node">
<title>layer3_expert14_0</title>
<polygon fill="lightgreen" stroke="black" points="66257,-1340 66083,-1340 66083,-1257 66257,-1257 66257,-1340"/>
<text text-anchor="middle" x="66170" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU14</text>
<text text-anchor="middle" x="66170" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="66170" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="66170" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="66170" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_0 -->
<g id="edge1108" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67487.85,-1414.87C67205.89,-1410.26 66515.51,-1393.9 66267.29,-1340.01"/>
<polygon fill="black" stroke="black" points="66267.75,-1336.52 66257.22,-1337.75 66266.21,-1343.35 66267.75,-1336.52"/>
</g>
<!-- layer3_expert14_1 -->
<g id="node669" class="node">
<title>layer3_expert14_1</title>
<polygon fill="lightgreen" stroke="black" points="66449,-1340 66275,-1340 66275,-1257 66449,-1257 66449,-1340"/>
<text text-anchor="middle" x="66362" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU14</text>
<text text-anchor="middle" x="66362" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="66362" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="66362" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="66362" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_1 -->
<g id="edge1109" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67487.68,-1413.51C67236.53,-1406.54 66669.38,-1386.35 66459.26,-1340.01"/>
<polygon fill="black" stroke="black" points="66459.76,-1336.53 66449.23,-1337.71 66458.2,-1343.35 66459.76,-1336.53"/>
</g>
<!-- layer3_expert14_2 -->
<g id="node670" class="node">
<title>layer3_expert14_2</title>
<polygon fill="lightgreen" stroke="black" points="66641,-1340 66467,-1340 66467,-1257 66641,-1257 66641,-1340"/>
<text text-anchor="middle" x="66554" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU14</text>
<text text-anchor="middle" x="66554" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="66554" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="66554" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="66554" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_2 -->
<g id="edge1110" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67487.94,-1411.63C67270.49,-1402.15 66823.52,-1378.91 66651.21,-1340"/>
<polygon fill="black" stroke="black" points="66651.78,-1336.54 66641.24,-1337.66 66650.17,-1343.36 66651.78,-1336.54"/>
</g>
<!-- layer3_expert14_3 -->
<g id="node671" class="node">
<title>layer3_expert14_3</title>
<polygon fill="lightgreen" stroke="black" points="66833,-1340 66659,-1340 66659,-1257 66833,-1257 66833,-1340"/>
<text text-anchor="middle" x="66746" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU14</text>
<text text-anchor="middle" x="66746" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="66746" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="66746" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="66746" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_3 -->
<g id="edge1111" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67487.67,-1415.54C67336.64,-1411.85 67072.63,-1397.19 66843.13,-1340.07"/>
<polygon fill="black" stroke="black" points="66843.81,-1336.63 66833.26,-1337.58 66842.1,-1343.42 66843.81,-1336.63"/>
</g>
<!-- layer3_expert14_4 -->
<g id="node672" class="node">
<title>layer3_expert14_4</title>
<polygon fill="lightgreen" stroke="black" points="67025,-1340 66851,-1340 66851,-1257 67025,-1257 67025,-1340"/>
<text text-anchor="middle" x="66938" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU14</text>
<text text-anchor="middle" x="66938" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="66938" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="66938" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="66938" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_4 -->
<g id="edge1112" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67487.89,-1409.76C67372.42,-1401.23 67194.78,-1382.5 67035.04,-1340.07"/>
<polygon fill="black" stroke="black" points="67035.59,-1336.6 67025.03,-1337.38 67033.77,-1343.36 67035.59,-1336.6"/>
</g>
<!-- layer3_expert14_5 -->
<g id="node673" class="node">
<title>layer3_expert14_5</title>
<polygon fill="lightgreen" stroke="black" points="67217,-1340 67043,-1340 67043,-1257 67217,-1257 67217,-1340"/>
<text text-anchor="middle" x="67130" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU14</text>
<text text-anchor="middle" x="67130" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="67130" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="67130" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="67130" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_5 -->
<g id="edge1113" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67487.8,-1398.65C67414.17,-1386.36 67318.72,-1367.72 67226.84,-1340.09"/>
<polygon fill="black" stroke="black" points="67227.69,-1336.69 67217.1,-1337.13 67225.65,-1343.39 67227.69,-1336.69"/>
</g>
<!-- layer3_expert14_6 -->
<g id="node674" class="node">
<title>layer3_expert14_6</title>
<polygon fill="lightgreen" stroke="black" points="67409,-1340 67235,-1340 67235,-1257 67409,-1257 67409,-1340"/>
<text text-anchor="middle" x="67322" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU14</text>
<text text-anchor="middle" x="67322" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="67322" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="67322" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="67322" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_6 -->
<g id="edge1114" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67507.21,-1375.99C67480.79,-1365.46 67452.27,-1354.01 67418.69,-1340.27"/>
<polygon fill="black" stroke="black" points="67419.67,-1336.88 67409.09,-1336.33 67417.01,-1343.36 67419.67,-1336.88"/>
</g>
<!-- layer3_expert14_7 -->
<g id="node675" class="node">
<title>layer3_expert14_7</title>
<polygon fill="lightgreen" stroke="black" points="67601,-1340 67427,-1340 67427,-1257 67601,-1257 67601,-1340"/>
<text text-anchor="middle" x="67514" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU14</text>
<text text-anchor="middle" x="67514" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="67514" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="67514" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="67514" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_7 -->
<g id="edge1115" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67576.69,-1375.91C67569.25,-1366.83 67561.28,-1357.12 67553.61,-1347.77"/>
<polygon fill="black" stroke="black" points="67556.3,-1345.53 67547.25,-1340.02 67550.89,-1349.97 67556.3,-1345.53"/>
</g>
<!-- layer3_expert14_8 -->
<g id="node676" class="node">
<title>layer3_expert14_8</title>
<polygon fill="lightgreen" stroke="black" points="67793,-1340 67619,-1340 67619,-1257 67793,-1257 67793,-1340"/>
<text text-anchor="middle" x="67706" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU14</text>
<text text-anchor="middle" x="67706" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="67706" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="67706" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="67706" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_8 -->
<g id="edge1116" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67643.31,-1375.91C67650.75,-1366.83 67658.72,-1357.12 67666.39,-1347.77"/>
<polygon fill="black" stroke="black" points="67669.11,-1349.97 67672.75,-1340.02 67663.7,-1345.53 67669.11,-1349.97"/>
</g>
<!-- layer3_expert14_9 -->
<g id="node677" class="node">
<title>layer3_expert14_9</title>
<polygon fill="lightgreen" stroke="black" points="67985,-1340 67811,-1340 67811,-1257 67985,-1257 67985,-1340"/>
<text text-anchor="middle" x="67898" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU14</text>
<text text-anchor="middle" x="67898" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="67898" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="67898" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="67898" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_9 -->
<g id="edge1117" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67712.79,-1375.99C67739.21,-1365.46 67767.73,-1354.01 67801.31,-1340.27"/>
<polygon fill="black" stroke="black" points="67802.99,-1343.36 67810.91,-1336.33 67800.33,-1336.88 67802.99,-1343.36"/>
</g>
<!-- layer3_expert14_10 -->
<g id="node678" class="node">
<title>layer3_expert14_10</title>
<polygon fill="lightgreen" stroke="black" points="68177,-1340 68003,-1340 68003,-1257 68177,-1257 68177,-1340"/>
<text text-anchor="middle" x="68090" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU14</text>
<text text-anchor="middle" x="68090" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="68090" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="68090" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="68090" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_10 -->
<g id="edge1118" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67732.2,-1398.65C67805.83,-1386.36 67901.28,-1367.72 67993.16,-1340.09"/>
<polygon fill="black" stroke="black" points="67994.35,-1343.39 68002.9,-1337.13 67992.31,-1336.69 67994.35,-1343.39"/>
</g>
<!-- layer3_expert14_11 -->
<g id="node679" class="node">
<title>layer3_expert14_11</title>
<polygon fill="lightgreen" stroke="black" points="68369,-1340 68195,-1340 68195,-1257 68369,-1257 68369,-1340"/>
<text text-anchor="middle" x="68282" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU14</text>
<text text-anchor="middle" x="68282" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="68282" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="68282" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="68282" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_11 -->
<g id="edge1119" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67732.11,-1409.76C67847.58,-1401.23 68025.22,-1382.5 68184.96,-1340.07"/>
<polygon fill="black" stroke="black" points="68186.23,-1343.36 68194.97,-1337.38 68184.41,-1336.6 68186.23,-1343.36"/>
</g>
<!-- layer3_expert14_12 -->
<g id="node680" class="node">
<title>layer3_expert14_12</title>
<polygon fill="lightgreen" stroke="black" points="68561,-1340 68387,-1340 68387,-1257 68561,-1257 68561,-1340"/>
<text text-anchor="middle" x="68474" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU14</text>
<text text-anchor="middle" x="68474" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="68474" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="68474" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="68474" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_12 -->
<g id="edge1120" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67732.33,-1415.54C67883.36,-1411.85 68147.37,-1397.19 68376.87,-1340.07"/>
<polygon fill="black" stroke="black" points="68377.9,-1343.42 68386.74,-1337.58 68376.19,-1336.63 68377.9,-1343.42"/>
</g>
<!-- layer3_expert14_13 -->
<g id="node681" class="node">
<title>layer3_expert14_13</title>
<polygon fill="lightgreen" stroke="black" points="68753,-1340 68579,-1340 68579,-1257 68753,-1257 68753,-1340"/>
<text text-anchor="middle" x="68666" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU14</text>
<text text-anchor="middle" x="68666" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="68666" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="68666" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="68666" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_13 -->
<g id="edge1121" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67732.06,-1411.63C67949.51,-1402.15 68396.48,-1378.91 68568.79,-1340"/>
<polygon fill="black" stroke="black" points="68569.83,-1343.36 68578.76,-1337.66 68568.22,-1336.54 68569.83,-1343.36"/>
</g>
<!-- layer3_expert14_14 -->
<g id="node682" class="node">
<title>layer3_expert14_14</title>
<polygon fill="lightgreen" stroke="black" points="68945,-1340 68771,-1340 68771,-1257 68945,-1257 68945,-1340"/>
<text text-anchor="middle" x="68858" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU14</text>
<text text-anchor="middle" x="68858" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="68858" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="68858" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="68858" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_14 -->
<g id="edge1122" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67732.32,-1413.51C67983.47,-1406.54 68550.62,-1386.35 68760.74,-1340.01"/>
<polygon fill="black" stroke="black" points="68761.8,-1343.35 68770.77,-1337.71 68760.24,-1336.53 68761.8,-1343.35"/>
</g>
<!-- layer3_expert14_15 -->
<g id="node683" class="node">
<title>layer3_expert14_15</title>
<polygon fill="lightgreen" stroke="black" points="69137,-1340 68963,-1340 68963,-1257 69137,-1257 69137,-1340"/>
<text text-anchor="middle" x="69050" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU14</text>
<text text-anchor="middle" x="69050" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="69050" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="69050" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="69050" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_15 -->
<g id="edge1123" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67732.15,-1414.87C68014.11,-1410.26 68704.49,-1393.9 68952.71,-1340.01"/>
<polygon fill="black" stroke="black" points="68953.79,-1343.35 68962.78,-1337.75 68952.25,-1336.52 68953.79,-1343.35"/>
</g>
<!-- layer3_moe_agg_gpu14 -->
<g id="node684" class="node">
<title>layer3_moe_agg_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="67620,-1213.5 67408,-1213.5 67408,-1145.5 67620,-1145.5 67620,-1213.5"/>
<text text-anchor="middle" x="67514" y="-1198.3" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU14</text>
<text text-anchor="middle" x="67514" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="67514" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="67514" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_expert14_0&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1124" class="edge">
<title>layer3_expert14_0&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M66257.22,-1259.27C66260.16,-1258.44 66263.09,-1257.68 66266,-1257 66478.97,-1207.09 67130.07,-1188.35 67397.48,-1182.64"/>
<polygon fill="black" stroke="black" points="67397.68,-1186.13 67407.61,-1182.42 67397.53,-1179.14 67397.68,-1186.13"/>
</g>
<!-- layer3_expert14_1&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1125" class="edge">
<title>layer3_expert14_1&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M66449.23,-1259.31C66452.17,-1258.47 66455.1,-1257.7 66458,-1257 66633.54,-1214.83 67161.41,-1192.33 67397.58,-1184.15"/>
<polygon fill="black" stroke="black" points="67397.7,-1187.65 67407.58,-1183.81 67397.46,-1180.65 67397.7,-1187.65"/>
</g>
<!-- layer3_expert14_2&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1126" class="edge">
<title>layer3_expert14_2&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M66641.25,-1259.37C66644.18,-1258.52 66647.1,-1257.72 66650,-1257 66788.5,-1222.55 67195.58,-1197.18 67397.58,-1186.32"/>
<polygon fill="black" stroke="black" points="67397.83,-1189.82 67407.63,-1185.79 67397.46,-1182.83 67397.83,-1189.82"/>
</g>
<!-- layer3_expert14_3&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1127" class="edge">
<title>layer3_expert14_3&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M66833.01,-1259.55C66836.02,-1258.63 66839.03,-1257.78 66842,-1257 67032.54,-1207.07 67261.93,-1189.73 67397.42,-1183.7"/>
<polygon fill="black" stroke="black" points="67397.98,-1187.18 67407.82,-1183.26 67397.68,-1180.19 67397.98,-1187.18"/>
</g>
<!-- layer3_expert14_4&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1128" class="edge">
<title>layer3_expert14_4&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M67025.06,-1259.72C67028.06,-1258.76 67031.04,-1257.85 67034,-1257 67155.58,-1222.22 67299.29,-1201.94 67397.57,-1191.11"/>
<polygon fill="black" stroke="black" points="67397.97,-1194.59 67407.53,-1190.03 67397.21,-1187.63 67397.97,-1194.59"/>
</g>
<!-- layer3_expert14_5&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1129" class="edge">
<title>layer3_expert14_5&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M67217.18,-1260.11C67220.14,-1259.04 67223.09,-1257.99 67226,-1257 67281.88,-1237.9 67345.18,-1220.62 67398.18,-1207.34"/>
<polygon fill="black" stroke="black" points="67399.1,-1210.72 67407.95,-1204.91 67397.41,-1203.93 67399.1,-1210.72"/>
</g>
<!-- layer3_expert14_6&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1130" class="edge">
<title>layer3_expert14_6&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M67388.61,-1256.91C67408.8,-1244.6 67430.91,-1231.13 67450.87,-1218.97"/>
<polygon fill="black" stroke="black" points="67452.85,-1221.86 67459.57,-1213.67 67449.21,-1215.88 67452.85,-1221.86"/>
</g>
<!-- layer3_expert14_7&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1131" class="edge">
<title>layer3_expert14_7&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M67514,-1256.91C67514,-1246.2 67514,-1234.62 67514,-1223.78"/>
<polygon fill="black" stroke="black" points="67517.5,-1223.67 67514,-1213.67 67510.5,-1223.67 67517.5,-1223.67"/>
</g>
<!-- layer3_expert14_8&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1132" class="edge">
<title>layer3_expert14_8&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M67639.39,-1256.91C67619.2,-1244.6 67597.09,-1231.13 67577.13,-1218.97"/>
<polygon fill="black" stroke="black" points="67578.79,-1215.88 67568.43,-1213.67 67575.15,-1221.86 67578.79,-1215.88"/>
</g>
<!-- layer3_expert14_9&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1133" class="edge">
<title>layer3_expert14_9&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M67810.82,-1260.11C67807.86,-1259.04 67804.91,-1257.99 67802,-1257 67746.12,-1237.9 67682.82,-1220.62 67629.82,-1207.34"/>
<polygon fill="black" stroke="black" points="67630.59,-1203.93 67620.05,-1204.91 67628.9,-1210.72 67630.59,-1203.93"/>
</g>
<!-- layer3_expert14_10&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1134" class="edge">
<title>layer3_expert14_10&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M68002.94,-1259.72C67999.94,-1258.76 67996.96,-1257.85 67994,-1257 67872.42,-1222.22 67728.71,-1201.94 67630.43,-1191.11"/>
<polygon fill="black" stroke="black" points="67630.79,-1187.63 67620.47,-1190.03 67630.03,-1194.59 67630.79,-1187.63"/>
</g>
<!-- layer3_expert14_11&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1135" class="edge">
<title>layer3_expert14_11&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M68194.99,-1259.55C68191.98,-1258.63 68188.97,-1257.78 68186,-1257 67995.46,-1207.07 67766.07,-1189.73 67630.58,-1183.7"/>
<polygon fill="black" stroke="black" points="67630.32,-1180.19 67620.18,-1183.26 67630.02,-1187.18 67630.32,-1180.19"/>
</g>
<!-- layer3_expert14_12&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1136" class="edge">
<title>layer3_expert14_12&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M68386.75,-1259.37C68383.82,-1258.52 68380.9,-1257.72 68378,-1257 68239.5,-1222.55 67832.42,-1197.18 67630.42,-1186.32"/>
<polygon fill="black" stroke="black" points="67630.54,-1182.83 67620.37,-1185.79 67630.17,-1189.82 67630.54,-1182.83"/>
</g>
<!-- layer3_expert14_13&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1137" class="edge">
<title>layer3_expert14_13&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M68578.77,-1259.31C68575.83,-1258.47 68572.9,-1257.7 68570,-1257 68394.46,-1214.83 67866.59,-1192.33 67630.42,-1184.15"/>
<polygon fill="black" stroke="black" points="67630.54,-1180.65 67620.42,-1183.81 67630.3,-1187.65 67630.54,-1180.65"/>
</g>
<!-- layer3_expert14_14&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1138" class="edge">
<title>layer3_expert14_14&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M68770.78,-1259.27C68767.84,-1258.44 68764.91,-1257.68 68762,-1257 68549.03,-1207.09 67897.93,-1188.35 67630.52,-1182.64"/>
<polygon fill="black" stroke="black" points="67630.47,-1179.14 67620.39,-1182.42 67630.32,-1186.13 67630.47,-1179.14"/>
</g>
<!-- layer3_expert14_15&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1139" class="edge">
<title>layer3_expert14_15&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M68962.78,-1259.24C68959.84,-1258.42 68956.91,-1257.67 68954,-1257 68703.24,-1199.3 67926.71,-1184.94 67630.46,-1181.52"/>
<polygon fill="black" stroke="black" points="67630.17,-1178.02 67620.13,-1181.4 67630.09,-1185.02 67630.17,-1178.02"/>
</g>
<!-- layer3_output_gpu14 -->
<g id="node685" class="node">
<title>layer3_output_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="65865.5,-1102 65612.5,-1102 65612.5,-1034 65865.5,-1034 65865.5,-1102"/>
<text text-anchor="middle" x="65739" y="-1086.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="65739" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="65739" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="65739" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_moe_agg_gpu14&#45;&gt;layer3_output_gpu14 -->
<g id="edge1140" class="edge">
<title>layer3_moe_agg_gpu14&#45;&gt;layer3_output_gpu14</title>
<path fill="none" stroke="black" d="M67407.95,-1171.96C67101.92,-1153.08 66217.38,-1098.51 65875.83,-1077.44"/>
<polygon fill="black" stroke="black" points="65875.83,-1073.93 65865.63,-1076.81 65875.4,-1080.92 65875.83,-1073.93"/>
</g>
<!-- layer3_output_gpu14&#45;&gt;output -->
<g id="edge1183" class="edge">
<title>layer3_output_gpu14&#45;&gt;output</title>
<path fill="none" stroke="black" d="M65612.25,-1063.71C64889.66,-1044.93 61285.7,-951.26 60223.85,-923.66"/>
<polygon fill="black" stroke="black" points="60223.87,-920.16 60213.79,-923.4 60223.69,-927.16 60223.87,-920.16"/>
</g>
<!-- layer3_qkv_gpu15 -->
<g id="node686" class="node">
<title>layer3_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="70788,-1778.48 70576,-1778.48 70576,-1710.48 70788,-1710.48 70788,-1778.48"/>
<text text-anchor="middle" x="70682" y="-1763.28" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU15</text>
<text text-anchor="middle" x="70682" y="-1748.28" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="70682" y="-1733.28" font-family="Times,serif" font-size="14.00">Output: [1024,2048,12288]</text>
<text text-anchor="middle" x="70682" y="-1718.28" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_attn_gpu15 -->
<g id="node687" class="node">
<title>layer3_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="70808,-1667 70556,-1667 70556,-1599 70808,-1599 70808,-1667"/>
<text text-anchor="middle" x="70682" y="-1651.8" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU15</text>
<text text-anchor="middle" x="70682" y="-1636.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,12288]</text>
<text text-anchor="middle" x="70682" y="-1621.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="70682" y="-1606.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_qkv_gpu15&#45;&gt;layer3_attn_gpu15 -->
<g id="edge1141" class="edge">
<title>layer3_qkv_gpu15&#45;&gt;layer3_attn_gpu15</title>
<path fill="none" stroke="black" d="M70682,-1710.33C70682,-1699.94 70682,-1688.3 70682,-1677.31"/>
<polygon fill="black" stroke="black" points="70685.5,-1677.03 70682,-1667.03 70678.5,-1677.03 70685.5,-1677.03"/>
</g>
<!-- layer3_attn_norm_gpu15 -->
<g id="node688" class="node">
<title>layer3_attn_norm_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="70808.5,-1563 70555.5,-1563 70555.5,-1495 70808.5,-1495 70808.5,-1563"/>
<text text-anchor="middle" x="70682" y="-1547.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="70682" y="-1532.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="70682" y="-1517.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="70682" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_attn_gpu15&#45;&gt;layer3_attn_norm_gpu15 -->
<g id="edge1142" class="edge">
<title>layer3_attn_gpu15&#45;&gt;layer3_attn_norm_gpu15</title>
<path fill="none" stroke="black" d="M70682,-1598.88C70682,-1590.78 70682,-1581.98 70682,-1573.47"/>
<polygon fill="black" stroke="black" points="70685.5,-1573.3 70682,-1563.3 70678.5,-1573.3 70685.5,-1573.3"/>
</g>
<!-- layer3_gate_gpu15 -->
<g id="node689" class="node">
<title>layer3_gate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="70804,-1459 70560,-1459 70560,-1376 70804,-1376 70804,-1459"/>
<text text-anchor="middle" x="70682" y="-1443.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU15</text>
<text text-anchor="middle" x="70682" y="-1428.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="70682" y="-1413.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="70682" y="-1398.8" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
<text text-anchor="middle" x="70682" y="-1383.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_attn_norm_gpu15&#45;&gt;layer3_gate_gpu15 -->
<g id="edge1143" class="edge">
<title>layer3_attn_norm_gpu15&#45;&gt;layer3_gate_gpu15</title>
<path fill="none" stroke="black" d="M70682,-1494.85C70682,-1486.8 70682,-1478 70682,-1469.34"/>
<polygon fill="black" stroke="black" points="70685.5,-1469.28 70682,-1459.28 70678.5,-1469.28 70685.5,-1469.28"/>
</g>
<!-- layer3_expert15_0 -->
<g id="node690" class="node">
<title>layer3_expert15_0</title>
<polygon fill="lightgreen" stroke="black" points="69329,-1340 69155,-1340 69155,-1257 69329,-1257 69329,-1340"/>
<text text-anchor="middle" x="69242" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU15</text>
<text text-anchor="middle" x="69242" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="69242" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="69242" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="69242" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_0 -->
<g id="edge1144" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70559.85,-1414.87C70277.89,-1410.26 69587.51,-1393.9 69339.29,-1340.01"/>
<polygon fill="black" stroke="black" points="69339.75,-1336.52 69329.22,-1337.75 69338.21,-1343.35 69339.75,-1336.52"/>
</g>
<!-- layer3_expert15_1 -->
<g id="node691" class="node">
<title>layer3_expert15_1</title>
<polygon fill="lightgreen" stroke="black" points="69521,-1340 69347,-1340 69347,-1257 69521,-1257 69521,-1340"/>
<text text-anchor="middle" x="69434" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU15</text>
<text text-anchor="middle" x="69434" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="69434" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="69434" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="69434" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_1 -->
<g id="edge1145" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70559.68,-1413.51C70308.53,-1406.54 69741.38,-1386.35 69531.26,-1340.01"/>
<polygon fill="black" stroke="black" points="69531.76,-1336.53 69521.23,-1337.71 69530.2,-1343.35 69531.76,-1336.53"/>
</g>
<!-- layer3_expert15_2 -->
<g id="node692" class="node">
<title>layer3_expert15_2</title>
<polygon fill="lightgreen" stroke="black" points="69713,-1340 69539,-1340 69539,-1257 69713,-1257 69713,-1340"/>
<text text-anchor="middle" x="69626" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU15</text>
<text text-anchor="middle" x="69626" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="69626" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="69626" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="69626" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_2 -->
<g id="edge1146" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70559.94,-1411.63C70342.49,-1402.15 69895.52,-1378.91 69723.21,-1340"/>
<polygon fill="black" stroke="black" points="69723.78,-1336.54 69713.24,-1337.66 69722.17,-1343.36 69723.78,-1336.54"/>
</g>
<!-- layer3_expert15_3 -->
<g id="node693" class="node">
<title>layer3_expert15_3</title>
<polygon fill="lightgreen" stroke="black" points="69905,-1340 69731,-1340 69731,-1257 69905,-1257 69905,-1340"/>
<text text-anchor="middle" x="69818" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU15</text>
<text text-anchor="middle" x="69818" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="69818" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="69818" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="69818" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_3 -->
<g id="edge1147" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70559.67,-1415.54C70408.64,-1411.85 70144.63,-1397.19 69915.13,-1340.07"/>
<polygon fill="black" stroke="black" points="69915.81,-1336.63 69905.26,-1337.58 69914.1,-1343.42 69915.81,-1336.63"/>
</g>
<!-- layer3_expert15_4 -->
<g id="node694" class="node">
<title>layer3_expert15_4</title>
<polygon fill="lightgreen" stroke="black" points="70097,-1340 69923,-1340 69923,-1257 70097,-1257 70097,-1340"/>
<text text-anchor="middle" x="70010" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU15</text>
<text text-anchor="middle" x="70010" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="70010" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="70010" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="70010" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_4 -->
<g id="edge1148" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70559.89,-1409.76C70444.42,-1401.23 70266.78,-1382.5 70107.04,-1340.07"/>
<polygon fill="black" stroke="black" points="70107.59,-1336.6 70097.03,-1337.38 70105.77,-1343.36 70107.59,-1336.6"/>
</g>
<!-- layer3_expert15_5 -->
<g id="node695" class="node">
<title>layer3_expert15_5</title>
<polygon fill="lightgreen" stroke="black" points="70289,-1340 70115,-1340 70115,-1257 70289,-1257 70289,-1340"/>
<text text-anchor="middle" x="70202" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU15</text>
<text text-anchor="middle" x="70202" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="70202" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="70202" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="70202" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_5 -->
<g id="edge1149" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70559.8,-1398.65C70486.17,-1386.36 70390.72,-1367.72 70298.84,-1340.09"/>
<polygon fill="black" stroke="black" points="70299.69,-1336.69 70289.1,-1337.13 70297.65,-1343.39 70299.69,-1336.69"/>
</g>
<!-- layer3_expert15_6 -->
<g id="node696" class="node">
<title>layer3_expert15_6</title>
<polygon fill="lightgreen" stroke="black" points="70481,-1340 70307,-1340 70307,-1257 70481,-1257 70481,-1340"/>
<text text-anchor="middle" x="70394" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU15</text>
<text text-anchor="middle" x="70394" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="70394" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="70394" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="70394" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_6 -->
<g id="edge1150" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70579.21,-1375.99C70552.79,-1365.46 70524.27,-1354.01 70490.69,-1340.27"/>
<polygon fill="black" stroke="black" points="70491.67,-1336.88 70481.09,-1336.33 70489.01,-1343.36 70491.67,-1336.88"/>
</g>
<!-- layer3_expert15_7 -->
<g id="node697" class="node">
<title>layer3_expert15_7</title>
<polygon fill="lightgreen" stroke="black" points="70673,-1340 70499,-1340 70499,-1257 70673,-1257 70673,-1340"/>
<text text-anchor="middle" x="70586" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU15</text>
<text text-anchor="middle" x="70586" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="70586" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="70586" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="70586" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_7 -->
<g id="edge1151" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70648.69,-1375.91C70641.25,-1366.83 70633.28,-1357.12 70625.61,-1347.77"/>
<polygon fill="black" stroke="black" points="70628.3,-1345.53 70619.25,-1340.02 70622.89,-1349.97 70628.3,-1345.53"/>
</g>
<!-- layer3_expert15_8 -->
<g id="node698" class="node">
<title>layer3_expert15_8</title>
<polygon fill="lightgreen" stroke="black" points="70865,-1340 70691,-1340 70691,-1257 70865,-1257 70865,-1340"/>
<text text-anchor="middle" x="70778" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU15</text>
<text text-anchor="middle" x="70778" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="70778" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="70778" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="70778" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_8 -->
<g id="edge1152" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70715.31,-1375.91C70722.75,-1366.83 70730.72,-1357.12 70738.39,-1347.77"/>
<polygon fill="black" stroke="black" points="70741.11,-1349.97 70744.75,-1340.02 70735.7,-1345.53 70741.11,-1349.97"/>
</g>
<!-- layer3_expert15_9 -->
<g id="node699" class="node">
<title>layer3_expert15_9</title>
<polygon fill="lightgreen" stroke="black" points="71057,-1340 70883,-1340 70883,-1257 71057,-1257 71057,-1340"/>
<text text-anchor="middle" x="70970" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU15</text>
<text text-anchor="middle" x="70970" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="70970" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="70970" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="70970" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_9 -->
<g id="edge1153" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70784.79,-1375.99C70811.21,-1365.46 70839.73,-1354.01 70873.31,-1340.27"/>
<polygon fill="black" stroke="black" points="70874.99,-1343.36 70882.91,-1336.33 70872.33,-1336.88 70874.99,-1343.36"/>
</g>
<!-- layer3_expert15_10 -->
<g id="node700" class="node">
<title>layer3_expert15_10</title>
<polygon fill="lightgreen" stroke="black" points="71249,-1340 71075,-1340 71075,-1257 71249,-1257 71249,-1340"/>
<text text-anchor="middle" x="71162" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU15</text>
<text text-anchor="middle" x="71162" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="71162" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="71162" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="71162" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_10 -->
<g id="edge1154" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70804.2,-1398.65C70877.83,-1386.36 70973.28,-1367.72 71065.16,-1340.09"/>
<polygon fill="black" stroke="black" points="71066.35,-1343.39 71074.9,-1337.13 71064.31,-1336.69 71066.35,-1343.39"/>
</g>
<!-- layer3_expert15_11 -->
<g id="node701" class="node">
<title>layer3_expert15_11</title>
<polygon fill="lightgreen" stroke="black" points="71441,-1340 71267,-1340 71267,-1257 71441,-1257 71441,-1340"/>
<text text-anchor="middle" x="71354" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU15</text>
<text text-anchor="middle" x="71354" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="71354" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="71354" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="71354" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_11 -->
<g id="edge1155" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70804.11,-1409.76C70919.58,-1401.23 71097.22,-1382.5 71256.96,-1340.07"/>
<polygon fill="black" stroke="black" points="71258.23,-1343.36 71266.97,-1337.38 71256.41,-1336.6 71258.23,-1343.36"/>
</g>
<!-- layer3_expert15_12 -->
<g id="node702" class="node">
<title>layer3_expert15_12</title>
<polygon fill="lightgreen" stroke="black" points="71633,-1340 71459,-1340 71459,-1257 71633,-1257 71633,-1340"/>
<text text-anchor="middle" x="71546" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU15</text>
<text text-anchor="middle" x="71546" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="71546" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="71546" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="71546" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_12 -->
<g id="edge1156" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70804.33,-1415.54C70955.36,-1411.85 71219.37,-1397.19 71448.87,-1340.07"/>
<polygon fill="black" stroke="black" points="71449.9,-1343.42 71458.74,-1337.58 71448.19,-1336.63 71449.9,-1343.42"/>
</g>
<!-- layer3_expert15_13 -->
<g id="node703" class="node">
<title>layer3_expert15_13</title>
<polygon fill="lightgreen" stroke="black" points="71825,-1340 71651,-1340 71651,-1257 71825,-1257 71825,-1340"/>
<text text-anchor="middle" x="71738" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU15</text>
<text text-anchor="middle" x="71738" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="71738" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="71738" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="71738" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_13 -->
<g id="edge1157" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70804.06,-1411.63C71021.51,-1402.15 71468.48,-1378.91 71640.79,-1340"/>
<polygon fill="black" stroke="black" points="71641.83,-1343.36 71650.76,-1337.66 71640.22,-1336.54 71641.83,-1343.36"/>
</g>
<!-- layer3_expert15_14 -->
<g id="node704" class="node">
<title>layer3_expert15_14</title>
<polygon fill="lightgreen" stroke="black" points="72017,-1340 71843,-1340 71843,-1257 72017,-1257 72017,-1340"/>
<text text-anchor="middle" x="71930" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU15</text>
<text text-anchor="middle" x="71930" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="71930" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="71930" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="71930" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_14 -->
<g id="edge1158" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70804.32,-1413.51C71055.47,-1406.54 71622.62,-1386.35 71832.74,-1340.01"/>
<polygon fill="black" stroke="black" points="71833.8,-1343.35 71842.77,-1337.71 71832.24,-1336.53 71833.8,-1343.35"/>
</g>
<!-- layer3_expert15_15 -->
<g id="node705" class="node">
<title>layer3_expert15_15</title>
<polygon fill="lightgreen" stroke="black" points="72209,-1340 72035,-1340 72035,-1257 72209,-1257 72209,-1340"/>
<text text-anchor="middle" x="72122" y="-1324.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU15</text>
<text text-anchor="middle" x="72122" y="-1309.8" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="72122" y="-1294.8" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="72122" y="-1279.8" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="72122" y="-1264.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_15 -->
<g id="edge1159" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70804.15,-1414.87C71086.11,-1410.26 71776.49,-1393.9 72024.71,-1340.01"/>
<polygon fill="black" stroke="black" points="72025.79,-1343.35 72034.78,-1337.75 72024.25,-1336.52 72025.79,-1343.35"/>
</g>
<!-- layer3_moe_agg_gpu15 -->
<g id="node706" class="node">
<title>layer3_moe_agg_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="70692,-1213.5 70480,-1213.5 70480,-1145.5 70692,-1145.5 70692,-1213.5"/>
<text text-anchor="middle" x="70586" y="-1198.3" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU15</text>
<text text-anchor="middle" x="70586" y="-1183.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="70586" y="-1168.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="70586" y="-1153.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_expert15_0&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1160" class="edge">
<title>layer3_expert15_0&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M69329.22,-1259.27C69332.16,-1258.44 69335.09,-1257.68 69338,-1257 69550.97,-1207.09 70202.07,-1188.35 70469.48,-1182.64"/>
<polygon fill="black" stroke="black" points="70469.68,-1186.13 70479.61,-1182.42 70469.53,-1179.14 70469.68,-1186.13"/>
</g>
<!-- layer3_expert15_1&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1161" class="edge">
<title>layer3_expert15_1&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M69521.23,-1259.31C69524.17,-1258.47 69527.1,-1257.7 69530,-1257 69705.54,-1214.83 70233.41,-1192.33 70469.58,-1184.15"/>
<polygon fill="black" stroke="black" points="70469.7,-1187.65 70479.58,-1183.81 70469.46,-1180.65 70469.7,-1187.65"/>
</g>
<!-- layer3_expert15_2&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1162" class="edge">
<title>layer3_expert15_2&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M69713.25,-1259.37C69716.18,-1258.52 69719.1,-1257.72 69722,-1257 69860.5,-1222.55 70267.58,-1197.18 70469.58,-1186.32"/>
<polygon fill="black" stroke="black" points="70469.83,-1189.82 70479.63,-1185.79 70469.46,-1182.83 70469.83,-1189.82"/>
</g>
<!-- layer3_expert15_3&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1163" class="edge">
<title>layer3_expert15_3&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M69905.01,-1259.55C69908.02,-1258.63 69911.03,-1257.78 69914,-1257 70104.54,-1207.07 70333.93,-1189.73 70469.42,-1183.7"/>
<polygon fill="black" stroke="black" points="70469.98,-1187.18 70479.82,-1183.26 70469.68,-1180.19 70469.98,-1187.18"/>
</g>
<!-- layer3_expert15_4&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1164" class="edge">
<title>layer3_expert15_4&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M70097.06,-1259.72C70100.06,-1258.76 70103.04,-1257.85 70106,-1257 70227.58,-1222.22 70371.29,-1201.94 70469.57,-1191.11"/>
<polygon fill="black" stroke="black" points="70469.97,-1194.59 70479.53,-1190.03 70469.21,-1187.63 70469.97,-1194.59"/>
</g>
<!-- layer3_expert15_5&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1165" class="edge">
<title>layer3_expert15_5&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M70289.18,-1260.11C70292.14,-1259.04 70295.09,-1257.99 70298,-1257 70353.88,-1237.9 70417.18,-1220.62 70470.18,-1207.34"/>
<polygon fill="black" stroke="black" points="70471.1,-1210.72 70479.95,-1204.91 70469.41,-1203.93 70471.1,-1210.72"/>
</g>
<!-- layer3_expert15_6&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1166" class="edge">
<title>layer3_expert15_6&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M70460.61,-1256.91C70480.8,-1244.6 70502.91,-1231.13 70522.87,-1218.97"/>
<polygon fill="black" stroke="black" points="70524.85,-1221.86 70531.57,-1213.67 70521.21,-1215.88 70524.85,-1221.86"/>
</g>
<!-- layer3_expert15_7&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1167" class="edge">
<title>layer3_expert15_7&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M70586,-1256.91C70586,-1246.2 70586,-1234.62 70586,-1223.78"/>
<polygon fill="black" stroke="black" points="70589.5,-1223.67 70586,-1213.67 70582.5,-1223.67 70589.5,-1223.67"/>
</g>
<!-- layer3_expert15_8&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1168" class="edge">
<title>layer3_expert15_8&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M70711.39,-1256.91C70691.2,-1244.6 70669.09,-1231.13 70649.13,-1218.97"/>
<polygon fill="black" stroke="black" points="70650.79,-1215.88 70640.43,-1213.67 70647.15,-1221.86 70650.79,-1215.88"/>
</g>
<!-- layer3_expert15_9&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1169" class="edge">
<title>layer3_expert15_9&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M70882.82,-1260.11C70879.86,-1259.04 70876.91,-1257.99 70874,-1257 70818.12,-1237.9 70754.82,-1220.62 70701.82,-1207.34"/>
<polygon fill="black" stroke="black" points="70702.59,-1203.93 70692.05,-1204.91 70700.9,-1210.72 70702.59,-1203.93"/>
</g>
<!-- layer3_expert15_10&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1170" class="edge">
<title>layer3_expert15_10&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M71074.94,-1259.72C71071.94,-1258.76 71068.96,-1257.85 71066,-1257 70944.42,-1222.22 70800.71,-1201.94 70702.43,-1191.11"/>
<polygon fill="black" stroke="black" points="70702.79,-1187.63 70692.47,-1190.03 70702.03,-1194.59 70702.79,-1187.63"/>
</g>
<!-- layer3_expert15_11&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1171" class="edge">
<title>layer3_expert15_11&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M71266.99,-1259.55C71263.98,-1258.63 71260.97,-1257.78 71258,-1257 71067.46,-1207.07 70838.07,-1189.73 70702.58,-1183.7"/>
<polygon fill="black" stroke="black" points="70702.32,-1180.19 70692.18,-1183.26 70702.02,-1187.18 70702.32,-1180.19"/>
</g>
<!-- layer3_expert15_12&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1172" class="edge">
<title>layer3_expert15_12&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M71458.75,-1259.37C71455.82,-1258.52 71452.9,-1257.72 71450,-1257 71311.5,-1222.55 70904.42,-1197.18 70702.42,-1186.32"/>
<polygon fill="black" stroke="black" points="70702.54,-1182.83 70692.37,-1185.79 70702.17,-1189.82 70702.54,-1182.83"/>
</g>
<!-- layer3_expert15_13&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1173" class="edge">
<title>layer3_expert15_13&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M71650.77,-1259.31C71647.83,-1258.47 71644.9,-1257.7 71642,-1257 71466.46,-1214.83 70938.59,-1192.33 70702.42,-1184.15"/>
<polygon fill="black" stroke="black" points="70702.54,-1180.65 70692.42,-1183.81 70702.3,-1187.65 70702.54,-1180.65"/>
</g>
<!-- layer3_expert15_14&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1174" class="edge">
<title>layer3_expert15_14&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M71842.78,-1259.27C71839.84,-1258.44 71836.91,-1257.68 71834,-1257 71621.03,-1207.09 70969.93,-1188.35 70702.52,-1182.64"/>
<polygon fill="black" stroke="black" points="70702.47,-1179.14 70692.39,-1182.42 70702.32,-1186.13 70702.47,-1179.14"/>
</g>
<!-- layer3_expert15_15&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1175" class="edge">
<title>layer3_expert15_15&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M72034.78,-1259.24C72031.84,-1258.42 72028.91,-1257.67 72026,-1257 71775.24,-1199.3 70998.71,-1184.94 70702.46,-1181.52"/>
<polygon fill="black" stroke="black" points="70702.17,-1178.02 70692.13,-1181.4 70702.09,-1185.02 70702.17,-1178.02"/>
</g>
<!-- layer3_output_gpu15 -->
<g id="node707" class="node">
<title>layer3_output_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="68750.5,-1102 68497.5,-1102 68497.5,-1034 68750.5,-1034 68750.5,-1102"/>
<text text-anchor="middle" x="68624" y="-1086.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="68624" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="68624" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="68624" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_moe_agg_gpu15&#45;&gt;layer3_output_gpu15 -->
<g id="edge1176" class="edge">
<title>layer3_moe_agg_gpu15&#45;&gt;layer3_output_gpu15</title>
<path fill="none" stroke="black" d="M70479.82,-1172.57C70148.14,-1154.06 69131.54,-1097.33 68760.98,-1076.64"/>
<polygon fill="black" stroke="black" points="68760.92,-1073.14 68750.74,-1076.07 68760.53,-1080.13 68760.92,-1073.14"/>
</g>
<!-- layer3_output_gpu15&#45;&gt;output -->
<g id="edge1184" class="edge">
<title>layer3_output_gpu15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M68497.31,-1064.8C67554.75,-1048.43 61632.75,-945.59 60227.72,-921.19"/>
<polygon fill="black" stroke="black" points="60227.55,-917.68 60217.49,-921.01 60227.43,-924.68 60227.55,-917.68"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu8 -->
<g id="edge593" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu8</title>
<path fill="none" stroke="black" d="M34914.72,-913.5C34270.12,-910.91 32052.05,-894.84 31351,-796 31346.47,-795.36 31341.87,-794.63 31337.23,-793.81"/>
<polygon fill="black" stroke="black" points="31337.52,-790.31 31327.04,-791.91 31336.23,-797.19 31337.52,-790.31"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu9 -->
<g id="edge594" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu9</title>
<path fill="none" stroke="black" d="M34910.95,-906.46C34268.58,-879.71 32109.11,-789.78 31582.53,-767.85"/>
<polygon fill="black" stroke="black" points="31582.4,-764.34 31572.26,-767.43 31582.11,-771.34 31582.4,-764.34"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu10 -->
<g id="edge595" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu10</title>
<path fill="none" stroke="black" d="M34905.99,-897.52C34552.76,-866.22 33794.29,-799 33504.15,-773.29"/>
<polygon fill="black" stroke="black" points="33504.29,-769.79 33494.02,-772.4 33503.68,-776.76 33504.29,-769.79"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu11 -->
<g id="edge596" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu11</title>
<path fill="none" stroke="black" d="M35024.01,-831.87C35016.03,-822.23 35008.18,-812.74 35000.96,-804.03"/>
<polygon fill="black" stroke="black" points="35003.61,-801.73 34994.53,-796.26 34998.22,-806.2 35003.61,-801.73"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu12 -->
<g id="edge597" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu12</title>
<path fill="none" stroke="black" d="M35159.99,-831.87C35167.97,-822.23 35175.82,-812.74 35183.04,-804.03"/>
<polygon fill="black" stroke="black" points="35185.78,-806.2 35189.47,-796.26 35180.39,-801.73 35185.78,-806.2"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu13 -->
<g id="edge598" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu13</title>
<path fill="none" stroke="black" d="M35237,-857.13C35285.95,-837.93 35339.28,-817.02 35383.2,-799.79"/>
<polygon fill="black" stroke="black" points="35384.68,-802.97 35392.71,-796.06 35382.12,-796.45 35384.68,-802.97"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu14 -->
<g id="edge599" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu14</title>
<path fill="none" stroke="black" d="M35248.1,-877.74C35364.36,-850.73 35520.55,-814.44 35625.91,-789.97"/>
<polygon fill="black" stroke="black" points="35626.99,-793.31 35635.94,-787.64 35625.41,-786.49 35626.99,-793.31"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu15 -->
<g id="edge600" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu15</title>
<path fill="none" stroke="black" d="M35255.89,-891.66C35411.13,-869.8 35650.55,-834.3 35857,-796 35868.62,-793.85 35880.7,-791.46 35892.76,-788.99"/>
<polygon fill="black" stroke="black" points="35893.78,-792.36 35902.86,-786.9 35892.36,-785.5 35893.78,-792.36"/>
</g>
</g>
</svg>
