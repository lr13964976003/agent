<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Corrected_Baseline_TP8_EP4_PP2 Pages: 1 -->
<svg width="6385pt" height="1818pt"
 viewBox="0.00 0.00 6385.36 1817.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1813.91)">
<title>Corrected_Baseline_TP8_EP4_PP2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1813.91 6381.36,-1813.91 6381.36,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="3012.86" cy="-1780.92" rx="161.44" ry="28.98"/>
<text text-anchor="middle" x="3012.86" y="-1789.42" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="3012.86" y="-1778.42" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=1024, d_model=1024]</text>
<text text-anchor="middle" x="3012.86" y="-1767.42" font-family="Arial" font-size="10.00">GPU: All</text>
</g>
<!-- layer_0_input_split -->
<g id="node6" class="node">
<title>layer_0_input_split</title>
<polygon fill="yellow" stroke="black" points="2931.59,-1714.93 2354.57,-1714.93 2206.14,-1632.93 2783.15,-1632.93 2931.59,-1714.93"/>
<text text-anchor="middle" x="2568.86" y="-1682.43" font-family="Arial" font-size="10.00">Input Split</text>
<text text-anchor="middle" x="2568.86" y="-1671.43" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="2568.86" y="-1660.43" font-family="Arial" font-size="10.00">GPU: Per TP group</text>
</g>
<!-- input&#45;&gt;layer_0_input_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_input_split</title>
<path fill="none" stroke="black" d="M2891.69,-1761.79C2891.69,-1761.79 2891.69,-1725.06 2891.69,-1725.06"/>
<polygon fill="black" stroke="black" points="2895.19,-1725.06 2891.69,-1715.06 2888.19,-1725.06 2895.19,-1725.06"/>
</g>
<!-- layer_0_add_norm1 -->
<g id="node33" class="node">
<title>layer_0_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="3032.36,-1133.95 2677.36,-1133.95 2677.36,-1092.95 3032.36,-1092.95 3032.36,-1133.95"/>
<text text-anchor="middle" x="2854.86" y="-1121.95" font-family="Arial" font-size="10.00">Add+Residual+Norm</text>
<text text-anchor="middle" x="2854.86" y="-1110.95" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="2854.86" y="-1099.95" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;layer_0_add_norm1 -->
<g id="edge36" class="edge">
<title>input&#45;&gt;layer_0_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3085.09,-1755C3132.63,-1755 3186.13,-1755 3186.13,-1755 3186.13,-1755 3186.13,-1113 3186.13,-1113 3186.13,-1113 3042.62,-1113 3042.62,-1113"/>
<polygon fill="black" stroke="black" points="3042.62,-1109.5 3032.62,-1113 3042.62,-1116.5 3042.62,-1109.5"/>
<text text-anchor="middle" x="3237.86" y="-1406.73" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- output -->
<g id="node2" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="362.86" cy="-28.99" rx="161.44" ry="28.98"/>
<text text-anchor="middle" x="362.86" y="-37.49" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="362.86" y="-26.49" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=1024, d_model=1024]</text>
<text text-anchor="middle" x="362.86" y="-15.49" font-family="Arial" font-size="10.00">GPU: All</text>
</g>
<!-- comm_tp_allreduce -->
<g id="node3" class="node">
<title>comm_tp_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="3377.86" cy="-1780.92" rx="185.94" ry="21.43"/>
<text text-anchor="middle" x="3377.86" y="-1783.92" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3377.86" y="-1772.92" font-family="Arial" font-size="10.00">GPU: 0&#45;7, 8&#45;15, 16&#45;23, 24&#45;31, 32&#45;39, 40&#45;47, 48&#45;55, 56&#45;63</text>
</g>
<!-- comm_ep_all2all -->
<g id="node4" class="node">
<title>comm_ep_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="3652.86" cy="-1780.92" rx="71.34" ry="21.43"/>
<text text-anchor="middle" x="3652.86" y="-1783.92" font-family="Arial" font-size="10.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="3652.86" y="-1772.92" font-family="Arial" font-size="10.00">GPU: Per TP group</text>
</g>
<!-- comm_pp_stage0_1 -->
<g id="node5" class="node">
<title>comm_pp_stage0_1</title>
<polygon fill="orange" stroke="black" points="362.86,-365.98 280.86,-335.98 362.86,-305.98 444.86,-335.98 362.86,-365.98"/>
<text text-anchor="middle" x="362.86" y="-338.98" font-family="Arial" font-size="10.00">PP Stage 0→1</text>
<text text-anchor="middle" x="362.86" y="-327.98" font-family="Arial" font-size="10.00">GPU: 31→32</text>
</g>
<!-- layer_8_input_split -->
<g id="node62" class="node">
<title>layer_8_input_split</title>
<polygon fill="yellow" stroke="black" points="725.59,-268.98 148.57,-268.98 0.14,-186.98 577.15,-186.98 725.59,-268.98"/>
<text text-anchor="middle" x="362.86" y="-236.48" font-family="Arial" font-size="10.00">Stage 1 Input Split</text>
<text text-anchor="middle" x="362.86" y="-225.48" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="362.86" y="-214.48" font-family="Arial" font-size="10.00">GPU: 32&#45;39,40&#45;47,48&#45;55,56&#45;63</text>
</g>
<!-- comm_pp_stage0_1&#45;&gt;layer_8_input_split -->
<g id="edge80" class="edge">
<title>comm_pp_stage0_1&#45;&gt;layer_8_input_split</title>
<path fill="none" stroke="black" d="M362.86,-305.9C362.86,-305.9 362.86,-279.21 362.86,-279.21"/>
<polygon fill="black" stroke="black" points="366.36,-279.21 362.86,-269.21 359.36,-279.21 366.36,-279.21"/>
</g>
<!-- layer_0_qkv_split -->
<g id="node7" class="node">
<title>layer_0_qkv_split</title>
<polygon fill="yellow" stroke="black" points="2183.59,-1595.93 1606.57,-1595.93 1458.14,-1513.93 2035.15,-1513.93 2183.59,-1595.93"/>
<text text-anchor="middle" x="1820.86" y="-1563.43" font-family="Arial" font-size="10.00">QKV Split</text>
<text text-anchor="middle" x="1820.86" y="-1552.43" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="1820.86" y="-1541.43" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_0_input_split&#45;&gt;layer_0_qkv_split -->
<g id="edge2" class="edge">
<title>layer_0_input_split&#45;&gt;layer_0_qkv_split</title>
<path fill="none" stroke="black" d="M2293.68,-1632.83C2293.68,-1605.65 2293.68,-1575 2293.68,-1575 2293.68,-1575 2156.02,-1575 2156.02,-1575"/>
<polygon fill="black" stroke="black" points="2156.02,-1571.5 2146.02,-1575 2156.02,-1578.5 2156.02,-1571.5"/>
</g>
<!-- layer_0_qkv_gpu0 -->
<g id="node8" class="node">
<title>layer_0_qkv_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="2767.36,-1476.93 2408.36,-1476.93 2408.36,-1435.93 2767.36,-1435.93 2767.36,-1476.93"/>
<text text-anchor="middle" x="2587.86" y="-1464.93" font-family="Arial" font-size="10.00">QKV Linear</text>
<text text-anchor="middle" x="2587.86" y="-1453.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=128]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="2587.86" y="-1442.93" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu0 -->
<g id="edge3" class="edge">
<title>layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2071.74,-1534C2295.47,-1534 2587.86,-1534 2587.86,-1534 2587.86,-1534 2587.86,-1487.22 2587.86,-1487.22"/>
<polygon fill="black" stroke="black" points="2591.36,-1487.22 2587.86,-1477.22 2584.36,-1487.22 2591.36,-1487.22"/>
</g>
<!-- layer_0_qkv_gpu1 -->
<g id="node9" class="node">
<title>layer_0_qkv_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="3153.36,-1476.93 2794.36,-1476.93 2794.36,-1435.93 3153.36,-1435.93 3153.36,-1476.93"/>
<text text-anchor="middle" x="2973.86" y="-1464.93" font-family="Arial" font-size="10.00">QKV Linear</text>
<text text-anchor="middle" x="2973.86" y="-1453.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=128]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="2973.86" y="-1442.93" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu1 -->
<g id="edge4" class="edge">
<title>layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2107.71,-1554C2416.22,-1554 2863.05,-1554 2863.05,-1554 2863.05,-1554 2863.05,-1487.12 2863.05,-1487.12"/>
<polygon fill="black" stroke="black" points="2866.55,-1487.12 2863.05,-1477.12 2859.55,-1487.12 2866.55,-1487.12"/>
</g>
<!-- layer_0_qkv_gpu2 -->
<g id="node10" class="node">
<title>layer_0_qkv_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="461.36,-1476.93 102.36,-1476.93 102.36,-1435.93 461.36,-1435.93 461.36,-1476.93"/>
<text text-anchor="middle" x="281.86" y="-1464.93" font-family="Arial" font-size="10.00">QKV Linear</text>
<text text-anchor="middle" x="281.86" y="-1453.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=128]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="281.86" y="-1442.93" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu2 -->
<g id="edge5" class="edge">
<title>layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1568.45,-1575C1131.84,-1575 281.86,-1575 281.86,-1575 281.86,-1575 281.86,-1487.08 281.86,-1487.08"/>
<polygon fill="black" stroke="black" points="285.36,-1487.08 281.86,-1477.08 278.36,-1487.08 285.36,-1487.08"/>
</g>
<!-- layer_0_qkv_gpu3 -->
<g id="node11" class="node">
<title>layer_0_qkv_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="841.36,-1476.93 482.36,-1476.93 482.36,-1435.93 841.36,-1435.93 841.36,-1476.93"/>
<text text-anchor="middle" x="661.86" y="-1464.93" font-family="Arial" font-size="10.00">QKV Linear</text>
<text text-anchor="middle" x="661.86" y="-1453.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=128]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="661.86" y="-1442.93" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu3 -->
<g id="edge6" class="edge">
<title>layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1530.64,-1554C1187.34,-1554 661.86,-1554 661.86,-1554 661.86,-1554 661.86,-1487.12 661.86,-1487.12"/>
<polygon fill="black" stroke="black" points="665.36,-1487.12 661.86,-1477.12 658.36,-1487.12 665.36,-1487.12"/>
</g>
<!-- layer_0_qkv_gpu4 -->
<g id="node12" class="node">
<title>layer_0_qkv_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="1232.36,-1476.93 873.36,-1476.93 873.36,-1435.93 1232.36,-1435.93 1232.36,-1476.93"/>
<text text-anchor="middle" x="1052.86" y="-1464.93" font-family="Arial" font-size="10.00">QKV Linear</text>
<text text-anchor="middle" x="1052.86" y="-1453.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=128]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="1052.86" y="-1442.93" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu4 -->
<g id="edge7" class="edge">
<title>layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1494.33,-1534C1285.22,-1534 1052.86,-1534 1052.86,-1534 1052.86,-1534 1052.86,-1487.22 1052.86,-1487.22"/>
<polygon fill="black" stroke="black" points="1056.36,-1487.22 1052.86,-1477.22 1049.36,-1487.22 1056.36,-1487.22"/>
</g>
<!-- layer_0_qkv_gpu5 -->
<g id="node13" class="node">
<title>layer_0_qkv_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="1619.36,-1476.93 1260.36,-1476.93 1260.36,-1435.93 1619.36,-1435.93 1619.36,-1476.93"/>
<text text-anchor="middle" x="1439.86" y="-1464.93" font-family="Arial" font-size="10.00">QKV Linear</text>
<text text-anchor="middle" x="1439.86" y="-1453.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=128]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="1439.86" y="-1442.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu5 -->
<g id="edge8" class="edge">
<title>layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1538.68,-1513.73C1538.68,-1513.73 1538.68,-1487.05 1538.68,-1487.05"/>
<polygon fill="black" stroke="black" points="1542.18,-1487.05 1538.68,-1477.05 1535.18,-1487.05 1542.18,-1487.05"/>
</g>
<!-- layer_0_qkv_gpu6 -->
<g id="node14" class="node">
<title>layer_0_qkv_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="2000.36,-1476.93 1641.36,-1476.93 1641.36,-1435.93 2000.36,-1435.93 2000.36,-1476.93"/>
<text text-anchor="middle" x="1820.86" y="-1464.93" font-family="Arial" font-size="10.00">QKV Linear</text>
<text text-anchor="middle" x="1820.86" y="-1453.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=128]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="1820.86" y="-1442.93" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu6 -->
<g id="edge9" class="edge">
<title>layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1820.86,-1513.73C1820.86,-1513.73 1820.86,-1487.05 1820.86,-1487.05"/>
<polygon fill="black" stroke="black" points="1824.36,-1487.05 1820.86,-1477.05 1817.36,-1487.05 1824.36,-1487.05"/>
</g>
<!-- layer_0_qkv_gpu7 -->
<g id="node15" class="node">
<title>layer_0_qkv_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="2381.36,-1476.93 2022.36,-1476.93 2022.36,-1435.93 2381.36,-1435.93 2381.36,-1476.93"/>
<text text-anchor="middle" x="2201.86" y="-1464.93" font-family="Arial" font-size="10.00">QKV Linear</text>
<text text-anchor="middle" x="2201.86" y="-1453.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=128]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="2201.86" y="-1442.93" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu7 -->
<g id="edge10" class="edge">
<title>layer_0_qkv_split&#45;&gt;layer_0_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2103.05,-1551.19C2103.05,-1551.19 2103.05,-1487.28 2103.05,-1487.28"/>
<polygon fill="black" stroke="black" points="2106.55,-1487.28 2103.05,-1477.28 2099.55,-1487.28 2106.55,-1487.28"/>
</g>
<!-- layer_0_attn_gpu0 -->
<g id="node16" class="node">
<title>layer_0_attn_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="2789.36,-1384.93 2416.36,-1384.93 2416.36,-1343.93 2789.36,-1343.93 2789.36,-1384.93"/>
<text text-anchor="middle" x="2602.86" y="-1372.93" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="2602.86" y="-1361.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="2602.86" y="-1350.93" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer_0_qkv_gpu0&#45;&gt;layer_0_attn_gpu0 -->
<g id="edge11" class="edge">
<title>layer_0_qkv_gpu0&#45;&gt;layer_0_attn_gpu0</title>
<path fill="none" stroke="black" d="M2591.86,-1435.55C2591.86,-1435.55 2591.86,-1395.22 2591.86,-1395.22"/>
<polygon fill="black" stroke="black" points="2595.36,-1395.22 2591.86,-1385.22 2588.36,-1395.22 2595.36,-1395.22"/>
</g>
<!-- layer_0_attn_gpu1 -->
<g id="node17" class="node">
<title>layer_0_attn_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="3180.36,-1384.93 2807.36,-1384.93 2807.36,-1343.93 3180.36,-1343.93 3180.36,-1384.93"/>
<text text-anchor="middle" x="2993.86" y="-1372.93" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="2993.86" y="-1361.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="2993.86" y="-1350.93" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer_0_qkv_gpu1&#45;&gt;layer_0_attn_gpu1 -->
<g id="edge12" class="edge">
<title>layer_0_qkv_gpu1&#45;&gt;layer_0_attn_gpu1</title>
<path fill="none" stroke="black" d="M2980.36,-1435.55C2980.36,-1435.55 2980.36,-1395.22 2980.36,-1395.22"/>
<polygon fill="black" stroke="black" points="2983.86,-1395.22 2980.36,-1385.22 2976.86,-1395.22 2983.86,-1395.22"/>
</g>
<!-- layer_0_attn_gpu2 -->
<g id="node18" class="node">
<title>layer_0_attn_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="443.36,-1384.93 70.36,-1384.93 70.36,-1343.93 443.36,-1343.93 443.36,-1384.93"/>
<text text-anchor="middle" x="256.86" y="-1372.93" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="256.86" y="-1361.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="256.86" y="-1350.93" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer_0_qkv_gpu2&#45;&gt;layer_0_attn_gpu2 -->
<g id="edge13" class="edge">
<title>layer_0_qkv_gpu2&#45;&gt;layer_0_attn_gpu2</title>
<path fill="none" stroke="black" d="M272.86,-1435.55C272.86,-1435.55 272.86,-1395.22 272.86,-1395.22"/>
<polygon fill="black" stroke="black" points="276.36,-1395.22 272.86,-1385.22 269.36,-1395.22 276.36,-1395.22"/>
</g>
<!-- layer_0_attn_gpu3 -->
<g id="node19" class="node">
<title>layer_0_attn_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="834.36,-1384.93 461.36,-1384.93 461.36,-1343.93 834.36,-1343.93 834.36,-1384.93"/>
<text text-anchor="middle" x="647.86" y="-1372.93" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="647.86" y="-1361.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="647.86" y="-1350.93" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer_0_qkv_gpu3&#45;&gt;layer_0_attn_gpu3 -->
<g id="edge14" class="edge">
<title>layer_0_qkv_gpu3&#45;&gt;layer_0_attn_gpu3</title>
<path fill="none" stroke="black" d="M658.36,-1435.55C658.36,-1435.55 658.36,-1395.22 658.36,-1395.22"/>
<polygon fill="black" stroke="black" points="661.86,-1395.22 658.36,-1385.22 654.86,-1395.22 661.86,-1395.22"/>
</g>
<!-- layer_0_attn_gpu4 -->
<g id="node20" class="node">
<title>layer_0_attn_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="1225.36,-1384.93 852.36,-1384.93 852.36,-1343.93 1225.36,-1343.93 1225.36,-1384.93"/>
<text text-anchor="middle" x="1038.86" y="-1372.93" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="1038.86" y="-1361.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="1038.86" y="-1350.93" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer_0_qkv_gpu4&#45;&gt;layer_0_attn_gpu4 -->
<g id="edge15" class="edge">
<title>layer_0_qkv_gpu4&#45;&gt;layer_0_attn_gpu4</title>
<path fill="none" stroke="black" d="M1049.36,-1435.55C1049.36,-1435.55 1049.36,-1395.22 1049.36,-1395.22"/>
<polygon fill="black" stroke="black" points="1052.86,-1395.22 1049.36,-1385.22 1045.86,-1395.22 1052.86,-1395.22"/>
</g>
<!-- layer_0_attn_gpu5 -->
<g id="node21" class="node">
<title>layer_0_attn_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="1616.36,-1384.93 1243.36,-1384.93 1243.36,-1343.93 1616.36,-1343.93 1616.36,-1384.93"/>
<text text-anchor="middle" x="1429.86" y="-1372.93" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="1429.86" y="-1361.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="1429.86" y="-1350.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer_0_qkv_gpu5&#45;&gt;layer_0_attn_gpu5 -->
<g id="edge16" class="edge">
<title>layer_0_qkv_gpu5&#45;&gt;layer_0_attn_gpu5</title>
<path fill="none" stroke="black" d="M1438.36,-1435.55C1438.36,-1435.55 1438.36,-1395.22 1438.36,-1395.22"/>
<polygon fill="black" stroke="black" points="1441.86,-1395.22 1438.36,-1385.22 1434.86,-1395.22 1441.86,-1395.22"/>
</g>
<!-- layer_0_attn_gpu6 -->
<g id="node22" class="node">
<title>layer_0_attn_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="2007.36,-1384.93 1634.36,-1384.93 1634.36,-1343.93 2007.36,-1343.93 2007.36,-1384.93"/>
<text text-anchor="middle" x="1820.86" y="-1372.93" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="1820.86" y="-1361.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="1820.86" y="-1350.93" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer_0_qkv_gpu6&#45;&gt;layer_0_attn_gpu6 -->
<g id="edge17" class="edge">
<title>layer_0_qkv_gpu6&#45;&gt;layer_0_attn_gpu6</title>
<path fill="none" stroke="black" d="M1820.86,-1435.55C1820.86,-1435.55 1820.86,-1395.22 1820.86,-1395.22"/>
<polygon fill="black" stroke="black" points="1824.36,-1395.22 1820.86,-1385.22 1817.36,-1395.22 1824.36,-1395.22"/>
</g>
<!-- layer_0_attn_gpu7 -->
<g id="node23" class="node">
<title>layer_0_attn_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="2398.36,-1384.93 2025.36,-1384.93 2025.36,-1343.93 2398.36,-1343.93 2398.36,-1384.93"/>
<text text-anchor="middle" x="2211.86" y="-1372.93" font-family="Arial" font-size="10.00">Attention Compute</text>
<text text-anchor="middle" x="2211.86" y="-1361.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,heads=2,d_k=64]</text>
<text text-anchor="middle" x="2211.86" y="-1350.93" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer_0_qkv_gpu7&#45;&gt;layer_0_attn_gpu7 -->
<g id="edge18" class="edge">
<title>layer_0_qkv_gpu7&#45;&gt;layer_0_attn_gpu7</title>
<path fill="none" stroke="black" d="M2203.36,-1435.55C2203.36,-1435.55 2203.36,-1395.22 2203.36,-1395.22"/>
<polygon fill="black" stroke="black" points="2206.86,-1395.22 2203.36,-1385.22 2199.86,-1395.22 2206.86,-1395.22"/>
</g>
<!-- layer_0_proj_gpu0 -->
<g id="node24" class="node">
<title>layer_0_proj_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="2767.36,-1306.93 2408.36,-1306.93 2408.36,-1265.93 2767.36,-1265.93 2767.36,-1306.93"/>
<text text-anchor="middle" x="2587.86" y="-1294.93" font-family="Arial" font-size="10.00">Projection</text>
<text text-anchor="middle" x="2587.86" y="-1283.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="2587.86" y="-1272.93" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer_0_attn_gpu0&#45;&gt;layer_0_proj_gpu0 -->
<g id="edge19" class="edge">
<title>layer_0_attn_gpu0&#45;&gt;layer_0_proj_gpu0</title>
<path fill="none" stroke="black" d="M2591.86,-1343.53C2591.86,-1343.53 2591.86,-1317.12 2591.86,-1317.12"/>
<polygon fill="black" stroke="black" points="2595.36,-1317.12 2591.86,-1307.12 2588.36,-1317.12 2595.36,-1317.12"/>
</g>
<!-- layer_0_proj_gpu1 -->
<g id="node25" class="node">
<title>layer_0_proj_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="3153.36,-1306.93 2794.36,-1306.93 2794.36,-1265.93 3153.36,-1265.93 3153.36,-1306.93"/>
<text text-anchor="middle" x="2973.86" y="-1294.93" font-family="Arial" font-size="10.00">Projection</text>
<text text-anchor="middle" x="2973.86" y="-1283.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="2973.86" y="-1272.93" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer_0_attn_gpu1&#45;&gt;layer_0_proj_gpu1 -->
<g id="edge20" class="edge">
<title>layer_0_attn_gpu1&#45;&gt;layer_0_proj_gpu1</title>
<path fill="none" stroke="black" d="M2980.36,-1343.53C2980.36,-1343.53 2980.36,-1317.12 2980.36,-1317.12"/>
<polygon fill="black" stroke="black" points="2983.86,-1317.12 2980.36,-1307.12 2976.86,-1317.12 2983.86,-1317.12"/>
</g>
<!-- layer_0_proj_gpu2 -->
<g id="node26" class="node">
<title>layer_0_proj_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="466.36,-1306.93 107.36,-1306.93 107.36,-1265.93 466.36,-1265.93 466.36,-1306.93"/>
<text text-anchor="middle" x="286.86" y="-1294.93" font-family="Arial" font-size="10.00">Projection</text>
<text text-anchor="middle" x="286.86" y="-1283.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="286.86" y="-1272.93" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer_0_attn_gpu2&#45;&gt;layer_0_proj_gpu2 -->
<g id="edge21" class="edge">
<title>layer_0_attn_gpu2&#45;&gt;layer_0_proj_gpu2</title>
<path fill="none" stroke="black" d="M275.36,-1343.53C275.36,-1343.53 275.36,-1317.12 275.36,-1317.12"/>
<polygon fill="black" stroke="black" points="278.86,-1317.12 275.36,-1307.12 271.86,-1317.12 278.86,-1317.12"/>
</g>
<!-- layer_0_proj_gpu3 -->
<g id="node27" class="node">
<title>layer_0_proj_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="857.36,-1306.93 498.36,-1306.93 498.36,-1265.93 857.36,-1265.93 857.36,-1306.93"/>
<text text-anchor="middle" x="677.86" y="-1294.93" font-family="Arial" font-size="10.00">Projection</text>
<text text-anchor="middle" x="677.86" y="-1283.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="677.86" y="-1272.93" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer_0_attn_gpu3&#45;&gt;layer_0_proj_gpu3 -->
<g id="edge22" class="edge">
<title>layer_0_attn_gpu3&#45;&gt;layer_0_proj_gpu3</title>
<path fill="none" stroke="black" d="M666.36,-1343.53C666.36,-1343.53 666.36,-1317.12 666.36,-1317.12"/>
<polygon fill="black" stroke="black" points="669.86,-1317.12 666.36,-1307.12 662.86,-1317.12 669.86,-1317.12"/>
</g>
<!-- layer_0_proj_gpu4 -->
<g id="node28" class="node">
<title>layer_0_proj_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="1241.36,-1306.93 882.36,-1306.93 882.36,-1265.93 1241.36,-1265.93 1241.36,-1306.93"/>
<text text-anchor="middle" x="1061.86" y="-1294.93" font-family="Arial" font-size="10.00">Projection</text>
<text text-anchor="middle" x="1061.86" y="-1283.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="1061.86" y="-1272.93" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer_0_attn_gpu4&#45;&gt;layer_0_proj_gpu4 -->
<g id="edge23" class="edge">
<title>layer_0_attn_gpu4&#45;&gt;layer_0_proj_gpu4</title>
<path fill="none" stroke="black" d="M1053.86,-1343.53C1053.86,-1343.53 1053.86,-1317.12 1053.86,-1317.12"/>
<polygon fill="black" stroke="black" points="1057.36,-1317.12 1053.86,-1307.12 1050.36,-1317.12 1057.36,-1317.12"/>
</g>
<!-- layer_0_proj_gpu5 -->
<g id="node29" class="node">
<title>layer_0_proj_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="1621.36,-1306.93 1262.36,-1306.93 1262.36,-1265.93 1621.36,-1265.93 1621.36,-1306.93"/>
<text text-anchor="middle" x="1441.86" y="-1294.93" font-family="Arial" font-size="10.00">Projection</text>
<text text-anchor="middle" x="1441.86" y="-1283.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="1441.86" y="-1272.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer_0_attn_gpu5&#45;&gt;layer_0_proj_gpu5 -->
<g id="edge24" class="edge">
<title>layer_0_attn_gpu5&#45;&gt;layer_0_proj_gpu5</title>
<path fill="none" stroke="black" d="M1439.36,-1343.53C1439.36,-1343.53 1439.36,-1317.12 1439.36,-1317.12"/>
<polygon fill="black" stroke="black" points="1442.86,-1317.12 1439.36,-1307.12 1435.86,-1317.12 1442.86,-1317.12"/>
</g>
<!-- layer_0_proj_gpu6 -->
<g id="node30" class="node">
<title>layer_0_proj_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="2000.36,-1306.93 1641.36,-1306.93 1641.36,-1265.93 2000.36,-1265.93 2000.36,-1306.93"/>
<text text-anchor="middle" x="1820.86" y="-1294.93" font-family="Arial" font-size="10.00">Projection</text>
<text text-anchor="middle" x="1820.86" y="-1283.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="1820.86" y="-1272.93" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer_0_attn_gpu6&#45;&gt;layer_0_proj_gpu6 -->
<g id="edge25" class="edge">
<title>layer_0_attn_gpu6&#45;&gt;layer_0_proj_gpu6</title>
<path fill="none" stroke="black" d="M1820.86,-1343.53C1820.86,-1343.53 1820.86,-1317.12 1820.86,-1317.12"/>
<polygon fill="black" stroke="black" points="1824.36,-1317.12 1820.86,-1307.12 1817.36,-1317.12 1824.36,-1317.12"/>
</g>
<!-- layer_0_proj_gpu7 -->
<g id="node31" class="node">
<title>layer_0_proj_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="2381.36,-1306.93 2022.36,-1306.93 2022.36,-1265.93 2381.36,-1265.93 2381.36,-1306.93"/>
<text text-anchor="middle" x="2201.86" y="-1294.93" font-family="Arial" font-size="10.00">Projection</text>
<text text-anchor="middle" x="2201.86" y="-1283.93" font-family="Arial" font-size="10.00">[batch=128,seq=1024,heads=2,d_k=64]→[batch=128,seq=1024,d_model=128]</text>
<text text-anchor="middle" x="2201.86" y="-1272.93" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer_0_attn_gpu7&#45;&gt;layer_0_proj_gpu7 -->
<g id="edge26" class="edge">
<title>layer_0_attn_gpu7&#45;&gt;layer_0_proj_gpu7</title>
<path fill="none" stroke="black" d="M2203.36,-1343.53C2203.36,-1343.53 2203.36,-1317.12 2203.36,-1317.12"/>
<polygon fill="black" stroke="black" points="2206.86,-1317.12 2203.36,-1307.12 2199.86,-1317.12 2206.86,-1317.12"/>
</g>
<!-- layer_0_attn_allreduce -->
<g id="node32" class="node">
<title>layer_0_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="1820.86" cy="-1199.94" rx="247.47" ry="28.98"/>
<text text-anchor="middle" x="1820.86" y="-1208.44" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="1820.86" y="-1197.44" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=128]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="1820.86" y="-1186.44" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_proj_gpu0&#45;&gt;layer_0_attn_allreduce -->
<g id="edge27" class="edge">
<title>layer_0_proj_gpu0&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2488.03,-1265.87C2488.03,-1244.46 2488.03,-1214 2488.03,-1214 2488.03,-1214 2047.47,-1214 2047.47,-1214"/>
<polygon fill="black" stroke="black" points="2047.47,-1210.5 2037.47,-1214 2047.47,-1217.5 2047.47,-1210.5"/>
</g>
<!-- layer_0_proj_gpu1&#45;&gt;layer_0_attn_allreduce -->
<g id="edge28" class="edge">
<title>layer_0_proj_gpu1&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2913.36,-1265.71C2913.36,-1239.86 2913.36,-1199 2913.36,-1199 2913.36,-1199 2078.43,-1199 2078.43,-1199"/>
<polygon fill="black" stroke="black" points="2078.43,-1195.5 2068.43,-1199 2078.43,-1202.5 2078.43,-1195.5"/>
</g>
<!-- layer_0_proj_gpu2&#45;&gt;layer_0_attn_allreduce -->
<g id="edge29" class="edge">
<title>layer_0_proj_gpu2&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M446.86,-1265.9C446.86,-1236.27 446.86,-1185 446.86,-1185 446.86,-1185 1598.44,-1185 1598.44,-1185"/>
<polygon fill="black" stroke="black" points="1598.44,-1188.5 1608.44,-1185 1598.44,-1181.5 1598.44,-1188.5"/>
</g>
<!-- layer_0_proj_gpu3&#45;&gt;layer_0_attn_allreduce -->
<g id="edge30" class="edge">
<title>layer_0_proj_gpu3&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M828.86,-1265.71C828.86,-1239.86 828.86,-1199 828.86,-1199 828.86,-1199 1563.42,-1199 1563.42,-1199"/>
<polygon fill="black" stroke="black" points="1563.42,-1202.5 1573.42,-1199 1563.42,-1195.5 1563.42,-1202.5"/>
</g>
<!-- layer_0_proj_gpu4&#45;&gt;layer_0_attn_allreduce -->
<g id="edge31" class="edge">
<title>layer_0_proj_gpu4&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M1207.36,-1265.87C1207.36,-1244.46 1207.36,-1214 1207.36,-1214 1207.36,-1214 1594.13,-1214 1594.13,-1214"/>
<polygon fill="black" stroke="black" points="1594.13,-1217.5 1604.13,-1214 1594.13,-1210.5 1594.13,-1217.5"/>
</g>
<!-- layer_0_proj_gpu5&#45;&gt;layer_0_attn_allreduce -->
<g id="edge32" class="edge">
<title>layer_0_proj_gpu5&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M1597.37,-1265.49C1597.37,-1265.49 1597.37,-1222.4 1597.37,-1222.4"/>
<polygon fill="black" stroke="black" points="1600.87,-1222.4 1597.37,-1212.4 1593.87,-1222.4 1600.87,-1222.4"/>
</g>
<!-- layer_0_proj_gpu6&#45;&gt;layer_0_attn_allreduce -->
<g id="edge33" class="edge">
<title>layer_0_proj_gpu6&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M1820.86,-1265.49C1820.86,-1265.49 1820.86,-1239.18 1820.86,-1239.18"/>
<polygon fill="black" stroke="black" points="1824.36,-1239.18 1820.86,-1229.18 1817.36,-1239.18 1824.36,-1239.18"/>
</g>
<!-- layer_0_proj_gpu7&#45;&gt;layer_0_attn_allreduce -->
<g id="edge34" class="edge">
<title>layer_0_proj_gpu7&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2045.36,-1265.49C2045.36,-1265.49 2045.36,-1222.15 2045.36,-1222.15"/>
<polygon fill="black" stroke="black" points="2048.86,-1222.15 2045.36,-1212.15 2041.86,-1222.15 2048.86,-1222.15"/>
</g>
<!-- layer_0_attn_allreduce&#45;&gt;layer_0_add_norm1 -->
<g id="edge35" class="edge">
<title>layer_0_attn_allreduce&#45;&gt;layer_0_add_norm1</title>
<path fill="none" stroke="black" d="M2033.08,-1185C2299.59,-1185 2722.36,-1185 2722.36,-1185 2722.36,-1185 2722.36,-1144.14 2722.36,-1144.14"/>
<polygon fill="black" stroke="black" points="2725.86,-1144.14 2722.36,-1134.14 2718.86,-1144.14 2725.86,-1144.14"/>
</g>
<!-- layer_0_gate -->
<g id="node34" class="node">
<title>layer_0_gate</title>
<polygon fill="yellow" stroke="black" points="3548.46,-1055.95 3019.37,-1055.95 2883.27,-973.95 3412.35,-973.95 3548.46,-1055.95"/>
<text text-anchor="middle" x="3215.86" y="-1023.45" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="3215.86" y="-1012.45" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,topk=2]</text>
<text text-anchor="middle" x="3215.86" y="-1001.45" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_gate -->
<g id="edge37" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" d="M2957.71,-1092.56C2957.71,-1092.56 2957.71,-1028.92 2957.71,-1028.92"/>
<polygon fill="black" stroke="black" points="2961.21,-1028.92 2957.71,-1018.92 2954.21,-1028.92 2961.21,-1028.92"/>
</g>
<!-- layer_0_ep0_scatter -->
<g id="node35" class="node">
<title>layer_0_ep0_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3215.86" cy="-893.96" rx="251.05" ry="28.98"/>
<text text-anchor="middle" x="3215.86" y="-902.46" font-family="Arial" font-size="10.00">EP Scatter</text>
<text text-anchor="middle" x="3215.86" y="-891.46" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="3215.86" y="-880.46" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_ep0_scatter -->
<g id="edge38" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_ep0_scatter</title>
<path fill="none" stroke="black" d="M2780.21,-1092.59C2780.21,-1041.64 2780.21,-915 2780.21,-915 2780.21,-915 3033.06,-915 3033.06,-915"/>
<polygon fill="black" stroke="black" points="3033.06,-918.5 3043.06,-915 3033.06,-911.5 3033.06,-918.5"/>
</g>
<!-- layer_0_add_norm2 -->
<g id="node60" class="node">
<title>layer_0_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="540.36,-535.98 185.36,-535.98 185.36,-494.98 540.36,-494.98 540.36,-535.98"/>
<text text-anchor="middle" x="362.86" y="-523.98" font-family="Arial" font-size="10.00">Add+Residual+Norm</text>
<text text-anchor="middle" x="362.86" y="-512.98" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="362.86" y="-501.98" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_add_norm2 -->
<g id="edge77" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2677.18,-1113C2098.69,-1113 306.36,-1113 306.36,-1113 306.36,-1113 306.36,-546.05 306.36,-546.05"/>
<polygon fill="black" stroke="black" points="309.86,-546.05 306.36,-536.05 302.86,-546.05 309.86,-546.05"/>
<text text-anchor="middle" x="379.86" y="-803.77" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_ep0_scatter -->
<g id="edge39" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_ep0_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3215.86,-973.65C3215.86,-973.65 3215.86,-933.25 3215.86,-933.25"/>
<polygon fill="black" stroke="black" points="3219.36,-933.25 3215.86,-923.25 3212.36,-933.25 3219.36,-933.25"/>
<text text-anchor="middle" x="3242.36" y="-944.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_exp0_gpu0 -->
<g id="node39" class="node">
<title>layer_0_exp0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="6004.36,-827.97 5649.36,-827.97 5649.36,-786.97 6004.36,-786.97 6004.36,-827.97"/>
<text text-anchor="middle" x="5826.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="5826.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="5826.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp0_gpu0 -->
<g id="edge40" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp0_gpu0</title>
<path fill="none" stroke="black" d="M3435.66,-908C4064.66,-908 5826.86,-908 5826.86,-908 5826.86,-908 5826.86,-838.3 5826.86,-838.3"/>
<polygon fill="black" stroke="black" points="5830.36,-838.3 5826.86,-828.3 5823.36,-838.3 5830.36,-838.3"/>
</g>
<!-- layer_0_exp1_gpu0 -->
<g id="node40" class="node">
<title>layer_0_exp1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="6377.36,-827.97 6022.36,-827.97 6022.36,-786.97 6377.36,-786.97 6377.36,-827.97"/>
<text text-anchor="middle" x="6199.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="6199.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="6199.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp1_gpu0 -->
<g id="edge41" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp1_gpu0</title>
<path fill="none" stroke="black" d="M3388.65,-915C4024.81,-915 6199.86,-915 6199.86,-915 6199.86,-915 6199.86,-838.2 6199.86,-838.2"/>
<polygon fill="black" stroke="black" points="6203.36,-838.2 6199.86,-828.2 6196.36,-838.2 6203.36,-838.2"/>
</g>
<!-- layer_0_exp2_gpu1 -->
<g id="node41" class="node">
<title>layer_0_exp2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="782.36,-827.97 427.36,-827.97 427.36,-786.97 782.36,-786.97 782.36,-827.97"/>
<text text-anchor="middle" x="604.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="604.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="604.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp2_gpu1 -->
<g id="edge42" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp2_gpu1</title>
<path fill="none" stroke="black" d="M2996,-908C2372.93,-908 640.36,-908 640.36,-908 640.36,-908 640.36,-838.3 640.36,-838.3"/>
<polygon fill="black" stroke="black" points="643.86,-838.3 640.36,-828.3 636.86,-838.3 643.86,-838.3"/>
</g>
<!-- layer_0_exp3_gpu1 -->
<g id="node42" class="node">
<title>layer_0_exp3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1155.36,-827.97 800.36,-827.97 800.36,-786.97 1155.36,-786.97 1155.36,-827.97"/>
<text text-anchor="middle" x="977.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="977.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="977.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp3_gpu1 -->
<g id="edge43" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp3_gpu1</title>
<path fill="none" stroke="black" d="M2972.35,-901C2400.34,-901 1018.86,-901 1018.86,-901 1018.86,-901 1018.86,-838.22 1018.86,-838.22"/>
<polygon fill="black" stroke="black" points="1022.36,-838.22 1018.86,-828.22 1015.36,-838.22 1022.36,-838.22"/>
</g>
<!-- layer_0_exp4_gpu2 -->
<g id="node43" class="node">
<title>layer_0_exp4_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1528.36,-827.97 1173.36,-827.97 1173.36,-786.97 1528.36,-786.97 1528.36,-827.97"/>
<text text-anchor="middle" x="1350.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1350.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="1350.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp4_gpu2 -->
<g id="edge44" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp4_gpu2</title>
<path fill="none" stroke="black" d="M2964.64,-893C2465.23,-893 1395.36,-893 1395.36,-893 1395.36,-893 1395.36,-838.17 1395.36,-838.17"/>
<polygon fill="black" stroke="black" points="1398.86,-838.17 1395.36,-828.17 1391.86,-838.17 1398.86,-838.17"/>
</g>
<!-- layer_0_exp5_gpu2 -->
<g id="node44" class="node">
<title>layer_0_exp5_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1901.36,-827.97 1546.36,-827.97 1546.36,-786.97 1901.36,-786.97 1901.36,-827.97"/>
<text text-anchor="middle" x="1723.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1723.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="1723.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp5_gpu2 -->
<g id="edge45" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp5_gpu2</title>
<path fill="none" stroke="black" d="M2974.2,-886C2555,-886 1737.37,-886 1737.37,-886 1737.37,-886 1737.37,-838.1 1737.37,-838.1"/>
<polygon fill="black" stroke="black" points="1740.87,-838.1 1737.37,-828.1 1733.87,-838.1 1740.87,-838.1"/>
</g>
<!-- layer_0_exp6_gpu3 -->
<g id="node45" class="node">
<title>layer_0_exp6_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="2274.36,-827.97 1919.36,-827.97 1919.36,-786.97 2274.36,-786.97 2274.36,-827.97"/>
<text text-anchor="middle" x="2096.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2096.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="2096.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp6_gpu3 -->
<g id="edge46" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp6_gpu3</title>
<path fill="none" stroke="black" d="M3000.71,-879C2694.94,-879 2171.36,-879 2171.36,-879 2171.36,-879 2171.36,-838.16 2171.36,-838.16"/>
<polygon fill="black" stroke="black" points="2174.86,-838.16 2171.36,-828.16 2167.86,-838.16 2174.86,-838.16"/>
</g>
<!-- layer_0_exp7_gpu3 -->
<g id="node46" class="node">
<title>layer_0_exp7_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="2647.36,-827.97 2292.36,-827.97 2292.36,-786.97 2647.36,-786.97 2647.36,-827.97"/>
<text text-anchor="middle" x="2469.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2469.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="2469.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp7_gpu3 -->
<g id="edge47" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp7_gpu3</title>
<path fill="none" stroke="black" d="M3051.88,-872C2859.86,-872 2567.7,-872 2567.7,-872 2567.7,-872 2567.7,-838.24 2567.7,-838.24"/>
<polygon fill="black" stroke="black" points="2571.2,-838.24 2567.7,-828.24 2564.2,-838.24 2571.2,-838.24"/>
</g>
<!-- layer_0_exp8_gpu4 -->
<g id="node47" class="node">
<title>layer_0_exp8_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="3020.36,-827.97 2665.36,-827.97 2665.36,-786.97 3020.36,-786.97 3020.36,-827.97"/>
<text text-anchor="middle" x="2842.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2842.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="2842.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp8_gpu4 -->
<g id="edge48" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp8_gpu4</title>
<path fill="none" stroke="black" d="M2992.6,-880.44C2992.6,-880.44 2992.6,-838.29 2992.6,-838.29"/>
<polygon fill="black" stroke="black" points="2996.1,-838.29 2992.6,-828.29 2989.1,-838.29 2996.1,-838.29"/>
</g>
<!-- layer_0_exp9_gpu4 -->
<g id="node48" class="node">
<title>layer_0_exp9_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="3393.36,-827.97 3038.36,-827.97 3038.36,-786.97 3393.36,-786.97 3393.36,-827.97"/>
<text text-anchor="middle" x="3215.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3215.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="3215.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp9_gpu4 -->
<g id="edge49" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp9_gpu4</title>
<path fill="none" stroke="black" d="M3215.86,-864.67C3215.86,-864.67 3215.86,-837.98 3215.86,-837.98"/>
<polygon fill="black" stroke="black" points="3219.36,-837.98 3215.86,-827.98 3212.36,-837.98 3219.36,-837.98"/>
</g>
<!-- layer_0_exp10_gpu5 -->
<g id="node49" class="node">
<title>layer_0_exp10_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3766.36,-827.97 3411.36,-827.97 3411.36,-786.97 3766.36,-786.97 3766.36,-827.97"/>
<text text-anchor="middle" x="3588.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3588.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="3588.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp10_gpu5 -->
<g id="edge50" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp10_gpu5</title>
<path fill="none" stroke="black" d="M3439.13,-880.44C3439.13,-880.44 3439.13,-838.29 3439.13,-838.29"/>
<polygon fill="black" stroke="black" points="3442.63,-838.29 3439.13,-828.29 3435.63,-838.29 3442.63,-838.29"/>
</g>
<!-- layer_0_exp11_gpu5 -->
<g id="node50" class="node">
<title>layer_0_exp11_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="4139.36,-827.97 3784.36,-827.97 3784.36,-786.97 4139.36,-786.97 4139.36,-827.97"/>
<text text-anchor="middle" x="3961.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3961.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="3961.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp11_gpu5 -->
<g id="edge51" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp11_gpu5</title>
<path fill="none" stroke="black" d="M3380.04,-872C3599.68,-872 3961.86,-872 3961.86,-872 3961.86,-872 3961.86,-838.24 3961.86,-838.24"/>
<polygon fill="black" stroke="black" points="3965.36,-838.24 3961.86,-828.24 3958.36,-838.24 3965.36,-838.24"/>
</g>
<!-- layer_0_exp12_gpu6 -->
<g id="node51" class="node">
<title>layer_0_exp12_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="4512.36,-827.97 4157.36,-827.97 4157.36,-786.97 4512.36,-786.97 4512.36,-827.97"/>
<text text-anchor="middle" x="4334.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4334.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="4334.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp12_gpu6 -->
<g id="edge52" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp12_gpu6</title>
<path fill="none" stroke="black" d="M3431.06,-879C3720.85,-879 4200.63,-879 4200.63,-879 4200.63,-879 4200.63,-838.16 4200.63,-838.16"/>
<polygon fill="black" stroke="black" points="4204.13,-838.16 4200.63,-828.16 4197.13,-838.16 4204.13,-838.16"/>
</g>
<!-- layer_0_exp13_gpu6 -->
<g id="node52" class="node">
<title>layer_0_exp13_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="4885.36,-827.97 4530.36,-827.97 4530.36,-786.97 4885.36,-786.97 4885.36,-827.97"/>
<text text-anchor="middle" x="4707.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4707.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="4707.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp13_gpu6 -->
<g id="edge53" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp13_gpu6</title>
<path fill="none" stroke="black" d="M3457.44,-886C3865.45,-886 4647.13,-886 4647.13,-886 4647.13,-886 4647.13,-838.1 4647.13,-838.1"/>
<polygon fill="black" stroke="black" points="4650.63,-838.1 4647.13,-828.1 4643.63,-838.1 4650.63,-838.1"/>
</g>
<!-- layer_0_exp14_gpu7 -->
<g id="node53" class="node">
<title>layer_0_exp14_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="5258.36,-827.97 4903.36,-827.97 4903.36,-786.97 5258.36,-786.97 5258.36,-827.97"/>
<text text-anchor="middle" x="5080.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="5080.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="5080.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp14_gpu7 -->
<g id="edge54" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp14_gpu7</title>
<path fill="none" stroke="black" d="M3466.9,-893C3975.75,-893 5080.86,-893 5080.86,-893 5080.86,-893 5080.86,-838.17 5080.86,-838.17"/>
<polygon fill="black" stroke="black" points="5084.36,-838.17 5080.86,-828.17 5077.36,-838.17 5084.36,-838.17"/>
</g>
<!-- layer_0_exp15_gpu7 -->
<g id="node54" class="node">
<title>layer_0_exp15_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="5631.36,-827.97 5276.36,-827.97 5276.36,-786.97 5631.36,-786.97 5631.36,-827.97"/>
<text text-anchor="middle" x="5453.86" y="-815.97" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="5453.86" y="-804.97" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="5453.86" y="-793.97" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer_0_ep0_scatter&#45;&gt;layer_0_exp15_gpu7 -->
<g id="edge55" class="edge">
<title>layer_0_ep0_scatter&#45;&gt;layer_0_exp15_gpu7</title>
<path fill="none" stroke="black" d="M3459.49,-901C4005.59,-901 5280.13,-901 5280.13,-901 5280.13,-901 5280.13,-838.22 5280.13,-838.22"/>
<polygon fill="black" stroke="black" points="5283.63,-838.22 5280.13,-828.22 5276.63,-838.22 5283.63,-838.22"/>
</g>
<!-- layer_0_ep1_scatter -->
<g id="node36" class="node">
<title>layer_0_ep1_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3992.86" cy="-1780.92" rx="251.05" ry="28.98"/>
<text text-anchor="middle" x="3992.86" y="-1789.42" font-family="Arial" font-size="10.00">EP Scatter</text>
<text text-anchor="middle" x="3992.86" y="-1778.42" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="3992.86" y="-1767.42" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
</g>
<!-- layer_0_ep2_scatter -->
<g id="node37" class="node">
<title>layer_0_ep2_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="4512.86" cy="-1780.92" rx="251.05" ry="28.98"/>
<text text-anchor="middle" x="4512.86" y="-1789.42" font-family="Arial" font-size="10.00">EP Scatter</text>
<text text-anchor="middle" x="4512.86" y="-1778.42" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="4512.86" y="-1767.42" font-family="Arial" font-size="10.00">GPU: 16&#45;23</text>
</g>
<!-- layer_0_ep3_scatter -->
<g id="node38" class="node">
<title>layer_0_ep3_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="5032.86" cy="-1780.92" rx="251.05" ry="28.98"/>
<text text-anchor="middle" x="5032.86" y="-1789.42" font-family="Arial" font-size="10.00">EP Scatter</text>
<text text-anchor="middle" x="5032.86" y="-1778.42" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="5032.86" y="-1767.42" font-family="Arial" font-size="10.00">GPU: 24&#45;31</text>
</g>
<!-- layer_0_ep0_gather -->
<g id="node55" class="node">
<title>layer_0_ep0_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3215.86" cy="-720.97" rx="251.05" ry="28.98"/>
<text text-anchor="middle" x="3215.86" y="-729.47" font-family="Arial" font-size="10.00">EP Gather</text>
<text text-anchor="middle" x="3215.86" y="-718.47" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="3215.86" y="-707.47" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_exp0_gpu0&#45;&gt;layer_0_ep0_gather -->
<g id="edge56" class="edge">
<title>layer_0_exp0_gpu0&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M5826.86,-786.93C5826.86,-757.28 5826.86,-706 5826.86,-706 5826.86,-706 3440.92,-706 3440.92,-706"/>
<polygon fill="black" stroke="black" points="3440.92,-702.5 3430.92,-706 3440.92,-709.5 3440.92,-702.5"/>
</g>
<!-- layer_0_exp1_gpu0&#45;&gt;layer_0_ep0_gather -->
<g id="edge57" class="edge">
<title>layer_0_exp1_gpu0&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M6199.86,-786.81C6199.86,-755.34 6199.86,-699 6199.86,-699 6199.86,-699 3389.75,-699 3389.75,-699"/>
<polygon fill="black" stroke="black" points="3389.75,-695.5 3379.75,-699 3389.75,-702.5 3389.75,-695.5"/>
</g>
<!-- layer_0_exp2_gpu1&#45;&gt;layer_0_ep0_gather -->
<g id="edge58" class="edge">
<title>layer_0_exp2_gpu1&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M754.05,-786.83C754.05,-772.51 754.05,-756 754.05,-756 754.05,-756 2972.77,-756 2972.77,-756 2972.77,-756 2972.77,-738.4 2972.77,-738.4"/>
<polygon fill="black" stroke="black" points="2976.27,-738.4 2972.77,-728.4 2969.27,-738.4 2976.27,-738.4"/>
</g>
<!-- layer_0_exp3_gpu1&#45;&gt;layer_0_ep0_gather -->
<g id="edge59" class="edge">
<title>layer_0_exp3_gpu1&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M1055.1,-786.86C1055.1,-774.83 1055.1,-762 1055.1,-762 1055.1,-762 2980.7,-762 2980.7,-762 2980.7,-762 2980.7,-741.33 2980.7,-741.33"/>
<polygon fill="black" stroke="black" points="2984.2,-741.33 2980.7,-731.33 2977.2,-741.33 2984.2,-741.33"/>
</g>
<!-- layer_0_exp4_gpu2&#45;&gt;layer_0_ep0_gather -->
<g id="edge60" class="edge">
<title>layer_0_exp4_gpu2&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M1501.6,-786.81C1501.6,-777.26 1501.6,-768 1501.6,-768 1501.6,-768 2988.64,-768 2988.64,-768 2988.64,-768 2988.64,-743.33 2988.64,-743.33"/>
<polygon fill="black" stroke="black" points="2992.14,-743.33 2988.64,-733.33 2985.14,-743.33 2992.14,-743.33"/>
</g>
<!-- layer_0_exp5_gpu2&#45;&gt;layer_0_ep0_gather -->
<g id="edge61" class="edge">
<title>layer_0_exp5_gpu2&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M1723.86,-786.84C1723.86,-779.96 1723.86,-774 1723.86,-774 1723.86,-774 2996.57,-774 2996.57,-774 2996.57,-774 2996.57,-745.18 2996.57,-745.18"/>
<polygon fill="black" stroke="black" points="3000.07,-745.18 2996.57,-735.18 2993.07,-745.18 3000.07,-745.18"/>
</g>
<!-- layer_0_exp6_gpu3&#45;&gt;layer_0_ep0_gather -->
<g id="edge62" class="edge">
<title>layer_0_exp6_gpu3&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M2134.6,-786.93C2134.6,-782.96 2134.6,-780 2134.6,-780 2134.6,-780 3004.5,-780 3004.5,-780 3004.5,-780 3004.5,-746.79 3004.5,-746.79"/>
<polygon fill="black" stroke="black" points="3008,-746.79 3004.5,-736.79 3001,-746.79 3008,-746.79"/>
</g>
<!-- layer_0_exp7_gpu3&#45;&gt;layer_0_ep0_gather -->
<g id="edge63" class="edge">
<title>layer_0_exp7_gpu3&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M2572.13,-786.74C2572.13,-760.87 2572.13,-720 2572.13,-720 2572.13,-720 2954.67,-720 2954.67,-720"/>
<polygon fill="black" stroke="black" points="2954.67,-723.5 2964.67,-720 2954.67,-716.5 2954.67,-723.5"/>
</g>
<!-- layer_0_exp8_gpu4&#45;&gt;layer_0_ep0_gather -->
<g id="edge64" class="edge">
<title>layer_0_exp8_gpu4&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M3012.43,-786.53C3012.43,-786.53 3012.43,-748.23 3012.43,-748.23"/>
<polygon fill="black" stroke="black" points="3015.93,-748.23 3012.43,-738.23 3008.93,-748.23 3015.93,-748.23"/>
</g>
<!-- layer_0_exp9_gpu4&#45;&gt;layer_0_ep0_gather -->
<g id="edge65" class="edge">
<title>layer_0_exp9_gpu4&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M3215.86,-786.53C3215.86,-786.53 3215.86,-760.21 3215.86,-760.21"/>
<polygon fill="black" stroke="black" points="3219.36,-760.21 3215.86,-750.21 3212.36,-760.21 3219.36,-760.21"/>
</g>
<!-- layer_0_exp10_gpu5&#45;&gt;layer_0_ep0_gather -->
<g id="edge66" class="edge">
<title>layer_0_exp10_gpu5&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M3439.13,-786.53C3439.13,-786.53 3439.13,-744.45 3439.13,-744.45"/>
<polygon fill="black" stroke="black" points="3442.63,-744.45 3439.13,-734.45 3435.63,-744.45 3442.63,-744.45"/>
</g>
<!-- layer_0_exp11_gpu5&#45;&gt;layer_0_ep0_gather -->
<g id="edge67" class="edge">
<title>layer_0_exp11_gpu5&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M3961.86,-786.75C3961.86,-767.57 3961.86,-742 3961.86,-742 3961.86,-742 3398.89,-742 3398.89,-742"/>
<polygon fill="black" stroke="black" points="3398.89,-738.5 3388.89,-742 3398.89,-745.5 3398.89,-738.5"/>
</g>
<!-- layer_0_exp12_gpu6&#45;&gt;layer_0_ep0_gather -->
<g id="edge68" class="edge">
<title>layer_0_exp12_gpu6&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M4334.86,-786.89C4334.86,-765.47 4334.86,-735 4334.86,-735 4334.86,-735 3445.61,-735 3445.61,-735"/>
<polygon fill="black" stroke="black" points="3445.61,-731.5 3435.61,-735 3445.61,-738.5 3445.61,-731.5"/>
</g>
<!-- layer_0_exp13_gpu6&#45;&gt;layer_0_ep0_gather -->
<g id="edge69" class="edge">
<title>layer_0_exp13_gpu6&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M4707.86,-786.59C4707.86,-763.04 4707.86,-728 4707.86,-728 4707.86,-728 3469.73,-728 3469.73,-728"/>
<polygon fill="black" stroke="black" points="3469.73,-724.5 3459.73,-728 3469.73,-731.5 3469.73,-724.5"/>
</g>
<!-- layer_0_exp14_gpu7&#45;&gt;layer_0_ep0_gather -->
<g id="edge70" class="edge">
<title>layer_0_exp14_gpu7&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M5080.86,-786.74C5080.86,-760.87 5080.86,-720 5080.86,-720 5080.86,-720 3476.9,-720 3476.9,-720"/>
<polygon fill="black" stroke="black" points="3476.9,-716.5 3466.9,-720 3476.9,-723.5 3476.9,-716.5"/>
</g>
<!-- layer_0_exp15_gpu7&#45;&gt;layer_0_ep0_gather -->
<g id="edge71" class="edge">
<title>layer_0_exp15_gpu7&#45;&gt;layer_0_ep0_gather</title>
<path fill="none" stroke="black" d="M5453.86,-786.5C5453.86,-758.67 5453.86,-713 5453.86,-713 5453.86,-713 3467.23,-713 3467.23,-713"/>
<polygon fill="black" stroke="black" points="3467.23,-709.5 3457.23,-713 3467.23,-716.5 3467.23,-709.5"/>
</g>
<!-- layer_0_moe_agg -->
<g id="node59" class="node">
<title>layer_0_moe_agg</title>
<polygon fill="yellow" stroke="black" points="2093.96,-654.98 1508.4,-654.98 1357.77,-572.98 1943.33,-572.98 2093.96,-654.98"/>
<text text-anchor="middle" x="1725.86" y="-622.48" font-family="Arial" font-size="10.00">MoE Aggregation</text>
<text text-anchor="middle" x="1725.86" y="-611.48" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="1725.86" y="-600.48" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
</g>
<!-- layer_0_ep0_gather&#45;&gt;layer_0_moe_agg -->
<g id="edge72" class="edge">
<title>layer_0_ep0_gather&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M3215.86,-691.75C3215.86,-659.78 3215.86,-613 3215.86,-613 3215.86,-613 2027.13,-613 2027.13,-613"/>
<polygon fill="black" stroke="black" points="2027.13,-609.5 2017.13,-613 2027.13,-616.5 2027.13,-609.5"/>
</g>
<!-- layer_0_ep1_gather -->
<g id="node56" class="node">
<title>layer_0_ep1_gather</title>
<ellipse fill="lightgray" stroke="black" cx="1205.86" cy="-720.97" rx="251.05" ry="28.98"/>
<text text-anchor="middle" x="1205.86" y="-729.47" font-family="Arial" font-size="10.00">EP Gather</text>
<text text-anchor="middle" x="1205.86" y="-718.47" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="1205.86" y="-707.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
</g>
<!-- layer_0_ep1_gather&#45;&gt;layer_0_moe_agg -->
<g id="edge73" class="edge">
<title>layer_0_ep1_gather&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1407.35,-703.31C1407.35,-703.31 1407.35,-624.15 1407.35,-624.15"/>
<polygon fill="black" stroke="black" points="1410.85,-624.15 1407.35,-614.15 1403.85,-624.15 1410.85,-624.15"/>
</g>
<!-- layer_0_ep2_gather -->
<g id="node57" class="node">
<title>layer_0_ep2_gather</title>
<ellipse fill="lightgray" stroke="black" cx="1725.86" cy="-720.97" rx="251.05" ry="28.98"/>
<text text-anchor="middle" x="1725.86" y="-729.47" font-family="Arial" font-size="10.00">EP Gather</text>
<text text-anchor="middle" x="1725.86" y="-718.47" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="1725.86" y="-707.47" font-family="Arial" font-size="10.00">GPU: 16&#45;23</text>
</g>
<!-- layer_0_ep2_gather&#45;&gt;layer_0_moe_agg -->
<g id="edge74" class="edge">
<title>layer_0_ep2_gather&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1725.86,-691.74C1725.86,-691.74 1725.86,-665.21 1725.86,-665.21"/>
<polygon fill="black" stroke="black" points="1729.36,-665.21 1725.86,-655.21 1722.36,-665.21 1729.36,-665.21"/>
</g>
<!-- layer_0_ep3_gather -->
<g id="node58" class="node">
<title>layer_0_ep3_gather</title>
<ellipse fill="lightgray" stroke="black" cx="2245.86" cy="-720.97" rx="251.05" ry="28.98"/>
<text text-anchor="middle" x="2245.86" y="-729.47" font-family="Arial" font-size="10.00">EP Gather</text>
<text text-anchor="middle" x="2245.86" y="-718.47" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="2245.86" y="-707.47" font-family="Arial" font-size="10.00">GPU: 24&#45;31</text>
</g>
<!-- layer_0_ep3_gather&#45;&gt;layer_0_moe_agg -->
<g id="edge75" class="edge">
<title>layer_0_ep3_gather&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M2044.38,-703.31C2044.38,-703.31 2044.38,-665.26 2044.38,-665.26"/>
<polygon fill="black" stroke="black" points="2047.88,-665.26 2044.38,-655.26 2040.88,-665.26 2047.88,-665.26"/>
</g>
<!-- layer_0_moe_agg&#45;&gt;layer_0_add_norm2 -->
<g id="edge76" class="edge">
<title>layer_0_moe_agg&#45;&gt;layer_0_add_norm2</title>
<path fill="none" stroke="black" d="M1431.13,-613C1063.84,-613 483.86,-613 483.86,-613 483.86,-613 483.86,-546.16 483.86,-546.16"/>
<polygon fill="black" stroke="black" points="487.36,-546.16 483.86,-536.16 480.36,-546.16 487.36,-546.16"/>
</g>
<!-- layer_7_add_norm2 -->
<g id="node61" class="node">
<title>layer_7_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="540.36,-443.98 185.36,-443.98 185.36,-402.98 540.36,-402.98 540.36,-443.98"/>
<text text-anchor="middle" x="362.86" y="-431.98" font-family="Arial" font-size="10.00">Layer 7 Add+Norm</text>
<text text-anchor="middle" x="362.86" y="-420.98" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="362.86" y="-409.98" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
</g>
<!-- layer_0_add_norm2&#45;&gt;layer_7_add_norm2 -->
<g id="edge78" class="edge">
<title>layer_0_add_norm2&#45;&gt;layer_7_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M362.86,-494.61C362.86,-494.61 362.86,-454.28 362.86,-454.28"/>
<polygon fill="black" stroke="black" points="366.36,-454.28 362.86,-444.28 359.36,-454.28 366.36,-454.28"/>
<text text-anchor="middle" x="398.36" y="-465.78" font-family="Times,serif" font-size="14.00">layers 1&#45;6</text>
</g>
<!-- layer_7_add_norm2&#45;&gt;comm_pp_stage0_1 -->
<g id="edge79" class="edge">
<title>layer_7_add_norm2&#45;&gt;comm_pp_stage0_1</title>
<path fill="none" stroke="black" d="M362.86,-402.75C362.86,-402.75 362.86,-376.18 362.86,-376.18"/>
<polygon fill="black" stroke="black" points="366.36,-376.18 362.86,-366.18 359.36,-376.18 366.36,-376.18"/>
</g>
<!-- layer_15_add_norm2 -->
<g id="node63" class="node">
<title>layer_15_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="540.36,-135.98 185.36,-135.98 185.36,-94.98 540.36,-94.98 540.36,-135.98"/>
<text text-anchor="middle" x="362.86" y="-123.98" font-family="Arial" font-size="10.00">Layer 15 Add+Norm</text>
<text text-anchor="middle" x="362.86" y="-112.98" font-family="Arial" font-size="10.00">[batch=128,seq=1024,d_model=1024]→[batch=128,seq=1024,d_model=1024]</text>
<text text-anchor="middle" x="362.86" y="-101.98" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
</g>
<!-- layer_8_input_split&#45;&gt;layer_15_add_norm2 -->
<g id="edge81" class="edge">
<title>layer_8_input_split&#45;&gt;layer_15_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M362.86,-186.73C362.86,-186.73 362.86,-146.22 362.86,-146.22"/>
<polygon fill="black" stroke="black" points="366.36,-146.22 362.86,-136.22 359.36,-146.22 366.36,-146.22"/>
<text text-anchor="middle" x="402.86" y="-157.78" font-family="Times,serif" font-size="14.00">layers 8&#45;14</text>
</g>
<!-- layer_15_add_norm2&#45;&gt;output -->
<g id="edge82" class="edge">
<title>layer_15_add_norm2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M362.86,-94.55C362.86,-94.55 362.86,-68.23 362.86,-68.23"/>
<polygon fill="black" stroke="black" points="366.36,-68.23 362.86,-58.23 359.36,-68.23 366.36,-68.23"/>
</g>
</g>
</svg>
