<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: optimized_helix_model Pages: 1 -->
<svg width="2160pt" height="1878pt"
 viewBox="0.00 0.00 2160.00 1878.38" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.79 0.79) rotate(0) translate(4 2386)">
<title>optimized_helix_model</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2386 2744.32,-2386 2744.32,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-1219 8,-2292 2681,-2292 2681,-1219 8,-1219"/>
<text text-anchor="middle" x="1344.5" y="-2276.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="1344.5" y="-2261.8" font-family="Times,serif" font-size="14.00">Layer 0 (GPUs 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="738,-110 738,-1079 1806,-1079 1806,-110 738,-110"/>
<text text-anchor="middle" x="1272" y="-1063.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="1272" y="-1048.8" font-family="Times,serif" font-size="14.00">Layer 1 (GPUs 8&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="1526.44,-2382 1236.22,-2382 1161.56,-2300 1451.78,-2300 1526.44,-2382"/>
<text text-anchor="middle" x="1344" y="-2349.5" font-family="Arial" font-size="10.00">Model Input</text>
<text text-anchor="middle" x="1344" y="-2338.5" font-family="Arial" font-size="10.00">[batch=1024, seq=10000, dim=8192]</text>
<text text-anchor="middle" x="1344" y="-2327.5" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
</g>
<!-- ln0 -->
<g id="node2" class="node">
<title>ln0</title>
<polygon fill="lightyellow" stroke="black" points="1395.5,-2246 1292.5,-2246 1292.5,-2205 1395.5,-2205 1395.5,-2246"/>
<text text-anchor="middle" x="1344" y="-2234" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1344" y="-2223" font-family="Arial" font-size="10.00">[1024×10000×8192]</text>
<text text-anchor="middle" x="1344" y="-2212" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;ln0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln0</title>
<path fill="none" stroke="black" d="M1344,-2299.98C1344,-2285.58 1344,-2269.6 1344,-2256.23"/>
<polygon fill="black" stroke="black" points="1347.5,-2256.14 1344,-2246.14 1340.5,-2256.14 1347.5,-2256.14"/>
</g>
<!-- residual0 -->
<g id="node33" class="node">
<title>residual0</title>
<polygon fill="lightgray" stroke="black" points="1381,-1268 1307,-1268 1307,-1227 1381,-1227 1381,-1268"/>
<text text-anchor="middle" x="1344" y="-1256" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1344" y="-1245" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="1344" y="-1234" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
</g>
<!-- input&#45;&gt;residual0 -->
<g id="edge51" class="edge">
<title>input&#45;&gt;residual0</title>
<path fill="none" stroke="black" d="M1481.7,-2332.56C1807.52,-2313.55 2604.36,-2258.32 2683,-2169 2698.27,-2151.65 2693.96,-2137.34 2683,-2117 2371.24,-1538.52 2012.92,-1639.72 1448,-1304 1429.34,-1292.91 1408.28,-1281.48 1390.03,-1271.9"/>
<polygon fill="black" stroke="black" points="1391.52,-1268.73 1381.04,-1267.21 1388.28,-1274.94 1391.52,-1268.73"/>
</g>
<!-- ln1 -->
<g id="node34" class="node">
<title>ln1</title>
<polygon fill="lightyellow" stroke="black" points="1395.5,-1033 1292.5,-1033 1292.5,-992 1395.5,-992 1395.5,-1033"/>
<text text-anchor="middle" x="1344" y="-1021" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1344" y="-1010" font-family="Arial" font-size="10.00">[1024×10000×8192]</text>
<text text-anchor="middle" x="1344" y="-999" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
</g>
<!-- input&#45;&gt;ln1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;ln1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M1488.26,-2339.79C1825.69,-2338.64 2641.34,-2331.75 2685,-2292 2800.11,-2187.19 2699,-2097.68 2699,-1942 2699,-1942 2699,-1942 2699,-1344 2699,-1288.1 2723.72,-1259.32 2685,-1219 2505.67,-1032.25 1645.29,-1014.7 1405.92,-1013.46"/>
<polygon fill="black" stroke="black" points="1405.68,-1009.96 1395.66,-1013.42 1405.64,-1016.96 1405.68,-1009.96"/>
</g>
<!-- q0_ds0 -->
<g id="node3" class="node">
<title>q0_ds0</title>
<polygon fill="lightcoral" stroke="black" points="220.5,-2169 15.5,-2169 15.5,-2117 220.5,-2117 220.5,-2169"/>
<text text-anchor="middle" x="118" y="-2157" font-family="Arial" font-size="10.00">Q Linear</text>
<text text-anchor="middle" x="118" y="-2146" font-family="Arial" font-size="10.00">HG0/DS0</text>
<text text-anchor="middle" x="118" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="118" y="-2124" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln0&#45;&gt;q0_ds0 -->
<g id="edge3" class="edge">
<title>ln0&#45;&gt;q0_ds0</title>
<path fill="none" stroke="black" d="M1292.36,-2225.03C1134.51,-2226 644.54,-2224.13 230.78,-2168.99"/>
<polygon fill="black" stroke="black" points="231.09,-2165.5 220.72,-2167.64 230.16,-2172.44 231.09,-2165.5"/>
</g>
<!-- k0_ds0 -->
<g id="node4" class="node">
<title>k0_ds0</title>
<polygon fill="lightcoral" stroke="black" points="443.5,-2169 238.5,-2169 238.5,-2117 443.5,-2117 443.5,-2169"/>
<text text-anchor="middle" x="341" y="-2157" font-family="Arial" font-size="10.00">K Linear</text>
<text text-anchor="middle" x="341" y="-2146" font-family="Arial" font-size="10.00">HG0/DS0</text>
<text text-anchor="middle" x="341" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="341" y="-2124" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln0&#45;&gt;k0_ds0 -->
<g id="edge4" class="edge">
<title>ln0&#45;&gt;k0_ds0</title>
<path fill="none" stroke="black" d="M1292.49,-2224.12C1156.7,-2222.51 777.75,-2214.12 453.77,-2169"/>
<polygon fill="black" stroke="black" points="454.11,-2165.52 443.72,-2167.59 453.14,-2172.45 454.11,-2165.52"/>
</g>
<!-- v0_ds0 -->
<g id="node5" class="node">
<title>v0_ds0</title>
<polygon fill="lightcoral" stroke="black" points="666.5,-2169 461.5,-2169 461.5,-2117 666.5,-2117 666.5,-2169"/>
<text text-anchor="middle" x="564" y="-2157" font-family="Arial" font-size="10.00">V Linear</text>
<text text-anchor="middle" x="564" y="-2146" font-family="Arial" font-size="10.00">HG0/DS0</text>
<text text-anchor="middle" x="564" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="564" y="-2124" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln0&#45;&gt;v0_ds0 -->
<g id="edge5" class="edge">
<title>ln0&#45;&gt;v0_ds0</title>
<path fill="none" stroke="black" d="M1292.17,-2222.61C1181.11,-2218.03 911.84,-2204.16 676.84,-2169.03"/>
<polygon fill="black" stroke="black" points="677.15,-2165.54 666.74,-2167.5 676.1,-2172.46 677.15,-2165.54"/>
</g>
<!-- q0_ds1 -->
<g id="node7" class="node">
<title>q0_ds1</title>
<polygon fill="lightcoral" stroke="black" points="889.5,-2169 684.5,-2169 684.5,-2117 889.5,-2117 889.5,-2169"/>
<text text-anchor="middle" x="787" y="-2157" font-family="Arial" font-size="10.00">Q Linear</text>
<text text-anchor="middle" x="787" y="-2146" font-family="Arial" font-size="10.00">HG0/DS1</text>
<text text-anchor="middle" x="787" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="787" y="-2124" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- ln0&#45;&gt;q0_ds1 -->
<g id="edge6" class="edge">
<title>ln0&#45;&gt;q0_ds1</title>
<path fill="none" stroke="black" d="M1292.37,-2219.68C1211.06,-2211.73 1048.06,-2194.37 899.95,-2169.09"/>
<polygon fill="black" stroke="black" points="900.21,-2165.59 889.76,-2167.34 899.02,-2172.49 900.21,-2165.59"/>
</g>
<!-- k0_ds1 -->
<g id="node8" class="node">
<title>k0_ds1</title>
<polygon fill="lightcoral" stroke="black" points="1112.5,-2169 907.5,-2169 907.5,-2117 1112.5,-2117 1112.5,-2169"/>
<text text-anchor="middle" x="1010" y="-2157" font-family="Arial" font-size="10.00">K Linear</text>
<text text-anchor="middle" x="1010" y="-2146" font-family="Arial" font-size="10.00">HG0/DS1</text>
<text text-anchor="middle" x="1010" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="1010" y="-2124" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- ln0&#45;&gt;k0_ds1 -->
<g id="edge7" class="edge">
<title>ln0&#45;&gt;k0_ds1</title>
<path fill="none" stroke="black" d="M1292.18,-2212.01C1247.06,-2201.14 1180.06,-2184.99 1122.68,-2171.16"/>
<polygon fill="black" stroke="black" points="1123.36,-2167.72 1112.82,-2168.78 1121.72,-2174.53 1123.36,-2167.72"/>
</g>
<!-- v0_ds1 -->
<g id="node9" class="node">
<title>v0_ds1</title>
<polygon fill="lightcoral" stroke="black" points="1335.5,-2169 1130.5,-2169 1130.5,-2117 1335.5,-2117 1335.5,-2169"/>
<text text-anchor="middle" x="1233" y="-2157" font-family="Arial" font-size="10.00">V Linear</text>
<text text-anchor="middle" x="1233" y="-2146" font-family="Arial" font-size="10.00">HG0/DS1</text>
<text text-anchor="middle" x="1233" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="1233" y="-2124" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- ln0&#45;&gt;v0_ds1 -->
<g id="edge8" class="edge">
<title>ln0&#45;&gt;v0_ds1</title>
<path fill="none" stroke="black" d="M1316.85,-2204.81C1304.62,-2195.94 1289.89,-2185.26 1276.21,-2175.33"/>
<polygon fill="black" stroke="black" points="1278,-2172.31 1267.85,-2169.28 1273.89,-2177.98 1278,-2172.31"/>
</g>
<!-- q1_ds0 -->
<g id="node11" class="node">
<title>q1_ds0</title>
<polygon fill="lightcoral" stroke="black" points="1558.5,-2169 1353.5,-2169 1353.5,-2117 1558.5,-2117 1558.5,-2169"/>
<text text-anchor="middle" x="1456" y="-2157" font-family="Arial" font-size="10.00">Q Linear</text>
<text text-anchor="middle" x="1456" y="-2146" font-family="Arial" font-size="10.00">HG1/DS0</text>
<text text-anchor="middle" x="1456" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="1456" y="-2124" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- ln0&#45;&gt;q1_ds0 -->
<g id="edge9" class="edge">
<title>ln0&#45;&gt;q1_ds0</title>
<path fill="none" stroke="black" d="M1371.4,-2204.81C1383.73,-2195.94 1398.6,-2185.26 1412.41,-2175.33"/>
<polygon fill="black" stroke="black" points="1414.76,-2177.96 1420.83,-2169.28 1410.67,-2172.27 1414.76,-2177.96"/>
</g>
<!-- k1_ds0 -->
<g id="node12" class="node">
<title>k1_ds0</title>
<polygon fill="lightcoral" stroke="black" points="1781.5,-2169 1576.5,-2169 1576.5,-2117 1781.5,-2117 1781.5,-2169"/>
<text text-anchor="middle" x="1679" y="-2157" font-family="Arial" font-size="10.00">K Linear</text>
<text text-anchor="middle" x="1679" y="-2146" font-family="Arial" font-size="10.00">HG1/DS0</text>
<text text-anchor="middle" x="1679" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="1679" y="-2124" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- ln0&#45;&gt;k1_ds0 -->
<g id="edge10" class="edge">
<title>ln0&#45;&gt;k1_ds0</title>
<path fill="none" stroke="black" d="M1395.61,-2212.1C1440.98,-2201.2 1508.6,-2184.95 1566.41,-2171.06"/>
<polygon fill="black" stroke="black" points="1567.43,-2174.41 1576.34,-2168.67 1565.8,-2167.6 1567.43,-2174.41"/>
</g>
<!-- v1_ds0 -->
<g id="node13" class="node">
<title>v1_ds0</title>
<polygon fill="lightcoral" stroke="black" points="2004.5,-2169 1799.5,-2169 1799.5,-2117 2004.5,-2117 2004.5,-2169"/>
<text text-anchor="middle" x="1902" y="-2157" font-family="Arial" font-size="10.00">V Linear</text>
<text text-anchor="middle" x="1902" y="-2146" font-family="Arial" font-size="10.00">HG1/DS0</text>
<text text-anchor="middle" x="1902" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="1902" y="-2124" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- ln0&#45;&gt;v1_ds0 -->
<g id="edge11" class="edge">
<title>ln0&#45;&gt;v1_ds0</title>
<path fill="none" stroke="black" d="M1395.53,-2219.76C1477.09,-2211.89 1641.09,-2194.6 1789.09,-2169.27"/>
<polygon fill="black" stroke="black" points="1790.01,-2172.66 1799.26,-2167.51 1788.81,-2165.77 1790.01,-2172.66"/>
</g>
<!-- q1_ds1 -->
<g id="node15" class="node">
<title>q1_ds1</title>
<polygon fill="lightcoral" stroke="black" points="2227.5,-2169 2022.5,-2169 2022.5,-2117 2227.5,-2117 2227.5,-2169"/>
<text text-anchor="middle" x="2125" y="-2157" font-family="Arial" font-size="10.00">Q Linear</text>
<text text-anchor="middle" x="2125" y="-2146" font-family="Arial" font-size="10.00">HG1/DS1</text>
<text text-anchor="middle" x="2125" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="2125" y="-2124" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- ln0&#45;&gt;q1_ds1 -->
<g id="edge12" class="edge">
<title>ln0&#45;&gt;q1_ds1</title>
<path fill="none" stroke="black" d="M1395.56,-2222.67C1506.7,-2218.2 1777.19,-2204.5 2012.18,-2169.2"/>
<polygon fill="black" stroke="black" points="2012.93,-2172.62 2022.29,-2167.66 2011.88,-2165.7 2012.93,-2172.62"/>
</g>
<!-- k1_ds1 -->
<g id="node16" class="node">
<title>k1_ds1</title>
<polygon fill="lightcoral" stroke="black" points="2450.5,-2169 2245.5,-2169 2245.5,-2117 2450.5,-2117 2450.5,-2169"/>
<text text-anchor="middle" x="2348" y="-2157" font-family="Arial" font-size="10.00">K Linear</text>
<text text-anchor="middle" x="2348" y="-2146" font-family="Arial" font-size="10.00">HG1/DS1</text>
<text text-anchor="middle" x="2348" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="2348" y="-2124" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- ln0&#45;&gt;k1_ds1 -->
<g id="edge13" class="edge">
<title>ln0&#45;&gt;k1_ds1</title>
<path fill="none" stroke="black" d="M1395.63,-2224.16C1531.74,-2222.66 1911.56,-2214.5 2235.26,-2169.16"/>
<polygon fill="black" stroke="black" points="2235.89,-2172.6 2245.3,-2167.74 2234.91,-2165.67 2235.89,-2172.6"/>
</g>
<!-- v1_ds1 -->
<g id="node17" class="node">
<title>v1_ds1</title>
<polygon fill="lightcoral" stroke="black" points="2673.5,-2169 2468.5,-2169 2468.5,-2117 2673.5,-2117 2673.5,-2169"/>
<text text-anchor="middle" x="2571" y="-2157" font-family="Arial" font-size="10.00">V Linear</text>
<text text-anchor="middle" x="2571" y="-2146" font-family="Arial" font-size="10.00">HG1/DS1</text>
<text text-anchor="middle" x="2571" y="-2135" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="2571" y="-2124" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- ln0&#45;&gt;v1_ds1 -->
<g id="edge14" class="edge">
<title>ln0&#45;&gt;v1_ds1</title>
<path fill="none" stroke="black" d="M1395.63,-2223.11C1583.36,-2217.88 2230.14,-2198.24 2458.09,-2169.13"/>
<polygon fill="black" stroke="black" points="2458.85,-2172.56 2468.31,-2167.78 2457.93,-2165.62 2458.85,-2172.56"/>
</g>
<!-- attn0_ds0 -->
<g id="node6" class="node">
<title>attn0_ds0</title>
<polygon fill="lightpink" stroke="black" points="506.5,-2081 397.5,-2081 397.5,-2029 506.5,-2029 506.5,-2081"/>
<text text-anchor="middle" x="452" y="-2069" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="452" y="-2058" font-family="Arial" font-size="10.00">HG0/DS0</text>
<text text-anchor="middle" x="452" y="-2047" font-family="Arial" font-size="10.00">[1024×10000×8×128]</text>
<text text-anchor="middle" x="452" y="-2036" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- q0_ds0&#45;&gt;attn0_ds0 -->
<g id="edge15" class="edge">
<title>q0_ds0&#45;&gt;attn0_ds0</title>
<path fill="none" stroke="black" d="M215.5,-2116.89C270.81,-2102.65 338.48,-2085.23 387.25,-2072.67"/>
<polygon fill="black" stroke="black" points="388.24,-2076.03 397.05,-2070.15 386.49,-2069.25 388.24,-2076.03"/>
</g>
<!-- k0_ds0&#45;&gt;attn0_ds0 -->
<g id="edge16" class="edge">
<title>k0_ds0&#45;&gt;attn0_ds0</title>
<path fill="none" stroke="black" d="M373.4,-2116.89C385.27,-2107.7 398.84,-2097.18 411.34,-2087.5"/>
<polygon fill="black" stroke="black" points="413.6,-2090.18 419.36,-2081.29 409.31,-2084.64 413.6,-2090.18"/>
</g>
<!-- v0_ds0&#45;&gt;attn0_ds0 -->
<g id="edge17" class="edge">
<title>v0_ds0&#45;&gt;attn0_ds0</title>
<path fill="none" stroke="black" d="M531.3,-2116.89C519.33,-2107.7 505.63,-2097.18 493.03,-2087.5"/>
<polygon fill="black" stroke="black" points="494.99,-2084.6 484.93,-2081.29 490.73,-2090.15 494.99,-2084.6"/>
</g>
<!-- concat0 -->
<g id="node19" class="node">
<title>concat0</title>
<polygon fill="lightsteelblue" stroke="black" points="1123.01,-1993 943.24,-1993 896.99,-1889 1076.76,-1889 1123.01,-1993"/>
<text text-anchor="middle" x="1010" y="-1955" font-family="Arial" font-size="10.00">Concat</text>
<text text-anchor="middle" x="1010" y="-1944" font-family="Arial" font-size="10.00">HG0</text>
<text text-anchor="middle" x="1010" y="-1933" font-family="Arial" font-size="10.00">[2×8×128]→[16×128]</text>
<text text-anchor="middle" x="1010" y="-1922" font-family="Arial" font-size="10.00">GPU: 0&#45;1</text>
</g>
<!-- attn0_ds0&#45;&gt;concat0 -->
<g id="edge27" class="edge">
<title>attn0_ds0&#45;&gt;concat0</title>
<path fill="none" stroke="black" d="M506.52,-2043.06C602.05,-2023.88 800.65,-1984.02 917.85,-1960.5"/>
<polygon fill="black" stroke="black" points="918.77,-1963.88 927.88,-1958.48 917.39,-1957.02 918.77,-1963.88"/>
</g>
<!-- attn0_ds1 -->
<g id="node10" class="node">
<title>attn0_ds1</title>
<polygon fill="lightpink" stroke="black" points="1064.5,-2081 955.5,-2081 955.5,-2029 1064.5,-2029 1064.5,-2081"/>
<text text-anchor="middle" x="1010" y="-2069" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1010" y="-2058" font-family="Arial" font-size="10.00">HG0/DS1</text>
<text text-anchor="middle" x="1010" y="-2047" font-family="Arial" font-size="10.00">[1024×10000×8×128]</text>
<text text-anchor="middle" x="1010" y="-2036" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- q0_ds1&#45;&gt;attn0_ds1 -->
<g id="edge18" class="edge">
<title>q0_ds1&#45;&gt;attn0_ds1</title>
<path fill="none" stroke="black" d="M852.1,-2116.89C881.68,-2105.49 916.56,-2092.03 946.01,-2080.68"/>
<polygon fill="black" stroke="black" points="947.3,-2083.93 955.37,-2077.07 944.78,-2077.4 947.3,-2083.93"/>
</g>
<!-- k0_ds1&#45;&gt;attn0_ds1 -->
<g id="edge19" class="edge">
<title>k0_ds1&#45;&gt;attn0_ds1</title>
<path fill="none" stroke="black" d="M1010,-2116.66C1010,-2108.7 1010,-2099.76 1010,-2091.24"/>
<polygon fill="black" stroke="black" points="1013.5,-2091.16 1010,-2081.16 1006.5,-2091.16 1013.5,-2091.16"/>
</g>
<!-- v0_ds1&#45;&gt;attn0_ds1 -->
<g id="edge20" class="edge">
<title>v0_ds1&#45;&gt;attn0_ds1</title>
<path fill="none" stroke="black" d="M1167.9,-2116.89C1138.32,-2105.49 1103.44,-2092.03 1073.99,-2080.68"/>
<polygon fill="black" stroke="black" points="1075.22,-2077.4 1064.63,-2077.07 1072.7,-2083.93 1075.22,-2077.4"/>
</g>
<!-- attn0_ds1&#45;&gt;concat0 -->
<g id="edge28" class="edge">
<title>attn0_ds1&#45;&gt;concat0</title>
<path fill="none" stroke="black" d="M1010,-2028.87C1010,-2021.18 1010,-2012.37 1010,-2003.37"/>
<polygon fill="black" stroke="black" points="1013.5,-2003.18 1010,-1993.18 1006.5,-2003.18 1013.5,-2003.18"/>
</g>
<!-- attn1_ds0 -->
<g id="node14" class="node">
<title>attn1_ds0</title>
<polygon fill="lightpink" stroke="black" points="1733.5,-2081 1624.5,-2081 1624.5,-2029 1733.5,-2029 1733.5,-2081"/>
<text text-anchor="middle" x="1679" y="-2069" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1679" y="-2058" font-family="Arial" font-size="10.00">HG1/DS0</text>
<text text-anchor="middle" x="1679" y="-2047" font-family="Arial" font-size="10.00">[1024×10000×8×128]</text>
<text text-anchor="middle" x="1679" y="-2036" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- q1_ds0&#45;&gt;attn1_ds0 -->
<g id="edge21" class="edge">
<title>q1_ds0&#45;&gt;attn1_ds0</title>
<path fill="none" stroke="black" d="M1521.1,-2116.89C1550.68,-2105.49 1585.56,-2092.03 1615.01,-2080.68"/>
<polygon fill="black" stroke="black" points="1616.3,-2083.93 1624.37,-2077.07 1613.78,-2077.4 1616.3,-2083.93"/>
</g>
<!-- k1_ds0&#45;&gt;attn1_ds0 -->
<g id="edge22" class="edge">
<title>k1_ds0&#45;&gt;attn1_ds0</title>
<path fill="none" stroke="black" d="M1679,-2116.66C1679,-2108.7 1679,-2099.76 1679,-2091.24"/>
<polygon fill="black" stroke="black" points="1682.5,-2091.16 1679,-2081.16 1675.5,-2091.16 1682.5,-2091.16"/>
</g>
<!-- v1_ds0&#45;&gt;attn1_ds0 -->
<g id="edge23" class="edge">
<title>v1_ds0&#45;&gt;attn1_ds0</title>
<path fill="none" stroke="black" d="M1836.9,-2116.89C1807.32,-2105.49 1772.44,-2092.03 1742.99,-2080.68"/>
<polygon fill="black" stroke="black" points="1744.22,-2077.4 1733.63,-2077.07 1741.7,-2083.93 1744.22,-2077.4"/>
</g>
<!-- concat1 -->
<g id="node20" class="node">
<title>concat1</title>
<polygon fill="lightsteelblue" stroke="black" points="1792.01,-1993 1612.24,-1993 1565.99,-1889 1745.76,-1889 1792.01,-1993"/>
<text text-anchor="middle" x="1679" y="-1955" font-family="Arial" font-size="10.00">Concat</text>
<text text-anchor="middle" x="1679" y="-1944" font-family="Arial" font-size="10.00">HG1</text>
<text text-anchor="middle" x="1679" y="-1933" font-family="Arial" font-size="10.00">[2×8×128]→[16×128]</text>
<text text-anchor="middle" x="1679" y="-1922" font-family="Arial" font-size="10.00">GPU: 2&#45;3</text>
</g>
<!-- attn1_ds0&#45;&gt;concat1 -->
<g id="edge29" class="edge">
<title>attn1_ds0&#45;&gt;concat1</title>
<path fill="none" stroke="black" d="M1679,-2028.87C1679,-2021.18 1679,-2012.37 1679,-2003.37"/>
<polygon fill="black" stroke="black" points="1682.5,-2003.18 1679,-1993.18 1675.5,-2003.18 1682.5,-2003.18"/>
</g>
<!-- attn1_ds1 -->
<g id="node18" class="node">
<title>attn1_ds1</title>
<polygon fill="lightpink" stroke="black" points="2290.5,-2081 2181.5,-2081 2181.5,-2029 2290.5,-2029 2290.5,-2081"/>
<text text-anchor="middle" x="2236" y="-2069" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2236" y="-2058" font-family="Arial" font-size="10.00">HG1/DS1</text>
<text text-anchor="middle" x="2236" y="-2047" font-family="Arial" font-size="10.00">[1024×10000×8×128]</text>
<text text-anchor="middle" x="2236" y="-2036" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- q1_ds1&#45;&gt;attn1_ds1 -->
<g id="edge24" class="edge">
<title>q1_ds1&#45;&gt;attn1_ds1</title>
<path fill="none" stroke="black" d="M2157.4,-2116.89C2169.27,-2107.7 2182.84,-2097.18 2195.34,-2087.5"/>
<polygon fill="black" stroke="black" points="2197.6,-2090.18 2203.36,-2081.29 2193.31,-2084.64 2197.6,-2090.18"/>
</g>
<!-- k1_ds1&#45;&gt;attn1_ds1 -->
<g id="edge25" class="edge">
<title>k1_ds1&#45;&gt;attn1_ds1</title>
<path fill="none" stroke="black" d="M2315.3,-2116.89C2303.33,-2107.7 2289.63,-2097.18 2277.03,-2087.5"/>
<polygon fill="black" stroke="black" points="2278.99,-2084.6 2268.93,-2081.29 2274.73,-2090.15 2278.99,-2084.6"/>
</g>
<!-- v1_ds1&#45;&gt;attn1_ds1 -->
<g id="edge26" class="edge">
<title>v1_ds1&#45;&gt;attn1_ds1</title>
<path fill="none" stroke="black" d="M2473.2,-2116.89C2417.55,-2102.61 2349.41,-2085.12 2300.47,-2072.55"/>
<polygon fill="black" stroke="black" points="2301.19,-2069.12 2290.63,-2070.03 2299.45,-2075.9 2301.19,-2069.12"/>
</g>
<!-- attn1_ds1&#45;&gt;concat1 -->
<g id="edge30" class="edge">
<title>attn1_ds1&#45;&gt;concat1</title>
<path fill="none" stroke="black" d="M2181.32,-2043.01C2090.41,-2024.73 1906.49,-1987.74 1788.21,-1963.96"/>
<polygon fill="black" stroke="black" points="1788.88,-1960.53 1778.39,-1961.99 1787.5,-1967.39 1788.88,-1960.53"/>
</g>
<!-- final_concat0 -->
<g id="node21" class="node">
<title>final_concat0</title>
<polygon fill="lightsteelblue" stroke="black" points="1450.57,-1853 1281.04,-1853 1237.43,-1771 1406.96,-1771 1450.57,-1853"/>
<text text-anchor="middle" x="1344" y="-1820.5" font-family="Arial" font-size="10.00">Final Concat</text>
<text text-anchor="middle" x="1344" y="-1809.5" font-family="Arial" font-size="10.00">[2×16×128]→[8192]</text>
<text text-anchor="middle" x="1344" y="-1798.5" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
</g>
<!-- concat0&#45;&gt;final_concat0 -->
<g id="edge31" class="edge">
<title>concat0&#45;&gt;final_concat0</title>
<path fill="none" stroke="black" d="M1086.63,-1910.86C1139.77,-1890.66 1210.38,-1863.81 1264.2,-1843.34"/>
<polygon fill="black" stroke="black" points="1265.61,-1846.55 1273.71,-1839.73 1263.12,-1840.01 1265.61,-1846.55"/>
</g>
<!-- concat1&#45;&gt;final_concat0 -->
<g id="edge32" class="edge">
<title>concat1&#45;&gt;final_concat0</title>
<path fill="none" stroke="black" d="M1570.24,-1898.77C1534.72,-1885.3 1495.17,-1870.31 1459.2,-1856.67"/>
<polygon fill="black" stroke="black" points="1460.24,-1853.32 1449.65,-1853.05 1457.76,-1859.87 1460.24,-1853.32"/>
</g>
<!-- fc1_0 -->
<g id="node22" class="node">
<title>fc1_0</title>
<polygon fill="lightcoral" stroke="black" points="1246.5,-1735 1175.5,-1735 1175.5,-1694 1246.5,-1694 1246.5,-1735"/>
<text text-anchor="middle" x="1211" y="-1723" font-family="Arial" font-size="10.00">FC1 Col</text>
<text text-anchor="middle" x="1211" y="-1712" font-family="Arial" font-size="10.00">[8192×4096]</text>
<text text-anchor="middle" x="1211" y="-1701" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- final_concat0&#45;&gt;fc1_0 -->
<g id="edge33" class="edge">
<title>final_concat0&#45;&gt;fc1_0</title>
<path fill="none" stroke="black" d="M1287.98,-1770.78C1274.02,-1760.75 1259.43,-1750.28 1246.75,-1741.17"/>
<polygon fill="black" stroke="black" points="1248.48,-1738.1 1238.31,-1735.11 1244.39,-1743.79 1248.48,-1738.1"/>
</g>
<!-- fc1_1 -->
<g id="node23" class="node">
<title>fc1_1</title>
<polygon fill="lightcoral" stroke="black" points="1335.5,-1735 1264.5,-1735 1264.5,-1694 1335.5,-1694 1335.5,-1735"/>
<text text-anchor="middle" x="1300" y="-1723" font-family="Arial" font-size="10.00">FC1 Col</text>
<text text-anchor="middle" x="1300" y="-1712" font-family="Arial" font-size="10.00">[8192×4096]</text>
<text text-anchor="middle" x="1300" y="-1701" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- final_concat0&#45;&gt;fc1_1 -->
<g id="edge34" class="edge">
<title>final_concat0&#45;&gt;fc1_1</title>
<path fill="none" stroke="black" d="M1325.47,-1770.78C1321.38,-1761.91 1317.13,-1752.69 1313.3,-1744.38"/>
<polygon fill="black" stroke="black" points="1316.4,-1742.73 1309.04,-1735.11 1310.04,-1745.66 1316.4,-1742.73"/>
</g>
<!-- fc1_2 -->
<g id="node24" class="node">
<title>fc1_2</title>
<polygon fill="lightcoral" stroke="black" points="1424.5,-1735 1353.5,-1735 1353.5,-1694 1424.5,-1694 1424.5,-1735"/>
<text text-anchor="middle" x="1389" y="-1723" font-family="Arial" font-size="10.00">FC1 Col</text>
<text text-anchor="middle" x="1389" y="-1712" font-family="Arial" font-size="10.00">[8192×4096]</text>
<text text-anchor="middle" x="1389" y="-1701" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- final_concat0&#45;&gt;fc1_2 -->
<g id="edge35" class="edge">
<title>final_concat0&#45;&gt;fc1_2</title>
<path fill="none" stroke="black" d="M1362.95,-1770.78C1367.13,-1761.91 1371.48,-1752.69 1375.39,-1744.38"/>
<polygon fill="black" stroke="black" points="1378.66,-1745.65 1379.76,-1735.11 1372.33,-1742.67 1378.66,-1745.65"/>
</g>
<!-- fc1_3 -->
<g id="node25" class="node">
<title>fc1_3</title>
<polygon fill="lightcoral" stroke="black" points="1513.5,-1735 1442.5,-1735 1442.5,-1694 1513.5,-1694 1513.5,-1735"/>
<text text-anchor="middle" x="1478" y="-1723" font-family="Arial" font-size="10.00">FC1 Col</text>
<text text-anchor="middle" x="1478" y="-1712" font-family="Arial" font-size="10.00">[8192×4096]</text>
<text text-anchor="middle" x="1478" y="-1701" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- final_concat0&#45;&gt;fc1_3 -->
<g id="edge36" class="edge">
<title>final_concat0&#45;&gt;fc1_3</title>
<path fill="none" stroke="black" d="M1400.44,-1770.78C1414.5,-1760.75 1429.2,-1750.28 1441.98,-1741.17"/>
<polygon fill="black" stroke="black" points="1444.37,-1743.77 1450.48,-1735.11 1440.31,-1738.06 1444.37,-1743.77"/>
</g>
<!-- fc1_concat -->
<g id="node26" class="node">
<title>fc1_concat</title>
<polygon fill="lightsteelblue" stroke="black" points="1444.63,-1658 1284.55,-1658 1243.37,-1576 1403.45,-1576 1444.63,-1658"/>
<text text-anchor="middle" x="1344" y="-1625.5" font-family="Arial" font-size="10.00">Concat FC1</text>
<text text-anchor="middle" x="1344" y="-1614.5" font-family="Arial" font-size="10.00">[4×4096]→[16384]</text>
<text text-anchor="middle" x="1344" y="-1603.5" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
</g>
<!-- fc1_0&#45;&gt;fc1_concat -->
<g id="edge37" class="edge">
<title>fc1_0&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M1238.24,-1693.94C1250.42,-1685.2 1265.34,-1674.48 1280.09,-1663.89"/>
<polygon fill="black" stroke="black" points="1282.17,-1666.7 1288.25,-1658.03 1278.09,-1661.02 1282.17,-1666.7"/>
</g>
<!-- fc1_1&#45;&gt;fc1_concat -->
<g id="edge38" class="edge">
<title>fc1_1&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M1309.12,-1693.71C1312.67,-1686.01 1316.91,-1676.81 1321.19,-1667.51"/>
<polygon fill="black" stroke="black" points="1324.45,-1668.79 1325.46,-1658.25 1318.09,-1665.86 1324.45,-1668.79"/>
</g>
<!-- fc1_2&#45;&gt;fc1_concat -->
<g id="edge39" class="edge">
<title>fc1_2&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M1379.68,-1693.71C1376.05,-1686.01 1371.71,-1676.81 1367.33,-1667.51"/>
<polygon fill="black" stroke="black" points="1370.39,-1665.8 1362.96,-1658.25 1364.06,-1668.78 1370.39,-1665.8"/>
</g>
<!-- fc1_3&#45;&gt;fc1_concat -->
<g id="edge40" class="edge">
<title>fc1_3&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M1450.56,-1693.94C1438.28,-1685.2 1423.25,-1674.48 1408.39,-1663.89"/>
<polygon fill="black" stroke="black" points="1410.34,-1660.98 1400.17,-1658.03 1406.28,-1666.68 1410.34,-1660.98"/>
</g>
<!-- gelu0 -->
<g id="node27" class="node">
<title>gelu0</title>
<polygon fill="lightyellow" stroke="black" points="1373,-1540 1315,-1540 1315,-1499 1373,-1499 1373,-1540"/>
<text text-anchor="middle" x="1344" y="-1528" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="1344" y="-1517" font-family="Arial" font-size="10.00">[16384]</text>
<text text-anchor="middle" x="1344" y="-1506" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
</g>
<!-- fc1_concat&#45;&gt;gelu0 -->
<g id="edge41" class="edge">
<title>fc1_concat&#45;&gt;gelu0</title>
<path fill="none" stroke="black" d="M1344,-1575.78C1344,-1567.2 1344,-1558.29 1344,-1550.19"/>
<polygon fill="black" stroke="black" points="1347.5,-1550.11 1344,-1540.11 1340.5,-1550.11 1347.5,-1550.11"/>
</g>
<!-- fc2_0 -->
<g id="node28" class="node">
<title>fc2_0</title>
<polygon fill="lightcoral" stroke="black" points="1246.5,-1463 1175.5,-1463 1175.5,-1422 1246.5,-1422 1246.5,-1463"/>
<text text-anchor="middle" x="1211" y="-1451" font-family="Arial" font-size="10.00">FC2 Row</text>
<text text-anchor="middle" x="1211" y="-1440" font-family="Arial" font-size="10.00">[4096×2048]</text>
<text text-anchor="middle" x="1211" y="-1429" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- gelu0&#45;&gt;fc2_0 -->
<g id="edge42" class="edge">
<title>gelu0&#45;&gt;fc2_0</title>
<path fill="none" stroke="black" d="M1314.81,-1502.04C1297.17,-1492.09 1274.36,-1479.23 1254.61,-1468.09"/>
<polygon fill="black" stroke="black" points="1256.21,-1464.98 1245.78,-1463.11 1252.77,-1471.07 1256.21,-1464.98"/>
</g>
<!-- fc2_1 -->
<g id="node29" class="node">
<title>fc2_1</title>
<polygon fill="lightcoral" stroke="black" points="1335.5,-1463 1264.5,-1463 1264.5,-1422 1335.5,-1422 1335.5,-1463"/>
<text text-anchor="middle" x="1300" y="-1451" font-family="Arial" font-size="10.00">FC2 Row</text>
<text text-anchor="middle" x="1300" y="-1440" font-family="Arial" font-size="10.00">[4096×2048]</text>
<text text-anchor="middle" x="1300" y="-1429" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- gelu0&#45;&gt;fc2_1 -->
<g id="edge43" class="edge">
<title>gelu0&#45;&gt;fc2_1</title>
<path fill="none" stroke="black" d="M1332.44,-1498.79C1327.59,-1490.53 1321.86,-1480.76 1316.57,-1471.75"/>
<polygon fill="black" stroke="black" points="1319.56,-1469.93 1311.48,-1463.07 1313.52,-1473.47 1319.56,-1469.93"/>
</g>
<!-- fc2_2 -->
<g id="node30" class="node">
<title>fc2_2</title>
<polygon fill="lightcoral" stroke="black" points="1424.5,-1463 1353.5,-1463 1353.5,-1422 1424.5,-1422 1424.5,-1463"/>
<text text-anchor="middle" x="1389" y="-1451" font-family="Arial" font-size="10.00">FC2 Row</text>
<text text-anchor="middle" x="1389" y="-1440" font-family="Arial" font-size="10.00">[4096×2048]</text>
<text text-anchor="middle" x="1389" y="-1429" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- gelu0&#45;&gt;fc2_2 -->
<g id="edge44" class="edge">
<title>gelu0&#45;&gt;fc2_2</title>
<path fill="none" stroke="black" d="M1355.82,-1498.79C1360.78,-1490.53 1366.65,-1480.76 1372.05,-1471.75"/>
<polygon fill="black" stroke="black" points="1375.11,-1473.45 1377.26,-1463.07 1369.11,-1469.85 1375.11,-1473.45"/>
</g>
<!-- fc2_3 -->
<g id="node31" class="node">
<title>fc2_3</title>
<polygon fill="lightcoral" stroke="black" points="1513.5,-1463 1442.5,-1463 1442.5,-1422 1513.5,-1422 1513.5,-1463"/>
<text text-anchor="middle" x="1478" y="-1451" font-family="Arial" font-size="10.00">FC2 Row</text>
<text text-anchor="middle" x="1478" y="-1440" font-family="Arial" font-size="10.00">[4096×2048]</text>
<text text-anchor="middle" x="1478" y="-1429" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- gelu0&#45;&gt;fc2_3 -->
<g id="edge45" class="edge">
<title>gelu0&#45;&gt;fc2_3</title>
<path fill="none" stroke="black" d="M1373.08,-1502.23C1390.83,-1492.29 1413.89,-1479.38 1433.86,-1468.21"/>
<polygon fill="black" stroke="black" points="1435.77,-1471.15 1442.79,-1463.21 1432.35,-1465.04 1435.77,-1471.15"/>
</g>
<!-- fc2_allreduce -->
<g id="node32" class="node">
<title>fc2_allreduce</title>
<polygon fill="lightsteelblue" stroke="black" points="1439.26,-1386 1287.72,-1386 1248.74,-1304 1400.28,-1304 1439.26,-1386"/>
<text text-anchor="middle" x="1344" y="-1353.5" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1344" y="-1342.5" font-family="Arial" font-size="10.00">[4×2048]→[8192]</text>
<text text-anchor="middle" x="1344" y="-1331.5" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
</g>
<!-- fc2_0&#45;&gt;fc2_allreduce -->
<g id="edge46" class="edge">
<title>fc2_0&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M1238.24,-1421.94C1250.42,-1413.2 1265.34,-1402.48 1280.09,-1391.89"/>
<polygon fill="black" stroke="black" points="1282.17,-1394.7 1288.25,-1386.03 1278.09,-1389.02 1282.17,-1394.7"/>
</g>
<!-- fc2_1&#45;&gt;fc2_allreduce -->
<g id="edge47" class="edge">
<title>fc2_1&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M1309.12,-1421.71C1312.67,-1414.01 1316.91,-1404.81 1321.19,-1395.51"/>
<polygon fill="black" stroke="black" points="1324.45,-1396.79 1325.46,-1386.25 1318.09,-1393.86 1324.45,-1396.79"/>
</g>
<!-- fc2_2&#45;&gt;fc2_allreduce -->
<g id="edge48" class="edge">
<title>fc2_2&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M1379.68,-1421.71C1376.05,-1414.01 1371.71,-1404.81 1367.33,-1395.51"/>
<polygon fill="black" stroke="black" points="1370.39,-1393.8 1362.96,-1386.25 1364.06,-1396.78 1370.39,-1393.8"/>
</g>
<!-- fc2_3&#45;&gt;fc2_allreduce -->
<g id="edge49" class="edge">
<title>fc2_3&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M1450.56,-1421.94C1438.28,-1413.2 1423.25,-1402.48 1408.39,-1391.89"/>
<polygon fill="black" stroke="black" points="1410.34,-1388.98 1400.17,-1386.03 1406.28,-1394.68 1410.34,-1388.98"/>
</g>
<!-- fc2_allreduce&#45;&gt;residual0 -->
<g id="edge50" class="edge">
<title>fc2_allreduce&#45;&gt;residual0</title>
<path fill="none" stroke="black" d="M1344,-1303.78C1344,-1295.2 1344,-1286.29 1344,-1278.19"/>
<polygon fill="black" stroke="black" points="1347.5,-1278.11 1344,-1268.11 1340.5,-1278.11 1347.5,-1278.11"/>
</g>
<!-- comm0 -->
<g id="node66" class="node">
<title>comm0</title>
<polygon fill="yellow" stroke="black" points="1470.47,-1191 1269.29,-1191 1217.53,-1087 1418.71,-1087 1470.47,-1191"/>
<text text-anchor="middle" x="1344" y="-1153" font-family="Arial" font-size="10.00">Pipeline Communication</text>
<text text-anchor="middle" x="1344" y="-1142" font-family="Arial" font-size="10.00">Stage 0 → Stage 1</text>
<text text-anchor="middle" x="1344" y="-1131" font-family="Arial" font-size="10.00">[1024×10000×8192]</text>
<text text-anchor="middle" x="1344" y="-1120" font-family="Arial" font-size="10.00">GPU: 3→8</text>
</g>
<!-- residual0&#45;&gt;comm0 -->
<g id="edge52" class="edge">
<title>residual0&#45;&gt;comm0</title>
<path fill="none" stroke="black" d="M1344,-1226.97C1344,-1219.56 1344,-1210.67 1344,-1201.45"/>
<polygon fill="black" stroke="black" points="1347.5,-1201.36 1344,-1191.36 1340.5,-1201.36 1347.5,-1201.36"/>
</g>
<!-- q2_ds0 -->
<g id="node35" class="node">
<title>q2_ds0</title>
<polygon fill="lightcoral" stroke="black" points="950.5,-956 745.5,-956 745.5,-904 950.5,-904 950.5,-956"/>
<text text-anchor="middle" x="848" y="-944" font-family="Arial" font-size="10.00">Q Linear</text>
<text text-anchor="middle" x="848" y="-933" font-family="Arial" font-size="10.00">HG2/DS0</text>
<text text-anchor="middle" x="848" y="-922" font-family="Arial" font-size="10.00">[1024×10000×8192]→[1024×10000×8×128]</text>
<text text-anchor="middle" x="848" y="-911" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- ln1&#45;&gt;q2_ds0 -->
<g id="edge54" class="edge">
<title>ln1&#45;&gt;q2_ds0</title>
<path fill="none" stroke="black" d="M1292.24,-1005.29C1220.25,-996.37 1085.6,-978.68 960.88,-956.1"/>
<polygon fill="black" stroke="black" points="961.24,-952.61 950.78,-954.26 959.99,-959.5 961.24,-952.61"/>
</g>
<!-- k2_ds0 -->
<g id="node36" class="node">
<title>k2_ds0</title>
<polygon fill="lightcoral" stroke="black" points="1027.5,-950.5 968.5,-950.5 968.5,-909.5 1027.5,-909.5 1027.5,-950.5"/>
<text text-anchor="middle" x="998" y="-938.5" font-family="Arial" font-size="10.00">K Linear</text>
<text text-anchor="middle" x="998" y="-927.5" font-family="Arial" font-size="10.00">HG2/DS0</text>
<text text-anchor="middle" x="998" y="-916.5" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- ln1&#45;&gt;k2_ds0 -->
<g id="edge55" class="edge">
<title>ln1&#45;&gt;k2_ds0</title>
<path fill="none" stroke="black" d="M1292.35,-1008.32C1229.96,-1003.1 1122.7,-989.68 1037,-956 1036.3,-955.72 1035.6,-955.44 1034.89,-955.13"/>
<polygon fill="black" stroke="black" points="1036.36,-951.96 1025.85,-950.65 1033.26,-958.23 1036.36,-951.96"/>
</g>
<!-- v2_ds0 -->
<g id="node37" class="node">
<title>v2_ds0</title>
<polygon fill="lightcoral" stroke="black" points="1104.5,-950.5 1045.5,-950.5 1045.5,-909.5 1104.5,-909.5 1104.5,-950.5"/>
<text text-anchor="middle" x="1075" y="-938.5" font-family="Arial" font-size="10.00">V Linear</text>
<text text-anchor="middle" x="1075" y="-927.5" font-family="Arial" font-size="10.00">HG2/DS0</text>
<text text-anchor="middle" x="1075" y="-916.5" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- ln1&#45;&gt;v2_ds0 -->
<g id="edge56" class="edge">
<title>ln1&#45;&gt;v2_ds0</title>
<path fill="none" stroke="black" d="M1292.19,-1004.07C1244.52,-996.07 1172.56,-980.99 1114,-956 1113.45,-955.76 1112.89,-955.52 1112.33,-955.27"/>
<polygon fill="black" stroke="black" points="1113.87,-952.12 1103.37,-950.69 1110.68,-958.36 1113.87,-952.12"/>
</g>
<!-- q2_ds1 -->
<g id="node39" class="node">
<title>q2_ds1</title>
<polygon fill="lightcoral" stroke="black" points="1181.5,-950.5 1122.5,-950.5 1122.5,-909.5 1181.5,-909.5 1181.5,-950.5"/>
<text text-anchor="middle" x="1152" y="-938.5" font-family="Arial" font-size="10.00">Q Linear</text>
<text text-anchor="middle" x="1152" y="-927.5" font-family="Arial" font-size="10.00">HG2/DS1</text>
<text text-anchor="middle" x="1152" y="-916.5" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- ln1&#45;&gt;q2_ds1 -->
<g id="edge57" class="edge">
<title>ln1&#45;&gt;q2_ds1</title>
<path fill="none" stroke="black" d="M1292.17,-995.88C1261.97,-986.01 1223.55,-972.09 1191,-956 1190.59,-955.8 1190.17,-955.59 1189.75,-955.38"/>
<polygon fill="black" stroke="black" points="1191.43,-952.3 1180.98,-950.56 1188.06,-958.44 1191.43,-952.3"/>
</g>
<!-- k2_ds1 -->
<g id="node40" class="node">
<title>k2_ds1</title>
<polygon fill="lightcoral" stroke="black" points="1258.5,-950.5 1199.5,-950.5 1199.5,-909.5 1258.5,-909.5 1258.5,-950.5"/>
<text text-anchor="middle" x="1229" y="-938.5" font-family="Arial" font-size="10.00">K Linear</text>
<text text-anchor="middle" x="1229" y="-927.5" font-family="Arial" font-size="10.00">HG2/DS1</text>
<text text-anchor="middle" x="1229" y="-916.5" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- ln1&#45;&gt;k2_ds1 -->
<g id="edge58" class="edge">
<title>ln1&#45;&gt;k2_ds1</title>
<path fill="none" stroke="black" d="M1315.87,-991.81C1300.69,-981.18 1281.79,-967.95 1265.49,-956.54"/>
<polygon fill="black" stroke="black" points="1267.44,-953.64 1257.24,-950.77 1263.43,-959.37 1267.44,-953.64"/>
</g>
<!-- v2_ds1 -->
<g id="node41" class="node">
<title>v2_ds1</title>
<polygon fill="lightcoral" stroke="black" points="1335.5,-950.5 1276.5,-950.5 1276.5,-909.5 1335.5,-909.5 1335.5,-950.5"/>
<text text-anchor="middle" x="1306" y="-938.5" font-family="Arial" font-size="10.00">V Linear</text>
<text text-anchor="middle" x="1306" y="-927.5" font-family="Arial" font-size="10.00">HG2/DS1</text>
<text text-anchor="middle" x="1306" y="-916.5" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- ln1&#45;&gt;v2_ds1 -->
<g id="edge59" class="edge">
<title>ln1&#45;&gt;v2_ds1</title>
<path fill="none" stroke="black" d="M1334.61,-991.6C1330.1,-982.05 1324.61,-970.42 1319.65,-959.91"/>
<polygon fill="black" stroke="black" points="1322.72,-958.22 1315.29,-950.67 1316.39,-961.21 1322.72,-958.22"/>
</g>
<!-- q3_ds0 -->
<g id="node43" class="node">
<title>q3_ds0</title>
<polygon fill="lightcoral" stroke="black" points="1412.5,-950.5 1353.5,-950.5 1353.5,-909.5 1412.5,-909.5 1412.5,-950.5"/>
<text text-anchor="middle" x="1383" y="-938.5" font-family="Arial" font-size="10.00">Q Linear</text>
<text text-anchor="middle" x="1383" y="-927.5" font-family="Arial" font-size="10.00">HG3/DS0</text>
<text text-anchor="middle" x="1383" y="-916.5" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- ln1&#45;&gt;q3_ds0 -->
<g id="edge60" class="edge">
<title>ln1&#45;&gt;q3_ds0</title>
<path fill="none" stroke="black" d="M1353.64,-991.6C1358.27,-982.05 1363.9,-970.42 1368.99,-959.91"/>
<polygon fill="black" stroke="black" points="1372.26,-961.2 1373.47,-950.67 1365.96,-958.14 1372.26,-961.2"/>
</g>
<!-- k3_ds0 -->
<g id="node44" class="node">
<title>k3_ds0</title>
<polygon fill="lightcoral" stroke="black" points="1489.5,-950.5 1430.5,-950.5 1430.5,-909.5 1489.5,-909.5 1489.5,-950.5"/>
<text text-anchor="middle" x="1460" y="-938.5" font-family="Arial" font-size="10.00">K Linear</text>
<text text-anchor="middle" x="1460" y="-927.5" font-family="Arial" font-size="10.00">HG3/DS0</text>
<text text-anchor="middle" x="1460" y="-916.5" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- ln1&#45;&gt;k3_ds0 -->
<g id="edge61" class="edge">
<title>ln1&#45;&gt;k3_ds0</title>
<path fill="none" stroke="black" d="M1372.38,-991.81C1387.68,-981.18 1406.75,-967.95 1423.19,-956.54"/>
<polygon fill="black" stroke="black" points="1425.29,-959.35 1431.51,-950.77 1421.3,-953.59 1425.29,-959.35"/>
</g>
<!-- v3_ds0 -->
<g id="node45" class="node">
<title>v3_ds0</title>
<polygon fill="lightcoral" stroke="black" points="1566.5,-950.5 1507.5,-950.5 1507.5,-909.5 1566.5,-909.5 1566.5,-950.5"/>
<text text-anchor="middle" x="1537" y="-938.5" font-family="Arial" font-size="10.00">V Linear</text>
<text text-anchor="middle" x="1537" y="-927.5" font-family="Arial" font-size="10.00">HG3/DS0</text>
<text text-anchor="middle" x="1537" y="-916.5" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- ln1&#45;&gt;v3_ds0 -->
<g id="edge62" class="edge">
<title>ln1&#45;&gt;v3_ds0</title>
<path fill="none" stroke="black" d="M1395.52,-996.46C1426.3,-986.64 1465.75,-972.59 1499,-956 1499.3,-955.85 1499.61,-955.69 1499.92,-955.54"/>
<polygon fill="black" stroke="black" points="1501.76,-958.51 1508.8,-950.59 1498.36,-952.4 1501.76,-958.51"/>
</g>
<!-- q3_ds1 -->
<g id="node47" class="node">
<title>q3_ds1</title>
<polygon fill="lightcoral" stroke="black" points="1643.5,-950.5 1584.5,-950.5 1584.5,-909.5 1643.5,-909.5 1643.5,-950.5"/>
<text text-anchor="middle" x="1614" y="-938.5" font-family="Arial" font-size="10.00">Q Linear</text>
<text text-anchor="middle" x="1614" y="-927.5" font-family="Arial" font-size="10.00">HG3/DS1</text>
<text text-anchor="middle" x="1614" y="-916.5" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- ln1&#45;&gt;q3_ds1 -->
<g id="edge63" class="edge">
<title>ln1&#45;&gt;q3_ds1</title>
<path fill="none" stroke="black" d="M1395.87,-1004.38C1444,-996.56 1516.9,-981.57 1576,-956 1576.43,-955.81 1576.87,-955.62 1577.31,-955.42"/>
<polygon fill="black" stroke="black" points="1579.13,-958.42 1586.4,-950.71 1575.91,-952.2 1579.13,-958.42"/>
</g>
<!-- k3_ds1 -->
<g id="node48" class="node">
<title>k3_ds1</title>
<polygon fill="lightcoral" stroke="black" points="1720.5,-950.5 1661.5,-950.5 1661.5,-909.5 1720.5,-909.5 1720.5,-950.5"/>
<text text-anchor="middle" x="1691" y="-938.5" font-family="Arial" font-size="10.00">K Linear</text>
<text text-anchor="middle" x="1691" y="-927.5" font-family="Arial" font-size="10.00">HG3/DS1</text>
<text text-anchor="middle" x="1691" y="-916.5" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- ln1&#45;&gt;k3_ds1 -->
<g id="edge64" class="edge">
<title>ln1&#45;&gt;k3_ds1</title>
<path fill="none" stroke="black" d="M1395.77,-1008.57C1458.6,-1003.59 1566.82,-990.4 1653,-956 1653.57,-955.77 1654.15,-955.53 1654.72,-955.29"/>
<polygon fill="black" stroke="black" points="1656.54,-958.29 1663.91,-950.67 1653.4,-952.03 1656.54,-958.29"/>
</g>
<!-- v3_ds1 -->
<g id="node49" class="node">
<title>v3_ds1</title>
<polygon fill="lightcoral" stroke="black" points="1797.5,-950.5 1738.5,-950.5 1738.5,-909.5 1797.5,-909.5 1797.5,-950.5"/>
<text text-anchor="middle" x="1768" y="-938.5" font-family="Arial" font-size="10.00">V Linear</text>
<text text-anchor="middle" x="1768" y="-927.5" font-family="Arial" font-size="10.00">HG3/DS1</text>
<text text-anchor="middle" x="1768" y="-916.5" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- ln1&#45;&gt;v3_ds1 -->
<g id="edge65" class="edge">
<title>ln1&#45;&gt;v3_ds1</title>
<path fill="none" stroke="black" d="M1395.73,-1011.15C1471.51,-1009.09 1616.05,-999.2 1730,-956 1730.72,-955.73 1731.44,-955.44 1732.16,-955.14"/>
<polygon fill="black" stroke="black" points="1733.99,-958.14 1741.38,-950.55 1730.87,-951.87 1733.99,-958.14"/>
</g>
<!-- attn2_ds0 -->
<g id="node38" class="node">
<title>attn2_ds0</title>
<polygon fill="lightpink" stroke="black" points="1065.5,-868 1006.5,-868 1006.5,-827 1065.5,-827 1065.5,-868"/>
<text text-anchor="middle" x="1036" y="-856" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1036" y="-845" font-family="Arial" font-size="10.00">HG2/DS0</text>
<text text-anchor="middle" x="1036" y="-834" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- q2_ds0&#45;&gt;attn2_ds0 -->
<g id="edge66" class="edge">
<title>q2_ds0&#45;&gt;attn2_ds0</title>
<path fill="none" stroke="black" d="M906.45,-903.97C935.93,-891.35 970.86,-876.39 997.03,-865.19"/>
<polygon fill="black" stroke="black" points="998.43,-868.4 1006.24,-861.24 995.67,-861.96 998.43,-868.4"/>
</g>
<!-- k2_ds0&#45;&gt;attn2_ds0 -->
<g id="edge67" class="edge">
<title>k2_ds0&#45;&gt;attn2_ds0</title>
<path fill="none" stroke="black" d="M1007.39,-909.1C1011.9,-899.55 1017.39,-887.92 1022.35,-877.41"/>
<polygon fill="black" stroke="black" points="1025.61,-878.71 1026.71,-868.17 1019.28,-875.72 1025.61,-878.71"/>
</g>
<!-- v2_ds0&#45;&gt;attn2_ds0 -->
<g id="edge68" class="edge">
<title>v2_ds0&#45;&gt;attn2_ds0</title>
<path fill="none" stroke="black" d="M1065.36,-909.1C1060.73,-899.55 1055.1,-887.92 1050.01,-877.41"/>
<polygon fill="black" stroke="black" points="1053.04,-875.64 1045.53,-868.17 1046.74,-878.7 1053.04,-875.64"/>
</g>
<!-- concat2 -->
<g id="node51" class="node">
<title>concat2</title>
<polygon fill="lightsteelblue" stroke="black" points="1289.26,-791 1193.4,-791 1168.74,-709 1264.6,-709 1289.26,-791"/>
<text text-anchor="middle" x="1229" y="-758.5" font-family="Arial" font-size="10.00">Concat</text>
<text text-anchor="middle" x="1229" y="-747.5" font-family="Arial" font-size="10.00">HG2</text>
<text text-anchor="middle" x="1229" y="-736.5" font-family="Arial" font-size="10.00">GPU: 8&#45;9</text>
</g>
<!-- attn2_ds0&#45;&gt;concat2 -->
<g id="edge78" class="edge">
<title>attn2_ds0&#45;&gt;concat2</title>
<path fill="none" stroke="black" d="M1065.73,-831.79C1095.63,-816.99 1142.29,-793.9 1178.09,-776.19"/>
<polygon fill="black" stroke="black" points="1180,-779.15 1187.41,-771.58 1176.89,-772.88 1180,-779.15"/>
</g>
<!-- attn2_ds1 -->
<g id="node42" class="node">
<title>attn2_ds1</title>
<polygon fill="lightpink" stroke="black" points="1258.5,-868 1199.5,-868 1199.5,-827 1258.5,-827 1258.5,-868"/>
<text text-anchor="middle" x="1229" y="-856" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1229" y="-845" font-family="Arial" font-size="10.00">HG2/DS1</text>
<text text-anchor="middle" x="1229" y="-834" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- q2_ds1&#45;&gt;attn2_ds1 -->
<g id="edge69" class="edge">
<title>q2_ds1&#45;&gt;attn2_ds1</title>
<path fill="none" stroke="black" d="M1171.03,-909.1C1180.73,-898.96 1192.66,-886.49 1203.18,-875.5"/>
<polygon fill="black" stroke="black" points="1205.8,-877.82 1210.19,-868.17 1200.74,-872.98 1205.8,-877.82"/>
</g>
<!-- k2_ds1&#45;&gt;attn2_ds1 -->
<g id="edge70" class="edge">
<title>k2_ds1&#45;&gt;attn2_ds1</title>
<path fill="none" stroke="black" d="M1229,-909.1C1229,-899.84 1229,-888.63 1229,-878.38"/>
<polygon fill="black" stroke="black" points="1232.5,-878.17 1229,-868.17 1225.5,-878.17 1232.5,-878.17"/>
</g>
<!-- v2_ds1&#45;&gt;attn2_ds1 -->
<g id="edge71" class="edge">
<title>v2_ds1&#45;&gt;attn2_ds1</title>
<path fill="none" stroke="black" d="M1286.97,-909.1C1277.27,-898.96 1265.34,-886.49 1254.82,-875.5"/>
<polygon fill="black" stroke="black" points="1257.26,-872.98 1247.81,-868.17 1252.2,-877.82 1257.26,-872.98"/>
</g>
<!-- attn2_ds1&#45;&gt;concat2 -->
<g id="edge79" class="edge">
<title>attn2_ds1&#45;&gt;concat2</title>
<path fill="none" stroke="black" d="M1229,-826.71C1229,-819.25 1229,-810.38 1229,-801.39"/>
<polygon fill="black" stroke="black" points="1232.5,-801.25 1229,-791.25 1225.5,-801.25 1232.5,-801.25"/>
</g>
<!-- attn3_ds0 -->
<g id="node46" class="node">
<title>attn3_ds0</title>
<polygon fill="lightpink" stroke="black" points="1489.5,-868 1430.5,-868 1430.5,-827 1489.5,-827 1489.5,-868"/>
<text text-anchor="middle" x="1460" y="-856" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1460" y="-845" font-family="Arial" font-size="10.00">HG3/DS0</text>
<text text-anchor="middle" x="1460" y="-834" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- q3_ds0&#45;&gt;attn3_ds0 -->
<g id="edge72" class="edge">
<title>q3_ds0&#45;&gt;attn3_ds0</title>
<path fill="none" stroke="black" d="M1402.03,-909.1C1411.73,-898.96 1423.66,-886.49 1434.18,-875.5"/>
<polygon fill="black" stroke="black" points="1436.8,-877.82 1441.19,-868.17 1431.74,-872.98 1436.8,-877.82"/>
</g>
<!-- k3_ds0&#45;&gt;attn3_ds0 -->
<g id="edge73" class="edge">
<title>k3_ds0&#45;&gt;attn3_ds0</title>
<path fill="none" stroke="black" d="M1460,-909.1C1460,-899.84 1460,-888.63 1460,-878.38"/>
<polygon fill="black" stroke="black" points="1463.5,-878.17 1460,-868.17 1456.5,-878.17 1463.5,-878.17"/>
</g>
<!-- v3_ds0&#45;&gt;attn3_ds0 -->
<g id="edge74" class="edge">
<title>v3_ds0&#45;&gt;attn3_ds0</title>
<path fill="none" stroke="black" d="M1517.97,-909.1C1508.27,-898.96 1496.34,-886.49 1485.82,-875.5"/>
<polygon fill="black" stroke="black" points="1488.26,-872.98 1478.81,-868.17 1483.2,-877.82 1488.26,-872.98"/>
</g>
<!-- concat3 -->
<g id="node52" class="node">
<title>concat3</title>
<polygon fill="lightsteelblue" stroke="black" points="1530.5,-791 1418.35,-791 1389.5,-709 1501.65,-709 1530.5,-791"/>
<text text-anchor="middle" x="1460" y="-758.5" font-family="Arial" font-size="10.00">Concat</text>
<text text-anchor="middle" x="1460" y="-747.5" font-family="Arial" font-size="10.00">HG3</text>
<text text-anchor="middle" x="1460" y="-736.5" font-family="Arial" font-size="10.00">GPU: 10&#45;11</text>
</g>
<!-- attn3_ds0&#45;&gt;concat3 -->
<g id="edge80" class="edge">
<title>attn3_ds0&#45;&gt;concat3</title>
<path fill="none" stroke="black" d="M1460,-826.71C1460,-819.25 1460,-810.38 1460,-801.39"/>
<polygon fill="black" stroke="black" points="1463.5,-801.25 1460,-791.25 1456.5,-801.25 1463.5,-801.25"/>
</g>
<!-- attn3_ds1 -->
<g id="node50" class="node">
<title>attn3_ds1</title>
<polygon fill="lightpink" stroke="black" points="1681.5,-868 1622.5,-868 1622.5,-827 1681.5,-827 1681.5,-868"/>
<text text-anchor="middle" x="1652" y="-856" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1652" y="-845" font-family="Arial" font-size="10.00">HG3/DS1</text>
<text text-anchor="middle" x="1652" y="-834" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- q3_ds1&#45;&gt;attn3_ds1 -->
<g id="edge75" class="edge">
<title>q3_ds1&#45;&gt;attn3_ds1</title>
<path fill="none" stroke="black" d="M1623.39,-909.1C1627.9,-899.55 1633.39,-887.92 1638.35,-877.41"/>
<polygon fill="black" stroke="black" points="1641.61,-878.71 1642.71,-868.17 1635.28,-875.72 1641.61,-878.71"/>
</g>
<!-- k3_ds1&#45;&gt;attn3_ds1 -->
<g id="edge76" class="edge">
<title>k3_ds1&#45;&gt;attn3_ds1</title>
<path fill="none" stroke="black" d="M1681.36,-909.1C1676.73,-899.55 1671.1,-887.92 1666.01,-877.41"/>
<polygon fill="black" stroke="black" points="1669.04,-875.64 1661.53,-868.17 1662.74,-878.7 1669.04,-875.64"/>
</g>
<!-- v3_ds1&#45;&gt;attn3_ds1 -->
<g id="edge77" class="edge">
<title>v3_ds1&#45;&gt;attn3_ds1</title>
<path fill="none" stroke="black" d="M1739.62,-909.31C1724.32,-898.68 1705.25,-885.45 1688.81,-874.04"/>
<polygon fill="black" stroke="black" points="1690.7,-871.09 1680.49,-868.27 1686.71,-876.85 1690.7,-871.09"/>
</g>
<!-- attn3_ds1&#45;&gt;concat3 -->
<g id="edge81" class="edge">
<title>attn3_ds1&#45;&gt;concat3</title>
<path fill="none" stroke="black" d="M1622.42,-831.79C1599.83,-820.55 1567.61,-804.52 1537.81,-789.7"/>
<polygon fill="black" stroke="black" points="1539.17,-786.47 1528.66,-785.15 1536.05,-792.74 1539.17,-786.47"/>
</g>
<!-- final_concat1 -->
<g id="node53" class="node">
<title>final_concat1</title>
<polygon fill="lightsteelblue" stroke="black" points="1416.79,-673 1297.81,-673 1267.21,-613 1386.19,-613 1416.79,-673"/>
<text text-anchor="middle" x="1342" y="-646" font-family="Arial" font-size="10.00">Final Concat</text>
<text text-anchor="middle" x="1342" y="-635" font-family="Arial" font-size="10.00">GPU: 8&#45;11</text>
</g>
<!-- concat2&#45;&gt;final_concat1 -->
<g id="edge82" class="edge">
<title>concat2&#45;&gt;final_concat1</title>
<path fill="none" stroke="black" d="M1266.31,-714.33C1278.13,-703.35 1291.21,-691.2 1303.13,-680.12"/>
<polygon fill="black" stroke="black" points="1305.82,-682.39 1310.77,-673.02 1301.06,-677.26 1305.82,-682.39"/>
</g>
<!-- concat3&#45;&gt;final_concat1 -->
<g id="edge83" class="edge">
<title>concat3&#45;&gt;final_concat1</title>
<path fill="none" stroke="black" d="M1414.72,-708.7C1404.15,-699.3 1392.96,-689.35 1382.62,-680.14"/>
<polygon fill="black" stroke="black" points="1384.69,-677.3 1374.89,-673.27 1380.03,-682.53 1384.69,-677.3"/>
</g>
<!-- fc1_4 -->
<g id="node54" class="node">
<title>fc1_4</title>
<polygon fill="lightcoral" stroke="black" points="1243.5,-577 1172.5,-577 1172.5,-536 1243.5,-536 1243.5,-577"/>
<text text-anchor="middle" x="1208" y="-565" font-family="Arial" font-size="10.00">FC1 Col</text>
<text text-anchor="middle" x="1208" y="-554" font-family="Arial" font-size="10.00">[8192×4096]</text>
<text text-anchor="middle" x="1208" y="-543" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- final_concat1&#45;&gt;fc1_4 -->
<g id="edge84" class="edge">
<title>final_concat1&#45;&gt;fc1_4</title>
<path fill="none" stroke="black" d="M1295.88,-612.92C1280.19,-603.02 1262.8,-592.05 1247.65,-582.5"/>
<polygon fill="black" stroke="black" points="1249.35,-579.44 1239.03,-577.07 1245.62,-585.36 1249.35,-579.44"/>
</g>
<!-- fc1_5 -->
<g id="node55" class="node">
<title>fc1_5</title>
<polygon fill="lightcoral" stroke="black" points="1332.5,-577 1261.5,-577 1261.5,-536 1332.5,-536 1332.5,-577"/>
<text text-anchor="middle" x="1297" y="-565" font-family="Arial" font-size="10.00">FC1 Col</text>
<text text-anchor="middle" x="1297" y="-554" font-family="Arial" font-size="10.00">[8192×4096]</text>
<text text-anchor="middle" x="1297" y="-543" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- final_concat1&#45;&gt;fc1_5 -->
<g id="edge85" class="edge">
<title>final_concat1&#45;&gt;fc1_5</title>
<path fill="none" stroke="black" d="M1326.51,-612.92C1321.88,-604.23 1316.81,-594.7 1312.2,-586.04"/>
<polygon fill="black" stroke="black" points="1315.21,-584.25 1307.42,-577.07 1309.03,-587.54 1315.21,-584.25"/>
</g>
<!-- fc1_6 -->
<g id="node56" class="node">
<title>fc1_6</title>
<polygon fill="lightcoral" stroke="black" points="1421.5,-577 1350.5,-577 1350.5,-536 1421.5,-536 1421.5,-577"/>
<text text-anchor="middle" x="1386" y="-565" font-family="Arial" font-size="10.00">FC1 Col</text>
<text text-anchor="middle" x="1386" y="-554" font-family="Arial" font-size="10.00">[8192×4096]</text>
<text text-anchor="middle" x="1386" y="-543" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- final_concat1&#45;&gt;fc1_6 -->
<g id="edge86" class="edge">
<title>final_concat1&#45;&gt;fc1_6</title>
<path fill="none" stroke="black" d="M1357.14,-612.92C1361.67,-604.23 1366.63,-594.7 1371.14,-586.04"/>
<polygon fill="black" stroke="black" points="1374.3,-587.55 1375.81,-577.07 1368.09,-584.32 1374.3,-587.55"/>
</g>
<!-- fc1_7 -->
<g id="node57" class="node">
<title>fc1_7</title>
<polygon fill="lightcoral" stroke="black" points="1510.5,-577 1439.5,-577 1439.5,-536 1510.5,-536 1510.5,-577"/>
<text text-anchor="middle" x="1475" y="-565" font-family="Arial" font-size="10.00">FC1 Col</text>
<text text-anchor="middle" x="1475" y="-554" font-family="Arial" font-size="10.00">[8192×4096]</text>
<text text-anchor="middle" x="1475" y="-543" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- final_concat1&#45;&gt;fc1_7 -->
<g id="edge87" class="edge">
<title>final_concat1&#45;&gt;fc1_7</title>
<path fill="none" stroke="black" d="M1386.66,-613.63C1402.43,-603.61 1420.04,-592.42 1435.37,-582.68"/>
<polygon fill="black" stroke="black" points="1437.53,-585.45 1444.1,-577.13 1433.78,-579.54 1437.53,-585.45"/>
</g>
<!-- fc1_concat1 -->
<g id="node58" class="node">
<title>fc1_concat1</title>
<polygon fill="lightsteelblue" stroke="black" points="1404.65,-500 1289.08,-500 1259.35,-440 1374.92,-440 1404.65,-500"/>
<text text-anchor="middle" x="1332" y="-473" font-family="Arial" font-size="10.00">Concat FC1</text>
<text text-anchor="middle" x="1332" y="-462" font-family="Arial" font-size="10.00">GPU: 8&#45;11</text>
</g>
<!-- fc1_4&#45;&gt;fc1_concat1 -->
<g id="edge88" class="edge">
<title>fc1_4&#45;&gt;fc1_concat1</title>
<path fill="none" stroke="black" d="M1236.76,-535.9C1249.92,-526.93 1265.92,-516.03 1281.01,-505.75"/>
<polygon fill="black" stroke="black" points="1282.99,-508.63 1289.28,-500.11 1279.05,-502.85 1282.99,-508.63"/>
</g>
<!-- fc1_5&#45;&gt;fc1_concat1 -->
<g id="edge89" class="edge">
<title>fc1_5&#45;&gt;fc1_concat1</title>
<path fill="none" stroke="black" d="M1305.12,-535.9C1308.39,-528.01 1312.27,-518.63 1316.06,-509.48"/>
<polygon fill="black" stroke="black" points="1319.35,-510.69 1319.94,-500.11 1312.88,-508.01 1319.35,-510.69"/>
</g>
<!-- fc1_6&#45;&gt;fc1_concat1 -->
<g id="edge90" class="edge">
<title>fc1_6&#45;&gt;fc1_concat1</title>
<path fill="none" stroke="black" d="M1373.48,-535.9C1368.28,-527.76 1362.06,-518.04 1356.04,-508.62"/>
<polygon fill="black" stroke="black" points="1358.94,-506.65 1350.6,-500.11 1353.04,-510.42 1358.94,-506.65"/>
</g>
<!-- fc1_7&#45;&gt;fc1_concat1 -->
<g id="edge91" class="edge">
<title>fc1_7&#45;&gt;fc1_concat1</title>
<path fill="none" stroke="black" d="M1441.83,-535.9C1426.52,-526.85 1407.87,-515.83 1390.32,-505.46"/>
<polygon fill="black" stroke="black" points="1391.65,-502.18 1381.26,-500.11 1388.09,-508.21 1391.65,-502.18"/>
</g>
<!-- gelu1 -->
<g id="node59" class="node">
<title>gelu1</title>
<polygon fill="lightyellow" stroke="black" points="1363.5,-404 1300.5,-404 1300.5,-368 1363.5,-368 1363.5,-404"/>
<text text-anchor="middle" x="1332" y="-389" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="1332" y="-378" font-family="Arial" font-size="10.00">GPU: 8&#45;11</text>
</g>
<!-- fc1_concat1&#45;&gt;gelu1 -->
<g id="edge92" class="edge">
<title>fc1_concat1&#45;&gt;gelu1</title>
<path fill="none" stroke="black" d="M1332,-439.86C1332,-431.54 1332,-422.5 1332,-414.29"/>
<polygon fill="black" stroke="black" points="1335.5,-414.11 1332,-404.11 1328.5,-414.11 1335.5,-414.11"/>
</g>
<!-- fc2_4 -->
<g id="node60" class="node">
<title>fc2_4</title>
<polygon fill="lightcoral" stroke="black" points="1233.5,-332 1162.5,-332 1162.5,-291 1233.5,-291 1233.5,-332"/>
<text text-anchor="middle" x="1198" y="-320" font-family="Arial" font-size="10.00">FC2 Row</text>
<text text-anchor="middle" x="1198" y="-309" font-family="Arial" font-size="10.00">[4096×2048]</text>
<text text-anchor="middle" x="1198" y="-298" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- gelu1&#45;&gt;fc2_4 -->
<g id="edge93" class="edge">
<title>gelu1&#45;&gt;fc2_4</title>
<path fill="none" stroke="black" d="M1300.24,-367.82C1283.08,-358.53 1261.61,-346.92 1242.78,-336.73"/>
<polygon fill="black" stroke="black" points="1244.24,-333.54 1233.78,-331.86 1240.91,-339.7 1244.24,-333.54"/>
</g>
<!-- fc2_5 -->
<g id="node61" class="node">
<title>fc2_5</title>
<polygon fill="lightcoral" stroke="black" points="1322.5,-332 1251.5,-332 1251.5,-291 1322.5,-291 1322.5,-332"/>
<text text-anchor="middle" x="1287" y="-320" font-family="Arial" font-size="10.00">FC2 Row</text>
<text text-anchor="middle" x="1287" y="-309" font-family="Arial" font-size="10.00">[4096×2048]</text>
<text text-anchor="middle" x="1287" y="-298" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- gelu1&#45;&gt;fc2_5 -->
<g id="edge94" class="edge">
<title>gelu1&#45;&gt;fc2_5</title>
<path fill="none" stroke="black" d="M1321.34,-367.82C1316.35,-359.78 1310.27,-349.99 1304.62,-340.89"/>
<polygon fill="black" stroke="black" points="1307.43,-338.77 1299.18,-332.12 1301.48,-342.46 1307.43,-338.77"/>
</g>
<!-- fc2_6 -->
<g id="node62" class="node">
<title>fc2_6</title>
<polygon fill="lightcoral" stroke="black" points="1411.5,-332 1340.5,-332 1340.5,-291 1411.5,-291 1411.5,-332"/>
<text text-anchor="middle" x="1376" y="-320" font-family="Arial" font-size="10.00">FC2 Row</text>
<text text-anchor="middle" x="1376" y="-309" font-family="Arial" font-size="10.00">[4096×2048]</text>
<text text-anchor="middle" x="1376" y="-298" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- gelu1&#45;&gt;fc2_6 -->
<g id="edge95" class="edge">
<title>gelu1&#45;&gt;fc2_6</title>
<path fill="none" stroke="black" d="M1342.43,-367.82C1347.31,-359.78 1353.25,-349.99 1358.77,-340.89"/>
<polygon fill="black" stroke="black" points="1361.9,-342.48 1364.09,-332.12 1355.91,-338.85 1361.9,-342.48"/>
</g>
<!-- fc2_7 -->
<g id="node63" class="node">
<title>fc2_7</title>
<polygon fill="lightcoral" stroke="black" points="1500.5,-332 1429.5,-332 1429.5,-291 1500.5,-291 1500.5,-332"/>
<text text-anchor="middle" x="1465" y="-320" font-family="Arial" font-size="10.00">FC2 Row</text>
<text text-anchor="middle" x="1465" y="-309" font-family="Arial" font-size="10.00">[4096×2048]</text>
<text text-anchor="middle" x="1465" y="-298" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- gelu1&#45;&gt;fc2_7 -->
<g id="edge96" class="edge">
<title>gelu1&#45;&gt;fc2_7</title>
<path fill="none" stroke="black" d="M1363.52,-367.82C1380.55,-358.53 1401.86,-346.92 1420.55,-336.73"/>
<polygon fill="black" stroke="black" points="1422.38,-339.72 1429.49,-331.86 1419.03,-333.57 1422.38,-339.72"/>
</g>
<!-- fc2_allreduce1 -->
<g id="node64" class="node">
<title>fc2_allreduce1</title>
<polygon fill="lightsteelblue" stroke="black" points="1391.28,-255 1284.25,-255 1256.72,-195 1363.75,-195 1391.28,-255"/>
<text text-anchor="middle" x="1324" y="-228" font-family="Arial" font-size="10.00">All&#45;Restore</text>
<text text-anchor="middle" x="1324" y="-217" font-family="Arial" font-size="10.00">GPU: 8&#45;11</text>
</g>
<!-- fc2_4&#45;&gt;fc2_allreduce1 -->
<g id="edge97" class="edge">
<title>fc2_4&#45;&gt;fc2_allreduce1</title>
<path fill="none" stroke="black" d="M1227.22,-290.9C1241.21,-281.52 1258.35,-270.03 1274.29,-259.33"/>
<polygon fill="black" stroke="black" points="1276.65,-261.97 1283,-253.49 1272.75,-256.16 1276.65,-261.97"/>
</g>
<!-- fc2_5&#45;&gt;fc2_allreduce1 -->
<g id="edge98" class="edge">
<title>fc2_5&#45;&gt;fc2_allreduce1</title>
<path fill="none" stroke="black" d="M1295.58,-290.9C1299.04,-283.01 1303.14,-273.63 1307.15,-264.48"/>
<polygon fill="black" stroke="black" points="1310.45,-265.67 1311.25,-255.11 1304.04,-262.87 1310.45,-265.67"/>
</g>
<!-- fc2_6&#45;&gt;fc2_allreduce1 -->
<g id="edge99" class="edge">
<title>fc2_6&#45;&gt;fc2_allreduce1</title>
<path fill="none" stroke="black" d="M1363.94,-290.9C1358.98,-282.85 1353.07,-273.23 1347.33,-263.91"/>
<polygon fill="black" stroke="black" points="1350.14,-261.79 1341.91,-255.11 1344.17,-265.46 1350.14,-261.79"/>
</g>
<!-- fc2_7&#45;&gt;fc2_allreduce1 -->
<g id="edge100" class="edge">
<title>fc2_7&#45;&gt;fc2_allreduce1</title>
<path fill="none" stroke="black" d="M1432.3,-290.9C1417.19,-281.85 1398.81,-270.83 1381.5,-260.46"/>
<polygon fill="black" stroke="black" points="1382.95,-257.25 1372.57,-255.11 1379.35,-263.25 1382.95,-257.25"/>
</g>
<!-- residual1 -->
<g id="node65" class="node">
<title>residual1</title>
<polygon fill="lightgray" stroke="black" points="1361,-159 1287,-159 1287,-118 1361,-118 1361,-159"/>
<text text-anchor="middle" x="1324" y="-147" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1324" y="-136" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="1324" y="-125" font-family="Arial" font-size="10.00">GPU: 8&#45;11</text>
</g>
<!-- fc2_allreduce1&#45;&gt;residual1 -->
<g id="edge101" class="edge">
<title>fc2_allreduce1&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M1324,-194.92C1324,-186.6 1324,-177.51 1324,-169.15"/>
<polygon fill="black" stroke="black" points="1327.5,-169.07 1324,-159.07 1320.5,-169.07 1327.5,-169.07"/>
</g>
<!-- output -->
<g id="node67" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="1430.57,-82 1261.04,-82 1217.43,0 1386.96,0 1430.57,-82"/>
<text text-anchor="middle" x="1324" y="-49.5" font-family="Arial" font-size="10.00">Model Output</text>
<text text-anchor="middle" x="1324" y="-38.5" font-family="Arial" font-size="10.00">[1024×10000×8192]</text>
<text text-anchor="middle" x="1324" y="-27.5" font-family="Arial" font-size="10.00">GPU: 8&#45;11</text>
</g>
<!-- residual1&#45;&gt;output -->
<g id="edge103" class="edge">
<title>residual1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1324,-117.71C1324,-110.25 1324,-101.38 1324,-92.39"/>
<polygon fill="black" stroke="black" points="1327.5,-92.25 1324,-82.25 1320.5,-92.25 1327.5,-92.25"/>
</g>
<!-- comm0&#45;&gt;ln1 -->
<g id="edge53" class="edge">
<title>comm0&#45;&gt;ln1</title>
<path fill="none" stroke="black" d="M1344,-1086.64C1344,-1071.89 1344,-1056.29 1344,-1043.3"/>
<polygon fill="black" stroke="black" points="1347.5,-1043.08 1344,-1033.08 1340.5,-1043.08 1347.5,-1043.08"/>
</g>
<!-- comm0&#45;&gt;residual1 -->
<g id="edge102" class="edge">
<title>comm0&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M1440.87,-1131.34C1587.27,-1116.01 1844.17,-1065.96 1807,-904 1739.28,-608.93 1693.75,-531.6 1510,-291 1469.29,-237.7 1406.19,-191.5 1364.98,-164.57"/>
<polygon fill="black" stroke="black" points="1366.84,-161.6 1356.54,-159.12 1363.04,-167.48 1366.84,-161.6"/>
</g>
</g>
</svg>
