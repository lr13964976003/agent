digraph EP3_TP2_PP1 {
rankdir=TB; splines=true; compound=true;
node [shape=record, fontname="Helvetica"];
edge [fontname="Helvetica"];

// ---------- subgraphs per GPU ----------
subgraph cluster_gpu0 { label="GPU-0"; style=rounded; color=blue;
  gpu0_att_in  [shape=parallelogram, label="att_input_agg|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_qkv0    [shape=rectangle,      label="qkv_proj_0|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu0_qkv1    [shape=rectangle,      label="qkv_proj_1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu0_attout0 [shape=rectangle,      label="att_out_proj_0|Input:batch_size=64,seq_len=1024,heads=16,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu0_attout1 [shape=rectangle,      label="att_out_proj_1|Input:batch_size=64,seq_len=1024,heads=16,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu0_att_agg [shape=parallelogram, label="att_output_agg|Input:batch_size=64,seq_len=1024,heads=16,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_res1    [shape=rectangle,      label="residual_add_1|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_ln1     [shape=rectangle,      label="layer_norm_1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  // MoE section GPU-0 (21 experts)
  gpu0_gate0      [shape=rectangle, label="expert0_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert0_fc1 [shape=rectangle, label="expert0_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert0_fc2 [shape=rectangle, label="expert0_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert0_add [shape=rectangle, label="expert0_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate1      [shape=rectangle, label="expert1_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert1_fc1 [shape=rectangle, label="expert1_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert1_fc2 [shape=rectangle, label="expert1_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert1_add [shape=rectangle, label="expert1_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate2      [shape=rectangle, label="expert2_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert2_fc1 [shape=rectangle, label="expert2_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert2_fc2 [shape=rectangle, label="expert2_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert2_add [shape=rectangle, label="expert2_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate3      [shape=rectangle, label="expert3_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert3_fc1 [shape=rectangle, label="expert3_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert3_fc2 [shape=rectangle, label="expert3_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert3_add [shape=rectangle, label="expert3_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate4      [shape=rectangle, label="expert4_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert4_fc1 [shape=rectangle, label="expert4_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert4_fc2 [shape=rectangle, label="expert4_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert4_add [shape=rectangle, label="expert4_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate5      [shape=rectangle, label="expert5_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert5_fc1 [shape=rectangle, label="expert5_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert5_fc2 [shape=rectangle, label="expert5_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert5_add [shape=rectangle, label="expert5_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate6      [shape=rectangle, label="expert6_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert6_fc1 [shape=rectangle, label="expert6_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert6_fc2 [shape=rectangle, label="expert6_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert6_add [shape=rectangle, label="expert6_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate7      [shape=rectangle, label="expert7_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert7_fc1 [shape=rectangle, label="expert7_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert7_fc2 [shape=rectangle, label="expert7_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert7_add [shape=rectangle, label="expert7_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate8      [shape=rectangle, label="expert8_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert8_fc1 [shape=rectangle, label="expert8_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert8_fc2 [shape=rectangle, label="expert8_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert8_add [shape=rectangle, label="expert8_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate9      [shape=rectangle, label="expert9_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert9_fc1 [shape=rectangle, label="expert9_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert9_fc2 [shape=rectangle, label="expert9_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert9_add [shape=rectangle, label="expert9_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate10      [shape=rectangle, label="expert10_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert10_fc1 [shape=rectangle, label="expert10_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert10_fc2 [shape=rectangle, label="expert10_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert10_add [shape=rectangle, label="expert10_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate11      [shape=rectangle, label="expert11_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert11_fc1 [shape=rectangle, label="expert11_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert11_fc2 [shape=rectangle, label="expert11_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert11_add [shape=rectangle, label="expert11_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate12      [shape=rectangle, label="expert12_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert12_fc1 [shape=rectangle, label="expert12_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert12_fc2 [shape=rectangle, label="expert12_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert12_add [shape=rectangle, label="expert12_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate13      [shape=rectangle, label="expert13_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert13_fc1 [shape=rectangle, label="expert13_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert13_fc2 [shape=rectangle, label="expert13_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert13_add [shape=rectangle, label="expert13_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate14      [shape=rectangle, label="expert14_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert14_fc1 [shape=rectangle, label="expert14_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert14_fc2 [shape=rectangle, label="expert14_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert14_add [shape=rectangle, label="expert14_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate15      [shape=rectangle, label="expert15_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert15_fc1 [shape=rectangle, label="expert15_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert15_fc2 [shape=rectangle, label="expert15_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert15_add [shape=rectangle, label="expert15_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate16      [shape=rectangle, label="expert16_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert16_fc1 [shape=rectangle, label="expert16_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert16_fc2 [shape=rectangle, label="expert16_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert16_add [shape=rectangle, label="expert16_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate17      [shape=rectangle, label="expert17_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert17_fc1 [shape=rectangle, label="expert17_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert17_fc2 [shape=rectangle, label="expert17_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert17_add [shape=rectangle, label="expert17_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate18      [shape=rectangle, label="expert18_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert18_fc1 [shape=rectangle, label="expert18_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert18_fc2 [shape=rectangle, label="expert18_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert18_add [shape=rectangle, label="expert18_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate19      [shape=rectangle, label="expert19_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert19_fc1 [shape=rectangle, label="expert19_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert19_fc2 [shape=rectangle, label="expert19_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert19_add [shape=rectangle, label="expert19_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_gate20      [shape=rectangle, label="expert20_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu0_expert20_fc1 [shape=rectangle, label="expert20_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu0_expert20_fc2 [shape=rectangle, label="expert20_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu0_expert20_add [shape=rectangle, label="expert20_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
}
subgraph cluster_gpu1 { label="GPU-1"; style=rounded; color=green;
  gpu1_att_in  [shape=parallelogram, label="att_input_agg|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_qkv0    [shape=rectangle,      label="qkv_proj_0|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu1_qkv1    [shape=rectangle,      label="qkv_proj_1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu1_attout0 [shape=rectangle,      label="att_out_proj_0|Input:batch_size=64,seq_len=1024,heads=16,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu1_attout1 [shape=rectangle,      label="att_out_proj_1|Input:batch_size=64,seq_len=1024,heads=16,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu1_att_agg [shape=parallelogram, label="att_output_agg|Input:batch_size=64,seq_len=1024,heads=16,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_res1    [shape=rectangle,      label="residual_add_1|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_ln1     [shape=rectangle,      label="layer_norm_1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  // MoE section GPU-1 (21 experts)
  gpu1_gate0      [shape=rectangle, label="expert21_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert0_fc1 [shape=rectangle, label="expert21_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert0_fc2 [shape=rectangle, label="expert21_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert0_add [shape=rectangle, label="expert21_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate1      [shape=rectangle, label="expert22_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert1_fc1 [shape=rectangle, label="expert22_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert1_fc2 [shape=rectangle, label="expert22_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert1_add [shape=rectangle, label="expert22_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate2      [shape=rectangle, label="expert23_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert2_fc1 [shape=rectangle, label="expert23_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert2_fc2 [shape=rectangle, label="expert23_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert2_add [shape=rectangle, label="expert23_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate3      [shape=rectangle, label="expert24_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert3_fc1 [shape=rectangle, label="expert24_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert3_fc2 [shape=rectangle, label="expert24_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert3_add [shape=rectangle, label="expert24_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate4      [shape=rectangle, label="expert25_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert4_fc1 [shape=rectangle, label="expert25_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert4_fc2 [shape=rectangle, label="expert25_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert4_add [shape=rectangle, label="expert25_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate5      [shape=rectangle, label="expert26_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert5_fc1 [shape=rectangle, label="expert26_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert5_fc2 [shape=rectangle, label="expert26_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert5_add [shape=rectangle, label="expert26_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate6      [shape=rectangle, label="expert27_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert6_fc1 [shape=rectangle, label="expert27_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert6_fc2 [shape=rectangle, label="expert27_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert6_add [shape=rectangle, label="expert27_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate7      [shape=rectangle, label="expert28_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert7_fc1 [shape=rectangle, label="expert28_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert7_fc2 [shape=rectangle, label="expert28_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert7_add [shape=rectangle, label="expert28_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate8      [shape=rectangle, label="expert29_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert8_fc1 [shape=rectangle, label="expert29_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert8_fc2 [shape=rectangle, label="expert29_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert8_add [shape=rectangle, label="expert29_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate9      [shape=rectangle, label="expert30_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert9_fc1 [shape=rectangle, label="expert30_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert9_fc2 [shape=rectangle, label="expert30_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert9_add [shape=rectangle, label="expert30_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate10      [shape=rectangle, label="expert31_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert10_fc1 [shape=rectangle, label="expert31_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert10_fc2 [shape=rectangle, label="expert31_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert10_add [shape=rectangle, label="expert31_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate11      [shape=rectangle, label="expert32_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert11_fc1 [shape=rectangle, label="expert32_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert11_fc2 [shape=rectangle, label="expert32_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert11_add [shape=rectangle, label="expert32_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate12      [shape=rectangle, label="expert33_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert12_fc1 [shape=rectangle, label="expert33_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert12_fc2 [shape=rectangle, label="expert33_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert12_add [shape=rectangle, label="expert33_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate13      [shape=rectangle, label="expert34_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert13_fc1 [shape=rectangle, label="expert34_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert13_fc2 [shape=rectangle, label="expert34_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert13_add [shape=rectangle, label="expert34_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate14      [shape=rectangle, label="expert35_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert14_fc1 [shape=rectangle, label="expert35_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert14_fc2 [shape=rectangle, label="expert35_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert14_add [shape=rectangle, label="expert35_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate15      [shape=rectangle, label="expert36_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert15_fc1 [shape=rectangle, label="expert36_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert15_fc2 [shape=rectangle, label="expert36_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert15_add [shape=rectangle, label="expert36_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate16      [shape=rectangle, label="expert37_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert16_fc1 [shape=rectangle, label="expert37_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert16_fc2 [shape=rectangle, label="expert37_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert16_add [shape=rectangle, label="expert37_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate17      [shape=rectangle, label="expert38_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert17_fc1 [shape=rectangle, label="expert38_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert17_fc2 [shape=rectangle, label="expert38_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert17_add [shape=rectangle, label="expert38_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate18      [shape=rectangle, label="expert39_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert18_fc1 [shape=rectangle, label="expert39_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert18_fc2 [shape=rectangle, label="expert39_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert18_add [shape=rectangle, label="expert39_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate19      [shape=rectangle, label="expert40_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert19_fc1 [shape=rectangle, label="expert40_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert19_fc2 [shape=rectangle, label="expert40_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert19_add [shape=rectangle, label="expert40_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_gate20      [shape=rectangle, label="expert41_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu1_expert20_fc1 [shape=rectangle, label="expert41_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu1_expert20_fc2 [shape=rectangle, label="expert41_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu1_expert20_add [shape=rectangle, label="expert41_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
}
subgraph cluster_gpu2 { label="GPU-2"; style=rounded; color=red;
  gpu2_att_in  [shape=parallelogram, label="att_input_agg|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_qkv0    [shape=rectangle,      label="qkv_proj_0|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu2_qkv1    [shape=rectangle,      label="qkv_proj_1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu2_attout0 [shape=rectangle,      label="att_out_proj_0|Input:batch_size=64,seq_len=1024,heads=16,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu2_attout1 [shape=rectangle,      label="att_out_proj_1|Input:batch_size=64,seq_len=1024,heads=16,d_k=128|Output:batch_size=64,seq_len=1024,heads=16,d_k=128"];
  gpu2_att_agg [shape=parallelogram, label="att_output_agg|Input:batch_size=64,seq_len=1024,heads=16,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_res1    [shape=rectangle,      label="residual_add_1|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_ln1     [shape=rectangle,      label="layer_norm_1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  // MoE section GPU-2 (21 experts)
  gpu2_gate0      [shape=rectangle, label="expert42_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert0_fc1 [shape=rectangle, label="expert42_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert0_fc2 [shape=rectangle, label="expert42_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert0_add [shape=rectangle, label="expert42_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate1      [shape=rectangle, label="expert43_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert1_fc1 [shape=rectangle, label="expert43_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert1_fc2 [shape=rectangle, label="expert43_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert1_add [shape=rectangle, label="expert43_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate2      [shape=rectangle, label="expert44_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert2_fc1 [shape=rectangle, label="expert44_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert2_fc2 [shape=rectangle, label="expert44_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert2_add [shape=rectangle, label="expert44_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate3      [shape=rectangle, label="expert45_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert3_fc1 [shape=rectangle, label="expert45_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert3_fc2 [shape=rectangle, label="expert45_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert3_add [shape=rectangle, label="expert45_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate4      [shape=rectangle, label="expert46_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert4_fc1 [shape=rectangle, label="expert46_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert4_fc2 [shape=rectangle, label="expert46_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert4_add [shape=rectangle, label="expert46_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate5      [shape=rectangle, label="expert47_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert5_fc1 [shape=rectangle, label="expert47_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert5_fc2 [shape=rectangle, label="expert47_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert5_add [shape=rectangle, label="expert47_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate6      [shape=rectangle, label="expert48_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert6_fc1 [shape=rectangle, label="expert48_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert6_fc2 [shape=rectangle, label="expert48_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert6_add [shape=rectangle, label="expert48_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate7      [shape=rectangle, label="expert49_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert7_fc1 [shape=rectangle, label="expert49_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert7_fc2 [shape=rectangle, label="expert49_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert7_add [shape=rectangle, label="expert49_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate8      [shape=rectangle, label="expert50_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert8_fc1 [shape=rectangle, label="expert50_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert8_fc2 [shape=rectangle, label="expert50_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert8_add [shape=rectangle, label="expert50_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate9      [shape=rectangle, label="expert51_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert9_fc1 [shape=rectangle, label="expert51_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert9_fc2 [shape=rectangle, label="expert51_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert9_add [shape=rectangle, label="expert51_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate10      [shape=rectangle, label="expert52_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert10_fc1 [shape=rectangle, label="expert52_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert10_fc2 [shape=rectangle, label="expert52_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert10_add [shape=rectangle, label="expert52_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate11      [shape=rectangle, label="expert53_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert11_fc1 [shape=rectangle, label="expert53_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert11_fc2 [shape=rectangle, label="expert53_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert11_add [shape=rectangle, label="expert53_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate12      [shape=rectangle, label="expert54_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert12_fc1 [shape=rectangle, label="expert54_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert12_fc2 [shape=rectangle, label="expert54_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert12_add [shape=rectangle, label="expert54_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate13      [shape=rectangle, label="expert55_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert13_fc1 [shape=rectangle, label="expert55_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert13_fc2 [shape=rectangle, label="expert55_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert13_add [shape=rectangle, label="expert55_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate14      [shape=rectangle, label="expert56_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert14_fc1 [shape=rectangle, label="expert56_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert14_fc2 [shape=rectangle, label="expert56_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert14_add [shape=rectangle, label="expert56_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate15      [shape=rectangle, label="expert57_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert15_fc1 [shape=rectangle, label="expert57_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert15_fc2 [shape=rectangle, label="expert57_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert15_add [shape=rectangle, label="expert57_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate16      [shape=rectangle, label="expert58_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert16_fc1 [shape=rectangle, label="expert58_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert16_fc2 [shape=rectangle, label="expert58_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert16_add [shape=rectangle, label="expert58_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate17      [shape=rectangle, label="expert59_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert17_fc1 [shape=rectangle, label="expert59_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert17_fc2 [shape=rectangle, label="expert59_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert17_add [shape=rectangle, label="expert59_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate18      [shape=rectangle, label="expert60_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert18_fc1 [shape=rectangle, label="expert60_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert18_fc2 [shape=rectangle, label="expert60_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert18_add [shape=rectangle, label="expert60_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate19      [shape=rectangle, label="expert61_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert19_fc1 [shape=rectangle, label="expert61_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert19_fc2 [shape=rectangle, label="expert61_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert19_add [shape=rectangle, label="expert61_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_gate20      [shape=rectangle, label="expert62_gate|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=1,d_k=128"];
  gpu2_expert20_fc1 [shape=rectangle, label="expert62_fc1|Input:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=8192,d_k=128"];
  gpu2_expert20_fc2 [shape=rectangle, label="expert62_fc2|Input:batch_size=64,seq_len=1024,heads=8192,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
  gpu2_expert20_add [shape=rectangle, label="expert62_add|Input1:batch_size=64,seq_len=1024,heads=32,d_k=128,Input2:batch_size=64,seq_len=1024,heads=32,d_k=128|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
}
// global input/output
input  [shape=ellipse, label="TotalInput|Output:batch_size=64,seq_len=1024,heads=32,d_k=128"];
output [shape=ellipse, label="TotalOutput|Input:batch_size=64,seq_len=1024,heads=32,d_k=128"];

input -> layer0_att_in_gpu0;
layer0_att_in_gpu0 -> layer0_qkv0_gpu0;
layer0_att_in_gpu0 -> layer0_qkv1_gpu0;
layer0_qkv0_gpu0 -> layer0_attout0_gpu0;
layer0_qkv1_gpu0 -> layer0_attout1_gpu0;
layer0_attout0_gpu0 -> layer0_att_agg_gpu0;
layer0_attout1_gpu0 -> layer0_att_agg_gpu0;
layer0_att_agg_gpu0 -> layer0_res1_gpu0;
layer0_res1_gpu0 -> layer0_ln1_gpu0;
input -> layer0_att_in_gpu1;
layer0_att_in_gpu1 -> layer0_qkv0_gpu1;
layer0_att_in_gpu1 -> layer0_qkv1_gpu1;
layer0_qkv0_gpu1 -> layer0_attout0_gpu1;
layer0_qkv1_gpu1 -> layer0_attout1_gpu1;
layer0_attout0_gpu1 -> layer0_att_agg_gpu1;
layer0_attout1_gpu1 -> layer0_att_agg_gpu1;
layer0_att_agg_gpu1 -> layer0_res1_gpu1;
layer0_res1_gpu1 -> layer0_ln1_gpu1;
input -> layer0_att_in_gpu2;
layer0_att_in_gpu2 -> layer0_qkv0_gpu2;
layer0_att_in_gpu2 -> layer0_qkv1_gpu2;
layer0_qkv0_gpu2 -> layer0_attout0_gpu2;
layer0_qkv1_gpu2 -> layer0_attout1_gpu2;
layer0_attout0_gpu2 -> layer0_att_agg_gpu2;
layer0_attout1_gpu2 -> layer0_att_agg_gpu2;
layer0_att_agg_gpu2 -> layer0_res1_gpu2;
layer0_res1_gpu2 -> layer0_ln1_gpu2;
layer0_ln1_gpu0 -> layer0_gate0_gpu0;
layer0_gate0_gpu0 -> layer0_expert0_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert0_fc1_gpu0;
layer0_expert0_fc1_gpu0 -> layer0_expert0_fc2_gpu0;
layer0_expert0_fc2_gpu0 -> layer0_expert0_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate1_gpu0;
layer0_gate1_gpu0 -> layer0_expert1_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert1_fc1_gpu0;
layer0_expert1_fc1_gpu0 -> layer0_expert1_fc2_gpu0;
layer0_expert1_fc2_gpu0 -> layer0_expert1_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate2_gpu0;
layer0_gate2_gpu0 -> layer0_expert2_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert2_fc1_gpu0;
layer0_expert2_fc1_gpu0 -> layer0_expert2_fc2_gpu0;
layer0_expert2_fc2_gpu0 -> layer0_expert2_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate3_gpu0;
layer0_gate3_gpu0 -> layer0_expert3_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert3_fc1_gpu0;
layer0_expert3_fc1_gpu0 -> layer0_expert3_fc2_gpu0;
layer0_expert3_fc2_gpu0 -> layer0_expert3_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate4_gpu0;
layer0_gate4_gpu0 -> layer0_expert4_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert4_fc1_gpu0;
layer0_expert4_fc1_gpu0 -> layer0_expert4_fc2_gpu0;
layer0_expert4_fc2_gpu0 -> layer0_expert4_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate5_gpu0;
layer0_gate5_gpu0 -> layer0_expert5_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert5_fc1_gpu0;
layer0_expert5_fc1_gpu0 -> layer0_expert5_fc2_gpu0;
layer0_expert5_fc2_gpu0 -> layer0_expert5_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate6_gpu0;
layer0_gate6_gpu0 -> layer0_expert6_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert6_fc1_gpu0;
layer0_expert6_fc1_gpu0 -> layer0_expert6_fc2_gpu0;
layer0_expert6_fc2_gpu0 -> layer0_expert6_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate7_gpu0;
layer0_gate7_gpu0 -> layer0_expert7_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert7_fc1_gpu0;
layer0_expert7_fc1_gpu0 -> layer0_expert7_fc2_gpu0;
layer0_expert7_fc2_gpu0 -> layer0_expert7_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate8_gpu0;
layer0_gate8_gpu0 -> layer0_expert8_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert8_fc1_gpu0;
layer0_expert8_fc1_gpu0 -> layer0_expert8_fc2_gpu0;
layer0_expert8_fc2_gpu0 -> layer0_expert8_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate9_gpu0;
layer0_gate9_gpu0 -> layer0_expert9_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert9_fc1_gpu0;
layer0_expert9_fc1_gpu0 -> layer0_expert9_fc2_gpu0;
layer0_expert9_fc2_gpu0 -> layer0_expert9_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate10_gpu0;
layer0_gate10_gpu0 -> layer0_expert10_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert10_fc1_gpu0;
layer0_expert10_fc1_gpu0 -> layer0_expert10_fc2_gpu0;
layer0_expert10_fc2_gpu0 -> layer0_expert10_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate11_gpu0;
layer0_gate11_gpu0 -> layer0_expert11_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert11_fc1_gpu0;
layer0_expert11_fc1_gpu0 -> layer0_expert11_fc2_gpu0;
layer0_expert11_fc2_gpu0 -> layer0_expert11_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate12_gpu0;
layer0_gate12_gpu0 -> layer0_expert12_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert12_fc1_gpu0;
layer0_expert12_fc1_gpu0 -> layer0_expert12_fc2_gpu0;
layer0_expert12_fc2_gpu0 -> layer0_expert12_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate13_gpu0;
layer0_gate13_gpu0 -> layer0_expert13_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert13_fc1_gpu0;
layer0_expert13_fc1_gpu0 -> layer0_expert13_fc2_gpu0;
layer0_expert13_fc2_gpu0 -> layer0_expert13_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate14_gpu0;
layer0_gate14_gpu0 -> layer0_expert14_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert14_fc1_gpu0;
layer0_expert14_fc1_gpu0 -> layer0_expert14_fc2_gpu0;
layer0_expert14_fc2_gpu0 -> layer0_expert14_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate15_gpu0;
layer0_gate15_gpu0 -> layer0_expert15_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert15_fc1_gpu0;
layer0_expert15_fc1_gpu0 -> layer0_expert15_fc2_gpu0;
layer0_expert15_fc2_gpu0 -> layer0_expert15_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate16_gpu0;
layer0_gate16_gpu0 -> layer0_expert16_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert16_fc1_gpu0;
layer0_expert16_fc1_gpu0 -> layer0_expert16_fc2_gpu0;
layer0_expert16_fc2_gpu0 -> layer0_expert16_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate17_gpu0;
layer0_gate17_gpu0 -> layer0_expert17_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert17_fc1_gpu0;
layer0_expert17_fc1_gpu0 -> layer0_expert17_fc2_gpu0;
layer0_expert17_fc2_gpu0 -> layer0_expert17_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate18_gpu0;
layer0_gate18_gpu0 -> layer0_expert18_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert18_fc1_gpu0;
layer0_expert18_fc1_gpu0 -> layer0_expert18_fc2_gpu0;
layer0_expert18_fc2_gpu0 -> layer0_expert18_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate19_gpu0;
layer0_gate19_gpu0 -> layer0_expert19_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert19_fc1_gpu0;
layer0_expert19_fc1_gpu0 -> layer0_expert19_fc2_gpu0;
layer0_expert19_fc2_gpu0 -> layer0_expert19_add_gpu0;
layer0_ln1_gpu0 -> layer0_gate20_gpu0;
layer0_gate20_gpu0 -> layer0_expert20_fc1_gpu0 [style=dashed];
layer0_ln1_gpu0 -> layer0_expert20_fc1_gpu0;
layer0_expert20_fc1_gpu0 -> layer0_expert20_fc2_gpu0;
layer0_expert20_fc2_gpu0 -> layer0_expert20_add_gpu0;
layer0_expert20_add_gpu0 -> layer1_att_in_gpu0;
layer0_ln1_gpu1 -> layer0_gate0_gpu1;
layer0_gate0_gpu1 -> layer0_expert0_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert0_fc1_gpu1;
layer0_expert0_fc1_gpu1 -> layer0_expert0_fc2_gpu1;
layer0_expert0_fc2_gpu1 -> layer0_expert0_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate1_gpu1;
layer0_gate1_gpu1 -> layer0_expert1_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert1_fc1_gpu1;
layer0_expert1_fc1_gpu1 -> layer0_expert1_fc2_gpu1;
layer0_expert1_fc2_gpu1 -> layer0_expert1_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate2_gpu1;
layer0_gate2_gpu1 -> layer0_expert2_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert2_fc1_gpu1;
layer0_expert2_fc1_gpu1 -> layer0_expert2_fc2_gpu1;
layer0_expert2_fc2_gpu1 -> layer0_expert2_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate3_gpu1;
layer0_gate3_gpu1 -> layer0_expert3_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert3_fc1_gpu1;
layer0_expert3_fc1_gpu1 -> layer0_expert3_fc2_gpu1;
layer0_expert3_fc2_gpu1 -> layer0_expert3_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate4_gpu1;
layer0_gate4_gpu1 -> layer0_expert4_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert4_fc1_gpu1;
layer0_expert4_fc1_gpu1 -> layer0_expert4_fc2_gpu1;
layer0_expert4_fc2_gpu1 -> layer0_expert4_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate5_gpu1;
layer0_gate5_gpu1 -> layer0_expert5_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert5_fc1_gpu1;
layer0_expert5_fc1_gpu1 -> layer0_expert5_fc2_gpu1;
layer0_expert5_fc2_gpu1 -> layer0_expert5_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate6_gpu1;
layer0_gate6_gpu1 -> layer0_expert6_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert6_fc1_gpu1;
layer0_expert6_fc1_gpu1 -> layer0_expert6_fc2_gpu1;
layer0_expert6_fc2_gpu1 -> layer0_expert6_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate7_gpu1;
layer0_gate7_gpu1 -> layer0_expert7_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert7_fc1_gpu1;
layer0_expert7_fc1_gpu1 -> layer0_expert7_fc2_gpu1;
layer0_expert7_fc2_gpu1 -> layer0_expert7_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate8_gpu1;
layer0_gate8_gpu1 -> layer0_expert8_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert8_fc1_gpu1;
layer0_expert8_fc1_gpu1 -> layer0_expert8_fc2_gpu1;
layer0_expert8_fc2_gpu1 -> layer0_expert8_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate9_gpu1;
layer0_gate9_gpu1 -> layer0_expert9_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert9_fc1_gpu1;
layer0_expert9_fc1_gpu1 -> layer0_expert9_fc2_gpu1;
layer0_expert9_fc2_gpu1 -> layer0_expert9_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate10_gpu1;
layer0_gate10_gpu1 -> layer0_expert10_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert10_fc1_gpu1;
layer0_expert10_fc1_gpu1 -> layer0_expert10_fc2_gpu1;
layer0_expert10_fc2_gpu1 -> layer0_expert10_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate11_gpu1;
layer0_gate11_gpu1 -> layer0_expert11_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert11_fc1_gpu1;
layer0_expert11_fc1_gpu1 -> layer0_expert11_fc2_gpu1;
layer0_expert11_fc2_gpu1 -> layer0_expert11_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate12_gpu1;
layer0_gate12_gpu1 -> layer0_expert12_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert12_fc1_gpu1;
layer0_expert12_fc1_gpu1 -> layer0_expert12_fc2_gpu1;
layer0_expert12_fc2_gpu1 -> layer0_expert12_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate13_gpu1;
layer0_gate13_gpu1 -> layer0_expert13_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert13_fc1_gpu1;
layer0_expert13_fc1_gpu1 -> layer0_expert13_fc2_gpu1;
layer0_expert13_fc2_gpu1 -> layer0_expert13_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate14_gpu1;
layer0_gate14_gpu1 -> layer0_expert14_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert14_fc1_gpu1;
layer0_expert14_fc1_gpu1 -> layer0_expert14_fc2_gpu1;
layer0_expert14_fc2_gpu1 -> layer0_expert14_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate15_gpu1;
layer0_gate15_gpu1 -> layer0_expert15_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert15_fc1_gpu1;
layer0_expert15_fc1_gpu1 -> layer0_expert15_fc2_gpu1;
layer0_expert15_fc2_gpu1 -> layer0_expert15_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate16_gpu1;
layer0_gate16_gpu1 -> layer0_expert16_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert16_fc1_gpu1;
layer0_expert16_fc1_gpu1 -> layer0_expert16_fc2_gpu1;
layer0_expert16_fc2_gpu1 -> layer0_expert16_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate17_gpu1;
layer0_gate17_gpu1 -> layer0_expert17_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert17_fc1_gpu1;
layer0_expert17_fc1_gpu1 -> layer0_expert17_fc2_gpu1;
layer0_expert17_fc2_gpu1 -> layer0_expert17_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate18_gpu1;
layer0_gate18_gpu1 -> layer0_expert18_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert18_fc1_gpu1;
layer0_expert18_fc1_gpu1 -> layer0_expert18_fc2_gpu1;
layer0_expert18_fc2_gpu1 -> layer0_expert18_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate19_gpu1;
layer0_gate19_gpu1 -> layer0_expert19_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert19_fc1_gpu1;
layer0_expert19_fc1_gpu1 -> layer0_expert19_fc2_gpu1;
layer0_expert19_fc2_gpu1 -> layer0_expert19_add_gpu1;
layer0_ln1_gpu1 -> layer0_gate20_gpu1;
layer0_gate20_gpu1 -> layer0_expert20_fc1_gpu1 [style=dashed];
layer0_ln1_gpu1 -> layer0_expert20_fc1_gpu1;
layer0_expert20_fc1_gpu1 -> layer0_expert20_fc2_gpu1;
layer0_expert20_fc2_gpu1 -> layer0_expert20_add_gpu1;
layer0_expert20_add_gpu1 -> layer1_att_in_gpu1;
layer0_ln1_gpu2 -> layer0_gate0_gpu2;
layer0_gate0_gpu2 -> layer0_expert0_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert0_fc1_gpu2;
layer0_expert0_fc1_gpu2 -> layer0_expert0_fc2_gpu2;
layer0_expert0_fc2_gpu2 -> layer0_expert0_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate1_gpu2;
layer0_gate1_gpu2 -> layer0_expert1_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert1_fc1_gpu2;
layer0_expert1_fc1_gpu2 -> layer0_expert1_fc2_gpu2;
layer0_expert1_fc2_gpu2 -> layer0_expert1_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate2_gpu2;
layer0_gate2_gpu2 -> layer0_expert2_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert2_fc1_gpu2;
layer0_expert2_fc1_gpu2 -> layer0_expert2_fc2_gpu2;
layer0_expert2_fc2_gpu2 -> layer0_expert2_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate3_gpu2;
layer0_gate3_gpu2 -> layer0_expert3_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert3_fc1_gpu2;
layer0_expert3_fc1_gpu2 -> layer0_expert3_fc2_gpu2;
layer0_expert3_fc2_gpu2 -> layer0_expert3_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate4_gpu2;
layer0_gate4_gpu2 -> layer0_expert4_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert4_fc1_gpu2;
layer0_expert4_fc1_gpu2 -> layer0_expert4_fc2_gpu2;
layer0_expert4_fc2_gpu2 -> layer0_expert4_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate5_gpu2;
layer0_gate5_gpu2 -> layer0_expert5_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert5_fc1_gpu2;
layer0_expert5_fc1_gpu2 -> layer0_expert5_fc2_gpu2;
layer0_expert5_fc2_gpu2 -> layer0_expert5_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate6_gpu2;
layer0_gate6_gpu2 -> layer0_expert6_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert6_fc1_gpu2;
layer0_expert6_fc1_gpu2 -> layer0_expert6_fc2_gpu2;
layer0_expert6_fc2_gpu2 -> layer0_expert6_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate7_gpu2;
layer0_gate7_gpu2 -> layer0_expert7_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert7_fc1_gpu2;
layer0_expert7_fc1_gpu2 -> layer0_expert7_fc2_gpu2;
layer0_expert7_fc2_gpu2 -> layer0_expert7_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate8_gpu2;
layer0_gate8_gpu2 -> layer0_expert8_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert8_fc1_gpu2;
layer0_expert8_fc1_gpu2 -> layer0_expert8_fc2_gpu2;
layer0_expert8_fc2_gpu2 -> layer0_expert8_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate9_gpu2;
layer0_gate9_gpu2 -> layer0_expert9_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert9_fc1_gpu2;
layer0_expert9_fc1_gpu2 -> layer0_expert9_fc2_gpu2;
layer0_expert9_fc2_gpu2 -> layer0_expert9_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate10_gpu2;
layer0_gate10_gpu2 -> layer0_expert10_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert10_fc1_gpu2;
layer0_expert10_fc1_gpu2 -> layer0_expert10_fc2_gpu2;
layer0_expert10_fc2_gpu2 -> layer0_expert10_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate11_gpu2;
layer0_gate11_gpu2 -> layer0_expert11_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert11_fc1_gpu2;
layer0_expert11_fc1_gpu2 -> layer0_expert11_fc2_gpu2;
layer0_expert11_fc2_gpu2 -> layer0_expert11_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate12_gpu2;
layer0_gate12_gpu2 -> layer0_expert12_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert12_fc1_gpu2;
layer0_expert12_fc1_gpu2 -> layer0_expert12_fc2_gpu2;
layer0_expert12_fc2_gpu2 -> layer0_expert12_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate13_gpu2;
layer0_gate13_gpu2 -> layer0_expert13_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert13_fc1_gpu2;
layer0_expert13_fc1_gpu2 -> layer0_expert13_fc2_gpu2;
layer0_expert13_fc2_gpu2 -> layer0_expert13_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate14_gpu2;
layer0_gate14_gpu2 -> layer0_expert14_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert14_fc1_gpu2;
layer0_expert14_fc1_gpu2 -> layer0_expert14_fc2_gpu2;
layer0_expert14_fc2_gpu2 -> layer0_expert14_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate15_gpu2;
layer0_gate15_gpu2 -> layer0_expert15_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert15_fc1_gpu2;
layer0_expert15_fc1_gpu2 -> layer0_expert15_fc2_gpu2;
layer0_expert15_fc2_gpu2 -> layer0_expert15_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate16_gpu2;
layer0_gate16_gpu2 -> layer0_expert16_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert16_fc1_gpu2;
layer0_expert16_fc1_gpu2 -> layer0_expert16_fc2_gpu2;
layer0_expert16_fc2_gpu2 -> layer0_expert16_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate17_gpu2;
layer0_gate17_gpu2 -> layer0_expert17_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert17_fc1_gpu2;
layer0_expert17_fc1_gpu2 -> layer0_expert17_fc2_gpu2;
layer0_expert17_fc2_gpu2 -> layer0_expert17_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate18_gpu2;
layer0_gate18_gpu2 -> layer0_expert18_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert18_fc1_gpu2;
layer0_expert18_fc1_gpu2 -> layer0_expert18_fc2_gpu2;
layer0_expert18_fc2_gpu2 -> layer0_expert18_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate19_gpu2;
layer0_gate19_gpu2 -> layer0_expert19_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert19_fc1_gpu2;
layer0_expert19_fc1_gpu2 -> layer0_expert19_fc2_gpu2;
layer0_expert19_fc2_gpu2 -> layer0_expert19_add_gpu2;
layer0_ln1_gpu2 -> layer0_gate20_gpu2;
layer0_gate20_gpu2 -> layer0_expert20_fc1_gpu2 [style=dashed];
layer0_ln1_gpu2 -> layer0_expert20_fc1_gpu2;
layer0_expert20_fc1_gpu2 -> layer0_expert20_fc2_gpu2;
layer0_expert20_fc2_gpu2 -> layer0_expert20_add_gpu2;
layer0_expert20_add_gpu2 -> layer1_att_in_gpu2;
input -> layer1_att_in_gpu0;
layer1_att_in_gpu0 -> layer1_qkv0_gpu0;
layer1_att_in_gpu0 -> layer1_qkv1_gpu0;
layer1_qkv0_gpu0 -> layer1_attout0_gpu0;
layer1_qkv1_gpu0 -> layer1_attout1_gpu0;
layer1_attout0_gpu0 -> layer1_att_agg_gpu0;
layer1_attout1_gpu0 -> layer1_att_agg_gpu0;
layer1_att_agg_gpu0 -> layer1_res1_gpu0;
layer1_res1_gpu0 -> layer1_ln1_gpu0;
input -> layer1_att_in_gpu1;
layer1_att_in_gpu1 -> layer1_qkv0_gpu1;
layer1_att_in_gpu1 -> layer1_qkv1_gpu1;
layer1_qkv0_gpu1 -> layer1_attout0_gpu1;
layer1_qkv1_gpu1 -> layer1_attout1_gpu1;
layer1_attout0_gpu1 -> layer1_att_agg_gpu1;
layer1_attout1_gpu1 -> layer1_att_agg_gpu1;
layer1_att_agg_gpu1 -> layer1_res1_gpu1;
layer1_res1_gpu1 -> layer1_ln1_gpu1;
input -> layer1_att_in_gpu2;
layer1_att_in_gpu2 -> layer1_qkv0_gpu2;
layer1_att_in_gpu2 -> layer1_qkv1_gpu2;
layer1_qkv0_gpu2 -> layer1_attout0_gpu2;
layer1_qkv1_gpu2 -> layer1_attout1_gpu2;
layer1_attout0_gpu2 -> layer1_att_agg_gpu2;
layer1_attout1_gpu2 -> layer1_att_agg_gpu2;
layer1_att_agg_gpu2 -> layer1_res1_gpu2;
layer1_res1_gpu2 -> layer1_ln1_gpu2;
layer1_ln1_gpu0 -> layer1_gate0_gpu0;
layer1_gate0_gpu0 -> layer1_expert0_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert0_fc1_gpu0;
layer1_expert0_fc1_gpu0 -> layer1_expert0_fc2_gpu0;
layer1_expert0_fc2_gpu0 -> layer1_expert0_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate1_gpu0;
layer1_gate1_gpu0 -> layer1_expert1_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert1_fc1_gpu0;
layer1_expert1_fc1_gpu0 -> layer1_expert1_fc2_gpu0;
layer1_expert1_fc2_gpu0 -> layer1_expert1_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate2_gpu0;
layer1_gate2_gpu0 -> layer1_expert2_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert2_fc1_gpu0;
layer1_expert2_fc1_gpu0 -> layer1_expert2_fc2_gpu0;
layer1_expert2_fc2_gpu0 -> layer1_expert2_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate3_gpu0;
layer1_gate3_gpu0 -> layer1_expert3_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert3_fc1_gpu0;
layer1_expert3_fc1_gpu0 -> layer1_expert3_fc2_gpu0;
layer1_expert3_fc2_gpu0 -> layer1_expert3_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate4_gpu0;
layer1_gate4_gpu0 -> layer1_expert4_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert4_fc1_gpu0;
layer1_expert4_fc1_gpu0 -> layer1_expert4_fc2_gpu0;
layer1_expert4_fc2_gpu0 -> layer1_expert4_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate5_gpu0;
layer1_gate5_gpu0 -> layer1_expert5_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert5_fc1_gpu0;
layer1_expert5_fc1_gpu0 -> layer1_expert5_fc2_gpu0;
layer1_expert5_fc2_gpu0 -> layer1_expert5_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate6_gpu0;
layer1_gate6_gpu0 -> layer1_expert6_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert6_fc1_gpu0;
layer1_expert6_fc1_gpu0 -> layer1_expert6_fc2_gpu0;
layer1_expert6_fc2_gpu0 -> layer1_expert6_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate7_gpu0;
layer1_gate7_gpu0 -> layer1_expert7_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert7_fc1_gpu0;
layer1_expert7_fc1_gpu0 -> layer1_expert7_fc2_gpu0;
layer1_expert7_fc2_gpu0 -> layer1_expert7_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate8_gpu0;
layer1_gate8_gpu0 -> layer1_expert8_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert8_fc1_gpu0;
layer1_expert8_fc1_gpu0 -> layer1_expert8_fc2_gpu0;
layer1_expert8_fc2_gpu0 -> layer1_expert8_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate9_gpu0;
layer1_gate9_gpu0 -> layer1_expert9_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert9_fc1_gpu0;
layer1_expert9_fc1_gpu0 -> layer1_expert9_fc2_gpu0;
layer1_expert9_fc2_gpu0 -> layer1_expert9_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate10_gpu0;
layer1_gate10_gpu0 -> layer1_expert10_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert10_fc1_gpu0;
layer1_expert10_fc1_gpu0 -> layer1_expert10_fc2_gpu0;
layer1_expert10_fc2_gpu0 -> layer1_expert10_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate11_gpu0;
layer1_gate11_gpu0 -> layer1_expert11_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert11_fc1_gpu0;
layer1_expert11_fc1_gpu0 -> layer1_expert11_fc2_gpu0;
layer1_expert11_fc2_gpu0 -> layer1_expert11_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate12_gpu0;
layer1_gate12_gpu0 -> layer1_expert12_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert12_fc1_gpu0;
layer1_expert12_fc1_gpu0 -> layer1_expert12_fc2_gpu0;
layer1_expert12_fc2_gpu0 -> layer1_expert12_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate13_gpu0;
layer1_gate13_gpu0 -> layer1_expert13_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert13_fc1_gpu0;
layer1_expert13_fc1_gpu0 -> layer1_expert13_fc2_gpu0;
layer1_expert13_fc2_gpu0 -> layer1_expert13_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate14_gpu0;
layer1_gate14_gpu0 -> layer1_expert14_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert14_fc1_gpu0;
layer1_expert14_fc1_gpu0 -> layer1_expert14_fc2_gpu0;
layer1_expert14_fc2_gpu0 -> layer1_expert14_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate15_gpu0;
layer1_gate15_gpu0 -> layer1_expert15_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert15_fc1_gpu0;
layer1_expert15_fc1_gpu0 -> layer1_expert15_fc2_gpu0;
layer1_expert15_fc2_gpu0 -> layer1_expert15_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate16_gpu0;
layer1_gate16_gpu0 -> layer1_expert16_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert16_fc1_gpu0;
layer1_expert16_fc1_gpu0 -> layer1_expert16_fc2_gpu0;
layer1_expert16_fc2_gpu0 -> layer1_expert16_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate17_gpu0;
layer1_gate17_gpu0 -> layer1_expert17_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert17_fc1_gpu0;
layer1_expert17_fc1_gpu0 -> layer1_expert17_fc2_gpu0;
layer1_expert17_fc2_gpu0 -> layer1_expert17_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate18_gpu0;
layer1_gate18_gpu0 -> layer1_expert18_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert18_fc1_gpu0;
layer1_expert18_fc1_gpu0 -> layer1_expert18_fc2_gpu0;
layer1_expert18_fc2_gpu0 -> layer1_expert18_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate19_gpu0;
layer1_gate19_gpu0 -> layer1_expert19_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert19_fc1_gpu0;
layer1_expert19_fc1_gpu0 -> layer1_expert19_fc2_gpu0;
layer1_expert19_fc2_gpu0 -> layer1_expert19_add_gpu0;
layer1_ln1_gpu0 -> layer1_gate20_gpu0;
layer1_gate20_gpu0 -> layer1_expert20_fc1_gpu0 [style=dashed];
layer1_ln1_gpu0 -> layer1_expert20_fc1_gpu0;
layer1_expert20_fc1_gpu0 -> layer1_expert20_fc2_gpu0;
layer1_expert20_fc2_gpu0 -> layer1_expert20_add_gpu0;
layer1_expert20_add_gpu0 -> layer2_att_in_gpu0;
layer1_ln1_gpu1 -> layer1_gate0_gpu1;
layer1_gate0_gpu1 -> layer1_expert0_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert0_fc1_gpu1;
layer1_expert0_fc1_gpu1 -> layer1_expert0_fc2_gpu1;
layer1_expert0_fc2_gpu1 -> layer1_expert0_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate1_gpu1;
layer1_gate1_gpu1 -> layer1_expert1_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert1_fc1_gpu1;
layer1_expert1_fc1_gpu1 -> layer1_expert1_fc2_gpu1;
layer1_expert1_fc2_gpu1 -> layer1_expert1_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate2_gpu1;
layer1_gate2_gpu1 -> layer1_expert2_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert2_fc1_gpu1;
layer1_expert2_fc1_gpu1 -> layer1_expert2_fc2_gpu1;
layer1_expert2_fc2_gpu1 -> layer1_expert2_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate3_gpu1;
layer1_gate3_gpu1 -> layer1_expert3_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert3_fc1_gpu1;
layer1_expert3_fc1_gpu1 -> layer1_expert3_fc2_gpu1;
layer1_expert3_fc2_gpu1 -> layer1_expert3_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate4_gpu1;
layer1_gate4_gpu1 -> layer1_expert4_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert4_fc1_gpu1;
layer1_expert4_fc1_gpu1 -> layer1_expert4_fc2_gpu1;
layer1_expert4_fc2_gpu1 -> layer1_expert4_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate5_gpu1;
layer1_gate5_gpu1 -> layer1_expert5_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert5_fc1_gpu1;
layer1_expert5_fc1_gpu1 -> layer1_expert5_fc2_gpu1;
layer1_expert5_fc2_gpu1 -> layer1_expert5_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate6_gpu1;
layer1_gate6_gpu1 -> layer1_expert6_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert6_fc1_gpu1;
layer1_expert6_fc1_gpu1 -> layer1_expert6_fc2_gpu1;
layer1_expert6_fc2_gpu1 -> layer1_expert6_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate7_gpu1;
layer1_gate7_gpu1 -> layer1_expert7_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert7_fc1_gpu1;
layer1_expert7_fc1_gpu1 -> layer1_expert7_fc2_gpu1;
layer1_expert7_fc2_gpu1 -> layer1_expert7_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate8_gpu1;
layer1_gate8_gpu1 -> layer1_expert8_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert8_fc1_gpu1;
layer1_expert8_fc1_gpu1 -> layer1_expert8_fc2_gpu1;
layer1_expert8_fc2_gpu1 -> layer1_expert8_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate9_gpu1;
layer1_gate9_gpu1 -> layer1_expert9_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert9_fc1_gpu1;
layer1_expert9_fc1_gpu1 -> layer1_expert9_fc2_gpu1;
layer1_expert9_fc2_gpu1 -> layer1_expert9_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate10_gpu1;
layer1_gate10_gpu1 -> layer1_expert10_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert10_fc1_gpu1;
layer1_expert10_fc1_gpu1 -> layer1_expert10_fc2_gpu1;
layer1_expert10_fc2_gpu1 -> layer1_expert10_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate11_gpu1;
layer1_gate11_gpu1 -> layer1_expert11_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert11_fc1_gpu1;
layer1_expert11_fc1_gpu1 -> layer1_expert11_fc2_gpu1;
layer1_expert11_fc2_gpu1 -> layer1_expert11_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate12_gpu1;
layer1_gate12_gpu1 -> layer1_expert12_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert12_fc1_gpu1;
layer1_expert12_fc1_gpu1 -> layer1_expert12_fc2_gpu1;
layer1_expert12_fc2_gpu1 -> layer1_expert12_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate13_gpu1;
layer1_gate13_gpu1 -> layer1_expert13_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert13_fc1_gpu1;
layer1_expert13_fc1_gpu1 -> layer1_expert13_fc2_gpu1;
layer1_expert13_fc2_gpu1 -> layer1_expert13_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate14_gpu1;
layer1_gate14_gpu1 -> layer1_expert14_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert14_fc1_gpu1;
layer1_expert14_fc1_gpu1 -> layer1_expert14_fc2_gpu1;
layer1_expert14_fc2_gpu1 -> layer1_expert14_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate15_gpu1;
layer1_gate15_gpu1 -> layer1_expert15_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert15_fc1_gpu1;
layer1_expert15_fc1_gpu1 -> layer1_expert15_fc2_gpu1;
layer1_expert15_fc2_gpu1 -> layer1_expert15_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate16_gpu1;
layer1_gate16_gpu1 -> layer1_expert16_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert16_fc1_gpu1;
layer1_expert16_fc1_gpu1 -> layer1_expert16_fc2_gpu1;
layer1_expert16_fc2_gpu1 -> layer1_expert16_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate17_gpu1;
layer1_gate17_gpu1 -> layer1_expert17_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert17_fc1_gpu1;
layer1_expert17_fc1_gpu1 -> layer1_expert17_fc2_gpu1;
layer1_expert17_fc2_gpu1 -> layer1_expert17_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate18_gpu1;
layer1_gate18_gpu1 -> layer1_expert18_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert18_fc1_gpu1;
layer1_expert18_fc1_gpu1 -> layer1_expert18_fc2_gpu1;
layer1_expert18_fc2_gpu1 -> layer1_expert18_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate19_gpu1;
layer1_gate19_gpu1 -> layer1_expert19_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert19_fc1_gpu1;
layer1_expert19_fc1_gpu1 -> layer1_expert19_fc2_gpu1;
layer1_expert19_fc2_gpu1 -> layer1_expert19_add_gpu1;
layer1_ln1_gpu1 -> layer1_gate20_gpu1;
layer1_gate20_gpu1 -> layer1_expert20_fc1_gpu1 [style=dashed];
layer1_ln1_gpu1 -> layer1_expert20_fc1_gpu1;
layer1_expert20_fc1_gpu1 -> layer1_expert20_fc2_gpu1;
layer1_expert20_fc2_gpu1 -> layer1_expert20_add_gpu1;
layer1_expert20_add_gpu1 -> layer2_att_in_gpu1;
layer1_ln1_gpu2 -> layer1_gate0_gpu2;
layer1_gate0_gpu2 -> layer1_expert0_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert0_fc1_gpu2;
layer1_expert0_fc1_gpu2 -> layer1_expert0_fc2_gpu2;
layer1_expert0_fc2_gpu2 -> layer1_expert0_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate1_gpu2;
layer1_gate1_gpu2 -> layer1_expert1_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert1_fc1_gpu2;
layer1_expert1_fc1_gpu2 -> layer1_expert1_fc2_gpu2;
layer1_expert1_fc2_gpu2 -> layer1_expert1_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate2_gpu2;
layer1_gate2_gpu2 -> layer1_expert2_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert2_fc1_gpu2;
layer1_expert2_fc1_gpu2 -> layer1_expert2_fc2_gpu2;
layer1_expert2_fc2_gpu2 -> layer1_expert2_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate3_gpu2;
layer1_gate3_gpu2 -> layer1_expert3_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert3_fc1_gpu2;
layer1_expert3_fc1_gpu2 -> layer1_expert3_fc2_gpu2;
layer1_expert3_fc2_gpu2 -> layer1_expert3_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate4_gpu2;
layer1_gate4_gpu2 -> layer1_expert4_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert4_fc1_gpu2;
layer1_expert4_fc1_gpu2 -> layer1_expert4_fc2_gpu2;
layer1_expert4_fc2_gpu2 -> layer1_expert4_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate5_gpu2;
layer1_gate5_gpu2 -> layer1_expert5_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert5_fc1_gpu2;
layer1_expert5_fc1_gpu2 -> layer1_expert5_fc2_gpu2;
layer1_expert5_fc2_gpu2 -> layer1_expert5_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate6_gpu2;
layer1_gate6_gpu2 -> layer1_expert6_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert6_fc1_gpu2;
layer1_expert6_fc1_gpu2 -> layer1_expert6_fc2_gpu2;
layer1_expert6_fc2_gpu2 -> layer1_expert6_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate7_gpu2;
layer1_gate7_gpu2 -> layer1_expert7_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert7_fc1_gpu2;
layer1_expert7_fc1_gpu2 -> layer1_expert7_fc2_gpu2;
layer1_expert7_fc2_gpu2 -> layer1_expert7_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate8_gpu2;
layer1_gate8_gpu2 -> layer1_expert8_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert8_fc1_gpu2;
layer1_expert8_fc1_gpu2 -> layer1_expert8_fc2_gpu2;
layer1_expert8_fc2_gpu2 -> layer1_expert8_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate9_gpu2;
layer1_gate9_gpu2 -> layer1_expert9_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert9_fc1_gpu2;
layer1_expert9_fc1_gpu2 -> layer1_expert9_fc2_gpu2;
layer1_expert9_fc2_gpu2 -> layer1_expert9_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate10_gpu2;
layer1_gate10_gpu2 -> layer1_expert10_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert10_fc1_gpu2;
layer1_expert10_fc1_gpu2 -> layer1_expert10_fc2_gpu2;
layer1_expert10_fc2_gpu2 -> layer1_expert10_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate11_gpu2;
layer1_gate11_gpu2 -> layer1_expert11_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert11_fc1_gpu2;
layer1_expert11_fc1_gpu2 -> layer1_expert11_fc2_gpu2;
layer1_expert11_fc2_gpu2 -> layer1_expert11_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate12_gpu2;
layer1_gate12_gpu2 -> layer1_expert12_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert12_fc1_gpu2;
layer1_expert12_fc1_gpu2 -> layer1_expert12_fc2_gpu2;
layer1_expert12_fc2_gpu2 -> layer1_expert12_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate13_gpu2;
layer1_gate13_gpu2 -> layer1_expert13_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert13_fc1_gpu2;
layer1_expert13_fc1_gpu2 -> layer1_expert13_fc2_gpu2;
layer1_expert13_fc2_gpu2 -> layer1_expert13_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate14_gpu2;
layer1_gate14_gpu2 -> layer1_expert14_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert14_fc1_gpu2;
layer1_expert14_fc1_gpu2 -> layer1_expert14_fc2_gpu2;
layer1_expert14_fc2_gpu2 -> layer1_expert14_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate15_gpu2;
layer1_gate15_gpu2 -> layer1_expert15_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert15_fc1_gpu2;
layer1_expert15_fc1_gpu2 -> layer1_expert15_fc2_gpu2;
layer1_expert15_fc2_gpu2 -> layer1_expert15_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate16_gpu2;
layer1_gate16_gpu2 -> layer1_expert16_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert16_fc1_gpu2;
layer1_expert16_fc1_gpu2 -> layer1_expert16_fc2_gpu2;
layer1_expert16_fc2_gpu2 -> layer1_expert16_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate17_gpu2;
layer1_gate17_gpu2 -> layer1_expert17_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert17_fc1_gpu2;
layer1_expert17_fc1_gpu2 -> layer1_expert17_fc2_gpu2;
layer1_expert17_fc2_gpu2 -> layer1_expert17_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate18_gpu2;
layer1_gate18_gpu2 -> layer1_expert18_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert18_fc1_gpu2;
layer1_expert18_fc1_gpu2 -> layer1_expert18_fc2_gpu2;
layer1_expert18_fc2_gpu2 -> layer1_expert18_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate19_gpu2;
layer1_gate19_gpu2 -> layer1_expert19_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert19_fc1_gpu2;
layer1_expert19_fc1_gpu2 -> layer1_expert19_fc2_gpu2;
layer1_expert19_fc2_gpu2 -> layer1_expert19_add_gpu2;
layer1_ln1_gpu2 -> layer1_gate20_gpu2;
layer1_gate20_gpu2 -> layer1_expert20_fc1_gpu2 [style=dashed];
layer1_ln1_gpu2 -> layer1_expert20_fc1_gpu2;
layer1_expert20_fc1_gpu2 -> layer1_expert20_fc2_gpu2;
layer1_expert20_fc2_gpu2 -> layer1_expert20_add_gpu2;
layer1_expert20_add_gpu2 -> layer2_att_in_gpu2;
input -> layer2_att_in_gpu0;
layer2_att_in_gpu0 -> layer2_qkv0_gpu0;
layer2_att_in_gpu0 -> layer2_qkv1_gpu0;
layer2_qkv0_gpu0 -> layer2_attout0_gpu0;
layer2_qkv1_gpu0 -> layer2_attout1_gpu0;
layer2_attout0_gpu0 -> layer2_att_agg_gpu0;
layer2_attout1_gpu0 -> layer2_att_agg_gpu0;
layer2_att_agg_gpu0 -> layer2_res1_gpu0;
layer2_res1_gpu0 -> layer2_ln1_gpu0;
input -> layer2_att_in_gpu1;
layer2_att_in_gpu1 -> layer2_qkv0_gpu1;
layer2_att_in_gpu1 -> layer2_qkv1_gpu1;
layer2_qkv0_gpu1 -> layer2_attout0_gpu1;
layer2_qkv1_gpu1 -> layer2_attout1_gpu1;
layer2_attout0_gpu1 -> layer2_att_agg_gpu1;
layer2_attout1_gpu1 -> layer2_att_agg_gpu1;
layer2_att_agg_gpu1 -> layer2_res1_gpu1;
layer2_res1_gpu1 -> layer2_ln1_gpu1;
input -> layer2_att_in_gpu2;
layer2_att_in_gpu2 -> layer2_qkv0_gpu2;
layer2_att_in_gpu2 -> layer2_qkv1_gpu2;
layer2_qkv0_gpu2 -> layer2_attout0_gpu2;
layer2_qkv1_gpu2 -> layer2_attout1_gpu2;
layer2_attout0_gpu2 -> layer2_att_agg_gpu2;
layer2_attout1_gpu2 -> layer2_att_agg_gpu2;
layer2_att_agg_gpu2 -> layer2_res1_gpu2;
layer2_res1_gpu2 -> layer2_ln1_gpu2;
layer2_ln1_gpu0 -> layer2_gate0_gpu0;
layer2_gate0_gpu0 -> layer2_expert0_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert0_fc1_gpu0;
layer2_expert0_fc1_gpu0 -> layer2_expert0_fc2_gpu0;
layer2_expert0_fc2_gpu0 -> layer2_expert0_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate1_gpu0;
layer2_gate1_gpu0 -> layer2_expert1_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert1_fc1_gpu0;
layer2_expert1_fc1_gpu0 -> layer2_expert1_fc2_gpu0;
layer2_expert1_fc2_gpu0 -> layer2_expert1_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate2_gpu0;
layer2_gate2_gpu0 -> layer2_expert2_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert2_fc1_gpu0;
layer2_expert2_fc1_gpu0 -> layer2_expert2_fc2_gpu0;
layer2_expert2_fc2_gpu0 -> layer2_expert2_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate3_gpu0;
layer2_gate3_gpu0 -> layer2_expert3_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert3_fc1_gpu0;
layer2_expert3_fc1_gpu0 -> layer2_expert3_fc2_gpu0;
layer2_expert3_fc2_gpu0 -> layer2_expert3_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate4_gpu0;
layer2_gate4_gpu0 -> layer2_expert4_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert4_fc1_gpu0;
layer2_expert4_fc1_gpu0 -> layer2_expert4_fc2_gpu0;
layer2_expert4_fc2_gpu0 -> layer2_expert4_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate5_gpu0;
layer2_gate5_gpu0 -> layer2_expert5_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert5_fc1_gpu0;
layer2_expert5_fc1_gpu0 -> layer2_expert5_fc2_gpu0;
layer2_expert5_fc2_gpu0 -> layer2_expert5_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate6_gpu0;
layer2_gate6_gpu0 -> layer2_expert6_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert6_fc1_gpu0;
layer2_expert6_fc1_gpu0 -> layer2_expert6_fc2_gpu0;
layer2_expert6_fc2_gpu0 -> layer2_expert6_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate7_gpu0;
layer2_gate7_gpu0 -> layer2_expert7_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert7_fc1_gpu0;
layer2_expert7_fc1_gpu0 -> layer2_expert7_fc2_gpu0;
layer2_expert7_fc2_gpu0 -> layer2_expert7_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate8_gpu0;
layer2_gate8_gpu0 -> layer2_expert8_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert8_fc1_gpu0;
layer2_expert8_fc1_gpu0 -> layer2_expert8_fc2_gpu0;
layer2_expert8_fc2_gpu0 -> layer2_expert8_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate9_gpu0;
layer2_gate9_gpu0 -> layer2_expert9_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert9_fc1_gpu0;
layer2_expert9_fc1_gpu0 -> layer2_expert9_fc2_gpu0;
layer2_expert9_fc2_gpu0 -> layer2_expert9_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate10_gpu0;
layer2_gate10_gpu0 -> layer2_expert10_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert10_fc1_gpu0;
layer2_expert10_fc1_gpu0 -> layer2_expert10_fc2_gpu0;
layer2_expert10_fc2_gpu0 -> layer2_expert10_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate11_gpu0;
layer2_gate11_gpu0 -> layer2_expert11_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert11_fc1_gpu0;
layer2_expert11_fc1_gpu0 -> layer2_expert11_fc2_gpu0;
layer2_expert11_fc2_gpu0 -> layer2_expert11_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate12_gpu0;
layer2_gate12_gpu0 -> layer2_expert12_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert12_fc1_gpu0;
layer2_expert12_fc1_gpu0 -> layer2_expert12_fc2_gpu0;
layer2_expert12_fc2_gpu0 -> layer2_expert12_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate13_gpu0;
layer2_gate13_gpu0 -> layer2_expert13_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert13_fc1_gpu0;
layer2_expert13_fc1_gpu0 -> layer2_expert13_fc2_gpu0;
layer2_expert13_fc2_gpu0 -> layer2_expert13_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate14_gpu0;
layer2_gate14_gpu0 -> layer2_expert14_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert14_fc1_gpu0;
layer2_expert14_fc1_gpu0 -> layer2_expert14_fc2_gpu0;
layer2_expert14_fc2_gpu0 -> layer2_expert14_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate15_gpu0;
layer2_gate15_gpu0 -> layer2_expert15_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert15_fc1_gpu0;
layer2_expert15_fc1_gpu0 -> layer2_expert15_fc2_gpu0;
layer2_expert15_fc2_gpu0 -> layer2_expert15_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate16_gpu0;
layer2_gate16_gpu0 -> layer2_expert16_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert16_fc1_gpu0;
layer2_expert16_fc1_gpu0 -> layer2_expert16_fc2_gpu0;
layer2_expert16_fc2_gpu0 -> layer2_expert16_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate17_gpu0;
layer2_gate17_gpu0 -> layer2_expert17_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert17_fc1_gpu0;
layer2_expert17_fc1_gpu0 -> layer2_expert17_fc2_gpu0;
layer2_expert17_fc2_gpu0 -> layer2_expert17_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate18_gpu0;
layer2_gate18_gpu0 -> layer2_expert18_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert18_fc1_gpu0;
layer2_expert18_fc1_gpu0 -> layer2_expert18_fc2_gpu0;
layer2_expert18_fc2_gpu0 -> layer2_expert18_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate19_gpu0;
layer2_gate19_gpu0 -> layer2_expert19_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert19_fc1_gpu0;
layer2_expert19_fc1_gpu0 -> layer2_expert19_fc2_gpu0;
layer2_expert19_fc2_gpu0 -> layer2_expert19_add_gpu0;
layer2_ln1_gpu0 -> layer2_gate20_gpu0;
layer2_gate20_gpu0 -> layer2_expert20_fc1_gpu0 [style=dashed];
layer2_ln1_gpu0 -> layer2_expert20_fc1_gpu0;
layer2_expert20_fc1_gpu0 -> layer2_expert20_fc2_gpu0;
layer2_expert20_fc2_gpu0 -> layer2_expert20_add_gpu0;
layer2_expert20_add_gpu0 -> layer3_att_in_gpu0;
layer2_ln1_gpu1 -> layer2_gate0_gpu1;
layer2_gate0_gpu1 -> layer2_expert0_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert0_fc1_gpu1;
layer2_expert0_fc1_gpu1 -> layer2_expert0_fc2_gpu1;
layer2_expert0_fc2_gpu1 -> layer2_expert0_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate1_gpu1;
layer2_gate1_gpu1 -> layer2_expert1_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert1_fc1_gpu1;
layer2_expert1_fc1_gpu1 -> layer2_expert1_fc2_gpu1;
layer2_expert1_fc2_gpu1 -> layer2_expert1_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate2_gpu1;
layer2_gate2_gpu1 -> layer2_expert2_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert2_fc1_gpu1;
layer2_expert2_fc1_gpu1 -> layer2_expert2_fc2_gpu1;
layer2_expert2_fc2_gpu1 -> layer2_expert2_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate3_gpu1;
layer2_gate3_gpu1 -> layer2_expert3_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert3_fc1_gpu1;
layer2_expert3_fc1_gpu1 -> layer2_expert3_fc2_gpu1;
layer2_expert3_fc2_gpu1 -> layer2_expert3_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate4_gpu1;
layer2_gate4_gpu1 -> layer2_expert4_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert4_fc1_gpu1;
layer2_expert4_fc1_gpu1 -> layer2_expert4_fc2_gpu1;
layer2_expert4_fc2_gpu1 -> layer2_expert4_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate5_gpu1;
layer2_gate5_gpu1 -> layer2_expert5_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert5_fc1_gpu1;
layer2_expert5_fc1_gpu1 -> layer2_expert5_fc2_gpu1;
layer2_expert5_fc2_gpu1 -> layer2_expert5_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate6_gpu1;
layer2_gate6_gpu1 -> layer2_expert6_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert6_fc1_gpu1;
layer2_expert6_fc1_gpu1 -> layer2_expert6_fc2_gpu1;
layer2_expert6_fc2_gpu1 -> layer2_expert6_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate7_gpu1;
layer2_gate7_gpu1 -> layer2_expert7_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert7_fc1_gpu1;
layer2_expert7_fc1_gpu1 -> layer2_expert7_fc2_gpu1;
layer2_expert7_fc2_gpu1 -> layer2_expert7_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate8_gpu1;
layer2_gate8_gpu1 -> layer2_expert8_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert8_fc1_gpu1;
layer2_expert8_fc1_gpu1 -> layer2_expert8_fc2_gpu1;
layer2_expert8_fc2_gpu1 -> layer2_expert8_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate9_gpu1;
layer2_gate9_gpu1 -> layer2_expert9_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert9_fc1_gpu1;
layer2_expert9_fc1_gpu1 -> layer2_expert9_fc2_gpu1;
layer2_expert9_fc2_gpu1 -> layer2_expert9_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate10_gpu1;
layer2_gate10_gpu1 -> layer2_expert10_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert10_fc1_gpu1;
layer2_expert10_fc1_gpu1 -> layer2_expert10_fc2_gpu1;
layer2_expert10_fc2_gpu1 -> layer2_expert10_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate11_gpu1;
layer2_gate11_gpu1 -> layer2_expert11_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert11_fc1_gpu1;
layer2_expert11_fc1_gpu1 -> layer2_expert11_fc2_gpu1;
layer2_expert11_fc2_gpu1 -> layer2_expert11_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate12_gpu1;
layer2_gate12_gpu1 -> layer2_expert12_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert12_fc1_gpu1;
layer2_expert12_fc1_gpu1 -> layer2_expert12_fc2_gpu1;
layer2_expert12_fc2_gpu1 -> layer2_expert12_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate13_gpu1;
layer2_gate13_gpu1 -> layer2_expert13_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert13_fc1_gpu1;
layer2_expert13_fc1_gpu1 -> layer2_expert13_fc2_gpu1;
layer2_expert13_fc2_gpu1 -> layer2_expert13_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate14_gpu1;
layer2_gate14_gpu1 -> layer2_expert14_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert14_fc1_gpu1;
layer2_expert14_fc1_gpu1 -> layer2_expert14_fc2_gpu1;
layer2_expert14_fc2_gpu1 -> layer2_expert14_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate15_gpu1;
layer2_gate15_gpu1 -> layer2_expert15_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert15_fc1_gpu1;
layer2_expert15_fc1_gpu1 -> layer2_expert15_fc2_gpu1;
layer2_expert15_fc2_gpu1 -> layer2_expert15_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate16_gpu1;
layer2_gate16_gpu1 -> layer2_expert16_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert16_fc1_gpu1;
layer2_expert16_fc1_gpu1 -> layer2_expert16_fc2_gpu1;
layer2_expert16_fc2_gpu1 -> layer2_expert16_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate17_gpu1;
layer2_gate17_gpu1 -> layer2_expert17_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert17_fc1_gpu1;
layer2_expert17_fc1_gpu1 -> layer2_expert17_fc2_gpu1;
layer2_expert17_fc2_gpu1 -> layer2_expert17_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate18_gpu1;
layer2_gate18_gpu1 -> layer2_expert18_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert18_fc1_gpu1;
layer2_expert18_fc1_gpu1 -> layer2_expert18_fc2_gpu1;
layer2_expert18_fc2_gpu1 -> layer2_expert18_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate19_gpu1;
layer2_gate19_gpu1 -> layer2_expert19_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert19_fc1_gpu1;
layer2_expert19_fc1_gpu1 -> layer2_expert19_fc2_gpu1;
layer2_expert19_fc2_gpu1 -> layer2_expert19_add_gpu1;
layer2_ln1_gpu1 -> layer2_gate20_gpu1;
layer2_gate20_gpu1 -> layer2_expert20_fc1_gpu1 [style=dashed];
layer2_ln1_gpu1 -> layer2_expert20_fc1_gpu1;
layer2_expert20_fc1_gpu1 -> layer2_expert20_fc2_gpu1;
layer2_expert20_fc2_gpu1 -> layer2_expert20_add_gpu1;
layer2_expert20_add_gpu1 -> layer3_att_in_gpu1;
layer2_ln1_gpu2 -> layer2_gate0_gpu2;
layer2_gate0_gpu2 -> layer2_expert0_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert0_fc1_gpu2;
layer2_expert0_fc1_gpu2 -> layer2_expert0_fc2_gpu2;
layer2_expert0_fc2_gpu2 -> layer2_expert0_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate1_gpu2;
layer2_gate1_gpu2 -> layer2_expert1_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert1_fc1_gpu2;
layer2_expert1_fc1_gpu2 -> layer2_expert1_fc2_gpu2;
layer2_expert1_fc2_gpu2 -> layer2_expert1_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate2_gpu2;
layer2_gate2_gpu2 -> layer2_expert2_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert2_fc1_gpu2;
layer2_expert2_fc1_gpu2 -> layer2_expert2_fc2_gpu2;
layer2_expert2_fc2_gpu2 -> layer2_expert2_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate3_gpu2;
layer2_gate3_gpu2 -> layer2_expert3_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert3_fc1_gpu2;
layer2_expert3_fc1_gpu2 -> layer2_expert3_fc2_gpu2;
layer2_expert3_fc2_gpu2 -> layer2_expert3_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate4_gpu2;
layer2_gate4_gpu2 -> layer2_expert4_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert4_fc1_gpu2;
layer2_expert4_fc1_gpu2 -> layer2_expert4_fc2_gpu2;
layer2_expert4_fc2_gpu2 -> layer2_expert4_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate5_gpu2;
layer2_gate5_gpu2 -> layer2_expert5_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert5_fc1_gpu2;
layer2_expert5_fc1_gpu2 -> layer2_expert5_fc2_gpu2;
layer2_expert5_fc2_gpu2 -> layer2_expert5_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate6_gpu2;
layer2_gate6_gpu2 -> layer2_expert6_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert6_fc1_gpu2;
layer2_expert6_fc1_gpu2 -> layer2_expert6_fc2_gpu2;
layer2_expert6_fc2_gpu2 -> layer2_expert6_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate7_gpu2;
layer2_gate7_gpu2 -> layer2_expert7_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert7_fc1_gpu2;
layer2_expert7_fc1_gpu2 -> layer2_expert7_fc2_gpu2;
layer2_expert7_fc2_gpu2 -> layer2_expert7_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate8_gpu2;
layer2_gate8_gpu2 -> layer2_expert8_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert8_fc1_gpu2;
layer2_expert8_fc1_gpu2 -> layer2_expert8_fc2_gpu2;
layer2_expert8_fc2_gpu2 -> layer2_expert8_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate9_gpu2;
layer2_gate9_gpu2 -> layer2_expert9_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert9_fc1_gpu2;
layer2_expert9_fc1_gpu2 -> layer2_expert9_fc2_gpu2;
layer2_expert9_fc2_gpu2 -> layer2_expert9_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate10_gpu2;
layer2_gate10_gpu2 -> layer2_expert10_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert10_fc1_gpu2;
layer2_expert10_fc1_gpu2 -> layer2_expert10_fc2_gpu2;
layer2_expert10_fc2_gpu2 -> layer2_expert10_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate11_gpu2;
layer2_gate11_gpu2 -> layer2_expert11_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert11_fc1_gpu2;
layer2_expert11_fc1_gpu2 -> layer2_expert11_fc2_gpu2;
layer2_expert11_fc2_gpu2 -> layer2_expert11_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate12_gpu2;
layer2_gate12_gpu2 -> layer2_expert12_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert12_fc1_gpu2;
layer2_expert12_fc1_gpu2 -> layer2_expert12_fc2_gpu2;
layer2_expert12_fc2_gpu2 -> layer2_expert12_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate13_gpu2;
layer2_gate13_gpu2 -> layer2_expert13_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert13_fc1_gpu2;
layer2_expert13_fc1_gpu2 -> layer2_expert13_fc2_gpu2;
layer2_expert13_fc2_gpu2 -> layer2_expert13_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate14_gpu2;
layer2_gate14_gpu2 -> layer2_expert14_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert14_fc1_gpu2;
layer2_expert14_fc1_gpu2 -> layer2_expert14_fc2_gpu2;
layer2_expert14_fc2_gpu2 -> layer2_expert14_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate15_gpu2;
layer2_gate15_gpu2 -> layer2_expert15_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert15_fc1_gpu2;
layer2_expert15_fc1_gpu2 -> layer2_expert15_fc2_gpu2;
layer2_expert15_fc2_gpu2 -> layer2_expert15_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate16_gpu2;
layer2_gate16_gpu2 -> layer2_expert16_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert16_fc1_gpu2;
layer2_expert16_fc1_gpu2 -> layer2_expert16_fc2_gpu2;
layer2_expert16_fc2_gpu2 -> layer2_expert16_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate17_gpu2;
layer2_gate17_gpu2 -> layer2_expert17_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert17_fc1_gpu2;
layer2_expert17_fc1_gpu2 -> layer2_expert17_fc2_gpu2;
layer2_expert17_fc2_gpu2 -> layer2_expert17_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate18_gpu2;
layer2_gate18_gpu2 -> layer2_expert18_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert18_fc1_gpu2;
layer2_expert18_fc1_gpu2 -> layer2_expert18_fc2_gpu2;
layer2_expert18_fc2_gpu2 -> layer2_expert18_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate19_gpu2;
layer2_gate19_gpu2 -> layer2_expert19_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert19_fc1_gpu2;
layer2_expert19_fc1_gpu2 -> layer2_expert19_fc2_gpu2;
layer2_expert19_fc2_gpu2 -> layer2_expert19_add_gpu2;
layer2_ln1_gpu2 -> layer2_gate20_gpu2;
layer2_gate20_gpu2 -> layer2_expert20_fc1_gpu2 [style=dashed];
layer2_ln1_gpu2 -> layer2_expert20_fc1_gpu2;
layer2_expert20_fc1_gpu2 -> layer2_expert20_fc2_gpu2;
layer2_expert20_fc2_gpu2 -> layer2_expert20_add_gpu2;
layer2_expert20_add_gpu2 -> layer3_att_in_gpu2;
input -> layer3_att_in_gpu0;
layer3_att_in_gpu0 -> layer3_qkv0_gpu0;
layer3_att_in_gpu0 -> layer3_qkv1_gpu0;
layer3_qkv0_gpu0 -> layer3_attout0_gpu0;
layer3_qkv1_gpu0 -> layer3_attout1_gpu0;
layer3_attout0_gpu0 -> layer3_att_agg_gpu0;
layer3_attout1_gpu0 -> layer3_att_agg_gpu0;
layer3_att_agg_gpu0 -> layer3_res1_gpu0;
layer3_res1_gpu0 -> layer3_ln1_gpu0;
input -> layer3_att_in_gpu1;
layer3_att_in_gpu1 -> layer3_qkv0_gpu1;
layer3_att_in_gpu1 -> layer3_qkv1_gpu1;
layer3_qkv0_gpu1 -> layer3_attout0_gpu1;
layer3_qkv1_gpu1 -> layer3_attout1_gpu1;
layer3_attout0_gpu1 -> layer3_att_agg_gpu1;
layer3_attout1_gpu1 -> layer3_att_agg_gpu1;
layer3_att_agg_gpu1 -> layer3_res1_gpu1;
layer3_res1_gpu1 -> layer3_ln1_gpu1;
input -> layer3_att_in_gpu2;
layer3_att_in_gpu2 -> layer3_qkv0_gpu2;
layer3_att_in_gpu2 -> layer3_qkv1_gpu2;
layer3_qkv0_gpu2 -> layer3_attout0_gpu2;
layer3_qkv1_gpu2 -> layer3_attout1_gpu2;
layer3_attout0_gpu2 -> layer3_att_agg_gpu2;
layer3_attout1_gpu2 -> layer3_att_agg_gpu2;
layer3_att_agg_gpu2 -> layer3_res1_gpu2;
layer3_res1_gpu2 -> layer3_ln1_gpu2;
layer3_ln1_gpu0 -> layer3_gate0_gpu0;
layer3_gate0_gpu0 -> layer3_expert0_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert0_fc1_gpu0;
layer3_expert0_fc1_gpu0 -> layer3_expert0_fc2_gpu0;
layer3_expert0_fc2_gpu0 -> layer3_expert0_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate1_gpu0;
layer3_gate1_gpu0 -> layer3_expert1_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert1_fc1_gpu0;
layer3_expert1_fc1_gpu0 -> layer3_expert1_fc2_gpu0;
layer3_expert1_fc2_gpu0 -> layer3_expert1_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate2_gpu0;
layer3_gate2_gpu0 -> layer3_expert2_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert2_fc1_gpu0;
layer3_expert2_fc1_gpu0 -> layer3_expert2_fc2_gpu0;
layer3_expert2_fc2_gpu0 -> layer3_expert2_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate3_gpu0;
layer3_gate3_gpu0 -> layer3_expert3_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert3_fc1_gpu0;
layer3_expert3_fc1_gpu0 -> layer3_expert3_fc2_gpu0;
layer3_expert3_fc2_gpu0 -> layer3_expert3_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate4_gpu0;
layer3_gate4_gpu0 -> layer3_expert4_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert4_fc1_gpu0;
layer3_expert4_fc1_gpu0 -> layer3_expert4_fc2_gpu0;
layer3_expert4_fc2_gpu0 -> layer3_expert4_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate5_gpu0;
layer3_gate5_gpu0 -> layer3_expert5_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert5_fc1_gpu0;
layer3_expert5_fc1_gpu0 -> layer3_expert5_fc2_gpu0;
layer3_expert5_fc2_gpu0 -> layer3_expert5_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate6_gpu0;
layer3_gate6_gpu0 -> layer3_expert6_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert6_fc1_gpu0;
layer3_expert6_fc1_gpu0 -> layer3_expert6_fc2_gpu0;
layer3_expert6_fc2_gpu0 -> layer3_expert6_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate7_gpu0;
layer3_gate7_gpu0 -> layer3_expert7_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert7_fc1_gpu0;
layer3_expert7_fc1_gpu0 -> layer3_expert7_fc2_gpu0;
layer3_expert7_fc2_gpu0 -> layer3_expert7_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate8_gpu0;
layer3_gate8_gpu0 -> layer3_expert8_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert8_fc1_gpu0;
layer3_expert8_fc1_gpu0 -> layer3_expert8_fc2_gpu0;
layer3_expert8_fc2_gpu0 -> layer3_expert8_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate9_gpu0;
layer3_gate9_gpu0 -> layer3_expert9_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert9_fc1_gpu0;
layer3_expert9_fc1_gpu0 -> layer3_expert9_fc2_gpu0;
layer3_expert9_fc2_gpu0 -> layer3_expert9_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate10_gpu0;
layer3_gate10_gpu0 -> layer3_expert10_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert10_fc1_gpu0;
layer3_expert10_fc1_gpu0 -> layer3_expert10_fc2_gpu0;
layer3_expert10_fc2_gpu0 -> layer3_expert10_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate11_gpu0;
layer3_gate11_gpu0 -> layer3_expert11_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert11_fc1_gpu0;
layer3_expert11_fc1_gpu0 -> layer3_expert11_fc2_gpu0;
layer3_expert11_fc2_gpu0 -> layer3_expert11_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate12_gpu0;
layer3_gate12_gpu0 -> layer3_expert12_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert12_fc1_gpu0;
layer3_expert12_fc1_gpu0 -> layer3_expert12_fc2_gpu0;
layer3_expert12_fc2_gpu0 -> layer3_expert12_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate13_gpu0;
layer3_gate13_gpu0 -> layer3_expert13_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert13_fc1_gpu0;
layer3_expert13_fc1_gpu0 -> layer3_expert13_fc2_gpu0;
layer3_expert13_fc2_gpu0 -> layer3_expert13_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate14_gpu0;
layer3_gate14_gpu0 -> layer3_expert14_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert14_fc1_gpu0;
layer3_expert14_fc1_gpu0 -> layer3_expert14_fc2_gpu0;
layer3_expert14_fc2_gpu0 -> layer3_expert14_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate15_gpu0;
layer3_gate15_gpu0 -> layer3_expert15_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert15_fc1_gpu0;
layer3_expert15_fc1_gpu0 -> layer3_expert15_fc2_gpu0;
layer3_expert15_fc2_gpu0 -> layer3_expert15_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate16_gpu0;
layer3_gate16_gpu0 -> layer3_expert16_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert16_fc1_gpu0;
layer3_expert16_fc1_gpu0 -> layer3_expert16_fc2_gpu0;
layer3_expert16_fc2_gpu0 -> layer3_expert16_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate17_gpu0;
layer3_gate17_gpu0 -> layer3_expert17_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert17_fc1_gpu0;
layer3_expert17_fc1_gpu0 -> layer3_expert17_fc2_gpu0;
layer3_expert17_fc2_gpu0 -> layer3_expert17_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate18_gpu0;
layer3_gate18_gpu0 -> layer3_expert18_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert18_fc1_gpu0;
layer3_expert18_fc1_gpu0 -> layer3_expert18_fc2_gpu0;
layer3_expert18_fc2_gpu0 -> layer3_expert18_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate19_gpu0;
layer3_gate19_gpu0 -> layer3_expert19_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert19_fc1_gpu0;
layer3_expert19_fc1_gpu0 -> layer3_expert19_fc2_gpu0;
layer3_expert19_fc2_gpu0 -> layer3_expert19_add_gpu0;
layer3_ln1_gpu0 -> layer3_gate20_gpu0;
layer3_gate20_gpu0 -> layer3_expert20_fc1_gpu0 [style=dashed];
layer3_ln1_gpu0 -> layer3_expert20_fc1_gpu0;
layer3_expert20_fc1_gpu0 -> layer3_expert20_fc2_gpu0;
layer3_expert20_fc2_gpu0 -> layer3_expert20_add_gpu0;
layer3_expert20_add_gpu0 -> layer4_att_in_gpu0;
layer3_ln1_gpu1 -> layer3_gate0_gpu1;
layer3_gate0_gpu1 -> layer3_expert0_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert0_fc1_gpu1;
layer3_expert0_fc1_gpu1 -> layer3_expert0_fc2_gpu1;
layer3_expert0_fc2_gpu1 -> layer3_expert0_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate1_gpu1;
layer3_gate1_gpu1 -> layer3_expert1_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert1_fc1_gpu1;
layer3_expert1_fc1_gpu1 -> layer3_expert1_fc2_gpu1;
layer3_expert1_fc2_gpu1 -> layer3_expert1_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate2_gpu1;
layer3_gate2_gpu1 -> layer3_expert2_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert2_fc1_gpu1;
layer3_expert2_fc1_gpu1 -> layer3_expert2_fc2_gpu1;
layer3_expert2_fc2_gpu1 -> layer3_expert2_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate3_gpu1;
layer3_gate3_gpu1 -> layer3_expert3_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert3_fc1_gpu1;
layer3_expert3_fc1_gpu1 -> layer3_expert3_fc2_gpu1;
layer3_expert3_fc2_gpu1 -> layer3_expert3_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate4_gpu1;
layer3_gate4_gpu1 -> layer3_expert4_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert4_fc1_gpu1;
layer3_expert4_fc1_gpu1 -> layer3_expert4_fc2_gpu1;
layer3_expert4_fc2_gpu1 -> layer3_expert4_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate5_gpu1;
layer3_gate5_gpu1 -> layer3_expert5_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert5_fc1_gpu1;
layer3_expert5_fc1_gpu1 -> layer3_expert5_fc2_gpu1;
layer3_expert5_fc2_gpu1 -> layer3_expert5_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate6_gpu1;
layer3_gate6_gpu1 -> layer3_expert6_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert6_fc1_gpu1;
layer3_expert6_fc1_gpu1 -> layer3_expert6_fc2_gpu1;
layer3_expert6_fc2_gpu1 -> layer3_expert6_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate7_gpu1;
layer3_gate7_gpu1 -> layer3_expert7_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert7_fc1_gpu1;
layer3_expert7_fc1_gpu1 -> layer3_expert7_fc2_gpu1;
layer3_expert7_fc2_gpu1 -> layer3_expert7_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate8_gpu1;
layer3_gate8_gpu1 -> layer3_expert8_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert8_fc1_gpu1;
layer3_expert8_fc1_gpu1 -> layer3_expert8_fc2_gpu1;
layer3_expert8_fc2_gpu1 -> layer3_expert8_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate9_gpu1;
layer3_gate9_gpu1 -> layer3_expert9_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert9_fc1_gpu1;
layer3_expert9_fc1_gpu1 -> layer3_expert9_fc2_gpu1;
layer3_expert9_fc2_gpu1 -> layer3_expert9_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate10_gpu1;
layer3_gate10_gpu1 -> layer3_expert10_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert10_fc1_gpu1;
layer3_expert10_fc1_gpu1 -> layer3_expert10_fc2_gpu1;
layer3_expert10_fc2_gpu1 -> layer3_expert10_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate11_gpu1;
layer3_gate11_gpu1 -> layer3_expert11_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert11_fc1_gpu1;
layer3_expert11_fc1_gpu1 -> layer3_expert11_fc2_gpu1;
layer3_expert11_fc2_gpu1 -> layer3_expert11_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate12_gpu1;
layer3_gate12_gpu1 -> layer3_expert12_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert12_fc1_gpu1;
layer3_expert12_fc1_gpu1 -> layer3_expert12_fc2_gpu1;
layer3_expert12_fc2_gpu1 -> layer3_expert12_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate13_gpu1;
layer3_gate13_gpu1 -> layer3_expert13_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert13_fc1_gpu1;
layer3_expert13_fc1_gpu1 -> layer3_expert13_fc2_gpu1;
layer3_expert13_fc2_gpu1 -> layer3_expert13_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate14_gpu1;
layer3_gate14_gpu1 -> layer3_expert14_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert14_fc1_gpu1;
layer3_expert14_fc1_gpu1 -> layer3_expert14_fc2_gpu1;
layer3_expert14_fc2_gpu1 -> layer3_expert14_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate15_gpu1;
layer3_gate15_gpu1 -> layer3_expert15_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert15_fc1_gpu1;
layer3_expert15_fc1_gpu1 -> layer3_expert15_fc2_gpu1;
layer3_expert15_fc2_gpu1 -> layer3_expert15_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate16_gpu1;
layer3_gate16_gpu1 -> layer3_expert16_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert16_fc1_gpu1;
layer3_expert16_fc1_gpu1 -> layer3_expert16_fc2_gpu1;
layer3_expert16_fc2_gpu1 -> layer3_expert16_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate17_gpu1;
layer3_gate17_gpu1 -> layer3_expert17_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert17_fc1_gpu1;
layer3_expert17_fc1_gpu1 -> layer3_expert17_fc2_gpu1;
layer3_expert17_fc2_gpu1 -> layer3_expert17_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate18_gpu1;
layer3_gate18_gpu1 -> layer3_expert18_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert18_fc1_gpu1;
layer3_expert18_fc1_gpu1 -> layer3_expert18_fc2_gpu1;
layer3_expert18_fc2_gpu1 -> layer3_expert18_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate19_gpu1;
layer3_gate19_gpu1 -> layer3_expert19_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert19_fc1_gpu1;
layer3_expert19_fc1_gpu1 -> layer3_expert19_fc2_gpu1;
layer3_expert19_fc2_gpu1 -> layer3_expert19_add_gpu1;
layer3_ln1_gpu1 -> layer3_gate20_gpu1;
layer3_gate20_gpu1 -> layer3_expert20_fc1_gpu1 [style=dashed];
layer3_ln1_gpu1 -> layer3_expert20_fc1_gpu1;
layer3_expert20_fc1_gpu1 -> layer3_expert20_fc2_gpu1;
layer3_expert20_fc2_gpu1 -> layer3_expert20_add_gpu1;
layer3_expert20_add_gpu1 -> layer4_att_in_gpu1;
layer3_ln1_gpu2 -> layer3_gate0_gpu2;
layer3_gate0_gpu2 -> layer3_expert0_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert0_fc1_gpu2;
layer3_expert0_fc1_gpu2 -> layer3_expert0_fc2_gpu2;
layer3_expert0_fc2_gpu2 -> layer3_expert0_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate1_gpu2;
layer3_gate1_gpu2 -> layer3_expert1_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert1_fc1_gpu2;
layer3_expert1_fc1_gpu2 -> layer3_expert1_fc2_gpu2;
layer3_expert1_fc2_gpu2 -> layer3_expert1_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate2_gpu2;
layer3_gate2_gpu2 -> layer3_expert2_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert2_fc1_gpu2;
layer3_expert2_fc1_gpu2 -> layer3_expert2_fc2_gpu2;
layer3_expert2_fc2_gpu2 -> layer3_expert2_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate3_gpu2;
layer3_gate3_gpu2 -> layer3_expert3_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert3_fc1_gpu2;
layer3_expert3_fc1_gpu2 -> layer3_expert3_fc2_gpu2;
layer3_expert3_fc2_gpu2 -> layer3_expert3_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate4_gpu2;
layer3_gate4_gpu2 -> layer3_expert4_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert4_fc1_gpu2;
layer3_expert4_fc1_gpu2 -> layer3_expert4_fc2_gpu2;
layer3_expert4_fc2_gpu2 -> layer3_expert4_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate5_gpu2;
layer3_gate5_gpu2 -> layer3_expert5_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert5_fc1_gpu2;
layer3_expert5_fc1_gpu2 -> layer3_expert5_fc2_gpu2;
layer3_expert5_fc2_gpu2 -> layer3_expert5_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate6_gpu2;
layer3_gate6_gpu2 -> layer3_expert6_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert6_fc1_gpu2;
layer3_expert6_fc1_gpu2 -> layer3_expert6_fc2_gpu2;
layer3_expert6_fc2_gpu2 -> layer3_expert6_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate7_gpu2;
layer3_gate7_gpu2 -> layer3_expert7_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert7_fc1_gpu2;
layer3_expert7_fc1_gpu2 -> layer3_expert7_fc2_gpu2;
layer3_expert7_fc2_gpu2 -> layer3_expert7_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate8_gpu2;
layer3_gate8_gpu2 -> layer3_expert8_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert8_fc1_gpu2;
layer3_expert8_fc1_gpu2 -> layer3_expert8_fc2_gpu2;
layer3_expert8_fc2_gpu2 -> layer3_expert8_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate9_gpu2;
layer3_gate9_gpu2 -> layer3_expert9_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert9_fc1_gpu2;
layer3_expert9_fc1_gpu2 -> layer3_expert9_fc2_gpu2;
layer3_expert9_fc2_gpu2 -> layer3_expert9_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate10_gpu2;
layer3_gate10_gpu2 -> layer3_expert10_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert10_fc1_gpu2;
layer3_expert10_fc1_gpu2 -> layer3_expert10_fc2_gpu2;
layer3_expert10_fc2_gpu2 -> layer3_expert10_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate11_gpu2;
layer3_gate11_gpu2 -> layer3_expert11_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert11_fc1_gpu2;
layer3_expert11_fc1_gpu2 -> layer3_expert11_fc2_gpu2;
layer3_expert11_fc2_gpu2 -> layer3_expert11_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate12_gpu2;
layer3_gate12_gpu2 -> layer3_expert12_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert12_fc1_gpu2;
layer3_expert12_fc1_gpu2 -> layer3_expert12_fc2_gpu2;
layer3_expert12_fc2_gpu2 -> layer3_expert12_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate13_gpu2;
layer3_gate13_gpu2 -> layer3_expert13_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert13_fc1_gpu2;
layer3_expert13_fc1_gpu2 -> layer3_expert13_fc2_gpu2;
layer3_expert13_fc2_gpu2 -> layer3_expert13_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate14_gpu2;
layer3_gate14_gpu2 -> layer3_expert14_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert14_fc1_gpu2;
layer3_expert14_fc1_gpu2 -> layer3_expert14_fc2_gpu2;
layer3_expert14_fc2_gpu2 -> layer3_expert14_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate15_gpu2;
layer3_gate15_gpu2 -> layer3_expert15_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert15_fc1_gpu2;
layer3_expert15_fc1_gpu2 -> layer3_expert15_fc2_gpu2;
layer3_expert15_fc2_gpu2 -> layer3_expert15_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate16_gpu2;
layer3_gate16_gpu2 -> layer3_expert16_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert16_fc1_gpu2;
layer3_expert16_fc1_gpu2 -> layer3_expert16_fc2_gpu2;
layer3_expert16_fc2_gpu2 -> layer3_expert16_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate17_gpu2;
layer3_gate17_gpu2 -> layer3_expert17_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert17_fc1_gpu2;
layer3_expert17_fc1_gpu2 -> layer3_expert17_fc2_gpu2;
layer3_expert17_fc2_gpu2 -> layer3_expert17_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate18_gpu2;
layer3_gate18_gpu2 -> layer3_expert18_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert18_fc1_gpu2;
layer3_expert18_fc1_gpu2 -> layer3_expert18_fc2_gpu2;
layer3_expert18_fc2_gpu2 -> layer3_expert18_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate19_gpu2;
layer3_gate19_gpu2 -> layer3_expert19_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert19_fc1_gpu2;
layer3_expert19_fc1_gpu2 -> layer3_expert19_fc2_gpu2;
layer3_expert19_fc2_gpu2 -> layer3_expert19_add_gpu2;
layer3_ln1_gpu2 -> layer3_gate20_gpu2;
layer3_gate20_gpu2 -> layer3_expert20_fc1_gpu2 [style=dashed];
layer3_ln1_gpu2 -> layer3_expert20_fc1_gpu2;
layer3_expert20_fc1_gpu2 -> layer3_expert20_fc2_gpu2;
layer3_expert20_fc2_gpu2 -> layer3_expert20_add_gpu2;
layer3_expert20_add_gpu2 -> layer4_att_in_gpu2;
input -> layer4_att_in_gpu0;
layer4_att_in_gpu0 -> layer4_qkv0_gpu0;
layer4_att_in_gpu0 -> layer4_qkv1_gpu0;
layer4_qkv0_gpu0 -> layer4_attout0_gpu0;
layer4_qkv1_gpu0 -> layer4_attout1_gpu0;
layer4_attout0_gpu0 -> layer4_att_agg_gpu0;
layer4_attout1_gpu0 -> layer4_att_agg_gpu0;
layer4_att_agg_gpu0 -> layer4_res1_gpu0;
layer4_res1_gpu0 -> layer4_ln1_gpu0;
input -> layer4_att_in_gpu1;
layer4_att_in_gpu1 -> layer4_qkv0_gpu1;
layer4_att_in_gpu1 -> layer4_qkv1_gpu1;
layer4_qkv0_gpu1 -> layer4_attout0_gpu1;
layer4_qkv1_gpu1 -> layer4_attout1_gpu1;
layer4_attout0_gpu1 -> layer4_att_agg_gpu1;
layer4_attout1_gpu1 -> layer4_att_agg_gpu1;
layer4_att_agg_gpu1 -> layer4_res1_gpu1;
layer4_res1_gpu1 -> layer4_ln1_gpu1;
input -> layer4_att_in_gpu2;
layer4_att_in_gpu2 -> layer4_qkv0_gpu2;
layer4_att_in_gpu2 -> layer4_qkv1_gpu2;
layer4_qkv0_gpu2 -> layer4_attout0_gpu2;
layer4_qkv1_gpu2 -> layer4_attout1_gpu2;
layer4_attout0_gpu2 -> layer4_att_agg_gpu2;
layer4_attout1_gpu2 -> layer4_att_agg_gpu2;
layer4_att_agg_gpu2 -> layer4_res1_gpu2;
layer4_res1_gpu2 -> layer4_ln1_gpu2;
layer4_ln1_gpu0 -> layer4_gate0_gpu0;
layer4_gate0_gpu0 -> layer4_expert0_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert0_fc1_gpu0;
layer4_expert0_fc1_gpu0 -> layer4_expert0_fc2_gpu0;
layer4_expert0_fc2_gpu0 -> layer4_expert0_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate1_gpu0;
layer4_gate1_gpu0 -> layer4_expert1_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert1_fc1_gpu0;
layer4_expert1_fc1_gpu0 -> layer4_expert1_fc2_gpu0;
layer4_expert1_fc2_gpu0 -> layer4_expert1_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate2_gpu0;
layer4_gate2_gpu0 -> layer4_expert2_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert2_fc1_gpu0;
layer4_expert2_fc1_gpu0 -> layer4_expert2_fc2_gpu0;
layer4_expert2_fc2_gpu0 -> layer4_expert2_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate3_gpu0;
layer4_gate3_gpu0 -> layer4_expert3_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert3_fc1_gpu0;
layer4_expert3_fc1_gpu0 -> layer4_expert3_fc2_gpu0;
layer4_expert3_fc2_gpu0 -> layer4_expert3_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate4_gpu0;
layer4_gate4_gpu0 -> layer4_expert4_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert4_fc1_gpu0;
layer4_expert4_fc1_gpu0 -> layer4_expert4_fc2_gpu0;
layer4_expert4_fc2_gpu0 -> layer4_expert4_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate5_gpu0;
layer4_gate5_gpu0 -> layer4_expert5_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert5_fc1_gpu0;
layer4_expert5_fc1_gpu0 -> layer4_expert5_fc2_gpu0;
layer4_expert5_fc2_gpu0 -> layer4_expert5_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate6_gpu0;
layer4_gate6_gpu0 -> layer4_expert6_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert6_fc1_gpu0;
layer4_expert6_fc1_gpu0 -> layer4_expert6_fc2_gpu0;
layer4_expert6_fc2_gpu0 -> layer4_expert6_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate7_gpu0;
layer4_gate7_gpu0 -> layer4_expert7_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert7_fc1_gpu0;
layer4_expert7_fc1_gpu0 -> layer4_expert7_fc2_gpu0;
layer4_expert7_fc2_gpu0 -> layer4_expert7_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate8_gpu0;
layer4_gate8_gpu0 -> layer4_expert8_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert8_fc1_gpu0;
layer4_expert8_fc1_gpu0 -> layer4_expert8_fc2_gpu0;
layer4_expert8_fc2_gpu0 -> layer4_expert8_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate9_gpu0;
layer4_gate9_gpu0 -> layer4_expert9_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert9_fc1_gpu0;
layer4_expert9_fc1_gpu0 -> layer4_expert9_fc2_gpu0;
layer4_expert9_fc2_gpu0 -> layer4_expert9_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate10_gpu0;
layer4_gate10_gpu0 -> layer4_expert10_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert10_fc1_gpu0;
layer4_expert10_fc1_gpu0 -> layer4_expert10_fc2_gpu0;
layer4_expert10_fc2_gpu0 -> layer4_expert10_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate11_gpu0;
layer4_gate11_gpu0 -> layer4_expert11_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert11_fc1_gpu0;
layer4_expert11_fc1_gpu0 -> layer4_expert11_fc2_gpu0;
layer4_expert11_fc2_gpu0 -> layer4_expert11_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate12_gpu0;
layer4_gate12_gpu0 -> layer4_expert12_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert12_fc1_gpu0;
layer4_expert12_fc1_gpu0 -> layer4_expert12_fc2_gpu0;
layer4_expert12_fc2_gpu0 -> layer4_expert12_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate13_gpu0;
layer4_gate13_gpu0 -> layer4_expert13_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert13_fc1_gpu0;
layer4_expert13_fc1_gpu0 -> layer4_expert13_fc2_gpu0;
layer4_expert13_fc2_gpu0 -> layer4_expert13_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate14_gpu0;
layer4_gate14_gpu0 -> layer4_expert14_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert14_fc1_gpu0;
layer4_expert14_fc1_gpu0 -> layer4_expert14_fc2_gpu0;
layer4_expert14_fc2_gpu0 -> layer4_expert14_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate15_gpu0;
layer4_gate15_gpu0 -> layer4_expert15_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert15_fc1_gpu0;
layer4_expert15_fc1_gpu0 -> layer4_expert15_fc2_gpu0;
layer4_expert15_fc2_gpu0 -> layer4_expert15_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate16_gpu0;
layer4_gate16_gpu0 -> layer4_expert16_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert16_fc1_gpu0;
layer4_expert16_fc1_gpu0 -> layer4_expert16_fc2_gpu0;
layer4_expert16_fc2_gpu0 -> layer4_expert16_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate17_gpu0;
layer4_gate17_gpu0 -> layer4_expert17_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert17_fc1_gpu0;
layer4_expert17_fc1_gpu0 -> layer4_expert17_fc2_gpu0;
layer4_expert17_fc2_gpu0 -> layer4_expert17_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate18_gpu0;
layer4_gate18_gpu0 -> layer4_expert18_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert18_fc1_gpu0;
layer4_expert18_fc1_gpu0 -> layer4_expert18_fc2_gpu0;
layer4_expert18_fc2_gpu0 -> layer4_expert18_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate19_gpu0;
layer4_gate19_gpu0 -> layer4_expert19_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert19_fc1_gpu0;
layer4_expert19_fc1_gpu0 -> layer4_expert19_fc2_gpu0;
layer4_expert19_fc2_gpu0 -> layer4_expert19_add_gpu0;
layer4_ln1_gpu0 -> layer4_gate20_gpu0;
layer4_gate20_gpu0 -> layer4_expert20_fc1_gpu0 [style=dashed];
layer4_ln1_gpu0 -> layer4_expert20_fc1_gpu0;
layer4_expert20_fc1_gpu0 -> layer4_expert20_fc2_gpu0;
layer4_expert20_fc2_gpu0 -> layer4_expert20_add_gpu0;
layer4_expert20_add_gpu0 -> layer5_att_in_gpu0;
layer4_ln1_gpu1 -> layer4_gate0_gpu1;
layer4_gate0_gpu1 -> layer4_expert0_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert0_fc1_gpu1;
layer4_expert0_fc1_gpu1 -> layer4_expert0_fc2_gpu1;
layer4_expert0_fc2_gpu1 -> layer4_expert0_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate1_gpu1;
layer4_gate1_gpu1 -> layer4_expert1_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert1_fc1_gpu1;
layer4_expert1_fc1_gpu1 -> layer4_expert1_fc2_gpu1;
layer4_expert1_fc2_gpu1 -> layer4_expert1_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate2_gpu1;
layer4_gate2_gpu1 -> layer4_expert2_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert2_fc1_gpu1;
layer4_expert2_fc1_gpu1 -> layer4_expert2_fc2_gpu1;
layer4_expert2_fc2_gpu1 -> layer4_expert2_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate3_gpu1;
layer4_gate3_gpu1 -> layer4_expert3_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert3_fc1_gpu1;
layer4_expert3_fc1_gpu1 -> layer4_expert3_fc2_gpu1;
layer4_expert3_fc2_gpu1 -> layer4_expert3_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate4_gpu1;
layer4_gate4_gpu1 -> layer4_expert4_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert4_fc1_gpu1;
layer4_expert4_fc1_gpu1 -> layer4_expert4_fc2_gpu1;
layer4_expert4_fc2_gpu1 -> layer4_expert4_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate5_gpu1;
layer4_gate5_gpu1 -> layer4_expert5_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert5_fc1_gpu1;
layer4_expert5_fc1_gpu1 -> layer4_expert5_fc2_gpu1;
layer4_expert5_fc2_gpu1 -> layer4_expert5_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate6_gpu1;
layer4_gate6_gpu1 -> layer4_expert6_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert6_fc1_gpu1;
layer4_expert6_fc1_gpu1 -> layer4_expert6_fc2_gpu1;
layer4_expert6_fc2_gpu1 -> layer4_expert6_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate7_gpu1;
layer4_gate7_gpu1 -> layer4_expert7_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert7_fc1_gpu1;
layer4_expert7_fc1_gpu1 -> layer4_expert7_fc2_gpu1;
layer4_expert7_fc2_gpu1 -> layer4_expert7_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate8_gpu1;
layer4_gate8_gpu1 -> layer4_expert8_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert8_fc1_gpu1;
layer4_expert8_fc1_gpu1 -> layer4_expert8_fc2_gpu1;
layer4_expert8_fc2_gpu1 -> layer4_expert8_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate9_gpu1;
layer4_gate9_gpu1 -> layer4_expert9_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert9_fc1_gpu1;
layer4_expert9_fc1_gpu1 -> layer4_expert9_fc2_gpu1;
layer4_expert9_fc2_gpu1 -> layer4_expert9_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate10_gpu1;
layer4_gate10_gpu1 -> layer4_expert10_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert10_fc1_gpu1;
layer4_expert10_fc1_gpu1 -> layer4_expert10_fc2_gpu1;
layer4_expert10_fc2_gpu1 -> layer4_expert10_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate11_gpu1;
layer4_gate11_gpu1 -> layer4_expert11_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert11_fc1_gpu1;
layer4_expert11_fc1_gpu1 -> layer4_expert11_fc2_gpu1;
layer4_expert11_fc2_gpu1 -> layer4_expert11_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate12_gpu1;
layer4_gate12_gpu1 -> layer4_expert12_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert12_fc1_gpu1;
layer4_expert12_fc1_gpu1 -> layer4_expert12_fc2_gpu1;
layer4_expert12_fc2_gpu1 -> layer4_expert12_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate13_gpu1;
layer4_gate13_gpu1 -> layer4_expert13_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert13_fc1_gpu1;
layer4_expert13_fc1_gpu1 -> layer4_expert13_fc2_gpu1;
layer4_expert13_fc2_gpu1 -> layer4_expert13_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate14_gpu1;
layer4_gate14_gpu1 -> layer4_expert14_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert14_fc1_gpu1;
layer4_expert14_fc1_gpu1 -> layer4_expert14_fc2_gpu1;
layer4_expert14_fc2_gpu1 -> layer4_expert14_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate15_gpu1;
layer4_gate15_gpu1 -> layer4_expert15_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert15_fc1_gpu1;
layer4_expert15_fc1_gpu1 -> layer4_expert15_fc2_gpu1;
layer4_expert15_fc2_gpu1 -> layer4_expert15_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate16_gpu1;
layer4_gate16_gpu1 -> layer4_expert16_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert16_fc1_gpu1;
layer4_expert16_fc1_gpu1 -> layer4_expert16_fc2_gpu1;
layer4_expert16_fc2_gpu1 -> layer4_expert16_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate17_gpu1;
layer4_gate17_gpu1 -> layer4_expert17_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert17_fc1_gpu1;
layer4_expert17_fc1_gpu1 -> layer4_expert17_fc2_gpu1;
layer4_expert17_fc2_gpu1 -> layer4_expert17_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate18_gpu1;
layer4_gate18_gpu1 -> layer4_expert18_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert18_fc1_gpu1;
layer4_expert18_fc1_gpu1 -> layer4_expert18_fc2_gpu1;
layer4_expert18_fc2_gpu1 -> layer4_expert18_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate19_gpu1;
layer4_gate19_gpu1 -> layer4_expert19_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert19_fc1_gpu1;
layer4_expert19_fc1_gpu1 -> layer4_expert19_fc2_gpu1;
layer4_expert19_fc2_gpu1 -> layer4_expert19_add_gpu1;
layer4_ln1_gpu1 -> layer4_gate20_gpu1;
layer4_gate20_gpu1 -> layer4_expert20_fc1_gpu1 [style=dashed];
layer4_ln1_gpu1 -> layer4_expert20_fc1_gpu1;
layer4_expert20_fc1_gpu1 -> layer4_expert20_fc2_gpu1;
layer4_expert20_fc2_gpu1 -> layer4_expert20_add_gpu1;
layer4_expert20_add_gpu1 -> layer5_att_in_gpu1;
layer4_ln1_gpu2 -> layer4_gate0_gpu2;
layer4_gate0_gpu2 -> layer4_expert0_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert0_fc1_gpu2;
layer4_expert0_fc1_gpu2 -> layer4_expert0_fc2_gpu2;
layer4_expert0_fc2_gpu2 -> layer4_expert0_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate1_gpu2;
layer4_gate1_gpu2 -> layer4_expert1_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert1_fc1_gpu2;
layer4_expert1_fc1_gpu2 -> layer4_expert1_fc2_gpu2;
layer4_expert1_fc2_gpu2 -> layer4_expert1_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate2_gpu2;
layer4_gate2_gpu2 -> layer4_expert2_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert2_fc1_gpu2;
layer4_expert2_fc1_gpu2 -> layer4_expert2_fc2_gpu2;
layer4_expert2_fc2_gpu2 -> layer4_expert2_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate3_gpu2;
layer4_gate3_gpu2 -> layer4_expert3_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert3_fc1_gpu2;
layer4_expert3_fc1_gpu2 -> layer4_expert3_fc2_gpu2;
layer4_expert3_fc2_gpu2 -> layer4_expert3_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate4_gpu2;
layer4_gate4_gpu2 -> layer4_expert4_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert4_fc1_gpu2;
layer4_expert4_fc1_gpu2 -> layer4_expert4_fc2_gpu2;
layer4_expert4_fc2_gpu2 -> layer4_expert4_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate5_gpu2;
layer4_gate5_gpu2 -> layer4_expert5_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert5_fc1_gpu2;
layer4_expert5_fc1_gpu2 -> layer4_expert5_fc2_gpu2;
layer4_expert5_fc2_gpu2 -> layer4_expert5_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate6_gpu2;
layer4_gate6_gpu2 -> layer4_expert6_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert6_fc1_gpu2;
layer4_expert6_fc1_gpu2 -> layer4_expert6_fc2_gpu2;
layer4_expert6_fc2_gpu2 -> layer4_expert6_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate7_gpu2;
layer4_gate7_gpu2 -> layer4_expert7_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert7_fc1_gpu2;
layer4_expert7_fc1_gpu2 -> layer4_expert7_fc2_gpu2;
layer4_expert7_fc2_gpu2 -> layer4_expert7_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate8_gpu2;
layer4_gate8_gpu2 -> layer4_expert8_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert8_fc1_gpu2;
layer4_expert8_fc1_gpu2 -> layer4_expert8_fc2_gpu2;
layer4_expert8_fc2_gpu2 -> layer4_expert8_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate9_gpu2;
layer4_gate9_gpu2 -> layer4_expert9_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert9_fc1_gpu2;
layer4_expert9_fc1_gpu2 -> layer4_expert9_fc2_gpu2;
layer4_expert9_fc2_gpu2 -> layer4_expert9_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate10_gpu2;
layer4_gate10_gpu2 -> layer4_expert10_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert10_fc1_gpu2;
layer4_expert10_fc1_gpu2 -> layer4_expert10_fc2_gpu2;
layer4_expert10_fc2_gpu2 -> layer4_expert10_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate11_gpu2;
layer4_gate11_gpu2 -> layer4_expert11_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert11_fc1_gpu2;
layer4_expert11_fc1_gpu2 -> layer4_expert11_fc2_gpu2;
layer4_expert11_fc2_gpu2 -> layer4_expert11_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate12_gpu2;
layer4_gate12_gpu2 -> layer4_expert12_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert12_fc1_gpu2;
layer4_expert12_fc1_gpu2 -> layer4_expert12_fc2_gpu2;
layer4_expert12_fc2_gpu2 -> layer4_expert12_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate13_gpu2;
layer4_gate13_gpu2 -> layer4_expert13_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert13_fc1_gpu2;
layer4_expert13_fc1_gpu2 -> layer4_expert13_fc2_gpu2;
layer4_expert13_fc2_gpu2 -> layer4_expert13_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate14_gpu2;
layer4_gate14_gpu2 -> layer4_expert14_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert14_fc1_gpu2;
layer4_expert14_fc1_gpu2 -> layer4_expert14_fc2_gpu2;
layer4_expert14_fc2_gpu2 -> layer4_expert14_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate15_gpu2;
layer4_gate15_gpu2 -> layer4_expert15_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert15_fc1_gpu2;
layer4_expert15_fc1_gpu2 -> layer4_expert15_fc2_gpu2;
layer4_expert15_fc2_gpu2 -> layer4_expert15_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate16_gpu2;
layer4_gate16_gpu2 -> layer4_expert16_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert16_fc1_gpu2;
layer4_expert16_fc1_gpu2 -> layer4_expert16_fc2_gpu2;
layer4_expert16_fc2_gpu2 -> layer4_expert16_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate17_gpu2;
layer4_gate17_gpu2 -> layer4_expert17_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert17_fc1_gpu2;
layer4_expert17_fc1_gpu2 -> layer4_expert17_fc2_gpu2;
layer4_expert17_fc2_gpu2 -> layer4_expert17_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate18_gpu2;
layer4_gate18_gpu2 -> layer4_expert18_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert18_fc1_gpu2;
layer4_expert18_fc1_gpu2 -> layer4_expert18_fc2_gpu2;
layer4_expert18_fc2_gpu2 -> layer4_expert18_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate19_gpu2;
layer4_gate19_gpu2 -> layer4_expert19_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert19_fc1_gpu2;
layer4_expert19_fc1_gpu2 -> layer4_expert19_fc2_gpu2;
layer4_expert19_fc2_gpu2 -> layer4_expert19_add_gpu2;
layer4_ln1_gpu2 -> layer4_gate20_gpu2;
layer4_gate20_gpu2 -> layer4_expert20_fc1_gpu2 [style=dashed];
layer4_ln1_gpu2 -> layer4_expert20_fc1_gpu2;
layer4_expert20_fc1_gpu2 -> layer4_expert20_fc2_gpu2;
layer4_expert20_fc2_gpu2 -> layer4_expert20_add_gpu2;
layer4_expert20_add_gpu2 -> layer5_att_in_gpu2;
input -> layer5_att_in_gpu0;
layer5_att_in_gpu0 -> layer5_qkv0_gpu0;
layer5_att_in_gpu0 -> layer5_qkv1_gpu0;
layer5_qkv0_gpu0 -> layer5_attout0_gpu0;
layer5_qkv1_gpu0 -> layer5_attout1_gpu0;
layer5_attout0_gpu0 -> layer5_att_agg_gpu0;
layer5_attout1_gpu0 -> layer5_att_agg_gpu0;
layer5_att_agg_gpu0 -> layer5_res1_gpu0;
layer5_res1_gpu0 -> layer5_ln1_gpu0;
input -> layer5_att_in_gpu1;
layer5_att_in_gpu1 -> layer5_qkv0_gpu1;
layer5_att_in_gpu1 -> layer5_qkv1_gpu1;
layer5_qkv0_gpu1 -> layer5_attout0_gpu1;
layer5_qkv1_gpu1 -> layer5_attout1_gpu1;
layer5_attout0_gpu1 -> layer5_att_agg_gpu1;
layer5_attout1_gpu1 -> layer5_att_agg_gpu1;
layer5_att_agg_gpu1 -> layer5_res1_gpu1;
layer5_res1_gpu1 -> layer5_ln1_gpu1;
input -> layer5_att_in_gpu2;
layer5_att_in_gpu2 -> layer5_qkv0_gpu2;
layer5_att_in_gpu2 -> layer5_qkv1_gpu2;
layer5_qkv0_gpu2 -> layer5_attout0_gpu2;
layer5_qkv1_gpu2 -> layer5_attout1_gpu2;
layer5_attout0_gpu2 -> layer5_att_agg_gpu2;
layer5_attout1_gpu2 -> layer5_att_agg_gpu2;
layer5_att_agg_gpu2 -> layer5_res1_gpu2;
layer5_res1_gpu2 -> layer5_ln1_gpu2;
layer5_ln1_gpu0 -> layer5_gate0_gpu0;
layer5_gate0_gpu0 -> layer5_expert0_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert0_fc1_gpu0;
layer5_expert0_fc1_gpu0 -> layer5_expert0_fc2_gpu0;
layer5_expert0_fc2_gpu0 -> layer5_expert0_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate1_gpu0;
layer5_gate1_gpu0 -> layer5_expert1_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert1_fc1_gpu0;
layer5_expert1_fc1_gpu0 -> layer5_expert1_fc2_gpu0;
layer5_expert1_fc2_gpu0 -> layer5_expert1_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate2_gpu0;
layer5_gate2_gpu0 -> layer5_expert2_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert2_fc1_gpu0;
layer5_expert2_fc1_gpu0 -> layer5_expert2_fc2_gpu0;
layer5_expert2_fc2_gpu0 -> layer5_expert2_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate3_gpu0;
layer5_gate3_gpu0 -> layer5_expert3_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert3_fc1_gpu0;
layer5_expert3_fc1_gpu0 -> layer5_expert3_fc2_gpu0;
layer5_expert3_fc2_gpu0 -> layer5_expert3_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate4_gpu0;
layer5_gate4_gpu0 -> layer5_expert4_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert4_fc1_gpu0;
layer5_expert4_fc1_gpu0 -> layer5_expert4_fc2_gpu0;
layer5_expert4_fc2_gpu0 -> layer5_expert4_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate5_gpu0;
layer5_gate5_gpu0 -> layer5_expert5_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert5_fc1_gpu0;
layer5_expert5_fc1_gpu0 -> layer5_expert5_fc2_gpu0;
layer5_expert5_fc2_gpu0 -> layer5_expert5_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate6_gpu0;
layer5_gate6_gpu0 -> layer5_expert6_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert6_fc1_gpu0;
layer5_expert6_fc1_gpu0 -> layer5_expert6_fc2_gpu0;
layer5_expert6_fc2_gpu0 -> layer5_expert6_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate7_gpu0;
layer5_gate7_gpu0 -> layer5_expert7_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert7_fc1_gpu0;
layer5_expert7_fc1_gpu0 -> layer5_expert7_fc2_gpu0;
layer5_expert7_fc2_gpu0 -> layer5_expert7_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate8_gpu0;
layer5_gate8_gpu0 -> layer5_expert8_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert8_fc1_gpu0;
layer5_expert8_fc1_gpu0 -> layer5_expert8_fc2_gpu0;
layer5_expert8_fc2_gpu0 -> layer5_expert8_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate9_gpu0;
layer5_gate9_gpu0 -> layer5_expert9_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert9_fc1_gpu0;
layer5_expert9_fc1_gpu0 -> layer5_expert9_fc2_gpu0;
layer5_expert9_fc2_gpu0 -> layer5_expert9_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate10_gpu0;
layer5_gate10_gpu0 -> layer5_expert10_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert10_fc1_gpu0;
layer5_expert10_fc1_gpu0 -> layer5_expert10_fc2_gpu0;
layer5_expert10_fc2_gpu0 -> layer5_expert10_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate11_gpu0;
layer5_gate11_gpu0 -> layer5_expert11_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert11_fc1_gpu0;
layer5_expert11_fc1_gpu0 -> layer5_expert11_fc2_gpu0;
layer5_expert11_fc2_gpu0 -> layer5_expert11_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate12_gpu0;
layer5_gate12_gpu0 -> layer5_expert12_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert12_fc1_gpu0;
layer5_expert12_fc1_gpu0 -> layer5_expert12_fc2_gpu0;
layer5_expert12_fc2_gpu0 -> layer5_expert12_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate13_gpu0;
layer5_gate13_gpu0 -> layer5_expert13_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert13_fc1_gpu0;
layer5_expert13_fc1_gpu0 -> layer5_expert13_fc2_gpu0;
layer5_expert13_fc2_gpu0 -> layer5_expert13_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate14_gpu0;
layer5_gate14_gpu0 -> layer5_expert14_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert14_fc1_gpu0;
layer5_expert14_fc1_gpu0 -> layer5_expert14_fc2_gpu0;
layer5_expert14_fc2_gpu0 -> layer5_expert14_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate15_gpu0;
layer5_gate15_gpu0 -> layer5_expert15_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert15_fc1_gpu0;
layer5_expert15_fc1_gpu0 -> layer5_expert15_fc2_gpu0;
layer5_expert15_fc2_gpu0 -> layer5_expert15_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate16_gpu0;
layer5_gate16_gpu0 -> layer5_expert16_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert16_fc1_gpu0;
layer5_expert16_fc1_gpu0 -> layer5_expert16_fc2_gpu0;
layer5_expert16_fc2_gpu0 -> layer5_expert16_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate17_gpu0;
layer5_gate17_gpu0 -> layer5_expert17_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert17_fc1_gpu0;
layer5_expert17_fc1_gpu0 -> layer5_expert17_fc2_gpu0;
layer5_expert17_fc2_gpu0 -> layer5_expert17_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate18_gpu0;
layer5_gate18_gpu0 -> layer5_expert18_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert18_fc1_gpu0;
layer5_expert18_fc1_gpu0 -> layer5_expert18_fc2_gpu0;
layer5_expert18_fc2_gpu0 -> layer5_expert18_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate19_gpu0;
layer5_gate19_gpu0 -> layer5_expert19_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert19_fc1_gpu0;
layer5_expert19_fc1_gpu0 -> layer5_expert19_fc2_gpu0;
layer5_expert19_fc2_gpu0 -> layer5_expert19_add_gpu0;
layer5_ln1_gpu0 -> layer5_gate20_gpu0;
layer5_gate20_gpu0 -> layer5_expert20_fc1_gpu0 [style=dashed];
layer5_ln1_gpu0 -> layer5_expert20_fc1_gpu0;
layer5_expert20_fc1_gpu0 -> layer5_expert20_fc2_gpu0;
layer5_expert20_fc2_gpu0 -> layer5_expert20_add_gpu0;
layer5_expert20_add_gpu0 -> layer6_att_in_gpu0;
layer5_ln1_gpu1 -> layer5_gate0_gpu1;
layer5_gate0_gpu1 -> layer5_expert0_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert0_fc1_gpu1;
layer5_expert0_fc1_gpu1 -> layer5_expert0_fc2_gpu1;
layer5_expert0_fc2_gpu1 -> layer5_expert0_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate1_gpu1;
layer5_gate1_gpu1 -> layer5_expert1_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert1_fc1_gpu1;
layer5_expert1_fc1_gpu1 -> layer5_expert1_fc2_gpu1;
layer5_expert1_fc2_gpu1 -> layer5_expert1_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate2_gpu1;
layer5_gate2_gpu1 -> layer5_expert2_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert2_fc1_gpu1;
layer5_expert2_fc1_gpu1 -> layer5_expert2_fc2_gpu1;
layer5_expert2_fc2_gpu1 -> layer5_expert2_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate3_gpu1;
layer5_gate3_gpu1 -> layer5_expert3_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert3_fc1_gpu1;
layer5_expert3_fc1_gpu1 -> layer5_expert3_fc2_gpu1;
layer5_expert3_fc2_gpu1 -> layer5_expert3_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate4_gpu1;
layer5_gate4_gpu1 -> layer5_expert4_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert4_fc1_gpu1;
layer5_expert4_fc1_gpu1 -> layer5_expert4_fc2_gpu1;
layer5_expert4_fc2_gpu1 -> layer5_expert4_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate5_gpu1;
layer5_gate5_gpu1 -> layer5_expert5_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert5_fc1_gpu1;
layer5_expert5_fc1_gpu1 -> layer5_expert5_fc2_gpu1;
layer5_expert5_fc2_gpu1 -> layer5_expert5_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate6_gpu1;
layer5_gate6_gpu1 -> layer5_expert6_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert6_fc1_gpu1;
layer5_expert6_fc1_gpu1 -> layer5_expert6_fc2_gpu1;
layer5_expert6_fc2_gpu1 -> layer5_expert6_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate7_gpu1;
layer5_gate7_gpu1 -> layer5_expert7_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert7_fc1_gpu1;
layer5_expert7_fc1_gpu1 -> layer5_expert7_fc2_gpu1;
layer5_expert7_fc2_gpu1 -> layer5_expert7_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate8_gpu1;
layer5_gate8_gpu1 -> layer5_expert8_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert8_fc1_gpu1;
layer5_expert8_fc1_gpu1 -> layer5_expert8_fc2_gpu1;
layer5_expert8_fc2_gpu1 -> layer5_expert8_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate9_gpu1;
layer5_gate9_gpu1 -> layer5_expert9_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert9_fc1_gpu1;
layer5_expert9_fc1_gpu1 -> layer5_expert9_fc2_gpu1;
layer5_expert9_fc2_gpu1 -> layer5_expert9_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate10_gpu1;
layer5_gate10_gpu1 -> layer5_expert10_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert10_fc1_gpu1;
layer5_expert10_fc1_gpu1 -> layer5_expert10_fc2_gpu1;
layer5_expert10_fc2_gpu1 -> layer5_expert10_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate11_gpu1;
layer5_gate11_gpu1 -> layer5_expert11_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert11_fc1_gpu1;
layer5_expert11_fc1_gpu1 -> layer5_expert11_fc2_gpu1;
layer5_expert11_fc2_gpu1 -> layer5_expert11_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate12_gpu1;
layer5_gate12_gpu1 -> layer5_expert12_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert12_fc1_gpu1;
layer5_expert12_fc1_gpu1 -> layer5_expert12_fc2_gpu1;
layer5_expert12_fc2_gpu1 -> layer5_expert12_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate13_gpu1;
layer5_gate13_gpu1 -> layer5_expert13_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert13_fc1_gpu1;
layer5_expert13_fc1_gpu1 -> layer5_expert13_fc2_gpu1;
layer5_expert13_fc2_gpu1 -> layer5_expert13_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate14_gpu1;
layer5_gate14_gpu1 -> layer5_expert14_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert14_fc1_gpu1;
layer5_expert14_fc1_gpu1 -> layer5_expert14_fc2_gpu1;
layer5_expert14_fc2_gpu1 -> layer5_expert14_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate15_gpu1;
layer5_gate15_gpu1 -> layer5_expert15_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert15_fc1_gpu1;
layer5_expert15_fc1_gpu1 -> layer5_expert15_fc2_gpu1;
layer5_expert15_fc2_gpu1 -> layer5_expert15_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate16_gpu1;
layer5_gate16_gpu1 -> layer5_expert16_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert16_fc1_gpu1;
layer5_expert16_fc1_gpu1 -> layer5_expert16_fc2_gpu1;
layer5_expert16_fc2_gpu1 -> layer5_expert16_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate17_gpu1;
layer5_gate17_gpu1 -> layer5_expert17_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert17_fc1_gpu1;
layer5_expert17_fc1_gpu1 -> layer5_expert17_fc2_gpu1;
layer5_expert17_fc2_gpu1 -> layer5_expert17_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate18_gpu1;
layer5_gate18_gpu1 -> layer5_expert18_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert18_fc1_gpu1;
layer5_expert18_fc1_gpu1 -> layer5_expert18_fc2_gpu1;
layer5_expert18_fc2_gpu1 -> layer5_expert18_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate19_gpu1;
layer5_gate19_gpu1 -> layer5_expert19_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert19_fc1_gpu1;
layer5_expert19_fc1_gpu1 -> layer5_expert19_fc2_gpu1;
layer5_expert19_fc2_gpu1 -> layer5_expert19_add_gpu1;
layer5_ln1_gpu1 -> layer5_gate20_gpu1;
layer5_gate20_gpu1 -> layer5_expert20_fc1_gpu1 [style=dashed];
layer5_ln1_gpu1 -> layer5_expert20_fc1_gpu1;
layer5_expert20_fc1_gpu1 -> layer5_expert20_fc2_gpu1;
layer5_expert20_fc2_gpu1 -> layer5_expert20_add_gpu1;
layer5_expert20_add_gpu1 -> layer6_att_in_gpu1;
layer5_ln1_gpu2 -> layer5_gate0_gpu2;
layer5_gate0_gpu2 -> layer5_expert0_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert0_fc1_gpu2;
layer5_expert0_fc1_gpu2 -> layer5_expert0_fc2_gpu2;
layer5_expert0_fc2_gpu2 -> layer5_expert0_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate1_gpu2;
layer5_gate1_gpu2 -> layer5_expert1_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert1_fc1_gpu2;
layer5_expert1_fc1_gpu2 -> layer5_expert1_fc2_gpu2;
layer5_expert1_fc2_gpu2 -> layer5_expert1_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate2_gpu2;
layer5_gate2_gpu2 -> layer5_expert2_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert2_fc1_gpu2;
layer5_expert2_fc1_gpu2 -> layer5_expert2_fc2_gpu2;
layer5_expert2_fc2_gpu2 -> layer5_expert2_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate3_gpu2;
layer5_gate3_gpu2 -> layer5_expert3_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert3_fc1_gpu2;
layer5_expert3_fc1_gpu2 -> layer5_expert3_fc2_gpu2;
layer5_expert3_fc2_gpu2 -> layer5_expert3_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate4_gpu2;
layer5_gate4_gpu2 -> layer5_expert4_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert4_fc1_gpu2;
layer5_expert4_fc1_gpu2 -> layer5_expert4_fc2_gpu2;
layer5_expert4_fc2_gpu2 -> layer5_expert4_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate5_gpu2;
layer5_gate5_gpu2 -> layer5_expert5_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert5_fc1_gpu2;
layer5_expert5_fc1_gpu2 -> layer5_expert5_fc2_gpu2;
layer5_expert5_fc2_gpu2 -> layer5_expert5_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate6_gpu2;
layer5_gate6_gpu2 -> layer5_expert6_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert6_fc1_gpu2;
layer5_expert6_fc1_gpu2 -> layer5_expert6_fc2_gpu2;
layer5_expert6_fc2_gpu2 -> layer5_expert6_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate7_gpu2;
layer5_gate7_gpu2 -> layer5_expert7_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert7_fc1_gpu2;
layer5_expert7_fc1_gpu2 -> layer5_expert7_fc2_gpu2;
layer5_expert7_fc2_gpu2 -> layer5_expert7_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate8_gpu2;
layer5_gate8_gpu2 -> layer5_expert8_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert8_fc1_gpu2;
layer5_expert8_fc1_gpu2 -> layer5_expert8_fc2_gpu2;
layer5_expert8_fc2_gpu2 -> layer5_expert8_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate9_gpu2;
layer5_gate9_gpu2 -> layer5_expert9_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert9_fc1_gpu2;
layer5_expert9_fc1_gpu2 -> layer5_expert9_fc2_gpu2;
layer5_expert9_fc2_gpu2 -> layer5_expert9_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate10_gpu2;
layer5_gate10_gpu2 -> layer5_expert10_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert10_fc1_gpu2;
layer5_expert10_fc1_gpu2 -> layer5_expert10_fc2_gpu2;
layer5_expert10_fc2_gpu2 -> layer5_expert10_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate11_gpu2;
layer5_gate11_gpu2 -> layer5_expert11_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert11_fc1_gpu2;
layer5_expert11_fc1_gpu2 -> layer5_expert11_fc2_gpu2;
layer5_expert11_fc2_gpu2 -> layer5_expert11_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate12_gpu2;
layer5_gate12_gpu2 -> layer5_expert12_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert12_fc1_gpu2;
layer5_expert12_fc1_gpu2 -> layer5_expert12_fc2_gpu2;
layer5_expert12_fc2_gpu2 -> layer5_expert12_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate13_gpu2;
layer5_gate13_gpu2 -> layer5_expert13_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert13_fc1_gpu2;
layer5_expert13_fc1_gpu2 -> layer5_expert13_fc2_gpu2;
layer5_expert13_fc2_gpu2 -> layer5_expert13_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate14_gpu2;
layer5_gate14_gpu2 -> layer5_expert14_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert14_fc1_gpu2;
layer5_expert14_fc1_gpu2 -> layer5_expert14_fc2_gpu2;
layer5_expert14_fc2_gpu2 -> layer5_expert14_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate15_gpu2;
layer5_gate15_gpu2 -> layer5_expert15_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert15_fc1_gpu2;
layer5_expert15_fc1_gpu2 -> layer5_expert15_fc2_gpu2;
layer5_expert15_fc2_gpu2 -> layer5_expert15_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate16_gpu2;
layer5_gate16_gpu2 -> layer5_expert16_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert16_fc1_gpu2;
layer5_expert16_fc1_gpu2 -> layer5_expert16_fc2_gpu2;
layer5_expert16_fc2_gpu2 -> layer5_expert16_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate17_gpu2;
layer5_gate17_gpu2 -> layer5_expert17_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert17_fc1_gpu2;
layer5_expert17_fc1_gpu2 -> layer5_expert17_fc2_gpu2;
layer5_expert17_fc2_gpu2 -> layer5_expert17_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate18_gpu2;
layer5_gate18_gpu2 -> layer5_expert18_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert18_fc1_gpu2;
layer5_expert18_fc1_gpu2 -> layer5_expert18_fc2_gpu2;
layer5_expert18_fc2_gpu2 -> layer5_expert18_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate19_gpu2;
layer5_gate19_gpu2 -> layer5_expert19_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert19_fc1_gpu2;
layer5_expert19_fc1_gpu2 -> layer5_expert19_fc2_gpu2;
layer5_expert19_fc2_gpu2 -> layer5_expert19_add_gpu2;
layer5_ln1_gpu2 -> layer5_gate20_gpu2;
layer5_gate20_gpu2 -> layer5_expert20_fc1_gpu2 [style=dashed];
layer5_ln1_gpu2 -> layer5_expert20_fc1_gpu2;
layer5_expert20_fc1_gpu2 -> layer5_expert20_fc2_gpu2;
layer5_expert20_fc2_gpu2 -> layer5_expert20_add_gpu2;
layer5_expert20_add_gpu2 -> layer6_att_in_gpu2;
input -> layer6_att_in_gpu0;
layer6_att_in_gpu0 -> layer6_qkv0_gpu0;
layer6_att_in_gpu0 -> layer6_qkv1_gpu0;
layer6_qkv0_gpu0 -> layer6_attout0_gpu0;
layer6_qkv1_gpu0 -> layer6_attout1_gpu0;
layer6_attout0_gpu0 -> layer6_att_agg_gpu0;
layer6_attout1_gpu0 -> layer6_att_agg_gpu0;
layer6_att_agg_gpu0 -> layer6_res1_gpu0;
layer6_res1_gpu0 -> layer6_ln1_gpu0;
input -> layer6_att_in_gpu1;
layer6_att_in_gpu1 -> layer6_qkv0_gpu1;
layer6_att_in_gpu1 -> layer6_qkv1_gpu1;
layer6_qkv0_gpu1 -> layer6_attout0_gpu1;
layer6_qkv1_gpu1 -> layer6_attout1_gpu1;
layer6_attout0_gpu1 -> layer6_att_agg_gpu1;
layer6_attout1_gpu1 -> layer6_att_agg_gpu1;
layer6_att_agg_gpu1 -> layer6_res1_gpu1;
layer6_res1_gpu1 -> layer6_ln1_gpu1;
input -> layer6_att_in_gpu2;
layer6_att_in_gpu2 -> layer6_qkv0_gpu2;
layer6_att_in_gpu2 -> layer6_qkv1_gpu2;
layer6_qkv0_gpu2 -> layer6_attout0_gpu2;
layer6_qkv1_gpu2 -> layer6_attout1_gpu2;
layer6_attout0_gpu2 -> layer6_att_agg_gpu2;
layer6_attout1_gpu2 -> layer6_att_agg_gpu2;
layer6_att_agg_gpu2 -> layer6_res1_gpu2;
layer6_res1_gpu2 -> layer6_ln1_gpu2;
layer6_ln1_gpu0 -> layer6_gate0_gpu0;
layer6_gate0_gpu0 -> layer6_expert0_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert0_fc1_gpu0;
layer6_expert0_fc1_gpu0 -> layer6_expert0_fc2_gpu0;
layer6_expert0_fc2_gpu0 -> layer6_expert0_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate1_gpu0;
layer6_gate1_gpu0 -> layer6_expert1_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert1_fc1_gpu0;
layer6_expert1_fc1_gpu0 -> layer6_expert1_fc2_gpu0;
layer6_expert1_fc2_gpu0 -> layer6_expert1_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate2_gpu0;
layer6_gate2_gpu0 -> layer6_expert2_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert2_fc1_gpu0;
layer6_expert2_fc1_gpu0 -> layer6_expert2_fc2_gpu0;
layer6_expert2_fc2_gpu0 -> layer6_expert2_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate3_gpu0;
layer6_gate3_gpu0 -> layer6_expert3_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert3_fc1_gpu0;
layer6_expert3_fc1_gpu0 -> layer6_expert3_fc2_gpu0;
layer6_expert3_fc2_gpu0 -> layer6_expert3_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate4_gpu0;
layer6_gate4_gpu0 -> layer6_expert4_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert4_fc1_gpu0;
layer6_expert4_fc1_gpu0 -> layer6_expert4_fc2_gpu0;
layer6_expert4_fc2_gpu0 -> layer6_expert4_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate5_gpu0;
layer6_gate5_gpu0 -> layer6_expert5_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert5_fc1_gpu0;
layer6_expert5_fc1_gpu0 -> layer6_expert5_fc2_gpu0;
layer6_expert5_fc2_gpu0 -> layer6_expert5_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate6_gpu0;
layer6_gate6_gpu0 -> layer6_expert6_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert6_fc1_gpu0;
layer6_expert6_fc1_gpu0 -> layer6_expert6_fc2_gpu0;
layer6_expert6_fc2_gpu0 -> layer6_expert6_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate7_gpu0;
layer6_gate7_gpu0 -> layer6_expert7_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert7_fc1_gpu0;
layer6_expert7_fc1_gpu0 -> layer6_expert7_fc2_gpu0;
layer6_expert7_fc2_gpu0 -> layer6_expert7_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate8_gpu0;
layer6_gate8_gpu0 -> layer6_expert8_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert8_fc1_gpu0;
layer6_expert8_fc1_gpu0 -> layer6_expert8_fc2_gpu0;
layer6_expert8_fc2_gpu0 -> layer6_expert8_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate9_gpu0;
layer6_gate9_gpu0 -> layer6_expert9_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert9_fc1_gpu0;
layer6_expert9_fc1_gpu0 -> layer6_expert9_fc2_gpu0;
layer6_expert9_fc2_gpu0 -> layer6_expert9_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate10_gpu0;
layer6_gate10_gpu0 -> layer6_expert10_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert10_fc1_gpu0;
layer6_expert10_fc1_gpu0 -> layer6_expert10_fc2_gpu0;
layer6_expert10_fc2_gpu0 -> layer6_expert10_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate11_gpu0;
layer6_gate11_gpu0 -> layer6_expert11_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert11_fc1_gpu0;
layer6_expert11_fc1_gpu0 -> layer6_expert11_fc2_gpu0;
layer6_expert11_fc2_gpu0 -> layer6_expert11_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate12_gpu0;
layer6_gate12_gpu0 -> layer6_expert12_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert12_fc1_gpu0;
layer6_expert12_fc1_gpu0 -> layer6_expert12_fc2_gpu0;
layer6_expert12_fc2_gpu0 -> layer6_expert12_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate13_gpu0;
layer6_gate13_gpu0 -> layer6_expert13_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert13_fc1_gpu0;
layer6_expert13_fc1_gpu0 -> layer6_expert13_fc2_gpu0;
layer6_expert13_fc2_gpu0 -> layer6_expert13_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate14_gpu0;
layer6_gate14_gpu0 -> layer6_expert14_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert14_fc1_gpu0;
layer6_expert14_fc1_gpu0 -> layer6_expert14_fc2_gpu0;
layer6_expert14_fc2_gpu0 -> layer6_expert14_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate15_gpu0;
layer6_gate15_gpu0 -> layer6_expert15_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert15_fc1_gpu0;
layer6_expert15_fc1_gpu0 -> layer6_expert15_fc2_gpu0;
layer6_expert15_fc2_gpu0 -> layer6_expert15_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate16_gpu0;
layer6_gate16_gpu0 -> layer6_expert16_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert16_fc1_gpu0;
layer6_expert16_fc1_gpu0 -> layer6_expert16_fc2_gpu0;
layer6_expert16_fc2_gpu0 -> layer6_expert16_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate17_gpu0;
layer6_gate17_gpu0 -> layer6_expert17_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert17_fc1_gpu0;
layer6_expert17_fc1_gpu0 -> layer6_expert17_fc2_gpu0;
layer6_expert17_fc2_gpu0 -> layer6_expert17_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate18_gpu0;
layer6_gate18_gpu0 -> layer6_expert18_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert18_fc1_gpu0;
layer6_expert18_fc1_gpu0 -> layer6_expert18_fc2_gpu0;
layer6_expert18_fc2_gpu0 -> layer6_expert18_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate19_gpu0;
layer6_gate19_gpu0 -> layer6_expert19_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert19_fc1_gpu0;
layer6_expert19_fc1_gpu0 -> layer6_expert19_fc2_gpu0;
layer6_expert19_fc2_gpu0 -> layer6_expert19_add_gpu0;
layer6_ln1_gpu0 -> layer6_gate20_gpu0;
layer6_gate20_gpu0 -> layer6_expert20_fc1_gpu0 [style=dashed];
layer6_ln1_gpu0 -> layer6_expert20_fc1_gpu0;
layer6_expert20_fc1_gpu0 -> layer6_expert20_fc2_gpu0;
layer6_expert20_fc2_gpu0 -> layer6_expert20_add_gpu0;
layer6_expert20_add_gpu0 -> layer7_att_in_gpu0;
layer6_ln1_gpu1 -> layer6_gate0_gpu1;
layer6_gate0_gpu1 -> layer6_expert0_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert0_fc1_gpu1;
layer6_expert0_fc1_gpu1 -> layer6_expert0_fc2_gpu1;
layer6_expert0_fc2_gpu1 -> layer6_expert0_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate1_gpu1;
layer6_gate1_gpu1 -> layer6_expert1_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert1_fc1_gpu1;
layer6_expert1_fc1_gpu1 -> layer6_expert1_fc2_gpu1;
layer6_expert1_fc2_gpu1 -> layer6_expert1_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate2_gpu1;
layer6_gate2_gpu1 -> layer6_expert2_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert2_fc1_gpu1;
layer6_expert2_fc1_gpu1 -> layer6_expert2_fc2_gpu1;
layer6_expert2_fc2_gpu1 -> layer6_expert2_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate3_gpu1;
layer6_gate3_gpu1 -> layer6_expert3_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert3_fc1_gpu1;
layer6_expert3_fc1_gpu1 -> layer6_expert3_fc2_gpu1;
layer6_expert3_fc2_gpu1 -> layer6_expert3_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate4_gpu1;
layer6_gate4_gpu1 -> layer6_expert4_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert4_fc1_gpu1;
layer6_expert4_fc1_gpu1 -> layer6_expert4_fc2_gpu1;
layer6_expert4_fc2_gpu1 -> layer6_expert4_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate5_gpu1;
layer6_gate5_gpu1 -> layer6_expert5_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert5_fc1_gpu1;
layer6_expert5_fc1_gpu1 -> layer6_expert5_fc2_gpu1;
layer6_expert5_fc2_gpu1 -> layer6_expert5_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate6_gpu1;
layer6_gate6_gpu1 -> layer6_expert6_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert6_fc1_gpu1;
layer6_expert6_fc1_gpu1 -> layer6_expert6_fc2_gpu1;
layer6_expert6_fc2_gpu1 -> layer6_expert6_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate7_gpu1;
layer6_gate7_gpu1 -> layer6_expert7_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert7_fc1_gpu1;
layer6_expert7_fc1_gpu1 -> layer6_expert7_fc2_gpu1;
layer6_expert7_fc2_gpu1 -> layer6_expert7_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate8_gpu1;
layer6_gate8_gpu1 -> layer6_expert8_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert8_fc1_gpu1;
layer6_expert8_fc1_gpu1 -> layer6_expert8_fc2_gpu1;
layer6_expert8_fc2_gpu1 -> layer6_expert8_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate9_gpu1;
layer6_gate9_gpu1 -> layer6_expert9_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert9_fc1_gpu1;
layer6_expert9_fc1_gpu1 -> layer6_expert9_fc2_gpu1;
layer6_expert9_fc2_gpu1 -> layer6_expert9_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate10_gpu1;
layer6_gate10_gpu1 -> layer6_expert10_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert10_fc1_gpu1;
layer6_expert10_fc1_gpu1 -> layer6_expert10_fc2_gpu1;
layer6_expert10_fc2_gpu1 -> layer6_expert10_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate11_gpu1;
layer6_gate11_gpu1 -> layer6_expert11_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert11_fc1_gpu1;
layer6_expert11_fc1_gpu1 -> layer6_expert11_fc2_gpu1;
layer6_expert11_fc2_gpu1 -> layer6_expert11_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate12_gpu1;
layer6_gate12_gpu1 -> layer6_expert12_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert12_fc1_gpu1;
layer6_expert12_fc1_gpu1 -> layer6_expert12_fc2_gpu1;
layer6_expert12_fc2_gpu1 -> layer6_expert12_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate13_gpu1;
layer6_gate13_gpu1 -> layer6_expert13_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert13_fc1_gpu1;
layer6_expert13_fc1_gpu1 -> layer6_expert13_fc2_gpu1;
layer6_expert13_fc2_gpu1 -> layer6_expert13_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate14_gpu1;
layer6_gate14_gpu1 -> layer6_expert14_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert14_fc1_gpu1;
layer6_expert14_fc1_gpu1 -> layer6_expert14_fc2_gpu1;
layer6_expert14_fc2_gpu1 -> layer6_expert14_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate15_gpu1;
layer6_gate15_gpu1 -> layer6_expert15_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert15_fc1_gpu1;
layer6_expert15_fc1_gpu1 -> layer6_expert15_fc2_gpu1;
layer6_expert15_fc2_gpu1 -> layer6_expert15_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate16_gpu1;
layer6_gate16_gpu1 -> layer6_expert16_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert16_fc1_gpu1;
layer6_expert16_fc1_gpu1 -> layer6_expert16_fc2_gpu1;
layer6_expert16_fc2_gpu1 -> layer6_expert16_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate17_gpu1;
layer6_gate17_gpu1 -> layer6_expert17_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert17_fc1_gpu1;
layer6_expert17_fc1_gpu1 -> layer6_expert17_fc2_gpu1;
layer6_expert17_fc2_gpu1 -> layer6_expert17_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate18_gpu1;
layer6_gate18_gpu1 -> layer6_expert18_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert18_fc1_gpu1;
layer6_expert18_fc1_gpu1 -> layer6_expert18_fc2_gpu1;
layer6_expert18_fc2_gpu1 -> layer6_expert18_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate19_gpu1;
layer6_gate19_gpu1 -> layer6_expert19_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert19_fc1_gpu1;
layer6_expert19_fc1_gpu1 -> layer6_expert19_fc2_gpu1;
layer6_expert19_fc2_gpu1 -> layer6_expert19_add_gpu1;
layer6_ln1_gpu1 -> layer6_gate20_gpu1;
layer6_gate20_gpu1 -> layer6_expert20_fc1_gpu1 [style=dashed];
layer6_ln1_gpu1 -> layer6_expert20_fc1_gpu1;
layer6_expert20_fc1_gpu1 -> layer6_expert20_fc2_gpu1;
layer6_expert20_fc2_gpu1 -> layer6_expert20_add_gpu1;
layer6_expert20_add_gpu1 -> layer7_att_in_gpu1;
layer6_ln1_gpu2 -> layer6_gate0_gpu2;
layer6_gate0_gpu2 -> layer6_expert0_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert0_fc1_gpu2;
layer6_expert0_fc1_gpu2 -> layer6_expert0_fc2_gpu2;
layer6_expert0_fc2_gpu2 -> layer6_expert0_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate1_gpu2;
layer6_gate1_gpu2 -> layer6_expert1_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert1_fc1_gpu2;
layer6_expert1_fc1_gpu2 -> layer6_expert1_fc2_gpu2;
layer6_expert1_fc2_gpu2 -> layer6_expert1_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate2_gpu2;
layer6_gate2_gpu2 -> layer6_expert2_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert2_fc1_gpu2;
layer6_expert2_fc1_gpu2 -> layer6_expert2_fc2_gpu2;
layer6_expert2_fc2_gpu2 -> layer6_expert2_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate3_gpu2;
layer6_gate3_gpu2 -> layer6_expert3_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert3_fc1_gpu2;
layer6_expert3_fc1_gpu2 -> layer6_expert3_fc2_gpu2;
layer6_expert3_fc2_gpu2 -> layer6_expert3_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate4_gpu2;
layer6_gate4_gpu2 -> layer6_expert4_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert4_fc1_gpu2;
layer6_expert4_fc1_gpu2 -> layer6_expert4_fc2_gpu2;
layer6_expert4_fc2_gpu2 -> layer6_expert4_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate5_gpu2;
layer6_gate5_gpu2 -> layer6_expert5_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert5_fc1_gpu2;
layer6_expert5_fc1_gpu2 -> layer6_expert5_fc2_gpu2;
layer6_expert5_fc2_gpu2 -> layer6_expert5_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate6_gpu2;
layer6_gate6_gpu2 -> layer6_expert6_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert6_fc1_gpu2;
layer6_expert6_fc1_gpu2 -> layer6_expert6_fc2_gpu2;
layer6_expert6_fc2_gpu2 -> layer6_expert6_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate7_gpu2;
layer6_gate7_gpu2 -> layer6_expert7_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert7_fc1_gpu2;
layer6_expert7_fc1_gpu2 -> layer6_expert7_fc2_gpu2;
layer6_expert7_fc2_gpu2 -> layer6_expert7_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate8_gpu2;
layer6_gate8_gpu2 -> layer6_expert8_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert8_fc1_gpu2;
layer6_expert8_fc1_gpu2 -> layer6_expert8_fc2_gpu2;
layer6_expert8_fc2_gpu2 -> layer6_expert8_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate9_gpu2;
layer6_gate9_gpu2 -> layer6_expert9_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert9_fc1_gpu2;
layer6_expert9_fc1_gpu2 -> layer6_expert9_fc2_gpu2;
layer6_expert9_fc2_gpu2 -> layer6_expert9_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate10_gpu2;
layer6_gate10_gpu2 -> layer6_expert10_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert10_fc1_gpu2;
layer6_expert10_fc1_gpu2 -> layer6_expert10_fc2_gpu2;
layer6_expert10_fc2_gpu2 -> layer6_expert10_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate11_gpu2;
layer6_gate11_gpu2 -> layer6_expert11_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert11_fc1_gpu2;
layer6_expert11_fc1_gpu2 -> layer6_expert11_fc2_gpu2;
layer6_expert11_fc2_gpu2 -> layer6_expert11_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate12_gpu2;
layer6_gate12_gpu2 -> layer6_expert12_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert12_fc1_gpu2;
layer6_expert12_fc1_gpu2 -> layer6_expert12_fc2_gpu2;
layer6_expert12_fc2_gpu2 -> layer6_expert12_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate13_gpu2;
layer6_gate13_gpu2 -> layer6_expert13_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert13_fc1_gpu2;
layer6_expert13_fc1_gpu2 -> layer6_expert13_fc2_gpu2;
layer6_expert13_fc2_gpu2 -> layer6_expert13_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate14_gpu2;
layer6_gate14_gpu2 -> layer6_expert14_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert14_fc1_gpu2;
layer6_expert14_fc1_gpu2 -> layer6_expert14_fc2_gpu2;
layer6_expert14_fc2_gpu2 -> layer6_expert14_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate15_gpu2;
layer6_gate15_gpu2 -> layer6_expert15_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert15_fc1_gpu2;
layer6_expert15_fc1_gpu2 -> layer6_expert15_fc2_gpu2;
layer6_expert15_fc2_gpu2 -> layer6_expert15_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate16_gpu2;
layer6_gate16_gpu2 -> layer6_expert16_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert16_fc1_gpu2;
layer6_expert16_fc1_gpu2 -> layer6_expert16_fc2_gpu2;
layer6_expert16_fc2_gpu2 -> layer6_expert16_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate17_gpu2;
layer6_gate17_gpu2 -> layer6_expert17_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert17_fc1_gpu2;
layer6_expert17_fc1_gpu2 -> layer6_expert17_fc2_gpu2;
layer6_expert17_fc2_gpu2 -> layer6_expert17_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate18_gpu2;
layer6_gate18_gpu2 -> layer6_expert18_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert18_fc1_gpu2;
layer6_expert18_fc1_gpu2 -> layer6_expert18_fc2_gpu2;
layer6_expert18_fc2_gpu2 -> layer6_expert18_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate19_gpu2;
layer6_gate19_gpu2 -> layer6_expert19_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert19_fc1_gpu2;
layer6_expert19_fc1_gpu2 -> layer6_expert19_fc2_gpu2;
layer6_expert19_fc2_gpu2 -> layer6_expert19_add_gpu2;
layer6_ln1_gpu2 -> layer6_gate20_gpu2;
layer6_gate20_gpu2 -> layer6_expert20_fc1_gpu2 [style=dashed];
layer6_ln1_gpu2 -> layer6_expert20_fc1_gpu2;
layer6_expert20_fc1_gpu2 -> layer6_expert20_fc2_gpu2;
layer6_expert20_fc2_gpu2 -> layer6_expert20_add_gpu2;
layer6_expert20_add_gpu2 -> layer7_att_in_gpu2;
input -> layer7_att_in_gpu0;
layer7_att_in_gpu0 -> layer7_qkv0_gpu0;
layer7_att_in_gpu0 -> layer7_qkv1_gpu0;
layer7_qkv0_gpu0 -> layer7_attout0_gpu0;
layer7_qkv1_gpu0 -> layer7_attout1_gpu0;
layer7_attout0_gpu0 -> layer7_att_agg_gpu0;
layer7_attout1_gpu0 -> layer7_att_agg_gpu0;
layer7_att_agg_gpu0 -> layer7_res1_gpu0;
layer7_res1_gpu0 -> layer7_ln1_gpu0;
input -> layer7_att_in_gpu1;
layer7_att_in_gpu1 -> layer7_qkv0_gpu1;
layer7_att_in_gpu1 -> layer7_qkv1_gpu1;
layer7_qkv0_gpu1 -> layer7_attout0_gpu1;
layer7_qkv1_gpu1 -> layer7_attout1_gpu1;
layer7_attout0_gpu1 -> layer7_att_agg_gpu1;
layer7_attout1_gpu1 -> layer7_att_agg_gpu1;
layer7_att_agg_gpu1 -> layer7_res1_gpu1;
layer7_res1_gpu1 -> layer7_ln1_gpu1;
input -> layer7_att_in_gpu2;
layer7_att_in_gpu2 -> layer7_qkv0_gpu2;
layer7_att_in_gpu2 -> layer7_qkv1_gpu2;
layer7_qkv0_gpu2 -> layer7_attout0_gpu2;
layer7_qkv1_gpu2 -> layer7_attout1_gpu2;
layer7_attout0_gpu2 -> layer7_att_agg_gpu2;
layer7_attout1_gpu2 -> layer7_att_agg_gpu2;
layer7_att_agg_gpu2 -> layer7_res1_gpu2;
layer7_res1_gpu2 -> layer7_ln1_gpu2;
layer7_ln1_gpu0 -> layer7_gate0_gpu0;
layer7_gate0_gpu0 -> layer7_expert0_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert0_fc1_gpu0;
layer7_expert0_fc1_gpu0 -> layer7_expert0_fc2_gpu0;
layer7_expert0_fc2_gpu0 -> layer7_expert0_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate1_gpu0;
layer7_gate1_gpu0 -> layer7_expert1_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert1_fc1_gpu0;
layer7_expert1_fc1_gpu0 -> layer7_expert1_fc2_gpu0;
layer7_expert1_fc2_gpu0 -> layer7_expert1_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate2_gpu0;
layer7_gate2_gpu0 -> layer7_expert2_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert2_fc1_gpu0;
layer7_expert2_fc1_gpu0 -> layer7_expert2_fc2_gpu0;
layer7_expert2_fc2_gpu0 -> layer7_expert2_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate3_gpu0;
layer7_gate3_gpu0 -> layer7_expert3_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert3_fc1_gpu0;
layer7_expert3_fc1_gpu0 -> layer7_expert3_fc2_gpu0;
layer7_expert3_fc2_gpu0 -> layer7_expert3_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate4_gpu0;
layer7_gate4_gpu0 -> layer7_expert4_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert4_fc1_gpu0;
layer7_expert4_fc1_gpu0 -> layer7_expert4_fc2_gpu0;
layer7_expert4_fc2_gpu0 -> layer7_expert4_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate5_gpu0;
layer7_gate5_gpu0 -> layer7_expert5_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert5_fc1_gpu0;
layer7_expert5_fc1_gpu0 -> layer7_expert5_fc2_gpu0;
layer7_expert5_fc2_gpu0 -> layer7_expert5_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate6_gpu0;
layer7_gate6_gpu0 -> layer7_expert6_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert6_fc1_gpu0;
layer7_expert6_fc1_gpu0 -> layer7_expert6_fc2_gpu0;
layer7_expert6_fc2_gpu0 -> layer7_expert6_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate7_gpu0;
layer7_gate7_gpu0 -> layer7_expert7_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert7_fc1_gpu0;
layer7_expert7_fc1_gpu0 -> layer7_expert7_fc2_gpu0;
layer7_expert7_fc2_gpu0 -> layer7_expert7_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate8_gpu0;
layer7_gate8_gpu0 -> layer7_expert8_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert8_fc1_gpu0;
layer7_expert8_fc1_gpu0 -> layer7_expert8_fc2_gpu0;
layer7_expert8_fc2_gpu0 -> layer7_expert8_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate9_gpu0;
layer7_gate9_gpu0 -> layer7_expert9_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert9_fc1_gpu0;
layer7_expert9_fc1_gpu0 -> layer7_expert9_fc2_gpu0;
layer7_expert9_fc2_gpu0 -> layer7_expert9_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate10_gpu0;
layer7_gate10_gpu0 -> layer7_expert10_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert10_fc1_gpu0;
layer7_expert10_fc1_gpu0 -> layer7_expert10_fc2_gpu0;
layer7_expert10_fc2_gpu0 -> layer7_expert10_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate11_gpu0;
layer7_gate11_gpu0 -> layer7_expert11_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert11_fc1_gpu0;
layer7_expert11_fc1_gpu0 -> layer7_expert11_fc2_gpu0;
layer7_expert11_fc2_gpu0 -> layer7_expert11_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate12_gpu0;
layer7_gate12_gpu0 -> layer7_expert12_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert12_fc1_gpu0;
layer7_expert12_fc1_gpu0 -> layer7_expert12_fc2_gpu0;
layer7_expert12_fc2_gpu0 -> layer7_expert12_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate13_gpu0;
layer7_gate13_gpu0 -> layer7_expert13_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert13_fc1_gpu0;
layer7_expert13_fc1_gpu0 -> layer7_expert13_fc2_gpu0;
layer7_expert13_fc2_gpu0 -> layer7_expert13_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate14_gpu0;
layer7_gate14_gpu0 -> layer7_expert14_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert14_fc1_gpu0;
layer7_expert14_fc1_gpu0 -> layer7_expert14_fc2_gpu0;
layer7_expert14_fc2_gpu0 -> layer7_expert14_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate15_gpu0;
layer7_gate15_gpu0 -> layer7_expert15_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert15_fc1_gpu0;
layer7_expert15_fc1_gpu0 -> layer7_expert15_fc2_gpu0;
layer7_expert15_fc2_gpu0 -> layer7_expert15_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate16_gpu0;
layer7_gate16_gpu0 -> layer7_expert16_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert16_fc1_gpu0;
layer7_expert16_fc1_gpu0 -> layer7_expert16_fc2_gpu0;
layer7_expert16_fc2_gpu0 -> layer7_expert16_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate17_gpu0;
layer7_gate17_gpu0 -> layer7_expert17_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert17_fc1_gpu0;
layer7_expert17_fc1_gpu0 -> layer7_expert17_fc2_gpu0;
layer7_expert17_fc2_gpu0 -> layer7_expert17_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate18_gpu0;
layer7_gate18_gpu0 -> layer7_expert18_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert18_fc1_gpu0;
layer7_expert18_fc1_gpu0 -> layer7_expert18_fc2_gpu0;
layer7_expert18_fc2_gpu0 -> layer7_expert18_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate19_gpu0;
layer7_gate19_gpu0 -> layer7_expert19_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert19_fc1_gpu0;
layer7_expert19_fc1_gpu0 -> layer7_expert19_fc2_gpu0;
layer7_expert19_fc2_gpu0 -> layer7_expert19_add_gpu0;
layer7_ln1_gpu0 -> layer7_gate20_gpu0;
layer7_gate20_gpu0 -> layer7_expert20_fc1_gpu0 [style=dashed];
layer7_ln1_gpu0 -> layer7_expert20_fc1_gpu0;
layer7_expert20_fc1_gpu0 -> layer7_expert20_fc2_gpu0;
layer7_expert20_fc2_gpu0 -> layer7_expert20_add_gpu0;
layer7_expert20_add_gpu0 -> layer8_att_in_gpu0;
layer7_ln1_gpu1 -> layer7_gate0_gpu1;
layer7_gate0_gpu1 -> layer7_expert0_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert0_fc1_gpu1;
layer7_expert0_fc1_gpu1 -> layer7_expert0_fc2_gpu1;
layer7_expert0_fc2_gpu1 -> layer7_expert0_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate1_gpu1;
layer7_gate1_gpu1 -> layer7_expert1_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert1_fc1_gpu1;
layer7_expert1_fc1_gpu1 -> layer7_expert1_fc2_gpu1;
layer7_expert1_fc2_gpu1 -> layer7_expert1_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate2_gpu1;
layer7_gate2_gpu1 -> layer7_expert2_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert2_fc1_gpu1;
layer7_expert2_fc1_gpu1 -> layer7_expert2_fc2_gpu1;
layer7_expert2_fc2_gpu1 -> layer7_expert2_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate3_gpu1;
layer7_gate3_gpu1 -> layer7_expert3_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert3_fc1_gpu1;
layer7_expert3_fc1_gpu1 -> layer7_expert3_fc2_gpu1;
layer7_expert3_fc2_gpu1 -> layer7_expert3_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate4_gpu1;
layer7_gate4_gpu1 -> layer7_expert4_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert4_fc1_gpu1;
layer7_expert4_fc1_gpu1 -> layer7_expert4_fc2_gpu1;
layer7_expert4_fc2_gpu1 -> layer7_expert4_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate5_gpu1;
layer7_gate5_gpu1 -> layer7_expert5_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert5_fc1_gpu1;
layer7_expert5_fc1_gpu1 -> layer7_expert5_fc2_gpu1;
layer7_expert5_fc2_gpu1 -> layer7_expert5_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate6_gpu1;
layer7_gate6_gpu1 -> layer7_expert6_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert6_fc1_gpu1;
layer7_expert6_fc1_gpu1 -> layer7_expert6_fc2_gpu1;
layer7_expert6_fc2_gpu1 -> layer7_expert6_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate7_gpu1;
layer7_gate7_gpu1 -> layer7_expert7_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert7_fc1_gpu1;
layer7_expert7_fc1_gpu1 -> layer7_expert7_fc2_gpu1;
layer7_expert7_fc2_gpu1 -> layer7_expert7_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate8_gpu1;
layer7_gate8_gpu1 -> layer7_expert8_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert8_fc1_gpu1;
layer7_expert8_fc1_gpu1 -> layer7_expert8_fc2_gpu1;
layer7_expert8_fc2_gpu1 -> layer7_expert8_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate9_gpu1;
layer7_gate9_gpu1 -> layer7_expert9_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert9_fc1_gpu1;
layer7_expert9_fc1_gpu1 -> layer7_expert9_fc2_gpu1;
layer7_expert9_fc2_gpu1 -> layer7_expert9_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate10_gpu1;
layer7_gate10_gpu1 -> layer7_expert10_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert10_fc1_gpu1;
layer7_expert10_fc1_gpu1 -> layer7_expert10_fc2_gpu1;
layer7_expert10_fc2_gpu1 -> layer7_expert10_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate11_gpu1;
layer7_gate11_gpu1 -> layer7_expert11_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert11_fc1_gpu1;
layer7_expert11_fc1_gpu1 -> layer7_expert11_fc2_gpu1;
layer7_expert11_fc2_gpu1 -> layer7_expert11_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate12_gpu1;
layer7_gate12_gpu1 -> layer7_expert12_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert12_fc1_gpu1;
layer7_expert12_fc1_gpu1 -> layer7_expert12_fc2_gpu1;
layer7_expert12_fc2_gpu1 -> layer7_expert12_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate13_gpu1;
layer7_gate13_gpu1 -> layer7_expert13_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert13_fc1_gpu1;
layer7_expert13_fc1_gpu1 -> layer7_expert13_fc2_gpu1;
layer7_expert13_fc2_gpu1 -> layer7_expert13_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate14_gpu1;
layer7_gate14_gpu1 -> layer7_expert14_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert14_fc1_gpu1;
layer7_expert14_fc1_gpu1 -> layer7_expert14_fc2_gpu1;
layer7_expert14_fc2_gpu1 -> layer7_expert14_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate15_gpu1;
layer7_gate15_gpu1 -> layer7_expert15_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert15_fc1_gpu1;
layer7_expert15_fc1_gpu1 -> layer7_expert15_fc2_gpu1;
layer7_expert15_fc2_gpu1 -> layer7_expert15_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate16_gpu1;
layer7_gate16_gpu1 -> layer7_expert16_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert16_fc1_gpu1;
layer7_expert16_fc1_gpu1 -> layer7_expert16_fc2_gpu1;
layer7_expert16_fc2_gpu1 -> layer7_expert16_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate17_gpu1;
layer7_gate17_gpu1 -> layer7_expert17_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert17_fc1_gpu1;
layer7_expert17_fc1_gpu1 -> layer7_expert17_fc2_gpu1;
layer7_expert17_fc2_gpu1 -> layer7_expert17_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate18_gpu1;
layer7_gate18_gpu1 -> layer7_expert18_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert18_fc1_gpu1;
layer7_expert18_fc1_gpu1 -> layer7_expert18_fc2_gpu1;
layer7_expert18_fc2_gpu1 -> layer7_expert18_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate19_gpu1;
layer7_gate19_gpu1 -> layer7_expert19_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert19_fc1_gpu1;
layer7_expert19_fc1_gpu1 -> layer7_expert19_fc2_gpu1;
layer7_expert19_fc2_gpu1 -> layer7_expert19_add_gpu1;
layer7_ln1_gpu1 -> layer7_gate20_gpu1;
layer7_gate20_gpu1 -> layer7_expert20_fc1_gpu1 [style=dashed];
layer7_ln1_gpu1 -> layer7_expert20_fc1_gpu1;
layer7_expert20_fc1_gpu1 -> layer7_expert20_fc2_gpu1;
layer7_expert20_fc2_gpu1 -> layer7_expert20_add_gpu1;
layer7_expert20_add_gpu1 -> layer8_att_in_gpu1;
layer7_ln1_gpu2 -> layer7_gate0_gpu2;
layer7_gate0_gpu2 -> layer7_expert0_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert0_fc1_gpu2;
layer7_expert0_fc1_gpu2 -> layer7_expert0_fc2_gpu2;
layer7_expert0_fc2_gpu2 -> layer7_expert0_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate1_gpu2;
layer7_gate1_gpu2 -> layer7_expert1_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert1_fc1_gpu2;
layer7_expert1_fc1_gpu2 -> layer7_expert1_fc2_gpu2;
layer7_expert1_fc2_gpu2 -> layer7_expert1_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate2_gpu2;
layer7_gate2_gpu2 -> layer7_expert2_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert2_fc1_gpu2;
layer7_expert2_fc1_gpu2 -> layer7_expert2_fc2_gpu2;
layer7_expert2_fc2_gpu2 -> layer7_expert2_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate3_gpu2;
layer7_gate3_gpu2 -> layer7_expert3_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert3_fc1_gpu2;
layer7_expert3_fc1_gpu2 -> layer7_expert3_fc2_gpu2;
layer7_expert3_fc2_gpu2 -> layer7_expert3_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate4_gpu2;
layer7_gate4_gpu2 -> layer7_expert4_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert4_fc1_gpu2;
layer7_expert4_fc1_gpu2 -> layer7_expert4_fc2_gpu2;
layer7_expert4_fc2_gpu2 -> layer7_expert4_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate5_gpu2;
layer7_gate5_gpu2 -> layer7_expert5_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert5_fc1_gpu2;
layer7_expert5_fc1_gpu2 -> layer7_expert5_fc2_gpu2;
layer7_expert5_fc2_gpu2 -> layer7_expert5_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate6_gpu2;
layer7_gate6_gpu2 -> layer7_expert6_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert6_fc1_gpu2;
layer7_expert6_fc1_gpu2 -> layer7_expert6_fc2_gpu2;
layer7_expert6_fc2_gpu2 -> layer7_expert6_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate7_gpu2;
layer7_gate7_gpu2 -> layer7_expert7_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert7_fc1_gpu2;
layer7_expert7_fc1_gpu2 -> layer7_expert7_fc2_gpu2;
layer7_expert7_fc2_gpu2 -> layer7_expert7_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate8_gpu2;
layer7_gate8_gpu2 -> layer7_expert8_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert8_fc1_gpu2;
layer7_expert8_fc1_gpu2 -> layer7_expert8_fc2_gpu2;
layer7_expert8_fc2_gpu2 -> layer7_expert8_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate9_gpu2;
layer7_gate9_gpu2 -> layer7_expert9_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert9_fc1_gpu2;
layer7_expert9_fc1_gpu2 -> layer7_expert9_fc2_gpu2;
layer7_expert9_fc2_gpu2 -> layer7_expert9_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate10_gpu2;
layer7_gate10_gpu2 -> layer7_expert10_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert10_fc1_gpu2;
layer7_expert10_fc1_gpu2 -> layer7_expert10_fc2_gpu2;
layer7_expert10_fc2_gpu2 -> layer7_expert10_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate11_gpu2;
layer7_gate11_gpu2 -> layer7_expert11_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert11_fc1_gpu2;
layer7_expert11_fc1_gpu2 -> layer7_expert11_fc2_gpu2;
layer7_expert11_fc2_gpu2 -> layer7_expert11_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate12_gpu2;
layer7_gate12_gpu2 -> layer7_expert12_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert12_fc1_gpu2;
layer7_expert12_fc1_gpu2 -> layer7_expert12_fc2_gpu2;
layer7_expert12_fc2_gpu2 -> layer7_expert12_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate13_gpu2;
layer7_gate13_gpu2 -> layer7_expert13_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert13_fc1_gpu2;
layer7_expert13_fc1_gpu2 -> layer7_expert13_fc2_gpu2;
layer7_expert13_fc2_gpu2 -> layer7_expert13_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate14_gpu2;
layer7_gate14_gpu2 -> layer7_expert14_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert14_fc1_gpu2;
layer7_expert14_fc1_gpu2 -> layer7_expert14_fc2_gpu2;
layer7_expert14_fc2_gpu2 -> layer7_expert14_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate15_gpu2;
layer7_gate15_gpu2 -> layer7_expert15_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert15_fc1_gpu2;
layer7_expert15_fc1_gpu2 -> layer7_expert15_fc2_gpu2;
layer7_expert15_fc2_gpu2 -> layer7_expert15_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate16_gpu2;
layer7_gate16_gpu2 -> layer7_expert16_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert16_fc1_gpu2;
layer7_expert16_fc1_gpu2 -> layer7_expert16_fc2_gpu2;
layer7_expert16_fc2_gpu2 -> layer7_expert16_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate17_gpu2;
layer7_gate17_gpu2 -> layer7_expert17_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert17_fc1_gpu2;
layer7_expert17_fc1_gpu2 -> layer7_expert17_fc2_gpu2;
layer7_expert17_fc2_gpu2 -> layer7_expert17_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate18_gpu2;
layer7_gate18_gpu2 -> layer7_expert18_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert18_fc1_gpu2;
layer7_expert18_fc1_gpu2 -> layer7_expert18_fc2_gpu2;
layer7_expert18_fc2_gpu2 -> layer7_expert18_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate19_gpu2;
layer7_gate19_gpu2 -> layer7_expert19_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert19_fc1_gpu2;
layer7_expert19_fc1_gpu2 -> layer7_expert19_fc2_gpu2;
layer7_expert19_fc2_gpu2 -> layer7_expert19_add_gpu2;
layer7_ln1_gpu2 -> layer7_gate20_gpu2;
layer7_gate20_gpu2 -> layer7_expert20_fc1_gpu2 [style=dashed];
layer7_ln1_gpu2 -> layer7_expert20_fc1_gpu2;
layer7_expert20_fc1_gpu2 -> layer7_expert20_fc2_gpu2;
layer7_expert20_fc2_gpu2 -> layer7_expert20_add_gpu2;
layer7_expert20_add_gpu2 -> layer8_att_in_gpu2;
input -> layer8_att_in_gpu0;
layer8_att_in_gpu0 -> layer8_qkv0_gpu0;
layer8_att_in_gpu0 -> layer8_qkv1_gpu0;
layer8_qkv0_gpu0 -> layer8_attout0_gpu0;
layer8_qkv1_gpu0 -> layer8_attout1_gpu0;
layer8_attout0_gpu0 -> layer8_att_agg_gpu0;
layer8_attout1_gpu0 -> layer8_att_agg_gpu0;
layer8_att_agg_gpu0 -> layer8_res1_gpu0;
layer8_res1_gpu0 -> layer8_ln1_gpu0;
input -> layer8_att_in_gpu1;
layer8_att_in_gpu1 -> layer8_qkv0_gpu1;
layer8_att_in_gpu1 -> layer8_qkv1_gpu1;
layer8_qkv0_gpu1 -> layer8_attout0_gpu1;
layer8_qkv1_gpu1 -> layer8_attout1_gpu1;
layer8_attout0_gpu1 -> layer8_att_agg_gpu1;
layer8_attout1_gpu1 -> layer8_att_agg_gpu1;
layer8_att_agg_gpu1 -> layer8_res1_gpu1;
layer8_res1_gpu1 -> layer8_ln1_gpu1;
input -> layer8_att_in_gpu2;
layer8_att_in_gpu2 -> layer8_qkv0_gpu2;
layer8_att_in_gpu2 -> layer8_qkv1_gpu2;
layer8_qkv0_gpu2 -> layer8_attout0_gpu2;
layer8_qkv1_gpu2 -> layer8_attout1_gpu2;
layer8_attout0_gpu2 -> layer8_att_agg_gpu2;
layer8_attout1_gpu2 -> layer8_att_agg_gpu2;
layer8_att_agg_gpu2 -> layer8_res1_gpu2;
layer8_res1_gpu2 -> layer8_ln1_gpu2;
layer8_ln1_gpu0 -> layer8_gate0_gpu0;
layer8_gate0_gpu0 -> layer8_expert0_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert0_fc1_gpu0;
layer8_expert0_fc1_gpu0 -> layer8_expert0_fc2_gpu0;
layer8_expert0_fc2_gpu0 -> layer8_expert0_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate1_gpu0;
layer8_gate1_gpu0 -> layer8_expert1_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert1_fc1_gpu0;
layer8_expert1_fc1_gpu0 -> layer8_expert1_fc2_gpu0;
layer8_expert1_fc2_gpu0 -> layer8_expert1_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate2_gpu0;
layer8_gate2_gpu0 -> layer8_expert2_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert2_fc1_gpu0;
layer8_expert2_fc1_gpu0 -> layer8_expert2_fc2_gpu0;
layer8_expert2_fc2_gpu0 -> layer8_expert2_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate3_gpu0;
layer8_gate3_gpu0 -> layer8_expert3_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert3_fc1_gpu0;
layer8_expert3_fc1_gpu0 -> layer8_expert3_fc2_gpu0;
layer8_expert3_fc2_gpu0 -> layer8_expert3_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate4_gpu0;
layer8_gate4_gpu0 -> layer8_expert4_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert4_fc1_gpu0;
layer8_expert4_fc1_gpu0 -> layer8_expert4_fc2_gpu0;
layer8_expert4_fc2_gpu0 -> layer8_expert4_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate5_gpu0;
layer8_gate5_gpu0 -> layer8_expert5_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert5_fc1_gpu0;
layer8_expert5_fc1_gpu0 -> layer8_expert5_fc2_gpu0;
layer8_expert5_fc2_gpu0 -> layer8_expert5_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate6_gpu0;
layer8_gate6_gpu0 -> layer8_expert6_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert6_fc1_gpu0;
layer8_expert6_fc1_gpu0 -> layer8_expert6_fc2_gpu0;
layer8_expert6_fc2_gpu0 -> layer8_expert6_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate7_gpu0;
layer8_gate7_gpu0 -> layer8_expert7_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert7_fc1_gpu0;
layer8_expert7_fc1_gpu0 -> layer8_expert7_fc2_gpu0;
layer8_expert7_fc2_gpu0 -> layer8_expert7_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate8_gpu0;
layer8_gate8_gpu0 -> layer8_expert8_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert8_fc1_gpu0;
layer8_expert8_fc1_gpu0 -> layer8_expert8_fc2_gpu0;
layer8_expert8_fc2_gpu0 -> layer8_expert8_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate9_gpu0;
layer8_gate9_gpu0 -> layer8_expert9_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert9_fc1_gpu0;
layer8_expert9_fc1_gpu0 -> layer8_expert9_fc2_gpu0;
layer8_expert9_fc2_gpu0 -> layer8_expert9_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate10_gpu0;
layer8_gate10_gpu0 -> layer8_expert10_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert10_fc1_gpu0;
layer8_expert10_fc1_gpu0 -> layer8_expert10_fc2_gpu0;
layer8_expert10_fc2_gpu0 -> layer8_expert10_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate11_gpu0;
layer8_gate11_gpu0 -> layer8_expert11_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert11_fc1_gpu0;
layer8_expert11_fc1_gpu0 -> layer8_expert11_fc2_gpu0;
layer8_expert11_fc2_gpu0 -> layer8_expert11_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate12_gpu0;
layer8_gate12_gpu0 -> layer8_expert12_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert12_fc1_gpu0;
layer8_expert12_fc1_gpu0 -> layer8_expert12_fc2_gpu0;
layer8_expert12_fc2_gpu0 -> layer8_expert12_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate13_gpu0;
layer8_gate13_gpu0 -> layer8_expert13_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert13_fc1_gpu0;
layer8_expert13_fc1_gpu0 -> layer8_expert13_fc2_gpu0;
layer8_expert13_fc2_gpu0 -> layer8_expert13_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate14_gpu0;
layer8_gate14_gpu0 -> layer8_expert14_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert14_fc1_gpu0;
layer8_expert14_fc1_gpu0 -> layer8_expert14_fc2_gpu0;
layer8_expert14_fc2_gpu0 -> layer8_expert14_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate15_gpu0;
layer8_gate15_gpu0 -> layer8_expert15_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert15_fc1_gpu0;
layer8_expert15_fc1_gpu0 -> layer8_expert15_fc2_gpu0;
layer8_expert15_fc2_gpu0 -> layer8_expert15_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate16_gpu0;
layer8_gate16_gpu0 -> layer8_expert16_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert16_fc1_gpu0;
layer8_expert16_fc1_gpu0 -> layer8_expert16_fc2_gpu0;
layer8_expert16_fc2_gpu0 -> layer8_expert16_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate17_gpu0;
layer8_gate17_gpu0 -> layer8_expert17_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert17_fc1_gpu0;
layer8_expert17_fc1_gpu0 -> layer8_expert17_fc2_gpu0;
layer8_expert17_fc2_gpu0 -> layer8_expert17_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate18_gpu0;
layer8_gate18_gpu0 -> layer8_expert18_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert18_fc1_gpu0;
layer8_expert18_fc1_gpu0 -> layer8_expert18_fc2_gpu0;
layer8_expert18_fc2_gpu0 -> layer8_expert18_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate19_gpu0;
layer8_gate19_gpu0 -> layer8_expert19_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert19_fc1_gpu0;
layer8_expert19_fc1_gpu0 -> layer8_expert19_fc2_gpu0;
layer8_expert19_fc2_gpu0 -> layer8_expert19_add_gpu0;
layer8_ln1_gpu0 -> layer8_gate20_gpu0;
layer8_gate20_gpu0 -> layer8_expert20_fc1_gpu0 [style=dashed];
layer8_ln1_gpu0 -> layer8_expert20_fc1_gpu0;
layer8_expert20_fc1_gpu0 -> layer8_expert20_fc2_gpu0;
layer8_expert20_fc2_gpu0 -> layer8_expert20_add_gpu0;
layer8_expert20_add_gpu0 -> layer9_att_in_gpu0;
layer8_ln1_gpu1 -> layer8_gate0_gpu1;
layer8_gate0_gpu1 -> layer8_expert0_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert0_fc1_gpu1;
layer8_expert0_fc1_gpu1 -> layer8_expert0_fc2_gpu1;
layer8_expert0_fc2_gpu1 -> layer8_expert0_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate1_gpu1;
layer8_gate1_gpu1 -> layer8_expert1_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert1_fc1_gpu1;
layer8_expert1_fc1_gpu1 -> layer8_expert1_fc2_gpu1;
layer8_expert1_fc2_gpu1 -> layer8_expert1_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate2_gpu1;
layer8_gate2_gpu1 -> layer8_expert2_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert2_fc1_gpu1;
layer8_expert2_fc1_gpu1 -> layer8_expert2_fc2_gpu1;
layer8_expert2_fc2_gpu1 -> layer8_expert2_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate3_gpu1;
layer8_gate3_gpu1 -> layer8_expert3_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert3_fc1_gpu1;
layer8_expert3_fc1_gpu1 -> layer8_expert3_fc2_gpu1;
layer8_expert3_fc2_gpu1 -> layer8_expert3_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate4_gpu1;
layer8_gate4_gpu1 -> layer8_expert4_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert4_fc1_gpu1;
layer8_expert4_fc1_gpu1 -> layer8_expert4_fc2_gpu1;
layer8_expert4_fc2_gpu1 -> layer8_expert4_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate5_gpu1;
layer8_gate5_gpu1 -> layer8_expert5_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert5_fc1_gpu1;
layer8_expert5_fc1_gpu1 -> layer8_expert5_fc2_gpu1;
layer8_expert5_fc2_gpu1 -> layer8_expert5_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate6_gpu1;
layer8_gate6_gpu1 -> layer8_expert6_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert6_fc1_gpu1;
layer8_expert6_fc1_gpu1 -> layer8_expert6_fc2_gpu1;
layer8_expert6_fc2_gpu1 -> layer8_expert6_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate7_gpu1;
layer8_gate7_gpu1 -> layer8_expert7_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert7_fc1_gpu1;
layer8_expert7_fc1_gpu1 -> layer8_expert7_fc2_gpu1;
layer8_expert7_fc2_gpu1 -> layer8_expert7_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate8_gpu1;
layer8_gate8_gpu1 -> layer8_expert8_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert8_fc1_gpu1;
layer8_expert8_fc1_gpu1 -> layer8_expert8_fc2_gpu1;
layer8_expert8_fc2_gpu1 -> layer8_expert8_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate9_gpu1;
layer8_gate9_gpu1 -> layer8_expert9_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert9_fc1_gpu1;
layer8_expert9_fc1_gpu1 -> layer8_expert9_fc2_gpu1;
layer8_expert9_fc2_gpu1 -> layer8_expert9_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate10_gpu1;
layer8_gate10_gpu1 -> layer8_expert10_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert10_fc1_gpu1;
layer8_expert10_fc1_gpu1 -> layer8_expert10_fc2_gpu1;
layer8_expert10_fc2_gpu1 -> layer8_expert10_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate11_gpu1;
layer8_gate11_gpu1 -> layer8_expert11_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert11_fc1_gpu1;
layer8_expert11_fc1_gpu1 -> layer8_expert11_fc2_gpu1;
layer8_expert11_fc2_gpu1 -> layer8_expert11_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate12_gpu1;
layer8_gate12_gpu1 -> layer8_expert12_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert12_fc1_gpu1;
layer8_expert12_fc1_gpu1 -> layer8_expert12_fc2_gpu1;
layer8_expert12_fc2_gpu1 -> layer8_expert12_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate13_gpu1;
layer8_gate13_gpu1 -> layer8_expert13_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert13_fc1_gpu1;
layer8_expert13_fc1_gpu1 -> layer8_expert13_fc2_gpu1;
layer8_expert13_fc2_gpu1 -> layer8_expert13_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate14_gpu1;
layer8_gate14_gpu1 -> layer8_expert14_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert14_fc1_gpu1;
layer8_expert14_fc1_gpu1 -> layer8_expert14_fc2_gpu1;
layer8_expert14_fc2_gpu1 -> layer8_expert14_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate15_gpu1;
layer8_gate15_gpu1 -> layer8_expert15_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert15_fc1_gpu1;
layer8_expert15_fc1_gpu1 -> layer8_expert15_fc2_gpu1;
layer8_expert15_fc2_gpu1 -> layer8_expert15_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate16_gpu1;
layer8_gate16_gpu1 -> layer8_expert16_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert16_fc1_gpu1;
layer8_expert16_fc1_gpu1 -> layer8_expert16_fc2_gpu1;
layer8_expert16_fc2_gpu1 -> layer8_expert16_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate17_gpu1;
layer8_gate17_gpu1 -> layer8_expert17_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert17_fc1_gpu1;
layer8_expert17_fc1_gpu1 -> layer8_expert17_fc2_gpu1;
layer8_expert17_fc2_gpu1 -> layer8_expert17_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate18_gpu1;
layer8_gate18_gpu1 -> layer8_expert18_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert18_fc1_gpu1;
layer8_expert18_fc1_gpu1 -> layer8_expert18_fc2_gpu1;
layer8_expert18_fc2_gpu1 -> layer8_expert18_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate19_gpu1;
layer8_gate19_gpu1 -> layer8_expert19_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert19_fc1_gpu1;
layer8_expert19_fc1_gpu1 -> layer8_expert19_fc2_gpu1;
layer8_expert19_fc2_gpu1 -> layer8_expert19_add_gpu1;
layer8_ln1_gpu1 -> layer8_gate20_gpu1;
layer8_gate20_gpu1 -> layer8_expert20_fc1_gpu1 [style=dashed];
layer8_ln1_gpu1 -> layer8_expert20_fc1_gpu1;
layer8_expert20_fc1_gpu1 -> layer8_expert20_fc2_gpu1;
layer8_expert20_fc2_gpu1 -> layer8_expert20_add_gpu1;
layer8_expert20_add_gpu1 -> layer9_att_in_gpu1;
layer8_ln1_gpu2 -> layer8_gate0_gpu2;
layer8_gate0_gpu2 -> layer8_expert0_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert0_fc1_gpu2;
layer8_expert0_fc1_gpu2 -> layer8_expert0_fc2_gpu2;
layer8_expert0_fc2_gpu2 -> layer8_expert0_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate1_gpu2;
layer8_gate1_gpu2 -> layer8_expert1_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert1_fc1_gpu2;
layer8_expert1_fc1_gpu2 -> layer8_expert1_fc2_gpu2;
layer8_expert1_fc2_gpu2 -> layer8_expert1_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate2_gpu2;
layer8_gate2_gpu2 -> layer8_expert2_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert2_fc1_gpu2;
layer8_expert2_fc1_gpu2 -> layer8_expert2_fc2_gpu2;
layer8_expert2_fc2_gpu2 -> layer8_expert2_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate3_gpu2;
layer8_gate3_gpu2 -> layer8_expert3_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert3_fc1_gpu2;
layer8_expert3_fc1_gpu2 -> layer8_expert3_fc2_gpu2;
layer8_expert3_fc2_gpu2 -> layer8_expert3_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate4_gpu2;
layer8_gate4_gpu2 -> layer8_expert4_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert4_fc1_gpu2;
layer8_expert4_fc1_gpu2 -> layer8_expert4_fc2_gpu2;
layer8_expert4_fc2_gpu2 -> layer8_expert4_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate5_gpu2;
layer8_gate5_gpu2 -> layer8_expert5_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert5_fc1_gpu2;
layer8_expert5_fc1_gpu2 -> layer8_expert5_fc2_gpu2;
layer8_expert5_fc2_gpu2 -> layer8_expert5_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate6_gpu2;
layer8_gate6_gpu2 -> layer8_expert6_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert6_fc1_gpu2;
layer8_expert6_fc1_gpu2 -> layer8_expert6_fc2_gpu2;
layer8_expert6_fc2_gpu2 -> layer8_expert6_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate7_gpu2;
layer8_gate7_gpu2 -> layer8_expert7_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert7_fc1_gpu2;
layer8_expert7_fc1_gpu2 -> layer8_expert7_fc2_gpu2;
layer8_expert7_fc2_gpu2 -> layer8_expert7_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate8_gpu2;
layer8_gate8_gpu2 -> layer8_expert8_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert8_fc1_gpu2;
layer8_expert8_fc1_gpu2 -> layer8_expert8_fc2_gpu2;
layer8_expert8_fc2_gpu2 -> layer8_expert8_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate9_gpu2;
layer8_gate9_gpu2 -> layer8_expert9_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert9_fc1_gpu2;
layer8_expert9_fc1_gpu2 -> layer8_expert9_fc2_gpu2;
layer8_expert9_fc2_gpu2 -> layer8_expert9_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate10_gpu2;
layer8_gate10_gpu2 -> layer8_expert10_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert10_fc1_gpu2;
layer8_expert10_fc1_gpu2 -> layer8_expert10_fc2_gpu2;
layer8_expert10_fc2_gpu2 -> layer8_expert10_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate11_gpu2;
layer8_gate11_gpu2 -> layer8_expert11_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert11_fc1_gpu2;
layer8_expert11_fc1_gpu2 -> layer8_expert11_fc2_gpu2;
layer8_expert11_fc2_gpu2 -> layer8_expert11_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate12_gpu2;
layer8_gate12_gpu2 -> layer8_expert12_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert12_fc1_gpu2;
layer8_expert12_fc1_gpu2 -> layer8_expert12_fc2_gpu2;
layer8_expert12_fc2_gpu2 -> layer8_expert12_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate13_gpu2;
layer8_gate13_gpu2 -> layer8_expert13_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert13_fc1_gpu2;
layer8_expert13_fc1_gpu2 -> layer8_expert13_fc2_gpu2;
layer8_expert13_fc2_gpu2 -> layer8_expert13_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate14_gpu2;
layer8_gate14_gpu2 -> layer8_expert14_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert14_fc1_gpu2;
layer8_expert14_fc1_gpu2 -> layer8_expert14_fc2_gpu2;
layer8_expert14_fc2_gpu2 -> layer8_expert14_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate15_gpu2;
layer8_gate15_gpu2 -> layer8_expert15_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert15_fc1_gpu2;
layer8_expert15_fc1_gpu2 -> layer8_expert15_fc2_gpu2;
layer8_expert15_fc2_gpu2 -> layer8_expert15_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate16_gpu2;
layer8_gate16_gpu2 -> layer8_expert16_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert16_fc1_gpu2;
layer8_expert16_fc1_gpu2 -> layer8_expert16_fc2_gpu2;
layer8_expert16_fc2_gpu2 -> layer8_expert16_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate17_gpu2;
layer8_gate17_gpu2 -> layer8_expert17_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert17_fc1_gpu2;
layer8_expert17_fc1_gpu2 -> layer8_expert17_fc2_gpu2;
layer8_expert17_fc2_gpu2 -> layer8_expert17_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate18_gpu2;
layer8_gate18_gpu2 -> layer8_expert18_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert18_fc1_gpu2;
layer8_expert18_fc1_gpu2 -> layer8_expert18_fc2_gpu2;
layer8_expert18_fc2_gpu2 -> layer8_expert18_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate19_gpu2;
layer8_gate19_gpu2 -> layer8_expert19_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert19_fc1_gpu2;
layer8_expert19_fc1_gpu2 -> layer8_expert19_fc2_gpu2;
layer8_expert19_fc2_gpu2 -> layer8_expert19_add_gpu2;
layer8_ln1_gpu2 -> layer8_gate20_gpu2;
layer8_gate20_gpu2 -> layer8_expert20_fc1_gpu2 [style=dashed];
layer8_ln1_gpu2 -> layer8_expert20_fc1_gpu2;
layer8_expert20_fc1_gpu2 -> layer8_expert20_fc2_gpu2;
layer8_expert20_fc2_gpu2 -> layer8_expert20_add_gpu2;
layer8_expert20_add_gpu2 -> layer9_att_in_gpu2;
input -> layer9_att_in_gpu0;
layer9_att_in_gpu0 -> layer9_qkv0_gpu0;
layer9_att_in_gpu0 -> layer9_qkv1_gpu0;
layer9_qkv0_gpu0 -> layer9_attout0_gpu0;
layer9_qkv1_gpu0 -> layer9_attout1_gpu0;
layer9_attout0_gpu0 -> layer9_att_agg_gpu0;
layer9_attout1_gpu0 -> layer9_att_agg_gpu0;
layer9_att_agg_gpu0 -> layer9_res1_gpu0;
layer9_res1_gpu0 -> layer9_ln1_gpu0;
input -> layer9_att_in_gpu1;
layer9_att_in_gpu1 -> layer9_qkv0_gpu1;
layer9_att_in_gpu1 -> layer9_qkv1_gpu1;
layer9_qkv0_gpu1 -> layer9_attout0_gpu1;
layer9_qkv1_gpu1 -> layer9_attout1_gpu1;
layer9_attout0_gpu1 -> layer9_att_agg_gpu1;
layer9_attout1_gpu1 -> layer9_att_agg_gpu1;
layer9_att_agg_gpu1 -> layer9_res1_gpu1;
layer9_res1_gpu1 -> layer9_ln1_gpu1;
input -> layer9_att_in_gpu2;
layer9_att_in_gpu2 -> layer9_qkv0_gpu2;
layer9_att_in_gpu2 -> layer9_qkv1_gpu2;
layer9_qkv0_gpu2 -> layer9_attout0_gpu2;
layer9_qkv1_gpu2 -> layer9_attout1_gpu2;
layer9_attout0_gpu2 -> layer9_att_agg_gpu2;
layer9_attout1_gpu2 -> layer9_att_agg_gpu2;
layer9_att_agg_gpu2 -> layer9_res1_gpu2;
layer9_res1_gpu2 -> layer9_ln1_gpu2;
layer9_ln1_gpu0 -> layer9_gate0_gpu0;
layer9_gate0_gpu0 -> layer9_expert0_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert0_fc1_gpu0;
layer9_expert0_fc1_gpu0 -> layer9_expert0_fc2_gpu0;
layer9_expert0_fc2_gpu0 -> layer9_expert0_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate1_gpu0;
layer9_gate1_gpu0 -> layer9_expert1_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert1_fc1_gpu0;
layer9_expert1_fc1_gpu0 -> layer9_expert1_fc2_gpu0;
layer9_expert1_fc2_gpu0 -> layer9_expert1_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate2_gpu0;
layer9_gate2_gpu0 -> layer9_expert2_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert2_fc1_gpu0;
layer9_expert2_fc1_gpu0 -> layer9_expert2_fc2_gpu0;
layer9_expert2_fc2_gpu0 -> layer9_expert2_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate3_gpu0;
layer9_gate3_gpu0 -> layer9_expert3_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert3_fc1_gpu0;
layer9_expert3_fc1_gpu0 -> layer9_expert3_fc2_gpu0;
layer9_expert3_fc2_gpu0 -> layer9_expert3_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate4_gpu0;
layer9_gate4_gpu0 -> layer9_expert4_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert4_fc1_gpu0;
layer9_expert4_fc1_gpu0 -> layer9_expert4_fc2_gpu0;
layer9_expert4_fc2_gpu0 -> layer9_expert4_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate5_gpu0;
layer9_gate5_gpu0 -> layer9_expert5_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert5_fc1_gpu0;
layer9_expert5_fc1_gpu0 -> layer9_expert5_fc2_gpu0;
layer9_expert5_fc2_gpu0 -> layer9_expert5_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate6_gpu0;
layer9_gate6_gpu0 -> layer9_expert6_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert6_fc1_gpu0;
layer9_expert6_fc1_gpu0 -> layer9_expert6_fc2_gpu0;
layer9_expert6_fc2_gpu0 -> layer9_expert6_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate7_gpu0;
layer9_gate7_gpu0 -> layer9_expert7_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert7_fc1_gpu0;
layer9_expert7_fc1_gpu0 -> layer9_expert7_fc2_gpu0;
layer9_expert7_fc2_gpu0 -> layer9_expert7_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate8_gpu0;
layer9_gate8_gpu0 -> layer9_expert8_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert8_fc1_gpu0;
layer9_expert8_fc1_gpu0 -> layer9_expert8_fc2_gpu0;
layer9_expert8_fc2_gpu0 -> layer9_expert8_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate9_gpu0;
layer9_gate9_gpu0 -> layer9_expert9_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert9_fc1_gpu0;
layer9_expert9_fc1_gpu0 -> layer9_expert9_fc2_gpu0;
layer9_expert9_fc2_gpu0 -> layer9_expert9_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate10_gpu0;
layer9_gate10_gpu0 -> layer9_expert10_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert10_fc1_gpu0;
layer9_expert10_fc1_gpu0 -> layer9_expert10_fc2_gpu0;
layer9_expert10_fc2_gpu0 -> layer9_expert10_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate11_gpu0;
layer9_gate11_gpu0 -> layer9_expert11_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert11_fc1_gpu0;
layer9_expert11_fc1_gpu0 -> layer9_expert11_fc2_gpu0;
layer9_expert11_fc2_gpu0 -> layer9_expert11_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate12_gpu0;
layer9_gate12_gpu0 -> layer9_expert12_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert12_fc1_gpu0;
layer9_expert12_fc1_gpu0 -> layer9_expert12_fc2_gpu0;
layer9_expert12_fc2_gpu0 -> layer9_expert12_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate13_gpu0;
layer9_gate13_gpu0 -> layer9_expert13_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert13_fc1_gpu0;
layer9_expert13_fc1_gpu0 -> layer9_expert13_fc2_gpu0;
layer9_expert13_fc2_gpu0 -> layer9_expert13_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate14_gpu0;
layer9_gate14_gpu0 -> layer9_expert14_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert14_fc1_gpu0;
layer9_expert14_fc1_gpu0 -> layer9_expert14_fc2_gpu0;
layer9_expert14_fc2_gpu0 -> layer9_expert14_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate15_gpu0;
layer9_gate15_gpu0 -> layer9_expert15_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert15_fc1_gpu0;
layer9_expert15_fc1_gpu0 -> layer9_expert15_fc2_gpu0;
layer9_expert15_fc2_gpu0 -> layer9_expert15_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate16_gpu0;
layer9_gate16_gpu0 -> layer9_expert16_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert16_fc1_gpu0;
layer9_expert16_fc1_gpu0 -> layer9_expert16_fc2_gpu0;
layer9_expert16_fc2_gpu0 -> layer9_expert16_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate17_gpu0;
layer9_gate17_gpu0 -> layer9_expert17_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert17_fc1_gpu0;
layer9_expert17_fc1_gpu0 -> layer9_expert17_fc2_gpu0;
layer9_expert17_fc2_gpu0 -> layer9_expert17_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate18_gpu0;
layer9_gate18_gpu0 -> layer9_expert18_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert18_fc1_gpu0;
layer9_expert18_fc1_gpu0 -> layer9_expert18_fc2_gpu0;
layer9_expert18_fc2_gpu0 -> layer9_expert18_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate19_gpu0;
layer9_gate19_gpu0 -> layer9_expert19_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert19_fc1_gpu0;
layer9_expert19_fc1_gpu0 -> layer9_expert19_fc2_gpu0;
layer9_expert19_fc2_gpu0 -> layer9_expert19_add_gpu0;
layer9_ln1_gpu0 -> layer9_gate20_gpu0;
layer9_gate20_gpu0 -> layer9_expert20_fc1_gpu0 [style=dashed];
layer9_ln1_gpu0 -> layer9_expert20_fc1_gpu0;
layer9_expert20_fc1_gpu0 -> layer9_expert20_fc2_gpu0;
layer9_expert20_fc2_gpu0 -> layer9_expert20_add_gpu0;
layer9_expert20_add_gpu0 -> layer10_att_in_gpu0;
layer9_ln1_gpu1 -> layer9_gate0_gpu1;
layer9_gate0_gpu1 -> layer9_expert0_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert0_fc1_gpu1;
layer9_expert0_fc1_gpu1 -> layer9_expert0_fc2_gpu1;
layer9_expert0_fc2_gpu1 -> layer9_expert0_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate1_gpu1;
layer9_gate1_gpu1 -> layer9_expert1_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert1_fc1_gpu1;
layer9_expert1_fc1_gpu1 -> layer9_expert1_fc2_gpu1;
layer9_expert1_fc2_gpu1 -> layer9_expert1_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate2_gpu1;
layer9_gate2_gpu1 -> layer9_expert2_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert2_fc1_gpu1;
layer9_expert2_fc1_gpu1 -> layer9_expert2_fc2_gpu1;
layer9_expert2_fc2_gpu1 -> layer9_expert2_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate3_gpu1;
layer9_gate3_gpu1 -> layer9_expert3_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert3_fc1_gpu1;
layer9_expert3_fc1_gpu1 -> layer9_expert3_fc2_gpu1;
layer9_expert3_fc2_gpu1 -> layer9_expert3_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate4_gpu1;
layer9_gate4_gpu1 -> layer9_expert4_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert4_fc1_gpu1;
layer9_expert4_fc1_gpu1 -> layer9_expert4_fc2_gpu1;
layer9_expert4_fc2_gpu1 -> layer9_expert4_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate5_gpu1;
layer9_gate5_gpu1 -> layer9_expert5_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert5_fc1_gpu1;
layer9_expert5_fc1_gpu1 -> layer9_expert5_fc2_gpu1;
layer9_expert5_fc2_gpu1 -> layer9_expert5_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate6_gpu1;
layer9_gate6_gpu1 -> layer9_expert6_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert6_fc1_gpu1;
layer9_expert6_fc1_gpu1 -> layer9_expert6_fc2_gpu1;
layer9_expert6_fc2_gpu1 -> layer9_expert6_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate7_gpu1;
layer9_gate7_gpu1 -> layer9_expert7_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert7_fc1_gpu1;
layer9_expert7_fc1_gpu1 -> layer9_expert7_fc2_gpu1;
layer9_expert7_fc2_gpu1 -> layer9_expert7_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate8_gpu1;
layer9_gate8_gpu1 -> layer9_expert8_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert8_fc1_gpu1;
layer9_expert8_fc1_gpu1 -> layer9_expert8_fc2_gpu1;
layer9_expert8_fc2_gpu1 -> layer9_expert8_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate9_gpu1;
layer9_gate9_gpu1 -> layer9_expert9_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert9_fc1_gpu1;
layer9_expert9_fc1_gpu1 -> layer9_expert9_fc2_gpu1;
layer9_expert9_fc2_gpu1 -> layer9_expert9_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate10_gpu1;
layer9_gate10_gpu1 -> layer9_expert10_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert10_fc1_gpu1;
layer9_expert10_fc1_gpu1 -> layer9_expert10_fc2_gpu1;
layer9_expert10_fc2_gpu1 -> layer9_expert10_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate11_gpu1;
layer9_gate11_gpu1 -> layer9_expert11_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert11_fc1_gpu1;
layer9_expert11_fc1_gpu1 -> layer9_expert11_fc2_gpu1;
layer9_expert11_fc2_gpu1 -> layer9_expert11_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate12_gpu1;
layer9_gate12_gpu1 -> layer9_expert12_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert12_fc1_gpu1;
layer9_expert12_fc1_gpu1 -> layer9_expert12_fc2_gpu1;
layer9_expert12_fc2_gpu1 -> layer9_expert12_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate13_gpu1;
layer9_gate13_gpu1 -> layer9_expert13_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert13_fc1_gpu1;
layer9_expert13_fc1_gpu1 -> layer9_expert13_fc2_gpu1;
layer9_expert13_fc2_gpu1 -> layer9_expert13_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate14_gpu1;
layer9_gate14_gpu1 -> layer9_expert14_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert14_fc1_gpu1;
layer9_expert14_fc1_gpu1 -> layer9_expert14_fc2_gpu1;
layer9_expert14_fc2_gpu1 -> layer9_expert14_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate15_gpu1;
layer9_gate15_gpu1 -> layer9_expert15_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert15_fc1_gpu1;
layer9_expert15_fc1_gpu1 -> layer9_expert15_fc2_gpu1;
layer9_expert15_fc2_gpu1 -> layer9_expert15_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate16_gpu1;
layer9_gate16_gpu1 -> layer9_expert16_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert16_fc1_gpu1;
layer9_expert16_fc1_gpu1 -> layer9_expert16_fc2_gpu1;
layer9_expert16_fc2_gpu1 -> layer9_expert16_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate17_gpu1;
layer9_gate17_gpu1 -> layer9_expert17_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert17_fc1_gpu1;
layer9_expert17_fc1_gpu1 -> layer9_expert17_fc2_gpu1;
layer9_expert17_fc2_gpu1 -> layer9_expert17_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate18_gpu1;
layer9_gate18_gpu1 -> layer9_expert18_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert18_fc1_gpu1;
layer9_expert18_fc1_gpu1 -> layer9_expert18_fc2_gpu1;
layer9_expert18_fc2_gpu1 -> layer9_expert18_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate19_gpu1;
layer9_gate19_gpu1 -> layer9_expert19_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert19_fc1_gpu1;
layer9_expert19_fc1_gpu1 -> layer9_expert19_fc2_gpu1;
layer9_expert19_fc2_gpu1 -> layer9_expert19_add_gpu1;
layer9_ln1_gpu1 -> layer9_gate20_gpu1;
layer9_gate20_gpu1 -> layer9_expert20_fc1_gpu1 [style=dashed];
layer9_ln1_gpu1 -> layer9_expert20_fc1_gpu1;
layer9_expert20_fc1_gpu1 -> layer9_expert20_fc2_gpu1;
layer9_expert20_fc2_gpu1 -> layer9_expert20_add_gpu1;
layer9_expert20_add_gpu1 -> layer10_att_in_gpu1;
layer9_ln1_gpu2 -> layer9_gate0_gpu2;
layer9_gate0_gpu2 -> layer9_expert0_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert0_fc1_gpu2;
layer9_expert0_fc1_gpu2 -> layer9_expert0_fc2_gpu2;
layer9_expert0_fc2_gpu2 -> layer9_expert0_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate1_gpu2;
layer9_gate1_gpu2 -> layer9_expert1_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert1_fc1_gpu2;
layer9_expert1_fc1_gpu2 -> layer9_expert1_fc2_gpu2;
layer9_expert1_fc2_gpu2 -> layer9_expert1_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate2_gpu2;
layer9_gate2_gpu2 -> layer9_expert2_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert2_fc1_gpu2;
layer9_expert2_fc1_gpu2 -> layer9_expert2_fc2_gpu2;
layer9_expert2_fc2_gpu2 -> layer9_expert2_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate3_gpu2;
layer9_gate3_gpu2 -> layer9_expert3_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert3_fc1_gpu2;
layer9_expert3_fc1_gpu2 -> layer9_expert3_fc2_gpu2;
layer9_expert3_fc2_gpu2 -> layer9_expert3_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate4_gpu2;
layer9_gate4_gpu2 -> layer9_expert4_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert4_fc1_gpu2;
layer9_expert4_fc1_gpu2 -> layer9_expert4_fc2_gpu2;
layer9_expert4_fc2_gpu2 -> layer9_expert4_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate5_gpu2;
layer9_gate5_gpu2 -> layer9_expert5_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert5_fc1_gpu2;
layer9_expert5_fc1_gpu2 -> layer9_expert5_fc2_gpu2;
layer9_expert5_fc2_gpu2 -> layer9_expert5_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate6_gpu2;
layer9_gate6_gpu2 -> layer9_expert6_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert6_fc1_gpu2;
layer9_expert6_fc1_gpu2 -> layer9_expert6_fc2_gpu2;
layer9_expert6_fc2_gpu2 -> layer9_expert6_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate7_gpu2;
layer9_gate7_gpu2 -> layer9_expert7_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert7_fc1_gpu2;
layer9_expert7_fc1_gpu2 -> layer9_expert7_fc2_gpu2;
layer9_expert7_fc2_gpu2 -> layer9_expert7_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate8_gpu2;
layer9_gate8_gpu2 -> layer9_expert8_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert8_fc1_gpu2;
layer9_expert8_fc1_gpu2 -> layer9_expert8_fc2_gpu2;
layer9_expert8_fc2_gpu2 -> layer9_expert8_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate9_gpu2;
layer9_gate9_gpu2 -> layer9_expert9_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert9_fc1_gpu2;
layer9_expert9_fc1_gpu2 -> layer9_expert9_fc2_gpu2;
layer9_expert9_fc2_gpu2 -> layer9_expert9_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate10_gpu2;
layer9_gate10_gpu2 -> layer9_expert10_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert10_fc1_gpu2;
layer9_expert10_fc1_gpu2 -> layer9_expert10_fc2_gpu2;
layer9_expert10_fc2_gpu2 -> layer9_expert10_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate11_gpu2;
layer9_gate11_gpu2 -> layer9_expert11_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert11_fc1_gpu2;
layer9_expert11_fc1_gpu2 -> layer9_expert11_fc2_gpu2;
layer9_expert11_fc2_gpu2 -> layer9_expert11_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate12_gpu2;
layer9_gate12_gpu2 -> layer9_expert12_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert12_fc1_gpu2;
layer9_expert12_fc1_gpu2 -> layer9_expert12_fc2_gpu2;
layer9_expert12_fc2_gpu2 -> layer9_expert12_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate13_gpu2;
layer9_gate13_gpu2 -> layer9_expert13_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert13_fc1_gpu2;
layer9_expert13_fc1_gpu2 -> layer9_expert13_fc2_gpu2;
layer9_expert13_fc2_gpu2 -> layer9_expert13_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate14_gpu2;
layer9_gate14_gpu2 -> layer9_expert14_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert14_fc1_gpu2;
layer9_expert14_fc1_gpu2 -> layer9_expert14_fc2_gpu2;
layer9_expert14_fc2_gpu2 -> layer9_expert14_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate15_gpu2;
layer9_gate15_gpu2 -> layer9_expert15_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert15_fc1_gpu2;
layer9_expert15_fc1_gpu2 -> layer9_expert15_fc2_gpu2;
layer9_expert15_fc2_gpu2 -> layer9_expert15_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate16_gpu2;
layer9_gate16_gpu2 -> layer9_expert16_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert16_fc1_gpu2;
layer9_expert16_fc1_gpu2 -> layer9_expert16_fc2_gpu2;
layer9_expert16_fc2_gpu2 -> layer9_expert16_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate17_gpu2;
layer9_gate17_gpu2 -> layer9_expert17_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert17_fc1_gpu2;
layer9_expert17_fc1_gpu2 -> layer9_expert17_fc2_gpu2;
layer9_expert17_fc2_gpu2 -> layer9_expert17_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate18_gpu2;
layer9_gate18_gpu2 -> layer9_expert18_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert18_fc1_gpu2;
layer9_expert18_fc1_gpu2 -> layer9_expert18_fc2_gpu2;
layer9_expert18_fc2_gpu2 -> layer9_expert18_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate19_gpu2;
layer9_gate19_gpu2 -> layer9_expert19_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert19_fc1_gpu2;
layer9_expert19_fc1_gpu2 -> layer9_expert19_fc2_gpu2;
layer9_expert19_fc2_gpu2 -> layer9_expert19_add_gpu2;
layer9_ln1_gpu2 -> layer9_gate20_gpu2;
layer9_gate20_gpu2 -> layer9_expert20_fc1_gpu2 [style=dashed];
layer9_ln1_gpu2 -> layer9_expert20_fc1_gpu2;
layer9_expert20_fc1_gpu2 -> layer9_expert20_fc2_gpu2;
layer9_expert20_fc2_gpu2 -> layer9_expert20_add_gpu2;
layer9_expert20_add_gpu2 -> layer10_att_in_gpu2;
input -> layer10_att_in_gpu0;
layer10_att_in_gpu0 -> layer10_qkv0_gpu0;
layer10_att_in_gpu0 -> layer10_qkv1_gpu0;
layer10_qkv0_gpu0 -> layer10_attout0_gpu0;
layer10_qkv1_gpu0 -> layer10_attout1_gpu0;
layer10_attout0_gpu0 -> layer10_att_agg_gpu0;
layer10_attout1_gpu0 -> layer10_att_agg_gpu0;
layer10_att_agg_gpu0 -> layer10_res1_gpu0;
layer10_res1_gpu0 -> layer10_ln1_gpu0;
input -> layer10_att_in_gpu1;
layer10_att_in_gpu1 -> layer10_qkv0_gpu1;
layer10_att_in_gpu1 -> layer10_qkv1_gpu1;
layer10_qkv0_gpu1 -> layer10_attout0_gpu1;
layer10_qkv1_gpu1 -> layer10_attout1_gpu1;
layer10_attout0_gpu1 -> layer10_att_agg_gpu1;
layer10_attout1_gpu1 -> layer10_att_agg_gpu1;
layer10_att_agg_gpu1 -> layer10_res1_gpu1;
layer10_res1_gpu1 -> layer10_ln1_gpu1;
input -> layer10_att_in_gpu2;
layer10_att_in_gpu2 -> layer10_qkv0_gpu2;
layer10_att_in_gpu2 -> layer10_qkv1_gpu2;
layer10_qkv0_gpu2 -> layer10_attout0_gpu2;
layer10_qkv1_gpu2 -> layer10_attout1_gpu2;
layer10_attout0_gpu2 -> layer10_att_agg_gpu2;
layer10_attout1_gpu2 -> layer10_att_agg_gpu2;
layer10_att_agg_gpu2 -> layer10_res1_gpu2;
layer10_res1_gpu2 -> layer10_ln1_gpu2;
layer10_ln1_gpu0 -> layer10_gate0_gpu0;
layer10_gate0_gpu0 -> layer10_expert0_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert0_fc1_gpu0;
layer10_expert0_fc1_gpu0 -> layer10_expert0_fc2_gpu0;
layer10_expert0_fc2_gpu0 -> layer10_expert0_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate1_gpu0;
layer10_gate1_gpu0 -> layer10_expert1_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert1_fc1_gpu0;
layer10_expert1_fc1_gpu0 -> layer10_expert1_fc2_gpu0;
layer10_expert1_fc2_gpu0 -> layer10_expert1_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate2_gpu0;
layer10_gate2_gpu0 -> layer10_expert2_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert2_fc1_gpu0;
layer10_expert2_fc1_gpu0 -> layer10_expert2_fc2_gpu0;
layer10_expert2_fc2_gpu0 -> layer10_expert2_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate3_gpu0;
layer10_gate3_gpu0 -> layer10_expert3_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert3_fc1_gpu0;
layer10_expert3_fc1_gpu0 -> layer10_expert3_fc2_gpu0;
layer10_expert3_fc2_gpu0 -> layer10_expert3_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate4_gpu0;
layer10_gate4_gpu0 -> layer10_expert4_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert4_fc1_gpu0;
layer10_expert4_fc1_gpu0 -> layer10_expert4_fc2_gpu0;
layer10_expert4_fc2_gpu0 -> layer10_expert4_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate5_gpu0;
layer10_gate5_gpu0 -> layer10_expert5_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert5_fc1_gpu0;
layer10_expert5_fc1_gpu0 -> layer10_expert5_fc2_gpu0;
layer10_expert5_fc2_gpu0 -> layer10_expert5_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate6_gpu0;
layer10_gate6_gpu0 -> layer10_expert6_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert6_fc1_gpu0;
layer10_expert6_fc1_gpu0 -> layer10_expert6_fc2_gpu0;
layer10_expert6_fc2_gpu0 -> layer10_expert6_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate7_gpu0;
layer10_gate7_gpu0 -> layer10_expert7_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert7_fc1_gpu0;
layer10_expert7_fc1_gpu0 -> layer10_expert7_fc2_gpu0;
layer10_expert7_fc2_gpu0 -> layer10_expert7_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate8_gpu0;
layer10_gate8_gpu0 -> layer10_expert8_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert8_fc1_gpu0;
layer10_expert8_fc1_gpu0 -> layer10_expert8_fc2_gpu0;
layer10_expert8_fc2_gpu0 -> layer10_expert8_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate9_gpu0;
layer10_gate9_gpu0 -> layer10_expert9_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert9_fc1_gpu0;
layer10_expert9_fc1_gpu0 -> layer10_expert9_fc2_gpu0;
layer10_expert9_fc2_gpu0 -> layer10_expert9_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate10_gpu0;
layer10_gate10_gpu0 -> layer10_expert10_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert10_fc1_gpu0;
layer10_expert10_fc1_gpu0 -> layer10_expert10_fc2_gpu0;
layer10_expert10_fc2_gpu0 -> layer10_expert10_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate11_gpu0;
layer10_gate11_gpu0 -> layer10_expert11_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert11_fc1_gpu0;
layer10_expert11_fc1_gpu0 -> layer10_expert11_fc2_gpu0;
layer10_expert11_fc2_gpu0 -> layer10_expert11_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate12_gpu0;
layer10_gate12_gpu0 -> layer10_expert12_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert12_fc1_gpu0;
layer10_expert12_fc1_gpu0 -> layer10_expert12_fc2_gpu0;
layer10_expert12_fc2_gpu0 -> layer10_expert12_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate13_gpu0;
layer10_gate13_gpu0 -> layer10_expert13_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert13_fc1_gpu0;
layer10_expert13_fc1_gpu0 -> layer10_expert13_fc2_gpu0;
layer10_expert13_fc2_gpu0 -> layer10_expert13_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate14_gpu0;
layer10_gate14_gpu0 -> layer10_expert14_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert14_fc1_gpu0;
layer10_expert14_fc1_gpu0 -> layer10_expert14_fc2_gpu0;
layer10_expert14_fc2_gpu0 -> layer10_expert14_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate15_gpu0;
layer10_gate15_gpu0 -> layer10_expert15_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert15_fc1_gpu0;
layer10_expert15_fc1_gpu0 -> layer10_expert15_fc2_gpu0;
layer10_expert15_fc2_gpu0 -> layer10_expert15_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate16_gpu0;
layer10_gate16_gpu0 -> layer10_expert16_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert16_fc1_gpu0;
layer10_expert16_fc1_gpu0 -> layer10_expert16_fc2_gpu0;
layer10_expert16_fc2_gpu0 -> layer10_expert16_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate17_gpu0;
layer10_gate17_gpu0 -> layer10_expert17_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert17_fc1_gpu0;
layer10_expert17_fc1_gpu0 -> layer10_expert17_fc2_gpu0;
layer10_expert17_fc2_gpu0 -> layer10_expert17_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate18_gpu0;
layer10_gate18_gpu0 -> layer10_expert18_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert18_fc1_gpu0;
layer10_expert18_fc1_gpu0 -> layer10_expert18_fc2_gpu0;
layer10_expert18_fc2_gpu0 -> layer10_expert18_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate19_gpu0;
layer10_gate19_gpu0 -> layer10_expert19_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert19_fc1_gpu0;
layer10_expert19_fc1_gpu0 -> layer10_expert19_fc2_gpu0;
layer10_expert19_fc2_gpu0 -> layer10_expert19_add_gpu0;
layer10_ln1_gpu0 -> layer10_gate20_gpu0;
layer10_gate20_gpu0 -> layer10_expert20_fc1_gpu0 [style=dashed];
layer10_ln1_gpu0 -> layer10_expert20_fc1_gpu0;
layer10_expert20_fc1_gpu0 -> layer10_expert20_fc2_gpu0;
layer10_expert20_fc2_gpu0 -> layer10_expert20_add_gpu0;
layer10_expert20_add_gpu0 -> layer11_att_in_gpu0;
layer10_ln1_gpu1 -> layer10_gate0_gpu1;
layer10_gate0_gpu1 -> layer10_expert0_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert0_fc1_gpu1;
layer10_expert0_fc1_gpu1 -> layer10_expert0_fc2_gpu1;
layer10_expert0_fc2_gpu1 -> layer10_expert0_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate1_gpu1;
layer10_gate1_gpu1 -> layer10_expert1_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert1_fc1_gpu1;
layer10_expert1_fc1_gpu1 -> layer10_expert1_fc2_gpu1;
layer10_expert1_fc2_gpu1 -> layer10_expert1_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate2_gpu1;
layer10_gate2_gpu1 -> layer10_expert2_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert2_fc1_gpu1;
layer10_expert2_fc1_gpu1 -> layer10_expert2_fc2_gpu1;
layer10_expert2_fc2_gpu1 -> layer10_expert2_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate3_gpu1;
layer10_gate3_gpu1 -> layer10_expert3_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert3_fc1_gpu1;
layer10_expert3_fc1_gpu1 -> layer10_expert3_fc2_gpu1;
layer10_expert3_fc2_gpu1 -> layer10_expert3_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate4_gpu1;
layer10_gate4_gpu1 -> layer10_expert4_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert4_fc1_gpu1;
layer10_expert4_fc1_gpu1 -> layer10_expert4_fc2_gpu1;
layer10_expert4_fc2_gpu1 -> layer10_expert4_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate5_gpu1;
layer10_gate5_gpu1 -> layer10_expert5_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert5_fc1_gpu1;
layer10_expert5_fc1_gpu1 -> layer10_expert5_fc2_gpu1;
layer10_expert5_fc2_gpu1 -> layer10_expert5_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate6_gpu1;
layer10_gate6_gpu1 -> layer10_expert6_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert6_fc1_gpu1;
layer10_expert6_fc1_gpu1 -> layer10_expert6_fc2_gpu1;
layer10_expert6_fc2_gpu1 -> layer10_expert6_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate7_gpu1;
layer10_gate7_gpu1 -> layer10_expert7_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert7_fc1_gpu1;
layer10_expert7_fc1_gpu1 -> layer10_expert7_fc2_gpu1;
layer10_expert7_fc2_gpu1 -> layer10_expert7_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate8_gpu1;
layer10_gate8_gpu1 -> layer10_expert8_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert8_fc1_gpu1;
layer10_expert8_fc1_gpu1 -> layer10_expert8_fc2_gpu1;
layer10_expert8_fc2_gpu1 -> layer10_expert8_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate9_gpu1;
layer10_gate9_gpu1 -> layer10_expert9_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert9_fc1_gpu1;
layer10_expert9_fc1_gpu1 -> layer10_expert9_fc2_gpu1;
layer10_expert9_fc2_gpu1 -> layer10_expert9_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate10_gpu1;
layer10_gate10_gpu1 -> layer10_expert10_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert10_fc1_gpu1;
layer10_expert10_fc1_gpu1 -> layer10_expert10_fc2_gpu1;
layer10_expert10_fc2_gpu1 -> layer10_expert10_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate11_gpu1;
layer10_gate11_gpu1 -> layer10_expert11_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert11_fc1_gpu1;
layer10_expert11_fc1_gpu1 -> layer10_expert11_fc2_gpu1;
layer10_expert11_fc2_gpu1 -> layer10_expert11_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate12_gpu1;
layer10_gate12_gpu1 -> layer10_expert12_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert12_fc1_gpu1;
layer10_expert12_fc1_gpu1 -> layer10_expert12_fc2_gpu1;
layer10_expert12_fc2_gpu1 -> layer10_expert12_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate13_gpu1;
layer10_gate13_gpu1 -> layer10_expert13_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert13_fc1_gpu1;
layer10_expert13_fc1_gpu1 -> layer10_expert13_fc2_gpu1;
layer10_expert13_fc2_gpu1 -> layer10_expert13_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate14_gpu1;
layer10_gate14_gpu1 -> layer10_expert14_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert14_fc1_gpu1;
layer10_expert14_fc1_gpu1 -> layer10_expert14_fc2_gpu1;
layer10_expert14_fc2_gpu1 -> layer10_expert14_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate15_gpu1;
layer10_gate15_gpu1 -> layer10_expert15_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert15_fc1_gpu1;
layer10_expert15_fc1_gpu1 -> layer10_expert15_fc2_gpu1;
layer10_expert15_fc2_gpu1 -> layer10_expert15_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate16_gpu1;
layer10_gate16_gpu1 -> layer10_expert16_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert16_fc1_gpu1;
layer10_expert16_fc1_gpu1 -> layer10_expert16_fc2_gpu1;
layer10_expert16_fc2_gpu1 -> layer10_expert16_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate17_gpu1;
layer10_gate17_gpu1 -> layer10_expert17_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert17_fc1_gpu1;
layer10_expert17_fc1_gpu1 -> layer10_expert17_fc2_gpu1;
layer10_expert17_fc2_gpu1 -> layer10_expert17_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate18_gpu1;
layer10_gate18_gpu1 -> layer10_expert18_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert18_fc1_gpu1;
layer10_expert18_fc1_gpu1 -> layer10_expert18_fc2_gpu1;
layer10_expert18_fc2_gpu1 -> layer10_expert18_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate19_gpu1;
layer10_gate19_gpu1 -> layer10_expert19_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert19_fc1_gpu1;
layer10_expert19_fc1_gpu1 -> layer10_expert19_fc2_gpu1;
layer10_expert19_fc2_gpu1 -> layer10_expert19_add_gpu1;
layer10_ln1_gpu1 -> layer10_gate20_gpu1;
layer10_gate20_gpu1 -> layer10_expert20_fc1_gpu1 [style=dashed];
layer10_ln1_gpu1 -> layer10_expert20_fc1_gpu1;
layer10_expert20_fc1_gpu1 -> layer10_expert20_fc2_gpu1;
layer10_expert20_fc2_gpu1 -> layer10_expert20_add_gpu1;
layer10_expert20_add_gpu1 -> layer11_att_in_gpu1;
layer10_ln1_gpu2 -> layer10_gate0_gpu2;
layer10_gate0_gpu2 -> layer10_expert0_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert0_fc1_gpu2;
layer10_expert0_fc1_gpu2 -> layer10_expert0_fc2_gpu2;
layer10_expert0_fc2_gpu2 -> layer10_expert0_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate1_gpu2;
layer10_gate1_gpu2 -> layer10_expert1_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert1_fc1_gpu2;
layer10_expert1_fc1_gpu2 -> layer10_expert1_fc2_gpu2;
layer10_expert1_fc2_gpu2 -> layer10_expert1_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate2_gpu2;
layer10_gate2_gpu2 -> layer10_expert2_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert2_fc1_gpu2;
layer10_expert2_fc1_gpu2 -> layer10_expert2_fc2_gpu2;
layer10_expert2_fc2_gpu2 -> layer10_expert2_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate3_gpu2;
layer10_gate3_gpu2 -> layer10_expert3_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert3_fc1_gpu2;
layer10_expert3_fc1_gpu2 -> layer10_expert3_fc2_gpu2;
layer10_expert3_fc2_gpu2 -> layer10_expert3_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate4_gpu2;
layer10_gate4_gpu2 -> layer10_expert4_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert4_fc1_gpu2;
layer10_expert4_fc1_gpu2 -> layer10_expert4_fc2_gpu2;
layer10_expert4_fc2_gpu2 -> layer10_expert4_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate5_gpu2;
layer10_gate5_gpu2 -> layer10_expert5_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert5_fc1_gpu2;
layer10_expert5_fc1_gpu2 -> layer10_expert5_fc2_gpu2;
layer10_expert5_fc2_gpu2 -> layer10_expert5_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate6_gpu2;
layer10_gate6_gpu2 -> layer10_expert6_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert6_fc1_gpu2;
layer10_expert6_fc1_gpu2 -> layer10_expert6_fc2_gpu2;
layer10_expert6_fc2_gpu2 -> layer10_expert6_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate7_gpu2;
layer10_gate7_gpu2 -> layer10_expert7_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert7_fc1_gpu2;
layer10_expert7_fc1_gpu2 -> layer10_expert7_fc2_gpu2;
layer10_expert7_fc2_gpu2 -> layer10_expert7_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate8_gpu2;
layer10_gate8_gpu2 -> layer10_expert8_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert8_fc1_gpu2;
layer10_expert8_fc1_gpu2 -> layer10_expert8_fc2_gpu2;
layer10_expert8_fc2_gpu2 -> layer10_expert8_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate9_gpu2;
layer10_gate9_gpu2 -> layer10_expert9_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert9_fc1_gpu2;
layer10_expert9_fc1_gpu2 -> layer10_expert9_fc2_gpu2;
layer10_expert9_fc2_gpu2 -> layer10_expert9_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate10_gpu2;
layer10_gate10_gpu2 -> layer10_expert10_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert10_fc1_gpu2;
layer10_expert10_fc1_gpu2 -> layer10_expert10_fc2_gpu2;
layer10_expert10_fc2_gpu2 -> layer10_expert10_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate11_gpu2;
layer10_gate11_gpu2 -> layer10_expert11_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert11_fc1_gpu2;
layer10_expert11_fc1_gpu2 -> layer10_expert11_fc2_gpu2;
layer10_expert11_fc2_gpu2 -> layer10_expert11_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate12_gpu2;
layer10_gate12_gpu2 -> layer10_expert12_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert12_fc1_gpu2;
layer10_expert12_fc1_gpu2 -> layer10_expert12_fc2_gpu2;
layer10_expert12_fc2_gpu2 -> layer10_expert12_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate13_gpu2;
layer10_gate13_gpu2 -> layer10_expert13_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert13_fc1_gpu2;
layer10_expert13_fc1_gpu2 -> layer10_expert13_fc2_gpu2;
layer10_expert13_fc2_gpu2 -> layer10_expert13_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate14_gpu2;
layer10_gate14_gpu2 -> layer10_expert14_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert14_fc1_gpu2;
layer10_expert14_fc1_gpu2 -> layer10_expert14_fc2_gpu2;
layer10_expert14_fc2_gpu2 -> layer10_expert14_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate15_gpu2;
layer10_gate15_gpu2 -> layer10_expert15_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert15_fc1_gpu2;
layer10_expert15_fc1_gpu2 -> layer10_expert15_fc2_gpu2;
layer10_expert15_fc2_gpu2 -> layer10_expert15_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate16_gpu2;
layer10_gate16_gpu2 -> layer10_expert16_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert16_fc1_gpu2;
layer10_expert16_fc1_gpu2 -> layer10_expert16_fc2_gpu2;
layer10_expert16_fc2_gpu2 -> layer10_expert16_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate17_gpu2;
layer10_gate17_gpu2 -> layer10_expert17_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert17_fc1_gpu2;
layer10_expert17_fc1_gpu2 -> layer10_expert17_fc2_gpu2;
layer10_expert17_fc2_gpu2 -> layer10_expert17_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate18_gpu2;
layer10_gate18_gpu2 -> layer10_expert18_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert18_fc1_gpu2;
layer10_expert18_fc1_gpu2 -> layer10_expert18_fc2_gpu2;
layer10_expert18_fc2_gpu2 -> layer10_expert18_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate19_gpu2;
layer10_gate19_gpu2 -> layer10_expert19_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert19_fc1_gpu2;
layer10_expert19_fc1_gpu2 -> layer10_expert19_fc2_gpu2;
layer10_expert19_fc2_gpu2 -> layer10_expert19_add_gpu2;
layer10_ln1_gpu2 -> layer10_gate20_gpu2;
layer10_gate20_gpu2 -> layer10_expert20_fc1_gpu2 [style=dashed];
layer10_ln1_gpu2 -> layer10_expert20_fc1_gpu2;
layer10_expert20_fc1_gpu2 -> layer10_expert20_fc2_gpu2;
layer10_expert20_fc2_gpu2 -> layer10_expert20_add_gpu2;
layer10_expert20_add_gpu2 -> layer11_att_in_gpu2;
input -> layer11_att_in_gpu0;
layer11_att_in_gpu0 -> layer11_qkv0_gpu0;
layer11_att_in_gpu0 -> layer11_qkv1_gpu0;
layer11_qkv0_gpu0 -> layer11_attout0_gpu0;
layer11_qkv1_gpu0 -> layer11_attout1_gpu0;
layer11_attout0_gpu0 -> layer11_att_agg_gpu0;
layer11_attout1_gpu0 -> layer11_att_agg_gpu0;
layer11_att_agg_gpu0 -> layer11_res1_gpu0;
layer11_res1_gpu0 -> layer11_ln1_gpu0;
input -> layer11_att_in_gpu1;
layer11_att_in_gpu1 -> layer11_qkv0_gpu1;
layer11_att_in_gpu1 -> layer11_qkv1_gpu1;
layer11_qkv0_gpu1 -> layer11_attout0_gpu1;
layer11_qkv1_gpu1 -> layer11_attout1_gpu1;
layer11_attout0_gpu1 -> layer11_att_agg_gpu1;
layer11_attout1_gpu1 -> layer11_att_agg_gpu1;
layer11_att_agg_gpu1 -> layer11_res1_gpu1;
layer11_res1_gpu1 -> layer11_ln1_gpu1;
input -> layer11_att_in_gpu2;
layer11_att_in_gpu2 -> layer11_qkv0_gpu2;
layer11_att_in_gpu2 -> layer11_qkv1_gpu2;
layer11_qkv0_gpu2 -> layer11_attout0_gpu2;
layer11_qkv1_gpu2 -> layer11_attout1_gpu2;
layer11_attout0_gpu2 -> layer11_att_agg_gpu2;
layer11_attout1_gpu2 -> layer11_att_agg_gpu2;
layer11_att_agg_gpu2 -> layer11_res1_gpu2;
layer11_res1_gpu2 -> layer11_ln1_gpu2;
layer11_ln1_gpu0 -> layer11_gate0_gpu0;
layer11_gate0_gpu0 -> layer11_expert0_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert0_fc1_gpu0;
layer11_expert0_fc1_gpu0 -> layer11_expert0_fc2_gpu0;
layer11_expert0_fc2_gpu0 -> layer11_expert0_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate1_gpu0;
layer11_gate1_gpu0 -> layer11_expert1_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert1_fc1_gpu0;
layer11_expert1_fc1_gpu0 -> layer11_expert1_fc2_gpu0;
layer11_expert1_fc2_gpu0 -> layer11_expert1_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate2_gpu0;
layer11_gate2_gpu0 -> layer11_expert2_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert2_fc1_gpu0;
layer11_expert2_fc1_gpu0 -> layer11_expert2_fc2_gpu0;
layer11_expert2_fc2_gpu0 -> layer11_expert2_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate3_gpu0;
layer11_gate3_gpu0 -> layer11_expert3_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert3_fc1_gpu0;
layer11_expert3_fc1_gpu0 -> layer11_expert3_fc2_gpu0;
layer11_expert3_fc2_gpu0 -> layer11_expert3_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate4_gpu0;
layer11_gate4_gpu0 -> layer11_expert4_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert4_fc1_gpu0;
layer11_expert4_fc1_gpu0 -> layer11_expert4_fc2_gpu0;
layer11_expert4_fc2_gpu0 -> layer11_expert4_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate5_gpu0;
layer11_gate5_gpu0 -> layer11_expert5_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert5_fc1_gpu0;
layer11_expert5_fc1_gpu0 -> layer11_expert5_fc2_gpu0;
layer11_expert5_fc2_gpu0 -> layer11_expert5_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate6_gpu0;
layer11_gate6_gpu0 -> layer11_expert6_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert6_fc1_gpu0;
layer11_expert6_fc1_gpu0 -> layer11_expert6_fc2_gpu0;
layer11_expert6_fc2_gpu0 -> layer11_expert6_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate7_gpu0;
layer11_gate7_gpu0 -> layer11_expert7_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert7_fc1_gpu0;
layer11_expert7_fc1_gpu0 -> layer11_expert7_fc2_gpu0;
layer11_expert7_fc2_gpu0 -> layer11_expert7_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate8_gpu0;
layer11_gate8_gpu0 -> layer11_expert8_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert8_fc1_gpu0;
layer11_expert8_fc1_gpu0 -> layer11_expert8_fc2_gpu0;
layer11_expert8_fc2_gpu0 -> layer11_expert8_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate9_gpu0;
layer11_gate9_gpu0 -> layer11_expert9_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert9_fc1_gpu0;
layer11_expert9_fc1_gpu0 -> layer11_expert9_fc2_gpu0;
layer11_expert9_fc2_gpu0 -> layer11_expert9_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate10_gpu0;
layer11_gate10_gpu0 -> layer11_expert10_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert10_fc1_gpu0;
layer11_expert10_fc1_gpu0 -> layer11_expert10_fc2_gpu0;
layer11_expert10_fc2_gpu0 -> layer11_expert10_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate11_gpu0;
layer11_gate11_gpu0 -> layer11_expert11_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert11_fc1_gpu0;
layer11_expert11_fc1_gpu0 -> layer11_expert11_fc2_gpu0;
layer11_expert11_fc2_gpu0 -> layer11_expert11_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate12_gpu0;
layer11_gate12_gpu0 -> layer11_expert12_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert12_fc1_gpu0;
layer11_expert12_fc1_gpu0 -> layer11_expert12_fc2_gpu0;
layer11_expert12_fc2_gpu0 -> layer11_expert12_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate13_gpu0;
layer11_gate13_gpu0 -> layer11_expert13_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert13_fc1_gpu0;
layer11_expert13_fc1_gpu0 -> layer11_expert13_fc2_gpu0;
layer11_expert13_fc2_gpu0 -> layer11_expert13_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate14_gpu0;
layer11_gate14_gpu0 -> layer11_expert14_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert14_fc1_gpu0;
layer11_expert14_fc1_gpu0 -> layer11_expert14_fc2_gpu0;
layer11_expert14_fc2_gpu0 -> layer11_expert14_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate15_gpu0;
layer11_gate15_gpu0 -> layer11_expert15_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert15_fc1_gpu0;
layer11_expert15_fc1_gpu0 -> layer11_expert15_fc2_gpu0;
layer11_expert15_fc2_gpu0 -> layer11_expert15_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate16_gpu0;
layer11_gate16_gpu0 -> layer11_expert16_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert16_fc1_gpu0;
layer11_expert16_fc1_gpu0 -> layer11_expert16_fc2_gpu0;
layer11_expert16_fc2_gpu0 -> layer11_expert16_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate17_gpu0;
layer11_gate17_gpu0 -> layer11_expert17_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert17_fc1_gpu0;
layer11_expert17_fc1_gpu0 -> layer11_expert17_fc2_gpu0;
layer11_expert17_fc2_gpu0 -> layer11_expert17_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate18_gpu0;
layer11_gate18_gpu0 -> layer11_expert18_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert18_fc1_gpu0;
layer11_expert18_fc1_gpu0 -> layer11_expert18_fc2_gpu0;
layer11_expert18_fc2_gpu0 -> layer11_expert18_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate19_gpu0;
layer11_gate19_gpu0 -> layer11_expert19_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert19_fc1_gpu0;
layer11_expert19_fc1_gpu0 -> layer11_expert19_fc2_gpu0;
layer11_expert19_fc2_gpu0 -> layer11_expert19_add_gpu0;
layer11_ln1_gpu0 -> layer11_gate20_gpu0;
layer11_gate20_gpu0 -> layer11_expert20_fc1_gpu0 [style=dashed];
layer11_ln1_gpu0 -> layer11_expert20_fc1_gpu0;
layer11_expert20_fc1_gpu0 -> layer11_expert20_fc2_gpu0;
layer11_expert20_fc2_gpu0 -> layer11_expert20_add_gpu0;
layer11_expert20_add_gpu0 -> layer12_att_in_gpu0;
layer11_ln1_gpu1 -> layer11_gate0_gpu1;
layer11_gate0_gpu1 -> layer11_expert0_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert0_fc1_gpu1;
layer11_expert0_fc1_gpu1 -> layer11_expert0_fc2_gpu1;
layer11_expert0_fc2_gpu1 -> layer11_expert0_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate1_gpu1;
layer11_gate1_gpu1 -> layer11_expert1_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert1_fc1_gpu1;
layer11_expert1_fc1_gpu1 -> layer11_expert1_fc2_gpu1;
layer11_expert1_fc2_gpu1 -> layer11_expert1_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate2_gpu1;
layer11_gate2_gpu1 -> layer11_expert2_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert2_fc1_gpu1;
layer11_expert2_fc1_gpu1 -> layer11_expert2_fc2_gpu1;
layer11_expert2_fc2_gpu1 -> layer11_expert2_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate3_gpu1;
layer11_gate3_gpu1 -> layer11_expert3_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert3_fc1_gpu1;
layer11_expert3_fc1_gpu1 -> layer11_expert3_fc2_gpu1;
layer11_expert3_fc2_gpu1 -> layer11_expert3_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate4_gpu1;
layer11_gate4_gpu1 -> layer11_expert4_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert4_fc1_gpu1;
layer11_expert4_fc1_gpu1 -> layer11_expert4_fc2_gpu1;
layer11_expert4_fc2_gpu1 -> layer11_expert4_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate5_gpu1;
layer11_gate5_gpu1 -> layer11_expert5_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert5_fc1_gpu1;
layer11_expert5_fc1_gpu1 -> layer11_expert5_fc2_gpu1;
layer11_expert5_fc2_gpu1 -> layer11_expert5_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate6_gpu1;
layer11_gate6_gpu1 -> layer11_expert6_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert6_fc1_gpu1;
layer11_expert6_fc1_gpu1 -> layer11_expert6_fc2_gpu1;
layer11_expert6_fc2_gpu1 -> layer11_expert6_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate7_gpu1;
layer11_gate7_gpu1 -> layer11_expert7_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert7_fc1_gpu1;
layer11_expert7_fc1_gpu1 -> layer11_expert7_fc2_gpu1;
layer11_expert7_fc2_gpu1 -> layer11_expert7_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate8_gpu1;
layer11_gate8_gpu1 -> layer11_expert8_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert8_fc1_gpu1;
layer11_expert8_fc1_gpu1 -> layer11_expert8_fc2_gpu1;
layer11_expert8_fc2_gpu1 -> layer11_expert8_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate9_gpu1;
layer11_gate9_gpu1 -> layer11_expert9_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert9_fc1_gpu1;
layer11_expert9_fc1_gpu1 -> layer11_expert9_fc2_gpu1;
layer11_expert9_fc2_gpu1 -> layer11_expert9_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate10_gpu1;
layer11_gate10_gpu1 -> layer11_expert10_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert10_fc1_gpu1;
layer11_expert10_fc1_gpu1 -> layer11_expert10_fc2_gpu1;
layer11_expert10_fc2_gpu1 -> layer11_expert10_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate11_gpu1;
layer11_gate11_gpu1 -> layer11_expert11_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert11_fc1_gpu1;
layer11_expert11_fc1_gpu1 -> layer11_expert11_fc2_gpu1;
layer11_expert11_fc2_gpu1 -> layer11_expert11_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate12_gpu1;
layer11_gate12_gpu1 -> layer11_expert12_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert12_fc1_gpu1;
layer11_expert12_fc1_gpu1 -> layer11_expert12_fc2_gpu1;
layer11_expert12_fc2_gpu1 -> layer11_expert12_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate13_gpu1;
layer11_gate13_gpu1 -> layer11_expert13_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert13_fc1_gpu1;
layer11_expert13_fc1_gpu1 -> layer11_expert13_fc2_gpu1;
layer11_expert13_fc2_gpu1 -> layer11_expert13_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate14_gpu1;
layer11_gate14_gpu1 -> layer11_expert14_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert14_fc1_gpu1;
layer11_expert14_fc1_gpu1 -> layer11_expert14_fc2_gpu1;
layer11_expert14_fc2_gpu1 -> layer11_expert14_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate15_gpu1;
layer11_gate15_gpu1 -> layer11_expert15_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert15_fc1_gpu1;
layer11_expert15_fc1_gpu1 -> layer11_expert15_fc2_gpu1;
layer11_expert15_fc2_gpu1 -> layer11_expert15_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate16_gpu1;
layer11_gate16_gpu1 -> layer11_expert16_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert16_fc1_gpu1;
layer11_expert16_fc1_gpu1 -> layer11_expert16_fc2_gpu1;
layer11_expert16_fc2_gpu1 -> layer11_expert16_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate17_gpu1;
layer11_gate17_gpu1 -> layer11_expert17_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert17_fc1_gpu1;
layer11_expert17_fc1_gpu1 -> layer11_expert17_fc2_gpu1;
layer11_expert17_fc2_gpu1 -> layer11_expert17_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate18_gpu1;
layer11_gate18_gpu1 -> layer11_expert18_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert18_fc1_gpu1;
layer11_expert18_fc1_gpu1 -> layer11_expert18_fc2_gpu1;
layer11_expert18_fc2_gpu1 -> layer11_expert18_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate19_gpu1;
layer11_gate19_gpu1 -> layer11_expert19_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert19_fc1_gpu1;
layer11_expert19_fc1_gpu1 -> layer11_expert19_fc2_gpu1;
layer11_expert19_fc2_gpu1 -> layer11_expert19_add_gpu1;
layer11_ln1_gpu1 -> layer11_gate20_gpu1;
layer11_gate20_gpu1 -> layer11_expert20_fc1_gpu1 [style=dashed];
layer11_ln1_gpu1 -> layer11_expert20_fc1_gpu1;
layer11_expert20_fc1_gpu1 -> layer11_expert20_fc2_gpu1;
layer11_expert20_fc2_gpu1 -> layer11_expert20_add_gpu1;
layer11_expert20_add_gpu1 -> layer12_att_in_gpu1;
layer11_ln1_gpu2 -> layer11_gate0_gpu2;
layer11_gate0_gpu2 -> layer11_expert0_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert0_fc1_gpu2;
layer11_expert0_fc1_gpu2 -> layer11_expert0_fc2_gpu2;
layer11_expert0_fc2_gpu2 -> layer11_expert0_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate1_gpu2;
layer11_gate1_gpu2 -> layer11_expert1_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert1_fc1_gpu2;
layer11_expert1_fc1_gpu2 -> layer11_expert1_fc2_gpu2;
layer11_expert1_fc2_gpu2 -> layer11_expert1_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate2_gpu2;
layer11_gate2_gpu2 -> layer11_expert2_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert2_fc1_gpu2;
layer11_expert2_fc1_gpu2 -> layer11_expert2_fc2_gpu2;
layer11_expert2_fc2_gpu2 -> layer11_expert2_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate3_gpu2;
layer11_gate3_gpu2 -> layer11_expert3_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert3_fc1_gpu2;
layer11_expert3_fc1_gpu2 -> layer11_expert3_fc2_gpu2;
layer11_expert3_fc2_gpu2 -> layer11_expert3_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate4_gpu2;
layer11_gate4_gpu2 -> layer11_expert4_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert4_fc1_gpu2;
layer11_expert4_fc1_gpu2 -> layer11_expert4_fc2_gpu2;
layer11_expert4_fc2_gpu2 -> layer11_expert4_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate5_gpu2;
layer11_gate5_gpu2 -> layer11_expert5_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert5_fc1_gpu2;
layer11_expert5_fc1_gpu2 -> layer11_expert5_fc2_gpu2;
layer11_expert5_fc2_gpu2 -> layer11_expert5_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate6_gpu2;
layer11_gate6_gpu2 -> layer11_expert6_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert6_fc1_gpu2;
layer11_expert6_fc1_gpu2 -> layer11_expert6_fc2_gpu2;
layer11_expert6_fc2_gpu2 -> layer11_expert6_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate7_gpu2;
layer11_gate7_gpu2 -> layer11_expert7_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert7_fc1_gpu2;
layer11_expert7_fc1_gpu2 -> layer11_expert7_fc2_gpu2;
layer11_expert7_fc2_gpu2 -> layer11_expert7_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate8_gpu2;
layer11_gate8_gpu2 -> layer11_expert8_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert8_fc1_gpu2;
layer11_expert8_fc1_gpu2 -> layer11_expert8_fc2_gpu2;
layer11_expert8_fc2_gpu2 -> layer11_expert8_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate9_gpu2;
layer11_gate9_gpu2 -> layer11_expert9_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert9_fc1_gpu2;
layer11_expert9_fc1_gpu2 -> layer11_expert9_fc2_gpu2;
layer11_expert9_fc2_gpu2 -> layer11_expert9_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate10_gpu2;
layer11_gate10_gpu2 -> layer11_expert10_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert10_fc1_gpu2;
layer11_expert10_fc1_gpu2 -> layer11_expert10_fc2_gpu2;
layer11_expert10_fc2_gpu2 -> layer11_expert10_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate11_gpu2;
layer11_gate11_gpu2 -> layer11_expert11_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert11_fc1_gpu2;
layer11_expert11_fc1_gpu2 -> layer11_expert11_fc2_gpu2;
layer11_expert11_fc2_gpu2 -> layer11_expert11_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate12_gpu2;
layer11_gate12_gpu2 -> layer11_expert12_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert12_fc1_gpu2;
layer11_expert12_fc1_gpu2 -> layer11_expert12_fc2_gpu2;
layer11_expert12_fc2_gpu2 -> layer11_expert12_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate13_gpu2;
layer11_gate13_gpu2 -> layer11_expert13_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert13_fc1_gpu2;
layer11_expert13_fc1_gpu2 -> layer11_expert13_fc2_gpu2;
layer11_expert13_fc2_gpu2 -> layer11_expert13_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate14_gpu2;
layer11_gate14_gpu2 -> layer11_expert14_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert14_fc1_gpu2;
layer11_expert14_fc1_gpu2 -> layer11_expert14_fc2_gpu2;
layer11_expert14_fc2_gpu2 -> layer11_expert14_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate15_gpu2;
layer11_gate15_gpu2 -> layer11_expert15_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert15_fc1_gpu2;
layer11_expert15_fc1_gpu2 -> layer11_expert15_fc2_gpu2;
layer11_expert15_fc2_gpu2 -> layer11_expert15_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate16_gpu2;
layer11_gate16_gpu2 -> layer11_expert16_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert16_fc1_gpu2;
layer11_expert16_fc1_gpu2 -> layer11_expert16_fc2_gpu2;
layer11_expert16_fc2_gpu2 -> layer11_expert16_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate17_gpu2;
layer11_gate17_gpu2 -> layer11_expert17_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert17_fc1_gpu2;
layer11_expert17_fc1_gpu2 -> layer11_expert17_fc2_gpu2;
layer11_expert17_fc2_gpu2 -> layer11_expert17_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate18_gpu2;
layer11_gate18_gpu2 -> layer11_expert18_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert18_fc1_gpu2;
layer11_expert18_fc1_gpu2 -> layer11_expert18_fc2_gpu2;
layer11_expert18_fc2_gpu2 -> layer11_expert18_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate19_gpu2;
layer11_gate19_gpu2 -> layer11_expert19_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert19_fc1_gpu2;
layer11_expert19_fc1_gpu2 -> layer11_expert19_fc2_gpu2;
layer11_expert19_fc2_gpu2 -> layer11_expert19_add_gpu2;
layer11_ln1_gpu2 -> layer11_gate20_gpu2;
layer11_gate20_gpu2 -> layer11_expert20_fc1_gpu2 [style=dashed];
layer11_ln1_gpu2 -> layer11_expert20_fc1_gpu2;
layer11_expert20_fc1_gpu2 -> layer11_expert20_fc2_gpu2;
layer11_expert20_fc2_gpu2 -> layer11_expert20_add_gpu2;
layer11_expert20_add_gpu2 -> layer12_att_in_gpu2;
input -> layer12_att_in_gpu0;
layer12_att_in_gpu0 -> layer12_qkv0_gpu0;
layer12_att_in_gpu0 -> layer12_qkv1_gpu0;
layer12_qkv0_gpu0 -> layer12_attout0_gpu0;
layer12_qkv1_gpu0 -> layer12_attout1_gpu0;
layer12_attout0_gpu0 -> layer12_att_agg_gpu0;
layer12_attout1_gpu0 -> layer12_att_agg_gpu0;
layer12_att_agg_gpu0 -> layer12_res1_gpu0;
layer12_res1_gpu0 -> layer12_ln1_gpu0;
input -> layer12_att_in_gpu1;
layer12_att_in_gpu1 -> layer12_qkv0_gpu1;
layer12_att_in_gpu1 -> layer12_qkv1_gpu1;
layer12_qkv0_gpu1 -> layer12_attout0_gpu1;
layer12_qkv1_gpu1 -> layer12_attout1_gpu1;
layer12_attout0_gpu1 -> layer12_att_agg_gpu1;
layer12_attout1_gpu1 -> layer12_att_agg_gpu1;
layer12_att_agg_gpu1 -> layer12_res1_gpu1;
layer12_res1_gpu1 -> layer12_ln1_gpu1;
input -> layer12_att_in_gpu2;
layer12_att_in_gpu2 -> layer12_qkv0_gpu2;
layer12_att_in_gpu2 -> layer12_qkv1_gpu2;
layer12_qkv0_gpu2 -> layer12_attout0_gpu2;
layer12_qkv1_gpu2 -> layer12_attout1_gpu2;
layer12_attout0_gpu2 -> layer12_att_agg_gpu2;
layer12_attout1_gpu2 -> layer12_att_agg_gpu2;
layer12_att_agg_gpu2 -> layer12_res1_gpu2;
layer12_res1_gpu2 -> layer12_ln1_gpu2;
layer12_ln1_gpu0 -> layer12_gate0_gpu0;
layer12_gate0_gpu0 -> layer12_expert0_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert0_fc1_gpu0;
layer12_expert0_fc1_gpu0 -> layer12_expert0_fc2_gpu0;
layer12_expert0_fc2_gpu0 -> layer12_expert0_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate1_gpu0;
layer12_gate1_gpu0 -> layer12_expert1_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert1_fc1_gpu0;
layer12_expert1_fc1_gpu0 -> layer12_expert1_fc2_gpu0;
layer12_expert1_fc2_gpu0 -> layer12_expert1_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate2_gpu0;
layer12_gate2_gpu0 -> layer12_expert2_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert2_fc1_gpu0;
layer12_expert2_fc1_gpu0 -> layer12_expert2_fc2_gpu0;
layer12_expert2_fc2_gpu0 -> layer12_expert2_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate3_gpu0;
layer12_gate3_gpu0 -> layer12_expert3_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert3_fc1_gpu0;
layer12_expert3_fc1_gpu0 -> layer12_expert3_fc2_gpu0;
layer12_expert3_fc2_gpu0 -> layer12_expert3_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate4_gpu0;
layer12_gate4_gpu0 -> layer12_expert4_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert4_fc1_gpu0;
layer12_expert4_fc1_gpu0 -> layer12_expert4_fc2_gpu0;
layer12_expert4_fc2_gpu0 -> layer12_expert4_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate5_gpu0;
layer12_gate5_gpu0 -> layer12_expert5_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert5_fc1_gpu0;
layer12_expert5_fc1_gpu0 -> layer12_expert5_fc2_gpu0;
layer12_expert5_fc2_gpu0 -> layer12_expert5_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate6_gpu0;
layer12_gate6_gpu0 -> layer12_expert6_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert6_fc1_gpu0;
layer12_expert6_fc1_gpu0 -> layer12_expert6_fc2_gpu0;
layer12_expert6_fc2_gpu0 -> layer12_expert6_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate7_gpu0;
layer12_gate7_gpu0 -> layer12_expert7_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert7_fc1_gpu0;
layer12_expert7_fc1_gpu0 -> layer12_expert7_fc2_gpu0;
layer12_expert7_fc2_gpu0 -> layer12_expert7_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate8_gpu0;
layer12_gate8_gpu0 -> layer12_expert8_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert8_fc1_gpu0;
layer12_expert8_fc1_gpu0 -> layer12_expert8_fc2_gpu0;
layer12_expert8_fc2_gpu0 -> layer12_expert8_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate9_gpu0;
layer12_gate9_gpu0 -> layer12_expert9_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert9_fc1_gpu0;
layer12_expert9_fc1_gpu0 -> layer12_expert9_fc2_gpu0;
layer12_expert9_fc2_gpu0 -> layer12_expert9_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate10_gpu0;
layer12_gate10_gpu0 -> layer12_expert10_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert10_fc1_gpu0;
layer12_expert10_fc1_gpu0 -> layer12_expert10_fc2_gpu0;
layer12_expert10_fc2_gpu0 -> layer12_expert10_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate11_gpu0;
layer12_gate11_gpu0 -> layer12_expert11_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert11_fc1_gpu0;
layer12_expert11_fc1_gpu0 -> layer12_expert11_fc2_gpu0;
layer12_expert11_fc2_gpu0 -> layer12_expert11_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate12_gpu0;
layer12_gate12_gpu0 -> layer12_expert12_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert12_fc1_gpu0;
layer12_expert12_fc1_gpu0 -> layer12_expert12_fc2_gpu0;
layer12_expert12_fc2_gpu0 -> layer12_expert12_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate13_gpu0;
layer12_gate13_gpu0 -> layer12_expert13_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert13_fc1_gpu0;
layer12_expert13_fc1_gpu0 -> layer12_expert13_fc2_gpu0;
layer12_expert13_fc2_gpu0 -> layer12_expert13_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate14_gpu0;
layer12_gate14_gpu0 -> layer12_expert14_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert14_fc1_gpu0;
layer12_expert14_fc1_gpu0 -> layer12_expert14_fc2_gpu0;
layer12_expert14_fc2_gpu0 -> layer12_expert14_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate15_gpu0;
layer12_gate15_gpu0 -> layer12_expert15_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert15_fc1_gpu0;
layer12_expert15_fc1_gpu0 -> layer12_expert15_fc2_gpu0;
layer12_expert15_fc2_gpu0 -> layer12_expert15_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate16_gpu0;
layer12_gate16_gpu0 -> layer12_expert16_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert16_fc1_gpu0;
layer12_expert16_fc1_gpu0 -> layer12_expert16_fc2_gpu0;
layer12_expert16_fc2_gpu0 -> layer12_expert16_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate17_gpu0;
layer12_gate17_gpu0 -> layer12_expert17_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert17_fc1_gpu0;
layer12_expert17_fc1_gpu0 -> layer12_expert17_fc2_gpu0;
layer12_expert17_fc2_gpu0 -> layer12_expert17_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate18_gpu0;
layer12_gate18_gpu0 -> layer12_expert18_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert18_fc1_gpu0;
layer12_expert18_fc1_gpu0 -> layer12_expert18_fc2_gpu0;
layer12_expert18_fc2_gpu0 -> layer12_expert18_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate19_gpu0;
layer12_gate19_gpu0 -> layer12_expert19_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert19_fc1_gpu0;
layer12_expert19_fc1_gpu0 -> layer12_expert19_fc2_gpu0;
layer12_expert19_fc2_gpu0 -> layer12_expert19_add_gpu0;
layer12_ln1_gpu0 -> layer12_gate20_gpu0;
layer12_gate20_gpu0 -> layer12_expert20_fc1_gpu0 [style=dashed];
layer12_ln1_gpu0 -> layer12_expert20_fc1_gpu0;
layer12_expert20_fc1_gpu0 -> layer12_expert20_fc2_gpu0;
layer12_expert20_fc2_gpu0 -> layer12_expert20_add_gpu0;
layer12_expert20_add_gpu0 -> layer13_att_in_gpu0;
layer12_ln1_gpu1 -> layer12_gate0_gpu1;
layer12_gate0_gpu1 -> layer12_expert0_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert0_fc1_gpu1;
layer12_expert0_fc1_gpu1 -> layer12_expert0_fc2_gpu1;
layer12_expert0_fc2_gpu1 -> layer12_expert0_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate1_gpu1;
layer12_gate1_gpu1 -> layer12_expert1_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert1_fc1_gpu1;
layer12_expert1_fc1_gpu1 -> layer12_expert1_fc2_gpu1;
layer12_expert1_fc2_gpu1 -> layer12_expert1_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate2_gpu1;
layer12_gate2_gpu1 -> layer12_expert2_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert2_fc1_gpu1;
layer12_expert2_fc1_gpu1 -> layer12_expert2_fc2_gpu1;
layer12_expert2_fc2_gpu1 -> layer12_expert2_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate3_gpu1;
layer12_gate3_gpu1 -> layer12_expert3_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert3_fc1_gpu1;
layer12_expert3_fc1_gpu1 -> layer12_expert3_fc2_gpu1;
layer12_expert3_fc2_gpu1 -> layer12_expert3_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate4_gpu1;
layer12_gate4_gpu1 -> layer12_expert4_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert4_fc1_gpu1;
layer12_expert4_fc1_gpu1 -> layer12_expert4_fc2_gpu1;
layer12_expert4_fc2_gpu1 -> layer12_expert4_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate5_gpu1;
layer12_gate5_gpu1 -> layer12_expert5_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert5_fc1_gpu1;
layer12_expert5_fc1_gpu1 -> layer12_expert5_fc2_gpu1;
layer12_expert5_fc2_gpu1 -> layer12_expert5_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate6_gpu1;
layer12_gate6_gpu1 -> layer12_expert6_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert6_fc1_gpu1;
layer12_expert6_fc1_gpu1 -> layer12_expert6_fc2_gpu1;
layer12_expert6_fc2_gpu1 -> layer12_expert6_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate7_gpu1;
layer12_gate7_gpu1 -> layer12_expert7_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert7_fc1_gpu1;
layer12_expert7_fc1_gpu1 -> layer12_expert7_fc2_gpu1;
layer12_expert7_fc2_gpu1 -> layer12_expert7_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate8_gpu1;
layer12_gate8_gpu1 -> layer12_expert8_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert8_fc1_gpu1;
layer12_expert8_fc1_gpu1 -> layer12_expert8_fc2_gpu1;
layer12_expert8_fc2_gpu1 -> layer12_expert8_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate9_gpu1;
layer12_gate9_gpu1 -> layer12_expert9_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert9_fc1_gpu1;
layer12_expert9_fc1_gpu1 -> layer12_expert9_fc2_gpu1;
layer12_expert9_fc2_gpu1 -> layer12_expert9_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate10_gpu1;
layer12_gate10_gpu1 -> layer12_expert10_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert10_fc1_gpu1;
layer12_expert10_fc1_gpu1 -> layer12_expert10_fc2_gpu1;
layer12_expert10_fc2_gpu1 -> layer12_expert10_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate11_gpu1;
layer12_gate11_gpu1 -> layer12_expert11_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert11_fc1_gpu1;
layer12_expert11_fc1_gpu1 -> layer12_expert11_fc2_gpu1;
layer12_expert11_fc2_gpu1 -> layer12_expert11_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate12_gpu1;
layer12_gate12_gpu1 -> layer12_expert12_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert12_fc1_gpu1;
layer12_expert12_fc1_gpu1 -> layer12_expert12_fc2_gpu1;
layer12_expert12_fc2_gpu1 -> layer12_expert12_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate13_gpu1;
layer12_gate13_gpu1 -> layer12_expert13_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert13_fc1_gpu1;
layer12_expert13_fc1_gpu1 -> layer12_expert13_fc2_gpu1;
layer12_expert13_fc2_gpu1 -> layer12_expert13_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate14_gpu1;
layer12_gate14_gpu1 -> layer12_expert14_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert14_fc1_gpu1;
layer12_expert14_fc1_gpu1 -> layer12_expert14_fc2_gpu1;
layer12_expert14_fc2_gpu1 -> layer12_expert14_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate15_gpu1;
layer12_gate15_gpu1 -> layer12_expert15_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert15_fc1_gpu1;
layer12_expert15_fc1_gpu1 -> layer12_expert15_fc2_gpu1;
layer12_expert15_fc2_gpu1 -> layer12_expert15_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate16_gpu1;
layer12_gate16_gpu1 -> layer12_expert16_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert16_fc1_gpu1;
layer12_expert16_fc1_gpu1 -> layer12_expert16_fc2_gpu1;
layer12_expert16_fc2_gpu1 -> layer12_expert16_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate17_gpu1;
layer12_gate17_gpu1 -> layer12_expert17_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert17_fc1_gpu1;
layer12_expert17_fc1_gpu1 -> layer12_expert17_fc2_gpu1;
layer12_expert17_fc2_gpu1 -> layer12_expert17_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate18_gpu1;
layer12_gate18_gpu1 -> layer12_expert18_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert18_fc1_gpu1;
layer12_expert18_fc1_gpu1 -> layer12_expert18_fc2_gpu1;
layer12_expert18_fc2_gpu1 -> layer12_expert18_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate19_gpu1;
layer12_gate19_gpu1 -> layer12_expert19_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert19_fc1_gpu1;
layer12_expert19_fc1_gpu1 -> layer12_expert19_fc2_gpu1;
layer12_expert19_fc2_gpu1 -> layer12_expert19_add_gpu1;
layer12_ln1_gpu1 -> layer12_gate20_gpu1;
layer12_gate20_gpu1 -> layer12_expert20_fc1_gpu1 [style=dashed];
layer12_ln1_gpu1 -> layer12_expert20_fc1_gpu1;
layer12_expert20_fc1_gpu1 -> layer12_expert20_fc2_gpu1;
layer12_expert20_fc2_gpu1 -> layer12_expert20_add_gpu1;
layer12_expert20_add_gpu1 -> layer13_att_in_gpu1;
layer12_ln1_gpu2 -> layer12_gate0_gpu2;
layer12_gate0_gpu2 -> layer12_expert0_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert0_fc1_gpu2;
layer12_expert0_fc1_gpu2 -> layer12_expert0_fc2_gpu2;
layer12_expert0_fc2_gpu2 -> layer12_expert0_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate1_gpu2;
layer12_gate1_gpu2 -> layer12_expert1_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert1_fc1_gpu2;
layer12_expert1_fc1_gpu2 -> layer12_expert1_fc2_gpu2;
layer12_expert1_fc2_gpu2 -> layer12_expert1_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate2_gpu2;
layer12_gate2_gpu2 -> layer12_expert2_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert2_fc1_gpu2;
layer12_expert2_fc1_gpu2 -> layer12_expert2_fc2_gpu2;
layer12_expert2_fc2_gpu2 -> layer12_expert2_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate3_gpu2;
layer12_gate3_gpu2 -> layer12_expert3_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert3_fc1_gpu2;
layer12_expert3_fc1_gpu2 -> layer12_expert3_fc2_gpu2;
layer12_expert3_fc2_gpu2 -> layer12_expert3_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate4_gpu2;
layer12_gate4_gpu2 -> layer12_expert4_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert4_fc1_gpu2;
layer12_expert4_fc1_gpu2 -> layer12_expert4_fc2_gpu2;
layer12_expert4_fc2_gpu2 -> layer12_expert4_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate5_gpu2;
layer12_gate5_gpu2 -> layer12_expert5_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert5_fc1_gpu2;
layer12_expert5_fc1_gpu2 -> layer12_expert5_fc2_gpu2;
layer12_expert5_fc2_gpu2 -> layer12_expert5_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate6_gpu2;
layer12_gate6_gpu2 -> layer12_expert6_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert6_fc1_gpu2;
layer12_expert6_fc1_gpu2 -> layer12_expert6_fc2_gpu2;
layer12_expert6_fc2_gpu2 -> layer12_expert6_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate7_gpu2;
layer12_gate7_gpu2 -> layer12_expert7_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert7_fc1_gpu2;
layer12_expert7_fc1_gpu2 -> layer12_expert7_fc2_gpu2;
layer12_expert7_fc2_gpu2 -> layer12_expert7_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate8_gpu2;
layer12_gate8_gpu2 -> layer12_expert8_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert8_fc1_gpu2;
layer12_expert8_fc1_gpu2 -> layer12_expert8_fc2_gpu2;
layer12_expert8_fc2_gpu2 -> layer12_expert8_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate9_gpu2;
layer12_gate9_gpu2 -> layer12_expert9_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert9_fc1_gpu2;
layer12_expert9_fc1_gpu2 -> layer12_expert9_fc2_gpu2;
layer12_expert9_fc2_gpu2 -> layer12_expert9_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate10_gpu2;
layer12_gate10_gpu2 -> layer12_expert10_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert10_fc1_gpu2;
layer12_expert10_fc1_gpu2 -> layer12_expert10_fc2_gpu2;
layer12_expert10_fc2_gpu2 -> layer12_expert10_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate11_gpu2;
layer12_gate11_gpu2 -> layer12_expert11_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert11_fc1_gpu2;
layer12_expert11_fc1_gpu2 -> layer12_expert11_fc2_gpu2;
layer12_expert11_fc2_gpu2 -> layer12_expert11_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate12_gpu2;
layer12_gate12_gpu2 -> layer12_expert12_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert12_fc1_gpu2;
layer12_expert12_fc1_gpu2 -> layer12_expert12_fc2_gpu2;
layer12_expert12_fc2_gpu2 -> layer12_expert12_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate13_gpu2;
layer12_gate13_gpu2 -> layer12_expert13_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert13_fc1_gpu2;
layer12_expert13_fc1_gpu2 -> layer12_expert13_fc2_gpu2;
layer12_expert13_fc2_gpu2 -> layer12_expert13_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate14_gpu2;
layer12_gate14_gpu2 -> layer12_expert14_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert14_fc1_gpu2;
layer12_expert14_fc1_gpu2 -> layer12_expert14_fc2_gpu2;
layer12_expert14_fc2_gpu2 -> layer12_expert14_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate15_gpu2;
layer12_gate15_gpu2 -> layer12_expert15_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert15_fc1_gpu2;
layer12_expert15_fc1_gpu2 -> layer12_expert15_fc2_gpu2;
layer12_expert15_fc2_gpu2 -> layer12_expert15_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate16_gpu2;
layer12_gate16_gpu2 -> layer12_expert16_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert16_fc1_gpu2;
layer12_expert16_fc1_gpu2 -> layer12_expert16_fc2_gpu2;
layer12_expert16_fc2_gpu2 -> layer12_expert16_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate17_gpu2;
layer12_gate17_gpu2 -> layer12_expert17_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert17_fc1_gpu2;
layer12_expert17_fc1_gpu2 -> layer12_expert17_fc2_gpu2;
layer12_expert17_fc2_gpu2 -> layer12_expert17_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate18_gpu2;
layer12_gate18_gpu2 -> layer12_expert18_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert18_fc1_gpu2;
layer12_expert18_fc1_gpu2 -> layer12_expert18_fc2_gpu2;
layer12_expert18_fc2_gpu2 -> layer12_expert18_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate19_gpu2;
layer12_gate19_gpu2 -> layer12_expert19_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert19_fc1_gpu2;
layer12_expert19_fc1_gpu2 -> layer12_expert19_fc2_gpu2;
layer12_expert19_fc2_gpu2 -> layer12_expert19_add_gpu2;
layer12_ln1_gpu2 -> layer12_gate20_gpu2;
layer12_gate20_gpu2 -> layer12_expert20_fc1_gpu2 [style=dashed];
layer12_ln1_gpu2 -> layer12_expert20_fc1_gpu2;
layer12_expert20_fc1_gpu2 -> layer12_expert20_fc2_gpu2;
layer12_expert20_fc2_gpu2 -> layer12_expert20_add_gpu2;
layer12_expert20_add_gpu2 -> layer13_att_in_gpu2;
input -> layer13_att_in_gpu0;
layer13_att_in_gpu0 -> layer13_qkv0_gpu0;
layer13_att_in_gpu0 -> layer13_qkv1_gpu0;
layer13_qkv0_gpu0 -> layer13_attout0_gpu0;
layer13_qkv1_gpu0 -> layer13_attout1_gpu0;
layer13_attout0_gpu0 -> layer13_att_agg_gpu0;
layer13_attout1_gpu0 -> layer13_att_agg_gpu0;
layer13_att_agg_gpu0 -> layer13_res1_gpu0;
layer13_res1_gpu0 -> layer13_ln1_gpu0;
input -> layer13_att_in_gpu1;
layer13_att_in_gpu1 -> layer13_qkv0_gpu1;
layer13_att_in_gpu1 -> layer13_qkv1_gpu1;
layer13_qkv0_gpu1 -> layer13_attout0_gpu1;
layer13_qkv1_gpu1 -> layer13_attout1_gpu1;
layer13_attout0_gpu1 -> layer13_att_agg_gpu1;
layer13_attout1_gpu1 -> layer13_att_agg_gpu1;
layer13_att_agg_gpu1 -> layer13_res1_gpu1;
layer13_res1_gpu1 -> layer13_ln1_gpu1;
input -> layer13_att_in_gpu2;
layer13_att_in_gpu2 -> layer13_qkv0_gpu2;
layer13_att_in_gpu2 -> layer13_qkv1_gpu2;
layer13_qkv0_gpu2 -> layer13_attout0_gpu2;
layer13_qkv1_gpu2 -> layer13_attout1_gpu2;
layer13_attout0_gpu2 -> layer13_att_agg_gpu2;
layer13_attout1_gpu2 -> layer13_att_agg_gpu2;
layer13_att_agg_gpu2 -> layer13_res1_gpu2;
layer13_res1_gpu2 -> layer13_ln1_gpu2;
layer13_ln1_gpu0 -> layer13_gate0_gpu0;
layer13_gate0_gpu0 -> layer13_expert0_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert0_fc1_gpu0;
layer13_expert0_fc1_gpu0 -> layer13_expert0_fc2_gpu0;
layer13_expert0_fc2_gpu0 -> layer13_expert0_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate1_gpu0;
layer13_gate1_gpu0 -> layer13_expert1_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert1_fc1_gpu0;
layer13_expert1_fc1_gpu0 -> layer13_expert1_fc2_gpu0;
layer13_expert1_fc2_gpu0 -> layer13_expert1_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate2_gpu0;
layer13_gate2_gpu0 -> layer13_expert2_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert2_fc1_gpu0;
layer13_expert2_fc1_gpu0 -> layer13_expert2_fc2_gpu0;
layer13_expert2_fc2_gpu0 -> layer13_expert2_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate3_gpu0;
layer13_gate3_gpu0 -> layer13_expert3_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert3_fc1_gpu0;
layer13_expert3_fc1_gpu0 -> layer13_expert3_fc2_gpu0;
layer13_expert3_fc2_gpu0 -> layer13_expert3_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate4_gpu0;
layer13_gate4_gpu0 -> layer13_expert4_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert4_fc1_gpu0;
layer13_expert4_fc1_gpu0 -> layer13_expert4_fc2_gpu0;
layer13_expert4_fc2_gpu0 -> layer13_expert4_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate5_gpu0;
layer13_gate5_gpu0 -> layer13_expert5_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert5_fc1_gpu0;
layer13_expert5_fc1_gpu0 -> layer13_expert5_fc2_gpu0;
layer13_expert5_fc2_gpu0 -> layer13_expert5_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate6_gpu0;
layer13_gate6_gpu0 -> layer13_expert6_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert6_fc1_gpu0;
layer13_expert6_fc1_gpu0 -> layer13_expert6_fc2_gpu0;
layer13_expert6_fc2_gpu0 -> layer13_expert6_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate7_gpu0;
layer13_gate7_gpu0 -> layer13_expert7_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert7_fc1_gpu0;
layer13_expert7_fc1_gpu0 -> layer13_expert7_fc2_gpu0;
layer13_expert7_fc2_gpu0 -> layer13_expert7_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate8_gpu0;
layer13_gate8_gpu0 -> layer13_expert8_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert8_fc1_gpu0;
layer13_expert8_fc1_gpu0 -> layer13_expert8_fc2_gpu0;
layer13_expert8_fc2_gpu0 -> layer13_expert8_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate9_gpu0;
layer13_gate9_gpu0 -> layer13_expert9_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert9_fc1_gpu0;
layer13_expert9_fc1_gpu0 -> layer13_expert9_fc2_gpu0;
layer13_expert9_fc2_gpu0 -> layer13_expert9_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate10_gpu0;
layer13_gate10_gpu0 -> layer13_expert10_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert10_fc1_gpu0;
layer13_expert10_fc1_gpu0 -> layer13_expert10_fc2_gpu0;
layer13_expert10_fc2_gpu0 -> layer13_expert10_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate11_gpu0;
layer13_gate11_gpu0 -> layer13_expert11_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert11_fc1_gpu0;
layer13_expert11_fc1_gpu0 -> layer13_expert11_fc2_gpu0;
layer13_expert11_fc2_gpu0 -> layer13_expert11_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate12_gpu0;
layer13_gate12_gpu0 -> layer13_expert12_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert12_fc1_gpu0;
layer13_expert12_fc1_gpu0 -> layer13_expert12_fc2_gpu0;
layer13_expert12_fc2_gpu0 -> layer13_expert12_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate13_gpu0;
layer13_gate13_gpu0 -> layer13_expert13_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert13_fc1_gpu0;
layer13_expert13_fc1_gpu0 -> layer13_expert13_fc2_gpu0;
layer13_expert13_fc2_gpu0 -> layer13_expert13_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate14_gpu0;
layer13_gate14_gpu0 -> layer13_expert14_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert14_fc1_gpu0;
layer13_expert14_fc1_gpu0 -> layer13_expert14_fc2_gpu0;
layer13_expert14_fc2_gpu0 -> layer13_expert14_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate15_gpu0;
layer13_gate15_gpu0 -> layer13_expert15_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert15_fc1_gpu0;
layer13_expert15_fc1_gpu0 -> layer13_expert15_fc2_gpu0;
layer13_expert15_fc2_gpu0 -> layer13_expert15_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate16_gpu0;
layer13_gate16_gpu0 -> layer13_expert16_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert16_fc1_gpu0;
layer13_expert16_fc1_gpu0 -> layer13_expert16_fc2_gpu0;
layer13_expert16_fc2_gpu0 -> layer13_expert16_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate17_gpu0;
layer13_gate17_gpu0 -> layer13_expert17_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert17_fc1_gpu0;
layer13_expert17_fc1_gpu0 -> layer13_expert17_fc2_gpu0;
layer13_expert17_fc2_gpu0 -> layer13_expert17_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate18_gpu0;
layer13_gate18_gpu0 -> layer13_expert18_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert18_fc1_gpu0;
layer13_expert18_fc1_gpu0 -> layer13_expert18_fc2_gpu0;
layer13_expert18_fc2_gpu0 -> layer13_expert18_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate19_gpu0;
layer13_gate19_gpu0 -> layer13_expert19_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert19_fc1_gpu0;
layer13_expert19_fc1_gpu0 -> layer13_expert19_fc2_gpu0;
layer13_expert19_fc2_gpu0 -> layer13_expert19_add_gpu0;
layer13_ln1_gpu0 -> layer13_gate20_gpu0;
layer13_gate20_gpu0 -> layer13_expert20_fc1_gpu0 [style=dashed];
layer13_ln1_gpu0 -> layer13_expert20_fc1_gpu0;
layer13_expert20_fc1_gpu0 -> layer13_expert20_fc2_gpu0;
layer13_expert20_fc2_gpu0 -> layer13_expert20_add_gpu0;
layer13_expert20_add_gpu0 -> layer14_att_in_gpu0;
layer13_ln1_gpu1 -> layer13_gate0_gpu1;
layer13_gate0_gpu1 -> layer13_expert0_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert0_fc1_gpu1;
layer13_expert0_fc1_gpu1 -> layer13_expert0_fc2_gpu1;
layer13_expert0_fc2_gpu1 -> layer13_expert0_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate1_gpu1;
layer13_gate1_gpu1 -> layer13_expert1_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert1_fc1_gpu1;
layer13_expert1_fc1_gpu1 -> layer13_expert1_fc2_gpu1;
layer13_expert1_fc2_gpu1 -> layer13_expert1_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate2_gpu1;
layer13_gate2_gpu1 -> layer13_expert2_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert2_fc1_gpu1;
layer13_expert2_fc1_gpu1 -> layer13_expert2_fc2_gpu1;
layer13_expert2_fc2_gpu1 -> layer13_expert2_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate3_gpu1;
layer13_gate3_gpu1 -> layer13_expert3_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert3_fc1_gpu1;
layer13_expert3_fc1_gpu1 -> layer13_expert3_fc2_gpu1;
layer13_expert3_fc2_gpu1 -> layer13_expert3_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate4_gpu1;
layer13_gate4_gpu1 -> layer13_expert4_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert4_fc1_gpu1;
layer13_expert4_fc1_gpu1 -> layer13_expert4_fc2_gpu1;
layer13_expert4_fc2_gpu1 -> layer13_expert4_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate5_gpu1;
layer13_gate5_gpu1 -> layer13_expert5_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert5_fc1_gpu1;
layer13_expert5_fc1_gpu1 -> layer13_expert5_fc2_gpu1;
layer13_expert5_fc2_gpu1 -> layer13_expert5_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate6_gpu1;
layer13_gate6_gpu1 -> layer13_expert6_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert6_fc1_gpu1;
layer13_expert6_fc1_gpu1 -> layer13_expert6_fc2_gpu1;
layer13_expert6_fc2_gpu1 -> layer13_expert6_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate7_gpu1;
layer13_gate7_gpu1 -> layer13_expert7_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert7_fc1_gpu1;
layer13_expert7_fc1_gpu1 -> layer13_expert7_fc2_gpu1;
layer13_expert7_fc2_gpu1 -> layer13_expert7_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate8_gpu1;
layer13_gate8_gpu1 -> layer13_expert8_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert8_fc1_gpu1;
layer13_expert8_fc1_gpu1 -> layer13_expert8_fc2_gpu1;
layer13_expert8_fc2_gpu1 -> layer13_expert8_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate9_gpu1;
layer13_gate9_gpu1 -> layer13_expert9_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert9_fc1_gpu1;
layer13_expert9_fc1_gpu1 -> layer13_expert9_fc2_gpu1;
layer13_expert9_fc2_gpu1 -> layer13_expert9_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate10_gpu1;
layer13_gate10_gpu1 -> layer13_expert10_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert10_fc1_gpu1;
layer13_expert10_fc1_gpu1 -> layer13_expert10_fc2_gpu1;
layer13_expert10_fc2_gpu1 -> layer13_expert10_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate11_gpu1;
layer13_gate11_gpu1 -> layer13_expert11_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert11_fc1_gpu1;
layer13_expert11_fc1_gpu1 -> layer13_expert11_fc2_gpu1;
layer13_expert11_fc2_gpu1 -> layer13_expert11_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate12_gpu1;
layer13_gate12_gpu1 -> layer13_expert12_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert12_fc1_gpu1;
layer13_expert12_fc1_gpu1 -> layer13_expert12_fc2_gpu1;
layer13_expert12_fc2_gpu1 -> layer13_expert12_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate13_gpu1;
layer13_gate13_gpu1 -> layer13_expert13_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert13_fc1_gpu1;
layer13_expert13_fc1_gpu1 -> layer13_expert13_fc2_gpu1;
layer13_expert13_fc2_gpu1 -> layer13_expert13_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate14_gpu1;
layer13_gate14_gpu1 -> layer13_expert14_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert14_fc1_gpu1;
layer13_expert14_fc1_gpu1 -> layer13_expert14_fc2_gpu1;
layer13_expert14_fc2_gpu1 -> layer13_expert14_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate15_gpu1;
layer13_gate15_gpu1 -> layer13_expert15_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert15_fc1_gpu1;
layer13_expert15_fc1_gpu1 -> layer13_expert15_fc2_gpu1;
layer13_expert15_fc2_gpu1 -> layer13_expert15_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate16_gpu1;
layer13_gate16_gpu1 -> layer13_expert16_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert16_fc1_gpu1;
layer13_expert16_fc1_gpu1 -> layer13_expert16_fc2_gpu1;
layer13_expert16_fc2_gpu1 -> layer13_expert16_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate17_gpu1;
layer13_gate17_gpu1 -> layer13_expert17_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert17_fc1_gpu1;
layer13_expert17_fc1_gpu1 -> layer13_expert17_fc2_gpu1;
layer13_expert17_fc2_gpu1 -> layer13_expert17_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate18_gpu1;
layer13_gate18_gpu1 -> layer13_expert18_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert18_fc1_gpu1;
layer13_expert18_fc1_gpu1 -> layer13_expert18_fc2_gpu1;
layer13_expert18_fc2_gpu1 -> layer13_expert18_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate19_gpu1;
layer13_gate19_gpu1 -> layer13_expert19_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert19_fc1_gpu1;
layer13_expert19_fc1_gpu1 -> layer13_expert19_fc2_gpu1;
layer13_expert19_fc2_gpu1 -> layer13_expert19_add_gpu1;
layer13_ln1_gpu1 -> layer13_gate20_gpu1;
layer13_gate20_gpu1 -> layer13_expert20_fc1_gpu1 [style=dashed];
layer13_ln1_gpu1 -> layer13_expert20_fc1_gpu1;
layer13_expert20_fc1_gpu1 -> layer13_expert20_fc2_gpu1;
layer13_expert20_fc2_gpu1 -> layer13_expert20_add_gpu1;
layer13_expert20_add_gpu1 -> layer14_att_in_gpu1;
layer13_ln1_gpu2 -> layer13_gate0_gpu2;
layer13_gate0_gpu2 -> layer13_expert0_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert0_fc1_gpu2;
layer13_expert0_fc1_gpu2 -> layer13_expert0_fc2_gpu2;
layer13_expert0_fc2_gpu2 -> layer13_expert0_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate1_gpu2;
layer13_gate1_gpu2 -> layer13_expert1_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert1_fc1_gpu2;
layer13_expert1_fc1_gpu2 -> layer13_expert1_fc2_gpu2;
layer13_expert1_fc2_gpu2 -> layer13_expert1_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate2_gpu2;
layer13_gate2_gpu2 -> layer13_expert2_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert2_fc1_gpu2;
layer13_expert2_fc1_gpu2 -> layer13_expert2_fc2_gpu2;
layer13_expert2_fc2_gpu2 -> layer13_expert2_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate3_gpu2;
layer13_gate3_gpu2 -> layer13_expert3_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert3_fc1_gpu2;
layer13_expert3_fc1_gpu2 -> layer13_expert3_fc2_gpu2;
layer13_expert3_fc2_gpu2 -> layer13_expert3_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate4_gpu2;
layer13_gate4_gpu2 -> layer13_expert4_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert4_fc1_gpu2;
layer13_expert4_fc1_gpu2 -> layer13_expert4_fc2_gpu2;
layer13_expert4_fc2_gpu2 -> layer13_expert4_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate5_gpu2;
layer13_gate5_gpu2 -> layer13_expert5_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert5_fc1_gpu2;
layer13_expert5_fc1_gpu2 -> layer13_expert5_fc2_gpu2;
layer13_expert5_fc2_gpu2 -> layer13_expert5_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate6_gpu2;
layer13_gate6_gpu2 -> layer13_expert6_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert6_fc1_gpu2;
layer13_expert6_fc1_gpu2 -> layer13_expert6_fc2_gpu2;
layer13_expert6_fc2_gpu2 -> layer13_expert6_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate7_gpu2;
layer13_gate7_gpu2 -> layer13_expert7_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert7_fc1_gpu2;
layer13_expert7_fc1_gpu2 -> layer13_expert7_fc2_gpu2;
layer13_expert7_fc2_gpu2 -> layer13_expert7_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate8_gpu2;
layer13_gate8_gpu2 -> layer13_expert8_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert8_fc1_gpu2;
layer13_expert8_fc1_gpu2 -> layer13_expert8_fc2_gpu2;
layer13_expert8_fc2_gpu2 -> layer13_expert8_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate9_gpu2;
layer13_gate9_gpu2 -> layer13_expert9_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert9_fc1_gpu2;
layer13_expert9_fc1_gpu2 -> layer13_expert9_fc2_gpu2;
layer13_expert9_fc2_gpu2 -> layer13_expert9_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate10_gpu2;
layer13_gate10_gpu2 -> layer13_expert10_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert10_fc1_gpu2;
layer13_expert10_fc1_gpu2 -> layer13_expert10_fc2_gpu2;
layer13_expert10_fc2_gpu2 -> layer13_expert10_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate11_gpu2;
layer13_gate11_gpu2 -> layer13_expert11_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert11_fc1_gpu2;
layer13_expert11_fc1_gpu2 -> layer13_expert11_fc2_gpu2;
layer13_expert11_fc2_gpu2 -> layer13_expert11_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate12_gpu2;
layer13_gate12_gpu2 -> layer13_expert12_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert12_fc1_gpu2;
layer13_expert12_fc1_gpu2 -> layer13_expert12_fc2_gpu2;
layer13_expert12_fc2_gpu2 -> layer13_expert12_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate13_gpu2;
layer13_gate13_gpu2 -> layer13_expert13_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert13_fc1_gpu2;
layer13_expert13_fc1_gpu2 -> layer13_expert13_fc2_gpu2;
layer13_expert13_fc2_gpu2 -> layer13_expert13_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate14_gpu2;
layer13_gate14_gpu2 -> layer13_expert14_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert14_fc1_gpu2;
layer13_expert14_fc1_gpu2 -> layer13_expert14_fc2_gpu2;
layer13_expert14_fc2_gpu2 -> layer13_expert14_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate15_gpu2;
layer13_gate15_gpu2 -> layer13_expert15_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert15_fc1_gpu2;
layer13_expert15_fc1_gpu2 -> layer13_expert15_fc2_gpu2;
layer13_expert15_fc2_gpu2 -> layer13_expert15_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate16_gpu2;
layer13_gate16_gpu2 -> layer13_expert16_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert16_fc1_gpu2;
layer13_expert16_fc1_gpu2 -> layer13_expert16_fc2_gpu2;
layer13_expert16_fc2_gpu2 -> layer13_expert16_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate17_gpu2;
layer13_gate17_gpu2 -> layer13_expert17_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert17_fc1_gpu2;
layer13_expert17_fc1_gpu2 -> layer13_expert17_fc2_gpu2;
layer13_expert17_fc2_gpu2 -> layer13_expert17_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate18_gpu2;
layer13_gate18_gpu2 -> layer13_expert18_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert18_fc1_gpu2;
layer13_expert18_fc1_gpu2 -> layer13_expert18_fc2_gpu2;
layer13_expert18_fc2_gpu2 -> layer13_expert18_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate19_gpu2;
layer13_gate19_gpu2 -> layer13_expert19_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert19_fc1_gpu2;
layer13_expert19_fc1_gpu2 -> layer13_expert19_fc2_gpu2;
layer13_expert19_fc2_gpu2 -> layer13_expert19_add_gpu2;
layer13_ln1_gpu2 -> layer13_gate20_gpu2;
layer13_gate20_gpu2 -> layer13_expert20_fc1_gpu2 [style=dashed];
layer13_ln1_gpu2 -> layer13_expert20_fc1_gpu2;
layer13_expert20_fc1_gpu2 -> layer13_expert20_fc2_gpu2;
layer13_expert20_fc2_gpu2 -> layer13_expert20_add_gpu2;
layer13_expert20_add_gpu2 -> layer14_att_in_gpu2;
input -> layer14_att_in_gpu0;
layer14_att_in_gpu0 -> layer14_qkv0_gpu0;
layer14_att_in_gpu0 -> layer14_qkv1_gpu0;
layer14_qkv0_gpu0 -> layer14_attout0_gpu0;
layer14_qkv1_gpu0 -> layer14_attout1_gpu0;
layer14_attout0_gpu0 -> layer14_att_agg_gpu0;
layer14_attout1_gpu0 -> layer14_att_agg_gpu0;
layer14_att_agg_gpu0 -> layer14_res1_gpu0;
layer14_res1_gpu0 -> layer14_ln1_gpu0;
input -> layer14_att_in_gpu1;
layer14_att_in_gpu1 -> layer14_qkv0_gpu1;
layer14_att_in_gpu1 -> layer14_qkv1_gpu1;
layer14_qkv0_gpu1 -> layer14_attout0_gpu1;
layer14_qkv1_gpu1 -> layer14_attout1_gpu1;
layer14_attout0_gpu1 -> layer14_att_agg_gpu1;
layer14_attout1_gpu1 -> layer14_att_agg_gpu1;
layer14_att_agg_gpu1 -> layer14_res1_gpu1;
layer14_res1_gpu1 -> layer14_ln1_gpu1;
input -> layer14_att_in_gpu2;
layer14_att_in_gpu2 -> layer14_qkv0_gpu2;
layer14_att_in_gpu2 -> layer14_qkv1_gpu2;
layer14_qkv0_gpu2 -> layer14_attout0_gpu2;
layer14_qkv1_gpu2 -> layer14_attout1_gpu2;
layer14_attout0_gpu2 -> layer14_att_agg_gpu2;
layer14_attout1_gpu2 -> layer14_att_agg_gpu2;
layer14_att_agg_gpu2 -> layer14_res1_gpu2;
layer14_res1_gpu2 -> layer14_ln1_gpu2;
layer14_ln1_gpu0 -> layer14_gate0_gpu0;
layer14_gate0_gpu0 -> layer14_expert0_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert0_fc1_gpu0;
layer14_expert0_fc1_gpu0 -> layer14_expert0_fc2_gpu0;
layer14_expert0_fc2_gpu0 -> layer14_expert0_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate1_gpu0;
layer14_gate1_gpu0 -> layer14_expert1_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert1_fc1_gpu0;
layer14_expert1_fc1_gpu0 -> layer14_expert1_fc2_gpu0;
layer14_expert1_fc2_gpu0 -> layer14_expert1_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate2_gpu0;
layer14_gate2_gpu0 -> layer14_expert2_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert2_fc1_gpu0;
layer14_expert2_fc1_gpu0 -> layer14_expert2_fc2_gpu0;
layer14_expert2_fc2_gpu0 -> layer14_expert2_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate3_gpu0;
layer14_gate3_gpu0 -> layer14_expert3_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert3_fc1_gpu0;
layer14_expert3_fc1_gpu0 -> layer14_expert3_fc2_gpu0;
layer14_expert3_fc2_gpu0 -> layer14_expert3_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate4_gpu0;
layer14_gate4_gpu0 -> layer14_expert4_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert4_fc1_gpu0;
layer14_expert4_fc1_gpu0 -> layer14_expert4_fc2_gpu0;
layer14_expert4_fc2_gpu0 -> layer14_expert4_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate5_gpu0;
layer14_gate5_gpu0 -> layer14_expert5_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert5_fc1_gpu0;
layer14_expert5_fc1_gpu0 -> layer14_expert5_fc2_gpu0;
layer14_expert5_fc2_gpu0 -> layer14_expert5_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate6_gpu0;
layer14_gate6_gpu0 -> layer14_expert6_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert6_fc1_gpu0;
layer14_expert6_fc1_gpu0 -> layer14_expert6_fc2_gpu0;
layer14_expert6_fc2_gpu0 -> layer14_expert6_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate7_gpu0;
layer14_gate7_gpu0 -> layer14_expert7_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert7_fc1_gpu0;
layer14_expert7_fc1_gpu0 -> layer14_expert7_fc2_gpu0;
layer14_expert7_fc2_gpu0 -> layer14_expert7_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate8_gpu0;
layer14_gate8_gpu0 -> layer14_expert8_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert8_fc1_gpu0;
layer14_expert8_fc1_gpu0 -> layer14_expert8_fc2_gpu0;
layer14_expert8_fc2_gpu0 -> layer14_expert8_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate9_gpu0;
layer14_gate9_gpu0 -> layer14_expert9_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert9_fc1_gpu0;
layer14_expert9_fc1_gpu0 -> layer14_expert9_fc2_gpu0;
layer14_expert9_fc2_gpu0 -> layer14_expert9_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate10_gpu0;
layer14_gate10_gpu0 -> layer14_expert10_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert10_fc1_gpu0;
layer14_expert10_fc1_gpu0 -> layer14_expert10_fc2_gpu0;
layer14_expert10_fc2_gpu0 -> layer14_expert10_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate11_gpu0;
layer14_gate11_gpu0 -> layer14_expert11_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert11_fc1_gpu0;
layer14_expert11_fc1_gpu0 -> layer14_expert11_fc2_gpu0;
layer14_expert11_fc2_gpu0 -> layer14_expert11_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate12_gpu0;
layer14_gate12_gpu0 -> layer14_expert12_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert12_fc1_gpu0;
layer14_expert12_fc1_gpu0 -> layer14_expert12_fc2_gpu0;
layer14_expert12_fc2_gpu0 -> layer14_expert12_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate13_gpu0;
layer14_gate13_gpu0 -> layer14_expert13_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert13_fc1_gpu0;
layer14_expert13_fc1_gpu0 -> layer14_expert13_fc2_gpu0;
layer14_expert13_fc2_gpu0 -> layer14_expert13_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate14_gpu0;
layer14_gate14_gpu0 -> layer14_expert14_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert14_fc1_gpu0;
layer14_expert14_fc1_gpu0 -> layer14_expert14_fc2_gpu0;
layer14_expert14_fc2_gpu0 -> layer14_expert14_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate15_gpu0;
layer14_gate15_gpu0 -> layer14_expert15_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert15_fc1_gpu0;
layer14_expert15_fc1_gpu0 -> layer14_expert15_fc2_gpu0;
layer14_expert15_fc2_gpu0 -> layer14_expert15_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate16_gpu0;
layer14_gate16_gpu0 -> layer14_expert16_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert16_fc1_gpu0;
layer14_expert16_fc1_gpu0 -> layer14_expert16_fc2_gpu0;
layer14_expert16_fc2_gpu0 -> layer14_expert16_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate17_gpu0;
layer14_gate17_gpu0 -> layer14_expert17_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert17_fc1_gpu0;
layer14_expert17_fc1_gpu0 -> layer14_expert17_fc2_gpu0;
layer14_expert17_fc2_gpu0 -> layer14_expert17_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate18_gpu0;
layer14_gate18_gpu0 -> layer14_expert18_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert18_fc1_gpu0;
layer14_expert18_fc1_gpu0 -> layer14_expert18_fc2_gpu0;
layer14_expert18_fc2_gpu0 -> layer14_expert18_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate19_gpu0;
layer14_gate19_gpu0 -> layer14_expert19_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert19_fc1_gpu0;
layer14_expert19_fc1_gpu0 -> layer14_expert19_fc2_gpu0;
layer14_expert19_fc2_gpu0 -> layer14_expert19_add_gpu0;
layer14_ln1_gpu0 -> layer14_gate20_gpu0;
layer14_gate20_gpu0 -> layer14_expert20_fc1_gpu0 [style=dashed];
layer14_ln1_gpu0 -> layer14_expert20_fc1_gpu0;
layer14_expert20_fc1_gpu0 -> layer14_expert20_fc2_gpu0;
layer14_expert20_fc2_gpu0 -> layer14_expert20_add_gpu0;
layer14_expert20_add_gpu0 -> layer15_att_in_gpu0;
layer14_ln1_gpu1 -> layer14_gate0_gpu1;
layer14_gate0_gpu1 -> layer14_expert0_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert0_fc1_gpu1;
layer14_expert0_fc1_gpu1 -> layer14_expert0_fc2_gpu1;
layer14_expert0_fc2_gpu1 -> layer14_expert0_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate1_gpu1;
layer14_gate1_gpu1 -> layer14_expert1_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert1_fc1_gpu1;
layer14_expert1_fc1_gpu1 -> layer14_expert1_fc2_gpu1;
layer14_expert1_fc2_gpu1 -> layer14_expert1_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate2_gpu1;
layer14_gate2_gpu1 -> layer14_expert2_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert2_fc1_gpu1;
layer14_expert2_fc1_gpu1 -> layer14_expert2_fc2_gpu1;
layer14_expert2_fc2_gpu1 -> layer14_expert2_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate3_gpu1;
layer14_gate3_gpu1 -> layer14_expert3_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert3_fc1_gpu1;
layer14_expert3_fc1_gpu1 -> layer14_expert3_fc2_gpu1;
layer14_expert3_fc2_gpu1 -> layer14_expert3_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate4_gpu1;
layer14_gate4_gpu1 -> layer14_expert4_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert4_fc1_gpu1;
layer14_expert4_fc1_gpu1 -> layer14_expert4_fc2_gpu1;
layer14_expert4_fc2_gpu1 -> layer14_expert4_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate5_gpu1;
layer14_gate5_gpu1 -> layer14_expert5_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert5_fc1_gpu1;
layer14_expert5_fc1_gpu1 -> layer14_expert5_fc2_gpu1;
layer14_expert5_fc2_gpu1 -> layer14_expert5_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate6_gpu1;
layer14_gate6_gpu1 -> layer14_expert6_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert6_fc1_gpu1;
layer14_expert6_fc1_gpu1 -> layer14_expert6_fc2_gpu1;
layer14_expert6_fc2_gpu1 -> layer14_expert6_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate7_gpu1;
layer14_gate7_gpu1 -> layer14_expert7_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert7_fc1_gpu1;
layer14_expert7_fc1_gpu1 -> layer14_expert7_fc2_gpu1;
layer14_expert7_fc2_gpu1 -> layer14_expert7_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate8_gpu1;
layer14_gate8_gpu1 -> layer14_expert8_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert8_fc1_gpu1;
layer14_expert8_fc1_gpu1 -> layer14_expert8_fc2_gpu1;
layer14_expert8_fc2_gpu1 -> layer14_expert8_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate9_gpu1;
layer14_gate9_gpu1 -> layer14_expert9_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert9_fc1_gpu1;
layer14_expert9_fc1_gpu1 -> layer14_expert9_fc2_gpu1;
layer14_expert9_fc2_gpu1 -> layer14_expert9_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate10_gpu1;
layer14_gate10_gpu1 -> layer14_expert10_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert10_fc1_gpu1;
layer14_expert10_fc1_gpu1 -> layer14_expert10_fc2_gpu1;
layer14_expert10_fc2_gpu1 -> layer14_expert10_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate11_gpu1;
layer14_gate11_gpu1 -> layer14_expert11_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert11_fc1_gpu1;
layer14_expert11_fc1_gpu1 -> layer14_expert11_fc2_gpu1;
layer14_expert11_fc2_gpu1 -> layer14_expert11_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate12_gpu1;
layer14_gate12_gpu1 -> layer14_expert12_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert12_fc1_gpu1;
layer14_expert12_fc1_gpu1 -> layer14_expert12_fc2_gpu1;
layer14_expert12_fc2_gpu1 -> layer14_expert12_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate13_gpu1;
layer14_gate13_gpu1 -> layer14_expert13_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert13_fc1_gpu1;
layer14_expert13_fc1_gpu1 -> layer14_expert13_fc2_gpu1;
layer14_expert13_fc2_gpu1 -> layer14_expert13_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate14_gpu1;
layer14_gate14_gpu1 -> layer14_expert14_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert14_fc1_gpu1;
layer14_expert14_fc1_gpu1 -> layer14_expert14_fc2_gpu1;
layer14_expert14_fc2_gpu1 -> layer14_expert14_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate15_gpu1;
layer14_gate15_gpu1 -> layer14_expert15_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert15_fc1_gpu1;
layer14_expert15_fc1_gpu1 -> layer14_expert15_fc2_gpu1;
layer14_expert15_fc2_gpu1 -> layer14_expert15_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate16_gpu1;
layer14_gate16_gpu1 -> layer14_expert16_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert16_fc1_gpu1;
layer14_expert16_fc1_gpu1 -> layer14_expert16_fc2_gpu1;
layer14_expert16_fc2_gpu1 -> layer14_expert16_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate17_gpu1;
layer14_gate17_gpu1 -> layer14_expert17_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert17_fc1_gpu1;
layer14_expert17_fc1_gpu1 -> layer14_expert17_fc2_gpu1;
layer14_expert17_fc2_gpu1 -> layer14_expert17_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate18_gpu1;
layer14_gate18_gpu1 -> layer14_expert18_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert18_fc1_gpu1;
layer14_expert18_fc1_gpu1 -> layer14_expert18_fc2_gpu1;
layer14_expert18_fc2_gpu1 -> layer14_expert18_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate19_gpu1;
layer14_gate19_gpu1 -> layer14_expert19_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert19_fc1_gpu1;
layer14_expert19_fc1_gpu1 -> layer14_expert19_fc2_gpu1;
layer14_expert19_fc2_gpu1 -> layer14_expert19_add_gpu1;
layer14_ln1_gpu1 -> layer14_gate20_gpu1;
layer14_gate20_gpu1 -> layer14_expert20_fc1_gpu1 [style=dashed];
layer14_ln1_gpu1 -> layer14_expert20_fc1_gpu1;
layer14_expert20_fc1_gpu1 -> layer14_expert20_fc2_gpu1;
layer14_expert20_fc2_gpu1 -> layer14_expert20_add_gpu1;
layer14_expert20_add_gpu1 -> layer15_att_in_gpu1;
layer14_ln1_gpu2 -> layer14_gate0_gpu2;
layer14_gate0_gpu2 -> layer14_expert0_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert0_fc1_gpu2;
layer14_expert0_fc1_gpu2 -> layer14_expert0_fc2_gpu2;
layer14_expert0_fc2_gpu2 -> layer14_expert0_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate1_gpu2;
layer14_gate1_gpu2 -> layer14_expert1_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert1_fc1_gpu2;
layer14_expert1_fc1_gpu2 -> layer14_expert1_fc2_gpu2;
layer14_expert1_fc2_gpu2 -> layer14_expert1_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate2_gpu2;
layer14_gate2_gpu2 -> layer14_expert2_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert2_fc1_gpu2;
layer14_expert2_fc1_gpu2 -> layer14_expert2_fc2_gpu2;
layer14_expert2_fc2_gpu2 -> layer14_expert2_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate3_gpu2;
layer14_gate3_gpu2 -> layer14_expert3_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert3_fc1_gpu2;
layer14_expert3_fc1_gpu2 -> layer14_expert3_fc2_gpu2;
layer14_expert3_fc2_gpu2 -> layer14_expert3_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate4_gpu2;
layer14_gate4_gpu2 -> layer14_expert4_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert4_fc1_gpu2;
layer14_expert4_fc1_gpu2 -> layer14_expert4_fc2_gpu2;
layer14_expert4_fc2_gpu2 -> layer14_expert4_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate5_gpu2;
layer14_gate5_gpu2 -> layer14_expert5_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert5_fc1_gpu2;
layer14_expert5_fc1_gpu2 -> layer14_expert5_fc2_gpu2;
layer14_expert5_fc2_gpu2 -> layer14_expert5_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate6_gpu2;
layer14_gate6_gpu2 -> layer14_expert6_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert6_fc1_gpu2;
layer14_expert6_fc1_gpu2 -> layer14_expert6_fc2_gpu2;
layer14_expert6_fc2_gpu2 -> layer14_expert6_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate7_gpu2;
layer14_gate7_gpu2 -> layer14_expert7_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert7_fc1_gpu2;
layer14_expert7_fc1_gpu2 -> layer14_expert7_fc2_gpu2;
layer14_expert7_fc2_gpu2 -> layer14_expert7_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate8_gpu2;
layer14_gate8_gpu2 -> layer14_expert8_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert8_fc1_gpu2;
layer14_expert8_fc1_gpu2 -> layer14_expert8_fc2_gpu2;
layer14_expert8_fc2_gpu2 -> layer14_expert8_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate9_gpu2;
layer14_gate9_gpu2 -> layer14_expert9_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert9_fc1_gpu2;
layer14_expert9_fc1_gpu2 -> layer14_expert9_fc2_gpu2;
layer14_expert9_fc2_gpu2 -> layer14_expert9_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate10_gpu2;
layer14_gate10_gpu2 -> layer14_expert10_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert10_fc1_gpu2;
layer14_expert10_fc1_gpu2 -> layer14_expert10_fc2_gpu2;
layer14_expert10_fc2_gpu2 -> layer14_expert10_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate11_gpu2;
layer14_gate11_gpu2 -> layer14_expert11_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert11_fc1_gpu2;
layer14_expert11_fc1_gpu2 -> layer14_expert11_fc2_gpu2;
layer14_expert11_fc2_gpu2 -> layer14_expert11_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate12_gpu2;
layer14_gate12_gpu2 -> layer14_expert12_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert12_fc1_gpu2;
layer14_expert12_fc1_gpu2 -> layer14_expert12_fc2_gpu2;
layer14_expert12_fc2_gpu2 -> layer14_expert12_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate13_gpu2;
layer14_gate13_gpu2 -> layer14_expert13_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert13_fc1_gpu2;
layer14_expert13_fc1_gpu2 -> layer14_expert13_fc2_gpu2;
layer14_expert13_fc2_gpu2 -> layer14_expert13_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate14_gpu2;
layer14_gate14_gpu2 -> layer14_expert14_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert14_fc1_gpu2;
layer14_expert14_fc1_gpu2 -> layer14_expert14_fc2_gpu2;
layer14_expert14_fc2_gpu2 -> layer14_expert14_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate15_gpu2;
layer14_gate15_gpu2 -> layer14_expert15_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert15_fc1_gpu2;
layer14_expert15_fc1_gpu2 -> layer14_expert15_fc2_gpu2;
layer14_expert15_fc2_gpu2 -> layer14_expert15_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate16_gpu2;
layer14_gate16_gpu2 -> layer14_expert16_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert16_fc1_gpu2;
layer14_expert16_fc1_gpu2 -> layer14_expert16_fc2_gpu2;
layer14_expert16_fc2_gpu2 -> layer14_expert16_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate17_gpu2;
layer14_gate17_gpu2 -> layer14_expert17_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert17_fc1_gpu2;
layer14_expert17_fc1_gpu2 -> layer14_expert17_fc2_gpu2;
layer14_expert17_fc2_gpu2 -> layer14_expert17_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate18_gpu2;
layer14_gate18_gpu2 -> layer14_expert18_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert18_fc1_gpu2;
layer14_expert18_fc1_gpu2 -> layer14_expert18_fc2_gpu2;
layer14_expert18_fc2_gpu2 -> layer14_expert18_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate19_gpu2;
layer14_gate19_gpu2 -> layer14_expert19_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert19_fc1_gpu2;
layer14_expert19_fc1_gpu2 -> layer14_expert19_fc2_gpu2;
layer14_expert19_fc2_gpu2 -> layer14_expert19_add_gpu2;
layer14_ln1_gpu2 -> layer14_gate20_gpu2;
layer14_gate20_gpu2 -> layer14_expert20_fc1_gpu2 [style=dashed];
layer14_ln1_gpu2 -> layer14_expert20_fc1_gpu2;
layer14_expert20_fc1_gpu2 -> layer14_expert20_fc2_gpu2;
layer14_expert20_fc2_gpu2 -> layer14_expert20_add_gpu2;
layer14_expert20_add_gpu2 -> layer15_att_in_gpu2;
input -> layer15_att_in_gpu0;
layer15_att_in_gpu0 -> layer15_qkv0_gpu0;
layer15_att_in_gpu0 -> layer15_qkv1_gpu0;
layer15_qkv0_gpu0 -> layer15_attout0_gpu0;
layer15_qkv1_gpu0 -> layer15_attout1_gpu0;
layer15_attout0_gpu0 -> layer15_att_agg_gpu0;
layer15_attout1_gpu0 -> layer15_att_agg_gpu0;
layer15_att_agg_gpu0 -> layer15_res1_gpu0;
layer15_res1_gpu0 -> layer15_ln1_gpu0;
input -> layer15_att_in_gpu1;
layer15_att_in_gpu1 -> layer15_qkv0_gpu1;
layer15_att_in_gpu1 -> layer15_qkv1_gpu1;
layer15_qkv0_gpu1 -> layer15_attout0_gpu1;
layer15_qkv1_gpu1 -> layer15_attout1_gpu1;
layer15_attout0_gpu1 -> layer15_att_agg_gpu1;
layer15_attout1_gpu1 -> layer15_att_agg_gpu1;
layer15_att_agg_gpu1 -> layer15_res1_gpu1;
layer15_res1_gpu1 -> layer15_ln1_gpu1;
input -> layer15_att_in_gpu2;
layer15_att_in_gpu2 -> layer15_qkv0_gpu2;
layer15_att_in_gpu2 -> layer15_qkv1_gpu2;
layer15_qkv0_gpu2 -> layer15_attout0_gpu2;
layer15_qkv1_gpu2 -> layer15_attout1_gpu2;
layer15_attout0_gpu2 -> layer15_att_agg_gpu2;
layer15_attout1_gpu2 -> layer15_att_agg_gpu2;
layer15_att_agg_gpu2 -> layer15_res1_gpu2;
layer15_res1_gpu2 -> layer15_ln1_gpu2;
layer15_ln1_gpu0 -> layer15_gate0_gpu0;
layer15_gate0_gpu0 -> layer15_expert0_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert0_fc1_gpu0;
layer15_expert0_fc1_gpu0 -> layer15_expert0_fc2_gpu0;
layer15_expert0_fc2_gpu0 -> layer15_expert0_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate1_gpu0;
layer15_gate1_gpu0 -> layer15_expert1_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert1_fc1_gpu0;
layer15_expert1_fc1_gpu0 -> layer15_expert1_fc2_gpu0;
layer15_expert1_fc2_gpu0 -> layer15_expert1_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate2_gpu0;
layer15_gate2_gpu0 -> layer15_expert2_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert2_fc1_gpu0;
layer15_expert2_fc1_gpu0 -> layer15_expert2_fc2_gpu0;
layer15_expert2_fc2_gpu0 -> layer15_expert2_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate3_gpu0;
layer15_gate3_gpu0 -> layer15_expert3_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert3_fc1_gpu0;
layer15_expert3_fc1_gpu0 -> layer15_expert3_fc2_gpu0;
layer15_expert3_fc2_gpu0 -> layer15_expert3_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate4_gpu0;
layer15_gate4_gpu0 -> layer15_expert4_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert4_fc1_gpu0;
layer15_expert4_fc1_gpu0 -> layer15_expert4_fc2_gpu0;
layer15_expert4_fc2_gpu0 -> layer15_expert4_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate5_gpu0;
layer15_gate5_gpu0 -> layer15_expert5_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert5_fc1_gpu0;
layer15_expert5_fc1_gpu0 -> layer15_expert5_fc2_gpu0;
layer15_expert5_fc2_gpu0 -> layer15_expert5_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate6_gpu0;
layer15_gate6_gpu0 -> layer15_expert6_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert6_fc1_gpu0;
layer15_expert6_fc1_gpu0 -> layer15_expert6_fc2_gpu0;
layer15_expert6_fc2_gpu0 -> layer15_expert6_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate7_gpu0;
layer15_gate7_gpu0 -> layer15_expert7_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert7_fc1_gpu0;
layer15_expert7_fc1_gpu0 -> layer15_expert7_fc2_gpu0;
layer15_expert7_fc2_gpu0 -> layer15_expert7_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate8_gpu0;
layer15_gate8_gpu0 -> layer15_expert8_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert8_fc1_gpu0;
layer15_expert8_fc1_gpu0 -> layer15_expert8_fc2_gpu0;
layer15_expert8_fc2_gpu0 -> layer15_expert8_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate9_gpu0;
layer15_gate9_gpu0 -> layer15_expert9_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert9_fc1_gpu0;
layer15_expert9_fc1_gpu0 -> layer15_expert9_fc2_gpu0;
layer15_expert9_fc2_gpu0 -> layer15_expert9_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate10_gpu0;
layer15_gate10_gpu0 -> layer15_expert10_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert10_fc1_gpu0;
layer15_expert10_fc1_gpu0 -> layer15_expert10_fc2_gpu0;
layer15_expert10_fc2_gpu0 -> layer15_expert10_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate11_gpu0;
layer15_gate11_gpu0 -> layer15_expert11_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert11_fc1_gpu0;
layer15_expert11_fc1_gpu0 -> layer15_expert11_fc2_gpu0;
layer15_expert11_fc2_gpu0 -> layer15_expert11_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate12_gpu0;
layer15_gate12_gpu0 -> layer15_expert12_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert12_fc1_gpu0;
layer15_expert12_fc1_gpu0 -> layer15_expert12_fc2_gpu0;
layer15_expert12_fc2_gpu0 -> layer15_expert12_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate13_gpu0;
layer15_gate13_gpu0 -> layer15_expert13_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert13_fc1_gpu0;
layer15_expert13_fc1_gpu0 -> layer15_expert13_fc2_gpu0;
layer15_expert13_fc2_gpu0 -> layer15_expert13_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate14_gpu0;
layer15_gate14_gpu0 -> layer15_expert14_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert14_fc1_gpu0;
layer15_expert14_fc1_gpu0 -> layer15_expert14_fc2_gpu0;
layer15_expert14_fc2_gpu0 -> layer15_expert14_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate15_gpu0;
layer15_gate15_gpu0 -> layer15_expert15_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert15_fc1_gpu0;
layer15_expert15_fc1_gpu0 -> layer15_expert15_fc2_gpu0;
layer15_expert15_fc2_gpu0 -> layer15_expert15_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate16_gpu0;
layer15_gate16_gpu0 -> layer15_expert16_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert16_fc1_gpu0;
layer15_expert16_fc1_gpu0 -> layer15_expert16_fc2_gpu0;
layer15_expert16_fc2_gpu0 -> layer15_expert16_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate17_gpu0;
layer15_gate17_gpu0 -> layer15_expert17_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert17_fc1_gpu0;
layer15_expert17_fc1_gpu0 -> layer15_expert17_fc2_gpu0;
layer15_expert17_fc2_gpu0 -> layer15_expert17_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate18_gpu0;
layer15_gate18_gpu0 -> layer15_expert18_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert18_fc1_gpu0;
layer15_expert18_fc1_gpu0 -> layer15_expert18_fc2_gpu0;
layer15_expert18_fc2_gpu0 -> layer15_expert18_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate19_gpu0;
layer15_gate19_gpu0 -> layer15_expert19_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert19_fc1_gpu0;
layer15_expert19_fc1_gpu0 -> layer15_expert19_fc2_gpu0;
layer15_expert19_fc2_gpu0 -> layer15_expert19_add_gpu0;
layer15_ln1_gpu0 -> layer15_gate20_gpu0;
layer15_gate20_gpu0 -> layer15_expert20_fc1_gpu0 [style=dashed];
layer15_ln1_gpu0 -> layer15_expert20_fc1_gpu0;
layer15_expert20_fc1_gpu0 -> layer15_expert20_fc2_gpu0;
layer15_expert20_fc2_gpu0 -> layer15_expert20_add_gpu0;
layer15_expert20_add_gpu0 -> layer16_att_in_gpu0;
layer15_ln1_gpu1 -> layer15_gate0_gpu1;
layer15_gate0_gpu1 -> layer15_expert0_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert0_fc1_gpu1;
layer15_expert0_fc1_gpu1 -> layer15_expert0_fc2_gpu1;
layer15_expert0_fc2_gpu1 -> layer15_expert0_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate1_gpu1;
layer15_gate1_gpu1 -> layer15_expert1_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert1_fc1_gpu1;
layer15_expert1_fc1_gpu1 -> layer15_expert1_fc2_gpu1;
layer15_expert1_fc2_gpu1 -> layer15_expert1_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate2_gpu1;
layer15_gate2_gpu1 -> layer15_expert2_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert2_fc1_gpu1;
layer15_expert2_fc1_gpu1 -> layer15_expert2_fc2_gpu1;
layer15_expert2_fc2_gpu1 -> layer15_expert2_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate3_gpu1;
layer15_gate3_gpu1 -> layer15_expert3_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert3_fc1_gpu1;
layer15_expert3_fc1_gpu1 -> layer15_expert3_fc2_gpu1;
layer15_expert3_fc2_gpu1 -> layer15_expert3_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate4_gpu1;
layer15_gate4_gpu1 -> layer15_expert4_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert4_fc1_gpu1;
layer15_expert4_fc1_gpu1 -> layer15_expert4_fc2_gpu1;
layer15_expert4_fc2_gpu1 -> layer15_expert4_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate5_gpu1;
layer15_gate5_gpu1 -> layer15_expert5_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert5_fc1_gpu1;
layer15_expert5_fc1_gpu1 -> layer15_expert5_fc2_gpu1;
layer15_expert5_fc2_gpu1 -> layer15_expert5_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate6_gpu1;
layer15_gate6_gpu1 -> layer15_expert6_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert6_fc1_gpu1;
layer15_expert6_fc1_gpu1 -> layer15_expert6_fc2_gpu1;
layer15_expert6_fc2_gpu1 -> layer15_expert6_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate7_gpu1;
layer15_gate7_gpu1 -> layer15_expert7_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert7_fc1_gpu1;
layer15_expert7_fc1_gpu1 -> layer15_expert7_fc2_gpu1;
layer15_expert7_fc2_gpu1 -> layer15_expert7_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate8_gpu1;
layer15_gate8_gpu1 -> layer15_expert8_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert8_fc1_gpu1;
layer15_expert8_fc1_gpu1 -> layer15_expert8_fc2_gpu1;
layer15_expert8_fc2_gpu1 -> layer15_expert8_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate9_gpu1;
layer15_gate9_gpu1 -> layer15_expert9_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert9_fc1_gpu1;
layer15_expert9_fc1_gpu1 -> layer15_expert9_fc2_gpu1;
layer15_expert9_fc2_gpu1 -> layer15_expert9_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate10_gpu1;
layer15_gate10_gpu1 -> layer15_expert10_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert10_fc1_gpu1;
layer15_expert10_fc1_gpu1 -> layer15_expert10_fc2_gpu1;
layer15_expert10_fc2_gpu1 -> layer15_expert10_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate11_gpu1;
layer15_gate11_gpu1 -> layer15_expert11_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert11_fc1_gpu1;
layer15_expert11_fc1_gpu1 -> layer15_expert11_fc2_gpu1;
layer15_expert11_fc2_gpu1 -> layer15_expert11_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate12_gpu1;
layer15_gate12_gpu1 -> layer15_expert12_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert12_fc1_gpu1;
layer15_expert12_fc1_gpu1 -> layer15_expert12_fc2_gpu1;
layer15_expert12_fc2_gpu1 -> layer15_expert12_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate13_gpu1;
layer15_gate13_gpu1 -> layer15_expert13_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert13_fc1_gpu1;
layer15_expert13_fc1_gpu1 -> layer15_expert13_fc2_gpu1;
layer15_expert13_fc2_gpu1 -> layer15_expert13_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate14_gpu1;
layer15_gate14_gpu1 -> layer15_expert14_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert14_fc1_gpu1;
layer15_expert14_fc1_gpu1 -> layer15_expert14_fc2_gpu1;
layer15_expert14_fc2_gpu1 -> layer15_expert14_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate15_gpu1;
layer15_gate15_gpu1 -> layer15_expert15_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert15_fc1_gpu1;
layer15_expert15_fc1_gpu1 -> layer15_expert15_fc2_gpu1;
layer15_expert15_fc2_gpu1 -> layer15_expert15_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate16_gpu1;
layer15_gate16_gpu1 -> layer15_expert16_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert16_fc1_gpu1;
layer15_expert16_fc1_gpu1 -> layer15_expert16_fc2_gpu1;
layer15_expert16_fc2_gpu1 -> layer15_expert16_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate17_gpu1;
layer15_gate17_gpu1 -> layer15_expert17_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert17_fc1_gpu1;
layer15_expert17_fc1_gpu1 -> layer15_expert17_fc2_gpu1;
layer15_expert17_fc2_gpu1 -> layer15_expert17_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate18_gpu1;
layer15_gate18_gpu1 -> layer15_expert18_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert18_fc1_gpu1;
layer15_expert18_fc1_gpu1 -> layer15_expert18_fc2_gpu1;
layer15_expert18_fc2_gpu1 -> layer15_expert18_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate19_gpu1;
layer15_gate19_gpu1 -> layer15_expert19_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert19_fc1_gpu1;
layer15_expert19_fc1_gpu1 -> layer15_expert19_fc2_gpu1;
layer15_expert19_fc2_gpu1 -> layer15_expert19_add_gpu1;
layer15_ln1_gpu1 -> layer15_gate20_gpu1;
layer15_gate20_gpu1 -> layer15_expert20_fc1_gpu1 [style=dashed];
layer15_ln1_gpu1 -> layer15_expert20_fc1_gpu1;
layer15_expert20_fc1_gpu1 -> layer15_expert20_fc2_gpu1;
layer15_expert20_fc2_gpu1 -> layer15_expert20_add_gpu1;
layer15_expert20_add_gpu1 -> layer16_att_in_gpu1;
layer15_ln1_gpu2 -> layer15_gate0_gpu2;
layer15_gate0_gpu2 -> layer15_expert0_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert0_fc1_gpu2;
layer15_expert0_fc1_gpu2 -> layer15_expert0_fc2_gpu2;
layer15_expert0_fc2_gpu2 -> layer15_expert0_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate1_gpu2;
layer15_gate1_gpu2 -> layer15_expert1_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert1_fc1_gpu2;
layer15_expert1_fc1_gpu2 -> layer15_expert1_fc2_gpu2;
layer15_expert1_fc2_gpu2 -> layer15_expert1_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate2_gpu2;
layer15_gate2_gpu2 -> layer15_expert2_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert2_fc1_gpu2;
layer15_expert2_fc1_gpu2 -> layer15_expert2_fc2_gpu2;
layer15_expert2_fc2_gpu2 -> layer15_expert2_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate3_gpu2;
layer15_gate3_gpu2 -> layer15_expert3_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert3_fc1_gpu2;
layer15_expert3_fc1_gpu2 -> layer15_expert3_fc2_gpu2;
layer15_expert3_fc2_gpu2 -> layer15_expert3_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate4_gpu2;
layer15_gate4_gpu2 -> layer15_expert4_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert4_fc1_gpu2;
layer15_expert4_fc1_gpu2 -> layer15_expert4_fc2_gpu2;
layer15_expert4_fc2_gpu2 -> layer15_expert4_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate5_gpu2;
layer15_gate5_gpu2 -> layer15_expert5_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert5_fc1_gpu2;
layer15_expert5_fc1_gpu2 -> layer15_expert5_fc2_gpu2;
layer15_expert5_fc2_gpu2 -> layer15_expert5_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate6_gpu2;
layer15_gate6_gpu2 -> layer15_expert6_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert6_fc1_gpu2;
layer15_expert6_fc1_gpu2 -> layer15_expert6_fc2_gpu2;
layer15_expert6_fc2_gpu2 -> layer15_expert6_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate7_gpu2;
layer15_gate7_gpu2 -> layer15_expert7_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert7_fc1_gpu2;
layer15_expert7_fc1_gpu2 -> layer15_expert7_fc2_gpu2;
layer15_expert7_fc2_gpu2 -> layer15_expert7_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate8_gpu2;
layer15_gate8_gpu2 -> layer15_expert8_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert8_fc1_gpu2;
layer15_expert8_fc1_gpu2 -> layer15_expert8_fc2_gpu2;
layer15_expert8_fc2_gpu2 -> layer15_expert8_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate9_gpu2;
layer15_gate9_gpu2 -> layer15_expert9_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert9_fc1_gpu2;
layer15_expert9_fc1_gpu2 -> layer15_expert9_fc2_gpu2;
layer15_expert9_fc2_gpu2 -> layer15_expert9_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate10_gpu2;
layer15_gate10_gpu2 -> layer15_expert10_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert10_fc1_gpu2;
layer15_expert10_fc1_gpu2 -> layer15_expert10_fc2_gpu2;
layer15_expert10_fc2_gpu2 -> layer15_expert10_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate11_gpu2;
layer15_gate11_gpu2 -> layer15_expert11_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert11_fc1_gpu2;
layer15_expert11_fc1_gpu2 -> layer15_expert11_fc2_gpu2;
layer15_expert11_fc2_gpu2 -> layer15_expert11_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate12_gpu2;
layer15_gate12_gpu2 -> layer15_expert12_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert12_fc1_gpu2;
layer15_expert12_fc1_gpu2 -> layer15_expert12_fc2_gpu2;
layer15_expert12_fc2_gpu2 -> layer15_expert12_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate13_gpu2;
layer15_gate13_gpu2 -> layer15_expert13_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert13_fc1_gpu2;
layer15_expert13_fc1_gpu2 -> layer15_expert13_fc2_gpu2;
layer15_expert13_fc2_gpu2 -> layer15_expert13_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate14_gpu2;
layer15_gate14_gpu2 -> layer15_expert14_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert14_fc1_gpu2;
layer15_expert14_fc1_gpu2 -> layer15_expert14_fc2_gpu2;
layer15_expert14_fc2_gpu2 -> layer15_expert14_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate15_gpu2;
layer15_gate15_gpu2 -> layer15_expert15_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert15_fc1_gpu2;
layer15_expert15_fc1_gpu2 -> layer15_expert15_fc2_gpu2;
layer15_expert15_fc2_gpu2 -> layer15_expert15_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate16_gpu2;
layer15_gate16_gpu2 -> layer15_expert16_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert16_fc1_gpu2;
layer15_expert16_fc1_gpu2 -> layer15_expert16_fc2_gpu2;
layer15_expert16_fc2_gpu2 -> layer15_expert16_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate17_gpu2;
layer15_gate17_gpu2 -> layer15_expert17_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert17_fc1_gpu2;
layer15_expert17_fc1_gpu2 -> layer15_expert17_fc2_gpu2;
layer15_expert17_fc2_gpu2 -> layer15_expert17_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate18_gpu2;
layer15_gate18_gpu2 -> layer15_expert18_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert18_fc1_gpu2;
layer15_expert18_fc1_gpu2 -> layer15_expert18_fc2_gpu2;
layer15_expert18_fc2_gpu2 -> layer15_expert18_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate19_gpu2;
layer15_gate19_gpu2 -> layer15_expert19_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert19_fc1_gpu2;
layer15_expert19_fc1_gpu2 -> layer15_expert19_fc2_gpu2;
layer15_expert19_fc2_gpu2 -> layer15_expert19_add_gpu2;
layer15_ln1_gpu2 -> layer15_gate20_gpu2;
layer15_gate20_gpu2 -> layer15_expert20_fc1_gpu2 [style=dashed];
layer15_ln1_gpu2 -> layer15_expert20_fc1_gpu2;
layer15_expert20_fc1_gpu2 -> layer15_expert20_fc2_gpu2;
layer15_expert20_fc2_gpu2 -> layer15_expert20_add_gpu2;
layer15_expert20_add_gpu2 -> layer16_att_in_gpu2;
input -> layer16_att_in_gpu0;
layer16_att_in_gpu0 -> layer16_qkv0_gpu0;
layer16_att_in_gpu0 -> layer16_qkv1_gpu0;
layer16_qkv0_gpu0 -> layer16_attout0_gpu0;
layer16_qkv1_gpu0 -> layer16_attout1_gpu0;
layer16_attout0_gpu0 -> layer16_att_agg_gpu0;
layer16_attout1_gpu0 -> layer16_att_agg_gpu0;
layer16_att_agg_gpu0 -> layer16_res1_gpu0;
layer16_res1_gpu0 -> layer16_ln1_gpu0;
input -> layer16_att_in_gpu1;
layer16_att_in_gpu1 -> layer16_qkv0_gpu1;
layer16_att_in_gpu1 -> layer16_qkv1_gpu1;
layer16_qkv0_gpu1 -> layer16_attout0_gpu1;
layer16_qkv1_gpu1 -> layer16_attout1_gpu1;
layer16_attout0_gpu1 -> layer16_att_agg_gpu1;
layer16_attout1_gpu1 -> layer16_att_agg_gpu1;
layer16_att_agg_gpu1 -> layer16_res1_gpu1;
layer16_res1_gpu1 -> layer16_ln1_gpu1;
input -> layer16_att_in_gpu2;
layer16_att_in_gpu2 -> layer16_qkv0_gpu2;
layer16_att_in_gpu2 -> layer16_qkv1_gpu2;
layer16_qkv0_gpu2 -> layer16_attout0_gpu2;
layer16_qkv1_gpu2 -> layer16_attout1_gpu2;
layer16_attout0_gpu2 -> layer16_att_agg_gpu2;
layer16_attout1_gpu2 -> layer16_att_agg_gpu2;
layer16_att_agg_gpu2 -> layer16_res1_gpu2;
layer16_res1_gpu2 -> layer16_ln1_gpu2;
layer16_ln1_gpu0 -> layer16_gate0_gpu0;
layer16_gate0_gpu0 -> layer16_expert0_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert0_fc1_gpu0;
layer16_expert0_fc1_gpu0 -> layer16_expert0_fc2_gpu0;
layer16_expert0_fc2_gpu0 -> layer16_expert0_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate1_gpu0;
layer16_gate1_gpu0 -> layer16_expert1_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert1_fc1_gpu0;
layer16_expert1_fc1_gpu0 -> layer16_expert1_fc2_gpu0;
layer16_expert1_fc2_gpu0 -> layer16_expert1_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate2_gpu0;
layer16_gate2_gpu0 -> layer16_expert2_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert2_fc1_gpu0;
layer16_expert2_fc1_gpu0 -> layer16_expert2_fc2_gpu0;
layer16_expert2_fc2_gpu0 -> layer16_expert2_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate3_gpu0;
layer16_gate3_gpu0 -> layer16_expert3_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert3_fc1_gpu0;
layer16_expert3_fc1_gpu0 -> layer16_expert3_fc2_gpu0;
layer16_expert3_fc2_gpu0 -> layer16_expert3_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate4_gpu0;
layer16_gate4_gpu0 -> layer16_expert4_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert4_fc1_gpu0;
layer16_expert4_fc1_gpu0 -> layer16_expert4_fc2_gpu0;
layer16_expert4_fc2_gpu0 -> layer16_expert4_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate5_gpu0;
layer16_gate5_gpu0 -> layer16_expert5_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert5_fc1_gpu0;
layer16_expert5_fc1_gpu0 -> layer16_expert5_fc2_gpu0;
layer16_expert5_fc2_gpu0 -> layer16_expert5_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate6_gpu0;
layer16_gate6_gpu0 -> layer16_expert6_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert6_fc1_gpu0;
layer16_expert6_fc1_gpu0 -> layer16_expert6_fc2_gpu0;
layer16_expert6_fc2_gpu0 -> layer16_expert6_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate7_gpu0;
layer16_gate7_gpu0 -> layer16_expert7_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert7_fc1_gpu0;
layer16_expert7_fc1_gpu0 -> layer16_expert7_fc2_gpu0;
layer16_expert7_fc2_gpu0 -> layer16_expert7_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate8_gpu0;
layer16_gate8_gpu0 -> layer16_expert8_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert8_fc1_gpu0;
layer16_expert8_fc1_gpu0 -> layer16_expert8_fc2_gpu0;
layer16_expert8_fc2_gpu0 -> layer16_expert8_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate9_gpu0;
layer16_gate9_gpu0 -> layer16_expert9_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert9_fc1_gpu0;
layer16_expert9_fc1_gpu0 -> layer16_expert9_fc2_gpu0;
layer16_expert9_fc2_gpu0 -> layer16_expert9_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate10_gpu0;
layer16_gate10_gpu0 -> layer16_expert10_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert10_fc1_gpu0;
layer16_expert10_fc1_gpu0 -> layer16_expert10_fc2_gpu0;
layer16_expert10_fc2_gpu0 -> layer16_expert10_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate11_gpu0;
layer16_gate11_gpu0 -> layer16_expert11_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert11_fc1_gpu0;
layer16_expert11_fc1_gpu0 -> layer16_expert11_fc2_gpu0;
layer16_expert11_fc2_gpu0 -> layer16_expert11_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate12_gpu0;
layer16_gate12_gpu0 -> layer16_expert12_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert12_fc1_gpu0;
layer16_expert12_fc1_gpu0 -> layer16_expert12_fc2_gpu0;
layer16_expert12_fc2_gpu0 -> layer16_expert12_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate13_gpu0;
layer16_gate13_gpu0 -> layer16_expert13_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert13_fc1_gpu0;
layer16_expert13_fc1_gpu0 -> layer16_expert13_fc2_gpu0;
layer16_expert13_fc2_gpu0 -> layer16_expert13_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate14_gpu0;
layer16_gate14_gpu0 -> layer16_expert14_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert14_fc1_gpu0;
layer16_expert14_fc1_gpu0 -> layer16_expert14_fc2_gpu0;
layer16_expert14_fc2_gpu0 -> layer16_expert14_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate15_gpu0;
layer16_gate15_gpu0 -> layer16_expert15_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert15_fc1_gpu0;
layer16_expert15_fc1_gpu0 -> layer16_expert15_fc2_gpu0;
layer16_expert15_fc2_gpu0 -> layer16_expert15_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate16_gpu0;
layer16_gate16_gpu0 -> layer16_expert16_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert16_fc1_gpu0;
layer16_expert16_fc1_gpu0 -> layer16_expert16_fc2_gpu0;
layer16_expert16_fc2_gpu0 -> layer16_expert16_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate17_gpu0;
layer16_gate17_gpu0 -> layer16_expert17_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert17_fc1_gpu0;
layer16_expert17_fc1_gpu0 -> layer16_expert17_fc2_gpu0;
layer16_expert17_fc2_gpu0 -> layer16_expert17_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate18_gpu0;
layer16_gate18_gpu0 -> layer16_expert18_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert18_fc1_gpu0;
layer16_expert18_fc1_gpu0 -> layer16_expert18_fc2_gpu0;
layer16_expert18_fc2_gpu0 -> layer16_expert18_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate19_gpu0;
layer16_gate19_gpu0 -> layer16_expert19_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert19_fc1_gpu0;
layer16_expert19_fc1_gpu0 -> layer16_expert19_fc2_gpu0;
layer16_expert19_fc2_gpu0 -> layer16_expert19_add_gpu0;
layer16_ln1_gpu0 -> layer16_gate20_gpu0;
layer16_gate20_gpu0 -> layer16_expert20_fc1_gpu0 [style=dashed];
layer16_ln1_gpu0 -> layer16_expert20_fc1_gpu0;
layer16_expert20_fc1_gpu0 -> layer16_expert20_fc2_gpu0;
layer16_expert20_fc2_gpu0 -> layer16_expert20_add_gpu0;
layer16_expert20_add_gpu0 -> layer17_att_in_gpu0;
layer16_ln1_gpu1 -> layer16_gate0_gpu1;
layer16_gate0_gpu1 -> layer16_expert0_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert0_fc1_gpu1;
layer16_expert0_fc1_gpu1 -> layer16_expert0_fc2_gpu1;
layer16_expert0_fc2_gpu1 -> layer16_expert0_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate1_gpu1;
layer16_gate1_gpu1 -> layer16_expert1_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert1_fc1_gpu1;
layer16_expert1_fc1_gpu1 -> layer16_expert1_fc2_gpu1;
layer16_expert1_fc2_gpu1 -> layer16_expert1_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate2_gpu1;
layer16_gate2_gpu1 -> layer16_expert2_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert2_fc1_gpu1;
layer16_expert2_fc1_gpu1 -> layer16_expert2_fc2_gpu1;
layer16_expert2_fc2_gpu1 -> layer16_expert2_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate3_gpu1;
layer16_gate3_gpu1 -> layer16_expert3_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert3_fc1_gpu1;
layer16_expert3_fc1_gpu1 -> layer16_expert3_fc2_gpu1;
layer16_expert3_fc2_gpu1 -> layer16_expert3_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate4_gpu1;
layer16_gate4_gpu1 -> layer16_expert4_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert4_fc1_gpu1;
layer16_expert4_fc1_gpu1 -> layer16_expert4_fc2_gpu1;
layer16_expert4_fc2_gpu1 -> layer16_expert4_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate5_gpu1;
layer16_gate5_gpu1 -> layer16_expert5_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert5_fc1_gpu1;
layer16_expert5_fc1_gpu1 -> layer16_expert5_fc2_gpu1;
layer16_expert5_fc2_gpu1 -> layer16_expert5_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate6_gpu1;
layer16_gate6_gpu1 -> layer16_expert6_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert6_fc1_gpu1;
layer16_expert6_fc1_gpu1 -> layer16_expert6_fc2_gpu1;
layer16_expert6_fc2_gpu1 -> layer16_expert6_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate7_gpu1;
layer16_gate7_gpu1 -> layer16_expert7_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert7_fc1_gpu1;
layer16_expert7_fc1_gpu1 -> layer16_expert7_fc2_gpu1;
layer16_expert7_fc2_gpu1 -> layer16_expert7_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate8_gpu1;
layer16_gate8_gpu1 -> layer16_expert8_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert8_fc1_gpu1;
layer16_expert8_fc1_gpu1 -> layer16_expert8_fc2_gpu1;
layer16_expert8_fc2_gpu1 -> layer16_expert8_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate9_gpu1;
layer16_gate9_gpu1 -> layer16_expert9_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert9_fc1_gpu1;
layer16_expert9_fc1_gpu1 -> layer16_expert9_fc2_gpu1;
layer16_expert9_fc2_gpu1 -> layer16_expert9_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate10_gpu1;
layer16_gate10_gpu1 -> layer16_expert10_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert10_fc1_gpu1;
layer16_expert10_fc1_gpu1 -> layer16_expert10_fc2_gpu1;
layer16_expert10_fc2_gpu1 -> layer16_expert10_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate11_gpu1;
layer16_gate11_gpu1 -> layer16_expert11_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert11_fc1_gpu1;
layer16_expert11_fc1_gpu1 -> layer16_expert11_fc2_gpu1;
layer16_expert11_fc2_gpu1 -> layer16_expert11_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate12_gpu1;
layer16_gate12_gpu1 -> layer16_expert12_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert12_fc1_gpu1;
layer16_expert12_fc1_gpu1 -> layer16_expert12_fc2_gpu1;
layer16_expert12_fc2_gpu1 -> layer16_expert12_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate13_gpu1;
layer16_gate13_gpu1 -> layer16_expert13_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert13_fc1_gpu1;
layer16_expert13_fc1_gpu1 -> layer16_expert13_fc2_gpu1;
layer16_expert13_fc2_gpu1 -> layer16_expert13_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate14_gpu1;
layer16_gate14_gpu1 -> layer16_expert14_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert14_fc1_gpu1;
layer16_expert14_fc1_gpu1 -> layer16_expert14_fc2_gpu1;
layer16_expert14_fc2_gpu1 -> layer16_expert14_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate15_gpu1;
layer16_gate15_gpu1 -> layer16_expert15_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert15_fc1_gpu1;
layer16_expert15_fc1_gpu1 -> layer16_expert15_fc2_gpu1;
layer16_expert15_fc2_gpu1 -> layer16_expert15_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate16_gpu1;
layer16_gate16_gpu1 -> layer16_expert16_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert16_fc1_gpu1;
layer16_expert16_fc1_gpu1 -> layer16_expert16_fc2_gpu1;
layer16_expert16_fc2_gpu1 -> layer16_expert16_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate17_gpu1;
layer16_gate17_gpu1 -> layer16_expert17_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert17_fc1_gpu1;
layer16_expert17_fc1_gpu1 -> layer16_expert17_fc2_gpu1;
layer16_expert17_fc2_gpu1 -> layer16_expert17_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate18_gpu1;
layer16_gate18_gpu1 -> layer16_expert18_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert18_fc1_gpu1;
layer16_expert18_fc1_gpu1 -> layer16_expert18_fc2_gpu1;
layer16_expert18_fc2_gpu1 -> layer16_expert18_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate19_gpu1;
layer16_gate19_gpu1 -> layer16_expert19_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert19_fc1_gpu1;
layer16_expert19_fc1_gpu1 -> layer16_expert19_fc2_gpu1;
layer16_expert19_fc2_gpu1 -> layer16_expert19_add_gpu1;
layer16_ln1_gpu1 -> layer16_gate20_gpu1;
layer16_gate20_gpu1 -> layer16_expert20_fc1_gpu1 [style=dashed];
layer16_ln1_gpu1 -> layer16_expert20_fc1_gpu1;
layer16_expert20_fc1_gpu1 -> layer16_expert20_fc2_gpu1;
layer16_expert20_fc2_gpu1 -> layer16_expert20_add_gpu1;
layer16_expert20_add_gpu1 -> layer17_att_in_gpu1;
layer16_ln1_gpu2 -> layer16_gate0_gpu2;
layer16_gate0_gpu2 -> layer16_expert0_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert0_fc1_gpu2;
layer16_expert0_fc1_gpu2 -> layer16_expert0_fc2_gpu2;
layer16_expert0_fc2_gpu2 -> layer16_expert0_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate1_gpu2;
layer16_gate1_gpu2 -> layer16_expert1_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert1_fc1_gpu2;
layer16_expert1_fc1_gpu2 -> layer16_expert1_fc2_gpu2;
layer16_expert1_fc2_gpu2 -> layer16_expert1_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate2_gpu2;
layer16_gate2_gpu2 -> layer16_expert2_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert2_fc1_gpu2;
layer16_expert2_fc1_gpu2 -> layer16_expert2_fc2_gpu2;
layer16_expert2_fc2_gpu2 -> layer16_expert2_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate3_gpu2;
layer16_gate3_gpu2 -> layer16_expert3_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert3_fc1_gpu2;
layer16_expert3_fc1_gpu2 -> layer16_expert3_fc2_gpu2;
layer16_expert3_fc2_gpu2 -> layer16_expert3_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate4_gpu2;
layer16_gate4_gpu2 -> layer16_expert4_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert4_fc1_gpu2;
layer16_expert4_fc1_gpu2 -> layer16_expert4_fc2_gpu2;
layer16_expert4_fc2_gpu2 -> layer16_expert4_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate5_gpu2;
layer16_gate5_gpu2 -> layer16_expert5_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert5_fc1_gpu2;
layer16_expert5_fc1_gpu2 -> layer16_expert5_fc2_gpu2;
layer16_expert5_fc2_gpu2 -> layer16_expert5_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate6_gpu2;
layer16_gate6_gpu2 -> layer16_expert6_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert6_fc1_gpu2;
layer16_expert6_fc1_gpu2 -> layer16_expert6_fc2_gpu2;
layer16_expert6_fc2_gpu2 -> layer16_expert6_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate7_gpu2;
layer16_gate7_gpu2 -> layer16_expert7_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert7_fc1_gpu2;
layer16_expert7_fc1_gpu2 -> layer16_expert7_fc2_gpu2;
layer16_expert7_fc2_gpu2 -> layer16_expert7_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate8_gpu2;
layer16_gate8_gpu2 -> layer16_expert8_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert8_fc1_gpu2;
layer16_expert8_fc1_gpu2 -> layer16_expert8_fc2_gpu2;
layer16_expert8_fc2_gpu2 -> layer16_expert8_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate9_gpu2;
layer16_gate9_gpu2 -> layer16_expert9_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert9_fc1_gpu2;
layer16_expert9_fc1_gpu2 -> layer16_expert9_fc2_gpu2;
layer16_expert9_fc2_gpu2 -> layer16_expert9_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate10_gpu2;
layer16_gate10_gpu2 -> layer16_expert10_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert10_fc1_gpu2;
layer16_expert10_fc1_gpu2 -> layer16_expert10_fc2_gpu2;
layer16_expert10_fc2_gpu2 -> layer16_expert10_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate11_gpu2;
layer16_gate11_gpu2 -> layer16_expert11_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert11_fc1_gpu2;
layer16_expert11_fc1_gpu2 -> layer16_expert11_fc2_gpu2;
layer16_expert11_fc2_gpu2 -> layer16_expert11_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate12_gpu2;
layer16_gate12_gpu2 -> layer16_expert12_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert12_fc1_gpu2;
layer16_expert12_fc1_gpu2 -> layer16_expert12_fc2_gpu2;
layer16_expert12_fc2_gpu2 -> layer16_expert12_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate13_gpu2;
layer16_gate13_gpu2 -> layer16_expert13_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert13_fc1_gpu2;
layer16_expert13_fc1_gpu2 -> layer16_expert13_fc2_gpu2;
layer16_expert13_fc2_gpu2 -> layer16_expert13_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate14_gpu2;
layer16_gate14_gpu2 -> layer16_expert14_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert14_fc1_gpu2;
layer16_expert14_fc1_gpu2 -> layer16_expert14_fc2_gpu2;
layer16_expert14_fc2_gpu2 -> layer16_expert14_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate15_gpu2;
layer16_gate15_gpu2 -> layer16_expert15_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert15_fc1_gpu2;
layer16_expert15_fc1_gpu2 -> layer16_expert15_fc2_gpu2;
layer16_expert15_fc2_gpu2 -> layer16_expert15_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate16_gpu2;
layer16_gate16_gpu2 -> layer16_expert16_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert16_fc1_gpu2;
layer16_expert16_fc1_gpu2 -> layer16_expert16_fc2_gpu2;
layer16_expert16_fc2_gpu2 -> layer16_expert16_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate17_gpu2;
layer16_gate17_gpu2 -> layer16_expert17_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert17_fc1_gpu2;
layer16_expert17_fc1_gpu2 -> layer16_expert17_fc2_gpu2;
layer16_expert17_fc2_gpu2 -> layer16_expert17_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate18_gpu2;
layer16_gate18_gpu2 -> layer16_expert18_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert18_fc1_gpu2;
layer16_expert18_fc1_gpu2 -> layer16_expert18_fc2_gpu2;
layer16_expert18_fc2_gpu2 -> layer16_expert18_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate19_gpu2;
layer16_gate19_gpu2 -> layer16_expert19_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert19_fc1_gpu2;
layer16_expert19_fc1_gpu2 -> layer16_expert19_fc2_gpu2;
layer16_expert19_fc2_gpu2 -> layer16_expert19_add_gpu2;
layer16_ln1_gpu2 -> layer16_gate20_gpu2;
layer16_gate20_gpu2 -> layer16_expert20_fc1_gpu2 [style=dashed];
layer16_ln1_gpu2 -> layer16_expert20_fc1_gpu2;
layer16_expert20_fc1_gpu2 -> layer16_expert20_fc2_gpu2;
layer16_expert20_fc2_gpu2 -> layer16_expert20_add_gpu2;
layer16_expert20_add_gpu2 -> layer17_att_in_gpu2;
input -> layer17_att_in_gpu0;
layer17_att_in_gpu0 -> layer17_qkv0_gpu0;
layer17_att_in_gpu0 -> layer17_qkv1_gpu0;
layer17_qkv0_gpu0 -> layer17_attout0_gpu0;
layer17_qkv1_gpu0 -> layer17_attout1_gpu0;
layer17_attout0_gpu0 -> layer17_att_agg_gpu0;
layer17_attout1_gpu0 -> layer17_att_agg_gpu0;
layer17_att_agg_gpu0 -> layer17_res1_gpu0;
layer17_res1_gpu0 -> layer17_ln1_gpu0;
input -> layer17_att_in_gpu1;
layer17_att_in_gpu1 -> layer17_qkv0_gpu1;
layer17_att_in_gpu1 -> layer17_qkv1_gpu1;
layer17_qkv0_gpu1 -> layer17_attout0_gpu1;
layer17_qkv1_gpu1 -> layer17_attout1_gpu1;
layer17_attout0_gpu1 -> layer17_att_agg_gpu1;
layer17_attout1_gpu1 -> layer17_att_agg_gpu1;
layer17_att_agg_gpu1 -> layer17_res1_gpu1;
layer17_res1_gpu1 -> layer17_ln1_gpu1;
input -> layer17_att_in_gpu2;
layer17_att_in_gpu2 -> layer17_qkv0_gpu2;
layer17_att_in_gpu2 -> layer17_qkv1_gpu2;
layer17_qkv0_gpu2 -> layer17_attout0_gpu2;
layer17_qkv1_gpu2 -> layer17_attout1_gpu2;
layer17_attout0_gpu2 -> layer17_att_agg_gpu2;
layer17_attout1_gpu2 -> layer17_att_agg_gpu2;
layer17_att_agg_gpu2 -> layer17_res1_gpu2;
layer17_res1_gpu2 -> layer17_ln1_gpu2;
layer17_ln1_gpu0 -> layer17_gate0_gpu0;
layer17_gate0_gpu0 -> layer17_expert0_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert0_fc1_gpu0;
layer17_expert0_fc1_gpu0 -> layer17_expert0_fc2_gpu0;
layer17_expert0_fc2_gpu0 -> layer17_expert0_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate1_gpu0;
layer17_gate1_gpu0 -> layer17_expert1_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert1_fc1_gpu0;
layer17_expert1_fc1_gpu0 -> layer17_expert1_fc2_gpu0;
layer17_expert1_fc2_gpu0 -> layer17_expert1_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate2_gpu0;
layer17_gate2_gpu0 -> layer17_expert2_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert2_fc1_gpu0;
layer17_expert2_fc1_gpu0 -> layer17_expert2_fc2_gpu0;
layer17_expert2_fc2_gpu0 -> layer17_expert2_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate3_gpu0;
layer17_gate3_gpu0 -> layer17_expert3_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert3_fc1_gpu0;
layer17_expert3_fc1_gpu0 -> layer17_expert3_fc2_gpu0;
layer17_expert3_fc2_gpu0 -> layer17_expert3_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate4_gpu0;
layer17_gate4_gpu0 -> layer17_expert4_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert4_fc1_gpu0;
layer17_expert4_fc1_gpu0 -> layer17_expert4_fc2_gpu0;
layer17_expert4_fc2_gpu0 -> layer17_expert4_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate5_gpu0;
layer17_gate5_gpu0 -> layer17_expert5_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert5_fc1_gpu0;
layer17_expert5_fc1_gpu0 -> layer17_expert5_fc2_gpu0;
layer17_expert5_fc2_gpu0 -> layer17_expert5_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate6_gpu0;
layer17_gate6_gpu0 -> layer17_expert6_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert6_fc1_gpu0;
layer17_expert6_fc1_gpu0 -> layer17_expert6_fc2_gpu0;
layer17_expert6_fc2_gpu0 -> layer17_expert6_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate7_gpu0;
layer17_gate7_gpu0 -> layer17_expert7_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert7_fc1_gpu0;
layer17_expert7_fc1_gpu0 -> layer17_expert7_fc2_gpu0;
layer17_expert7_fc2_gpu0 -> layer17_expert7_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate8_gpu0;
layer17_gate8_gpu0 -> layer17_expert8_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert8_fc1_gpu0;
layer17_expert8_fc1_gpu0 -> layer17_expert8_fc2_gpu0;
layer17_expert8_fc2_gpu0 -> layer17_expert8_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate9_gpu0;
layer17_gate9_gpu0 -> layer17_expert9_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert9_fc1_gpu0;
layer17_expert9_fc1_gpu0 -> layer17_expert9_fc2_gpu0;
layer17_expert9_fc2_gpu0 -> layer17_expert9_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate10_gpu0;
layer17_gate10_gpu0 -> layer17_expert10_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert10_fc1_gpu0;
layer17_expert10_fc1_gpu0 -> layer17_expert10_fc2_gpu0;
layer17_expert10_fc2_gpu0 -> layer17_expert10_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate11_gpu0;
layer17_gate11_gpu0 -> layer17_expert11_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert11_fc1_gpu0;
layer17_expert11_fc1_gpu0 -> layer17_expert11_fc2_gpu0;
layer17_expert11_fc2_gpu0 -> layer17_expert11_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate12_gpu0;
layer17_gate12_gpu0 -> layer17_expert12_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert12_fc1_gpu0;
layer17_expert12_fc1_gpu0 -> layer17_expert12_fc2_gpu0;
layer17_expert12_fc2_gpu0 -> layer17_expert12_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate13_gpu0;
layer17_gate13_gpu0 -> layer17_expert13_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert13_fc1_gpu0;
layer17_expert13_fc1_gpu0 -> layer17_expert13_fc2_gpu0;
layer17_expert13_fc2_gpu0 -> layer17_expert13_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate14_gpu0;
layer17_gate14_gpu0 -> layer17_expert14_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert14_fc1_gpu0;
layer17_expert14_fc1_gpu0 -> layer17_expert14_fc2_gpu0;
layer17_expert14_fc2_gpu0 -> layer17_expert14_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate15_gpu0;
layer17_gate15_gpu0 -> layer17_expert15_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert15_fc1_gpu0;
layer17_expert15_fc1_gpu0 -> layer17_expert15_fc2_gpu0;
layer17_expert15_fc2_gpu0 -> layer17_expert15_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate16_gpu0;
layer17_gate16_gpu0 -> layer17_expert16_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert16_fc1_gpu0;
layer17_expert16_fc1_gpu0 -> layer17_expert16_fc2_gpu0;
layer17_expert16_fc2_gpu0 -> layer17_expert16_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate17_gpu0;
layer17_gate17_gpu0 -> layer17_expert17_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert17_fc1_gpu0;
layer17_expert17_fc1_gpu0 -> layer17_expert17_fc2_gpu0;
layer17_expert17_fc2_gpu0 -> layer17_expert17_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate18_gpu0;
layer17_gate18_gpu0 -> layer17_expert18_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert18_fc1_gpu0;
layer17_expert18_fc1_gpu0 -> layer17_expert18_fc2_gpu0;
layer17_expert18_fc2_gpu0 -> layer17_expert18_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate19_gpu0;
layer17_gate19_gpu0 -> layer17_expert19_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert19_fc1_gpu0;
layer17_expert19_fc1_gpu0 -> layer17_expert19_fc2_gpu0;
layer17_expert19_fc2_gpu0 -> layer17_expert19_add_gpu0;
layer17_ln1_gpu0 -> layer17_gate20_gpu0;
layer17_gate20_gpu0 -> layer17_expert20_fc1_gpu0 [style=dashed];
layer17_ln1_gpu0 -> layer17_expert20_fc1_gpu0;
layer17_expert20_fc1_gpu0 -> layer17_expert20_fc2_gpu0;
layer17_expert20_fc2_gpu0 -> layer17_expert20_add_gpu0;
layer17_expert20_add_gpu0 -> layer18_att_in_gpu0;
layer17_ln1_gpu1 -> layer17_gate0_gpu1;
layer17_gate0_gpu1 -> layer17_expert0_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert0_fc1_gpu1;
layer17_expert0_fc1_gpu1 -> layer17_expert0_fc2_gpu1;
layer17_expert0_fc2_gpu1 -> layer17_expert0_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate1_gpu1;
layer17_gate1_gpu1 -> layer17_expert1_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert1_fc1_gpu1;
layer17_expert1_fc1_gpu1 -> layer17_expert1_fc2_gpu1;
layer17_expert1_fc2_gpu1 -> layer17_expert1_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate2_gpu1;
layer17_gate2_gpu1 -> layer17_expert2_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert2_fc1_gpu1;
layer17_expert2_fc1_gpu1 -> layer17_expert2_fc2_gpu1;
layer17_expert2_fc2_gpu1 -> layer17_expert2_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate3_gpu1;
layer17_gate3_gpu1 -> layer17_expert3_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert3_fc1_gpu1;
layer17_expert3_fc1_gpu1 -> layer17_expert3_fc2_gpu1;
layer17_expert3_fc2_gpu1 -> layer17_expert3_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate4_gpu1;
layer17_gate4_gpu1 -> layer17_expert4_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert4_fc1_gpu1;
layer17_expert4_fc1_gpu1 -> layer17_expert4_fc2_gpu1;
layer17_expert4_fc2_gpu1 -> layer17_expert4_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate5_gpu1;
layer17_gate5_gpu1 -> layer17_expert5_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert5_fc1_gpu1;
layer17_expert5_fc1_gpu1 -> layer17_expert5_fc2_gpu1;
layer17_expert5_fc2_gpu1 -> layer17_expert5_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate6_gpu1;
layer17_gate6_gpu1 -> layer17_expert6_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert6_fc1_gpu1;
layer17_expert6_fc1_gpu1 -> layer17_expert6_fc2_gpu1;
layer17_expert6_fc2_gpu1 -> layer17_expert6_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate7_gpu1;
layer17_gate7_gpu1 -> layer17_expert7_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert7_fc1_gpu1;
layer17_expert7_fc1_gpu1 -> layer17_expert7_fc2_gpu1;
layer17_expert7_fc2_gpu1 -> layer17_expert7_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate8_gpu1;
layer17_gate8_gpu1 -> layer17_expert8_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert8_fc1_gpu1;
layer17_expert8_fc1_gpu1 -> layer17_expert8_fc2_gpu1;
layer17_expert8_fc2_gpu1 -> layer17_expert8_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate9_gpu1;
layer17_gate9_gpu1 -> layer17_expert9_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert9_fc1_gpu1;
layer17_expert9_fc1_gpu1 -> layer17_expert9_fc2_gpu1;
layer17_expert9_fc2_gpu1 -> layer17_expert9_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate10_gpu1;
layer17_gate10_gpu1 -> layer17_expert10_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert10_fc1_gpu1;
layer17_expert10_fc1_gpu1 -> layer17_expert10_fc2_gpu1;
layer17_expert10_fc2_gpu1 -> layer17_expert10_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate11_gpu1;
layer17_gate11_gpu1 -> layer17_expert11_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert11_fc1_gpu1;
layer17_expert11_fc1_gpu1 -> layer17_expert11_fc2_gpu1;
layer17_expert11_fc2_gpu1 -> layer17_expert11_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate12_gpu1;
layer17_gate12_gpu1 -> layer17_expert12_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert12_fc1_gpu1;
layer17_expert12_fc1_gpu1 -> layer17_expert12_fc2_gpu1;
layer17_expert12_fc2_gpu1 -> layer17_expert12_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate13_gpu1;
layer17_gate13_gpu1 -> layer17_expert13_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert13_fc1_gpu1;
layer17_expert13_fc1_gpu1 -> layer17_expert13_fc2_gpu1;
layer17_expert13_fc2_gpu1 -> layer17_expert13_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate14_gpu1;
layer17_gate14_gpu1 -> layer17_expert14_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert14_fc1_gpu1;
layer17_expert14_fc1_gpu1 -> layer17_expert14_fc2_gpu1;
layer17_expert14_fc2_gpu1 -> layer17_expert14_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate15_gpu1;
layer17_gate15_gpu1 -> layer17_expert15_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert15_fc1_gpu1;
layer17_expert15_fc1_gpu1 -> layer17_expert15_fc2_gpu1;
layer17_expert15_fc2_gpu1 -> layer17_expert15_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate16_gpu1;
layer17_gate16_gpu1 -> layer17_expert16_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert16_fc1_gpu1;
layer17_expert16_fc1_gpu1 -> layer17_expert16_fc2_gpu1;
layer17_expert16_fc2_gpu1 -> layer17_expert16_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate17_gpu1;
layer17_gate17_gpu1 -> layer17_expert17_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert17_fc1_gpu1;
layer17_expert17_fc1_gpu1 -> layer17_expert17_fc2_gpu1;
layer17_expert17_fc2_gpu1 -> layer17_expert17_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate18_gpu1;
layer17_gate18_gpu1 -> layer17_expert18_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert18_fc1_gpu1;
layer17_expert18_fc1_gpu1 -> layer17_expert18_fc2_gpu1;
layer17_expert18_fc2_gpu1 -> layer17_expert18_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate19_gpu1;
layer17_gate19_gpu1 -> layer17_expert19_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert19_fc1_gpu1;
layer17_expert19_fc1_gpu1 -> layer17_expert19_fc2_gpu1;
layer17_expert19_fc2_gpu1 -> layer17_expert19_add_gpu1;
layer17_ln1_gpu1 -> layer17_gate20_gpu1;
layer17_gate20_gpu1 -> layer17_expert20_fc1_gpu1 [style=dashed];
layer17_ln1_gpu1 -> layer17_expert20_fc1_gpu1;
layer17_expert20_fc1_gpu1 -> layer17_expert20_fc2_gpu1;
layer17_expert20_fc2_gpu1 -> layer17_expert20_add_gpu1;
layer17_expert20_add_gpu1 -> layer18_att_in_gpu1;
layer17_ln1_gpu2 -> layer17_gate0_gpu2;
layer17_gate0_gpu2 -> layer17_expert0_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert0_fc1_gpu2;
layer17_expert0_fc1_gpu2 -> layer17_expert0_fc2_gpu2;
layer17_expert0_fc2_gpu2 -> layer17_expert0_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate1_gpu2;
layer17_gate1_gpu2 -> layer17_expert1_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert1_fc1_gpu2;
layer17_expert1_fc1_gpu2 -> layer17_expert1_fc2_gpu2;
layer17_expert1_fc2_gpu2 -> layer17_expert1_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate2_gpu2;
layer17_gate2_gpu2 -> layer17_expert2_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert2_fc1_gpu2;
layer17_expert2_fc1_gpu2 -> layer17_expert2_fc2_gpu2;
layer17_expert2_fc2_gpu2 -> layer17_expert2_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate3_gpu2;
layer17_gate3_gpu2 -> layer17_expert3_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert3_fc1_gpu2;
layer17_expert3_fc1_gpu2 -> layer17_expert3_fc2_gpu2;
layer17_expert3_fc2_gpu2 -> layer17_expert3_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate4_gpu2;
layer17_gate4_gpu2 -> layer17_expert4_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert4_fc1_gpu2;
layer17_expert4_fc1_gpu2 -> layer17_expert4_fc2_gpu2;
layer17_expert4_fc2_gpu2 -> layer17_expert4_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate5_gpu2;
layer17_gate5_gpu2 -> layer17_expert5_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert5_fc1_gpu2;
layer17_expert5_fc1_gpu2 -> layer17_expert5_fc2_gpu2;
layer17_expert5_fc2_gpu2 -> layer17_expert5_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate6_gpu2;
layer17_gate6_gpu2 -> layer17_expert6_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert6_fc1_gpu2;
layer17_expert6_fc1_gpu2 -> layer17_expert6_fc2_gpu2;
layer17_expert6_fc2_gpu2 -> layer17_expert6_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate7_gpu2;
layer17_gate7_gpu2 -> layer17_expert7_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert7_fc1_gpu2;
layer17_expert7_fc1_gpu2 -> layer17_expert7_fc2_gpu2;
layer17_expert7_fc2_gpu2 -> layer17_expert7_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate8_gpu2;
layer17_gate8_gpu2 -> layer17_expert8_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert8_fc1_gpu2;
layer17_expert8_fc1_gpu2 -> layer17_expert8_fc2_gpu2;
layer17_expert8_fc2_gpu2 -> layer17_expert8_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate9_gpu2;
layer17_gate9_gpu2 -> layer17_expert9_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert9_fc1_gpu2;
layer17_expert9_fc1_gpu2 -> layer17_expert9_fc2_gpu2;
layer17_expert9_fc2_gpu2 -> layer17_expert9_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate10_gpu2;
layer17_gate10_gpu2 -> layer17_expert10_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert10_fc1_gpu2;
layer17_expert10_fc1_gpu2 -> layer17_expert10_fc2_gpu2;
layer17_expert10_fc2_gpu2 -> layer17_expert10_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate11_gpu2;
layer17_gate11_gpu2 -> layer17_expert11_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert11_fc1_gpu2;
layer17_expert11_fc1_gpu2 -> layer17_expert11_fc2_gpu2;
layer17_expert11_fc2_gpu2 -> layer17_expert11_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate12_gpu2;
layer17_gate12_gpu2 -> layer17_expert12_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert12_fc1_gpu2;
layer17_expert12_fc1_gpu2 -> layer17_expert12_fc2_gpu2;
layer17_expert12_fc2_gpu2 -> layer17_expert12_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate13_gpu2;
layer17_gate13_gpu2 -> layer17_expert13_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert13_fc1_gpu2;
layer17_expert13_fc1_gpu2 -> layer17_expert13_fc2_gpu2;
layer17_expert13_fc2_gpu2 -> layer17_expert13_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate14_gpu2;
layer17_gate14_gpu2 -> layer17_expert14_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert14_fc1_gpu2;
layer17_expert14_fc1_gpu2 -> layer17_expert14_fc2_gpu2;
layer17_expert14_fc2_gpu2 -> layer17_expert14_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate15_gpu2;
layer17_gate15_gpu2 -> layer17_expert15_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert15_fc1_gpu2;
layer17_expert15_fc1_gpu2 -> layer17_expert15_fc2_gpu2;
layer17_expert15_fc2_gpu2 -> layer17_expert15_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate16_gpu2;
layer17_gate16_gpu2 -> layer17_expert16_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert16_fc1_gpu2;
layer17_expert16_fc1_gpu2 -> layer17_expert16_fc2_gpu2;
layer17_expert16_fc2_gpu2 -> layer17_expert16_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate17_gpu2;
layer17_gate17_gpu2 -> layer17_expert17_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert17_fc1_gpu2;
layer17_expert17_fc1_gpu2 -> layer17_expert17_fc2_gpu2;
layer17_expert17_fc2_gpu2 -> layer17_expert17_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate18_gpu2;
layer17_gate18_gpu2 -> layer17_expert18_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert18_fc1_gpu2;
layer17_expert18_fc1_gpu2 -> layer17_expert18_fc2_gpu2;
layer17_expert18_fc2_gpu2 -> layer17_expert18_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate19_gpu2;
layer17_gate19_gpu2 -> layer17_expert19_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert19_fc1_gpu2;
layer17_expert19_fc1_gpu2 -> layer17_expert19_fc2_gpu2;
layer17_expert19_fc2_gpu2 -> layer17_expert19_add_gpu2;
layer17_ln1_gpu2 -> layer17_gate20_gpu2;
layer17_gate20_gpu2 -> layer17_expert20_fc1_gpu2 [style=dashed];
layer17_ln1_gpu2 -> layer17_expert20_fc1_gpu2;
layer17_expert20_fc1_gpu2 -> layer17_expert20_fc2_gpu2;
layer17_expert20_fc2_gpu2 -> layer17_expert20_add_gpu2;
layer17_expert20_add_gpu2 -> layer18_att_in_gpu2;
input -> layer18_att_in_gpu0;
layer18_att_in_gpu0 -> layer18_qkv0_gpu0;
layer18_att_in_gpu0 -> layer18_qkv1_gpu0;
layer18_qkv0_gpu0 -> layer18_attout0_gpu0;
layer18_qkv1_gpu0 -> layer18_attout1_gpu0;
layer18_attout0_gpu0 -> layer18_att_agg_gpu0;
layer18_attout1_gpu0 -> layer18_att_agg_gpu0;
layer18_att_agg_gpu0 -> layer18_res1_gpu0;
layer18_res1_gpu0 -> layer18_ln1_gpu0;
input -> layer18_att_in_gpu1;
layer18_att_in_gpu1 -> layer18_qkv0_gpu1;
layer18_att_in_gpu1 -> layer18_qkv1_gpu1;
layer18_qkv0_gpu1 -> layer18_attout0_gpu1;
layer18_qkv1_gpu1 -> layer18_attout1_gpu1;
layer18_attout0_gpu1 -> layer18_att_agg_gpu1;
layer18_attout1_gpu1 -> layer18_att_agg_gpu1;
layer18_att_agg_gpu1 -> layer18_res1_gpu1;
layer18_res1_gpu1 -> layer18_ln1_gpu1;
input -> layer18_att_in_gpu2;
layer18_att_in_gpu2 -> layer18_qkv0_gpu2;
layer18_att_in_gpu2 -> layer18_qkv1_gpu2;
layer18_qkv0_gpu2 -> layer18_attout0_gpu2;
layer18_qkv1_gpu2 -> layer18_attout1_gpu2;
layer18_attout0_gpu2 -> layer18_att_agg_gpu2;
layer18_attout1_gpu2 -> layer18_att_agg_gpu2;
layer18_att_agg_gpu2 -> layer18_res1_gpu2;
layer18_res1_gpu2 -> layer18_ln1_gpu2;
layer18_ln1_gpu0 -> layer18_gate0_gpu0;
layer18_gate0_gpu0 -> layer18_expert0_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert0_fc1_gpu0;
layer18_expert0_fc1_gpu0 -> layer18_expert0_fc2_gpu0;
layer18_expert0_fc2_gpu0 -> layer18_expert0_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate1_gpu0;
layer18_gate1_gpu0 -> layer18_expert1_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert1_fc1_gpu0;
layer18_expert1_fc1_gpu0 -> layer18_expert1_fc2_gpu0;
layer18_expert1_fc2_gpu0 -> layer18_expert1_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate2_gpu0;
layer18_gate2_gpu0 -> layer18_expert2_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert2_fc1_gpu0;
layer18_expert2_fc1_gpu0 -> layer18_expert2_fc2_gpu0;
layer18_expert2_fc2_gpu0 -> layer18_expert2_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate3_gpu0;
layer18_gate3_gpu0 -> layer18_expert3_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert3_fc1_gpu0;
layer18_expert3_fc1_gpu0 -> layer18_expert3_fc2_gpu0;
layer18_expert3_fc2_gpu0 -> layer18_expert3_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate4_gpu0;
layer18_gate4_gpu0 -> layer18_expert4_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert4_fc1_gpu0;
layer18_expert4_fc1_gpu0 -> layer18_expert4_fc2_gpu0;
layer18_expert4_fc2_gpu0 -> layer18_expert4_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate5_gpu0;
layer18_gate5_gpu0 -> layer18_expert5_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert5_fc1_gpu0;
layer18_expert5_fc1_gpu0 -> layer18_expert5_fc2_gpu0;
layer18_expert5_fc2_gpu0 -> layer18_expert5_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate6_gpu0;
layer18_gate6_gpu0 -> layer18_expert6_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert6_fc1_gpu0;
layer18_expert6_fc1_gpu0 -> layer18_expert6_fc2_gpu0;
layer18_expert6_fc2_gpu0 -> layer18_expert6_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate7_gpu0;
layer18_gate7_gpu0 -> layer18_expert7_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert7_fc1_gpu0;
layer18_expert7_fc1_gpu0 -> layer18_expert7_fc2_gpu0;
layer18_expert7_fc2_gpu0 -> layer18_expert7_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate8_gpu0;
layer18_gate8_gpu0 -> layer18_expert8_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert8_fc1_gpu0;
layer18_expert8_fc1_gpu0 -> layer18_expert8_fc2_gpu0;
layer18_expert8_fc2_gpu0 -> layer18_expert8_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate9_gpu0;
layer18_gate9_gpu0 -> layer18_expert9_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert9_fc1_gpu0;
layer18_expert9_fc1_gpu0 -> layer18_expert9_fc2_gpu0;
layer18_expert9_fc2_gpu0 -> layer18_expert9_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate10_gpu0;
layer18_gate10_gpu0 -> layer18_expert10_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert10_fc1_gpu0;
layer18_expert10_fc1_gpu0 -> layer18_expert10_fc2_gpu0;
layer18_expert10_fc2_gpu0 -> layer18_expert10_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate11_gpu0;
layer18_gate11_gpu0 -> layer18_expert11_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert11_fc1_gpu0;
layer18_expert11_fc1_gpu0 -> layer18_expert11_fc2_gpu0;
layer18_expert11_fc2_gpu0 -> layer18_expert11_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate12_gpu0;
layer18_gate12_gpu0 -> layer18_expert12_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert12_fc1_gpu0;
layer18_expert12_fc1_gpu0 -> layer18_expert12_fc2_gpu0;
layer18_expert12_fc2_gpu0 -> layer18_expert12_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate13_gpu0;
layer18_gate13_gpu0 -> layer18_expert13_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert13_fc1_gpu0;
layer18_expert13_fc1_gpu0 -> layer18_expert13_fc2_gpu0;
layer18_expert13_fc2_gpu0 -> layer18_expert13_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate14_gpu0;
layer18_gate14_gpu0 -> layer18_expert14_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert14_fc1_gpu0;
layer18_expert14_fc1_gpu0 -> layer18_expert14_fc2_gpu0;
layer18_expert14_fc2_gpu0 -> layer18_expert14_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate15_gpu0;
layer18_gate15_gpu0 -> layer18_expert15_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert15_fc1_gpu0;
layer18_expert15_fc1_gpu0 -> layer18_expert15_fc2_gpu0;
layer18_expert15_fc2_gpu0 -> layer18_expert15_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate16_gpu0;
layer18_gate16_gpu0 -> layer18_expert16_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert16_fc1_gpu0;
layer18_expert16_fc1_gpu0 -> layer18_expert16_fc2_gpu0;
layer18_expert16_fc2_gpu0 -> layer18_expert16_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate17_gpu0;
layer18_gate17_gpu0 -> layer18_expert17_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert17_fc1_gpu0;
layer18_expert17_fc1_gpu0 -> layer18_expert17_fc2_gpu0;
layer18_expert17_fc2_gpu0 -> layer18_expert17_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate18_gpu0;
layer18_gate18_gpu0 -> layer18_expert18_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert18_fc1_gpu0;
layer18_expert18_fc1_gpu0 -> layer18_expert18_fc2_gpu0;
layer18_expert18_fc2_gpu0 -> layer18_expert18_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate19_gpu0;
layer18_gate19_gpu0 -> layer18_expert19_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert19_fc1_gpu0;
layer18_expert19_fc1_gpu0 -> layer18_expert19_fc2_gpu0;
layer18_expert19_fc2_gpu0 -> layer18_expert19_add_gpu0;
layer18_ln1_gpu0 -> layer18_gate20_gpu0;
layer18_gate20_gpu0 -> layer18_expert20_fc1_gpu0 [style=dashed];
layer18_ln1_gpu0 -> layer18_expert20_fc1_gpu0;
layer18_expert20_fc1_gpu0 -> layer18_expert20_fc2_gpu0;
layer18_expert20_fc2_gpu0 -> layer18_expert20_add_gpu0;
layer18_expert20_add_gpu0 -> layer19_att_in_gpu0;
layer18_ln1_gpu1 -> layer18_gate0_gpu1;
layer18_gate0_gpu1 -> layer18_expert0_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert0_fc1_gpu1;
layer18_expert0_fc1_gpu1 -> layer18_expert0_fc2_gpu1;
layer18_expert0_fc2_gpu1 -> layer18_expert0_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate1_gpu1;
layer18_gate1_gpu1 -> layer18_expert1_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert1_fc1_gpu1;
layer18_expert1_fc1_gpu1 -> layer18_expert1_fc2_gpu1;
layer18_expert1_fc2_gpu1 -> layer18_expert1_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate2_gpu1;
layer18_gate2_gpu1 -> layer18_expert2_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert2_fc1_gpu1;
layer18_expert2_fc1_gpu1 -> layer18_expert2_fc2_gpu1;
layer18_expert2_fc2_gpu1 -> layer18_expert2_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate3_gpu1;
layer18_gate3_gpu1 -> layer18_expert3_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert3_fc1_gpu1;
layer18_expert3_fc1_gpu1 -> layer18_expert3_fc2_gpu1;
layer18_expert3_fc2_gpu1 -> layer18_expert3_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate4_gpu1;
layer18_gate4_gpu1 -> layer18_expert4_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert4_fc1_gpu1;
layer18_expert4_fc1_gpu1 -> layer18_expert4_fc2_gpu1;
layer18_expert4_fc2_gpu1 -> layer18_expert4_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate5_gpu1;
layer18_gate5_gpu1 -> layer18_expert5_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert5_fc1_gpu1;
layer18_expert5_fc1_gpu1 -> layer18_expert5_fc2_gpu1;
layer18_expert5_fc2_gpu1 -> layer18_expert5_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate6_gpu1;
layer18_gate6_gpu1 -> layer18_expert6_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert6_fc1_gpu1;
layer18_expert6_fc1_gpu1 -> layer18_expert6_fc2_gpu1;
layer18_expert6_fc2_gpu1 -> layer18_expert6_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate7_gpu1;
layer18_gate7_gpu1 -> layer18_expert7_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert7_fc1_gpu1;
layer18_expert7_fc1_gpu1 -> layer18_expert7_fc2_gpu1;
layer18_expert7_fc2_gpu1 -> layer18_expert7_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate8_gpu1;
layer18_gate8_gpu1 -> layer18_expert8_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert8_fc1_gpu1;
layer18_expert8_fc1_gpu1 -> layer18_expert8_fc2_gpu1;
layer18_expert8_fc2_gpu1 -> layer18_expert8_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate9_gpu1;
layer18_gate9_gpu1 -> layer18_expert9_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert9_fc1_gpu1;
layer18_expert9_fc1_gpu1 -> layer18_expert9_fc2_gpu1;
layer18_expert9_fc2_gpu1 -> layer18_expert9_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate10_gpu1;
layer18_gate10_gpu1 -> layer18_expert10_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert10_fc1_gpu1;
layer18_expert10_fc1_gpu1 -> layer18_expert10_fc2_gpu1;
layer18_expert10_fc2_gpu1 -> layer18_expert10_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate11_gpu1;
layer18_gate11_gpu1 -> layer18_expert11_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert11_fc1_gpu1;
layer18_expert11_fc1_gpu1 -> layer18_expert11_fc2_gpu1;
layer18_expert11_fc2_gpu1 -> layer18_expert11_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate12_gpu1;
layer18_gate12_gpu1 -> layer18_expert12_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert12_fc1_gpu1;
layer18_expert12_fc1_gpu1 -> layer18_expert12_fc2_gpu1;
layer18_expert12_fc2_gpu1 -> layer18_expert12_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate13_gpu1;
layer18_gate13_gpu1 -> layer18_expert13_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert13_fc1_gpu1;
layer18_expert13_fc1_gpu1 -> layer18_expert13_fc2_gpu1;
layer18_expert13_fc2_gpu1 -> layer18_expert13_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate14_gpu1;
layer18_gate14_gpu1 -> layer18_expert14_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert14_fc1_gpu1;
layer18_expert14_fc1_gpu1 -> layer18_expert14_fc2_gpu1;
layer18_expert14_fc2_gpu1 -> layer18_expert14_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate15_gpu1;
layer18_gate15_gpu1 -> layer18_expert15_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert15_fc1_gpu1;
layer18_expert15_fc1_gpu1 -> layer18_expert15_fc2_gpu1;
layer18_expert15_fc2_gpu1 -> layer18_expert15_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate16_gpu1;
layer18_gate16_gpu1 -> layer18_expert16_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert16_fc1_gpu1;
layer18_expert16_fc1_gpu1 -> layer18_expert16_fc2_gpu1;
layer18_expert16_fc2_gpu1 -> layer18_expert16_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate17_gpu1;
layer18_gate17_gpu1 -> layer18_expert17_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert17_fc1_gpu1;
layer18_expert17_fc1_gpu1 -> layer18_expert17_fc2_gpu1;
layer18_expert17_fc2_gpu1 -> layer18_expert17_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate18_gpu1;
layer18_gate18_gpu1 -> layer18_expert18_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert18_fc1_gpu1;
layer18_expert18_fc1_gpu1 -> layer18_expert18_fc2_gpu1;
layer18_expert18_fc2_gpu1 -> layer18_expert18_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate19_gpu1;
layer18_gate19_gpu1 -> layer18_expert19_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert19_fc1_gpu1;
layer18_expert19_fc1_gpu1 -> layer18_expert19_fc2_gpu1;
layer18_expert19_fc2_gpu1 -> layer18_expert19_add_gpu1;
layer18_ln1_gpu1 -> layer18_gate20_gpu1;
layer18_gate20_gpu1 -> layer18_expert20_fc1_gpu1 [style=dashed];
layer18_ln1_gpu1 -> layer18_expert20_fc1_gpu1;
layer18_expert20_fc1_gpu1 -> layer18_expert20_fc2_gpu1;
layer18_expert20_fc2_gpu1 -> layer18_expert20_add_gpu1;
layer18_expert20_add_gpu1 -> layer19_att_in_gpu1;
layer18_ln1_gpu2 -> layer18_gate0_gpu2;
layer18_gate0_gpu2 -> layer18_expert0_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert0_fc1_gpu2;
layer18_expert0_fc1_gpu2 -> layer18_expert0_fc2_gpu2;
layer18_expert0_fc2_gpu2 -> layer18_expert0_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate1_gpu2;
layer18_gate1_gpu2 -> layer18_expert1_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert1_fc1_gpu2;
layer18_expert1_fc1_gpu2 -> layer18_expert1_fc2_gpu2;
layer18_expert1_fc2_gpu2 -> layer18_expert1_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate2_gpu2;
layer18_gate2_gpu2 -> layer18_expert2_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert2_fc1_gpu2;
layer18_expert2_fc1_gpu2 -> layer18_expert2_fc2_gpu2;
layer18_expert2_fc2_gpu2 -> layer18_expert2_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate3_gpu2;
layer18_gate3_gpu2 -> layer18_expert3_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert3_fc1_gpu2;
layer18_expert3_fc1_gpu2 -> layer18_expert3_fc2_gpu2;
layer18_expert3_fc2_gpu2 -> layer18_expert3_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate4_gpu2;
layer18_gate4_gpu2 -> layer18_expert4_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert4_fc1_gpu2;
layer18_expert4_fc1_gpu2 -> layer18_expert4_fc2_gpu2;
layer18_expert4_fc2_gpu2 -> layer18_expert4_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate5_gpu2;
layer18_gate5_gpu2 -> layer18_expert5_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert5_fc1_gpu2;
layer18_expert5_fc1_gpu2 -> layer18_expert5_fc2_gpu2;
layer18_expert5_fc2_gpu2 -> layer18_expert5_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate6_gpu2;
layer18_gate6_gpu2 -> layer18_expert6_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert6_fc1_gpu2;
layer18_expert6_fc1_gpu2 -> layer18_expert6_fc2_gpu2;
layer18_expert6_fc2_gpu2 -> layer18_expert6_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate7_gpu2;
layer18_gate7_gpu2 -> layer18_expert7_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert7_fc1_gpu2;
layer18_expert7_fc1_gpu2 -> layer18_expert7_fc2_gpu2;
layer18_expert7_fc2_gpu2 -> layer18_expert7_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate8_gpu2;
layer18_gate8_gpu2 -> layer18_expert8_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert8_fc1_gpu2;
layer18_expert8_fc1_gpu2 -> layer18_expert8_fc2_gpu2;
layer18_expert8_fc2_gpu2 -> layer18_expert8_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate9_gpu2;
layer18_gate9_gpu2 -> layer18_expert9_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert9_fc1_gpu2;
layer18_expert9_fc1_gpu2 -> layer18_expert9_fc2_gpu2;
layer18_expert9_fc2_gpu2 -> layer18_expert9_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate10_gpu2;
layer18_gate10_gpu2 -> layer18_expert10_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert10_fc1_gpu2;
layer18_expert10_fc1_gpu2 -> layer18_expert10_fc2_gpu2;
layer18_expert10_fc2_gpu2 -> layer18_expert10_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate11_gpu2;
layer18_gate11_gpu2 -> layer18_expert11_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert11_fc1_gpu2;
layer18_expert11_fc1_gpu2 -> layer18_expert11_fc2_gpu2;
layer18_expert11_fc2_gpu2 -> layer18_expert11_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate12_gpu2;
layer18_gate12_gpu2 -> layer18_expert12_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert12_fc1_gpu2;
layer18_expert12_fc1_gpu2 -> layer18_expert12_fc2_gpu2;
layer18_expert12_fc2_gpu2 -> layer18_expert12_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate13_gpu2;
layer18_gate13_gpu2 -> layer18_expert13_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert13_fc1_gpu2;
layer18_expert13_fc1_gpu2 -> layer18_expert13_fc2_gpu2;
layer18_expert13_fc2_gpu2 -> layer18_expert13_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate14_gpu2;
layer18_gate14_gpu2 -> layer18_expert14_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert14_fc1_gpu2;
layer18_expert14_fc1_gpu2 -> layer18_expert14_fc2_gpu2;
layer18_expert14_fc2_gpu2 -> layer18_expert14_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate15_gpu2;
layer18_gate15_gpu2 -> layer18_expert15_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert15_fc1_gpu2;
layer18_expert15_fc1_gpu2 -> layer18_expert15_fc2_gpu2;
layer18_expert15_fc2_gpu2 -> layer18_expert15_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate16_gpu2;
layer18_gate16_gpu2 -> layer18_expert16_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert16_fc1_gpu2;
layer18_expert16_fc1_gpu2 -> layer18_expert16_fc2_gpu2;
layer18_expert16_fc2_gpu2 -> layer18_expert16_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate17_gpu2;
layer18_gate17_gpu2 -> layer18_expert17_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert17_fc1_gpu2;
layer18_expert17_fc1_gpu2 -> layer18_expert17_fc2_gpu2;
layer18_expert17_fc2_gpu2 -> layer18_expert17_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate18_gpu2;
layer18_gate18_gpu2 -> layer18_expert18_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert18_fc1_gpu2;
layer18_expert18_fc1_gpu2 -> layer18_expert18_fc2_gpu2;
layer18_expert18_fc2_gpu2 -> layer18_expert18_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate19_gpu2;
layer18_gate19_gpu2 -> layer18_expert19_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert19_fc1_gpu2;
layer18_expert19_fc1_gpu2 -> layer18_expert19_fc2_gpu2;
layer18_expert19_fc2_gpu2 -> layer18_expert19_add_gpu2;
layer18_ln1_gpu2 -> layer18_gate20_gpu2;
layer18_gate20_gpu2 -> layer18_expert20_fc1_gpu2 [style=dashed];
layer18_ln1_gpu2 -> layer18_expert20_fc1_gpu2;
layer18_expert20_fc1_gpu2 -> layer18_expert20_fc2_gpu2;
layer18_expert20_fc2_gpu2 -> layer18_expert20_add_gpu2;
layer18_expert20_add_gpu2 -> layer19_att_in_gpu2;
input -> layer19_att_in_gpu0;
layer19_att_in_gpu0 -> layer19_qkv0_gpu0;
layer19_att_in_gpu0 -> layer19_qkv1_gpu0;
layer19_qkv0_gpu0 -> layer19_attout0_gpu0;
layer19_qkv1_gpu0 -> layer19_attout1_gpu0;
layer19_attout0_gpu0 -> layer19_att_agg_gpu0;
layer19_attout1_gpu0 -> layer19_att_agg_gpu0;
layer19_att_agg_gpu0 -> layer19_res1_gpu0;
layer19_res1_gpu0 -> layer19_ln1_gpu0;
input -> layer19_att_in_gpu1;
layer19_att_in_gpu1 -> layer19_qkv0_gpu1;
layer19_att_in_gpu1 -> layer19_qkv1_gpu1;
layer19_qkv0_gpu1 -> layer19_attout0_gpu1;
layer19_qkv1_gpu1 -> layer19_attout1_gpu1;
layer19_attout0_gpu1 -> layer19_att_agg_gpu1;
layer19_attout1_gpu1 -> layer19_att_agg_gpu1;
layer19_att_agg_gpu1 -> layer19_res1_gpu1;
layer19_res1_gpu1 -> layer19_ln1_gpu1;
input -> layer19_att_in_gpu2;
layer19_att_in_gpu2 -> layer19_qkv0_gpu2;
layer19_att_in_gpu2 -> layer19_qkv1_gpu2;
layer19_qkv0_gpu2 -> layer19_attout0_gpu2;
layer19_qkv1_gpu2 -> layer19_attout1_gpu2;
layer19_attout0_gpu2 -> layer19_att_agg_gpu2;
layer19_attout1_gpu2 -> layer19_att_agg_gpu2;
layer19_att_agg_gpu2 -> layer19_res1_gpu2;
layer19_res1_gpu2 -> layer19_ln1_gpu2;
layer19_ln1_gpu0 -> layer19_gate0_gpu0;
layer19_gate0_gpu0 -> layer19_expert0_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert0_fc1_gpu0;
layer19_expert0_fc1_gpu0 -> layer19_expert0_fc2_gpu0;
layer19_expert0_fc2_gpu0 -> layer19_expert0_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate1_gpu0;
layer19_gate1_gpu0 -> layer19_expert1_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert1_fc1_gpu0;
layer19_expert1_fc1_gpu0 -> layer19_expert1_fc2_gpu0;
layer19_expert1_fc2_gpu0 -> layer19_expert1_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate2_gpu0;
layer19_gate2_gpu0 -> layer19_expert2_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert2_fc1_gpu0;
layer19_expert2_fc1_gpu0 -> layer19_expert2_fc2_gpu0;
layer19_expert2_fc2_gpu0 -> layer19_expert2_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate3_gpu0;
layer19_gate3_gpu0 -> layer19_expert3_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert3_fc1_gpu0;
layer19_expert3_fc1_gpu0 -> layer19_expert3_fc2_gpu0;
layer19_expert3_fc2_gpu0 -> layer19_expert3_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate4_gpu0;
layer19_gate4_gpu0 -> layer19_expert4_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert4_fc1_gpu0;
layer19_expert4_fc1_gpu0 -> layer19_expert4_fc2_gpu0;
layer19_expert4_fc2_gpu0 -> layer19_expert4_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate5_gpu0;
layer19_gate5_gpu0 -> layer19_expert5_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert5_fc1_gpu0;
layer19_expert5_fc1_gpu0 -> layer19_expert5_fc2_gpu0;
layer19_expert5_fc2_gpu0 -> layer19_expert5_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate6_gpu0;
layer19_gate6_gpu0 -> layer19_expert6_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert6_fc1_gpu0;
layer19_expert6_fc1_gpu0 -> layer19_expert6_fc2_gpu0;
layer19_expert6_fc2_gpu0 -> layer19_expert6_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate7_gpu0;
layer19_gate7_gpu0 -> layer19_expert7_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert7_fc1_gpu0;
layer19_expert7_fc1_gpu0 -> layer19_expert7_fc2_gpu0;
layer19_expert7_fc2_gpu0 -> layer19_expert7_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate8_gpu0;
layer19_gate8_gpu0 -> layer19_expert8_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert8_fc1_gpu0;
layer19_expert8_fc1_gpu0 -> layer19_expert8_fc2_gpu0;
layer19_expert8_fc2_gpu0 -> layer19_expert8_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate9_gpu0;
layer19_gate9_gpu0 -> layer19_expert9_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert9_fc1_gpu0;
layer19_expert9_fc1_gpu0 -> layer19_expert9_fc2_gpu0;
layer19_expert9_fc2_gpu0 -> layer19_expert9_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate10_gpu0;
layer19_gate10_gpu0 -> layer19_expert10_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert10_fc1_gpu0;
layer19_expert10_fc1_gpu0 -> layer19_expert10_fc2_gpu0;
layer19_expert10_fc2_gpu0 -> layer19_expert10_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate11_gpu0;
layer19_gate11_gpu0 -> layer19_expert11_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert11_fc1_gpu0;
layer19_expert11_fc1_gpu0 -> layer19_expert11_fc2_gpu0;
layer19_expert11_fc2_gpu0 -> layer19_expert11_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate12_gpu0;
layer19_gate12_gpu0 -> layer19_expert12_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert12_fc1_gpu0;
layer19_expert12_fc1_gpu0 -> layer19_expert12_fc2_gpu0;
layer19_expert12_fc2_gpu0 -> layer19_expert12_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate13_gpu0;
layer19_gate13_gpu0 -> layer19_expert13_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert13_fc1_gpu0;
layer19_expert13_fc1_gpu0 -> layer19_expert13_fc2_gpu0;
layer19_expert13_fc2_gpu0 -> layer19_expert13_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate14_gpu0;
layer19_gate14_gpu0 -> layer19_expert14_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert14_fc1_gpu0;
layer19_expert14_fc1_gpu0 -> layer19_expert14_fc2_gpu0;
layer19_expert14_fc2_gpu0 -> layer19_expert14_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate15_gpu0;
layer19_gate15_gpu0 -> layer19_expert15_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert15_fc1_gpu0;
layer19_expert15_fc1_gpu0 -> layer19_expert15_fc2_gpu0;
layer19_expert15_fc2_gpu0 -> layer19_expert15_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate16_gpu0;
layer19_gate16_gpu0 -> layer19_expert16_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert16_fc1_gpu0;
layer19_expert16_fc1_gpu0 -> layer19_expert16_fc2_gpu0;
layer19_expert16_fc2_gpu0 -> layer19_expert16_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate17_gpu0;
layer19_gate17_gpu0 -> layer19_expert17_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert17_fc1_gpu0;
layer19_expert17_fc1_gpu0 -> layer19_expert17_fc2_gpu0;
layer19_expert17_fc2_gpu0 -> layer19_expert17_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate18_gpu0;
layer19_gate18_gpu0 -> layer19_expert18_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert18_fc1_gpu0;
layer19_expert18_fc1_gpu0 -> layer19_expert18_fc2_gpu0;
layer19_expert18_fc2_gpu0 -> layer19_expert18_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate19_gpu0;
layer19_gate19_gpu0 -> layer19_expert19_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert19_fc1_gpu0;
layer19_expert19_fc1_gpu0 -> layer19_expert19_fc2_gpu0;
layer19_expert19_fc2_gpu0 -> layer19_expert19_add_gpu0;
layer19_ln1_gpu0 -> layer19_gate20_gpu0;
layer19_gate20_gpu0 -> layer19_expert20_fc1_gpu0 [style=dashed];
layer19_ln1_gpu0 -> layer19_expert20_fc1_gpu0;
layer19_expert20_fc1_gpu0 -> layer19_expert20_fc2_gpu0;
layer19_expert20_fc2_gpu0 -> layer19_expert20_add_gpu0;
layer19_expert20_add_gpu0 -> layer20_att_in_gpu0;
layer19_ln1_gpu1 -> layer19_gate0_gpu1;
layer19_gate0_gpu1 -> layer19_expert0_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert0_fc1_gpu1;
layer19_expert0_fc1_gpu1 -> layer19_expert0_fc2_gpu1;
layer19_expert0_fc2_gpu1 -> layer19_expert0_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate1_gpu1;
layer19_gate1_gpu1 -> layer19_expert1_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert1_fc1_gpu1;
layer19_expert1_fc1_gpu1 -> layer19_expert1_fc2_gpu1;
layer19_expert1_fc2_gpu1 -> layer19_expert1_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate2_gpu1;
layer19_gate2_gpu1 -> layer19_expert2_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert2_fc1_gpu1;
layer19_expert2_fc1_gpu1 -> layer19_expert2_fc2_gpu1;
layer19_expert2_fc2_gpu1 -> layer19_expert2_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate3_gpu1;
layer19_gate3_gpu1 -> layer19_expert3_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert3_fc1_gpu1;
layer19_expert3_fc1_gpu1 -> layer19_expert3_fc2_gpu1;
layer19_expert3_fc2_gpu1 -> layer19_expert3_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate4_gpu1;
layer19_gate4_gpu1 -> layer19_expert4_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert4_fc1_gpu1;
layer19_expert4_fc1_gpu1 -> layer19_expert4_fc2_gpu1;
layer19_expert4_fc2_gpu1 -> layer19_expert4_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate5_gpu1;
layer19_gate5_gpu1 -> layer19_expert5_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert5_fc1_gpu1;
layer19_expert5_fc1_gpu1 -> layer19_expert5_fc2_gpu1;
layer19_expert5_fc2_gpu1 -> layer19_expert5_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate6_gpu1;
layer19_gate6_gpu1 -> layer19_expert6_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert6_fc1_gpu1;
layer19_expert6_fc1_gpu1 -> layer19_expert6_fc2_gpu1;
layer19_expert6_fc2_gpu1 -> layer19_expert6_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate7_gpu1;
layer19_gate7_gpu1 -> layer19_expert7_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert7_fc1_gpu1;
layer19_expert7_fc1_gpu1 -> layer19_expert7_fc2_gpu1;
layer19_expert7_fc2_gpu1 -> layer19_expert7_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate8_gpu1;
layer19_gate8_gpu1 -> layer19_expert8_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert8_fc1_gpu1;
layer19_expert8_fc1_gpu1 -> layer19_expert8_fc2_gpu1;
layer19_expert8_fc2_gpu1 -> layer19_expert8_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate9_gpu1;
layer19_gate9_gpu1 -> layer19_expert9_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert9_fc1_gpu1;
layer19_expert9_fc1_gpu1 -> layer19_expert9_fc2_gpu1;
layer19_expert9_fc2_gpu1 -> layer19_expert9_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate10_gpu1;
layer19_gate10_gpu1 -> layer19_expert10_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert10_fc1_gpu1;
layer19_expert10_fc1_gpu1 -> layer19_expert10_fc2_gpu1;
layer19_expert10_fc2_gpu1 -> layer19_expert10_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate11_gpu1;
layer19_gate11_gpu1 -> layer19_expert11_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert11_fc1_gpu1;
layer19_expert11_fc1_gpu1 -> layer19_expert11_fc2_gpu1;
layer19_expert11_fc2_gpu1 -> layer19_expert11_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate12_gpu1;
layer19_gate12_gpu1 -> layer19_expert12_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert12_fc1_gpu1;
layer19_expert12_fc1_gpu1 -> layer19_expert12_fc2_gpu1;
layer19_expert12_fc2_gpu1 -> layer19_expert12_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate13_gpu1;
layer19_gate13_gpu1 -> layer19_expert13_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert13_fc1_gpu1;
layer19_expert13_fc1_gpu1 -> layer19_expert13_fc2_gpu1;
layer19_expert13_fc2_gpu1 -> layer19_expert13_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate14_gpu1;
layer19_gate14_gpu1 -> layer19_expert14_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert14_fc1_gpu1;
layer19_expert14_fc1_gpu1 -> layer19_expert14_fc2_gpu1;
layer19_expert14_fc2_gpu1 -> layer19_expert14_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate15_gpu1;
layer19_gate15_gpu1 -> layer19_expert15_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert15_fc1_gpu1;
layer19_expert15_fc1_gpu1 -> layer19_expert15_fc2_gpu1;
layer19_expert15_fc2_gpu1 -> layer19_expert15_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate16_gpu1;
layer19_gate16_gpu1 -> layer19_expert16_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert16_fc1_gpu1;
layer19_expert16_fc1_gpu1 -> layer19_expert16_fc2_gpu1;
layer19_expert16_fc2_gpu1 -> layer19_expert16_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate17_gpu1;
layer19_gate17_gpu1 -> layer19_expert17_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert17_fc1_gpu1;
layer19_expert17_fc1_gpu1 -> layer19_expert17_fc2_gpu1;
layer19_expert17_fc2_gpu1 -> layer19_expert17_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate18_gpu1;
layer19_gate18_gpu1 -> layer19_expert18_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert18_fc1_gpu1;
layer19_expert18_fc1_gpu1 -> layer19_expert18_fc2_gpu1;
layer19_expert18_fc2_gpu1 -> layer19_expert18_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate19_gpu1;
layer19_gate19_gpu1 -> layer19_expert19_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert19_fc1_gpu1;
layer19_expert19_fc1_gpu1 -> layer19_expert19_fc2_gpu1;
layer19_expert19_fc2_gpu1 -> layer19_expert19_add_gpu1;
layer19_ln1_gpu1 -> layer19_gate20_gpu1;
layer19_gate20_gpu1 -> layer19_expert20_fc1_gpu1 [style=dashed];
layer19_ln1_gpu1 -> layer19_expert20_fc1_gpu1;
layer19_expert20_fc1_gpu1 -> layer19_expert20_fc2_gpu1;
layer19_expert20_fc2_gpu1 -> layer19_expert20_add_gpu1;
layer19_expert20_add_gpu1 -> layer20_att_in_gpu1;
layer19_ln1_gpu2 -> layer19_gate0_gpu2;
layer19_gate0_gpu2 -> layer19_expert0_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert0_fc1_gpu2;
layer19_expert0_fc1_gpu2 -> layer19_expert0_fc2_gpu2;
layer19_expert0_fc2_gpu2 -> layer19_expert0_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate1_gpu2;
layer19_gate1_gpu2 -> layer19_expert1_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert1_fc1_gpu2;
layer19_expert1_fc1_gpu2 -> layer19_expert1_fc2_gpu2;
layer19_expert1_fc2_gpu2 -> layer19_expert1_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate2_gpu2;
layer19_gate2_gpu2 -> layer19_expert2_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert2_fc1_gpu2;
layer19_expert2_fc1_gpu2 -> layer19_expert2_fc2_gpu2;
layer19_expert2_fc2_gpu2 -> layer19_expert2_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate3_gpu2;
layer19_gate3_gpu2 -> layer19_expert3_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert3_fc1_gpu2;
layer19_expert3_fc1_gpu2 -> layer19_expert3_fc2_gpu2;
layer19_expert3_fc2_gpu2 -> layer19_expert3_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate4_gpu2;
layer19_gate4_gpu2 -> layer19_expert4_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert4_fc1_gpu2;
layer19_expert4_fc1_gpu2 -> layer19_expert4_fc2_gpu2;
layer19_expert4_fc2_gpu2 -> layer19_expert4_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate5_gpu2;
layer19_gate5_gpu2 -> layer19_expert5_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert5_fc1_gpu2;
layer19_expert5_fc1_gpu2 -> layer19_expert5_fc2_gpu2;
layer19_expert5_fc2_gpu2 -> layer19_expert5_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate6_gpu2;
layer19_gate6_gpu2 -> layer19_expert6_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert6_fc1_gpu2;
layer19_expert6_fc1_gpu2 -> layer19_expert6_fc2_gpu2;
layer19_expert6_fc2_gpu2 -> layer19_expert6_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate7_gpu2;
layer19_gate7_gpu2 -> layer19_expert7_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert7_fc1_gpu2;
layer19_expert7_fc1_gpu2 -> layer19_expert7_fc2_gpu2;
layer19_expert7_fc2_gpu2 -> layer19_expert7_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate8_gpu2;
layer19_gate8_gpu2 -> layer19_expert8_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert8_fc1_gpu2;
layer19_expert8_fc1_gpu2 -> layer19_expert8_fc2_gpu2;
layer19_expert8_fc2_gpu2 -> layer19_expert8_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate9_gpu2;
layer19_gate9_gpu2 -> layer19_expert9_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert9_fc1_gpu2;
layer19_expert9_fc1_gpu2 -> layer19_expert9_fc2_gpu2;
layer19_expert9_fc2_gpu2 -> layer19_expert9_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate10_gpu2;
layer19_gate10_gpu2 -> layer19_expert10_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert10_fc1_gpu2;
layer19_expert10_fc1_gpu2 -> layer19_expert10_fc2_gpu2;
layer19_expert10_fc2_gpu2 -> layer19_expert10_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate11_gpu2;
layer19_gate11_gpu2 -> layer19_expert11_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert11_fc1_gpu2;
layer19_expert11_fc1_gpu2 -> layer19_expert11_fc2_gpu2;
layer19_expert11_fc2_gpu2 -> layer19_expert11_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate12_gpu2;
layer19_gate12_gpu2 -> layer19_expert12_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert12_fc1_gpu2;
layer19_expert12_fc1_gpu2 -> layer19_expert12_fc2_gpu2;
layer19_expert12_fc2_gpu2 -> layer19_expert12_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate13_gpu2;
layer19_gate13_gpu2 -> layer19_expert13_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert13_fc1_gpu2;
layer19_expert13_fc1_gpu2 -> layer19_expert13_fc2_gpu2;
layer19_expert13_fc2_gpu2 -> layer19_expert13_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate14_gpu2;
layer19_gate14_gpu2 -> layer19_expert14_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert14_fc1_gpu2;
layer19_expert14_fc1_gpu2 -> layer19_expert14_fc2_gpu2;
layer19_expert14_fc2_gpu2 -> layer19_expert14_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate15_gpu2;
layer19_gate15_gpu2 -> layer19_expert15_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert15_fc1_gpu2;
layer19_expert15_fc1_gpu2 -> layer19_expert15_fc2_gpu2;
layer19_expert15_fc2_gpu2 -> layer19_expert15_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate16_gpu2;
layer19_gate16_gpu2 -> layer19_expert16_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert16_fc1_gpu2;
layer19_expert16_fc1_gpu2 -> layer19_expert16_fc2_gpu2;
layer19_expert16_fc2_gpu2 -> layer19_expert16_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate17_gpu2;
layer19_gate17_gpu2 -> layer19_expert17_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert17_fc1_gpu2;
layer19_expert17_fc1_gpu2 -> layer19_expert17_fc2_gpu2;
layer19_expert17_fc2_gpu2 -> layer19_expert17_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate18_gpu2;
layer19_gate18_gpu2 -> layer19_expert18_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert18_fc1_gpu2;
layer19_expert18_fc1_gpu2 -> layer19_expert18_fc2_gpu2;
layer19_expert18_fc2_gpu2 -> layer19_expert18_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate19_gpu2;
layer19_gate19_gpu2 -> layer19_expert19_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert19_fc1_gpu2;
layer19_expert19_fc1_gpu2 -> layer19_expert19_fc2_gpu2;
layer19_expert19_fc2_gpu2 -> layer19_expert19_add_gpu2;
layer19_ln1_gpu2 -> layer19_gate20_gpu2;
layer19_gate20_gpu2 -> layer19_expert20_fc1_gpu2 [style=dashed];
layer19_ln1_gpu2 -> layer19_expert20_fc1_gpu2;
layer19_expert20_fc1_gpu2 -> layer19_expert20_fc2_gpu2;
layer19_expert20_fc2_gpu2 -> layer19_expert20_add_gpu2;
layer19_expert20_add_gpu2 -> layer20_att_in_gpu2;
input -> layer20_att_in_gpu0;
layer20_att_in_gpu0 -> layer20_qkv0_gpu0;
layer20_att_in_gpu0 -> layer20_qkv1_gpu0;
layer20_qkv0_gpu0 -> layer20_attout0_gpu0;
layer20_qkv1_gpu0 -> layer20_attout1_gpu0;
layer20_attout0_gpu0 -> layer20_att_agg_gpu0;
layer20_attout1_gpu0 -> layer20_att_agg_gpu0;
layer20_att_agg_gpu0 -> layer20_res1_gpu0;
layer20_res1_gpu0 -> layer20_ln1_gpu0;
input -> layer20_att_in_gpu1;
layer20_att_in_gpu1 -> layer20_qkv0_gpu1;
layer20_att_in_gpu1 -> layer20_qkv1_gpu1;
layer20_qkv0_gpu1 -> layer20_attout0_gpu1;
layer20_qkv1_gpu1 -> layer20_attout1_gpu1;
layer20_attout0_gpu1 -> layer20_att_agg_gpu1;
layer20_attout1_gpu1 -> layer20_att_agg_gpu1;
layer20_att_agg_gpu1 -> layer20_res1_gpu1;
layer20_res1_gpu1 -> layer20_ln1_gpu1;
input -> layer20_att_in_gpu2;
layer20_att_in_gpu2 -> layer20_qkv0_gpu2;
layer20_att_in_gpu2 -> layer20_qkv1_gpu2;
layer20_qkv0_gpu2 -> layer20_attout0_gpu2;
layer20_qkv1_gpu2 -> layer20_attout1_gpu2;
layer20_attout0_gpu2 -> layer20_att_agg_gpu2;
layer20_attout1_gpu2 -> layer20_att_agg_gpu2;
layer20_att_agg_gpu2 -> layer20_res1_gpu2;
layer20_res1_gpu2 -> layer20_ln1_gpu2;
layer20_ln1_gpu0 -> layer20_gate0_gpu0;
layer20_gate0_gpu0 -> layer20_expert0_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert0_fc1_gpu0;
layer20_expert0_fc1_gpu0 -> layer20_expert0_fc2_gpu0;
layer20_expert0_fc2_gpu0 -> layer20_expert0_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate1_gpu0;
layer20_gate1_gpu0 -> layer20_expert1_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert1_fc1_gpu0;
layer20_expert1_fc1_gpu0 -> layer20_expert1_fc2_gpu0;
layer20_expert1_fc2_gpu0 -> layer20_expert1_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate2_gpu0;
layer20_gate2_gpu0 -> layer20_expert2_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert2_fc1_gpu0;
layer20_expert2_fc1_gpu0 -> layer20_expert2_fc2_gpu0;
layer20_expert2_fc2_gpu0 -> layer20_expert2_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate3_gpu0;
layer20_gate3_gpu0 -> layer20_expert3_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert3_fc1_gpu0;
layer20_expert3_fc1_gpu0 -> layer20_expert3_fc2_gpu0;
layer20_expert3_fc2_gpu0 -> layer20_expert3_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate4_gpu0;
layer20_gate4_gpu0 -> layer20_expert4_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert4_fc1_gpu0;
layer20_expert4_fc1_gpu0 -> layer20_expert4_fc2_gpu0;
layer20_expert4_fc2_gpu0 -> layer20_expert4_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate5_gpu0;
layer20_gate5_gpu0 -> layer20_expert5_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert5_fc1_gpu0;
layer20_expert5_fc1_gpu0 -> layer20_expert5_fc2_gpu0;
layer20_expert5_fc2_gpu0 -> layer20_expert5_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate6_gpu0;
layer20_gate6_gpu0 -> layer20_expert6_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert6_fc1_gpu0;
layer20_expert6_fc1_gpu0 -> layer20_expert6_fc2_gpu0;
layer20_expert6_fc2_gpu0 -> layer20_expert6_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate7_gpu0;
layer20_gate7_gpu0 -> layer20_expert7_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert7_fc1_gpu0;
layer20_expert7_fc1_gpu0 -> layer20_expert7_fc2_gpu0;
layer20_expert7_fc2_gpu0 -> layer20_expert7_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate8_gpu0;
layer20_gate8_gpu0 -> layer20_expert8_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert8_fc1_gpu0;
layer20_expert8_fc1_gpu0 -> layer20_expert8_fc2_gpu0;
layer20_expert8_fc2_gpu0 -> layer20_expert8_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate9_gpu0;
layer20_gate9_gpu0 -> layer20_expert9_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert9_fc1_gpu0;
layer20_expert9_fc1_gpu0 -> layer20_expert9_fc2_gpu0;
layer20_expert9_fc2_gpu0 -> layer20_expert9_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate10_gpu0;
layer20_gate10_gpu0 -> layer20_expert10_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert10_fc1_gpu0;
layer20_expert10_fc1_gpu0 -> layer20_expert10_fc2_gpu0;
layer20_expert10_fc2_gpu0 -> layer20_expert10_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate11_gpu0;
layer20_gate11_gpu0 -> layer20_expert11_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert11_fc1_gpu0;
layer20_expert11_fc1_gpu0 -> layer20_expert11_fc2_gpu0;
layer20_expert11_fc2_gpu0 -> layer20_expert11_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate12_gpu0;
layer20_gate12_gpu0 -> layer20_expert12_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert12_fc1_gpu0;
layer20_expert12_fc1_gpu0 -> layer20_expert12_fc2_gpu0;
layer20_expert12_fc2_gpu0 -> layer20_expert12_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate13_gpu0;
layer20_gate13_gpu0 -> layer20_expert13_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert13_fc1_gpu0;
layer20_expert13_fc1_gpu0 -> layer20_expert13_fc2_gpu0;
layer20_expert13_fc2_gpu0 -> layer20_expert13_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate14_gpu0;
layer20_gate14_gpu0 -> layer20_expert14_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert14_fc1_gpu0;
layer20_expert14_fc1_gpu0 -> layer20_expert14_fc2_gpu0;
layer20_expert14_fc2_gpu0 -> layer20_expert14_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate15_gpu0;
layer20_gate15_gpu0 -> layer20_expert15_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert15_fc1_gpu0;
layer20_expert15_fc1_gpu0 -> layer20_expert15_fc2_gpu0;
layer20_expert15_fc2_gpu0 -> layer20_expert15_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate16_gpu0;
layer20_gate16_gpu0 -> layer20_expert16_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert16_fc1_gpu0;
layer20_expert16_fc1_gpu0 -> layer20_expert16_fc2_gpu0;
layer20_expert16_fc2_gpu0 -> layer20_expert16_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate17_gpu0;
layer20_gate17_gpu0 -> layer20_expert17_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert17_fc1_gpu0;
layer20_expert17_fc1_gpu0 -> layer20_expert17_fc2_gpu0;
layer20_expert17_fc2_gpu0 -> layer20_expert17_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate18_gpu0;
layer20_gate18_gpu0 -> layer20_expert18_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert18_fc1_gpu0;
layer20_expert18_fc1_gpu0 -> layer20_expert18_fc2_gpu0;
layer20_expert18_fc2_gpu0 -> layer20_expert18_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate19_gpu0;
layer20_gate19_gpu0 -> layer20_expert19_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert19_fc1_gpu0;
layer20_expert19_fc1_gpu0 -> layer20_expert19_fc2_gpu0;
layer20_expert19_fc2_gpu0 -> layer20_expert19_add_gpu0;
layer20_ln1_gpu0 -> layer20_gate20_gpu0;
layer20_gate20_gpu0 -> layer20_expert20_fc1_gpu0 [style=dashed];
layer20_ln1_gpu0 -> layer20_expert20_fc1_gpu0;
layer20_expert20_fc1_gpu0 -> layer20_expert20_fc2_gpu0;
layer20_expert20_fc2_gpu0 -> layer20_expert20_add_gpu0;
layer20_expert20_add_gpu0 -> layer21_att_in_gpu0;
layer20_ln1_gpu1 -> layer20_gate0_gpu1;
layer20_gate0_gpu1 -> layer20_expert0_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert0_fc1_gpu1;
layer20_expert0_fc1_gpu1 -> layer20_expert0_fc2_gpu1;
layer20_expert0_fc2_gpu1 -> layer20_expert0_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate1_gpu1;
layer20_gate1_gpu1 -> layer20_expert1_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert1_fc1_gpu1;
layer20_expert1_fc1_gpu1 -> layer20_expert1_fc2_gpu1;
layer20_expert1_fc2_gpu1 -> layer20_expert1_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate2_gpu1;
layer20_gate2_gpu1 -> layer20_expert2_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert2_fc1_gpu1;
layer20_expert2_fc1_gpu1 -> layer20_expert2_fc2_gpu1;
layer20_expert2_fc2_gpu1 -> layer20_expert2_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate3_gpu1;
layer20_gate3_gpu1 -> layer20_expert3_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert3_fc1_gpu1;
layer20_expert3_fc1_gpu1 -> layer20_expert3_fc2_gpu1;
layer20_expert3_fc2_gpu1 -> layer20_expert3_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate4_gpu1;
layer20_gate4_gpu1 -> layer20_expert4_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert4_fc1_gpu1;
layer20_expert4_fc1_gpu1 -> layer20_expert4_fc2_gpu1;
layer20_expert4_fc2_gpu1 -> layer20_expert4_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate5_gpu1;
layer20_gate5_gpu1 -> layer20_expert5_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert5_fc1_gpu1;
layer20_expert5_fc1_gpu1 -> layer20_expert5_fc2_gpu1;
layer20_expert5_fc2_gpu1 -> layer20_expert5_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate6_gpu1;
layer20_gate6_gpu1 -> layer20_expert6_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert6_fc1_gpu1;
layer20_expert6_fc1_gpu1 -> layer20_expert6_fc2_gpu1;
layer20_expert6_fc2_gpu1 -> layer20_expert6_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate7_gpu1;
layer20_gate7_gpu1 -> layer20_expert7_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert7_fc1_gpu1;
layer20_expert7_fc1_gpu1 -> layer20_expert7_fc2_gpu1;
layer20_expert7_fc2_gpu1 -> layer20_expert7_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate8_gpu1;
layer20_gate8_gpu1 -> layer20_expert8_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert8_fc1_gpu1;
layer20_expert8_fc1_gpu1 -> layer20_expert8_fc2_gpu1;
layer20_expert8_fc2_gpu1 -> layer20_expert8_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate9_gpu1;
layer20_gate9_gpu1 -> layer20_expert9_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert9_fc1_gpu1;
layer20_expert9_fc1_gpu1 -> layer20_expert9_fc2_gpu1;
layer20_expert9_fc2_gpu1 -> layer20_expert9_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate10_gpu1;
layer20_gate10_gpu1 -> layer20_expert10_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert10_fc1_gpu1;
layer20_expert10_fc1_gpu1 -> layer20_expert10_fc2_gpu1;
layer20_expert10_fc2_gpu1 -> layer20_expert10_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate11_gpu1;
layer20_gate11_gpu1 -> layer20_expert11_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert11_fc1_gpu1;
layer20_expert11_fc1_gpu1 -> layer20_expert11_fc2_gpu1;
layer20_expert11_fc2_gpu1 -> layer20_expert11_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate12_gpu1;
layer20_gate12_gpu1 -> layer20_expert12_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert12_fc1_gpu1;
layer20_expert12_fc1_gpu1 -> layer20_expert12_fc2_gpu1;
layer20_expert12_fc2_gpu1 -> layer20_expert12_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate13_gpu1;
layer20_gate13_gpu1 -> layer20_expert13_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert13_fc1_gpu1;
layer20_expert13_fc1_gpu1 -> layer20_expert13_fc2_gpu1;
layer20_expert13_fc2_gpu1 -> layer20_expert13_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate14_gpu1;
layer20_gate14_gpu1 -> layer20_expert14_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert14_fc1_gpu1;
layer20_expert14_fc1_gpu1 -> layer20_expert14_fc2_gpu1;
layer20_expert14_fc2_gpu1 -> layer20_expert14_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate15_gpu1;
layer20_gate15_gpu1 -> layer20_expert15_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert15_fc1_gpu1;
layer20_expert15_fc1_gpu1 -> layer20_expert15_fc2_gpu1;
layer20_expert15_fc2_gpu1 -> layer20_expert15_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate16_gpu1;
layer20_gate16_gpu1 -> layer20_expert16_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert16_fc1_gpu1;
layer20_expert16_fc1_gpu1 -> layer20_expert16_fc2_gpu1;
layer20_expert16_fc2_gpu1 -> layer20_expert16_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate17_gpu1;
layer20_gate17_gpu1 -> layer20_expert17_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert17_fc1_gpu1;
layer20_expert17_fc1_gpu1 -> layer20_expert17_fc2_gpu1;
layer20_expert17_fc2_gpu1 -> layer20_expert17_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate18_gpu1;
layer20_gate18_gpu1 -> layer20_expert18_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert18_fc1_gpu1;
layer20_expert18_fc1_gpu1 -> layer20_expert18_fc2_gpu1;
layer20_expert18_fc2_gpu1 -> layer20_expert18_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate19_gpu1;
layer20_gate19_gpu1 -> layer20_expert19_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert19_fc1_gpu1;
layer20_expert19_fc1_gpu1 -> layer20_expert19_fc2_gpu1;
layer20_expert19_fc2_gpu1 -> layer20_expert19_add_gpu1;
layer20_ln1_gpu1 -> layer20_gate20_gpu1;
layer20_gate20_gpu1 -> layer20_expert20_fc1_gpu1 [style=dashed];
layer20_ln1_gpu1 -> layer20_expert20_fc1_gpu1;
layer20_expert20_fc1_gpu1 -> layer20_expert20_fc2_gpu1;
layer20_expert20_fc2_gpu1 -> layer20_expert20_add_gpu1;
layer20_expert20_add_gpu1 -> layer21_att_in_gpu1;
layer20_ln1_gpu2 -> layer20_gate0_gpu2;
layer20_gate0_gpu2 -> layer20_expert0_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert0_fc1_gpu2;
layer20_expert0_fc1_gpu2 -> layer20_expert0_fc2_gpu2;
layer20_expert0_fc2_gpu2 -> layer20_expert0_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate1_gpu2;
layer20_gate1_gpu2 -> layer20_expert1_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert1_fc1_gpu2;
layer20_expert1_fc1_gpu2 -> layer20_expert1_fc2_gpu2;
layer20_expert1_fc2_gpu2 -> layer20_expert1_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate2_gpu2;
layer20_gate2_gpu2 -> layer20_expert2_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert2_fc1_gpu2;
layer20_expert2_fc1_gpu2 -> layer20_expert2_fc2_gpu2;
layer20_expert2_fc2_gpu2 -> layer20_expert2_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate3_gpu2;
layer20_gate3_gpu2 -> layer20_expert3_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert3_fc1_gpu2;
layer20_expert3_fc1_gpu2 -> layer20_expert3_fc2_gpu2;
layer20_expert3_fc2_gpu2 -> layer20_expert3_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate4_gpu2;
layer20_gate4_gpu2 -> layer20_expert4_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert4_fc1_gpu2;
layer20_expert4_fc1_gpu2 -> layer20_expert4_fc2_gpu2;
layer20_expert4_fc2_gpu2 -> layer20_expert4_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate5_gpu2;
layer20_gate5_gpu2 -> layer20_expert5_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert5_fc1_gpu2;
layer20_expert5_fc1_gpu2 -> layer20_expert5_fc2_gpu2;
layer20_expert5_fc2_gpu2 -> layer20_expert5_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate6_gpu2;
layer20_gate6_gpu2 -> layer20_expert6_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert6_fc1_gpu2;
layer20_expert6_fc1_gpu2 -> layer20_expert6_fc2_gpu2;
layer20_expert6_fc2_gpu2 -> layer20_expert6_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate7_gpu2;
layer20_gate7_gpu2 -> layer20_expert7_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert7_fc1_gpu2;
layer20_expert7_fc1_gpu2 -> layer20_expert7_fc2_gpu2;
layer20_expert7_fc2_gpu2 -> layer20_expert7_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate8_gpu2;
layer20_gate8_gpu2 -> layer20_expert8_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert8_fc1_gpu2;
layer20_expert8_fc1_gpu2 -> layer20_expert8_fc2_gpu2;
layer20_expert8_fc2_gpu2 -> layer20_expert8_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate9_gpu2;
layer20_gate9_gpu2 -> layer20_expert9_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert9_fc1_gpu2;
layer20_expert9_fc1_gpu2 -> layer20_expert9_fc2_gpu2;
layer20_expert9_fc2_gpu2 -> layer20_expert9_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate10_gpu2;
layer20_gate10_gpu2 -> layer20_expert10_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert10_fc1_gpu2;
layer20_expert10_fc1_gpu2 -> layer20_expert10_fc2_gpu2;
layer20_expert10_fc2_gpu2 -> layer20_expert10_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate11_gpu2;
layer20_gate11_gpu2 -> layer20_expert11_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert11_fc1_gpu2;
layer20_expert11_fc1_gpu2 -> layer20_expert11_fc2_gpu2;
layer20_expert11_fc2_gpu2 -> layer20_expert11_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate12_gpu2;
layer20_gate12_gpu2 -> layer20_expert12_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert12_fc1_gpu2;
layer20_expert12_fc1_gpu2 -> layer20_expert12_fc2_gpu2;
layer20_expert12_fc2_gpu2 -> layer20_expert12_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate13_gpu2;
layer20_gate13_gpu2 -> layer20_expert13_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert13_fc1_gpu2;
layer20_expert13_fc1_gpu2 -> layer20_expert13_fc2_gpu2;
layer20_expert13_fc2_gpu2 -> layer20_expert13_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate14_gpu2;
layer20_gate14_gpu2 -> layer20_expert14_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert14_fc1_gpu2;
layer20_expert14_fc1_gpu2 -> layer20_expert14_fc2_gpu2;
layer20_expert14_fc2_gpu2 -> layer20_expert14_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate15_gpu2;
layer20_gate15_gpu2 -> layer20_expert15_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert15_fc1_gpu2;
layer20_expert15_fc1_gpu2 -> layer20_expert15_fc2_gpu2;
layer20_expert15_fc2_gpu2 -> layer20_expert15_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate16_gpu2;
layer20_gate16_gpu2 -> layer20_expert16_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert16_fc1_gpu2;
layer20_expert16_fc1_gpu2 -> layer20_expert16_fc2_gpu2;
layer20_expert16_fc2_gpu2 -> layer20_expert16_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate17_gpu2;
layer20_gate17_gpu2 -> layer20_expert17_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert17_fc1_gpu2;
layer20_expert17_fc1_gpu2 -> layer20_expert17_fc2_gpu2;
layer20_expert17_fc2_gpu2 -> layer20_expert17_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate18_gpu2;
layer20_gate18_gpu2 -> layer20_expert18_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert18_fc1_gpu2;
layer20_expert18_fc1_gpu2 -> layer20_expert18_fc2_gpu2;
layer20_expert18_fc2_gpu2 -> layer20_expert18_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate19_gpu2;
layer20_gate19_gpu2 -> layer20_expert19_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert19_fc1_gpu2;
layer20_expert19_fc1_gpu2 -> layer20_expert19_fc2_gpu2;
layer20_expert19_fc2_gpu2 -> layer20_expert19_add_gpu2;
layer20_ln1_gpu2 -> layer20_gate20_gpu2;
layer20_gate20_gpu2 -> layer20_expert20_fc1_gpu2 [style=dashed];
layer20_ln1_gpu2 -> layer20_expert20_fc1_gpu2;
layer20_expert20_fc1_gpu2 -> layer20_expert20_fc2_gpu2;
layer20_expert20_fc2_gpu2 -> layer20_expert20_add_gpu2;
layer20_expert20_add_gpu2 -> layer21_att_in_gpu2;
input -> layer21_att_in_gpu0;
layer21_att_in_gpu0 -> layer21_qkv0_gpu0;
layer21_att_in_gpu0 -> layer21_qkv1_gpu0;
layer21_qkv0_gpu0 -> layer21_attout0_gpu0;
layer21_qkv1_gpu0 -> layer21_attout1_gpu0;
layer21_attout0_gpu0 -> layer21_att_agg_gpu0;
layer21_attout1_gpu0 -> layer21_att_agg_gpu0;
layer21_att_agg_gpu0 -> layer21_res1_gpu0;
layer21_res1_gpu0 -> layer21_ln1_gpu0;
input -> layer21_att_in_gpu1;
layer21_att_in_gpu1 -> layer21_qkv0_gpu1;
layer21_att_in_gpu1 -> layer21_qkv1_gpu1;
layer21_qkv0_gpu1 -> layer21_attout0_gpu1;
layer21_qkv1_gpu1 -> layer21_attout1_gpu1;
layer21_attout0_gpu1 -> layer21_att_agg_gpu1;
layer21_attout1_gpu1 -> layer21_att_agg_gpu1;
layer21_att_agg_gpu1 -> layer21_res1_gpu1;
layer21_res1_gpu1 -> layer21_ln1_gpu1;
input -> layer21_att_in_gpu2;
layer21_att_in_gpu2 -> layer21_qkv0_gpu2;
layer21_att_in_gpu2 -> layer21_qkv1_gpu2;
layer21_qkv0_gpu2 -> layer21_attout0_gpu2;
layer21_qkv1_gpu2 -> layer21_attout1_gpu2;
layer21_attout0_gpu2 -> layer21_att_agg_gpu2;
layer21_attout1_gpu2 -> layer21_att_agg_gpu2;
layer21_att_agg_gpu2 -> layer21_res1_gpu2;
layer21_res1_gpu2 -> layer21_ln1_gpu2;
layer21_ln1_gpu0 -> layer21_gate0_gpu0;
layer21_gate0_gpu0 -> layer21_expert0_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert0_fc1_gpu0;
layer21_expert0_fc1_gpu0 -> layer21_expert0_fc2_gpu0;
layer21_expert0_fc2_gpu0 -> layer21_expert0_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate1_gpu0;
layer21_gate1_gpu0 -> layer21_expert1_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert1_fc1_gpu0;
layer21_expert1_fc1_gpu0 -> layer21_expert1_fc2_gpu0;
layer21_expert1_fc2_gpu0 -> layer21_expert1_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate2_gpu0;
layer21_gate2_gpu0 -> layer21_expert2_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert2_fc1_gpu0;
layer21_expert2_fc1_gpu0 -> layer21_expert2_fc2_gpu0;
layer21_expert2_fc2_gpu0 -> layer21_expert2_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate3_gpu0;
layer21_gate3_gpu0 -> layer21_expert3_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert3_fc1_gpu0;
layer21_expert3_fc1_gpu0 -> layer21_expert3_fc2_gpu0;
layer21_expert3_fc2_gpu0 -> layer21_expert3_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate4_gpu0;
layer21_gate4_gpu0 -> layer21_expert4_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert4_fc1_gpu0;
layer21_expert4_fc1_gpu0 -> layer21_expert4_fc2_gpu0;
layer21_expert4_fc2_gpu0 -> layer21_expert4_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate5_gpu0;
layer21_gate5_gpu0 -> layer21_expert5_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert5_fc1_gpu0;
layer21_expert5_fc1_gpu0 -> layer21_expert5_fc2_gpu0;
layer21_expert5_fc2_gpu0 -> layer21_expert5_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate6_gpu0;
layer21_gate6_gpu0 -> layer21_expert6_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert6_fc1_gpu0;
layer21_expert6_fc1_gpu0 -> layer21_expert6_fc2_gpu0;
layer21_expert6_fc2_gpu0 -> layer21_expert6_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate7_gpu0;
layer21_gate7_gpu0 -> layer21_expert7_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert7_fc1_gpu0;
layer21_expert7_fc1_gpu0 -> layer21_expert7_fc2_gpu0;
layer21_expert7_fc2_gpu0 -> layer21_expert7_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate8_gpu0;
layer21_gate8_gpu0 -> layer21_expert8_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert8_fc1_gpu0;
layer21_expert8_fc1_gpu0 -> layer21_expert8_fc2_gpu0;
layer21_expert8_fc2_gpu0 -> layer21_expert8_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate9_gpu0;
layer21_gate9_gpu0 -> layer21_expert9_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert9_fc1_gpu0;
layer21_expert9_fc1_gpu0 -> layer21_expert9_fc2_gpu0;
layer21_expert9_fc2_gpu0 -> layer21_expert9_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate10_gpu0;
layer21_gate10_gpu0 -> layer21_expert10_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert10_fc1_gpu0;
layer21_expert10_fc1_gpu0 -> layer21_expert10_fc2_gpu0;
layer21_expert10_fc2_gpu0 -> layer21_expert10_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate11_gpu0;
layer21_gate11_gpu0 -> layer21_expert11_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert11_fc1_gpu0;
layer21_expert11_fc1_gpu0 -> layer21_expert11_fc2_gpu0;
layer21_expert11_fc2_gpu0 -> layer21_expert11_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate12_gpu0;
layer21_gate12_gpu0 -> layer21_expert12_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert12_fc1_gpu0;
layer21_expert12_fc1_gpu0 -> layer21_expert12_fc2_gpu0;
layer21_expert12_fc2_gpu0 -> layer21_expert12_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate13_gpu0;
layer21_gate13_gpu0 -> layer21_expert13_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert13_fc1_gpu0;
layer21_expert13_fc1_gpu0 -> layer21_expert13_fc2_gpu0;
layer21_expert13_fc2_gpu0 -> layer21_expert13_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate14_gpu0;
layer21_gate14_gpu0 -> layer21_expert14_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert14_fc1_gpu0;
layer21_expert14_fc1_gpu0 -> layer21_expert14_fc2_gpu0;
layer21_expert14_fc2_gpu0 -> layer21_expert14_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate15_gpu0;
layer21_gate15_gpu0 -> layer21_expert15_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert15_fc1_gpu0;
layer21_expert15_fc1_gpu0 -> layer21_expert15_fc2_gpu0;
layer21_expert15_fc2_gpu0 -> layer21_expert15_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate16_gpu0;
layer21_gate16_gpu0 -> layer21_expert16_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert16_fc1_gpu0;
layer21_expert16_fc1_gpu0 -> layer21_expert16_fc2_gpu0;
layer21_expert16_fc2_gpu0 -> layer21_expert16_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate17_gpu0;
layer21_gate17_gpu0 -> layer21_expert17_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert17_fc1_gpu0;
layer21_expert17_fc1_gpu0 -> layer21_expert17_fc2_gpu0;
layer21_expert17_fc2_gpu0 -> layer21_expert17_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate18_gpu0;
layer21_gate18_gpu0 -> layer21_expert18_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert18_fc1_gpu0;
layer21_expert18_fc1_gpu0 -> layer21_expert18_fc2_gpu0;
layer21_expert18_fc2_gpu0 -> layer21_expert18_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate19_gpu0;
layer21_gate19_gpu0 -> layer21_expert19_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert19_fc1_gpu0;
layer21_expert19_fc1_gpu0 -> layer21_expert19_fc2_gpu0;
layer21_expert19_fc2_gpu0 -> layer21_expert19_add_gpu0;
layer21_ln1_gpu0 -> layer21_gate20_gpu0;
layer21_gate20_gpu0 -> layer21_expert20_fc1_gpu0 [style=dashed];
layer21_ln1_gpu0 -> layer21_expert20_fc1_gpu0;
layer21_expert20_fc1_gpu0 -> layer21_expert20_fc2_gpu0;
layer21_expert20_fc2_gpu0 -> layer21_expert20_add_gpu0;
layer21_expert20_add_gpu0 -> layer22_att_in_gpu0;
layer21_ln1_gpu1 -> layer21_gate0_gpu1;
layer21_gate0_gpu1 -> layer21_expert0_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert0_fc1_gpu1;
layer21_expert0_fc1_gpu1 -> layer21_expert0_fc2_gpu1;
layer21_expert0_fc2_gpu1 -> layer21_expert0_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate1_gpu1;
layer21_gate1_gpu1 -> layer21_expert1_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert1_fc1_gpu1;
layer21_expert1_fc1_gpu1 -> layer21_expert1_fc2_gpu1;
layer21_expert1_fc2_gpu1 -> layer21_expert1_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate2_gpu1;
layer21_gate2_gpu1 -> layer21_expert2_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert2_fc1_gpu1;
layer21_expert2_fc1_gpu1 -> layer21_expert2_fc2_gpu1;
layer21_expert2_fc2_gpu1 -> layer21_expert2_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate3_gpu1;
layer21_gate3_gpu1 -> layer21_expert3_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert3_fc1_gpu1;
layer21_expert3_fc1_gpu1 -> layer21_expert3_fc2_gpu1;
layer21_expert3_fc2_gpu1 -> layer21_expert3_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate4_gpu1;
layer21_gate4_gpu1 -> layer21_expert4_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert4_fc1_gpu1;
layer21_expert4_fc1_gpu1 -> layer21_expert4_fc2_gpu1;
layer21_expert4_fc2_gpu1 -> layer21_expert4_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate5_gpu1;
layer21_gate5_gpu1 -> layer21_expert5_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert5_fc1_gpu1;
layer21_expert5_fc1_gpu1 -> layer21_expert5_fc2_gpu1;
layer21_expert5_fc2_gpu1 -> layer21_expert5_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate6_gpu1;
layer21_gate6_gpu1 -> layer21_expert6_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert6_fc1_gpu1;
layer21_expert6_fc1_gpu1 -> layer21_expert6_fc2_gpu1;
layer21_expert6_fc2_gpu1 -> layer21_expert6_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate7_gpu1;
layer21_gate7_gpu1 -> layer21_expert7_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert7_fc1_gpu1;
layer21_expert7_fc1_gpu1 -> layer21_expert7_fc2_gpu1;
layer21_expert7_fc2_gpu1 -> layer21_expert7_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate8_gpu1;
layer21_gate8_gpu1 -> layer21_expert8_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert8_fc1_gpu1;
layer21_expert8_fc1_gpu1 -> layer21_expert8_fc2_gpu1;
layer21_expert8_fc2_gpu1 -> layer21_expert8_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate9_gpu1;
layer21_gate9_gpu1 -> layer21_expert9_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert9_fc1_gpu1;
layer21_expert9_fc1_gpu1 -> layer21_expert9_fc2_gpu1;
layer21_expert9_fc2_gpu1 -> layer21_expert9_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate10_gpu1;
layer21_gate10_gpu1 -> layer21_expert10_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert10_fc1_gpu1;
layer21_expert10_fc1_gpu1 -> layer21_expert10_fc2_gpu1;
layer21_expert10_fc2_gpu1 -> layer21_expert10_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate11_gpu1;
layer21_gate11_gpu1 -> layer21_expert11_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert11_fc1_gpu1;
layer21_expert11_fc1_gpu1 -> layer21_expert11_fc2_gpu1;
layer21_expert11_fc2_gpu1 -> layer21_expert11_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate12_gpu1;
layer21_gate12_gpu1 -> layer21_expert12_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert12_fc1_gpu1;
layer21_expert12_fc1_gpu1 -> layer21_expert12_fc2_gpu1;
layer21_expert12_fc2_gpu1 -> layer21_expert12_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate13_gpu1;
layer21_gate13_gpu1 -> layer21_expert13_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert13_fc1_gpu1;
layer21_expert13_fc1_gpu1 -> layer21_expert13_fc2_gpu1;
layer21_expert13_fc2_gpu1 -> layer21_expert13_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate14_gpu1;
layer21_gate14_gpu1 -> layer21_expert14_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert14_fc1_gpu1;
layer21_expert14_fc1_gpu1 -> layer21_expert14_fc2_gpu1;
layer21_expert14_fc2_gpu1 -> layer21_expert14_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate15_gpu1;
layer21_gate15_gpu1 -> layer21_expert15_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert15_fc1_gpu1;
layer21_expert15_fc1_gpu1 -> layer21_expert15_fc2_gpu1;
layer21_expert15_fc2_gpu1 -> layer21_expert15_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate16_gpu1;
layer21_gate16_gpu1 -> layer21_expert16_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert16_fc1_gpu1;
layer21_expert16_fc1_gpu1 -> layer21_expert16_fc2_gpu1;
layer21_expert16_fc2_gpu1 -> layer21_expert16_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate17_gpu1;
layer21_gate17_gpu1 -> layer21_expert17_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert17_fc1_gpu1;
layer21_expert17_fc1_gpu1 -> layer21_expert17_fc2_gpu1;
layer21_expert17_fc2_gpu1 -> layer21_expert17_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate18_gpu1;
layer21_gate18_gpu1 -> layer21_expert18_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert18_fc1_gpu1;
layer21_expert18_fc1_gpu1 -> layer21_expert18_fc2_gpu1;
layer21_expert18_fc2_gpu1 -> layer21_expert18_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate19_gpu1;
layer21_gate19_gpu1 -> layer21_expert19_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert19_fc1_gpu1;
layer21_expert19_fc1_gpu1 -> layer21_expert19_fc2_gpu1;
layer21_expert19_fc2_gpu1 -> layer21_expert19_add_gpu1;
layer21_ln1_gpu1 -> layer21_gate20_gpu1;
layer21_gate20_gpu1 -> layer21_expert20_fc1_gpu1 [style=dashed];
layer21_ln1_gpu1 -> layer21_expert20_fc1_gpu1;
layer21_expert20_fc1_gpu1 -> layer21_expert20_fc2_gpu1;
layer21_expert20_fc2_gpu1 -> layer21_expert20_add_gpu1;
layer21_expert20_add_gpu1 -> layer22_att_in_gpu1;
layer21_ln1_gpu2 -> layer21_gate0_gpu2;
layer21_gate0_gpu2 -> layer21_expert0_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert0_fc1_gpu2;
layer21_expert0_fc1_gpu2 -> layer21_expert0_fc2_gpu2;
layer21_expert0_fc2_gpu2 -> layer21_expert0_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate1_gpu2;
layer21_gate1_gpu2 -> layer21_expert1_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert1_fc1_gpu2;
layer21_expert1_fc1_gpu2 -> layer21_expert1_fc2_gpu2;
layer21_expert1_fc2_gpu2 -> layer21_expert1_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate2_gpu2;
layer21_gate2_gpu2 -> layer21_expert2_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert2_fc1_gpu2;
layer21_expert2_fc1_gpu2 -> layer21_expert2_fc2_gpu2;
layer21_expert2_fc2_gpu2 -> layer21_expert2_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate3_gpu2;
layer21_gate3_gpu2 -> layer21_expert3_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert3_fc1_gpu2;
layer21_expert3_fc1_gpu2 -> layer21_expert3_fc2_gpu2;
layer21_expert3_fc2_gpu2 -> layer21_expert3_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate4_gpu2;
layer21_gate4_gpu2 -> layer21_expert4_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert4_fc1_gpu2;
layer21_expert4_fc1_gpu2 -> layer21_expert4_fc2_gpu2;
layer21_expert4_fc2_gpu2 -> layer21_expert4_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate5_gpu2;
layer21_gate5_gpu2 -> layer21_expert5_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert5_fc1_gpu2;
layer21_expert5_fc1_gpu2 -> layer21_expert5_fc2_gpu2;
layer21_expert5_fc2_gpu2 -> layer21_expert5_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate6_gpu2;
layer21_gate6_gpu2 -> layer21_expert6_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert6_fc1_gpu2;
layer21_expert6_fc1_gpu2 -> layer21_expert6_fc2_gpu2;
layer21_expert6_fc2_gpu2 -> layer21_expert6_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate7_gpu2;
layer21_gate7_gpu2 -> layer21_expert7_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert7_fc1_gpu2;
layer21_expert7_fc1_gpu2 -> layer21_expert7_fc2_gpu2;
layer21_expert7_fc2_gpu2 -> layer21_expert7_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate8_gpu2;
layer21_gate8_gpu2 -> layer21_expert8_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert8_fc1_gpu2;
layer21_expert8_fc1_gpu2 -> layer21_expert8_fc2_gpu2;
layer21_expert8_fc2_gpu2 -> layer21_expert8_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate9_gpu2;
layer21_gate9_gpu2 -> layer21_expert9_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert9_fc1_gpu2;
layer21_expert9_fc1_gpu2 -> layer21_expert9_fc2_gpu2;
layer21_expert9_fc2_gpu2 -> layer21_expert9_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate10_gpu2;
layer21_gate10_gpu2 -> layer21_expert10_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert10_fc1_gpu2;
layer21_expert10_fc1_gpu2 -> layer21_expert10_fc2_gpu2;
layer21_expert10_fc2_gpu2 -> layer21_expert10_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate11_gpu2;
layer21_gate11_gpu2 -> layer21_expert11_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert11_fc1_gpu2;
layer21_expert11_fc1_gpu2 -> layer21_expert11_fc2_gpu2;
layer21_expert11_fc2_gpu2 -> layer21_expert11_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate12_gpu2;
layer21_gate12_gpu2 -> layer21_expert12_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert12_fc1_gpu2;
layer21_expert12_fc1_gpu2 -> layer21_expert12_fc2_gpu2;
layer21_expert12_fc2_gpu2 -> layer21_expert12_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate13_gpu2;
layer21_gate13_gpu2 -> layer21_expert13_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert13_fc1_gpu2;
layer21_expert13_fc1_gpu2 -> layer21_expert13_fc2_gpu2;
layer21_expert13_fc2_gpu2 -> layer21_expert13_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate14_gpu2;
layer21_gate14_gpu2 -> layer21_expert14_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert14_fc1_gpu2;
layer21_expert14_fc1_gpu2 -> layer21_expert14_fc2_gpu2;
layer21_expert14_fc2_gpu2 -> layer21_expert14_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate15_gpu2;
layer21_gate15_gpu2 -> layer21_expert15_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert15_fc1_gpu2;
layer21_expert15_fc1_gpu2 -> layer21_expert15_fc2_gpu2;
layer21_expert15_fc2_gpu2 -> layer21_expert15_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate16_gpu2;
layer21_gate16_gpu2 -> layer21_expert16_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert16_fc1_gpu2;
layer21_expert16_fc1_gpu2 -> layer21_expert16_fc2_gpu2;
layer21_expert16_fc2_gpu2 -> layer21_expert16_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate17_gpu2;
layer21_gate17_gpu2 -> layer21_expert17_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert17_fc1_gpu2;
layer21_expert17_fc1_gpu2 -> layer21_expert17_fc2_gpu2;
layer21_expert17_fc2_gpu2 -> layer21_expert17_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate18_gpu2;
layer21_gate18_gpu2 -> layer21_expert18_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert18_fc1_gpu2;
layer21_expert18_fc1_gpu2 -> layer21_expert18_fc2_gpu2;
layer21_expert18_fc2_gpu2 -> layer21_expert18_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate19_gpu2;
layer21_gate19_gpu2 -> layer21_expert19_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert19_fc1_gpu2;
layer21_expert19_fc1_gpu2 -> layer21_expert19_fc2_gpu2;
layer21_expert19_fc2_gpu2 -> layer21_expert19_add_gpu2;
layer21_ln1_gpu2 -> layer21_gate20_gpu2;
layer21_gate20_gpu2 -> layer21_expert20_fc1_gpu2 [style=dashed];
layer21_ln1_gpu2 -> layer21_expert20_fc1_gpu2;
layer21_expert20_fc1_gpu2 -> layer21_expert20_fc2_gpu2;
layer21_expert20_fc2_gpu2 -> layer21_expert20_add_gpu2;
layer21_expert20_add_gpu2 -> layer22_att_in_gpu2;
input -> layer22_att_in_gpu0;
layer22_att_in_gpu0 -> layer22_qkv0_gpu0;
layer22_att_in_gpu0 -> layer22_qkv1_gpu0;
layer22_qkv0_gpu0 -> layer22_attout0_gpu0;
layer22_qkv1_gpu0 -> layer22_attout1_gpu0;
layer22_attout0_gpu0 -> layer22_att_agg_gpu0;
layer22_attout1_gpu0 -> layer22_att_agg_gpu0;
layer22_att_agg_gpu0 -> layer22_res1_gpu0;
layer22_res1_gpu0 -> layer22_ln1_gpu0;
input -> layer22_att_in_gpu1;
layer22_att_in_gpu1 -> layer22_qkv0_gpu1;
layer22_att_in_gpu1 -> layer22_qkv1_gpu1;
layer22_qkv0_gpu1 -> layer22_attout0_gpu1;
layer22_qkv1_gpu1 -> layer22_attout1_gpu1;
layer22_attout0_gpu1 -> layer22_att_agg_gpu1;
layer22_attout1_gpu1 -> layer22_att_agg_gpu1;
layer22_att_agg_gpu1 -> layer22_res1_gpu1;
layer22_res1_gpu1 -> layer22_ln1_gpu1;
input -> layer22_att_in_gpu2;
layer22_att_in_gpu2 -> layer22_qkv0_gpu2;
layer22_att_in_gpu2 -> layer22_qkv1_gpu2;
layer22_qkv0_gpu2 -> layer22_attout0_gpu2;
layer22_qkv1_gpu2 -> layer22_attout1_gpu2;
layer22_attout0_gpu2 -> layer22_att_agg_gpu2;
layer22_attout1_gpu2 -> layer22_att_agg_gpu2;
layer22_att_agg_gpu2 -> layer22_res1_gpu2;
layer22_res1_gpu2 -> layer22_ln1_gpu2;
layer22_ln1_gpu0 -> layer22_gate0_gpu0;
layer22_gate0_gpu0 -> layer22_expert0_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert0_fc1_gpu0;
layer22_expert0_fc1_gpu0 -> layer22_expert0_fc2_gpu0;
layer22_expert0_fc2_gpu0 -> layer22_expert0_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate1_gpu0;
layer22_gate1_gpu0 -> layer22_expert1_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert1_fc1_gpu0;
layer22_expert1_fc1_gpu0 -> layer22_expert1_fc2_gpu0;
layer22_expert1_fc2_gpu0 -> layer22_expert1_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate2_gpu0;
layer22_gate2_gpu0 -> layer22_expert2_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert2_fc1_gpu0;
layer22_expert2_fc1_gpu0 -> layer22_expert2_fc2_gpu0;
layer22_expert2_fc2_gpu0 -> layer22_expert2_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate3_gpu0;
layer22_gate3_gpu0 -> layer22_expert3_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert3_fc1_gpu0;
layer22_expert3_fc1_gpu0 -> layer22_expert3_fc2_gpu0;
layer22_expert3_fc2_gpu0 -> layer22_expert3_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate4_gpu0;
layer22_gate4_gpu0 -> layer22_expert4_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert4_fc1_gpu0;
layer22_expert4_fc1_gpu0 -> layer22_expert4_fc2_gpu0;
layer22_expert4_fc2_gpu0 -> layer22_expert4_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate5_gpu0;
layer22_gate5_gpu0 -> layer22_expert5_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert5_fc1_gpu0;
layer22_expert5_fc1_gpu0 -> layer22_expert5_fc2_gpu0;
layer22_expert5_fc2_gpu0 -> layer22_expert5_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate6_gpu0;
layer22_gate6_gpu0 -> layer22_expert6_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert6_fc1_gpu0;
layer22_expert6_fc1_gpu0 -> layer22_expert6_fc2_gpu0;
layer22_expert6_fc2_gpu0 -> layer22_expert6_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate7_gpu0;
layer22_gate7_gpu0 -> layer22_expert7_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert7_fc1_gpu0;
layer22_expert7_fc1_gpu0 -> layer22_expert7_fc2_gpu0;
layer22_expert7_fc2_gpu0 -> layer22_expert7_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate8_gpu0;
layer22_gate8_gpu0 -> layer22_expert8_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert8_fc1_gpu0;
layer22_expert8_fc1_gpu0 -> layer22_expert8_fc2_gpu0;
layer22_expert8_fc2_gpu0 -> layer22_expert8_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate9_gpu0;
layer22_gate9_gpu0 -> layer22_expert9_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert9_fc1_gpu0;
layer22_expert9_fc1_gpu0 -> layer22_expert9_fc2_gpu0;
layer22_expert9_fc2_gpu0 -> layer22_expert9_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate10_gpu0;
layer22_gate10_gpu0 -> layer22_expert10_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert10_fc1_gpu0;
layer22_expert10_fc1_gpu0 -> layer22_expert10_fc2_gpu0;
layer22_expert10_fc2_gpu0 -> layer22_expert10_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate11_gpu0;
layer22_gate11_gpu0 -> layer22_expert11_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert11_fc1_gpu0;
layer22_expert11_fc1_gpu0 -> layer22_expert11_fc2_gpu0;
layer22_expert11_fc2_gpu0 -> layer22_expert11_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate12_gpu0;
layer22_gate12_gpu0 -> layer22_expert12_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert12_fc1_gpu0;
layer22_expert12_fc1_gpu0 -> layer22_expert12_fc2_gpu0;
layer22_expert12_fc2_gpu0 -> layer22_expert12_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate13_gpu0;
layer22_gate13_gpu0 -> layer22_expert13_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert13_fc1_gpu0;
layer22_expert13_fc1_gpu0 -> layer22_expert13_fc2_gpu0;
layer22_expert13_fc2_gpu0 -> layer22_expert13_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate14_gpu0;
layer22_gate14_gpu0 -> layer22_expert14_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert14_fc1_gpu0;
layer22_expert14_fc1_gpu0 -> layer22_expert14_fc2_gpu0;
layer22_expert14_fc2_gpu0 -> layer22_expert14_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate15_gpu0;
layer22_gate15_gpu0 -> layer22_expert15_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert15_fc1_gpu0;
layer22_expert15_fc1_gpu0 -> layer22_expert15_fc2_gpu0;
layer22_expert15_fc2_gpu0 -> layer22_expert15_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate16_gpu0;
layer22_gate16_gpu0 -> layer22_expert16_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert16_fc1_gpu0;
layer22_expert16_fc1_gpu0 -> layer22_expert16_fc2_gpu0;
layer22_expert16_fc2_gpu0 -> layer22_expert16_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate17_gpu0;
layer22_gate17_gpu0 -> layer22_expert17_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert17_fc1_gpu0;
layer22_expert17_fc1_gpu0 -> layer22_expert17_fc2_gpu0;
layer22_expert17_fc2_gpu0 -> layer22_expert17_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate18_gpu0;
layer22_gate18_gpu0 -> layer22_expert18_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert18_fc1_gpu0;
layer22_expert18_fc1_gpu0 -> layer22_expert18_fc2_gpu0;
layer22_expert18_fc2_gpu0 -> layer22_expert18_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate19_gpu0;
layer22_gate19_gpu0 -> layer22_expert19_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert19_fc1_gpu0;
layer22_expert19_fc1_gpu0 -> layer22_expert19_fc2_gpu0;
layer22_expert19_fc2_gpu0 -> layer22_expert19_add_gpu0;
layer22_ln1_gpu0 -> layer22_gate20_gpu0;
layer22_gate20_gpu0 -> layer22_expert20_fc1_gpu0 [style=dashed];
layer22_ln1_gpu0 -> layer22_expert20_fc1_gpu0;
layer22_expert20_fc1_gpu0 -> layer22_expert20_fc2_gpu0;
layer22_expert20_fc2_gpu0 -> layer22_expert20_add_gpu0;
layer22_expert20_add_gpu0 -> layer23_att_in_gpu0;
layer22_ln1_gpu1 -> layer22_gate0_gpu1;
layer22_gate0_gpu1 -> layer22_expert0_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert0_fc1_gpu1;
layer22_expert0_fc1_gpu1 -> layer22_expert0_fc2_gpu1;
layer22_expert0_fc2_gpu1 -> layer22_expert0_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate1_gpu1;
layer22_gate1_gpu1 -> layer22_expert1_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert1_fc1_gpu1;
layer22_expert1_fc1_gpu1 -> layer22_expert1_fc2_gpu1;
layer22_expert1_fc2_gpu1 -> layer22_expert1_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate2_gpu1;
layer22_gate2_gpu1 -> layer22_expert2_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert2_fc1_gpu1;
layer22_expert2_fc1_gpu1 -> layer22_expert2_fc2_gpu1;
layer22_expert2_fc2_gpu1 -> layer22_expert2_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate3_gpu1;
layer22_gate3_gpu1 -> layer22_expert3_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert3_fc1_gpu1;
layer22_expert3_fc1_gpu1 -> layer22_expert3_fc2_gpu1;
layer22_expert3_fc2_gpu1 -> layer22_expert3_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate4_gpu1;
layer22_gate4_gpu1 -> layer22_expert4_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert4_fc1_gpu1;
layer22_expert4_fc1_gpu1 -> layer22_expert4_fc2_gpu1;
layer22_expert4_fc2_gpu1 -> layer22_expert4_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate5_gpu1;
layer22_gate5_gpu1 -> layer22_expert5_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert5_fc1_gpu1;
layer22_expert5_fc1_gpu1 -> layer22_expert5_fc2_gpu1;
layer22_expert5_fc2_gpu1 -> layer22_expert5_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate6_gpu1;
layer22_gate6_gpu1 -> layer22_expert6_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert6_fc1_gpu1;
layer22_expert6_fc1_gpu1 -> layer22_expert6_fc2_gpu1;
layer22_expert6_fc2_gpu1 -> layer22_expert6_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate7_gpu1;
layer22_gate7_gpu1 -> layer22_expert7_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert7_fc1_gpu1;
layer22_expert7_fc1_gpu1 -> layer22_expert7_fc2_gpu1;
layer22_expert7_fc2_gpu1 -> layer22_expert7_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate8_gpu1;
layer22_gate8_gpu1 -> layer22_expert8_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert8_fc1_gpu1;
layer22_expert8_fc1_gpu1 -> layer22_expert8_fc2_gpu1;
layer22_expert8_fc2_gpu1 -> layer22_expert8_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate9_gpu1;
layer22_gate9_gpu1 -> layer22_expert9_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert9_fc1_gpu1;
layer22_expert9_fc1_gpu1 -> layer22_expert9_fc2_gpu1;
layer22_expert9_fc2_gpu1 -> layer22_expert9_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate10_gpu1;
layer22_gate10_gpu1 -> layer22_expert10_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert10_fc1_gpu1;
layer22_expert10_fc1_gpu1 -> layer22_expert10_fc2_gpu1;
layer22_expert10_fc2_gpu1 -> layer22_expert10_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate11_gpu1;
layer22_gate11_gpu1 -> layer22_expert11_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert11_fc1_gpu1;
layer22_expert11_fc1_gpu1 -> layer22_expert11_fc2_gpu1;
layer22_expert11_fc2_gpu1 -> layer22_expert11_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate12_gpu1;
layer22_gate12_gpu1 -> layer22_expert12_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert12_fc1_gpu1;
layer22_expert12_fc1_gpu1 -> layer22_expert12_fc2_gpu1;
layer22_expert12_fc2_gpu1 -> layer22_expert12_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate13_gpu1;
layer22_gate13_gpu1 -> layer22_expert13_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert13_fc1_gpu1;
layer22_expert13_fc1_gpu1 -> layer22_expert13_fc2_gpu1;
layer22_expert13_fc2_gpu1 -> layer22_expert13_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate14_gpu1;
layer22_gate14_gpu1 -> layer22_expert14_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert14_fc1_gpu1;
layer22_expert14_fc1_gpu1 -> layer22_expert14_fc2_gpu1;
layer22_expert14_fc2_gpu1 -> layer22_expert14_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate15_gpu1;
layer22_gate15_gpu1 -> layer22_expert15_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert15_fc1_gpu1;
layer22_expert15_fc1_gpu1 -> layer22_expert15_fc2_gpu1;
layer22_expert15_fc2_gpu1 -> layer22_expert15_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate16_gpu1;
layer22_gate16_gpu1 -> layer22_expert16_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert16_fc1_gpu1;
layer22_expert16_fc1_gpu1 -> layer22_expert16_fc2_gpu1;
layer22_expert16_fc2_gpu1 -> layer22_expert16_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate17_gpu1;
layer22_gate17_gpu1 -> layer22_expert17_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert17_fc1_gpu1;
layer22_expert17_fc1_gpu1 -> layer22_expert17_fc2_gpu1;
layer22_expert17_fc2_gpu1 -> layer22_expert17_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate18_gpu1;
layer22_gate18_gpu1 -> layer22_expert18_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert18_fc1_gpu1;
layer22_expert18_fc1_gpu1 -> layer22_expert18_fc2_gpu1;
layer22_expert18_fc2_gpu1 -> layer22_expert18_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate19_gpu1;
layer22_gate19_gpu1 -> layer22_expert19_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert19_fc1_gpu1;
layer22_expert19_fc1_gpu1 -> layer22_expert19_fc2_gpu1;
layer22_expert19_fc2_gpu1 -> layer22_expert19_add_gpu1;
layer22_ln1_gpu1 -> layer22_gate20_gpu1;
layer22_gate20_gpu1 -> layer22_expert20_fc1_gpu1 [style=dashed];
layer22_ln1_gpu1 -> layer22_expert20_fc1_gpu1;
layer22_expert20_fc1_gpu1 -> layer22_expert20_fc2_gpu1;
layer22_expert20_fc2_gpu1 -> layer22_expert20_add_gpu1;
layer22_expert20_add_gpu1 -> layer23_att_in_gpu1;
layer22_ln1_gpu2 -> layer22_gate0_gpu2;
layer22_gate0_gpu2 -> layer22_expert0_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert0_fc1_gpu2;
layer22_expert0_fc1_gpu2 -> layer22_expert0_fc2_gpu2;
layer22_expert0_fc2_gpu2 -> layer22_expert0_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate1_gpu2;
layer22_gate1_gpu2 -> layer22_expert1_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert1_fc1_gpu2;
layer22_expert1_fc1_gpu2 -> layer22_expert1_fc2_gpu2;
layer22_expert1_fc2_gpu2 -> layer22_expert1_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate2_gpu2;
layer22_gate2_gpu2 -> layer22_expert2_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert2_fc1_gpu2;
layer22_expert2_fc1_gpu2 -> layer22_expert2_fc2_gpu2;
layer22_expert2_fc2_gpu2 -> layer22_expert2_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate3_gpu2;
layer22_gate3_gpu2 -> layer22_expert3_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert3_fc1_gpu2;
layer22_expert3_fc1_gpu2 -> layer22_expert3_fc2_gpu2;
layer22_expert3_fc2_gpu2 -> layer22_expert3_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate4_gpu2;
layer22_gate4_gpu2 -> layer22_expert4_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert4_fc1_gpu2;
layer22_expert4_fc1_gpu2 -> layer22_expert4_fc2_gpu2;
layer22_expert4_fc2_gpu2 -> layer22_expert4_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate5_gpu2;
layer22_gate5_gpu2 -> layer22_expert5_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert5_fc1_gpu2;
layer22_expert5_fc1_gpu2 -> layer22_expert5_fc2_gpu2;
layer22_expert5_fc2_gpu2 -> layer22_expert5_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate6_gpu2;
layer22_gate6_gpu2 -> layer22_expert6_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert6_fc1_gpu2;
layer22_expert6_fc1_gpu2 -> layer22_expert6_fc2_gpu2;
layer22_expert6_fc2_gpu2 -> layer22_expert6_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate7_gpu2;
layer22_gate7_gpu2 -> layer22_expert7_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert7_fc1_gpu2;
layer22_expert7_fc1_gpu2 -> layer22_expert7_fc2_gpu2;
layer22_expert7_fc2_gpu2 -> layer22_expert7_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate8_gpu2;
layer22_gate8_gpu2 -> layer22_expert8_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert8_fc1_gpu2;
layer22_expert8_fc1_gpu2 -> layer22_expert8_fc2_gpu2;
layer22_expert8_fc2_gpu2 -> layer22_expert8_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate9_gpu2;
layer22_gate9_gpu2 -> layer22_expert9_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert9_fc1_gpu2;
layer22_expert9_fc1_gpu2 -> layer22_expert9_fc2_gpu2;
layer22_expert9_fc2_gpu2 -> layer22_expert9_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate10_gpu2;
layer22_gate10_gpu2 -> layer22_expert10_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert10_fc1_gpu2;
layer22_expert10_fc1_gpu2 -> layer22_expert10_fc2_gpu2;
layer22_expert10_fc2_gpu2 -> layer22_expert10_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate11_gpu2;
layer22_gate11_gpu2 -> layer22_expert11_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert11_fc1_gpu2;
layer22_expert11_fc1_gpu2 -> layer22_expert11_fc2_gpu2;
layer22_expert11_fc2_gpu2 -> layer22_expert11_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate12_gpu2;
layer22_gate12_gpu2 -> layer22_expert12_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert12_fc1_gpu2;
layer22_expert12_fc1_gpu2 -> layer22_expert12_fc2_gpu2;
layer22_expert12_fc2_gpu2 -> layer22_expert12_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate13_gpu2;
layer22_gate13_gpu2 -> layer22_expert13_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert13_fc1_gpu2;
layer22_expert13_fc1_gpu2 -> layer22_expert13_fc2_gpu2;
layer22_expert13_fc2_gpu2 -> layer22_expert13_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate14_gpu2;
layer22_gate14_gpu2 -> layer22_expert14_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert14_fc1_gpu2;
layer22_expert14_fc1_gpu2 -> layer22_expert14_fc2_gpu2;
layer22_expert14_fc2_gpu2 -> layer22_expert14_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate15_gpu2;
layer22_gate15_gpu2 -> layer22_expert15_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert15_fc1_gpu2;
layer22_expert15_fc1_gpu2 -> layer22_expert15_fc2_gpu2;
layer22_expert15_fc2_gpu2 -> layer22_expert15_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate16_gpu2;
layer22_gate16_gpu2 -> layer22_expert16_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert16_fc1_gpu2;
layer22_expert16_fc1_gpu2 -> layer22_expert16_fc2_gpu2;
layer22_expert16_fc2_gpu2 -> layer22_expert16_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate17_gpu2;
layer22_gate17_gpu2 -> layer22_expert17_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert17_fc1_gpu2;
layer22_expert17_fc1_gpu2 -> layer22_expert17_fc2_gpu2;
layer22_expert17_fc2_gpu2 -> layer22_expert17_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate18_gpu2;
layer22_gate18_gpu2 -> layer22_expert18_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert18_fc1_gpu2;
layer22_expert18_fc1_gpu2 -> layer22_expert18_fc2_gpu2;
layer22_expert18_fc2_gpu2 -> layer22_expert18_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate19_gpu2;
layer22_gate19_gpu2 -> layer22_expert19_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert19_fc1_gpu2;
layer22_expert19_fc1_gpu2 -> layer22_expert19_fc2_gpu2;
layer22_expert19_fc2_gpu2 -> layer22_expert19_add_gpu2;
layer22_ln1_gpu2 -> layer22_gate20_gpu2;
layer22_gate20_gpu2 -> layer22_expert20_fc1_gpu2 [style=dashed];
layer22_ln1_gpu2 -> layer22_expert20_fc1_gpu2;
layer22_expert20_fc1_gpu2 -> layer22_expert20_fc2_gpu2;
layer22_expert20_fc2_gpu2 -> layer22_expert20_add_gpu2;
layer22_expert20_add_gpu2 -> layer23_att_in_gpu2;
input -> layer23_att_in_gpu0;
layer23_att_in_gpu0 -> layer23_qkv0_gpu0;
layer23_att_in_gpu0 -> layer23_qkv1_gpu0;
layer23_qkv0_gpu0 -> layer23_attout0_gpu0;
layer23_qkv1_gpu0 -> layer23_attout1_gpu0;
layer23_attout0_gpu0 -> layer23_att_agg_gpu0;
layer23_attout1_gpu0 -> layer23_att_agg_gpu0;
layer23_att_agg_gpu0 -> layer23_res1_gpu0;
layer23_res1_gpu0 -> layer23_ln1_gpu0;
input -> layer23_att_in_gpu1;
layer23_att_in_gpu1 -> layer23_qkv0_gpu1;
layer23_att_in_gpu1 -> layer23_qkv1_gpu1;
layer23_qkv0_gpu1 -> layer23_attout0_gpu1;
layer23_qkv1_gpu1 -> layer23_attout1_gpu1;
layer23_attout0_gpu1 -> layer23_att_agg_gpu1;
layer23_attout1_gpu1 -> layer23_att_agg_gpu1;
layer23_att_agg_gpu1 -> layer23_res1_gpu1;
layer23_res1_gpu1 -> layer23_ln1_gpu1;
input -> layer23_att_in_gpu2;
layer23_att_in_gpu2 -> layer23_qkv0_gpu2;
layer23_att_in_gpu2 -> layer23_qkv1_gpu2;
layer23_qkv0_gpu2 -> layer23_attout0_gpu2;
layer23_qkv1_gpu2 -> layer23_attout1_gpu2;
layer23_attout0_gpu2 -> layer23_att_agg_gpu2;
layer23_attout1_gpu2 -> layer23_att_agg_gpu2;
layer23_att_agg_gpu2 -> layer23_res1_gpu2;
layer23_res1_gpu2 -> layer23_ln1_gpu2;
layer23_ln1_gpu0 -> layer23_gate0_gpu0;
layer23_gate0_gpu0 -> layer23_expert0_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert0_fc1_gpu0;
layer23_expert0_fc1_gpu0 -> layer23_expert0_fc2_gpu0;
layer23_expert0_fc2_gpu0 -> layer23_expert0_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate1_gpu0;
layer23_gate1_gpu0 -> layer23_expert1_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert1_fc1_gpu0;
layer23_expert1_fc1_gpu0 -> layer23_expert1_fc2_gpu0;
layer23_expert1_fc2_gpu0 -> layer23_expert1_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate2_gpu0;
layer23_gate2_gpu0 -> layer23_expert2_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert2_fc1_gpu0;
layer23_expert2_fc1_gpu0 -> layer23_expert2_fc2_gpu0;
layer23_expert2_fc2_gpu0 -> layer23_expert2_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate3_gpu0;
layer23_gate3_gpu0 -> layer23_expert3_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert3_fc1_gpu0;
layer23_expert3_fc1_gpu0 -> layer23_expert3_fc2_gpu0;
layer23_expert3_fc2_gpu0 -> layer23_expert3_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate4_gpu0;
layer23_gate4_gpu0 -> layer23_expert4_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert4_fc1_gpu0;
layer23_expert4_fc1_gpu0 -> layer23_expert4_fc2_gpu0;
layer23_expert4_fc2_gpu0 -> layer23_expert4_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate5_gpu0;
layer23_gate5_gpu0 -> layer23_expert5_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert5_fc1_gpu0;
layer23_expert5_fc1_gpu0 -> layer23_expert5_fc2_gpu0;
layer23_expert5_fc2_gpu0 -> layer23_expert5_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate6_gpu0;
layer23_gate6_gpu0 -> layer23_expert6_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert6_fc1_gpu0;
layer23_expert6_fc1_gpu0 -> layer23_expert6_fc2_gpu0;
layer23_expert6_fc2_gpu0 -> layer23_expert6_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate7_gpu0;
layer23_gate7_gpu0 -> layer23_expert7_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert7_fc1_gpu0;
layer23_expert7_fc1_gpu0 -> layer23_expert7_fc2_gpu0;
layer23_expert7_fc2_gpu0 -> layer23_expert7_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate8_gpu0;
layer23_gate8_gpu0 -> layer23_expert8_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert8_fc1_gpu0;
layer23_expert8_fc1_gpu0 -> layer23_expert8_fc2_gpu0;
layer23_expert8_fc2_gpu0 -> layer23_expert8_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate9_gpu0;
layer23_gate9_gpu0 -> layer23_expert9_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert9_fc1_gpu0;
layer23_expert9_fc1_gpu0 -> layer23_expert9_fc2_gpu0;
layer23_expert9_fc2_gpu0 -> layer23_expert9_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate10_gpu0;
layer23_gate10_gpu0 -> layer23_expert10_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert10_fc1_gpu0;
layer23_expert10_fc1_gpu0 -> layer23_expert10_fc2_gpu0;
layer23_expert10_fc2_gpu0 -> layer23_expert10_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate11_gpu0;
layer23_gate11_gpu0 -> layer23_expert11_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert11_fc1_gpu0;
layer23_expert11_fc1_gpu0 -> layer23_expert11_fc2_gpu0;
layer23_expert11_fc2_gpu0 -> layer23_expert11_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate12_gpu0;
layer23_gate12_gpu0 -> layer23_expert12_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert12_fc1_gpu0;
layer23_expert12_fc1_gpu0 -> layer23_expert12_fc2_gpu0;
layer23_expert12_fc2_gpu0 -> layer23_expert12_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate13_gpu0;
layer23_gate13_gpu0 -> layer23_expert13_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert13_fc1_gpu0;
layer23_expert13_fc1_gpu0 -> layer23_expert13_fc2_gpu0;
layer23_expert13_fc2_gpu0 -> layer23_expert13_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate14_gpu0;
layer23_gate14_gpu0 -> layer23_expert14_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert14_fc1_gpu0;
layer23_expert14_fc1_gpu0 -> layer23_expert14_fc2_gpu0;
layer23_expert14_fc2_gpu0 -> layer23_expert14_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate15_gpu0;
layer23_gate15_gpu0 -> layer23_expert15_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert15_fc1_gpu0;
layer23_expert15_fc1_gpu0 -> layer23_expert15_fc2_gpu0;
layer23_expert15_fc2_gpu0 -> layer23_expert15_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate16_gpu0;
layer23_gate16_gpu0 -> layer23_expert16_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert16_fc1_gpu0;
layer23_expert16_fc1_gpu0 -> layer23_expert16_fc2_gpu0;
layer23_expert16_fc2_gpu0 -> layer23_expert16_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate17_gpu0;
layer23_gate17_gpu0 -> layer23_expert17_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert17_fc1_gpu0;
layer23_expert17_fc1_gpu0 -> layer23_expert17_fc2_gpu0;
layer23_expert17_fc2_gpu0 -> layer23_expert17_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate18_gpu0;
layer23_gate18_gpu0 -> layer23_expert18_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert18_fc1_gpu0;
layer23_expert18_fc1_gpu0 -> layer23_expert18_fc2_gpu0;
layer23_expert18_fc2_gpu0 -> layer23_expert18_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate19_gpu0;
layer23_gate19_gpu0 -> layer23_expert19_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert19_fc1_gpu0;
layer23_expert19_fc1_gpu0 -> layer23_expert19_fc2_gpu0;
layer23_expert19_fc2_gpu0 -> layer23_expert19_add_gpu0;
layer23_ln1_gpu0 -> layer23_gate20_gpu0;
layer23_gate20_gpu0 -> layer23_expert20_fc1_gpu0 [style=dashed];
layer23_ln1_gpu0 -> layer23_expert20_fc1_gpu0;
layer23_expert20_fc1_gpu0 -> layer23_expert20_fc2_gpu0;
layer23_expert20_fc2_gpu0 -> layer23_expert20_add_gpu0;
layer23_expert20_add_gpu0 -> output;
layer23_ln1_gpu1 -> layer23_gate0_gpu1;
layer23_gate0_gpu1 -> layer23_expert0_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert0_fc1_gpu1;
layer23_expert0_fc1_gpu1 -> layer23_expert0_fc2_gpu1;
layer23_expert0_fc2_gpu1 -> layer23_expert0_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate1_gpu1;
layer23_gate1_gpu1 -> layer23_expert1_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert1_fc1_gpu1;
layer23_expert1_fc1_gpu1 -> layer23_expert1_fc2_gpu1;
layer23_expert1_fc2_gpu1 -> layer23_expert1_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate2_gpu1;
layer23_gate2_gpu1 -> layer23_expert2_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert2_fc1_gpu1;
layer23_expert2_fc1_gpu1 -> layer23_expert2_fc2_gpu1;
layer23_expert2_fc2_gpu1 -> layer23_expert2_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate3_gpu1;
layer23_gate3_gpu1 -> layer23_expert3_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert3_fc1_gpu1;
layer23_expert3_fc1_gpu1 -> layer23_expert3_fc2_gpu1;
layer23_expert3_fc2_gpu1 -> layer23_expert3_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate4_gpu1;
layer23_gate4_gpu1 -> layer23_expert4_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert4_fc1_gpu1;
layer23_expert4_fc1_gpu1 -> layer23_expert4_fc2_gpu1;
layer23_expert4_fc2_gpu1 -> layer23_expert4_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate5_gpu1;
layer23_gate5_gpu1 -> layer23_expert5_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert5_fc1_gpu1;
layer23_expert5_fc1_gpu1 -> layer23_expert5_fc2_gpu1;
layer23_expert5_fc2_gpu1 -> layer23_expert5_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate6_gpu1;
layer23_gate6_gpu1 -> layer23_expert6_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert6_fc1_gpu1;
layer23_expert6_fc1_gpu1 -> layer23_expert6_fc2_gpu1;
layer23_expert6_fc2_gpu1 -> layer23_expert6_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate7_gpu1;
layer23_gate7_gpu1 -> layer23_expert7_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert7_fc1_gpu1;
layer23_expert7_fc1_gpu1 -> layer23_expert7_fc2_gpu1;
layer23_expert7_fc2_gpu1 -> layer23_expert7_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate8_gpu1;
layer23_gate8_gpu1 -> layer23_expert8_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert8_fc1_gpu1;
layer23_expert8_fc1_gpu1 -> layer23_expert8_fc2_gpu1;
layer23_expert8_fc2_gpu1 -> layer23_expert8_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate9_gpu1;
layer23_gate9_gpu1 -> layer23_expert9_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert9_fc1_gpu1;
layer23_expert9_fc1_gpu1 -> layer23_expert9_fc2_gpu1;
layer23_expert9_fc2_gpu1 -> layer23_expert9_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate10_gpu1;
layer23_gate10_gpu1 -> layer23_expert10_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert10_fc1_gpu1;
layer23_expert10_fc1_gpu1 -> layer23_expert10_fc2_gpu1;
layer23_expert10_fc2_gpu1 -> layer23_expert10_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate11_gpu1;
layer23_gate11_gpu1 -> layer23_expert11_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert11_fc1_gpu1;
layer23_expert11_fc1_gpu1 -> layer23_expert11_fc2_gpu1;
layer23_expert11_fc2_gpu1 -> layer23_expert11_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate12_gpu1;
layer23_gate12_gpu1 -> layer23_expert12_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert12_fc1_gpu1;
layer23_expert12_fc1_gpu1 -> layer23_expert12_fc2_gpu1;
layer23_expert12_fc2_gpu1 -> layer23_expert12_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate13_gpu1;
layer23_gate13_gpu1 -> layer23_expert13_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert13_fc1_gpu1;
layer23_expert13_fc1_gpu1 -> layer23_expert13_fc2_gpu1;
layer23_expert13_fc2_gpu1 -> layer23_expert13_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate14_gpu1;
layer23_gate14_gpu1 -> layer23_expert14_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert14_fc1_gpu1;
layer23_expert14_fc1_gpu1 -> layer23_expert14_fc2_gpu1;
layer23_expert14_fc2_gpu1 -> layer23_expert14_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate15_gpu1;
layer23_gate15_gpu1 -> layer23_expert15_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert15_fc1_gpu1;
layer23_expert15_fc1_gpu1 -> layer23_expert15_fc2_gpu1;
layer23_expert15_fc2_gpu1 -> layer23_expert15_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate16_gpu1;
layer23_gate16_gpu1 -> layer23_expert16_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert16_fc1_gpu1;
layer23_expert16_fc1_gpu1 -> layer23_expert16_fc2_gpu1;
layer23_expert16_fc2_gpu1 -> layer23_expert16_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate17_gpu1;
layer23_gate17_gpu1 -> layer23_expert17_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert17_fc1_gpu1;
layer23_expert17_fc1_gpu1 -> layer23_expert17_fc2_gpu1;
layer23_expert17_fc2_gpu1 -> layer23_expert17_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate18_gpu1;
layer23_gate18_gpu1 -> layer23_expert18_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert18_fc1_gpu1;
layer23_expert18_fc1_gpu1 -> layer23_expert18_fc2_gpu1;
layer23_expert18_fc2_gpu1 -> layer23_expert18_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate19_gpu1;
layer23_gate19_gpu1 -> layer23_expert19_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert19_fc1_gpu1;
layer23_expert19_fc1_gpu1 -> layer23_expert19_fc2_gpu1;
layer23_expert19_fc2_gpu1 -> layer23_expert19_add_gpu1;
layer23_ln1_gpu1 -> layer23_gate20_gpu1;
layer23_gate20_gpu1 -> layer23_expert20_fc1_gpu1 [style=dashed];
layer23_ln1_gpu1 -> layer23_expert20_fc1_gpu1;
layer23_expert20_fc1_gpu1 -> layer23_expert20_fc2_gpu1;
layer23_expert20_fc2_gpu1 -> layer23_expert20_add_gpu1;
layer23_expert20_add_gpu1 -> output;
layer23_ln1_gpu2 -> layer23_gate0_gpu2;
layer23_gate0_gpu2 -> layer23_expert0_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert0_fc1_gpu2;
layer23_expert0_fc1_gpu2 -> layer23_expert0_fc2_gpu2;
layer23_expert0_fc2_gpu2 -> layer23_expert0_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate1_gpu2;
layer23_gate1_gpu2 -> layer23_expert1_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert1_fc1_gpu2;
layer23_expert1_fc1_gpu2 -> layer23_expert1_fc2_gpu2;
layer23_expert1_fc2_gpu2 -> layer23_expert1_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate2_gpu2;
layer23_gate2_gpu2 -> layer23_expert2_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert2_fc1_gpu2;
layer23_expert2_fc1_gpu2 -> layer23_expert2_fc2_gpu2;
layer23_expert2_fc2_gpu2 -> layer23_expert2_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate3_gpu2;
layer23_gate3_gpu2 -> layer23_expert3_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert3_fc1_gpu2;
layer23_expert3_fc1_gpu2 -> layer23_expert3_fc2_gpu2;
layer23_expert3_fc2_gpu2 -> layer23_expert3_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate4_gpu2;
layer23_gate4_gpu2 -> layer23_expert4_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert4_fc1_gpu2;
layer23_expert4_fc1_gpu2 -> layer23_expert4_fc2_gpu2;
layer23_expert4_fc2_gpu2 -> layer23_expert4_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate5_gpu2;
layer23_gate5_gpu2 -> layer23_expert5_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert5_fc1_gpu2;
layer23_expert5_fc1_gpu2 -> layer23_expert5_fc2_gpu2;
layer23_expert5_fc2_gpu2 -> layer23_expert5_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate6_gpu2;
layer23_gate6_gpu2 -> layer23_expert6_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert6_fc1_gpu2;
layer23_expert6_fc1_gpu2 -> layer23_expert6_fc2_gpu2;
layer23_expert6_fc2_gpu2 -> layer23_expert6_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate7_gpu2;
layer23_gate7_gpu2 -> layer23_expert7_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert7_fc1_gpu2;
layer23_expert7_fc1_gpu2 -> layer23_expert7_fc2_gpu2;
layer23_expert7_fc2_gpu2 -> layer23_expert7_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate8_gpu2;
layer23_gate8_gpu2 -> layer23_expert8_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert8_fc1_gpu2;
layer23_expert8_fc1_gpu2 -> layer23_expert8_fc2_gpu2;
layer23_expert8_fc2_gpu2 -> layer23_expert8_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate9_gpu2;
layer23_gate9_gpu2 -> layer23_expert9_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert9_fc1_gpu2;
layer23_expert9_fc1_gpu2 -> layer23_expert9_fc2_gpu2;
layer23_expert9_fc2_gpu2 -> layer23_expert9_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate10_gpu2;
layer23_gate10_gpu2 -> layer23_expert10_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert10_fc1_gpu2;
layer23_expert10_fc1_gpu2 -> layer23_expert10_fc2_gpu2;
layer23_expert10_fc2_gpu2 -> layer23_expert10_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate11_gpu2;
layer23_gate11_gpu2 -> layer23_expert11_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert11_fc1_gpu2;
layer23_expert11_fc1_gpu2 -> layer23_expert11_fc2_gpu2;
layer23_expert11_fc2_gpu2 -> layer23_expert11_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate12_gpu2;
layer23_gate12_gpu2 -> layer23_expert12_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert12_fc1_gpu2;
layer23_expert12_fc1_gpu2 -> layer23_expert12_fc2_gpu2;
layer23_expert12_fc2_gpu2 -> layer23_expert12_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate13_gpu2;
layer23_gate13_gpu2 -> layer23_expert13_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert13_fc1_gpu2;
layer23_expert13_fc1_gpu2 -> layer23_expert13_fc2_gpu2;
layer23_expert13_fc2_gpu2 -> layer23_expert13_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate14_gpu2;
layer23_gate14_gpu2 -> layer23_expert14_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert14_fc1_gpu2;
layer23_expert14_fc1_gpu2 -> layer23_expert14_fc2_gpu2;
layer23_expert14_fc2_gpu2 -> layer23_expert14_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate15_gpu2;
layer23_gate15_gpu2 -> layer23_expert15_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert15_fc1_gpu2;
layer23_expert15_fc1_gpu2 -> layer23_expert15_fc2_gpu2;
layer23_expert15_fc2_gpu2 -> layer23_expert15_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate16_gpu2;
layer23_gate16_gpu2 -> layer23_expert16_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert16_fc1_gpu2;
layer23_expert16_fc1_gpu2 -> layer23_expert16_fc2_gpu2;
layer23_expert16_fc2_gpu2 -> layer23_expert16_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate17_gpu2;
layer23_gate17_gpu2 -> layer23_expert17_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert17_fc1_gpu2;
layer23_expert17_fc1_gpu2 -> layer23_expert17_fc2_gpu2;
layer23_expert17_fc2_gpu2 -> layer23_expert17_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate18_gpu2;
layer23_gate18_gpu2 -> layer23_expert18_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert18_fc1_gpu2;
layer23_expert18_fc1_gpu2 -> layer23_expert18_fc2_gpu2;
layer23_expert18_fc2_gpu2 -> layer23_expert18_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate19_gpu2;
layer23_gate19_gpu2 -> layer23_expert19_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert19_fc1_gpu2;
layer23_expert19_fc1_gpu2 -> layer23_expert19_fc2_gpu2;
layer23_expert19_fc2_gpu2 -> layer23_expert19_add_gpu2;
layer23_ln1_gpu2 -> layer23_gate20_gpu2;
layer23_gate20_gpu2 -> layer23_expert20_fc1_gpu2 [style=dashed];
layer23_ln1_gpu2 -> layer23_expert20_fc1_gpu2;
layer23_expert20_fc1_gpu2 -> layer23_expert20_fc2_gpu2;
layer23_expert20_fc2_gpu2 -> layer23_expert20_add_gpu2;
layer23_expert20_add_gpu2 -> output;
}