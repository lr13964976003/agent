<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2405pt" height="13500pt"
 viewBox="0.00 0.00 577.15 3240.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(3.33 3.33) rotate(0) translate(4 4049.16)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4049.16 718,-4049.16 718,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu0</title>
<path fill="lightgray" stroke="black" d="M35,-2904.62C35,-2904.62 627,-2904.62 627,-2904.62 633,-2904.62 639,-2910.62 639,-2916.62 639,-2916.62 639,-3932.62 639,-3932.62 639,-3938.62 633,-3944.62 627,-3944.62 627,-3944.62 35,-3944.62 35,-3944.62 29,-3944.62 23,-3938.62 23,-3932.62 23,-3932.62 23,-2916.62 23,-2916.62 23,-2910.62 29,-2904.62 35,-2904.62"/>
<text text-anchor="middle" x="331" y="-3929.42" font-family="Times,serif" font-size="14.00">GPU 0: Layers 0&#45;1 (Start)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu4</title>
<path fill="lightgray" stroke="black" d="M40,-1422.08C40,-1422.08 694,-1422.08 694,-1422.08 700,-1422.08 706,-1428.08 706,-1434.08 706,-1434.08 706,-2754.08 706,-2754.08 706,-2760.08 700,-2766.08 694,-2766.08 694,-2766.08 40,-2766.08 40,-2766.08 34,-2766.08 28,-2760.08 28,-2754.08 28,-2754.08 28,-1434.08 28,-1434.08 28,-1428.08 34,-1422.08 40,-1422.08"/>
<text text-anchor="middle" x="367" y="-2750.88" font-family="Times,serif" font-size="14.00">GPU 4: Layers 8&#45;9 (Middle &#45; Expert Parallelism Demo)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu7</title>
<path fill="lightgray" stroke="black" d="M20,-102.54C20,-102.54 674,-102.54 674,-102.54 680,-102.54 686,-108.54 686,-114.54 686,-114.54 686,-1271.54 686,-1271.54 686,-1277.54 680,-1283.54 674,-1283.54 674,-1283.54 20,-1283.54 20,-1283.54 14,-1283.54 8,-1277.54 8,-1271.54 8,-1271.54 8,-114.54 8,-114.54 8,-108.54 14,-102.54 20,-102.54"/>
<text text-anchor="middle" x="347" y="-1268.34" font-family="Times,serif" font-size="14.00">GPU 7: Layers 14&#45;15 (End)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightcyan" stroke="black" cx="370" cy="-4008.39" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="370" y="-4022.39" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="370" y="-4011.39" font-family="Arial" font-size="10.00">GPU: Host</text>
<text text-anchor="middle" x="370" y="-4000.39" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="370" y="-3989.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_layernorm0 -->
<g id="node2" class="node">
<title>gpu0_layernorm0</title>
<polygon fill="lightblue" stroke="black" points="422.5,-3913.62 133.5,-3913.62 133.5,-3861.62 422.5,-3861.62 422.5,-3913.62"/>
<text text-anchor="middle" x="278" y="-3901.62" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="278" y="-3890.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="278" y="-3879.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="278" y="-3868.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- input&#45;&gt;gpu0_layernorm0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;gpu0_layernorm0</title>
<path fill="none" stroke="black" d="M342.4,-3971.75C330.16,-3955.96 315.84,-3937.47 303.82,-3921.95"/>
<polygon fill="black" stroke="black" points="306.3,-3919.43 297.41,-3913.67 300.76,-3923.72 306.3,-3919.43"/>
</g>
<!-- gpu0_residual0 -->
<g id="node6" class="node">
<title>gpu0_residual0</title>
<polygon fill="lightyellow" stroke="black" points="630.74,-3557.62 153.92,-3557.62 31.26,-3431.62 508.08,-3431.62 630.74,-3557.62"/>
<text text-anchor="middle" x="331" y="-3514.12" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="331" y="-3503.12" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="331" y="-3492.12" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="331" y="-3481.12" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="331" y="-3470.12" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- input&#45;&gt;gpu0_residual0 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;gpu0_residual0</title>
<path fill="none" stroke="black" d="M417.32,-3972.39C440.29,-3951.14 463,-3921.75 463,-3888.62 463,-3888.62 463,-3888.62 463,-3619.62 463,-3599.27 454.56,-3581.28 441.96,-3565.77"/>
<polygon fill="black" stroke="black" points="444.24,-3563.07 435.01,-3557.88 438.99,-3567.7 444.24,-3563.07"/>
</g>
<!-- gpu0_mha_qkv -->
<g id="node3" class="node">
<title>gpu0_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="434.5,-3824.62 93.5,-3824.62 93.5,-3772.62 434.5,-3772.62 434.5,-3824.62"/>
<text text-anchor="middle" x="264" y="-3812.62" font-family="Arial" font-size="10.00">MHA Q/K/V Proj</text>
<text text-anchor="middle" x="264" y="-3801.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="264" y="-3790.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="264" y="-3779.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu0_layernorm0&#45;&gt;gpu0_mha_qkv -->
<g id="edge2" class="edge">
<title>gpu0_layernorm0&#45;&gt;gpu0_mha_qkv</title>
<path fill="none" stroke="black" d="M273.95,-3861.45C272.62,-3853.16 271.11,-3843.77 269.67,-3834.87"/>
<polygon fill="black" stroke="black" points="273.08,-3834.04 268.04,-3824.72 266.17,-3835.15 273.08,-3834.04"/>
</g>
<!-- gpu0_mha_attention -->
<g id="node4" class="node">
<title>gpu0_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="434.5,-3735.62 93.5,-3735.62 93.5,-3683.62 434.5,-3683.62 434.5,-3735.62"/>
<text text-anchor="middle" x="264" y="-3723.62" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="264" y="-3712.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="264" y="-3701.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="264" y="-3690.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu0_mha_qkv&#45;&gt;gpu0_mha_attention -->
<g id="edge3" class="edge">
<title>gpu0_mha_qkv&#45;&gt;gpu0_mha_attention</title>
<path fill="none" stroke="black" d="M264,-3772.45C264,-3764.16 264,-3754.77 264,-3745.87"/>
<polygon fill="black" stroke="black" points="267.5,-3745.72 264,-3735.72 260.5,-3745.72 267.5,-3745.72"/>
</g>
<!-- gpu0_mha_out -->
<g id="node5" class="node">
<title>gpu0_mha_out</title>
<polygon fill="lightblue" stroke="black" points="433,-3646.62 99,-3646.62 99,-3594.62 433,-3594.62 433,-3646.62"/>
<text text-anchor="middle" x="266" y="-3634.62" font-family="Arial" font-size="10.00">MHA Out Proj</text>
<text text-anchor="middle" x="266" y="-3623.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="266" y="-3612.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="266" y="-3601.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_mha_attention&#45;&gt;gpu0_mha_out -->
<g id="edge4" class="edge">
<title>gpu0_mha_attention&#45;&gt;gpu0_mha_out</title>
<path fill="none" stroke="black" d="M264.58,-3683.45C264.77,-3675.16 264.98,-3665.77 265.19,-3656.87"/>
<polygon fill="black" stroke="black" points="268.69,-3656.8 265.42,-3646.72 261.69,-3656.64 268.69,-3656.8"/>
</g>
<!-- gpu0_mha_out&#45;&gt;gpu0_residual0 -->
<g id="edge5" class="edge">
<title>gpu0_mha_out&#45;&gt;gpu0_residual0</title>
<path fill="none" stroke="black" d="M279.15,-3594.52C283.44,-3586.34 288.44,-3576.81 293.6,-3566.96"/>
<polygon fill="black" stroke="black" points="296.83,-3568.33 298.38,-3557.85 290.63,-3565.08 296.83,-3568.33"/>
</g>
<!-- gpu0_layernorm1 -->
<g id="node7" class="node">
<title>gpu0_layernorm1</title>
<polygon fill="lightblue" stroke="black" points="408.5,-3394.62 119.5,-3394.62 119.5,-3342.62 408.5,-3342.62 408.5,-3394.62"/>
<text text-anchor="middle" x="264" y="-3382.62" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="264" y="-3371.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="264" y="-3360.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="264" y="-3349.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_residual0&#45;&gt;gpu0_layernorm1 -->
<g id="edge7" class="edge">
<title>gpu0_residual0&#45;&gt;gpu0_layernorm1</title>
<path fill="none" stroke="black" d="M297.5,-3431.62C292.31,-3422.01 287.12,-3412.41 282.43,-3403.73"/>
<polygon fill="black" stroke="black" points="285.39,-3401.84 277.56,-3394.71 279.23,-3405.17 285.39,-3401.84"/>
</g>
<!-- gpu0_residual1 -->
<g id="node11" class="node">
<title>gpu0_residual1</title>
<polygon fill="lightyellow" stroke="black" points="630.74,-3038.62 153.92,-3038.62 31.26,-2912.62 508.08,-2912.62 630.74,-3038.62"/>
<text text-anchor="middle" x="331" y="-2995.12" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="331" y="-2984.12" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="331" y="-2973.12" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="331" y="-2962.12" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="331" y="-2951.12" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_residual0&#45;&gt;gpu0_residual1 -->
<g id="edge12" class="edge">
<title>gpu0_residual0&#45;&gt;gpu0_residual1</title>
<path fill="none" stroke="black" d="M405.53,-3431.59C419.59,-3413.55 430,-3392.48 430,-3369.62 430,-3369.62 430,-3369.62 430,-3100.62 430,-3081.15 422.45,-3062.98 411.53,-3046.87"/>
<polygon fill="black" stroke="black" points="414.25,-3044.66 405.53,-3038.64 408.59,-3048.78 414.25,-3044.66"/>
</g>
<!-- gpu0_ffn_gate -->
<g id="node8" class="node">
<title>gpu0_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="411,-3305.62 101,-3305.62 101,-3253.62 411,-3253.62 411,-3305.62"/>
<text text-anchor="middle" x="256" y="-3293.62" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="256" y="-3282.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="256" y="-3271.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="256" y="-3260.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu0_layernorm1&#45;&gt;gpu0_ffn_gate -->
<g id="edge8" class="edge">
<title>gpu0_layernorm1&#45;&gt;gpu0_ffn_gate</title>
<path fill="none" stroke="black" d="M261.69,-3342.45C260.92,-3334.16 260.06,-3324.77 259.24,-3315.87"/>
<polygon fill="black" stroke="black" points="262.71,-3315.36 258.31,-3305.72 255.74,-3316 262.71,-3315.36"/>
</g>
<!-- gpu0_ffn_experts -->
<g id="node9" class="node">
<title>gpu0_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="411,-3216.62 101,-3216.62 101,-3164.62 411,-3164.62 411,-3216.62"/>
<text text-anchor="middle" x="256" y="-3204.62" font-family="Arial" font-size="10.00">FFN Experts (Simple)</text>
<text text-anchor="middle" x="256" y="-3193.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="256" y="-3182.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="256" y="-3171.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu0_ffn_gate&#45;&gt;gpu0_ffn_experts -->
<g id="edge9" class="edge">
<title>gpu0_ffn_gate&#45;&gt;gpu0_ffn_experts</title>
<path fill="none" stroke="black" d="M256,-3253.45C256,-3245.16 256,-3235.77 256,-3226.87"/>
<polygon fill="black" stroke="black" points="259.5,-3226.72 256,-3216.72 252.5,-3226.72 259.5,-3226.72"/>
</g>
<!-- gpu0_ffn_out -->
<g id="node10" class="node">
<title>gpu0_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="409,-3127.62 107,-3127.62 107,-3075.62 409,-3075.62 409,-3127.62"/>
<text text-anchor="middle" x="258" y="-3115.62" font-family="Arial" font-size="10.00">FFN Out Proj</text>
<text text-anchor="middle" x="258" y="-3104.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="258" y="-3093.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="258" y="-3082.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_ffn_experts&#45;&gt;gpu0_ffn_out -->
<g id="edge10" class="edge">
<title>gpu0_ffn_experts&#45;&gt;gpu0_ffn_out</title>
<path fill="none" stroke="black" d="M256.58,-3164.45C256.77,-3156.16 256.98,-3146.77 257.19,-3137.87"/>
<polygon fill="black" stroke="black" points="260.69,-3137.8 257.42,-3127.72 253.69,-3137.64 260.69,-3137.8"/>
</g>
<!-- gpu0_ffn_out&#45;&gt;gpu0_residual1 -->
<g id="edge11" class="edge">
<title>gpu0_ffn_out&#45;&gt;gpu0_residual1</title>
<path fill="none" stroke="black" d="M272.77,-3075.52C277.64,-3067.26 283.31,-3057.62 289.18,-3047.66"/>
<polygon fill="black" stroke="black" points="292.3,-3049.25 294.36,-3038.85 286.27,-3045.69 292.3,-3049.25"/>
</g>
<!-- comm_gpu0_gpu1 -->
<g id="node12" class="node">
<title>comm_gpu0_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="331" cy="-2838.85" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="331" y="-2852.85" font-family="Arial" font-size="10.00">Inter&#45;GPU Comm</text>
<text text-anchor="middle" x="331" y="-2841.85" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="331" y="-2830.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="331" y="-2819.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_residual1&#45;&gt;comm_gpu0_gpu1 -->
<g id="edge13" class="edge">
<title>gpu0_residual1&#45;&gt;comm_gpu0_gpu1</title>
<path fill="none" stroke="black" d="M331,-2912.36C331,-2903.44 331,-2894.39 331,-2885.86"/>
<polygon fill="black" stroke="black" points="334.5,-2885.74 331,-2875.74 327.5,-2885.74 334.5,-2885.74"/>
</g>
<!-- gpu4_layernorm8 -->
<g id="node13" class="node">
<title>gpu4_layernorm8</title>
<polygon fill="lightblue" stroke="black" points="475.5,-2735.08 186.5,-2735.08 186.5,-2683.08 475.5,-2683.08 475.5,-2735.08"/>
<text text-anchor="middle" x="331" y="-2723.08" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="331" y="-2712.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="331" y="-2701.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="331" y="-2690.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu0_gpu1&#45;&gt;gpu4_layernorm8 -->
<g id="edge14" class="edge">
<title>comm_gpu0_gpu1&#45;&gt;gpu4_layernorm8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M331,-2801.92C331,-2784.31 331,-2763.18 331,-2745.63"/>
<polygon fill="black" stroke="black" points="334.5,-2745.23 331,-2735.23 327.5,-2745.23 334.5,-2745.23"/>
<text text-anchor="middle" x="377" y="-2776.88" font-family="Arial" font-size="9.00">... through GPUs 1&#45;3 ...</text>
</g>
<!-- gpu4_mha_qkv -->
<g id="node14" class="node">
<title>gpu4_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="377.5,-2646.08 36.5,-2646.08 36.5,-2594.08 377.5,-2594.08 377.5,-2646.08"/>
<text text-anchor="middle" x="207" y="-2634.08" font-family="Arial" font-size="10.00">MHA Q/K/V Proj</text>
<text text-anchor="middle" x="207" y="-2623.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="207" y="-2612.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="207" y="-2601.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu4_layernorm8&#45;&gt;gpu4_mha_qkv -->
<g id="edge15" class="edge">
<title>gpu4_layernorm8&#45;&gt;gpu4_mha_qkv</title>
<path fill="none" stroke="black" d="M295.13,-2682.91C281.38,-2673.27 265.53,-2662.14 251.09,-2652.02"/>
<polygon fill="black" stroke="black" points="252.98,-2649.06 242.79,-2646.19 248.96,-2654.79 252.98,-2649.06"/>
</g>
<!-- gpu4_residual8 -->
<g id="node17" class="node">
<title>gpu4_residual8</title>
<polygon fill="lightyellow" stroke="black" points="695.74,-2379.08 218.92,-2379.08 96.26,-2253.08 573.08,-2253.08 695.74,-2379.08"/>
<text text-anchor="middle" x="396" y="-2335.58" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="396" y="-2324.58" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="396" y="-2313.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="396" y="-2302.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="396" y="-2291.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_layernorm8&#45;&gt;gpu4_residual8 -->
<g id="edge19" class="edge">
<title>gpu4_layernorm8&#45;&gt;gpu4_residual8</title>
<path fill="none" stroke="black" d="M364,-2682.78C380.5,-2667.1 397,-2645.35 397,-2621.08 397,-2621.08 397,-2621.08 397,-2441.08 397,-2424.41 396.91,-2406.48 396.78,-2389.58"/>
<polygon fill="black" stroke="black" points="400.28,-2389.18 396.7,-2379.21 393.28,-2389.23 400.28,-2389.18"/>
</g>
<!-- gpu4_mha_attention -->
<g id="node15" class="node">
<title>gpu4_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="377.5,-2557.08 36.5,-2557.08 36.5,-2505.08 377.5,-2505.08 377.5,-2557.08"/>
<text text-anchor="middle" x="207" y="-2545.08" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="207" y="-2534.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="207" y="-2523.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="207" y="-2512.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu4_mha_qkv&#45;&gt;gpu4_mha_attention -->
<g id="edge16" class="edge">
<title>gpu4_mha_qkv&#45;&gt;gpu4_mha_attention</title>
<path fill="none" stroke="black" d="M207,-2593.91C207,-2585.62 207,-2576.23 207,-2567.33"/>
<polygon fill="black" stroke="black" points="210.5,-2567.19 207,-2557.19 203.5,-2567.19 210.5,-2567.19"/>
</g>
<!-- gpu4_mha_out -->
<g id="node16" class="node">
<title>gpu4_mha_out</title>
<polygon fill="lightblue" stroke="black" points="376,-2468.08 42,-2468.08 42,-2416.08 376,-2416.08 376,-2468.08"/>
<text text-anchor="middle" x="209" y="-2456.08" font-family="Arial" font-size="10.00">MHA Out Proj</text>
<text text-anchor="middle" x="209" y="-2445.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="209" y="-2434.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="209" y="-2423.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_mha_attention&#45;&gt;gpu4_mha_out -->
<g id="edge17" class="edge">
<title>gpu4_mha_attention&#45;&gt;gpu4_mha_out</title>
<path fill="none" stroke="black" d="M207.58,-2504.91C207.77,-2496.62 207.98,-2487.23 208.19,-2478.33"/>
<polygon fill="black" stroke="black" points="211.69,-2478.26 208.42,-2468.19 204.69,-2478.1 211.69,-2478.26"/>
</g>
<!-- gpu4_mha_out&#45;&gt;gpu4_residual8 -->
<g id="edge18" class="edge">
<title>gpu4_mha_out&#45;&gt;gpu4_residual8</title>
<path fill="none" stroke="black" d="M246.84,-2415.98C260.57,-2406.89 276.8,-2396.12 293.43,-2385.09"/>
<polygon fill="black" stroke="black" points="295.74,-2387.76 302.14,-2379.31 291.88,-2381.92 295.74,-2387.76"/>
</g>
<!-- gpu4_layernorm9 -->
<g id="node18" class="node">
<title>gpu4_layernorm9</title>
<polygon fill="lightblue" stroke="black" points="537.5,-2216.08 248.5,-2216.08 248.5,-2164.08 537.5,-2164.08 537.5,-2216.08"/>
<text text-anchor="middle" x="393" y="-2204.08" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="393" y="-2193.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="393" y="-2182.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="393" y="-2171.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_residual8&#45;&gt;gpu4_layernorm9 -->
<g id="edge20" class="edge">
<title>gpu4_residual8&#45;&gt;gpu4_layernorm9</title>
<path fill="none" stroke="black" d="M394.5,-2253.08C394.28,-2243.88 394.06,-2234.69 393.85,-2226.3"/>
<polygon fill="black" stroke="black" points="397.35,-2226.08 393.61,-2216.17 390.35,-2226.25 397.35,-2226.08"/>
</g>
<!-- gpu4_residual9 -->
<g id="node25" class="node">
<title>gpu4_residual9</title>
<polygon fill="lightyellow" stroke="black" points="677.74,-1556.08 200.92,-1556.08 78.26,-1430.08 555.08,-1430.08 677.74,-1556.08"/>
<text text-anchor="middle" x="378" y="-1512.58" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="378" y="-1501.58" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="378" y="-1490.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="378" y="-1479.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="378" y="-1468.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_residual8&#45;&gt;gpu4_residual9 -->
<g id="edge29" class="edge">
<title>gpu4_residual8&#45;&gt;gpu4_residual9</title>
<path fill="none" stroke="black" d="M587.05,-2267.37C646.6,-2246.82 697,-2220.68 697,-2191.08 697,-2191.08 697,-2191.08 697,-1618.08 697,-1596.28 670.8,-1576.79 633.41,-1560.08"/>
<polygon fill="black" stroke="black" points="634.78,-1556.86 624.21,-1556.11 632.01,-1563.29 634.78,-1556.86"/>
</g>
<!-- gpu4_ffn_gate -->
<g id="node19" class="node">
<title>gpu4_ffn_gate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="527,-2127.08 217,-2127.08 217,-2075.08 527,-2075.08 527,-2127.08"/>
<text text-anchor="middle" x="372" y="-2115.08" font-family="Arial" font-size="10.00">FFN Gate (Expert Selection)</text>
<text text-anchor="middle" x="372" y="-2104.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="372" y="-2093.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="372" y="-2082.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu4_layernorm9&#45;&gt;gpu4_ffn_gate -->
<g id="edge21" class="edge">
<title>gpu4_layernorm9&#45;&gt;gpu4_ffn_gate</title>
<path fill="none" stroke="black" d="M386.93,-2163.91C384.9,-2155.53 382.61,-2146.03 380.44,-2137.04"/>
<polygon fill="black" stroke="black" points="383.81,-2136.09 378.06,-2127.19 377,-2137.73 383.81,-2136.09"/>
</g>
<!-- gpu4_split_tokens -->
<g id="node20" class="node">
<title>gpu4_split_tokens</title>
<polygon fill="lightyellow" stroke="black" points="678.42,-2038.08 175.07,-2038.08 45.58,-1934.08 548.93,-1934.08 678.42,-2038.08"/>
<text text-anchor="middle" x="362" y="-2000.08" font-family="Arial" font-size="10.00">Split Tokens by Expert</text>
<text text-anchor="middle" x="362" y="-1989.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="362" y="-1978.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="362" y="-1967.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu4_ffn_gate&#45;&gt;gpu4_split_tokens -->
<g id="edge22" class="edge">
<title>gpu4_ffn_gate&#45;&gt;gpu4_split_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M369.78,-2075C369.08,-2067.07 368.27,-2057.94 367.45,-2048.62"/>
<polygon fill="black" stroke="black" points="370.92,-2048.13 366.55,-2038.48 363.94,-2048.75 370.92,-2048.13"/>
</g>
<!-- gpu4_expert0 -->
<g id="node21" class="node">
<title>gpu4_expert0</title>
<polygon fill="lightblue" stroke="black" points="347.5,-1897.08 42.5,-1897.08 42.5,-1845.08 347.5,-1845.08 347.5,-1897.08"/>
<text text-anchor="middle" x="195" y="-1885.08" font-family="Arial" font-size="10.00">Expert 0 Processing</text>
<text text-anchor="middle" x="195" y="-1874.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="195" y="-1863.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="195" y="-1852.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu4_split_tokens&#45;&gt;gpu4_expert0 -->
<g id="edge23" class="edge">
<title>gpu4_split_tokens&#45;&gt;gpu4_expert0</title>
<path fill="none" stroke="black" d="M286.32,-1933.87C270.74,-1923.33 254.79,-1912.54 240.67,-1902.98"/>
<polygon fill="black" stroke="black" points="242.38,-1899.91 232.14,-1897.21 238.46,-1905.71 242.38,-1899.91"/>
</g>
<!-- gpu4_expert1 -->
<g id="node22" class="node">
<title>gpu4_expert1</title>
<polygon fill="lightblue" stroke="black" points="670.5,-1897.08 365.5,-1897.08 365.5,-1845.08 670.5,-1845.08 670.5,-1897.08"/>
<text text-anchor="middle" x="518" y="-1885.08" font-family="Arial" font-size="10.00">Expert 1 Processing</text>
<text text-anchor="middle" x="518" y="-1874.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="518" y="-1863.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="518" y="-1852.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu4_split_tokens&#45;&gt;gpu4_expert1 -->
<g id="edge24" class="edge">
<title>gpu4_split_tokens&#45;&gt;gpu4_expert1</title>
<path fill="none" stroke="black" d="M432.7,-1933.87C447.11,-1923.43 461.87,-1912.74 474.96,-1903.25"/>
<polygon fill="black" stroke="black" points="477.26,-1905.91 483.31,-1897.21 473.15,-1900.24 477.26,-1905.91"/>
</g>
<!-- gpu4_aggregate_experts -->
<g id="node23" class="node">
<title>gpu4_aggregate_experts</title>
<polygon fill="lightyellow" stroke="black" points="678.29,-1808.08 167.19,-1808.08 35.71,-1682.08 546.81,-1682.08 678.29,-1808.08"/>
<text text-anchor="middle" x="357" y="-1764.58" font-family="Arial" font-size="10.00">Aggregate Expert Outputs</text>
<text text-anchor="middle" x="357" y="-1753.58" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="357" y="-1742.58" font-family="Arial" font-size="10.00">Input1: [batch_size=64, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="357" y="-1731.58" font-family="Arial" font-size="10.00">Input2: [batch_size=64, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="357" y="-1720.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu4_expert0&#45;&gt;gpu4_aggregate_experts -->
<g id="edge25" class="edge">
<title>gpu4_expert0&#45;&gt;gpu4_aggregate_experts</title>
<path fill="none" stroke="black" d="M227.78,-1844.98C239.56,-1835.97 253.48,-1825.32 267.74,-1814.4"/>
<polygon fill="black" stroke="black" points="269.88,-1817.17 275.69,-1808.31 265.62,-1811.61 269.88,-1817.17"/>
</g>
<!-- gpu4_expert1&#45;&gt;gpu4_aggregate_experts -->
<g id="edge26" class="edge">
<title>gpu4_expert1&#45;&gt;gpu4_aggregate_experts</title>
<path fill="none" stroke="black" d="M485.42,-1844.98C473.82,-1836.05 460.14,-1825.51 446.1,-1814.7"/>
<polygon fill="black" stroke="black" points="447.86,-1811.64 437.81,-1808.31 443.59,-1817.19 447.86,-1811.64"/>
</g>
<!-- gpu4_ffn_out -->
<g id="node24" class="node">
<title>gpu4_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="514,-1645.08 212,-1645.08 212,-1593.08 514,-1593.08 514,-1645.08"/>
<text text-anchor="middle" x="363" y="-1633.08" font-family="Arial" font-size="10.00">FFN Out Proj</text>
<text text-anchor="middle" x="363" y="-1622.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="363" y="-1611.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="363" y="-1600.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_aggregate_experts&#45;&gt;gpu4_ffn_out -->
<g id="edge27" class="edge">
<title>gpu4_aggregate_experts&#45;&gt;gpu4_ffn_out</title>
<path fill="none" stroke="black" d="M360,-1682.08C360.44,-1672.88 360.89,-1663.69 361.3,-1655.3"/>
<polygon fill="black" stroke="black" points="364.8,-1655.33 361.79,-1645.17 357.81,-1654.99 364.8,-1655.33"/>
</g>
<!-- gpu4_ffn_out&#45;&gt;gpu4_residual9 -->
<g id="edge28" class="edge">
<title>gpu4_ffn_out&#45;&gt;gpu4_residual9</title>
<path fill="none" stroke="black" d="M366.04,-1592.98C366.99,-1585.05 368.11,-1575.86 369.26,-1566.33"/>
<polygon fill="black" stroke="black" points="372.75,-1566.66 370.47,-1556.31 365.8,-1565.82 372.75,-1566.66"/>
</g>
<!-- comm_gpu4_gpu5 -->
<g id="node26" class="node">
<title>comm_gpu4_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="378" cy="-1356.31" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="378" y="-1370.31" font-family="Arial" font-size="10.00">Inter&#45;GPU Comm</text>
<text text-anchor="middle" x="378" y="-1359.31" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="378" y="-1348.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="378" y="-1337.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_residual9&#45;&gt;comm_gpu4_gpu5 -->
<g id="edge30" class="edge">
<title>gpu4_residual9&#45;&gt;comm_gpu4_gpu5</title>
<path fill="none" stroke="black" d="M378,-1429.82C378,-1420.9 378,-1411.85 378,-1403.32"/>
<polygon fill="black" stroke="black" points="381.5,-1403.2 378,-1393.2 374.5,-1403.2 381.5,-1403.2"/>
</g>
<!-- gpu7_layernorm14 -->
<g id="node27" class="node">
<title>gpu7_layernorm14</title>
<polygon fill="lightblue" stroke="black" points="522.5,-1252.54 233.5,-1252.54 233.5,-1200.54 522.5,-1200.54 522.5,-1252.54"/>
<text text-anchor="middle" x="378" y="-1240.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="378" y="-1229.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="378" y="-1218.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="378" y="-1207.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu4_gpu5&#45;&gt;gpu7_layernorm14 -->
<g id="edge31" class="edge">
<title>comm_gpu4_gpu5&#45;&gt;gpu7_layernorm14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M378,-1319.38C378,-1301.77 378,-1280.64 378,-1263.09"/>
<polygon fill="black" stroke="black" points="381.5,-1262.69 378,-1252.69 374.5,-1262.69 381.5,-1262.69"/>
<text text-anchor="middle" x="424" y="-1294.34" font-family="Arial" font-size="9.00">... through GPUs 5&#45;6 ...</text>
</g>
<!-- gpu7_mha_qkv -->
<g id="node28" class="node">
<title>gpu7_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="368.5,-1163.54 27.5,-1163.54 27.5,-1111.54 368.5,-1111.54 368.5,-1163.54"/>
<text text-anchor="middle" x="198" y="-1151.54" font-family="Arial" font-size="10.00">MHA Q/K/V Proj</text>
<text text-anchor="middle" x="198" y="-1140.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="198" y="-1129.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="198" y="-1118.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu7_layernorm14&#45;&gt;gpu7_mha_qkv -->
<g id="edge32" class="edge">
<title>gpu7_layernorm14&#45;&gt;gpu7_mha_qkv</title>
<path fill="none" stroke="black" d="M325.94,-1200.38C305.04,-1190.28 280.81,-1178.56 259.08,-1168.06"/>
<polygon fill="black" stroke="black" points="260.47,-1164.85 249.95,-1163.65 257.43,-1171.15 260.47,-1164.85"/>
</g>
<!-- gpu7_residual14 -->
<g id="node31" class="node">
<title>gpu7_residual14</title>
<polygon fill="lightyellow" stroke="black" points="677.74,-896.54 200.92,-896.54 78.26,-770.54 555.08,-770.54 677.74,-896.54"/>
<text text-anchor="middle" x="378" y="-853.04" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="378" y="-842.04" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="378" y="-831.04" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="378" y="-820.04" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="378" y="-809.04" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_layernorm14&#45;&gt;gpu7_residual14 -->
<g id="edge36" class="edge">
<title>gpu7_layernorm14&#45;&gt;gpu7_residual14</title>
<path fill="none" stroke="black" d="M382.42,-1200.5C385.09,-1183.16 388,-1159.52 388,-1138.54 388,-1138.54 388,-1138.54 388,-958.54 388,-941.82 387.09,-923.87 385.81,-906.96"/>
<polygon fill="black" stroke="black" points="389.27,-906.27 384.97,-896.59 382.29,-906.84 389.27,-906.27"/>
</g>
<!-- gpu7_mha_attention -->
<g id="node29" class="node">
<title>gpu7_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="368.5,-1074.54 27.5,-1074.54 27.5,-1022.54 368.5,-1022.54 368.5,-1074.54"/>
<text text-anchor="middle" x="198" y="-1062.54" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="198" y="-1051.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="198" y="-1040.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="198" y="-1029.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu7_mha_qkv&#45;&gt;gpu7_mha_attention -->
<g id="edge33" class="edge">
<title>gpu7_mha_qkv&#45;&gt;gpu7_mha_attention</title>
<path fill="none" stroke="black" d="M198,-1111.38C198,-1103.08 198,-1093.69 198,-1084.79"/>
<polygon fill="black" stroke="black" points="201.5,-1084.65 198,-1074.65 194.5,-1084.65 201.5,-1084.65"/>
</g>
<!-- gpu7_mha_out -->
<g id="node30" class="node">
<title>gpu7_mha_out</title>
<polygon fill="lightblue" stroke="black" points="368,-985.54 34,-985.54 34,-933.54 368,-933.54 368,-985.54"/>
<text text-anchor="middle" x="201" y="-973.54" font-family="Arial" font-size="10.00">MHA Out Proj</text>
<text text-anchor="middle" x="201" y="-962.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="201" y="-951.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="201" y="-940.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_mha_attention&#45;&gt;gpu7_mha_out -->
<g id="edge34" class="edge">
<title>gpu7_mha_attention&#45;&gt;gpu7_mha_out</title>
<path fill="none" stroke="black" d="M198.87,-1022.38C199.15,-1014.08 199.48,-1004.69 199.78,-995.79"/>
<polygon fill="black" stroke="black" points="203.29,-995.76 200.13,-985.65 196.29,-995.52 203.29,-995.76"/>
</g>
<!-- gpu7_mha_out&#45;&gt;gpu7_residual14 -->
<g id="edge35" class="edge">
<title>gpu7_mha_out&#45;&gt;gpu7_residual14</title>
<path fill="none" stroke="black" d="M236.82,-933.45C249.81,-924.35 265.18,-913.58 280.91,-902.56"/>
<polygon fill="black" stroke="black" points="282.98,-905.38 289.16,-896.77 278.97,-899.65 282.98,-905.38"/>
</g>
<!-- gpu7_layernorm15 -->
<g id="node32" class="node">
<title>gpu7_layernorm15</title>
<polygon fill="lightblue" stroke="black" points="519.5,-733.54 230.5,-733.54 230.5,-681.54 519.5,-681.54 519.5,-733.54"/>
<text text-anchor="middle" x="375" y="-721.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="375" y="-710.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="375" y="-699.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="375" y="-688.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_residual14&#45;&gt;gpu7_layernorm15 -->
<g id="edge37" class="edge">
<title>gpu7_residual14&#45;&gt;gpu7_layernorm15</title>
<path fill="none" stroke="black" d="M376.5,-770.54C376.28,-761.34 376.06,-752.15 375.85,-743.76"/>
<polygon fill="black" stroke="black" points="379.35,-743.54 375.61,-733.63 372.35,-743.71 379.35,-743.54"/>
</g>
<!-- gpu7_residual15 -->
<g id="node37" class="node">
<title>gpu7_residual15</title>
<polygon fill="lightyellow" stroke="black" points="657.74,-236.54 180.92,-236.54 58.26,-110.54 535.08,-110.54 657.74,-236.54"/>
<text text-anchor="middle" x="358" y="-193.04" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="358" y="-182.04" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="358" y="-171.04" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="358" y="-160.04" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="358" y="-149.04" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_residual14&#45;&gt;gpu7_residual15 -->
<g id="edge43" class="edge">
<title>gpu7_residual14&#45;&gt;gpu7_residual15</title>
<path fill="none" stroke="black" d="M591.72,-807.69C639.84,-789.63 677,-759.26 677,-708.54 677,-708.54 677,-708.54 677,-298.54 677,-276.74 650.8,-257.25 613.41,-240.54"/>
<polygon fill="black" stroke="black" points="614.78,-237.32 604.21,-236.58 612.01,-243.75 614.78,-237.32"/>
</g>
<!-- gpu7_ffn_gate -->
<g id="node33" class="node">
<title>gpu7_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="507,-644.54 197,-644.54 197,-592.54 507,-592.54 507,-644.54"/>
<text text-anchor="middle" x="352" y="-632.54" font-family="Arial" font-size="10.00">FFN Gate with Cache Opt</text>
<text text-anchor="middle" x="352" y="-621.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="352" y="-610.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="352" y="-599.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu7_layernorm15&#45;&gt;gpu7_ffn_gate -->
<g id="edge38" class="edge">
<title>gpu7_layernorm15&#45;&gt;gpu7_ffn_gate</title>
<path fill="none" stroke="black" d="M368.35,-681.38C366.13,-672.99 363.62,-663.49 361.24,-654.5"/>
<polygon fill="black" stroke="black" points="364.58,-653.42 358.64,-644.65 357.81,-655.21 364.58,-653.42"/>
</g>
<!-- gpu7_ffn_cache_load -->
<g id="node34" class="node">
<title>gpu7_ffn_cache_load</title>
<polygon fill="lightyellow" stroke="black" points="658.29,-555.54 147.19,-555.54 15.71,-451.54 526.81,-451.54 658.29,-555.54"/>
<text text-anchor="middle" x="337" y="-517.54" font-family="Arial" font-size="10.00">Load Expert Weights</text>
<text text-anchor="middle" x="337" y="-506.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="337" y="-495.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="337" y="-484.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu7_ffn_gate&#45;&gt;gpu7_ffn_cache_load -->
<g id="edge39" class="edge">
<title>gpu7_ffn_gate&#45;&gt;gpu7_ffn_cache_load</title>
<path fill="none" stroke="black" d="M348.67,-592.46C347.62,-584.53 346.41,-575.4 345.17,-566.08"/>
<polygon fill="black" stroke="black" points="348.61,-565.39 343.82,-555.94 341.67,-566.31 348.61,-565.39"/>
</g>
<!-- gpu7_ffn_experts -->
<g id="node35" class="node">
<title>gpu7_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="494,-414.54 184,-414.54 184,-362.54 494,-362.54 494,-414.54"/>
<text text-anchor="middle" x="339" y="-402.54" font-family="Arial" font-size="10.00">FFN Experts (Cached)</text>
<text text-anchor="middle" x="339" y="-391.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="339" y="-380.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="339" y="-369.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu7_ffn_cache_load&#45;&gt;gpu7_ffn_experts -->
<g id="edge40" class="edge">
<title>gpu7_ffn_cache_load&#45;&gt;gpu7_ffn_experts</title>
<path fill="none" stroke="black" d="M337.91,-451.33C338.06,-442.38 338.23,-433.25 338.38,-424.85"/>
<polygon fill="black" stroke="black" points="341.88,-424.73 338.56,-414.67 334.88,-424.61 341.88,-424.73"/>
</g>
<!-- gpu7_ffn_out -->
<g id="node36" class="node">
<title>gpu7_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="501,-325.54 199,-325.54 199,-273.54 501,-273.54 501,-325.54"/>
<text text-anchor="middle" x="350" y="-313.54" font-family="Arial" font-size="10.00">FFN Out Proj</text>
<text text-anchor="middle" x="350" y="-302.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="350" y="-291.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="350" y="-280.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_ffn_experts&#45;&gt;gpu7_ffn_out -->
<g id="edge41" class="edge">
<title>gpu7_ffn_experts&#45;&gt;gpu7_ffn_out</title>
<path fill="none" stroke="black" d="M342.18,-362.38C343.23,-354.08 344.42,-344.69 345.54,-335.79"/>
<polygon fill="black" stroke="black" points="349.04,-336.01 346.83,-325.65 342.1,-335.13 349.04,-336.01"/>
</g>
<!-- gpu7_ffn_out&#45;&gt;gpu7_residual15 -->
<g id="edge42" class="edge">
<title>gpu7_ffn_out&#45;&gt;gpu7_residual15</title>
<path fill="none" stroke="black" d="M351.62,-273.45C352.13,-265.51 352.72,-256.32 353.34,-246.79"/>
<polygon fill="black" stroke="black" points="356.83,-246.98 353.98,-236.77 349.85,-246.53 356.83,-246.98"/>
</g>
<!-- output -->
<g id="node38" class="node">
<title>output</title>
<ellipse fill="lightcyan" stroke="black" cx="358" cy="-36.77" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="358" y="-50.77" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="358" y="-39.77" font-family="Arial" font-size="10.00">GPU: Host</text>
<text text-anchor="middle" x="358" y="-28.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="358" y="-17.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_residual15&#45;&gt;output -->
<g id="edge44" class="edge">
<title>gpu7_residual15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M358,-110.28C358,-101.36 358,-92.31 358,-83.78"/>
<polygon fill="black" stroke="black" points="361.5,-83.67 358,-73.67 354.5,-83.67 361.5,-83.67"/>
</g>
</g>
</svg>
