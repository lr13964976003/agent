<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2211pt" height="12000pt"
 viewBox="0.00 0.00 530.64 2880.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(3.04 3.04) rotate(0) translate(4 3947.16)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3947.16 724,-3947.16 724,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="40,-3822.62 40,-3935.16 464,-3935.16 464,-3822.62 40,-3822.62"/>
<text text-anchor="middle" x="252" y="-3919.96" font-family="Times,serif" font-size="14.00">Input Batch</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu0</title>
<path fill="lightgray" stroke="black" d="M20,-2763.62C20,-2763.62 612,-2763.62 612,-2763.62 618,-2763.62 624,-2769.62 624,-2775.62 624,-2775.62 624,-3791.62 624,-3791.62 624,-3797.62 618,-3803.62 612,-3803.62 612,-3803.62 20,-3803.62 20,-3803.62 14,-3803.62 8,-3797.62 8,-3791.62 8,-3791.62 8,-2775.62 8,-2775.62 8,-2769.62 14,-2763.62 20,-2763.62"/>
<text text-anchor="middle" x="316" y="-3788.42" font-family="Times,serif" font-size="14.00">GPU 0: Layers 0&#45;1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu4</title>
<path fill="lightgray" stroke="black" d="M46,-1281.08C46,-1281.08 700,-1281.08 700,-1281.08 706,-1281.08 712,-1287.08 712,-1293.08 712,-1293.08 712,-2613.08 712,-2613.08 712,-2619.08 706,-2625.08 700,-2625.08 700,-2625.08 46,-2625.08 46,-2625.08 40,-2625.08 34,-2619.08 34,-2613.08 34,-2613.08 34,-1293.08 34,-1293.08 34,-1287.08 40,-1281.08 46,-1281.08"/>
<text text-anchor="middle" x="373" y="-2609.88" font-family="Times,serif" font-size="14.00">GPU 4: Layers 8&#45;9 (Representative Middle)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu7</title>
<path fill="lightgray" stroke="black" d="M54,-102.54C54,-102.54 646,-102.54 646,-102.54 652,-102.54 658,-108.54 658,-114.54 658,-114.54 658,-1130.54 658,-1130.54 658,-1136.54 652,-1142.54 646,-1142.54 646,-1142.54 54,-1142.54 54,-1142.54 48,-1142.54 42,-1136.54 42,-1130.54 42,-1130.54 42,-114.54 42,-114.54 42,-108.54 48,-102.54 54,-102.54"/>
<text text-anchor="middle" x="350" y="-1127.34" font-family="Times,serif" font-size="14.00">GPU 7: Layers 14&#45;15 (Final)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightcyan" stroke="black" cx="252" cy="-3867.39" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="252" y="-3881.39" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="252" y="-3870.39" font-family="Arial" font-size="10.00">GPU: Host</text>
<text text-anchor="middle" x="252" y="-3859.39" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="252" y="-3848.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_layernorm0 -->
<g id="node2" class="node">
<title>gpu0_layernorm0</title>
<polygon fill="lightblue" stroke="black" points="370.5,-3772.62 81.5,-3772.62 81.5,-3720.62 370.5,-3720.62 370.5,-3772.62"/>
<text text-anchor="middle" x="226" y="-3760.62" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="226" y="-3749.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="226" y="-3738.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="226" y="-3727.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- input&#45;&gt;gpu0_layernorm0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;gpu0_layernorm0</title>
<path fill="none" stroke="black" d="M244.13,-3830.43C240.83,-3815.34 237,-3797.85 233.71,-3782.84"/>
<polygon fill="black" stroke="black" points="237.09,-3781.93 231.54,-3772.91 230.26,-3783.42 237.09,-3781.93"/>
</g>
<!-- gpu0_residual0 -->
<g id="node6" class="node">
<title>gpu0_residual0</title>
<polygon fill="lightyellow" stroke="black" points="615.74,-3416.62 138.92,-3416.62 16.26,-3290.62 493.08,-3290.62 615.74,-3416.62"/>
<text text-anchor="middle" x="316" y="-3373.12" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="316" y="-3362.12" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="316" y="-3351.12" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-3340.12" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-3329.12" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- input&#45;&gt;gpu0_residual0 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;gpu0_residual0</title>
<path fill="none" stroke="black" d="M343.11,-3834.29C378.63,-3815.48 411,-3787.41 411,-3747.62 411,-3747.62 411,-3747.62 411,-3478.62 411,-3459.33 403.67,-3441.2 393.08,-3425.06"/>
<polygon fill="black" stroke="black" points="395.89,-3422.96 387.27,-3416.8 390.17,-3426.99 395.89,-3422.96"/>
</g>
<!-- gpu0_mha_qkv -->
<g id="node3" class="node">
<title>gpu0_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="382.5,-3683.62 41.5,-3683.62 41.5,-3631.62 382.5,-3631.62 382.5,-3683.62"/>
<text text-anchor="middle" x="212" y="-3671.62" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="212" y="-3660.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="212" y="-3649.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="212" y="-3638.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu0_layernorm0&#45;&gt;gpu0_mha_qkv -->
<g id="edge2" class="edge">
<title>gpu0_layernorm0&#45;&gt;gpu0_mha_qkv</title>
<path fill="none" stroke="black" d="M221.95,-3720.45C220.62,-3712.16 219.11,-3702.77 217.67,-3693.87"/>
<polygon fill="black" stroke="black" points="221.08,-3693.04 216.04,-3683.72 214.17,-3694.15 221.08,-3693.04"/>
</g>
<!-- gpu0_mha_attention -->
<g id="node4" class="node">
<title>gpu0_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="382.5,-3594.62 41.5,-3594.62 41.5,-3542.62 382.5,-3542.62 382.5,-3594.62"/>
<text text-anchor="middle" x="212" y="-3582.62" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="212" y="-3571.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="212" y="-3560.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="212" y="-3549.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu0_mha_qkv&#45;&gt;gpu0_mha_attention -->
<g id="edge3" class="edge">
<title>gpu0_mha_qkv&#45;&gt;gpu0_mha_attention</title>
<path fill="none" stroke="black" d="M212,-3631.45C212,-3623.16 212,-3613.77 212,-3604.87"/>
<polygon fill="black" stroke="black" points="215.5,-3604.72 212,-3594.72 208.5,-3604.72 215.5,-3604.72"/>
</g>
<!-- gpu0_mha_out -->
<g id="node5" class="node">
<title>gpu0_mha_out</title>
<polygon fill="lightblue" stroke="black" points="381,-3505.62 47,-3505.62 47,-3453.62 381,-3453.62 381,-3505.62"/>
<text text-anchor="middle" x="214" y="-3493.62" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="214" y="-3482.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="214" y="-3471.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="214" y="-3460.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_mha_attention&#45;&gt;gpu0_mha_out -->
<g id="edge4" class="edge">
<title>gpu0_mha_attention&#45;&gt;gpu0_mha_out</title>
<path fill="none" stroke="black" d="M212.58,-3542.45C212.77,-3534.16 212.98,-3524.77 213.19,-3515.87"/>
<polygon fill="black" stroke="black" points="216.69,-3515.8 213.42,-3505.72 209.69,-3515.64 216.69,-3515.8"/>
</g>
<!-- gpu0_mha_out&#45;&gt;gpu0_residual0 -->
<g id="edge5" class="edge">
<title>gpu0_mha_out&#45;&gt;gpu0_residual0</title>
<path fill="none" stroke="black" d="M234.64,-3453.52C241.65,-3445.01 249.85,-3435.03 258.31,-3424.75"/>
<polygon fill="black" stroke="black" points="261.16,-3426.8 264.81,-3416.85 255.75,-3422.35 261.16,-3426.8"/>
</g>
<!-- gpu0_layernorm1 -->
<g id="node7" class="node">
<title>gpu0_layernorm1</title>
<polygon fill="lightblue" stroke="black" points="390.5,-3253.62 101.5,-3253.62 101.5,-3201.62 390.5,-3201.62 390.5,-3253.62"/>
<text text-anchor="middle" x="246" y="-3241.62" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="246" y="-3230.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="246" y="-3219.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="246" y="-3208.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_residual0&#45;&gt;gpu0_layernorm1 -->
<g id="edge7" class="edge">
<title>gpu0_residual0&#45;&gt;gpu0_layernorm1</title>
<path fill="none" stroke="black" d="M281,-3290.62C275.52,-3280.91 270.04,-3271.2 265.1,-3262.45"/>
<polygon fill="black" stroke="black" points="268.13,-3260.7 260.17,-3253.71 262.03,-3264.14 268.13,-3260.7"/>
</g>
<!-- gpu0_residual1 -->
<g id="node11" class="node">
<title>gpu0_residual1</title>
<polygon fill="lightyellow" stroke="black" points="615.74,-2897.62 138.92,-2897.62 16.26,-2771.62 493.08,-2771.62 615.74,-2897.62"/>
<text text-anchor="middle" x="316" y="-2854.12" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="316" y="-2843.12" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="316" y="-2832.12" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-2821.12" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-2810.12" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_residual0&#45;&gt;gpu0_residual1 -->
<g id="edge12" class="edge">
<title>gpu0_residual0&#45;&gt;gpu0_residual1</title>
<path fill="none" stroke="black" d="M389.78,-3290.47C403.7,-3272.43 414,-3251.39 414,-3228.62 414,-3228.62 414,-3228.62 414,-2959.62 414,-2940.22 406.53,-2922.09 395.71,-2905.99"/>
<polygon fill="black" stroke="black" points="398.47,-2903.82 389.78,-2897.76 392.79,-2907.92 398.47,-2903.82"/>
</g>
<!-- gpu0_ffn_gate -->
<g id="node8" class="node">
<title>gpu0_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="395,-3164.62 85,-3164.62 85,-3112.62 395,-3112.62 395,-3164.62"/>
<text text-anchor="middle" x="240" y="-3152.62" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="240" y="-3141.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="240" y="-3130.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="240" y="-3119.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu0_layernorm1&#45;&gt;gpu0_ffn_gate -->
<g id="edge8" class="edge">
<title>gpu0_layernorm1&#45;&gt;gpu0_ffn_gate</title>
<path fill="none" stroke="black" d="M244.26,-3201.45C243.69,-3193.16 243.05,-3183.77 242.43,-3174.87"/>
<polygon fill="black" stroke="black" points="245.91,-3174.46 241.73,-3164.72 238.93,-3174.94 245.91,-3174.46"/>
</g>
<!-- gpu0_ffn_experts -->
<g id="node9" class="node">
<title>gpu0_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="395,-3075.62 85,-3075.62 85,-3023.62 395,-3023.62 395,-3075.62"/>
<text text-anchor="middle" x="240" y="-3063.62" font-family="Arial" font-size="10.00">FFN Experts</text>
<text text-anchor="middle" x="240" y="-3052.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="240" y="-3041.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="240" y="-3030.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu0_ffn_gate&#45;&gt;gpu0_ffn_experts -->
<g id="edge9" class="edge">
<title>gpu0_ffn_gate&#45;&gt;gpu0_ffn_experts</title>
<path fill="none" stroke="black" d="M240,-3112.45C240,-3104.16 240,-3094.77 240,-3085.87"/>
<polygon fill="black" stroke="black" points="243.5,-3085.72 240,-3075.72 236.5,-3085.72 243.5,-3085.72"/>
</g>
<!-- gpu0_ffn_out -->
<g id="node10" class="node">
<title>gpu0_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="393,-2986.62 91,-2986.62 91,-2934.62 393,-2934.62 393,-2986.62"/>
<text text-anchor="middle" x="242" y="-2974.62" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="242" y="-2963.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="242" y="-2952.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="242" y="-2941.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_ffn_experts&#45;&gt;gpu0_ffn_out -->
<g id="edge10" class="edge">
<title>gpu0_ffn_experts&#45;&gt;gpu0_ffn_out</title>
<path fill="none" stroke="black" d="M240.58,-3023.45C240.77,-3015.16 240.98,-3005.77 241.19,-2996.87"/>
<polygon fill="black" stroke="black" points="244.69,-2996.8 241.42,-2986.72 237.69,-2996.64 244.69,-2996.8"/>
</g>
<!-- gpu0_ffn_out&#45;&gt;gpu0_residual1 -->
<g id="edge11" class="edge">
<title>gpu0_ffn_out&#45;&gt;gpu0_residual1</title>
<path fill="none" stroke="black" d="M256.98,-2934.52C261.91,-2926.26 267.66,-2916.62 273.6,-2906.66"/>
<polygon fill="black" stroke="black" points="276.74,-2908.23 278.86,-2897.85 270.73,-2904.65 276.74,-2908.23"/>
</g>
<!-- comm_gpu0_gpu1 -->
<g id="node12" class="node">
<title>comm_gpu0_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="316" cy="-2697.85" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="316" y="-2711.85" font-family="Arial" font-size="10.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="316" y="-2700.85" font-family="Arial" font-size="10.00">GPU: 0 → 1</text>
<text text-anchor="middle" x="316" y="-2689.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-2678.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_residual1&#45;&gt;comm_gpu0_gpu1 -->
<g id="edge13" class="edge">
<title>gpu0_residual1&#45;&gt;comm_gpu0_gpu1</title>
<path fill="none" stroke="black" d="M316,-2771.36C316,-2762.44 316,-2753.39 316,-2744.86"/>
<polygon fill="black" stroke="black" points="319.5,-2744.74 316,-2734.74 312.5,-2744.74 319.5,-2744.74"/>
</g>
<!-- gpu4_layernorm8 -->
<g id="node13" class="node">
<title>gpu4_layernorm8</title>
<polygon fill="lightblue" stroke="black" points="460.5,-2594.08 171.5,-2594.08 171.5,-2542.08 460.5,-2542.08 460.5,-2594.08"/>
<text text-anchor="middle" x="316" y="-2582.08" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="316" y="-2571.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="316" y="-2560.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-2549.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu0_gpu1&#45;&gt;gpu4_layernorm8 -->
<g id="edge14" class="edge">
<title>comm_gpu0_gpu1&#45;&gt;gpu4_layernorm8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M316,-2660.92C316,-2643.31 316,-2622.18 316,-2604.63"/>
<polygon fill="black" stroke="black" points="319.5,-2604.23 316,-2594.23 312.5,-2604.23 319.5,-2604.23"/>
<text text-anchor="middle" x="362" y="-2635.88" font-family="Arial" font-size="9.00">... through GPUs 1&#45;3 ...</text>
</g>
<!-- gpu4_mha_qkv -->
<g id="node14" class="node">
<title>gpu4_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="383.5,-2505.08 42.5,-2505.08 42.5,-2453.08 383.5,-2453.08 383.5,-2505.08"/>
<text text-anchor="middle" x="213" y="-2493.08" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="213" y="-2482.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="213" y="-2471.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="213" y="-2460.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu4_layernorm8&#45;&gt;gpu4_mha_qkv -->
<g id="edge15" class="edge">
<title>gpu4_layernorm8&#45;&gt;gpu4_mha_qkv</title>
<path fill="none" stroke="black" d="M286.21,-2541.91C275.11,-2532.54 262.35,-2521.77 250.64,-2511.87"/>
<polygon fill="black" stroke="black" points="252.62,-2508.96 242.72,-2505.19 248.11,-2514.31 252.62,-2508.96"/>
</g>
<!-- gpu4_residual8 -->
<g id="node17" class="node">
<title>gpu4_residual8</title>
<polygon fill="lightyellow" stroke="black" points="701.74,-2238.08 224.92,-2238.08 102.26,-2112.08 579.08,-2112.08 701.74,-2238.08"/>
<text text-anchor="middle" x="402" y="-2194.58" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="402" y="-2183.58" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="402" y="-2172.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="402" y="-2161.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="402" y="-2150.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_layernorm8&#45;&gt;gpu4_residual8 -->
<g id="edge19" class="edge">
<title>gpu4_layernorm8&#45;&gt;gpu4_residual8</title>
<path fill="none" stroke="black" d="M362.56,-2541.94C383.24,-2527.12 403,-2506.14 403,-2480.08 403,-2480.08 403,-2480.08 403,-2300.08 403,-2283.41 402.91,-2265.48 402.78,-2248.58"/>
<polygon fill="black" stroke="black" points="406.28,-2248.18 402.7,-2238.21 399.28,-2248.23 406.28,-2248.18"/>
</g>
<!-- gpu4_mha_attention -->
<g id="node15" class="node">
<title>gpu4_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="383.5,-2416.08 42.5,-2416.08 42.5,-2364.08 383.5,-2364.08 383.5,-2416.08"/>
<text text-anchor="middle" x="213" y="-2404.08" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="213" y="-2393.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="213" y="-2382.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="213" y="-2371.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu4_mha_qkv&#45;&gt;gpu4_mha_attention -->
<g id="edge16" class="edge">
<title>gpu4_mha_qkv&#45;&gt;gpu4_mha_attention</title>
<path fill="none" stroke="black" d="M213,-2452.91C213,-2444.62 213,-2435.23 213,-2426.33"/>
<polygon fill="black" stroke="black" points="216.5,-2426.19 213,-2416.19 209.5,-2426.19 216.5,-2426.19"/>
</g>
<!-- gpu4_mha_out -->
<g id="node16" class="node">
<title>gpu4_mha_out</title>
<polygon fill="lightblue" stroke="black" points="382,-2327.08 48,-2327.08 48,-2275.08 382,-2275.08 382,-2327.08"/>
<text text-anchor="middle" x="215" y="-2315.08" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="215" y="-2304.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="215" y="-2293.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="215" y="-2282.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_mha_attention&#45;&gt;gpu4_mha_out -->
<g id="edge17" class="edge">
<title>gpu4_mha_attention&#45;&gt;gpu4_mha_out</title>
<path fill="none" stroke="black" d="M213.58,-2363.91C213.77,-2355.62 213.98,-2346.23 214.19,-2337.33"/>
<polygon fill="black" stroke="black" points="217.69,-2337.26 214.42,-2327.19 210.69,-2337.1 217.69,-2337.26"/>
</g>
<!-- gpu4_mha_out&#45;&gt;gpu4_residual8 -->
<g id="edge18" class="edge">
<title>gpu4_mha_out&#45;&gt;gpu4_residual8</title>
<path fill="none" stroke="black" d="M252.84,-2274.98C266.57,-2265.89 282.8,-2255.12 299.43,-2244.09"/>
<polygon fill="black" stroke="black" points="301.74,-2246.76 308.14,-2238.31 297.88,-2240.92 301.74,-2246.76"/>
</g>
<!-- gpu4_layernorm9 -->
<g id="node18" class="node">
<title>gpu4_layernorm9</title>
<polygon fill="lightblue" stroke="black" points="544.5,-2075.08 255.5,-2075.08 255.5,-2023.08 544.5,-2023.08 544.5,-2075.08"/>
<text text-anchor="middle" x="400" y="-2063.08" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="400" y="-2052.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="400" y="-2041.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="400" y="-2030.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_residual8&#45;&gt;gpu4_layernorm9 -->
<g id="edge20" class="edge">
<title>gpu4_residual8&#45;&gt;gpu4_layernorm9</title>
<path fill="none" stroke="black" d="M401,-2112.08C400.85,-2102.88 400.7,-2093.69 400.57,-2085.3"/>
<polygon fill="black" stroke="black" points="404.07,-2085.11 400.4,-2075.17 397.07,-2085.23 404.07,-2085.11"/>
</g>
<!-- gpu4_residual9 -->
<g id="node25" class="node">
<title>gpu4_residual9</title>
<polygon fill="lightyellow" stroke="black" points="683.74,-1415.08 206.92,-1415.08 84.26,-1289.08 561.08,-1289.08 683.74,-1415.08"/>
<text text-anchor="middle" x="384" y="-1371.58" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="384" y="-1360.58" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="384" y="-1349.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="384" y="-1338.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="384" y="-1327.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_residual8&#45;&gt;gpu4_residual9 -->
<g id="edge29" class="edge">
<title>gpu4_residual8&#45;&gt;gpu4_residual9</title>
<path fill="none" stroke="black" d="M593.05,-2126.37C652.6,-2105.82 703,-2079.68 703,-2050.08 703,-2050.08 703,-2050.08 703,-1477.08 703,-1455.28 676.8,-1435.79 639.41,-1419.08"/>
<polygon fill="black" stroke="black" points="640.78,-1415.86 630.21,-1415.11 638.01,-1422.29 640.78,-1415.86"/>
</g>
<!-- gpu4_ffn_gate -->
<g id="node19" class="node">
<title>gpu4_ffn_gate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="536,-1986.08 226,-1986.08 226,-1934.08 536,-1934.08 536,-1986.08"/>
<text text-anchor="middle" x="381" y="-1974.08" font-family="Arial" font-size="10.00">FFN Gate (Expert Selection)</text>
<text text-anchor="middle" x="381" y="-1963.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="381" y="-1952.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="381" y="-1941.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu4_layernorm9&#45;&gt;gpu4_ffn_gate -->
<g id="edge21" class="edge">
<title>gpu4_layernorm9&#45;&gt;gpu4_ffn_gate</title>
<path fill="none" stroke="black" d="M394.5,-2022.91C392.67,-2014.53 390.6,-2005.03 388.63,-1996.04"/>
<polygon fill="black" stroke="black" points="392.04,-1995.21 386.48,-1986.19 385.2,-1996.7 392.04,-1995.21"/>
</g>
<!-- gpu4_split_experts -->
<g id="node20" class="node">
<title>gpu4_split_experts</title>
<polygon fill="lightyellow" stroke="black" points="684.42,-1897.08 181.07,-1897.08 51.58,-1793.08 554.93,-1793.08 684.42,-1897.08"/>
<text text-anchor="middle" x="368" y="-1859.08" font-family="Arial" font-size="10.00">Split for Experts</text>
<text text-anchor="middle" x="368" y="-1848.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="368" y="-1837.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="368" y="-1826.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
</g>
<!-- gpu4_ffn_gate&#45;&gt;gpu4_split_experts -->
<g id="edge22" class="edge">
<title>gpu4_ffn_gate&#45;&gt;gpu4_split_experts</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M378.11,-1934C377.2,-1926.07 376.15,-1916.94 375.08,-1907.62"/>
<polygon fill="black" stroke="black" points="378.53,-1907.01 373.91,-1897.48 371.58,-1907.81 378.53,-1907.01"/>
</g>
<!-- gpu4_expert1 -->
<g id="node21" class="node">
<title>gpu4_expert1</title>
<polygon fill="lightblue" stroke="black" points="353.5,-1756.08 48.5,-1756.08 48.5,-1704.08 353.5,-1704.08 353.5,-1756.08"/>
<text text-anchor="middle" x="201" y="-1744.08" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-1733.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="201" y="-1722.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
<text text-anchor="middle" x="201" y="-1711.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
</g>
<!-- gpu4_split_experts&#45;&gt;gpu4_expert1 -->
<g id="edge23" class="edge">
<title>gpu4_split_experts&#45;&gt;gpu4_expert1</title>
<path fill="none" stroke="black" d="M292.32,-1792.87C276.74,-1782.33 260.79,-1771.54 246.67,-1761.98"/>
<polygon fill="black" stroke="black" points="248.38,-1758.91 238.14,-1756.21 244.46,-1764.71 248.38,-1758.91"/>
</g>
<!-- gpu4_expert2 -->
<g id="node22" class="node">
<title>gpu4_expert2</title>
<polygon fill="lightblue" stroke="black" points="676.5,-1756.08 371.5,-1756.08 371.5,-1704.08 676.5,-1704.08 676.5,-1756.08"/>
<text text-anchor="middle" x="524" y="-1744.08" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="524" y="-1733.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="524" y="-1722.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
<text text-anchor="middle" x="524" y="-1711.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
</g>
<!-- gpu4_split_experts&#45;&gt;gpu4_expert2 -->
<g id="edge24" class="edge">
<title>gpu4_split_experts&#45;&gt;gpu4_expert2</title>
<path fill="none" stroke="black" d="M438.7,-1792.87C453.11,-1782.43 467.87,-1771.74 480.96,-1762.25"/>
<polygon fill="black" stroke="black" points="483.26,-1764.91 489.31,-1756.21 479.15,-1759.24 483.26,-1764.91"/>
</g>
<!-- gpu4_aggregate_experts -->
<g id="node23" class="node">
<title>gpu4_aggregate_experts</title>
<polygon fill="lightyellow" stroke="black" points="684.29,-1667.08 173.19,-1667.08 41.71,-1541.08 552.81,-1541.08 684.29,-1667.08"/>
<text text-anchor="middle" x="363" y="-1623.58" font-family="Arial" font-size="10.00">Aggregate Experts</text>
<text text-anchor="middle" x="363" y="-1612.58" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="363" y="-1601.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
<text text-anchor="middle" x="363" y="-1590.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
<text text-anchor="middle" x="363" y="-1579.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu4_expert1&#45;&gt;gpu4_aggregate_experts -->
<g id="edge25" class="edge">
<title>gpu4_expert1&#45;&gt;gpu4_aggregate_experts</title>
<path fill="none" stroke="black" d="M233.78,-1703.98C245.56,-1694.97 259.48,-1684.32 273.74,-1673.4"/>
<polygon fill="black" stroke="black" points="275.88,-1676.17 281.69,-1667.31 271.62,-1670.61 275.88,-1676.17"/>
</g>
<!-- gpu4_expert2&#45;&gt;gpu4_aggregate_experts -->
<g id="edge26" class="edge">
<title>gpu4_expert2&#45;&gt;gpu4_aggregate_experts</title>
<path fill="none" stroke="black" d="M491.42,-1703.98C479.82,-1695.05 466.14,-1684.51 452.1,-1673.7"/>
<polygon fill="black" stroke="black" points="453.86,-1670.64 443.81,-1667.31 449.59,-1676.19 453.86,-1670.64"/>
</g>
<!-- gpu4_ffn_out -->
<g id="node24" class="node">
<title>gpu4_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="520,-1504.08 218,-1504.08 218,-1452.08 520,-1452.08 520,-1504.08"/>
<text text-anchor="middle" x="369" y="-1492.08" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="369" y="-1481.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="369" y="-1470.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="369" y="-1459.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_aggregate_experts&#45;&gt;gpu4_ffn_out -->
<g id="edge27" class="edge">
<title>gpu4_aggregate_experts&#45;&gt;gpu4_ffn_out</title>
<path fill="none" stroke="black" d="M366,-1541.08C366.44,-1531.88 366.89,-1522.69 367.3,-1514.3"/>
<polygon fill="black" stroke="black" points="370.8,-1514.33 367.79,-1504.17 363.81,-1513.99 370.8,-1514.33"/>
</g>
<!-- gpu4_ffn_out&#45;&gt;gpu4_residual9 -->
<g id="edge28" class="edge">
<title>gpu4_ffn_out&#45;&gt;gpu4_residual9</title>
<path fill="none" stroke="black" d="M372.04,-1451.98C372.99,-1444.05 374.11,-1434.86 375.26,-1425.33"/>
<polygon fill="black" stroke="black" points="378.75,-1425.66 376.47,-1415.31 371.8,-1424.82 378.75,-1425.66"/>
</g>
<!-- comm_gpu4_gpu5 -->
<g id="node26" class="node">
<title>comm_gpu4_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="384" cy="-1215.31" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="384" y="-1229.31" font-family="Arial" font-size="10.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="384" y="-1218.31" font-family="Arial" font-size="10.00">GPU: 4 → 5</text>
<text text-anchor="middle" x="384" y="-1207.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="384" y="-1196.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_residual9&#45;&gt;comm_gpu4_gpu5 -->
<g id="edge30" class="edge">
<title>gpu4_residual9&#45;&gt;comm_gpu4_gpu5</title>
<path fill="none" stroke="black" d="M384,-1288.82C384,-1279.9 384,-1270.85 384,-1262.32"/>
<polygon fill="black" stroke="black" points="387.5,-1262.2 384,-1252.2 380.5,-1262.2 387.5,-1262.2"/>
</g>
<!-- gpu7_layernorm14 -->
<g id="node27" class="node">
<title>gpu7_layernorm14</title>
<polygon fill="lightblue" stroke="black" points="528.5,-1111.54 239.5,-1111.54 239.5,-1059.54 528.5,-1059.54 528.5,-1111.54"/>
<text text-anchor="middle" x="384" y="-1099.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="384" y="-1088.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="384" y="-1077.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="384" y="-1066.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu4_gpu5&#45;&gt;gpu7_layernorm14 -->
<g id="edge31" class="edge">
<title>comm_gpu4_gpu5&#45;&gt;gpu7_layernorm14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M384,-1178.38C384,-1160.77 384,-1139.64 384,-1122.09"/>
<polygon fill="black" stroke="black" points="387.5,-1121.69 384,-1111.69 380.5,-1121.69 387.5,-1121.69"/>
<text text-anchor="middle" x="430" y="-1153.34" font-family="Arial" font-size="9.00">... through GPUs 5&#45;6 ...</text>
</g>
<!-- gpu7_mha_qkv -->
<g id="node28" class="node">
<title>gpu7_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="413.5,-1022.54 72.5,-1022.54 72.5,-970.54 413.5,-970.54 413.5,-1022.54"/>
<text text-anchor="middle" x="243" y="-1010.54" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="243" y="-999.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="243" y="-988.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="243" y="-977.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu7_layernorm14&#45;&gt;gpu7_mha_qkv -->
<g id="edge32" class="edge">
<title>gpu7_layernorm14&#45;&gt;gpu7_mha_qkv</title>
<path fill="none" stroke="black" d="M343.22,-1059.38C327.29,-1049.55 308.88,-1038.19 292.22,-1027.91"/>
<polygon fill="black" stroke="black" points="294.04,-1024.92 283.69,-1022.65 290.36,-1030.88 294.04,-1024.92"/>
</g>
<!-- gpu7_residual14 -->
<g id="node31" class="node">
<title>gpu7_residual14</title>
<polygon fill="lightyellow" stroke="black" points="649.74,-755.54 172.92,-755.54 50.26,-629.54 527.08,-629.54 649.74,-755.54"/>
<text text-anchor="middle" x="350" y="-712.04" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="350" y="-701.04" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="350" y="-690.04" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="350" y="-679.04" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="350" y="-668.04" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_layernorm14&#45;&gt;gpu7_residual14 -->
<g id="edge36" class="edge">
<title>gpu7_layernorm14&#45;&gt;gpu7_residual14</title>
<path fill="none" stroke="black" d="M407.35,-1059.18C419.97,-1042.84 433,-1020.42 433,-997.54 433,-997.54 433,-997.54 433,-817.54 433,-798.85 426.41,-780.85 416.94,-764.63"/>
<polygon fill="black" stroke="black" points="419.69,-762.42 411.41,-755.81 413.76,-766.14 419.69,-762.42"/>
</g>
<!-- gpu7_mha_attention -->
<g id="node29" class="node">
<title>gpu7_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="413.5,-933.54 72.5,-933.54 72.5,-881.54 413.5,-881.54 413.5,-933.54"/>
<text text-anchor="middle" x="243" y="-921.54" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="243" y="-910.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="243" y="-899.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="243" y="-888.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu7_mha_qkv&#45;&gt;gpu7_mha_attention -->
<g id="edge33" class="edge">
<title>gpu7_mha_qkv&#45;&gt;gpu7_mha_attention</title>
<path fill="none" stroke="black" d="M243,-970.38C243,-962.08 243,-952.69 243,-943.79"/>
<polygon fill="black" stroke="black" points="246.5,-943.65 243,-933.65 239.5,-943.65 246.5,-943.65"/>
</g>
<!-- gpu7_mha_out -->
<g id="node30" class="node">
<title>gpu7_mha_out</title>
<polygon fill="lightblue" stroke="black" points="412,-844.54 78,-844.54 78,-792.54 412,-792.54 412,-844.54"/>
<text text-anchor="middle" x="245" y="-832.54" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="245" y="-821.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="245" y="-810.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="245" y="-799.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_mha_attention&#45;&gt;gpu7_mha_out -->
<g id="edge34" class="edge">
<title>gpu7_mha_attention&#45;&gt;gpu7_mha_out</title>
<path fill="none" stroke="black" d="M243.58,-881.38C243.77,-873.08 243.98,-863.69 244.19,-854.79"/>
<polygon fill="black" stroke="black" points="247.69,-854.72 244.42,-844.65 240.69,-854.56 247.69,-854.72"/>
</g>
<!-- gpu7_mha_out&#45;&gt;gpu7_residual14 -->
<g id="edge35" class="edge">
<title>gpu7_mha_out&#45;&gt;gpu7_residual14</title>
<path fill="none" stroke="black" d="M266.25,-792.45C273.46,-783.93 281.91,-773.95 290.61,-763.68"/>
<polygon fill="black" stroke="black" points="293.51,-765.67 297.3,-755.77 288.17,-761.14 293.51,-765.67"/>
</g>
<!-- gpu7_layernorm15 -->
<g id="node32" class="node">
<title>gpu7_layernorm15</title>
<polygon fill="lightblue" stroke="black" points="424.5,-592.54 135.5,-592.54 135.5,-540.54 424.5,-540.54 424.5,-592.54"/>
<text text-anchor="middle" x="280" y="-580.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="280" y="-569.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="280" y="-558.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="280" y="-547.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_residual14&#45;&gt;gpu7_layernorm15 -->
<g id="edge37" class="edge">
<title>gpu7_residual14&#45;&gt;gpu7_layernorm15</title>
<path fill="none" stroke="black" d="M315,-629.54C309.52,-619.83 304.04,-610.13 299.1,-601.37"/>
<polygon fill="black" stroke="black" points="302.13,-599.62 294.17,-592.63 296.03,-603.06 302.13,-599.62"/>
</g>
<!-- gpu7_residual15 -->
<g id="node36" class="node">
<title>gpu7_residual15</title>
<polygon fill="lightyellow" stroke="black" points="649.74,-236.54 172.92,-236.54 50.26,-110.54 527.08,-110.54 649.74,-236.54"/>
<text text-anchor="middle" x="350" y="-193.04" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="350" y="-182.04" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="350" y="-171.04" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="350" y="-160.04" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="350" y="-149.04" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_residual14&#45;&gt;gpu7_residual15 -->
<g id="edge42" class="edge">
<title>gpu7_residual14&#45;&gt;gpu7_residual15</title>
<path fill="none" stroke="black" d="M423.78,-629.39C437.7,-611.36 448,-590.31 448,-567.54 448,-567.54 448,-567.54 448,-298.54 448,-279.15 440.53,-261.01 429.71,-244.91"/>
<polygon fill="black" stroke="black" points="432.47,-242.74 423.78,-236.69 426.79,-246.84 432.47,-242.74"/>
</g>
<!-- gpu7_ffn_gate -->
<g id="node33" class="node">
<title>gpu7_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="429,-503.54 119,-503.54 119,-451.54 429,-451.54 429,-503.54"/>
<text text-anchor="middle" x="274" y="-491.54" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="274" y="-480.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="274" y="-469.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="274" y="-458.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu7_layernorm15&#45;&gt;gpu7_ffn_gate -->
<g id="edge38" class="edge">
<title>gpu7_layernorm15&#45;&gt;gpu7_ffn_gate</title>
<path fill="none" stroke="black" d="M278.26,-540.38C277.69,-532.08 277.05,-522.69 276.43,-513.79"/>
<polygon fill="black" stroke="black" points="279.91,-513.38 275.73,-503.65 272.93,-513.86 279.91,-513.38"/>
</g>
<!-- gpu7_ffn_experts -->
<g id="node34" class="node">
<title>gpu7_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="429,-414.54 119,-414.54 119,-362.54 429,-362.54 429,-414.54"/>
<text text-anchor="middle" x="274" y="-402.54" font-family="Arial" font-size="10.00">FFN Experts</text>
<text text-anchor="middle" x="274" y="-391.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="274" y="-380.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="274" y="-369.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu7_ffn_gate&#45;&gt;gpu7_ffn_experts -->
<g id="edge39" class="edge">
<title>gpu7_ffn_gate&#45;&gt;gpu7_ffn_experts</title>
<path fill="none" stroke="black" d="M274,-451.38C274,-443.08 274,-433.69 274,-424.79"/>
<polygon fill="black" stroke="black" points="277.5,-424.65 274,-414.65 270.5,-424.65 277.5,-424.65"/>
</g>
<!-- gpu7_ffn_out -->
<g id="node35" class="node">
<title>gpu7_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="427,-325.54 125,-325.54 125,-273.54 427,-273.54 427,-325.54"/>
<text text-anchor="middle" x="276" y="-313.54" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="276" y="-302.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="276" y="-291.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="276" y="-280.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_ffn_experts&#45;&gt;gpu7_ffn_out -->
<g id="edge40" class="edge">
<title>gpu7_ffn_experts&#45;&gt;gpu7_ffn_out</title>
<path fill="none" stroke="black" d="M274.58,-362.38C274.77,-354.08 274.98,-344.69 275.19,-335.79"/>
<polygon fill="black" stroke="black" points="278.69,-335.72 275.42,-325.65 271.69,-335.56 278.69,-335.72"/>
</g>
<!-- gpu7_ffn_out&#45;&gt;gpu7_residual15 -->
<g id="edge41" class="edge">
<title>gpu7_ffn_out&#45;&gt;gpu7_residual15</title>
<path fill="none" stroke="black" d="M290.98,-273.45C295.91,-265.18 301.66,-255.54 307.6,-245.58"/>
<polygon fill="black" stroke="black" points="310.74,-247.16 312.86,-236.77 304.73,-243.57 310.74,-247.16"/>
</g>
<!-- output -->
<g id="node37" class="node">
<title>output</title>
<ellipse fill="lightcyan" stroke="black" cx="350" cy="-36.77" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="350" y="-50.77" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="350" y="-39.77" font-family="Arial" font-size="10.00">GPU: Host</text>
<text text-anchor="middle" x="350" y="-28.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="350" y="-17.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_residual15&#45;&gt;output -->
<g id="edge43" class="edge">
<title>gpu7_residual15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M350,-110.28C350,-101.36 350,-92.31 350,-83.78"/>
<polygon fill="black" stroke="black" points="353.5,-83.67 350,-73.67 346.5,-83.67 353.5,-83.67"/>
</g>
</g>
</svg>
