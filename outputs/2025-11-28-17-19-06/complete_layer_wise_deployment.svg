<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1366pt" height="18000pt"
 viewBox="0.00 0.00 327.79 4320.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.88 1.88) rotate(0) translate(4 9550.85)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-9550.85 721,-9550.85 721,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="91,-9426.31 91,-9538.85 515,-9538.85 515,-9426.31 91,-9426.31"/>
<text text-anchor="middle" x="303" y="-9523.65" font-family="Times,serif" font-size="14.00">Input Batch</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu0</title>
<path fill="lightgray" stroke="black" d="M50,-8387.31C50,-8387.31 642,-8387.31 642,-8387.31 648,-8387.31 654,-8393.31 654,-8399.31 654,-8399.31 654,-9406.31 654,-9406.31 654,-9412.31 648,-9418.31 642,-9418.31 642,-9418.31 50,-9418.31 50,-9418.31 44,-9418.31 38,-9412.31 38,-9406.31 38,-9406.31 38,-8399.31 38,-8399.31 38,-8393.31 44,-8387.31 50,-8387.31"/>
<text text-anchor="middle" x="346" y="-9403.11" font-family="Times,serif" font-size="14.00">GPU 0: Layers 0&#45;1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu1</title>
<path fill="lightgray" stroke="black" d="M50,-7246.77C50,-7246.77 642,-7246.77 642,-7246.77 648,-7246.77 654,-7252.77 654,-7258.77 654,-7258.77 654,-8265.77 654,-8265.77 654,-8271.77 648,-8277.77 642,-8277.77 642,-8277.77 50,-8277.77 50,-8277.77 44,-8277.77 38,-8271.77 38,-8265.77 38,-8265.77 38,-7258.77 38,-7258.77 38,-7252.77 44,-7246.77 50,-7246.77"/>
<text text-anchor="middle" x="346" y="-8262.57" font-family="Times,serif" font-size="14.00">GPU 1: Layers 2&#45;3</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu2</title>
<path fill="lightgray" stroke="black" d="M50,-6106.23C50,-6106.23 642,-6106.23 642,-6106.23 648,-6106.23 654,-6112.23 654,-6118.23 654,-6118.23 654,-7125.23 654,-7125.23 654,-7131.23 648,-7137.23 642,-7137.23 642,-7137.23 50,-7137.23 50,-7137.23 44,-7137.23 38,-7131.23 38,-7125.23 38,-7125.23 38,-6118.23 38,-6118.23 38,-6112.23 44,-6106.23 50,-6106.23"/>
<text text-anchor="middle" x="346" y="-7122.03" font-family="Times,serif" font-size="14.00">GPU 2: Layers 4&#45;5</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu3</title>
<path fill="lightgray" stroke="black" d="M59,-4965.7C59,-4965.7 651,-4965.7 651,-4965.7 657,-4965.7 663,-4971.7 663,-4977.7 663,-4977.7 663,-5984.7 663,-5984.7 663,-5990.7 657,-5996.7 651,-5996.7 651,-5996.7 59,-5996.7 59,-5996.7 53,-5996.7 47,-5990.7 47,-5984.7 47,-5984.7 47,-4977.7 47,-4977.7 47,-4971.7 53,-4965.7 59,-4965.7"/>
<text text-anchor="middle" x="355" y="-5981.5" font-family="Times,serif" font-size="14.00">GPU 3: Layers 6&#45;7</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu4</title>
<path fill="lightgray" stroke="black" d="M37,-3523.16C37,-3523.16 691,-3523.16 691,-3523.16 697,-3523.16 703,-3529.16 703,-3535.16 703,-3535.16 703,-4844.16 703,-4844.16 703,-4850.16 697,-4856.16 691,-4856.16 691,-4856.16 37,-4856.16 37,-4856.16 31,-4856.16 25,-4850.16 25,-4844.16 25,-4844.16 25,-3535.16 25,-3535.16 25,-3529.16 31,-3523.16 37,-3523.16"/>
<text text-anchor="middle" x="364" y="-4840.96" font-family="Times,serif" font-size="14.00">GPU 4: Layers 8&#45;9 (Representative Middle)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu5</title>
<path fill="lightgray" stroke="black" d="M20,-2382.62C20,-2382.62 612,-2382.62 612,-2382.62 618,-2382.62 624,-2388.62 624,-2394.62 624,-2394.62 624,-3401.62 624,-3401.62 624,-3407.62 618,-3413.62 612,-3413.62 612,-3413.62 20,-3413.62 20,-3413.62 14,-3413.62 8,-3407.62 8,-3401.62 8,-3401.62 8,-2394.62 8,-2394.62 8,-2388.62 14,-2382.62 20,-2382.62"/>
<text text-anchor="middle" x="316" y="-3398.42" font-family="Times,serif" font-size="14.00">GPU 5: Layers 10&#45;11</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu6</title>
<path fill="lightgray" stroke="black" d="M74,-1242.08C74,-1242.08 666,-1242.08 666,-1242.08 672,-1242.08 678,-1248.08 678,-1254.08 678,-1254.08 678,-2261.08 678,-2261.08 678,-2267.08 672,-2273.08 666,-2273.08 666,-2273.08 74,-2273.08 74,-2273.08 68,-2273.08 62,-2267.08 62,-2261.08 62,-2261.08 62,-1254.08 62,-1254.08 62,-1248.08 68,-1242.08 74,-1242.08"/>
<text text-anchor="middle" x="370" y="-2257.88" font-family="Times,serif" font-size="14.00">GPU 6: Layers 12&#45;13</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu7</title>
<path fill="lightgray" stroke="black" d="M105,-101.54C105,-101.54 697,-101.54 697,-101.54 703,-101.54 709,-107.54 709,-113.54 709,-113.54 709,-1120.54 709,-1120.54 709,-1126.54 703,-1132.54 697,-1132.54 697,-1132.54 105,-1132.54 105,-1132.54 99,-1132.54 93,-1126.54 93,-1120.54 93,-1120.54 93,-113.54 93,-113.54 93,-107.54 99,-101.54 105,-101.54"/>
<text text-anchor="middle" x="401" y="-1117.34" font-family="Times,serif" font-size="14.00">GPU 7: Layers 14&#45;15 (Final)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightcyan" stroke="black" cx="303" cy="-9471.08" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="303" y="-9485.08" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="303" y="-9474.08" font-family="Arial" font-size="10.00">GPU: Host</text>
<text text-anchor="middle" x="303" y="-9463.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="303" y="-9452.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_layernorm0 -->
<g id="node2" class="node">
<title>gpu0_layernorm0</title>
<polygon fill="lightblue" stroke="black" points="417.5,-9387.31 128.5,-9387.31 128.5,-9335.31 417.5,-9335.31 417.5,-9387.31"/>
<text text-anchor="middle" x="273" y="-9375.31" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="273" y="-9364.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="273" y="-9353.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="273" y="-9342.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- input&#45;&gt;gpu0_layernorm0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;gpu0_layernorm0</title>
<path fill="none" stroke="black" d="M293.01,-9434.2C289.71,-9422.36 286.05,-9409.21 282.77,-9397.43"/>
<polygon fill="black" stroke="black" points="286.06,-9396.19 280.01,-9387.49 279.32,-9398.07 286.06,-9396.19"/>
</g>
<!-- gpu0_residual0 -->
<g id="node6" class="node">
<title>gpu0_residual0</title>
<polygon fill="lightyellow" stroke="black" points="645.74,-9035.31 168.92,-9035.31 46.26,-8909.31 523.08,-8909.31 645.74,-9035.31"/>
<text text-anchor="middle" x="346" y="-8991.81" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="346" y="-8980.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="346" y="-8969.81" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-8958.81" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-8947.81" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- input&#45;&gt;gpu0_residual0 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;gpu0_residual0</title>
<path fill="none" stroke="black" d="M402.26,-9438.82C411.14,-9433.07 419.29,-9426.29 426,-9418.31 468.24,-9368.05 459,-9339.97 459,-9274.31 459,-9274.31 459,-9274.31 459,-9184.31 459,-9133.23 461.08,-9116.88 438,-9071.31 433.12,-9061.67 426.99,-9052.31 420.23,-9043.44"/>
<polygon fill="black" stroke="black" points="422.82,-9041.08 413.85,-9035.44 417.35,-9045.45 422.82,-9041.08"/>
</g>
<!-- gpu0_mha_qkv -->
<g id="node3" class="node">
<title>gpu0_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="430.5,-9299.31 89.5,-9299.31 89.5,-9247.31 430.5,-9247.31 430.5,-9299.31"/>
<text text-anchor="middle" x="260" y="-9287.31" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="260" y="-9276.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="260" y="-9265.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="260" y="-9254.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu0_layernorm0&#45;&gt;gpu0_mha_qkv -->
<g id="edge2" class="edge">
<title>gpu0_layernorm0&#45;&gt;gpu0_mha_qkv</title>
<path fill="none" stroke="black" d="M269.17,-9334.98C267.97,-9327.01 266.62,-9318.08 265.33,-9309.56"/>
<polygon fill="black" stroke="black" points="268.76,-9308.83 263.8,-9299.47 261.84,-9309.88 268.76,-9308.83"/>
</g>
<!-- gpu0_mha_attention -->
<g id="node4" class="node">
<title>gpu0_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="430.5,-9211.31 89.5,-9211.31 89.5,-9159.31 430.5,-9159.31 430.5,-9211.31"/>
<text text-anchor="middle" x="260" y="-9199.31" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="260" y="-9188.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="260" y="-9177.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="260" y="-9166.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu0_mha_qkv&#45;&gt;gpu0_mha_attention -->
<g id="edge3" class="edge">
<title>gpu0_mha_qkv&#45;&gt;gpu0_mha_attention</title>
<path fill="none" stroke="black" d="M260,-9246.98C260,-9239.01 260,-9230.08 260,-9221.56"/>
<polygon fill="black" stroke="black" points="263.5,-9221.47 260,-9211.47 256.5,-9221.47 263.5,-9221.47"/>
</g>
<!-- gpu0_mha_out -->
<g id="node5" class="node">
<title>gpu0_mha_out</title>
<polygon fill="lightblue" stroke="black" points="429,-9123.31 95,-9123.31 95,-9071.31 429,-9071.31 429,-9123.31"/>
<text text-anchor="middle" x="262" y="-9111.31" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="262" y="-9100.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="262" y="-9089.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="262" y="-9078.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_mha_attention&#45;&gt;gpu0_mha_out -->
<g id="edge4" class="edge">
<title>gpu0_mha_attention&#45;&gt;gpu0_mha_out</title>
<path fill="none" stroke="black" d="M260.59,-9158.98C260.77,-9151.01 260.98,-9142.08 261.18,-9133.56"/>
<polygon fill="black" stroke="black" points="264.68,-9133.55 261.41,-9123.47 257.68,-9133.39 264.68,-9133.55"/>
</g>
<!-- gpu0_mha_out&#45;&gt;gpu0_residual0 -->
<g id="edge5" class="edge">
<title>gpu0_mha_out&#45;&gt;gpu0_residual0</title>
<path fill="none" stroke="black" d="M279.2,-9071.13C284.7,-9063.08 291.07,-9053.74 297.66,-9044.09"/>
<polygon fill="black" stroke="black" points="300.74,-9045.79 303.49,-9035.56 294.96,-9041.84 300.74,-9045.79"/>
</g>
<!-- gpu0_layernorm1 -->
<g id="node7" class="node">
<title>gpu0_layernorm1</title>
<polygon fill="lightblue" stroke="black" points="422.5,-8873.31 133.5,-8873.31 133.5,-8821.31 422.5,-8821.31 422.5,-8873.31"/>
<text text-anchor="middle" x="278" y="-8861.31" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="278" y="-8850.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="278" y="-8839.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="278" y="-8828.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_residual0&#45;&gt;gpu0_layernorm1 -->
<g id="edge7" class="edge">
<title>gpu0_residual0&#45;&gt;gpu0_layernorm1</title>
<path fill="none" stroke="black" d="M311.6,-8909.09C306.53,-8899.91 301.47,-8890.76 296.87,-8882.44"/>
<polygon fill="black" stroke="black" points="299.8,-8880.51 291.9,-8873.45 293.67,-8883.89 299.8,-8880.51"/>
</g>
<!-- gpu0_residual1 -->
<g id="node11" class="node">
<title>gpu0_residual1</title>
<polygon fill="lightyellow" stroke="black" points="645.74,-8521.31 168.92,-8521.31 46.26,-8395.31 523.08,-8395.31 645.74,-8521.31"/>
<text text-anchor="middle" x="346" y="-8477.81" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="346" y="-8466.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="346" y="-8455.81" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-8444.81" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-8433.81" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_residual0&#45;&gt;gpu0_residual1 -->
<g id="edge12" class="edge">
<title>gpu0_residual0&#45;&gt;gpu0_residual1</title>
<path fill="none" stroke="black" d="M408.91,-8909.11C417.5,-8897.92 425.3,-8885.81 431,-8873.31 452.03,-8827.16 447,-8811.04 447,-8760.31 447,-8760.31 447,-8760.31 447,-8670.31 447,-8619.81 455.67,-8603.4 435,-8557.31 430.72,-8547.78 425.16,-8538.54 418.9,-8529.79"/>
<polygon fill="black" stroke="black" points="421.51,-8527.44 412.7,-8521.56 415.92,-8531.65 421.51,-8527.44"/>
</g>
<!-- gpu0_ffn_gate -->
<g id="node8" class="node">
<title>gpu0_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="428,-8785.31 118,-8785.31 118,-8733.31 428,-8733.31 428,-8785.31"/>
<text text-anchor="middle" x="273" y="-8773.31" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="273" y="-8762.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="273" y="-8751.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="273" y="-8740.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu0_layernorm1&#45;&gt;gpu0_ffn_gate -->
<g id="edge8" class="edge">
<title>gpu0_layernorm1&#45;&gt;gpu0_ffn_gate</title>
<path fill="none" stroke="black" d="M276.53,-8820.98C276.06,-8813.01 275.54,-8804.08 275.05,-8795.56"/>
<polygon fill="black" stroke="black" points="278.54,-8795.25 274.46,-8785.47 271.55,-8795.66 278.54,-8795.25"/>
</g>
<!-- gpu0_ffn_experts -->
<g id="node9" class="node">
<title>gpu0_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="428,-8697.31 118,-8697.31 118,-8645.31 428,-8645.31 428,-8697.31"/>
<text text-anchor="middle" x="273" y="-8685.31" font-family="Arial" font-size="10.00">FFN Experts</text>
<text text-anchor="middle" x="273" y="-8674.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="273" y="-8663.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="273" y="-8652.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu0_ffn_gate&#45;&gt;gpu0_ffn_experts -->
<g id="edge9" class="edge">
<title>gpu0_ffn_gate&#45;&gt;gpu0_ffn_experts</title>
<path fill="none" stroke="black" d="M273,-8732.98C273,-8725.01 273,-8716.08 273,-8707.56"/>
<polygon fill="black" stroke="black" points="276.5,-8707.47 273,-8697.47 269.5,-8707.47 276.5,-8707.47"/>
</g>
<!-- gpu0_ffn_out -->
<g id="node10" class="node">
<title>gpu0_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="426,-8609.31 124,-8609.31 124,-8557.31 426,-8557.31 426,-8609.31"/>
<text text-anchor="middle" x="275" y="-8597.31" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="275" y="-8586.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="275" y="-8575.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="275" y="-8564.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_ffn_experts&#45;&gt;gpu0_ffn_out -->
<g id="edge10" class="edge">
<title>gpu0_ffn_experts&#45;&gt;gpu0_ffn_out</title>
<path fill="none" stroke="black" d="M273.59,-8644.98C273.77,-8637.01 273.98,-8628.08 274.18,-8619.56"/>
<polygon fill="black" stroke="black" points="277.68,-8619.55 274.41,-8609.47 270.68,-8619.39 277.68,-8619.55"/>
</g>
<!-- gpu0_ffn_out&#45;&gt;gpu0_residual1 -->
<g id="edge11" class="edge">
<title>gpu0_ffn_out&#45;&gt;gpu0_residual1</title>
<path fill="none" stroke="black" d="M289.54,-8557.13C294.14,-8549.16 299.46,-8539.93 304.97,-8530.39"/>
<polygon fill="black" stroke="black" points="308.1,-8531.97 310.07,-8521.56 302.04,-8528.47 308.1,-8531.97"/>
</g>
<!-- comm_gpu0_gpu1 -->
<g id="node12" class="node">
<title>comm_gpu0_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="346" cy="-8322.54" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="346" y="-8336.54" font-family="Arial" font-size="10.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="346" y="-8325.54" font-family="Arial" font-size="10.00">GPU: 0 → 1</text>
<text text-anchor="middle" x="346" y="-8314.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-8303.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu0_residual1&#45;&gt;comm_gpu0_gpu1 -->
<g id="edge13" class="edge">
<title>gpu0_residual1&#45;&gt;comm_gpu0_gpu1</title>
<path fill="none" stroke="black" d="M346,-8395.13C346,-8386.49 346,-8377.75 346,-8369.49"/>
<polygon fill="black" stroke="black" points="349.5,-8369.31 346,-8359.31 342.5,-8369.31 349.5,-8369.31"/>
</g>
<!-- gpu1_layernorm2 -->
<g id="node13" class="node">
<title>gpu1_layernorm2</title>
<polygon fill="lightblue" stroke="black" points="490.5,-8246.77 201.5,-8246.77 201.5,-8194.77 490.5,-8194.77 490.5,-8246.77"/>
<text text-anchor="middle" x="346" y="-8234.77" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="346" y="-8223.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="346" y="-8212.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-8201.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu0_gpu1&#45;&gt;gpu1_layernorm2 -->
<g id="edge14" class="edge">
<title>comm_gpu0_gpu1&#45;&gt;gpu1_layernorm2</title>
<path fill="none" stroke="black" d="M346,-8285.52C346,-8276.2 346,-8266.17 346,-8256.89"/>
<polygon fill="black" stroke="black" points="349.5,-8256.8 346,-8246.8 342.5,-8256.8 349.5,-8256.8"/>
</g>
<!-- gpu1_mha_qkv -->
<g id="node14" class="node">
<title>gpu1_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="449.5,-8158.77 108.5,-8158.77 108.5,-8106.77 449.5,-8106.77 449.5,-8158.77"/>
<text text-anchor="middle" x="279" y="-8146.77" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="279" y="-8135.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="279" y="-8124.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="279" y="-8113.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu1_layernorm2&#45;&gt;gpu1_mha_qkv -->
<g id="edge15" class="edge">
<title>gpu1_layernorm2&#45;&gt;gpu1_mha_qkv</title>
<path fill="none" stroke="black" d="M326.26,-8194.44C319.58,-8185.86 312.02,-8176.16 304.93,-8167.06"/>
<polygon fill="black" stroke="black" points="307.51,-8164.67 298.6,-8158.93 301.98,-8168.97 307.51,-8164.67"/>
</g>
<!-- gpu1_residual2 -->
<g id="node17" class="node">
<title>gpu1_residual2</title>
<polygon fill="lightyellow" stroke="black" points="645.74,-7894.77 168.92,-7894.77 46.26,-7768.77 523.08,-7768.77 645.74,-7894.77"/>
<text text-anchor="middle" x="346" y="-7851.27" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="346" y="-7840.27" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="346" y="-7829.27" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-7818.27" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-7807.27" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu1_layernorm2&#45;&gt;gpu1_residual2 -->
<g id="edge19" class="edge">
<title>gpu1_layernorm2&#45;&gt;gpu1_residual2</title>
<path fill="none" stroke="black" d="M419.83,-8194.64C435.4,-8185.79 449.86,-8174.09 459,-8158.77 490.88,-8105.34 459.71,-8080.99 459,-8018.77 458.56,-7979.66 473.49,-7966.25 457,-7930.77 452.35,-7920.78 446.15,-7911.38 439.04,-7902.67"/>
<polygon fill="black" stroke="black" points="441.47,-7900.12 432.28,-7894.85 436.18,-7904.7 441.47,-7900.12"/>
</g>
<!-- gpu1_mha_attention -->
<g id="node15" class="node">
<title>gpu1_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="449.5,-8070.77 108.5,-8070.77 108.5,-8018.77 449.5,-8018.77 449.5,-8070.77"/>
<text text-anchor="middle" x="279" y="-8058.77" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="279" y="-8047.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="279" y="-8036.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="279" y="-8025.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu1_mha_qkv&#45;&gt;gpu1_mha_attention -->
<g id="edge16" class="edge">
<title>gpu1_mha_qkv&#45;&gt;gpu1_mha_attention</title>
<path fill="none" stroke="black" d="M279,-8106.44C279,-8098.48 279,-8089.54 279,-8081.02"/>
<polygon fill="black" stroke="black" points="282.5,-8080.93 279,-8070.93 275.5,-8080.93 282.5,-8080.93"/>
</g>
<!-- gpu1_mha_out -->
<g id="node16" class="node">
<title>gpu1_mha_out</title>
<polygon fill="lightblue" stroke="black" points="448,-7982.77 114,-7982.77 114,-7930.77 448,-7930.77 448,-7982.77"/>
<text text-anchor="middle" x="281" y="-7970.77" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="281" y="-7959.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="281" y="-7948.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="281" y="-7937.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu1_mha_attention&#45;&gt;gpu1_mha_out -->
<g id="edge17" class="edge">
<title>gpu1_mha_attention&#45;&gt;gpu1_mha_out</title>
<path fill="none" stroke="black" d="M279.59,-8018.44C279.77,-8010.48 279.98,-8001.54 280.18,-7993.02"/>
<polygon fill="black" stroke="black" points="283.68,-7993.01 280.41,-7982.93 276.68,-7992.85 283.68,-7993.01"/>
</g>
<!-- gpu1_mha_out&#45;&gt;gpu1_residual2 -->
<g id="edge18" class="edge">
<title>gpu1_mha_out&#45;&gt;gpu1_residual2</title>
<path fill="none" stroke="black" d="M294.31,-7930.59C298.48,-7922.7 303.3,-7913.58 308.29,-7904.14"/>
<polygon fill="black" stroke="black" points="311.53,-7905.5 313.11,-7895.02 305.34,-7902.23 311.53,-7905.5"/>
</g>
<!-- gpu1_layernorm3 -->
<g id="node18" class="node">
<title>gpu1_layernorm3</title>
<polygon fill="lightblue" stroke="black" points="422.5,-7732.77 133.5,-7732.77 133.5,-7680.77 422.5,-7680.77 422.5,-7732.77"/>
<text text-anchor="middle" x="278" y="-7720.77" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="278" y="-7709.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="278" y="-7698.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="278" y="-7687.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu1_residual2&#45;&gt;gpu1_layernorm3 -->
<g id="edge20" class="edge">
<title>gpu1_residual2&#45;&gt;gpu1_layernorm3</title>
<path fill="none" stroke="black" d="M311.6,-7768.55C306.53,-7759.37 301.47,-7750.22 296.87,-7741.9"/>
<polygon fill="black" stroke="black" points="299.8,-7739.97 291.9,-7732.91 293.67,-7743.36 299.8,-7739.97"/>
</g>
<!-- gpu1_residual3 -->
<g id="node22" class="node">
<title>gpu1_residual3</title>
<polygon fill="lightyellow" stroke="black" points="645.74,-7380.77 168.92,-7380.77 46.26,-7254.77 523.08,-7254.77 645.74,-7380.77"/>
<text text-anchor="middle" x="346" y="-7337.27" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="346" y="-7326.27" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="346" y="-7315.27" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-7304.27" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-7293.27" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu1_residual2&#45;&gt;gpu1_residual3 -->
<g id="edge25" class="edge">
<title>gpu1_residual2&#45;&gt;gpu1_residual3</title>
<path fill="none" stroke="black" d="M408.91,-7768.58C417.5,-7757.38 425.3,-7745.28 431,-7732.77 452.03,-7686.62 447,-7670.5 447,-7619.77 447,-7619.77 447,-7619.77 447,-7529.77 447,-7479.27 455.67,-7462.86 435,-7416.77 430.72,-7407.24 425.16,-7398 418.9,-7389.25"/>
<polygon fill="black" stroke="black" points="421.51,-7386.9 412.7,-7381.02 415.92,-7391.11 421.51,-7386.9"/>
</g>
<!-- gpu1_ffn_gate -->
<g id="node19" class="node">
<title>gpu1_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="428,-7644.77 118,-7644.77 118,-7592.77 428,-7592.77 428,-7644.77"/>
<text text-anchor="middle" x="273" y="-7632.77" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="273" y="-7621.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="273" y="-7610.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="273" y="-7599.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu1_layernorm3&#45;&gt;gpu1_ffn_gate -->
<g id="edge21" class="edge">
<title>gpu1_layernorm3&#45;&gt;gpu1_ffn_gate</title>
<path fill="none" stroke="black" d="M276.53,-7680.44C276.06,-7672.48 275.54,-7663.54 275.05,-7655.02"/>
<polygon fill="black" stroke="black" points="278.54,-7654.71 274.46,-7644.93 271.55,-7655.12 278.54,-7654.71"/>
</g>
<!-- gpu1_ffn_experts -->
<g id="node20" class="node">
<title>gpu1_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="428,-7556.77 118,-7556.77 118,-7504.77 428,-7504.77 428,-7556.77"/>
<text text-anchor="middle" x="273" y="-7544.77" font-family="Arial" font-size="10.00">FFN Experts</text>
<text text-anchor="middle" x="273" y="-7533.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="273" y="-7522.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="273" y="-7511.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu1_ffn_gate&#45;&gt;gpu1_ffn_experts -->
<g id="edge22" class="edge">
<title>gpu1_ffn_gate&#45;&gt;gpu1_ffn_experts</title>
<path fill="none" stroke="black" d="M273,-7592.44C273,-7584.48 273,-7575.54 273,-7567.02"/>
<polygon fill="black" stroke="black" points="276.5,-7566.93 273,-7556.93 269.5,-7566.93 276.5,-7566.93"/>
</g>
<!-- gpu1_ffn_out -->
<g id="node21" class="node">
<title>gpu1_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="426,-7468.77 124,-7468.77 124,-7416.77 426,-7416.77 426,-7468.77"/>
<text text-anchor="middle" x="275" y="-7456.77" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="275" y="-7445.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="275" y="-7434.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="275" y="-7423.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu1_ffn_experts&#45;&gt;gpu1_ffn_out -->
<g id="edge23" class="edge">
<title>gpu1_ffn_experts&#45;&gt;gpu1_ffn_out</title>
<path fill="none" stroke="black" d="M273.59,-7504.44C273.77,-7496.48 273.98,-7487.54 274.18,-7479.02"/>
<polygon fill="black" stroke="black" points="277.68,-7479.01 274.41,-7468.93 270.68,-7478.85 277.68,-7479.01"/>
</g>
<!-- gpu1_ffn_out&#45;&gt;gpu1_residual3 -->
<g id="edge24" class="edge">
<title>gpu1_ffn_out&#45;&gt;gpu1_residual3</title>
<path fill="none" stroke="black" d="M289.54,-7416.59C294.14,-7408.62 299.46,-7399.39 304.97,-7389.85"/>
<polygon fill="black" stroke="black" points="308.1,-7391.43 310.07,-7381.02 302.04,-7387.93 308.1,-7391.43"/>
</g>
<!-- comm_gpu1_gpu2 -->
<g id="node23" class="node">
<title>comm_gpu1_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="346" cy="-7182" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="346" y="-7196" font-family="Arial" font-size="10.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="346" y="-7185" font-family="Arial" font-size="10.00">GPU: 1 → 2</text>
<text text-anchor="middle" x="346" y="-7174" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-7163" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu1_residual3&#45;&gt;comm_gpu1_gpu2 -->
<g id="edge26" class="edge">
<title>gpu1_residual3&#45;&gt;comm_gpu1_gpu2</title>
<path fill="none" stroke="black" d="M346,-7254.59C346,-7245.95 346,-7237.21 346,-7228.95"/>
<polygon fill="black" stroke="black" points="349.5,-7228.78 346,-7218.78 342.5,-7228.78 349.5,-7228.78"/>
</g>
<!-- gpu2_layernorm4 -->
<g id="node24" class="node">
<title>gpu2_layernorm4</title>
<polygon fill="lightblue" stroke="black" points="490.5,-7106.23 201.5,-7106.23 201.5,-7054.23 490.5,-7054.23 490.5,-7106.23"/>
<text text-anchor="middle" x="346" y="-7094.23" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="346" y="-7083.23" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="346" y="-7072.23" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-7061.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu1_gpu2&#45;&gt;gpu2_layernorm4 -->
<g id="edge27" class="edge">
<title>comm_gpu1_gpu2&#45;&gt;gpu2_layernorm4</title>
<path fill="none" stroke="black" d="M346,-7144.99C346,-7135.66 346,-7125.63 346,-7116.35"/>
<polygon fill="black" stroke="black" points="349.5,-7116.27 346,-7106.27 342.5,-7116.27 349.5,-7116.27"/>
</g>
<!-- gpu2_mha_qkv -->
<g id="node25" class="node">
<title>gpu2_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="449.5,-7018.23 108.5,-7018.23 108.5,-6966.23 449.5,-6966.23 449.5,-7018.23"/>
<text text-anchor="middle" x="279" y="-7006.23" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="279" y="-6995.23" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="279" y="-6984.23" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="279" y="-6973.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu2_layernorm4&#45;&gt;gpu2_mha_qkv -->
<g id="edge28" class="edge">
<title>gpu2_layernorm4&#45;&gt;gpu2_mha_qkv</title>
<path fill="none" stroke="black" d="M326.26,-7053.9C319.58,-7045.32 312.02,-7035.62 304.93,-7026.52"/>
<polygon fill="black" stroke="black" points="307.51,-7024.13 298.6,-7018.39 301.98,-7028.43 307.51,-7024.13"/>
</g>
<!-- gpu2_residual4 -->
<g id="node28" class="node">
<title>gpu2_residual4</title>
<polygon fill="lightyellow" stroke="black" points="645.74,-6754.23 168.92,-6754.23 46.26,-6628.23 523.08,-6628.23 645.74,-6754.23"/>
<text text-anchor="middle" x="346" y="-6710.73" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="346" y="-6699.73" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="346" y="-6688.73" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-6677.73" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-6666.73" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu2_layernorm4&#45;&gt;gpu2_residual4 -->
<g id="edge32" class="edge">
<title>gpu2_layernorm4&#45;&gt;gpu2_residual4</title>
<path fill="none" stroke="black" d="M419.83,-7054.1C435.4,-7045.25 449.86,-7033.55 459,-7018.23 490.88,-6964.8 459.71,-6940.45 459,-6878.23 458.56,-6839.12 473.49,-6825.71 457,-6790.23 452.35,-6780.24 446.15,-6770.84 439.04,-6762.13"/>
<polygon fill="black" stroke="black" points="441.47,-6759.58 432.28,-6754.31 436.18,-6764.17 441.47,-6759.58"/>
</g>
<!-- gpu2_mha_attention -->
<g id="node26" class="node">
<title>gpu2_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="449.5,-6930.23 108.5,-6930.23 108.5,-6878.23 449.5,-6878.23 449.5,-6930.23"/>
<text text-anchor="middle" x="279" y="-6918.23" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="279" y="-6907.23" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="279" y="-6896.23" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="279" y="-6885.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu2_mha_qkv&#45;&gt;gpu2_mha_attention -->
<g id="edge29" class="edge">
<title>gpu2_mha_qkv&#45;&gt;gpu2_mha_attention</title>
<path fill="none" stroke="black" d="M279,-6965.9C279,-6957.94 279,-6949 279,-6940.48"/>
<polygon fill="black" stroke="black" points="282.5,-6940.39 279,-6930.39 275.5,-6940.39 282.5,-6940.39"/>
</g>
<!-- gpu2_mha_out -->
<g id="node27" class="node">
<title>gpu2_mha_out</title>
<polygon fill="lightblue" stroke="black" points="448,-6842.23 114,-6842.23 114,-6790.23 448,-6790.23 448,-6842.23"/>
<text text-anchor="middle" x="281" y="-6830.23" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="281" y="-6819.23" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="281" y="-6808.23" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="281" y="-6797.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu2_mha_attention&#45;&gt;gpu2_mha_out -->
<g id="edge30" class="edge">
<title>gpu2_mha_attention&#45;&gt;gpu2_mha_out</title>
<path fill="none" stroke="black" d="M279.59,-6877.9C279.77,-6869.94 279.98,-6861 280.18,-6852.48"/>
<polygon fill="black" stroke="black" points="283.68,-6852.47 280.41,-6842.39 276.68,-6852.31 283.68,-6852.47"/>
</g>
<!-- gpu2_mha_out&#45;&gt;gpu2_residual4 -->
<g id="edge31" class="edge">
<title>gpu2_mha_out&#45;&gt;gpu2_residual4</title>
<path fill="none" stroke="black" d="M294.31,-6790.05C298.48,-6782.16 303.3,-6773.04 308.29,-6763.6"/>
<polygon fill="black" stroke="black" points="311.53,-6764.96 313.11,-6754.48 305.34,-6761.69 311.53,-6764.96"/>
</g>
<!-- gpu2_layernorm5 -->
<g id="node29" class="node">
<title>gpu2_layernorm5</title>
<polygon fill="lightblue" stroke="black" points="420.5,-6592.23 131.5,-6592.23 131.5,-6540.23 420.5,-6540.23 420.5,-6592.23"/>
<text text-anchor="middle" x="276" y="-6580.23" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="276" y="-6569.23" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="276" y="-6558.23" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="276" y="-6547.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu2_residual4&#45;&gt;gpu2_layernorm5 -->
<g id="edge33" class="edge">
<title>gpu2_residual4&#45;&gt;gpu2_layernorm5</title>
<path fill="none" stroke="black" d="M310.59,-6628.01C305.31,-6618.74 300.04,-6609.48 295.27,-6601.09"/>
<polygon fill="black" stroke="black" points="298.29,-6599.33 290.31,-6592.37 292.21,-6602.79 298.29,-6599.33"/>
</g>
<!-- gpu2_residual5 -->
<g id="node33" class="node">
<title>gpu2_residual5</title>
<polygon fill="lightyellow" stroke="black" points="645.74,-6240.23 168.92,-6240.23 46.26,-6114.23 523.08,-6114.23 645.74,-6240.23"/>
<text text-anchor="middle" x="346" y="-6196.73" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="346" y="-6185.73" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="346" y="-6174.73" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-6163.73" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-6152.73" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu2_residual4&#45;&gt;gpu2_residual5 -->
<g id="edge38" class="edge">
<title>gpu2_residual4&#45;&gt;gpu2_residual5</title>
<path fill="none" stroke="black" d="M407.31,-6628.19C415.76,-6616.94 423.44,-6604.77 429,-6592.23 449.54,-6545.92 444,-6529.9 444,-6479.23 444,-6479.23 444,-6479.23 444,-6389.23 444,-6338.73 452.27,-6322.49 432,-6276.23 427.83,-6266.73 422.4,-6257.49 416.29,-6248.71"/>
<polygon fill="black" stroke="black" points="418.98,-6246.46 410.24,-6240.46 413.33,-6250.59 418.98,-6246.46"/>
</g>
<!-- gpu2_ffn_gate -->
<g id="node30" class="node">
<title>gpu2_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="425,-6504.23 115,-6504.23 115,-6452.23 425,-6452.23 425,-6504.23"/>
<text text-anchor="middle" x="270" y="-6492.23" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="270" y="-6481.23" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="270" y="-6470.23" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="270" y="-6459.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu2_layernorm5&#45;&gt;gpu2_ffn_gate -->
<g id="edge34" class="edge">
<title>gpu2_layernorm5&#45;&gt;gpu2_ffn_gate</title>
<path fill="none" stroke="black" d="M274.23,-6539.9C273.68,-6531.94 273.05,-6523 272.46,-6514.48"/>
<polygon fill="black" stroke="black" points="275.94,-6514.12 271.76,-6504.39 268.96,-6514.61 275.94,-6514.12"/>
</g>
<!-- gpu2_ffn_experts -->
<g id="node31" class="node">
<title>gpu2_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="425,-6416.23 115,-6416.23 115,-6364.23 425,-6364.23 425,-6416.23"/>
<text text-anchor="middle" x="270" y="-6404.23" font-family="Arial" font-size="10.00">FFN Experts</text>
<text text-anchor="middle" x="270" y="-6393.23" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="270" y="-6382.23" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="270" y="-6371.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu2_ffn_gate&#45;&gt;gpu2_ffn_experts -->
<g id="edge35" class="edge">
<title>gpu2_ffn_gate&#45;&gt;gpu2_ffn_experts</title>
<path fill="none" stroke="black" d="M270,-6451.9C270,-6443.94 270,-6435 270,-6426.48"/>
<polygon fill="black" stroke="black" points="273.5,-6426.39 270,-6416.39 266.5,-6426.39 273.5,-6426.39"/>
</g>
<!-- gpu2_ffn_out -->
<g id="node32" class="node">
<title>gpu2_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="423,-6328.23 121,-6328.23 121,-6276.23 423,-6276.23 423,-6328.23"/>
<text text-anchor="middle" x="272" y="-6316.23" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="272" y="-6305.23" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="272" y="-6294.23" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="272" y="-6283.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu2_ffn_experts&#45;&gt;gpu2_ffn_out -->
<g id="edge36" class="edge">
<title>gpu2_ffn_experts&#45;&gt;gpu2_ffn_out</title>
<path fill="none" stroke="black" d="M270.59,-6363.9C270.77,-6355.94 270.98,-6347 271.18,-6338.48"/>
<polygon fill="black" stroke="black" points="274.68,-6338.47 271.41,-6328.39 267.68,-6338.31 274.68,-6338.47"/>
</g>
<!-- gpu2_ffn_out&#45;&gt;gpu2_residual5 -->
<g id="edge37" class="edge">
<title>gpu2_ffn_out&#45;&gt;gpu2_residual5</title>
<path fill="none" stroke="black" d="M287.15,-6276.05C291.94,-6268.08 297.5,-6258.85 303.24,-6249.31"/>
<polygon fill="black" stroke="black" points="306.4,-6250.85 308.55,-6240.48 300.4,-6247.25 306.4,-6250.85"/>
</g>
<!-- comm_gpu2_gpu3 -->
<g id="node34" class="node">
<title>comm_gpu2_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="346" cy="-6041.47" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="346" y="-6055.47" font-family="Arial" font-size="10.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="346" y="-6044.47" font-family="Arial" font-size="10.00">GPU: 2 → 3</text>
<text text-anchor="middle" x="346" y="-6033.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-6022.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu2_residual5&#45;&gt;comm_gpu2_gpu3 -->
<g id="edge39" class="edge">
<title>gpu2_residual5&#45;&gt;comm_gpu2_gpu3</title>
<path fill="none" stroke="black" d="M346,-6114.05C346,-6105.41 346,-6096.67 346,-6088.41"/>
<polygon fill="black" stroke="black" points="349.5,-6088.24 346,-6078.24 342.5,-6088.24 349.5,-6088.24"/>
</g>
<!-- gpu3_layernorm6 -->
<g id="node35" class="node">
<title>gpu3_layernorm6</title>
<polygon fill="lightblue" stroke="black" points="490.5,-5965.7 201.5,-5965.7 201.5,-5913.7 490.5,-5913.7 490.5,-5965.7"/>
<text text-anchor="middle" x="346" y="-5953.7" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="346" y="-5942.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="346" y="-5931.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="346" y="-5920.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu2_gpu3&#45;&gt;gpu3_layernorm6 -->
<g id="edge40" class="edge">
<title>comm_gpu2_gpu3&#45;&gt;gpu3_layernorm6</title>
<path fill="none" stroke="black" d="M346,-6004.45C346,-5995.12 346,-5985.09 346,-5975.81"/>
<polygon fill="black" stroke="black" points="349.5,-5975.73 346,-5965.73 342.5,-5975.73 349.5,-5975.73"/>
</g>
<!-- gpu3_mha_qkv -->
<g id="node36" class="node">
<title>gpu3_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="456.5,-5877.7 115.5,-5877.7 115.5,-5825.7 456.5,-5825.7 456.5,-5877.7"/>
<text text-anchor="middle" x="286" y="-5865.7" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="286" y="-5854.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="286" y="-5843.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="286" y="-5832.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu3_layernorm6&#45;&gt;gpu3_mha_qkv -->
<g id="edge41" class="edge">
<title>gpu3_layernorm6&#45;&gt;gpu3_mha_qkv</title>
<path fill="none" stroke="black" d="M328.32,-5913.36C322.4,-5904.87 315.71,-5895.28 309.42,-5886.26"/>
<polygon fill="black" stroke="black" points="312.14,-5884.05 303.55,-5877.85 306.4,-5888.06 312.14,-5884.05"/>
</g>
<!-- gpu3_residual6 -->
<g id="node39" class="node">
<title>gpu3_residual6</title>
<polygon fill="lightyellow" stroke="black" points="654.74,-5613.7 177.92,-5613.7 55.26,-5487.7 532.08,-5487.7 654.74,-5613.7"/>
<text text-anchor="middle" x="355" y="-5570.2" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="355" y="-5559.2" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="355" y="-5548.2" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="355" y="-5537.2" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="355" y="-5526.2" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu3_layernorm6&#45;&gt;gpu3_residual6 -->
<g id="edge45" class="edge">
<title>gpu3_layernorm6&#45;&gt;gpu3_residual6</title>
<path fill="none" stroke="black" d="M425.85,-5913.6C441.79,-5904.82 456.53,-5893.13 466,-5877.7 518.99,-5791.32 506.3,-5741.78 464,-5649.7 459.45,-5639.78 453.36,-5630.44 446.38,-5621.75"/>
<polygon fill="black" stroke="black" points="448.89,-5619.31 439.74,-5613.97 443.57,-5623.85 448.89,-5619.31"/>
</g>
<!-- gpu3_mha_attention -->
<g id="node37" class="node">
<title>gpu3_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="456.5,-5789.7 115.5,-5789.7 115.5,-5737.7 456.5,-5737.7 456.5,-5789.7"/>
<text text-anchor="middle" x="286" y="-5777.7" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="286" y="-5766.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="286" y="-5755.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="286" y="-5744.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu3_mha_qkv&#45;&gt;gpu3_mha_attention -->
<g id="edge42" class="edge">
<title>gpu3_mha_qkv&#45;&gt;gpu3_mha_attention</title>
<path fill="none" stroke="black" d="M286,-5825.36C286,-5817.4 286,-5808.46 286,-5799.94"/>
<polygon fill="black" stroke="black" points="289.5,-5799.85 286,-5789.85 282.5,-5799.85 289.5,-5799.85"/>
</g>
<!-- gpu3_mha_out -->
<g id="node38" class="node">
<title>gpu3_mha_out</title>
<polygon fill="lightblue" stroke="black" points="455,-5701.7 121,-5701.7 121,-5649.7 455,-5649.7 455,-5701.7"/>
<text text-anchor="middle" x="288" y="-5689.7" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="288" y="-5678.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="288" y="-5667.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="288" y="-5656.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu3_mha_attention&#45;&gt;gpu3_mha_out -->
<g id="edge43" class="edge">
<title>gpu3_mha_attention&#45;&gt;gpu3_mha_out</title>
<path fill="none" stroke="black" d="M286.59,-5737.36C286.77,-5729.4 286.98,-5720.46 287.18,-5711.94"/>
<polygon fill="black" stroke="black" points="290.68,-5711.93 287.41,-5701.85 283.68,-5711.77 290.68,-5711.93"/>
</g>
<!-- gpu3_mha_out&#45;&gt;gpu3_residual6 -->
<g id="edge44" class="edge">
<title>gpu3_mha_out&#45;&gt;gpu3_residual6</title>
<path fill="none" stroke="black" d="M301.72,-5649.51C306.06,-5641.54 311.09,-5632.31 316.29,-5622.77"/>
<polygon fill="black" stroke="black" points="319.38,-5624.4 321.09,-5613.94 313.24,-5621.05 319.38,-5624.4"/>
</g>
<!-- gpu3_layernorm7 -->
<g id="node40" class="node">
<title>gpu3_layernorm7</title>
<polygon fill="lightblue" stroke="black" points="429.5,-5451.7 140.5,-5451.7 140.5,-5399.7 429.5,-5399.7 429.5,-5451.7"/>
<text text-anchor="middle" x="285" y="-5439.7" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="285" y="-5428.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="285" y="-5417.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="285" y="-5406.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu3_residual6&#45;&gt;gpu3_layernorm7 -->
<g id="edge46" class="edge">
<title>gpu3_residual6&#45;&gt;gpu3_layernorm7</title>
<path fill="none" stroke="black" d="M319.59,-5487.47C314.31,-5478.2 309.04,-5468.94 304.27,-5460.55"/>
<polygon fill="black" stroke="black" points="307.29,-5458.79 299.31,-5451.83 301.21,-5462.25 307.29,-5458.79"/>
</g>
<!-- gpu3_residual7 -->
<g id="node44" class="node">
<title>gpu3_residual7</title>
<polygon fill="lightyellow" stroke="black" points="654.74,-5099.7 177.92,-5099.7 55.26,-4973.7 532.08,-4973.7 654.74,-5099.7"/>
<text text-anchor="middle" x="355" y="-5056.2" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="355" y="-5045.2" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="355" y="-5034.2" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="355" y="-5023.2" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="355" y="-5012.2" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu3_residual6&#45;&gt;gpu3_residual7 -->
<g id="edge51" class="edge">
<title>gpu3_residual6&#45;&gt;gpu3_residual7</title>
<path fill="none" stroke="black" d="M416.21,-5487.61C424.68,-5476.36 432.39,-5464.21 438,-5451.7 458.76,-5405.42 454,-5389.42 454,-5338.7 454,-5338.7 454,-5338.7 454,-5248.7 454,-5198.19 462.4,-5181.89 442,-5135.7 437.79,-5126.15 432.29,-5116.89 426.11,-5108.1"/>
<polygon fill="black" stroke="black" points="428.75,-5105.79 419.99,-5099.83 423.12,-5109.95 428.75,-5105.79"/>
</g>
<!-- gpu3_ffn_gate -->
<g id="node41" class="node">
<title>gpu3_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="435,-5363.7 125,-5363.7 125,-5311.7 435,-5311.7 435,-5363.7"/>
<text text-anchor="middle" x="280" y="-5351.7" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="280" y="-5340.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="280" y="-5329.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="280" y="-5318.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu3_layernorm7&#45;&gt;gpu3_ffn_gate -->
<g id="edge47" class="edge">
<title>gpu3_layernorm7&#45;&gt;gpu3_ffn_gate</title>
<path fill="none" stroke="black" d="M283.53,-5399.36C283.06,-5391.4 282.54,-5382.46 282.05,-5373.94"/>
<polygon fill="black" stroke="black" points="285.54,-5373.63 281.46,-5363.85 278.55,-5374.04 285.54,-5373.63"/>
</g>
<!-- gpu3_ffn_experts -->
<g id="node42" class="node">
<title>gpu3_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="435,-5275.7 125,-5275.7 125,-5223.7 435,-5223.7 435,-5275.7"/>
<text text-anchor="middle" x="280" y="-5263.7" font-family="Arial" font-size="10.00">FFN Experts</text>
<text text-anchor="middle" x="280" y="-5252.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="280" y="-5241.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="280" y="-5230.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu3_ffn_gate&#45;&gt;gpu3_ffn_experts -->
<g id="edge48" class="edge">
<title>gpu3_ffn_gate&#45;&gt;gpu3_ffn_experts</title>
<path fill="none" stroke="black" d="M280,-5311.36C280,-5303.4 280,-5294.46 280,-5285.94"/>
<polygon fill="black" stroke="black" points="283.5,-5285.85 280,-5275.85 276.5,-5285.85 283.5,-5285.85"/>
</g>
<!-- gpu3_ffn_out -->
<g id="node43" class="node">
<title>gpu3_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="433,-5187.7 131,-5187.7 131,-5135.7 433,-5135.7 433,-5187.7"/>
<text text-anchor="middle" x="282" y="-5175.7" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="282" y="-5164.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="282" y="-5153.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="282" y="-5142.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu3_ffn_experts&#45;&gt;gpu3_ffn_out -->
<g id="edge49" class="edge">
<title>gpu3_ffn_experts&#45;&gt;gpu3_ffn_out</title>
<path fill="none" stroke="black" d="M280.59,-5223.36C280.77,-5215.4 280.98,-5206.46 281.18,-5197.94"/>
<polygon fill="black" stroke="black" points="284.68,-5197.93 281.41,-5187.85 277.68,-5197.77 284.68,-5197.93"/>
</g>
<!-- gpu3_ffn_out&#45;&gt;gpu3_residual7 -->
<g id="edge50" class="edge">
<title>gpu3_ffn_out&#45;&gt;gpu3_residual7</title>
<path fill="none" stroke="black" d="M296.95,-5135.51C301.68,-5127.54 307.15,-5118.31 312.82,-5108.77"/>
<polygon fill="black" stroke="black" points="315.96,-5110.33 318.06,-5099.94 309.94,-5106.75 315.96,-5110.33"/>
</g>
<!-- comm_gpu3_gpu4 -->
<g id="node45" class="node">
<title>comm_gpu3_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="355" cy="-4900.93" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="355" y="-4914.93" font-family="Arial" font-size="10.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="355" y="-4903.93" font-family="Arial" font-size="10.00">GPU: 3 → 4</text>
<text text-anchor="middle" x="355" y="-4892.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="355" y="-4881.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu3_residual7&#45;&gt;comm_gpu3_gpu4 -->
<g id="edge52" class="edge">
<title>gpu3_residual7&#45;&gt;comm_gpu3_gpu4</title>
<path fill="none" stroke="black" d="M355,-4973.51C355,-4964.87 355,-4956.13 355,-4947.87"/>
<polygon fill="black" stroke="black" points="358.5,-4947.7 355,-4937.7 351.5,-4947.7 358.5,-4947.7"/>
</g>
<!-- gpu4_layernorm8 -->
<g id="node46" class="node">
<title>gpu4_layernorm8</title>
<polygon fill="lightblue" stroke="black" points="499.5,-4825.16 210.5,-4825.16 210.5,-4773.16 499.5,-4773.16 499.5,-4825.16"/>
<text text-anchor="middle" x="355" y="-4813.16" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="355" y="-4802.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="355" y="-4791.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="355" y="-4780.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu3_gpu4&#45;&gt;gpu4_layernorm8 -->
<g id="edge53" class="edge">
<title>comm_gpu3_gpu4&#45;&gt;gpu4_layernorm8</title>
<path fill="none" stroke="black" d="M355,-4863.91C355,-4854.58 355,-4844.55 355,-4835.27"/>
<polygon fill="black" stroke="black" points="358.5,-4835.19 355,-4825.19 351.5,-4835.19 358.5,-4835.19"/>
</g>
<!-- gpu4_mha_qkv -->
<g id="node47" class="node">
<title>gpu4_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="450.5,-4737.16 109.5,-4737.16 109.5,-4685.16 450.5,-4685.16 450.5,-4737.16"/>
<text text-anchor="middle" x="280" y="-4725.16" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="280" y="-4714.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="280" y="-4703.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="280" y="-4692.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu4_layernorm8&#45;&gt;gpu4_mha_qkv -->
<g id="edge54" class="edge">
<title>gpu4_layernorm8&#45;&gt;gpu4_mha_qkv</title>
<path fill="none" stroke="black" d="M332.9,-4772.82C325.27,-4764.07 316.62,-4754.14 308.54,-4744.89"/>
<polygon fill="black" stroke="black" points="311.15,-4742.55 301.94,-4737.31 305.87,-4747.15 311.15,-4742.55"/>
</g>
<!-- gpu4_residual8 -->
<g id="node50" class="node">
<title>gpu4_residual8</title>
<polygon fill="lightyellow" stroke="black" points="694.74,-4473.16 217.92,-4473.16 95.26,-4347.16 572.08,-4347.16 694.74,-4473.16"/>
<text text-anchor="middle" x="395" y="-4429.66" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="395" y="-4418.66" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="395" y="-4407.66" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="395" y="-4396.66" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="395" y="-4385.66" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_layernorm8&#45;&gt;gpu4_residual8 -->
<g id="edge58" class="edge">
<title>gpu4_layernorm8&#45;&gt;gpu4_residual8</title>
<path fill="none" stroke="black" d="M422.09,-4773.01C437.17,-4764.07 451.27,-4752.32 460,-4737.16 510.55,-4649.33 487.66,-4606.06 458,-4509.16 455.21,-4500.04 451.31,-4490.96 446.81,-4482.21"/>
<polygon fill="black" stroke="black" points="449.77,-4480.34 441.92,-4473.23 443.62,-4483.68 449.77,-4480.34"/>
</g>
<!-- gpu4_mha_attention -->
<g id="node48" class="node">
<title>gpu4_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="450.5,-4649.16 109.5,-4649.16 109.5,-4597.16 450.5,-4597.16 450.5,-4649.16"/>
<text text-anchor="middle" x="280" y="-4637.16" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="280" y="-4626.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="280" y="-4615.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="280" y="-4604.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu4_mha_qkv&#45;&gt;gpu4_mha_attention -->
<g id="edge55" class="edge">
<title>gpu4_mha_qkv&#45;&gt;gpu4_mha_attention</title>
<path fill="none" stroke="black" d="M280,-4684.82C280,-4676.86 280,-4667.92 280,-4659.4"/>
<polygon fill="black" stroke="black" points="283.5,-4659.31 280,-4649.31 276.5,-4659.31 283.5,-4659.31"/>
</g>
<!-- gpu4_mha_out -->
<g id="node49" class="node">
<title>gpu4_mha_out</title>
<polygon fill="lightblue" stroke="black" points="449,-4561.16 115,-4561.16 115,-4509.16 449,-4509.16 449,-4561.16"/>
<text text-anchor="middle" x="282" y="-4549.16" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="282" y="-4538.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="282" y="-4527.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="282" y="-4516.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_mha_attention&#45;&gt;gpu4_mha_out -->
<g id="edge56" class="edge">
<title>gpu4_mha_attention&#45;&gt;gpu4_mha_out</title>
<path fill="none" stroke="black" d="M280.59,-4596.82C280.77,-4588.86 280.98,-4579.92 281.18,-4571.4"/>
<polygon fill="black" stroke="black" points="284.68,-4571.39 281.41,-4561.31 277.68,-4571.23 284.68,-4571.39"/>
</g>
<!-- gpu4_mha_out&#45;&gt;gpu4_residual8 -->
<g id="edge57" class="edge">
<title>gpu4_mha_out&#45;&gt;gpu4_residual8</title>
<path fill="none" stroke="black" d="M305.14,-4508.97C312.76,-4500.68 321.63,-4491.02 330.78,-4481.06"/>
<polygon fill="black" stroke="black" points="333.63,-4483.13 337.81,-4473.4 328.47,-4478.4 333.63,-4483.13"/>
</g>
<!-- gpu4_layernorm9 -->
<g id="node51" class="node">
<title>gpu4_layernorm9</title>
<polygon fill="lightblue" stroke="black" points="530.5,-4311.16 241.5,-4311.16 241.5,-4259.16 530.5,-4259.16 530.5,-4311.16"/>
<text text-anchor="middle" x="386" y="-4299.16" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="386" y="-4288.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="386" y="-4277.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="386" y="-4266.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_residual8&#45;&gt;gpu4_layernorm9 -->
<g id="edge59" class="edge">
<title>gpu4_residual8&#45;&gt;gpu4_layernorm9</title>
<path fill="none" stroke="black" d="M390.45,-4346.94C389.8,-4338.15 389.16,-4329.39 388.58,-4321.36"/>
<polygon fill="black" stroke="black" points="392.06,-4321.01 387.84,-4311.29 385.08,-4321.52 392.06,-4321.01"/>
</g>
<!-- gpu4_residual9 -->
<g id="node58" class="node">
<title>gpu4_residual9</title>
<polygon fill="lightyellow" stroke="black" points="683.74,-3657.16 206.92,-3657.16 84.26,-3531.16 561.08,-3531.16 683.74,-3657.16"/>
<text text-anchor="middle" x="384" y="-3613.66" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="384" y="-3602.66" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="384" y="-3591.66" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="384" y="-3580.66" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="384" y="-3569.66" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_residual8&#45;&gt;gpu4_residual9 -->
<g id="edge68" class="edge">
<title>gpu4_residual8&#45;&gt;gpu4_residual9</title>
<path fill="none" stroke="black" d="M575.4,-4349.97C638.54,-4317.05 694,-4268.2 694,-4198.16 694,-4198.16 694,-4198.16 694,-3843.16 694,-3815.24 699.48,-3804.38 684,-3781.16 650.35,-3730.66 597.84,-3691.4 546.11,-3662.24"/>
<polygon fill="black" stroke="black" points="547.58,-3659.06 537.14,-3657.28 544.2,-3665.18 547.58,-3659.06"/>
</g>
<!-- gpu4_ffn_gate -->
<g id="node52" class="node">
<title>gpu4_ffn_gate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="523,-4223.16 213,-4223.16 213,-4171.16 523,-4171.16 523,-4223.16"/>
<text text-anchor="middle" x="368" y="-4211.16" font-family="Arial" font-size="10.00">FFN Gate (Expert Selection)</text>
<text text-anchor="middle" x="368" y="-4200.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="368" y="-4189.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="368" y="-4178.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu4_layernorm9&#45;&gt;gpu4_ffn_gate -->
<g id="edge60" class="edge">
<title>gpu4_layernorm9&#45;&gt;gpu4_ffn_gate</title>
<path fill="none" stroke="black" d="M380.7,-4258.82C379.01,-4250.77 377.12,-4241.72 375.32,-4233.12"/>
<polygon fill="black" stroke="black" points="378.74,-4232.38 373.27,-4223.31 371.89,-4233.82 378.74,-4232.38"/>
</g>
<!-- gpu4_split_experts -->
<g id="node53" class="node">
<title>gpu4_split_experts</title>
<polygon fill="lightyellow" stroke="black" points="675.42,-4135.16 172.07,-4135.16 42.58,-4031.16 545.93,-4031.16 675.42,-4135.16"/>
<text text-anchor="middle" x="359" y="-4097.16" font-family="Arial" font-size="10.00">Split for Experts</text>
<text text-anchor="middle" x="359" y="-4086.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="359" y="-4075.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="359" y="-4064.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
</g>
<!-- gpu4_ffn_gate&#45;&gt;gpu4_split_experts -->
<g id="edge61" class="edge">
<title>gpu4_ffn_gate&#45;&gt;gpu4_split_experts</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365.98,-4171.02C365.36,-4163.34 364.65,-4154.52 363.93,-4145.52"/>
<polygon fill="black" stroke="black" points="367.4,-4145.02 363.11,-4135.33 360.42,-4145.58 367.4,-4145.02"/>
</g>
<!-- gpu4_expert1 -->
<g id="node54" class="node">
<title>gpu4_expert1</title>
<polygon fill="lightblue" stroke="black" points="345.5,-3995.16 40.5,-3995.16 40.5,-3943.16 345.5,-3943.16 345.5,-3995.16"/>
<text text-anchor="middle" x="193" y="-3983.16" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="193" y="-3972.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="193" y="-3961.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
<text text-anchor="middle" x="193" y="-3950.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
</g>
<!-- gpu4_split_experts&#45;&gt;gpu4_expert1 -->
<g id="edge62" class="edge">
<title>gpu4_split_experts&#45;&gt;gpu4_expert1</title>
<path fill="none" stroke="black" d="M283.29,-4031.07C267.99,-4020.75 252.36,-4010.21 238.5,-4000.86"/>
<polygon fill="black" stroke="black" points="240.37,-3997.89 230.12,-3995.2 236.45,-4003.69 240.37,-3997.89"/>
</g>
<!-- gpu4_expert2 -->
<g id="node55" class="node">
<title>gpu4_expert2</title>
<polygon fill="lightblue" stroke="black" points="668.5,-3995.16 363.5,-3995.16 363.5,-3943.16 668.5,-3943.16 668.5,-3995.16"/>
<text text-anchor="middle" x="516" y="-3983.16" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="516" y="-3972.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="516" y="-3961.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-3950.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
</g>
<!-- gpu4_split_experts&#45;&gt;gpu4_expert2 -->
<g id="edge63" class="edge">
<title>gpu4_split_experts&#45;&gt;gpu4_expert2</title>
<path fill="none" stroke="black" d="M430.61,-4031.07C444.94,-4020.85 459.58,-4010.41 472.59,-4001.12"/>
<polygon fill="black" stroke="black" points="474.79,-4003.86 480.89,-3995.2 470.72,-3998.16 474.79,-4003.86"/>
</g>
<!-- gpu4_aggregate_experts -->
<g id="node56" class="node">
<title>gpu4_aggregate_experts</title>
<polygon fill="lightyellow" stroke="black" points="675.29,-3907.16 164.19,-3907.16 32.71,-3781.16 543.81,-3781.16 675.29,-3907.16"/>
<text text-anchor="middle" x="354" y="-3863.66" font-family="Arial" font-size="10.00">Aggregate Experts</text>
<text text-anchor="middle" x="354" y="-3852.66" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="354" y="-3841.66" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
<text text-anchor="middle" x="354" y="-3830.66" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, mlp_hidden_size=8192]</text>
<text text-anchor="middle" x="354" y="-3819.66" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu4_expert1&#45;&gt;gpu4_aggregate_experts -->
<g id="edge64" class="edge">
<title>gpu4_expert1&#45;&gt;gpu4_aggregate_experts</title>
<path fill="none" stroke="black" d="M225.97,-3942.97C237.35,-3934.27 250.71,-3924.07 264.42,-3913.59"/>
<polygon fill="black" stroke="black" points="266.7,-3916.25 272.52,-3907.4 262.45,-3910.69 266.7,-3916.25"/>
</g>
<!-- gpu4_expert2&#45;&gt;gpu4_aggregate_experts -->
<g id="edge65" class="edge">
<title>gpu4_expert2&#45;&gt;gpu4_aggregate_experts</title>
<path fill="none" stroke="black" d="M482.83,-3942.97C471.37,-3934.27 457.93,-3924.07 444.14,-3913.59"/>
<polygon fill="black" stroke="black" points="446.06,-3910.66 435.98,-3907.4 441.83,-3916.24 446.06,-3910.66"/>
</g>
<!-- gpu4_ffn_out -->
<g id="node57" class="node">
<title>gpu4_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="515,-3745.16 213,-3745.16 213,-3693.16 515,-3693.16 515,-3745.16"/>
<text text-anchor="middle" x="364" y="-3733.16" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="364" y="-3722.16" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="364" y="-3711.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="364" y="-3700.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_aggregate_experts&#45;&gt;gpu4_ffn_out -->
<g id="edge66" class="edge">
<title>gpu4_aggregate_experts&#45;&gt;gpu4_ffn_out</title>
<path fill="none" stroke="black" d="M359.06,-3780.94C359.77,-3772.15 360.49,-3763.39 361.14,-3755.36"/>
<polygon fill="black" stroke="black" points="364.63,-3755.54 361.96,-3745.29 357.66,-3754.98 364.63,-3755.54"/>
</g>
<!-- gpu4_ffn_out&#45;&gt;gpu4_residual9 -->
<g id="edge67" class="edge">
<title>gpu4_ffn_out&#45;&gt;gpu4_residual9</title>
<path fill="none" stroke="black" d="M368.1,-3692.97C369.34,-3685.33 370.77,-3676.53 372.25,-3667.4"/>
<polygon fill="black" stroke="black" points="375.73,-3667.83 373.88,-3657.4 368.82,-3666.71 375.73,-3667.83"/>
</g>
<!-- comm_gpu4_gpu5 -->
<g id="node59" class="node">
<title>comm_gpu4_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="384" cy="-3458.39" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="384" y="-3472.39" font-family="Arial" font-size="10.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="384" y="-3461.39" font-family="Arial" font-size="10.00">GPU: 4 → 5</text>
<text text-anchor="middle" x="384" y="-3450.39" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="384" y="-3439.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu4_residual9&#45;&gt;comm_gpu4_gpu5 -->
<g id="edge69" class="edge">
<title>gpu4_residual9&#45;&gt;comm_gpu4_gpu5</title>
<path fill="none" stroke="black" d="M384,-3530.97C384,-3522.34 384,-3513.6 384,-3505.33"/>
<polygon fill="black" stroke="black" points="387.5,-3505.16 384,-3495.16 380.5,-3505.16 387.5,-3505.16"/>
</g>
<!-- gpu5_layernorm10 -->
<g id="node60" class="node">
<title>gpu5_layernorm10</title>
<polygon fill="lightblue" stroke="black" points="528.5,-3382.62 239.5,-3382.62 239.5,-3330.62 528.5,-3330.62 528.5,-3382.62"/>
<text text-anchor="middle" x="384" y="-3370.62" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="384" y="-3359.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="384" y="-3348.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="384" y="-3337.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu4_gpu5&#45;&gt;gpu5_layernorm10 -->
<g id="edge70" class="edge">
<title>comm_gpu4_gpu5&#45;&gt;gpu5_layernorm10</title>
<path fill="none" stroke="black" d="M384,-3421.37C384,-3412.04 384,-3402.01 384,-3392.73"/>
<polygon fill="black" stroke="black" points="387.5,-3392.65 384,-3382.65 380.5,-3392.65 387.5,-3392.65"/>
</g>
<!-- gpu5_mha_qkv -->
<g id="node61" class="node">
<title>gpu5_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="419.5,-3294.62 78.5,-3294.62 78.5,-3242.62 419.5,-3242.62 419.5,-3294.62"/>
<text text-anchor="middle" x="249" y="-3282.62" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="249" y="-3271.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="249" y="-3260.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="249" y="-3249.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu5_layernorm10&#45;&gt;gpu5_mha_qkv -->
<g id="edge71" class="edge">
<title>gpu5_layernorm10&#45;&gt;gpu5_mha_qkv</title>
<path fill="none" stroke="black" d="M344.59,-3330.51C329.75,-3321.06 312.7,-3310.2 297.15,-3300.29"/>
<polygon fill="black" stroke="black" points="299.01,-3297.32 288.69,-3294.9 295.25,-3303.23 299.01,-3297.32"/>
</g>
<!-- gpu5_residual10 -->
<g id="node64" class="node">
<title>gpu5_residual10</title>
<polygon fill="lightyellow" stroke="black" points="615.74,-3030.62 138.92,-3030.62 16.26,-2904.62 493.08,-2904.62 615.74,-3030.62"/>
<text text-anchor="middle" x="316" y="-2987.12" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="316" y="-2976.12" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="316" y="-2965.12" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-2954.12" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-2943.12" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu5_layernorm10&#45;&gt;gpu5_residual10 -->
<g id="edge75" class="edge">
<title>gpu5_layernorm10&#45;&gt;gpu5_residual10</title>
<path fill="none" stroke="black" d="M408.23,-3330.39C416.49,-3320.12 424.72,-3307.62 429,-3294.62 460.66,-3198.35 469.72,-3158.51 427,-3066.62 422.35,-3056.62 416.15,-3047.23 409.04,-3038.51"/>
<polygon fill="black" stroke="black" points="411.47,-3035.97 402.28,-3030.7 406.18,-3040.55 411.47,-3035.97"/>
</g>
<!-- gpu5_mha_attention -->
<g id="node62" class="node">
<title>gpu5_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="419.5,-3206.62 78.5,-3206.62 78.5,-3154.62 419.5,-3154.62 419.5,-3206.62"/>
<text text-anchor="middle" x="249" y="-3194.62" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="249" y="-3183.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="249" y="-3172.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="249" y="-3161.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu5_mha_qkv&#45;&gt;gpu5_mha_attention -->
<g id="edge72" class="edge">
<title>gpu5_mha_qkv&#45;&gt;gpu5_mha_attention</title>
<path fill="none" stroke="black" d="M249,-3242.28C249,-3234.32 249,-3225.38 249,-3216.86"/>
<polygon fill="black" stroke="black" points="252.5,-3216.77 249,-3206.77 245.5,-3216.77 252.5,-3216.77"/>
</g>
<!-- gpu5_mha_out -->
<g id="node63" class="node">
<title>gpu5_mha_out</title>
<polygon fill="lightblue" stroke="black" points="418,-3118.62 84,-3118.62 84,-3066.62 418,-3066.62 418,-3118.62"/>
<text text-anchor="middle" x="251" y="-3106.62" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="251" y="-3095.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="251" y="-3084.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="251" y="-3073.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu5_mha_attention&#45;&gt;gpu5_mha_out -->
<g id="edge73" class="edge">
<title>gpu5_mha_attention&#45;&gt;gpu5_mha_out</title>
<path fill="none" stroke="black" d="M249.59,-3154.28C249.77,-3146.32 249.98,-3137.38 250.18,-3128.86"/>
<polygon fill="black" stroke="black" points="253.68,-3128.85 250.41,-3118.77 246.68,-3128.69 253.68,-3128.85"/>
</g>
<!-- gpu5_mha_out&#45;&gt;gpu5_residual10 -->
<g id="edge74" class="edge">
<title>gpu5_mha_out&#45;&gt;gpu5_residual10</title>
<path fill="none" stroke="black" d="M264.31,-3066.43C268.48,-3058.55 273.3,-3049.42 278.29,-3039.98"/>
<polygon fill="black" stroke="black" points="281.53,-3041.34 283.11,-3030.86 275.34,-3038.07 281.53,-3041.34"/>
</g>
<!-- gpu5_layernorm11 -->
<g id="node65" class="node">
<title>gpu5_layernorm11</title>
<polygon fill="lightblue" stroke="black" points="392.5,-2868.62 103.5,-2868.62 103.5,-2816.62 392.5,-2816.62 392.5,-2868.62"/>
<text text-anchor="middle" x="248" y="-2856.62" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="248" y="-2845.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="248" y="-2834.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="248" y="-2823.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu5_residual10&#45;&gt;gpu5_layernorm11 -->
<g id="edge76" class="edge">
<title>gpu5_residual10&#45;&gt;gpu5_layernorm11</title>
<path fill="none" stroke="black" d="M281.6,-2904.4C276.53,-2895.22 271.47,-2886.06 266.87,-2877.74"/>
<polygon fill="black" stroke="black" points="269.8,-2875.81 261.9,-2868.75 263.67,-2879.2 269.8,-2875.81"/>
</g>
<!-- gpu5_residual11 -->
<g id="node69" class="node">
<title>gpu5_residual11</title>
<polygon fill="lightyellow" stroke="black" points="615.74,-2516.62 138.92,-2516.62 16.26,-2390.62 493.08,-2390.62 615.74,-2516.62"/>
<text text-anchor="middle" x="316" y="-2473.12" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="316" y="-2462.12" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="316" y="-2451.12" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-2440.12" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-2429.12" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu5_residual10&#45;&gt;gpu5_residual11 -->
<g id="edge81" class="edge">
<title>gpu5_residual10&#45;&gt;gpu5_residual11</title>
<path fill="none" stroke="black" d="M378.91,-2904.42C387.5,-2893.23 395.3,-2881.12 401,-2868.62 422.03,-2822.46 417,-2806.34 417,-2755.62 417,-2755.62 417,-2755.62 417,-2665.62 417,-2615.11 425.67,-2598.7 405,-2552.62 400.72,-2543.08 395.16,-2533.84 388.9,-2525.09"/>
<polygon fill="black" stroke="black" points="391.51,-2522.75 382.7,-2516.86 385.92,-2526.96 391.51,-2522.75"/>
</g>
<!-- gpu5_ffn_gate -->
<g id="node66" class="node">
<title>gpu5_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="398,-2780.62 88,-2780.62 88,-2728.62 398,-2728.62 398,-2780.62"/>
<text text-anchor="middle" x="243" y="-2768.62" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="243" y="-2757.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="243" y="-2746.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="243" y="-2735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu5_layernorm11&#45;&gt;gpu5_ffn_gate -->
<g id="edge77" class="edge">
<title>gpu5_layernorm11&#45;&gt;gpu5_ffn_gate</title>
<path fill="none" stroke="black" d="M246.53,-2816.28C246.06,-2808.32 245.54,-2799.38 245.05,-2790.86"/>
<polygon fill="black" stroke="black" points="248.54,-2790.55 244.46,-2780.77 241.55,-2790.96 248.54,-2790.55"/>
</g>
<!-- gpu5_ffn_experts -->
<g id="node67" class="node">
<title>gpu5_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="398,-2692.62 88,-2692.62 88,-2640.62 398,-2640.62 398,-2692.62"/>
<text text-anchor="middle" x="243" y="-2680.62" font-family="Arial" font-size="10.00">FFN Experts</text>
<text text-anchor="middle" x="243" y="-2669.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="243" y="-2658.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="243" y="-2647.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu5_ffn_gate&#45;&gt;gpu5_ffn_experts -->
<g id="edge78" class="edge">
<title>gpu5_ffn_gate&#45;&gt;gpu5_ffn_experts</title>
<path fill="none" stroke="black" d="M243,-2728.28C243,-2720.32 243,-2711.38 243,-2702.86"/>
<polygon fill="black" stroke="black" points="246.5,-2702.77 243,-2692.77 239.5,-2702.77 246.5,-2702.77"/>
</g>
<!-- gpu5_ffn_out -->
<g id="node68" class="node">
<title>gpu5_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="396,-2604.62 94,-2604.62 94,-2552.62 396,-2552.62 396,-2604.62"/>
<text text-anchor="middle" x="245" y="-2592.62" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="245" y="-2581.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="245" y="-2570.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="245" y="-2559.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu5_ffn_experts&#45;&gt;gpu5_ffn_out -->
<g id="edge79" class="edge">
<title>gpu5_ffn_experts&#45;&gt;gpu5_ffn_out</title>
<path fill="none" stroke="black" d="M243.59,-2640.28C243.77,-2632.32 243.98,-2623.38 244.18,-2614.86"/>
<polygon fill="black" stroke="black" points="247.68,-2614.85 244.41,-2604.77 240.68,-2614.69 247.68,-2614.85"/>
</g>
<!-- gpu5_ffn_out&#45;&gt;gpu5_residual11 -->
<g id="edge80" class="edge">
<title>gpu5_ffn_out&#45;&gt;gpu5_residual11</title>
<path fill="none" stroke="black" d="M259.54,-2552.43C264.14,-2544.47 269.46,-2535.24 274.97,-2525.69"/>
<polygon fill="black" stroke="black" points="278.1,-2527.27 280.07,-2516.86 272.04,-2523.77 278.1,-2527.27"/>
</g>
<!-- comm_gpu5_gpu6 -->
<g id="node70" class="node">
<title>comm_gpu5_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="316" cy="-2317.85" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="316" y="-2331.85" font-family="Arial" font-size="10.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="316" y="-2320.85" font-family="Arial" font-size="10.00">GPU: 5 → 6</text>
<text text-anchor="middle" x="316" y="-2309.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-2298.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu5_residual11&#45;&gt;comm_gpu5_gpu6 -->
<g id="edge82" class="edge">
<title>gpu5_residual11&#45;&gt;comm_gpu5_gpu6</title>
<path fill="none" stroke="black" d="M316,-2390.43C316,-2381.8 316,-2373.06 316,-2364.79"/>
<polygon fill="black" stroke="black" points="319.5,-2364.62 316,-2354.62 312.5,-2364.62 319.5,-2364.62"/>
</g>
<!-- gpu6_layernorm12 -->
<g id="node71" class="node">
<title>gpu6_layernorm12</title>
<polygon fill="lightblue" stroke="black" points="460.5,-2242.08 171.5,-2242.08 171.5,-2190.08 460.5,-2190.08 460.5,-2242.08"/>
<text text-anchor="middle" x="316" y="-2230.08" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="316" y="-2219.08" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="316" y="-2208.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="316" y="-2197.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu5_gpu6&#45;&gt;gpu6_layernorm12 -->
<g id="edge83" class="edge">
<title>comm_gpu5_gpu6&#45;&gt;gpu6_layernorm12</title>
<path fill="none" stroke="black" d="M316,-2280.83C316,-2271.5 316,-2261.47 316,-2252.19"/>
<polygon fill="black" stroke="black" points="319.5,-2252.11 316,-2242.11 312.5,-2252.11 319.5,-2252.11"/>
</g>
<!-- gpu6_mha_qkv -->
<g id="node72" class="node">
<title>gpu6_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="449.5,-2154.08 108.5,-2154.08 108.5,-2102.08 449.5,-2102.08 449.5,-2154.08"/>
<text text-anchor="middle" x="279" y="-2142.08" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="279" y="-2131.08" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="279" y="-2120.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="279" y="-2109.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu6_layernorm12&#45;&gt;gpu6_mha_qkv -->
<g id="edge84" class="edge">
<title>gpu6_layernorm12&#45;&gt;gpu6_mha_qkv</title>
<path fill="none" stroke="black" d="M305.1,-2189.74C301.56,-2181.52 297.57,-2172.25 293.8,-2163.48"/>
<polygon fill="black" stroke="black" points="296.99,-2162.04 289.82,-2154.23 290.56,-2164.8 296.99,-2162.04"/>
</g>
<!-- gpu6_residual12 -->
<g id="node75" class="node">
<title>gpu6_residual12</title>
<polygon fill="lightyellow" stroke="black" points="669.74,-1890.08 192.92,-1890.08 70.26,-1764.08 547.08,-1764.08 669.74,-1890.08"/>
<text text-anchor="middle" x="370" y="-1846.58" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="370" y="-1835.58" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="370" y="-1824.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="370" y="-1813.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="370" y="-1802.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu6_layernorm12&#45;&gt;gpu6_residual12 -->
<g id="edge88" class="edge">
<title>gpu6_layernorm12&#45;&gt;gpu6_residual12</title>
<path fill="none" stroke="black" d="M416.64,-2190.05C433.4,-2181.38 448.66,-2169.73 459,-2154.08 514.86,-2069.52 494.06,-2020.4 457,-1926.08 453.22,-1916.45 448.03,-1907.15 442.07,-1898.37"/>
<polygon fill="black" stroke="black" points="444.81,-1896.18 436.12,-1890.11 439.12,-1900.27 444.81,-1896.18"/>
</g>
<!-- gpu6_mha_attention -->
<g id="node73" class="node">
<title>gpu6_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="449.5,-2066.08 108.5,-2066.08 108.5,-2014.08 449.5,-2014.08 449.5,-2066.08"/>
<text text-anchor="middle" x="279" y="-2054.08" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="279" y="-2043.08" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="279" y="-2032.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="279" y="-2021.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu6_mha_qkv&#45;&gt;gpu6_mha_attention -->
<g id="edge85" class="edge">
<title>gpu6_mha_qkv&#45;&gt;gpu6_mha_attention</title>
<path fill="none" stroke="black" d="M279,-2101.74C279,-2093.78 279,-2084.84 279,-2076.32"/>
<polygon fill="black" stroke="black" points="282.5,-2076.23 279,-2066.23 275.5,-2076.23 282.5,-2076.23"/>
</g>
<!-- gpu6_mha_out -->
<g id="node74" class="node">
<title>gpu6_mha_out</title>
<polygon fill="lightblue" stroke="black" points="448,-1978.08 114,-1978.08 114,-1926.08 448,-1926.08 448,-1978.08"/>
<text text-anchor="middle" x="281" y="-1966.08" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="281" y="-1955.08" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="281" y="-1944.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="281" y="-1933.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu6_mha_attention&#45;&gt;gpu6_mha_out -->
<g id="edge86" class="edge">
<title>gpu6_mha_attention&#45;&gt;gpu6_mha_out</title>
<path fill="none" stroke="black" d="M279.59,-2013.74C279.77,-2005.78 279.98,-1996.84 280.18,-1988.32"/>
<polygon fill="black" stroke="black" points="283.68,-1988.31 280.41,-1978.23 276.68,-1988.15 283.68,-1988.31"/>
</g>
<!-- gpu6_mha_out&#45;&gt;gpu6_residual12 -->
<g id="edge87" class="edge">
<title>gpu6_mha_out&#45;&gt;gpu6_residual12</title>
<path fill="none" stroke="black" d="M299.23,-1925.89C305.11,-1917.76 311.94,-1908.32 319,-1898.57"/>
<polygon fill="black" stroke="black" points="321.93,-1900.48 324.96,-1890.32 316.26,-1896.37 321.93,-1900.48"/>
</g>
<!-- gpu6_layernorm13 -->
<g id="node76" class="node">
<title>gpu6_layernorm13</title>
<polygon fill="lightblue" stroke="black" points="444.5,-1728.08 155.5,-1728.08 155.5,-1676.08 444.5,-1676.08 444.5,-1728.08"/>
<text text-anchor="middle" x="300" y="-1716.08" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="300" y="-1705.08" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="300" y="-1694.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="300" y="-1683.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu6_residual12&#45;&gt;gpu6_layernorm13 -->
<g id="edge89" class="edge">
<title>gpu6_residual12&#45;&gt;gpu6_layernorm13</title>
<path fill="none" stroke="black" d="M334.59,-1763.86C329.31,-1754.58 324.04,-1745.33 319.27,-1736.94"/>
<polygon fill="black" stroke="black" points="322.29,-1735.17 314.31,-1728.21 316.21,-1738.64 322.29,-1735.17"/>
</g>
<!-- gpu6_residual13 -->
<g id="node80" class="node">
<title>gpu6_residual13</title>
<polygon fill="lightyellow" stroke="black" points="669.74,-1376.08 192.92,-1376.08 70.26,-1250.08 547.08,-1250.08 669.74,-1376.08"/>
<text text-anchor="middle" x="370" y="-1332.58" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="370" y="-1321.58" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="370" y="-1310.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="370" y="-1299.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="370" y="-1288.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu6_residual12&#45;&gt;gpu6_residual13 -->
<g id="edge94" class="edge">
<title>gpu6_residual12&#45;&gt;gpu6_residual13</title>
<path fill="none" stroke="black" d="M431.31,-1764.04C439.76,-1752.78 447.44,-1740.61 453,-1728.08 473.54,-1681.76 468,-1665.74 468,-1615.08 468,-1615.08 468,-1615.08 468,-1525.08 468,-1474.57 476.27,-1458.34 456,-1412.08 451.83,-1402.57 446.4,-1393.33 440.29,-1384.56"/>
<polygon fill="black" stroke="black" points="442.98,-1382.3 434.24,-1376.3 437.33,-1386.44 442.98,-1382.3"/>
</g>
<!-- gpu6_ffn_gate -->
<g id="node77" class="node">
<title>gpu6_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="449,-1640.08 139,-1640.08 139,-1588.08 449,-1588.08 449,-1640.08"/>
<text text-anchor="middle" x="294" y="-1628.08" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="294" y="-1617.08" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="294" y="-1606.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="294" y="-1595.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu6_layernorm13&#45;&gt;gpu6_ffn_gate -->
<g id="edge90" class="edge">
<title>gpu6_layernorm13&#45;&gt;gpu6_ffn_gate</title>
<path fill="none" stroke="black" d="M298.23,-1675.74C297.68,-1667.78 297.05,-1658.84 296.46,-1650.32"/>
<polygon fill="black" stroke="black" points="299.94,-1649.97 295.76,-1640.23 292.96,-1650.45 299.94,-1649.97"/>
</g>
<!-- gpu6_ffn_experts -->
<g id="node78" class="node">
<title>gpu6_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="449,-1552.08 139,-1552.08 139,-1500.08 449,-1500.08 449,-1552.08"/>
<text text-anchor="middle" x="294" y="-1540.08" font-family="Arial" font-size="10.00">FFN Experts</text>
<text text-anchor="middle" x="294" y="-1529.08" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="294" y="-1518.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="294" y="-1507.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu6_ffn_gate&#45;&gt;gpu6_ffn_experts -->
<g id="edge91" class="edge">
<title>gpu6_ffn_gate&#45;&gt;gpu6_ffn_experts</title>
<path fill="none" stroke="black" d="M294,-1587.74C294,-1579.78 294,-1570.84 294,-1562.32"/>
<polygon fill="black" stroke="black" points="297.5,-1562.23 294,-1552.23 290.5,-1562.23 297.5,-1562.23"/>
</g>
<!-- gpu6_ffn_out -->
<g id="node79" class="node">
<title>gpu6_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="447,-1464.08 145,-1464.08 145,-1412.08 447,-1412.08 447,-1464.08"/>
<text text-anchor="middle" x="296" y="-1452.08" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="296" y="-1441.08" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="296" y="-1430.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="296" y="-1419.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu6_ffn_experts&#45;&gt;gpu6_ffn_out -->
<g id="edge92" class="edge">
<title>gpu6_ffn_experts&#45;&gt;gpu6_ffn_out</title>
<path fill="none" stroke="black" d="M294.59,-1499.74C294.77,-1491.78 294.98,-1482.84 295.18,-1474.32"/>
<polygon fill="black" stroke="black" points="298.68,-1474.31 295.41,-1464.23 291.68,-1474.15 298.68,-1474.31"/>
</g>
<!-- gpu6_ffn_out&#45;&gt;gpu6_residual13 -->
<g id="edge93" class="edge">
<title>gpu6_ffn_out&#45;&gt;gpu6_residual13</title>
<path fill="none" stroke="black" d="M311.15,-1411.89C315.94,-1403.93 321.5,-1394.7 327.24,-1385.15"/>
<polygon fill="black" stroke="black" points="330.4,-1386.7 332.55,-1376.32 324.4,-1383.09 330.4,-1386.7"/>
</g>
<!-- comm_gpu6_gpu7 -->
<g id="node81" class="node">
<title>comm_gpu6_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="370" cy="-1177.31" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="370" y="-1191.31" font-family="Arial" font-size="10.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="370" y="-1180.31" font-family="Arial" font-size="10.00">GPU: 6 → 7</text>
<text text-anchor="middle" x="370" y="-1169.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="370" y="-1158.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu6_residual13&#45;&gt;comm_gpu6_gpu7 -->
<g id="edge95" class="edge">
<title>gpu6_residual13&#45;&gt;comm_gpu6_gpu7</title>
<path fill="none" stroke="black" d="M370,-1249.89C370,-1241.26 370,-1232.52 370,-1224.25"/>
<polygon fill="black" stroke="black" points="373.5,-1224.08 370,-1214.08 366.5,-1224.08 373.5,-1224.08"/>
</g>
<!-- gpu7_layernorm14 -->
<g id="node82" class="node">
<title>gpu7_layernorm14</title>
<polygon fill="lightblue" stroke="black" points="514.5,-1101.54 225.5,-1101.54 225.5,-1049.54 514.5,-1049.54 514.5,-1101.54"/>
<text text-anchor="middle" x="370" y="-1089.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="370" y="-1078.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="370" y="-1067.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="370" y="-1056.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- comm_gpu6_gpu7&#45;&gt;gpu7_layernorm14 -->
<g id="edge96" class="edge">
<title>comm_gpu6_gpu7&#45;&gt;gpu7_layernorm14</title>
<path fill="none" stroke="black" d="M370,-1140.29C370,-1130.96 370,-1120.93 370,-1111.65"/>
<polygon fill="black" stroke="black" points="373.5,-1111.57 370,-1101.57 366.5,-1111.57 373.5,-1111.57"/>
</g>
<!-- gpu7_mha_qkv -->
<g id="node83" class="node">
<title>gpu7_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="491.5,-1013.54 150.5,-1013.54 150.5,-961.54 491.5,-961.54 491.5,-1013.54"/>
<text text-anchor="middle" x="321" y="-1001.54" font-family="Arial" font-size="10.00">MHA Q/K/V Projection</text>
<text text-anchor="middle" x="321" y="-990.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="321" y="-979.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="321" y="-968.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu7_layernorm14&#45;&gt;gpu7_mha_qkv -->
<g id="edge97" class="edge">
<title>gpu7_layernorm14&#45;&gt;gpu7_mha_qkv</title>
<path fill="none" stroke="black" d="M355.56,-1049.2C350.83,-1040.89 345.49,-1031.51 340.44,-1022.66"/>
<polygon fill="black" stroke="black" points="343.32,-1020.65 335.33,-1013.7 337.24,-1024.12 343.32,-1020.65"/>
</g>
<!-- gpu7_residual14 -->
<g id="node86" class="node">
<title>gpu7_residual14</title>
<polygon fill="lightyellow" stroke="black" points="700.74,-749.54 223.92,-749.54 101.26,-623.54 578.08,-623.54 700.74,-749.54"/>
<text text-anchor="middle" x="401" y="-706.04" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="401" y="-695.04" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="401" y="-684.04" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="401" y="-673.04" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="401" y="-662.04" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_layernorm14&#45;&gt;gpu7_residual14 -->
<g id="edge101" class="edge">
<title>gpu7_layernorm14&#45;&gt;gpu7_residual14</title>
<path fill="none" stroke="black" d="M459.69,-1049.44C476.07,-1040.74 491.09,-1029.09 501,-1013.54 555.47,-928.09 538.84,-878.72 499,-785.54 494.8,-775.71 489.11,-766.35 482.57,-757.58"/>
<polygon fill="black" stroke="black" points="485.29,-755.38 476.34,-749.7 479.79,-759.72 485.29,-755.38"/>
</g>
<!-- gpu7_mha_attention -->
<g id="node84" class="node">
<title>gpu7_mha_attention</title>
<polygon fill="lightblue" stroke="black" points="491.5,-925.54 150.5,-925.54 150.5,-873.54 491.5,-873.54 491.5,-925.54"/>
<text text-anchor="middle" x="321" y="-913.54" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="321" y="-902.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="321" y="-891.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="321" y="-880.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
</g>
<!-- gpu7_mha_qkv&#45;&gt;gpu7_mha_attention -->
<g id="edge98" class="edge">
<title>gpu7_mha_qkv&#45;&gt;gpu7_mha_attention</title>
<path fill="none" stroke="black" d="M321,-961.2C321,-953.24 321,-944.3 321,-935.78"/>
<polygon fill="black" stroke="black" points="324.5,-935.7 321,-925.7 317.5,-935.7 324.5,-935.7"/>
</g>
<!-- gpu7_mha_out -->
<g id="node85" class="node">
<title>gpu7_mha_out</title>
<polygon fill="lightblue" stroke="black" points="490,-837.54 156,-837.54 156,-785.54 490,-785.54 490,-837.54"/>
<text text-anchor="middle" x="323" y="-825.54" font-family="Arial" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="323" y="-814.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="323" y="-803.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="323" y="-792.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_mha_attention&#45;&gt;gpu7_mha_out -->
<g id="edge99" class="edge">
<title>gpu7_mha_attention&#45;&gt;gpu7_mha_out</title>
<path fill="none" stroke="black" d="M321.59,-873.2C321.77,-865.24 321.98,-856.3 322.18,-847.78"/>
<polygon fill="black" stroke="black" points="325.68,-847.77 322.41,-837.7 318.68,-847.61 325.68,-847.77"/>
</g>
<!-- gpu7_mha_out&#45;&gt;gpu7_residual14 -->
<g id="edge100" class="edge">
<title>gpu7_mha_out&#45;&gt;gpu7_residual14</title>
<path fill="none" stroke="black" d="M338.97,-785.35C344.07,-777.31 350,-767.97 356.11,-758.32"/>
<polygon fill="black" stroke="black" points="359.13,-760.1 361.53,-749.79 353.22,-756.36 359.13,-760.1"/>
</g>
<!-- gpu7_layernorm15 -->
<g id="node87" class="node">
<title>gpu7_layernorm15</title>
<polygon fill="lightblue" stroke="black" points="477.5,-587.54 188.5,-587.54 188.5,-535.54 477.5,-535.54 477.5,-587.54"/>
<text text-anchor="middle" x="333" y="-575.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="333" y="-564.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="333" y="-553.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="333" y="-542.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_residual14&#45;&gt;gpu7_layernorm15 -->
<g id="edge102" class="edge">
<title>gpu7_residual14&#45;&gt;gpu7_layernorm15</title>
<path fill="none" stroke="black" d="M366.6,-623.32C361.53,-614.14 356.47,-604.98 351.87,-596.67"/>
<polygon fill="black" stroke="black" points="354.8,-594.73 346.9,-587.68 348.67,-598.12 354.8,-594.73"/>
</g>
<!-- gpu7_residual15 -->
<g id="node91" class="node">
<title>gpu7_residual15</title>
<polygon fill="lightyellow" stroke="black" points="700.74,-235.54 223.92,-235.54 101.26,-109.54 578.08,-109.54 700.74,-235.54"/>
<text text-anchor="middle" x="401" y="-192.04" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="401" y="-181.04" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="401" y="-170.04" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="401" y="-159.04" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="401" y="-148.04" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_residual14&#45;&gt;gpu7_residual15 -->
<g id="edge107" class="edge">
<title>gpu7_residual14&#45;&gt;gpu7_residual15</title>
<path fill="none" stroke="black" d="M463.91,-623.34C472.5,-612.15 480.3,-600.04 486,-587.54 507.03,-541.38 502,-525.26 502,-474.54 502,-474.54 502,-474.54 502,-384.54 502,-334.03 510.67,-317.62 490,-271.54 485.72,-262 480.16,-252.76 473.9,-244.02"/>
<polygon fill="black" stroke="black" points="476.51,-241.67 467.7,-235.79 470.92,-245.88 476.51,-241.67"/>
</g>
<!-- gpu7_ffn_gate -->
<g id="node88" class="node">
<title>gpu7_ffn_gate</title>
<polygon fill="lightblue" stroke="black" points="483,-499.54 173,-499.54 173,-447.54 483,-447.54 483,-499.54"/>
<text text-anchor="middle" x="328" y="-487.54" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="328" y="-476.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="328" y="-465.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="328" y="-454.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu7_layernorm15&#45;&gt;gpu7_ffn_gate -->
<g id="edge103" class="edge">
<title>gpu7_layernorm15&#45;&gt;gpu7_ffn_gate</title>
<path fill="none" stroke="black" d="M331.53,-535.2C331.06,-527.24 330.54,-518.3 330.05,-509.78"/>
<polygon fill="black" stroke="black" points="333.54,-509.48 329.46,-499.7 326.55,-509.88 333.54,-509.48"/>
</g>
<!-- gpu7_ffn_experts -->
<g id="node89" class="node">
<title>gpu7_ffn_experts</title>
<polygon fill="lightblue" stroke="black" points="483,-411.54 173,-411.54 173,-359.54 483,-359.54 483,-411.54"/>
<text text-anchor="middle" x="328" y="-399.54" font-family="Arial" font-size="10.00">FFN Experts</text>
<text text-anchor="middle" x="328" y="-388.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="328" y="-377.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="328" y="-366.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
</g>
<!-- gpu7_ffn_gate&#45;&gt;gpu7_ffn_experts -->
<g id="edge104" class="edge">
<title>gpu7_ffn_gate&#45;&gt;gpu7_ffn_experts</title>
<path fill="none" stroke="black" d="M328,-447.2C328,-439.24 328,-430.3 328,-421.78"/>
<polygon fill="black" stroke="black" points="331.5,-421.7 328,-411.7 324.5,-421.7 331.5,-421.7"/>
</g>
<!-- gpu7_ffn_out -->
<g id="node90" class="node">
<title>gpu7_ffn_out</title>
<polygon fill="lightblue" stroke="black" points="481,-323.54 179,-323.54 179,-271.54 481,-271.54 481,-323.54"/>
<text text-anchor="middle" x="330" y="-311.54" font-family="Arial" font-size="10.00">FFN Output Projection</text>
<text text-anchor="middle" x="330" y="-300.54" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="330" y="-289.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="330" y="-278.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_ffn_experts&#45;&gt;gpu7_ffn_out -->
<g id="edge105" class="edge">
<title>gpu7_ffn_experts&#45;&gt;gpu7_ffn_out</title>
<path fill="none" stroke="black" d="M328.59,-359.2C328.77,-351.24 328.98,-342.3 329.18,-333.78"/>
<polygon fill="black" stroke="black" points="332.68,-333.77 329.41,-323.7 325.68,-333.61 332.68,-333.77"/>
</g>
<!-- gpu7_ffn_out&#45;&gt;gpu7_residual15 -->
<g id="edge106" class="edge">
<title>gpu7_ffn_out&#45;&gt;gpu7_residual15</title>
<path fill="none" stroke="black" d="M344.54,-271.35C349.14,-263.39 354.46,-254.16 359.97,-244.61"/>
<polygon fill="black" stroke="black" points="363.1,-246.2 365.07,-235.79 357.04,-242.7 363.1,-246.2"/>
</g>
<!-- output -->
<g id="node92" class="node">
<title>output</title>
<ellipse fill="lightcyan" stroke="black" cx="401" cy="-36.77" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="401" y="-50.77" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="401" y="-39.77" font-family="Arial" font-size="10.00">GPU: Host</text>
<text text-anchor="middle" x="401" y="-28.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
<text text-anchor="middle" x="401" y="-17.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=16384]</text>
</g>
<!-- gpu7_residual15&#45;&gt;output -->
<g id="edge108" class="edge">
<title>gpu7_residual15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M401,-109.35C401,-100.72 401,-91.98 401,-83.71"/>
<polygon fill="black" stroke="black" points="404.5,-83.54 401,-73.54 397.5,-83.54 404.5,-83.54"/>
</g>
</g>
</svg>
