<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="15000pt" height="481pt"
 viewBox="0.00 0.00 3600.00 115.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.26 0.26) rotate(0) translate(4 1831.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1831.91 57212,-1831.91 57212,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_stage_0</title>
<path fill="lightgray" stroke="black" d="M20,-248.97C20,-248.97 57188,-248.97 57188,-248.97 57194,-248.97 57200,-254.97 57200,-260.97 57200,-260.97 57200,-1766.91 57200,-1766.91 57200,-1772.91 57194,-1778.91 57188,-1778.91 57188,-1778.91 20,-1778.91 20,-1778.91 14,-1778.91 8,-1772.91 8,-1766.91 8,-1766.91 8,-260.97 8,-260.97 8,-254.97 14,-248.97 20,-248.97"/>
<text text-anchor="middle" x="28604" y="-1763.71" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;3)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_expert_group_0</title>
<path fill="lightcyan" stroke="black" d="M56154,-256.97C56154,-256.97 57180,-256.97 57180,-256.97 57186,-256.97 57192,-262.97 57192,-268.97 57192,-268.97 57192,-1735.91 57192,-1735.91 57192,-1741.91 57186,-1747.91 57180,-1747.91 57180,-1747.91 56154,-1747.91 56154,-1747.91 56148,-1747.91 56142,-1741.91 56142,-1735.91 56142,-1735.91 56142,-268.97 56142,-268.97 56142,-262.97 56148,-256.97 56154,-256.97"/>
<text text-anchor="middle" x="56667" y="-1732.71" font-family="Times,serif" font-size="14.00">Expert Group 0 (GPU 0)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_expert_group_1</title>
<path fill="lightcyan" stroke="black" d="M48136,-1626.91C48136,-1626.91 56122,-1626.91 56122,-1626.91 56128,-1626.91 56134,-1632.91 56134,-1638.91 56134,-1638.91 56134,-1735.91 56134,-1735.91 56134,-1741.91 56128,-1747.91 56122,-1747.91 56122,-1747.91 48136,-1747.91 48136,-1747.91 48130,-1747.91 48124,-1741.91 48124,-1735.91 48124,-1735.91 48124,-1638.91 48124,-1638.91 48124,-1632.91 48130,-1626.91 48136,-1626.91"/>
<text text-anchor="middle" x="52129" y="-1732.71" font-family="Times,serif" font-size="14.00">Expert Group 1 (GPU 1)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_expert_group_2</title>
<path fill="lightcyan" stroke="black" d="M40118,-1626.91C40118,-1626.91 48104,-1626.91 48104,-1626.91 48110,-1626.91 48116,-1632.91 48116,-1638.91 48116,-1638.91 48116,-1735.91 48116,-1735.91 48116,-1741.91 48110,-1747.91 48104,-1747.91 48104,-1747.91 40118,-1747.91 40118,-1747.91 40112,-1747.91 40106,-1741.91 40106,-1735.91 40106,-1735.91 40106,-1638.91 40106,-1638.91 40106,-1632.91 40112,-1626.91 40118,-1626.91"/>
<text text-anchor="middle" x="44111" y="-1732.71" font-family="Times,serif" font-size="14.00">Expert Group 2 (GPU 2)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_expert_group_3</title>
<path fill="lightcyan" stroke="black" d="M32100,-1626.91C32100,-1626.91 40086,-1626.91 40086,-1626.91 40092,-1626.91 40098,-1632.91 40098,-1638.91 40098,-1638.91 40098,-1735.91 40098,-1735.91 40098,-1741.91 40092,-1747.91 40086,-1747.91 40086,-1747.91 32100,-1747.91 32100,-1747.91 32094,-1747.91 32088,-1741.91 32088,-1735.91 32088,-1735.91 32088,-1638.91 32088,-1638.91 32088,-1632.91 32094,-1626.91 32100,-1626.91"/>
<text text-anchor="middle" x="36093" y="-1732.71" font-family="Times,serif" font-size="14.00">Expert Group 3 (GPU 3)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_expert_group_4</title>
<path fill="lightcyan" stroke="black" d="M24082,-1626.91C24082,-1626.91 32068,-1626.91 32068,-1626.91 32074,-1626.91 32080,-1632.91 32080,-1638.91 32080,-1638.91 32080,-1735.91 32080,-1735.91 32080,-1741.91 32074,-1747.91 32068,-1747.91 32068,-1747.91 24082,-1747.91 24082,-1747.91 24076,-1747.91 24070,-1741.91 24070,-1735.91 24070,-1735.91 24070,-1638.91 24070,-1638.91 24070,-1632.91 24076,-1626.91 24082,-1626.91"/>
<text text-anchor="middle" x="28075" y="-1732.71" font-family="Times,serif" font-size="14.00">Expert Group 4 (GPU 4)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_expert_group_5</title>
<path fill="lightcyan" stroke="black" d="M16064,-1626.91C16064,-1626.91 24050,-1626.91 24050,-1626.91 24056,-1626.91 24062,-1632.91 24062,-1638.91 24062,-1638.91 24062,-1735.91 24062,-1735.91 24062,-1741.91 24056,-1747.91 24050,-1747.91 24050,-1747.91 16064,-1747.91 16064,-1747.91 16058,-1747.91 16052,-1741.91 16052,-1735.91 16052,-1735.91 16052,-1638.91 16052,-1638.91 16052,-1632.91 16058,-1626.91 16064,-1626.91"/>
<text text-anchor="middle" x="20057" y="-1732.71" font-family="Times,serif" font-size="14.00">Expert Group 5 (GPU 5)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_expert_group_6</title>
<path fill="lightcyan" stroke="black" d="M8046,-1626.91C8046,-1626.91 16032,-1626.91 16032,-1626.91 16038,-1626.91 16044,-1632.91 16044,-1638.91 16044,-1638.91 16044,-1735.91 16044,-1735.91 16044,-1741.91 16038,-1747.91 16032,-1747.91 16032,-1747.91 8046,-1747.91 8046,-1747.91 8040,-1747.91 8034,-1741.91 8034,-1735.91 8034,-1735.91 8034,-1638.91 8034,-1638.91 8034,-1632.91 8040,-1626.91 8046,-1626.91"/>
<text text-anchor="middle" x="12039" y="-1732.71" font-family="Times,serif" font-size="14.00">Expert Group 6 (GPU 6)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_expert_group_7</title>
<path fill="lightcyan" stroke="black" d="M28,-1626.91C28,-1626.91 8014,-1626.91 8014,-1626.91 8020,-1626.91 8026,-1632.91 8026,-1638.91 8026,-1638.91 8026,-1735.91 8026,-1735.91 8026,-1741.91 8020,-1747.91 8014,-1747.91 8014,-1747.91 28,-1747.91 28,-1747.91 22,-1747.91 16,-1741.91 16,-1735.91 16,-1735.91 16,-1638.91 16,-1638.91 16,-1632.91 22,-1626.91 28,-1626.91"/>
<text text-anchor="middle" x="4021" y="-1732.71" font-family="Times,serif" font-size="14.00">Expert Group 7 (GPU 7)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightyellow" stroke="transparent" points="56811.5,-1827.91 56522.5,-1827.91 56522.5,-1786.91 56811.5,-1786.91 56811.5,-1827.91"/>
<text text-anchor="middle" x="56667" y="-1815.91" font-family="Arial Bold" font-size="10.00">Input</text>
<text text-anchor="middle" x="56667" y="-1804.91" font-family="Arial Bold" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-1793.91" font-family="Arial Bold" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_route -->
<g id="node2" class="node">
<title>layer0_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="56953.29,-1716.91 56497.87,-1716.91 56380.71,-1634.91 56836.13,-1634.91 56953.29,-1716.91"/>
<text text-anchor="middle" x="56667" y="-1684.41" font-family="Arial" font-size="10.00">Expert Routing L0</text>
<text text-anchor="middle" x="56667" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- input&#45;&gt;layer0_expert0_route -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_expert0_route</title>
<path fill="none" stroke="black" d="M56667,-1786.75C56667,-1770.94 56667,-1748.01 56667,-1727.19"/>
<polygon fill="black" stroke="black" points="56670.5,-1727.17 56667,-1717.17 56663.5,-1727.17 56670.5,-1727.17"/>
</g>
<!-- layer0_expert0_gate -->
<g id="node3" class="node">
<title>layer0_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="56945.77,-1598.91 56502.31,-1598.91 56388.23,-1516.91 56831.69,-1516.91 56945.77,-1598.91"/>
<text text-anchor="middle" x="56667" y="-1566.41" font-family="Arial" font-size="10.00">Expert Gate L0</text>
<text text-anchor="middle" x="56667" y="-1555.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-1544.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert0_route&#45;&gt;layer0_expert0_gate -->
<g id="edge2" class="edge">
<title>layer0_expert0_route&#45;&gt;layer0_expert0_gate</title>
<path fill="none" stroke="black" d="M56667,-1634.67C56667,-1626.48 56667,-1617.77 56667,-1609.28"/>
<polygon fill="black" stroke="black" points="56670.5,-1609.09 56667,-1599.09 56663.5,-1609.09 56670.5,-1609.09"/>
</g>
<!-- layer0_expert0_a2a -->
<g id="node4" class="node">
<title>layer0_expert0_a2a</title>
<ellipse fill="lightyellow" stroke="black" cx="56667" cy="-1451.92" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="56667" y="-1460.42" font-family="Arial" font-size="10.00">All&#45;to&#45;All Comm L0</text>
<text text-anchor="middle" x="56667" y="-1449.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-1438.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_gate&#45;&gt;layer0_expert0_a2a -->
<g id="edge3" class="edge">
<title>layer0_expert0_gate&#45;&gt;layer0_expert0_a2a</title>
<path fill="none" stroke="black" d="M56667,-1516.71C56667,-1508.35 56667,-1499.56 56667,-1491.27"/>
<polygon fill="black" stroke="black" points="56670.5,-1491.11 56667,-1481.11 56663.5,-1491.11 56670.5,-1491.11"/>
</g>
<!-- layer0_expert0_attn_split -->
<g id="node5" class="node">
<title>layer0_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="56952.21,-1386.93 56498.5,-1386.93 56381.79,-1304.93 56835.5,-1304.93 56952.21,-1386.93"/>
<text text-anchor="middle" x="56667" y="-1354.43" font-family="Arial" font-size="10.00">Attention Split L0</text>
<text text-anchor="middle" x="56667" y="-1343.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-1332.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert0_a2a&#45;&gt;layer0_expert0_attn_split -->
<g id="edge4" class="edge">
<title>layer0_expert0_a2a&#45;&gt;layer0_expert0_attn_split</title>
<path fill="none" stroke="black" d="M56667,-1422.78C56667,-1414.91 56667,-1406.11 56667,-1397.37"/>
<polygon fill="black" stroke="black" points="56670.5,-1397.2 56667,-1387.2 56663.5,-1397.2 56670.5,-1397.2"/>
</g>
<!-- layer0_expert0_q_proj -->
<g id="node6" class="node">
<title>layer0_expert0_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="56511.5,-1268.93 56236.5,-1268.93 56236.5,-1227.93 56511.5,-1227.93 56511.5,-1268.93"/>
<text text-anchor="middle" x="56374" y="-1256.93" font-family="Arial" font-size="10.00">Q Projection L0</text>
<text text-anchor="middle" x="56374" y="-1245.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56374" y="-1234.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert0_attn_split&#45;&gt;layer0_expert0_q_proj -->
<g id="edge5" class="edge">
<title>layer0_expert0_attn_split&#45;&gt;layer0_expert0_q_proj</title>
<path fill="none" stroke="black" d="M56544.02,-1304.85C56509.68,-1293.65 56473.57,-1281.88 56443.5,-1272.08"/>
<polygon fill="black" stroke="black" points="56444.56,-1268.75 56433.96,-1268.98 56442.39,-1275.4 56444.56,-1268.75"/>
</g>
<!-- layer0_expert0_k_proj -->
<g id="node7" class="node">
<title>layer0_expert0_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="56804.5,-1268.93 56529.5,-1268.93 56529.5,-1227.93 56804.5,-1227.93 56804.5,-1268.93"/>
<text text-anchor="middle" x="56667" y="-1256.93" font-family="Arial" font-size="10.00">K Projection L0</text>
<text text-anchor="middle" x="56667" y="-1245.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-1234.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert0_attn_split&#45;&gt;layer0_expert0_k_proj -->
<g id="edge6" class="edge">
<title>layer0_expert0_attn_split&#45;&gt;layer0_expert0_k_proj</title>
<path fill="none" stroke="black" d="M56667,-1304.71C56667,-1296.13 56667,-1287.22 56667,-1279.12"/>
<polygon fill="black" stroke="black" points="56670.5,-1279.04 56667,-1269.04 56663.5,-1279.04 56670.5,-1279.04"/>
</g>
<!-- layer0_expert0_v_proj -->
<g id="node8" class="node">
<title>layer0_expert0_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="57097.5,-1268.93 56822.5,-1268.93 56822.5,-1227.93 57097.5,-1227.93 57097.5,-1268.93"/>
<text text-anchor="middle" x="56960" y="-1256.93" font-family="Arial" font-size="10.00">V Projection L0</text>
<text text-anchor="middle" x="56960" y="-1245.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56960" y="-1234.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert0_attn_split&#45;&gt;layer0_expert0_v_proj -->
<g id="edge7" class="edge">
<title>layer0_expert0_attn_split&#45;&gt;layer0_expert0_v_proj</title>
<path fill="none" stroke="black" d="M56789.98,-1304.85C56824.32,-1293.65 56860.43,-1281.88 56890.5,-1272.08"/>
<polygon fill="black" stroke="black" points="56891.61,-1275.4 56900.04,-1268.98 56889.44,-1268.75 56891.61,-1275.4"/>
</g>
<!-- layer0_expert0_attn -->
<g id="node9" class="node">
<title>layer0_expert0_attn</title>
<polygon fill="lightyellow" stroke="black" points="56804.5,-1191.93 56529.5,-1191.93 56529.5,-1150.93 56804.5,-1150.93 56804.5,-1191.93"/>
<text text-anchor="middle" x="56667" y="-1179.93" font-family="Arial" font-size="10.00">Attention Computation L0</text>
<text text-anchor="middle" x="56667" y="-1168.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="56667" y="-1157.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert0_q_proj&#45;&gt;layer0_expert0_attn -->
<g id="edge8" class="edge">
<title>layer0_expert0_q_proj&#45;&gt;layer0_expert0_attn</title>
<path fill="none" stroke="black" d="M56450.22,-1227.92C56490.25,-1217.68 56539.45,-1205.08 56580.86,-1194.48"/>
<polygon fill="black" stroke="black" points="56581.84,-1197.84 56590.66,-1191.97 56580.1,-1191.06 56581.84,-1197.84"/>
</g>
<!-- layer0_expert0_k_proj&#45;&gt;layer0_expert0_attn -->
<g id="edge9" class="edge">
<title>layer0_expert0_k_proj&#45;&gt;layer0_expert0_attn</title>
<path fill="none" stroke="black" d="M56667,-1227.73C56667,-1219.89 56667,-1210.7 56667,-1202.09"/>
<polygon fill="black" stroke="black" points="56670.5,-1202 56667,-1192 56663.5,-1202 56670.5,-1202"/>
</g>
<!-- layer0_expert0_v_proj&#45;&gt;layer0_expert0_attn -->
<g id="edge10" class="edge">
<title>layer0_expert0_v_proj&#45;&gt;layer0_expert0_attn</title>
<path fill="none" stroke="black" d="M56883.78,-1227.92C56843.75,-1217.68 56794.55,-1205.08 56753.14,-1194.48"/>
<polygon fill="black" stroke="black" points="56753.9,-1191.06 56743.34,-1191.97 56752.16,-1197.84 56753.9,-1191.06"/>
</g>
<!-- layer0_expert0_attn_out -->
<g id="node10" class="node">
<title>layer0_expert0_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="56805,-1114.93 56529,-1114.93 56529,-1073.93 56805,-1073.93 56805,-1114.93"/>
<text text-anchor="middle" x="56667" y="-1102.93" font-family="Arial" font-size="10.00">Attention Output L0</text>
<text text-anchor="middle" x="56667" y="-1091.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="56667" y="-1080.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_attn&#45;&gt;layer0_expert0_attn_out -->
<g id="edge11" class="edge">
<title>layer0_expert0_attn&#45;&gt;layer0_expert0_attn_out</title>
<path fill="none" stroke="black" d="M56667,-1150.73C56667,-1142.89 56667,-1133.7 56667,-1125.09"/>
<polygon fill="black" stroke="black" points="56670.5,-1125 56667,-1115 56663.5,-1125 56670.5,-1125"/>
</g>
<!-- layer0_expert0_attn_ar -->
<g id="node11" class="node">
<title>layer0_expert0_attn_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="56667" cy="-1008.94" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="56667" y="-1017.44" font-family="Arial" font-size="10.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="56667" y="-1006.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-995.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_attn_out&#45;&gt;layer0_expert0_attn_ar -->
<g id="edge12" class="edge">
<title>layer0_expert0_attn_out&#45;&gt;layer0_expert0_attn_ar</title>
<path fill="none" stroke="black" d="M56667,-1073.64C56667,-1066.02 56667,-1057.03 56667,-1048.24"/>
<polygon fill="black" stroke="black" points="56670.5,-1048.12 56667,-1038.12 56663.5,-1048.12 56670.5,-1048.12"/>
</g>
<!-- layer0_expert0_attn_res -->
<g id="node12" class="node">
<title>layer0_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="57184.18,-943.95 56361.46,-943.95 56149.82,-861.95 56972.54,-861.95 57184.18,-943.95"/>
<text text-anchor="middle" x="56667" y="-911.45" font-family="Arial" font-size="10.00">Attention Residual L0</text>
<text text-anchor="middle" x="56667" y="-900.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-889.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_attn_ar&#45;&gt;layer0_expert0_attn_res -->
<g id="edge13" class="edge">
<title>layer0_expert0_attn_ar&#45;&gt;layer0_expert0_attn_res</title>
<path fill="none" stroke="black" d="M56667,-979.8C56667,-971.93 56667,-963.13 56667,-954.39"/>
<polygon fill="black" stroke="black" points="56670.5,-954.22 56667,-944.22 56663.5,-954.22 56670.5,-954.22"/>
</g>
<!-- layer0_expert0_ln1 -->
<g id="node13" class="node">
<title>layer0_expert0_ln1</title>
<polygon fill="lightyellow" stroke="black" points="56805,-825.95 56529,-825.95 56529,-784.95 56805,-784.95 56805,-825.95"/>
<text text-anchor="middle" x="56667" y="-813.95" font-family="Arial" font-size="10.00">Layer Norm 1 L0</text>
<text text-anchor="middle" x="56667" y="-802.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-791.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_attn_res&#45;&gt;layer0_expert0_ln1 -->
<g id="edge14" class="edge">
<title>layer0_expert0_attn_res&#45;&gt;layer0_expert0_ln1</title>
<path fill="none" stroke="black" d="M56667,-861.72C56667,-853.15 56667,-844.24 56667,-836.14"/>
<polygon fill="black" stroke="black" points="56670.5,-836.06 56667,-826.06 56663.5,-836.06 56670.5,-836.06"/>
</g>
<!-- layer0_expert0_mlp1 -->
<g id="node14" class="node">
<title>layer0_expert0_mlp1</title>
<polygon fill="lightyellow" stroke="black" points="56802.5,-748.95 56531.5,-748.95 56531.5,-707.95 56802.5,-707.95 56802.5,-748.95"/>
<text text-anchor="middle" x="56667" y="-736.95" font-family="Arial" font-size="10.00">MLP First Linear L0</text>
<text text-anchor="middle" x="56667" y="-725.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-714.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert0_ln1&#45;&gt;layer0_expert0_mlp1 -->
<g id="edge15" class="edge">
<title>layer0_expert0_ln1&#45;&gt;layer0_expert0_mlp1</title>
<path fill="none" stroke="black" d="M56667,-784.74C56667,-776.91 56667,-767.72 56667,-759.11"/>
<polygon fill="black" stroke="black" points="56670.5,-759.02 56667,-749.02 56663.5,-759.02 56670.5,-759.02"/>
</g>
<!-- layer0_expert0_gelu -->
<g id="node15" class="node">
<title>layer0_expert0_gelu</title>
<polygon fill="lightyellow" stroke="black" points="56802.5,-671.95 56531.5,-671.95 56531.5,-630.95 56802.5,-630.95 56802.5,-671.95"/>
<text text-anchor="middle" x="56667" y="-659.95" font-family="Arial" font-size="10.00">GELU Activation L0</text>
<text text-anchor="middle" x="56667" y="-648.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="56667" y="-637.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert0_mlp1&#45;&gt;layer0_expert0_gelu -->
<g id="edge16" class="edge">
<title>layer0_expert0_mlp1&#45;&gt;layer0_expert0_gelu</title>
<path fill="none" stroke="black" d="M56667,-707.74C56667,-699.91 56667,-690.72 56667,-682.11"/>
<polygon fill="black" stroke="black" points="56670.5,-682.02 56667,-672.02 56663.5,-682.02 56670.5,-682.02"/>
</g>
<!-- layer0_expert0_mlp2 -->
<g id="node16" class="node">
<title>layer0_expert0_mlp2</title>
<polygon fill="lightyellow" stroke="black" points="56805,-594.95 56529,-594.95 56529,-553.95 56805,-553.95 56805,-594.95"/>
<text text-anchor="middle" x="56667" y="-582.95" font-family="Arial" font-size="10.00">MLP Second Linear L0</text>
<text text-anchor="middle" x="56667" y="-571.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="56667" y="-560.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_gelu&#45;&gt;layer0_expert0_mlp2 -->
<g id="edge17" class="edge">
<title>layer0_expert0_gelu&#45;&gt;layer0_expert0_mlp2</title>
<path fill="none" stroke="black" d="M56667,-630.74C56667,-622.91 56667,-613.72 56667,-605.11"/>
<polygon fill="black" stroke="black" points="56670.5,-605.02 56667,-595.02 56663.5,-605.02 56670.5,-605.02"/>
</g>
<!-- layer0_expert0_mlp_ar -->
<g id="node17" class="node">
<title>layer0_expert0_mlp_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="56667" cy="-488.96" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="56667" y="-497.46" font-family="Arial" font-size="10.00">MLP All&#45;Reduce L0</text>
<text text-anchor="middle" x="56667" y="-486.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-475.46" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_mlp2&#45;&gt;layer0_expert0_mlp_ar -->
<g id="edge18" class="edge">
<title>layer0_expert0_mlp2&#45;&gt;layer0_expert0_mlp_ar</title>
<path fill="none" stroke="black" d="M56667,-553.66C56667,-546.04 56667,-537.05 56667,-528.26"/>
<polygon fill="black" stroke="black" points="56670.5,-528.13 56667,-518.13 56663.5,-528.13 56670.5,-528.13"/>
</g>
<!-- layer0_expert0_mlp_res -->
<g id="node18" class="node">
<title>layer0_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="57184.18,-423.97 56361.46,-423.97 56149.82,-341.97 56972.54,-341.97 57184.18,-423.97"/>
<text text-anchor="middle" x="56667" y="-391.47" font-family="Arial" font-size="10.00">MLP Residual L0</text>
<text text-anchor="middle" x="56667" y="-380.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-369.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_mlp_ar&#45;&gt;layer0_expert0_mlp_res -->
<g id="edge19" class="edge">
<title>layer0_expert0_mlp_ar&#45;&gt;layer0_expert0_mlp_res</title>
<path fill="none" stroke="black" d="M56667,-459.82C56667,-451.95 56667,-443.15 56667,-434.41"/>
<polygon fill="black" stroke="black" points="56670.5,-434.23 56667,-424.23 56663.5,-434.23 56670.5,-434.23"/>
</g>
<!-- layer0_expert0_ln2 -->
<g id="node19" class="node">
<title>layer0_expert0_ln2</title>
<polygon fill="lightyellow" stroke="black" points="56805,-305.97 56529,-305.97 56529,-264.97 56805,-264.97 56805,-305.97"/>
<text text-anchor="middle" x="56667" y="-293.97" font-family="Arial" font-size="10.00">Layer Norm 2 L0</text>
<text text-anchor="middle" x="56667" y="-282.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-271.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_mlp_res&#45;&gt;layer0_expert0_ln2 -->
<g id="edge20" class="edge">
<title>layer0_expert0_mlp_res&#45;&gt;layer0_expert0_ln2</title>
<path fill="none" stroke="black" d="M56667,-341.74C56667,-333.16 56667,-324.25 56667,-316.16"/>
<polygon fill="black" stroke="black" points="56670.5,-316.08 56667,-306.08 56663.5,-316.08 56670.5,-316.08"/>
</g>
<!-- pipeline_send_0_1 -->
<g id="node146" class="node">
<title>pipeline_send_0_1</title>
<ellipse fill="orange" stroke="black" cx="56667" cy="-199.97" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="56667" y="-208.47" font-family="Arial" font-size="10.00">Pipeline Send Stage0â†’1</text>
<text text-anchor="middle" x="56667" y="-197.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-186.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_ln2&#45;&gt;pipeline_send_0_1 -->
<g id="edge21" class="edge">
<title>layer0_expert0_ln2&#45;&gt;pipeline_send_0_1</title>
<path fill="none" stroke="black" d="M56667,-264.68C56667,-257.05 56667,-248.06 56667,-239.28"/>
<polygon fill="black" stroke="black" points="56670.5,-239.15 56667,-229.15 56663.5,-239.15 56670.5,-239.15"/>
</g>
<!-- layer0_expert1_route -->
<g id="node20" class="node">
<title>layer0_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="56126.29,-1716.91 55670.87,-1716.91 55553.71,-1634.91 56009.13,-1634.91 56126.29,-1716.91"/>
<text text-anchor="middle" x="55840" y="-1684.41" font-family="Arial" font-size="10.00">Expert Routing L0</text>
<text text-anchor="middle" x="55840" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="55840" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_gate -->
<g id="node21" class="node">
<title>layer0_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="55535.77,-1716.91 55092.31,-1716.91 54978.23,-1634.91 55421.69,-1634.91 55535.77,-1716.91"/>
<text text-anchor="middle" x="55257" y="-1684.41" font-family="Arial" font-size="10.00">Expert Gate L0</text>
<text text-anchor="middle" x="55257" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="55257" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert1_a2a -->
<g id="node22" class="node">
<title>layer0_expert1_a2a</title>
<ellipse fill="lightyellow" stroke="black" cx="54765" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="54765" y="-1684.41" font-family="Arial" font-size="10.00">All&#45;to&#45;All Comm L0</text>
<text text-anchor="middle" x="54765" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="54765" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_attn_split -->
<g id="node23" class="node">
<title>layer0_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="54552.21,-1716.91 54098.5,-1716.91 53981.79,-1634.91 54435.5,-1634.91 54552.21,-1716.91"/>
<text text-anchor="middle" x="54267" y="-1684.41" font-family="Arial" font-size="10.00">Attention Split L0</text>
<text text-anchor="middle" x="54267" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="54267" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert1_q_proj -->
<g id="node24" class="node">
<title>layer0_expert1_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="53963.5,-1696.41 53688.5,-1696.41 53688.5,-1655.41 53963.5,-1655.41 53963.5,-1696.41"/>
<text text-anchor="middle" x="53826" y="-1684.41" font-family="Arial" font-size="10.00">Q Projection L0</text>
<text text-anchor="middle" x="53826" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="53826" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert1_k_proj -->
<g id="node25" class="node">
<title>layer0_expert1_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="53670.5,-1696.41 53395.5,-1696.41 53395.5,-1655.41 53670.5,-1655.41 53670.5,-1696.41"/>
<text text-anchor="middle" x="53533" y="-1684.41" font-family="Arial" font-size="10.00">K Projection L0</text>
<text text-anchor="middle" x="53533" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="53533" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert1_v_proj -->
<g id="node26" class="node">
<title>layer0_expert1_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="53377.5,-1696.41 53102.5,-1696.41 53102.5,-1655.41 53377.5,-1655.41 53377.5,-1696.41"/>
<text text-anchor="middle" x="53240" y="-1684.41" font-family="Arial" font-size="10.00">V Projection L0</text>
<text text-anchor="middle" x="53240" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="53240" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert1_attn -->
<g id="node27" class="node">
<title>layer0_expert1_attn</title>
<polygon fill="lightyellow" stroke="black" points="53084.5,-1696.41 52809.5,-1696.41 52809.5,-1655.41 53084.5,-1655.41 53084.5,-1696.41"/>
<text text-anchor="middle" x="52947" y="-1684.41" font-family="Arial" font-size="10.00">Attention Computation L0</text>
<text text-anchor="middle" x="52947" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="52947" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert1_attn_out -->
<g id="node28" class="node">
<title>layer0_expert1_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="52791,-1696.41 52515,-1696.41 52515,-1655.41 52791,-1655.41 52791,-1696.41"/>
<text text-anchor="middle" x="52653" y="-1684.41" font-family="Arial" font-size="10.00">Attention Output L0</text>
<text text-anchor="middle" x="52653" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="52653" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_attn_ar -->
<g id="node29" class="node">
<title>layer0_expert1_attn_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="52302" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="52302" y="-1684.41" font-family="Arial" font-size="10.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="52302" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="52302" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_attn_res -->
<g id="node30" class="node">
<title>layer0_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="52088.18,-1716.91 51265.46,-1716.91 51053.82,-1634.91 51876.54,-1634.91 52088.18,-1716.91"/>
<text text-anchor="middle" x="51571" y="-1684.41" font-family="Arial" font-size="10.00">Attention Residual L0</text>
<text text-anchor="middle" x="51571" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="51571" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_ln1 -->
<g id="node31" class="node">
<title>layer0_expert1_ln1</title>
<polygon fill="lightyellow" stroke="black" points="51036,-1696.41 50760,-1696.41 50760,-1655.41 51036,-1655.41 51036,-1696.41"/>
<text text-anchor="middle" x="50898" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 1 L0</text>
<text text-anchor="middle" x="50898" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="50898" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_mlp1 -->
<g id="node32" class="node">
<title>layer0_expert1_mlp1</title>
<polygon fill="lightyellow" stroke="black" points="50741.5,-1696.41 50470.5,-1696.41 50470.5,-1655.41 50741.5,-1655.41 50741.5,-1696.41"/>
<text text-anchor="middle" x="50606" y="-1684.41" font-family="Arial" font-size="10.00">MLP First Linear L0</text>
<text text-anchor="middle" x="50606" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="50606" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert1_gelu -->
<g id="node33" class="node">
<title>layer0_expert1_gelu</title>
<polygon fill="lightyellow" stroke="black" points="50452.5,-1696.41 50181.5,-1696.41 50181.5,-1655.41 50452.5,-1655.41 50452.5,-1696.41"/>
<text text-anchor="middle" x="50317" y="-1684.41" font-family="Arial" font-size="10.00">GELU Activation L0</text>
<text text-anchor="middle" x="50317" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="50317" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert1_mlp2 -->
<g id="node34" class="node">
<title>layer0_expert1_mlp2</title>
<polygon fill="lightyellow" stroke="black" points="50163,-1696.41 49887,-1696.41 49887,-1655.41 50163,-1655.41 50163,-1696.41"/>
<text text-anchor="middle" x="50025" y="-1684.41" font-family="Arial" font-size="10.00">MLP Second Linear L0</text>
<text text-anchor="middle" x="50025" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="50025" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_mlp_ar -->
<g id="node35" class="node">
<title>layer0_expert1_mlp_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="49674" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="49674" y="-1684.41" font-family="Arial" font-size="10.00">MLP All&#45;Reduce L0</text>
<text text-anchor="middle" x="49674" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="49674" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_mlp_res -->
<g id="node36" class="node">
<title>layer0_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="49460.18,-1716.91 48637.46,-1716.91 48425.82,-1634.91 49248.54,-1634.91 49460.18,-1716.91"/>
<text text-anchor="middle" x="48943" y="-1684.41" font-family="Arial" font-size="10.00">MLP Residual L0</text>
<text text-anchor="middle" x="48943" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="48943" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_ln2 -->
<g id="node37" class="node">
<title>layer0_expert1_ln2</title>
<polygon fill="lightyellow" stroke="black" points="48408,-1696.41 48132,-1696.41 48132,-1655.41 48408,-1655.41 48408,-1696.41"/>
<text text-anchor="middle" x="48270" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 2 L0</text>
<text text-anchor="middle" x="48270" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="48270" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_route -->
<g id="node38" class="node">
<title>layer0_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="48108.29,-1716.91 47652.87,-1716.91 47535.71,-1634.91 47991.13,-1634.91 48108.29,-1716.91"/>
<text text-anchor="middle" x="47822" y="-1684.41" font-family="Arial" font-size="10.00">Expert Routing L0</text>
<text text-anchor="middle" x="47822" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="47822" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_gate -->
<g id="node39" class="node">
<title>layer0_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="47517.77,-1716.91 47074.31,-1716.91 46960.23,-1634.91 47403.69,-1634.91 47517.77,-1716.91"/>
<text text-anchor="middle" x="47239" y="-1684.41" font-family="Arial" font-size="10.00">Expert Gate L0</text>
<text text-anchor="middle" x="47239" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="47239" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert2_a2a -->
<g id="node40" class="node">
<title>layer0_expert2_a2a</title>
<ellipse fill="lightyellow" stroke="black" cx="46747" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="46747" y="-1684.41" font-family="Arial" font-size="10.00">All&#45;to&#45;All Comm L0</text>
<text text-anchor="middle" x="46747" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="46747" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_attn_split -->
<g id="node41" class="node">
<title>layer0_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="46534.21,-1716.91 46080.5,-1716.91 45963.79,-1634.91 46417.5,-1634.91 46534.21,-1716.91"/>
<text text-anchor="middle" x="46249" y="-1684.41" font-family="Arial" font-size="10.00">Attention Split L0</text>
<text text-anchor="middle" x="46249" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="46249" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert2_q_proj -->
<g id="node42" class="node">
<title>layer0_expert2_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="45945.5,-1696.41 45670.5,-1696.41 45670.5,-1655.41 45945.5,-1655.41 45945.5,-1696.41"/>
<text text-anchor="middle" x="45808" y="-1684.41" font-family="Arial" font-size="10.00">Q Projection L0</text>
<text text-anchor="middle" x="45808" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="45808" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert2_k_proj -->
<g id="node43" class="node">
<title>layer0_expert2_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="45652.5,-1696.41 45377.5,-1696.41 45377.5,-1655.41 45652.5,-1655.41 45652.5,-1696.41"/>
<text text-anchor="middle" x="45515" y="-1684.41" font-family="Arial" font-size="10.00">K Projection L0</text>
<text text-anchor="middle" x="45515" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="45515" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert2_v_proj -->
<g id="node44" class="node">
<title>layer0_expert2_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="45359.5,-1696.41 45084.5,-1696.41 45084.5,-1655.41 45359.5,-1655.41 45359.5,-1696.41"/>
<text text-anchor="middle" x="45222" y="-1684.41" font-family="Arial" font-size="10.00">V Projection L0</text>
<text text-anchor="middle" x="45222" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="45222" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert2_attn -->
<g id="node45" class="node">
<title>layer0_expert2_attn</title>
<polygon fill="lightyellow" stroke="black" points="45066.5,-1696.41 44791.5,-1696.41 44791.5,-1655.41 45066.5,-1655.41 45066.5,-1696.41"/>
<text text-anchor="middle" x="44929" y="-1684.41" font-family="Arial" font-size="10.00">Attention Computation L0</text>
<text text-anchor="middle" x="44929" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="44929" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert2_attn_out -->
<g id="node46" class="node">
<title>layer0_expert2_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="44773,-1696.41 44497,-1696.41 44497,-1655.41 44773,-1655.41 44773,-1696.41"/>
<text text-anchor="middle" x="44635" y="-1684.41" font-family="Arial" font-size="10.00">Attention Output L0</text>
<text text-anchor="middle" x="44635" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="44635" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_attn_ar -->
<g id="node47" class="node">
<title>layer0_expert2_attn_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="44284" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="44284" y="-1684.41" font-family="Arial" font-size="10.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="44284" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="44284" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_attn_res -->
<g id="node48" class="node">
<title>layer0_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="44070.18,-1716.91 43247.46,-1716.91 43035.82,-1634.91 43858.54,-1634.91 44070.18,-1716.91"/>
<text text-anchor="middle" x="43553" y="-1684.41" font-family="Arial" font-size="10.00">Attention Residual L0</text>
<text text-anchor="middle" x="43553" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="43553" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_ln1 -->
<g id="node49" class="node">
<title>layer0_expert2_ln1</title>
<polygon fill="lightyellow" stroke="black" points="43018,-1696.41 42742,-1696.41 42742,-1655.41 43018,-1655.41 43018,-1696.41"/>
<text text-anchor="middle" x="42880" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 1 L0</text>
<text text-anchor="middle" x="42880" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="42880" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_mlp1 -->
<g id="node50" class="node">
<title>layer0_expert2_mlp1</title>
<polygon fill="lightyellow" stroke="black" points="42723.5,-1696.41 42452.5,-1696.41 42452.5,-1655.41 42723.5,-1655.41 42723.5,-1696.41"/>
<text text-anchor="middle" x="42588" y="-1684.41" font-family="Arial" font-size="10.00">MLP First Linear L0</text>
<text text-anchor="middle" x="42588" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="42588" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert2_gelu -->
<g id="node51" class="node">
<title>layer0_expert2_gelu</title>
<polygon fill="lightyellow" stroke="black" points="42434.5,-1696.41 42163.5,-1696.41 42163.5,-1655.41 42434.5,-1655.41 42434.5,-1696.41"/>
<text text-anchor="middle" x="42299" y="-1684.41" font-family="Arial" font-size="10.00">GELU Activation L0</text>
<text text-anchor="middle" x="42299" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="42299" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert2_mlp2 -->
<g id="node52" class="node">
<title>layer0_expert2_mlp2</title>
<polygon fill="lightyellow" stroke="black" points="42145,-1696.41 41869,-1696.41 41869,-1655.41 42145,-1655.41 42145,-1696.41"/>
<text text-anchor="middle" x="42007" y="-1684.41" font-family="Arial" font-size="10.00">MLP Second Linear L0</text>
<text text-anchor="middle" x="42007" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="42007" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_mlp_ar -->
<g id="node53" class="node">
<title>layer0_expert2_mlp_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="41656" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="41656" y="-1684.41" font-family="Arial" font-size="10.00">MLP All&#45;Reduce L0</text>
<text text-anchor="middle" x="41656" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="41656" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_mlp_res -->
<g id="node54" class="node">
<title>layer0_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="41442.18,-1716.91 40619.46,-1716.91 40407.82,-1634.91 41230.54,-1634.91 41442.18,-1716.91"/>
<text text-anchor="middle" x="40925" y="-1684.41" font-family="Arial" font-size="10.00">MLP Residual L0</text>
<text text-anchor="middle" x="40925" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="40925" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_ln2 -->
<g id="node55" class="node">
<title>layer0_expert2_ln2</title>
<polygon fill="lightyellow" stroke="black" points="40390,-1696.41 40114,-1696.41 40114,-1655.41 40390,-1655.41 40390,-1696.41"/>
<text text-anchor="middle" x="40252" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 2 L0</text>
<text text-anchor="middle" x="40252" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="40252" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_route -->
<g id="node56" class="node">
<title>layer0_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="40090.29,-1716.91 39634.87,-1716.91 39517.71,-1634.91 39973.13,-1634.91 40090.29,-1716.91"/>
<text text-anchor="middle" x="39804" y="-1684.41" font-family="Arial" font-size="10.00">Expert Routing L0</text>
<text text-anchor="middle" x="39804" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="39804" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_gate -->
<g id="node57" class="node">
<title>layer0_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="39499.77,-1716.91 39056.31,-1716.91 38942.23,-1634.91 39385.69,-1634.91 39499.77,-1716.91"/>
<text text-anchor="middle" x="39221" y="-1684.41" font-family="Arial" font-size="10.00">Expert Gate L0</text>
<text text-anchor="middle" x="39221" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="39221" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert3_a2a -->
<g id="node58" class="node">
<title>layer0_expert3_a2a</title>
<ellipse fill="lightyellow" stroke="black" cx="38729" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="38729" y="-1684.41" font-family="Arial" font-size="10.00">All&#45;to&#45;All Comm L0</text>
<text text-anchor="middle" x="38729" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="38729" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_attn_split -->
<g id="node59" class="node">
<title>layer0_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="38516.21,-1716.91 38062.5,-1716.91 37945.79,-1634.91 38399.5,-1634.91 38516.21,-1716.91"/>
<text text-anchor="middle" x="38231" y="-1684.41" font-family="Arial" font-size="10.00">Attention Split L0</text>
<text text-anchor="middle" x="38231" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="38231" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert3_q_proj -->
<g id="node60" class="node">
<title>layer0_expert3_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="37927.5,-1696.41 37652.5,-1696.41 37652.5,-1655.41 37927.5,-1655.41 37927.5,-1696.41"/>
<text text-anchor="middle" x="37790" y="-1684.41" font-family="Arial" font-size="10.00">Q Projection L0</text>
<text text-anchor="middle" x="37790" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="37790" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert3_k_proj -->
<g id="node61" class="node">
<title>layer0_expert3_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="37634.5,-1696.41 37359.5,-1696.41 37359.5,-1655.41 37634.5,-1655.41 37634.5,-1696.41"/>
<text text-anchor="middle" x="37497" y="-1684.41" font-family="Arial" font-size="10.00">K Projection L0</text>
<text text-anchor="middle" x="37497" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="37497" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert3_v_proj -->
<g id="node62" class="node">
<title>layer0_expert3_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="37341.5,-1696.41 37066.5,-1696.41 37066.5,-1655.41 37341.5,-1655.41 37341.5,-1696.41"/>
<text text-anchor="middle" x="37204" y="-1684.41" font-family="Arial" font-size="10.00">V Projection L0</text>
<text text-anchor="middle" x="37204" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="37204" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert3_attn -->
<g id="node63" class="node">
<title>layer0_expert3_attn</title>
<polygon fill="lightyellow" stroke="black" points="37048.5,-1696.41 36773.5,-1696.41 36773.5,-1655.41 37048.5,-1655.41 37048.5,-1696.41"/>
<text text-anchor="middle" x="36911" y="-1684.41" font-family="Arial" font-size="10.00">Attention Computation L0</text>
<text text-anchor="middle" x="36911" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="36911" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert3_attn_out -->
<g id="node64" class="node">
<title>layer0_expert3_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="36755,-1696.41 36479,-1696.41 36479,-1655.41 36755,-1655.41 36755,-1696.41"/>
<text text-anchor="middle" x="36617" y="-1684.41" font-family="Arial" font-size="10.00">Attention Output L0</text>
<text text-anchor="middle" x="36617" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="36617" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_attn_ar -->
<g id="node65" class="node">
<title>layer0_expert3_attn_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="36266" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="36266" y="-1684.41" font-family="Arial" font-size="10.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="36266" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="36266" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_attn_res -->
<g id="node66" class="node">
<title>layer0_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="36052.18,-1716.91 35229.46,-1716.91 35017.82,-1634.91 35840.54,-1634.91 36052.18,-1716.91"/>
<text text-anchor="middle" x="35535" y="-1684.41" font-family="Arial" font-size="10.00">Attention Residual L0</text>
<text text-anchor="middle" x="35535" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="35535" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_ln1 -->
<g id="node67" class="node">
<title>layer0_expert3_ln1</title>
<polygon fill="lightyellow" stroke="black" points="35000,-1696.41 34724,-1696.41 34724,-1655.41 35000,-1655.41 35000,-1696.41"/>
<text text-anchor="middle" x="34862" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 1 L0</text>
<text text-anchor="middle" x="34862" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="34862" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_mlp1 -->
<g id="node68" class="node">
<title>layer0_expert3_mlp1</title>
<polygon fill="lightyellow" stroke="black" points="34705.5,-1696.41 34434.5,-1696.41 34434.5,-1655.41 34705.5,-1655.41 34705.5,-1696.41"/>
<text text-anchor="middle" x="34570" y="-1684.41" font-family="Arial" font-size="10.00">MLP First Linear L0</text>
<text text-anchor="middle" x="34570" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="34570" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert3_gelu -->
<g id="node69" class="node">
<title>layer0_expert3_gelu</title>
<polygon fill="lightyellow" stroke="black" points="34416.5,-1696.41 34145.5,-1696.41 34145.5,-1655.41 34416.5,-1655.41 34416.5,-1696.41"/>
<text text-anchor="middle" x="34281" y="-1684.41" font-family="Arial" font-size="10.00">GELU Activation L0</text>
<text text-anchor="middle" x="34281" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="34281" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert3_mlp2 -->
<g id="node70" class="node">
<title>layer0_expert3_mlp2</title>
<polygon fill="lightyellow" stroke="black" points="34127,-1696.41 33851,-1696.41 33851,-1655.41 34127,-1655.41 34127,-1696.41"/>
<text text-anchor="middle" x="33989" y="-1684.41" font-family="Arial" font-size="10.00">MLP Second Linear L0</text>
<text text-anchor="middle" x="33989" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="33989" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_mlp_ar -->
<g id="node71" class="node">
<title>layer0_expert3_mlp_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="33638" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="33638" y="-1684.41" font-family="Arial" font-size="10.00">MLP All&#45;Reduce L0</text>
<text text-anchor="middle" x="33638" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="33638" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_mlp_res -->
<g id="node72" class="node">
<title>layer0_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="33424.18,-1716.91 32601.46,-1716.91 32389.82,-1634.91 33212.54,-1634.91 33424.18,-1716.91"/>
<text text-anchor="middle" x="32907" y="-1684.41" font-family="Arial" font-size="10.00">MLP Residual L0</text>
<text text-anchor="middle" x="32907" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="32907" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_ln2 -->
<g id="node73" class="node">
<title>layer0_expert3_ln2</title>
<polygon fill="lightyellow" stroke="black" points="32372,-1696.41 32096,-1696.41 32096,-1655.41 32372,-1655.41 32372,-1696.41"/>
<text text-anchor="middle" x="32234" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 2 L0</text>
<text text-anchor="middle" x="32234" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="32234" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_route -->
<g id="node74" class="node">
<title>layer0_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="32072.29,-1716.91 31616.87,-1716.91 31499.71,-1634.91 31955.13,-1634.91 32072.29,-1716.91"/>
<text text-anchor="middle" x="31786" y="-1684.41" font-family="Arial" font-size="10.00">Expert Routing L0</text>
<text text-anchor="middle" x="31786" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="31786" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_gate -->
<g id="node75" class="node">
<title>layer0_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="31481.77,-1716.91 31038.31,-1716.91 30924.23,-1634.91 31367.69,-1634.91 31481.77,-1716.91"/>
<text text-anchor="middle" x="31203" y="-1684.41" font-family="Arial" font-size="10.00">Expert Gate L0</text>
<text text-anchor="middle" x="31203" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="31203" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert4_a2a -->
<g id="node76" class="node">
<title>layer0_expert4_a2a</title>
<ellipse fill="lightyellow" stroke="black" cx="30711" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="30711" y="-1684.41" font-family="Arial" font-size="10.00">All&#45;to&#45;All Comm L0</text>
<text text-anchor="middle" x="30711" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="30711" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_attn_split -->
<g id="node77" class="node">
<title>layer0_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="30498.21,-1716.91 30044.5,-1716.91 29927.79,-1634.91 30381.5,-1634.91 30498.21,-1716.91"/>
<text text-anchor="middle" x="30213" y="-1684.41" font-family="Arial" font-size="10.00">Attention Split L0</text>
<text text-anchor="middle" x="30213" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="30213" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert4_q_proj -->
<g id="node78" class="node">
<title>layer0_expert4_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="29909.5,-1696.41 29634.5,-1696.41 29634.5,-1655.41 29909.5,-1655.41 29909.5,-1696.41"/>
<text text-anchor="middle" x="29772" y="-1684.41" font-family="Arial" font-size="10.00">Q Projection L0</text>
<text text-anchor="middle" x="29772" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="29772" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert4_k_proj -->
<g id="node79" class="node">
<title>layer0_expert4_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="29616.5,-1696.41 29341.5,-1696.41 29341.5,-1655.41 29616.5,-1655.41 29616.5,-1696.41"/>
<text text-anchor="middle" x="29479" y="-1684.41" font-family="Arial" font-size="10.00">K Projection L0</text>
<text text-anchor="middle" x="29479" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="29479" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert4_v_proj -->
<g id="node80" class="node">
<title>layer0_expert4_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="29323.5,-1696.41 29048.5,-1696.41 29048.5,-1655.41 29323.5,-1655.41 29323.5,-1696.41"/>
<text text-anchor="middle" x="29186" y="-1684.41" font-family="Arial" font-size="10.00">V Projection L0</text>
<text text-anchor="middle" x="29186" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="29186" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert4_attn -->
<g id="node81" class="node">
<title>layer0_expert4_attn</title>
<polygon fill="lightyellow" stroke="black" points="29030.5,-1696.41 28755.5,-1696.41 28755.5,-1655.41 29030.5,-1655.41 29030.5,-1696.41"/>
<text text-anchor="middle" x="28893" y="-1684.41" font-family="Arial" font-size="10.00">Attention Computation L0</text>
<text text-anchor="middle" x="28893" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="28893" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert4_attn_out -->
<g id="node82" class="node">
<title>layer0_expert4_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="28737,-1696.41 28461,-1696.41 28461,-1655.41 28737,-1655.41 28737,-1696.41"/>
<text text-anchor="middle" x="28599" y="-1684.41" font-family="Arial" font-size="10.00">Attention Output L0</text>
<text text-anchor="middle" x="28599" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="28599" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_attn_ar -->
<g id="node83" class="node">
<title>layer0_expert4_attn_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="28248" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="28248" y="-1684.41" font-family="Arial" font-size="10.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="28248" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="28248" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_attn_res -->
<g id="node84" class="node">
<title>layer0_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="28034.18,-1716.91 27211.46,-1716.91 26999.82,-1634.91 27822.54,-1634.91 28034.18,-1716.91"/>
<text text-anchor="middle" x="27517" y="-1684.41" font-family="Arial" font-size="10.00">Attention Residual L0</text>
<text text-anchor="middle" x="27517" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="27517" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_ln1 -->
<g id="node85" class="node">
<title>layer0_expert4_ln1</title>
<polygon fill="lightyellow" stroke="black" points="26982,-1696.41 26706,-1696.41 26706,-1655.41 26982,-1655.41 26982,-1696.41"/>
<text text-anchor="middle" x="26844" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 1 L0</text>
<text text-anchor="middle" x="26844" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="26844" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_mlp1 -->
<g id="node86" class="node">
<title>layer0_expert4_mlp1</title>
<polygon fill="lightyellow" stroke="black" points="26687.5,-1696.41 26416.5,-1696.41 26416.5,-1655.41 26687.5,-1655.41 26687.5,-1696.41"/>
<text text-anchor="middle" x="26552" y="-1684.41" font-family="Arial" font-size="10.00">MLP First Linear L0</text>
<text text-anchor="middle" x="26552" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="26552" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert4_gelu -->
<g id="node87" class="node">
<title>layer0_expert4_gelu</title>
<polygon fill="lightyellow" stroke="black" points="26398.5,-1696.41 26127.5,-1696.41 26127.5,-1655.41 26398.5,-1655.41 26398.5,-1696.41"/>
<text text-anchor="middle" x="26263" y="-1684.41" font-family="Arial" font-size="10.00">GELU Activation L0</text>
<text text-anchor="middle" x="26263" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="26263" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert4_mlp2 -->
<g id="node88" class="node">
<title>layer0_expert4_mlp2</title>
<polygon fill="lightyellow" stroke="black" points="26109,-1696.41 25833,-1696.41 25833,-1655.41 26109,-1655.41 26109,-1696.41"/>
<text text-anchor="middle" x="25971" y="-1684.41" font-family="Arial" font-size="10.00">MLP Second Linear L0</text>
<text text-anchor="middle" x="25971" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="25971" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_mlp_ar -->
<g id="node89" class="node">
<title>layer0_expert4_mlp_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="25620" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="25620" y="-1684.41" font-family="Arial" font-size="10.00">MLP All&#45;Reduce L0</text>
<text text-anchor="middle" x="25620" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="25620" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_mlp_res -->
<g id="node90" class="node">
<title>layer0_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="25406.18,-1716.91 24583.46,-1716.91 24371.82,-1634.91 25194.54,-1634.91 25406.18,-1716.91"/>
<text text-anchor="middle" x="24889" y="-1684.41" font-family="Arial" font-size="10.00">MLP Residual L0</text>
<text text-anchor="middle" x="24889" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="24889" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_ln2 -->
<g id="node91" class="node">
<title>layer0_expert4_ln2</title>
<polygon fill="lightyellow" stroke="black" points="24354,-1696.41 24078,-1696.41 24078,-1655.41 24354,-1655.41 24354,-1696.41"/>
<text text-anchor="middle" x="24216" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 2 L0</text>
<text text-anchor="middle" x="24216" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="24216" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_route -->
<g id="node92" class="node">
<title>layer0_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="24054.29,-1716.91 23598.87,-1716.91 23481.71,-1634.91 23937.13,-1634.91 24054.29,-1716.91"/>
<text text-anchor="middle" x="23768" y="-1684.41" font-family="Arial" font-size="10.00">Expert Routing L0</text>
<text text-anchor="middle" x="23768" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="23768" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_gate -->
<g id="node93" class="node">
<title>layer0_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="23463.77,-1716.91 23020.31,-1716.91 22906.23,-1634.91 23349.69,-1634.91 23463.77,-1716.91"/>
<text text-anchor="middle" x="23185" y="-1684.41" font-family="Arial" font-size="10.00">Expert Gate L0</text>
<text text-anchor="middle" x="23185" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="23185" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert5_a2a -->
<g id="node94" class="node">
<title>layer0_expert5_a2a</title>
<ellipse fill="lightyellow" stroke="black" cx="22693" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="22693" y="-1684.41" font-family="Arial" font-size="10.00">All&#45;to&#45;All Comm L0</text>
<text text-anchor="middle" x="22693" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="22693" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_attn_split -->
<g id="node95" class="node">
<title>layer0_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="22480.21,-1716.91 22026.5,-1716.91 21909.79,-1634.91 22363.5,-1634.91 22480.21,-1716.91"/>
<text text-anchor="middle" x="22195" y="-1684.41" font-family="Arial" font-size="10.00">Attention Split L0</text>
<text text-anchor="middle" x="22195" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="22195" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert5_q_proj -->
<g id="node96" class="node">
<title>layer0_expert5_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="21891.5,-1696.41 21616.5,-1696.41 21616.5,-1655.41 21891.5,-1655.41 21891.5,-1696.41"/>
<text text-anchor="middle" x="21754" y="-1684.41" font-family="Arial" font-size="10.00">Q Projection L0</text>
<text text-anchor="middle" x="21754" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="21754" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert5_k_proj -->
<g id="node97" class="node">
<title>layer0_expert5_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="21598.5,-1696.41 21323.5,-1696.41 21323.5,-1655.41 21598.5,-1655.41 21598.5,-1696.41"/>
<text text-anchor="middle" x="21461" y="-1684.41" font-family="Arial" font-size="10.00">K Projection L0</text>
<text text-anchor="middle" x="21461" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="21461" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert5_v_proj -->
<g id="node98" class="node">
<title>layer0_expert5_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="21305.5,-1696.41 21030.5,-1696.41 21030.5,-1655.41 21305.5,-1655.41 21305.5,-1696.41"/>
<text text-anchor="middle" x="21168" y="-1684.41" font-family="Arial" font-size="10.00">V Projection L0</text>
<text text-anchor="middle" x="21168" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="21168" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert5_attn -->
<g id="node99" class="node">
<title>layer0_expert5_attn</title>
<polygon fill="lightyellow" stroke="black" points="21012.5,-1696.41 20737.5,-1696.41 20737.5,-1655.41 21012.5,-1655.41 21012.5,-1696.41"/>
<text text-anchor="middle" x="20875" y="-1684.41" font-family="Arial" font-size="10.00">Attention Computation L0</text>
<text text-anchor="middle" x="20875" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="20875" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert5_attn_out -->
<g id="node100" class="node">
<title>layer0_expert5_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="20719,-1696.41 20443,-1696.41 20443,-1655.41 20719,-1655.41 20719,-1696.41"/>
<text text-anchor="middle" x="20581" y="-1684.41" font-family="Arial" font-size="10.00">Attention Output L0</text>
<text text-anchor="middle" x="20581" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="20581" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_attn_ar -->
<g id="node101" class="node">
<title>layer0_expert5_attn_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="20230" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="20230" y="-1684.41" font-family="Arial" font-size="10.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="20230" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="20230" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_attn_res -->
<g id="node102" class="node">
<title>layer0_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="20016.18,-1716.91 19193.46,-1716.91 18981.82,-1634.91 19804.54,-1634.91 20016.18,-1716.91"/>
<text text-anchor="middle" x="19499" y="-1684.41" font-family="Arial" font-size="10.00">Attention Residual L0</text>
<text text-anchor="middle" x="19499" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="19499" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_ln1 -->
<g id="node103" class="node">
<title>layer0_expert5_ln1</title>
<polygon fill="lightyellow" stroke="black" points="18964,-1696.41 18688,-1696.41 18688,-1655.41 18964,-1655.41 18964,-1696.41"/>
<text text-anchor="middle" x="18826" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 1 L0</text>
<text text-anchor="middle" x="18826" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="18826" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_mlp1 -->
<g id="node104" class="node">
<title>layer0_expert5_mlp1</title>
<polygon fill="lightyellow" stroke="black" points="18669.5,-1696.41 18398.5,-1696.41 18398.5,-1655.41 18669.5,-1655.41 18669.5,-1696.41"/>
<text text-anchor="middle" x="18534" y="-1684.41" font-family="Arial" font-size="10.00">MLP First Linear L0</text>
<text text-anchor="middle" x="18534" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="18534" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert5_gelu -->
<g id="node105" class="node">
<title>layer0_expert5_gelu</title>
<polygon fill="lightyellow" stroke="black" points="18380.5,-1696.41 18109.5,-1696.41 18109.5,-1655.41 18380.5,-1655.41 18380.5,-1696.41"/>
<text text-anchor="middle" x="18245" y="-1684.41" font-family="Arial" font-size="10.00">GELU Activation L0</text>
<text text-anchor="middle" x="18245" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="18245" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert5_mlp2 -->
<g id="node106" class="node">
<title>layer0_expert5_mlp2</title>
<polygon fill="lightyellow" stroke="black" points="18091,-1696.41 17815,-1696.41 17815,-1655.41 18091,-1655.41 18091,-1696.41"/>
<text text-anchor="middle" x="17953" y="-1684.41" font-family="Arial" font-size="10.00">MLP Second Linear L0</text>
<text text-anchor="middle" x="17953" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="17953" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_mlp_ar -->
<g id="node107" class="node">
<title>layer0_expert5_mlp_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="17602" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="17602" y="-1684.41" font-family="Arial" font-size="10.00">MLP All&#45;Reduce L0</text>
<text text-anchor="middle" x="17602" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="17602" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_mlp_res -->
<g id="node108" class="node">
<title>layer0_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="17388.18,-1716.91 16565.46,-1716.91 16353.82,-1634.91 17176.54,-1634.91 17388.18,-1716.91"/>
<text text-anchor="middle" x="16871" y="-1684.41" font-family="Arial" font-size="10.00">MLP Residual L0</text>
<text text-anchor="middle" x="16871" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="16871" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_ln2 -->
<g id="node109" class="node">
<title>layer0_expert5_ln2</title>
<polygon fill="lightyellow" stroke="black" points="16336,-1696.41 16060,-1696.41 16060,-1655.41 16336,-1655.41 16336,-1696.41"/>
<text text-anchor="middle" x="16198" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 2 L0</text>
<text text-anchor="middle" x="16198" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="16198" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_route -->
<g id="node110" class="node">
<title>layer0_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="16036.29,-1716.91 15580.87,-1716.91 15463.71,-1634.91 15919.13,-1634.91 16036.29,-1716.91"/>
<text text-anchor="middle" x="15750" y="-1684.41" font-family="Arial" font-size="10.00">Expert Routing L0</text>
<text text-anchor="middle" x="15750" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="15750" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_gate -->
<g id="node111" class="node">
<title>layer0_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="15445.77,-1716.91 15002.31,-1716.91 14888.23,-1634.91 15331.69,-1634.91 15445.77,-1716.91"/>
<text text-anchor="middle" x="15167" y="-1684.41" font-family="Arial" font-size="10.00">Expert Gate L0</text>
<text text-anchor="middle" x="15167" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="15167" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert6_a2a -->
<g id="node112" class="node">
<title>layer0_expert6_a2a</title>
<ellipse fill="lightyellow" stroke="black" cx="14675" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="14675" y="-1684.41" font-family="Arial" font-size="10.00">All&#45;to&#45;All Comm L0</text>
<text text-anchor="middle" x="14675" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="14675" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_attn_split -->
<g id="node113" class="node">
<title>layer0_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="14462.21,-1716.91 14008.5,-1716.91 13891.79,-1634.91 14345.5,-1634.91 14462.21,-1716.91"/>
<text text-anchor="middle" x="14177" y="-1684.41" font-family="Arial" font-size="10.00">Attention Split L0</text>
<text text-anchor="middle" x="14177" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="14177" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert6_q_proj -->
<g id="node114" class="node">
<title>layer0_expert6_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="13873.5,-1696.41 13598.5,-1696.41 13598.5,-1655.41 13873.5,-1655.41 13873.5,-1696.41"/>
<text text-anchor="middle" x="13736" y="-1684.41" font-family="Arial" font-size="10.00">Q Projection L0</text>
<text text-anchor="middle" x="13736" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13736" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert6_k_proj -->
<g id="node115" class="node">
<title>layer0_expert6_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="13580.5,-1696.41 13305.5,-1696.41 13305.5,-1655.41 13580.5,-1655.41 13580.5,-1696.41"/>
<text text-anchor="middle" x="13443" y="-1684.41" font-family="Arial" font-size="10.00">K Projection L0</text>
<text text-anchor="middle" x="13443" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13443" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert6_v_proj -->
<g id="node116" class="node">
<title>layer0_expert6_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="13287.5,-1696.41 13012.5,-1696.41 13012.5,-1655.41 13287.5,-1655.41 13287.5,-1696.41"/>
<text text-anchor="middle" x="13150" y="-1684.41" font-family="Arial" font-size="10.00">V Projection L0</text>
<text text-anchor="middle" x="13150" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13150" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert6_attn -->
<g id="node117" class="node">
<title>layer0_expert6_attn</title>
<polygon fill="lightyellow" stroke="black" points="12994.5,-1696.41 12719.5,-1696.41 12719.5,-1655.41 12994.5,-1655.41 12994.5,-1696.41"/>
<text text-anchor="middle" x="12857" y="-1684.41" font-family="Arial" font-size="10.00">Attention Computation L0</text>
<text text-anchor="middle" x="12857" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="12857" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert6_attn_out -->
<g id="node118" class="node">
<title>layer0_expert6_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="12701,-1696.41 12425,-1696.41 12425,-1655.41 12701,-1655.41 12701,-1696.41"/>
<text text-anchor="middle" x="12563" y="-1684.41" font-family="Arial" font-size="10.00">Attention Output L0</text>
<text text-anchor="middle" x="12563" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="12563" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_attn_ar -->
<g id="node119" class="node">
<title>layer0_expert6_attn_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="12212" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="12212" y="-1684.41" font-family="Arial" font-size="10.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="12212" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12212" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_attn_res -->
<g id="node120" class="node">
<title>layer0_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="11998.18,-1716.91 11175.46,-1716.91 10963.82,-1634.91 11786.54,-1634.91 11998.18,-1716.91"/>
<text text-anchor="middle" x="11481" y="-1684.41" font-family="Arial" font-size="10.00">Attention Residual L0</text>
<text text-anchor="middle" x="11481" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="11481" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_ln1 -->
<g id="node121" class="node">
<title>layer0_expert6_ln1</title>
<polygon fill="lightyellow" stroke="black" points="10946,-1696.41 10670,-1696.41 10670,-1655.41 10946,-1655.41 10946,-1696.41"/>
<text text-anchor="middle" x="10808" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 1 L0</text>
<text text-anchor="middle" x="10808" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="10808" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_mlp1 -->
<g id="node122" class="node">
<title>layer0_expert6_mlp1</title>
<polygon fill="lightyellow" stroke="black" points="10651.5,-1696.41 10380.5,-1696.41 10380.5,-1655.41 10651.5,-1655.41 10651.5,-1696.41"/>
<text text-anchor="middle" x="10516" y="-1684.41" font-family="Arial" font-size="10.00">MLP First Linear L0</text>
<text text-anchor="middle" x="10516" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="10516" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert6_gelu -->
<g id="node123" class="node">
<title>layer0_expert6_gelu</title>
<polygon fill="lightyellow" stroke="black" points="10362.5,-1696.41 10091.5,-1696.41 10091.5,-1655.41 10362.5,-1655.41 10362.5,-1696.41"/>
<text text-anchor="middle" x="10227" y="-1684.41" font-family="Arial" font-size="10.00">GELU Activation L0</text>
<text text-anchor="middle" x="10227" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="10227" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert6_mlp2 -->
<g id="node124" class="node">
<title>layer0_expert6_mlp2</title>
<polygon fill="lightyellow" stroke="black" points="10073,-1696.41 9797,-1696.41 9797,-1655.41 10073,-1655.41 10073,-1696.41"/>
<text text-anchor="middle" x="9935" y="-1684.41" font-family="Arial" font-size="10.00">MLP Second Linear L0</text>
<text text-anchor="middle" x="9935" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="9935" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_mlp_ar -->
<g id="node125" class="node">
<title>layer0_expert6_mlp_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="9584" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="9584" y="-1684.41" font-family="Arial" font-size="10.00">MLP All&#45;Reduce L0</text>
<text text-anchor="middle" x="9584" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="9584" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_mlp_res -->
<g id="node126" class="node">
<title>layer0_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="9370.18,-1716.91 8547.46,-1716.91 8335.82,-1634.91 9158.54,-1634.91 9370.18,-1716.91"/>
<text text-anchor="middle" x="8853" y="-1684.41" font-family="Arial" font-size="10.00">MLP Residual L0</text>
<text text-anchor="middle" x="8853" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8853" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_ln2 -->
<g id="node127" class="node">
<title>layer0_expert6_ln2</title>
<polygon fill="lightyellow" stroke="black" points="8318,-1696.41 8042,-1696.41 8042,-1655.41 8318,-1655.41 8318,-1696.41"/>
<text text-anchor="middle" x="8180" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 2 L0</text>
<text text-anchor="middle" x="8180" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8180" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_route -->
<g id="node128" class="node">
<title>layer0_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="8018.29,-1716.91 7562.87,-1716.91 7445.71,-1634.91 7901.13,-1634.91 8018.29,-1716.91"/>
<text text-anchor="middle" x="7732" y="-1684.41" font-family="Arial" font-size="10.00">Expert Routing L0</text>
<text text-anchor="middle" x="7732" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="7732" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_gate -->
<g id="node129" class="node">
<title>layer0_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="7427.77,-1716.91 6984.31,-1716.91 6870.23,-1634.91 7313.69,-1634.91 7427.77,-1716.91"/>
<text text-anchor="middle" x="7149" y="-1684.41" font-family="Arial" font-size="10.00">Expert Gate L0</text>
<text text-anchor="middle" x="7149" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="7149" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert7_a2a -->
<g id="node130" class="node">
<title>layer0_expert7_a2a</title>
<ellipse fill="lightyellow" stroke="black" cx="6657" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="6657" y="-1684.41" font-family="Arial" font-size="10.00">All&#45;to&#45;All Comm L0</text>
<text text-anchor="middle" x="6657" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="6657" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_attn_split -->
<g id="node131" class="node">
<title>layer0_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="6444.21,-1716.91 5990.5,-1716.91 5873.79,-1634.91 6327.5,-1634.91 6444.21,-1716.91"/>
<text text-anchor="middle" x="6159" y="-1684.41" font-family="Arial" font-size="10.00">Attention Split L0</text>
<text text-anchor="middle" x="6159" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="6159" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert7_q_proj -->
<g id="node132" class="node">
<title>layer0_expert7_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="5855.5,-1696.41 5580.5,-1696.41 5580.5,-1655.41 5855.5,-1655.41 5855.5,-1696.41"/>
<text text-anchor="middle" x="5718" y="-1684.41" font-family="Arial" font-size="10.00">Q Projection L0</text>
<text text-anchor="middle" x="5718" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5718" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert7_k_proj -->
<g id="node133" class="node">
<title>layer0_expert7_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="5562.5,-1696.41 5287.5,-1696.41 5287.5,-1655.41 5562.5,-1655.41 5562.5,-1696.41"/>
<text text-anchor="middle" x="5425" y="-1684.41" font-family="Arial" font-size="10.00">K Projection L0</text>
<text text-anchor="middle" x="5425" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5425" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert7_v_proj -->
<g id="node134" class="node">
<title>layer0_expert7_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="5269.5,-1696.41 4994.5,-1696.41 4994.5,-1655.41 5269.5,-1655.41 5269.5,-1696.41"/>
<text text-anchor="middle" x="5132" y="-1684.41" font-family="Arial" font-size="10.00">V Projection L0</text>
<text text-anchor="middle" x="5132" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5132" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert7_attn -->
<g id="node135" class="node">
<title>layer0_expert7_attn</title>
<polygon fill="lightyellow" stroke="black" points="4976.5,-1696.41 4701.5,-1696.41 4701.5,-1655.41 4976.5,-1655.41 4976.5,-1696.41"/>
<text text-anchor="middle" x="4839" y="-1684.41" font-family="Arial" font-size="10.00">Attention Computation L0</text>
<text text-anchor="middle" x="4839" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4839" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert7_attn_out -->
<g id="node136" class="node">
<title>layer0_expert7_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="4683,-1696.41 4407,-1696.41 4407,-1655.41 4683,-1655.41 4683,-1696.41"/>
<text text-anchor="middle" x="4545" y="-1684.41" font-family="Arial" font-size="10.00">Attention Output L0</text>
<text text-anchor="middle" x="4545" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4545" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_attn_ar -->
<g id="node137" class="node">
<title>layer0_expert7_attn_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="4194" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="4194" y="-1684.41" font-family="Arial" font-size="10.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="4194" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="4194" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_attn_res -->
<g id="node138" class="node">
<title>layer0_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="3980.18,-1716.91 3157.46,-1716.91 2945.82,-1634.91 3768.54,-1634.91 3980.18,-1716.91"/>
<text text-anchor="middle" x="3463" y="-1684.41" font-family="Arial" font-size="10.00">Attention Residual L0</text>
<text text-anchor="middle" x="3463" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="3463" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_ln1 -->
<g id="node139" class="node">
<title>layer0_expert7_ln1</title>
<polygon fill="lightyellow" stroke="black" points="2928,-1696.41 2652,-1696.41 2652,-1655.41 2928,-1655.41 2928,-1696.41"/>
<text text-anchor="middle" x="2790" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 1 L0</text>
<text text-anchor="middle" x="2790" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="2790" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_mlp1 -->
<g id="node140" class="node">
<title>layer0_expert7_mlp1</title>
<polygon fill="lightyellow" stroke="black" points="2633.5,-1696.41 2362.5,-1696.41 2362.5,-1655.41 2633.5,-1655.41 2633.5,-1696.41"/>
<text text-anchor="middle" x="2498" y="-1684.41" font-family="Arial" font-size="10.00">MLP First Linear L0</text>
<text text-anchor="middle" x="2498" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="2498" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert7_gelu -->
<g id="node141" class="node">
<title>layer0_expert7_gelu</title>
<polygon fill="lightyellow" stroke="black" points="2344.5,-1696.41 2073.5,-1696.41 2073.5,-1655.41 2344.5,-1655.41 2344.5,-1696.41"/>
<text text-anchor="middle" x="2209" y="-1684.41" font-family="Arial" font-size="10.00">GELU Activation L0</text>
<text text-anchor="middle" x="2209" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="2209" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert7_mlp2 -->
<g id="node142" class="node">
<title>layer0_expert7_mlp2</title>
<polygon fill="lightyellow" stroke="black" points="2055,-1696.41 1779,-1696.41 1779,-1655.41 2055,-1655.41 2055,-1696.41"/>
<text text-anchor="middle" x="1917" y="-1684.41" font-family="Arial" font-size="10.00">MLP Second Linear L0</text>
<text text-anchor="middle" x="1917" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
<text text-anchor="middle" x="1917" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_mlp_ar -->
<g id="node143" class="node">
<title>layer0_expert7_mlp_ar</title>
<ellipse fill="lightyellow" stroke="black" cx="1566" cy="-1675.91" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="1566" y="-1684.41" font-family="Arial" font-size="10.00">MLP All&#45;Reduce L0</text>
<text text-anchor="middle" x="1566" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="1566" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_mlp_res -->
<g id="node144" class="node">
<title>layer0_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="1352.18,-1716.91 529.46,-1716.91 317.82,-1634.91 1140.54,-1634.91 1352.18,-1716.91"/>
<text text-anchor="middle" x="835" y="-1684.41" font-family="Arial" font-size="10.00">MLP Residual L0</text>
<text text-anchor="middle" x="835" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024], [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="835" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_ln2 -->
<g id="node145" class="node">
<title>layer0_expert7_ln2</title>
<polygon fill="lightyellow" stroke="black" points="300,-1696.41 24,-1696.41 24,-1655.41 300,-1655.41 300,-1696.41"/>
<text text-anchor="middle" x="162" y="-1684.41" font-family="Arial" font-size="10.00">Layer Norm 2 L0</text>
<text text-anchor="middle" x="162" y="-1673.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="162" y="-1662.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- pipeline_recv_1_0 -->
<g id="node147" class="node">
<title>pipeline_recv_1_0</title>
<ellipse fill="orange" stroke="black" cx="56667" cy="-105.99" rx="195.32" ry="28.98"/>
<text text-anchor="middle" x="56667" y="-114.49" font-family="Arial" font-size="10.00">Pipeline Recv Stage0â†’1</text>
<text text-anchor="middle" x="56667" y="-103.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-92.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- pipeline_send_0_1&#45;&gt;pipeline_recv_1_0 -->
<g id="edge22" class="edge">
<title>pipeline_send_0_1&#45;&gt;pipeline_recv_1_0</title>
<path fill="none" stroke="black" d="M56667,-170.88C56667,-162.84 56667,-153.94 56667,-145.39"/>
<polygon fill="black" stroke="black" points="56670.5,-145.23 56667,-135.23 56663.5,-145.23 56670.5,-145.23"/>
</g>
<!-- output -->
<g id="node148" class="node">
<title>output</title>
<polygon fill="lightyellow" stroke="transparent" points="56811.5,-41 56522.5,-41 56522.5,0 56811.5,0 56811.5,-41"/>
<text text-anchor="middle" x="56667" y="-29" font-family="Arial Bold" font-size="10.00">Output</text>
<text text-anchor="middle" x="56667" y="-18" font-family="Arial Bold" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="56667" y="-7" font-family="Arial Bold" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- pipeline_recv_1_0&#45;&gt;output -->
<g id="edge23" class="edge">
<title>pipeline_recv_1_0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M56667,-76.73C56667,-68.48 56667,-59.44 56667,-51.11"/>
<polygon fill="black" stroke="black" points="56670.5,-51.05 56667,-41.05 56663.5,-51.05 56670.5,-51.05"/>
</g>
</g>
</svg>
