// Detailed MoE Layer Implementation
digraph {
	dpi=300 rankdir=TB size="30,40"
	node [fontname=Arial fontsize=9]
	input [label="Layer Input\n[batch_size=128, seq_len=1024, hidden_dim=1024]" fillcolor=white shape=box style=filled]
	router [label="Router Network\n[batch_size=128, seq_len=1024, hidden_dim=1024]\n→ [batch_size=128, seq_len=1024, num_experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	topk [label="Top-2 Expert Selection\n[batch_size=128, seq_len=1024, num_experts=64]\n→ [batch_size=128, seq_len=1024, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_weights [label="Expert Weights\n[batch_size=128, seq_len=1024, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	token_routing [label="Token Routing\n[batch_size=128, seq_len=1024, hidden_dim=1024]\n→ Expert-specific batches" fillcolor=lightblue shape=ellipse style=filled]
	subgraph cluster_expert_group_0 {
		fillcolor=lightcyan label="Expert Group 0 (GPU 0)" style="rounded,filled"
		a2a_group_0 [label="All-to-All Comm\nGroup 0\n[batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightblue shape=ellipse style=filled]
		expert_0 [label="Expert 0\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_0_ffn1 [label="Expert 0 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_0_gelu [label="Expert 0 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_0_ffn2 [label="Expert 0 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_1 [label="Expert 1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_1_ffn1 [label="Expert 1 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_1_gelu [label="Expert 1 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_1_ffn2 [label="Expert 1 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_2 [label="Expert 2\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_2_ffn1 [label="Expert 2 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_2_gelu [label="Expert 2 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_2_ffn2 [label="Expert 2 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_3 [label="Expert 3\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_3_ffn1 [label="Expert 3 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_3_gelu [label="Expert 3 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_3_ffn2 [label="Expert 3 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_4 [label="Expert 4\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_4_ffn1 [label="Expert 4 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_4_gelu [label="Expert 4 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_4_ffn2 [label="Expert 4 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_5 [label="Expert 5\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_5_ffn1 [label="Expert 5 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_5_gelu [label="Expert 5 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_5_ffn2 [label="Expert 5 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_6 [label="Expert 6\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_6_ffn1 [label="Expert 6 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_6_gelu [label="Expert 6 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_6_ffn2 [label="Expert 6 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_7 [label="Expert 7\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_7_ffn1 [label="Expert 7 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_7_gelu [label="Expert 7 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_7_ffn2 [label="Expert 7 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	}
	subgraph cluster_expert_group_1 {
		fillcolor=lightcyan label="Expert Group 1 (GPU 1)" style="rounded,filled"
		a2a_group_1 [label="All-to-All Comm\nGroup 1\n[batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightblue shape=ellipse style=filled]
		expert_8 [label="Expert 8\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_8_ffn1 [label="Expert 8 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_8_gelu [label="Expert 8 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_8_ffn2 [label="Expert 8 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_9 [label="Expert 9\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_9_ffn1 [label="Expert 9 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_9_gelu [label="Expert 9 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_9_ffn2 [label="Expert 9 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_10 [label="Expert 10\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_10_ffn1 [label="Expert 10 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_10_gelu [label="Expert 10 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_10_ffn2 [label="Expert 10 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_11 [label="Expert 11\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_11_ffn1 [label="Expert 11 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_11_gelu [label="Expert 11 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_11_ffn2 [label="Expert 11 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_12 [label="Expert 12\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_12_ffn1 [label="Expert 12 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_12_gelu [label="Expert 12 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_12_ffn2 [label="Expert 12 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_13 [label="Expert 13\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_13_ffn1 [label="Expert 13 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_13_gelu [label="Expert 13 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_13_ffn2 [label="Expert 13 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_14 [label="Expert 14\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_14_ffn1 [label="Expert 14 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_14_gelu [label="Expert 14 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_14_ffn2 [label="Expert 14 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_15 [label="Expert 15\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_15_ffn1 [label="Expert 15 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_15_gelu [label="Expert 15 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_15_ffn2 [label="Expert 15 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	}
	subgraph cluster_expert_group_2 {
		fillcolor=lightcyan label="Expert Group 2 (GPU 2)" style="rounded,filled"
		a2a_group_2 [label="All-to-All Comm\nGroup 2\n[batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightblue shape=ellipse style=filled]
		expert_16 [label="Expert 16\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_16_ffn1 [label="Expert 16 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_16_gelu [label="Expert 16 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_16_ffn2 [label="Expert 16 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_17 [label="Expert 17\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_17_ffn1 [label="Expert 17 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_17_gelu [label="Expert 17 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_17_ffn2 [label="Expert 17 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_18 [label="Expert 18\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_18_ffn1 [label="Expert 18 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_18_gelu [label="Expert 18 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_18_ffn2 [label="Expert 18 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_19 [label="Expert 19\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_19_ffn1 [label="Expert 19 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_19_gelu [label="Expert 19 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_19_ffn2 [label="Expert 19 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_20 [label="Expert 20\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_20_ffn1 [label="Expert 20 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_20_gelu [label="Expert 20 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_20_ffn2 [label="Expert 20 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_21 [label="Expert 21\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_21_ffn1 [label="Expert 21 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_21_gelu [label="Expert 21 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_21_ffn2 [label="Expert 21 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_22 [label="Expert 22\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_22_ffn1 [label="Expert 22 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_22_gelu [label="Expert 22 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_22_ffn2 [label="Expert 22 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_23 [label="Expert 23\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_23_ffn1 [label="Expert 23 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_23_gelu [label="Expert 23 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_23_ffn2 [label="Expert 23 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	}
	subgraph cluster_expert_group_3 {
		fillcolor=lightcyan label="Expert Group 3 (GPU 3)" style="rounded,filled"
		a2a_group_3 [label="All-to-All Comm\nGroup 3\n[batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightblue shape=ellipse style=filled]
		expert_24 [label="Expert 24\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_24_ffn1 [label="Expert 24 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_24_gelu [label="Expert 24 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_24_ffn2 [label="Expert 24 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_25 [label="Expert 25\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_25_ffn1 [label="Expert 25 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_25_gelu [label="Expert 25 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_25_ffn2 [label="Expert 25 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_26 [label="Expert 26\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_26_ffn1 [label="Expert 26 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_26_gelu [label="Expert 26 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_26_ffn2 [label="Expert 26 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_27 [label="Expert 27\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_27_ffn1 [label="Expert 27 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_27_gelu [label="Expert 27 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_27_ffn2 [label="Expert 27 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_28 [label="Expert 28\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_28_ffn1 [label="Expert 28 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_28_gelu [label="Expert 28 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_28_ffn2 [label="Expert 28 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_29 [label="Expert 29\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_29_ffn1 [label="Expert 29 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_29_gelu [label="Expert 29 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_29_ffn2 [label="Expert 29 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_30 [label="Expert 30\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_30_ffn1 [label="Expert 30 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_30_gelu [label="Expert 30 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_30_ffn2 [label="Expert 30 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_31 [label="Expert 31\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_31_ffn1 [label="Expert 31 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_31_gelu [label="Expert 31 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_31_ffn2 [label="Expert 31 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	}
	subgraph cluster_expert_group_4 {
		fillcolor=lightcyan label="Expert Group 4 (GPU 4)" style="rounded,filled"
		a2a_group_4 [label="All-to-All Comm\nGroup 4\n[batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightblue shape=ellipse style=filled]
		expert_32 [label="Expert 32\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_32_ffn1 [label="Expert 32 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_32_gelu [label="Expert 32 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_32_ffn2 [label="Expert 32 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_33 [label="Expert 33\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_33_ffn1 [label="Expert 33 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_33_gelu [label="Expert 33 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_33_ffn2 [label="Expert 33 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_34 [label="Expert 34\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_34_ffn1 [label="Expert 34 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_34_gelu [label="Expert 34 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_34_ffn2 [label="Expert 34 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_35 [label="Expert 35\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_35_ffn1 [label="Expert 35 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_35_gelu [label="Expert 35 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_35_ffn2 [label="Expert 35 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_36 [label="Expert 36\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_36_ffn1 [label="Expert 36 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_36_gelu [label="Expert 36 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_36_ffn2 [label="Expert 36 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_37 [label="Expert 37\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_37_ffn1 [label="Expert 37 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_37_gelu [label="Expert 37 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_37_ffn2 [label="Expert 37 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_38 [label="Expert 38\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_38_ffn1 [label="Expert 38 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_38_gelu [label="Expert 38 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_38_ffn2 [label="Expert 38 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_39 [label="Expert 39\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_39_ffn1 [label="Expert 39 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_39_gelu [label="Expert 39 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_39_ffn2 [label="Expert 39 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	}
	subgraph cluster_expert_group_5 {
		fillcolor=lightcyan label="Expert Group 5 (GPU 5)" style="rounded,filled"
		a2a_group_5 [label="All-to-All Comm\nGroup 5\n[batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightblue shape=ellipse style=filled]
		expert_40 [label="Expert 40\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_40_ffn1 [label="Expert 40 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_40_gelu [label="Expert 40 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_40_ffn2 [label="Expert 40 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_41 [label="Expert 41\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_41_ffn1 [label="Expert 41 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_41_gelu [label="Expert 41 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_41_ffn2 [label="Expert 41 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_42 [label="Expert 42\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_42_ffn1 [label="Expert 42 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_42_gelu [label="Expert 42 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_42_ffn2 [label="Expert 42 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_43 [label="Expert 43\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_43_ffn1 [label="Expert 43 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_43_gelu [label="Expert 43 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_43_ffn2 [label="Expert 43 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_44 [label="Expert 44\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_44_ffn1 [label="Expert 44 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_44_gelu [label="Expert 44 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_44_ffn2 [label="Expert 44 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_45 [label="Expert 45\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_45_ffn1 [label="Expert 45 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_45_gelu [label="Expert 45 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_45_ffn2 [label="Expert 45 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_46 [label="Expert 46\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_46_ffn1 [label="Expert 46 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_46_gelu [label="Expert 46 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_46_ffn2 [label="Expert 46 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_47 [label="Expert 47\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_47_ffn1 [label="Expert 47 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_47_gelu [label="Expert 47 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_47_ffn2 [label="Expert 47 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	}
	subgraph cluster_expert_group_6 {
		fillcolor=lightcyan label="Expert Group 6 (GPU 6)" style="rounded,filled"
		a2a_group_6 [label="All-to-All Comm\nGroup 6\n[batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightblue shape=ellipse style=filled]
		expert_48 [label="Expert 48\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_48_ffn1 [label="Expert 48 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_48_gelu [label="Expert 48 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_48_ffn2 [label="Expert 48 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_49 [label="Expert 49\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_49_ffn1 [label="Expert 49 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_49_gelu [label="Expert 49 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_49_ffn2 [label="Expert 49 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_50 [label="Expert 50\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_50_ffn1 [label="Expert 50 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_50_gelu [label="Expert 50 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_50_ffn2 [label="Expert 50 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_51 [label="Expert 51\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_51_ffn1 [label="Expert 51 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_51_gelu [label="Expert 51 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_51_ffn2 [label="Expert 51 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_52 [label="Expert 52\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_52_ffn1 [label="Expert 52 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_52_gelu [label="Expert 52 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_52_ffn2 [label="Expert 52 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_53 [label="Expert 53\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_53_ffn1 [label="Expert 53 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_53_gelu [label="Expert 53 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_53_ffn2 [label="Expert 53 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_54 [label="Expert 54\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_54_ffn1 [label="Expert 54 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_54_gelu [label="Expert 54 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_54_ffn2 [label="Expert 54 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_55 [label="Expert 55\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_55_ffn1 [label="Expert 55 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_55_gelu [label="Expert 55 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_55_ffn2 [label="Expert 55 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	}
	subgraph cluster_expert_group_7 {
		fillcolor=lightcyan label="Expert Group 7 (GPU 7)" style="rounded,filled"
		a2a_group_7 [label="All-to-All Comm\nGroup 7\n[batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightblue shape=ellipse style=filled]
		expert_56 [label="Expert 56\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_56_ffn1 [label="Expert 56 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_56_gelu [label="Expert 56 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_56_ffn2 [label="Expert 56 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_57 [label="Expert 57\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_57_ffn1 [label="Expert 57 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_57_gelu [label="Expert 57 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_57_ffn2 [label="Expert 57 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_58 [label="Expert 58\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_58_ffn1 [label="Expert 58 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_58_gelu [label="Expert 58 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_58_ffn2 [label="Expert 58 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_59 [label="Expert 59\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_59_ffn1 [label="Expert 59 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_59_gelu [label="Expert 59 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_59_ffn2 [label="Expert 59 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_60 [label="Expert 60\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_60_ffn1 [label="Expert 60 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_60_gelu [label="Expert 60 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_60_ffn2 [label="Expert 60 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_61 [label="Expert 61\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_61_ffn1 [label="Expert 61 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_61_gelu [label="Expert 61 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_61_ffn2 [label="Expert 61 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_62 [label="Expert 62\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_62_ffn1 [label="Expert 62 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_62_gelu [label="Expert 62 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_62_ffn2 [label="Expert 62 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_63 [label="Expert 63\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightcoral shape=rectangle style=filled]
		expert_63_ffn1 [label="Expert 63 FFN1\n[batch_size=?, seq_len=1024, hidden_dim=1024]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_63_gelu [label="Expert 63 GELU\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, ffn_hidden=2048]" fillcolor=lightgreen shape=rectangle style=filled]
		expert_63_ffn2 [label="Expert 63 FFN2\n[batch_size=?, seq_len=1024, ffn_hidden=2048]\n→ [batch_size=?, seq_len=1024, hidden_dim=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	}
	expert_agg [label="Expert Aggregation\n[batch_size=128, seq_len=1024, hidden_dim=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
	weighted_sum [label="Weighted Sum\n[batch_size=128, seq_len=1024, hidden_dim=1024]\n× [batch_size=128, seq_len=1024, top_k=2]\n→ [batch_size=128, seq_len=1024, hidden_dim=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
	output [label="Layer Output\n[batch_size=128, seq_len=1024, hidden_dim=1024]" fillcolor=white shape=box style=filled]
	input -> router
	router -> topk
	topk -> expert_weights
	expert_weights -> token_routing
	token_routing -> a2a_group_0
	a2a_group_0 -> expert_0
	expert_0 -> expert_0_ffn1
	expert_0_ffn1 -> expert_0_gelu
	expert_0_gelu -> expert_0_ffn2
	expert_0_ffn2 -> expert_agg
	expert_1 -> expert_1_ffn1
	expert_1_ffn1 -> expert_1_gelu
	expert_1_gelu -> expert_1_ffn2
	expert_1_ffn2 -> expert_agg
	expert_2 -> expert_2_ffn1
	expert_2_ffn1 -> expert_2_gelu
	expert_2_gelu -> expert_2_ffn2
	expert_2_ffn2 -> expert_agg
	expert_3 -> expert_3_ffn1
	expert_3_ffn1 -> expert_3_gelu
	expert_3_gelu -> expert_3_ffn2
	expert_3_ffn2 -> expert_agg
	expert_4 -> expert_4_ffn1
	expert_4_ffn1 -> expert_4_gelu
	expert_4_gelu -> expert_4_ffn2
	expert_4_ffn2 -> expert_agg
	expert_5 -> expert_5_ffn1
	expert_5_ffn1 -> expert_5_gelu
	expert_5_gelu -> expert_5_ffn2
	expert_5_ffn2 -> expert_agg
	expert_6 -> expert_6_ffn1
	expert_6_ffn1 -> expert_6_gelu
	expert_6_gelu -> expert_6_ffn2
	expert_6_ffn2 -> expert_agg
	expert_7 -> expert_7_ffn1
	expert_7_ffn1 -> expert_7_gelu
	expert_7_gelu -> expert_7_ffn2
	expert_7_ffn2 -> expert_agg
	token_routing -> a2a_group_1
	a2a_group_1 -> expert_8
	expert_8 -> expert_8_ffn1
	expert_8_ffn1 -> expert_8_gelu
	expert_8_gelu -> expert_8_ffn2
	expert_8_ffn2 -> expert_agg
	expert_9 -> expert_9_ffn1
	expert_9_ffn1 -> expert_9_gelu
	expert_9_gelu -> expert_9_ffn2
	expert_9_ffn2 -> expert_agg
	expert_10 -> expert_10_ffn1
	expert_10_ffn1 -> expert_10_gelu
	expert_10_gelu -> expert_10_ffn2
	expert_10_ffn2 -> expert_agg
	expert_11 -> expert_11_ffn1
	expert_11_ffn1 -> expert_11_gelu
	expert_11_gelu -> expert_11_ffn2
	expert_11_ffn2 -> expert_agg
	expert_12 -> expert_12_ffn1
	expert_12_ffn1 -> expert_12_gelu
	expert_12_gelu -> expert_12_ffn2
	expert_12_ffn2 -> expert_agg
	expert_13 -> expert_13_ffn1
	expert_13_ffn1 -> expert_13_gelu
	expert_13_gelu -> expert_13_ffn2
	expert_13_ffn2 -> expert_agg
	expert_14 -> expert_14_ffn1
	expert_14_ffn1 -> expert_14_gelu
	expert_14_gelu -> expert_14_ffn2
	expert_14_ffn2 -> expert_agg
	expert_15 -> expert_15_ffn1
	expert_15_ffn1 -> expert_15_gelu
	expert_15_gelu -> expert_15_ffn2
	expert_15_ffn2 -> expert_agg
	token_routing -> a2a_group_2
	a2a_group_2 -> expert_16
	expert_16 -> expert_16_ffn1
	expert_16_ffn1 -> expert_16_gelu
	expert_16_gelu -> expert_16_ffn2
	expert_16_ffn2 -> expert_agg
	expert_17 -> expert_17_ffn1
	expert_17_ffn1 -> expert_17_gelu
	expert_17_gelu -> expert_17_ffn2
	expert_17_ffn2 -> expert_agg
	expert_18 -> expert_18_ffn1
	expert_18_ffn1 -> expert_18_gelu
	expert_18_gelu -> expert_18_ffn2
	expert_18_ffn2 -> expert_agg
	expert_19 -> expert_19_ffn1
	expert_19_ffn1 -> expert_19_gelu
	expert_19_gelu -> expert_19_ffn2
	expert_19_ffn2 -> expert_agg
	expert_20 -> expert_20_ffn1
	expert_20_ffn1 -> expert_20_gelu
	expert_20_gelu -> expert_20_ffn2
	expert_20_ffn2 -> expert_agg
	expert_21 -> expert_21_ffn1
	expert_21_ffn1 -> expert_21_gelu
	expert_21_gelu -> expert_21_ffn2
	expert_21_ffn2 -> expert_agg
	expert_22 -> expert_22_ffn1
	expert_22_ffn1 -> expert_22_gelu
	expert_22_gelu -> expert_22_ffn2
	expert_22_ffn2 -> expert_agg
	expert_23 -> expert_23_ffn1
	expert_23_ffn1 -> expert_23_gelu
	expert_23_gelu -> expert_23_ffn2
	expert_23_ffn2 -> expert_agg
	token_routing -> a2a_group_3
	a2a_group_3 -> expert_24
	expert_24 -> expert_24_ffn1
	expert_24_ffn1 -> expert_24_gelu
	expert_24_gelu -> expert_24_ffn2
	expert_24_ffn2 -> expert_agg
	expert_25 -> expert_25_ffn1
	expert_25_ffn1 -> expert_25_gelu
	expert_25_gelu -> expert_25_ffn2
	expert_25_ffn2 -> expert_agg
	expert_26 -> expert_26_ffn1
	expert_26_ffn1 -> expert_26_gelu
	expert_26_gelu -> expert_26_ffn2
	expert_26_ffn2 -> expert_agg
	expert_27 -> expert_27_ffn1
	expert_27_ffn1 -> expert_27_gelu
	expert_27_gelu -> expert_27_ffn2
	expert_27_ffn2 -> expert_agg
	expert_28 -> expert_28_ffn1
	expert_28_ffn1 -> expert_28_gelu
	expert_28_gelu -> expert_28_ffn2
	expert_28_ffn2 -> expert_agg
	expert_29 -> expert_29_ffn1
	expert_29_ffn1 -> expert_29_gelu
	expert_29_gelu -> expert_29_ffn2
	expert_29_ffn2 -> expert_agg
	expert_30 -> expert_30_ffn1
	expert_30_ffn1 -> expert_30_gelu
	expert_30_gelu -> expert_30_ffn2
	expert_30_ffn2 -> expert_agg
	expert_31 -> expert_31_ffn1
	expert_31_ffn1 -> expert_31_gelu
	expert_31_gelu -> expert_31_ffn2
	expert_31_ffn2 -> expert_agg
	token_routing -> a2a_group_4
	a2a_group_4 -> expert_32
	expert_32 -> expert_32_ffn1
	expert_32_ffn1 -> expert_32_gelu
	expert_32_gelu -> expert_32_ffn2
	expert_32_ffn2 -> expert_agg
	expert_33 -> expert_33_ffn1
	expert_33_ffn1 -> expert_33_gelu
	expert_33_gelu -> expert_33_ffn2
	expert_33_ffn2 -> expert_agg
	expert_34 -> expert_34_ffn1
	expert_34_ffn1 -> expert_34_gelu
	expert_34_gelu -> expert_34_ffn2
	expert_34_ffn2 -> expert_agg
	expert_35 -> expert_35_ffn1
	expert_35_ffn1 -> expert_35_gelu
	expert_35_gelu -> expert_35_ffn2
	expert_35_ffn2 -> expert_agg
	expert_36 -> expert_36_ffn1
	expert_36_ffn1 -> expert_36_gelu
	expert_36_gelu -> expert_36_ffn2
	expert_36_ffn2 -> expert_agg
	expert_37 -> expert_37_ffn1
	expert_37_ffn1 -> expert_37_gelu
	expert_37_gelu -> expert_37_ffn2
	expert_37_ffn2 -> expert_agg
	expert_38 -> expert_38_ffn1
	expert_38_ffn1 -> expert_38_gelu
	expert_38_gelu -> expert_38_ffn2
	expert_38_ffn2 -> expert_agg
	expert_39 -> expert_39_ffn1
	expert_39_ffn1 -> expert_39_gelu
	expert_39_gelu -> expert_39_ffn2
	expert_39_ffn2 -> expert_agg
	token_routing -> a2a_group_5
	a2a_group_5 -> expert_40
	expert_40 -> expert_40_ffn1
	expert_40_ffn1 -> expert_40_gelu
	expert_40_gelu -> expert_40_ffn2
	expert_40_ffn2 -> expert_agg
	expert_41 -> expert_41_ffn1
	expert_41_ffn1 -> expert_41_gelu
	expert_41_gelu -> expert_41_ffn2
	expert_41_ffn2 -> expert_agg
	expert_42 -> expert_42_ffn1
	expert_42_ffn1 -> expert_42_gelu
	expert_42_gelu -> expert_42_ffn2
	expert_42_ffn2 -> expert_agg
	expert_43 -> expert_43_ffn1
	expert_43_ffn1 -> expert_43_gelu
	expert_43_gelu -> expert_43_ffn2
	expert_43_ffn2 -> expert_agg
	expert_44 -> expert_44_ffn1
	expert_44_ffn1 -> expert_44_gelu
	expert_44_gelu -> expert_44_ffn2
	expert_44_ffn2 -> expert_agg
	expert_45 -> expert_45_ffn1
	expert_45_ffn1 -> expert_45_gelu
	expert_45_gelu -> expert_45_ffn2
	expert_45_ffn2 -> expert_agg
	expert_46 -> expert_46_ffn1
	expert_46_ffn1 -> expert_46_gelu
	expert_46_gelu -> expert_46_ffn2
	expert_46_ffn2 -> expert_agg
	expert_47 -> expert_47_ffn1
	expert_47_ffn1 -> expert_47_gelu
	expert_47_gelu -> expert_47_ffn2
	expert_47_ffn2 -> expert_agg
	token_routing -> a2a_group_6
	a2a_group_6 -> expert_48
	expert_48 -> expert_48_ffn1
	expert_48_ffn1 -> expert_48_gelu
	expert_48_gelu -> expert_48_ffn2
	expert_48_ffn2 -> expert_agg
	expert_49 -> expert_49_ffn1
	expert_49_ffn1 -> expert_49_gelu
	expert_49_gelu -> expert_49_ffn2
	expert_49_ffn2 -> expert_agg
	expert_50 -> expert_50_ffn1
	expert_50_ffn1 -> expert_50_gelu
	expert_50_gelu -> expert_50_ffn2
	expert_50_ffn2 -> expert_agg
	expert_51 -> expert_51_ffn1
	expert_51_ffn1 -> expert_51_gelu
	expert_51_gelu -> expert_51_ffn2
	expert_51_ffn2 -> expert_agg
	expert_52 -> expert_52_ffn1
	expert_52_ffn1 -> expert_52_gelu
	expert_52_gelu -> expert_52_ffn2
	expert_52_ffn2 -> expert_agg
	expert_53 -> expert_53_ffn1
	expert_53_ffn1 -> expert_53_gelu
	expert_53_gelu -> expert_53_ffn2
	expert_53_ffn2 -> expert_agg
	expert_54 -> expert_54_ffn1
	expert_54_ffn1 -> expert_54_gelu
	expert_54_gelu -> expert_54_ffn2
	expert_54_ffn2 -> expert_agg
	expert_55 -> expert_55_ffn1
	expert_55_ffn1 -> expert_55_gelu
	expert_55_gelu -> expert_55_ffn2
	expert_55_ffn2 -> expert_agg
	token_routing -> a2a_group_7
	a2a_group_7 -> expert_56
	expert_56 -> expert_56_ffn1
	expert_56_ffn1 -> expert_56_gelu
	expert_56_gelu -> expert_56_ffn2
	expert_56_ffn2 -> expert_agg
	expert_57 -> expert_57_ffn1
	expert_57_ffn1 -> expert_57_gelu
	expert_57_gelu -> expert_57_ffn2
	expert_57_ffn2 -> expert_agg
	expert_58 -> expert_58_ffn1
	expert_58_ffn1 -> expert_58_gelu
	expert_58_gelu -> expert_58_ffn2
	expert_58_ffn2 -> expert_agg
	expert_59 -> expert_59_ffn1
	expert_59_ffn1 -> expert_59_gelu
	expert_59_gelu -> expert_59_ffn2
	expert_59_ffn2 -> expert_agg
	expert_60 -> expert_60_ffn1
	expert_60_ffn1 -> expert_60_gelu
	expert_60_gelu -> expert_60_ffn2
	expert_60_ffn2 -> expert_agg
	expert_61 -> expert_61_ffn1
	expert_61_ffn1 -> expert_61_gelu
	expert_61_gelu -> expert_61_ffn2
	expert_61_ffn2 -> expert_agg
	expert_62 -> expert_62_ffn1
	expert_62_ffn1 -> expert_62_gelu
	expert_62_gelu -> expert_62_ffn2
	expert_62_ffn2 -> expert_agg
	expert_63 -> expert_63_ffn1
	expert_63_ffn1 -> expert_63_gelu
	expert_63_gelu -> expert_63_ffn2
	expert_63_ffn2 -> expert_agg
	expert_agg -> weighted_sum
	expert_weights -> weighted_sum
	weighted_sum -> output
}
