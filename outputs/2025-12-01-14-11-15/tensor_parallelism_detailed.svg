<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="6000pt" height="821pt"
 viewBox="0.00 0.00 1440.00 197.09" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(2 2) rotate(0) translate(4 406)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-406 2991.63,-406 2991.63,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu0</title>
<path fill="lightcyan" stroke="black" d="M591.54,-205C591.54,-205 1808.54,-205 1808.54,-205 1814.54,-205 1820.54,-211 1820.54,-217 1820.54,-217 1820.54,-382 1820.54,-382 1820.54,-388 1814.54,-394 1808.54,-394 1808.54,-394 591.54,-394 591.54,-394 585.54,-394 579.54,-388 579.54,-382 579.54,-382 579.54,-217 579.54,-217 579.54,-211 585.54,-205 591.54,-205"/>
<text text-anchor="middle" x="1200.04" y="-378.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu1</title>
<path fill="lightcyan" stroke="black" d="M591.54,-8C591.54,-8 1808.54,-8 1808.54,-8 1814.54,-8 1820.54,-14 1820.54,-20 1820.54,-20 1820.54,-185 1820.54,-185 1820.54,-191 1814.54,-197 1808.54,-197 1808.54,-197 591.54,-197 591.54,-197 585.54,-197 579.54,-191 579.54,-185 579.54,-185 579.54,-20 579.54,-20 579.54,-14 585.54,-8 591.54,-8"/>
<text text-anchor="middle" x="1200.04" y="-181.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="275.77" cy="-189" rx="275.54" ry="26.74"/>
<text text-anchor="middle" x="275.77" y="-192.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="275.77" y="-177.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- q_proj_0 -->
<g id="node2" class="node">
<title>q_proj_0</title>
<polygon fill="none" stroke="black" points="973.54,-363 587.54,-363 587.54,-325 973.54,-325 973.54,-363"/>
<text text-anchor="middle" x="780.54" y="-347.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="780.54" y="-332.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- input&#45;&gt;q_proj_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;q_proj_0</title>
<path fill="none" stroke="black" d="M328.36,-215.49C387.48,-244.7 488.03,-290.86 579.54,-316 588.64,-318.5 598.03,-320.78 607.56,-322.87"/>
<polygon fill="black" stroke="black" points="607.02,-326.33 617.53,-324.97 608.47,-319.48 607.02,-326.33"/>
</g>
<!-- k_proj_0 -->
<g id="node3" class="node">
<title>k_proj_0</title>
<polygon fill="none" stroke="black" points="973.54,-307 587.54,-307 587.54,-269 973.54,-269 973.54,-307"/>
<text text-anchor="middle" x="780.54" y="-291.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.54" y="-276.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- input&#45;&gt;k_proj_0 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;k_proj_0</title>
<path fill="none" stroke="black" d="M373.79,-214.13C432.96,-228.86 510.28,-247.06 579.54,-260 593.47,-262.6 607.99,-265.08 622.56,-267.41"/>
<polygon fill="black" stroke="black" points="622.23,-270.9 632.66,-269 623.32,-263.99 622.23,-270.9"/>
</g>
<!-- v_proj_0 -->
<g id="node4" class="node">
<title>v_proj_0</title>
<polygon fill="none" stroke="black" points="973.54,-251 587.54,-251 587.54,-213 973.54,-213 973.54,-251"/>
<text text-anchor="middle" x="780.54" y="-235.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="780.54" y="-220.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- input&#45;&gt;v_proj_0 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;v_proj_0</title>
<path fill="none" stroke="black" d="M483.81,-206.71C514.57,-209.34 546.25,-212.05 576.92,-214.67"/>
<polygon fill="black" stroke="black" points="577.02,-218.19 587.28,-215.56 577.61,-211.22 577.02,-218.19"/>
</g>
<!-- q_proj_1 -->
<g id="node7" class="node">
<title>q_proj_1</title>
<polygon fill="none" stroke="black" points="973.54,-166 587.54,-166 587.54,-128 973.54,-128 973.54,-166"/>
<text text-anchor="middle" x="780.54" y="-150.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="780.54" y="-135.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- input&#45;&gt;q_proj_1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M485.62,-171.55C515.92,-169.02 547.07,-166.42 577.24,-163.9"/>
<polygon fill="black" stroke="black" points="577.76,-167.37 587.43,-163.05 577.17,-160.39 577.76,-167.37"/>
</g>
<!-- k_proj_1 -->
<g id="node8" class="node">
<title>k_proj_1</title>
<polygon fill="none" stroke="black" points="973.54,-110 587.54,-110 587.54,-72 973.54,-72 973.54,-110"/>
<text text-anchor="middle" x="780.54" y="-94.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.54" y="-79.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- input&#45;&gt;k_proj_1 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M375.52,-163.85C434.47,-149.42 510.98,-131.7 579.54,-119 593.55,-116.41 608.15,-113.93 622.79,-111.6"/>
<polygon fill="black" stroke="black" points="623.6,-115.02 632.94,-110.01 622.51,-108.1 623.6,-115.02"/>
</g>
<!-- v_proj_1 -->
<g id="node9" class="node">
<title>v_proj_1</title>
<polygon fill="none" stroke="black" points="973.54,-54 587.54,-54 587.54,-16 973.54,-16 973.54,-54"/>
<text text-anchor="middle" x="780.54" y="-38.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="780.54" y="-23.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- input&#45;&gt;v_proj_1 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M328.65,-162.6C387.83,-133.63 488.24,-87.95 579.54,-63 588.71,-60.5 598.17,-58.21 607.76,-56.12"/>
<polygon fill="black" stroke="black" points="608.74,-59.49 617.81,-54.02 607.3,-52.64 608.74,-59.49"/>
</g>
<!-- attn_0 -->
<g id="node5" class="node">
<title>attn_0</title>
<polygon fill="none" stroke="black" points="1395.54,-293 1009.54,-293 1009.54,-255 1395.54,-255 1395.54,-293"/>
<text text-anchor="middle" x="1202.54" y="-277.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1202.54" y="-262.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- q_proj_0&#45;&gt;attn_0 -->
<g id="edge7" class="edge">
<title>q_proj_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M916.44,-324.98C935.62,-322.08 955.1,-319.04 973.54,-316 1012.46,-309.58 1054.99,-301.92 1092.67,-294.91"/>
<polygon fill="black" stroke="black" points="1093.46,-298.33 1102.64,-293.05 1092.17,-291.44 1093.46,-298.33"/>
</g>
<!-- k_proj_0&#45;&gt;attn_0 -->
<g id="edge8" class="edge">
<title>k_proj_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M973.72,-281.59C982.26,-281.31 990.84,-281.02 999.4,-280.74"/>
<polygon fill="black" stroke="black" points="999.56,-284.23 1009.44,-280.4 999.33,-277.24 999.56,-284.23"/>
</g>
<!-- v_proj_0&#45;&gt;attn_0 -->
<g id="edge9" class="edge">
<title>v_proj_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M971.58,-251C981.51,-252 991.51,-253 1001.48,-253.99"/>
<polygon fill="black" stroke="black" points="1001.13,-257.48 1011.43,-254.99 1001.83,-250.51 1001.13,-257.48"/>
</g>
<!-- out_proj_0 -->
<g id="node6" class="node">
<title>out_proj_0</title>
<polygon fill="none" stroke="black" points="1812.54,-279 1431.54,-279 1431.54,-241 1812.54,-241 1812.54,-279"/>
<text text-anchor="middle" x="1622.04" y="-263.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1622.04" y="-248.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, hidden_dim=512]</text>
</g>
<!-- attn_0&#45;&gt;out_proj_0 -->
<g id="edge13" class="edge">
<title>attn_0&#45;&gt;out_proj_0</title>
<path fill="none" stroke="black" d="M1395.8,-267.55C1404.33,-267.27 1412.91,-266.98 1421.46,-266.69"/>
<polygon fill="black" stroke="black" points="1421.61,-270.19 1431.49,-266.36 1421.38,-263.19 1421.61,-270.19"/>
</g>
<!-- all_reduce -->
<g id="node12" class="node">
<title>all_reduce</title>
<ellipse fill="none" stroke="black" cx="2124.31" cy="-203" rx="275.54" ry="26.74"/>
<text text-anchor="middle" x="2124.31" y="-206.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="2124.31" y="-191.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- out_proj_0&#45;&gt;all_reduce -->
<g id="edge15" class="edge">
<title>out_proj_0&#45;&gt;all_reduce</title>
<path fill="none" stroke="black" d="M1789.97,-240.98C1836.26,-235.71 1886.85,-229.94 1934.3,-224.54"/>
<polygon fill="black" stroke="black" points="1934.84,-228 1944.38,-223.39 1934.04,-221.04 1934.84,-228"/>
</g>
<!-- attn_1 -->
<g id="node10" class="node">
<title>attn_1</title>
<polygon fill="none" stroke="black" points="1395.54,-124 1009.54,-124 1009.54,-86 1395.54,-86 1395.54,-124"/>
<text text-anchor="middle" x="1202.54" y="-108.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1202.54" y="-93.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- q_proj_1&#45;&gt;attn_1 -->
<g id="edge10" class="edge">
<title>q_proj_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M971.58,-128C981.51,-127 991.51,-126 1001.48,-125.01"/>
<polygon fill="black" stroke="black" points="1001.83,-128.49 1011.43,-124.01 1001.13,-121.52 1001.83,-128.49"/>
</g>
<!-- k_proj_1&#45;&gt;attn_1 -->
<g id="edge11" class="edge">
<title>k_proj_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M973.72,-97.41C982.26,-97.69 990.84,-97.98 999.4,-98.26"/>
<polygon fill="black" stroke="black" points="999.33,-101.76 1009.44,-98.6 999.56,-94.77 999.33,-101.76"/>
</g>
<!-- v_proj_1&#45;&gt;attn_1 -->
<g id="edge12" class="edge">
<title>v_proj_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M916.44,-54.02C935.62,-56.92 955.1,-59.96 973.54,-63 1012.46,-69.42 1054.99,-77.08 1092.67,-84.09"/>
<polygon fill="black" stroke="black" points="1092.17,-87.56 1102.64,-85.95 1093.46,-80.67 1092.17,-87.56"/>
</g>
<!-- out_proj_1 -->
<g id="node11" class="node">
<title>out_proj_1</title>
<polygon fill="none" stroke="black" points="1812.54,-152 1431.54,-152 1431.54,-114 1812.54,-114 1812.54,-152"/>
<text text-anchor="middle" x="1622.04" y="-136.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1622.04" y="-121.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, hidden_dim=512]</text>
</g>
<!-- attn_1&#45;&gt;out_proj_1 -->
<g id="edge14" class="edge">
<title>attn_1&#45;&gt;out_proj_1</title>
<path fill="none" stroke="black" d="M1395.8,-117.89C1404.33,-118.47 1412.91,-119.04 1421.46,-119.61"/>
<polygon fill="black" stroke="black" points="1421.28,-123.11 1431.49,-120.29 1421.75,-116.13 1421.28,-123.11"/>
</g>
<!-- out_proj_1&#45;&gt;all_reduce -->
<g id="edge16" class="edge">
<title>out_proj_1&#45;&gt;all_reduce</title>
<path fill="none" stroke="black" d="M1759.08,-152.04C1819.78,-160.53 1891.88,-170.62 1955.86,-179.57"/>
<polygon fill="black" stroke="black" points="1955.66,-183.08 1966.05,-181 1956.63,-176.14 1955.66,-183.08"/>
</g>
<!-- output -->
<g id="node13" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="2711.86" cy="-203" rx="275.54" ry="26.74"/>
<text text-anchor="middle" x="2711.86" y="-206.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2711.86" y="-191.8" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- all_reduce&#45;&gt;output -->
<g id="edge17" class="edge">
<title>all_reduce&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2400.51,-203C2408.85,-203 2417.21,-203 2425.55,-203"/>
<polygon fill="black" stroke="black" points="2425.73,-206.5 2435.73,-203 2425.73,-199.5 2425.73,-206.5"/>
</g>
</g>
</svg>
