<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="9000pt" height="615pt"
 viewBox="0.00 0.00 2160.00 147.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.54 0.54) rotate(0) translate(4 1130.48)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1130.48 16585.17,-1130.48 16585.17,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_expert_group_0</title>
<path fill="lightcyan" stroke="black" d="M20,-288C20,-288 2058,-288 2058,-288 2064,-288 2070,-294 2070,-300 2070,-300 2070,-664.74 2070,-664.74 2070,-670.74 2064,-676.74 2058,-676.74 2058,-676.74 20,-676.74 20,-676.74 14,-676.74 8,-670.74 8,-664.74 8,-664.74 8,-300 8,-300 8,-294 14,-288 20,-288"/>
<text text-anchor="middle" x="1039" y="-661.54" font-family="Times,serif" font-size="14.00">Expert Group 0 (GPU 0)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_expert_group_1</title>
<path fill="lightcyan" stroke="black" d="M2090,-288C2090,-288 4128,-288 4128,-288 4134,-288 4140,-294 4140,-300 4140,-300 4140,-664.74 4140,-664.74 4140,-670.74 4134,-676.74 4128,-676.74 4128,-676.74 2090,-676.74 2090,-676.74 2084,-676.74 2078,-670.74 2078,-664.74 2078,-664.74 2078,-300 2078,-300 2078,-294 2084,-288 2090,-288"/>
<text text-anchor="middle" x="3109" y="-661.54" font-family="Times,serif" font-size="14.00">Expert Group 1 (GPU 1)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_expert_group_2</title>
<path fill="lightcyan" stroke="black" d="M4160,-288C4160,-288 6198,-288 6198,-288 6204,-288 6210,-294 6210,-300 6210,-300 6210,-664.74 6210,-664.74 6210,-670.74 6204,-676.74 6198,-676.74 6198,-676.74 4160,-676.74 4160,-676.74 4154,-676.74 4148,-670.74 4148,-664.74 4148,-664.74 4148,-300 4148,-300 4148,-294 4154,-288 4160,-288"/>
<text text-anchor="middle" x="5179" y="-661.54" font-family="Times,serif" font-size="14.00">Expert Group 2 (GPU 2)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_expert_group_3</title>
<path fill="lightcyan" stroke="black" d="M6230,-288C6230,-288 8268,-288 8268,-288 8274,-288 8280,-294 8280,-300 8280,-300 8280,-664.74 8280,-664.74 8280,-670.74 8274,-676.74 8268,-676.74 8268,-676.74 6230,-676.74 6230,-676.74 6224,-676.74 6218,-670.74 6218,-664.74 6218,-664.74 6218,-300 6218,-300 6218,-294 6224,-288 6230,-288"/>
<text text-anchor="middle" x="7249" y="-661.54" font-family="Times,serif" font-size="14.00">Expert Group 3 (GPU 3)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_expert_group_4</title>
<path fill="lightcyan" stroke="black" d="M8300,-288C8300,-288 10338,-288 10338,-288 10344,-288 10350,-294 10350,-300 10350,-300 10350,-664.74 10350,-664.74 10350,-670.74 10344,-676.74 10338,-676.74 10338,-676.74 8300,-676.74 8300,-676.74 8294,-676.74 8288,-670.74 8288,-664.74 8288,-664.74 8288,-300 8288,-300 8288,-294 8294,-288 8300,-288"/>
<text text-anchor="middle" x="9319" y="-661.54" font-family="Times,serif" font-size="14.00">Expert Group 4 (GPU 4)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_expert_group_5</title>
<path fill="lightcyan" stroke="black" d="M10370,-288C10370,-288 12408,-288 12408,-288 12414,-288 12420,-294 12420,-300 12420,-300 12420,-664.74 12420,-664.74 12420,-670.74 12414,-676.74 12408,-676.74 12408,-676.74 10370,-676.74 10370,-676.74 10364,-676.74 10358,-670.74 10358,-664.74 10358,-664.74 10358,-300 10358,-300 10358,-294 10364,-288 10370,-288"/>
<text text-anchor="middle" x="11389" y="-661.54" font-family="Times,serif" font-size="14.00">Expert Group 5 (GPU 5)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_expert_group_6</title>
<path fill="lightcyan" stroke="black" d="M12440,-288C12440,-288 14478,-288 14478,-288 14484,-288 14490,-294 14490,-300 14490,-300 14490,-664.74 14490,-664.74 14490,-670.74 14484,-676.74 14478,-676.74 14478,-676.74 12440,-676.74 12440,-676.74 12434,-676.74 12428,-670.74 12428,-664.74 12428,-664.74 12428,-300 12428,-300 12428,-294 12434,-288 12440,-288"/>
<text text-anchor="middle" x="13459" y="-661.54" font-family="Times,serif" font-size="14.00">Expert Group 6 (GPU 6)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_expert_group_7</title>
<path fill="lightcyan" stroke="black" d="M14510,-288C14510,-288 16548,-288 16548,-288 16554,-288 16560,-294 16560,-300 16560,-300 16560,-664.74 16560,-664.74 16560,-670.74 16554,-676.74 16548,-676.74 16548,-676.74 14510,-676.74 14510,-676.74 14504,-676.74 14498,-670.74 14498,-664.74 14498,-664.74 14498,-300 14498,-300 14498,-294 14504,-288 14510,-288"/>
<text text-anchor="middle" x="15529" y="-661.54" font-family="Times,serif" font-size="14.00">Expert Group 7 (GPU 7)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="white" stroke="black" points="12630,-1126.48 12400,-1126.48 12400,-1090.48 12630,-1090.48 12630,-1126.48"/>
<text text-anchor="middle" x="12515" y="-1111.28" font-family="Arial" font-size="9.00">Layer Input</text>
<text text-anchor="middle" x="12515" y="-1101.28" font-family="Arial" font-size="9.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- router -->
<g id="node2" class="node">
<title>router</title>
<polygon fill="lightyellow" stroke="black" points="12758.77,-1054.48 12370.98,-1054.48 12271.23,-978.48 12659.02,-978.48 12758.77,-1054.48"/>
<text text-anchor="middle" x="12515" y="-1024.28" font-family="Arial" font-size="9.00">Router Network</text>
<text text-anchor="middle" x="12515" y="-1014.28" font-family="Arial" font-size="9.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12515" y="-1004.28" font-family="Arial" font-size="9.00">→ [batch_size=128, seq_len=1024, num_experts=64]</text>
</g>
<!-- input&#45;&gt;router -->
<g id="edge1" class="edge">
<title>input&#45;&gt;router</title>
<path fill="none" stroke="black" d="M12515,-1090.13C12515,-1082.78 12515,-1073.82 12515,-1064.75"/>
<polygon fill="black" stroke="black" points="12518.5,-1064.52 12515,-1054.53 12511.5,-1064.53 12518.5,-1064.52"/>
</g>
<!-- topk -->
<g id="node3" class="node">
<title>topk</title>
<polygon fill="lightyellow" stroke="black" points="12747.47,-942.48 12377.66,-942.48 12282.53,-866.48 12652.34,-866.48 12747.47,-942.48"/>
<text text-anchor="middle" x="12515" y="-912.28" font-family="Arial" font-size="9.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="12515" y="-902.28" font-family="Arial" font-size="9.00">[batch_size=128, seq_len=1024, num_experts=64]</text>
<text text-anchor="middle" x="12515" y="-892.28" font-family="Arial" font-size="9.00">→ [batch_size=128, seq_len=1024, top_k=2]</text>
</g>
<!-- router&#45;&gt;topk -->
<g id="edge2" class="edge">
<title>router&#45;&gt;topk</title>
<path fill="none" stroke="black" d="M12515,-978.24C12515,-970.09 12515,-961.35 12515,-952.86"/>
<polygon fill="black" stroke="black" points="12518.5,-952.68 12515,-942.68 12511.5,-952.68 12518.5,-952.68"/>
</g>
<!-- expert_weights -->
<g id="node4" class="node">
<title>expert_weights</title>
<polygon fill="lightyellow" stroke="black" points="12709.82,-830.48 12399.91,-830.48 12320.18,-774.48 12630.09,-774.48 12709.82,-830.48"/>
<text text-anchor="middle" x="12515" y="-805.28" font-family="Arial" font-size="9.00">Expert Weights</text>
<text text-anchor="middle" x="12515" y="-795.28" font-family="Arial" font-size="9.00">[batch_size=128, seq_len=1024, top_k=2]</text>
</g>
<!-- topk&#45;&gt;expert_weights -->
<g id="edge3" class="edge">
<title>topk&#45;&gt;expert_weights</title>
<path fill="none" stroke="black" d="M12515,-866.24C12515,-857.97 12515,-849.19 12515,-840.9"/>
<polygon fill="black" stroke="black" points="12518.5,-840.75 12515,-830.75 12511.5,-840.75 12518.5,-840.75"/>
</g>
<!-- token_routing -->
<g id="node5" class="node">
<title>token_routing</title>
<ellipse fill="lightblue" stroke="black" cx="8451" cy="-711.61" rx="162.77" ry="26.74"/>
<text text-anchor="middle" x="8451" y="-719.41" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="8451" y="-709.41" font-family="Arial" font-size="9.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8451" y="-699.41" font-family="Arial" font-size="9.00">→ Expert&#45;specific batches</text>
</g>
<!-- expert_weights&#45;&gt;token_routing -->
<g id="edge4" class="edge">
<title>expert_weights&#45;&gt;token_routing</title>
<path fill="none" stroke="black" d="M12353.49,-797.95C11704.16,-783.75 9286.99,-730.89 8621.54,-716.34"/>
<polygon fill="black" stroke="black" points="8621.47,-712.84 8611.39,-716.12 8621.31,-719.84 8621.47,-712.84"/>
</g>
<!-- weighted_sum -->
<g id="node271" class="node">
<title>weighted_sum</title>
<polygon fill="lightyellow" stroke="black" points="12764.72,-168 12367.47,-168 12265.28,-72 12662.53,-72 12764.72,-168"/>
<text text-anchor="middle" x="12515" y="-132.8" font-family="Arial" font-size="9.00">Weighted Sum</text>
<text text-anchor="middle" x="12515" y="-122.8" font-family="Arial" font-size="9.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12515" y="-112.8" font-family="Arial" font-size="9.00">× [batch_size=128, seq_len=1024, top_k=2]</text>
<text text-anchor="middle" x="12515" y="-102.8" font-family="Arial" font-size="9.00">→ [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_weights&#45;&gt;weighted_sum -->
<g id="edge278" class="edge">
<title>expert_weights&#45;&gt;weighted_sum</title>
<path fill="none" stroke="black" d="M12669.17,-801.79C13390.98,-802.62 16407.99,-798.74 16564,-676.74 16584.68,-660.57 16580,-646.13 16580,-619.87 16580,-619.87 16580,-619.87 16580,-314 16580,-300.43 16575.71,-294.86 16564,-288 16397.45,-190.37 13539.21,-137.38 12728.05,-124.26"/>
<polygon fill="black" stroke="black" points="12728.07,-120.76 12718.02,-124.1 12727.96,-127.76 12728.07,-120.76"/>
</g>
<!-- a2a_group_0 -->
<g id="node6" class="node">
<title>a2a_group_0</title>
<ellipse fill="lightblue" stroke="black" cx="171" cy="-618.87" rx="154.71" ry="26.74"/>
<text text-anchor="middle" x="171" y="-626.67" font-family="Arial" font-size="9.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="171" y="-616.67" font-family="Arial" font-size="9.00">Group 0</text>
<text text-anchor="middle" x="171" y="-606.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- token_routing&#45;&gt;a2a_group_0 -->
<g id="edge5" class="edge">
<title>token_routing&#45;&gt;a2a_group_0</title>
<path fill="none" stroke="black" d="M8288.25,-710.67C7159.75,-711 538.27,-711.42 335,-676.74 301.23,-670.98 265.1,-659.12 235.38,-647.71"/>
<polygon fill="black" stroke="black" points="236.55,-644.41 225.97,-644.03 234.01,-650.93 236.55,-644.41"/>
</g>
<!-- a2a_group_1 -->
<g id="node39" class="node">
<title>a2a_group_1</title>
<ellipse fill="lightblue" stroke="black" cx="2241" cy="-618.87" rx="154.71" ry="26.74"/>
<text text-anchor="middle" x="2241" y="-626.67" font-family="Arial" font-size="9.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="2241" y="-616.67" font-family="Arial" font-size="9.00">Group 1</text>
<text text-anchor="middle" x="2241" y="-606.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- token_routing&#45;&gt;a2a_group_1 -->
<g id="edge39" class="edge">
<title>token_routing&#45;&gt;a2a_group_1</title>
<path fill="none" stroke="black" d="M8288.19,-710.43C7338.8,-709.29 2554.09,-702.29 2405,-676.74 2371.23,-670.95 2335.11,-659.09 2305.38,-647.69"/>
<polygon fill="black" stroke="black" points="2306.56,-644.39 2295.97,-644.01 2304.01,-650.91 2306.56,-644.39"/>
</g>
<!-- a2a_group_2 -->
<g id="node72" class="node">
<title>a2a_group_2</title>
<ellipse fill="lightblue" stroke="black" cx="4311" cy="-618.87" rx="154.71" ry="26.74"/>
<text text-anchor="middle" x="4311" y="-626.67" font-family="Arial" font-size="9.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="4311" y="-616.67" font-family="Arial" font-size="9.00">Group 2</text>
<text text-anchor="middle" x="4311" y="-606.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- token_routing&#45;&gt;a2a_group_2 -->
<g id="edge73" class="edge">
<title>token_routing&#45;&gt;a2a_group_2</title>
<path fill="none" stroke="black" d="M8288.18,-710.7C7564.31,-710.9 4665.38,-709.65 4475,-676.74 4441.37,-670.93 4405.4,-659.13 4375.75,-647.78"/>
<polygon fill="black" stroke="black" points="4376.94,-644.49 4366.35,-644.12 4374.4,-651.01 4376.94,-644.49"/>
</g>
<!-- a2a_group_3 -->
<g id="node105" class="node">
<title>a2a_group_3</title>
<ellipse fill="lightblue" stroke="black" cx="6381" cy="-618.87" rx="154.71" ry="26.74"/>
<text text-anchor="middle" x="6381" y="-626.67" font-family="Arial" font-size="9.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="6381" y="-616.67" font-family="Arial" font-size="9.00">Group 3</text>
<text text-anchor="middle" x="6381" y="-606.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- token_routing&#45;&gt;a2a_group_3 -->
<g id="edge107" class="edge">
<title>token_routing&#45;&gt;a2a_group_3</title>
<path fill="none" stroke="black" d="M8288.34,-710.66C7858.5,-710.36 6713.83,-706.73 6545,-676.74 6511.4,-670.77 6475.43,-658.96 6445.77,-647.63"/>
<polygon fill="black" stroke="black" points="6446.96,-644.34 6436.37,-643.98 6444.43,-650.87 6446.96,-644.34"/>
</g>
<!-- a2a_group_4 -->
<g id="node138" class="node">
<title>a2a_group_4</title>
<ellipse fill="lightblue" stroke="black" cx="8451" cy="-618.87" rx="154.71" ry="26.74"/>
<text text-anchor="middle" x="8451" y="-626.67" font-family="Arial" font-size="9.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="8451" y="-616.67" font-family="Arial" font-size="9.00">Group 4</text>
<text text-anchor="middle" x="8451" y="-606.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- token_routing&#45;&gt;a2a_group_4 -->
<g id="edge141" class="edge">
<title>token_routing&#45;&gt;a2a_group_4</title>
<path fill="none" stroke="black" d="M8451,-684.36C8451,-675.45 8451,-665.32 8451,-655.78"/>
<polygon fill="black" stroke="black" points="8454.5,-655.74 8451,-645.74 8447.5,-655.74 8454.5,-655.74"/>
</g>
<!-- a2a_group_5 -->
<g id="node171" class="node">
<title>a2a_group_5</title>
<ellipse fill="lightblue" stroke="black" cx="10521" cy="-618.87" rx="154.71" ry="26.74"/>
<text text-anchor="middle" x="10521" y="-626.67" font-family="Arial" font-size="9.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="10521" y="-616.67" font-family="Arial" font-size="9.00">Group 5</text>
<text text-anchor="middle" x="10521" y="-606.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- token_routing&#45;&gt;a2a_group_5 -->
<g id="edge175" class="edge">
<title>token_routing&#45;&gt;a2a_group_5</title>
<path fill="none" stroke="black" d="M8613.79,-710.6C9043.22,-710.16 10185.4,-706.2 10354,-676.74 10388.17,-670.77 10424.78,-658.95 10455,-647.63"/>
<polygon fill="black" stroke="black" points="10456.48,-650.81 10464.57,-643.98 10453.98,-644.27 10456.48,-650.81"/>
</g>
<!-- a2a_group_6 -->
<g id="node204" class="node">
<title>a2a_group_6</title>
<ellipse fill="lightblue" stroke="black" cx="12591" cy="-618.87" rx="154.71" ry="26.74"/>
<text text-anchor="middle" x="12591" y="-626.67" font-family="Arial" font-size="9.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="12591" y="-616.67" font-family="Arial" font-size="9.00">Group 6</text>
<text text-anchor="middle" x="12591" y="-606.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- token_routing&#45;&gt;a2a_group_6 -->
<g id="edge209" class="edge">
<title>token_routing&#45;&gt;a2a_group_6</title>
<path fill="none" stroke="black" d="M8613.7,-710.67C9337,-710.76 12233.67,-709.09 12424,-676.74 12458.33,-670.9 12495.11,-659.04 12525.39,-647.64"/>
<polygon fill="black" stroke="black" points="12526.89,-650.81 12534.98,-643.97 12524.39,-644.28 12526.89,-650.81"/>
</g>
<!-- a2a_group_7 -->
<g id="node237" class="node">
<title>a2a_group_7</title>
<ellipse fill="lightblue" stroke="black" cx="14661" cy="-618.87" rx="154.71" ry="26.74"/>
<text text-anchor="middle" x="14661" y="-626.67" font-family="Arial" font-size="9.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="14661" y="-616.67" font-family="Arial" font-size="9.00">Group 7</text>
<text text-anchor="middle" x="14661" y="-606.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- token_routing&#45;&gt;a2a_group_7 -->
<g id="edge243" class="edge">
<title>token_routing&#45;&gt;a2a_group_7</title>
<path fill="none" stroke="black" d="M8613.72,-710.42C9562.64,-709.21 14344.92,-701.86 14494,-676.74 14528.34,-670.95 14565.12,-659.09 14595.39,-647.69"/>
<polygon fill="black" stroke="black" points="14596.9,-650.86 14604.98,-644.01 14594.39,-644.32 14596.9,-650.86"/>
</g>
<!-- expert_0 -->
<g id="node7" class="node">
<title>expert_0</title>
<polygon fill="lightcoral" stroke="black" points="291,-556 61,-556 61,-518 291,-518 291,-556"/>
<text text-anchor="middle" x="176" y="-544.8" font-family="Arial" font-size="9.00">Expert 0</text>
<text text-anchor="middle" x="176" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="176" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- a2a_group_0&#45;&gt;expert_0 -->
<g id="edge6" class="edge">
<title>a2a_group_0&#45;&gt;expert_0</title>
<path fill="none" stroke="black" d="M172.64,-591.72C173.15,-583.53 173.72,-574.46 174.24,-566.14"/>
<polygon fill="black" stroke="black" points="177.73,-566.32 174.87,-556.12 170.75,-565.89 177.73,-566.32"/>
</g>
<!-- expert_0_ffn1 -->
<g id="node8" class="node">
<title>expert_0_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="298.5,-482 73.5,-482 73.5,-444 298.5,-444 298.5,-482"/>
<text text-anchor="middle" x="186" y="-470.8" font-family="Arial" font-size="9.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="186" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="186" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_0&#45;&gt;expert_0_ffn1 -->
<g id="edge7" class="edge">
<title>expert_0&#45;&gt;expert_0_ffn1</title>
<path fill="none" stroke="black" d="M178.52,-517.83C179.59,-510.13 180.86,-500.97 182.05,-492.42"/>
<polygon fill="black" stroke="black" points="185.53,-492.8 183.44,-482.41 178.6,-491.84 185.53,-492.8"/>
</g>
<!-- expert_0_gelu -->
<g id="node9" class="node">
<title>expert_0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="304.5,-408 79.5,-408 79.5,-370 304.5,-370 304.5,-408"/>
<text text-anchor="middle" x="192" y="-396.8" font-family="Arial" font-size="9.00">Expert 0 GELU</text>
<text text-anchor="middle" x="192" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="192" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_0_ffn1&#45;&gt;expert_0_gelu -->
<g id="edge8" class="edge">
<title>expert_0_ffn1&#45;&gt;expert_0_gelu</title>
<path fill="none" stroke="black" d="M187.51,-443.83C188.16,-436.13 188.92,-426.97 189.63,-418.42"/>
<polygon fill="black" stroke="black" points="193.12,-418.67 190.47,-408.41 186.15,-418.09 193.12,-418.67"/>
</g>
<!-- expert_0_ffn2 -->
<g id="node10" class="node">
<title>expert_0_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="522,-334 292,-334 292,-296 522,-296 522,-334"/>
<text text-anchor="middle" x="407" y="-322.8" font-family="Arial" font-size="9.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="407" y="-312.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="407" y="-302.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_0_gelu&#45;&gt;expert_0_ffn2 -->
<g id="edge9" class="edge">
<title>expert_0_gelu&#45;&gt;expert_0_ffn2</title>
<path fill="none" stroke="black" d="M245.98,-369.92C275.5,-360.04 312.24,-347.73 343.18,-337.37"/>
<polygon fill="black" stroke="black" points="344.63,-340.58 353,-334.08 342.41,-333.94 344.63,-340.58"/>
</g>
<!-- expert_agg -->
<g id="node270" class="node">
<title>expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="8689.41,-260 8310.16,-260 8212.59,-204 8591.84,-204 8689.41,-260"/>
<text text-anchor="middle" x="8451" y="-234.8" font-family="Arial" font-size="9.00">Expert Aggregation</text>
<text text-anchor="middle" x="8451" y="-224.8" font-family="Arial" font-size="9.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_0_ffn2&#45;&gt;expert_agg -->
<g id="edge10" class="edge">
<title>expert_0_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M522.12,-301.72C576.85,-296.44 643.23,-290.83 703,-288 1476.08,-251.36 7120.87,-236.15 8253.44,-233.45"/>
<polygon fill="black" stroke="black" points="8253.72,-236.95 8263.72,-233.42 8253.71,-229.95 8253.72,-236.95"/>
</g>
<!-- expert_1 -->
<g id="node11" class="node">
<title>expert_1</title>
<polygon fill="lightcoral" stroke="black" points="574,-637.87 344,-637.87 344,-599.87 574,-599.87 574,-637.87"/>
<text text-anchor="middle" x="459" y="-626.67" font-family="Arial" font-size="9.00">Expert 1</text>
<text text-anchor="middle" x="459" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="459" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_1_ffn1 -->
<g id="node12" class="node">
<title>expert_1_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-556 346.5,-556 346.5,-518 571.5,-518 571.5,-556"/>
<text text-anchor="middle" x="459" y="-544.8" font-family="Arial" font-size="9.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="459" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="459" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_1&#45;&gt;expert_1_ffn1 -->
<g id="edge11" class="edge">
<title>expert_1&#45;&gt;expert_1_ffn1</title>
<path fill="none" stroke="black" d="M459,-599.75C459,-589.84 459,-577.35 459,-566.2"/>
<polygon fill="black" stroke="black" points="462.5,-566.05 459,-556.05 455.5,-566.05 462.5,-566.05"/>
</g>
<!-- expert_1_gelu -->
<g id="node13" class="node">
<title>expert_1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-482 346.5,-482 346.5,-444 571.5,-444 571.5,-482"/>
<text text-anchor="middle" x="459" y="-470.8" font-family="Arial" font-size="9.00">Expert 1 GELU</text>
<text text-anchor="middle" x="459" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="459" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_1_ffn1&#45;&gt;expert_1_gelu -->
<g id="edge12" class="edge">
<title>expert_1_ffn1&#45;&gt;expert_1_gelu</title>
<path fill="none" stroke="black" d="M459,-517.83C459,-510.13 459,-500.97 459,-492.42"/>
<polygon fill="black" stroke="black" points="462.5,-492.41 459,-482.41 455.5,-492.41 462.5,-492.41"/>
</g>
<!-- expert_1_ffn2 -->
<g id="node14" class="node">
<title>expert_1_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="574,-408 344,-408 344,-370 574,-370 574,-408"/>
<text text-anchor="middle" x="459" y="-396.8" font-family="Arial" font-size="9.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="459" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="459" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_1_gelu&#45;&gt;expert_1_ffn2 -->
<g id="edge13" class="edge">
<title>expert_1_gelu&#45;&gt;expert_1_ffn2</title>
<path fill="none" stroke="black" d="M459,-443.83C459,-436.13 459,-426.97 459,-418.42"/>
<polygon fill="black" stroke="black" points="462.5,-418.41 459,-408.41 455.5,-418.41 462.5,-418.41"/>
</g>
<!-- expert_1_ffn2&#45;&gt;expert_agg -->
<g id="edge14" class="edge">
<title>expert_1_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M519.42,-369.97C603.88,-345.77 762.47,-303.99 901,-288 1276.3,-244.69 7100.22,-234.78 8253.45,-233.24"/>
<polygon fill="black" stroke="black" points="8253.5,-236.74 8263.49,-233.22 8253.49,-229.74 8253.5,-236.74"/>
</g>
<!-- expert_2 -->
<g id="node15" class="node">
<title>expert_2</title>
<polygon fill="lightcoral" stroke="black" points="822,-637.87 592,-637.87 592,-599.87 822,-599.87 822,-637.87"/>
<text text-anchor="middle" x="707" y="-626.67" font-family="Arial" font-size="9.00">Expert 2</text>
<text text-anchor="middle" x="707" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="707" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_2_ffn1 -->
<g id="node16" class="node">
<title>expert_2_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="819.5,-556 594.5,-556 594.5,-518 819.5,-518 819.5,-556"/>
<text text-anchor="middle" x="707" y="-544.8" font-family="Arial" font-size="9.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="707" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="707" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_2&#45;&gt;expert_2_ffn1 -->
<g id="edge15" class="edge">
<title>expert_2&#45;&gt;expert_2_ffn1</title>
<path fill="none" stroke="black" d="M707,-599.75C707,-589.84 707,-577.35 707,-566.2"/>
<polygon fill="black" stroke="black" points="710.5,-566.05 707,-556.05 703.5,-566.05 710.5,-566.05"/>
</g>
<!-- expert_2_gelu -->
<g id="node17" class="node">
<title>expert_2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="819.5,-482 594.5,-482 594.5,-444 819.5,-444 819.5,-482"/>
<text text-anchor="middle" x="707" y="-470.8" font-family="Arial" font-size="9.00">Expert 2 GELU</text>
<text text-anchor="middle" x="707" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="707" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_2_ffn1&#45;&gt;expert_2_gelu -->
<g id="edge16" class="edge">
<title>expert_2_ffn1&#45;&gt;expert_2_gelu</title>
<path fill="none" stroke="black" d="M707,-517.83C707,-510.13 707,-500.97 707,-492.42"/>
<polygon fill="black" stroke="black" points="710.5,-492.41 707,-482.41 703.5,-492.41 710.5,-492.41"/>
</g>
<!-- expert_2_ffn2 -->
<g id="node18" class="node">
<title>expert_2_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="822,-408 592,-408 592,-370 822,-370 822,-408"/>
<text text-anchor="middle" x="707" y="-396.8" font-family="Arial" font-size="9.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="707" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="707" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_2_gelu&#45;&gt;expert_2_ffn2 -->
<g id="edge17" class="edge">
<title>expert_2_gelu&#45;&gt;expert_2_ffn2</title>
<path fill="none" stroke="black" d="M707,-443.83C707,-436.13 707,-426.97 707,-418.42"/>
<polygon fill="black" stroke="black" points="710.5,-418.41 707,-408.41 703.5,-418.41 710.5,-418.41"/>
</g>
<!-- expert_2_ffn2&#45;&gt;expert_agg -->
<g id="edge18" class="edge">
<title>expert_2_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M766.86,-369.98C850.54,-345.78 1007.68,-304 1145,-288 1507.4,-245.77 7121.18,-235.02 8253.03,-233.28"/>
<polygon fill="black" stroke="black" points="8253.31,-236.78 8263.3,-233.26 8253.29,-229.78 8253.31,-236.78"/>
</g>
<!-- expert_3 -->
<g id="node19" class="node">
<title>expert_3</title>
<polygon fill="lightcoral" stroke="black" points="1070,-637.87 840,-637.87 840,-599.87 1070,-599.87 1070,-637.87"/>
<text text-anchor="middle" x="955" y="-626.67" font-family="Arial" font-size="9.00">Expert 3</text>
<text text-anchor="middle" x="955" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="955" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_3_ffn1 -->
<g id="node20" class="node">
<title>expert_3_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="1067.5,-556 842.5,-556 842.5,-518 1067.5,-518 1067.5,-556"/>
<text text-anchor="middle" x="955" y="-544.8" font-family="Arial" font-size="9.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="955" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="955" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_3&#45;&gt;expert_3_ffn1 -->
<g id="edge19" class="edge">
<title>expert_3&#45;&gt;expert_3_ffn1</title>
<path fill="none" stroke="black" d="M955,-599.75C955,-589.84 955,-577.35 955,-566.2"/>
<polygon fill="black" stroke="black" points="958.5,-566.05 955,-556.05 951.5,-566.05 958.5,-566.05"/>
</g>
<!-- expert_3_gelu -->
<g id="node21" class="node">
<title>expert_3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="1067.5,-482 842.5,-482 842.5,-444 1067.5,-444 1067.5,-482"/>
<text text-anchor="middle" x="955" y="-470.8" font-family="Arial" font-size="9.00">Expert 3 GELU</text>
<text text-anchor="middle" x="955" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="955" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_3_ffn1&#45;&gt;expert_3_gelu -->
<g id="edge20" class="edge">
<title>expert_3_ffn1&#45;&gt;expert_3_gelu</title>
<path fill="none" stroke="black" d="M955,-517.83C955,-510.13 955,-500.97 955,-492.42"/>
<polygon fill="black" stroke="black" points="958.5,-492.41 955,-482.41 951.5,-492.41 958.5,-492.41"/>
</g>
<!-- expert_3_ffn2 -->
<g id="node22" class="node">
<title>expert_3_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="1070,-408 840,-408 840,-370 1070,-370 1070,-408"/>
<text text-anchor="middle" x="955" y="-396.8" font-family="Arial" font-size="9.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="955" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="955" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_3_gelu&#45;&gt;expert_3_ffn2 -->
<g id="edge21" class="edge">
<title>expert_3_gelu&#45;&gt;expert_3_ffn2</title>
<path fill="none" stroke="black" d="M955,-443.83C955,-436.13 955,-426.97 955,-418.42"/>
<polygon fill="black" stroke="black" points="958.5,-418.41 955,-408.41 951.5,-418.41 958.5,-418.41"/>
</g>
<!-- expert_3_ffn2&#45;&gt;expert_agg -->
<g id="edge22" class="edge">
<title>expert_3_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1013.88,-369.98C1096.2,-345.79 1250.79,-304.01 1386,-288 1735.7,-246.58 7144.47,-235.21 8253.29,-233.31"/>
<polygon fill="black" stroke="black" points="8253.36,-236.81 8263.35,-233.29 8253.34,-229.81 8253.36,-236.81"/>
</g>
<!-- expert_4 -->
<g id="node23" class="node">
<title>expert_4</title>
<polygon fill="lightcoral" stroke="black" points="1318,-637.87 1088,-637.87 1088,-599.87 1318,-599.87 1318,-637.87"/>
<text text-anchor="middle" x="1203" y="-626.67" font-family="Arial" font-size="9.00">Expert 4</text>
<text text-anchor="middle" x="1203" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="1203" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_4_ffn1 -->
<g id="node24" class="node">
<title>expert_4_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="1315.5,-556 1090.5,-556 1090.5,-518 1315.5,-518 1315.5,-556"/>
<text text-anchor="middle" x="1203" y="-544.8" font-family="Arial" font-size="9.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="1203" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="1203" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_4&#45;&gt;expert_4_ffn1 -->
<g id="edge23" class="edge">
<title>expert_4&#45;&gt;expert_4_ffn1</title>
<path fill="none" stroke="black" d="M1203,-599.75C1203,-589.84 1203,-577.35 1203,-566.2"/>
<polygon fill="black" stroke="black" points="1206.5,-566.05 1203,-556.05 1199.5,-566.05 1206.5,-566.05"/>
</g>
<!-- expert_4_gelu -->
<g id="node25" class="node">
<title>expert_4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="1315.5,-482 1090.5,-482 1090.5,-444 1315.5,-444 1315.5,-482"/>
<text text-anchor="middle" x="1203" y="-470.8" font-family="Arial" font-size="9.00">Expert 4 GELU</text>
<text text-anchor="middle" x="1203" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="1203" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_4_ffn1&#45;&gt;expert_4_gelu -->
<g id="edge24" class="edge">
<title>expert_4_ffn1&#45;&gt;expert_4_gelu</title>
<path fill="none" stroke="black" d="M1203,-517.83C1203,-510.13 1203,-500.97 1203,-492.42"/>
<polygon fill="black" stroke="black" points="1206.5,-492.41 1203,-482.41 1199.5,-492.41 1206.5,-492.41"/>
</g>
<!-- expert_4_ffn2 -->
<g id="node26" class="node">
<title>expert_4_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="1318,-408 1088,-408 1088,-370 1318,-370 1318,-408"/>
<text text-anchor="middle" x="1203" y="-396.8" font-family="Arial" font-size="9.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="1203" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="1203" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_4_gelu&#45;&gt;expert_4_ffn2 -->
<g id="edge25" class="edge">
<title>expert_4_gelu&#45;&gt;expert_4_ffn2</title>
<path fill="none" stroke="black" d="M1203,-443.83C1203,-436.13 1203,-426.97 1203,-418.42"/>
<polygon fill="black" stroke="black" points="1206.5,-418.41 1203,-408.41 1199.5,-418.41 1206.5,-418.41"/>
</g>
<!-- expert_4_ffn2&#45;&gt;expert_agg -->
<g id="edge26" class="edge">
<title>expert_4_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1259.5,-369.98C1338.5,-345.79 1486.92,-304.02 1617,-288 1954.39,-246.45 7166.02,-235.21 8253.19,-233.32"/>
<polygon fill="black" stroke="black" points="8253.46,-236.82 8263.45,-233.3 8253.45,-229.82 8253.46,-236.82"/>
</g>
<!-- expert_5 -->
<g id="node27" class="node">
<title>expert_5</title>
<polygon fill="lightcoral" stroke="black" points="1566,-637.87 1336,-637.87 1336,-599.87 1566,-599.87 1566,-637.87"/>
<text text-anchor="middle" x="1451" y="-626.67" font-family="Arial" font-size="9.00">Expert 5</text>
<text text-anchor="middle" x="1451" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="1451" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_5_ffn1 -->
<g id="node28" class="node">
<title>expert_5_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="1563.5,-556 1338.5,-556 1338.5,-518 1563.5,-518 1563.5,-556"/>
<text text-anchor="middle" x="1451" y="-544.8" font-family="Arial" font-size="9.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="1451" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="1451" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_5&#45;&gt;expert_5_ffn1 -->
<g id="edge27" class="edge">
<title>expert_5&#45;&gt;expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1451,-599.75C1451,-589.84 1451,-577.35 1451,-566.2"/>
<polygon fill="black" stroke="black" points="1454.5,-566.05 1451,-556.05 1447.5,-566.05 1454.5,-566.05"/>
</g>
<!-- expert_5_gelu -->
<g id="node29" class="node">
<title>expert_5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="1563.5,-482 1338.5,-482 1338.5,-444 1563.5,-444 1563.5,-482"/>
<text text-anchor="middle" x="1451" y="-470.8" font-family="Arial" font-size="9.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1451" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="1451" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_5_ffn1&#45;&gt;expert_5_gelu -->
<g id="edge28" class="edge">
<title>expert_5_ffn1&#45;&gt;expert_5_gelu</title>
<path fill="none" stroke="black" d="M1451,-517.83C1451,-510.13 1451,-500.97 1451,-492.42"/>
<polygon fill="black" stroke="black" points="1454.5,-492.41 1451,-482.41 1447.5,-492.41 1454.5,-492.41"/>
</g>
<!-- expert_5_ffn2 -->
<g id="node30" class="node">
<title>expert_5_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="1566,-408 1336,-408 1336,-370 1566,-370 1566,-408"/>
<text text-anchor="middle" x="1451" y="-396.8" font-family="Arial" font-size="9.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="1451" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="1451" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_5_gelu&#45;&gt;expert_5_ffn2 -->
<g id="edge29" class="edge">
<title>expert_5_gelu&#45;&gt;expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1451,-443.83C1451,-436.13 1451,-426.97 1451,-418.42"/>
<polygon fill="black" stroke="black" points="1454.5,-418.41 1451,-408.41 1447.5,-418.41 1454.5,-418.41"/>
</g>
<!-- expert_5_ffn2&#45;&gt;expert_agg -->
<g id="edge30" class="edge">
<title>expert_5_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1502.31,-369.98C1574.09,-345.79 1709.05,-304.01 1828,-288 2153.88,-244.14 7186.39,-234.75 8253.23,-233.25"/>
<polygon fill="black" stroke="black" points="8253.3,-236.75 8263.3,-233.23 8253.29,-229.75 8253.3,-236.75"/>
</g>
<!-- expert_6 -->
<g id="node31" class="node">
<title>expert_6</title>
<polygon fill="lightcoral" stroke="black" points="1814,-637.87 1584,-637.87 1584,-599.87 1814,-599.87 1814,-637.87"/>
<text text-anchor="middle" x="1699" y="-626.67" font-family="Arial" font-size="9.00">Expert 6</text>
<text text-anchor="middle" x="1699" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="1699" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_6_ffn1 -->
<g id="node32" class="node">
<title>expert_6_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="1811.5,-556 1586.5,-556 1586.5,-518 1811.5,-518 1811.5,-556"/>
<text text-anchor="middle" x="1699" y="-544.8" font-family="Arial" font-size="9.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="1699" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="1699" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_6&#45;&gt;expert_6_ffn1 -->
<g id="edge31" class="edge">
<title>expert_6&#45;&gt;expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1699,-599.75C1699,-589.84 1699,-577.35 1699,-566.2"/>
<polygon fill="black" stroke="black" points="1702.5,-566.05 1699,-556.05 1695.5,-566.05 1702.5,-566.05"/>
</g>
<!-- expert_6_gelu -->
<g id="node33" class="node">
<title>expert_6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="1811.5,-482 1586.5,-482 1586.5,-444 1811.5,-444 1811.5,-482"/>
<text text-anchor="middle" x="1699" y="-470.8" font-family="Arial" font-size="9.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1699" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="1699" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_6_ffn1&#45;&gt;expert_6_gelu -->
<g id="edge32" class="edge">
<title>expert_6_ffn1&#45;&gt;expert_6_gelu</title>
<path fill="none" stroke="black" d="M1699,-517.83C1699,-510.13 1699,-500.97 1699,-492.42"/>
<polygon fill="black" stroke="black" points="1702.5,-492.41 1699,-482.41 1695.5,-492.41 1702.5,-492.41"/>
</g>
<!-- expert_6_ffn2 -->
<g id="node34" class="node">
<title>expert_6_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="1814,-408 1584,-408 1584,-370 1814,-370 1814,-408"/>
<text text-anchor="middle" x="1699" y="-396.8" font-family="Arial" font-size="9.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="1699" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="1699" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_6_gelu&#45;&gt;expert_6_ffn2 -->
<g id="edge33" class="edge">
<title>expert_6_gelu&#45;&gt;expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1699,-443.83C1699,-436.13 1699,-426.97 1699,-418.42"/>
<polygon fill="black" stroke="black" points="1702.5,-418.41 1699,-408.41 1695.5,-418.41 1702.5,-418.41"/>
</g>
<!-- expert_6_ffn2&#45;&gt;expert_agg -->
<g id="edge34" class="edge">
<title>expert_6_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1739.26,-369.87C1795.41,-345.66 1901.03,-303.97 1996,-288 2311.49,-234.93 7200.91,-232.78 8252.67,-232.93"/>
<polygon fill="black" stroke="black" points="8252.98,-236.43 8262.98,-232.93 8252.98,-229.43 8252.98,-236.43"/>
</g>
<!-- expert_7 -->
<g id="node35" class="node">
<title>expert_7</title>
<polygon fill="lightcoral" stroke="black" points="2062,-637.87 1832,-637.87 1832,-599.87 2062,-599.87 2062,-637.87"/>
<text text-anchor="middle" x="1947" y="-626.67" font-family="Arial" font-size="9.00">Expert 7</text>
<text text-anchor="middle" x="1947" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="1947" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_7_ffn1 -->
<g id="node36" class="node">
<title>expert_7_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="2059.5,-556 1834.5,-556 1834.5,-518 2059.5,-518 2059.5,-556"/>
<text text-anchor="middle" x="1947" y="-544.8" font-family="Arial" font-size="9.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="1947" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="1947" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_7&#45;&gt;expert_7_ffn1 -->
<g id="edge35" class="edge">
<title>expert_7&#45;&gt;expert_7_ffn1</title>
<path fill="none" stroke="black" d="M1947,-599.75C1947,-589.84 1947,-577.35 1947,-566.2"/>
<polygon fill="black" stroke="black" points="1950.5,-566.05 1947,-556.05 1943.5,-566.05 1950.5,-566.05"/>
</g>
<!-- expert_7_gelu -->
<g id="node37" class="node">
<title>expert_7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="2059.5,-482 1834.5,-482 1834.5,-444 2059.5,-444 2059.5,-482"/>
<text text-anchor="middle" x="1947" y="-470.8" font-family="Arial" font-size="9.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1947" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="1947" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_7_ffn1&#45;&gt;expert_7_gelu -->
<g id="edge36" class="edge">
<title>expert_7_ffn1&#45;&gt;expert_7_gelu</title>
<path fill="none" stroke="black" d="M1947,-517.83C1947,-510.13 1947,-500.97 1947,-492.42"/>
<polygon fill="black" stroke="black" points="1950.5,-492.41 1947,-482.41 1943.5,-492.41 1950.5,-492.41"/>
</g>
<!-- expert_7_ffn2 -->
<g id="node38" class="node">
<title>expert_7_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="2062,-408 1832,-408 1832,-370 2062,-370 2062,-408"/>
<text text-anchor="middle" x="1947" y="-396.8" font-family="Arial" font-size="9.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="1947" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="1947" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_7_gelu&#45;&gt;expert_7_ffn2 -->
<g id="edge37" class="edge">
<title>expert_7_gelu&#45;&gt;expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1947,-443.83C1947,-436.13 1947,-426.97 1947,-418.42"/>
<polygon fill="black" stroke="black" points="1950.5,-418.41 1947,-408.41 1943.5,-418.41 1950.5,-418.41"/>
</g>
<!-- expert_7_ffn2&#45;&gt;expert_agg -->
<g id="edge38" class="edge">
<title>expert_7_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1962.8,-369.6C1984.85,-345.5 2027.4,-304.37 2074,-288 2223.26,-235.57 7191.61,-232.92 8252.83,-232.95"/>
<polygon fill="black" stroke="black" points="8252.85,-236.45 8262.85,-232.95 8252.85,-229.45 8252.85,-236.45"/>
</g>
<!-- expert_8 -->
<g id="node40" class="node">
<title>expert_8</title>
<polygon fill="lightcoral" stroke="black" points="2361,-556 2131,-556 2131,-518 2361,-518 2361,-556"/>
<text text-anchor="middle" x="2246" y="-544.8" font-family="Arial" font-size="9.00">Expert 8</text>
<text text-anchor="middle" x="2246" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="2246" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- a2a_group_1&#45;&gt;expert_8 -->
<g id="edge40" class="edge">
<title>a2a_group_1&#45;&gt;expert_8</title>
<path fill="none" stroke="black" d="M2242.64,-591.72C2243.15,-583.53 2243.72,-574.46 2244.24,-566.14"/>
<polygon fill="black" stroke="black" points="2247.73,-566.32 2244.87,-556.12 2240.75,-565.89 2247.73,-566.32"/>
</g>
<!-- expert_8_ffn1 -->
<g id="node41" class="node">
<title>expert_8_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="2368.5,-482 2143.5,-482 2143.5,-444 2368.5,-444 2368.5,-482"/>
<text text-anchor="middle" x="2256" y="-470.8" font-family="Arial" font-size="9.00">Expert 8 FFN1</text>
<text text-anchor="middle" x="2256" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="2256" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_8&#45;&gt;expert_8_ffn1 -->
<g id="edge41" class="edge">
<title>expert_8&#45;&gt;expert_8_ffn1</title>
<path fill="none" stroke="black" d="M2248.52,-517.83C2249.59,-510.13 2250.86,-500.97 2252.05,-492.42"/>
<polygon fill="black" stroke="black" points="2255.53,-492.8 2253.44,-482.41 2248.6,-491.84 2255.53,-492.8"/>
</g>
<!-- expert_8_gelu -->
<g id="node42" class="node">
<title>expert_8_gelu</title>
<polygon fill="lightgreen" stroke="black" points="2374.5,-408 2149.5,-408 2149.5,-370 2374.5,-370 2374.5,-408"/>
<text text-anchor="middle" x="2262" y="-396.8" font-family="Arial" font-size="9.00">Expert 8 GELU</text>
<text text-anchor="middle" x="2262" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="2262" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_8_ffn1&#45;&gt;expert_8_gelu -->
<g id="edge42" class="edge">
<title>expert_8_ffn1&#45;&gt;expert_8_gelu</title>
<path fill="none" stroke="black" d="M2257.51,-443.83C2258.16,-436.13 2258.92,-426.97 2259.63,-418.42"/>
<polygon fill="black" stroke="black" points="2263.12,-418.67 2260.47,-408.41 2256.15,-418.09 2263.12,-418.67"/>
</g>
<!-- expert_8_ffn2 -->
<g id="node43" class="node">
<title>expert_8_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="2596,-334 2366,-334 2366,-296 2596,-296 2596,-334"/>
<text text-anchor="middle" x="2481" y="-322.8" font-family="Arial" font-size="9.00">Expert 8 FFN2</text>
<text text-anchor="middle" x="2481" y="-312.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="2481" y="-302.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_8_gelu&#45;&gt;expert_8_ffn2 -->
<g id="edge43" class="edge">
<title>expert_8_gelu&#45;&gt;expert_8_ffn2</title>
<path fill="none" stroke="black" d="M2316.98,-369.92C2347.18,-360 2384.81,-347.63 2416.4,-337.24"/>
<polygon fill="black" stroke="black" points="2417.59,-340.53 2426,-334.08 2415.4,-333.88 2417.59,-340.53"/>
</g>
<!-- expert_8_ffn2&#45;&gt;expert_agg -->
<g id="edge44" class="edge">
<title>expert_8_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2595.9,-295.98C2620.92,-292.72 2647.3,-289.79 2672,-288 3237.13,-247.01 7304.41,-235.53 8253.4,-233.4"/>
<polygon fill="black" stroke="black" points="8253.75,-236.9 8263.74,-233.38 8253.73,-229.9 8253.75,-236.9"/>
</g>
<!-- expert_9 -->
<g id="node44" class="node">
<title>expert_9</title>
<polygon fill="lightcoral" stroke="black" points="2644,-637.87 2414,-637.87 2414,-599.87 2644,-599.87 2644,-637.87"/>
<text text-anchor="middle" x="2529" y="-626.67" font-family="Arial" font-size="9.00">Expert 9</text>
<text text-anchor="middle" x="2529" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="2529" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_9_ffn1 -->
<g id="node45" class="node">
<title>expert_9_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="2641.5,-556 2416.5,-556 2416.5,-518 2641.5,-518 2641.5,-556"/>
<text text-anchor="middle" x="2529" y="-544.8" font-family="Arial" font-size="9.00">Expert 9 FFN1</text>
<text text-anchor="middle" x="2529" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="2529" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_9&#45;&gt;expert_9_ffn1 -->
<g id="edge45" class="edge">
<title>expert_9&#45;&gt;expert_9_ffn1</title>
<path fill="none" stroke="black" d="M2529,-599.75C2529,-589.84 2529,-577.35 2529,-566.2"/>
<polygon fill="black" stroke="black" points="2532.5,-566.05 2529,-556.05 2525.5,-566.05 2532.5,-566.05"/>
</g>
<!-- expert_9_gelu -->
<g id="node46" class="node">
<title>expert_9_gelu</title>
<polygon fill="lightgreen" stroke="black" points="2641.5,-482 2416.5,-482 2416.5,-444 2641.5,-444 2641.5,-482"/>
<text text-anchor="middle" x="2529" y="-470.8" font-family="Arial" font-size="9.00">Expert 9 GELU</text>
<text text-anchor="middle" x="2529" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="2529" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_9_ffn1&#45;&gt;expert_9_gelu -->
<g id="edge46" class="edge">
<title>expert_9_ffn1&#45;&gt;expert_9_gelu</title>
<path fill="none" stroke="black" d="M2529,-517.83C2529,-510.13 2529,-500.97 2529,-492.42"/>
<polygon fill="black" stroke="black" points="2532.5,-492.41 2529,-482.41 2525.5,-492.41 2532.5,-492.41"/>
</g>
<!-- expert_9_ffn2 -->
<g id="node47" class="node">
<title>expert_9_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="2644,-408 2414,-408 2414,-370 2644,-370 2644,-408"/>
<text text-anchor="middle" x="2529" y="-396.8" font-family="Arial" font-size="9.00">Expert 9 FFN2</text>
<text text-anchor="middle" x="2529" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="2529" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_9_gelu&#45;&gt;expert_9_ffn2 -->
<g id="edge47" class="edge">
<title>expert_9_gelu&#45;&gt;expert_9_ffn2</title>
<path fill="none" stroke="black" d="M2529,-443.83C2529,-436.13 2529,-426.97 2529,-418.42"/>
<polygon fill="black" stroke="black" points="2532.5,-418.41 2529,-408.41 2525.5,-418.41 2532.5,-418.41"/>
</g>
<!-- expert_9_ffn2&#45;&gt;expert_agg -->
<g id="edge48" class="edge">
<title>expert_9_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2589.78,-369.92C2674.34,-345.77 2832.68,-304.15 2971,-288 3237.98,-256.82 7304.92,-237.83 8254.03,-233.8"/>
<polygon fill="black" stroke="black" points="8254.39,-237.3 8264.37,-233.76 8254.36,-230.3 8254.39,-237.3"/>
</g>
<!-- expert_10 -->
<g id="node48" class="node">
<title>expert_10</title>
<polygon fill="lightcoral" stroke="black" points="2892,-637.87 2662,-637.87 2662,-599.87 2892,-599.87 2892,-637.87"/>
<text text-anchor="middle" x="2777" y="-626.67" font-family="Arial" font-size="9.00">Expert 10</text>
<text text-anchor="middle" x="2777" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="2777" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_10_ffn1 -->
<g id="node49" class="node">
<title>expert_10_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="2889.5,-556 2664.5,-556 2664.5,-518 2889.5,-518 2889.5,-556"/>
<text text-anchor="middle" x="2777" y="-544.8" font-family="Arial" font-size="9.00">Expert 10 FFN1</text>
<text text-anchor="middle" x="2777" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="2777" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_10&#45;&gt;expert_10_ffn1 -->
<g id="edge49" class="edge">
<title>expert_10&#45;&gt;expert_10_ffn1</title>
<path fill="none" stroke="black" d="M2777,-599.75C2777,-589.84 2777,-577.35 2777,-566.2"/>
<polygon fill="black" stroke="black" points="2780.5,-566.05 2777,-556.05 2773.5,-566.05 2780.5,-566.05"/>
</g>
<!-- expert_10_gelu -->
<g id="node50" class="node">
<title>expert_10_gelu</title>
<polygon fill="lightgreen" stroke="black" points="2889.5,-482 2664.5,-482 2664.5,-444 2889.5,-444 2889.5,-482"/>
<text text-anchor="middle" x="2777" y="-470.8" font-family="Arial" font-size="9.00">Expert 10 GELU</text>
<text text-anchor="middle" x="2777" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="2777" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_10_ffn1&#45;&gt;expert_10_gelu -->
<g id="edge50" class="edge">
<title>expert_10_ffn1&#45;&gt;expert_10_gelu</title>
<path fill="none" stroke="black" d="M2777,-517.83C2777,-510.13 2777,-500.97 2777,-492.42"/>
<polygon fill="black" stroke="black" points="2780.5,-492.41 2777,-482.41 2773.5,-492.41 2780.5,-492.41"/>
</g>
<!-- expert_10_ffn2 -->
<g id="node51" class="node">
<title>expert_10_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="2892,-408 2662,-408 2662,-370 2892,-370 2892,-408"/>
<text text-anchor="middle" x="2777" y="-396.8" font-family="Arial" font-size="9.00">Expert 10 FFN2</text>
<text text-anchor="middle" x="2777" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="2777" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_10_gelu&#45;&gt;expert_10_ffn2 -->
<g id="edge51" class="edge">
<title>expert_10_gelu&#45;&gt;expert_10_ffn2</title>
<path fill="none" stroke="black" d="M2777,-443.83C2777,-436.13 2777,-426.97 2777,-418.42"/>
<polygon fill="black" stroke="black" points="2780.5,-418.41 2777,-408.41 2773.5,-418.41 2780.5,-418.41"/>
</g>
<!-- expert_10_ffn2&#45;&gt;expert_agg -->
<g id="edge52" class="edge">
<title>expert_10_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2837.22,-369.93C2921,-345.79 3077.89,-304.18 3215,-288 3469.29,-257.99 7332.42,-238.2 8254.47,-233.89"/>
<polygon fill="black" stroke="black" points="8254.54,-237.39 8264.52,-233.84 8254.5,-230.39 8254.54,-237.39"/>
</g>
<!-- expert_11 -->
<g id="node52" class="node">
<title>expert_11</title>
<polygon fill="lightcoral" stroke="black" points="3140,-637.87 2910,-637.87 2910,-599.87 3140,-599.87 3140,-637.87"/>
<text text-anchor="middle" x="3025" y="-626.67" font-family="Arial" font-size="9.00">Expert 11</text>
<text text-anchor="middle" x="3025" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="3025" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_11_ffn1 -->
<g id="node53" class="node">
<title>expert_11_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="3137.5,-556 2912.5,-556 2912.5,-518 3137.5,-518 3137.5,-556"/>
<text text-anchor="middle" x="3025" y="-544.8" font-family="Arial" font-size="9.00">Expert 11 FFN1</text>
<text text-anchor="middle" x="3025" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="3025" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_11&#45;&gt;expert_11_ffn1 -->
<g id="edge53" class="edge">
<title>expert_11&#45;&gt;expert_11_ffn1</title>
<path fill="none" stroke="black" d="M3025,-599.75C3025,-589.84 3025,-577.35 3025,-566.2"/>
<polygon fill="black" stroke="black" points="3028.5,-566.05 3025,-556.05 3021.5,-566.05 3028.5,-566.05"/>
</g>
<!-- expert_11_gelu -->
<g id="node54" class="node">
<title>expert_11_gelu</title>
<polygon fill="lightgreen" stroke="black" points="3137.5,-482 2912.5,-482 2912.5,-444 3137.5,-444 3137.5,-482"/>
<text text-anchor="middle" x="3025" y="-470.8" font-family="Arial" font-size="9.00">Expert 11 GELU</text>
<text text-anchor="middle" x="3025" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="3025" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_11_ffn1&#45;&gt;expert_11_gelu -->
<g id="edge54" class="edge">
<title>expert_11_ffn1&#45;&gt;expert_11_gelu</title>
<path fill="none" stroke="black" d="M3025,-517.83C3025,-510.13 3025,-500.97 3025,-492.42"/>
<polygon fill="black" stroke="black" points="3028.5,-492.41 3025,-482.41 3021.5,-492.41 3028.5,-492.41"/>
</g>
<!-- expert_11_ffn2 -->
<g id="node55" class="node">
<title>expert_11_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="3140,-408 2910,-408 2910,-370 3140,-370 3140,-408"/>
<text text-anchor="middle" x="3025" y="-396.8" font-family="Arial" font-size="9.00">Expert 11 FFN2</text>
<text text-anchor="middle" x="3025" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="3025" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_11_gelu&#45;&gt;expert_11_ffn2 -->
<g id="edge55" class="edge">
<title>expert_11_gelu&#45;&gt;expert_11_ffn2</title>
<path fill="none" stroke="black" d="M3025,-443.83C3025,-436.13 3025,-426.97 3025,-418.42"/>
<polygon fill="black" stroke="black" points="3028.5,-418.41 3025,-408.41 3021.5,-418.41 3028.5,-418.41"/>
</g>
<!-- expert_11_ffn2&#45;&gt;expert_agg -->
<g id="edge56" class="edge">
<title>expert_11_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3084.23,-369.94C3166.65,-345.81 3321.01,-304.21 3456,-288 3936.91,-230.26 7382.47,-231.41 8252.08,-232.64"/>
<polygon fill="black" stroke="black" points="8252.19,-236.14 8262.19,-232.65 8252.2,-229.14 8252.19,-236.14"/>
</g>
<!-- expert_12 -->
<g id="node56" class="node">
<title>expert_12</title>
<polygon fill="lightcoral" stroke="black" points="3388,-637.87 3158,-637.87 3158,-599.87 3388,-599.87 3388,-637.87"/>
<text text-anchor="middle" x="3273" y="-626.67" font-family="Arial" font-size="9.00">Expert 12</text>
<text text-anchor="middle" x="3273" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="3273" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_12_ffn1 -->
<g id="node57" class="node">
<title>expert_12_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="3385.5,-556 3160.5,-556 3160.5,-518 3385.5,-518 3385.5,-556"/>
<text text-anchor="middle" x="3273" y="-544.8" font-family="Arial" font-size="9.00">Expert 12 FFN1</text>
<text text-anchor="middle" x="3273" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="3273" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_12&#45;&gt;expert_12_ffn1 -->
<g id="edge57" class="edge">
<title>expert_12&#45;&gt;expert_12_ffn1</title>
<path fill="none" stroke="black" d="M3273,-599.75C3273,-589.84 3273,-577.35 3273,-566.2"/>
<polygon fill="black" stroke="black" points="3276.5,-566.05 3273,-556.05 3269.5,-566.05 3276.5,-566.05"/>
</g>
<!-- expert_12_gelu -->
<g id="node58" class="node">
<title>expert_12_gelu</title>
<polygon fill="lightgreen" stroke="black" points="3385.5,-482 3160.5,-482 3160.5,-444 3385.5,-444 3385.5,-482"/>
<text text-anchor="middle" x="3273" y="-470.8" font-family="Arial" font-size="9.00">Expert 12 GELU</text>
<text text-anchor="middle" x="3273" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="3273" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_12_ffn1&#45;&gt;expert_12_gelu -->
<g id="edge58" class="edge">
<title>expert_12_ffn1&#45;&gt;expert_12_gelu</title>
<path fill="none" stroke="black" d="M3273,-517.83C3273,-510.13 3273,-500.97 3273,-492.42"/>
<polygon fill="black" stroke="black" points="3276.5,-492.41 3273,-482.41 3269.5,-492.41 3276.5,-492.41"/>
</g>
<!-- expert_12_ffn2 -->
<g id="node59" class="node">
<title>expert_12_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="3388,-408 3158,-408 3158,-370 3388,-370 3388,-408"/>
<text text-anchor="middle" x="3273" y="-396.8" font-family="Arial" font-size="9.00">Expert 12 FFN2</text>
<text text-anchor="middle" x="3273" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="3273" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_12_gelu&#45;&gt;expert_12_ffn2 -->
<g id="edge59" class="edge">
<title>expert_12_gelu&#45;&gt;expert_12_ffn2</title>
<path fill="none" stroke="black" d="M3273,-443.83C3273,-436.13 3273,-426.97 3273,-418.42"/>
<polygon fill="black" stroke="black" points="3276.5,-418.41 3273,-408.41 3269.5,-418.41 3276.5,-418.41"/>
</g>
<!-- expert_12_ffn2&#45;&gt;expert_agg -->
<g id="edge60" class="edge">
<title>expert_12_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3329.84,-369.94C3408.94,-345.82 3557.13,-304.22 3687,-288 4143.75,-230.94 7408.16,-231.53 8252.2,-232.65"/>
<polygon fill="black" stroke="black" points="8252.32,-236.15 8262.32,-232.66 8252.33,-229.15 8252.32,-236.15"/>
</g>
<!-- expert_13 -->
<g id="node60" class="node">
<title>expert_13</title>
<polygon fill="lightcoral" stroke="black" points="3636,-637.87 3406,-637.87 3406,-599.87 3636,-599.87 3636,-637.87"/>
<text text-anchor="middle" x="3521" y="-626.67" font-family="Arial" font-size="9.00">Expert 13</text>
<text text-anchor="middle" x="3521" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="3521" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_13_ffn1 -->
<g id="node61" class="node">
<title>expert_13_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="3633.5,-556 3408.5,-556 3408.5,-518 3633.5,-518 3633.5,-556"/>
<text text-anchor="middle" x="3521" y="-544.8" font-family="Arial" font-size="9.00">Expert 13 FFN1</text>
<text text-anchor="middle" x="3521" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="3521" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_13&#45;&gt;expert_13_ffn1 -->
<g id="edge61" class="edge">
<title>expert_13&#45;&gt;expert_13_ffn1</title>
<path fill="none" stroke="black" d="M3521,-599.75C3521,-589.84 3521,-577.35 3521,-566.2"/>
<polygon fill="black" stroke="black" points="3524.5,-566.05 3521,-556.05 3517.5,-566.05 3524.5,-566.05"/>
</g>
<!-- expert_13_gelu -->
<g id="node62" class="node">
<title>expert_13_gelu</title>
<polygon fill="lightgreen" stroke="black" points="3633.5,-482 3408.5,-482 3408.5,-444 3633.5,-444 3633.5,-482"/>
<text text-anchor="middle" x="3521" y="-470.8" font-family="Arial" font-size="9.00">Expert 13 GELU</text>
<text text-anchor="middle" x="3521" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="3521" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_13_ffn1&#45;&gt;expert_13_gelu -->
<g id="edge62" class="edge">
<title>expert_13_ffn1&#45;&gt;expert_13_gelu</title>
<path fill="none" stroke="black" d="M3521,-517.83C3521,-510.13 3521,-500.97 3521,-492.42"/>
<polygon fill="black" stroke="black" points="3524.5,-492.41 3521,-482.41 3517.5,-492.41 3524.5,-492.41"/>
</g>
<!-- expert_13_ffn2 -->
<g id="node63" class="node">
<title>expert_13_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="3636,-408 3406,-408 3406,-370 3636,-370 3636,-408"/>
<text text-anchor="middle" x="3521" y="-396.8" font-family="Arial" font-size="9.00">Expert 13 FFN2</text>
<text text-anchor="middle" x="3521" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="3521" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_13_gelu&#45;&gt;expert_13_ffn2 -->
<g id="edge63" class="edge">
<title>expert_13_gelu&#45;&gt;expert_13_ffn2</title>
<path fill="none" stroke="black" d="M3521,-443.83C3521,-436.13 3521,-426.97 3521,-418.42"/>
<polygon fill="black" stroke="black" points="3524.5,-418.41 3521,-408.41 3517.5,-418.41 3524.5,-418.41"/>
</g>
<!-- expert_13_ffn2&#45;&gt;expert_agg -->
<g id="edge64" class="edge">
<title>expert_13_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3572.62,-369.94C3644.48,-345.81 3779.25,-304.21 3898,-288 4116.33,-258.19 7409.25,-238.58 8254.47,-234.02"/>
<polygon fill="black" stroke="black" points="8254.62,-237.52 8264.6,-233.97 8254.59,-230.52 8254.62,-237.52"/>
</g>
<!-- expert_14 -->
<g id="node64" class="node">
<title>expert_14</title>
<polygon fill="lightcoral" stroke="black" points="3884,-637.87 3654,-637.87 3654,-599.87 3884,-599.87 3884,-637.87"/>
<text text-anchor="middle" x="3769" y="-626.67" font-family="Arial" font-size="9.00">Expert 14</text>
<text text-anchor="middle" x="3769" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="3769" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_14_ffn1 -->
<g id="node65" class="node">
<title>expert_14_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="3881.5,-556 3656.5,-556 3656.5,-518 3881.5,-518 3881.5,-556"/>
<text text-anchor="middle" x="3769" y="-544.8" font-family="Arial" font-size="9.00">Expert 14 FFN1</text>
<text text-anchor="middle" x="3769" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="3769" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_14&#45;&gt;expert_14_ffn1 -->
<g id="edge65" class="edge">
<title>expert_14&#45;&gt;expert_14_ffn1</title>
<path fill="none" stroke="black" d="M3769,-599.75C3769,-589.84 3769,-577.35 3769,-566.2"/>
<polygon fill="black" stroke="black" points="3772.5,-566.05 3769,-556.05 3765.5,-566.05 3772.5,-566.05"/>
</g>
<!-- expert_14_gelu -->
<g id="node66" class="node">
<title>expert_14_gelu</title>
<polygon fill="lightgreen" stroke="black" points="3881.5,-482 3656.5,-482 3656.5,-444 3881.5,-444 3881.5,-482"/>
<text text-anchor="middle" x="3769" y="-470.8" font-family="Arial" font-size="9.00">Expert 14 GELU</text>
<text text-anchor="middle" x="3769" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="3769" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_14_ffn1&#45;&gt;expert_14_gelu -->
<g id="edge66" class="edge">
<title>expert_14_ffn1&#45;&gt;expert_14_gelu</title>
<path fill="none" stroke="black" d="M3769,-517.83C3769,-510.13 3769,-500.97 3769,-492.42"/>
<polygon fill="black" stroke="black" points="3772.5,-492.41 3769,-482.41 3765.5,-492.41 3772.5,-492.41"/>
</g>
<!-- expert_14_ffn2 -->
<g id="node67" class="node">
<title>expert_14_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="3884,-408 3654,-408 3654,-370 3884,-370 3884,-408"/>
<text text-anchor="middle" x="3769" y="-396.8" font-family="Arial" font-size="9.00">Expert 14 FFN2</text>
<text text-anchor="middle" x="3769" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="3769" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_14_gelu&#45;&gt;expert_14_ffn2 -->
<g id="edge67" class="edge">
<title>expert_14_gelu&#45;&gt;expert_14_ffn2</title>
<path fill="none" stroke="black" d="M3769,-443.83C3769,-436.13 3769,-426.97 3769,-418.42"/>
<polygon fill="black" stroke="black" points="3772.5,-418.41 3769,-408.41 3765.5,-418.41 3772.5,-418.41"/>
</g>
<!-- expert_14_ffn2&#45;&gt;expert_agg -->
<g id="edge68" class="edge">
<title>expert_14_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3809.27,-369.93C3865.43,-345.78 3971.07,-304.17 4066,-288 4274.58,-252.48 7428.07,-237.17 8254.14,-233.76"/>
<polygon fill="black" stroke="black" points="8254.36,-237.26 8264.35,-233.72 8254.34,-230.26 8254.36,-237.26"/>
</g>
<!-- expert_15 -->
<g id="node68" class="node">
<title>expert_15</title>
<polygon fill="lightcoral" stroke="black" points="4132,-637.87 3902,-637.87 3902,-599.87 4132,-599.87 4132,-637.87"/>
<text text-anchor="middle" x="4017" y="-626.67" font-family="Arial" font-size="9.00">Expert 15</text>
<text text-anchor="middle" x="4017" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="4017" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_15_ffn1 -->
<g id="node69" class="node">
<title>expert_15_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="4129.5,-556 3904.5,-556 3904.5,-518 4129.5,-518 4129.5,-556"/>
<text text-anchor="middle" x="4017" y="-544.8" font-family="Arial" font-size="9.00">Expert 15 FFN1</text>
<text text-anchor="middle" x="4017" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="4017" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_15&#45;&gt;expert_15_ffn1 -->
<g id="edge69" class="edge">
<title>expert_15&#45;&gt;expert_15_ffn1</title>
<path fill="none" stroke="black" d="M4017,-599.75C4017,-589.84 4017,-577.35 4017,-566.2"/>
<polygon fill="black" stroke="black" points="4020.5,-566.05 4017,-556.05 4013.5,-566.05 4020.5,-566.05"/>
</g>
<!-- expert_15_gelu -->
<g id="node70" class="node">
<title>expert_15_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4129.5,-482 3904.5,-482 3904.5,-444 4129.5,-444 4129.5,-482"/>
<text text-anchor="middle" x="4017" y="-470.8" font-family="Arial" font-size="9.00">Expert 15 GELU</text>
<text text-anchor="middle" x="4017" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="4017" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_15_ffn1&#45;&gt;expert_15_gelu -->
<g id="edge70" class="edge">
<title>expert_15_ffn1&#45;&gt;expert_15_gelu</title>
<path fill="none" stroke="black" d="M4017,-517.83C4017,-510.13 4017,-500.97 4017,-492.42"/>
<polygon fill="black" stroke="black" points="4020.5,-492.41 4017,-482.41 4013.5,-492.41 4020.5,-492.41"/>
</g>
<!-- expert_15_ffn2 -->
<g id="node71" class="node">
<title>expert_15_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="4132,-408 3902,-408 3902,-370 4132,-370 4132,-408"/>
<text text-anchor="middle" x="4017" y="-396.8" font-family="Arial" font-size="9.00">Expert 15 FFN2</text>
<text text-anchor="middle" x="4017" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="4017" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_15_gelu&#45;&gt;expert_15_ffn2 -->
<g id="edge71" class="edge">
<title>expert_15_gelu&#45;&gt;expert_15_ffn2</title>
<path fill="none" stroke="black" d="M4017,-443.83C4017,-436.13 4017,-426.97 4017,-418.42"/>
<polygon fill="black" stroke="black" points="4020.5,-418.41 4017,-408.41 4013.5,-418.41 4020.5,-418.41"/>
</g>
<!-- expert_15_ffn2&#45;&gt;expert_agg -->
<g id="edge72" class="edge">
<title>expert_15_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4032.81,-369.63C4054.87,-345.56 4097.43,-304.47 4144,-288 4242.03,-253.33 7422.59,-237.38 8253.84,-233.8"/>
<polygon fill="black" stroke="black" points="8254.13,-237.3 8264.11,-233.75 8254.1,-230.3 8254.13,-237.3"/>
</g>
<!-- expert_16 -->
<g id="node73" class="node">
<title>expert_16</title>
<polygon fill="lightcoral" stroke="black" points="4447,-556 4217,-556 4217,-518 4447,-518 4447,-556"/>
<text text-anchor="middle" x="4332" y="-544.8" font-family="Arial" font-size="9.00">Expert 16</text>
<text text-anchor="middle" x="4332" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="4332" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- a2a_group_2&#45;&gt;expert_16 -->
<g id="edge74" class="edge">
<title>a2a_group_2&#45;&gt;expert_16</title>
<path fill="none" stroke="black" d="M4317.88,-591.72C4320.05,-583.44 4322.47,-574.26 4324.67,-565.86"/>
<polygon fill="black" stroke="black" points="4328.08,-566.69 4327.23,-556.12 4321.31,-564.91 4328.08,-566.69"/>
</g>
<!-- expert_16_ffn1 -->
<g id="node74" class="node">
<title>expert_16_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="4450.5,-482 4225.5,-482 4225.5,-444 4450.5,-444 4450.5,-482"/>
<text text-anchor="middle" x="4338" y="-470.8" font-family="Arial" font-size="9.00">Expert 16 FFN1</text>
<text text-anchor="middle" x="4338" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="4338" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_16&#45;&gt;expert_16_ffn1 -->
<g id="edge75" class="edge">
<title>expert_16&#45;&gt;expert_16_ffn1</title>
<path fill="none" stroke="black" d="M4333.51,-517.83C4334.16,-510.13 4334.92,-500.97 4335.63,-492.42"/>
<polygon fill="black" stroke="black" points="4339.12,-492.67 4336.47,-482.41 4332.15,-492.09 4339.12,-492.67"/>
</g>
<!-- expert_16_gelu -->
<g id="node75" class="node">
<title>expert_16_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4460.5,-408 4235.5,-408 4235.5,-370 4460.5,-370 4460.5,-408"/>
<text text-anchor="middle" x="4348" y="-396.8" font-family="Arial" font-size="9.00">Expert 16 GELU</text>
<text text-anchor="middle" x="4348" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="4348" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_16_ffn1&#45;&gt;expert_16_gelu -->
<g id="edge76" class="edge">
<title>expert_16_ffn1&#45;&gt;expert_16_gelu</title>
<path fill="none" stroke="black" d="M4340.52,-443.83C4341.59,-436.13 4342.86,-426.97 4344.05,-418.42"/>
<polygon fill="black" stroke="black" points="4347.53,-418.8 4345.44,-408.41 4340.6,-417.84 4347.53,-418.8"/>
</g>
<!-- expert_16_ffn2 -->
<g id="node76" class="node">
<title>expert_16_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="4674,-334 4444,-334 4444,-296 4674,-296 4674,-334"/>
<text text-anchor="middle" x="4559" y="-322.8" font-family="Arial" font-size="9.00">Expert 16 FFN2</text>
<text text-anchor="middle" x="4559" y="-312.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="4559" y="-302.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_16_gelu&#45;&gt;expert_16_ffn2 -->
<g id="edge77" class="edge">
<title>expert_16_gelu&#45;&gt;expert_16_ffn2</title>
<path fill="none" stroke="black" d="M4400.97,-369.92C4429.94,-360.04 4466.01,-347.73 4496.37,-337.37"/>
<polygon fill="black" stroke="black" points="4497.67,-340.63 4506.01,-334.08 4495.41,-334 4497.67,-340.63"/>
</g>
<!-- expert_16_ffn2&#45;&gt;expert_agg -->
<g id="edge78" class="edge">
<title>expert_16_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4670.04,-295.93C4693.73,-292.72 4718.65,-289.82 4742,-288 5433.24,-233.99 7585.72,-231.93 8252.23,-232.63"/>
<polygon fill="black" stroke="black" points="8252.41,-236.13 8262.42,-232.64 8252.42,-229.13 8252.41,-236.13"/>
</g>
<!-- expert_17 -->
<g id="node77" class="node">
<title>expert_17</title>
<polygon fill="lightcoral" stroke="black" points="4714,-637.87 4484,-637.87 4484,-599.87 4714,-599.87 4714,-637.87"/>
<text text-anchor="middle" x="4599" y="-626.67" font-family="Arial" font-size="9.00">Expert 17</text>
<text text-anchor="middle" x="4599" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="4599" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_17_ffn1 -->
<g id="node78" class="node">
<title>expert_17_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="4711.5,-556 4486.5,-556 4486.5,-518 4711.5,-518 4711.5,-556"/>
<text text-anchor="middle" x="4599" y="-544.8" font-family="Arial" font-size="9.00">Expert 17 FFN1</text>
<text text-anchor="middle" x="4599" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="4599" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_17&#45;&gt;expert_17_ffn1 -->
<g id="edge79" class="edge">
<title>expert_17&#45;&gt;expert_17_ffn1</title>
<path fill="none" stroke="black" d="M4599,-599.75C4599,-589.84 4599,-577.35 4599,-566.2"/>
<polygon fill="black" stroke="black" points="4602.5,-566.05 4599,-556.05 4595.5,-566.05 4602.5,-566.05"/>
</g>
<!-- expert_17_gelu -->
<g id="node79" class="node">
<title>expert_17_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4711.5,-482 4486.5,-482 4486.5,-444 4711.5,-444 4711.5,-482"/>
<text text-anchor="middle" x="4599" y="-470.8" font-family="Arial" font-size="9.00">Expert 17 GELU</text>
<text text-anchor="middle" x="4599" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="4599" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_17_ffn1&#45;&gt;expert_17_gelu -->
<g id="edge80" class="edge">
<title>expert_17_ffn1&#45;&gt;expert_17_gelu</title>
<path fill="none" stroke="black" d="M4599,-517.83C4599,-510.13 4599,-500.97 4599,-492.42"/>
<polygon fill="black" stroke="black" points="4602.5,-492.41 4599,-482.41 4595.5,-492.41 4602.5,-492.41"/>
</g>
<!-- expert_17_ffn2 -->
<g id="node80" class="node">
<title>expert_17_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="4714,-408 4484,-408 4484,-370 4714,-370 4714,-408"/>
<text text-anchor="middle" x="4599" y="-396.8" font-family="Arial" font-size="9.00">Expert 17 FFN2</text>
<text text-anchor="middle" x="4599" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="4599" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_17_gelu&#45;&gt;expert_17_ffn2 -->
<g id="edge81" class="edge">
<title>expert_17_gelu&#45;&gt;expert_17_ffn2</title>
<path fill="none" stroke="black" d="M4599,-443.83C4599,-436.13 4599,-426.97 4599,-418.42"/>
<polygon fill="black" stroke="black" points="4602.5,-418.41 4599,-408.41 4595.5,-418.41 4602.5,-418.41"/>
</g>
<!-- expert_17_ffn2&#45;&gt;expert_agg -->
<g id="edge82" class="edge">
<title>expert_17_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4660.15,-369.94C4744.82,-345.92 4902.93,-304.55 5041,-288 5358.98,-249.88 7575.07,-236.91 8253.85,-233.81"/>
<polygon fill="black" stroke="black" points="8254.24,-237.3 8264.22,-233.76 8254.21,-230.3 8254.24,-237.3"/>
</g>
<!-- expert_18 -->
<g id="node81" class="node">
<title>expert_18</title>
<polygon fill="lightcoral" stroke="black" points="4962,-637.87 4732,-637.87 4732,-599.87 4962,-599.87 4962,-637.87"/>
<text text-anchor="middle" x="4847" y="-626.67" font-family="Arial" font-size="9.00">Expert 18</text>
<text text-anchor="middle" x="4847" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="4847" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_18_ffn1 -->
<g id="node82" class="node">
<title>expert_18_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="4959.5,-556 4734.5,-556 4734.5,-518 4959.5,-518 4959.5,-556"/>
<text text-anchor="middle" x="4847" y="-544.8" font-family="Arial" font-size="9.00">Expert 18 FFN1</text>
<text text-anchor="middle" x="4847" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="4847" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_18&#45;&gt;expert_18_ffn1 -->
<g id="edge83" class="edge">
<title>expert_18&#45;&gt;expert_18_ffn1</title>
<path fill="none" stroke="black" d="M4847,-599.75C4847,-589.84 4847,-577.35 4847,-566.2"/>
<polygon fill="black" stroke="black" points="4850.5,-566.05 4847,-556.05 4843.5,-566.05 4850.5,-566.05"/>
</g>
<!-- expert_18_gelu -->
<g id="node83" class="node">
<title>expert_18_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4959.5,-482 4734.5,-482 4734.5,-444 4959.5,-444 4959.5,-482"/>
<text text-anchor="middle" x="4847" y="-470.8" font-family="Arial" font-size="9.00">Expert 18 GELU</text>
<text text-anchor="middle" x="4847" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="4847" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_18_ffn1&#45;&gt;expert_18_gelu -->
<g id="edge84" class="edge">
<title>expert_18_ffn1&#45;&gt;expert_18_gelu</title>
<path fill="none" stroke="black" d="M4847,-517.83C4847,-510.13 4847,-500.97 4847,-492.42"/>
<polygon fill="black" stroke="black" points="4850.5,-492.41 4847,-482.41 4843.5,-492.41 4850.5,-492.41"/>
</g>
<!-- expert_18_ffn2 -->
<g id="node84" class="node">
<title>expert_18_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="4962,-408 4732,-408 4732,-370 4962,-370 4962,-408"/>
<text text-anchor="middle" x="4847" y="-396.8" font-family="Arial" font-size="9.00">Expert 18 FFN2</text>
<text text-anchor="middle" x="4847" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="4847" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_18_gelu&#45;&gt;expert_18_ffn2 -->
<g id="edge85" class="edge">
<title>expert_18_gelu&#45;&gt;expert_18_ffn2</title>
<path fill="none" stroke="black" d="M4847,-443.83C4847,-436.13 4847,-426.97 4847,-418.42"/>
<polygon fill="black" stroke="black" points="4850.5,-418.41 4847,-408.41 4843.5,-418.41 4850.5,-418.41"/>
</g>
<!-- expert_18_ffn2&#45;&gt;expert_agg -->
<g id="edge86" class="edge">
<title>expert_18_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4907.59,-369.96C4991.48,-345.97 5148.14,-304.63 5285,-288 5578.06,-252.39 7608.44,-237.82 8254.24,-234.05"/>
<polygon fill="black" stroke="black" points="8254.6,-237.55 8264.58,-233.99 8254.56,-230.55 8254.6,-237.55"/>
</g>
<!-- expert_19 -->
<g id="node85" class="node">
<title>expert_19</title>
<polygon fill="lightcoral" stroke="black" points="5210,-637.87 4980,-637.87 4980,-599.87 5210,-599.87 5210,-637.87"/>
<text text-anchor="middle" x="5095" y="-626.67" font-family="Arial" font-size="9.00">Expert 19</text>
<text text-anchor="middle" x="5095" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5095" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_19_ffn1 -->
<g id="node86" class="node">
<title>expert_19_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="5207.5,-556 4982.5,-556 4982.5,-518 5207.5,-518 5207.5,-556"/>
<text text-anchor="middle" x="5095" y="-544.8" font-family="Arial" font-size="9.00">Expert 19 FFN1</text>
<text text-anchor="middle" x="5095" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5095" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_19&#45;&gt;expert_19_ffn1 -->
<g id="edge87" class="edge">
<title>expert_19&#45;&gt;expert_19_ffn1</title>
<path fill="none" stroke="black" d="M5095,-599.75C5095,-589.84 5095,-577.35 5095,-566.2"/>
<polygon fill="black" stroke="black" points="5098.5,-566.05 5095,-556.05 5091.5,-566.05 5098.5,-566.05"/>
</g>
<!-- expert_19_gelu -->
<g id="node87" class="node">
<title>expert_19_gelu</title>
<polygon fill="lightgreen" stroke="black" points="5207.5,-482 4982.5,-482 4982.5,-444 5207.5,-444 5207.5,-482"/>
<text text-anchor="middle" x="5095" y="-470.8" font-family="Arial" font-size="9.00">Expert 19 GELU</text>
<text text-anchor="middle" x="5095" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="5095" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_19_ffn1&#45;&gt;expert_19_gelu -->
<g id="edge88" class="edge">
<title>expert_19_ffn1&#45;&gt;expert_19_gelu</title>
<path fill="none" stroke="black" d="M5095,-517.83C5095,-510.13 5095,-500.97 5095,-492.42"/>
<polygon fill="black" stroke="black" points="5098.5,-492.41 5095,-482.41 5091.5,-492.41 5098.5,-492.41"/>
</g>
<!-- expert_19_ffn2 -->
<g id="node88" class="node">
<title>expert_19_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="5210,-408 4980,-408 4980,-370 5210,-370 5210,-408"/>
<text text-anchor="middle" x="5095" y="-396.8" font-family="Arial" font-size="9.00">Expert 19 FFN2</text>
<text text-anchor="middle" x="5095" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="5095" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_19_gelu&#45;&gt;expert_19_ffn2 -->
<g id="edge89" class="edge">
<title>expert_19_gelu&#45;&gt;expert_19_ffn2</title>
<path fill="none" stroke="black" d="M5095,-443.83C5095,-436.13 5095,-426.97 5095,-418.42"/>
<polygon fill="black" stroke="black" points="5098.5,-418.41 5095,-408.41 5091.5,-418.41 5098.5,-418.41"/>
</g>
<!-- expert_19_ffn2&#45;&gt;expert_agg -->
<g id="edge90" class="edge">
<title>expert_19_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M5154.6,-369.99C5237.12,-346.02 5391.26,-304.71 5526,-288 5794.54,-254.69 7642.97,-238.73 8254.81,-234.31"/>
<polygon fill="black" stroke="black" points="8255.08,-237.81 8265.05,-234.24 8255.03,-230.81 8255.08,-237.81"/>
</g>
<!-- expert_20 -->
<g id="node89" class="node">
<title>expert_20</title>
<polygon fill="lightcoral" stroke="black" points="5458,-637.87 5228,-637.87 5228,-599.87 5458,-599.87 5458,-637.87"/>
<text text-anchor="middle" x="5343" y="-626.67" font-family="Arial" font-size="9.00">Expert 20</text>
<text text-anchor="middle" x="5343" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5343" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_20_ffn1 -->
<g id="node90" class="node">
<title>expert_20_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="5455.5,-556 5230.5,-556 5230.5,-518 5455.5,-518 5455.5,-556"/>
<text text-anchor="middle" x="5343" y="-544.8" font-family="Arial" font-size="9.00">Expert 20 FFN1</text>
<text text-anchor="middle" x="5343" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5343" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_20&#45;&gt;expert_20_ffn1 -->
<g id="edge91" class="edge">
<title>expert_20&#45;&gt;expert_20_ffn1</title>
<path fill="none" stroke="black" d="M5343,-599.75C5343,-589.84 5343,-577.35 5343,-566.2"/>
<polygon fill="black" stroke="black" points="5346.5,-566.05 5343,-556.05 5339.5,-566.05 5346.5,-566.05"/>
</g>
<!-- expert_20_gelu -->
<g id="node91" class="node">
<title>expert_20_gelu</title>
<polygon fill="lightgreen" stroke="black" points="5455.5,-482 5230.5,-482 5230.5,-444 5455.5,-444 5455.5,-482"/>
<text text-anchor="middle" x="5343" y="-470.8" font-family="Arial" font-size="9.00">Expert 20 GELU</text>
<text text-anchor="middle" x="5343" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="5343" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_20_ffn1&#45;&gt;expert_20_gelu -->
<g id="edge92" class="edge">
<title>expert_20_ffn1&#45;&gt;expert_20_gelu</title>
<path fill="none" stroke="black" d="M5343,-517.83C5343,-510.13 5343,-500.97 5343,-492.42"/>
<polygon fill="black" stroke="black" points="5346.5,-492.41 5343,-482.41 5339.5,-492.41 5346.5,-492.41"/>
</g>
<!-- expert_20_ffn2 -->
<g id="node92" class="node">
<title>expert_20_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="5458,-408 5228,-408 5228,-370 5458,-370 5458,-408"/>
<text text-anchor="middle" x="5343" y="-396.8" font-family="Arial" font-size="9.00">Expert 20 FFN2</text>
<text text-anchor="middle" x="5343" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="5343" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_20_gelu&#45;&gt;expert_20_ffn2 -->
<g id="edge93" class="edge">
<title>expert_20_gelu&#45;&gt;expert_20_ffn2</title>
<path fill="none" stroke="black" d="M5343,-443.83C5343,-436.13 5343,-426.97 5343,-418.42"/>
<polygon fill="black" stroke="black" points="5346.5,-418.41 5343,-408.41 5339.5,-418.41 5346.5,-418.41"/>
</g>
<!-- expert_20_ffn2&#45;&gt;expert_agg -->
<g id="edge94" class="edge">
<title>expert_20_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M5400.53,-369.9C5479.82,-345.94 5627.57,-304.75 5757,-288 6002.02,-256.29 7677.21,-239.46 8255.32,-234.55"/>
<polygon fill="black" stroke="black" points="8255.46,-238.05 8265.43,-234.46 8255.4,-231.05 8255.46,-238.05"/>
</g>
<!-- expert_21 -->
<g id="node93" class="node">
<title>expert_21</title>
<polygon fill="lightcoral" stroke="black" points="5706,-637.87 5476,-637.87 5476,-599.87 5706,-599.87 5706,-637.87"/>
<text text-anchor="middle" x="5591" y="-626.67" font-family="Arial" font-size="9.00">Expert 21</text>
<text text-anchor="middle" x="5591" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5591" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_21_ffn1 -->
<g id="node94" class="node">
<title>expert_21_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="5703.5,-556 5478.5,-556 5478.5,-518 5703.5,-518 5703.5,-556"/>
<text text-anchor="middle" x="5591" y="-544.8" font-family="Arial" font-size="9.00">Expert 21 FFN1</text>
<text text-anchor="middle" x="5591" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5591" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_21&#45;&gt;expert_21_ffn1 -->
<g id="edge95" class="edge">
<title>expert_21&#45;&gt;expert_21_ffn1</title>
<path fill="none" stroke="black" d="M5591,-599.75C5591,-589.84 5591,-577.35 5591,-566.2"/>
<polygon fill="black" stroke="black" points="5594.5,-566.05 5591,-556.05 5587.5,-566.05 5594.5,-566.05"/>
</g>
<!-- expert_21_gelu -->
<g id="node95" class="node">
<title>expert_21_gelu</title>
<polygon fill="lightgreen" stroke="black" points="5703.5,-482 5478.5,-482 5478.5,-444 5703.5,-444 5703.5,-482"/>
<text text-anchor="middle" x="5591" y="-470.8" font-family="Arial" font-size="9.00">Expert 21 GELU</text>
<text text-anchor="middle" x="5591" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="5591" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_21_ffn1&#45;&gt;expert_21_gelu -->
<g id="edge96" class="edge">
<title>expert_21_ffn1&#45;&gt;expert_21_gelu</title>
<path fill="none" stroke="black" d="M5591,-517.83C5591,-510.13 5591,-500.97 5591,-492.42"/>
<polygon fill="black" stroke="black" points="5594.5,-492.41 5591,-482.41 5587.5,-492.41 5594.5,-492.41"/>
</g>
<!-- expert_21_ffn2 -->
<g id="node96" class="node">
<title>expert_21_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="5706,-408 5476,-408 5476,-370 5706,-370 5706,-408"/>
<text text-anchor="middle" x="5591" y="-396.8" font-family="Arial" font-size="9.00">Expert 21 FFN2</text>
<text text-anchor="middle" x="5591" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="5591" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_21_gelu&#45;&gt;expert_21_ffn2 -->
<g id="edge97" class="edge">
<title>expert_21_gelu&#45;&gt;expert_21_ffn2</title>
<path fill="none" stroke="black" d="M5591,-443.83C5591,-436.13 5591,-426.97 5591,-418.42"/>
<polygon fill="black" stroke="black" points="5594.5,-418.41 5591,-408.41 5587.5,-418.41 5594.5,-418.41"/>
</g>
<!-- expert_21_ffn2&#45;&gt;expert_agg -->
<g id="edge98" class="edge">
<title>expert_21_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M5643.25,-369.91C5715.3,-345.95 5849.66,-304.76 5968,-288 6191.37,-256.36 7709.05,-239.69 8255.47,-234.66"/>
<polygon fill="black" stroke="black" points="8255.85,-238.16 8265.82,-234.57 8255.79,-231.16 8255.85,-238.16"/>
</g>
<!-- expert_22 -->
<g id="node97" class="node">
<title>expert_22</title>
<polygon fill="lightcoral" stroke="black" points="5954,-637.87 5724,-637.87 5724,-599.87 5954,-599.87 5954,-637.87"/>
<text text-anchor="middle" x="5839" y="-626.67" font-family="Arial" font-size="9.00">Expert 22</text>
<text text-anchor="middle" x="5839" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5839" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_22_ffn1 -->
<g id="node98" class="node">
<title>expert_22_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="5951.5,-556 5726.5,-556 5726.5,-518 5951.5,-518 5951.5,-556"/>
<text text-anchor="middle" x="5839" y="-544.8" font-family="Arial" font-size="9.00">Expert 22 FFN1</text>
<text text-anchor="middle" x="5839" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="5839" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_22&#45;&gt;expert_22_ffn1 -->
<g id="edge99" class="edge">
<title>expert_22&#45;&gt;expert_22_ffn1</title>
<path fill="none" stroke="black" d="M5839,-599.75C5839,-589.84 5839,-577.35 5839,-566.2"/>
<polygon fill="black" stroke="black" points="5842.5,-566.05 5839,-556.05 5835.5,-566.05 5842.5,-566.05"/>
</g>
<!-- expert_22_gelu -->
<g id="node99" class="node">
<title>expert_22_gelu</title>
<polygon fill="lightgreen" stroke="black" points="5951.5,-482 5726.5,-482 5726.5,-444 5951.5,-444 5951.5,-482"/>
<text text-anchor="middle" x="5839" y="-470.8" font-family="Arial" font-size="9.00">Expert 22 GELU</text>
<text text-anchor="middle" x="5839" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="5839" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_22_ffn1&#45;&gt;expert_22_gelu -->
<g id="edge100" class="edge">
<title>expert_22_ffn1&#45;&gt;expert_22_gelu</title>
<path fill="none" stroke="black" d="M5839,-517.83C5839,-510.13 5839,-500.97 5839,-492.42"/>
<polygon fill="black" stroke="black" points="5842.5,-492.41 5839,-482.41 5835.5,-492.41 5842.5,-492.41"/>
</g>
<!-- expert_22_ffn2 -->
<g id="node100" class="node">
<title>expert_22_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="5954,-408 5724,-408 5724,-370 5954,-370 5954,-408"/>
<text text-anchor="middle" x="5839" y="-396.8" font-family="Arial" font-size="9.00">Expert 22 FFN2</text>
<text text-anchor="middle" x="5839" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="5839" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_22_gelu&#45;&gt;expert_22_ffn2 -->
<g id="edge101" class="edge">
<title>expert_22_gelu&#45;&gt;expert_22_ffn2</title>
<path fill="none" stroke="black" d="M5839,-443.83C5839,-436.13 5839,-426.97 5839,-418.42"/>
<polygon fill="black" stroke="black" points="5842.5,-418.41 5839,-408.41 5835.5,-418.41 5842.5,-418.41"/>
</g>
<!-- expert_22_ffn2&#45;&gt;expert_agg -->
<g id="edge102" class="edge">
<title>expert_22_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M5879.78,-369.88C5936.08,-345.88 6041.43,-304.65 6136,-288 6341.33,-251.85 7733.89,-238.17 8254.84,-234.28"/>
<polygon fill="black" stroke="black" points="8255.13,-237.78 8265.1,-234.21 8255.07,-230.78 8255.13,-237.78"/>
</g>
<!-- expert_23 -->
<g id="node101" class="node">
<title>expert_23</title>
<polygon fill="lightcoral" stroke="black" points="6202,-637.87 5972,-637.87 5972,-599.87 6202,-599.87 6202,-637.87"/>
<text text-anchor="middle" x="6087" y="-626.67" font-family="Arial" font-size="9.00">Expert 23</text>
<text text-anchor="middle" x="6087" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="6087" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_23_ffn1 -->
<g id="node102" class="node">
<title>expert_23_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="6199.5,-556 5974.5,-556 5974.5,-518 6199.5,-518 6199.5,-556"/>
<text text-anchor="middle" x="6087" y="-544.8" font-family="Arial" font-size="9.00">Expert 23 FFN1</text>
<text text-anchor="middle" x="6087" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="6087" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_23&#45;&gt;expert_23_ffn1 -->
<g id="edge103" class="edge">
<title>expert_23&#45;&gt;expert_23_ffn1</title>
<path fill="none" stroke="black" d="M6087,-599.75C6087,-589.84 6087,-577.35 6087,-566.2"/>
<polygon fill="black" stroke="black" points="6090.5,-566.05 6087,-556.05 6083.5,-566.05 6090.5,-566.05"/>
</g>
<!-- expert_23_gelu -->
<g id="node103" class="node">
<title>expert_23_gelu</title>
<polygon fill="lightgreen" stroke="black" points="6199.5,-482 5974.5,-482 5974.5,-444 6199.5,-444 6199.5,-482"/>
<text text-anchor="middle" x="6087" y="-470.8" font-family="Arial" font-size="9.00">Expert 23 GELU</text>
<text text-anchor="middle" x="6087" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="6087" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_23_ffn1&#45;&gt;expert_23_gelu -->
<g id="edge104" class="edge">
<title>expert_23_ffn1&#45;&gt;expert_23_gelu</title>
<path fill="none" stroke="black" d="M6087,-517.83C6087,-510.13 6087,-500.97 6087,-492.42"/>
<polygon fill="black" stroke="black" points="6090.5,-492.41 6087,-482.41 6083.5,-492.41 6090.5,-492.41"/>
</g>
<!-- expert_23_ffn2 -->
<g id="node104" class="node">
<title>expert_23_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="6202,-408 5972,-408 5972,-370 6202,-370 6202,-408"/>
<text text-anchor="middle" x="6087" y="-396.8" font-family="Arial" font-size="9.00">Expert 23 FFN2</text>
<text text-anchor="middle" x="6087" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="6087" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_23_gelu&#45;&gt;expert_23_ffn2 -->
<g id="edge105" class="edge">
<title>expert_23_gelu&#45;&gt;expert_23_ffn2</title>
<path fill="none" stroke="black" d="M6087,-443.83C6087,-436.13 6087,-426.97 6087,-418.42"/>
<polygon fill="black" stroke="black" points="6090.5,-418.41 6087,-408.41 6083.5,-418.41 6090.5,-418.41"/>
</g>
<!-- expert_23_ffn2&#45;&gt;expert_agg -->
<g id="edge106" class="edge">
<title>expert_23_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M6102.84,-369.71C6124.93,-345.73 6167.53,-304.74 6214,-288 6309.08,-253.75 7727.88,-238.84 8255.4,-234.46"/>
<polygon fill="black" stroke="black" points="8255.43,-237.96 8265.4,-234.38 8255.37,-230.96 8255.43,-237.96"/>
</g>
<!-- expert_24 -->
<g id="node106" class="node">
<title>expert_24</title>
<polygon fill="lightcoral" stroke="black" points="6517,-556 6287,-556 6287,-518 6517,-518 6517,-556"/>
<text text-anchor="middle" x="6402" y="-544.8" font-family="Arial" font-size="9.00">Expert 24</text>
<text text-anchor="middle" x="6402" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="6402" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- a2a_group_3&#45;&gt;expert_24 -->
<g id="edge108" class="edge">
<title>a2a_group_3&#45;&gt;expert_24</title>
<path fill="none" stroke="black" d="M6387.88,-591.72C6390.05,-583.44 6392.47,-574.26 6394.67,-565.86"/>
<polygon fill="black" stroke="black" points="6398.08,-566.69 6397.23,-556.12 6391.31,-564.91 6398.08,-566.69"/>
</g>
<!-- expert_24_ffn1 -->
<g id="node107" class="node">
<title>expert_24_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="6519.5,-482 6294.5,-482 6294.5,-444 6519.5,-444 6519.5,-482"/>
<text text-anchor="middle" x="6407" y="-470.8" font-family="Arial" font-size="9.00">Expert 24 FFN1</text>
<text text-anchor="middle" x="6407" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="6407" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_24&#45;&gt;expert_24_ffn1 -->
<g id="edge109" class="edge">
<title>expert_24&#45;&gt;expert_24_ffn1</title>
<path fill="none" stroke="black" d="M6403.26,-517.83C6403.8,-510.13 6404.43,-500.97 6405.03,-492.42"/>
<polygon fill="black" stroke="black" points="6408.52,-492.63 6405.72,-482.41 6401.54,-492.15 6408.52,-492.63"/>
</g>
<!-- expert_24_gelu -->
<g id="node108" class="node">
<title>expert_24_gelu</title>
<polygon fill="lightgreen" stroke="black" points="6525.5,-408 6300.5,-408 6300.5,-370 6525.5,-370 6525.5,-408"/>
<text text-anchor="middle" x="6413" y="-396.8" font-family="Arial" font-size="9.00">Expert 24 GELU</text>
<text text-anchor="middle" x="6413" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="6413" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_24_ffn1&#45;&gt;expert_24_gelu -->
<g id="edge110" class="edge">
<title>expert_24_ffn1&#45;&gt;expert_24_gelu</title>
<path fill="none" stroke="black" d="M6408.51,-443.83C6409.16,-436.13 6409.92,-426.97 6410.63,-418.42"/>
<polygon fill="black" stroke="black" points="6414.12,-418.67 6411.47,-408.41 6407.15,-418.09 6414.12,-418.67"/>
</g>
<!-- expert_24_ffn2 -->
<g id="node109" class="node">
<title>expert_24_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="6714,-334 6484,-334 6484,-296 6714,-296 6714,-334"/>
<text text-anchor="middle" x="6599" y="-322.8" font-family="Arial" font-size="9.00">Expert 24 FFN2</text>
<text text-anchor="middle" x="6599" y="-312.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="6599" y="-302.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_24_gelu&#45;&gt;expert_24_ffn2 -->
<g id="edge111" class="edge">
<title>expert_24_gelu&#45;&gt;expert_24_ffn2</title>
<path fill="none" stroke="black" d="M6459.94,-369.83C6485.14,-360.07 6516.39,-347.98 6542.88,-337.72"/>
<polygon fill="black" stroke="black" points="6544.34,-340.91 6552.4,-334.04 6541.81,-334.38 6544.34,-340.91"/>
</g>
<!-- expert_24_ffn2&#45;&gt;expert_agg -->
<g id="edge112" class="edge">
<title>expert_24_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M6714.26,-302.22C6767.41,-297.16 6831.36,-291.6 6889,-288 7381.81,-257.26 7963.23,-242.43 8258.3,-236.43"/>
<polygon fill="black" stroke="black" points="8258.75,-239.92 8268.68,-236.22 8258.61,-232.92 8258.75,-239.92"/>
</g>
<!-- expert_25 -->
<g id="node110" class="node">
<title>expert_25</title>
<polygon fill="lightcoral" stroke="black" points="6784,-637.87 6554,-637.87 6554,-599.87 6784,-599.87 6784,-637.87"/>
<text text-anchor="middle" x="6669" y="-626.67" font-family="Arial" font-size="9.00">Expert 25</text>
<text text-anchor="middle" x="6669" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="6669" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_25_ffn1 -->
<g id="node111" class="node">
<title>expert_25_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="6781.5,-556 6556.5,-556 6556.5,-518 6781.5,-518 6781.5,-556"/>
<text text-anchor="middle" x="6669" y="-544.8" font-family="Arial" font-size="9.00">Expert 25 FFN1</text>
<text text-anchor="middle" x="6669" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="6669" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_25&#45;&gt;expert_25_ffn1 -->
<g id="edge113" class="edge">
<title>expert_25&#45;&gt;expert_25_ffn1</title>
<path fill="none" stroke="black" d="M6669,-599.75C6669,-589.84 6669,-577.35 6669,-566.2"/>
<polygon fill="black" stroke="black" points="6672.5,-566.05 6669,-556.05 6665.5,-566.05 6672.5,-566.05"/>
</g>
<!-- expert_25_gelu -->
<g id="node112" class="node">
<title>expert_25_gelu</title>
<polygon fill="lightgreen" stroke="black" points="6781.5,-482 6556.5,-482 6556.5,-444 6781.5,-444 6781.5,-482"/>
<text text-anchor="middle" x="6669" y="-470.8" font-family="Arial" font-size="9.00">Expert 25 GELU</text>
<text text-anchor="middle" x="6669" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="6669" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_25_ffn1&#45;&gt;expert_25_gelu -->
<g id="edge114" class="edge">
<title>expert_25_ffn1&#45;&gt;expert_25_gelu</title>
<path fill="none" stroke="black" d="M6669,-517.83C6669,-510.13 6669,-500.97 6669,-492.42"/>
<polygon fill="black" stroke="black" points="6672.5,-492.41 6669,-482.41 6665.5,-492.41 6672.5,-492.41"/>
</g>
<!-- expert_25_ffn2 -->
<g id="node113" class="node">
<title>expert_25_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="6784,-408 6554,-408 6554,-370 6784,-370 6784,-408"/>
<text text-anchor="middle" x="6669" y="-396.8" font-family="Arial" font-size="9.00">Expert 25 FFN2</text>
<text text-anchor="middle" x="6669" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="6669" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_25_gelu&#45;&gt;expert_25_ffn2 -->
<g id="edge115" class="edge">
<title>expert_25_gelu&#45;&gt;expert_25_ffn2</title>
<path fill="none" stroke="black" d="M6669,-443.83C6669,-436.13 6669,-426.97 6669,-418.42"/>
<polygon fill="black" stroke="black" points="6672.5,-418.41 6669,-408.41 6665.5,-418.41 6672.5,-418.41"/>
</g>
<!-- expert_25_ffn2&#45;&gt;expert_agg -->
<g id="edge116" class="edge">
<title>expert_25_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M6735.81,-370C6826.08,-346.54 6992.35,-306.35 7137,-288 7348.19,-261.21 7948.91,-244.27 8259.62,-237.04"/>
<polygon fill="black" stroke="black" points="8259.73,-240.54 8269.64,-236.81 8259.56,-233.54 8259.73,-240.54"/>
</g>
<!-- expert_26 -->
<g id="node114" class="node">
<title>expert_26</title>
<polygon fill="lightcoral" stroke="black" points="7032,-637.87 6802,-637.87 6802,-599.87 7032,-599.87 7032,-637.87"/>
<text text-anchor="middle" x="6917" y="-626.67" font-family="Arial" font-size="9.00">Expert 26</text>
<text text-anchor="middle" x="6917" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="6917" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_26_ffn1 -->
<g id="node115" class="node">
<title>expert_26_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="7029.5,-556 6804.5,-556 6804.5,-518 7029.5,-518 7029.5,-556"/>
<text text-anchor="middle" x="6917" y="-544.8" font-family="Arial" font-size="9.00">Expert 26 FFN1</text>
<text text-anchor="middle" x="6917" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="6917" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_26&#45;&gt;expert_26_ffn1 -->
<g id="edge117" class="edge">
<title>expert_26&#45;&gt;expert_26_ffn1</title>
<path fill="none" stroke="black" d="M6917,-599.75C6917,-589.84 6917,-577.35 6917,-566.2"/>
<polygon fill="black" stroke="black" points="6920.5,-566.05 6917,-556.05 6913.5,-566.05 6920.5,-566.05"/>
</g>
<!-- expert_26_gelu -->
<g id="node116" class="node">
<title>expert_26_gelu</title>
<polygon fill="lightgreen" stroke="black" points="7029.5,-482 6804.5,-482 6804.5,-444 7029.5,-444 7029.5,-482"/>
<text text-anchor="middle" x="6917" y="-470.8" font-family="Arial" font-size="9.00">Expert 26 GELU</text>
<text text-anchor="middle" x="6917" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="6917" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_26_ffn1&#45;&gt;expert_26_gelu -->
<g id="edge118" class="edge">
<title>expert_26_ffn1&#45;&gt;expert_26_gelu</title>
<path fill="none" stroke="black" d="M6917,-517.83C6917,-510.13 6917,-500.97 6917,-492.42"/>
<polygon fill="black" stroke="black" points="6920.5,-492.41 6917,-482.41 6913.5,-492.41 6920.5,-492.41"/>
</g>
<!-- expert_26_ffn2 -->
<g id="node117" class="node">
<title>expert_26_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="7032,-408 6802,-408 6802,-370 7032,-370 7032,-408"/>
<text text-anchor="middle" x="6917" y="-396.8" font-family="Arial" font-size="9.00">Expert 26 FFN2</text>
<text text-anchor="middle" x="6917" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="6917" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_26_gelu&#45;&gt;expert_26_ffn2 -->
<g id="edge119" class="edge">
<title>expert_26_gelu&#45;&gt;expert_26_ffn2</title>
<path fill="none" stroke="black" d="M6917,-443.83C6917,-436.13 6917,-426.97 6917,-418.42"/>
<polygon fill="black" stroke="black" points="6920.5,-418.41 6917,-408.41 6913.5,-418.41 6920.5,-418.41"/>
</g>
<!-- expert_26_ffn2&#45;&gt;expert_agg -->
<g id="edge120" class="edge">
<title>expert_26_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M6985.15,-369.91C7075.9,-346.64 7241.76,-306.98 7386,-288 7687.08,-248.38 8039.54,-236.95 8253.95,-233.86"/>
<polygon fill="black" stroke="black" points="8254.1,-237.35 8264.05,-233.71 8254,-230.35 8254.1,-237.35"/>
</g>
<!-- expert_27 -->
<g id="node118" class="node">
<title>expert_27</title>
<polygon fill="lightcoral" stroke="black" points="7280,-637.87 7050,-637.87 7050,-599.87 7280,-599.87 7280,-637.87"/>
<text text-anchor="middle" x="7165" y="-626.67" font-family="Arial" font-size="9.00">Expert 27</text>
<text text-anchor="middle" x="7165" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="7165" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_27_ffn1 -->
<g id="node119" class="node">
<title>expert_27_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="7277.5,-556 7052.5,-556 7052.5,-518 7277.5,-518 7277.5,-556"/>
<text text-anchor="middle" x="7165" y="-544.8" font-family="Arial" font-size="9.00">Expert 27 FFN1</text>
<text text-anchor="middle" x="7165" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="7165" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_27&#45;&gt;expert_27_ffn1 -->
<g id="edge121" class="edge">
<title>expert_27&#45;&gt;expert_27_ffn1</title>
<path fill="none" stroke="black" d="M7165,-599.75C7165,-589.84 7165,-577.35 7165,-566.2"/>
<polygon fill="black" stroke="black" points="7168.5,-566.05 7165,-556.05 7161.5,-566.05 7168.5,-566.05"/>
</g>
<!-- expert_27_gelu -->
<g id="node120" class="node">
<title>expert_27_gelu</title>
<polygon fill="lightgreen" stroke="black" points="7277.5,-482 7052.5,-482 7052.5,-444 7277.5,-444 7277.5,-482"/>
<text text-anchor="middle" x="7165" y="-470.8" font-family="Arial" font-size="9.00">Expert 27 GELU</text>
<text text-anchor="middle" x="7165" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="7165" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_27_ffn1&#45;&gt;expert_27_gelu -->
<g id="edge122" class="edge">
<title>expert_27_ffn1&#45;&gt;expert_27_gelu</title>
<path fill="none" stroke="black" d="M7165,-517.83C7165,-510.13 7165,-500.97 7165,-492.42"/>
<polygon fill="black" stroke="black" points="7168.5,-492.41 7165,-482.41 7161.5,-492.41 7168.5,-492.41"/>
</g>
<!-- expert_27_ffn2 -->
<g id="node121" class="node">
<title>expert_27_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="7280,-408 7050,-408 7050,-370 7280,-370 7280,-408"/>
<text text-anchor="middle" x="7165" y="-396.8" font-family="Arial" font-size="9.00">Expert 27 FFN2</text>
<text text-anchor="middle" x="7165" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="7165" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_27_gelu&#45;&gt;expert_27_ffn2 -->
<g id="edge123" class="edge">
<title>expert_27_gelu&#45;&gt;expert_27_ffn2</title>
<path fill="none" stroke="black" d="M7165,-443.83C7165,-436.13 7165,-426.97 7165,-418.42"/>
<polygon fill="black" stroke="black" points="7168.5,-418.41 7165,-408.41 7161.5,-418.41 7168.5,-418.41"/>
</g>
<!-- expert_27_ffn2&#45;&gt;expert_agg -->
<g id="edge124" class="edge">
<title>expert_27_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M7234.52,-369.96C7325.77,-347.03 7491.23,-308.04 7635,-288 7848.16,-258.29 8094.97,-244.48 8260.85,-238.16"/>
<polygon fill="black" stroke="black" points="8261.3,-241.65 8271.16,-237.77 8261.04,-234.65 8261.3,-241.65"/>
</g>
<!-- expert_28 -->
<g id="node122" class="node">
<title>expert_28</title>
<polygon fill="lightcoral" stroke="black" points="7528,-637.87 7298,-637.87 7298,-599.87 7528,-599.87 7528,-637.87"/>
<text text-anchor="middle" x="7413" y="-626.67" font-family="Arial" font-size="9.00">Expert 28</text>
<text text-anchor="middle" x="7413" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="7413" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_28_ffn1 -->
<g id="node123" class="node">
<title>expert_28_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="7525.5,-556 7300.5,-556 7300.5,-518 7525.5,-518 7525.5,-556"/>
<text text-anchor="middle" x="7413" y="-544.8" font-family="Arial" font-size="9.00">Expert 28 FFN1</text>
<text text-anchor="middle" x="7413" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="7413" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_28&#45;&gt;expert_28_ffn1 -->
<g id="edge125" class="edge">
<title>expert_28&#45;&gt;expert_28_ffn1</title>
<path fill="none" stroke="black" d="M7413,-599.75C7413,-589.84 7413,-577.35 7413,-566.2"/>
<polygon fill="black" stroke="black" points="7416.5,-566.05 7413,-556.05 7409.5,-566.05 7416.5,-566.05"/>
</g>
<!-- expert_28_gelu -->
<g id="node124" class="node">
<title>expert_28_gelu</title>
<polygon fill="lightgreen" stroke="black" points="7525.5,-482 7300.5,-482 7300.5,-444 7525.5,-444 7525.5,-482"/>
<text text-anchor="middle" x="7413" y="-470.8" font-family="Arial" font-size="9.00">Expert 28 GELU</text>
<text text-anchor="middle" x="7413" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="7413" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_28_ffn1&#45;&gt;expert_28_gelu -->
<g id="edge126" class="edge">
<title>expert_28_ffn1&#45;&gt;expert_28_gelu</title>
<path fill="none" stroke="black" d="M7413,-517.83C7413,-510.13 7413,-500.97 7413,-492.42"/>
<polygon fill="black" stroke="black" points="7416.5,-492.41 7413,-482.41 7409.5,-492.41 7416.5,-492.41"/>
</g>
<!-- expert_28_ffn2 -->
<g id="node125" class="node">
<title>expert_28_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="7528,-408 7298,-408 7298,-370 7528,-370 7528,-408"/>
<text text-anchor="middle" x="7413" y="-396.8" font-family="Arial" font-size="9.00">Expert 28 FFN2</text>
<text text-anchor="middle" x="7413" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="7413" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_28_gelu&#45;&gt;expert_28_ffn2 -->
<g id="edge127" class="edge">
<title>expert_28_gelu&#45;&gt;expert_28_ffn2</title>
<path fill="none" stroke="black" d="M7413,-443.83C7413,-436.13 7413,-426.97 7413,-418.42"/>
<polygon fill="black" stroke="black" points="7416.5,-418.41 7413,-408.41 7409.5,-418.41 7416.5,-418.41"/>
</g>
<!-- expert_28_ffn2&#45;&gt;expert_agg -->
<g id="edge128" class="edge">
<title>expert_28_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M7481.33,-369.96C7568.91,-347.49 7725.72,-309.45 7862,-288 7998.29,-266.55 8153.73,-252.46 8270.69,-243.92"/>
<polygon fill="black" stroke="black" points="8271.1,-247.4 8280.82,-243.19 8270.59,-240.42 8271.1,-247.4"/>
</g>
<!-- expert_29 -->
<g id="node126" class="node">
<title>expert_29</title>
<polygon fill="lightcoral" stroke="black" points="7776,-637.87 7546,-637.87 7546,-599.87 7776,-599.87 7776,-637.87"/>
<text text-anchor="middle" x="7661" y="-626.67" font-family="Arial" font-size="9.00">Expert 29</text>
<text text-anchor="middle" x="7661" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="7661" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_29_ffn1 -->
<g id="node127" class="node">
<title>expert_29_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="7773.5,-556 7548.5,-556 7548.5,-518 7773.5,-518 7773.5,-556"/>
<text text-anchor="middle" x="7661" y="-544.8" font-family="Arial" font-size="9.00">Expert 29 FFN1</text>
<text text-anchor="middle" x="7661" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="7661" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_29&#45;&gt;expert_29_ffn1 -->
<g id="edge129" class="edge">
<title>expert_29&#45;&gt;expert_29_ffn1</title>
<path fill="none" stroke="black" d="M7661,-599.75C7661,-589.84 7661,-577.35 7661,-566.2"/>
<polygon fill="black" stroke="black" points="7664.5,-566.05 7661,-556.05 7657.5,-566.05 7664.5,-566.05"/>
</g>
<!-- expert_29_gelu -->
<g id="node128" class="node">
<title>expert_29_gelu</title>
<polygon fill="lightgreen" stroke="black" points="7773.5,-482 7548.5,-482 7548.5,-444 7773.5,-444 7773.5,-482"/>
<text text-anchor="middle" x="7661" y="-470.8" font-family="Arial" font-size="9.00">Expert 29 GELU</text>
<text text-anchor="middle" x="7661" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="7661" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_29_ffn1&#45;&gt;expert_29_gelu -->
<g id="edge130" class="edge">
<title>expert_29_ffn1&#45;&gt;expert_29_gelu</title>
<path fill="none" stroke="black" d="M7661,-517.83C7661,-510.13 7661,-500.97 7661,-492.42"/>
<polygon fill="black" stroke="black" points="7664.5,-492.41 7661,-482.41 7657.5,-492.41 7664.5,-492.41"/>
</g>
<!-- expert_29_ffn2 -->
<g id="node129" class="node">
<title>expert_29_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="7776,-408 7546,-408 7546,-370 7776,-370 7776,-408"/>
<text text-anchor="middle" x="7661" y="-396.8" font-family="Arial" font-size="9.00">Expert 29 FFN2</text>
<text text-anchor="middle" x="7661" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="7661" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_29_gelu&#45;&gt;expert_29_ffn2 -->
<g id="edge131" class="edge">
<title>expert_29_gelu&#45;&gt;expert_29_ffn2</title>
<path fill="none" stroke="black" d="M7661,-443.83C7661,-436.13 7661,-426.97 7661,-418.42"/>
<polygon fill="black" stroke="black" points="7664.5,-418.41 7661,-408.41 7657.5,-418.41 7664.5,-418.41"/>
</g>
<!-- expert_29_ffn2&#45;&gt;expert_agg -->
<g id="edge132" class="edge">
<title>expert_29_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M7725.6,-369.98C7805.34,-348.23 7945.32,-311.64 8067,-288 8138.2,-274.17 8217.46,-262.24 8285.4,-253.06"/>
<polygon fill="black" stroke="black" points="8285.89,-256.53 8295.33,-251.73 8284.96,-249.59 8285.89,-256.53"/>
</g>
<!-- expert_30 -->
<g id="node130" class="node">
<title>expert_30</title>
<polygon fill="lightcoral" stroke="black" points="8024,-637.87 7794,-637.87 7794,-599.87 8024,-599.87 8024,-637.87"/>
<text text-anchor="middle" x="7909" y="-626.67" font-family="Arial" font-size="9.00">Expert 30</text>
<text text-anchor="middle" x="7909" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="7909" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_30_ffn1 -->
<g id="node131" class="node">
<title>expert_30_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="8021.5,-556 7796.5,-556 7796.5,-518 8021.5,-518 8021.5,-556"/>
<text text-anchor="middle" x="7909" y="-544.8" font-family="Arial" font-size="9.00">Expert 30 FFN1</text>
<text text-anchor="middle" x="7909" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="7909" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_30&#45;&gt;expert_30_ffn1 -->
<g id="edge133" class="edge">
<title>expert_30&#45;&gt;expert_30_ffn1</title>
<path fill="none" stroke="black" d="M7909,-599.75C7909,-589.84 7909,-577.35 7909,-566.2"/>
<polygon fill="black" stroke="black" points="7912.5,-566.05 7909,-556.05 7905.5,-566.05 7912.5,-566.05"/>
</g>
<!-- expert_30_gelu -->
<g id="node132" class="node">
<title>expert_30_gelu</title>
<polygon fill="lightgreen" stroke="black" points="8021.5,-482 7796.5,-482 7796.5,-444 8021.5,-444 8021.5,-482"/>
<text text-anchor="middle" x="7909" y="-470.8" font-family="Arial" font-size="9.00">Expert 30 GELU</text>
<text text-anchor="middle" x="7909" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="7909" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_30_ffn1&#45;&gt;expert_30_gelu -->
<g id="edge134" class="edge">
<title>expert_30_ffn1&#45;&gt;expert_30_gelu</title>
<path fill="none" stroke="black" d="M7909,-517.83C7909,-510.13 7909,-500.97 7909,-492.42"/>
<polygon fill="black" stroke="black" points="7912.5,-492.41 7909,-482.41 7905.5,-492.41 7912.5,-492.41"/>
</g>
<!-- expert_30_ffn2 -->
<g id="node133" class="node">
<title>expert_30_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="8024,-408 7794,-408 7794,-370 8024,-370 8024,-408"/>
<text text-anchor="middle" x="7909" y="-396.8" font-family="Arial" font-size="9.00">Expert 30 FFN2</text>
<text text-anchor="middle" x="7909" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="7909" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_30_gelu&#45;&gt;expert_30_ffn2 -->
<g id="edge135" class="edge">
<title>expert_30_gelu&#45;&gt;expert_30_ffn2</title>
<path fill="none" stroke="black" d="M7909,-443.83C7909,-436.13 7909,-426.97 7909,-418.42"/>
<polygon fill="black" stroke="black" points="7912.5,-418.41 7909,-408.41 7905.5,-418.41 7912.5,-418.41"/>
</g>
<!-- expert_30_ffn2&#45;&gt;expert_agg -->
<g id="edge136" class="edge">
<title>expert_30_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M7959.31,-369.98C8019.43,-348.8 8123.3,-313.34 8214,-288 8246.58,-278.9 8281.98,-270.11 8315.23,-262.32"/>
<polygon fill="black" stroke="black" points="8316.07,-265.72 8325.01,-260.05 8314.48,-258.91 8316.07,-265.72"/>
</g>
<!-- expert_31 -->
<g id="node134" class="node">
<title>expert_31</title>
<polygon fill="lightcoral" stroke="black" points="8272,-637.87 8042,-637.87 8042,-599.87 8272,-599.87 8272,-637.87"/>
<text text-anchor="middle" x="8157" y="-626.67" font-family="Arial" font-size="9.00">Expert 31</text>
<text text-anchor="middle" x="8157" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8157" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_31_ffn1 -->
<g id="node135" class="node">
<title>expert_31_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="8269.5,-556 8044.5,-556 8044.5,-518 8269.5,-518 8269.5,-556"/>
<text text-anchor="middle" x="8157" y="-544.8" font-family="Arial" font-size="9.00">Expert 31 FFN1</text>
<text text-anchor="middle" x="8157" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8157" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_31&#45;&gt;expert_31_ffn1 -->
<g id="edge137" class="edge">
<title>expert_31&#45;&gt;expert_31_ffn1</title>
<path fill="none" stroke="black" d="M8157,-599.75C8157,-589.84 8157,-577.35 8157,-566.2"/>
<polygon fill="black" stroke="black" points="8160.5,-566.05 8157,-556.05 8153.5,-566.05 8160.5,-566.05"/>
</g>
<!-- expert_31_gelu -->
<g id="node136" class="node">
<title>expert_31_gelu</title>
<polygon fill="lightgreen" stroke="black" points="8269.5,-482 8044.5,-482 8044.5,-444 8269.5,-444 8269.5,-482"/>
<text text-anchor="middle" x="8157" y="-470.8" font-family="Arial" font-size="9.00">Expert 31 GELU</text>
<text text-anchor="middle" x="8157" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="8157" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_31_ffn1&#45;&gt;expert_31_gelu -->
<g id="edge138" class="edge">
<title>expert_31_ffn1&#45;&gt;expert_31_gelu</title>
<path fill="none" stroke="black" d="M8157,-517.83C8157,-510.13 8157,-500.97 8157,-492.42"/>
<polygon fill="black" stroke="black" points="8160.5,-492.41 8157,-482.41 8153.5,-492.41 8160.5,-492.41"/>
</g>
<!-- expert_31_ffn2 -->
<g id="node137" class="node">
<title>expert_31_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="8272,-408 8042,-408 8042,-370 8272,-370 8272,-408"/>
<text text-anchor="middle" x="8157" y="-396.8" font-family="Arial" font-size="9.00">Expert 31 FFN2</text>
<text text-anchor="middle" x="8157" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="8157" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_31_gelu&#45;&gt;expert_31_ffn2 -->
<g id="edge139" class="edge">
<title>expert_31_gelu&#45;&gt;expert_31_ffn2</title>
<path fill="none" stroke="black" d="M8157,-443.83C8157,-436.13 8157,-426.97 8157,-418.42"/>
<polygon fill="black" stroke="black" points="8160.5,-418.41 8157,-408.41 8153.5,-418.41 8160.5,-418.41"/>
</g>
<!-- expert_31_ffn2&#45;&gt;expert_agg -->
<g id="edge140" class="edge">
<title>expert_31_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M8175.72,-369.75C8199.26,-347.69 8241.72,-310.69 8284,-288 8301.57,-278.57 8321.04,-270.37 8340.3,-263.39"/>
<polygon fill="black" stroke="black" points="8341.47,-266.69 8349.73,-260.06 8339.14,-260.09 8341.47,-266.69"/>
</g>
<!-- expert_32 -->
<g id="node139" class="node">
<title>expert_32</title>
<polygon fill="lightcoral" stroke="black" points="8566,-556 8336,-556 8336,-518 8566,-518 8566,-556"/>
<text text-anchor="middle" x="8451" y="-544.8" font-family="Arial" font-size="9.00">Expert 32</text>
<text text-anchor="middle" x="8451" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8451" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- a2a_group_4&#45;&gt;expert_32 -->
<g id="edge142" class="edge">
<title>a2a_group_4&#45;&gt;expert_32</title>
<path fill="none" stroke="black" d="M8451,-591.72C8451,-583.53 8451,-574.46 8451,-566.14"/>
<polygon fill="black" stroke="black" points="8454.5,-566.12 8451,-556.12 8447.5,-566.12 8454.5,-566.12"/>
</g>
<!-- expert_32_ffn1 -->
<g id="node140" class="node">
<title>expert_32_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="8563.5,-482 8338.5,-482 8338.5,-444 8563.5,-444 8563.5,-482"/>
<text text-anchor="middle" x="8451" y="-470.8" font-family="Arial" font-size="9.00">Expert 32 FFN1</text>
<text text-anchor="middle" x="8451" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8451" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_32&#45;&gt;expert_32_ffn1 -->
<g id="edge143" class="edge">
<title>expert_32&#45;&gt;expert_32_ffn1</title>
<path fill="none" stroke="black" d="M8451,-517.83C8451,-510.13 8451,-500.97 8451,-492.42"/>
<polygon fill="black" stroke="black" points="8454.5,-492.41 8451,-482.41 8447.5,-492.41 8454.5,-492.41"/>
</g>
<!-- expert_32_gelu -->
<g id="node141" class="node">
<title>expert_32_gelu</title>
<polygon fill="lightgreen" stroke="black" points="8563.5,-408 8338.5,-408 8338.5,-370 8563.5,-370 8563.5,-408"/>
<text text-anchor="middle" x="8451" y="-396.8" font-family="Arial" font-size="9.00">Expert 32 GELU</text>
<text text-anchor="middle" x="8451" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="8451" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_32_ffn1&#45;&gt;expert_32_gelu -->
<g id="edge144" class="edge">
<title>expert_32_ffn1&#45;&gt;expert_32_gelu</title>
<path fill="none" stroke="black" d="M8451,-443.83C8451,-436.13 8451,-426.97 8451,-418.42"/>
<polygon fill="black" stroke="black" points="8454.5,-418.41 8451,-408.41 8447.5,-418.41 8454.5,-418.41"/>
</g>
<!-- expert_32_ffn2 -->
<g id="node142" class="node">
<title>expert_32_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="8566,-334 8336,-334 8336,-296 8566,-296 8566,-334"/>
<text text-anchor="middle" x="8451" y="-322.8" font-family="Arial" font-size="9.00">Expert 32 FFN2</text>
<text text-anchor="middle" x="8451" y="-312.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="8451" y="-302.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_32_gelu&#45;&gt;expert_32_ffn2 -->
<g id="edge145" class="edge">
<title>expert_32_gelu&#45;&gt;expert_32_ffn2</title>
<path fill="none" stroke="black" d="M8451,-369.83C8451,-362.13 8451,-352.97 8451,-344.42"/>
<polygon fill="black" stroke="black" points="8454.5,-344.41 8451,-334.41 8447.5,-344.41 8454.5,-344.41"/>
</g>
<!-- expert_32_ffn2&#45;&gt;expert_agg -->
<g id="edge146" class="edge">
<title>expert_32_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M8451,-295.62C8451,-288.1 8451,-279.12 8451,-270.34"/>
<polygon fill="black" stroke="black" points="8454.5,-270.23 8451,-260.23 8447.5,-270.23 8454.5,-270.23"/>
</g>
<!-- expert_33 -->
<g id="node143" class="node">
<title>expert_33</title>
<polygon fill="lightcoral" stroke="black" points="8854,-637.87 8624,-637.87 8624,-599.87 8854,-599.87 8854,-637.87"/>
<text text-anchor="middle" x="8739" y="-626.67" font-family="Arial" font-size="9.00">Expert 33</text>
<text text-anchor="middle" x="8739" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8739" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_33_ffn1 -->
<g id="node144" class="node">
<title>expert_33_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="8838.5,-556 8613.5,-556 8613.5,-518 8838.5,-518 8838.5,-556"/>
<text text-anchor="middle" x="8726" y="-544.8" font-family="Arial" font-size="9.00">Expert 33 FFN1</text>
<text text-anchor="middle" x="8726" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8726" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_33&#45;&gt;expert_33_ffn1 -->
<g id="edge147" class="edge">
<title>expert_33&#45;&gt;expert_33_ffn1</title>
<path fill="none" stroke="black" d="M8736.05,-599.75C8734.44,-589.84 8732.41,-577.35 8730.59,-566.2"/>
<polygon fill="black" stroke="black" points="8734,-565.36 8728.94,-556.05 8727.09,-566.48 8734,-565.36"/>
</g>
<!-- expert_33_gelu -->
<g id="node145" class="node">
<title>expert_33_gelu</title>
<polygon fill="lightgreen" stroke="black" points="8819.5,-482 8594.5,-482 8594.5,-444 8819.5,-444 8819.5,-482"/>
<text text-anchor="middle" x="8707" y="-470.8" font-family="Arial" font-size="9.00">Expert 33 GELU</text>
<text text-anchor="middle" x="8707" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="8707" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_33_ffn1&#45;&gt;expert_33_gelu -->
<g id="edge148" class="edge">
<title>expert_33_ffn1&#45;&gt;expert_33_gelu</title>
<path fill="none" stroke="black" d="M8721.21,-517.83C8719.15,-510.05 8716.7,-500.77 8714.42,-492.13"/>
<polygon fill="black" stroke="black" points="8717.79,-491.19 8711.86,-482.41 8711.03,-492.98 8717.79,-491.19"/>
</g>
<!-- expert_33_ffn2 -->
<g id="node146" class="node">
<title>expert_33_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="8818,-408 8588,-408 8588,-370 8818,-370 8818,-408"/>
<text text-anchor="middle" x="8703" y="-396.8" font-family="Arial" font-size="9.00">Expert 33 FFN2</text>
<text text-anchor="middle" x="8703" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="8703" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_33_gelu&#45;&gt;expert_33_ffn2 -->
<g id="edge149" class="edge">
<title>expert_33_gelu&#45;&gt;expert_33_ffn2</title>
<path fill="none" stroke="black" d="M8705.99,-443.83C8705.56,-436.13 8705.05,-426.97 8704.58,-418.42"/>
<polygon fill="black" stroke="black" points="8708.07,-418.2 8704.02,-408.41 8701.08,-418.59 8708.07,-418.2"/>
</g>
<!-- expert_33_ffn2&#45;&gt;expert_agg -->
<g id="edge150" class="edge">
<title>expert_33_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M8682.86,-369.7C8658.56,-348.24 8615.87,-312.52 8575,-288 8560.78,-279.47 8545.01,-271.48 8529.61,-264.36"/>
<polygon fill="black" stroke="black" points="8530.64,-260.99 8520.09,-260.05 8527.76,-267.36 8530.64,-260.99"/>
</g>
<!-- expert_34 -->
<g id="node147" class="node">
<title>expert_34</title>
<polygon fill="lightcoral" stroke="black" points="9102,-637.87 8872,-637.87 8872,-599.87 9102,-599.87 9102,-637.87"/>
<text text-anchor="middle" x="8987" y="-626.67" font-family="Arial" font-size="9.00">Expert 34</text>
<text text-anchor="middle" x="8987" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8987" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_34_ffn1 -->
<g id="node148" class="node">
<title>expert_34_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="9096.5,-556 8871.5,-556 8871.5,-518 9096.5,-518 9096.5,-556"/>
<text text-anchor="middle" x="8984" y="-544.8" font-family="Arial" font-size="9.00">Expert 34 FFN1</text>
<text text-anchor="middle" x="8984" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="8984" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_34&#45;&gt;expert_34_ffn1 -->
<g id="edge151" class="edge">
<title>expert_34&#45;&gt;expert_34_ffn1</title>
<path fill="none" stroke="black" d="M8986.32,-599.75C8985.95,-589.84 8985.48,-577.35 8985.06,-566.2"/>
<polygon fill="black" stroke="black" points="8988.55,-565.91 8984.68,-556.05 8981.56,-566.18 8988.55,-565.91"/>
</g>
<!-- expert_34_gelu -->
<g id="node149" class="node">
<title>expert_34_gelu</title>
<polygon fill="lightgreen" stroke="black" points="9071.5,-482 8846.5,-482 8846.5,-444 9071.5,-444 9071.5,-482"/>
<text text-anchor="middle" x="8959" y="-470.8" font-family="Arial" font-size="9.00">Expert 34 GELU</text>
<text text-anchor="middle" x="8959" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="8959" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_34_ffn1&#45;&gt;expert_34_gelu -->
<g id="edge152" class="edge">
<title>expert_34_ffn1&#45;&gt;expert_34_gelu</title>
<path fill="none" stroke="black" d="M8977.69,-517.83C8974.99,-510.05 8971.77,-500.77 8968.77,-492.13"/>
<polygon fill="black" stroke="black" points="8971.98,-490.71 8965.39,-482.41 8965.37,-493.01 8971.98,-490.71"/>
</g>
<!-- expert_34_ffn2 -->
<g id="node150" class="node">
<title>expert_34_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="9069,-408 8839,-408 8839,-370 9069,-370 9069,-408"/>
<text text-anchor="middle" x="8954" y="-396.8" font-family="Arial" font-size="9.00">Expert 34 FFN2</text>
<text text-anchor="middle" x="8954" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="8954" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_34_gelu&#45;&gt;expert_34_ffn2 -->
<g id="edge153" class="edge">
<title>expert_34_gelu&#45;&gt;expert_34_ffn2</title>
<path fill="none" stroke="black" d="M8957.74,-443.83C8957.2,-436.13 8956.57,-426.97 8955.97,-418.42"/>
<polygon fill="black" stroke="black" points="8959.46,-418.15 8955.28,-408.41 8952.48,-418.63 8959.46,-418.15"/>
</g>
<!-- expert_34_ffn2&#45;&gt;expert_agg -->
<g id="edge154" class="edge">
<title>expert_34_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M8895.32,-369.92C8810.21,-343.69 8651.48,-294.78 8548.59,-263.07"/>
<polygon fill="black" stroke="black" points="8549.4,-259.66 8538.81,-260.06 8547.34,-266.35 8549.4,-259.66"/>
</g>
<!-- expert_35 -->
<g id="node151" class="node">
<title>expert_35</title>
<polygon fill="lightcoral" stroke="black" points="9350,-637.87 9120,-637.87 9120,-599.87 9350,-599.87 9350,-637.87"/>
<text text-anchor="middle" x="9235" y="-626.67" font-family="Arial" font-size="9.00">Expert 35</text>
<text text-anchor="middle" x="9235" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="9235" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_35_ffn1 -->
<g id="node152" class="node">
<title>expert_35_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="9346.5,-556 9121.5,-556 9121.5,-518 9346.5,-518 9346.5,-556"/>
<text text-anchor="middle" x="9234" y="-544.8" font-family="Arial" font-size="9.00">Expert 35 FFN1</text>
<text text-anchor="middle" x="9234" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="9234" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_35&#45;&gt;expert_35_ffn1 -->
<g id="edge155" class="edge">
<title>expert_35&#45;&gt;expert_35_ffn1</title>
<path fill="none" stroke="black" d="M9234.77,-599.75C9234.65,-589.84 9234.49,-577.35 9234.35,-566.2"/>
<polygon fill="black" stroke="black" points="9237.85,-566.01 9234.23,-556.05 9230.85,-566.1 9237.85,-566.01"/>
</g>
<!-- expert_35_gelu -->
<g id="node153" class="node">
<title>expert_35_gelu</title>
<polygon fill="lightgreen" stroke="black" points="9321.5,-482 9096.5,-482 9096.5,-444 9321.5,-444 9321.5,-482"/>
<text text-anchor="middle" x="9209" y="-470.8" font-family="Arial" font-size="9.00">Expert 35 GELU</text>
<text text-anchor="middle" x="9209" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="9209" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_35_ffn1&#45;&gt;expert_35_gelu -->
<g id="edge156" class="edge">
<title>expert_35_ffn1&#45;&gt;expert_35_gelu</title>
<path fill="none" stroke="black" d="M9227.69,-517.83C9224.99,-510.05 9221.77,-500.77 9218.77,-492.13"/>
<polygon fill="black" stroke="black" points="9221.98,-490.71 9215.39,-482.41 9215.37,-493.01 9221.98,-490.71"/>
</g>
<!-- expert_35_ffn2 -->
<g id="node154" class="node">
<title>expert_35_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="9319,-408 9089,-408 9089,-370 9319,-370 9319,-408"/>
<text text-anchor="middle" x="9204" y="-396.8" font-family="Arial" font-size="9.00">Expert 35 FFN2</text>
<text text-anchor="middle" x="9204" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="9204" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_35_gelu&#45;&gt;expert_35_ffn2 -->
<g id="edge157" class="edge">
<title>expert_35_gelu&#45;&gt;expert_35_ffn2</title>
<path fill="none" stroke="black" d="M9207.74,-443.83C9207.2,-436.13 9206.57,-426.97 9205.97,-418.42"/>
<polygon fill="black" stroke="black" points="9209.46,-418.15 9205.28,-408.41 9202.48,-418.63 9209.46,-418.15"/>
</g>
<!-- expert_35_ffn2&#45;&gt;expert_agg -->
<g id="edge158" class="edge">
<title>expert_35_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M9118.01,-369.97C9021.8,-349.84 8861.28,-316.35 8723,-288 8681.6,-279.51 8636.64,-270.38 8595.41,-262.05"/>
<polygon fill="black" stroke="black" points="8596.07,-258.61 8585.57,-260.06 8594.68,-265.47 8596.07,-258.61"/>
</g>
<!-- expert_36 -->
<g id="node155" class="node">
<title>expert_36</title>
<polygon fill="lightcoral" stroke="black" points="9598,-637.87 9368,-637.87 9368,-599.87 9598,-599.87 9598,-637.87"/>
<text text-anchor="middle" x="9483" y="-626.67" font-family="Arial" font-size="9.00">Expert 36</text>
<text text-anchor="middle" x="9483" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="9483" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_36_ffn1 -->
<g id="node156" class="node">
<title>expert_36_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="9591.5,-556 9366.5,-556 9366.5,-518 9591.5,-518 9591.5,-556"/>
<text text-anchor="middle" x="9479" y="-544.8" font-family="Arial" font-size="9.00">Expert 36 FFN1</text>
<text text-anchor="middle" x="9479" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="9479" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_36&#45;&gt;expert_36_ffn1 -->
<g id="edge159" class="edge">
<title>expert_36&#45;&gt;expert_36_ffn1</title>
<path fill="none" stroke="black" d="M9482.09,-599.75C9481.6,-589.84 9480.97,-577.35 9480.41,-566.2"/>
<polygon fill="black" stroke="black" points="9483.9,-565.86 9479.9,-556.05 9476.91,-566.21 9483.9,-565.86"/>
</g>
<!-- expert_36_gelu -->
<g id="node157" class="node">
<title>expert_36_gelu</title>
<polygon fill="lightgreen" stroke="black" points="9571.5,-482 9346.5,-482 9346.5,-444 9571.5,-444 9571.5,-482"/>
<text text-anchor="middle" x="9459" y="-470.8" font-family="Arial" font-size="9.00">Expert 36 GELU</text>
<text text-anchor="middle" x="9459" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="9459" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_36_ffn1&#45;&gt;expert_36_gelu -->
<g id="edge160" class="edge">
<title>expert_36_ffn1&#45;&gt;expert_36_gelu</title>
<path fill="none" stroke="black" d="M9473.95,-517.83C9471.79,-510.05 9469.21,-500.77 9466.82,-492.13"/>
<polygon fill="black" stroke="black" points="9470.16,-491.11 9464.11,-482.41 9463.42,-492.99 9470.16,-491.11"/>
</g>
<!-- expert_36_ffn2 -->
<g id="node158" class="node">
<title>expert_36_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="9568,-408 9338,-408 9338,-370 9568,-370 9568,-408"/>
<text text-anchor="middle" x="9453" y="-396.8" font-family="Arial" font-size="9.00">Expert 36 FFN2</text>
<text text-anchor="middle" x="9453" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="9453" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_36_gelu&#45;&gt;expert_36_ffn2 -->
<g id="edge161" class="edge">
<title>expert_36_gelu&#45;&gt;expert_36_ffn2</title>
<path fill="none" stroke="black" d="M9457.49,-443.83C9456.84,-436.13 9456.08,-426.97 9455.37,-418.42"/>
<polygon fill="black" stroke="black" points="9458.85,-418.09 9454.53,-408.41 9451.88,-418.67 9458.85,-418.09"/>
</g>
<!-- expert_36_ffn2&#45;&gt;expert_agg -->
<g id="edge162" class="edge">
<title>expert_36_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M9347.42,-369.98C9225.71,-349.38 9019.6,-315.02 8842,-288 8782.82,-279 8718.52,-269.74 8659.48,-261.44"/>
<polygon fill="black" stroke="black" points="8659.67,-257.93 8649.29,-260.01 8658.7,-264.87 8659.67,-257.93"/>
</g>
<!-- expert_37 -->
<g id="node159" class="node">
<title>expert_37</title>
<polygon fill="lightcoral" stroke="black" points="9846,-637.87 9616,-637.87 9616,-599.87 9846,-599.87 9846,-637.87"/>
<text text-anchor="middle" x="9731" y="-626.67" font-family="Arial" font-size="9.00">Expert 37</text>
<text text-anchor="middle" x="9731" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="9731" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_37_ffn1 -->
<g id="node160" class="node">
<title>expert_37_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="9835.5,-556 9610.5,-556 9610.5,-518 9835.5,-518 9835.5,-556"/>
<text text-anchor="middle" x="9723" y="-544.8" font-family="Arial" font-size="9.00">Expert 37 FFN1</text>
<text text-anchor="middle" x="9723" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="9723" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_37&#45;&gt;expert_37_ffn1 -->
<g id="edge163" class="edge">
<title>expert_37&#45;&gt;expert_37_ffn1</title>
<path fill="none" stroke="black" d="M9729.18,-599.75C9728.19,-589.84 9726.94,-577.35 9725.82,-566.2"/>
<polygon fill="black" stroke="black" points="9729.29,-565.65 9724.81,-556.05 9722.32,-566.35 9729.29,-565.65"/>
</g>
<!-- expert_37_gelu -->
<g id="node161" class="node">
<title>expert_37_gelu</title>
<polygon fill="lightgreen" stroke="black" points="9818.5,-482 9593.5,-482 9593.5,-444 9818.5,-444 9818.5,-482"/>
<text text-anchor="middle" x="9706" y="-470.8" font-family="Arial" font-size="9.00">Expert 37 GELU</text>
<text text-anchor="middle" x="9706" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="9706" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_37_ffn1&#45;&gt;expert_37_gelu -->
<g id="edge164" class="edge">
<title>expert_37_ffn1&#45;&gt;expert_37_gelu</title>
<path fill="none" stroke="black" d="M9718.71,-517.83C9716.89,-510.13 9714.73,-500.97 9712.71,-492.42"/>
<polygon fill="black" stroke="black" points="9716.05,-491.34 9710.35,-482.41 9709.24,-492.95 9716.05,-491.34"/>
</g>
<!-- expert_37_ffn2 -->
<g id="node162" class="node">
<title>expert_37_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="9816,-408 9586,-408 9586,-370 9816,-370 9816,-408"/>
<text text-anchor="middle" x="9701" y="-396.8" font-family="Arial" font-size="9.00">Expert 37 FFN2</text>
<text text-anchor="middle" x="9701" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="9701" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_37_gelu&#45;&gt;expert_37_ffn2 -->
<g id="edge165" class="edge">
<title>expert_37_gelu&#45;&gt;expert_37_ffn2</title>
<path fill="none" stroke="black" d="M9704.74,-443.83C9704.2,-436.13 9703.57,-426.97 9702.97,-418.42"/>
<polygon fill="black" stroke="black" points="9706.46,-418.15 9702.28,-408.41 9699.48,-418.63 9706.46,-418.15"/>
</g>
<!-- expert_37_ffn2&#45;&gt;expert_agg -->
<g id="edge166" class="edge">
<title>expert_37_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M9585.82,-371.27C9582.85,-370.84 9579.91,-370.42 9577,-370 9319.73,-333.11 9256.02,-319.23 8998,-288 8896.88,-275.76 8785,-264.17 8688.91,-254.81"/>
<polygon fill="black" stroke="black" points="8689.06,-251.31 8678.77,-253.82 8688.39,-258.27 8689.06,-251.31"/>
</g>
<!-- expert_38 -->
<g id="node163" class="node">
<title>expert_38</title>
<polygon fill="lightcoral" stroke="black" points="10094,-637.87 9864,-637.87 9864,-599.87 10094,-599.87 10094,-637.87"/>
<text text-anchor="middle" x="9979" y="-626.67" font-family="Arial" font-size="9.00">Expert 38</text>
<text text-anchor="middle" x="9979" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="9979" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_38_ffn1 -->
<g id="node164" class="node">
<title>expert_38_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="10079.5,-556 9854.5,-556 9854.5,-518 10079.5,-518 10079.5,-556"/>
<text text-anchor="middle" x="9967" y="-544.8" font-family="Arial" font-size="9.00">Expert 38 FFN1</text>
<text text-anchor="middle" x="9967" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="9967" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_38&#45;&gt;expert_38_ffn1 -->
<g id="edge167" class="edge">
<title>expert_38&#45;&gt;expert_38_ffn1</title>
<path fill="none" stroke="black" d="M9976.28,-599.75C9974.79,-589.84 9972.91,-577.35 9971.24,-566.2"/>
<polygon fill="black" stroke="black" points="9974.66,-565.42 9969.71,-556.05 9967.74,-566.46 9974.66,-565.42"/>
</g>
<!-- expert_38_gelu -->
<g id="node165" class="node">
<title>expert_38_gelu</title>
<polygon fill="lightgreen" stroke="black" points="10063.5,-482 9838.5,-482 9838.5,-444 10063.5,-444 10063.5,-482"/>
<text text-anchor="middle" x="9951" y="-470.8" font-family="Arial" font-size="9.00">Expert 38 GELU</text>
<text text-anchor="middle" x="9951" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="9951" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_38_ffn1&#45;&gt;expert_38_gelu -->
<g id="edge168" class="edge">
<title>expert_38_ffn1&#45;&gt;expert_38_gelu</title>
<path fill="none" stroke="black" d="M9962.96,-517.83C9961.25,-510.13 9959.22,-500.97 9957.31,-492.42"/>
<polygon fill="black" stroke="black" points="9960.68,-491.42 9955.09,-482.41 9953.84,-492.93 9960.68,-491.42"/>
</g>
<!-- expert_38_ffn2 -->
<g id="node166" class="node">
<title>expert_38_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="10064,-408 9834,-408 9834,-370 10064,-370 10064,-408"/>
<text text-anchor="middle" x="9949" y="-396.8" font-family="Arial" font-size="9.00">Expert 38 FFN2</text>
<text text-anchor="middle" x="9949" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="9949" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_38_gelu&#45;&gt;expert_38_ffn2 -->
<g id="edge169" class="edge">
<title>expert_38_gelu&#45;&gt;expert_38_ffn2</title>
<path fill="none" stroke="black" d="M9950.5,-443.83C9950.28,-436.13 9950.03,-426.97 9949.79,-418.42"/>
<polygon fill="black" stroke="black" points="9953.29,-418.31 9949.51,-408.41 9946.29,-418.51 9953.29,-418.31"/>
</g>
<!-- expert_38_ffn2&#45;&gt;expert_agg -->
<g id="edge170" class="edge">
<title>expert_38_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M9833.83,-371.21C9830.86,-370.8 9827.91,-370.4 9825,-370 9536.9,-330.89 9465.26,-317.23 9176,-288 9008.89,-271.12 8819.64,-256.92 8676.41,-247.19"/>
<polygon fill="black" stroke="black" points="8676.39,-243.68 8666.17,-246.5 8675.92,-250.66 8676.39,-243.68"/>
</g>
<!-- expert_39 -->
<g id="node167" class="node">
<title>expert_39</title>
<polygon fill="lightcoral" stroke="black" points="10342,-637.87 10112,-637.87 10112,-599.87 10342,-599.87 10342,-637.87"/>
<text text-anchor="middle" x="10227" y="-626.67" font-family="Arial" font-size="9.00">Expert 39</text>
<text text-anchor="middle" x="10227" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="10227" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_39_ffn1 -->
<g id="node168" class="node">
<title>expert_39_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="10322.5,-556 10097.5,-556 10097.5,-518 10322.5,-518 10322.5,-556"/>
<text text-anchor="middle" x="10210" y="-544.8" font-family="Arial" font-size="9.00">Expert 39 FFN1</text>
<text text-anchor="middle" x="10210" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="10210" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_39&#45;&gt;expert_39_ffn1 -->
<g id="edge171" class="edge">
<title>expert_39&#45;&gt;expert_39_ffn1</title>
<path fill="none" stroke="black" d="M10223.14,-599.75C10221.01,-589.74 10218.32,-577.09 10215.93,-565.86"/>
<polygon fill="black" stroke="black" points="10219.35,-565.1 10213.84,-556.05 10212.5,-566.56 10219.35,-565.1"/>
</g>
<!-- expert_39_gelu -->
<g id="node169" class="node">
<title>expert_39_gelu</title>
<polygon fill="lightgreen" stroke="black" points="10309.5,-482 10084.5,-482 10084.5,-444 10309.5,-444 10309.5,-482"/>
<text text-anchor="middle" x="10197" y="-470.8" font-family="Arial" font-size="9.00">Expert 39 GELU</text>
<text text-anchor="middle" x="10197" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="10197" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_39_ffn1&#45;&gt;expert_39_gelu -->
<g id="edge172" class="edge">
<title>expert_39_ffn1&#45;&gt;expert_39_gelu</title>
<path fill="none" stroke="black" d="M10206.72,-517.83C10205.33,-510.13 10203.68,-500.97 10202.13,-492.42"/>
<polygon fill="black" stroke="black" points="10205.55,-491.63 10200.32,-482.41 10198.66,-492.88 10205.55,-491.63"/>
</g>
<!-- expert_39_ffn2 -->
<g id="node170" class="node">
<title>expert_39_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="10312,-408 10082,-408 10082,-370 10312,-370 10312,-408"/>
<text text-anchor="middle" x="10197" y="-396.8" font-family="Arial" font-size="9.00">Expert 39 FFN2</text>
<text text-anchor="middle" x="10197" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="10197" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_39_gelu&#45;&gt;expert_39_ffn2 -->
<g id="edge173" class="edge">
<title>expert_39_gelu&#45;&gt;expert_39_ffn2</title>
<path fill="none" stroke="black" d="M10197,-443.83C10197,-436.13 10197,-426.97 10197,-418.42"/>
<polygon fill="black" stroke="black" points="10200.5,-418.41 10197,-408.41 10193.5,-418.41 10200.5,-418.41"/>
</g>
<!-- expert_39_ffn2&#45;&gt;expert_agg -->
<g id="edge174" class="edge">
<title>expert_39_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M10081.84,-371.18C10078.86,-370.78 10075.91,-370.38 10073,-370 9765.07,-329.47 9688.38,-315.42 9379,-288 9135.97,-266.46 8856.37,-251.18 8668.13,-242.28"/>
<polygon fill="black" stroke="black" points="8668.27,-238.78 8658.12,-241.81 8667.94,-245.77 8668.27,-238.78"/>
</g>
<!-- expert_40 -->
<g id="node172" class="node">
<title>expert_40</title>
<polygon fill="lightcoral" stroke="black" points="10635,-556 10405,-556 10405,-518 10635,-518 10635,-556"/>
<text text-anchor="middle" x="10520" y="-544.8" font-family="Arial" font-size="9.00">Expert 40</text>
<text text-anchor="middle" x="10520" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="10520" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- a2a_group_5&#45;&gt;expert_40 -->
<g id="edge176" class="edge">
<title>a2a_group_5&#45;&gt;expert_40</title>
<path fill="none" stroke="black" d="M10520.67,-591.72C10520.57,-583.53 10520.46,-574.46 10520.35,-566.14"/>
<polygon fill="black" stroke="black" points="10523.85,-566.08 10520.23,-556.12 10516.85,-566.17 10523.85,-566.08"/>
</g>
<!-- expert_40_ffn1 -->
<g id="node173" class="node">
<title>expert_40_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="10599.5,-482 10374.5,-482 10374.5,-444 10599.5,-444 10599.5,-482"/>
<text text-anchor="middle" x="10487" y="-470.8" font-family="Arial" font-size="9.00">Expert 40 FFN1</text>
<text text-anchor="middle" x="10487" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="10487" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_40&#45;&gt;expert_40_ffn1 -->
<g id="edge177" class="edge">
<title>expert_40&#45;&gt;expert_40_ffn1</title>
<path fill="none" stroke="black" d="M10511.67,-517.83C10508.03,-509.88 10503.67,-500.37 10499.64,-491.57"/>
<polygon fill="black" stroke="black" points="10502.79,-490.05 10495.44,-482.41 10496.42,-492.96 10502.79,-490.05"/>
</g>
<!-- expert_40_gelu -->
<g id="node174" class="node">
<title>expert_40_gelu</title>
<polygon fill="lightgreen" stroke="black" points="10593.5,-408 10368.5,-408 10368.5,-370 10593.5,-370 10593.5,-408"/>
<text text-anchor="middle" x="10481" y="-396.8" font-family="Arial" font-size="9.00">Expert 40 GELU</text>
<text text-anchor="middle" x="10481" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="10481" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_40_ffn1&#45;&gt;expert_40_gelu -->
<g id="edge178" class="edge">
<title>expert_40_ffn1&#45;&gt;expert_40_gelu</title>
<path fill="none" stroke="black" d="M10485.49,-443.83C10484.84,-436.13 10484.08,-426.97 10483.37,-418.42"/>
<polygon fill="black" stroke="black" points="10486.85,-418.09 10482.53,-408.41 10479.88,-418.67 10486.85,-418.09"/>
</g>
<!-- expert_40_ffn2 -->
<g id="node175" class="node">
<title>expert_40_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="10596,-334 10366,-334 10366,-296 10596,-296 10596,-334"/>
<text text-anchor="middle" x="10481" y="-322.8" font-family="Arial" font-size="9.00">Expert 40 FFN2</text>
<text text-anchor="middle" x="10481" y="-312.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="10481" y="-302.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_40_gelu&#45;&gt;expert_40_ffn2 -->
<g id="edge179" class="edge">
<title>expert_40_gelu&#45;&gt;expert_40_ffn2</title>
<path fill="none" stroke="black" d="M10481,-369.83C10481,-362.13 10481,-352.97 10481,-344.42"/>
<polygon fill="black" stroke="black" points="10484.5,-344.41 10481,-334.41 10477.5,-344.41 10484.5,-344.41"/>
</g>
<!-- expert_40_ffn2&#45;&gt;expert_agg -->
<g id="edge180" class="edge">
<title>expert_40_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M10403.77,-295.97C10387.42,-292.78 10370.21,-289.88 10354,-288 10030.36,-250.48 9076.58,-238.13 8655.16,-234.44"/>
<polygon fill="black" stroke="black" points="8655.03,-230.93 8645,-234.35 8654.97,-237.93 8655.03,-230.93"/>
</g>
<!-- expert_41 -->
<g id="node176" class="node">
<title>expert_41</title>
<polygon fill="lightcoral" stroke="black" points="10924,-637.87 10694,-637.87 10694,-599.87 10924,-599.87 10924,-637.87"/>
<text text-anchor="middle" x="10809" y="-626.67" font-family="Arial" font-size="9.00">Expert 41</text>
<text text-anchor="middle" x="10809" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="10809" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_41_ffn1 -->
<g id="node177" class="node">
<title>expert_41_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="10893.5,-556 10668.5,-556 10668.5,-518 10893.5,-518 10893.5,-556"/>
<text text-anchor="middle" x="10781" y="-544.8" font-family="Arial" font-size="9.00">Expert 41 FFN1</text>
<text text-anchor="middle" x="10781" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="10781" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_41&#45;&gt;expert_41_ffn1 -->
<g id="edge181" class="edge">
<title>expert_41&#45;&gt;expert_41_ffn1</title>
<path fill="none" stroke="black" d="M10802.65,-599.75C10799.1,-589.64 10794.61,-576.84 10790.65,-565.52"/>
<polygon fill="black" stroke="black" points="10793.94,-564.33 10787.33,-556.05 10787.33,-566.65 10793.94,-564.33"/>
</g>
<!-- expert_41_gelu -->
<g id="node178" class="node">
<title>expert_41_gelu</title>
<polygon fill="lightgreen" stroke="black" points="10854.5,-482 10629.5,-482 10629.5,-444 10854.5,-444 10854.5,-482"/>
<text text-anchor="middle" x="10742" y="-470.8" font-family="Arial" font-size="9.00">Expert 41 GELU</text>
<text text-anchor="middle" x="10742" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="10742" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_41_ffn1&#45;&gt;expert_41_gelu -->
<g id="edge182" class="edge">
<title>expert_41_ffn1&#45;&gt;expert_41_gelu</title>
<path fill="none" stroke="black" d="M10771.16,-517.83C10766.8,-509.79 10761.59,-500.17 10756.78,-491.29"/>
<polygon fill="black" stroke="black" points="10759.81,-489.54 10751.97,-482.41 10753.66,-492.87 10759.81,-489.54"/>
</g>
<!-- expert_41_ffn2 -->
<g id="node179" class="node">
<title>expert_41_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="10852,-408 10622,-408 10622,-370 10852,-370 10852,-408"/>
<text text-anchor="middle" x="10737" y="-396.8" font-family="Arial" font-size="9.00">Expert 41 FFN2</text>
<text text-anchor="middle" x="10737" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="10737" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_41_gelu&#45;&gt;expert_41_ffn2 -->
<g id="edge183" class="edge">
<title>expert_41_gelu&#45;&gt;expert_41_ffn2</title>
<path fill="none" stroke="black" d="M10740.74,-443.83C10740.2,-436.13 10739.57,-426.97 10738.97,-418.42"/>
<polygon fill="black" stroke="black" points="10742.46,-418.15 10738.28,-408.41 10735.48,-418.63 10742.46,-418.15"/>
</g>
<!-- expert_41_ffn2&#45;&gt;expert_agg -->
<g id="edge184" class="edge">
<title>expert_41_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M10720.38,-369.71C10697.24,-345.72 10652.76,-304.73 10605,-288 10514.14,-256.17 9176.24,-239.97 8655.88,-234.84"/>
<polygon fill="black" stroke="black" points="8655.67,-231.34 8645.63,-234.74 8655.6,-238.34 8655.67,-231.34"/>
</g>
<!-- expert_42 -->
<g id="node180" class="node">
<title>expert_42</title>
<polygon fill="lightcoral" stroke="black" points="11172,-637.87 10942,-637.87 10942,-599.87 11172,-599.87 11172,-637.87"/>
<text text-anchor="middle" x="11057" y="-626.67" font-family="Arial" font-size="9.00">Expert 42</text>
<text text-anchor="middle" x="11057" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="11057" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_42_ffn1 -->
<g id="node181" class="node">
<title>expert_42_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="11143.5,-556 10918.5,-556 10918.5,-518 11143.5,-518 11143.5,-556"/>
<text text-anchor="middle" x="11031" y="-544.8" font-family="Arial" font-size="9.00">Expert 42 FFN1</text>
<text text-anchor="middle" x="11031" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="11031" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_42&#45;&gt;expert_42_ffn1 -->
<g id="edge185" class="edge">
<title>expert_42&#45;&gt;expert_42_ffn1</title>
<path fill="none" stroke="black" d="M11051.1,-599.75C11047.84,-589.74 11043.73,-577.09 11040.07,-565.86"/>
<polygon fill="black" stroke="black" points="11043.3,-564.48 11036.88,-556.05 11036.64,-566.64 11043.3,-564.48"/>
</g>
<!-- expert_42_gelu -->
<g id="node182" class="node">
<title>expert_42_gelu</title>
<polygon fill="lightgreen" stroke="black" points="11105.5,-482 10880.5,-482 10880.5,-444 11105.5,-444 11105.5,-482"/>
<text text-anchor="middle" x="10993" y="-470.8" font-family="Arial" font-size="9.00">Expert 42 GELU</text>
<text text-anchor="middle" x="10993" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="10993" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_42_ffn1&#45;&gt;expert_42_gelu -->
<g id="edge186" class="edge">
<title>expert_42_ffn1&#45;&gt;expert_42_gelu</title>
<path fill="none" stroke="black" d="M11021.41,-517.83C11017.17,-509.79 11012.09,-500.17 11007.4,-491.29"/>
<polygon fill="black" stroke="black" points="11010.48,-489.62 11002.72,-482.41 11004.29,-492.89 11010.48,-489.62"/>
</g>
<!-- expert_42_ffn2 -->
<g id="node183" class="node">
<title>expert_42_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="11105,-408 10875,-408 10875,-370 11105,-370 11105,-408"/>
<text text-anchor="middle" x="10990" y="-396.8" font-family="Arial" font-size="9.00">Expert 42 FFN2</text>
<text text-anchor="middle" x="10990" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="10990" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_42_gelu&#45;&gt;expert_42_ffn2 -->
<g id="edge187" class="edge">
<title>expert_42_gelu&#45;&gt;expert_42_ffn2</title>
<path fill="none" stroke="black" d="M10992.24,-443.83C10991.92,-436.13 10991.54,-426.97 10991.18,-418.42"/>
<polygon fill="black" stroke="black" points="10994.68,-418.26 10990.77,-408.41 10987.69,-418.55 10994.68,-418.26"/>
</g>
<!-- expert_42_ffn2&#45;&gt;expert_agg -->
<g id="edge188" class="edge">
<title>expert_42_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M10944.04,-369.92C10880.63,-345.97 10762.21,-304.8 10657,-288 10463.16,-257.05 9165.75,-240.4 8656.04,-235"/>
<polygon fill="black" stroke="black" points="8656.04,-231.5 8646,-234.89 8655.96,-238.5 8656.04,-231.5"/>
</g>
<!-- expert_43 -->
<g id="node184" class="node">
<title>expert_43</title>
<polygon fill="lightcoral" stroke="black" points="11420,-637.87 11190,-637.87 11190,-599.87 11420,-599.87 11420,-637.87"/>
<text text-anchor="middle" x="11305" y="-626.67" font-family="Arial" font-size="9.00">Expert 43</text>
<text text-anchor="middle" x="11305" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="11305" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_43_ffn1 -->
<g id="node185" class="node">
<title>expert_43_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="11390.5,-556 11165.5,-556 11165.5,-518 11390.5,-518 11390.5,-556"/>
<text text-anchor="middle" x="11278" y="-544.8" font-family="Arial" font-size="9.00">Expert 43 FFN1</text>
<text text-anchor="middle" x="11278" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="11278" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_43&#45;&gt;expert_43_ffn1 -->
<g id="edge189" class="edge">
<title>expert_43&#45;&gt;expert_43_ffn1</title>
<path fill="none" stroke="black" d="M11298.87,-599.75C11295.49,-589.74 11291.22,-577.09 11287.42,-565.86"/>
<polygon fill="black" stroke="black" points="11290.62,-564.4 11284.1,-556.05 11283.99,-566.65 11290.62,-564.4"/>
</g>
<!-- expert_43_gelu -->
<g id="node186" class="node">
<title>expert_43_gelu</title>
<polygon fill="lightgreen" stroke="black" points="11357.5,-482 11132.5,-482 11132.5,-444 11357.5,-444 11357.5,-482"/>
<text text-anchor="middle" x="11245" y="-470.8" font-family="Arial" font-size="9.00">Expert 43 GELU</text>
<text text-anchor="middle" x="11245" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="11245" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_43_ffn1&#45;&gt;expert_43_gelu -->
<g id="edge190" class="edge">
<title>expert_43_ffn1&#45;&gt;expert_43_gelu</title>
<path fill="none" stroke="black" d="M11269.67,-517.83C11266.03,-509.88 11261.67,-500.37 11257.64,-491.57"/>
<polygon fill="black" stroke="black" points="11260.79,-490.05 11253.44,-482.41 11254.42,-492.96 11260.79,-490.05"/>
</g>
<!-- expert_43_ffn2 -->
<g id="node187" class="node">
<title>expert_43_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="11355,-408 11125,-408 11125,-370 11355,-370 11355,-408"/>
<text text-anchor="middle" x="11240" y="-396.8" font-family="Arial" font-size="9.00">Expert 43 FFN2</text>
<text text-anchor="middle" x="11240" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="11240" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_43_gelu&#45;&gt;expert_43_ffn2 -->
<g id="edge191" class="edge">
<title>expert_43_gelu&#45;&gt;expert_43_ffn2</title>
<path fill="none" stroke="black" d="M11243.74,-443.83C11243.2,-436.13 11242.57,-426.97 11241.97,-418.42"/>
<polygon fill="black" stroke="black" points="11245.46,-418.15 11241.28,-408.41 11238.48,-418.63 11245.46,-418.15"/>
</g>
<!-- expert_43_ffn2&#45;&gt;expert_agg -->
<g id="edge192" class="edge">
<title>expert_43_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M11172.95,-369.93C11081.06,-346.08 10910.44,-305.15 10762,-288 10356.74,-241.18 9137.69,-234.04 8652.96,-233.08"/>
<polygon fill="black" stroke="black" points="8652.71,-229.58 8642.7,-233.06 8652.7,-236.58 8652.71,-229.58"/>
</g>
<!-- expert_44 -->
<g id="node188" class="node">
<title>expert_44</title>
<polygon fill="lightcoral" stroke="black" points="11668,-637.87 11438,-637.87 11438,-599.87 11668,-599.87 11668,-637.87"/>
<text text-anchor="middle" x="11553" y="-626.67" font-family="Arial" font-size="9.00">Expert 44</text>
<text text-anchor="middle" x="11553" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="11553" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_44_ffn1 -->
<g id="node189" class="node">
<title>expert_44_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="11635.5,-556 11410.5,-556 11410.5,-518 11635.5,-518 11635.5,-556"/>
<text text-anchor="middle" x="11523" y="-544.8" font-family="Arial" font-size="9.00">Expert 44 FFN1</text>
<text text-anchor="middle" x="11523" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="11523" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_44&#45;&gt;expert_44_ffn1 -->
<g id="edge193" class="edge">
<title>expert_44&#45;&gt;expert_44_ffn1</title>
<path fill="none" stroke="black" d="M11546.19,-599.75C11542.4,-589.64 11537.59,-576.84 11533.34,-565.52"/>
<polygon fill="black" stroke="black" points="11536.57,-564.18 11529.78,-556.05 11530.02,-566.64 11536.57,-564.18"/>
</g>
<!-- expert_44_gelu -->
<g id="node190" class="node">
<title>expert_44_gelu</title>
<polygon fill="lightgreen" stroke="black" points="11607.5,-482 11382.5,-482 11382.5,-444 11607.5,-444 11607.5,-482"/>
<text text-anchor="middle" x="11495" y="-470.8" font-family="Arial" font-size="9.00">Expert 44 GELU</text>
<text text-anchor="middle" x="11495" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="11495" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_44_ffn1&#45;&gt;expert_44_gelu -->
<g id="edge194" class="edge">
<title>expert_44_ffn1&#45;&gt;expert_44_gelu</title>
<path fill="none" stroke="black" d="M11515.93,-517.83C11512.87,-509.96 11509.22,-500.57 11505.83,-491.85"/>
<polygon fill="black" stroke="black" points="11509.05,-490.46 11502.16,-482.41 11502.52,-493 11509.05,-490.46"/>
</g>
<!-- expert_44_ffn2 -->
<g id="node191" class="node">
<title>expert_44_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="11604,-408 11374,-408 11374,-370 11604,-370 11604,-408"/>
<text text-anchor="middle" x="11489" y="-396.8" font-family="Arial" font-size="9.00">Expert 44 FFN2</text>
<text text-anchor="middle" x="11489" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="11489" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_44_gelu&#45;&gt;expert_44_ffn2 -->
<g id="edge195" class="edge">
<title>expert_44_gelu&#45;&gt;expert_44_ffn2</title>
<path fill="none" stroke="black" d="M11493.49,-443.83C11492.84,-436.13 11492.08,-426.97 11491.37,-418.42"/>
<polygon fill="black" stroke="black" points="11494.85,-418.09 11490.53,-408.41 11487.88,-418.67 11494.85,-418.09"/>
</g>
<!-- expert_44_ffn2&#45;&gt;expert_agg -->
<g id="edge196" class="edge">
<title>expert_44_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M11406.97,-369.99C11294.59,-346.22 11086.16,-305.37 10906,-288 10471.38,-246.09 9160.47,-236.03 8653.88,-233.69"/>
<polygon fill="black" stroke="black" points="8653.55,-230.19 8643.53,-233.64 8653.52,-237.19 8653.55,-230.19"/>
</g>
<!-- expert_45 -->
<g id="node192" class="node">
<title>expert_45</title>
<polygon fill="lightcoral" stroke="black" points="11916,-637.87 11686,-637.87 11686,-599.87 11916,-599.87 11916,-637.87"/>
<text text-anchor="middle" x="11801" y="-626.67" font-family="Arial" font-size="9.00">Expert 45</text>
<text text-anchor="middle" x="11801" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="11801" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_45_ffn1 -->
<g id="node193" class="node">
<title>expert_45_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="11879.5,-556 11654.5,-556 11654.5,-518 11879.5,-518 11879.5,-556"/>
<text text-anchor="middle" x="11767" y="-544.8" font-family="Arial" font-size="9.00">Expert 45 FFN1</text>
<text text-anchor="middle" x="11767" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="11767" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_45&#45;&gt;expert_45_ffn1 -->
<g id="edge197" class="edge">
<title>expert_45&#45;&gt;expert_45_ffn1</title>
<path fill="none" stroke="black" d="M11793.28,-599.75C11788.98,-589.64 11783.53,-576.84 11778.71,-565.52"/>
<polygon fill="black" stroke="black" points="11781.82,-563.88 11774.68,-556.05 11775.38,-566.62 11781.82,-563.88"/>
</g>
<!-- expert_45_gelu -->
<g id="node194" class="node">
<title>expert_45_gelu</title>
<polygon fill="lightgreen" stroke="black" points="11852.5,-482 11627.5,-482 11627.5,-444 11852.5,-444 11852.5,-482"/>
<text text-anchor="middle" x="11740" y="-470.8" font-family="Arial" font-size="9.00">Expert 45 GELU</text>
<text text-anchor="middle" x="11740" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="11740" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_45_ffn1&#45;&gt;expert_45_gelu -->
<g id="edge198" class="edge">
<title>expert_45_ffn1&#45;&gt;expert_45_gelu</title>
<path fill="none" stroke="black" d="M11760.19,-517.83C11757.24,-509.96 11753.71,-500.57 11750.44,-491.85"/>
<polygon fill="black" stroke="black" points="11753.69,-490.55 11746.9,-482.41 11747.14,-493.01 11753.69,-490.55"/>
</g>
<!-- expert_45_ffn2 -->
<g id="node195" class="node">
<title>expert_45_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="11853,-408 11623,-408 11623,-370 11853,-370 11853,-408"/>
<text text-anchor="middle" x="11738" y="-396.8" font-family="Arial" font-size="9.00">Expert 45 FFN2</text>
<text text-anchor="middle" x="11738" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="11738" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_45_gelu&#45;&gt;expert_45_ffn2 -->
<g id="edge199" class="edge">
<title>expert_45_gelu&#45;&gt;expert_45_ffn2</title>
<path fill="none" stroke="black" d="M11739.5,-443.83C11739.28,-436.13 11739.03,-426.97 11738.79,-418.42"/>
<polygon fill="black" stroke="black" points="11742.29,-418.31 11738.51,-408.41 11735.29,-418.51 11742.29,-418.31"/>
</g>
<!-- expert_45_ffn2&#45;&gt;expert_agg -->
<g id="edge200" class="edge">
<title>expert_45_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M11643.73,-369.98C11514.94,-346.25 11276.49,-305.49 11071,-288 10602.82,-248.15 9184.48,-236.8 8654.06,-233.9"/>
<polygon fill="black" stroke="black" points="8654.02,-230.4 8644,-233.85 8653.99,-237.4 8654.02,-230.4"/>
</g>
<!-- expert_46 -->
<g id="node196" class="node">
<title>expert_46</title>
<polygon fill="lightcoral" stroke="black" points="12164,-637.87 11934,-637.87 11934,-599.87 12164,-599.87 12164,-637.87"/>
<text text-anchor="middle" x="12049" y="-626.67" font-family="Arial" font-size="9.00">Expert 46</text>
<text text-anchor="middle" x="12049" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12049" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_46_ffn1 -->
<g id="node197" class="node">
<title>expert_46_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="12122.5,-556 11897.5,-556 11897.5,-518 12122.5,-518 12122.5,-556"/>
<text text-anchor="middle" x="12010" y="-544.8" font-family="Arial" font-size="9.00">Expert 46 FFN1</text>
<text text-anchor="middle" x="12010" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12010" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_46&#45;&gt;expert_46_ffn1 -->
<g id="edge201" class="edge">
<title>expert_46&#45;&gt;expert_46_ffn1</title>
<path fill="none" stroke="black" d="M12040.15,-599.75C12035.16,-589.53 12028.84,-576.58 12023.27,-565.17"/>
<polygon fill="black" stroke="black" points="12026.35,-563.5 12018.81,-556.05 12020.06,-566.57 12026.35,-563.5"/>
</g>
<!-- expert_46_gelu -->
<g id="node198" class="node">
<title>expert_46_gelu</title>
<polygon fill="lightgreen" stroke="black" points="12100.5,-482 11875.5,-482 11875.5,-444 12100.5,-444 12100.5,-482"/>
<text text-anchor="middle" x="11988" y="-470.8" font-family="Arial" font-size="9.00">Expert 46 GELU</text>
<text text-anchor="middle" x="11988" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="11988" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_46_ffn1&#45;&gt;expert_46_gelu -->
<g id="edge202" class="edge">
<title>expert_46_ffn1&#45;&gt;expert_46_gelu</title>
<path fill="none" stroke="black" d="M12004.45,-517.83C12002.07,-510.05 11999.24,-500.77 11996.6,-492.13"/>
<polygon fill="black" stroke="black" points="11999.9,-490.95 11993.63,-482.41 11993.2,-493 11999.9,-490.95"/>
</g>
<!-- expert_46_ffn2 -->
<g id="node199" class="node">
<title>expert_46_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="12101,-408 11871,-408 11871,-370 12101,-370 12101,-408"/>
<text text-anchor="middle" x="11986" y="-396.8" font-family="Arial" font-size="9.00">Expert 46 FFN2</text>
<text text-anchor="middle" x="11986" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="11986" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_46_gelu&#45;&gt;expert_46_ffn2 -->
<g id="edge203" class="edge">
<title>expert_46_gelu&#45;&gt;expert_46_ffn2</title>
<path fill="none" stroke="black" d="M11987.5,-443.83C11987.28,-436.13 11987.03,-426.97 11986.79,-418.42"/>
<polygon fill="black" stroke="black" points="11990.29,-418.31 11986.51,-408.41 11983.29,-418.51 11990.29,-418.31"/>
</g>
<!-- expert_46_ffn2&#45;&gt;expert_agg -->
<g id="edge204" class="edge">
<title>expert_46_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M11883.34,-369.99C11742.75,-346.21 11482.18,-305.36 11258,-288 10751.91,-248.82 9211.22,-236.99 8654.46,-233.94"/>
<polygon fill="black" stroke="black" points="8654.34,-230.44 8644.32,-233.88 8654.3,-237.44 8654.34,-230.44"/>
</g>
<!-- expert_47 -->
<g id="node200" class="node">
<title>expert_47</title>
<polygon fill="lightcoral" stroke="black" points="12412,-637.87 12182,-637.87 12182,-599.87 12412,-599.87 12412,-637.87"/>
<text text-anchor="middle" x="12297" y="-626.67" font-family="Arial" font-size="9.00">Expert 47</text>
<text text-anchor="middle" x="12297" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12297" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_47_ffn1 -->
<g id="node201" class="node">
<title>expert_47_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="12365.5,-556 12140.5,-556 12140.5,-518 12365.5,-518 12365.5,-556"/>
<text text-anchor="middle" x="12253" y="-544.8" font-family="Arial" font-size="9.00">Expert 47 FFN1</text>
<text text-anchor="middle" x="12253" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12253" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_47&#45;&gt;expert_47_ffn1 -->
<g id="edge205" class="edge">
<title>expert_47&#45;&gt;expert_47_ffn1</title>
<path fill="none" stroke="black" d="M12287.02,-599.75C12281.33,-589.43 12274.11,-576.32 12267.78,-564.83"/>
<polygon fill="black" stroke="black" points="12270.84,-563.12 12262.94,-556.05 12264.7,-566.5 12270.84,-563.12"/>
</g>
<!-- expert_47_gelu -->
<g id="node202" class="node">
<title>expert_47_gelu</title>
<polygon fill="lightgreen" stroke="black" points="12346.5,-482 12121.5,-482 12121.5,-444 12346.5,-444 12346.5,-482"/>
<text text-anchor="middle" x="12234" y="-470.8" font-family="Arial" font-size="9.00">Expert 47 GELU</text>
<text text-anchor="middle" x="12234" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="12234" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_47_ffn1&#45;&gt;expert_47_gelu -->
<g id="edge206" class="edge">
<title>expert_47_ffn1&#45;&gt;expert_47_gelu</title>
<path fill="none" stroke="black" d="M12248.21,-517.83C12246.15,-510.05 12243.7,-500.77 12241.42,-492.13"/>
<polygon fill="black" stroke="black" points="12244.79,-491.19 12238.86,-482.41 12238.03,-492.98 12244.79,-491.19"/>
</g>
<!-- expert_47_ffn2 -->
<g id="node203" class="node">
<title>expert_47_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="12349,-408 12119,-408 12119,-370 12349,-370 12349,-408"/>
<text text-anchor="middle" x="12234" y="-396.8" font-family="Arial" font-size="9.00">Expert 47 FFN2</text>
<text text-anchor="middle" x="12234" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="12234" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_47_gelu&#45;&gt;expert_47_ffn2 -->
<g id="edge207" class="edge">
<title>expert_47_gelu&#45;&gt;expert_47_ffn2</title>
<path fill="none" stroke="black" d="M12234,-443.83C12234,-436.13 12234,-426.97 12234,-418.42"/>
<polygon fill="black" stroke="black" points="12237.5,-418.41 12234,-408.41 12230.5,-418.41 12237.5,-418.41"/>
</g>
<!-- expert_47_ffn2&#45;&gt;expert_agg -->
<g id="edge208" class="edge">
<title>expert_47_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M12125.26,-369.98C11976.01,-346.14 11699.05,-305.16 11461,-288 10913.44,-248.52 9237.64,-236.8 8653.99,-233.86"/>
<polygon fill="black" stroke="black" points="8653.8,-230.36 8643.79,-233.81 8653.77,-237.36 8653.8,-230.36"/>
</g>
<!-- expert_48 -->
<g id="node205" class="node">
<title>expert_48</title>
<polygon fill="lightcoral" stroke="black" points="12702,-556 12472,-556 12472,-518 12702,-518 12702,-556"/>
<text text-anchor="middle" x="12587" y="-544.8" font-family="Arial" font-size="9.00">Expert 48</text>
<text text-anchor="middle" x="12587" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12587" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- a2a_group_6&#45;&gt;expert_48 -->
<g id="edge210" class="edge">
<title>a2a_group_6&#45;&gt;expert_48</title>
<path fill="none" stroke="black" d="M12589.69,-591.72C12589.28,-583.53 12588.83,-574.46 12588.41,-566.14"/>
<polygon fill="black" stroke="black" points="12591.9,-565.94 12587.91,-556.12 12584.91,-566.29 12591.9,-565.94"/>
</g>
<!-- expert_48_ffn1 -->
<g id="node206" class="node">
<title>expert_48_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="12680.5,-482 12455.5,-482 12455.5,-444 12680.5,-444 12680.5,-482"/>
<text text-anchor="middle" x="12568" y="-470.8" font-family="Arial" font-size="9.00">Expert 48 FFN1</text>
<text text-anchor="middle" x="12568" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12568" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_48&#45;&gt;expert_48_ffn1 -->
<g id="edge211" class="edge">
<title>expert_48&#45;&gt;expert_48_ffn1</title>
<path fill="none" stroke="black" d="M12582.21,-517.83C12580.15,-510.05 12577.7,-500.77 12575.42,-492.13"/>
<polygon fill="black" stroke="black" points="12578.79,-491.19 12572.86,-482.41 12572.03,-492.98 12578.79,-491.19"/>
</g>
<!-- expert_48_gelu -->
<g id="node207" class="node">
<title>expert_48_gelu</title>
<polygon fill="lightgreen" stroke="black" points="12665.5,-408 12440.5,-408 12440.5,-370 12665.5,-370 12665.5,-408"/>
<text text-anchor="middle" x="12553" y="-396.8" font-family="Arial" font-size="9.00">Expert 48 GELU</text>
<text text-anchor="middle" x="12553" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="12553" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_48_ffn1&#45;&gt;expert_48_gelu -->
<g id="edge212" class="edge">
<title>expert_48_ffn1&#45;&gt;expert_48_gelu</title>
<path fill="none" stroke="black" d="M12564.21,-443.83C12562.61,-436.13 12560.7,-426.97 12558.92,-418.42"/>
<polygon fill="black" stroke="black" points="12562.3,-417.49 12556.84,-408.41 12555.45,-418.92 12562.3,-417.49"/>
</g>
<!-- expert_48_ffn2 -->
<g id="node208" class="node">
<title>expert_48_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="12667,-334 12437,-334 12437,-296 12667,-296 12667,-334"/>
<text text-anchor="middle" x="12552" y="-322.8" font-family="Arial" font-size="9.00">Expert 48 FFN2</text>
<text text-anchor="middle" x="12552" y="-312.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="12552" y="-302.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_48_gelu&#45;&gt;expert_48_ffn2 -->
<g id="edge213" class="edge">
<title>expert_48_gelu&#45;&gt;expert_48_ffn2</title>
<path fill="none" stroke="black" d="M12552.75,-369.83C12552.64,-362.13 12552.51,-352.97 12552.39,-344.42"/>
<polygon fill="black" stroke="black" points="12555.89,-344.36 12552.26,-334.41 12548.9,-344.46 12555.89,-344.36"/>
</g>
<!-- expert_48_ffn2&#45;&gt;expert_agg -->
<g id="edge214" class="edge">
<title>expert_48_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M12475.2,-295.98C12458.42,-292.72 12440.68,-289.79 12424,-288 12048.69,-247.64 9410.75,-236.09 8653.68,-233.59"/>
<polygon fill="black" stroke="black" points="8653.5,-230.09 8643.49,-233.55 8653.48,-237.09 8653.5,-230.09"/>
</g>
<!-- expert_49 -->
<g id="node209" class="node">
<title>expert_49</title>
<polygon fill="lightcoral" stroke="black" points="12994,-637.87 12764,-637.87 12764,-599.87 12994,-599.87 12994,-637.87"/>
<text text-anchor="middle" x="12879" y="-626.67" font-family="Arial" font-size="9.00">Expert 49</text>
<text text-anchor="middle" x="12879" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12879" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_49_ffn1 -->
<g id="node210" class="node">
<title>expert_49_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="12947.5,-556 12722.5,-556 12722.5,-518 12947.5,-518 12947.5,-556"/>
<text text-anchor="middle" x="12835" y="-544.8" font-family="Arial" font-size="9.00">Expert 49 FFN1</text>
<text text-anchor="middle" x="12835" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="12835" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_49&#45;&gt;expert_49_ffn1 -->
<g id="edge215" class="edge">
<title>expert_49&#45;&gt;expert_49_ffn1</title>
<path fill="none" stroke="black" d="M12869.02,-599.75C12863.33,-589.43 12856.11,-576.32 12849.78,-564.83"/>
<polygon fill="black" stroke="black" points="12852.84,-563.12 12844.94,-556.05 12846.7,-566.5 12852.84,-563.12"/>
</g>
<!-- expert_49_gelu -->
<g id="node211" class="node">
<title>expert_49_gelu</title>
<polygon fill="lightgreen" stroke="black" points="12946.5,-482 12721.5,-482 12721.5,-444 12946.5,-444 12946.5,-482"/>
<text text-anchor="middle" x="12834" y="-470.8" font-family="Arial" font-size="9.00">Expert 49 GELU</text>
<text text-anchor="middle" x="12834" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="12834" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_49_ffn1&#45;&gt;expert_49_gelu -->
<g id="edge216" class="edge">
<title>expert_49_ffn1&#45;&gt;expert_49_gelu</title>
<path fill="none" stroke="black" d="M12834.75,-517.83C12834.64,-510.13 12834.51,-500.97 12834.39,-492.42"/>
<polygon fill="black" stroke="black" points="12837.89,-492.36 12834.26,-482.41 12830.9,-492.46 12837.89,-492.36"/>
</g>
<!-- expert_49_ffn2 -->
<g id="node212" class="node">
<title>expert_49_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="12933,-408 12703,-408 12703,-370 12933,-370 12933,-408"/>
<text text-anchor="middle" x="12818" y="-396.8" font-family="Arial" font-size="9.00">Expert 49 FFN2</text>
<text text-anchor="middle" x="12818" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="12818" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_49_gelu&#45;&gt;expert_49_ffn2 -->
<g id="edge217" class="edge">
<title>expert_49_gelu&#45;&gt;expert_49_ffn2</title>
<path fill="none" stroke="black" d="M12829.96,-443.83C12828.25,-436.13 12826.22,-426.97 12824.31,-418.42"/>
<polygon fill="black" stroke="black" points="12827.68,-417.42 12822.09,-408.41 12820.84,-418.93 12827.68,-417.42"/>
</g>
<!-- expert_49_ffn2&#45;&gt;expert_agg -->
<g id="edge218" class="edge">
<title>expert_49_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M12799.86,-369.6C12774.67,-345.49 12726.49,-304.35 12676,-288 12579.36,-256.69 9484.86,-238.38 8654.39,-234.02"/>
<polygon fill="black" stroke="black" points="8654.15,-230.52 8644.13,-233.96 8654.11,-237.52 8654.15,-230.52"/>
</g>
<!-- expert_50 -->
<g id="node213" class="node">
<title>expert_50</title>
<polygon fill="lightcoral" stroke="black" points="13242,-637.87 13012,-637.87 13012,-599.87 13242,-599.87 13242,-637.87"/>
<text text-anchor="middle" x="13127" y="-626.67" font-family="Arial" font-size="9.00">Expert 50</text>
<text text-anchor="middle" x="13127" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13127" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_50_ffn1 -->
<g id="node214" class="node">
<title>expert_50_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="13233.5,-556 13008.5,-556 13008.5,-518 13233.5,-518 13233.5,-556"/>
<text text-anchor="middle" x="13121" y="-544.8" font-family="Arial" font-size="9.00">Expert 50 FFN1</text>
<text text-anchor="middle" x="13121" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13121" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_50&#45;&gt;expert_50_ffn1 -->
<g id="edge219" class="edge">
<title>expert_50&#45;&gt;expert_50_ffn1</title>
<path fill="none" stroke="black" d="M13125.64,-599.75C13124.89,-589.84 13123.96,-577.35 13123.12,-566.2"/>
<polygon fill="black" stroke="black" points="13126.6,-565.76 13122.36,-556.05 13119.62,-566.29 13126.6,-565.76"/>
</g>
<!-- expert_50_gelu -->
<g id="node215" class="node">
<title>expert_50_gelu</title>
<polygon fill="lightgreen" stroke="black" points="13191.5,-482 12966.5,-482 12966.5,-444 13191.5,-444 13191.5,-482"/>
<text text-anchor="middle" x="13079" y="-470.8" font-family="Arial" font-size="9.00">Expert 50 GELU</text>
<text text-anchor="middle" x="13079" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="13079" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_50_ffn1&#45;&gt;expert_50_gelu -->
<g id="edge220" class="edge">
<title>expert_50_ffn1&#45;&gt;expert_50_gelu</title>
<path fill="none" stroke="black" d="M13110.4,-517.83C13105.71,-509.79 13100.1,-500.17 13094.92,-491.29"/>
<polygon fill="black" stroke="black" points="13097.8,-489.29 13089.74,-482.41 13091.76,-492.81 13097.8,-489.29"/>
</g>
<!-- expert_50_ffn2 -->
<g id="node216" class="node">
<title>expert_50_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="13190,-408 12960,-408 12960,-370 13190,-370 13190,-408"/>
<text text-anchor="middle" x="13075" y="-396.8" font-family="Arial" font-size="9.00">Expert 50 FFN2</text>
<text text-anchor="middle" x="13075" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="13075" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_50_gelu&#45;&gt;expert_50_ffn2 -->
<g id="edge221" class="edge">
<title>expert_50_gelu&#45;&gt;expert_50_ffn2</title>
<path fill="none" stroke="black" d="M13077.99,-443.83C13077.56,-436.13 13077.05,-426.97 13076.58,-418.42"/>
<polygon fill="black" stroke="black" points="13080.07,-418.2 13076.02,-408.41 13073.08,-418.59 13080.07,-418.2"/>
</g>
<!-- expert_50_ffn2&#45;&gt;expert_agg -->
<g id="edge222" class="edge">
<title>expert_50_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M13027.91,-369.94C12962.31,-345.82 12839.18,-304.22 12730,-288 12526.72,-257.8 9477.38,-238.71 8654.38,-234.09"/>
<polygon fill="black" stroke="black" points="8654.22,-230.59 8644.2,-234.04 8654.18,-237.59 8654.22,-230.59"/>
</g>
<!-- expert_51 -->
<g id="node217" class="node">
<title>expert_51</title>
<polygon fill="lightcoral" stroke="black" points="13490,-637.87 13260,-637.87 13260,-599.87 13490,-599.87 13490,-637.87"/>
<text text-anchor="middle" x="13375" y="-626.67" font-family="Arial" font-size="9.00">Expert 51</text>
<text text-anchor="middle" x="13375" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13375" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_51_ffn1 -->
<g id="node218" class="node">
<title>expert_51_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="13486.5,-556 13261.5,-556 13261.5,-518 13486.5,-518 13486.5,-556"/>
<text text-anchor="middle" x="13374" y="-544.8" font-family="Arial" font-size="9.00">Expert 51 FFN1</text>
<text text-anchor="middle" x="13374" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13374" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_51&#45;&gt;expert_51_ffn1 -->
<g id="edge223" class="edge">
<title>expert_51&#45;&gt;expert_51_ffn1</title>
<path fill="none" stroke="black" d="M13374.77,-599.75C13374.65,-589.84 13374.49,-577.35 13374.35,-566.2"/>
<polygon fill="black" stroke="black" points="13377.85,-566.01 13374.23,-556.05 13370.85,-566.1 13377.85,-566.01"/>
</g>
<!-- expert_51_gelu -->
<g id="node219" class="node">
<title>expert_51_gelu</title>
<polygon fill="lightgreen" stroke="black" points="13466.5,-482 13241.5,-482 13241.5,-444 13466.5,-444 13466.5,-482"/>
<text text-anchor="middle" x="13354" y="-470.8" font-family="Arial" font-size="9.00">Expert 51 GELU</text>
<text text-anchor="middle" x="13354" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="13354" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_51_ffn1&#45;&gt;expert_51_gelu -->
<g id="edge224" class="edge">
<title>expert_51_ffn1&#45;&gt;expert_51_gelu</title>
<path fill="none" stroke="black" d="M13368.95,-517.83C13366.79,-510.05 13364.21,-500.77 13361.82,-492.13"/>
<polygon fill="black" stroke="black" points="13365.16,-491.11 13359.11,-482.41 13358.42,-492.99 13365.16,-491.11"/>
</g>
<!-- expert_51_ffn2 -->
<g id="node220" class="node">
<title>expert_51_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="13461,-408 13231,-408 13231,-370 13461,-370 13461,-408"/>
<text text-anchor="middle" x="13346" y="-396.8" font-family="Arial" font-size="9.00">Expert 51 FFN2</text>
<text text-anchor="middle" x="13346" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="13346" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_51_gelu&#45;&gt;expert_51_ffn2 -->
<g id="edge225" class="edge">
<title>expert_51_gelu&#45;&gt;expert_51_ffn2</title>
<path fill="none" stroke="black" d="M13351.98,-443.83C13351.13,-436.13 13350.11,-426.97 13349.16,-418.42"/>
<polygon fill="black" stroke="black" points="13352.63,-417.97 13348.05,-408.41 13345.67,-418.74 13352.63,-417.97"/>
</g>
<!-- expert_51_ffn2&#45;&gt;expert_agg -->
<g id="edge226" class="edge">
<title>expert_51_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M13275.52,-369.9C13178,-345.83 12996.03,-304.41 12838,-288 12419.79,-244.58 9459.41,-235.14 8653.27,-233.37"/>
<polygon fill="black" stroke="black" points="8653.02,-229.87 8643.01,-233.35 8653,-236.87 8653.02,-229.87"/>
</g>
<!-- expert_52 -->
<g id="node221" class="node">
<title>expert_52</title>
<polygon fill="lightcoral" stroke="black" points="13738,-637.87 13508,-637.87 13508,-599.87 13738,-599.87 13738,-637.87"/>
<text text-anchor="middle" x="13623" y="-626.67" font-family="Arial" font-size="9.00">Expert 52</text>
<text text-anchor="middle" x="13623" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13623" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_52_ffn1 -->
<g id="node222" class="node">
<title>expert_52_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="13734.5,-556 13509.5,-556 13509.5,-518 13734.5,-518 13734.5,-556"/>
<text text-anchor="middle" x="13622" y="-544.8" font-family="Arial" font-size="9.00">Expert 52 FFN1</text>
<text text-anchor="middle" x="13622" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13622" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_52&#45;&gt;expert_52_ffn1 -->
<g id="edge227" class="edge">
<title>expert_52&#45;&gt;expert_52_ffn1</title>
<path fill="none" stroke="black" d="M13622.77,-599.75C13622.65,-589.84 13622.49,-577.35 13622.35,-566.2"/>
<polygon fill="black" stroke="black" points="13625.85,-566.01 13622.23,-556.05 13618.85,-566.1 13625.85,-566.01"/>
</g>
<!-- expert_52_gelu -->
<g id="node223" class="node">
<title>expert_52_gelu</title>
<polygon fill="lightgreen" stroke="black" points="13726.5,-482 13501.5,-482 13501.5,-444 13726.5,-444 13726.5,-482"/>
<text text-anchor="middle" x="13614" y="-470.8" font-family="Arial" font-size="9.00">Expert 52 GELU</text>
<text text-anchor="middle" x="13614" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="13614" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_52_ffn1&#45;&gt;expert_52_gelu -->
<g id="edge228" class="edge">
<title>expert_52_ffn1&#45;&gt;expert_52_gelu</title>
<path fill="none" stroke="black" d="M13619.98,-517.83C13619.13,-510.13 13618.11,-500.97 13617.16,-492.42"/>
<polygon fill="black" stroke="black" points="13620.63,-491.97 13616.05,-482.41 13613.67,-492.74 13620.63,-491.97"/>
</g>
<!-- expert_52_ffn2 -->
<g id="node224" class="node">
<title>expert_52_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="13721,-408 13491,-408 13491,-370 13721,-370 13721,-408"/>
<text text-anchor="middle" x="13606" y="-396.8" font-family="Arial" font-size="9.00">Expert 52 FFN2</text>
<text text-anchor="middle" x="13606" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="13606" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_52_gelu&#45;&gt;expert_52_ffn2 -->
<g id="edge229" class="edge">
<title>expert_52_gelu&#45;&gt;expert_52_ffn2</title>
<path fill="none" stroke="black" d="M13611.98,-443.83C13611.13,-436.13 13610.11,-426.97 13609.16,-418.42"/>
<polygon fill="black" stroke="black" points="13612.63,-417.97 13608.05,-408.41 13605.67,-418.74 13612.63,-417.97"/>
</g>
<!-- expert_52_ffn2&#45;&gt;expert_agg -->
<g id="edge230" class="edge">
<title>expert_52_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M13520.55,-369.99C13402.08,-345.97 13180.92,-304.56 12990,-288 12555.51,-250.31 9478.71,-236.68 8653.98,-233.68"/>
<polygon fill="black" stroke="black" points="8653.8,-230.18 8643.78,-233.64 8653.77,-237.18 8653.8,-230.18"/>
</g>
<!-- expert_53 -->
<g id="node225" class="node">
<title>expert_53</title>
<polygon fill="lightcoral" stroke="black" points="13986,-637.87 13756,-637.87 13756,-599.87 13986,-599.87 13986,-637.87"/>
<text text-anchor="middle" x="13871" y="-626.67" font-family="Arial" font-size="9.00">Expert 53</text>
<text text-anchor="middle" x="13871" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13871" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_53_ffn1 -->
<g id="node226" class="node">
<title>expert_53_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="13979.5,-556 13754.5,-556 13754.5,-518 13979.5,-518 13979.5,-556"/>
<text text-anchor="middle" x="13867" y="-544.8" font-family="Arial" font-size="9.00">Expert 53 FFN1</text>
<text text-anchor="middle" x="13867" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="13867" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_53&#45;&gt;expert_53_ffn1 -->
<g id="edge231" class="edge">
<title>expert_53&#45;&gt;expert_53_ffn1</title>
<path fill="none" stroke="black" d="M13870.09,-599.75C13869.6,-589.84 13868.97,-577.35 13868.41,-566.2"/>
<polygon fill="black" stroke="black" points="13871.9,-565.86 13867.9,-556.05 13864.91,-566.21 13871.9,-565.86"/>
</g>
<!-- expert_53_gelu -->
<g id="node227" class="node">
<title>expert_53_gelu</title>
<polygon fill="lightgreen" stroke="black" points="13978.5,-482 13753.5,-482 13753.5,-444 13978.5,-444 13978.5,-482"/>
<text text-anchor="middle" x="13866" y="-470.8" font-family="Arial" font-size="9.00">Expert 53 GELU</text>
<text text-anchor="middle" x="13866" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="13866" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_53_ffn1&#45;&gt;expert_53_gelu -->
<g id="edge232" class="edge">
<title>expert_53_ffn1&#45;&gt;expert_53_gelu</title>
<path fill="none" stroke="black" d="M13866.75,-517.83C13866.64,-510.13 13866.51,-500.97 13866.39,-492.42"/>
<polygon fill="black" stroke="black" points="13869.89,-492.36 13866.26,-482.41 13862.9,-492.46 13869.89,-492.36"/>
</g>
<!-- expert_53_ffn2 -->
<g id="node228" class="node">
<title>expert_53_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="13975,-408 13745,-408 13745,-370 13975,-370 13975,-408"/>
<text text-anchor="middle" x="13860" y="-396.8" font-family="Arial" font-size="9.00">Expert 53 FFN2</text>
<text text-anchor="middle" x="13860" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="13860" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_53_gelu&#45;&gt;expert_53_ffn2 -->
<g id="edge233" class="edge">
<title>expert_53_gelu&#45;&gt;expert_53_ffn2</title>
<path fill="none" stroke="black" d="M13864.49,-443.83C13863.84,-436.13 13863.08,-426.97 13862.37,-418.42"/>
<polygon fill="black" stroke="black" points="13865.85,-418.09 13861.53,-408.41 13858.88,-418.67 13865.85,-418.09"/>
</g>
<!-- expert_53_ffn2&#45;&gt;expert_agg -->
<g id="edge234" class="edge">
<title>expert_53_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M13764.17,-369.96C13631.65,-345.96 13384.69,-304.62 13172,-288 12718.32,-252.54 9499.23,-237.21 8653.9,-233.77"/>
<polygon fill="black" stroke="black" points="8653.77,-230.27 8643.76,-233.73 8653.74,-237.27 8653.77,-230.27"/>
</g>
<!-- expert_54 -->
<g id="node229" class="node">
<title>expert_54</title>
<polygon fill="lightcoral" stroke="black" points="14234,-637.87 14004,-637.87 14004,-599.87 14234,-599.87 14234,-637.87"/>
<text text-anchor="middle" x="14119" y="-626.67" font-family="Arial" font-size="9.00">Expert 54</text>
<text text-anchor="middle" x="14119" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="14119" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_54_ffn1 -->
<g id="node230" class="node">
<title>expert_54_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="14230.5,-556 14005.5,-556 14005.5,-518 14230.5,-518 14230.5,-556"/>
<text text-anchor="middle" x="14118" y="-544.8" font-family="Arial" font-size="9.00">Expert 54 FFN1</text>
<text text-anchor="middle" x="14118" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="14118" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_54&#45;&gt;expert_54_ffn1 -->
<g id="edge235" class="edge">
<title>expert_54&#45;&gt;expert_54_ffn1</title>
<path fill="none" stroke="black" d="M14118.77,-599.75C14118.65,-589.84 14118.49,-577.35 14118.35,-566.2"/>
<polygon fill="black" stroke="black" points="14121.85,-566.01 14118.23,-556.05 14114.85,-566.1 14121.85,-566.01"/>
</g>
<!-- expert_54_gelu -->
<g id="node231" class="node">
<title>expert_54_gelu</title>
<polygon fill="lightgreen" stroke="black" points="14223.5,-482 13998.5,-482 13998.5,-444 14223.5,-444 14223.5,-482"/>
<text text-anchor="middle" x="14111" y="-470.8" font-family="Arial" font-size="9.00">Expert 54 GELU</text>
<text text-anchor="middle" x="14111" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="14111" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_54_ffn1&#45;&gt;expert_54_gelu -->
<g id="edge236" class="edge">
<title>expert_54_ffn1&#45;&gt;expert_54_gelu</title>
<path fill="none" stroke="black" d="M14116.23,-517.83C14115.48,-510.13 14114.59,-500.97 14113.76,-492.42"/>
<polygon fill="black" stroke="black" points="14117.24,-492.03 14112.79,-482.41 14110.27,-492.71 14117.24,-492.03"/>
</g>
<!-- expert_54_ffn2 -->
<g id="node232" class="node">
<title>expert_54_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="14226,-408 13996,-408 13996,-370 14226,-370 14226,-408"/>
<text text-anchor="middle" x="14111" y="-396.8" font-family="Arial" font-size="9.00">Expert 54 FFN2</text>
<text text-anchor="middle" x="14111" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="14111" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_54_gelu&#45;&gt;expert_54_ffn2 -->
<g id="edge237" class="edge">
<title>expert_54_gelu&#45;&gt;expert_54_ffn2</title>
<path fill="none" stroke="black" d="M14111,-443.83C14111,-436.13 14111,-426.97 14111,-418.42"/>
<polygon fill="black" stroke="black" points="14114.5,-418.41 14111,-408.41 14107.5,-418.41 14114.5,-418.41"/>
</g>
<!-- expert_54_ffn2&#45;&gt;expert_agg -->
<g id="edge238" class="edge">
<title>expert_54_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M14008.45,-369.98C13866.3,-345.95 13601.09,-304.52 13373,-288 12898.29,-253.62 9522.25,-237.43 8654.12,-233.8"/>
<polygon fill="black" stroke="black" points="8654.04,-230.3 8644.03,-233.76 8654.01,-237.3 8654.04,-230.3"/>
</g>
<!-- expert_55 -->
<g id="node233" class="node">
<title>expert_55</title>
<polygon fill="lightcoral" stroke="black" points="14482,-637.87 14252,-637.87 14252,-599.87 14482,-599.87 14482,-637.87"/>
<text text-anchor="middle" x="14367" y="-626.67" font-family="Arial" font-size="9.00">Expert 55</text>
<text text-anchor="middle" x="14367" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="14367" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_55_ffn1 -->
<g id="node234" class="node">
<title>expert_55_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="14475.5,-556 14250.5,-556 14250.5,-518 14475.5,-518 14475.5,-556"/>
<text text-anchor="middle" x="14363" y="-544.8" font-family="Arial" font-size="9.00">Expert 55 FFN1</text>
<text text-anchor="middle" x="14363" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="14363" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_55&#45;&gt;expert_55_ffn1 -->
<g id="edge239" class="edge">
<title>expert_55&#45;&gt;expert_55_ffn1</title>
<path fill="none" stroke="black" d="M14366.09,-599.75C14365.6,-589.84 14364.97,-577.35 14364.41,-566.2"/>
<polygon fill="black" stroke="black" points="14367.9,-565.86 14363.9,-556.05 14360.91,-566.21 14367.9,-565.86"/>
</g>
<!-- expert_55_gelu -->
<g id="node235" class="node">
<title>expert_55_gelu</title>
<polygon fill="lightgreen" stroke="black" points="14474.5,-482 14249.5,-482 14249.5,-444 14474.5,-444 14474.5,-482"/>
<text text-anchor="middle" x="14362" y="-470.8" font-family="Arial" font-size="9.00">Expert 55 GELU</text>
<text text-anchor="middle" x="14362" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="14362" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_55_ffn1&#45;&gt;expert_55_gelu -->
<g id="edge240" class="edge">
<title>expert_55_ffn1&#45;&gt;expert_55_gelu</title>
<path fill="none" stroke="black" d="M14362.75,-517.83C14362.64,-510.13 14362.51,-500.97 14362.39,-492.42"/>
<polygon fill="black" stroke="black" points="14365.89,-492.36 14362.26,-482.41 14358.9,-492.46 14365.89,-492.36"/>
</g>
<!-- expert_55_ffn2 -->
<g id="node236" class="node">
<title>expert_55_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="14477,-408 14247,-408 14247,-370 14477,-370 14477,-408"/>
<text text-anchor="middle" x="14362" y="-396.8" font-family="Arial" font-size="9.00">Expert 55 FFN2</text>
<text text-anchor="middle" x="14362" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="14362" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_55_gelu&#45;&gt;expert_55_ffn2 -->
<g id="edge241" class="edge">
<title>expert_55_gelu&#45;&gt;expert_55_ffn2</title>
<path fill="none" stroke="black" d="M14362,-443.83C14362,-436.13 14362,-426.97 14362,-418.42"/>
<polygon fill="black" stroke="black" points="14365.5,-418.41 14362,-408.41 14358.5,-418.41 14365.5,-418.41"/>
</g>
<!-- expert_55_ffn2&#45;&gt;expert_agg -->
<g id="edge242" class="edge">
<title>expert_55_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M14254.72,-369.99C14105.67,-345.92 13827.26,-304.39 13588,-288 13090.76,-253.94 9545.46,-237.43 8654.01,-233.79"/>
<polygon fill="black" stroke="black" points="8653.98,-230.29 8643.97,-233.75 8653.95,-237.29 8653.98,-230.29"/>
</g>
<!-- expert_56 -->
<g id="node238" class="node">
<title>expert_56</title>
<polygon fill="lightcoral" stroke="black" points="14775,-556 14545,-556 14545,-518 14775,-518 14775,-556"/>
<text text-anchor="middle" x="14660" y="-544.8" font-family="Arial" font-size="9.00">Expert 56</text>
<text text-anchor="middle" x="14660" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="14660" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- a2a_group_7&#45;&gt;expert_56 -->
<g id="edge244" class="edge">
<title>a2a_group_7&#45;&gt;expert_56</title>
<path fill="none" stroke="black" d="M14660.67,-591.72C14660.57,-583.53 14660.46,-574.46 14660.35,-566.14"/>
<polygon fill="black" stroke="black" points="14663.85,-566.08 14660.23,-556.12 14656.85,-566.17 14663.85,-566.08"/>
</g>
<!-- expert_56_ffn1 -->
<g id="node239" class="node">
<title>expert_56_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="14739.5,-482 14514.5,-482 14514.5,-444 14739.5,-444 14739.5,-482"/>
<text text-anchor="middle" x="14627" y="-470.8" font-family="Arial" font-size="9.00">Expert 56 FFN1</text>
<text text-anchor="middle" x="14627" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="14627" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_56&#45;&gt;expert_56_ffn1 -->
<g id="edge245" class="edge">
<title>expert_56&#45;&gt;expert_56_ffn1</title>
<path fill="none" stroke="black" d="M14651.67,-517.83C14648.03,-509.88 14643.67,-500.37 14639.64,-491.57"/>
<polygon fill="black" stroke="black" points="14642.79,-490.05 14635.44,-482.41 14636.42,-492.96 14642.79,-490.05"/>
</g>
<!-- expert_56_gelu -->
<g id="node240" class="node">
<title>expert_56_gelu</title>
<polygon fill="lightgreen" stroke="black" points="14733.5,-408 14508.5,-408 14508.5,-370 14733.5,-370 14733.5,-408"/>
<text text-anchor="middle" x="14621" y="-396.8" font-family="Arial" font-size="9.00">Expert 56 GELU</text>
<text text-anchor="middle" x="14621" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="14621" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_56_ffn1&#45;&gt;expert_56_gelu -->
<g id="edge246" class="edge">
<title>expert_56_ffn1&#45;&gt;expert_56_gelu</title>
<path fill="none" stroke="black" d="M14625.49,-443.83C14624.84,-436.13 14624.08,-426.97 14623.37,-418.42"/>
<polygon fill="black" stroke="black" points="14626.85,-418.09 14622.53,-408.41 14619.88,-418.67 14626.85,-418.09"/>
</g>
<!-- expert_56_ffn2 -->
<g id="node241" class="node">
<title>expert_56_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="14736,-334 14506,-334 14506,-296 14736,-296 14736,-334"/>
<text text-anchor="middle" x="14621" y="-322.8" font-family="Arial" font-size="9.00">Expert 56 FFN2</text>
<text text-anchor="middle" x="14621" y="-312.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="14621" y="-302.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_56_gelu&#45;&gt;expert_56_ffn2 -->
<g id="edge247" class="edge">
<title>expert_56_gelu&#45;&gt;expert_56_ffn2</title>
<path fill="none" stroke="black" d="M14621,-369.83C14621,-362.13 14621,-352.97 14621,-344.42"/>
<polygon fill="black" stroke="black" points="14624.5,-344.41 14621,-334.41 14617.5,-344.41 14624.5,-344.41"/>
</g>
<!-- expert_56_ffn2&#45;&gt;expert_agg -->
<g id="edge248" class="edge">
<title>expert_56_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M14545.15,-295.99C14528.4,-292.71 14510.67,-289.77 14494,-288 14197.91,-256.64 9674.15,-237.65 8654.22,-233.75"/>
<polygon fill="black" stroke="black" points="8653.86,-230.25 8643.85,-233.71 8653.84,-237.25 8653.86,-230.25"/>
</g>
<!-- expert_57 -->
<g id="node242" class="node">
<title>expert_57</title>
<polygon fill="lightcoral" stroke="black" points="15064,-637.87 14834,-637.87 14834,-599.87 15064,-599.87 15064,-637.87"/>
<text text-anchor="middle" x="14949" y="-626.67" font-family="Arial" font-size="9.00">Expert 57</text>
<text text-anchor="middle" x="14949" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="14949" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_57_ffn1 -->
<g id="node243" class="node">
<title>expert_57_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="15033.5,-556 14808.5,-556 14808.5,-518 15033.5,-518 15033.5,-556"/>
<text text-anchor="middle" x="14921" y="-544.8" font-family="Arial" font-size="9.00">Expert 57 FFN1</text>
<text text-anchor="middle" x="14921" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="14921" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_57&#45;&gt;expert_57_ffn1 -->
<g id="edge249" class="edge">
<title>expert_57&#45;&gt;expert_57_ffn1</title>
<path fill="none" stroke="black" d="M14942.65,-599.75C14939.1,-589.64 14934.61,-576.84 14930.65,-565.52"/>
<polygon fill="black" stroke="black" points="14933.94,-564.33 14927.33,-556.05 14927.33,-566.65 14933.94,-564.33"/>
</g>
<!-- expert_57_gelu -->
<g id="node244" class="node">
<title>expert_57_gelu</title>
<polygon fill="lightgreen" stroke="black" points="14994.5,-482 14769.5,-482 14769.5,-444 14994.5,-444 14994.5,-482"/>
<text text-anchor="middle" x="14882" y="-470.8" font-family="Arial" font-size="9.00">Expert 57 GELU</text>
<text text-anchor="middle" x="14882" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="14882" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_57_ffn1&#45;&gt;expert_57_gelu -->
<g id="edge250" class="edge">
<title>expert_57_ffn1&#45;&gt;expert_57_gelu</title>
<path fill="none" stroke="black" d="M14911.16,-517.83C14906.8,-509.79 14901.59,-500.17 14896.78,-491.29"/>
<polygon fill="black" stroke="black" points="14899.81,-489.54 14891.97,-482.41 14893.66,-492.87 14899.81,-489.54"/>
</g>
<!-- expert_57_ffn2 -->
<g id="node245" class="node">
<title>expert_57_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="14992,-408 14762,-408 14762,-370 14992,-370 14992,-408"/>
<text text-anchor="middle" x="14877" y="-396.8" font-family="Arial" font-size="9.00">Expert 57 FFN2</text>
<text text-anchor="middle" x="14877" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="14877" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_57_gelu&#45;&gt;expert_57_ffn2 -->
<g id="edge251" class="edge">
<title>expert_57_gelu&#45;&gt;expert_57_ffn2</title>
<path fill="none" stroke="black" d="M14880.74,-443.83C14880.2,-436.13 14879.57,-426.97 14878.97,-418.42"/>
<polygon fill="black" stroke="black" points="14882.46,-418.15 14878.28,-408.41 14875.48,-418.63 14882.46,-418.15"/>
</g>
<!-- expert_57_ffn2&#45;&gt;expert_agg -->
<g id="edge252" class="edge">
<title>expert_57_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M14860.81,-370C14837.83,-345.94 14793.17,-304.42 14745,-288 14597.5,-237.72 9712.58,-233.38 8652.61,-233.03"/>
<polygon fill="black" stroke="black" points="8652.6,-229.53 8642.6,-233.02 8652.6,-236.53 8652.6,-229.53"/>
</g>
<!-- expert_58 -->
<g id="node246" class="node">
<title>expert_58</title>
<polygon fill="lightcoral" stroke="black" points="15312,-637.87 15082,-637.87 15082,-599.87 15312,-599.87 15312,-637.87"/>
<text text-anchor="middle" x="15197" y="-626.67" font-family="Arial" font-size="9.00">Expert 58</text>
<text text-anchor="middle" x="15197" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="15197" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_58_ffn1 -->
<g id="node247" class="node">
<title>expert_58_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="15283.5,-556 15058.5,-556 15058.5,-518 15283.5,-518 15283.5,-556"/>
<text text-anchor="middle" x="15171" y="-544.8" font-family="Arial" font-size="9.00">Expert 58 FFN1</text>
<text text-anchor="middle" x="15171" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="15171" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_58&#45;&gt;expert_58_ffn1 -->
<g id="edge253" class="edge">
<title>expert_58&#45;&gt;expert_58_ffn1</title>
<path fill="none" stroke="black" d="M15191.1,-599.75C15187.84,-589.74 15183.73,-577.09 15180.07,-565.86"/>
<polygon fill="black" stroke="black" points="15183.3,-564.48 15176.88,-556.05 15176.64,-566.64 15183.3,-564.48"/>
</g>
<!-- expert_58_gelu -->
<g id="node248" class="node">
<title>expert_58_gelu</title>
<polygon fill="lightgreen" stroke="black" points="15245.5,-482 15020.5,-482 15020.5,-444 15245.5,-444 15245.5,-482"/>
<text text-anchor="middle" x="15133" y="-470.8" font-family="Arial" font-size="9.00">Expert 58 GELU</text>
<text text-anchor="middle" x="15133" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="15133" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_58_ffn1&#45;&gt;expert_58_gelu -->
<g id="edge254" class="edge">
<title>expert_58_ffn1&#45;&gt;expert_58_gelu</title>
<path fill="none" stroke="black" d="M15161.41,-517.83C15157.17,-509.79 15152.09,-500.17 15147.4,-491.29"/>
<polygon fill="black" stroke="black" points="15150.48,-489.62 15142.72,-482.41 15144.29,-492.89 15150.48,-489.62"/>
</g>
<!-- expert_58_ffn2 -->
<g id="node249" class="node">
<title>expert_58_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="15245,-408 15015,-408 15015,-370 15245,-370 15245,-408"/>
<text text-anchor="middle" x="15130" y="-396.8" font-family="Arial" font-size="9.00">Expert 58 FFN2</text>
<text text-anchor="middle" x="15130" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="15130" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_58_gelu&#45;&gt;expert_58_ffn2 -->
<g id="edge255" class="edge">
<title>expert_58_gelu&#45;&gt;expert_58_ffn2</title>
<path fill="none" stroke="black" d="M15132.24,-443.83C15131.92,-436.13 15131.54,-426.97 15131.18,-418.42"/>
<polygon fill="black" stroke="black" points="15134.68,-418.26 15130.77,-408.41 15127.69,-418.55 15134.68,-418.26"/>
</g>
<!-- expert_58_ffn2&#45;&gt;expert_agg -->
<g id="edge256" class="edge">
<title>expert_58_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M15084.88,-369.98C15021.72,-345.79 14902.79,-304.01 14797,-288 14486.75,-241.05 9702.06,-234.1 8653.2,-233.15"/>
<polygon fill="black" stroke="black" points="8652.92,-229.65 8642.92,-233.14 8652.91,-236.65 8652.92,-229.65"/>
</g>
<!-- expert_59 -->
<g id="node250" class="node">
<title>expert_59</title>
<polygon fill="lightcoral" stroke="black" points="15560,-637.87 15330,-637.87 15330,-599.87 15560,-599.87 15560,-637.87"/>
<text text-anchor="middle" x="15445" y="-626.67" font-family="Arial" font-size="9.00">Expert 59</text>
<text text-anchor="middle" x="15445" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="15445" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_59_ffn1 -->
<g id="node251" class="node">
<title>expert_59_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="15530.5,-556 15305.5,-556 15305.5,-518 15530.5,-518 15530.5,-556"/>
<text text-anchor="middle" x="15418" y="-544.8" font-family="Arial" font-size="9.00">Expert 59 FFN1</text>
<text text-anchor="middle" x="15418" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="15418" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_59&#45;&gt;expert_59_ffn1 -->
<g id="edge257" class="edge">
<title>expert_59&#45;&gt;expert_59_ffn1</title>
<path fill="none" stroke="black" d="M15438.87,-599.75C15435.49,-589.74 15431.22,-577.09 15427.42,-565.86"/>
<polygon fill="black" stroke="black" points="15430.62,-564.4 15424.1,-556.05 15423.99,-566.65 15430.62,-564.4"/>
</g>
<!-- expert_59_gelu -->
<g id="node252" class="node">
<title>expert_59_gelu</title>
<polygon fill="lightgreen" stroke="black" points="15495.5,-482 15270.5,-482 15270.5,-444 15495.5,-444 15495.5,-482"/>
<text text-anchor="middle" x="15383" y="-470.8" font-family="Arial" font-size="9.00">Expert 59 GELU</text>
<text text-anchor="middle" x="15383" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="15383" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_59_ffn1&#45;&gt;expert_59_gelu -->
<g id="edge258" class="edge">
<title>expert_59_ffn1&#45;&gt;expert_59_gelu</title>
<path fill="none" stroke="black" d="M15409.17,-517.83C15405.3,-509.88 15400.68,-500.37 15396.4,-491.57"/>
<polygon fill="black" stroke="black" points="15399.47,-489.88 15391.95,-482.41 15393.18,-492.94 15399.47,-489.88"/>
</g>
<!-- expert_59_ffn2 -->
<g id="node253" class="node">
<title>expert_59_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="15495,-408 15265,-408 15265,-370 15495,-370 15495,-408"/>
<text text-anchor="middle" x="15380" y="-396.8" font-family="Arial" font-size="9.00">Expert 59 FFN2</text>
<text text-anchor="middle" x="15380" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="15380" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_59_gelu&#45;&gt;expert_59_ffn2 -->
<g id="edge259" class="edge">
<title>expert_59_gelu&#45;&gt;expert_59_ffn2</title>
<path fill="none" stroke="black" d="M15382.24,-443.83C15381.92,-436.13 15381.54,-426.97 15381.18,-418.42"/>
<polygon fill="black" stroke="black" points="15384.68,-418.26 15380.77,-408.41 15377.69,-418.55 15384.68,-418.26"/>
</g>
<!-- expert_59_ffn2&#45;&gt;expert_agg -->
<g id="edge260" class="edge">
<title>expert_59_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M15314.16,-369.9C15222.59,-345.73 15051.2,-304.08 14902,-288 14584.56,-253.78 9713.21,-236.88 8653.48,-233.6"/>
<polygon fill="black" stroke="black" points="8653.48,-230.1 8643.47,-233.57 8653.46,-237.1 8653.48,-230.1"/>
</g>
<!-- expert_60 -->
<g id="node254" class="node">
<title>expert_60</title>
<polygon fill="lightcoral" stroke="black" points="15808,-637.87 15578,-637.87 15578,-599.87 15808,-599.87 15808,-637.87"/>
<text text-anchor="middle" x="15693" y="-626.67" font-family="Arial" font-size="9.00">Expert 60</text>
<text text-anchor="middle" x="15693" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="15693" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_60_ffn1 -->
<g id="node255" class="node">
<title>expert_60_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="15775.5,-556 15550.5,-556 15550.5,-518 15775.5,-518 15775.5,-556"/>
<text text-anchor="middle" x="15663" y="-544.8" font-family="Arial" font-size="9.00">Expert 60 FFN1</text>
<text text-anchor="middle" x="15663" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="15663" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_60&#45;&gt;expert_60_ffn1 -->
<g id="edge261" class="edge">
<title>expert_60&#45;&gt;expert_60_ffn1</title>
<path fill="none" stroke="black" d="M15686.19,-599.75C15682.4,-589.64 15677.59,-576.84 15673.34,-565.52"/>
<polygon fill="black" stroke="black" points="15676.57,-564.18 15669.78,-556.05 15670.02,-566.64 15676.57,-564.18"/>
</g>
<!-- expert_60_gelu -->
<g id="node256" class="node">
<title>expert_60_gelu</title>
<polygon fill="lightgreen" stroke="black" points="15744.5,-482 15519.5,-482 15519.5,-444 15744.5,-444 15744.5,-482"/>
<text text-anchor="middle" x="15632" y="-470.8" font-family="Arial" font-size="9.00">Expert 60 GELU</text>
<text text-anchor="middle" x="15632" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="15632" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_60_ffn1&#45;&gt;expert_60_gelu -->
<g id="edge262" class="edge">
<title>expert_60_ffn1&#45;&gt;expert_60_gelu</title>
<path fill="none" stroke="black" d="M15655.18,-517.83C15651.79,-509.96 15647.75,-500.57 15643.99,-491.85"/>
<polygon fill="black" stroke="black" points="15647.1,-490.21 15639.93,-482.41 15640.67,-492.98 15647.1,-490.21"/>
</g>
<!-- expert_60_ffn2 -->
<g id="node257" class="node">
<title>expert_60_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="15744,-408 15514,-408 15514,-370 15744,-370 15744,-408"/>
<text text-anchor="middle" x="15629" y="-396.8" font-family="Arial" font-size="9.00">Expert 60 FFN2</text>
<text text-anchor="middle" x="15629" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="15629" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_60_gelu&#45;&gt;expert_60_ffn2 -->
<g id="edge263" class="edge">
<title>expert_60_gelu&#45;&gt;expert_60_ffn2</title>
<path fill="none" stroke="black" d="M15631.24,-443.83C15630.92,-436.13 15630.54,-426.97 15630.18,-418.42"/>
<polygon fill="black" stroke="black" points="15633.68,-418.26 15629.77,-408.41 15626.69,-418.55 15633.68,-418.26"/>
</g>
<!-- expert_60_ffn2&#45;&gt;expert_agg -->
<g id="edge264" class="edge">
<title>expert_60_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M15548.43,-369.93C15436.44,-345.79 15227.05,-304.18 15046,-288 14397.01,-230.02 9688.2,-231.66 8652.22,-232.74"/>
<polygon fill="black" stroke="black" points="8652.06,-229.24 8642.07,-232.75 8652.07,-236.24 8652.06,-229.24"/>
</g>
<!-- expert_61 -->
<g id="node258" class="node">
<title>expert_61</title>
<polygon fill="lightcoral" stroke="black" points="16056,-637.87 15826,-637.87 15826,-599.87 16056,-599.87 16056,-637.87"/>
<text text-anchor="middle" x="15941" y="-626.67" font-family="Arial" font-size="9.00">Expert 61</text>
<text text-anchor="middle" x="15941" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="15941" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_61_ffn1 -->
<g id="node259" class="node">
<title>expert_61_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="16019.5,-556 15794.5,-556 15794.5,-518 16019.5,-518 16019.5,-556"/>
<text text-anchor="middle" x="15907" y="-544.8" font-family="Arial" font-size="9.00">Expert 61 FFN1</text>
<text text-anchor="middle" x="15907" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="15907" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_61&#45;&gt;expert_61_ffn1 -->
<g id="edge265" class="edge">
<title>expert_61&#45;&gt;expert_61_ffn1</title>
<path fill="none" stroke="black" d="M15933.28,-599.75C15928.98,-589.64 15923.53,-576.84 15918.71,-565.52"/>
<polygon fill="black" stroke="black" points="15921.82,-563.88 15914.68,-556.05 15915.38,-566.62 15921.82,-563.88"/>
</g>
<!-- expert_61_gelu -->
<g id="node260" class="node">
<title>expert_61_gelu</title>
<polygon fill="lightgreen" stroke="black" points="15992.5,-482 15767.5,-482 15767.5,-444 15992.5,-444 15992.5,-482"/>
<text text-anchor="middle" x="15880" y="-470.8" font-family="Arial" font-size="9.00">Expert 61 GELU</text>
<text text-anchor="middle" x="15880" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="15880" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_61_ffn1&#45;&gt;expert_61_gelu -->
<g id="edge266" class="edge">
<title>expert_61_ffn1&#45;&gt;expert_61_gelu</title>
<path fill="none" stroke="black" d="M15900.19,-517.83C15897.24,-509.96 15893.71,-500.57 15890.44,-491.85"/>
<polygon fill="black" stroke="black" points="15893.69,-490.55 15886.9,-482.41 15887.14,-493.01 15893.69,-490.55"/>
</g>
<!-- expert_61_ffn2 -->
<g id="node261" class="node">
<title>expert_61_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="15993,-408 15763,-408 15763,-370 15993,-370 15993,-408"/>
<text text-anchor="middle" x="15878" y="-396.8" font-family="Arial" font-size="9.00">Expert 61 FFN2</text>
<text text-anchor="middle" x="15878" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="15878" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_61_gelu&#45;&gt;expert_61_ffn2 -->
<g id="edge267" class="edge">
<title>expert_61_gelu&#45;&gt;expert_61_ffn2</title>
<path fill="none" stroke="black" d="M15879.5,-443.83C15879.28,-436.13 15879.03,-426.97 15878.79,-418.42"/>
<polygon fill="black" stroke="black" points="15882.29,-418.31 15878.51,-408.41 15875.29,-418.51 15882.29,-418.31"/>
</g>
<!-- expert_61_ffn2&#45;&gt;expert_agg -->
<g id="edge268" class="edge">
<title>expert_61_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M15787.06,-370C15660.38,-345.88 15423.32,-304.25 15219,-288 14551.44,-234.91 9705.98,-232.76 8652.71,-232.92"/>
<polygon fill="black" stroke="black" points="8652.38,-229.42 8642.38,-232.93 8652.38,-236.42 8652.38,-229.42"/>
</g>
<!-- expert_62 -->
<g id="node262" class="node">
<title>expert_62</title>
<polygon fill="lightcoral" stroke="black" points="16304,-637.87 16074,-637.87 16074,-599.87 16304,-599.87 16304,-637.87"/>
<text text-anchor="middle" x="16189" y="-626.67" font-family="Arial" font-size="9.00">Expert 62</text>
<text text-anchor="middle" x="16189" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="16189" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_62_ffn1 -->
<g id="node263" class="node">
<title>expert_62_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="16262.5,-556 16037.5,-556 16037.5,-518 16262.5,-518 16262.5,-556"/>
<text text-anchor="middle" x="16150" y="-544.8" font-family="Arial" font-size="9.00">Expert 62 FFN1</text>
<text text-anchor="middle" x="16150" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="16150" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_62&#45;&gt;expert_62_ffn1 -->
<g id="edge269" class="edge">
<title>expert_62&#45;&gt;expert_62_ffn1</title>
<path fill="none" stroke="black" d="M16180.15,-599.75C16175.16,-589.53 16168.84,-576.58 16163.27,-565.17"/>
<polygon fill="black" stroke="black" points="16166.35,-563.5 16158.81,-556.05 16160.06,-566.57 16166.35,-563.5"/>
</g>
<!-- expert_62_gelu -->
<g id="node264" class="node">
<title>expert_62_gelu</title>
<polygon fill="lightgreen" stroke="black" points="16240.5,-482 16015.5,-482 16015.5,-444 16240.5,-444 16240.5,-482"/>
<text text-anchor="middle" x="16128" y="-470.8" font-family="Arial" font-size="9.00">Expert 62 GELU</text>
<text text-anchor="middle" x="16128" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="16128" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_62_ffn1&#45;&gt;expert_62_gelu -->
<g id="edge270" class="edge">
<title>expert_62_ffn1&#45;&gt;expert_62_gelu</title>
<path fill="none" stroke="black" d="M16144.45,-517.83C16142.07,-510.05 16139.24,-500.77 16136.6,-492.13"/>
<polygon fill="black" stroke="black" points="16139.9,-490.95 16133.63,-482.41 16133.2,-493 16139.9,-490.95"/>
</g>
<!-- expert_62_ffn2 -->
<g id="node265" class="node">
<title>expert_62_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="16241,-408 16011,-408 16011,-370 16241,-370 16241,-408"/>
<text text-anchor="middle" x="16126" y="-396.8" font-family="Arial" font-size="9.00">Expert 62 FFN2</text>
<text text-anchor="middle" x="16126" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="16126" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_62_gelu&#45;&gt;expert_62_ffn2 -->
<g id="edge271" class="edge">
<title>expert_62_gelu&#45;&gt;expert_62_ffn2</title>
<path fill="none" stroke="black" d="M16127.5,-443.83C16127.28,-436.13 16127.03,-426.97 16126.79,-418.42"/>
<polygon fill="black" stroke="black" points="16130.29,-418.31 16126.51,-408.41 16123.29,-418.51 16130.29,-418.31"/>
</g>
<!-- expert_62_ffn2&#45;&gt;expert_agg -->
<g id="edge272" class="edge">
<title>expert_62_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M16027.4,-369.98C15890.06,-345.84 15633.11,-304.17 15412,-288 14723.86,-237.68 9724.11,-233.37 8652.76,-233.03"/>
<polygon fill="black" stroke="black" points="8652.65,-229.53 8642.64,-233.02 8652.64,-236.53 8652.65,-229.53"/>
</g>
<!-- expert_63 -->
<g id="node266" class="node">
<title>expert_63</title>
<polygon fill="lightcoral" stroke="black" points="16552,-637.87 16322,-637.87 16322,-599.87 16552,-599.87 16552,-637.87"/>
<text text-anchor="middle" x="16437" y="-626.67" font-family="Arial" font-size="9.00">Expert 63</text>
<text text-anchor="middle" x="16437" y="-616.67" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="16437" y="-606.67" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_63_ffn1 -->
<g id="node267" class="node">
<title>expert_63_ffn1</title>
<polygon fill="lightgreen" stroke="black" points="16505.5,-556 16280.5,-556 16280.5,-518 16505.5,-518 16505.5,-556"/>
<text text-anchor="middle" x="16393" y="-544.8" font-family="Arial" font-size="9.00">Expert 63 FFN1</text>
<text text-anchor="middle" x="16393" y="-534.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="16393" y="-524.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_63&#45;&gt;expert_63_ffn1 -->
<g id="edge273" class="edge">
<title>expert_63&#45;&gt;expert_63_ffn1</title>
<path fill="none" stroke="black" d="M16427.02,-599.75C16421.33,-589.43 16414.11,-576.32 16407.78,-564.83"/>
<polygon fill="black" stroke="black" points="16410.84,-563.12 16402.94,-556.05 16404.7,-566.5 16410.84,-563.12"/>
</g>
<!-- expert_63_gelu -->
<g id="node268" class="node">
<title>expert_63_gelu</title>
<polygon fill="lightgreen" stroke="black" points="16486.5,-482 16261.5,-482 16261.5,-444 16486.5,-444 16486.5,-482"/>
<text text-anchor="middle" x="16374" y="-470.8" font-family="Arial" font-size="9.00">Expert 63 GELU</text>
<text text-anchor="middle" x="16374" y="-460.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="16374" y="-450.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
</g>
<!-- expert_63_ffn1&#45;&gt;expert_63_gelu -->
<g id="edge274" class="edge">
<title>expert_63_ffn1&#45;&gt;expert_63_gelu</title>
<path fill="none" stroke="black" d="M16388.21,-517.83C16386.15,-510.05 16383.7,-500.77 16381.42,-492.13"/>
<polygon fill="black" stroke="black" points="16384.79,-491.19 16378.86,-482.41 16378.03,-492.98 16384.79,-491.19"/>
</g>
<!-- expert_63_ffn2 -->
<g id="node269" class="node">
<title>expert_63_ffn2</title>
<polygon fill="lightgreen" stroke="black" points="16489,-408 16259,-408 16259,-370 16489,-370 16489,-408"/>
<text text-anchor="middle" x="16374" y="-396.8" font-family="Arial" font-size="9.00">Expert 63 FFN2</text>
<text text-anchor="middle" x="16374" y="-386.8" font-family="Arial" font-size="9.00">[batch_size=?, seq_len=1024, ffn_hidden=2048]</text>
<text text-anchor="middle" x="16374" y="-376.8" font-family="Arial" font-size="9.00">→ [batch_size=?, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- expert_63_gelu&#45;&gt;expert_63_ffn2 -->
<g id="edge275" class="edge">
<title>expert_63_gelu&#45;&gt;expert_63_ffn2</title>
<path fill="none" stroke="black" d="M16374,-443.83C16374,-436.13 16374,-426.97 16374,-418.42"/>
<polygon fill="black" stroke="black" points="16377.5,-418.41 16374,-408.41 16370.5,-418.41 16377.5,-418.41"/>
</g>
<!-- expert_63_ffn2&#45;&gt;expert_agg -->
<g id="edge276" class="edge">
<title>expert_63_ffn2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M16270.14,-369.98C16125.12,-345.8 15853.51,-304.03 15620,-288 14909.82,-239.24 9743.83,-233.71 8652.95,-233.08"/>
<polygon fill="black" stroke="black" points="8652.65,-229.58 8642.65,-233.07 8652.65,-236.58 8652.65,-229.58"/>
</g>
<!-- expert_agg&#45;&gt;weighted_sum -->
<g id="edge277" class="edge">
<title>expert_agg&#45;&gt;weighted_sum</title>
<path fill="none" stroke="black" d="M8630.54,-226.14C9294.95,-208.16 11611.89,-145.44 12312.67,-126.48"/>
<polygon fill="black" stroke="black" points="12312.97,-129.97 12322.87,-126.2 12312.78,-122.97 12312.97,-129.97"/>
</g>
<!-- output -->
<g id="node272" class="node">
<title>output</title>
<polygon fill="white" stroke="black" points="12630,-36 12400,-36 12400,0 12630,0 12630,-36"/>
<text text-anchor="middle" x="12515" y="-20.8" font-family="Arial" font-size="9.00">Layer Output</text>
<text text-anchor="middle" x="12515" y="-10.8" font-family="Arial" font-size="9.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- weighted_sum&#45;&gt;output -->
<g id="edge279" class="edge">
<title>weighted_sum&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12515,-71.93C12515,-63.15 12515,-54.25 12515,-46.32"/>
<polygon fill="black" stroke="black" points="12518.5,-46.21 12515,-36.21 12511.5,-46.21 12518.5,-46.21"/>
</g>
</g>
</svg>
