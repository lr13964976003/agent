<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="30000pt" height="90pt"
 viewBox="0.00 0.00 7200.00 21.70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.05 0.05) rotate(0) translate(4 1909.68)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1909.68 634805,-1909.68 634805,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_stage_0</title>
<path fill="orange" stroke="black" d="M20,-73C20,-73 155472,-73 155472,-73 155478,-73 155484,-79 155484,-85 155484,-85 155484,-1684.68 155484,-1684.68 155484,-1690.68 155478,-1696.68 155472,-1696.68 155472,-1696.68 20,-1696.68 20,-1696.68 14,-1696.68 8,-1690.68 8,-1684.68 8,-1684.68 8,-85 8,-85 8,-79 14,-73 20,-73"/>
<text text-anchor="middle" x="77746" y="-1684.68" font-family="Arial Bold" font-size="10.00">Pipeline Stage 0 (Layers 0&#45;3)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0</title>
<path fill="lightgray" stroke="black" d="M119884,-81C119884,-81 155464,-81 155464,-81 155470,-81 155476,-87 155476,-93 155476,-93 155476,-1657.68 155476,-1657.68 155476,-1663.68 155470,-1669.68 155464,-1669.68 155464,-1669.68 119884,-1669.68 119884,-1669.68 119878,-1669.68 119872,-1663.68 119872,-1657.68 119872,-1657.68 119872,-93 119872,-93 119872,-87 119878,-81 119884,-81"/>
<text text-anchor="middle" x="137674" y="-1657.68" font-family="Arial Bold" font-size="10.00">Layer 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer0_expert0</title>
<path fill="lightcyan" stroke="black" d="M154836,-89C154836,-89 155456,-89 155456,-89 155462,-89 155468,-95 155468,-101 155468,-101 155468,-1608.68 155468,-1608.68 155468,-1614.68 155462,-1620.68 155456,-1620.68 155456,-1620.68 154836,-1620.68 154836,-1620.68 154830,-1620.68 154824,-1614.68 154824,-1608.68 154824,-1608.68 154824,-101 154824,-101 154824,-95 154830,-89 154836,-89"/>
<text text-anchor="middle" x="155146" y="-1608.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 0)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer0_expert1</title>
<path fill="lightcyan" stroke="black" d="M149844,-1519.68C149844,-1519.68 154804,-1519.68 154804,-1519.68 154810,-1519.68 154816,-1525.68 154816,-1531.68 154816,-1531.68 154816,-1630.68 154816,-1630.68 154816,-1636.68 154810,-1642.68 154804,-1642.68 154804,-1642.68 149844,-1642.68 149844,-1642.68 149838,-1642.68 149832,-1636.68 149832,-1630.68 149832,-1630.68 149832,-1531.68 149832,-1531.68 149832,-1525.68 149838,-1519.68 149844,-1519.68"/>
<text text-anchor="middle" x="152324" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 2)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer0_expert2</title>
<path fill="lightcyan" stroke="black" d="M144852,-1519.68C144852,-1519.68 149812,-1519.68 149812,-1519.68 149818,-1519.68 149824,-1525.68 149824,-1531.68 149824,-1531.68 149824,-1630.68 149824,-1630.68 149824,-1636.68 149818,-1642.68 149812,-1642.68 149812,-1642.68 144852,-1642.68 144852,-1642.68 144846,-1642.68 144840,-1636.68 144840,-1630.68 144840,-1630.68 144840,-1531.68 144840,-1531.68 144840,-1525.68 144846,-1519.68 144852,-1519.68"/>
<text text-anchor="middle" x="147332" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 4)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer0_expert3</title>
<path fill="lightcyan" stroke="black" d="M139860,-1519.68C139860,-1519.68 144820,-1519.68 144820,-1519.68 144826,-1519.68 144832,-1525.68 144832,-1531.68 144832,-1531.68 144832,-1630.68 144832,-1630.68 144832,-1636.68 144826,-1642.68 144820,-1642.68 144820,-1642.68 139860,-1642.68 139860,-1642.68 139854,-1642.68 139848,-1636.68 139848,-1630.68 139848,-1630.68 139848,-1531.68 139848,-1531.68 139848,-1525.68 139854,-1519.68 139860,-1519.68"/>
<text text-anchor="middle" x="142340" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 6)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer0_expert4</title>
<path fill="lightcyan" stroke="black" d="M134868,-1519.68C134868,-1519.68 139828,-1519.68 139828,-1519.68 139834,-1519.68 139840,-1525.68 139840,-1531.68 139840,-1531.68 139840,-1630.68 139840,-1630.68 139840,-1636.68 139834,-1642.68 139828,-1642.68 139828,-1642.68 134868,-1642.68 134868,-1642.68 134862,-1642.68 134856,-1636.68 134856,-1630.68 134856,-1630.68 134856,-1531.68 134856,-1531.68 134856,-1525.68 134862,-1519.68 134868,-1519.68"/>
<text text-anchor="middle" x="137348" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 8)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer0_expert5</title>
<path fill="lightcyan" stroke="black" d="M129876,-1519.68C129876,-1519.68 134836,-1519.68 134836,-1519.68 134842,-1519.68 134848,-1525.68 134848,-1531.68 134848,-1531.68 134848,-1630.68 134848,-1630.68 134848,-1636.68 134842,-1642.68 134836,-1642.68 134836,-1642.68 129876,-1642.68 129876,-1642.68 129870,-1642.68 129864,-1636.68 129864,-1630.68 129864,-1630.68 129864,-1531.68 129864,-1531.68 129864,-1525.68 129870,-1519.68 129876,-1519.68"/>
<text text-anchor="middle" x="132356" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 10)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer0_expert6</title>
<path fill="lightcyan" stroke="black" d="M124884,-1519.68C124884,-1519.68 129844,-1519.68 129844,-1519.68 129850,-1519.68 129856,-1525.68 129856,-1531.68 129856,-1531.68 129856,-1630.68 129856,-1630.68 129856,-1636.68 129850,-1642.68 129844,-1642.68 129844,-1642.68 124884,-1642.68 124884,-1642.68 124878,-1642.68 124872,-1636.68 124872,-1630.68 124872,-1630.68 124872,-1531.68 124872,-1531.68 124872,-1525.68 124878,-1519.68 124884,-1519.68"/>
<text text-anchor="middle" x="127364" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 12)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer0_expert7</title>
<path fill="lightcyan" stroke="black" d="M119892,-1519.68C119892,-1519.68 124852,-1519.68 124852,-1519.68 124858,-1519.68 124864,-1525.68 124864,-1531.68 124864,-1531.68 124864,-1630.68 124864,-1630.68 124864,-1636.68 124858,-1642.68 124852,-1642.68 124852,-1642.68 119892,-1642.68 119892,-1642.68 119886,-1642.68 119880,-1636.68 119880,-1630.68 119880,-1630.68 119880,-1531.68 119880,-1531.68 119880,-1525.68 119886,-1519.68 119892,-1519.68"/>
<text text-anchor="middle" x="122372" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 14)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_1</title>
<path fill="lightgray" stroke="black" d="M79932,-1511.68C79932,-1511.68 119852,-1511.68 119852,-1511.68 119858,-1511.68 119864,-1517.68 119864,-1523.68 119864,-1523.68 119864,-1657.68 119864,-1657.68 119864,-1663.68 119858,-1669.68 119852,-1669.68 119852,-1669.68 79932,-1669.68 79932,-1669.68 79926,-1669.68 79920,-1663.68 79920,-1657.68 79920,-1657.68 79920,-1523.68 79920,-1523.68 79920,-1517.68 79926,-1511.68 79932,-1511.68"/>
<text text-anchor="middle" x="99892" y="-1657.68" font-family="Arial Bold" font-size="10.00">Layer 1</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer1_expert0</title>
<path fill="lightcyan" stroke="black" d="M114884,-1519.68C114884,-1519.68 119844,-1519.68 119844,-1519.68 119850,-1519.68 119856,-1525.68 119856,-1531.68 119856,-1531.68 119856,-1630.68 119856,-1630.68 119856,-1636.68 119850,-1642.68 119844,-1642.68 119844,-1642.68 114884,-1642.68 114884,-1642.68 114878,-1642.68 114872,-1636.68 114872,-1630.68 114872,-1630.68 114872,-1531.68 114872,-1531.68 114872,-1525.68 114878,-1519.68 114884,-1519.68"/>
<text text-anchor="middle" x="117364" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 0)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer1_expert1</title>
<path fill="lightcyan" stroke="black" d="M109892,-1519.68C109892,-1519.68 114852,-1519.68 114852,-1519.68 114858,-1519.68 114864,-1525.68 114864,-1531.68 114864,-1531.68 114864,-1630.68 114864,-1630.68 114864,-1636.68 114858,-1642.68 114852,-1642.68 114852,-1642.68 109892,-1642.68 109892,-1642.68 109886,-1642.68 109880,-1636.68 109880,-1630.68 109880,-1630.68 109880,-1531.68 109880,-1531.68 109880,-1525.68 109886,-1519.68 109892,-1519.68"/>
<text text-anchor="middle" x="112372" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 2)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer1_expert2</title>
<path fill="lightcyan" stroke="black" d="M104900,-1519.68C104900,-1519.68 109860,-1519.68 109860,-1519.68 109866,-1519.68 109872,-1525.68 109872,-1531.68 109872,-1531.68 109872,-1630.68 109872,-1630.68 109872,-1636.68 109866,-1642.68 109860,-1642.68 109860,-1642.68 104900,-1642.68 104900,-1642.68 104894,-1642.68 104888,-1636.68 104888,-1630.68 104888,-1630.68 104888,-1531.68 104888,-1531.68 104888,-1525.68 104894,-1519.68 104900,-1519.68"/>
<text text-anchor="middle" x="107380" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 4)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer1_expert3</title>
<path fill="lightcyan" stroke="black" d="M99908,-1519.68C99908,-1519.68 104868,-1519.68 104868,-1519.68 104874,-1519.68 104880,-1525.68 104880,-1531.68 104880,-1531.68 104880,-1630.68 104880,-1630.68 104880,-1636.68 104874,-1642.68 104868,-1642.68 104868,-1642.68 99908,-1642.68 99908,-1642.68 99902,-1642.68 99896,-1636.68 99896,-1630.68 99896,-1630.68 99896,-1531.68 99896,-1531.68 99896,-1525.68 99902,-1519.68 99908,-1519.68"/>
<text text-anchor="middle" x="102388" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 6)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer1_expert4</title>
<path fill="lightcyan" stroke="black" d="M94916,-1519.68C94916,-1519.68 99876,-1519.68 99876,-1519.68 99882,-1519.68 99888,-1525.68 99888,-1531.68 99888,-1531.68 99888,-1630.68 99888,-1630.68 99888,-1636.68 99882,-1642.68 99876,-1642.68 99876,-1642.68 94916,-1642.68 94916,-1642.68 94910,-1642.68 94904,-1636.68 94904,-1630.68 94904,-1630.68 94904,-1531.68 94904,-1531.68 94904,-1525.68 94910,-1519.68 94916,-1519.68"/>
<text text-anchor="middle" x="97396" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 8)</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_layer1_expert5</title>
<path fill="lightcyan" stroke="black" d="M89924,-1519.68C89924,-1519.68 94884,-1519.68 94884,-1519.68 94890,-1519.68 94896,-1525.68 94896,-1531.68 94896,-1531.68 94896,-1630.68 94896,-1630.68 94896,-1636.68 94890,-1642.68 94884,-1642.68 94884,-1642.68 89924,-1642.68 89924,-1642.68 89918,-1642.68 89912,-1636.68 89912,-1630.68 89912,-1630.68 89912,-1531.68 89912,-1531.68 89912,-1525.68 89918,-1519.68 89924,-1519.68"/>
<text text-anchor="middle" x="92404" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 10)</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_layer1_expert6</title>
<path fill="lightcyan" stroke="black" d="M84932,-1519.68C84932,-1519.68 89892,-1519.68 89892,-1519.68 89898,-1519.68 89904,-1525.68 89904,-1531.68 89904,-1531.68 89904,-1630.68 89904,-1630.68 89904,-1636.68 89898,-1642.68 89892,-1642.68 89892,-1642.68 84932,-1642.68 84932,-1642.68 84926,-1642.68 84920,-1636.68 84920,-1630.68 84920,-1630.68 84920,-1531.68 84920,-1531.68 84920,-1525.68 84926,-1519.68 84932,-1519.68"/>
<text text-anchor="middle" x="87412" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 12)</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_layer1_expert7</title>
<path fill="lightcyan" stroke="black" d="M79940,-1519.68C79940,-1519.68 84900,-1519.68 84900,-1519.68 84906,-1519.68 84912,-1525.68 84912,-1531.68 84912,-1531.68 84912,-1630.68 84912,-1630.68 84912,-1636.68 84906,-1642.68 84900,-1642.68 84900,-1642.68 79940,-1642.68 79940,-1642.68 79934,-1642.68 79928,-1636.68 79928,-1630.68 79928,-1630.68 79928,-1531.68 79928,-1531.68 79928,-1525.68 79934,-1519.68 79940,-1519.68"/>
<text text-anchor="middle" x="82420" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 14)</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_layer_2</title>
<path fill="lightgray" stroke="black" d="M39980,-1511.68C39980,-1511.68 79900,-1511.68 79900,-1511.68 79906,-1511.68 79912,-1517.68 79912,-1523.68 79912,-1523.68 79912,-1657.68 79912,-1657.68 79912,-1663.68 79906,-1669.68 79900,-1669.68 79900,-1669.68 39980,-1669.68 39980,-1669.68 39974,-1669.68 39968,-1663.68 39968,-1657.68 39968,-1657.68 39968,-1523.68 39968,-1523.68 39968,-1517.68 39974,-1511.68 39980,-1511.68"/>
<text text-anchor="middle" x="59940" y="-1657.68" font-family="Arial Bold" font-size="10.00">Layer 2</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_layer2_expert0</title>
<path fill="lightcyan" stroke="black" d="M74932,-1519.68C74932,-1519.68 79892,-1519.68 79892,-1519.68 79898,-1519.68 79904,-1525.68 79904,-1531.68 79904,-1531.68 79904,-1630.68 79904,-1630.68 79904,-1636.68 79898,-1642.68 79892,-1642.68 79892,-1642.68 74932,-1642.68 74932,-1642.68 74926,-1642.68 74920,-1636.68 74920,-1630.68 74920,-1630.68 74920,-1531.68 74920,-1531.68 74920,-1525.68 74926,-1519.68 74932,-1519.68"/>
<text text-anchor="middle" x="77412" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 0)</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_layer2_expert1</title>
<path fill="lightcyan" stroke="black" d="M69940,-1519.68C69940,-1519.68 74900,-1519.68 74900,-1519.68 74906,-1519.68 74912,-1525.68 74912,-1531.68 74912,-1531.68 74912,-1630.68 74912,-1630.68 74912,-1636.68 74906,-1642.68 74900,-1642.68 74900,-1642.68 69940,-1642.68 69940,-1642.68 69934,-1642.68 69928,-1636.68 69928,-1630.68 69928,-1630.68 69928,-1531.68 69928,-1531.68 69928,-1525.68 69934,-1519.68 69940,-1519.68"/>
<text text-anchor="middle" x="72420" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 2)</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_layer2_expert2</title>
<path fill="lightcyan" stroke="black" d="M64948,-1519.68C64948,-1519.68 69908,-1519.68 69908,-1519.68 69914,-1519.68 69920,-1525.68 69920,-1531.68 69920,-1531.68 69920,-1630.68 69920,-1630.68 69920,-1636.68 69914,-1642.68 69908,-1642.68 69908,-1642.68 64948,-1642.68 64948,-1642.68 64942,-1642.68 64936,-1636.68 64936,-1630.68 64936,-1630.68 64936,-1531.68 64936,-1531.68 64936,-1525.68 64942,-1519.68 64948,-1519.68"/>
<text text-anchor="middle" x="67428" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 4)</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_layer2_expert3</title>
<path fill="lightcyan" stroke="black" d="M59956,-1519.68C59956,-1519.68 64916,-1519.68 64916,-1519.68 64922,-1519.68 64928,-1525.68 64928,-1531.68 64928,-1531.68 64928,-1630.68 64928,-1630.68 64928,-1636.68 64922,-1642.68 64916,-1642.68 64916,-1642.68 59956,-1642.68 59956,-1642.68 59950,-1642.68 59944,-1636.68 59944,-1630.68 59944,-1630.68 59944,-1531.68 59944,-1531.68 59944,-1525.68 59950,-1519.68 59956,-1519.68"/>
<text text-anchor="middle" x="62436" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 6)</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_layer2_expert4</title>
<path fill="lightcyan" stroke="black" d="M54964,-1519.68C54964,-1519.68 59924,-1519.68 59924,-1519.68 59930,-1519.68 59936,-1525.68 59936,-1531.68 59936,-1531.68 59936,-1630.68 59936,-1630.68 59936,-1636.68 59930,-1642.68 59924,-1642.68 59924,-1642.68 54964,-1642.68 54964,-1642.68 54958,-1642.68 54952,-1636.68 54952,-1630.68 54952,-1630.68 54952,-1531.68 54952,-1531.68 54952,-1525.68 54958,-1519.68 54964,-1519.68"/>
<text text-anchor="middle" x="57444" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 8)</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_layer2_expert5</title>
<path fill="lightcyan" stroke="black" d="M49972,-1519.68C49972,-1519.68 54932,-1519.68 54932,-1519.68 54938,-1519.68 54944,-1525.68 54944,-1531.68 54944,-1531.68 54944,-1630.68 54944,-1630.68 54944,-1636.68 54938,-1642.68 54932,-1642.68 54932,-1642.68 49972,-1642.68 49972,-1642.68 49966,-1642.68 49960,-1636.68 49960,-1630.68 49960,-1630.68 49960,-1531.68 49960,-1531.68 49960,-1525.68 49966,-1519.68 49972,-1519.68"/>
<text text-anchor="middle" x="52452" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 10)</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_layer2_expert6</title>
<path fill="lightcyan" stroke="black" d="M44980,-1519.68C44980,-1519.68 49940,-1519.68 49940,-1519.68 49946,-1519.68 49952,-1525.68 49952,-1531.68 49952,-1531.68 49952,-1630.68 49952,-1630.68 49952,-1636.68 49946,-1642.68 49940,-1642.68 49940,-1642.68 44980,-1642.68 44980,-1642.68 44974,-1642.68 44968,-1636.68 44968,-1630.68 44968,-1630.68 44968,-1531.68 44968,-1531.68 44968,-1525.68 44974,-1519.68 44980,-1519.68"/>
<text text-anchor="middle" x="47460" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 12)</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_layer2_expert7</title>
<path fill="lightcyan" stroke="black" d="M39988,-1519.68C39988,-1519.68 44948,-1519.68 44948,-1519.68 44954,-1519.68 44960,-1525.68 44960,-1531.68 44960,-1531.68 44960,-1630.68 44960,-1630.68 44960,-1636.68 44954,-1642.68 44948,-1642.68 44948,-1642.68 39988,-1642.68 39988,-1642.68 39982,-1642.68 39976,-1636.68 39976,-1630.68 39976,-1630.68 39976,-1531.68 39976,-1531.68 39976,-1525.68 39982,-1519.68 39988,-1519.68"/>
<text text-anchor="middle" x="42468" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 14)</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_layer_3</title>
<path fill="lightgray" stroke="black" d="M28,-1511.68C28,-1511.68 39948,-1511.68 39948,-1511.68 39954,-1511.68 39960,-1517.68 39960,-1523.68 39960,-1523.68 39960,-1657.68 39960,-1657.68 39960,-1663.68 39954,-1669.68 39948,-1669.68 39948,-1669.68 28,-1669.68 28,-1669.68 22,-1669.68 16,-1663.68 16,-1657.68 16,-1657.68 16,-1523.68 16,-1523.68 16,-1517.68 22,-1511.68 28,-1511.68"/>
<text text-anchor="middle" x="19988" y="-1657.68" font-family="Arial Bold" font-size="10.00">Layer 3</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_layer3_expert0</title>
<path fill="lightcyan" stroke="black" d="M34980,-1519.68C34980,-1519.68 39940,-1519.68 39940,-1519.68 39946,-1519.68 39952,-1525.68 39952,-1531.68 39952,-1531.68 39952,-1630.68 39952,-1630.68 39952,-1636.68 39946,-1642.68 39940,-1642.68 39940,-1642.68 34980,-1642.68 34980,-1642.68 34974,-1642.68 34968,-1636.68 34968,-1630.68 34968,-1630.68 34968,-1531.68 34968,-1531.68 34968,-1525.68 34974,-1519.68 34980,-1519.68"/>
<text text-anchor="middle" x="37460" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 0)</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_layer3_expert1</title>
<path fill="lightcyan" stroke="black" d="M29988,-1519.68C29988,-1519.68 34948,-1519.68 34948,-1519.68 34954,-1519.68 34960,-1525.68 34960,-1531.68 34960,-1531.68 34960,-1630.68 34960,-1630.68 34960,-1636.68 34954,-1642.68 34948,-1642.68 34948,-1642.68 29988,-1642.68 29988,-1642.68 29982,-1642.68 29976,-1636.68 29976,-1630.68 29976,-1630.68 29976,-1531.68 29976,-1531.68 29976,-1525.68 29982,-1519.68 29988,-1519.68"/>
<text text-anchor="middle" x="32468" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 2)</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_layer3_expert2</title>
<path fill="lightcyan" stroke="black" d="M24996,-1519.68C24996,-1519.68 29956,-1519.68 29956,-1519.68 29962,-1519.68 29968,-1525.68 29968,-1531.68 29968,-1531.68 29968,-1630.68 29968,-1630.68 29968,-1636.68 29962,-1642.68 29956,-1642.68 29956,-1642.68 24996,-1642.68 24996,-1642.68 24990,-1642.68 24984,-1636.68 24984,-1630.68 24984,-1630.68 24984,-1531.68 24984,-1531.68 24984,-1525.68 24990,-1519.68 24996,-1519.68"/>
<text text-anchor="middle" x="27476" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 4)</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_layer3_expert3</title>
<path fill="lightcyan" stroke="black" d="M20004,-1519.68C20004,-1519.68 24964,-1519.68 24964,-1519.68 24970,-1519.68 24976,-1525.68 24976,-1531.68 24976,-1531.68 24976,-1630.68 24976,-1630.68 24976,-1636.68 24970,-1642.68 24964,-1642.68 24964,-1642.68 20004,-1642.68 20004,-1642.68 19998,-1642.68 19992,-1636.68 19992,-1630.68 19992,-1630.68 19992,-1531.68 19992,-1531.68 19992,-1525.68 19998,-1519.68 20004,-1519.68"/>
<text text-anchor="middle" x="22484" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 6)</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_layer3_expert4</title>
<path fill="lightcyan" stroke="black" d="M15012,-1519.68C15012,-1519.68 19972,-1519.68 19972,-1519.68 19978,-1519.68 19984,-1525.68 19984,-1531.68 19984,-1531.68 19984,-1630.68 19984,-1630.68 19984,-1636.68 19978,-1642.68 19972,-1642.68 19972,-1642.68 15012,-1642.68 15012,-1642.68 15006,-1642.68 15000,-1636.68 15000,-1630.68 15000,-1630.68 15000,-1531.68 15000,-1531.68 15000,-1525.68 15006,-1519.68 15012,-1519.68"/>
<text text-anchor="middle" x="17492" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 8)</text>
</g>
<g id="clust35" class="cluster">
<title>cluster_layer3_expert5</title>
<path fill="lightcyan" stroke="black" d="M10020,-1519.68C10020,-1519.68 14980,-1519.68 14980,-1519.68 14986,-1519.68 14992,-1525.68 14992,-1531.68 14992,-1531.68 14992,-1630.68 14992,-1630.68 14992,-1636.68 14986,-1642.68 14980,-1642.68 14980,-1642.68 10020,-1642.68 10020,-1642.68 10014,-1642.68 10008,-1636.68 10008,-1630.68 10008,-1630.68 10008,-1531.68 10008,-1531.68 10008,-1525.68 10014,-1519.68 10020,-1519.68"/>
<text text-anchor="middle" x="12500" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 10)</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_layer3_expert6</title>
<path fill="lightcyan" stroke="black" d="M5028,-1519.68C5028,-1519.68 9988,-1519.68 9988,-1519.68 9994,-1519.68 10000,-1525.68 10000,-1531.68 10000,-1531.68 10000,-1630.68 10000,-1630.68 10000,-1636.68 9994,-1642.68 9988,-1642.68 9988,-1642.68 5028,-1642.68 5028,-1642.68 5022,-1642.68 5016,-1636.68 5016,-1630.68 5016,-1630.68 5016,-1531.68 5016,-1531.68 5016,-1525.68 5022,-1519.68 5028,-1519.68"/>
<text text-anchor="middle" x="7508" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 12)</text>
</g>
<g id="clust37" class="cluster">
<title>cluster_layer3_expert7</title>
<path fill="lightcyan" stroke="black" d="M36,-1519.68C36,-1519.68 4996,-1519.68 4996,-1519.68 5002,-1519.68 5008,-1525.68 5008,-1531.68 5008,-1531.68 5008,-1630.68 5008,-1630.68 5008,-1636.68 5002,-1642.68 4996,-1642.68 4996,-1642.68 36,-1642.68 36,-1642.68 30,-1642.68 24,-1636.68 24,-1630.68 24,-1630.68 24,-1531.68 24,-1531.68 24,-1525.68 30,-1519.68 36,-1519.68"/>
<text text-anchor="middle" x="2516" y="-1630.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 14)</text>
</g>
<g id="clust38" class="cluster">
<title>cluster_pipeline_stage_1</title>
<path fill="orange" stroke="black" d="M155341,-1704.68C155341,-1704.68 315133,-1704.68 315133,-1704.68 315139,-1704.68 315145,-1710.68 315145,-1716.68 315145,-1716.68 315145,-1885.68 315145,-1885.68 315145,-1891.68 315139,-1897.68 315133,-1897.68 315133,-1897.68 155341,-1897.68 155341,-1897.68 155335,-1897.68 155329,-1891.68 155329,-1885.68 155329,-1885.68 155329,-1716.68 155329,-1716.68 155329,-1710.68 155335,-1704.68 155341,-1704.68"/>
<text text-anchor="middle" x="235237" y="-1885.68" font-family="Arial Bold" font-size="10.00">Pipeline Stage 1 (Layers 4&#45;7)</text>
</g>
<g id="clust39" class="cluster">
<title>cluster_layer_4</title>
<path fill="lightgray" stroke="black" d="M275205,-1712.68C275205,-1712.68 315125,-1712.68 315125,-1712.68 315131,-1712.68 315137,-1718.68 315137,-1724.68 315137,-1724.68 315137,-1858.68 315137,-1858.68 315137,-1864.68 315131,-1870.68 315125,-1870.68 315125,-1870.68 275205,-1870.68 275205,-1870.68 275199,-1870.68 275193,-1864.68 275193,-1858.68 275193,-1858.68 275193,-1724.68 275193,-1724.68 275193,-1718.68 275199,-1712.68 275205,-1712.68"/>
<text text-anchor="middle" x="295165" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 4</text>
</g>
<g id="clust40" class="cluster">
<title>cluster_layer4_expert0</title>
<path fill="lightcyan" stroke="black" d="M310157,-1720.68C310157,-1720.68 315117,-1720.68 315117,-1720.68 315123,-1720.68 315129,-1726.68 315129,-1732.68 315129,-1732.68 315129,-1831.68 315129,-1831.68 315129,-1837.68 315123,-1843.68 315117,-1843.68 315117,-1843.68 310157,-1843.68 310157,-1843.68 310151,-1843.68 310145,-1837.68 310145,-1831.68 310145,-1831.68 310145,-1732.68 310145,-1732.68 310145,-1726.68 310151,-1720.68 310157,-1720.68"/>
<text text-anchor="middle" x="312637" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 16)</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_layer4_expert1</title>
<path fill="lightcyan" stroke="black" d="M305165,-1720.68C305165,-1720.68 310125,-1720.68 310125,-1720.68 310131,-1720.68 310137,-1726.68 310137,-1732.68 310137,-1732.68 310137,-1831.68 310137,-1831.68 310137,-1837.68 310131,-1843.68 310125,-1843.68 310125,-1843.68 305165,-1843.68 305165,-1843.68 305159,-1843.68 305153,-1837.68 305153,-1831.68 305153,-1831.68 305153,-1732.68 305153,-1732.68 305153,-1726.68 305159,-1720.68 305165,-1720.68"/>
<text text-anchor="middle" x="307645" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 18)</text>
</g>
<g id="clust42" class="cluster">
<title>cluster_layer4_expert2</title>
<path fill="lightcyan" stroke="black" d="M300173,-1720.68C300173,-1720.68 305133,-1720.68 305133,-1720.68 305139,-1720.68 305145,-1726.68 305145,-1732.68 305145,-1732.68 305145,-1831.68 305145,-1831.68 305145,-1837.68 305139,-1843.68 305133,-1843.68 305133,-1843.68 300173,-1843.68 300173,-1843.68 300167,-1843.68 300161,-1837.68 300161,-1831.68 300161,-1831.68 300161,-1732.68 300161,-1732.68 300161,-1726.68 300167,-1720.68 300173,-1720.68"/>
<text text-anchor="middle" x="302653" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 20)</text>
</g>
<g id="clust43" class="cluster">
<title>cluster_layer4_expert3</title>
<path fill="lightcyan" stroke="black" d="M295181,-1720.68C295181,-1720.68 300141,-1720.68 300141,-1720.68 300147,-1720.68 300153,-1726.68 300153,-1732.68 300153,-1732.68 300153,-1831.68 300153,-1831.68 300153,-1837.68 300147,-1843.68 300141,-1843.68 300141,-1843.68 295181,-1843.68 295181,-1843.68 295175,-1843.68 295169,-1837.68 295169,-1831.68 295169,-1831.68 295169,-1732.68 295169,-1732.68 295169,-1726.68 295175,-1720.68 295181,-1720.68"/>
<text text-anchor="middle" x="297661" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 22)</text>
</g>
<g id="clust44" class="cluster">
<title>cluster_layer4_expert4</title>
<path fill="lightcyan" stroke="black" d="M290189,-1720.68C290189,-1720.68 295149,-1720.68 295149,-1720.68 295155,-1720.68 295161,-1726.68 295161,-1732.68 295161,-1732.68 295161,-1831.68 295161,-1831.68 295161,-1837.68 295155,-1843.68 295149,-1843.68 295149,-1843.68 290189,-1843.68 290189,-1843.68 290183,-1843.68 290177,-1837.68 290177,-1831.68 290177,-1831.68 290177,-1732.68 290177,-1732.68 290177,-1726.68 290183,-1720.68 290189,-1720.68"/>
<text text-anchor="middle" x="292669" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 24)</text>
</g>
<g id="clust45" class="cluster">
<title>cluster_layer4_expert5</title>
<path fill="lightcyan" stroke="black" d="M285197,-1720.68C285197,-1720.68 290157,-1720.68 290157,-1720.68 290163,-1720.68 290169,-1726.68 290169,-1732.68 290169,-1732.68 290169,-1831.68 290169,-1831.68 290169,-1837.68 290163,-1843.68 290157,-1843.68 290157,-1843.68 285197,-1843.68 285197,-1843.68 285191,-1843.68 285185,-1837.68 285185,-1831.68 285185,-1831.68 285185,-1732.68 285185,-1732.68 285185,-1726.68 285191,-1720.68 285197,-1720.68"/>
<text text-anchor="middle" x="287677" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 26)</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_layer4_expert6</title>
<path fill="lightcyan" stroke="black" d="M280205,-1720.68C280205,-1720.68 285165,-1720.68 285165,-1720.68 285171,-1720.68 285177,-1726.68 285177,-1732.68 285177,-1732.68 285177,-1831.68 285177,-1831.68 285177,-1837.68 285171,-1843.68 285165,-1843.68 285165,-1843.68 280205,-1843.68 280205,-1843.68 280199,-1843.68 280193,-1837.68 280193,-1831.68 280193,-1831.68 280193,-1732.68 280193,-1732.68 280193,-1726.68 280199,-1720.68 280205,-1720.68"/>
<text text-anchor="middle" x="282685" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 28)</text>
</g>
<g id="clust47" class="cluster">
<title>cluster_layer4_expert7</title>
<path fill="lightcyan" stroke="black" d="M275213,-1720.68C275213,-1720.68 280173,-1720.68 280173,-1720.68 280179,-1720.68 280185,-1726.68 280185,-1732.68 280185,-1732.68 280185,-1831.68 280185,-1831.68 280185,-1837.68 280179,-1843.68 280173,-1843.68 280173,-1843.68 275213,-1843.68 275213,-1843.68 275207,-1843.68 275201,-1837.68 275201,-1831.68 275201,-1831.68 275201,-1732.68 275201,-1732.68 275201,-1726.68 275207,-1720.68 275213,-1720.68"/>
<text text-anchor="middle" x="277693" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 30)</text>
</g>
<g id="clust48" class="cluster">
<title>cluster_layer_5</title>
<path fill="lightgray" stroke="black" d="M235253,-1712.68C235253,-1712.68 275173,-1712.68 275173,-1712.68 275179,-1712.68 275185,-1718.68 275185,-1724.68 275185,-1724.68 275185,-1858.68 275185,-1858.68 275185,-1864.68 275179,-1870.68 275173,-1870.68 275173,-1870.68 235253,-1870.68 235253,-1870.68 235247,-1870.68 235241,-1864.68 235241,-1858.68 235241,-1858.68 235241,-1724.68 235241,-1724.68 235241,-1718.68 235247,-1712.68 235253,-1712.68"/>
<text text-anchor="middle" x="255213" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 5</text>
</g>
<g id="clust49" class="cluster">
<title>cluster_layer5_expert0</title>
<path fill="lightcyan" stroke="black" d="M270205,-1720.68C270205,-1720.68 275165,-1720.68 275165,-1720.68 275171,-1720.68 275177,-1726.68 275177,-1732.68 275177,-1732.68 275177,-1831.68 275177,-1831.68 275177,-1837.68 275171,-1843.68 275165,-1843.68 275165,-1843.68 270205,-1843.68 270205,-1843.68 270199,-1843.68 270193,-1837.68 270193,-1831.68 270193,-1831.68 270193,-1732.68 270193,-1732.68 270193,-1726.68 270199,-1720.68 270205,-1720.68"/>
<text text-anchor="middle" x="272685" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 16)</text>
</g>
<g id="clust50" class="cluster">
<title>cluster_layer5_expert1</title>
<path fill="lightcyan" stroke="black" d="M265213,-1720.68C265213,-1720.68 270173,-1720.68 270173,-1720.68 270179,-1720.68 270185,-1726.68 270185,-1732.68 270185,-1732.68 270185,-1831.68 270185,-1831.68 270185,-1837.68 270179,-1843.68 270173,-1843.68 270173,-1843.68 265213,-1843.68 265213,-1843.68 265207,-1843.68 265201,-1837.68 265201,-1831.68 265201,-1831.68 265201,-1732.68 265201,-1732.68 265201,-1726.68 265207,-1720.68 265213,-1720.68"/>
<text text-anchor="middle" x="267693" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 18)</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_layer5_expert2</title>
<path fill="lightcyan" stroke="black" d="M260221,-1720.68C260221,-1720.68 265181,-1720.68 265181,-1720.68 265187,-1720.68 265193,-1726.68 265193,-1732.68 265193,-1732.68 265193,-1831.68 265193,-1831.68 265193,-1837.68 265187,-1843.68 265181,-1843.68 265181,-1843.68 260221,-1843.68 260221,-1843.68 260215,-1843.68 260209,-1837.68 260209,-1831.68 260209,-1831.68 260209,-1732.68 260209,-1732.68 260209,-1726.68 260215,-1720.68 260221,-1720.68"/>
<text text-anchor="middle" x="262701" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 20)</text>
</g>
<g id="clust52" class="cluster">
<title>cluster_layer5_expert3</title>
<path fill="lightcyan" stroke="black" d="M255229,-1720.68C255229,-1720.68 260189,-1720.68 260189,-1720.68 260195,-1720.68 260201,-1726.68 260201,-1732.68 260201,-1732.68 260201,-1831.68 260201,-1831.68 260201,-1837.68 260195,-1843.68 260189,-1843.68 260189,-1843.68 255229,-1843.68 255229,-1843.68 255223,-1843.68 255217,-1837.68 255217,-1831.68 255217,-1831.68 255217,-1732.68 255217,-1732.68 255217,-1726.68 255223,-1720.68 255229,-1720.68"/>
<text text-anchor="middle" x="257709" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 22)</text>
</g>
<g id="clust53" class="cluster">
<title>cluster_layer5_expert4</title>
<path fill="lightcyan" stroke="black" d="M250237,-1720.68C250237,-1720.68 255197,-1720.68 255197,-1720.68 255203,-1720.68 255209,-1726.68 255209,-1732.68 255209,-1732.68 255209,-1831.68 255209,-1831.68 255209,-1837.68 255203,-1843.68 255197,-1843.68 255197,-1843.68 250237,-1843.68 250237,-1843.68 250231,-1843.68 250225,-1837.68 250225,-1831.68 250225,-1831.68 250225,-1732.68 250225,-1732.68 250225,-1726.68 250231,-1720.68 250237,-1720.68"/>
<text text-anchor="middle" x="252717" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 24)</text>
</g>
<g id="clust54" class="cluster">
<title>cluster_layer5_expert5</title>
<path fill="lightcyan" stroke="black" d="M245245,-1720.68C245245,-1720.68 250205,-1720.68 250205,-1720.68 250211,-1720.68 250217,-1726.68 250217,-1732.68 250217,-1732.68 250217,-1831.68 250217,-1831.68 250217,-1837.68 250211,-1843.68 250205,-1843.68 250205,-1843.68 245245,-1843.68 245245,-1843.68 245239,-1843.68 245233,-1837.68 245233,-1831.68 245233,-1831.68 245233,-1732.68 245233,-1732.68 245233,-1726.68 245239,-1720.68 245245,-1720.68"/>
<text text-anchor="middle" x="247725" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 26)</text>
</g>
<g id="clust55" class="cluster">
<title>cluster_layer5_expert6</title>
<path fill="lightcyan" stroke="black" d="M240253,-1720.68C240253,-1720.68 245213,-1720.68 245213,-1720.68 245219,-1720.68 245225,-1726.68 245225,-1732.68 245225,-1732.68 245225,-1831.68 245225,-1831.68 245225,-1837.68 245219,-1843.68 245213,-1843.68 245213,-1843.68 240253,-1843.68 240253,-1843.68 240247,-1843.68 240241,-1837.68 240241,-1831.68 240241,-1831.68 240241,-1732.68 240241,-1732.68 240241,-1726.68 240247,-1720.68 240253,-1720.68"/>
<text text-anchor="middle" x="242733" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 28)</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_layer5_expert7</title>
<path fill="lightcyan" stroke="black" d="M235261,-1720.68C235261,-1720.68 240221,-1720.68 240221,-1720.68 240227,-1720.68 240233,-1726.68 240233,-1732.68 240233,-1732.68 240233,-1831.68 240233,-1831.68 240233,-1837.68 240227,-1843.68 240221,-1843.68 240221,-1843.68 235261,-1843.68 235261,-1843.68 235255,-1843.68 235249,-1837.68 235249,-1831.68 235249,-1831.68 235249,-1732.68 235249,-1732.68 235249,-1726.68 235255,-1720.68 235261,-1720.68"/>
<text text-anchor="middle" x="237741" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 30)</text>
</g>
<g id="clust57" class="cluster">
<title>cluster_layer_6</title>
<path fill="lightgray" stroke="black" d="M195301,-1712.68C195301,-1712.68 235221,-1712.68 235221,-1712.68 235227,-1712.68 235233,-1718.68 235233,-1724.68 235233,-1724.68 235233,-1858.68 235233,-1858.68 235233,-1864.68 235227,-1870.68 235221,-1870.68 235221,-1870.68 195301,-1870.68 195301,-1870.68 195295,-1870.68 195289,-1864.68 195289,-1858.68 195289,-1858.68 195289,-1724.68 195289,-1724.68 195289,-1718.68 195295,-1712.68 195301,-1712.68"/>
<text text-anchor="middle" x="215261" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 6</text>
</g>
<g id="clust58" class="cluster">
<title>cluster_layer6_expert0</title>
<path fill="lightcyan" stroke="black" d="M230253,-1720.68C230253,-1720.68 235213,-1720.68 235213,-1720.68 235219,-1720.68 235225,-1726.68 235225,-1732.68 235225,-1732.68 235225,-1831.68 235225,-1831.68 235225,-1837.68 235219,-1843.68 235213,-1843.68 235213,-1843.68 230253,-1843.68 230253,-1843.68 230247,-1843.68 230241,-1837.68 230241,-1831.68 230241,-1831.68 230241,-1732.68 230241,-1732.68 230241,-1726.68 230247,-1720.68 230253,-1720.68"/>
<text text-anchor="middle" x="232733" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 16)</text>
</g>
<g id="clust59" class="cluster">
<title>cluster_layer6_expert1</title>
<path fill="lightcyan" stroke="black" d="M225261,-1720.68C225261,-1720.68 230221,-1720.68 230221,-1720.68 230227,-1720.68 230233,-1726.68 230233,-1732.68 230233,-1732.68 230233,-1831.68 230233,-1831.68 230233,-1837.68 230227,-1843.68 230221,-1843.68 230221,-1843.68 225261,-1843.68 225261,-1843.68 225255,-1843.68 225249,-1837.68 225249,-1831.68 225249,-1831.68 225249,-1732.68 225249,-1732.68 225249,-1726.68 225255,-1720.68 225261,-1720.68"/>
<text text-anchor="middle" x="227741" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 18)</text>
</g>
<g id="clust60" class="cluster">
<title>cluster_layer6_expert2</title>
<path fill="lightcyan" stroke="black" d="M220269,-1720.68C220269,-1720.68 225229,-1720.68 225229,-1720.68 225235,-1720.68 225241,-1726.68 225241,-1732.68 225241,-1732.68 225241,-1831.68 225241,-1831.68 225241,-1837.68 225235,-1843.68 225229,-1843.68 225229,-1843.68 220269,-1843.68 220269,-1843.68 220263,-1843.68 220257,-1837.68 220257,-1831.68 220257,-1831.68 220257,-1732.68 220257,-1732.68 220257,-1726.68 220263,-1720.68 220269,-1720.68"/>
<text text-anchor="middle" x="222749" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 20)</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_layer6_expert3</title>
<path fill="lightcyan" stroke="black" d="M215277,-1720.68C215277,-1720.68 220237,-1720.68 220237,-1720.68 220243,-1720.68 220249,-1726.68 220249,-1732.68 220249,-1732.68 220249,-1831.68 220249,-1831.68 220249,-1837.68 220243,-1843.68 220237,-1843.68 220237,-1843.68 215277,-1843.68 215277,-1843.68 215271,-1843.68 215265,-1837.68 215265,-1831.68 215265,-1831.68 215265,-1732.68 215265,-1732.68 215265,-1726.68 215271,-1720.68 215277,-1720.68"/>
<text text-anchor="middle" x="217757" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 22)</text>
</g>
<g id="clust62" class="cluster">
<title>cluster_layer6_expert4</title>
<path fill="lightcyan" stroke="black" d="M210285,-1720.68C210285,-1720.68 215245,-1720.68 215245,-1720.68 215251,-1720.68 215257,-1726.68 215257,-1732.68 215257,-1732.68 215257,-1831.68 215257,-1831.68 215257,-1837.68 215251,-1843.68 215245,-1843.68 215245,-1843.68 210285,-1843.68 210285,-1843.68 210279,-1843.68 210273,-1837.68 210273,-1831.68 210273,-1831.68 210273,-1732.68 210273,-1732.68 210273,-1726.68 210279,-1720.68 210285,-1720.68"/>
<text text-anchor="middle" x="212765" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 24)</text>
</g>
<g id="clust63" class="cluster">
<title>cluster_layer6_expert5</title>
<path fill="lightcyan" stroke="black" d="M205293,-1720.68C205293,-1720.68 210253,-1720.68 210253,-1720.68 210259,-1720.68 210265,-1726.68 210265,-1732.68 210265,-1732.68 210265,-1831.68 210265,-1831.68 210265,-1837.68 210259,-1843.68 210253,-1843.68 210253,-1843.68 205293,-1843.68 205293,-1843.68 205287,-1843.68 205281,-1837.68 205281,-1831.68 205281,-1831.68 205281,-1732.68 205281,-1732.68 205281,-1726.68 205287,-1720.68 205293,-1720.68"/>
<text text-anchor="middle" x="207773" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 26)</text>
</g>
<g id="clust64" class="cluster">
<title>cluster_layer6_expert6</title>
<path fill="lightcyan" stroke="black" d="M200301,-1720.68C200301,-1720.68 205261,-1720.68 205261,-1720.68 205267,-1720.68 205273,-1726.68 205273,-1732.68 205273,-1732.68 205273,-1831.68 205273,-1831.68 205273,-1837.68 205267,-1843.68 205261,-1843.68 205261,-1843.68 200301,-1843.68 200301,-1843.68 200295,-1843.68 200289,-1837.68 200289,-1831.68 200289,-1831.68 200289,-1732.68 200289,-1732.68 200289,-1726.68 200295,-1720.68 200301,-1720.68"/>
<text text-anchor="middle" x="202781" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 28)</text>
</g>
<g id="clust65" class="cluster">
<title>cluster_layer6_expert7</title>
<path fill="lightcyan" stroke="black" d="M195309,-1720.68C195309,-1720.68 200269,-1720.68 200269,-1720.68 200275,-1720.68 200281,-1726.68 200281,-1732.68 200281,-1732.68 200281,-1831.68 200281,-1831.68 200281,-1837.68 200275,-1843.68 200269,-1843.68 200269,-1843.68 195309,-1843.68 195309,-1843.68 195303,-1843.68 195297,-1837.68 195297,-1831.68 195297,-1831.68 195297,-1732.68 195297,-1732.68 195297,-1726.68 195303,-1720.68 195309,-1720.68"/>
<text text-anchor="middle" x="197789" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 30)</text>
</g>
<g id="clust66" class="cluster">
<title>cluster_layer_7</title>
<path fill="lightgray" stroke="black" d="M155349,-1712.68C155349,-1712.68 195269,-1712.68 195269,-1712.68 195275,-1712.68 195281,-1718.68 195281,-1724.68 195281,-1724.68 195281,-1858.68 195281,-1858.68 195281,-1864.68 195275,-1870.68 195269,-1870.68 195269,-1870.68 155349,-1870.68 155349,-1870.68 155343,-1870.68 155337,-1864.68 155337,-1858.68 155337,-1858.68 155337,-1724.68 155337,-1724.68 155337,-1718.68 155343,-1712.68 155349,-1712.68"/>
<text text-anchor="middle" x="175309" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 7</text>
</g>
<g id="clust67" class="cluster">
<title>cluster_layer7_expert0</title>
<path fill="lightcyan" stroke="black" d="M190301,-1720.68C190301,-1720.68 195261,-1720.68 195261,-1720.68 195267,-1720.68 195273,-1726.68 195273,-1732.68 195273,-1732.68 195273,-1831.68 195273,-1831.68 195273,-1837.68 195267,-1843.68 195261,-1843.68 195261,-1843.68 190301,-1843.68 190301,-1843.68 190295,-1843.68 190289,-1837.68 190289,-1831.68 190289,-1831.68 190289,-1732.68 190289,-1732.68 190289,-1726.68 190295,-1720.68 190301,-1720.68"/>
<text text-anchor="middle" x="192781" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 16)</text>
</g>
<g id="clust68" class="cluster">
<title>cluster_layer7_expert1</title>
<path fill="lightcyan" stroke="black" d="M185309,-1720.68C185309,-1720.68 190269,-1720.68 190269,-1720.68 190275,-1720.68 190281,-1726.68 190281,-1732.68 190281,-1732.68 190281,-1831.68 190281,-1831.68 190281,-1837.68 190275,-1843.68 190269,-1843.68 190269,-1843.68 185309,-1843.68 185309,-1843.68 185303,-1843.68 185297,-1837.68 185297,-1831.68 185297,-1831.68 185297,-1732.68 185297,-1732.68 185297,-1726.68 185303,-1720.68 185309,-1720.68"/>
<text text-anchor="middle" x="187789" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 18)</text>
</g>
<g id="clust69" class="cluster">
<title>cluster_layer7_expert2</title>
<path fill="lightcyan" stroke="black" d="M180317,-1720.68C180317,-1720.68 185277,-1720.68 185277,-1720.68 185283,-1720.68 185289,-1726.68 185289,-1732.68 185289,-1732.68 185289,-1831.68 185289,-1831.68 185289,-1837.68 185283,-1843.68 185277,-1843.68 185277,-1843.68 180317,-1843.68 180317,-1843.68 180311,-1843.68 180305,-1837.68 180305,-1831.68 180305,-1831.68 180305,-1732.68 180305,-1732.68 180305,-1726.68 180311,-1720.68 180317,-1720.68"/>
<text text-anchor="middle" x="182797" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 20)</text>
</g>
<g id="clust70" class="cluster">
<title>cluster_layer7_expert3</title>
<path fill="lightcyan" stroke="black" d="M175325,-1720.68C175325,-1720.68 180285,-1720.68 180285,-1720.68 180291,-1720.68 180297,-1726.68 180297,-1732.68 180297,-1732.68 180297,-1831.68 180297,-1831.68 180297,-1837.68 180291,-1843.68 180285,-1843.68 180285,-1843.68 175325,-1843.68 175325,-1843.68 175319,-1843.68 175313,-1837.68 175313,-1831.68 175313,-1831.68 175313,-1732.68 175313,-1732.68 175313,-1726.68 175319,-1720.68 175325,-1720.68"/>
<text text-anchor="middle" x="177805" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 22)</text>
</g>
<g id="clust71" class="cluster">
<title>cluster_layer7_expert4</title>
<path fill="lightcyan" stroke="black" d="M170333,-1720.68C170333,-1720.68 175293,-1720.68 175293,-1720.68 175299,-1720.68 175305,-1726.68 175305,-1732.68 175305,-1732.68 175305,-1831.68 175305,-1831.68 175305,-1837.68 175299,-1843.68 175293,-1843.68 175293,-1843.68 170333,-1843.68 170333,-1843.68 170327,-1843.68 170321,-1837.68 170321,-1831.68 170321,-1831.68 170321,-1732.68 170321,-1732.68 170321,-1726.68 170327,-1720.68 170333,-1720.68"/>
<text text-anchor="middle" x="172813" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 24)</text>
</g>
<g id="clust72" class="cluster">
<title>cluster_layer7_expert5</title>
<path fill="lightcyan" stroke="black" d="M165341,-1720.68C165341,-1720.68 170301,-1720.68 170301,-1720.68 170307,-1720.68 170313,-1726.68 170313,-1732.68 170313,-1732.68 170313,-1831.68 170313,-1831.68 170313,-1837.68 170307,-1843.68 170301,-1843.68 170301,-1843.68 165341,-1843.68 165341,-1843.68 165335,-1843.68 165329,-1837.68 165329,-1831.68 165329,-1831.68 165329,-1732.68 165329,-1732.68 165329,-1726.68 165335,-1720.68 165341,-1720.68"/>
<text text-anchor="middle" x="167821" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 26)</text>
</g>
<g id="clust73" class="cluster">
<title>cluster_layer7_expert6</title>
<path fill="lightcyan" stroke="black" d="M160349,-1720.68C160349,-1720.68 165309,-1720.68 165309,-1720.68 165315,-1720.68 165321,-1726.68 165321,-1732.68 165321,-1732.68 165321,-1831.68 165321,-1831.68 165321,-1837.68 165315,-1843.68 165309,-1843.68 165309,-1843.68 160349,-1843.68 160349,-1843.68 160343,-1843.68 160337,-1837.68 160337,-1831.68 160337,-1831.68 160337,-1732.68 160337,-1732.68 160337,-1726.68 160343,-1720.68 160349,-1720.68"/>
<text text-anchor="middle" x="162829" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 28)</text>
</g>
<g id="clust74" class="cluster">
<title>cluster_layer7_expert7</title>
<path fill="lightcyan" stroke="black" d="M155357,-1720.68C155357,-1720.68 160317,-1720.68 160317,-1720.68 160323,-1720.68 160329,-1726.68 160329,-1732.68 160329,-1732.68 160329,-1831.68 160329,-1831.68 160329,-1837.68 160323,-1843.68 160317,-1843.68 160317,-1843.68 155357,-1843.68 155357,-1843.68 155351,-1843.68 155345,-1837.68 155345,-1831.68 155345,-1831.68 155345,-1732.68 155345,-1732.68 155345,-1726.68 155351,-1720.68 155357,-1720.68"/>
<text text-anchor="middle" x="157837" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 30)</text>
</g>
<g id="clust75" class="cluster">
<title>cluster_pipeline_stage_2</title>
<path fill="orange" stroke="black" d="M315165,-1704.68C315165,-1704.68 474957,-1704.68 474957,-1704.68 474963,-1704.68 474969,-1710.68 474969,-1716.68 474969,-1716.68 474969,-1885.68 474969,-1885.68 474969,-1891.68 474963,-1897.68 474957,-1897.68 474957,-1897.68 315165,-1897.68 315165,-1897.68 315159,-1897.68 315153,-1891.68 315153,-1885.68 315153,-1885.68 315153,-1716.68 315153,-1716.68 315153,-1710.68 315159,-1704.68 315165,-1704.68"/>
<text text-anchor="middle" x="395061" y="-1885.68" font-family="Arial Bold" font-size="10.00">Pipeline Stage 2 (Layers 8&#45;11)</text>
</g>
<g id="clust76" class="cluster">
<title>cluster_layer_8</title>
<path fill="lightgray" stroke="black" d="M435029,-1712.68C435029,-1712.68 474949,-1712.68 474949,-1712.68 474955,-1712.68 474961,-1718.68 474961,-1724.68 474961,-1724.68 474961,-1858.68 474961,-1858.68 474961,-1864.68 474955,-1870.68 474949,-1870.68 474949,-1870.68 435029,-1870.68 435029,-1870.68 435023,-1870.68 435017,-1864.68 435017,-1858.68 435017,-1858.68 435017,-1724.68 435017,-1724.68 435017,-1718.68 435023,-1712.68 435029,-1712.68"/>
<text text-anchor="middle" x="454989" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 8</text>
</g>
<g id="clust77" class="cluster">
<title>cluster_layer8_expert0</title>
<path fill="lightcyan" stroke="black" d="M469981,-1720.68C469981,-1720.68 474941,-1720.68 474941,-1720.68 474947,-1720.68 474953,-1726.68 474953,-1732.68 474953,-1732.68 474953,-1831.68 474953,-1831.68 474953,-1837.68 474947,-1843.68 474941,-1843.68 474941,-1843.68 469981,-1843.68 469981,-1843.68 469975,-1843.68 469969,-1837.68 469969,-1831.68 469969,-1831.68 469969,-1732.68 469969,-1732.68 469969,-1726.68 469975,-1720.68 469981,-1720.68"/>
<text text-anchor="middle" x="472461" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 32)</text>
</g>
<g id="clust78" class="cluster">
<title>cluster_layer8_expert1</title>
<path fill="lightcyan" stroke="black" d="M464989,-1720.68C464989,-1720.68 469949,-1720.68 469949,-1720.68 469955,-1720.68 469961,-1726.68 469961,-1732.68 469961,-1732.68 469961,-1831.68 469961,-1831.68 469961,-1837.68 469955,-1843.68 469949,-1843.68 469949,-1843.68 464989,-1843.68 464989,-1843.68 464983,-1843.68 464977,-1837.68 464977,-1831.68 464977,-1831.68 464977,-1732.68 464977,-1732.68 464977,-1726.68 464983,-1720.68 464989,-1720.68"/>
<text text-anchor="middle" x="467469" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 34)</text>
</g>
<g id="clust79" class="cluster">
<title>cluster_layer8_expert2</title>
<path fill="lightcyan" stroke="black" d="M459997,-1720.68C459997,-1720.68 464957,-1720.68 464957,-1720.68 464963,-1720.68 464969,-1726.68 464969,-1732.68 464969,-1732.68 464969,-1831.68 464969,-1831.68 464969,-1837.68 464963,-1843.68 464957,-1843.68 464957,-1843.68 459997,-1843.68 459997,-1843.68 459991,-1843.68 459985,-1837.68 459985,-1831.68 459985,-1831.68 459985,-1732.68 459985,-1732.68 459985,-1726.68 459991,-1720.68 459997,-1720.68"/>
<text text-anchor="middle" x="462477" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 36)</text>
</g>
<g id="clust80" class="cluster">
<title>cluster_layer8_expert3</title>
<path fill="lightcyan" stroke="black" d="M455005,-1720.68C455005,-1720.68 459965,-1720.68 459965,-1720.68 459971,-1720.68 459977,-1726.68 459977,-1732.68 459977,-1732.68 459977,-1831.68 459977,-1831.68 459977,-1837.68 459971,-1843.68 459965,-1843.68 459965,-1843.68 455005,-1843.68 455005,-1843.68 454999,-1843.68 454993,-1837.68 454993,-1831.68 454993,-1831.68 454993,-1732.68 454993,-1732.68 454993,-1726.68 454999,-1720.68 455005,-1720.68"/>
<text text-anchor="middle" x="457485" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 38)</text>
</g>
<g id="clust81" class="cluster">
<title>cluster_layer8_expert4</title>
<path fill="lightcyan" stroke="black" d="M450013,-1720.68C450013,-1720.68 454973,-1720.68 454973,-1720.68 454979,-1720.68 454985,-1726.68 454985,-1732.68 454985,-1732.68 454985,-1831.68 454985,-1831.68 454985,-1837.68 454979,-1843.68 454973,-1843.68 454973,-1843.68 450013,-1843.68 450013,-1843.68 450007,-1843.68 450001,-1837.68 450001,-1831.68 450001,-1831.68 450001,-1732.68 450001,-1732.68 450001,-1726.68 450007,-1720.68 450013,-1720.68"/>
<text text-anchor="middle" x="452493" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 40)</text>
</g>
<g id="clust82" class="cluster">
<title>cluster_layer8_expert5</title>
<path fill="lightcyan" stroke="black" d="M445021,-1720.68C445021,-1720.68 449981,-1720.68 449981,-1720.68 449987,-1720.68 449993,-1726.68 449993,-1732.68 449993,-1732.68 449993,-1831.68 449993,-1831.68 449993,-1837.68 449987,-1843.68 449981,-1843.68 449981,-1843.68 445021,-1843.68 445021,-1843.68 445015,-1843.68 445009,-1837.68 445009,-1831.68 445009,-1831.68 445009,-1732.68 445009,-1732.68 445009,-1726.68 445015,-1720.68 445021,-1720.68"/>
<text text-anchor="middle" x="447501" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 42)</text>
</g>
<g id="clust83" class="cluster">
<title>cluster_layer8_expert6</title>
<path fill="lightcyan" stroke="black" d="M440029,-1720.68C440029,-1720.68 444989,-1720.68 444989,-1720.68 444995,-1720.68 445001,-1726.68 445001,-1732.68 445001,-1732.68 445001,-1831.68 445001,-1831.68 445001,-1837.68 444995,-1843.68 444989,-1843.68 444989,-1843.68 440029,-1843.68 440029,-1843.68 440023,-1843.68 440017,-1837.68 440017,-1831.68 440017,-1831.68 440017,-1732.68 440017,-1732.68 440017,-1726.68 440023,-1720.68 440029,-1720.68"/>
<text text-anchor="middle" x="442509" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 44)</text>
</g>
<g id="clust84" class="cluster">
<title>cluster_layer8_expert7</title>
<path fill="lightcyan" stroke="black" d="M435037,-1720.68C435037,-1720.68 439997,-1720.68 439997,-1720.68 440003,-1720.68 440009,-1726.68 440009,-1732.68 440009,-1732.68 440009,-1831.68 440009,-1831.68 440009,-1837.68 440003,-1843.68 439997,-1843.68 439997,-1843.68 435037,-1843.68 435037,-1843.68 435031,-1843.68 435025,-1837.68 435025,-1831.68 435025,-1831.68 435025,-1732.68 435025,-1732.68 435025,-1726.68 435031,-1720.68 435037,-1720.68"/>
<text text-anchor="middle" x="437517" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 46)</text>
</g>
<g id="clust85" class="cluster">
<title>cluster_layer_9</title>
<path fill="lightgray" stroke="black" d="M395077,-1712.68C395077,-1712.68 434997,-1712.68 434997,-1712.68 435003,-1712.68 435009,-1718.68 435009,-1724.68 435009,-1724.68 435009,-1858.68 435009,-1858.68 435009,-1864.68 435003,-1870.68 434997,-1870.68 434997,-1870.68 395077,-1870.68 395077,-1870.68 395071,-1870.68 395065,-1864.68 395065,-1858.68 395065,-1858.68 395065,-1724.68 395065,-1724.68 395065,-1718.68 395071,-1712.68 395077,-1712.68"/>
<text text-anchor="middle" x="415037" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 9</text>
</g>
<g id="clust86" class="cluster">
<title>cluster_layer9_expert0</title>
<path fill="lightcyan" stroke="black" d="M430029,-1720.68C430029,-1720.68 434989,-1720.68 434989,-1720.68 434995,-1720.68 435001,-1726.68 435001,-1732.68 435001,-1732.68 435001,-1831.68 435001,-1831.68 435001,-1837.68 434995,-1843.68 434989,-1843.68 434989,-1843.68 430029,-1843.68 430029,-1843.68 430023,-1843.68 430017,-1837.68 430017,-1831.68 430017,-1831.68 430017,-1732.68 430017,-1732.68 430017,-1726.68 430023,-1720.68 430029,-1720.68"/>
<text text-anchor="middle" x="432509" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 32)</text>
</g>
<g id="clust87" class="cluster">
<title>cluster_layer9_expert1</title>
<path fill="lightcyan" stroke="black" d="M425037,-1720.68C425037,-1720.68 429997,-1720.68 429997,-1720.68 430003,-1720.68 430009,-1726.68 430009,-1732.68 430009,-1732.68 430009,-1831.68 430009,-1831.68 430009,-1837.68 430003,-1843.68 429997,-1843.68 429997,-1843.68 425037,-1843.68 425037,-1843.68 425031,-1843.68 425025,-1837.68 425025,-1831.68 425025,-1831.68 425025,-1732.68 425025,-1732.68 425025,-1726.68 425031,-1720.68 425037,-1720.68"/>
<text text-anchor="middle" x="427517" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 34)</text>
</g>
<g id="clust88" class="cluster">
<title>cluster_layer9_expert2</title>
<path fill="lightcyan" stroke="black" d="M420045,-1720.68C420045,-1720.68 425005,-1720.68 425005,-1720.68 425011,-1720.68 425017,-1726.68 425017,-1732.68 425017,-1732.68 425017,-1831.68 425017,-1831.68 425017,-1837.68 425011,-1843.68 425005,-1843.68 425005,-1843.68 420045,-1843.68 420045,-1843.68 420039,-1843.68 420033,-1837.68 420033,-1831.68 420033,-1831.68 420033,-1732.68 420033,-1732.68 420033,-1726.68 420039,-1720.68 420045,-1720.68"/>
<text text-anchor="middle" x="422525" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 36)</text>
</g>
<g id="clust89" class="cluster">
<title>cluster_layer9_expert3</title>
<path fill="lightcyan" stroke="black" d="M415053,-1720.68C415053,-1720.68 420013,-1720.68 420013,-1720.68 420019,-1720.68 420025,-1726.68 420025,-1732.68 420025,-1732.68 420025,-1831.68 420025,-1831.68 420025,-1837.68 420019,-1843.68 420013,-1843.68 420013,-1843.68 415053,-1843.68 415053,-1843.68 415047,-1843.68 415041,-1837.68 415041,-1831.68 415041,-1831.68 415041,-1732.68 415041,-1732.68 415041,-1726.68 415047,-1720.68 415053,-1720.68"/>
<text text-anchor="middle" x="417533" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 38)</text>
</g>
<g id="clust90" class="cluster">
<title>cluster_layer9_expert4</title>
<path fill="lightcyan" stroke="black" d="M410061,-1720.68C410061,-1720.68 415021,-1720.68 415021,-1720.68 415027,-1720.68 415033,-1726.68 415033,-1732.68 415033,-1732.68 415033,-1831.68 415033,-1831.68 415033,-1837.68 415027,-1843.68 415021,-1843.68 415021,-1843.68 410061,-1843.68 410061,-1843.68 410055,-1843.68 410049,-1837.68 410049,-1831.68 410049,-1831.68 410049,-1732.68 410049,-1732.68 410049,-1726.68 410055,-1720.68 410061,-1720.68"/>
<text text-anchor="middle" x="412541" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 40)</text>
</g>
<g id="clust91" class="cluster">
<title>cluster_layer9_expert5</title>
<path fill="lightcyan" stroke="black" d="M405069,-1720.68C405069,-1720.68 410029,-1720.68 410029,-1720.68 410035,-1720.68 410041,-1726.68 410041,-1732.68 410041,-1732.68 410041,-1831.68 410041,-1831.68 410041,-1837.68 410035,-1843.68 410029,-1843.68 410029,-1843.68 405069,-1843.68 405069,-1843.68 405063,-1843.68 405057,-1837.68 405057,-1831.68 405057,-1831.68 405057,-1732.68 405057,-1732.68 405057,-1726.68 405063,-1720.68 405069,-1720.68"/>
<text text-anchor="middle" x="407549" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 42)</text>
</g>
<g id="clust92" class="cluster">
<title>cluster_layer9_expert6</title>
<path fill="lightcyan" stroke="black" d="M400077,-1720.68C400077,-1720.68 405037,-1720.68 405037,-1720.68 405043,-1720.68 405049,-1726.68 405049,-1732.68 405049,-1732.68 405049,-1831.68 405049,-1831.68 405049,-1837.68 405043,-1843.68 405037,-1843.68 405037,-1843.68 400077,-1843.68 400077,-1843.68 400071,-1843.68 400065,-1837.68 400065,-1831.68 400065,-1831.68 400065,-1732.68 400065,-1732.68 400065,-1726.68 400071,-1720.68 400077,-1720.68"/>
<text text-anchor="middle" x="402557" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 44)</text>
</g>
<g id="clust93" class="cluster">
<title>cluster_layer9_expert7</title>
<path fill="lightcyan" stroke="black" d="M395085,-1720.68C395085,-1720.68 400045,-1720.68 400045,-1720.68 400051,-1720.68 400057,-1726.68 400057,-1732.68 400057,-1732.68 400057,-1831.68 400057,-1831.68 400057,-1837.68 400051,-1843.68 400045,-1843.68 400045,-1843.68 395085,-1843.68 395085,-1843.68 395079,-1843.68 395073,-1837.68 395073,-1831.68 395073,-1831.68 395073,-1732.68 395073,-1732.68 395073,-1726.68 395079,-1720.68 395085,-1720.68"/>
<text text-anchor="middle" x="397565" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 46)</text>
</g>
<g id="clust94" class="cluster">
<title>cluster_layer_10</title>
<path fill="lightgray" stroke="black" d="M355125,-1712.68C355125,-1712.68 395045,-1712.68 395045,-1712.68 395051,-1712.68 395057,-1718.68 395057,-1724.68 395057,-1724.68 395057,-1858.68 395057,-1858.68 395057,-1864.68 395051,-1870.68 395045,-1870.68 395045,-1870.68 355125,-1870.68 355125,-1870.68 355119,-1870.68 355113,-1864.68 355113,-1858.68 355113,-1858.68 355113,-1724.68 355113,-1724.68 355113,-1718.68 355119,-1712.68 355125,-1712.68"/>
<text text-anchor="middle" x="375085" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 10</text>
</g>
<g id="clust95" class="cluster">
<title>cluster_layer10_expert0</title>
<path fill="lightcyan" stroke="black" d="M390077,-1720.68C390077,-1720.68 395037,-1720.68 395037,-1720.68 395043,-1720.68 395049,-1726.68 395049,-1732.68 395049,-1732.68 395049,-1831.68 395049,-1831.68 395049,-1837.68 395043,-1843.68 395037,-1843.68 395037,-1843.68 390077,-1843.68 390077,-1843.68 390071,-1843.68 390065,-1837.68 390065,-1831.68 390065,-1831.68 390065,-1732.68 390065,-1732.68 390065,-1726.68 390071,-1720.68 390077,-1720.68"/>
<text text-anchor="middle" x="392557" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 32)</text>
</g>
<g id="clust96" class="cluster">
<title>cluster_layer10_expert1</title>
<path fill="lightcyan" stroke="black" d="M385085,-1720.68C385085,-1720.68 390045,-1720.68 390045,-1720.68 390051,-1720.68 390057,-1726.68 390057,-1732.68 390057,-1732.68 390057,-1831.68 390057,-1831.68 390057,-1837.68 390051,-1843.68 390045,-1843.68 390045,-1843.68 385085,-1843.68 385085,-1843.68 385079,-1843.68 385073,-1837.68 385073,-1831.68 385073,-1831.68 385073,-1732.68 385073,-1732.68 385073,-1726.68 385079,-1720.68 385085,-1720.68"/>
<text text-anchor="middle" x="387565" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 34)</text>
</g>
<g id="clust97" class="cluster">
<title>cluster_layer10_expert2</title>
<path fill="lightcyan" stroke="black" d="M380093,-1720.68C380093,-1720.68 385053,-1720.68 385053,-1720.68 385059,-1720.68 385065,-1726.68 385065,-1732.68 385065,-1732.68 385065,-1831.68 385065,-1831.68 385065,-1837.68 385059,-1843.68 385053,-1843.68 385053,-1843.68 380093,-1843.68 380093,-1843.68 380087,-1843.68 380081,-1837.68 380081,-1831.68 380081,-1831.68 380081,-1732.68 380081,-1732.68 380081,-1726.68 380087,-1720.68 380093,-1720.68"/>
<text text-anchor="middle" x="382573" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 36)</text>
</g>
<g id="clust98" class="cluster">
<title>cluster_layer10_expert3</title>
<path fill="lightcyan" stroke="black" d="M375101,-1720.68C375101,-1720.68 380061,-1720.68 380061,-1720.68 380067,-1720.68 380073,-1726.68 380073,-1732.68 380073,-1732.68 380073,-1831.68 380073,-1831.68 380073,-1837.68 380067,-1843.68 380061,-1843.68 380061,-1843.68 375101,-1843.68 375101,-1843.68 375095,-1843.68 375089,-1837.68 375089,-1831.68 375089,-1831.68 375089,-1732.68 375089,-1732.68 375089,-1726.68 375095,-1720.68 375101,-1720.68"/>
<text text-anchor="middle" x="377581" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 38)</text>
</g>
<g id="clust99" class="cluster">
<title>cluster_layer10_expert4</title>
<path fill="lightcyan" stroke="black" d="M370109,-1720.68C370109,-1720.68 375069,-1720.68 375069,-1720.68 375075,-1720.68 375081,-1726.68 375081,-1732.68 375081,-1732.68 375081,-1831.68 375081,-1831.68 375081,-1837.68 375075,-1843.68 375069,-1843.68 375069,-1843.68 370109,-1843.68 370109,-1843.68 370103,-1843.68 370097,-1837.68 370097,-1831.68 370097,-1831.68 370097,-1732.68 370097,-1732.68 370097,-1726.68 370103,-1720.68 370109,-1720.68"/>
<text text-anchor="middle" x="372589" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 40)</text>
</g>
<g id="clust100" class="cluster">
<title>cluster_layer10_expert5</title>
<path fill="lightcyan" stroke="black" d="M365117,-1720.68C365117,-1720.68 370077,-1720.68 370077,-1720.68 370083,-1720.68 370089,-1726.68 370089,-1732.68 370089,-1732.68 370089,-1831.68 370089,-1831.68 370089,-1837.68 370083,-1843.68 370077,-1843.68 370077,-1843.68 365117,-1843.68 365117,-1843.68 365111,-1843.68 365105,-1837.68 365105,-1831.68 365105,-1831.68 365105,-1732.68 365105,-1732.68 365105,-1726.68 365111,-1720.68 365117,-1720.68"/>
<text text-anchor="middle" x="367597" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 42)</text>
</g>
<g id="clust101" class="cluster">
<title>cluster_layer10_expert6</title>
<path fill="lightcyan" stroke="black" d="M360125,-1720.68C360125,-1720.68 365085,-1720.68 365085,-1720.68 365091,-1720.68 365097,-1726.68 365097,-1732.68 365097,-1732.68 365097,-1831.68 365097,-1831.68 365097,-1837.68 365091,-1843.68 365085,-1843.68 365085,-1843.68 360125,-1843.68 360125,-1843.68 360119,-1843.68 360113,-1837.68 360113,-1831.68 360113,-1831.68 360113,-1732.68 360113,-1732.68 360113,-1726.68 360119,-1720.68 360125,-1720.68"/>
<text text-anchor="middle" x="362605" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 44)</text>
</g>
<g id="clust102" class="cluster">
<title>cluster_layer10_expert7</title>
<path fill="lightcyan" stroke="black" d="M355133,-1720.68C355133,-1720.68 360093,-1720.68 360093,-1720.68 360099,-1720.68 360105,-1726.68 360105,-1732.68 360105,-1732.68 360105,-1831.68 360105,-1831.68 360105,-1837.68 360099,-1843.68 360093,-1843.68 360093,-1843.68 355133,-1843.68 355133,-1843.68 355127,-1843.68 355121,-1837.68 355121,-1831.68 355121,-1831.68 355121,-1732.68 355121,-1732.68 355121,-1726.68 355127,-1720.68 355133,-1720.68"/>
<text text-anchor="middle" x="357613" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 46)</text>
</g>
<g id="clust103" class="cluster">
<title>cluster_layer_11</title>
<path fill="lightgray" stroke="black" d="M315173,-1712.68C315173,-1712.68 355093,-1712.68 355093,-1712.68 355099,-1712.68 355105,-1718.68 355105,-1724.68 355105,-1724.68 355105,-1858.68 355105,-1858.68 355105,-1864.68 355099,-1870.68 355093,-1870.68 355093,-1870.68 315173,-1870.68 315173,-1870.68 315167,-1870.68 315161,-1864.68 315161,-1858.68 315161,-1858.68 315161,-1724.68 315161,-1724.68 315161,-1718.68 315167,-1712.68 315173,-1712.68"/>
<text text-anchor="middle" x="335133" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 11</text>
</g>
<g id="clust104" class="cluster">
<title>cluster_layer11_expert0</title>
<path fill="lightcyan" stroke="black" d="M350125,-1720.68C350125,-1720.68 355085,-1720.68 355085,-1720.68 355091,-1720.68 355097,-1726.68 355097,-1732.68 355097,-1732.68 355097,-1831.68 355097,-1831.68 355097,-1837.68 355091,-1843.68 355085,-1843.68 355085,-1843.68 350125,-1843.68 350125,-1843.68 350119,-1843.68 350113,-1837.68 350113,-1831.68 350113,-1831.68 350113,-1732.68 350113,-1732.68 350113,-1726.68 350119,-1720.68 350125,-1720.68"/>
<text text-anchor="middle" x="352605" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 32)</text>
</g>
<g id="clust105" class="cluster">
<title>cluster_layer11_expert1</title>
<path fill="lightcyan" stroke="black" d="M345133,-1720.68C345133,-1720.68 350093,-1720.68 350093,-1720.68 350099,-1720.68 350105,-1726.68 350105,-1732.68 350105,-1732.68 350105,-1831.68 350105,-1831.68 350105,-1837.68 350099,-1843.68 350093,-1843.68 350093,-1843.68 345133,-1843.68 345133,-1843.68 345127,-1843.68 345121,-1837.68 345121,-1831.68 345121,-1831.68 345121,-1732.68 345121,-1732.68 345121,-1726.68 345127,-1720.68 345133,-1720.68"/>
<text text-anchor="middle" x="347613" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 34)</text>
</g>
<g id="clust106" class="cluster">
<title>cluster_layer11_expert2</title>
<path fill="lightcyan" stroke="black" d="M340141,-1720.68C340141,-1720.68 345101,-1720.68 345101,-1720.68 345107,-1720.68 345113,-1726.68 345113,-1732.68 345113,-1732.68 345113,-1831.68 345113,-1831.68 345113,-1837.68 345107,-1843.68 345101,-1843.68 345101,-1843.68 340141,-1843.68 340141,-1843.68 340135,-1843.68 340129,-1837.68 340129,-1831.68 340129,-1831.68 340129,-1732.68 340129,-1732.68 340129,-1726.68 340135,-1720.68 340141,-1720.68"/>
<text text-anchor="middle" x="342621" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 36)</text>
</g>
<g id="clust107" class="cluster">
<title>cluster_layer11_expert3</title>
<path fill="lightcyan" stroke="black" d="M335149,-1720.68C335149,-1720.68 340109,-1720.68 340109,-1720.68 340115,-1720.68 340121,-1726.68 340121,-1732.68 340121,-1732.68 340121,-1831.68 340121,-1831.68 340121,-1837.68 340115,-1843.68 340109,-1843.68 340109,-1843.68 335149,-1843.68 335149,-1843.68 335143,-1843.68 335137,-1837.68 335137,-1831.68 335137,-1831.68 335137,-1732.68 335137,-1732.68 335137,-1726.68 335143,-1720.68 335149,-1720.68"/>
<text text-anchor="middle" x="337629" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 38)</text>
</g>
<g id="clust108" class="cluster">
<title>cluster_layer11_expert4</title>
<path fill="lightcyan" stroke="black" d="M330157,-1720.68C330157,-1720.68 335117,-1720.68 335117,-1720.68 335123,-1720.68 335129,-1726.68 335129,-1732.68 335129,-1732.68 335129,-1831.68 335129,-1831.68 335129,-1837.68 335123,-1843.68 335117,-1843.68 335117,-1843.68 330157,-1843.68 330157,-1843.68 330151,-1843.68 330145,-1837.68 330145,-1831.68 330145,-1831.68 330145,-1732.68 330145,-1732.68 330145,-1726.68 330151,-1720.68 330157,-1720.68"/>
<text text-anchor="middle" x="332637" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 40)</text>
</g>
<g id="clust109" class="cluster">
<title>cluster_layer11_expert5</title>
<path fill="lightcyan" stroke="black" d="M325165,-1720.68C325165,-1720.68 330125,-1720.68 330125,-1720.68 330131,-1720.68 330137,-1726.68 330137,-1732.68 330137,-1732.68 330137,-1831.68 330137,-1831.68 330137,-1837.68 330131,-1843.68 330125,-1843.68 330125,-1843.68 325165,-1843.68 325165,-1843.68 325159,-1843.68 325153,-1837.68 325153,-1831.68 325153,-1831.68 325153,-1732.68 325153,-1732.68 325153,-1726.68 325159,-1720.68 325165,-1720.68"/>
<text text-anchor="middle" x="327645" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 42)</text>
</g>
<g id="clust110" class="cluster">
<title>cluster_layer11_expert6</title>
<path fill="lightcyan" stroke="black" d="M320173,-1720.68C320173,-1720.68 325133,-1720.68 325133,-1720.68 325139,-1720.68 325145,-1726.68 325145,-1732.68 325145,-1732.68 325145,-1831.68 325145,-1831.68 325145,-1837.68 325139,-1843.68 325133,-1843.68 325133,-1843.68 320173,-1843.68 320173,-1843.68 320167,-1843.68 320161,-1837.68 320161,-1831.68 320161,-1831.68 320161,-1732.68 320161,-1732.68 320161,-1726.68 320167,-1720.68 320173,-1720.68"/>
<text text-anchor="middle" x="322653" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 44)</text>
</g>
<g id="clust111" class="cluster">
<title>cluster_layer11_expert7</title>
<path fill="lightcyan" stroke="black" d="M315181,-1720.68C315181,-1720.68 320141,-1720.68 320141,-1720.68 320147,-1720.68 320153,-1726.68 320153,-1732.68 320153,-1732.68 320153,-1831.68 320153,-1831.68 320153,-1837.68 320147,-1843.68 320141,-1843.68 320141,-1843.68 315181,-1843.68 315181,-1843.68 315175,-1843.68 315169,-1837.68 315169,-1831.68 315169,-1831.68 315169,-1732.68 315169,-1732.68 315169,-1726.68 315175,-1720.68 315181,-1720.68"/>
<text text-anchor="middle" x="317661" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 46)</text>
</g>
<g id="clust112" class="cluster">
<title>cluster_pipeline_stage_3</title>
<path fill="orange" stroke="black" d="M474989,-1704.68C474989,-1704.68 634781,-1704.68 634781,-1704.68 634787,-1704.68 634793,-1710.68 634793,-1716.68 634793,-1716.68 634793,-1885.68 634793,-1885.68 634793,-1891.68 634787,-1897.68 634781,-1897.68 634781,-1897.68 474989,-1897.68 474989,-1897.68 474983,-1897.68 474977,-1891.68 474977,-1885.68 474977,-1885.68 474977,-1716.68 474977,-1716.68 474977,-1710.68 474983,-1704.68 474989,-1704.68"/>
<text text-anchor="middle" x="554885" y="-1885.68" font-family="Arial Bold" font-size="10.00">Pipeline Stage 3 (Layers 12&#45;15)</text>
</g>
<g id="clust113" class="cluster">
<title>cluster_layer_12</title>
<path fill="lightgray" stroke="black" d="M594853,-1712.68C594853,-1712.68 634773,-1712.68 634773,-1712.68 634779,-1712.68 634785,-1718.68 634785,-1724.68 634785,-1724.68 634785,-1858.68 634785,-1858.68 634785,-1864.68 634779,-1870.68 634773,-1870.68 634773,-1870.68 594853,-1870.68 594853,-1870.68 594847,-1870.68 594841,-1864.68 594841,-1858.68 594841,-1858.68 594841,-1724.68 594841,-1724.68 594841,-1718.68 594847,-1712.68 594853,-1712.68"/>
<text text-anchor="middle" x="614813" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 12</text>
</g>
<g id="clust114" class="cluster">
<title>cluster_layer12_expert0</title>
<path fill="lightcyan" stroke="black" d="M629805,-1720.68C629805,-1720.68 634765,-1720.68 634765,-1720.68 634771,-1720.68 634777,-1726.68 634777,-1732.68 634777,-1732.68 634777,-1831.68 634777,-1831.68 634777,-1837.68 634771,-1843.68 634765,-1843.68 634765,-1843.68 629805,-1843.68 629805,-1843.68 629799,-1843.68 629793,-1837.68 629793,-1831.68 629793,-1831.68 629793,-1732.68 629793,-1732.68 629793,-1726.68 629799,-1720.68 629805,-1720.68"/>
<text text-anchor="middle" x="632285" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 48)</text>
</g>
<g id="clust115" class="cluster">
<title>cluster_layer12_expert1</title>
<path fill="lightcyan" stroke="black" d="M624813,-1720.68C624813,-1720.68 629773,-1720.68 629773,-1720.68 629779,-1720.68 629785,-1726.68 629785,-1732.68 629785,-1732.68 629785,-1831.68 629785,-1831.68 629785,-1837.68 629779,-1843.68 629773,-1843.68 629773,-1843.68 624813,-1843.68 624813,-1843.68 624807,-1843.68 624801,-1837.68 624801,-1831.68 624801,-1831.68 624801,-1732.68 624801,-1732.68 624801,-1726.68 624807,-1720.68 624813,-1720.68"/>
<text text-anchor="middle" x="627293" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 50)</text>
</g>
<g id="clust116" class="cluster">
<title>cluster_layer12_expert2</title>
<path fill="lightcyan" stroke="black" d="M619821,-1720.68C619821,-1720.68 624781,-1720.68 624781,-1720.68 624787,-1720.68 624793,-1726.68 624793,-1732.68 624793,-1732.68 624793,-1831.68 624793,-1831.68 624793,-1837.68 624787,-1843.68 624781,-1843.68 624781,-1843.68 619821,-1843.68 619821,-1843.68 619815,-1843.68 619809,-1837.68 619809,-1831.68 619809,-1831.68 619809,-1732.68 619809,-1732.68 619809,-1726.68 619815,-1720.68 619821,-1720.68"/>
<text text-anchor="middle" x="622301" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 52)</text>
</g>
<g id="clust117" class="cluster">
<title>cluster_layer12_expert3</title>
<path fill="lightcyan" stroke="black" d="M614829,-1720.68C614829,-1720.68 619789,-1720.68 619789,-1720.68 619795,-1720.68 619801,-1726.68 619801,-1732.68 619801,-1732.68 619801,-1831.68 619801,-1831.68 619801,-1837.68 619795,-1843.68 619789,-1843.68 619789,-1843.68 614829,-1843.68 614829,-1843.68 614823,-1843.68 614817,-1837.68 614817,-1831.68 614817,-1831.68 614817,-1732.68 614817,-1732.68 614817,-1726.68 614823,-1720.68 614829,-1720.68"/>
<text text-anchor="middle" x="617309" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 54)</text>
</g>
<g id="clust118" class="cluster">
<title>cluster_layer12_expert4</title>
<path fill="lightcyan" stroke="black" d="M609837,-1720.68C609837,-1720.68 614797,-1720.68 614797,-1720.68 614803,-1720.68 614809,-1726.68 614809,-1732.68 614809,-1732.68 614809,-1831.68 614809,-1831.68 614809,-1837.68 614803,-1843.68 614797,-1843.68 614797,-1843.68 609837,-1843.68 609837,-1843.68 609831,-1843.68 609825,-1837.68 609825,-1831.68 609825,-1831.68 609825,-1732.68 609825,-1732.68 609825,-1726.68 609831,-1720.68 609837,-1720.68"/>
<text text-anchor="middle" x="612317" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 56)</text>
</g>
<g id="clust119" class="cluster">
<title>cluster_layer12_expert5</title>
<path fill="lightcyan" stroke="black" d="M604845,-1720.68C604845,-1720.68 609805,-1720.68 609805,-1720.68 609811,-1720.68 609817,-1726.68 609817,-1732.68 609817,-1732.68 609817,-1831.68 609817,-1831.68 609817,-1837.68 609811,-1843.68 609805,-1843.68 609805,-1843.68 604845,-1843.68 604845,-1843.68 604839,-1843.68 604833,-1837.68 604833,-1831.68 604833,-1831.68 604833,-1732.68 604833,-1732.68 604833,-1726.68 604839,-1720.68 604845,-1720.68"/>
<text text-anchor="middle" x="607325" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 58)</text>
</g>
<g id="clust120" class="cluster">
<title>cluster_layer12_expert6</title>
<path fill="lightcyan" stroke="black" d="M599853,-1720.68C599853,-1720.68 604813,-1720.68 604813,-1720.68 604819,-1720.68 604825,-1726.68 604825,-1732.68 604825,-1732.68 604825,-1831.68 604825,-1831.68 604825,-1837.68 604819,-1843.68 604813,-1843.68 604813,-1843.68 599853,-1843.68 599853,-1843.68 599847,-1843.68 599841,-1837.68 599841,-1831.68 599841,-1831.68 599841,-1732.68 599841,-1732.68 599841,-1726.68 599847,-1720.68 599853,-1720.68"/>
<text text-anchor="middle" x="602333" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 60)</text>
</g>
<g id="clust121" class="cluster">
<title>cluster_layer12_expert7</title>
<path fill="lightcyan" stroke="black" d="M594861,-1720.68C594861,-1720.68 599821,-1720.68 599821,-1720.68 599827,-1720.68 599833,-1726.68 599833,-1732.68 599833,-1732.68 599833,-1831.68 599833,-1831.68 599833,-1837.68 599827,-1843.68 599821,-1843.68 599821,-1843.68 594861,-1843.68 594861,-1843.68 594855,-1843.68 594849,-1837.68 594849,-1831.68 594849,-1831.68 594849,-1732.68 594849,-1732.68 594849,-1726.68 594855,-1720.68 594861,-1720.68"/>
<text text-anchor="middle" x="597341" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 62)</text>
</g>
<g id="clust122" class="cluster">
<title>cluster_layer_13</title>
<path fill="lightgray" stroke="black" d="M554901,-1712.68C554901,-1712.68 594821,-1712.68 594821,-1712.68 594827,-1712.68 594833,-1718.68 594833,-1724.68 594833,-1724.68 594833,-1858.68 594833,-1858.68 594833,-1864.68 594827,-1870.68 594821,-1870.68 594821,-1870.68 554901,-1870.68 554901,-1870.68 554895,-1870.68 554889,-1864.68 554889,-1858.68 554889,-1858.68 554889,-1724.68 554889,-1724.68 554889,-1718.68 554895,-1712.68 554901,-1712.68"/>
<text text-anchor="middle" x="574861" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 13</text>
</g>
<g id="clust123" class="cluster">
<title>cluster_layer13_expert0</title>
<path fill="lightcyan" stroke="black" d="M589853,-1720.68C589853,-1720.68 594813,-1720.68 594813,-1720.68 594819,-1720.68 594825,-1726.68 594825,-1732.68 594825,-1732.68 594825,-1831.68 594825,-1831.68 594825,-1837.68 594819,-1843.68 594813,-1843.68 594813,-1843.68 589853,-1843.68 589853,-1843.68 589847,-1843.68 589841,-1837.68 589841,-1831.68 589841,-1831.68 589841,-1732.68 589841,-1732.68 589841,-1726.68 589847,-1720.68 589853,-1720.68"/>
<text text-anchor="middle" x="592333" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 48)</text>
</g>
<g id="clust124" class="cluster">
<title>cluster_layer13_expert1</title>
<path fill="lightcyan" stroke="black" d="M584861,-1720.68C584861,-1720.68 589821,-1720.68 589821,-1720.68 589827,-1720.68 589833,-1726.68 589833,-1732.68 589833,-1732.68 589833,-1831.68 589833,-1831.68 589833,-1837.68 589827,-1843.68 589821,-1843.68 589821,-1843.68 584861,-1843.68 584861,-1843.68 584855,-1843.68 584849,-1837.68 584849,-1831.68 584849,-1831.68 584849,-1732.68 584849,-1732.68 584849,-1726.68 584855,-1720.68 584861,-1720.68"/>
<text text-anchor="middle" x="587341" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 50)</text>
</g>
<g id="clust125" class="cluster">
<title>cluster_layer13_expert2</title>
<path fill="lightcyan" stroke="black" d="M579869,-1720.68C579869,-1720.68 584829,-1720.68 584829,-1720.68 584835,-1720.68 584841,-1726.68 584841,-1732.68 584841,-1732.68 584841,-1831.68 584841,-1831.68 584841,-1837.68 584835,-1843.68 584829,-1843.68 584829,-1843.68 579869,-1843.68 579869,-1843.68 579863,-1843.68 579857,-1837.68 579857,-1831.68 579857,-1831.68 579857,-1732.68 579857,-1732.68 579857,-1726.68 579863,-1720.68 579869,-1720.68"/>
<text text-anchor="middle" x="582349" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 52)</text>
</g>
<g id="clust126" class="cluster">
<title>cluster_layer13_expert3</title>
<path fill="lightcyan" stroke="black" d="M574877,-1720.68C574877,-1720.68 579837,-1720.68 579837,-1720.68 579843,-1720.68 579849,-1726.68 579849,-1732.68 579849,-1732.68 579849,-1831.68 579849,-1831.68 579849,-1837.68 579843,-1843.68 579837,-1843.68 579837,-1843.68 574877,-1843.68 574877,-1843.68 574871,-1843.68 574865,-1837.68 574865,-1831.68 574865,-1831.68 574865,-1732.68 574865,-1732.68 574865,-1726.68 574871,-1720.68 574877,-1720.68"/>
<text text-anchor="middle" x="577357" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 54)</text>
</g>
<g id="clust127" class="cluster">
<title>cluster_layer13_expert4</title>
<path fill="lightcyan" stroke="black" d="M569885,-1720.68C569885,-1720.68 574845,-1720.68 574845,-1720.68 574851,-1720.68 574857,-1726.68 574857,-1732.68 574857,-1732.68 574857,-1831.68 574857,-1831.68 574857,-1837.68 574851,-1843.68 574845,-1843.68 574845,-1843.68 569885,-1843.68 569885,-1843.68 569879,-1843.68 569873,-1837.68 569873,-1831.68 569873,-1831.68 569873,-1732.68 569873,-1732.68 569873,-1726.68 569879,-1720.68 569885,-1720.68"/>
<text text-anchor="middle" x="572365" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 56)</text>
</g>
<g id="clust128" class="cluster">
<title>cluster_layer13_expert5</title>
<path fill="lightcyan" stroke="black" d="M564893,-1720.68C564893,-1720.68 569853,-1720.68 569853,-1720.68 569859,-1720.68 569865,-1726.68 569865,-1732.68 569865,-1732.68 569865,-1831.68 569865,-1831.68 569865,-1837.68 569859,-1843.68 569853,-1843.68 569853,-1843.68 564893,-1843.68 564893,-1843.68 564887,-1843.68 564881,-1837.68 564881,-1831.68 564881,-1831.68 564881,-1732.68 564881,-1732.68 564881,-1726.68 564887,-1720.68 564893,-1720.68"/>
<text text-anchor="middle" x="567373" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 58)</text>
</g>
<g id="clust129" class="cluster">
<title>cluster_layer13_expert6</title>
<path fill="lightcyan" stroke="black" d="M559901,-1720.68C559901,-1720.68 564861,-1720.68 564861,-1720.68 564867,-1720.68 564873,-1726.68 564873,-1732.68 564873,-1732.68 564873,-1831.68 564873,-1831.68 564873,-1837.68 564867,-1843.68 564861,-1843.68 564861,-1843.68 559901,-1843.68 559901,-1843.68 559895,-1843.68 559889,-1837.68 559889,-1831.68 559889,-1831.68 559889,-1732.68 559889,-1732.68 559889,-1726.68 559895,-1720.68 559901,-1720.68"/>
<text text-anchor="middle" x="562381" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 60)</text>
</g>
<g id="clust130" class="cluster">
<title>cluster_layer13_expert7</title>
<path fill="lightcyan" stroke="black" d="M554909,-1720.68C554909,-1720.68 559869,-1720.68 559869,-1720.68 559875,-1720.68 559881,-1726.68 559881,-1732.68 559881,-1732.68 559881,-1831.68 559881,-1831.68 559881,-1837.68 559875,-1843.68 559869,-1843.68 559869,-1843.68 554909,-1843.68 554909,-1843.68 554903,-1843.68 554897,-1837.68 554897,-1831.68 554897,-1831.68 554897,-1732.68 554897,-1732.68 554897,-1726.68 554903,-1720.68 554909,-1720.68"/>
<text text-anchor="middle" x="557389" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 62)</text>
</g>
<g id="clust131" class="cluster">
<title>cluster_layer_14</title>
<path fill="lightgray" stroke="black" d="M514949,-1712.68C514949,-1712.68 554869,-1712.68 554869,-1712.68 554875,-1712.68 554881,-1718.68 554881,-1724.68 554881,-1724.68 554881,-1858.68 554881,-1858.68 554881,-1864.68 554875,-1870.68 554869,-1870.68 554869,-1870.68 514949,-1870.68 514949,-1870.68 514943,-1870.68 514937,-1864.68 514937,-1858.68 514937,-1858.68 514937,-1724.68 514937,-1724.68 514937,-1718.68 514943,-1712.68 514949,-1712.68"/>
<text text-anchor="middle" x="534909" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 14</text>
</g>
<g id="clust132" class="cluster">
<title>cluster_layer14_expert0</title>
<path fill="lightcyan" stroke="black" d="M549901,-1720.68C549901,-1720.68 554861,-1720.68 554861,-1720.68 554867,-1720.68 554873,-1726.68 554873,-1732.68 554873,-1732.68 554873,-1831.68 554873,-1831.68 554873,-1837.68 554867,-1843.68 554861,-1843.68 554861,-1843.68 549901,-1843.68 549901,-1843.68 549895,-1843.68 549889,-1837.68 549889,-1831.68 549889,-1831.68 549889,-1732.68 549889,-1732.68 549889,-1726.68 549895,-1720.68 549901,-1720.68"/>
<text text-anchor="middle" x="552381" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 48)</text>
</g>
<g id="clust133" class="cluster">
<title>cluster_layer14_expert1</title>
<path fill="lightcyan" stroke="black" d="M544909,-1720.68C544909,-1720.68 549869,-1720.68 549869,-1720.68 549875,-1720.68 549881,-1726.68 549881,-1732.68 549881,-1732.68 549881,-1831.68 549881,-1831.68 549881,-1837.68 549875,-1843.68 549869,-1843.68 549869,-1843.68 544909,-1843.68 544909,-1843.68 544903,-1843.68 544897,-1837.68 544897,-1831.68 544897,-1831.68 544897,-1732.68 544897,-1732.68 544897,-1726.68 544903,-1720.68 544909,-1720.68"/>
<text text-anchor="middle" x="547389" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 50)</text>
</g>
<g id="clust134" class="cluster">
<title>cluster_layer14_expert2</title>
<path fill="lightcyan" stroke="black" d="M539917,-1720.68C539917,-1720.68 544877,-1720.68 544877,-1720.68 544883,-1720.68 544889,-1726.68 544889,-1732.68 544889,-1732.68 544889,-1831.68 544889,-1831.68 544889,-1837.68 544883,-1843.68 544877,-1843.68 544877,-1843.68 539917,-1843.68 539917,-1843.68 539911,-1843.68 539905,-1837.68 539905,-1831.68 539905,-1831.68 539905,-1732.68 539905,-1732.68 539905,-1726.68 539911,-1720.68 539917,-1720.68"/>
<text text-anchor="middle" x="542397" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 52)</text>
</g>
<g id="clust135" class="cluster">
<title>cluster_layer14_expert3</title>
<path fill="lightcyan" stroke="black" d="M534925,-1720.68C534925,-1720.68 539885,-1720.68 539885,-1720.68 539891,-1720.68 539897,-1726.68 539897,-1732.68 539897,-1732.68 539897,-1831.68 539897,-1831.68 539897,-1837.68 539891,-1843.68 539885,-1843.68 539885,-1843.68 534925,-1843.68 534925,-1843.68 534919,-1843.68 534913,-1837.68 534913,-1831.68 534913,-1831.68 534913,-1732.68 534913,-1732.68 534913,-1726.68 534919,-1720.68 534925,-1720.68"/>
<text text-anchor="middle" x="537405" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 54)</text>
</g>
<g id="clust136" class="cluster">
<title>cluster_layer14_expert4</title>
<path fill="lightcyan" stroke="black" d="M529933,-1720.68C529933,-1720.68 534893,-1720.68 534893,-1720.68 534899,-1720.68 534905,-1726.68 534905,-1732.68 534905,-1732.68 534905,-1831.68 534905,-1831.68 534905,-1837.68 534899,-1843.68 534893,-1843.68 534893,-1843.68 529933,-1843.68 529933,-1843.68 529927,-1843.68 529921,-1837.68 529921,-1831.68 529921,-1831.68 529921,-1732.68 529921,-1732.68 529921,-1726.68 529927,-1720.68 529933,-1720.68"/>
<text text-anchor="middle" x="532413" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 56)</text>
</g>
<g id="clust137" class="cluster">
<title>cluster_layer14_expert5</title>
<path fill="lightcyan" stroke="black" d="M524941,-1720.68C524941,-1720.68 529901,-1720.68 529901,-1720.68 529907,-1720.68 529913,-1726.68 529913,-1732.68 529913,-1732.68 529913,-1831.68 529913,-1831.68 529913,-1837.68 529907,-1843.68 529901,-1843.68 529901,-1843.68 524941,-1843.68 524941,-1843.68 524935,-1843.68 524929,-1837.68 524929,-1831.68 524929,-1831.68 524929,-1732.68 524929,-1732.68 524929,-1726.68 524935,-1720.68 524941,-1720.68"/>
<text text-anchor="middle" x="527421" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 58)</text>
</g>
<g id="clust138" class="cluster">
<title>cluster_layer14_expert6</title>
<path fill="lightcyan" stroke="black" d="M519949,-1720.68C519949,-1720.68 524909,-1720.68 524909,-1720.68 524915,-1720.68 524921,-1726.68 524921,-1732.68 524921,-1732.68 524921,-1831.68 524921,-1831.68 524921,-1837.68 524915,-1843.68 524909,-1843.68 524909,-1843.68 519949,-1843.68 519949,-1843.68 519943,-1843.68 519937,-1837.68 519937,-1831.68 519937,-1831.68 519937,-1732.68 519937,-1732.68 519937,-1726.68 519943,-1720.68 519949,-1720.68"/>
<text text-anchor="middle" x="522429" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 60)</text>
</g>
<g id="clust139" class="cluster">
<title>cluster_layer14_expert7</title>
<path fill="lightcyan" stroke="black" d="M514957,-1720.68C514957,-1720.68 519917,-1720.68 519917,-1720.68 519923,-1720.68 519929,-1726.68 519929,-1732.68 519929,-1732.68 519929,-1831.68 519929,-1831.68 519929,-1837.68 519923,-1843.68 519917,-1843.68 519917,-1843.68 514957,-1843.68 514957,-1843.68 514951,-1843.68 514945,-1837.68 514945,-1831.68 514945,-1831.68 514945,-1732.68 514945,-1732.68 514945,-1726.68 514951,-1720.68 514957,-1720.68"/>
<text text-anchor="middle" x="517437" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 62)</text>
</g>
<g id="clust140" class="cluster">
<title>cluster_layer_15</title>
<path fill="lightgray" stroke="black" d="M474997,-1712.68C474997,-1712.68 514917,-1712.68 514917,-1712.68 514923,-1712.68 514929,-1718.68 514929,-1724.68 514929,-1724.68 514929,-1858.68 514929,-1858.68 514929,-1864.68 514923,-1870.68 514917,-1870.68 514917,-1870.68 474997,-1870.68 474997,-1870.68 474991,-1870.68 474985,-1864.68 474985,-1858.68 474985,-1858.68 474985,-1724.68 474985,-1724.68 474985,-1718.68 474991,-1712.68 474997,-1712.68"/>
<text text-anchor="middle" x="494957" y="-1858.68" font-family="Arial Bold" font-size="10.00">Layer 15</text>
</g>
<g id="clust141" class="cluster">
<title>cluster_layer15_expert0</title>
<path fill="lightcyan" stroke="black" d="M509949,-1720.68C509949,-1720.68 514909,-1720.68 514909,-1720.68 514915,-1720.68 514921,-1726.68 514921,-1732.68 514921,-1732.68 514921,-1831.68 514921,-1831.68 514921,-1837.68 514915,-1843.68 514909,-1843.68 514909,-1843.68 509949,-1843.68 509949,-1843.68 509943,-1843.68 509937,-1837.68 509937,-1831.68 509937,-1831.68 509937,-1732.68 509937,-1732.68 509937,-1726.68 509943,-1720.68 509949,-1720.68"/>
<text text-anchor="middle" x="512429" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 0 (GPU 48)</text>
</g>
<g id="clust142" class="cluster">
<title>cluster_layer15_expert1</title>
<path fill="lightcyan" stroke="black" d="M504957,-1720.68C504957,-1720.68 509917,-1720.68 509917,-1720.68 509923,-1720.68 509929,-1726.68 509929,-1732.68 509929,-1732.68 509929,-1831.68 509929,-1831.68 509929,-1837.68 509923,-1843.68 509917,-1843.68 509917,-1843.68 504957,-1843.68 504957,-1843.68 504951,-1843.68 504945,-1837.68 504945,-1831.68 504945,-1831.68 504945,-1732.68 504945,-1732.68 504945,-1726.68 504951,-1720.68 504957,-1720.68"/>
<text text-anchor="middle" x="507437" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 1 (GPU 50)</text>
</g>
<g id="clust143" class="cluster">
<title>cluster_layer15_expert2</title>
<path fill="lightcyan" stroke="black" d="M499965,-1720.68C499965,-1720.68 504925,-1720.68 504925,-1720.68 504931,-1720.68 504937,-1726.68 504937,-1732.68 504937,-1732.68 504937,-1831.68 504937,-1831.68 504937,-1837.68 504931,-1843.68 504925,-1843.68 504925,-1843.68 499965,-1843.68 499965,-1843.68 499959,-1843.68 499953,-1837.68 499953,-1831.68 499953,-1831.68 499953,-1732.68 499953,-1732.68 499953,-1726.68 499959,-1720.68 499965,-1720.68"/>
<text text-anchor="middle" x="502445" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 2 (GPU 52)</text>
</g>
<g id="clust144" class="cluster">
<title>cluster_layer15_expert3</title>
<path fill="lightcyan" stroke="black" d="M494973,-1720.68C494973,-1720.68 499933,-1720.68 499933,-1720.68 499939,-1720.68 499945,-1726.68 499945,-1732.68 499945,-1732.68 499945,-1831.68 499945,-1831.68 499945,-1837.68 499939,-1843.68 499933,-1843.68 499933,-1843.68 494973,-1843.68 494973,-1843.68 494967,-1843.68 494961,-1837.68 494961,-1831.68 494961,-1831.68 494961,-1732.68 494961,-1732.68 494961,-1726.68 494967,-1720.68 494973,-1720.68"/>
<text text-anchor="middle" x="497453" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 3 (GPU 54)</text>
</g>
<g id="clust145" class="cluster">
<title>cluster_layer15_expert4</title>
<path fill="lightcyan" stroke="black" d="M489981,-1720.68C489981,-1720.68 494941,-1720.68 494941,-1720.68 494947,-1720.68 494953,-1726.68 494953,-1732.68 494953,-1732.68 494953,-1831.68 494953,-1831.68 494953,-1837.68 494947,-1843.68 494941,-1843.68 494941,-1843.68 489981,-1843.68 489981,-1843.68 489975,-1843.68 489969,-1837.68 489969,-1831.68 489969,-1831.68 489969,-1732.68 489969,-1732.68 489969,-1726.68 489975,-1720.68 489981,-1720.68"/>
<text text-anchor="middle" x="492461" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 4 (GPU 56)</text>
</g>
<g id="clust146" class="cluster">
<title>cluster_layer15_expert5</title>
<path fill="lightcyan" stroke="black" d="M484989,-1720.68C484989,-1720.68 489949,-1720.68 489949,-1720.68 489955,-1720.68 489961,-1726.68 489961,-1732.68 489961,-1732.68 489961,-1831.68 489961,-1831.68 489961,-1837.68 489955,-1843.68 489949,-1843.68 489949,-1843.68 484989,-1843.68 484989,-1843.68 484983,-1843.68 484977,-1837.68 484977,-1831.68 484977,-1831.68 484977,-1732.68 484977,-1732.68 484977,-1726.68 484983,-1720.68 484989,-1720.68"/>
<text text-anchor="middle" x="487469" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 5 (GPU 58)</text>
</g>
<g id="clust147" class="cluster">
<title>cluster_layer15_expert6</title>
<path fill="lightcyan" stroke="black" d="M479997,-1720.68C479997,-1720.68 484957,-1720.68 484957,-1720.68 484963,-1720.68 484969,-1726.68 484969,-1732.68 484969,-1732.68 484969,-1831.68 484969,-1831.68 484969,-1837.68 484963,-1843.68 484957,-1843.68 484957,-1843.68 479997,-1843.68 479997,-1843.68 479991,-1843.68 479985,-1837.68 479985,-1831.68 479985,-1831.68 479985,-1732.68 479985,-1732.68 479985,-1726.68 479991,-1720.68 479997,-1720.68"/>
<text text-anchor="middle" x="482477" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 6 (GPU 60)</text>
</g>
<g id="clust148" class="cluster">
<title>cluster_layer15_expert7</title>
<path fill="lightcyan" stroke="black" d="M475005,-1720.68C475005,-1720.68 479965,-1720.68 479965,-1720.68 479971,-1720.68 479977,-1726.68 479977,-1732.68 479977,-1732.68 479977,-1831.68 479977,-1831.68 479977,-1837.68 479971,-1843.68 479965,-1843.68 479965,-1843.68 475005,-1843.68 475005,-1843.68 474999,-1843.68 474993,-1837.68 474993,-1831.68 474993,-1831.68 474993,-1732.68 474993,-1732.68 474993,-1726.68 474999,-1720.68 475005,-1720.68"/>
<text text-anchor="middle" x="477485" y="-1831.68" font-family="Arial Bold" font-size="10.00">Expert Group 7 (GPU 62)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="white" stroke="black" points="155321,-1803.18 154971,-1803.18 154971,-1742.18 155321,-1742.18 155321,-1803.18"/>
<text text-anchor="middle" x="155146" y="-1789.58" font-family="Arial Bold" font-size="12.00">Model Input</text>
<text text-anchor="middle" x="155146" y="-1762.58" font-family="Arial Bold" font-size="12.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="155146" y="-1749.58" font-family="Arial Bold" font-size="12.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_route -->
<g id="node2" class="node">
<title>layer0_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="155246,-1593.68 155046,-1593.68 155046,-1549.68 155246,-1549.68 155246,-1593.68"/>
<text text-anchor="middle" x="155146" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="155146" y="-1574.28" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- input&#45;&gt;layer0_expert0_route -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_expert0_route</title>
<path fill="none" stroke="black" d="M155146,-1741.88C155146,-1704.88 155146,-1642.02 155146,-1604.22"/>
<polygon fill="black" stroke="black" points="155149.5,-1603.8 155146,-1593.8 155142.5,-1603.8 155149.5,-1603.8"/>
</g>
<!-- layer0_expert0_gate -->
<g id="node3" class="node">
<title>layer0_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="155344.04,-1491.68 155029,-1491.68 154947.96,-1403.68 155263,-1403.68 155344.04,-1491.68"/>
<text text-anchor="middle" x="155146" y="-1459.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="155146" y="-1450.28" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-1441.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-1432.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert0_route&#45;&gt;layer0_expert0_gate -->
<g id="edge2" class="edge">
<title>layer0_expert0_route&#45;&gt;layer0_expert0_gate</title>
<path fill="none" stroke="black" d="M155146,-1549.43C155146,-1536.31 155146,-1518.85 155146,-1502.15"/>
<polygon fill="black" stroke="black" points="155149.5,-1501.9 155146,-1491.9 155142.5,-1501.9 155149.5,-1501.9"/>
</g>
<!-- layer0_expert0_a2a -->
<g id="node4" class="node">
<title>layer0_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="155146" cy="-1336.56" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="155146" y="-1348.16" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="155146" y="-1339.16" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-1330.16" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-1321.16" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_gate&#45;&gt;layer0_expert0_a2a -->
<g id="edge3" class="edge">
<title>layer0_expert0_gate&#45;&gt;layer0_expert0_a2a</title>
<path fill="none" stroke="black" d="M155146,-1403.55C155146,-1395.18 155146,-1386.42 155146,-1378.13"/>
<polygon fill="black" stroke="black" points="155149.5,-1377.94 155146,-1367.94 155142.5,-1377.94 155149.5,-1377.94"/>
</g>
<!-- layer0_expert0_attn_split -->
<g id="node5" class="node">
<title>layer0_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="155350.48,-1269.45 155025.2,-1269.45 154941.52,-1181.45 155266.8,-1181.45 155350.48,-1269.45"/>
<text text-anchor="middle" x="155146" y="-1237.05" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="155146" y="-1228.05" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-1219.05" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-1210.05" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert0_a2a&#45;&gt;layer0_expert0_attn_split -->
<g id="edge4" class="edge">
<title>layer0_expert0_a2a&#45;&gt;layer0_expert0_attn_split</title>
<path fill="none" stroke="black" d="M155146,-1305.17C155146,-1297.28 155146,-1288.55 155146,-1279.86"/>
<polygon fill="black" stroke="black" points="155149.5,-1279.73 155146,-1269.73 155142.5,-1279.73 155149.5,-1279.73"/>
</g>
<!-- layer0_expert0_q_proj -->
<g id="node6" class="node">
<title>layer0_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="155029.5,-1145.45 154832.5,-1145.45 154832.5,-1101.45 155029.5,-1101.45 155029.5,-1145.45"/>
<text text-anchor="middle" x="154931" y="-1135.05" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="154931" y="-1126.05" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="154931" y="-1117.05" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="154931" y="-1108.05" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert0_attn_split&#45;&gt;layer0_expert0_q_proj -->
<g id="edge5" class="edge">
<title>layer0_expert0_attn_split&#45;&gt;layer0_expert0_q_proj</title>
<path fill="none" stroke="black" d="M155053.26,-1181.32C155030.1,-1170.54 155006.01,-1159.34 154985.39,-1149.75"/>
<polygon fill="black" stroke="black" points="154986.73,-1146.51 154976.18,-1145.47 154983.77,-1152.86 154986.73,-1146.51"/>
</g>
<!-- layer0_expert0_k_proj -->
<g id="node7" class="node">
<title>layer0_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="155244.5,-1145.45 155047.5,-1145.45 155047.5,-1101.45 155244.5,-1101.45 155244.5,-1145.45"/>
<text text-anchor="middle" x="155146" y="-1135.05" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="155146" y="-1126.05" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-1117.05" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-1108.05" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert0_attn_split&#45;&gt;layer0_expert0_k_proj -->
<g id="edge6" class="edge">
<title>layer0_expert0_attn_split&#45;&gt;layer0_expert0_k_proj</title>
<path fill="none" stroke="black" d="M155146,-1181.17C155146,-1172.58 155146,-1163.72 155146,-1155.64"/>
<polygon fill="black" stroke="black" points="155149.5,-1155.53 155146,-1145.53 155142.5,-1155.53 155149.5,-1155.53"/>
</g>
<!-- layer0_expert0_v_proj -->
<g id="node8" class="node">
<title>layer0_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="155459.5,-1145.45 155262.5,-1145.45 155262.5,-1101.45 155459.5,-1101.45 155459.5,-1145.45"/>
<text text-anchor="middle" x="155361" y="-1135.05" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="155361" y="-1126.05" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155361" y="-1117.05" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155361" y="-1108.05" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert0_attn_split&#45;&gt;layer0_expert0_v_proj -->
<g id="edge7" class="edge">
<title>layer0_expert0_attn_split&#45;&gt;layer0_expert0_v_proj</title>
<path fill="none" stroke="black" d="M155238.74,-1181.32C155261.9,-1170.54 155285.99,-1159.34 155306.61,-1149.75"/>
<polygon fill="black" stroke="black" points="155308.23,-1152.86 155315.82,-1145.47 155305.27,-1146.51 155308.23,-1152.86"/>
</g>
<!-- layer0_expert0_attn -->
<g id="node9" class="node">
<title>layer0_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="155244.5,-1065.45 155047.5,-1065.45 155047.5,-1021.45 155244.5,-1021.45 155244.5,-1065.45"/>
<text text-anchor="middle" x="155146" y="-1055.05" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="155146" y="-1046.05" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-1037.05" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-1028.05" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert0_q_proj&#45;&gt;layer0_expert0_attn -->
<g id="edge8" class="edge">
<title>layer0_expert0_q_proj&#45;&gt;layer0_expert0_attn</title>
<path fill="none" stroke="black" d="M154988.9,-1101.45C155016.5,-1091.43 155049.69,-1079.39 155078.43,-1068.96"/>
<polygon fill="black" stroke="black" points="155079.79,-1072.19 155088,-1065.49 155077.4,-1065.61 155079.79,-1072.19"/>
</g>
<!-- layer0_expert0_k_proj&#45;&gt;layer0_expert0_attn -->
<g id="edge9" class="edge">
<title>layer0_expert0_k_proj&#45;&gt;layer0_expert0_attn</title>
<path fill="none" stroke="black" d="M155146,-1101.14C155146,-1093.25 155146,-1084.13 155146,-1075.55"/>
<polygon fill="black" stroke="black" points="155149.5,-1075.47 155146,-1065.47 155142.5,-1075.47 155149.5,-1075.47"/>
</g>
<!-- layer0_expert0_v_proj&#45;&gt;layer0_expert0_attn -->
<g id="edge10" class="edge">
<title>layer0_expert0_v_proj&#45;&gt;layer0_expert0_attn</title>
<path fill="none" stroke="black" d="M155303.1,-1101.45C155275.5,-1091.43 155242.31,-1079.39 155213.57,-1068.96"/>
<polygon fill="black" stroke="black" points="155214.6,-1065.61 155204,-1065.49 155212.21,-1072.19 155214.6,-1065.61"/>
</g>
<!-- layer0_expert0_attn_out -->
<g id="node10" class="node">
<title>layer0_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="155246,-985.45 155046,-985.45 155046,-941.45 155246,-941.45 155246,-985.45"/>
<text text-anchor="middle" x="155146" y="-975.05" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="155146" y="-966.05" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-957.05" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-948.05" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_attn&#45;&gt;layer0_expert0_attn_out -->
<g id="edge11" class="edge">
<title>layer0_expert0_attn&#45;&gt;layer0_expert0_attn_out</title>
<path fill="none" stroke="black" d="M155146,-1021.14C155146,-1013.25 155146,-1004.13 155146,-995.55"/>
<polygon fill="black" stroke="black" points="155149.5,-995.47 155146,-985.47 155142.5,-995.47 155149.5,-995.47"/>
</g>
<!-- layer0_expert0_attn_ar -->
<g id="node11" class="node">
<title>layer0_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="155146" cy="-874.34" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="155146" y="-885.94" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="155146" y="-876.94" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-867.94" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-858.94" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_attn_out&#45;&gt;layer0_expert0_attn_ar -->
<g id="edge12" class="edge">
<title>layer0_expert0_attn_out&#45;&gt;layer0_expert0_attn_ar</title>
<path fill="none" stroke="black" d="M155146,-941.36C155146,-933.69 155146,-924.74 155146,-915.94"/>
<polygon fill="black" stroke="black" points="155149.5,-915.78 155146,-905.78 155142.5,-915.78 155149.5,-915.78"/>
</g>
<!-- layer0_expert0_attn_res -->
<g id="node12" class="node">
<title>layer0_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="155353.2,-807.23 155023.59,-807.23 154938.8,-719.23 155268.41,-719.23 155353.2,-807.23"/>
<text text-anchor="middle" x="155146" y="-774.83" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="155146" y="-765.83" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-756.83" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-747.83" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_attn_ar&#45;&gt;layer0_expert0_attn_res -->
<g id="edge13" class="edge">
<title>layer0_expert0_attn_ar&#45;&gt;layer0_expert0_attn_res</title>
<path fill="none" stroke="black" d="M155146,-842.94C155146,-835.06 155146,-826.33 155146,-817.64"/>
<polygon fill="black" stroke="black" points="155149.5,-817.5 155146,-807.5 155142.5,-817.5 155149.5,-817.5"/>
</g>
<!-- layer0_expert0_ln1 -->
<g id="node13" class="node">
<title>layer0_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="155246,-683.23 155046,-683.23 155046,-639.23 155246,-639.23 155246,-683.23"/>
<text text-anchor="middle" x="155146" y="-672.83" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="155146" y="-663.83" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-654.83" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-645.83" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_attn_res&#45;&gt;layer0_expert0_ln1 -->
<g id="edge14" class="edge">
<title>layer0_expert0_attn_res&#45;&gt;layer0_expert0_ln1</title>
<path fill="none" stroke="black" d="M155146,-718.95C155146,-710.36 155146,-701.5 155146,-693.41"/>
<polygon fill="black" stroke="black" points="155149.5,-693.31 155146,-683.31 155142.5,-693.31 155149.5,-693.31"/>
</g>
<!-- layer0_expert0_mlp1 -->
<g id="node14" class="node">
<title>layer0_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="155244,-603.23 155048,-603.23 155048,-559.23 155244,-559.23 155244,-603.23"/>
<text text-anchor="middle" x="155146" y="-592.83" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="155146" y="-583.83" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-574.83" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-565.83" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert0_ln1&#45;&gt;layer0_expert0_mlp1 -->
<g id="edge15" class="edge">
<title>layer0_expert0_ln1&#45;&gt;layer0_expert0_mlp1</title>
<path fill="none" stroke="black" d="M155146,-638.91C155146,-631.02 155146,-621.91 155146,-613.33"/>
<polygon fill="black" stroke="black" points="155149.5,-613.24 155146,-603.24 155142.5,-613.24 155149.5,-613.24"/>
</g>
<!-- layer0_expert0_gelu -->
<g id="node15" class="node">
<title>layer0_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="155244,-523.23 155048,-523.23 155048,-479.23 155244,-479.23 155244,-523.23"/>
<text text-anchor="middle" x="155146" y="-512.83" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="155146" y="-503.83" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-494.83" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-485.83" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert0_mlp1&#45;&gt;layer0_expert0_gelu -->
<g id="edge16" class="edge">
<title>layer0_expert0_mlp1&#45;&gt;layer0_expert0_gelu</title>
<path fill="none" stroke="black" d="M155146,-558.91C155146,-551.02 155146,-541.91 155146,-533.33"/>
<polygon fill="black" stroke="black" points="155149.5,-533.24 155146,-523.24 155142.5,-533.24 155149.5,-533.24"/>
</g>
<!-- layer0_expert0_mlp2 -->
<g id="node16" class="node">
<title>layer0_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="155246,-443.23 155046,-443.23 155046,-399.23 155246,-399.23 155246,-443.23"/>
<text text-anchor="middle" x="155146" y="-432.83" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="155146" y="-423.83" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-414.83" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-405.83" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_gelu&#45;&gt;layer0_expert0_mlp2 -->
<g id="edge17" class="edge">
<title>layer0_expert0_gelu&#45;&gt;layer0_expert0_mlp2</title>
<path fill="none" stroke="black" d="M155146,-478.91C155146,-471.02 155146,-461.91 155146,-453.33"/>
<polygon fill="black" stroke="black" points="155149.5,-453.24 155146,-443.24 155142.5,-453.24 155149.5,-453.24"/>
</g>
<!-- layer0_expert0_mlp_ar -->
<g id="node17" class="node">
<title>layer0_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="155146" cy="-332.11" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="155146" y="-343.71" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="155146" y="-334.71" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-325.71" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-316.71" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_mlp2&#45;&gt;layer0_expert0_mlp_ar -->
<g id="edge18" class="edge">
<title>layer0_expert0_mlp2&#45;&gt;layer0_expert0_mlp_ar</title>
<path fill="none" stroke="black" d="M155146,-399.14C155146,-391.47 155146,-382.51 155146,-373.72"/>
<polygon fill="black" stroke="black" points="155149.5,-373.56 155146,-363.56 155142.5,-373.56 155149.5,-373.56"/>
</g>
<!-- layer0_expert0_mlp_res -->
<g id="node18" class="node">
<title>layer0_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="155353.2,-265 155023.59,-265 154938.8,-177 155268.41,-177 155353.2,-265"/>
<text text-anchor="middle" x="155146" y="-232.6" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="155146" y="-223.6" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-214.6" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-205.6" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_mlp_ar&#45;&gt;layer0_expert0_mlp_res -->
<g id="edge19" class="edge">
<title>layer0_expert0_mlp_ar&#45;&gt;layer0_expert0_mlp_res</title>
<path fill="none" stroke="black" d="M155146,-300.72C155146,-292.83 155146,-284.1 155146,-275.41"/>
<polygon fill="black" stroke="black" points="155149.5,-275.28 155146,-265.28 155142.5,-275.28 155149.5,-275.28"/>
</g>
<!-- layer0_expert0_ln2 -->
<g id="node19" class="node">
<title>layer0_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="155246,-141 155046,-141 155046,-97 155246,-97 155246,-141"/>
<text text-anchor="middle" x="155146" y="-130.6" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="155146" y="-121.6" font-family="Arial" font-size="8.00">L0_E0</text>
<text text-anchor="middle" x="155146" y="-112.6" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="155146" y="-103.6" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_mlp_res&#45;&gt;layer0_expert0_ln2 -->
<g id="edge20" class="edge">
<title>layer0_expert0_mlp_res&#45;&gt;layer0_expert0_ln2</title>
<path fill="none" stroke="black" d="M155146,-176.72C155146,-168.13 155146,-159.27 155146,-151.19"/>
<polygon fill="black" stroke="black" points="155149.5,-151.08 155146,-141.08 155142.5,-151.08 155149.5,-151.08"/>
</g>
<!-- output -->
<g id="node2306" class="node">
<title>output</title>
<polygon fill="white" stroke="black" points="155321,-61 154971,-61 154971,0 155321,0 155321,-61"/>
<text text-anchor="middle" x="155146" y="-47.4" font-family="Arial Bold" font-size="12.00">Model Output</text>
<text text-anchor="middle" x="155146" y="-20.4" font-family="Arial Bold" font-size="12.00">Input: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
<text text-anchor="middle" x="155146" y="-7.4" font-family="Arial Bold" font-size="12.00">Output: [batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert0_ln2&#45;&gt;output -->
<g id="edge21" class="edge">
<title>layer0_expert0_ln2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M155146,-96.62C155146,-88.92 155146,-79.97 155146,-71.22"/>
<polygon fill="black" stroke="black" points="155149.5,-71.12 155146,-61.12 155142.5,-71.12 155149.5,-71.12"/>
</g>
<!-- layer0_expert1_route -->
<g id="node20" class="node">
<title>layer0_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="154808,-1593.68 154608,-1593.68 154608,-1549.68 154808,-1549.68 154808,-1593.68"/>
<text text-anchor="middle" x="154708" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="154708" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="154708" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="154708" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_gate -->
<g id="node21" class="node">
<title>layer0_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="154590.04,-1615.68 154275,-1615.68 154193.96,-1527.68 154509,-1527.68 154590.04,-1615.68"/>
<text text-anchor="middle" x="154392" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="154392" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="154392" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="154392" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert1_a2a -->
<g id="node22" class="node">
<title>layer0_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="154035" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="154035" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="154035" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="154035" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="154035" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_attn_split -->
<g id="node23" class="node">
<title>layer0_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="153875.48,-1615.68 153550.2,-1615.68 153466.52,-1527.68 153791.8,-1527.68 153875.48,-1615.68"/>
<text text-anchor="middle" x="153671" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="153671" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="153671" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="153671" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert1_q_proj -->
<g id="node24" class="node">
<title>layer0_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="153448.5,-1593.68 153251.5,-1593.68 153251.5,-1549.68 153448.5,-1549.68 153448.5,-1593.68"/>
<text text-anchor="middle" x="153350" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="153350" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="153350" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="153350" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert1_k_proj -->
<g id="node25" class="node">
<title>layer0_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="153233.5,-1593.68 153036.5,-1593.68 153036.5,-1549.68 153233.5,-1549.68 153233.5,-1593.68"/>
<text text-anchor="middle" x="153135" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="153135" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="153135" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="153135" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert1_v_proj -->
<g id="node26" class="node">
<title>layer0_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="153018.5,-1593.68 152821.5,-1593.68 152821.5,-1549.68 153018.5,-1549.68 153018.5,-1593.68"/>
<text text-anchor="middle" x="152920" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="152920" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="152920" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="152920" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert1_attn -->
<g id="node27" class="node">
<title>layer0_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="152803.5,-1593.68 152606.5,-1593.68 152606.5,-1549.68 152803.5,-1549.68 152803.5,-1593.68"/>
<text text-anchor="middle" x="152705" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="152705" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="152705" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="152705" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert1_attn_out -->
<g id="node28" class="node">
<title>layer0_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="152588,-1593.68 152388,-1593.68 152388,-1549.68 152588,-1549.68 152588,-1593.68"/>
<text text-anchor="middle" x="152488" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="152488" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="152488" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="152488" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_attn_ar -->
<g id="node29" class="node">
<title>layer0_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="152229" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="152229" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="152229" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="152229" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="152229" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_attn_res -->
<g id="node30" class="node">
<title>layer0_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="152069.2,-1615.68 151739.59,-1615.68 151654.8,-1527.68 151984.41,-1527.68 152069.2,-1615.68"/>
<text text-anchor="middle" x="151862" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="151862" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="151862" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="151862" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_ln1 -->
<g id="node31" class="node">
<title>layer0_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="151637,-1593.68 151437,-1593.68 151437,-1549.68 151637,-1549.68 151637,-1593.68"/>
<text text-anchor="middle" x="151537" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="151537" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="151537" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="151537" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_mlp1 -->
<g id="node32" class="node">
<title>layer0_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="151419,-1593.68 151223,-1593.68 151223,-1549.68 151419,-1549.68 151419,-1593.68"/>
<text text-anchor="middle" x="151321" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="151321" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="151321" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="151321" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert1_gelu -->
<g id="node33" class="node">
<title>layer0_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="151205,-1593.68 151009,-1593.68 151009,-1549.68 151205,-1549.68 151205,-1593.68"/>
<text text-anchor="middle" x="151107" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="151107" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="151107" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="151107" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert1_mlp2 -->
<g id="node34" class="node">
<title>layer0_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="150991,-1593.68 150791,-1593.68 150791,-1549.68 150991,-1549.68 150991,-1593.68"/>
<text text-anchor="middle" x="150891" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="150891" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="150891" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="150891" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_mlp_ar -->
<g id="node35" class="node">
<title>layer0_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="150632" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="150632" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="150632" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="150632" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="150632" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_mlp_res -->
<g id="node36" class="node">
<title>layer0_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="150472.2,-1615.68 150142.59,-1615.68 150057.8,-1527.68 150387.41,-1527.68 150472.2,-1615.68"/>
<text text-anchor="middle" x="150265" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="150265" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="150265" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="150265" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert1_ln2 -->
<g id="node37" class="node">
<title>layer0_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="150040,-1593.68 149840,-1593.68 149840,-1549.68 150040,-1549.68 150040,-1593.68"/>
<text text-anchor="middle" x="149940" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="149940" y="-1574.28" font-family="Arial" font-size="8.00">L0_E1</text>
<text text-anchor="middle" x="149940" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="149940" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_route -->
<g id="node38" class="node">
<title>layer0_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="149816,-1593.68 149616,-1593.68 149616,-1549.68 149816,-1549.68 149816,-1593.68"/>
<text text-anchor="middle" x="149716" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="149716" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="149716" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="149716" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_gate -->
<g id="node39" class="node">
<title>layer0_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="149598.04,-1615.68 149283,-1615.68 149201.96,-1527.68 149517,-1527.68 149598.04,-1615.68"/>
<text text-anchor="middle" x="149400" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="149400" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="149400" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="149400" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert2_a2a -->
<g id="node40" class="node">
<title>layer0_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="149043" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="149043" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="149043" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="149043" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="149043" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_attn_split -->
<g id="node41" class="node">
<title>layer0_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="148883.48,-1615.68 148558.2,-1615.68 148474.52,-1527.68 148799.8,-1527.68 148883.48,-1615.68"/>
<text text-anchor="middle" x="148679" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="148679" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="148679" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="148679" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert2_q_proj -->
<g id="node42" class="node">
<title>layer0_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="148456.5,-1593.68 148259.5,-1593.68 148259.5,-1549.68 148456.5,-1549.68 148456.5,-1593.68"/>
<text text-anchor="middle" x="148358" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="148358" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="148358" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="148358" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert2_k_proj -->
<g id="node43" class="node">
<title>layer0_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="148241.5,-1593.68 148044.5,-1593.68 148044.5,-1549.68 148241.5,-1549.68 148241.5,-1593.68"/>
<text text-anchor="middle" x="148143" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="148143" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="148143" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="148143" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert2_v_proj -->
<g id="node44" class="node">
<title>layer0_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="148026.5,-1593.68 147829.5,-1593.68 147829.5,-1549.68 148026.5,-1549.68 148026.5,-1593.68"/>
<text text-anchor="middle" x="147928" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="147928" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="147928" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="147928" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert2_attn -->
<g id="node45" class="node">
<title>layer0_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="147811.5,-1593.68 147614.5,-1593.68 147614.5,-1549.68 147811.5,-1549.68 147811.5,-1593.68"/>
<text text-anchor="middle" x="147713" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="147713" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="147713" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="147713" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert2_attn_out -->
<g id="node46" class="node">
<title>layer0_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="147596,-1593.68 147396,-1593.68 147396,-1549.68 147596,-1549.68 147596,-1593.68"/>
<text text-anchor="middle" x="147496" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="147496" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="147496" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="147496" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_attn_ar -->
<g id="node47" class="node">
<title>layer0_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="147237" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="147237" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="147237" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="147237" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="147237" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_attn_res -->
<g id="node48" class="node">
<title>layer0_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="147077.2,-1615.68 146747.59,-1615.68 146662.8,-1527.68 146992.41,-1527.68 147077.2,-1615.68"/>
<text text-anchor="middle" x="146870" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="146870" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="146870" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="146870" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_ln1 -->
<g id="node49" class="node">
<title>layer0_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="146645,-1593.68 146445,-1593.68 146445,-1549.68 146645,-1549.68 146645,-1593.68"/>
<text text-anchor="middle" x="146545" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="146545" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="146545" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="146545" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_mlp1 -->
<g id="node50" class="node">
<title>layer0_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="146427,-1593.68 146231,-1593.68 146231,-1549.68 146427,-1549.68 146427,-1593.68"/>
<text text-anchor="middle" x="146329" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="146329" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="146329" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="146329" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert2_gelu -->
<g id="node51" class="node">
<title>layer0_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="146213,-1593.68 146017,-1593.68 146017,-1549.68 146213,-1549.68 146213,-1593.68"/>
<text text-anchor="middle" x="146115" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="146115" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="146115" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="146115" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert2_mlp2 -->
<g id="node52" class="node">
<title>layer0_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="145999,-1593.68 145799,-1593.68 145799,-1549.68 145999,-1549.68 145999,-1593.68"/>
<text text-anchor="middle" x="145899" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="145899" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="145899" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="145899" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_mlp_ar -->
<g id="node53" class="node">
<title>layer0_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="145640" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="145640" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="145640" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="145640" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="145640" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_mlp_res -->
<g id="node54" class="node">
<title>layer0_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="145480.2,-1615.68 145150.59,-1615.68 145065.8,-1527.68 145395.41,-1527.68 145480.2,-1615.68"/>
<text text-anchor="middle" x="145273" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="145273" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="145273" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="145273" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert2_ln2 -->
<g id="node55" class="node">
<title>layer0_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="145048,-1593.68 144848,-1593.68 144848,-1549.68 145048,-1549.68 145048,-1593.68"/>
<text text-anchor="middle" x="144948" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="144948" y="-1574.28" font-family="Arial" font-size="8.00">L0_E2</text>
<text text-anchor="middle" x="144948" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="144948" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_route -->
<g id="node56" class="node">
<title>layer0_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="144824,-1593.68 144624,-1593.68 144624,-1549.68 144824,-1549.68 144824,-1593.68"/>
<text text-anchor="middle" x="144724" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="144724" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="144724" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="144724" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_gate -->
<g id="node57" class="node">
<title>layer0_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="144606.04,-1615.68 144291,-1615.68 144209.96,-1527.68 144525,-1527.68 144606.04,-1615.68"/>
<text text-anchor="middle" x="144408" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="144408" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="144408" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="144408" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert3_a2a -->
<g id="node58" class="node">
<title>layer0_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="144051" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="144051" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="144051" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="144051" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="144051" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_attn_split -->
<g id="node59" class="node">
<title>layer0_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="143891.48,-1615.68 143566.2,-1615.68 143482.52,-1527.68 143807.8,-1527.68 143891.48,-1615.68"/>
<text text-anchor="middle" x="143687" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="143687" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="143687" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="143687" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert3_q_proj -->
<g id="node60" class="node">
<title>layer0_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="143464.5,-1593.68 143267.5,-1593.68 143267.5,-1549.68 143464.5,-1549.68 143464.5,-1593.68"/>
<text text-anchor="middle" x="143366" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="143366" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="143366" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="143366" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert3_k_proj -->
<g id="node61" class="node">
<title>layer0_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="143249.5,-1593.68 143052.5,-1593.68 143052.5,-1549.68 143249.5,-1549.68 143249.5,-1593.68"/>
<text text-anchor="middle" x="143151" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="143151" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="143151" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="143151" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert3_v_proj -->
<g id="node62" class="node">
<title>layer0_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="143034.5,-1593.68 142837.5,-1593.68 142837.5,-1549.68 143034.5,-1549.68 143034.5,-1593.68"/>
<text text-anchor="middle" x="142936" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="142936" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="142936" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="142936" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert3_attn -->
<g id="node63" class="node">
<title>layer0_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="142819.5,-1593.68 142622.5,-1593.68 142622.5,-1549.68 142819.5,-1549.68 142819.5,-1593.68"/>
<text text-anchor="middle" x="142721" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="142721" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="142721" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="142721" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert3_attn_out -->
<g id="node64" class="node">
<title>layer0_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="142604,-1593.68 142404,-1593.68 142404,-1549.68 142604,-1549.68 142604,-1593.68"/>
<text text-anchor="middle" x="142504" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="142504" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="142504" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="142504" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_attn_ar -->
<g id="node65" class="node">
<title>layer0_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="142245" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="142245" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="142245" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="142245" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="142245" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_attn_res -->
<g id="node66" class="node">
<title>layer0_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="142085.2,-1615.68 141755.59,-1615.68 141670.8,-1527.68 142000.41,-1527.68 142085.2,-1615.68"/>
<text text-anchor="middle" x="141878" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="141878" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="141878" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="141878" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_ln1 -->
<g id="node67" class="node">
<title>layer0_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="141653,-1593.68 141453,-1593.68 141453,-1549.68 141653,-1549.68 141653,-1593.68"/>
<text text-anchor="middle" x="141553" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="141553" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="141553" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="141553" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_mlp1 -->
<g id="node68" class="node">
<title>layer0_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="141435,-1593.68 141239,-1593.68 141239,-1549.68 141435,-1549.68 141435,-1593.68"/>
<text text-anchor="middle" x="141337" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="141337" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="141337" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="141337" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert3_gelu -->
<g id="node69" class="node">
<title>layer0_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="141221,-1593.68 141025,-1593.68 141025,-1549.68 141221,-1549.68 141221,-1593.68"/>
<text text-anchor="middle" x="141123" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="141123" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="141123" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="141123" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert3_mlp2 -->
<g id="node70" class="node">
<title>layer0_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="141007,-1593.68 140807,-1593.68 140807,-1549.68 141007,-1549.68 141007,-1593.68"/>
<text text-anchor="middle" x="140907" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="140907" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="140907" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="140907" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_mlp_ar -->
<g id="node71" class="node">
<title>layer0_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="140648" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="140648" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="140648" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="140648" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="140648" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_mlp_res -->
<g id="node72" class="node">
<title>layer0_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="140488.2,-1615.68 140158.59,-1615.68 140073.8,-1527.68 140403.41,-1527.68 140488.2,-1615.68"/>
<text text-anchor="middle" x="140281" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="140281" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="140281" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="140281" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert3_ln2 -->
<g id="node73" class="node">
<title>layer0_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="140056,-1593.68 139856,-1593.68 139856,-1549.68 140056,-1549.68 140056,-1593.68"/>
<text text-anchor="middle" x="139956" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="139956" y="-1574.28" font-family="Arial" font-size="8.00">L0_E3</text>
<text text-anchor="middle" x="139956" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="139956" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_route -->
<g id="node74" class="node">
<title>layer0_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="139832,-1593.68 139632,-1593.68 139632,-1549.68 139832,-1549.68 139832,-1593.68"/>
<text text-anchor="middle" x="139732" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="139732" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="139732" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="139732" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_gate -->
<g id="node75" class="node">
<title>layer0_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="139614.04,-1615.68 139299,-1615.68 139217.96,-1527.68 139533,-1527.68 139614.04,-1615.68"/>
<text text-anchor="middle" x="139416" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="139416" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="139416" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="139416" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert4_a2a -->
<g id="node76" class="node">
<title>layer0_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="139059" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="139059" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="139059" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="139059" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="139059" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_attn_split -->
<g id="node77" class="node">
<title>layer0_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="138899.48,-1615.68 138574.2,-1615.68 138490.52,-1527.68 138815.8,-1527.68 138899.48,-1615.68"/>
<text text-anchor="middle" x="138695" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="138695" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="138695" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="138695" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert4_q_proj -->
<g id="node78" class="node">
<title>layer0_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="138472.5,-1593.68 138275.5,-1593.68 138275.5,-1549.68 138472.5,-1549.68 138472.5,-1593.68"/>
<text text-anchor="middle" x="138374" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="138374" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="138374" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="138374" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert4_k_proj -->
<g id="node79" class="node">
<title>layer0_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="138257.5,-1593.68 138060.5,-1593.68 138060.5,-1549.68 138257.5,-1549.68 138257.5,-1593.68"/>
<text text-anchor="middle" x="138159" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="138159" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="138159" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="138159" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert4_v_proj -->
<g id="node80" class="node">
<title>layer0_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="138042.5,-1593.68 137845.5,-1593.68 137845.5,-1549.68 138042.5,-1549.68 138042.5,-1593.68"/>
<text text-anchor="middle" x="137944" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="137944" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="137944" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="137944" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert4_attn -->
<g id="node81" class="node">
<title>layer0_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="137827.5,-1593.68 137630.5,-1593.68 137630.5,-1549.68 137827.5,-1549.68 137827.5,-1593.68"/>
<text text-anchor="middle" x="137729" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="137729" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="137729" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="137729" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert4_attn_out -->
<g id="node82" class="node">
<title>layer0_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="137612,-1593.68 137412,-1593.68 137412,-1549.68 137612,-1549.68 137612,-1593.68"/>
<text text-anchor="middle" x="137512" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="137512" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="137512" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="137512" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_attn_ar -->
<g id="node83" class="node">
<title>layer0_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="137253" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="137253" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="137253" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="137253" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="137253" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_attn_res -->
<g id="node84" class="node">
<title>layer0_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="137093.2,-1615.68 136763.59,-1615.68 136678.8,-1527.68 137008.41,-1527.68 137093.2,-1615.68"/>
<text text-anchor="middle" x="136886" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="136886" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="136886" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="136886" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_ln1 -->
<g id="node85" class="node">
<title>layer0_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="136661,-1593.68 136461,-1593.68 136461,-1549.68 136661,-1549.68 136661,-1593.68"/>
<text text-anchor="middle" x="136561" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="136561" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="136561" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="136561" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_mlp1 -->
<g id="node86" class="node">
<title>layer0_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="136443,-1593.68 136247,-1593.68 136247,-1549.68 136443,-1549.68 136443,-1593.68"/>
<text text-anchor="middle" x="136345" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="136345" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="136345" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="136345" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert4_gelu -->
<g id="node87" class="node">
<title>layer0_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="136229,-1593.68 136033,-1593.68 136033,-1549.68 136229,-1549.68 136229,-1593.68"/>
<text text-anchor="middle" x="136131" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="136131" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="136131" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="136131" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert4_mlp2 -->
<g id="node88" class="node">
<title>layer0_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="136015,-1593.68 135815,-1593.68 135815,-1549.68 136015,-1549.68 136015,-1593.68"/>
<text text-anchor="middle" x="135915" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="135915" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="135915" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="135915" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_mlp_ar -->
<g id="node89" class="node">
<title>layer0_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="135656" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="135656" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="135656" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="135656" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="135656" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_mlp_res -->
<g id="node90" class="node">
<title>layer0_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="135496.2,-1615.68 135166.59,-1615.68 135081.8,-1527.68 135411.41,-1527.68 135496.2,-1615.68"/>
<text text-anchor="middle" x="135289" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="135289" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="135289" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="135289" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert4_ln2 -->
<g id="node91" class="node">
<title>layer0_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="135064,-1593.68 134864,-1593.68 134864,-1549.68 135064,-1549.68 135064,-1593.68"/>
<text text-anchor="middle" x="134964" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="134964" y="-1574.28" font-family="Arial" font-size="8.00">L0_E4</text>
<text text-anchor="middle" x="134964" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="134964" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_route -->
<g id="node92" class="node">
<title>layer0_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="134840,-1593.68 134640,-1593.68 134640,-1549.68 134840,-1549.68 134840,-1593.68"/>
<text text-anchor="middle" x="134740" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="134740" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="134740" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="134740" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_gate -->
<g id="node93" class="node">
<title>layer0_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="134622.04,-1615.68 134307,-1615.68 134225.96,-1527.68 134541,-1527.68 134622.04,-1615.68"/>
<text text-anchor="middle" x="134424" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="134424" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="134424" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="134424" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert5_a2a -->
<g id="node94" class="node">
<title>layer0_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="134067" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="134067" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="134067" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="134067" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="134067" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_attn_split -->
<g id="node95" class="node">
<title>layer0_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="133907.48,-1615.68 133582.2,-1615.68 133498.52,-1527.68 133823.8,-1527.68 133907.48,-1615.68"/>
<text text-anchor="middle" x="133703" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="133703" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="133703" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="133703" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert5_q_proj -->
<g id="node96" class="node">
<title>layer0_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="133480.5,-1593.68 133283.5,-1593.68 133283.5,-1549.68 133480.5,-1549.68 133480.5,-1593.68"/>
<text text-anchor="middle" x="133382" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="133382" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="133382" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="133382" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert5_k_proj -->
<g id="node97" class="node">
<title>layer0_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="133265.5,-1593.68 133068.5,-1593.68 133068.5,-1549.68 133265.5,-1549.68 133265.5,-1593.68"/>
<text text-anchor="middle" x="133167" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="133167" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="133167" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="133167" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert5_v_proj -->
<g id="node98" class="node">
<title>layer0_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="133050.5,-1593.68 132853.5,-1593.68 132853.5,-1549.68 133050.5,-1549.68 133050.5,-1593.68"/>
<text text-anchor="middle" x="132952" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="132952" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="132952" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="132952" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert5_attn -->
<g id="node99" class="node">
<title>layer0_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="132835.5,-1593.68 132638.5,-1593.68 132638.5,-1549.68 132835.5,-1549.68 132835.5,-1593.68"/>
<text text-anchor="middle" x="132737" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="132737" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="132737" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="132737" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert5_attn_out -->
<g id="node100" class="node">
<title>layer0_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="132620,-1593.68 132420,-1593.68 132420,-1549.68 132620,-1549.68 132620,-1593.68"/>
<text text-anchor="middle" x="132520" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="132520" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="132520" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="132520" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_attn_ar -->
<g id="node101" class="node">
<title>layer0_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="132261" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="132261" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="132261" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="132261" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="132261" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_attn_res -->
<g id="node102" class="node">
<title>layer0_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="132101.2,-1615.68 131771.59,-1615.68 131686.8,-1527.68 132016.41,-1527.68 132101.2,-1615.68"/>
<text text-anchor="middle" x="131894" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="131894" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="131894" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="131894" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_ln1 -->
<g id="node103" class="node">
<title>layer0_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="131669,-1593.68 131469,-1593.68 131469,-1549.68 131669,-1549.68 131669,-1593.68"/>
<text text-anchor="middle" x="131569" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="131569" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="131569" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="131569" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_mlp1 -->
<g id="node104" class="node">
<title>layer0_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="131451,-1593.68 131255,-1593.68 131255,-1549.68 131451,-1549.68 131451,-1593.68"/>
<text text-anchor="middle" x="131353" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="131353" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="131353" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="131353" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert5_gelu -->
<g id="node105" class="node">
<title>layer0_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="131237,-1593.68 131041,-1593.68 131041,-1549.68 131237,-1549.68 131237,-1593.68"/>
<text text-anchor="middle" x="131139" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="131139" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="131139" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="131139" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert5_mlp2 -->
<g id="node106" class="node">
<title>layer0_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="131023,-1593.68 130823,-1593.68 130823,-1549.68 131023,-1549.68 131023,-1593.68"/>
<text text-anchor="middle" x="130923" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="130923" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="130923" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="130923" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_mlp_ar -->
<g id="node107" class="node">
<title>layer0_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="130664" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="130664" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="130664" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="130664" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="130664" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_mlp_res -->
<g id="node108" class="node">
<title>layer0_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="130504.2,-1615.68 130174.59,-1615.68 130089.8,-1527.68 130419.41,-1527.68 130504.2,-1615.68"/>
<text text-anchor="middle" x="130297" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="130297" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="130297" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="130297" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert5_ln2 -->
<g id="node109" class="node">
<title>layer0_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="130072,-1593.68 129872,-1593.68 129872,-1549.68 130072,-1549.68 130072,-1593.68"/>
<text text-anchor="middle" x="129972" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="129972" y="-1574.28" font-family="Arial" font-size="8.00">L0_E5</text>
<text text-anchor="middle" x="129972" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="129972" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_route -->
<g id="node110" class="node">
<title>layer0_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="129848,-1593.68 129648,-1593.68 129648,-1549.68 129848,-1549.68 129848,-1593.68"/>
<text text-anchor="middle" x="129748" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="129748" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="129748" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="129748" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_gate -->
<g id="node111" class="node">
<title>layer0_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="129630.04,-1615.68 129315,-1615.68 129233.96,-1527.68 129549,-1527.68 129630.04,-1615.68"/>
<text text-anchor="middle" x="129432" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="129432" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="129432" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="129432" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert6_a2a -->
<g id="node112" class="node">
<title>layer0_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="129075" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="129075" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="129075" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="129075" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="129075" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_attn_split -->
<g id="node113" class="node">
<title>layer0_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="128915.48,-1615.68 128590.2,-1615.68 128506.52,-1527.68 128831.8,-1527.68 128915.48,-1615.68"/>
<text text-anchor="middle" x="128711" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="128711" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="128711" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="128711" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert6_q_proj -->
<g id="node114" class="node">
<title>layer0_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="128488.5,-1593.68 128291.5,-1593.68 128291.5,-1549.68 128488.5,-1549.68 128488.5,-1593.68"/>
<text text-anchor="middle" x="128390" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="128390" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="128390" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="128390" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert6_k_proj -->
<g id="node115" class="node">
<title>layer0_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="128273.5,-1593.68 128076.5,-1593.68 128076.5,-1549.68 128273.5,-1549.68 128273.5,-1593.68"/>
<text text-anchor="middle" x="128175" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="128175" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="128175" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="128175" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert6_v_proj -->
<g id="node116" class="node">
<title>layer0_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="128058.5,-1593.68 127861.5,-1593.68 127861.5,-1549.68 128058.5,-1549.68 128058.5,-1593.68"/>
<text text-anchor="middle" x="127960" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="127960" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="127960" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="127960" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert6_attn -->
<g id="node117" class="node">
<title>layer0_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="127843.5,-1593.68 127646.5,-1593.68 127646.5,-1549.68 127843.5,-1549.68 127843.5,-1593.68"/>
<text text-anchor="middle" x="127745" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="127745" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="127745" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="127745" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert6_attn_out -->
<g id="node118" class="node">
<title>layer0_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="127628,-1593.68 127428,-1593.68 127428,-1549.68 127628,-1549.68 127628,-1593.68"/>
<text text-anchor="middle" x="127528" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="127528" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="127528" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="127528" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_attn_ar -->
<g id="node119" class="node">
<title>layer0_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="127269" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="127269" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="127269" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="127269" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="127269" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_attn_res -->
<g id="node120" class="node">
<title>layer0_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="127109.2,-1615.68 126779.59,-1615.68 126694.8,-1527.68 127024.41,-1527.68 127109.2,-1615.68"/>
<text text-anchor="middle" x="126902" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="126902" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="126902" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="126902" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_ln1 -->
<g id="node121" class="node">
<title>layer0_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="126677,-1593.68 126477,-1593.68 126477,-1549.68 126677,-1549.68 126677,-1593.68"/>
<text text-anchor="middle" x="126577" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="126577" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="126577" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="126577" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_mlp1 -->
<g id="node122" class="node">
<title>layer0_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="126459,-1593.68 126263,-1593.68 126263,-1549.68 126459,-1549.68 126459,-1593.68"/>
<text text-anchor="middle" x="126361" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="126361" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="126361" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="126361" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert6_gelu -->
<g id="node123" class="node">
<title>layer0_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="126245,-1593.68 126049,-1593.68 126049,-1549.68 126245,-1549.68 126245,-1593.68"/>
<text text-anchor="middle" x="126147" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="126147" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="126147" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="126147" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert6_mlp2 -->
<g id="node124" class="node">
<title>layer0_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="126031,-1593.68 125831,-1593.68 125831,-1549.68 126031,-1549.68 126031,-1593.68"/>
<text text-anchor="middle" x="125931" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="125931" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="125931" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="125931" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_mlp_ar -->
<g id="node125" class="node">
<title>layer0_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="125672" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="125672" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="125672" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="125672" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="125672" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_mlp_res -->
<g id="node126" class="node">
<title>layer0_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="125512.2,-1615.68 125182.59,-1615.68 125097.8,-1527.68 125427.41,-1527.68 125512.2,-1615.68"/>
<text text-anchor="middle" x="125305" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="125305" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="125305" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="125305" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert6_ln2 -->
<g id="node127" class="node">
<title>layer0_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="125080,-1593.68 124880,-1593.68 124880,-1549.68 125080,-1549.68 125080,-1593.68"/>
<text text-anchor="middle" x="124980" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="124980" y="-1574.28" font-family="Arial" font-size="8.00">L0_E6</text>
<text text-anchor="middle" x="124980" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="124980" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_route -->
<g id="node128" class="node">
<title>layer0_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="124856,-1593.68 124656,-1593.68 124656,-1549.68 124856,-1549.68 124856,-1593.68"/>
<text text-anchor="middle" x="124756" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="124756" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="124756" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="124756" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_gate -->
<g id="node129" class="node">
<title>layer0_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="124638.04,-1615.68 124323,-1615.68 124241.96,-1527.68 124557,-1527.68 124638.04,-1615.68"/>
<text text-anchor="middle" x="124440" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="124440" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="124440" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="124440" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer0_expert7_a2a -->
<g id="node130" class="node">
<title>layer0_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="124083" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="124083" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="124083" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="124083" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="124083" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_attn_split -->
<g id="node131" class="node">
<title>layer0_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="123923.48,-1615.68 123598.2,-1615.68 123514.52,-1527.68 123839.8,-1527.68 123923.48,-1615.68"/>
<text text-anchor="middle" x="123719" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="123719" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="123719" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="123719" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert7_q_proj -->
<g id="node132" class="node">
<title>layer0_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="123496.5,-1593.68 123299.5,-1593.68 123299.5,-1549.68 123496.5,-1549.68 123496.5,-1593.68"/>
<text text-anchor="middle" x="123398" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="123398" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="123398" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="123398" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert7_k_proj -->
<g id="node133" class="node">
<title>layer0_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="123281.5,-1593.68 123084.5,-1593.68 123084.5,-1549.68 123281.5,-1549.68 123281.5,-1593.68"/>
<text text-anchor="middle" x="123183" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="123183" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="123183" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="123183" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert7_v_proj -->
<g id="node134" class="node">
<title>layer0_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="123066.5,-1593.68 122869.5,-1593.68 122869.5,-1549.68 123066.5,-1549.68 123066.5,-1593.68"/>
<text text-anchor="middle" x="122968" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="122968" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="122968" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="122968" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert7_attn -->
<g id="node135" class="node">
<title>layer0_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="122851.5,-1593.68 122654.5,-1593.68 122654.5,-1549.68 122851.5,-1549.68 122851.5,-1593.68"/>
<text text-anchor="middle" x="122753" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="122753" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="122753" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="122753" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer0_expert7_attn_out -->
<g id="node136" class="node">
<title>layer0_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="122636,-1593.68 122436,-1593.68 122436,-1549.68 122636,-1549.68 122636,-1593.68"/>
<text text-anchor="middle" x="122536" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="122536" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="122536" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="122536" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_attn_ar -->
<g id="node137" class="node">
<title>layer0_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="122277" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="122277" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="122277" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="122277" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="122277" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_attn_res -->
<g id="node138" class="node">
<title>layer0_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="122117.2,-1615.68 121787.59,-1615.68 121702.8,-1527.68 122032.41,-1527.68 122117.2,-1615.68"/>
<text text-anchor="middle" x="121910" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="121910" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="121910" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="121910" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_ln1 -->
<g id="node139" class="node">
<title>layer0_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="121685,-1593.68 121485,-1593.68 121485,-1549.68 121685,-1549.68 121685,-1593.68"/>
<text text-anchor="middle" x="121585" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="121585" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="121585" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="121585" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_mlp1 -->
<g id="node140" class="node">
<title>layer0_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="121467,-1593.68 121271,-1593.68 121271,-1549.68 121467,-1549.68 121467,-1593.68"/>
<text text-anchor="middle" x="121369" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="121369" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="121369" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="121369" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert7_gelu -->
<g id="node141" class="node">
<title>layer0_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="121253,-1593.68 121057,-1593.68 121057,-1549.68 121253,-1549.68 121253,-1593.68"/>
<text text-anchor="middle" x="121155" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="121155" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="121155" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="121155" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer0_expert7_mlp2 -->
<g id="node142" class="node">
<title>layer0_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="121039,-1593.68 120839,-1593.68 120839,-1549.68 121039,-1549.68 121039,-1593.68"/>
<text text-anchor="middle" x="120939" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="120939" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="120939" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="120939" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_mlp_ar -->
<g id="node143" class="node">
<title>layer0_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="120680" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="120680" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="120680" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="120680" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="120680" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_mlp_res -->
<g id="node144" class="node">
<title>layer0_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="120520.2,-1615.68 120190.59,-1615.68 120105.8,-1527.68 120435.41,-1527.68 120520.2,-1615.68"/>
<text text-anchor="middle" x="120313" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="120313" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="120313" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="120313" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer0_expert7_ln2 -->
<g id="node145" class="node">
<title>layer0_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="120088,-1593.68 119888,-1593.68 119888,-1549.68 120088,-1549.68 120088,-1593.68"/>
<text text-anchor="middle" x="119988" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="119988" y="-1574.28" font-family="Arial" font-size="8.00">L0_E7</text>
<text text-anchor="middle" x="119988" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="119988" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert0_route -->
<g id="node146" class="node">
<title>layer1_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="119848,-1593.68 119648,-1593.68 119648,-1549.68 119848,-1549.68 119848,-1593.68"/>
<text text-anchor="middle" x="119748" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="119748" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="119748" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="119748" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert0_gate -->
<g id="node147" class="node">
<title>layer1_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="119630.04,-1615.68 119315,-1615.68 119233.96,-1527.68 119549,-1527.68 119630.04,-1615.68"/>
<text text-anchor="middle" x="119432" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="119432" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="119432" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="119432" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer1_expert0_a2a -->
<g id="node148" class="node">
<title>layer1_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="119075" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="119075" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="119075" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="119075" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="119075" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert0_attn_split -->
<g id="node149" class="node">
<title>layer1_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="118915.48,-1615.68 118590.2,-1615.68 118506.52,-1527.68 118831.8,-1527.68 118915.48,-1615.68"/>
<text text-anchor="middle" x="118711" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="118711" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="118711" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="118711" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert0_q_proj -->
<g id="node150" class="node">
<title>layer1_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="118488.5,-1593.68 118291.5,-1593.68 118291.5,-1549.68 118488.5,-1549.68 118488.5,-1593.68"/>
<text text-anchor="middle" x="118390" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="118390" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="118390" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="118390" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert0_k_proj -->
<g id="node151" class="node">
<title>layer1_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="118273.5,-1593.68 118076.5,-1593.68 118076.5,-1549.68 118273.5,-1549.68 118273.5,-1593.68"/>
<text text-anchor="middle" x="118175" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="118175" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="118175" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="118175" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert0_v_proj -->
<g id="node152" class="node">
<title>layer1_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="118058.5,-1593.68 117861.5,-1593.68 117861.5,-1549.68 118058.5,-1549.68 118058.5,-1593.68"/>
<text text-anchor="middle" x="117960" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="117960" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="117960" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="117960" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert0_attn -->
<g id="node153" class="node">
<title>layer1_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="117843.5,-1593.68 117646.5,-1593.68 117646.5,-1549.68 117843.5,-1549.68 117843.5,-1593.68"/>
<text text-anchor="middle" x="117745" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="117745" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="117745" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="117745" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert0_attn_out -->
<g id="node154" class="node">
<title>layer1_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="117628,-1593.68 117428,-1593.68 117428,-1549.68 117628,-1549.68 117628,-1593.68"/>
<text text-anchor="middle" x="117528" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="117528" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="117528" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="117528" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert0_attn_ar -->
<g id="node155" class="node">
<title>layer1_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="117269" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="117269" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="117269" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="117269" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="117269" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert0_attn_res -->
<g id="node156" class="node">
<title>layer1_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="117109.2,-1615.68 116779.59,-1615.68 116694.8,-1527.68 117024.41,-1527.68 117109.2,-1615.68"/>
<text text-anchor="middle" x="116902" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="116902" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="116902" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="116902" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert0_ln1 -->
<g id="node157" class="node">
<title>layer1_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="116677,-1593.68 116477,-1593.68 116477,-1549.68 116677,-1549.68 116677,-1593.68"/>
<text text-anchor="middle" x="116577" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="116577" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="116577" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="116577" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert0_mlp1 -->
<g id="node158" class="node">
<title>layer1_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="116459,-1593.68 116263,-1593.68 116263,-1549.68 116459,-1549.68 116459,-1593.68"/>
<text text-anchor="middle" x="116361" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="116361" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="116361" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="116361" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert0_gelu -->
<g id="node159" class="node">
<title>layer1_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="116245,-1593.68 116049,-1593.68 116049,-1549.68 116245,-1549.68 116245,-1593.68"/>
<text text-anchor="middle" x="116147" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="116147" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="116147" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="116147" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert0_mlp2 -->
<g id="node160" class="node">
<title>layer1_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="116031,-1593.68 115831,-1593.68 115831,-1549.68 116031,-1549.68 116031,-1593.68"/>
<text text-anchor="middle" x="115931" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="115931" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="115931" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="115931" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert0_mlp_ar -->
<g id="node161" class="node">
<title>layer1_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="115672" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="115672" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="115672" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="115672" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="115672" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert0_mlp_res -->
<g id="node162" class="node">
<title>layer1_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="115512.2,-1615.68 115182.59,-1615.68 115097.8,-1527.68 115427.41,-1527.68 115512.2,-1615.68"/>
<text text-anchor="middle" x="115305" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="115305" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="115305" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="115305" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert0_ln2 -->
<g id="node163" class="node">
<title>layer1_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="115080,-1593.68 114880,-1593.68 114880,-1549.68 115080,-1549.68 115080,-1593.68"/>
<text text-anchor="middle" x="114980" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="114980" y="-1574.28" font-family="Arial" font-size="8.00">L1_E0</text>
<text text-anchor="middle" x="114980" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="114980" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert1_route -->
<g id="node164" class="node">
<title>layer1_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="114856,-1593.68 114656,-1593.68 114656,-1549.68 114856,-1549.68 114856,-1593.68"/>
<text text-anchor="middle" x="114756" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="114756" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="114756" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="114756" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert1_gate -->
<g id="node165" class="node">
<title>layer1_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="114638.04,-1615.68 114323,-1615.68 114241.96,-1527.68 114557,-1527.68 114638.04,-1615.68"/>
<text text-anchor="middle" x="114440" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="114440" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="114440" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="114440" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer1_expert1_a2a -->
<g id="node166" class="node">
<title>layer1_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="114083" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="114083" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="114083" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="114083" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="114083" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert1_attn_split -->
<g id="node167" class="node">
<title>layer1_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="113923.48,-1615.68 113598.2,-1615.68 113514.52,-1527.68 113839.8,-1527.68 113923.48,-1615.68"/>
<text text-anchor="middle" x="113719" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="113719" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="113719" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="113719" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert1_q_proj -->
<g id="node168" class="node">
<title>layer1_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="113496.5,-1593.68 113299.5,-1593.68 113299.5,-1549.68 113496.5,-1549.68 113496.5,-1593.68"/>
<text text-anchor="middle" x="113398" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="113398" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="113398" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="113398" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert1_k_proj -->
<g id="node169" class="node">
<title>layer1_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="113281.5,-1593.68 113084.5,-1593.68 113084.5,-1549.68 113281.5,-1549.68 113281.5,-1593.68"/>
<text text-anchor="middle" x="113183" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="113183" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="113183" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="113183" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert1_v_proj -->
<g id="node170" class="node">
<title>layer1_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="113066.5,-1593.68 112869.5,-1593.68 112869.5,-1549.68 113066.5,-1549.68 113066.5,-1593.68"/>
<text text-anchor="middle" x="112968" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="112968" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="112968" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="112968" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert1_attn -->
<g id="node171" class="node">
<title>layer1_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="112851.5,-1593.68 112654.5,-1593.68 112654.5,-1549.68 112851.5,-1549.68 112851.5,-1593.68"/>
<text text-anchor="middle" x="112753" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="112753" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="112753" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="112753" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert1_attn_out -->
<g id="node172" class="node">
<title>layer1_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="112636,-1593.68 112436,-1593.68 112436,-1549.68 112636,-1549.68 112636,-1593.68"/>
<text text-anchor="middle" x="112536" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="112536" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="112536" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="112536" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert1_attn_ar -->
<g id="node173" class="node">
<title>layer1_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="112277" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="112277" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="112277" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="112277" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="112277" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert1_attn_res -->
<g id="node174" class="node">
<title>layer1_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="112117.2,-1615.68 111787.59,-1615.68 111702.8,-1527.68 112032.41,-1527.68 112117.2,-1615.68"/>
<text text-anchor="middle" x="111910" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="111910" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="111910" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="111910" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert1_ln1 -->
<g id="node175" class="node">
<title>layer1_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="111685,-1593.68 111485,-1593.68 111485,-1549.68 111685,-1549.68 111685,-1593.68"/>
<text text-anchor="middle" x="111585" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="111585" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="111585" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="111585" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert1_mlp1 -->
<g id="node176" class="node">
<title>layer1_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="111467,-1593.68 111271,-1593.68 111271,-1549.68 111467,-1549.68 111467,-1593.68"/>
<text text-anchor="middle" x="111369" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="111369" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="111369" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="111369" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert1_gelu -->
<g id="node177" class="node">
<title>layer1_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="111253,-1593.68 111057,-1593.68 111057,-1549.68 111253,-1549.68 111253,-1593.68"/>
<text text-anchor="middle" x="111155" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="111155" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="111155" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="111155" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert1_mlp2 -->
<g id="node178" class="node">
<title>layer1_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="111039,-1593.68 110839,-1593.68 110839,-1549.68 111039,-1549.68 111039,-1593.68"/>
<text text-anchor="middle" x="110939" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="110939" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="110939" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="110939" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert1_mlp_ar -->
<g id="node179" class="node">
<title>layer1_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="110680" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="110680" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="110680" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="110680" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="110680" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert1_mlp_res -->
<g id="node180" class="node">
<title>layer1_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="110520.2,-1615.68 110190.59,-1615.68 110105.8,-1527.68 110435.41,-1527.68 110520.2,-1615.68"/>
<text text-anchor="middle" x="110313" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="110313" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="110313" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="110313" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert1_ln2 -->
<g id="node181" class="node">
<title>layer1_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="110088,-1593.68 109888,-1593.68 109888,-1549.68 110088,-1549.68 110088,-1593.68"/>
<text text-anchor="middle" x="109988" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="109988" y="-1574.28" font-family="Arial" font-size="8.00">L1_E1</text>
<text text-anchor="middle" x="109988" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="109988" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert2_route -->
<g id="node182" class="node">
<title>layer1_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="109864,-1593.68 109664,-1593.68 109664,-1549.68 109864,-1549.68 109864,-1593.68"/>
<text text-anchor="middle" x="109764" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="109764" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="109764" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="109764" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert2_gate -->
<g id="node183" class="node">
<title>layer1_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="109646.04,-1615.68 109331,-1615.68 109249.96,-1527.68 109565,-1527.68 109646.04,-1615.68"/>
<text text-anchor="middle" x="109448" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="109448" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="109448" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="109448" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer1_expert2_a2a -->
<g id="node184" class="node">
<title>layer1_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="109091" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="109091" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="109091" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="109091" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="109091" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert2_attn_split -->
<g id="node185" class="node">
<title>layer1_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="108931.48,-1615.68 108606.2,-1615.68 108522.52,-1527.68 108847.8,-1527.68 108931.48,-1615.68"/>
<text text-anchor="middle" x="108727" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="108727" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="108727" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="108727" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert2_q_proj -->
<g id="node186" class="node">
<title>layer1_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="108504.5,-1593.68 108307.5,-1593.68 108307.5,-1549.68 108504.5,-1549.68 108504.5,-1593.68"/>
<text text-anchor="middle" x="108406" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="108406" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="108406" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="108406" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert2_k_proj -->
<g id="node187" class="node">
<title>layer1_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="108289.5,-1593.68 108092.5,-1593.68 108092.5,-1549.68 108289.5,-1549.68 108289.5,-1593.68"/>
<text text-anchor="middle" x="108191" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="108191" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="108191" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="108191" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert2_v_proj -->
<g id="node188" class="node">
<title>layer1_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="108074.5,-1593.68 107877.5,-1593.68 107877.5,-1549.68 108074.5,-1549.68 108074.5,-1593.68"/>
<text text-anchor="middle" x="107976" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="107976" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="107976" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="107976" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert2_attn -->
<g id="node189" class="node">
<title>layer1_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="107859.5,-1593.68 107662.5,-1593.68 107662.5,-1549.68 107859.5,-1549.68 107859.5,-1593.68"/>
<text text-anchor="middle" x="107761" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="107761" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="107761" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="107761" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert2_attn_out -->
<g id="node190" class="node">
<title>layer1_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="107644,-1593.68 107444,-1593.68 107444,-1549.68 107644,-1549.68 107644,-1593.68"/>
<text text-anchor="middle" x="107544" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="107544" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="107544" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="107544" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert2_attn_ar -->
<g id="node191" class="node">
<title>layer1_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="107285" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="107285" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="107285" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="107285" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="107285" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert2_attn_res -->
<g id="node192" class="node">
<title>layer1_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="107125.2,-1615.68 106795.59,-1615.68 106710.8,-1527.68 107040.41,-1527.68 107125.2,-1615.68"/>
<text text-anchor="middle" x="106918" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="106918" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="106918" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="106918" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert2_ln1 -->
<g id="node193" class="node">
<title>layer1_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="106693,-1593.68 106493,-1593.68 106493,-1549.68 106693,-1549.68 106693,-1593.68"/>
<text text-anchor="middle" x="106593" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="106593" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="106593" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="106593" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert2_mlp1 -->
<g id="node194" class="node">
<title>layer1_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="106475,-1593.68 106279,-1593.68 106279,-1549.68 106475,-1549.68 106475,-1593.68"/>
<text text-anchor="middle" x="106377" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="106377" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="106377" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="106377" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert2_gelu -->
<g id="node195" class="node">
<title>layer1_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="106261,-1593.68 106065,-1593.68 106065,-1549.68 106261,-1549.68 106261,-1593.68"/>
<text text-anchor="middle" x="106163" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="106163" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="106163" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="106163" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert2_mlp2 -->
<g id="node196" class="node">
<title>layer1_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="106047,-1593.68 105847,-1593.68 105847,-1549.68 106047,-1549.68 106047,-1593.68"/>
<text text-anchor="middle" x="105947" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="105947" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="105947" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="105947" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert2_mlp_ar -->
<g id="node197" class="node">
<title>layer1_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="105688" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="105688" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="105688" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="105688" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="105688" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert2_mlp_res -->
<g id="node198" class="node">
<title>layer1_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="105528.2,-1615.68 105198.59,-1615.68 105113.8,-1527.68 105443.41,-1527.68 105528.2,-1615.68"/>
<text text-anchor="middle" x="105321" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="105321" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="105321" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="105321" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert2_ln2 -->
<g id="node199" class="node">
<title>layer1_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="105096,-1593.68 104896,-1593.68 104896,-1549.68 105096,-1549.68 105096,-1593.68"/>
<text text-anchor="middle" x="104996" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="104996" y="-1574.28" font-family="Arial" font-size="8.00">L1_E2</text>
<text text-anchor="middle" x="104996" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="104996" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert3_route -->
<g id="node200" class="node">
<title>layer1_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="104872,-1593.68 104672,-1593.68 104672,-1549.68 104872,-1549.68 104872,-1593.68"/>
<text text-anchor="middle" x="104772" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="104772" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="104772" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="104772" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert3_gate -->
<g id="node201" class="node">
<title>layer1_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="104654.04,-1615.68 104339,-1615.68 104257.96,-1527.68 104573,-1527.68 104654.04,-1615.68"/>
<text text-anchor="middle" x="104456" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="104456" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="104456" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="104456" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer1_expert3_a2a -->
<g id="node202" class="node">
<title>layer1_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="104099" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="104099" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="104099" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="104099" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="104099" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert3_attn_split -->
<g id="node203" class="node">
<title>layer1_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="103939.48,-1615.68 103614.2,-1615.68 103530.52,-1527.68 103855.8,-1527.68 103939.48,-1615.68"/>
<text text-anchor="middle" x="103735" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="103735" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="103735" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="103735" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert3_q_proj -->
<g id="node204" class="node">
<title>layer1_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="103512.5,-1593.68 103315.5,-1593.68 103315.5,-1549.68 103512.5,-1549.68 103512.5,-1593.68"/>
<text text-anchor="middle" x="103414" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="103414" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="103414" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="103414" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert3_k_proj -->
<g id="node205" class="node">
<title>layer1_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="103297.5,-1593.68 103100.5,-1593.68 103100.5,-1549.68 103297.5,-1549.68 103297.5,-1593.68"/>
<text text-anchor="middle" x="103199" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="103199" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="103199" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="103199" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert3_v_proj -->
<g id="node206" class="node">
<title>layer1_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="103082.5,-1593.68 102885.5,-1593.68 102885.5,-1549.68 103082.5,-1549.68 103082.5,-1593.68"/>
<text text-anchor="middle" x="102984" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="102984" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="102984" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="102984" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert3_attn -->
<g id="node207" class="node">
<title>layer1_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="102867.5,-1593.68 102670.5,-1593.68 102670.5,-1549.68 102867.5,-1549.68 102867.5,-1593.68"/>
<text text-anchor="middle" x="102769" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="102769" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="102769" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="102769" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert3_attn_out -->
<g id="node208" class="node">
<title>layer1_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="102652,-1593.68 102452,-1593.68 102452,-1549.68 102652,-1549.68 102652,-1593.68"/>
<text text-anchor="middle" x="102552" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="102552" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="102552" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="102552" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert3_attn_ar -->
<g id="node209" class="node">
<title>layer1_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="102293" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="102293" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="102293" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="102293" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="102293" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert3_attn_res -->
<g id="node210" class="node">
<title>layer1_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="102133.2,-1615.68 101803.59,-1615.68 101718.8,-1527.68 102048.41,-1527.68 102133.2,-1615.68"/>
<text text-anchor="middle" x="101926" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="101926" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="101926" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="101926" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert3_ln1 -->
<g id="node211" class="node">
<title>layer1_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="101701,-1593.68 101501,-1593.68 101501,-1549.68 101701,-1549.68 101701,-1593.68"/>
<text text-anchor="middle" x="101601" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="101601" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="101601" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="101601" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert3_mlp1 -->
<g id="node212" class="node">
<title>layer1_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="101483,-1593.68 101287,-1593.68 101287,-1549.68 101483,-1549.68 101483,-1593.68"/>
<text text-anchor="middle" x="101385" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="101385" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="101385" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="101385" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert3_gelu -->
<g id="node213" class="node">
<title>layer1_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="101269,-1593.68 101073,-1593.68 101073,-1549.68 101269,-1549.68 101269,-1593.68"/>
<text text-anchor="middle" x="101171" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="101171" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="101171" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="101171" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert3_mlp2 -->
<g id="node214" class="node">
<title>layer1_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="101055,-1593.68 100855,-1593.68 100855,-1549.68 101055,-1549.68 101055,-1593.68"/>
<text text-anchor="middle" x="100955" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="100955" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="100955" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="100955" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert3_mlp_ar -->
<g id="node215" class="node">
<title>layer1_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="100696" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="100696" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="100696" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="100696" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="100696" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert3_mlp_res -->
<g id="node216" class="node">
<title>layer1_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="100536.2,-1615.68 100206.59,-1615.68 100121.8,-1527.68 100451.41,-1527.68 100536.2,-1615.68"/>
<text text-anchor="middle" x="100329" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="100329" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="100329" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="100329" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert3_ln2 -->
<g id="node217" class="node">
<title>layer1_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="100104,-1593.68 99904,-1593.68 99904,-1549.68 100104,-1549.68 100104,-1593.68"/>
<text text-anchor="middle" x="100004" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="100004" y="-1574.28" font-family="Arial" font-size="8.00">L1_E3</text>
<text text-anchor="middle" x="100004" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="100004" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert4_route -->
<g id="node218" class="node">
<title>layer1_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="99880,-1593.68 99680,-1593.68 99680,-1549.68 99880,-1549.68 99880,-1593.68"/>
<text text-anchor="middle" x="99780" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="99780" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="99780" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="99780" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert4_gate -->
<g id="node219" class="node">
<title>layer1_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="99662.04,-1615.68 99347,-1615.68 99265.96,-1527.68 99581,-1527.68 99662.04,-1615.68"/>
<text text-anchor="middle" x="99464" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="99464" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="99464" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="99464" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer1_expert4_a2a -->
<g id="node220" class="node">
<title>layer1_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="99107" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="99107" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="99107" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="99107" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="99107" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert4_attn_split -->
<g id="node221" class="node">
<title>layer1_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="98947.48,-1615.68 98622.2,-1615.68 98538.52,-1527.68 98863.8,-1527.68 98947.48,-1615.68"/>
<text text-anchor="middle" x="98743" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="98743" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="98743" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="98743" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert4_q_proj -->
<g id="node222" class="node">
<title>layer1_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="98520.5,-1593.68 98323.5,-1593.68 98323.5,-1549.68 98520.5,-1549.68 98520.5,-1593.68"/>
<text text-anchor="middle" x="98422" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="98422" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="98422" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="98422" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert4_k_proj -->
<g id="node223" class="node">
<title>layer1_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="98305.5,-1593.68 98108.5,-1593.68 98108.5,-1549.68 98305.5,-1549.68 98305.5,-1593.68"/>
<text text-anchor="middle" x="98207" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="98207" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="98207" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="98207" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert4_v_proj -->
<g id="node224" class="node">
<title>layer1_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="98090.5,-1593.68 97893.5,-1593.68 97893.5,-1549.68 98090.5,-1549.68 98090.5,-1593.68"/>
<text text-anchor="middle" x="97992" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="97992" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="97992" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="97992" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert4_attn -->
<g id="node225" class="node">
<title>layer1_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="97875.5,-1593.68 97678.5,-1593.68 97678.5,-1549.68 97875.5,-1549.68 97875.5,-1593.68"/>
<text text-anchor="middle" x="97777" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="97777" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="97777" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="97777" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert4_attn_out -->
<g id="node226" class="node">
<title>layer1_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="97660,-1593.68 97460,-1593.68 97460,-1549.68 97660,-1549.68 97660,-1593.68"/>
<text text-anchor="middle" x="97560" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="97560" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="97560" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="97560" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert4_attn_ar -->
<g id="node227" class="node">
<title>layer1_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="97301" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="97301" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="97301" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="97301" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="97301" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert4_attn_res -->
<g id="node228" class="node">
<title>layer1_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="97141.2,-1615.68 96811.59,-1615.68 96726.8,-1527.68 97056.41,-1527.68 97141.2,-1615.68"/>
<text text-anchor="middle" x="96934" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="96934" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="96934" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="96934" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert4_ln1 -->
<g id="node229" class="node">
<title>layer1_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="96709,-1593.68 96509,-1593.68 96509,-1549.68 96709,-1549.68 96709,-1593.68"/>
<text text-anchor="middle" x="96609" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="96609" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="96609" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="96609" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert4_mlp1 -->
<g id="node230" class="node">
<title>layer1_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="96491,-1593.68 96295,-1593.68 96295,-1549.68 96491,-1549.68 96491,-1593.68"/>
<text text-anchor="middle" x="96393" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="96393" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="96393" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="96393" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert4_gelu -->
<g id="node231" class="node">
<title>layer1_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="96277,-1593.68 96081,-1593.68 96081,-1549.68 96277,-1549.68 96277,-1593.68"/>
<text text-anchor="middle" x="96179" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="96179" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="96179" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="96179" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert4_mlp2 -->
<g id="node232" class="node">
<title>layer1_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="96063,-1593.68 95863,-1593.68 95863,-1549.68 96063,-1549.68 96063,-1593.68"/>
<text text-anchor="middle" x="95963" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="95963" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="95963" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="95963" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert4_mlp_ar -->
<g id="node233" class="node">
<title>layer1_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="95704" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="95704" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="95704" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="95704" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="95704" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert4_mlp_res -->
<g id="node234" class="node">
<title>layer1_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="95544.2,-1615.68 95214.59,-1615.68 95129.8,-1527.68 95459.41,-1527.68 95544.2,-1615.68"/>
<text text-anchor="middle" x="95337" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="95337" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="95337" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="95337" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert4_ln2 -->
<g id="node235" class="node">
<title>layer1_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="95112,-1593.68 94912,-1593.68 94912,-1549.68 95112,-1549.68 95112,-1593.68"/>
<text text-anchor="middle" x="95012" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="95012" y="-1574.28" font-family="Arial" font-size="8.00">L1_E4</text>
<text text-anchor="middle" x="95012" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="95012" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert5_route -->
<g id="node236" class="node">
<title>layer1_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="94888,-1593.68 94688,-1593.68 94688,-1549.68 94888,-1549.68 94888,-1593.68"/>
<text text-anchor="middle" x="94788" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="94788" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="94788" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="94788" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert5_gate -->
<g id="node237" class="node">
<title>layer1_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="94670.04,-1615.68 94355,-1615.68 94273.96,-1527.68 94589,-1527.68 94670.04,-1615.68"/>
<text text-anchor="middle" x="94472" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="94472" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="94472" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="94472" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer1_expert5_a2a -->
<g id="node238" class="node">
<title>layer1_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="94115" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="94115" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="94115" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="94115" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="94115" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert5_attn_split -->
<g id="node239" class="node">
<title>layer1_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="93955.48,-1615.68 93630.2,-1615.68 93546.52,-1527.68 93871.8,-1527.68 93955.48,-1615.68"/>
<text text-anchor="middle" x="93751" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="93751" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="93751" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="93751" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert5_q_proj -->
<g id="node240" class="node">
<title>layer1_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="93528.5,-1593.68 93331.5,-1593.68 93331.5,-1549.68 93528.5,-1549.68 93528.5,-1593.68"/>
<text text-anchor="middle" x="93430" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="93430" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="93430" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="93430" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert5_k_proj -->
<g id="node241" class="node">
<title>layer1_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="93313.5,-1593.68 93116.5,-1593.68 93116.5,-1549.68 93313.5,-1549.68 93313.5,-1593.68"/>
<text text-anchor="middle" x="93215" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="93215" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="93215" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="93215" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert5_v_proj -->
<g id="node242" class="node">
<title>layer1_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="93098.5,-1593.68 92901.5,-1593.68 92901.5,-1549.68 93098.5,-1549.68 93098.5,-1593.68"/>
<text text-anchor="middle" x="93000" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="93000" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="93000" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="93000" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert5_attn -->
<g id="node243" class="node">
<title>layer1_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="92883.5,-1593.68 92686.5,-1593.68 92686.5,-1549.68 92883.5,-1549.68 92883.5,-1593.68"/>
<text text-anchor="middle" x="92785" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="92785" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="92785" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="92785" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert5_attn_out -->
<g id="node244" class="node">
<title>layer1_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="92668,-1593.68 92468,-1593.68 92468,-1549.68 92668,-1549.68 92668,-1593.68"/>
<text text-anchor="middle" x="92568" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="92568" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="92568" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="92568" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert5_attn_ar -->
<g id="node245" class="node">
<title>layer1_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="92309" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="92309" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="92309" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="92309" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="92309" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert5_attn_res -->
<g id="node246" class="node">
<title>layer1_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="92149.2,-1615.68 91819.59,-1615.68 91734.8,-1527.68 92064.41,-1527.68 92149.2,-1615.68"/>
<text text-anchor="middle" x="91942" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="91942" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="91942" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="91942" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert5_ln1 -->
<g id="node247" class="node">
<title>layer1_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="91717,-1593.68 91517,-1593.68 91517,-1549.68 91717,-1549.68 91717,-1593.68"/>
<text text-anchor="middle" x="91617" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="91617" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="91617" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="91617" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert5_mlp1 -->
<g id="node248" class="node">
<title>layer1_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="91499,-1593.68 91303,-1593.68 91303,-1549.68 91499,-1549.68 91499,-1593.68"/>
<text text-anchor="middle" x="91401" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="91401" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="91401" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="91401" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert5_gelu -->
<g id="node249" class="node">
<title>layer1_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="91285,-1593.68 91089,-1593.68 91089,-1549.68 91285,-1549.68 91285,-1593.68"/>
<text text-anchor="middle" x="91187" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="91187" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="91187" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="91187" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert5_mlp2 -->
<g id="node250" class="node">
<title>layer1_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="91071,-1593.68 90871,-1593.68 90871,-1549.68 91071,-1549.68 91071,-1593.68"/>
<text text-anchor="middle" x="90971" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="90971" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="90971" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="90971" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert5_mlp_ar -->
<g id="node251" class="node">
<title>layer1_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="90712" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="90712" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="90712" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="90712" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="90712" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert5_mlp_res -->
<g id="node252" class="node">
<title>layer1_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="90552.2,-1615.68 90222.59,-1615.68 90137.8,-1527.68 90467.41,-1527.68 90552.2,-1615.68"/>
<text text-anchor="middle" x="90345" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="90345" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="90345" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="90345" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert5_ln2 -->
<g id="node253" class="node">
<title>layer1_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="90120,-1593.68 89920,-1593.68 89920,-1549.68 90120,-1549.68 90120,-1593.68"/>
<text text-anchor="middle" x="90020" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="90020" y="-1574.28" font-family="Arial" font-size="8.00">L1_E5</text>
<text text-anchor="middle" x="90020" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="90020" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert6_route -->
<g id="node254" class="node">
<title>layer1_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="89896,-1593.68 89696,-1593.68 89696,-1549.68 89896,-1549.68 89896,-1593.68"/>
<text text-anchor="middle" x="89796" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="89796" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="89796" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="89796" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert6_gate -->
<g id="node255" class="node">
<title>layer1_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="89678.04,-1615.68 89363,-1615.68 89281.96,-1527.68 89597,-1527.68 89678.04,-1615.68"/>
<text text-anchor="middle" x="89480" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="89480" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="89480" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="89480" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer1_expert6_a2a -->
<g id="node256" class="node">
<title>layer1_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="89123" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="89123" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="89123" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="89123" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="89123" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert6_attn_split -->
<g id="node257" class="node">
<title>layer1_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="88963.48,-1615.68 88638.2,-1615.68 88554.52,-1527.68 88879.8,-1527.68 88963.48,-1615.68"/>
<text text-anchor="middle" x="88759" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="88759" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="88759" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="88759" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert6_q_proj -->
<g id="node258" class="node">
<title>layer1_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="88536.5,-1593.68 88339.5,-1593.68 88339.5,-1549.68 88536.5,-1549.68 88536.5,-1593.68"/>
<text text-anchor="middle" x="88438" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="88438" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="88438" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="88438" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert6_k_proj -->
<g id="node259" class="node">
<title>layer1_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="88321.5,-1593.68 88124.5,-1593.68 88124.5,-1549.68 88321.5,-1549.68 88321.5,-1593.68"/>
<text text-anchor="middle" x="88223" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="88223" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="88223" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="88223" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert6_v_proj -->
<g id="node260" class="node">
<title>layer1_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="88106.5,-1593.68 87909.5,-1593.68 87909.5,-1549.68 88106.5,-1549.68 88106.5,-1593.68"/>
<text text-anchor="middle" x="88008" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="88008" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="88008" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="88008" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert6_attn -->
<g id="node261" class="node">
<title>layer1_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="87891.5,-1593.68 87694.5,-1593.68 87694.5,-1549.68 87891.5,-1549.68 87891.5,-1593.68"/>
<text text-anchor="middle" x="87793" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="87793" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="87793" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="87793" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert6_attn_out -->
<g id="node262" class="node">
<title>layer1_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="87676,-1593.68 87476,-1593.68 87476,-1549.68 87676,-1549.68 87676,-1593.68"/>
<text text-anchor="middle" x="87576" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="87576" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="87576" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="87576" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert6_attn_ar -->
<g id="node263" class="node">
<title>layer1_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="87317" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="87317" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="87317" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="87317" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="87317" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert6_attn_res -->
<g id="node264" class="node">
<title>layer1_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="87157.2,-1615.68 86827.59,-1615.68 86742.8,-1527.68 87072.41,-1527.68 87157.2,-1615.68"/>
<text text-anchor="middle" x="86950" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="86950" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="86950" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="86950" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert6_ln1 -->
<g id="node265" class="node">
<title>layer1_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="86725,-1593.68 86525,-1593.68 86525,-1549.68 86725,-1549.68 86725,-1593.68"/>
<text text-anchor="middle" x="86625" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="86625" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="86625" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="86625" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert6_mlp1 -->
<g id="node266" class="node">
<title>layer1_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="86507,-1593.68 86311,-1593.68 86311,-1549.68 86507,-1549.68 86507,-1593.68"/>
<text text-anchor="middle" x="86409" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="86409" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="86409" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="86409" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert6_gelu -->
<g id="node267" class="node">
<title>layer1_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="86293,-1593.68 86097,-1593.68 86097,-1549.68 86293,-1549.68 86293,-1593.68"/>
<text text-anchor="middle" x="86195" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="86195" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="86195" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="86195" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert6_mlp2 -->
<g id="node268" class="node">
<title>layer1_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="86079,-1593.68 85879,-1593.68 85879,-1549.68 86079,-1549.68 86079,-1593.68"/>
<text text-anchor="middle" x="85979" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="85979" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="85979" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="85979" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert6_mlp_ar -->
<g id="node269" class="node">
<title>layer1_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="85720" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="85720" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="85720" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="85720" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="85720" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert6_mlp_res -->
<g id="node270" class="node">
<title>layer1_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="85560.2,-1615.68 85230.59,-1615.68 85145.8,-1527.68 85475.41,-1527.68 85560.2,-1615.68"/>
<text text-anchor="middle" x="85353" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="85353" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="85353" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="85353" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert6_ln2 -->
<g id="node271" class="node">
<title>layer1_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="85128,-1593.68 84928,-1593.68 84928,-1549.68 85128,-1549.68 85128,-1593.68"/>
<text text-anchor="middle" x="85028" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="85028" y="-1574.28" font-family="Arial" font-size="8.00">L1_E6</text>
<text text-anchor="middle" x="85028" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="85028" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert7_route -->
<g id="node272" class="node">
<title>layer1_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="84904,-1593.68 84704,-1593.68 84704,-1549.68 84904,-1549.68 84904,-1593.68"/>
<text text-anchor="middle" x="84804" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="84804" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="84804" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="84804" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert7_gate -->
<g id="node273" class="node">
<title>layer1_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="84686.04,-1615.68 84371,-1615.68 84289.96,-1527.68 84605,-1527.68 84686.04,-1615.68"/>
<text text-anchor="middle" x="84488" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="84488" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="84488" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="84488" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer1_expert7_a2a -->
<g id="node274" class="node">
<title>layer1_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="84131" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="84131" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="84131" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="84131" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="84131" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert7_attn_split -->
<g id="node275" class="node">
<title>layer1_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="83971.48,-1615.68 83646.2,-1615.68 83562.52,-1527.68 83887.8,-1527.68 83971.48,-1615.68"/>
<text text-anchor="middle" x="83767" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="83767" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="83767" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="83767" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert7_q_proj -->
<g id="node276" class="node">
<title>layer1_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="83544.5,-1593.68 83347.5,-1593.68 83347.5,-1549.68 83544.5,-1549.68 83544.5,-1593.68"/>
<text text-anchor="middle" x="83446" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="83446" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="83446" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="83446" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert7_k_proj -->
<g id="node277" class="node">
<title>layer1_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="83329.5,-1593.68 83132.5,-1593.68 83132.5,-1549.68 83329.5,-1549.68 83329.5,-1593.68"/>
<text text-anchor="middle" x="83231" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="83231" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="83231" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="83231" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert7_v_proj -->
<g id="node278" class="node">
<title>layer1_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="83114.5,-1593.68 82917.5,-1593.68 82917.5,-1549.68 83114.5,-1549.68 83114.5,-1593.68"/>
<text text-anchor="middle" x="83016" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="83016" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="83016" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="83016" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert7_attn -->
<g id="node279" class="node">
<title>layer1_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="82899.5,-1593.68 82702.5,-1593.68 82702.5,-1549.68 82899.5,-1549.68 82899.5,-1593.68"/>
<text text-anchor="middle" x="82801" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="82801" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="82801" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="82801" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer1_expert7_attn_out -->
<g id="node280" class="node">
<title>layer1_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="82684,-1593.68 82484,-1593.68 82484,-1549.68 82684,-1549.68 82684,-1593.68"/>
<text text-anchor="middle" x="82584" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="82584" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="82584" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="82584" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert7_attn_ar -->
<g id="node281" class="node">
<title>layer1_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="82325" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="82325" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="82325" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="82325" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="82325" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert7_attn_res -->
<g id="node282" class="node">
<title>layer1_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="82165.2,-1615.68 81835.59,-1615.68 81750.8,-1527.68 82080.41,-1527.68 82165.2,-1615.68"/>
<text text-anchor="middle" x="81958" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="81958" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="81958" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="81958" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert7_ln1 -->
<g id="node283" class="node">
<title>layer1_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="81733,-1593.68 81533,-1593.68 81533,-1549.68 81733,-1549.68 81733,-1593.68"/>
<text text-anchor="middle" x="81633" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="81633" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="81633" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="81633" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert7_mlp1 -->
<g id="node284" class="node">
<title>layer1_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="81515,-1593.68 81319,-1593.68 81319,-1549.68 81515,-1549.68 81515,-1593.68"/>
<text text-anchor="middle" x="81417" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="81417" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="81417" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="81417" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert7_gelu -->
<g id="node285" class="node">
<title>layer1_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="81301,-1593.68 81105,-1593.68 81105,-1549.68 81301,-1549.68 81301,-1593.68"/>
<text text-anchor="middle" x="81203" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="81203" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="81203" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="81203" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer1_expert7_mlp2 -->
<g id="node286" class="node">
<title>layer1_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="81087,-1593.68 80887,-1593.68 80887,-1549.68 81087,-1549.68 81087,-1593.68"/>
<text text-anchor="middle" x="80987" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="80987" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="80987" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="80987" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert7_mlp_ar -->
<g id="node287" class="node">
<title>layer1_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="80728" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="80728" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="80728" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="80728" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="80728" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert7_mlp_res -->
<g id="node288" class="node">
<title>layer1_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="80568.2,-1615.68 80238.59,-1615.68 80153.8,-1527.68 80483.41,-1527.68 80568.2,-1615.68"/>
<text text-anchor="middle" x="80361" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="80361" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="80361" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="80361" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer1_expert7_ln2 -->
<g id="node289" class="node">
<title>layer1_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="80136,-1593.68 79936,-1593.68 79936,-1549.68 80136,-1549.68 80136,-1593.68"/>
<text text-anchor="middle" x="80036" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="80036" y="-1574.28" font-family="Arial" font-size="8.00">L1_E7</text>
<text text-anchor="middle" x="80036" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="80036" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert0_route -->
<g id="node290" class="node">
<title>layer2_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="79896,-1593.68 79696,-1593.68 79696,-1549.68 79896,-1549.68 79896,-1593.68"/>
<text text-anchor="middle" x="79796" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="79796" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="79796" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="79796" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert0_gate -->
<g id="node291" class="node">
<title>layer2_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="79678.04,-1615.68 79363,-1615.68 79281.96,-1527.68 79597,-1527.68 79678.04,-1615.68"/>
<text text-anchor="middle" x="79480" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="79480" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="79480" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="79480" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer2_expert0_a2a -->
<g id="node292" class="node">
<title>layer2_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="79123" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="79123" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="79123" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="79123" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="79123" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert0_attn_split -->
<g id="node293" class="node">
<title>layer2_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="78963.48,-1615.68 78638.2,-1615.68 78554.52,-1527.68 78879.8,-1527.68 78963.48,-1615.68"/>
<text text-anchor="middle" x="78759" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="78759" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="78759" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="78759" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert0_q_proj -->
<g id="node294" class="node">
<title>layer2_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="78536.5,-1593.68 78339.5,-1593.68 78339.5,-1549.68 78536.5,-1549.68 78536.5,-1593.68"/>
<text text-anchor="middle" x="78438" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="78438" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="78438" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="78438" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert0_k_proj -->
<g id="node295" class="node">
<title>layer2_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="78321.5,-1593.68 78124.5,-1593.68 78124.5,-1549.68 78321.5,-1549.68 78321.5,-1593.68"/>
<text text-anchor="middle" x="78223" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="78223" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="78223" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="78223" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert0_v_proj -->
<g id="node296" class="node">
<title>layer2_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="78106.5,-1593.68 77909.5,-1593.68 77909.5,-1549.68 78106.5,-1549.68 78106.5,-1593.68"/>
<text text-anchor="middle" x="78008" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="78008" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="78008" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="78008" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert0_attn -->
<g id="node297" class="node">
<title>layer2_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="77891.5,-1593.68 77694.5,-1593.68 77694.5,-1549.68 77891.5,-1549.68 77891.5,-1593.68"/>
<text text-anchor="middle" x="77793" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="77793" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="77793" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="77793" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert0_attn_out -->
<g id="node298" class="node">
<title>layer2_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="77676,-1593.68 77476,-1593.68 77476,-1549.68 77676,-1549.68 77676,-1593.68"/>
<text text-anchor="middle" x="77576" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="77576" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="77576" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="77576" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert0_attn_ar -->
<g id="node299" class="node">
<title>layer2_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="77317" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="77317" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="77317" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="77317" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="77317" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert0_attn_res -->
<g id="node300" class="node">
<title>layer2_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="77157.2,-1615.68 76827.59,-1615.68 76742.8,-1527.68 77072.41,-1527.68 77157.2,-1615.68"/>
<text text-anchor="middle" x="76950" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="76950" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="76950" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="76950" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert0_ln1 -->
<g id="node301" class="node">
<title>layer2_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="76725,-1593.68 76525,-1593.68 76525,-1549.68 76725,-1549.68 76725,-1593.68"/>
<text text-anchor="middle" x="76625" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="76625" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="76625" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="76625" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert0_mlp1 -->
<g id="node302" class="node">
<title>layer2_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="76507,-1593.68 76311,-1593.68 76311,-1549.68 76507,-1549.68 76507,-1593.68"/>
<text text-anchor="middle" x="76409" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="76409" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="76409" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="76409" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert0_gelu -->
<g id="node303" class="node">
<title>layer2_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="76293,-1593.68 76097,-1593.68 76097,-1549.68 76293,-1549.68 76293,-1593.68"/>
<text text-anchor="middle" x="76195" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="76195" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="76195" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="76195" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert0_mlp2 -->
<g id="node304" class="node">
<title>layer2_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="76079,-1593.68 75879,-1593.68 75879,-1549.68 76079,-1549.68 76079,-1593.68"/>
<text text-anchor="middle" x="75979" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="75979" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="75979" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="75979" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert0_mlp_ar -->
<g id="node305" class="node">
<title>layer2_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="75720" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="75720" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="75720" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="75720" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="75720" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert0_mlp_res -->
<g id="node306" class="node">
<title>layer2_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="75560.2,-1615.68 75230.59,-1615.68 75145.8,-1527.68 75475.41,-1527.68 75560.2,-1615.68"/>
<text text-anchor="middle" x="75353" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="75353" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="75353" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="75353" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert0_ln2 -->
<g id="node307" class="node">
<title>layer2_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="75128,-1593.68 74928,-1593.68 74928,-1549.68 75128,-1549.68 75128,-1593.68"/>
<text text-anchor="middle" x="75028" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="75028" y="-1574.28" font-family="Arial" font-size="8.00">L2_E0</text>
<text text-anchor="middle" x="75028" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="75028" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert1_route -->
<g id="node308" class="node">
<title>layer2_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="74904,-1593.68 74704,-1593.68 74704,-1549.68 74904,-1549.68 74904,-1593.68"/>
<text text-anchor="middle" x="74804" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="74804" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="74804" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="74804" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert1_gate -->
<g id="node309" class="node">
<title>layer2_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="74686.04,-1615.68 74371,-1615.68 74289.96,-1527.68 74605,-1527.68 74686.04,-1615.68"/>
<text text-anchor="middle" x="74488" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="74488" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="74488" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="74488" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer2_expert1_a2a -->
<g id="node310" class="node">
<title>layer2_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="74131" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="74131" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="74131" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="74131" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="74131" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert1_attn_split -->
<g id="node311" class="node">
<title>layer2_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="73971.48,-1615.68 73646.2,-1615.68 73562.52,-1527.68 73887.8,-1527.68 73971.48,-1615.68"/>
<text text-anchor="middle" x="73767" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="73767" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="73767" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="73767" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert1_q_proj -->
<g id="node312" class="node">
<title>layer2_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="73544.5,-1593.68 73347.5,-1593.68 73347.5,-1549.68 73544.5,-1549.68 73544.5,-1593.68"/>
<text text-anchor="middle" x="73446" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="73446" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="73446" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="73446" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert1_k_proj -->
<g id="node313" class="node">
<title>layer2_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="73329.5,-1593.68 73132.5,-1593.68 73132.5,-1549.68 73329.5,-1549.68 73329.5,-1593.68"/>
<text text-anchor="middle" x="73231" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="73231" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="73231" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="73231" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert1_v_proj -->
<g id="node314" class="node">
<title>layer2_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="73114.5,-1593.68 72917.5,-1593.68 72917.5,-1549.68 73114.5,-1549.68 73114.5,-1593.68"/>
<text text-anchor="middle" x="73016" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="73016" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="73016" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="73016" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert1_attn -->
<g id="node315" class="node">
<title>layer2_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="72899.5,-1593.68 72702.5,-1593.68 72702.5,-1549.68 72899.5,-1549.68 72899.5,-1593.68"/>
<text text-anchor="middle" x="72801" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="72801" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="72801" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="72801" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert1_attn_out -->
<g id="node316" class="node">
<title>layer2_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="72684,-1593.68 72484,-1593.68 72484,-1549.68 72684,-1549.68 72684,-1593.68"/>
<text text-anchor="middle" x="72584" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="72584" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="72584" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="72584" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert1_attn_ar -->
<g id="node317" class="node">
<title>layer2_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="72325" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="72325" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="72325" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="72325" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="72325" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert1_attn_res -->
<g id="node318" class="node">
<title>layer2_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="72165.2,-1615.68 71835.59,-1615.68 71750.8,-1527.68 72080.41,-1527.68 72165.2,-1615.68"/>
<text text-anchor="middle" x="71958" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="71958" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="71958" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="71958" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert1_ln1 -->
<g id="node319" class="node">
<title>layer2_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="71733,-1593.68 71533,-1593.68 71533,-1549.68 71733,-1549.68 71733,-1593.68"/>
<text text-anchor="middle" x="71633" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="71633" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="71633" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="71633" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert1_mlp1 -->
<g id="node320" class="node">
<title>layer2_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="71515,-1593.68 71319,-1593.68 71319,-1549.68 71515,-1549.68 71515,-1593.68"/>
<text text-anchor="middle" x="71417" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="71417" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="71417" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="71417" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert1_gelu -->
<g id="node321" class="node">
<title>layer2_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="71301,-1593.68 71105,-1593.68 71105,-1549.68 71301,-1549.68 71301,-1593.68"/>
<text text-anchor="middle" x="71203" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="71203" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="71203" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="71203" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert1_mlp2 -->
<g id="node322" class="node">
<title>layer2_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="71087,-1593.68 70887,-1593.68 70887,-1549.68 71087,-1549.68 71087,-1593.68"/>
<text text-anchor="middle" x="70987" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="70987" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="70987" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="70987" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert1_mlp_ar -->
<g id="node323" class="node">
<title>layer2_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="70728" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="70728" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="70728" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="70728" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="70728" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert1_mlp_res -->
<g id="node324" class="node">
<title>layer2_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="70568.2,-1615.68 70238.59,-1615.68 70153.8,-1527.68 70483.41,-1527.68 70568.2,-1615.68"/>
<text text-anchor="middle" x="70361" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="70361" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="70361" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="70361" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert1_ln2 -->
<g id="node325" class="node">
<title>layer2_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="70136,-1593.68 69936,-1593.68 69936,-1549.68 70136,-1549.68 70136,-1593.68"/>
<text text-anchor="middle" x="70036" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="70036" y="-1574.28" font-family="Arial" font-size="8.00">L2_E1</text>
<text text-anchor="middle" x="70036" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="70036" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert2_route -->
<g id="node326" class="node">
<title>layer2_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="69912,-1593.68 69712,-1593.68 69712,-1549.68 69912,-1549.68 69912,-1593.68"/>
<text text-anchor="middle" x="69812" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="69812" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="69812" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="69812" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert2_gate -->
<g id="node327" class="node">
<title>layer2_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="69694.04,-1615.68 69379,-1615.68 69297.96,-1527.68 69613,-1527.68 69694.04,-1615.68"/>
<text text-anchor="middle" x="69496" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="69496" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="69496" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="69496" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer2_expert2_a2a -->
<g id="node328" class="node">
<title>layer2_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="69139" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="69139" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="69139" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="69139" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="69139" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert2_attn_split -->
<g id="node329" class="node">
<title>layer2_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="68979.48,-1615.68 68654.2,-1615.68 68570.52,-1527.68 68895.8,-1527.68 68979.48,-1615.68"/>
<text text-anchor="middle" x="68775" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="68775" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="68775" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="68775" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert2_q_proj -->
<g id="node330" class="node">
<title>layer2_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="68552.5,-1593.68 68355.5,-1593.68 68355.5,-1549.68 68552.5,-1549.68 68552.5,-1593.68"/>
<text text-anchor="middle" x="68454" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="68454" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="68454" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="68454" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert2_k_proj -->
<g id="node331" class="node">
<title>layer2_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="68337.5,-1593.68 68140.5,-1593.68 68140.5,-1549.68 68337.5,-1549.68 68337.5,-1593.68"/>
<text text-anchor="middle" x="68239" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="68239" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="68239" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="68239" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert2_v_proj -->
<g id="node332" class="node">
<title>layer2_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="68122.5,-1593.68 67925.5,-1593.68 67925.5,-1549.68 68122.5,-1549.68 68122.5,-1593.68"/>
<text text-anchor="middle" x="68024" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="68024" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="68024" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="68024" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert2_attn -->
<g id="node333" class="node">
<title>layer2_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="67907.5,-1593.68 67710.5,-1593.68 67710.5,-1549.68 67907.5,-1549.68 67907.5,-1593.68"/>
<text text-anchor="middle" x="67809" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="67809" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="67809" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="67809" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert2_attn_out -->
<g id="node334" class="node">
<title>layer2_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="67692,-1593.68 67492,-1593.68 67492,-1549.68 67692,-1549.68 67692,-1593.68"/>
<text text-anchor="middle" x="67592" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="67592" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="67592" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="67592" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert2_attn_ar -->
<g id="node335" class="node">
<title>layer2_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="67333" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="67333" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="67333" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="67333" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="67333" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert2_attn_res -->
<g id="node336" class="node">
<title>layer2_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="67173.2,-1615.68 66843.59,-1615.68 66758.8,-1527.68 67088.41,-1527.68 67173.2,-1615.68"/>
<text text-anchor="middle" x="66966" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="66966" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="66966" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="66966" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert2_ln1 -->
<g id="node337" class="node">
<title>layer2_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="66741,-1593.68 66541,-1593.68 66541,-1549.68 66741,-1549.68 66741,-1593.68"/>
<text text-anchor="middle" x="66641" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="66641" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="66641" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="66641" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert2_mlp1 -->
<g id="node338" class="node">
<title>layer2_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="66523,-1593.68 66327,-1593.68 66327,-1549.68 66523,-1549.68 66523,-1593.68"/>
<text text-anchor="middle" x="66425" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="66425" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="66425" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="66425" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert2_gelu -->
<g id="node339" class="node">
<title>layer2_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="66309,-1593.68 66113,-1593.68 66113,-1549.68 66309,-1549.68 66309,-1593.68"/>
<text text-anchor="middle" x="66211" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="66211" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="66211" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="66211" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert2_mlp2 -->
<g id="node340" class="node">
<title>layer2_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="66095,-1593.68 65895,-1593.68 65895,-1549.68 66095,-1549.68 66095,-1593.68"/>
<text text-anchor="middle" x="65995" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="65995" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="65995" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="65995" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert2_mlp_ar -->
<g id="node341" class="node">
<title>layer2_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="65736" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="65736" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="65736" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="65736" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="65736" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert2_mlp_res -->
<g id="node342" class="node">
<title>layer2_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="65576.2,-1615.68 65246.59,-1615.68 65161.8,-1527.68 65491.41,-1527.68 65576.2,-1615.68"/>
<text text-anchor="middle" x="65369" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="65369" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="65369" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="65369" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert2_ln2 -->
<g id="node343" class="node">
<title>layer2_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="65144,-1593.68 64944,-1593.68 64944,-1549.68 65144,-1549.68 65144,-1593.68"/>
<text text-anchor="middle" x="65044" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="65044" y="-1574.28" font-family="Arial" font-size="8.00">L2_E2</text>
<text text-anchor="middle" x="65044" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="65044" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert3_route -->
<g id="node344" class="node">
<title>layer2_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="64920,-1593.68 64720,-1593.68 64720,-1549.68 64920,-1549.68 64920,-1593.68"/>
<text text-anchor="middle" x="64820" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="64820" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="64820" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="64820" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert3_gate -->
<g id="node345" class="node">
<title>layer2_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="64702.04,-1615.68 64387,-1615.68 64305.96,-1527.68 64621,-1527.68 64702.04,-1615.68"/>
<text text-anchor="middle" x="64504" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="64504" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="64504" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="64504" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer2_expert3_a2a -->
<g id="node346" class="node">
<title>layer2_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="64147" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="64147" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="64147" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="64147" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="64147" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert3_attn_split -->
<g id="node347" class="node">
<title>layer2_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="63987.48,-1615.68 63662.2,-1615.68 63578.52,-1527.68 63903.8,-1527.68 63987.48,-1615.68"/>
<text text-anchor="middle" x="63783" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="63783" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="63783" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="63783" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert3_q_proj -->
<g id="node348" class="node">
<title>layer2_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="63560.5,-1593.68 63363.5,-1593.68 63363.5,-1549.68 63560.5,-1549.68 63560.5,-1593.68"/>
<text text-anchor="middle" x="63462" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="63462" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="63462" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="63462" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert3_k_proj -->
<g id="node349" class="node">
<title>layer2_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="63345.5,-1593.68 63148.5,-1593.68 63148.5,-1549.68 63345.5,-1549.68 63345.5,-1593.68"/>
<text text-anchor="middle" x="63247" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="63247" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="63247" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="63247" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert3_v_proj -->
<g id="node350" class="node">
<title>layer2_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="63130.5,-1593.68 62933.5,-1593.68 62933.5,-1549.68 63130.5,-1549.68 63130.5,-1593.68"/>
<text text-anchor="middle" x="63032" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="63032" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="63032" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="63032" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert3_attn -->
<g id="node351" class="node">
<title>layer2_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="62915.5,-1593.68 62718.5,-1593.68 62718.5,-1549.68 62915.5,-1549.68 62915.5,-1593.68"/>
<text text-anchor="middle" x="62817" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="62817" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="62817" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="62817" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert3_attn_out -->
<g id="node352" class="node">
<title>layer2_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="62700,-1593.68 62500,-1593.68 62500,-1549.68 62700,-1549.68 62700,-1593.68"/>
<text text-anchor="middle" x="62600" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="62600" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="62600" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="62600" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert3_attn_ar -->
<g id="node353" class="node">
<title>layer2_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="62341" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="62341" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="62341" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="62341" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="62341" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert3_attn_res -->
<g id="node354" class="node">
<title>layer2_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="62181.2,-1615.68 61851.59,-1615.68 61766.8,-1527.68 62096.41,-1527.68 62181.2,-1615.68"/>
<text text-anchor="middle" x="61974" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="61974" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="61974" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="61974" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert3_ln1 -->
<g id="node355" class="node">
<title>layer2_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="61749,-1593.68 61549,-1593.68 61549,-1549.68 61749,-1549.68 61749,-1593.68"/>
<text text-anchor="middle" x="61649" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="61649" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="61649" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="61649" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert3_mlp1 -->
<g id="node356" class="node">
<title>layer2_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="61531,-1593.68 61335,-1593.68 61335,-1549.68 61531,-1549.68 61531,-1593.68"/>
<text text-anchor="middle" x="61433" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="61433" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="61433" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="61433" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert3_gelu -->
<g id="node357" class="node">
<title>layer2_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="61317,-1593.68 61121,-1593.68 61121,-1549.68 61317,-1549.68 61317,-1593.68"/>
<text text-anchor="middle" x="61219" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="61219" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="61219" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="61219" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert3_mlp2 -->
<g id="node358" class="node">
<title>layer2_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="61103,-1593.68 60903,-1593.68 60903,-1549.68 61103,-1549.68 61103,-1593.68"/>
<text text-anchor="middle" x="61003" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="61003" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="61003" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="61003" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert3_mlp_ar -->
<g id="node359" class="node">
<title>layer2_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="60744" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="60744" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="60744" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="60744" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="60744" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert3_mlp_res -->
<g id="node360" class="node">
<title>layer2_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="60584.2,-1615.68 60254.59,-1615.68 60169.8,-1527.68 60499.41,-1527.68 60584.2,-1615.68"/>
<text text-anchor="middle" x="60377" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="60377" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="60377" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="60377" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert3_ln2 -->
<g id="node361" class="node">
<title>layer2_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="60152,-1593.68 59952,-1593.68 59952,-1549.68 60152,-1549.68 60152,-1593.68"/>
<text text-anchor="middle" x="60052" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="60052" y="-1574.28" font-family="Arial" font-size="8.00">L2_E3</text>
<text text-anchor="middle" x="60052" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="60052" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert4_route -->
<g id="node362" class="node">
<title>layer2_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="59928,-1593.68 59728,-1593.68 59728,-1549.68 59928,-1549.68 59928,-1593.68"/>
<text text-anchor="middle" x="59828" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="59828" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="59828" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="59828" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert4_gate -->
<g id="node363" class="node">
<title>layer2_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="59710.04,-1615.68 59395,-1615.68 59313.96,-1527.68 59629,-1527.68 59710.04,-1615.68"/>
<text text-anchor="middle" x="59512" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="59512" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="59512" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="59512" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer2_expert4_a2a -->
<g id="node364" class="node">
<title>layer2_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="59155" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="59155" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="59155" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="59155" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="59155" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert4_attn_split -->
<g id="node365" class="node">
<title>layer2_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="58995.48,-1615.68 58670.2,-1615.68 58586.52,-1527.68 58911.8,-1527.68 58995.48,-1615.68"/>
<text text-anchor="middle" x="58791" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="58791" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="58791" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="58791" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert4_q_proj -->
<g id="node366" class="node">
<title>layer2_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="58568.5,-1593.68 58371.5,-1593.68 58371.5,-1549.68 58568.5,-1549.68 58568.5,-1593.68"/>
<text text-anchor="middle" x="58470" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="58470" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="58470" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="58470" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert4_k_proj -->
<g id="node367" class="node">
<title>layer2_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="58353.5,-1593.68 58156.5,-1593.68 58156.5,-1549.68 58353.5,-1549.68 58353.5,-1593.68"/>
<text text-anchor="middle" x="58255" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="58255" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="58255" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="58255" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert4_v_proj -->
<g id="node368" class="node">
<title>layer2_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="58138.5,-1593.68 57941.5,-1593.68 57941.5,-1549.68 58138.5,-1549.68 58138.5,-1593.68"/>
<text text-anchor="middle" x="58040" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="58040" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="58040" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="58040" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert4_attn -->
<g id="node369" class="node">
<title>layer2_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="57923.5,-1593.68 57726.5,-1593.68 57726.5,-1549.68 57923.5,-1549.68 57923.5,-1593.68"/>
<text text-anchor="middle" x="57825" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="57825" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="57825" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="57825" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert4_attn_out -->
<g id="node370" class="node">
<title>layer2_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="57708,-1593.68 57508,-1593.68 57508,-1549.68 57708,-1549.68 57708,-1593.68"/>
<text text-anchor="middle" x="57608" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="57608" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="57608" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="57608" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert4_attn_ar -->
<g id="node371" class="node">
<title>layer2_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="57349" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="57349" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="57349" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="57349" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="57349" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert4_attn_res -->
<g id="node372" class="node">
<title>layer2_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="57189.2,-1615.68 56859.59,-1615.68 56774.8,-1527.68 57104.41,-1527.68 57189.2,-1615.68"/>
<text text-anchor="middle" x="56982" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="56982" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="56982" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="56982" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert4_ln1 -->
<g id="node373" class="node">
<title>layer2_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="56757,-1593.68 56557,-1593.68 56557,-1549.68 56757,-1549.68 56757,-1593.68"/>
<text text-anchor="middle" x="56657" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="56657" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="56657" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="56657" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert4_mlp1 -->
<g id="node374" class="node">
<title>layer2_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="56539,-1593.68 56343,-1593.68 56343,-1549.68 56539,-1549.68 56539,-1593.68"/>
<text text-anchor="middle" x="56441" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="56441" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="56441" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="56441" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert4_gelu -->
<g id="node375" class="node">
<title>layer2_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="56325,-1593.68 56129,-1593.68 56129,-1549.68 56325,-1549.68 56325,-1593.68"/>
<text text-anchor="middle" x="56227" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="56227" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="56227" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="56227" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert4_mlp2 -->
<g id="node376" class="node">
<title>layer2_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="56111,-1593.68 55911,-1593.68 55911,-1549.68 56111,-1549.68 56111,-1593.68"/>
<text text-anchor="middle" x="56011" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="56011" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="56011" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="56011" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert4_mlp_ar -->
<g id="node377" class="node">
<title>layer2_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="55752" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="55752" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="55752" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="55752" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="55752" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert4_mlp_res -->
<g id="node378" class="node">
<title>layer2_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="55592.2,-1615.68 55262.59,-1615.68 55177.8,-1527.68 55507.41,-1527.68 55592.2,-1615.68"/>
<text text-anchor="middle" x="55385" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="55385" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="55385" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="55385" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert4_ln2 -->
<g id="node379" class="node">
<title>layer2_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="55160,-1593.68 54960,-1593.68 54960,-1549.68 55160,-1549.68 55160,-1593.68"/>
<text text-anchor="middle" x="55060" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="55060" y="-1574.28" font-family="Arial" font-size="8.00">L2_E4</text>
<text text-anchor="middle" x="55060" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="55060" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert5_route -->
<g id="node380" class="node">
<title>layer2_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="54936,-1593.68 54736,-1593.68 54736,-1549.68 54936,-1549.68 54936,-1593.68"/>
<text text-anchor="middle" x="54836" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="54836" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="54836" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="54836" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert5_gate -->
<g id="node381" class="node">
<title>layer2_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="54718.04,-1615.68 54403,-1615.68 54321.96,-1527.68 54637,-1527.68 54718.04,-1615.68"/>
<text text-anchor="middle" x="54520" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="54520" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="54520" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="54520" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer2_expert5_a2a -->
<g id="node382" class="node">
<title>layer2_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="54163" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="54163" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="54163" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="54163" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="54163" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert5_attn_split -->
<g id="node383" class="node">
<title>layer2_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="54003.48,-1615.68 53678.2,-1615.68 53594.52,-1527.68 53919.8,-1527.68 54003.48,-1615.68"/>
<text text-anchor="middle" x="53799" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="53799" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="53799" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="53799" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert5_q_proj -->
<g id="node384" class="node">
<title>layer2_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="53576.5,-1593.68 53379.5,-1593.68 53379.5,-1549.68 53576.5,-1549.68 53576.5,-1593.68"/>
<text text-anchor="middle" x="53478" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="53478" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="53478" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="53478" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert5_k_proj -->
<g id="node385" class="node">
<title>layer2_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="53361.5,-1593.68 53164.5,-1593.68 53164.5,-1549.68 53361.5,-1549.68 53361.5,-1593.68"/>
<text text-anchor="middle" x="53263" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="53263" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="53263" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="53263" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert5_v_proj -->
<g id="node386" class="node">
<title>layer2_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="53146.5,-1593.68 52949.5,-1593.68 52949.5,-1549.68 53146.5,-1549.68 53146.5,-1593.68"/>
<text text-anchor="middle" x="53048" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="53048" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="53048" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="53048" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert5_attn -->
<g id="node387" class="node">
<title>layer2_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="52931.5,-1593.68 52734.5,-1593.68 52734.5,-1549.68 52931.5,-1549.68 52931.5,-1593.68"/>
<text text-anchor="middle" x="52833" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="52833" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="52833" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="52833" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert5_attn_out -->
<g id="node388" class="node">
<title>layer2_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="52716,-1593.68 52516,-1593.68 52516,-1549.68 52716,-1549.68 52716,-1593.68"/>
<text text-anchor="middle" x="52616" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="52616" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="52616" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="52616" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert5_attn_ar -->
<g id="node389" class="node">
<title>layer2_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="52357" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="52357" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="52357" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="52357" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="52357" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert5_attn_res -->
<g id="node390" class="node">
<title>layer2_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="52197.2,-1615.68 51867.59,-1615.68 51782.8,-1527.68 52112.41,-1527.68 52197.2,-1615.68"/>
<text text-anchor="middle" x="51990" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="51990" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="51990" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="51990" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert5_ln1 -->
<g id="node391" class="node">
<title>layer2_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="51765,-1593.68 51565,-1593.68 51565,-1549.68 51765,-1549.68 51765,-1593.68"/>
<text text-anchor="middle" x="51665" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="51665" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="51665" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="51665" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert5_mlp1 -->
<g id="node392" class="node">
<title>layer2_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="51547,-1593.68 51351,-1593.68 51351,-1549.68 51547,-1549.68 51547,-1593.68"/>
<text text-anchor="middle" x="51449" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="51449" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="51449" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="51449" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert5_gelu -->
<g id="node393" class="node">
<title>layer2_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="51333,-1593.68 51137,-1593.68 51137,-1549.68 51333,-1549.68 51333,-1593.68"/>
<text text-anchor="middle" x="51235" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="51235" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="51235" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="51235" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert5_mlp2 -->
<g id="node394" class="node">
<title>layer2_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="51119,-1593.68 50919,-1593.68 50919,-1549.68 51119,-1549.68 51119,-1593.68"/>
<text text-anchor="middle" x="51019" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="51019" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="51019" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="51019" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert5_mlp_ar -->
<g id="node395" class="node">
<title>layer2_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="50760" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="50760" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="50760" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="50760" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="50760" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert5_mlp_res -->
<g id="node396" class="node">
<title>layer2_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="50600.2,-1615.68 50270.59,-1615.68 50185.8,-1527.68 50515.41,-1527.68 50600.2,-1615.68"/>
<text text-anchor="middle" x="50393" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="50393" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="50393" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="50393" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert5_ln2 -->
<g id="node397" class="node">
<title>layer2_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="50168,-1593.68 49968,-1593.68 49968,-1549.68 50168,-1549.68 50168,-1593.68"/>
<text text-anchor="middle" x="50068" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="50068" y="-1574.28" font-family="Arial" font-size="8.00">L2_E5</text>
<text text-anchor="middle" x="50068" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="50068" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert6_route -->
<g id="node398" class="node">
<title>layer2_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="49944,-1593.68 49744,-1593.68 49744,-1549.68 49944,-1549.68 49944,-1593.68"/>
<text text-anchor="middle" x="49844" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="49844" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="49844" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="49844" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert6_gate -->
<g id="node399" class="node">
<title>layer2_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="49726.04,-1615.68 49411,-1615.68 49329.96,-1527.68 49645,-1527.68 49726.04,-1615.68"/>
<text text-anchor="middle" x="49528" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="49528" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="49528" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="49528" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer2_expert6_a2a -->
<g id="node400" class="node">
<title>layer2_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="49171" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="49171" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="49171" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="49171" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="49171" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert6_attn_split -->
<g id="node401" class="node">
<title>layer2_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="49011.48,-1615.68 48686.2,-1615.68 48602.52,-1527.68 48927.8,-1527.68 49011.48,-1615.68"/>
<text text-anchor="middle" x="48807" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="48807" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="48807" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="48807" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert6_q_proj -->
<g id="node402" class="node">
<title>layer2_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="48584.5,-1593.68 48387.5,-1593.68 48387.5,-1549.68 48584.5,-1549.68 48584.5,-1593.68"/>
<text text-anchor="middle" x="48486" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="48486" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="48486" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="48486" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert6_k_proj -->
<g id="node403" class="node">
<title>layer2_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="48369.5,-1593.68 48172.5,-1593.68 48172.5,-1549.68 48369.5,-1549.68 48369.5,-1593.68"/>
<text text-anchor="middle" x="48271" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="48271" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="48271" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="48271" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert6_v_proj -->
<g id="node404" class="node">
<title>layer2_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="48154.5,-1593.68 47957.5,-1593.68 47957.5,-1549.68 48154.5,-1549.68 48154.5,-1593.68"/>
<text text-anchor="middle" x="48056" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="48056" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="48056" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="48056" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert6_attn -->
<g id="node405" class="node">
<title>layer2_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="47939.5,-1593.68 47742.5,-1593.68 47742.5,-1549.68 47939.5,-1549.68 47939.5,-1593.68"/>
<text text-anchor="middle" x="47841" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="47841" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="47841" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="47841" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert6_attn_out -->
<g id="node406" class="node">
<title>layer2_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="47724,-1593.68 47524,-1593.68 47524,-1549.68 47724,-1549.68 47724,-1593.68"/>
<text text-anchor="middle" x="47624" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="47624" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="47624" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="47624" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert6_attn_ar -->
<g id="node407" class="node">
<title>layer2_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="47365" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="47365" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="47365" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="47365" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="47365" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert6_attn_res -->
<g id="node408" class="node">
<title>layer2_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="47205.2,-1615.68 46875.59,-1615.68 46790.8,-1527.68 47120.41,-1527.68 47205.2,-1615.68"/>
<text text-anchor="middle" x="46998" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="46998" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="46998" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="46998" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert6_ln1 -->
<g id="node409" class="node">
<title>layer2_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="46773,-1593.68 46573,-1593.68 46573,-1549.68 46773,-1549.68 46773,-1593.68"/>
<text text-anchor="middle" x="46673" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="46673" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="46673" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="46673" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert6_mlp1 -->
<g id="node410" class="node">
<title>layer2_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="46555,-1593.68 46359,-1593.68 46359,-1549.68 46555,-1549.68 46555,-1593.68"/>
<text text-anchor="middle" x="46457" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="46457" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="46457" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="46457" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert6_gelu -->
<g id="node411" class="node">
<title>layer2_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="46341,-1593.68 46145,-1593.68 46145,-1549.68 46341,-1549.68 46341,-1593.68"/>
<text text-anchor="middle" x="46243" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="46243" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="46243" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="46243" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert6_mlp2 -->
<g id="node412" class="node">
<title>layer2_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="46127,-1593.68 45927,-1593.68 45927,-1549.68 46127,-1549.68 46127,-1593.68"/>
<text text-anchor="middle" x="46027" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="46027" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="46027" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="46027" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert6_mlp_ar -->
<g id="node413" class="node">
<title>layer2_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="45768" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="45768" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="45768" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="45768" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="45768" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert6_mlp_res -->
<g id="node414" class="node">
<title>layer2_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="45608.2,-1615.68 45278.59,-1615.68 45193.8,-1527.68 45523.41,-1527.68 45608.2,-1615.68"/>
<text text-anchor="middle" x="45401" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="45401" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="45401" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="45401" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert6_ln2 -->
<g id="node415" class="node">
<title>layer2_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="45176,-1593.68 44976,-1593.68 44976,-1549.68 45176,-1549.68 45176,-1593.68"/>
<text text-anchor="middle" x="45076" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="45076" y="-1574.28" font-family="Arial" font-size="8.00">L2_E6</text>
<text text-anchor="middle" x="45076" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="45076" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert7_route -->
<g id="node416" class="node">
<title>layer2_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="44952,-1593.68 44752,-1593.68 44752,-1549.68 44952,-1549.68 44952,-1593.68"/>
<text text-anchor="middle" x="44852" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="44852" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="44852" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="44852" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert7_gate -->
<g id="node417" class="node">
<title>layer2_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="44734.04,-1615.68 44419,-1615.68 44337.96,-1527.68 44653,-1527.68 44734.04,-1615.68"/>
<text text-anchor="middle" x="44536" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="44536" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="44536" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="44536" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer2_expert7_a2a -->
<g id="node418" class="node">
<title>layer2_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="44179" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="44179" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="44179" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="44179" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="44179" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert7_attn_split -->
<g id="node419" class="node">
<title>layer2_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="44019.48,-1615.68 43694.2,-1615.68 43610.52,-1527.68 43935.8,-1527.68 44019.48,-1615.68"/>
<text text-anchor="middle" x="43815" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="43815" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="43815" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="43815" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert7_q_proj -->
<g id="node420" class="node">
<title>layer2_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="43592.5,-1593.68 43395.5,-1593.68 43395.5,-1549.68 43592.5,-1549.68 43592.5,-1593.68"/>
<text text-anchor="middle" x="43494" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="43494" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="43494" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="43494" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert7_k_proj -->
<g id="node421" class="node">
<title>layer2_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="43377.5,-1593.68 43180.5,-1593.68 43180.5,-1549.68 43377.5,-1549.68 43377.5,-1593.68"/>
<text text-anchor="middle" x="43279" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="43279" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="43279" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="43279" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert7_v_proj -->
<g id="node422" class="node">
<title>layer2_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="43162.5,-1593.68 42965.5,-1593.68 42965.5,-1549.68 43162.5,-1549.68 43162.5,-1593.68"/>
<text text-anchor="middle" x="43064" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="43064" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="43064" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="43064" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert7_attn -->
<g id="node423" class="node">
<title>layer2_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="42947.5,-1593.68 42750.5,-1593.68 42750.5,-1549.68 42947.5,-1549.68 42947.5,-1593.68"/>
<text text-anchor="middle" x="42849" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="42849" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="42849" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="42849" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer2_expert7_attn_out -->
<g id="node424" class="node">
<title>layer2_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="42732,-1593.68 42532,-1593.68 42532,-1549.68 42732,-1549.68 42732,-1593.68"/>
<text text-anchor="middle" x="42632" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="42632" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="42632" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="42632" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert7_attn_ar -->
<g id="node425" class="node">
<title>layer2_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="42373" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="42373" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="42373" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="42373" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="42373" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert7_attn_res -->
<g id="node426" class="node">
<title>layer2_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="42213.2,-1615.68 41883.59,-1615.68 41798.8,-1527.68 42128.41,-1527.68 42213.2,-1615.68"/>
<text text-anchor="middle" x="42006" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="42006" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="42006" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="42006" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert7_ln1 -->
<g id="node427" class="node">
<title>layer2_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="41781,-1593.68 41581,-1593.68 41581,-1549.68 41781,-1549.68 41781,-1593.68"/>
<text text-anchor="middle" x="41681" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="41681" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="41681" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="41681" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert7_mlp1 -->
<g id="node428" class="node">
<title>layer2_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="41563,-1593.68 41367,-1593.68 41367,-1549.68 41563,-1549.68 41563,-1593.68"/>
<text text-anchor="middle" x="41465" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="41465" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="41465" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="41465" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert7_gelu -->
<g id="node429" class="node">
<title>layer2_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="41349,-1593.68 41153,-1593.68 41153,-1549.68 41349,-1549.68 41349,-1593.68"/>
<text text-anchor="middle" x="41251" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="41251" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="41251" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="41251" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer2_expert7_mlp2 -->
<g id="node430" class="node">
<title>layer2_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="41135,-1593.68 40935,-1593.68 40935,-1549.68 41135,-1549.68 41135,-1593.68"/>
<text text-anchor="middle" x="41035" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="41035" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="41035" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="41035" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert7_mlp_ar -->
<g id="node431" class="node">
<title>layer2_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="40776" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="40776" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="40776" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="40776" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="40776" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert7_mlp_res -->
<g id="node432" class="node">
<title>layer2_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="40616.2,-1615.68 40286.59,-1615.68 40201.8,-1527.68 40531.41,-1527.68 40616.2,-1615.68"/>
<text text-anchor="middle" x="40409" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="40409" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="40409" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="40409" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer2_expert7_ln2 -->
<g id="node433" class="node">
<title>layer2_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="40184,-1593.68 39984,-1593.68 39984,-1549.68 40184,-1549.68 40184,-1593.68"/>
<text text-anchor="middle" x="40084" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="40084" y="-1574.28" font-family="Arial" font-size="8.00">L2_E7</text>
<text text-anchor="middle" x="40084" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="40084" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert0_route -->
<g id="node434" class="node">
<title>layer3_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="39944,-1593.68 39744,-1593.68 39744,-1549.68 39944,-1549.68 39944,-1593.68"/>
<text text-anchor="middle" x="39844" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="39844" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="39844" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="39844" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert0_gate -->
<g id="node435" class="node">
<title>layer3_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="39726.04,-1615.68 39411,-1615.68 39329.96,-1527.68 39645,-1527.68 39726.04,-1615.68"/>
<text text-anchor="middle" x="39528" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="39528" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="39528" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="39528" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer3_expert0_a2a -->
<g id="node436" class="node">
<title>layer3_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="39171" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="39171" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="39171" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="39171" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="39171" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert0_attn_split -->
<g id="node437" class="node">
<title>layer3_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="39011.48,-1615.68 38686.2,-1615.68 38602.52,-1527.68 38927.8,-1527.68 39011.48,-1615.68"/>
<text text-anchor="middle" x="38807" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="38807" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="38807" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="38807" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert0_q_proj -->
<g id="node438" class="node">
<title>layer3_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="38584.5,-1593.68 38387.5,-1593.68 38387.5,-1549.68 38584.5,-1549.68 38584.5,-1593.68"/>
<text text-anchor="middle" x="38486" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="38486" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="38486" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="38486" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert0_k_proj -->
<g id="node439" class="node">
<title>layer3_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="38369.5,-1593.68 38172.5,-1593.68 38172.5,-1549.68 38369.5,-1549.68 38369.5,-1593.68"/>
<text text-anchor="middle" x="38271" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="38271" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="38271" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="38271" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert0_v_proj -->
<g id="node440" class="node">
<title>layer3_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="38154.5,-1593.68 37957.5,-1593.68 37957.5,-1549.68 38154.5,-1549.68 38154.5,-1593.68"/>
<text text-anchor="middle" x="38056" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="38056" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="38056" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="38056" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert0_attn -->
<g id="node441" class="node">
<title>layer3_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="37939.5,-1593.68 37742.5,-1593.68 37742.5,-1549.68 37939.5,-1549.68 37939.5,-1593.68"/>
<text text-anchor="middle" x="37841" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="37841" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="37841" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="37841" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert0_attn_out -->
<g id="node442" class="node">
<title>layer3_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="37724,-1593.68 37524,-1593.68 37524,-1549.68 37724,-1549.68 37724,-1593.68"/>
<text text-anchor="middle" x="37624" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="37624" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="37624" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="37624" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert0_attn_ar -->
<g id="node443" class="node">
<title>layer3_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="37365" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="37365" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="37365" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="37365" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="37365" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert0_attn_res -->
<g id="node444" class="node">
<title>layer3_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="37205.2,-1615.68 36875.59,-1615.68 36790.8,-1527.68 37120.41,-1527.68 37205.2,-1615.68"/>
<text text-anchor="middle" x="36998" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="36998" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="36998" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="36998" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert0_ln1 -->
<g id="node445" class="node">
<title>layer3_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="36773,-1593.68 36573,-1593.68 36573,-1549.68 36773,-1549.68 36773,-1593.68"/>
<text text-anchor="middle" x="36673" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="36673" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="36673" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="36673" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert0_mlp1 -->
<g id="node446" class="node">
<title>layer3_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="36555,-1593.68 36359,-1593.68 36359,-1549.68 36555,-1549.68 36555,-1593.68"/>
<text text-anchor="middle" x="36457" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="36457" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="36457" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="36457" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert0_gelu -->
<g id="node447" class="node">
<title>layer3_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="36341,-1593.68 36145,-1593.68 36145,-1549.68 36341,-1549.68 36341,-1593.68"/>
<text text-anchor="middle" x="36243" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="36243" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="36243" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="36243" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert0_mlp2 -->
<g id="node448" class="node">
<title>layer3_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="36127,-1593.68 35927,-1593.68 35927,-1549.68 36127,-1549.68 36127,-1593.68"/>
<text text-anchor="middle" x="36027" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="36027" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="36027" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="36027" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert0_mlp_ar -->
<g id="node449" class="node">
<title>layer3_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="35768" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="35768" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="35768" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="35768" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="35768" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert0_mlp_res -->
<g id="node450" class="node">
<title>layer3_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="35608.2,-1615.68 35278.59,-1615.68 35193.8,-1527.68 35523.41,-1527.68 35608.2,-1615.68"/>
<text text-anchor="middle" x="35401" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="35401" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="35401" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="35401" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert0_ln2 -->
<g id="node451" class="node">
<title>layer3_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="35176,-1593.68 34976,-1593.68 34976,-1549.68 35176,-1549.68 35176,-1593.68"/>
<text text-anchor="middle" x="35076" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="35076" y="-1574.28" font-family="Arial" font-size="8.00">L3_E0</text>
<text text-anchor="middle" x="35076" y="-1565.28" font-family="Arial" font-size="8.00">GPU:0</text>
<text text-anchor="middle" x="35076" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert1_route -->
<g id="node452" class="node">
<title>layer3_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="34952,-1593.68 34752,-1593.68 34752,-1549.68 34952,-1549.68 34952,-1593.68"/>
<text text-anchor="middle" x="34852" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="34852" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="34852" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="34852" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert1_gate -->
<g id="node453" class="node">
<title>layer3_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="34734.04,-1615.68 34419,-1615.68 34337.96,-1527.68 34653,-1527.68 34734.04,-1615.68"/>
<text text-anchor="middle" x="34536" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="34536" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="34536" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="34536" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer3_expert1_a2a -->
<g id="node454" class="node">
<title>layer3_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="34179" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="34179" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="34179" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="34179" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="34179" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert1_attn_split -->
<g id="node455" class="node">
<title>layer3_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="34019.48,-1615.68 33694.2,-1615.68 33610.52,-1527.68 33935.8,-1527.68 34019.48,-1615.68"/>
<text text-anchor="middle" x="33815" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="33815" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="33815" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="33815" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert1_q_proj -->
<g id="node456" class="node">
<title>layer3_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="33592.5,-1593.68 33395.5,-1593.68 33395.5,-1549.68 33592.5,-1549.68 33592.5,-1593.68"/>
<text text-anchor="middle" x="33494" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="33494" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="33494" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="33494" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert1_k_proj -->
<g id="node457" class="node">
<title>layer3_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="33377.5,-1593.68 33180.5,-1593.68 33180.5,-1549.68 33377.5,-1549.68 33377.5,-1593.68"/>
<text text-anchor="middle" x="33279" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="33279" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="33279" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="33279" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert1_v_proj -->
<g id="node458" class="node">
<title>layer3_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="33162.5,-1593.68 32965.5,-1593.68 32965.5,-1549.68 33162.5,-1549.68 33162.5,-1593.68"/>
<text text-anchor="middle" x="33064" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="33064" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="33064" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="33064" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert1_attn -->
<g id="node459" class="node">
<title>layer3_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="32947.5,-1593.68 32750.5,-1593.68 32750.5,-1549.68 32947.5,-1549.68 32947.5,-1593.68"/>
<text text-anchor="middle" x="32849" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="32849" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="32849" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="32849" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert1_attn_out -->
<g id="node460" class="node">
<title>layer3_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="32732,-1593.68 32532,-1593.68 32532,-1549.68 32732,-1549.68 32732,-1593.68"/>
<text text-anchor="middle" x="32632" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="32632" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="32632" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="32632" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert1_attn_ar -->
<g id="node461" class="node">
<title>layer3_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="32373" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="32373" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="32373" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="32373" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="32373" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert1_attn_res -->
<g id="node462" class="node">
<title>layer3_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="32213.2,-1615.68 31883.59,-1615.68 31798.8,-1527.68 32128.41,-1527.68 32213.2,-1615.68"/>
<text text-anchor="middle" x="32006" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="32006" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="32006" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="32006" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert1_ln1 -->
<g id="node463" class="node">
<title>layer3_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="31781,-1593.68 31581,-1593.68 31581,-1549.68 31781,-1549.68 31781,-1593.68"/>
<text text-anchor="middle" x="31681" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="31681" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="31681" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="31681" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert1_mlp1 -->
<g id="node464" class="node">
<title>layer3_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="31563,-1593.68 31367,-1593.68 31367,-1549.68 31563,-1549.68 31563,-1593.68"/>
<text text-anchor="middle" x="31465" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="31465" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="31465" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="31465" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert1_gelu -->
<g id="node465" class="node">
<title>layer3_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="31349,-1593.68 31153,-1593.68 31153,-1549.68 31349,-1549.68 31349,-1593.68"/>
<text text-anchor="middle" x="31251" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="31251" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="31251" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="31251" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert1_mlp2 -->
<g id="node466" class="node">
<title>layer3_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="31135,-1593.68 30935,-1593.68 30935,-1549.68 31135,-1549.68 31135,-1593.68"/>
<text text-anchor="middle" x="31035" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="31035" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="31035" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="31035" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert1_mlp_ar -->
<g id="node467" class="node">
<title>layer3_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="30776" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="30776" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="30776" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="30776" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="30776" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert1_mlp_res -->
<g id="node468" class="node">
<title>layer3_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="30616.2,-1615.68 30286.59,-1615.68 30201.8,-1527.68 30531.41,-1527.68 30616.2,-1615.68"/>
<text text-anchor="middle" x="30409" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="30409" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="30409" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="30409" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert1_ln2 -->
<g id="node469" class="node">
<title>layer3_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="30184,-1593.68 29984,-1593.68 29984,-1549.68 30184,-1549.68 30184,-1593.68"/>
<text text-anchor="middle" x="30084" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="30084" y="-1574.28" font-family="Arial" font-size="8.00">L3_E1</text>
<text text-anchor="middle" x="30084" y="-1565.28" font-family="Arial" font-size="8.00">GPU:2</text>
<text text-anchor="middle" x="30084" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert2_route -->
<g id="node470" class="node">
<title>layer3_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="29960,-1593.68 29760,-1593.68 29760,-1549.68 29960,-1549.68 29960,-1593.68"/>
<text text-anchor="middle" x="29860" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="29860" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="29860" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="29860" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert2_gate -->
<g id="node471" class="node">
<title>layer3_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="29742.04,-1615.68 29427,-1615.68 29345.96,-1527.68 29661,-1527.68 29742.04,-1615.68"/>
<text text-anchor="middle" x="29544" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="29544" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="29544" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="29544" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer3_expert2_a2a -->
<g id="node472" class="node">
<title>layer3_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="29187" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="29187" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="29187" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="29187" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="29187" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert2_attn_split -->
<g id="node473" class="node">
<title>layer3_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="29027.48,-1615.68 28702.2,-1615.68 28618.52,-1527.68 28943.8,-1527.68 29027.48,-1615.68"/>
<text text-anchor="middle" x="28823" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="28823" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="28823" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="28823" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert2_q_proj -->
<g id="node474" class="node">
<title>layer3_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="28600.5,-1593.68 28403.5,-1593.68 28403.5,-1549.68 28600.5,-1549.68 28600.5,-1593.68"/>
<text text-anchor="middle" x="28502" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="28502" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="28502" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="28502" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert2_k_proj -->
<g id="node475" class="node">
<title>layer3_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="28385.5,-1593.68 28188.5,-1593.68 28188.5,-1549.68 28385.5,-1549.68 28385.5,-1593.68"/>
<text text-anchor="middle" x="28287" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="28287" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="28287" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="28287" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert2_v_proj -->
<g id="node476" class="node">
<title>layer3_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="28170.5,-1593.68 27973.5,-1593.68 27973.5,-1549.68 28170.5,-1549.68 28170.5,-1593.68"/>
<text text-anchor="middle" x="28072" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="28072" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="28072" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="28072" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert2_attn -->
<g id="node477" class="node">
<title>layer3_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="27955.5,-1593.68 27758.5,-1593.68 27758.5,-1549.68 27955.5,-1549.68 27955.5,-1593.68"/>
<text text-anchor="middle" x="27857" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="27857" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="27857" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="27857" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert2_attn_out -->
<g id="node478" class="node">
<title>layer3_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="27740,-1593.68 27540,-1593.68 27540,-1549.68 27740,-1549.68 27740,-1593.68"/>
<text text-anchor="middle" x="27640" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="27640" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="27640" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="27640" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert2_attn_ar -->
<g id="node479" class="node">
<title>layer3_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="27381" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="27381" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="27381" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="27381" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="27381" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert2_attn_res -->
<g id="node480" class="node">
<title>layer3_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="27221.2,-1615.68 26891.59,-1615.68 26806.8,-1527.68 27136.41,-1527.68 27221.2,-1615.68"/>
<text text-anchor="middle" x="27014" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="27014" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="27014" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="27014" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert2_ln1 -->
<g id="node481" class="node">
<title>layer3_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="26789,-1593.68 26589,-1593.68 26589,-1549.68 26789,-1549.68 26789,-1593.68"/>
<text text-anchor="middle" x="26689" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="26689" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="26689" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="26689" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert2_mlp1 -->
<g id="node482" class="node">
<title>layer3_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="26571,-1593.68 26375,-1593.68 26375,-1549.68 26571,-1549.68 26571,-1593.68"/>
<text text-anchor="middle" x="26473" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="26473" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="26473" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="26473" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert2_gelu -->
<g id="node483" class="node">
<title>layer3_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="26357,-1593.68 26161,-1593.68 26161,-1549.68 26357,-1549.68 26357,-1593.68"/>
<text text-anchor="middle" x="26259" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="26259" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="26259" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="26259" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert2_mlp2 -->
<g id="node484" class="node">
<title>layer3_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="26143,-1593.68 25943,-1593.68 25943,-1549.68 26143,-1549.68 26143,-1593.68"/>
<text text-anchor="middle" x="26043" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="26043" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="26043" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="26043" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert2_mlp_ar -->
<g id="node485" class="node">
<title>layer3_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="25784" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="25784" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="25784" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="25784" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="25784" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert2_mlp_res -->
<g id="node486" class="node">
<title>layer3_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="25624.2,-1615.68 25294.59,-1615.68 25209.8,-1527.68 25539.41,-1527.68 25624.2,-1615.68"/>
<text text-anchor="middle" x="25417" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="25417" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="25417" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="25417" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert2_ln2 -->
<g id="node487" class="node">
<title>layer3_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="25192,-1593.68 24992,-1593.68 24992,-1549.68 25192,-1549.68 25192,-1593.68"/>
<text text-anchor="middle" x="25092" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="25092" y="-1574.28" font-family="Arial" font-size="8.00">L3_E2</text>
<text text-anchor="middle" x="25092" y="-1565.28" font-family="Arial" font-size="8.00">GPU:4</text>
<text text-anchor="middle" x="25092" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert3_route -->
<g id="node488" class="node">
<title>layer3_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="24968,-1593.68 24768,-1593.68 24768,-1549.68 24968,-1549.68 24968,-1593.68"/>
<text text-anchor="middle" x="24868" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="24868" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="24868" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="24868" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert3_gate -->
<g id="node489" class="node">
<title>layer3_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="24750.04,-1615.68 24435,-1615.68 24353.96,-1527.68 24669,-1527.68 24750.04,-1615.68"/>
<text text-anchor="middle" x="24552" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="24552" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="24552" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="24552" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer3_expert3_a2a -->
<g id="node490" class="node">
<title>layer3_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="24195" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="24195" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="24195" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="24195" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="24195" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert3_attn_split -->
<g id="node491" class="node">
<title>layer3_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="24035.48,-1615.68 23710.2,-1615.68 23626.52,-1527.68 23951.8,-1527.68 24035.48,-1615.68"/>
<text text-anchor="middle" x="23831" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="23831" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="23831" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="23831" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert3_q_proj -->
<g id="node492" class="node">
<title>layer3_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="23608.5,-1593.68 23411.5,-1593.68 23411.5,-1549.68 23608.5,-1549.68 23608.5,-1593.68"/>
<text text-anchor="middle" x="23510" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="23510" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="23510" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="23510" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert3_k_proj -->
<g id="node493" class="node">
<title>layer3_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="23393.5,-1593.68 23196.5,-1593.68 23196.5,-1549.68 23393.5,-1549.68 23393.5,-1593.68"/>
<text text-anchor="middle" x="23295" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="23295" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="23295" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="23295" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert3_v_proj -->
<g id="node494" class="node">
<title>layer3_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="23178.5,-1593.68 22981.5,-1593.68 22981.5,-1549.68 23178.5,-1549.68 23178.5,-1593.68"/>
<text text-anchor="middle" x="23080" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="23080" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="23080" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="23080" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert3_attn -->
<g id="node495" class="node">
<title>layer3_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="22963.5,-1593.68 22766.5,-1593.68 22766.5,-1549.68 22963.5,-1549.68 22963.5,-1593.68"/>
<text text-anchor="middle" x="22865" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="22865" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="22865" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="22865" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert3_attn_out -->
<g id="node496" class="node">
<title>layer3_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="22748,-1593.68 22548,-1593.68 22548,-1549.68 22748,-1549.68 22748,-1593.68"/>
<text text-anchor="middle" x="22648" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="22648" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="22648" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="22648" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert3_attn_ar -->
<g id="node497" class="node">
<title>layer3_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="22389" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="22389" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="22389" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="22389" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="22389" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert3_attn_res -->
<g id="node498" class="node">
<title>layer3_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="22229.2,-1615.68 21899.59,-1615.68 21814.8,-1527.68 22144.41,-1527.68 22229.2,-1615.68"/>
<text text-anchor="middle" x="22022" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="22022" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="22022" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="22022" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert3_ln1 -->
<g id="node499" class="node">
<title>layer3_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="21797,-1593.68 21597,-1593.68 21597,-1549.68 21797,-1549.68 21797,-1593.68"/>
<text text-anchor="middle" x="21697" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="21697" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="21697" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="21697" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert3_mlp1 -->
<g id="node500" class="node">
<title>layer3_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="21579,-1593.68 21383,-1593.68 21383,-1549.68 21579,-1549.68 21579,-1593.68"/>
<text text-anchor="middle" x="21481" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="21481" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="21481" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="21481" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert3_gelu -->
<g id="node501" class="node">
<title>layer3_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="21365,-1593.68 21169,-1593.68 21169,-1549.68 21365,-1549.68 21365,-1593.68"/>
<text text-anchor="middle" x="21267" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="21267" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="21267" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="21267" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert3_mlp2 -->
<g id="node502" class="node">
<title>layer3_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="21151,-1593.68 20951,-1593.68 20951,-1549.68 21151,-1549.68 21151,-1593.68"/>
<text text-anchor="middle" x="21051" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="21051" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="21051" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="21051" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert3_mlp_ar -->
<g id="node503" class="node">
<title>layer3_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="20792" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="20792" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="20792" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="20792" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="20792" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert3_mlp_res -->
<g id="node504" class="node">
<title>layer3_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="20632.2,-1615.68 20302.59,-1615.68 20217.8,-1527.68 20547.41,-1527.68 20632.2,-1615.68"/>
<text text-anchor="middle" x="20425" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="20425" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="20425" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="20425" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert3_ln2 -->
<g id="node505" class="node">
<title>layer3_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="20200,-1593.68 20000,-1593.68 20000,-1549.68 20200,-1549.68 20200,-1593.68"/>
<text text-anchor="middle" x="20100" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="20100" y="-1574.28" font-family="Arial" font-size="8.00">L3_E3</text>
<text text-anchor="middle" x="20100" y="-1565.28" font-family="Arial" font-size="8.00">GPU:6</text>
<text text-anchor="middle" x="20100" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert4_route -->
<g id="node506" class="node">
<title>layer3_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="19976,-1593.68 19776,-1593.68 19776,-1549.68 19976,-1549.68 19976,-1593.68"/>
<text text-anchor="middle" x="19876" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="19876" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="19876" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="19876" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert4_gate -->
<g id="node507" class="node">
<title>layer3_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="19758.04,-1615.68 19443,-1615.68 19361.96,-1527.68 19677,-1527.68 19758.04,-1615.68"/>
<text text-anchor="middle" x="19560" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="19560" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="19560" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="19560" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer3_expert4_a2a -->
<g id="node508" class="node">
<title>layer3_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="19203" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="19203" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="19203" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="19203" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="19203" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert4_attn_split -->
<g id="node509" class="node">
<title>layer3_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="19043.48,-1615.68 18718.2,-1615.68 18634.52,-1527.68 18959.8,-1527.68 19043.48,-1615.68"/>
<text text-anchor="middle" x="18839" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="18839" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="18839" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="18839" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert4_q_proj -->
<g id="node510" class="node">
<title>layer3_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="18616.5,-1593.68 18419.5,-1593.68 18419.5,-1549.68 18616.5,-1549.68 18616.5,-1593.68"/>
<text text-anchor="middle" x="18518" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="18518" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="18518" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="18518" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert4_k_proj -->
<g id="node511" class="node">
<title>layer3_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="18401.5,-1593.68 18204.5,-1593.68 18204.5,-1549.68 18401.5,-1549.68 18401.5,-1593.68"/>
<text text-anchor="middle" x="18303" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="18303" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="18303" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="18303" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert4_v_proj -->
<g id="node512" class="node">
<title>layer3_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="18186.5,-1593.68 17989.5,-1593.68 17989.5,-1549.68 18186.5,-1549.68 18186.5,-1593.68"/>
<text text-anchor="middle" x="18088" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="18088" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="18088" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="18088" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert4_attn -->
<g id="node513" class="node">
<title>layer3_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="17971.5,-1593.68 17774.5,-1593.68 17774.5,-1549.68 17971.5,-1549.68 17971.5,-1593.68"/>
<text text-anchor="middle" x="17873" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="17873" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="17873" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="17873" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert4_attn_out -->
<g id="node514" class="node">
<title>layer3_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="17756,-1593.68 17556,-1593.68 17556,-1549.68 17756,-1549.68 17756,-1593.68"/>
<text text-anchor="middle" x="17656" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="17656" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="17656" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="17656" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert4_attn_ar -->
<g id="node515" class="node">
<title>layer3_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="17397" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="17397" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="17397" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="17397" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="17397" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert4_attn_res -->
<g id="node516" class="node">
<title>layer3_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="17237.2,-1615.68 16907.59,-1615.68 16822.8,-1527.68 17152.41,-1527.68 17237.2,-1615.68"/>
<text text-anchor="middle" x="17030" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="17030" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="17030" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="17030" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert4_ln1 -->
<g id="node517" class="node">
<title>layer3_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="16805,-1593.68 16605,-1593.68 16605,-1549.68 16805,-1549.68 16805,-1593.68"/>
<text text-anchor="middle" x="16705" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="16705" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="16705" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="16705" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert4_mlp1 -->
<g id="node518" class="node">
<title>layer3_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="16587,-1593.68 16391,-1593.68 16391,-1549.68 16587,-1549.68 16587,-1593.68"/>
<text text-anchor="middle" x="16489" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="16489" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="16489" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="16489" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert4_gelu -->
<g id="node519" class="node">
<title>layer3_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="16373,-1593.68 16177,-1593.68 16177,-1549.68 16373,-1549.68 16373,-1593.68"/>
<text text-anchor="middle" x="16275" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="16275" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="16275" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="16275" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert4_mlp2 -->
<g id="node520" class="node">
<title>layer3_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="16159,-1593.68 15959,-1593.68 15959,-1549.68 16159,-1549.68 16159,-1593.68"/>
<text text-anchor="middle" x="16059" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="16059" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="16059" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="16059" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert4_mlp_ar -->
<g id="node521" class="node">
<title>layer3_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="15800" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="15800" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="15800" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="15800" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="15800" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert4_mlp_res -->
<g id="node522" class="node">
<title>layer3_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="15640.2,-1615.68 15310.59,-1615.68 15225.8,-1527.68 15555.41,-1527.68 15640.2,-1615.68"/>
<text text-anchor="middle" x="15433" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="15433" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="15433" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="15433" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert4_ln2 -->
<g id="node523" class="node">
<title>layer3_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="15208,-1593.68 15008,-1593.68 15008,-1549.68 15208,-1549.68 15208,-1593.68"/>
<text text-anchor="middle" x="15108" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="15108" y="-1574.28" font-family="Arial" font-size="8.00">L3_E4</text>
<text text-anchor="middle" x="15108" y="-1565.28" font-family="Arial" font-size="8.00">GPU:8</text>
<text text-anchor="middle" x="15108" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert5_route -->
<g id="node524" class="node">
<title>layer3_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="14984,-1593.68 14784,-1593.68 14784,-1549.68 14984,-1549.68 14984,-1593.68"/>
<text text-anchor="middle" x="14884" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="14884" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="14884" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="14884" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert5_gate -->
<g id="node525" class="node">
<title>layer3_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="14766.04,-1615.68 14451,-1615.68 14369.96,-1527.68 14685,-1527.68 14766.04,-1615.68"/>
<text text-anchor="middle" x="14568" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="14568" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="14568" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="14568" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer3_expert5_a2a -->
<g id="node526" class="node">
<title>layer3_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="14211" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="14211" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="14211" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="14211" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="14211" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert5_attn_split -->
<g id="node527" class="node">
<title>layer3_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="14051.48,-1615.68 13726.2,-1615.68 13642.52,-1527.68 13967.8,-1527.68 14051.48,-1615.68"/>
<text text-anchor="middle" x="13847" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="13847" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="13847" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="13847" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert5_q_proj -->
<g id="node528" class="node">
<title>layer3_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="13624.5,-1593.68 13427.5,-1593.68 13427.5,-1549.68 13624.5,-1549.68 13624.5,-1593.68"/>
<text text-anchor="middle" x="13526" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="13526" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="13526" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="13526" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert5_k_proj -->
<g id="node529" class="node">
<title>layer3_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="13409.5,-1593.68 13212.5,-1593.68 13212.5,-1549.68 13409.5,-1549.68 13409.5,-1593.68"/>
<text text-anchor="middle" x="13311" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="13311" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="13311" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="13311" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert5_v_proj -->
<g id="node530" class="node">
<title>layer3_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="13194.5,-1593.68 12997.5,-1593.68 12997.5,-1549.68 13194.5,-1549.68 13194.5,-1593.68"/>
<text text-anchor="middle" x="13096" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="13096" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="13096" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="13096" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert5_attn -->
<g id="node531" class="node">
<title>layer3_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="12979.5,-1593.68 12782.5,-1593.68 12782.5,-1549.68 12979.5,-1549.68 12979.5,-1593.68"/>
<text text-anchor="middle" x="12881" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="12881" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="12881" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="12881" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert5_attn_out -->
<g id="node532" class="node">
<title>layer3_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="12764,-1593.68 12564,-1593.68 12564,-1549.68 12764,-1549.68 12764,-1593.68"/>
<text text-anchor="middle" x="12664" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="12664" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="12664" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="12664" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert5_attn_ar -->
<g id="node533" class="node">
<title>layer3_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="12405" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="12405" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="12405" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="12405" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="12405" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert5_attn_res -->
<g id="node534" class="node">
<title>layer3_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="12245.2,-1615.68 11915.59,-1615.68 11830.8,-1527.68 12160.41,-1527.68 12245.2,-1615.68"/>
<text text-anchor="middle" x="12038" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="12038" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="12038" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="12038" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert5_ln1 -->
<g id="node535" class="node">
<title>layer3_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="11813,-1593.68 11613,-1593.68 11613,-1549.68 11813,-1549.68 11813,-1593.68"/>
<text text-anchor="middle" x="11713" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="11713" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="11713" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="11713" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert5_mlp1 -->
<g id="node536" class="node">
<title>layer3_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="11595,-1593.68 11399,-1593.68 11399,-1549.68 11595,-1549.68 11595,-1593.68"/>
<text text-anchor="middle" x="11497" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="11497" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="11497" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="11497" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert5_gelu -->
<g id="node537" class="node">
<title>layer3_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="11381,-1593.68 11185,-1593.68 11185,-1549.68 11381,-1549.68 11381,-1593.68"/>
<text text-anchor="middle" x="11283" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="11283" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="11283" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="11283" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert5_mlp2 -->
<g id="node538" class="node">
<title>layer3_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="11167,-1593.68 10967,-1593.68 10967,-1549.68 11167,-1549.68 11167,-1593.68"/>
<text text-anchor="middle" x="11067" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="11067" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="11067" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="11067" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert5_mlp_ar -->
<g id="node539" class="node">
<title>layer3_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="10808" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="10808" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="10808" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="10808" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="10808" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert5_mlp_res -->
<g id="node540" class="node">
<title>layer3_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="10648.2,-1615.68 10318.59,-1615.68 10233.8,-1527.68 10563.41,-1527.68 10648.2,-1615.68"/>
<text text-anchor="middle" x="10441" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="10441" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="10441" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="10441" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert5_ln2 -->
<g id="node541" class="node">
<title>layer3_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="10216,-1593.68 10016,-1593.68 10016,-1549.68 10216,-1549.68 10216,-1593.68"/>
<text text-anchor="middle" x="10116" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="10116" y="-1574.28" font-family="Arial" font-size="8.00">L3_E5</text>
<text text-anchor="middle" x="10116" y="-1565.28" font-family="Arial" font-size="8.00">GPU:10</text>
<text text-anchor="middle" x="10116" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert6_route -->
<g id="node542" class="node">
<title>layer3_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="9992,-1593.68 9792,-1593.68 9792,-1549.68 9992,-1549.68 9992,-1593.68"/>
<text text-anchor="middle" x="9892" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="9892" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="9892" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="9892" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert6_gate -->
<g id="node543" class="node">
<title>layer3_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="9774.04,-1615.68 9459,-1615.68 9377.96,-1527.68 9693,-1527.68 9774.04,-1615.68"/>
<text text-anchor="middle" x="9576" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="9576" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="9576" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="9576" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer3_expert6_a2a -->
<g id="node544" class="node">
<title>layer3_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="9219" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="9219" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="9219" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="9219" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="9219" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert6_attn_split -->
<g id="node545" class="node">
<title>layer3_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="9059.48,-1615.68 8734.2,-1615.68 8650.52,-1527.68 8975.8,-1527.68 9059.48,-1615.68"/>
<text text-anchor="middle" x="8855" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="8855" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="8855" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="8855" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert6_q_proj -->
<g id="node546" class="node">
<title>layer3_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="8632.5,-1593.68 8435.5,-1593.68 8435.5,-1549.68 8632.5,-1549.68 8632.5,-1593.68"/>
<text text-anchor="middle" x="8534" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="8534" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="8534" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="8534" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert6_k_proj -->
<g id="node547" class="node">
<title>layer3_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="8417.5,-1593.68 8220.5,-1593.68 8220.5,-1549.68 8417.5,-1549.68 8417.5,-1593.68"/>
<text text-anchor="middle" x="8319" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="8319" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="8319" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="8319" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert6_v_proj -->
<g id="node548" class="node">
<title>layer3_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="8202.5,-1593.68 8005.5,-1593.68 8005.5,-1549.68 8202.5,-1549.68 8202.5,-1593.68"/>
<text text-anchor="middle" x="8104" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="8104" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="8104" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="8104" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert6_attn -->
<g id="node549" class="node">
<title>layer3_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="7987.5,-1593.68 7790.5,-1593.68 7790.5,-1549.68 7987.5,-1549.68 7987.5,-1593.68"/>
<text text-anchor="middle" x="7889" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="7889" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="7889" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="7889" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert6_attn_out -->
<g id="node550" class="node">
<title>layer3_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="7772,-1593.68 7572,-1593.68 7572,-1549.68 7772,-1549.68 7772,-1593.68"/>
<text text-anchor="middle" x="7672" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="7672" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="7672" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="7672" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert6_attn_ar -->
<g id="node551" class="node">
<title>layer3_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="7413" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="7413" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="7413" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="7413" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="7413" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert6_attn_res -->
<g id="node552" class="node">
<title>layer3_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="7253.2,-1615.68 6923.59,-1615.68 6838.8,-1527.68 7168.41,-1527.68 7253.2,-1615.68"/>
<text text-anchor="middle" x="7046" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="7046" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="7046" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="7046" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert6_ln1 -->
<g id="node553" class="node">
<title>layer3_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="6821,-1593.68 6621,-1593.68 6621,-1549.68 6821,-1549.68 6821,-1593.68"/>
<text text-anchor="middle" x="6721" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="6721" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="6721" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="6721" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert6_mlp1 -->
<g id="node554" class="node">
<title>layer3_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="6603,-1593.68 6407,-1593.68 6407,-1549.68 6603,-1549.68 6603,-1593.68"/>
<text text-anchor="middle" x="6505" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="6505" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="6505" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="6505" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert6_gelu -->
<g id="node555" class="node">
<title>layer3_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="6389,-1593.68 6193,-1593.68 6193,-1549.68 6389,-1549.68 6389,-1593.68"/>
<text text-anchor="middle" x="6291" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="6291" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="6291" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="6291" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert6_mlp2 -->
<g id="node556" class="node">
<title>layer3_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="6175,-1593.68 5975,-1593.68 5975,-1549.68 6175,-1549.68 6175,-1593.68"/>
<text text-anchor="middle" x="6075" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="6075" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="6075" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="6075" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert6_mlp_ar -->
<g id="node557" class="node">
<title>layer3_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="5816" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="5816" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="5816" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="5816" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="5816" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert6_mlp_res -->
<g id="node558" class="node">
<title>layer3_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="5656.2,-1615.68 5326.59,-1615.68 5241.8,-1527.68 5571.41,-1527.68 5656.2,-1615.68"/>
<text text-anchor="middle" x="5449" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="5449" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="5449" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="5449" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert6_ln2 -->
<g id="node559" class="node">
<title>layer3_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="5224,-1593.68 5024,-1593.68 5024,-1549.68 5224,-1549.68 5224,-1593.68"/>
<text text-anchor="middle" x="5124" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="5124" y="-1574.28" font-family="Arial" font-size="8.00">L3_E6</text>
<text text-anchor="middle" x="5124" y="-1565.28" font-family="Arial" font-size="8.00">GPU:12</text>
<text text-anchor="middle" x="5124" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert7_route -->
<g id="node560" class="node">
<title>layer3_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="5000,-1593.68 4800,-1593.68 4800,-1549.68 5000,-1549.68 5000,-1593.68"/>
<text text-anchor="middle" x="4900" y="-1583.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="4900" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="4900" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="4900" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert7_gate -->
<g id="node561" class="node">
<title>layer3_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="4782.04,-1615.68 4467,-1615.68 4385.96,-1527.68 4701,-1527.68 4782.04,-1615.68"/>
<text text-anchor="middle" x="4584" y="-1583.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="4584" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="4584" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="4584" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer3_expert7_a2a -->
<g id="node562" class="node">
<title>layer3_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="4227" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="4227" y="-1583.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="4227" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="4227" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="4227" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert7_attn_split -->
<g id="node563" class="node">
<title>layer3_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="4067.48,-1615.68 3742.2,-1615.68 3658.52,-1527.68 3983.8,-1527.68 4067.48,-1615.68"/>
<text text-anchor="middle" x="3863" y="-1583.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="3863" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="3863" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="3863" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert7_q_proj -->
<g id="node564" class="node">
<title>layer3_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="3640.5,-1593.68 3443.5,-1593.68 3443.5,-1549.68 3640.5,-1549.68 3640.5,-1593.68"/>
<text text-anchor="middle" x="3542" y="-1583.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="3542" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="3542" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="3542" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert7_k_proj -->
<g id="node565" class="node">
<title>layer3_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="3425.5,-1593.68 3228.5,-1593.68 3228.5,-1549.68 3425.5,-1549.68 3425.5,-1593.68"/>
<text text-anchor="middle" x="3327" y="-1583.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="3327" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="3327" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="3327" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert7_v_proj -->
<g id="node566" class="node">
<title>layer3_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="3210.5,-1593.68 3013.5,-1593.68 3013.5,-1549.68 3210.5,-1549.68 3210.5,-1593.68"/>
<text text-anchor="middle" x="3112" y="-1583.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="3112" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="3112" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="3112" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert7_attn -->
<g id="node567" class="node">
<title>layer3_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="2995.5,-1593.68 2798.5,-1593.68 2798.5,-1549.68 2995.5,-1549.68 2995.5,-1593.68"/>
<text text-anchor="middle" x="2897" y="-1583.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2897" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="2897" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="2897" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer3_expert7_attn_out -->
<g id="node568" class="node">
<title>layer3_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="2780,-1593.68 2580,-1593.68 2580,-1549.68 2780,-1549.68 2780,-1593.68"/>
<text text-anchor="middle" x="2680" y="-1583.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="2680" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="2680" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="2680" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert7_attn_ar -->
<g id="node569" class="node">
<title>layer3_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="2421" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="2421" y="-1583.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="2421" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="2421" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="2421" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert7_attn_res -->
<g id="node570" class="node">
<title>layer3_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="2261.2,-1615.68 1931.59,-1615.68 1846.8,-1527.68 2176.41,-1527.68 2261.2,-1615.68"/>
<text text-anchor="middle" x="2054" y="-1583.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="2054" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="2054" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="2054" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert7_ln1 -->
<g id="node571" class="node">
<title>layer3_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="1829,-1593.68 1629,-1593.68 1629,-1549.68 1829,-1549.68 1829,-1593.68"/>
<text text-anchor="middle" x="1729" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="1729" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="1729" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="1729" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert7_mlp1 -->
<g id="node572" class="node">
<title>layer3_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="1611,-1593.68 1415,-1593.68 1415,-1549.68 1611,-1549.68 1611,-1593.68"/>
<text text-anchor="middle" x="1513" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="1513" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="1513" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="1513" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert7_gelu -->
<g id="node573" class="node">
<title>layer3_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="1397,-1593.68 1201,-1593.68 1201,-1549.68 1397,-1549.68 1397,-1593.68"/>
<text text-anchor="middle" x="1299" y="-1583.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="1299" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="1299" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="1299" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer3_expert7_mlp2 -->
<g id="node574" class="node">
<title>layer3_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="1183,-1593.68 983,-1593.68 983,-1549.68 1183,-1549.68 1183,-1593.68"/>
<text text-anchor="middle" x="1083" y="-1583.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="1083" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="1083" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="1083" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert7_mlp_ar -->
<g id="node575" class="node">
<title>layer3_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="824" cy="-1571.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="824" y="-1583.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="824" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="824" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="824" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert7_mlp_res -->
<g id="node576" class="node">
<title>layer3_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="664.2,-1615.68 334.59,-1615.68 249.8,-1527.68 579.41,-1527.68 664.2,-1615.68"/>
<text text-anchor="middle" x="457" y="-1583.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="457" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="457" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="457" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer3_expert7_ln2 -->
<g id="node577" class="node">
<title>layer3_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="232,-1593.68 32,-1593.68 32,-1549.68 232,-1549.68 232,-1593.68"/>
<text text-anchor="middle" x="132" y="-1583.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="132" y="-1574.28" font-family="Arial" font-size="8.00">L3_E7</text>
<text text-anchor="middle" x="132" y="-1565.28" font-family="Arial" font-size="8.00">GPU:14</text>
<text text-anchor="middle" x="132" y="-1556.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert0_route -->
<g id="node578" class="node">
<title>layer4_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="315121,-1794.68 314921,-1794.68 314921,-1750.68 315121,-1750.68 315121,-1794.68"/>
<text text-anchor="middle" x="315021" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="315021" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="315021" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="315021" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert0_gate -->
<g id="node579" class="node">
<title>layer4_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="314903.04,-1816.68 314588,-1816.68 314506.96,-1728.68 314822,-1728.68 314903.04,-1816.68"/>
<text text-anchor="middle" x="314705" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="314705" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="314705" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="314705" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer4_expert0_a2a -->
<g id="node580" class="node">
<title>layer4_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="314348" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="314348" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="314348" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="314348" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="314348" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert0_attn_split -->
<g id="node581" class="node">
<title>layer4_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="314188.48,-1816.68 313863.2,-1816.68 313779.52,-1728.68 314104.8,-1728.68 314188.48,-1816.68"/>
<text text-anchor="middle" x="313984" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="313984" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="313984" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="313984" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert0_q_proj -->
<g id="node582" class="node">
<title>layer4_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="313761.5,-1794.68 313564.5,-1794.68 313564.5,-1750.68 313761.5,-1750.68 313761.5,-1794.68"/>
<text text-anchor="middle" x="313663" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="313663" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="313663" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="313663" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert0_k_proj -->
<g id="node583" class="node">
<title>layer4_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="313546.5,-1794.68 313349.5,-1794.68 313349.5,-1750.68 313546.5,-1750.68 313546.5,-1794.68"/>
<text text-anchor="middle" x="313448" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="313448" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="313448" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="313448" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert0_v_proj -->
<g id="node584" class="node">
<title>layer4_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="313331.5,-1794.68 313134.5,-1794.68 313134.5,-1750.68 313331.5,-1750.68 313331.5,-1794.68"/>
<text text-anchor="middle" x="313233" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="313233" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="313233" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="313233" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert0_attn -->
<g id="node585" class="node">
<title>layer4_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="313116.5,-1794.68 312919.5,-1794.68 312919.5,-1750.68 313116.5,-1750.68 313116.5,-1794.68"/>
<text text-anchor="middle" x="313018" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="313018" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="313018" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="313018" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert0_attn_out -->
<g id="node586" class="node">
<title>layer4_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="312901,-1794.68 312701,-1794.68 312701,-1750.68 312901,-1750.68 312901,-1794.68"/>
<text text-anchor="middle" x="312801" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="312801" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="312801" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="312801" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert0_attn_ar -->
<g id="node587" class="node">
<title>layer4_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="312542" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="312542" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="312542" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="312542" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="312542" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert0_attn_res -->
<g id="node588" class="node">
<title>layer4_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="312382.2,-1816.68 312052.59,-1816.68 311967.8,-1728.68 312297.41,-1728.68 312382.2,-1816.68"/>
<text text-anchor="middle" x="312175" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="312175" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="312175" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="312175" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert0_ln1 -->
<g id="node589" class="node">
<title>layer4_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="311950,-1794.68 311750,-1794.68 311750,-1750.68 311950,-1750.68 311950,-1794.68"/>
<text text-anchor="middle" x="311850" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="311850" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="311850" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="311850" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert0_mlp1 -->
<g id="node590" class="node">
<title>layer4_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="311732,-1794.68 311536,-1794.68 311536,-1750.68 311732,-1750.68 311732,-1794.68"/>
<text text-anchor="middle" x="311634" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="311634" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="311634" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="311634" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert0_gelu -->
<g id="node591" class="node">
<title>layer4_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="311518,-1794.68 311322,-1794.68 311322,-1750.68 311518,-1750.68 311518,-1794.68"/>
<text text-anchor="middle" x="311420" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="311420" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="311420" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="311420" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert0_mlp2 -->
<g id="node592" class="node">
<title>layer4_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="311304,-1794.68 311104,-1794.68 311104,-1750.68 311304,-1750.68 311304,-1794.68"/>
<text text-anchor="middle" x="311204" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="311204" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="311204" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="311204" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert0_mlp_ar -->
<g id="node593" class="node">
<title>layer4_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="310945" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="310945" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="310945" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="310945" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="310945" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert0_mlp_res -->
<g id="node594" class="node">
<title>layer4_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="310785.2,-1816.68 310455.59,-1816.68 310370.8,-1728.68 310700.41,-1728.68 310785.2,-1816.68"/>
<text text-anchor="middle" x="310578" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="310578" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="310578" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="310578" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert0_ln2 -->
<g id="node595" class="node">
<title>layer4_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="310353,-1794.68 310153,-1794.68 310153,-1750.68 310353,-1750.68 310353,-1794.68"/>
<text text-anchor="middle" x="310253" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="310253" y="-1775.28" font-family="Arial" font-size="8.00">L4_E0</text>
<text text-anchor="middle" x="310253" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="310253" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert1_route -->
<g id="node596" class="node">
<title>layer4_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="310129,-1794.68 309929,-1794.68 309929,-1750.68 310129,-1750.68 310129,-1794.68"/>
<text text-anchor="middle" x="310029" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="310029" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="310029" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="310029" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert1_gate -->
<g id="node597" class="node">
<title>layer4_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="309911.04,-1816.68 309596,-1816.68 309514.96,-1728.68 309830,-1728.68 309911.04,-1816.68"/>
<text text-anchor="middle" x="309713" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="309713" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="309713" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="309713" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer4_expert1_a2a -->
<g id="node598" class="node">
<title>layer4_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="309356" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="309356" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="309356" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="309356" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="309356" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert1_attn_split -->
<g id="node599" class="node">
<title>layer4_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="309196.48,-1816.68 308871.2,-1816.68 308787.52,-1728.68 309112.8,-1728.68 309196.48,-1816.68"/>
<text text-anchor="middle" x="308992" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="308992" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="308992" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="308992" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert1_q_proj -->
<g id="node600" class="node">
<title>layer4_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="308769.5,-1794.68 308572.5,-1794.68 308572.5,-1750.68 308769.5,-1750.68 308769.5,-1794.68"/>
<text text-anchor="middle" x="308671" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="308671" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="308671" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="308671" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert1_k_proj -->
<g id="node601" class="node">
<title>layer4_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="308554.5,-1794.68 308357.5,-1794.68 308357.5,-1750.68 308554.5,-1750.68 308554.5,-1794.68"/>
<text text-anchor="middle" x="308456" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="308456" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="308456" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="308456" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert1_v_proj -->
<g id="node602" class="node">
<title>layer4_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="308339.5,-1794.68 308142.5,-1794.68 308142.5,-1750.68 308339.5,-1750.68 308339.5,-1794.68"/>
<text text-anchor="middle" x="308241" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="308241" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="308241" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="308241" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert1_attn -->
<g id="node603" class="node">
<title>layer4_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="308124.5,-1794.68 307927.5,-1794.68 307927.5,-1750.68 308124.5,-1750.68 308124.5,-1794.68"/>
<text text-anchor="middle" x="308026" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="308026" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="308026" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="308026" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert1_attn_out -->
<g id="node604" class="node">
<title>layer4_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="307909,-1794.68 307709,-1794.68 307709,-1750.68 307909,-1750.68 307909,-1794.68"/>
<text text-anchor="middle" x="307809" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="307809" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="307809" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="307809" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert1_attn_ar -->
<g id="node605" class="node">
<title>layer4_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="307550" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="307550" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="307550" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="307550" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="307550" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert1_attn_res -->
<g id="node606" class="node">
<title>layer4_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="307390.2,-1816.68 307060.59,-1816.68 306975.8,-1728.68 307305.41,-1728.68 307390.2,-1816.68"/>
<text text-anchor="middle" x="307183" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="307183" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="307183" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="307183" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert1_ln1 -->
<g id="node607" class="node">
<title>layer4_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="306958,-1794.68 306758,-1794.68 306758,-1750.68 306958,-1750.68 306958,-1794.68"/>
<text text-anchor="middle" x="306858" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="306858" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="306858" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="306858" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert1_mlp1 -->
<g id="node608" class="node">
<title>layer4_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="306740,-1794.68 306544,-1794.68 306544,-1750.68 306740,-1750.68 306740,-1794.68"/>
<text text-anchor="middle" x="306642" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="306642" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="306642" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="306642" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert1_gelu -->
<g id="node609" class="node">
<title>layer4_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="306526,-1794.68 306330,-1794.68 306330,-1750.68 306526,-1750.68 306526,-1794.68"/>
<text text-anchor="middle" x="306428" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="306428" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="306428" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="306428" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert1_mlp2 -->
<g id="node610" class="node">
<title>layer4_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="306312,-1794.68 306112,-1794.68 306112,-1750.68 306312,-1750.68 306312,-1794.68"/>
<text text-anchor="middle" x="306212" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="306212" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="306212" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="306212" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert1_mlp_ar -->
<g id="node611" class="node">
<title>layer4_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="305953" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="305953" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="305953" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="305953" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="305953" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert1_mlp_res -->
<g id="node612" class="node">
<title>layer4_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="305793.2,-1816.68 305463.59,-1816.68 305378.8,-1728.68 305708.41,-1728.68 305793.2,-1816.68"/>
<text text-anchor="middle" x="305586" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="305586" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="305586" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="305586" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert1_ln2 -->
<g id="node613" class="node">
<title>layer4_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="305361,-1794.68 305161,-1794.68 305161,-1750.68 305361,-1750.68 305361,-1794.68"/>
<text text-anchor="middle" x="305261" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="305261" y="-1775.28" font-family="Arial" font-size="8.00">L4_E1</text>
<text text-anchor="middle" x="305261" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="305261" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert2_route -->
<g id="node614" class="node">
<title>layer4_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="305137,-1794.68 304937,-1794.68 304937,-1750.68 305137,-1750.68 305137,-1794.68"/>
<text text-anchor="middle" x="305037" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="305037" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="305037" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="305037" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert2_gate -->
<g id="node615" class="node">
<title>layer4_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="304919.04,-1816.68 304604,-1816.68 304522.96,-1728.68 304838,-1728.68 304919.04,-1816.68"/>
<text text-anchor="middle" x="304721" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="304721" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="304721" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="304721" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer4_expert2_a2a -->
<g id="node616" class="node">
<title>layer4_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="304364" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="304364" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="304364" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="304364" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="304364" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert2_attn_split -->
<g id="node617" class="node">
<title>layer4_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="304204.48,-1816.68 303879.2,-1816.68 303795.52,-1728.68 304120.8,-1728.68 304204.48,-1816.68"/>
<text text-anchor="middle" x="304000" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="304000" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="304000" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="304000" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert2_q_proj -->
<g id="node618" class="node">
<title>layer4_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="303777.5,-1794.68 303580.5,-1794.68 303580.5,-1750.68 303777.5,-1750.68 303777.5,-1794.68"/>
<text text-anchor="middle" x="303679" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="303679" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="303679" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="303679" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert2_k_proj -->
<g id="node619" class="node">
<title>layer4_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="303562.5,-1794.68 303365.5,-1794.68 303365.5,-1750.68 303562.5,-1750.68 303562.5,-1794.68"/>
<text text-anchor="middle" x="303464" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="303464" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="303464" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="303464" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert2_v_proj -->
<g id="node620" class="node">
<title>layer4_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="303347.5,-1794.68 303150.5,-1794.68 303150.5,-1750.68 303347.5,-1750.68 303347.5,-1794.68"/>
<text text-anchor="middle" x="303249" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="303249" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="303249" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="303249" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert2_attn -->
<g id="node621" class="node">
<title>layer4_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="303132.5,-1794.68 302935.5,-1794.68 302935.5,-1750.68 303132.5,-1750.68 303132.5,-1794.68"/>
<text text-anchor="middle" x="303034" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="303034" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="303034" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="303034" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert2_attn_out -->
<g id="node622" class="node">
<title>layer4_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="302917,-1794.68 302717,-1794.68 302717,-1750.68 302917,-1750.68 302917,-1794.68"/>
<text text-anchor="middle" x="302817" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="302817" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="302817" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="302817" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert2_attn_ar -->
<g id="node623" class="node">
<title>layer4_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="302558" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="302558" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="302558" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="302558" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="302558" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert2_attn_res -->
<g id="node624" class="node">
<title>layer4_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="302398.2,-1816.68 302068.59,-1816.68 301983.8,-1728.68 302313.41,-1728.68 302398.2,-1816.68"/>
<text text-anchor="middle" x="302191" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="302191" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="302191" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="302191" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert2_ln1 -->
<g id="node625" class="node">
<title>layer4_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="301966,-1794.68 301766,-1794.68 301766,-1750.68 301966,-1750.68 301966,-1794.68"/>
<text text-anchor="middle" x="301866" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="301866" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="301866" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="301866" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert2_mlp1 -->
<g id="node626" class="node">
<title>layer4_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="301748,-1794.68 301552,-1794.68 301552,-1750.68 301748,-1750.68 301748,-1794.68"/>
<text text-anchor="middle" x="301650" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="301650" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="301650" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="301650" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert2_gelu -->
<g id="node627" class="node">
<title>layer4_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="301534,-1794.68 301338,-1794.68 301338,-1750.68 301534,-1750.68 301534,-1794.68"/>
<text text-anchor="middle" x="301436" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="301436" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="301436" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="301436" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert2_mlp2 -->
<g id="node628" class="node">
<title>layer4_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="301320,-1794.68 301120,-1794.68 301120,-1750.68 301320,-1750.68 301320,-1794.68"/>
<text text-anchor="middle" x="301220" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="301220" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="301220" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="301220" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert2_mlp_ar -->
<g id="node629" class="node">
<title>layer4_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="300961" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="300961" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="300961" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="300961" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="300961" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert2_mlp_res -->
<g id="node630" class="node">
<title>layer4_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="300801.2,-1816.68 300471.59,-1816.68 300386.8,-1728.68 300716.41,-1728.68 300801.2,-1816.68"/>
<text text-anchor="middle" x="300594" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="300594" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="300594" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="300594" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert2_ln2 -->
<g id="node631" class="node">
<title>layer4_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="300369,-1794.68 300169,-1794.68 300169,-1750.68 300369,-1750.68 300369,-1794.68"/>
<text text-anchor="middle" x="300269" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="300269" y="-1775.28" font-family="Arial" font-size="8.00">L4_E2</text>
<text text-anchor="middle" x="300269" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="300269" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert3_route -->
<g id="node632" class="node">
<title>layer4_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="300145,-1794.68 299945,-1794.68 299945,-1750.68 300145,-1750.68 300145,-1794.68"/>
<text text-anchor="middle" x="300045" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="300045" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="300045" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="300045" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert3_gate -->
<g id="node633" class="node">
<title>layer4_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="299927.04,-1816.68 299612,-1816.68 299530.96,-1728.68 299846,-1728.68 299927.04,-1816.68"/>
<text text-anchor="middle" x="299729" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="299729" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="299729" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="299729" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer4_expert3_a2a -->
<g id="node634" class="node">
<title>layer4_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="299372" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="299372" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="299372" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="299372" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="299372" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert3_attn_split -->
<g id="node635" class="node">
<title>layer4_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="299212.48,-1816.68 298887.2,-1816.68 298803.52,-1728.68 299128.8,-1728.68 299212.48,-1816.68"/>
<text text-anchor="middle" x="299008" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="299008" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="299008" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="299008" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert3_q_proj -->
<g id="node636" class="node">
<title>layer4_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="298785.5,-1794.68 298588.5,-1794.68 298588.5,-1750.68 298785.5,-1750.68 298785.5,-1794.68"/>
<text text-anchor="middle" x="298687" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="298687" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="298687" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="298687" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert3_k_proj -->
<g id="node637" class="node">
<title>layer4_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="298570.5,-1794.68 298373.5,-1794.68 298373.5,-1750.68 298570.5,-1750.68 298570.5,-1794.68"/>
<text text-anchor="middle" x="298472" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="298472" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="298472" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="298472" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert3_v_proj -->
<g id="node638" class="node">
<title>layer4_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="298355.5,-1794.68 298158.5,-1794.68 298158.5,-1750.68 298355.5,-1750.68 298355.5,-1794.68"/>
<text text-anchor="middle" x="298257" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="298257" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="298257" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="298257" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert3_attn -->
<g id="node639" class="node">
<title>layer4_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="298140.5,-1794.68 297943.5,-1794.68 297943.5,-1750.68 298140.5,-1750.68 298140.5,-1794.68"/>
<text text-anchor="middle" x="298042" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="298042" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="298042" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="298042" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert3_attn_out -->
<g id="node640" class="node">
<title>layer4_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="297925,-1794.68 297725,-1794.68 297725,-1750.68 297925,-1750.68 297925,-1794.68"/>
<text text-anchor="middle" x="297825" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="297825" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="297825" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="297825" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert3_attn_ar -->
<g id="node641" class="node">
<title>layer4_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="297566" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="297566" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="297566" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="297566" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="297566" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert3_attn_res -->
<g id="node642" class="node">
<title>layer4_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="297406.2,-1816.68 297076.59,-1816.68 296991.8,-1728.68 297321.41,-1728.68 297406.2,-1816.68"/>
<text text-anchor="middle" x="297199" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="297199" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="297199" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="297199" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert3_ln1 -->
<g id="node643" class="node">
<title>layer4_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="296974,-1794.68 296774,-1794.68 296774,-1750.68 296974,-1750.68 296974,-1794.68"/>
<text text-anchor="middle" x="296874" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="296874" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="296874" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="296874" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert3_mlp1 -->
<g id="node644" class="node">
<title>layer4_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="296756,-1794.68 296560,-1794.68 296560,-1750.68 296756,-1750.68 296756,-1794.68"/>
<text text-anchor="middle" x="296658" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="296658" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="296658" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="296658" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert3_gelu -->
<g id="node645" class="node">
<title>layer4_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="296542,-1794.68 296346,-1794.68 296346,-1750.68 296542,-1750.68 296542,-1794.68"/>
<text text-anchor="middle" x="296444" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="296444" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="296444" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="296444" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert3_mlp2 -->
<g id="node646" class="node">
<title>layer4_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="296328,-1794.68 296128,-1794.68 296128,-1750.68 296328,-1750.68 296328,-1794.68"/>
<text text-anchor="middle" x="296228" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="296228" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="296228" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="296228" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert3_mlp_ar -->
<g id="node647" class="node">
<title>layer4_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="295969" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="295969" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="295969" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="295969" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="295969" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert3_mlp_res -->
<g id="node648" class="node">
<title>layer4_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="295809.2,-1816.68 295479.59,-1816.68 295394.8,-1728.68 295724.41,-1728.68 295809.2,-1816.68"/>
<text text-anchor="middle" x="295602" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="295602" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="295602" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="295602" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert3_ln2 -->
<g id="node649" class="node">
<title>layer4_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="295377,-1794.68 295177,-1794.68 295177,-1750.68 295377,-1750.68 295377,-1794.68"/>
<text text-anchor="middle" x="295277" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="295277" y="-1775.28" font-family="Arial" font-size="8.00">L4_E3</text>
<text text-anchor="middle" x="295277" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="295277" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert4_route -->
<g id="node650" class="node">
<title>layer4_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="295153,-1794.68 294953,-1794.68 294953,-1750.68 295153,-1750.68 295153,-1794.68"/>
<text text-anchor="middle" x="295053" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="295053" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="295053" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="295053" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert4_gate -->
<g id="node651" class="node">
<title>layer4_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="294935.04,-1816.68 294620,-1816.68 294538.96,-1728.68 294854,-1728.68 294935.04,-1816.68"/>
<text text-anchor="middle" x="294737" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="294737" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="294737" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="294737" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer4_expert4_a2a -->
<g id="node652" class="node">
<title>layer4_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="294380" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="294380" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="294380" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="294380" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="294380" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert4_attn_split -->
<g id="node653" class="node">
<title>layer4_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="294220.48,-1816.68 293895.2,-1816.68 293811.52,-1728.68 294136.8,-1728.68 294220.48,-1816.68"/>
<text text-anchor="middle" x="294016" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="294016" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="294016" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="294016" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert4_q_proj -->
<g id="node654" class="node">
<title>layer4_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="293793.5,-1794.68 293596.5,-1794.68 293596.5,-1750.68 293793.5,-1750.68 293793.5,-1794.68"/>
<text text-anchor="middle" x="293695" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="293695" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="293695" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="293695" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert4_k_proj -->
<g id="node655" class="node">
<title>layer4_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="293578.5,-1794.68 293381.5,-1794.68 293381.5,-1750.68 293578.5,-1750.68 293578.5,-1794.68"/>
<text text-anchor="middle" x="293480" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="293480" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="293480" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="293480" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert4_v_proj -->
<g id="node656" class="node">
<title>layer4_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="293363.5,-1794.68 293166.5,-1794.68 293166.5,-1750.68 293363.5,-1750.68 293363.5,-1794.68"/>
<text text-anchor="middle" x="293265" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="293265" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="293265" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="293265" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert4_attn -->
<g id="node657" class="node">
<title>layer4_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="293148.5,-1794.68 292951.5,-1794.68 292951.5,-1750.68 293148.5,-1750.68 293148.5,-1794.68"/>
<text text-anchor="middle" x="293050" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="293050" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="293050" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="293050" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert4_attn_out -->
<g id="node658" class="node">
<title>layer4_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="292933,-1794.68 292733,-1794.68 292733,-1750.68 292933,-1750.68 292933,-1794.68"/>
<text text-anchor="middle" x="292833" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="292833" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="292833" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="292833" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert4_attn_ar -->
<g id="node659" class="node">
<title>layer4_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="292574" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="292574" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="292574" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="292574" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="292574" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert4_attn_res -->
<g id="node660" class="node">
<title>layer4_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="292414.2,-1816.68 292084.59,-1816.68 291999.8,-1728.68 292329.41,-1728.68 292414.2,-1816.68"/>
<text text-anchor="middle" x="292207" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="292207" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="292207" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="292207" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert4_ln1 -->
<g id="node661" class="node">
<title>layer4_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="291982,-1794.68 291782,-1794.68 291782,-1750.68 291982,-1750.68 291982,-1794.68"/>
<text text-anchor="middle" x="291882" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="291882" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="291882" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="291882" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert4_mlp1 -->
<g id="node662" class="node">
<title>layer4_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="291764,-1794.68 291568,-1794.68 291568,-1750.68 291764,-1750.68 291764,-1794.68"/>
<text text-anchor="middle" x="291666" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="291666" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="291666" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="291666" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert4_gelu -->
<g id="node663" class="node">
<title>layer4_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="291550,-1794.68 291354,-1794.68 291354,-1750.68 291550,-1750.68 291550,-1794.68"/>
<text text-anchor="middle" x="291452" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="291452" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="291452" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="291452" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert4_mlp2 -->
<g id="node664" class="node">
<title>layer4_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="291336,-1794.68 291136,-1794.68 291136,-1750.68 291336,-1750.68 291336,-1794.68"/>
<text text-anchor="middle" x="291236" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="291236" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="291236" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="291236" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert4_mlp_ar -->
<g id="node665" class="node">
<title>layer4_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="290977" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="290977" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="290977" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="290977" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="290977" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert4_mlp_res -->
<g id="node666" class="node">
<title>layer4_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="290817.2,-1816.68 290487.59,-1816.68 290402.8,-1728.68 290732.41,-1728.68 290817.2,-1816.68"/>
<text text-anchor="middle" x="290610" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="290610" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="290610" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="290610" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert4_ln2 -->
<g id="node667" class="node">
<title>layer4_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="290385,-1794.68 290185,-1794.68 290185,-1750.68 290385,-1750.68 290385,-1794.68"/>
<text text-anchor="middle" x="290285" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="290285" y="-1775.28" font-family="Arial" font-size="8.00">L4_E4</text>
<text text-anchor="middle" x="290285" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="290285" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert5_route -->
<g id="node668" class="node">
<title>layer4_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="290161,-1794.68 289961,-1794.68 289961,-1750.68 290161,-1750.68 290161,-1794.68"/>
<text text-anchor="middle" x="290061" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="290061" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="290061" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="290061" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert5_gate -->
<g id="node669" class="node">
<title>layer4_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="289943.04,-1816.68 289628,-1816.68 289546.96,-1728.68 289862,-1728.68 289943.04,-1816.68"/>
<text text-anchor="middle" x="289745" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="289745" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="289745" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="289745" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer4_expert5_a2a -->
<g id="node670" class="node">
<title>layer4_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="289388" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="289388" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="289388" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="289388" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="289388" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert5_attn_split -->
<g id="node671" class="node">
<title>layer4_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="289228.48,-1816.68 288903.2,-1816.68 288819.52,-1728.68 289144.8,-1728.68 289228.48,-1816.68"/>
<text text-anchor="middle" x="289024" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="289024" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="289024" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="289024" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert5_q_proj -->
<g id="node672" class="node">
<title>layer4_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="288801.5,-1794.68 288604.5,-1794.68 288604.5,-1750.68 288801.5,-1750.68 288801.5,-1794.68"/>
<text text-anchor="middle" x="288703" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="288703" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="288703" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="288703" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert5_k_proj -->
<g id="node673" class="node">
<title>layer4_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="288586.5,-1794.68 288389.5,-1794.68 288389.5,-1750.68 288586.5,-1750.68 288586.5,-1794.68"/>
<text text-anchor="middle" x="288488" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="288488" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="288488" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="288488" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert5_v_proj -->
<g id="node674" class="node">
<title>layer4_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="288371.5,-1794.68 288174.5,-1794.68 288174.5,-1750.68 288371.5,-1750.68 288371.5,-1794.68"/>
<text text-anchor="middle" x="288273" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="288273" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="288273" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="288273" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert5_attn -->
<g id="node675" class="node">
<title>layer4_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="288156.5,-1794.68 287959.5,-1794.68 287959.5,-1750.68 288156.5,-1750.68 288156.5,-1794.68"/>
<text text-anchor="middle" x="288058" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="288058" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="288058" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="288058" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert5_attn_out -->
<g id="node676" class="node">
<title>layer4_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="287941,-1794.68 287741,-1794.68 287741,-1750.68 287941,-1750.68 287941,-1794.68"/>
<text text-anchor="middle" x="287841" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="287841" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="287841" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="287841" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert5_attn_ar -->
<g id="node677" class="node">
<title>layer4_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="287582" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="287582" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="287582" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="287582" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="287582" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert5_attn_res -->
<g id="node678" class="node">
<title>layer4_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="287422.2,-1816.68 287092.59,-1816.68 287007.8,-1728.68 287337.41,-1728.68 287422.2,-1816.68"/>
<text text-anchor="middle" x="287215" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="287215" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="287215" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="287215" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert5_ln1 -->
<g id="node679" class="node">
<title>layer4_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="286990,-1794.68 286790,-1794.68 286790,-1750.68 286990,-1750.68 286990,-1794.68"/>
<text text-anchor="middle" x="286890" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="286890" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="286890" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="286890" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert5_mlp1 -->
<g id="node680" class="node">
<title>layer4_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="286772,-1794.68 286576,-1794.68 286576,-1750.68 286772,-1750.68 286772,-1794.68"/>
<text text-anchor="middle" x="286674" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="286674" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="286674" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="286674" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert5_gelu -->
<g id="node681" class="node">
<title>layer4_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="286558,-1794.68 286362,-1794.68 286362,-1750.68 286558,-1750.68 286558,-1794.68"/>
<text text-anchor="middle" x="286460" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="286460" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="286460" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="286460" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert5_mlp2 -->
<g id="node682" class="node">
<title>layer4_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="286344,-1794.68 286144,-1794.68 286144,-1750.68 286344,-1750.68 286344,-1794.68"/>
<text text-anchor="middle" x="286244" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="286244" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="286244" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="286244" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert5_mlp_ar -->
<g id="node683" class="node">
<title>layer4_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="285985" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="285985" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="285985" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="285985" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="285985" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert5_mlp_res -->
<g id="node684" class="node">
<title>layer4_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="285825.2,-1816.68 285495.59,-1816.68 285410.8,-1728.68 285740.41,-1728.68 285825.2,-1816.68"/>
<text text-anchor="middle" x="285618" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="285618" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="285618" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="285618" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert5_ln2 -->
<g id="node685" class="node">
<title>layer4_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="285393,-1794.68 285193,-1794.68 285193,-1750.68 285393,-1750.68 285393,-1794.68"/>
<text text-anchor="middle" x="285293" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="285293" y="-1775.28" font-family="Arial" font-size="8.00">L4_E5</text>
<text text-anchor="middle" x="285293" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="285293" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert6_route -->
<g id="node686" class="node">
<title>layer4_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="285169,-1794.68 284969,-1794.68 284969,-1750.68 285169,-1750.68 285169,-1794.68"/>
<text text-anchor="middle" x="285069" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="285069" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="285069" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="285069" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert6_gate -->
<g id="node687" class="node">
<title>layer4_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="284951.04,-1816.68 284636,-1816.68 284554.96,-1728.68 284870,-1728.68 284951.04,-1816.68"/>
<text text-anchor="middle" x="284753" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="284753" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="284753" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="284753" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer4_expert6_a2a -->
<g id="node688" class="node">
<title>layer4_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="284396" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="284396" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="284396" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="284396" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="284396" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert6_attn_split -->
<g id="node689" class="node">
<title>layer4_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="284236.48,-1816.68 283911.2,-1816.68 283827.52,-1728.68 284152.8,-1728.68 284236.48,-1816.68"/>
<text text-anchor="middle" x="284032" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="284032" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="284032" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="284032" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert6_q_proj -->
<g id="node690" class="node">
<title>layer4_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="283809.5,-1794.68 283612.5,-1794.68 283612.5,-1750.68 283809.5,-1750.68 283809.5,-1794.68"/>
<text text-anchor="middle" x="283711" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="283711" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="283711" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="283711" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert6_k_proj -->
<g id="node691" class="node">
<title>layer4_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="283594.5,-1794.68 283397.5,-1794.68 283397.5,-1750.68 283594.5,-1750.68 283594.5,-1794.68"/>
<text text-anchor="middle" x="283496" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="283496" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="283496" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="283496" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert6_v_proj -->
<g id="node692" class="node">
<title>layer4_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="283379.5,-1794.68 283182.5,-1794.68 283182.5,-1750.68 283379.5,-1750.68 283379.5,-1794.68"/>
<text text-anchor="middle" x="283281" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="283281" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="283281" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="283281" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert6_attn -->
<g id="node693" class="node">
<title>layer4_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="283164.5,-1794.68 282967.5,-1794.68 282967.5,-1750.68 283164.5,-1750.68 283164.5,-1794.68"/>
<text text-anchor="middle" x="283066" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="283066" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="283066" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="283066" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert6_attn_out -->
<g id="node694" class="node">
<title>layer4_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="282949,-1794.68 282749,-1794.68 282749,-1750.68 282949,-1750.68 282949,-1794.68"/>
<text text-anchor="middle" x="282849" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="282849" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="282849" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="282849" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert6_attn_ar -->
<g id="node695" class="node">
<title>layer4_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="282590" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="282590" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="282590" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="282590" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="282590" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert6_attn_res -->
<g id="node696" class="node">
<title>layer4_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="282430.2,-1816.68 282100.59,-1816.68 282015.8,-1728.68 282345.41,-1728.68 282430.2,-1816.68"/>
<text text-anchor="middle" x="282223" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="282223" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="282223" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="282223" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert6_ln1 -->
<g id="node697" class="node">
<title>layer4_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="281998,-1794.68 281798,-1794.68 281798,-1750.68 281998,-1750.68 281998,-1794.68"/>
<text text-anchor="middle" x="281898" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="281898" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="281898" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="281898" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert6_mlp1 -->
<g id="node698" class="node">
<title>layer4_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="281780,-1794.68 281584,-1794.68 281584,-1750.68 281780,-1750.68 281780,-1794.68"/>
<text text-anchor="middle" x="281682" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="281682" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="281682" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="281682" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert6_gelu -->
<g id="node699" class="node">
<title>layer4_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="281566,-1794.68 281370,-1794.68 281370,-1750.68 281566,-1750.68 281566,-1794.68"/>
<text text-anchor="middle" x="281468" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="281468" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="281468" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="281468" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert6_mlp2 -->
<g id="node700" class="node">
<title>layer4_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="281352,-1794.68 281152,-1794.68 281152,-1750.68 281352,-1750.68 281352,-1794.68"/>
<text text-anchor="middle" x="281252" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="281252" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="281252" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="281252" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert6_mlp_ar -->
<g id="node701" class="node">
<title>layer4_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="280993" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="280993" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="280993" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="280993" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="280993" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert6_mlp_res -->
<g id="node702" class="node">
<title>layer4_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="280833.2,-1816.68 280503.59,-1816.68 280418.8,-1728.68 280748.41,-1728.68 280833.2,-1816.68"/>
<text text-anchor="middle" x="280626" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="280626" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="280626" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="280626" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert6_ln2 -->
<g id="node703" class="node">
<title>layer4_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="280401,-1794.68 280201,-1794.68 280201,-1750.68 280401,-1750.68 280401,-1794.68"/>
<text text-anchor="middle" x="280301" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="280301" y="-1775.28" font-family="Arial" font-size="8.00">L4_E6</text>
<text text-anchor="middle" x="280301" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="280301" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert7_route -->
<g id="node704" class="node">
<title>layer4_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="280177,-1794.68 279977,-1794.68 279977,-1750.68 280177,-1750.68 280177,-1794.68"/>
<text text-anchor="middle" x="280077" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="280077" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="280077" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="280077" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert7_gate -->
<g id="node705" class="node">
<title>layer4_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="279959.04,-1816.68 279644,-1816.68 279562.96,-1728.68 279878,-1728.68 279959.04,-1816.68"/>
<text text-anchor="middle" x="279761" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="279761" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="279761" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="279761" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer4_expert7_a2a -->
<g id="node706" class="node">
<title>layer4_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="279404" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="279404" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="279404" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="279404" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="279404" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert7_attn_split -->
<g id="node707" class="node">
<title>layer4_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="279244.48,-1816.68 278919.2,-1816.68 278835.52,-1728.68 279160.8,-1728.68 279244.48,-1816.68"/>
<text text-anchor="middle" x="279040" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="279040" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="279040" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="279040" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert7_q_proj -->
<g id="node708" class="node">
<title>layer4_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="278817.5,-1794.68 278620.5,-1794.68 278620.5,-1750.68 278817.5,-1750.68 278817.5,-1794.68"/>
<text text-anchor="middle" x="278719" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="278719" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="278719" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="278719" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert7_k_proj -->
<g id="node709" class="node">
<title>layer4_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="278602.5,-1794.68 278405.5,-1794.68 278405.5,-1750.68 278602.5,-1750.68 278602.5,-1794.68"/>
<text text-anchor="middle" x="278504" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="278504" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="278504" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="278504" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert7_v_proj -->
<g id="node710" class="node">
<title>layer4_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="278387.5,-1794.68 278190.5,-1794.68 278190.5,-1750.68 278387.5,-1750.68 278387.5,-1794.68"/>
<text text-anchor="middle" x="278289" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="278289" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="278289" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="278289" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert7_attn -->
<g id="node711" class="node">
<title>layer4_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="278172.5,-1794.68 277975.5,-1794.68 277975.5,-1750.68 278172.5,-1750.68 278172.5,-1794.68"/>
<text text-anchor="middle" x="278074" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="278074" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="278074" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="278074" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer4_expert7_attn_out -->
<g id="node712" class="node">
<title>layer4_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="277957,-1794.68 277757,-1794.68 277757,-1750.68 277957,-1750.68 277957,-1794.68"/>
<text text-anchor="middle" x="277857" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="277857" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="277857" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="277857" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert7_attn_ar -->
<g id="node713" class="node">
<title>layer4_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="277598" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="277598" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="277598" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="277598" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="277598" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert7_attn_res -->
<g id="node714" class="node">
<title>layer4_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="277438.2,-1816.68 277108.59,-1816.68 277023.8,-1728.68 277353.41,-1728.68 277438.2,-1816.68"/>
<text text-anchor="middle" x="277231" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="277231" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="277231" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="277231" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert7_ln1 -->
<g id="node715" class="node">
<title>layer4_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="277006,-1794.68 276806,-1794.68 276806,-1750.68 277006,-1750.68 277006,-1794.68"/>
<text text-anchor="middle" x="276906" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="276906" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="276906" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="276906" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert7_mlp1 -->
<g id="node716" class="node">
<title>layer4_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="276788,-1794.68 276592,-1794.68 276592,-1750.68 276788,-1750.68 276788,-1794.68"/>
<text text-anchor="middle" x="276690" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="276690" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="276690" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="276690" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert7_gelu -->
<g id="node717" class="node">
<title>layer4_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="276574,-1794.68 276378,-1794.68 276378,-1750.68 276574,-1750.68 276574,-1794.68"/>
<text text-anchor="middle" x="276476" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="276476" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="276476" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="276476" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer4_expert7_mlp2 -->
<g id="node718" class="node">
<title>layer4_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="276360,-1794.68 276160,-1794.68 276160,-1750.68 276360,-1750.68 276360,-1794.68"/>
<text text-anchor="middle" x="276260" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="276260" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="276260" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="276260" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert7_mlp_ar -->
<g id="node719" class="node">
<title>layer4_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="276001" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="276001" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="276001" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="276001" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="276001" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert7_mlp_res -->
<g id="node720" class="node">
<title>layer4_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="275841.2,-1816.68 275511.59,-1816.68 275426.8,-1728.68 275756.41,-1728.68 275841.2,-1816.68"/>
<text text-anchor="middle" x="275634" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="275634" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="275634" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="275634" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer4_expert7_ln2 -->
<g id="node721" class="node">
<title>layer4_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="275409,-1794.68 275209,-1794.68 275209,-1750.68 275409,-1750.68 275409,-1794.68"/>
<text text-anchor="middle" x="275309" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="275309" y="-1775.28" font-family="Arial" font-size="8.00">L4_E7</text>
<text text-anchor="middle" x="275309" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="275309" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert0_route -->
<g id="node722" class="node">
<title>layer5_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="275169,-1794.68 274969,-1794.68 274969,-1750.68 275169,-1750.68 275169,-1794.68"/>
<text text-anchor="middle" x="275069" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="275069" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="275069" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="275069" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert0_gate -->
<g id="node723" class="node">
<title>layer5_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="274951.04,-1816.68 274636,-1816.68 274554.96,-1728.68 274870,-1728.68 274951.04,-1816.68"/>
<text text-anchor="middle" x="274753" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="274753" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="274753" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="274753" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer5_expert0_a2a -->
<g id="node724" class="node">
<title>layer5_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="274396" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="274396" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="274396" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="274396" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="274396" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert0_attn_split -->
<g id="node725" class="node">
<title>layer5_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="274236.48,-1816.68 273911.2,-1816.68 273827.52,-1728.68 274152.8,-1728.68 274236.48,-1816.68"/>
<text text-anchor="middle" x="274032" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="274032" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="274032" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="274032" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert0_q_proj -->
<g id="node726" class="node">
<title>layer5_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="273809.5,-1794.68 273612.5,-1794.68 273612.5,-1750.68 273809.5,-1750.68 273809.5,-1794.68"/>
<text text-anchor="middle" x="273711" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="273711" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="273711" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="273711" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert0_k_proj -->
<g id="node727" class="node">
<title>layer5_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="273594.5,-1794.68 273397.5,-1794.68 273397.5,-1750.68 273594.5,-1750.68 273594.5,-1794.68"/>
<text text-anchor="middle" x="273496" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="273496" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="273496" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="273496" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert0_v_proj -->
<g id="node728" class="node">
<title>layer5_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="273379.5,-1794.68 273182.5,-1794.68 273182.5,-1750.68 273379.5,-1750.68 273379.5,-1794.68"/>
<text text-anchor="middle" x="273281" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="273281" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="273281" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="273281" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert0_attn -->
<g id="node729" class="node">
<title>layer5_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="273164.5,-1794.68 272967.5,-1794.68 272967.5,-1750.68 273164.5,-1750.68 273164.5,-1794.68"/>
<text text-anchor="middle" x="273066" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="273066" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="273066" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="273066" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert0_attn_out -->
<g id="node730" class="node">
<title>layer5_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="272949,-1794.68 272749,-1794.68 272749,-1750.68 272949,-1750.68 272949,-1794.68"/>
<text text-anchor="middle" x="272849" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="272849" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="272849" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="272849" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert0_attn_ar -->
<g id="node731" class="node">
<title>layer5_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="272590" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="272590" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="272590" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="272590" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="272590" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert0_attn_res -->
<g id="node732" class="node">
<title>layer5_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="272430.2,-1816.68 272100.59,-1816.68 272015.8,-1728.68 272345.41,-1728.68 272430.2,-1816.68"/>
<text text-anchor="middle" x="272223" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="272223" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="272223" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="272223" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert0_ln1 -->
<g id="node733" class="node">
<title>layer5_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="271998,-1794.68 271798,-1794.68 271798,-1750.68 271998,-1750.68 271998,-1794.68"/>
<text text-anchor="middle" x="271898" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="271898" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="271898" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="271898" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert0_mlp1 -->
<g id="node734" class="node">
<title>layer5_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="271780,-1794.68 271584,-1794.68 271584,-1750.68 271780,-1750.68 271780,-1794.68"/>
<text text-anchor="middle" x="271682" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="271682" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="271682" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="271682" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert0_gelu -->
<g id="node735" class="node">
<title>layer5_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="271566,-1794.68 271370,-1794.68 271370,-1750.68 271566,-1750.68 271566,-1794.68"/>
<text text-anchor="middle" x="271468" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="271468" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="271468" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="271468" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert0_mlp2 -->
<g id="node736" class="node">
<title>layer5_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="271352,-1794.68 271152,-1794.68 271152,-1750.68 271352,-1750.68 271352,-1794.68"/>
<text text-anchor="middle" x="271252" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="271252" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="271252" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="271252" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert0_mlp_ar -->
<g id="node737" class="node">
<title>layer5_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="270993" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="270993" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="270993" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="270993" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="270993" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert0_mlp_res -->
<g id="node738" class="node">
<title>layer5_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="270833.2,-1816.68 270503.59,-1816.68 270418.8,-1728.68 270748.41,-1728.68 270833.2,-1816.68"/>
<text text-anchor="middle" x="270626" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="270626" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="270626" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="270626" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert0_ln2 -->
<g id="node739" class="node">
<title>layer5_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="270401,-1794.68 270201,-1794.68 270201,-1750.68 270401,-1750.68 270401,-1794.68"/>
<text text-anchor="middle" x="270301" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="270301" y="-1775.28" font-family="Arial" font-size="8.00">L5_E0</text>
<text text-anchor="middle" x="270301" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="270301" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert1_route -->
<g id="node740" class="node">
<title>layer5_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="270177,-1794.68 269977,-1794.68 269977,-1750.68 270177,-1750.68 270177,-1794.68"/>
<text text-anchor="middle" x="270077" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="270077" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="270077" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="270077" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert1_gate -->
<g id="node741" class="node">
<title>layer5_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="269959.04,-1816.68 269644,-1816.68 269562.96,-1728.68 269878,-1728.68 269959.04,-1816.68"/>
<text text-anchor="middle" x="269761" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="269761" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="269761" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="269761" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer5_expert1_a2a -->
<g id="node742" class="node">
<title>layer5_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="269404" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="269404" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="269404" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="269404" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="269404" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert1_attn_split -->
<g id="node743" class="node">
<title>layer5_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="269244.48,-1816.68 268919.2,-1816.68 268835.52,-1728.68 269160.8,-1728.68 269244.48,-1816.68"/>
<text text-anchor="middle" x="269040" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="269040" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="269040" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="269040" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert1_q_proj -->
<g id="node744" class="node">
<title>layer5_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="268817.5,-1794.68 268620.5,-1794.68 268620.5,-1750.68 268817.5,-1750.68 268817.5,-1794.68"/>
<text text-anchor="middle" x="268719" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="268719" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="268719" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="268719" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert1_k_proj -->
<g id="node745" class="node">
<title>layer5_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="268602.5,-1794.68 268405.5,-1794.68 268405.5,-1750.68 268602.5,-1750.68 268602.5,-1794.68"/>
<text text-anchor="middle" x="268504" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="268504" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="268504" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="268504" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert1_v_proj -->
<g id="node746" class="node">
<title>layer5_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="268387.5,-1794.68 268190.5,-1794.68 268190.5,-1750.68 268387.5,-1750.68 268387.5,-1794.68"/>
<text text-anchor="middle" x="268289" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="268289" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="268289" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="268289" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert1_attn -->
<g id="node747" class="node">
<title>layer5_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="268172.5,-1794.68 267975.5,-1794.68 267975.5,-1750.68 268172.5,-1750.68 268172.5,-1794.68"/>
<text text-anchor="middle" x="268074" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="268074" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="268074" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="268074" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert1_attn_out -->
<g id="node748" class="node">
<title>layer5_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="267957,-1794.68 267757,-1794.68 267757,-1750.68 267957,-1750.68 267957,-1794.68"/>
<text text-anchor="middle" x="267857" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="267857" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="267857" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="267857" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert1_attn_ar -->
<g id="node749" class="node">
<title>layer5_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="267598" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="267598" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="267598" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="267598" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="267598" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert1_attn_res -->
<g id="node750" class="node">
<title>layer5_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="267438.2,-1816.68 267108.59,-1816.68 267023.8,-1728.68 267353.41,-1728.68 267438.2,-1816.68"/>
<text text-anchor="middle" x="267231" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="267231" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="267231" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="267231" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert1_ln1 -->
<g id="node751" class="node">
<title>layer5_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="267006,-1794.68 266806,-1794.68 266806,-1750.68 267006,-1750.68 267006,-1794.68"/>
<text text-anchor="middle" x="266906" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="266906" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="266906" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="266906" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert1_mlp1 -->
<g id="node752" class="node">
<title>layer5_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="266788,-1794.68 266592,-1794.68 266592,-1750.68 266788,-1750.68 266788,-1794.68"/>
<text text-anchor="middle" x="266690" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="266690" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="266690" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="266690" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert1_gelu -->
<g id="node753" class="node">
<title>layer5_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="266574,-1794.68 266378,-1794.68 266378,-1750.68 266574,-1750.68 266574,-1794.68"/>
<text text-anchor="middle" x="266476" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="266476" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="266476" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="266476" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert1_mlp2 -->
<g id="node754" class="node">
<title>layer5_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="266360,-1794.68 266160,-1794.68 266160,-1750.68 266360,-1750.68 266360,-1794.68"/>
<text text-anchor="middle" x="266260" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="266260" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="266260" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="266260" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert1_mlp_ar -->
<g id="node755" class="node">
<title>layer5_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="266001" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="266001" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="266001" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="266001" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="266001" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert1_mlp_res -->
<g id="node756" class="node">
<title>layer5_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="265841.2,-1816.68 265511.59,-1816.68 265426.8,-1728.68 265756.41,-1728.68 265841.2,-1816.68"/>
<text text-anchor="middle" x="265634" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="265634" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="265634" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="265634" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert1_ln2 -->
<g id="node757" class="node">
<title>layer5_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="265409,-1794.68 265209,-1794.68 265209,-1750.68 265409,-1750.68 265409,-1794.68"/>
<text text-anchor="middle" x="265309" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="265309" y="-1775.28" font-family="Arial" font-size="8.00">L5_E1</text>
<text text-anchor="middle" x="265309" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="265309" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert2_route -->
<g id="node758" class="node">
<title>layer5_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="265185,-1794.68 264985,-1794.68 264985,-1750.68 265185,-1750.68 265185,-1794.68"/>
<text text-anchor="middle" x="265085" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="265085" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="265085" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="265085" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert2_gate -->
<g id="node759" class="node">
<title>layer5_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="264967.04,-1816.68 264652,-1816.68 264570.96,-1728.68 264886,-1728.68 264967.04,-1816.68"/>
<text text-anchor="middle" x="264769" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="264769" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="264769" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="264769" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer5_expert2_a2a -->
<g id="node760" class="node">
<title>layer5_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="264412" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="264412" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="264412" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="264412" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="264412" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert2_attn_split -->
<g id="node761" class="node">
<title>layer5_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="264252.48,-1816.68 263927.2,-1816.68 263843.52,-1728.68 264168.8,-1728.68 264252.48,-1816.68"/>
<text text-anchor="middle" x="264048" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="264048" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="264048" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="264048" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert2_q_proj -->
<g id="node762" class="node">
<title>layer5_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="263825.5,-1794.68 263628.5,-1794.68 263628.5,-1750.68 263825.5,-1750.68 263825.5,-1794.68"/>
<text text-anchor="middle" x="263727" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="263727" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="263727" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="263727" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert2_k_proj -->
<g id="node763" class="node">
<title>layer5_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="263610.5,-1794.68 263413.5,-1794.68 263413.5,-1750.68 263610.5,-1750.68 263610.5,-1794.68"/>
<text text-anchor="middle" x="263512" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="263512" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="263512" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="263512" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert2_v_proj -->
<g id="node764" class="node">
<title>layer5_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="263395.5,-1794.68 263198.5,-1794.68 263198.5,-1750.68 263395.5,-1750.68 263395.5,-1794.68"/>
<text text-anchor="middle" x="263297" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="263297" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="263297" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="263297" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert2_attn -->
<g id="node765" class="node">
<title>layer5_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="263180.5,-1794.68 262983.5,-1794.68 262983.5,-1750.68 263180.5,-1750.68 263180.5,-1794.68"/>
<text text-anchor="middle" x="263082" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="263082" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="263082" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="263082" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert2_attn_out -->
<g id="node766" class="node">
<title>layer5_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="262965,-1794.68 262765,-1794.68 262765,-1750.68 262965,-1750.68 262965,-1794.68"/>
<text text-anchor="middle" x="262865" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="262865" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="262865" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="262865" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert2_attn_ar -->
<g id="node767" class="node">
<title>layer5_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="262606" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="262606" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="262606" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="262606" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="262606" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert2_attn_res -->
<g id="node768" class="node">
<title>layer5_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="262446.2,-1816.68 262116.59,-1816.68 262031.8,-1728.68 262361.41,-1728.68 262446.2,-1816.68"/>
<text text-anchor="middle" x="262239" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="262239" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="262239" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="262239" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert2_ln1 -->
<g id="node769" class="node">
<title>layer5_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="262014,-1794.68 261814,-1794.68 261814,-1750.68 262014,-1750.68 262014,-1794.68"/>
<text text-anchor="middle" x="261914" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="261914" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="261914" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="261914" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert2_mlp1 -->
<g id="node770" class="node">
<title>layer5_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="261796,-1794.68 261600,-1794.68 261600,-1750.68 261796,-1750.68 261796,-1794.68"/>
<text text-anchor="middle" x="261698" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="261698" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="261698" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="261698" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert2_gelu -->
<g id="node771" class="node">
<title>layer5_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="261582,-1794.68 261386,-1794.68 261386,-1750.68 261582,-1750.68 261582,-1794.68"/>
<text text-anchor="middle" x="261484" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="261484" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="261484" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="261484" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert2_mlp2 -->
<g id="node772" class="node">
<title>layer5_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="261368,-1794.68 261168,-1794.68 261168,-1750.68 261368,-1750.68 261368,-1794.68"/>
<text text-anchor="middle" x="261268" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="261268" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="261268" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="261268" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert2_mlp_ar -->
<g id="node773" class="node">
<title>layer5_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="261009" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="261009" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="261009" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="261009" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="261009" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert2_mlp_res -->
<g id="node774" class="node">
<title>layer5_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="260849.2,-1816.68 260519.59,-1816.68 260434.8,-1728.68 260764.41,-1728.68 260849.2,-1816.68"/>
<text text-anchor="middle" x="260642" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="260642" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="260642" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="260642" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert2_ln2 -->
<g id="node775" class="node">
<title>layer5_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="260417,-1794.68 260217,-1794.68 260217,-1750.68 260417,-1750.68 260417,-1794.68"/>
<text text-anchor="middle" x="260317" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="260317" y="-1775.28" font-family="Arial" font-size="8.00">L5_E2</text>
<text text-anchor="middle" x="260317" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="260317" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert3_route -->
<g id="node776" class="node">
<title>layer5_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="260193,-1794.68 259993,-1794.68 259993,-1750.68 260193,-1750.68 260193,-1794.68"/>
<text text-anchor="middle" x="260093" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="260093" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="260093" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="260093" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert3_gate -->
<g id="node777" class="node">
<title>layer5_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="259975.04,-1816.68 259660,-1816.68 259578.96,-1728.68 259894,-1728.68 259975.04,-1816.68"/>
<text text-anchor="middle" x="259777" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="259777" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="259777" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="259777" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer5_expert3_a2a -->
<g id="node778" class="node">
<title>layer5_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="259420" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="259420" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="259420" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="259420" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="259420" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert3_attn_split -->
<g id="node779" class="node">
<title>layer5_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="259260.48,-1816.68 258935.2,-1816.68 258851.52,-1728.68 259176.8,-1728.68 259260.48,-1816.68"/>
<text text-anchor="middle" x="259056" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="259056" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="259056" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="259056" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert3_q_proj -->
<g id="node780" class="node">
<title>layer5_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="258833.5,-1794.68 258636.5,-1794.68 258636.5,-1750.68 258833.5,-1750.68 258833.5,-1794.68"/>
<text text-anchor="middle" x="258735" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="258735" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="258735" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="258735" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert3_k_proj -->
<g id="node781" class="node">
<title>layer5_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="258618.5,-1794.68 258421.5,-1794.68 258421.5,-1750.68 258618.5,-1750.68 258618.5,-1794.68"/>
<text text-anchor="middle" x="258520" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="258520" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="258520" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="258520" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert3_v_proj -->
<g id="node782" class="node">
<title>layer5_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="258403.5,-1794.68 258206.5,-1794.68 258206.5,-1750.68 258403.5,-1750.68 258403.5,-1794.68"/>
<text text-anchor="middle" x="258305" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="258305" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="258305" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="258305" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert3_attn -->
<g id="node783" class="node">
<title>layer5_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="258188.5,-1794.68 257991.5,-1794.68 257991.5,-1750.68 258188.5,-1750.68 258188.5,-1794.68"/>
<text text-anchor="middle" x="258090" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="258090" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="258090" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="258090" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert3_attn_out -->
<g id="node784" class="node">
<title>layer5_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="257973,-1794.68 257773,-1794.68 257773,-1750.68 257973,-1750.68 257973,-1794.68"/>
<text text-anchor="middle" x="257873" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="257873" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="257873" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="257873" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert3_attn_ar -->
<g id="node785" class="node">
<title>layer5_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="257614" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="257614" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="257614" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="257614" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="257614" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert3_attn_res -->
<g id="node786" class="node">
<title>layer5_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="257454.2,-1816.68 257124.59,-1816.68 257039.8,-1728.68 257369.41,-1728.68 257454.2,-1816.68"/>
<text text-anchor="middle" x="257247" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="257247" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="257247" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="257247" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert3_ln1 -->
<g id="node787" class="node">
<title>layer5_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="257022,-1794.68 256822,-1794.68 256822,-1750.68 257022,-1750.68 257022,-1794.68"/>
<text text-anchor="middle" x="256922" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="256922" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="256922" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="256922" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert3_mlp1 -->
<g id="node788" class="node">
<title>layer5_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="256804,-1794.68 256608,-1794.68 256608,-1750.68 256804,-1750.68 256804,-1794.68"/>
<text text-anchor="middle" x="256706" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="256706" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="256706" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="256706" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert3_gelu -->
<g id="node789" class="node">
<title>layer5_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="256590,-1794.68 256394,-1794.68 256394,-1750.68 256590,-1750.68 256590,-1794.68"/>
<text text-anchor="middle" x="256492" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="256492" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="256492" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="256492" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert3_mlp2 -->
<g id="node790" class="node">
<title>layer5_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="256376,-1794.68 256176,-1794.68 256176,-1750.68 256376,-1750.68 256376,-1794.68"/>
<text text-anchor="middle" x="256276" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="256276" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="256276" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="256276" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert3_mlp_ar -->
<g id="node791" class="node">
<title>layer5_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="256017" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="256017" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="256017" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="256017" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="256017" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert3_mlp_res -->
<g id="node792" class="node">
<title>layer5_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="255857.2,-1816.68 255527.59,-1816.68 255442.8,-1728.68 255772.41,-1728.68 255857.2,-1816.68"/>
<text text-anchor="middle" x="255650" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="255650" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="255650" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="255650" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert3_ln2 -->
<g id="node793" class="node">
<title>layer5_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="255425,-1794.68 255225,-1794.68 255225,-1750.68 255425,-1750.68 255425,-1794.68"/>
<text text-anchor="middle" x="255325" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="255325" y="-1775.28" font-family="Arial" font-size="8.00">L5_E3</text>
<text text-anchor="middle" x="255325" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="255325" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert4_route -->
<g id="node794" class="node">
<title>layer5_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="255201,-1794.68 255001,-1794.68 255001,-1750.68 255201,-1750.68 255201,-1794.68"/>
<text text-anchor="middle" x="255101" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="255101" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="255101" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="255101" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert4_gate -->
<g id="node795" class="node">
<title>layer5_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="254983.04,-1816.68 254668,-1816.68 254586.96,-1728.68 254902,-1728.68 254983.04,-1816.68"/>
<text text-anchor="middle" x="254785" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="254785" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="254785" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="254785" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer5_expert4_a2a -->
<g id="node796" class="node">
<title>layer5_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="254428" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="254428" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="254428" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="254428" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="254428" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert4_attn_split -->
<g id="node797" class="node">
<title>layer5_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="254268.48,-1816.68 253943.2,-1816.68 253859.52,-1728.68 254184.8,-1728.68 254268.48,-1816.68"/>
<text text-anchor="middle" x="254064" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="254064" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="254064" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="254064" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert4_q_proj -->
<g id="node798" class="node">
<title>layer5_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="253841.5,-1794.68 253644.5,-1794.68 253644.5,-1750.68 253841.5,-1750.68 253841.5,-1794.68"/>
<text text-anchor="middle" x="253743" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="253743" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="253743" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="253743" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert4_k_proj -->
<g id="node799" class="node">
<title>layer5_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="253626.5,-1794.68 253429.5,-1794.68 253429.5,-1750.68 253626.5,-1750.68 253626.5,-1794.68"/>
<text text-anchor="middle" x="253528" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="253528" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="253528" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="253528" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert4_v_proj -->
<g id="node800" class="node">
<title>layer5_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="253411.5,-1794.68 253214.5,-1794.68 253214.5,-1750.68 253411.5,-1750.68 253411.5,-1794.68"/>
<text text-anchor="middle" x="253313" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="253313" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="253313" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="253313" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert4_attn -->
<g id="node801" class="node">
<title>layer5_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="253196.5,-1794.68 252999.5,-1794.68 252999.5,-1750.68 253196.5,-1750.68 253196.5,-1794.68"/>
<text text-anchor="middle" x="253098" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="253098" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="253098" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="253098" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert4_attn_out -->
<g id="node802" class="node">
<title>layer5_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="252981,-1794.68 252781,-1794.68 252781,-1750.68 252981,-1750.68 252981,-1794.68"/>
<text text-anchor="middle" x="252881" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="252881" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="252881" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="252881" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert4_attn_ar -->
<g id="node803" class="node">
<title>layer5_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="252622" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="252622" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="252622" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="252622" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="252622" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert4_attn_res -->
<g id="node804" class="node">
<title>layer5_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="252462.2,-1816.68 252132.59,-1816.68 252047.8,-1728.68 252377.41,-1728.68 252462.2,-1816.68"/>
<text text-anchor="middle" x="252255" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="252255" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="252255" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="252255" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert4_ln1 -->
<g id="node805" class="node">
<title>layer5_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="252030,-1794.68 251830,-1794.68 251830,-1750.68 252030,-1750.68 252030,-1794.68"/>
<text text-anchor="middle" x="251930" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="251930" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="251930" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="251930" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert4_mlp1 -->
<g id="node806" class="node">
<title>layer5_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="251812,-1794.68 251616,-1794.68 251616,-1750.68 251812,-1750.68 251812,-1794.68"/>
<text text-anchor="middle" x="251714" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="251714" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="251714" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="251714" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert4_gelu -->
<g id="node807" class="node">
<title>layer5_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="251598,-1794.68 251402,-1794.68 251402,-1750.68 251598,-1750.68 251598,-1794.68"/>
<text text-anchor="middle" x="251500" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="251500" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="251500" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="251500" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert4_mlp2 -->
<g id="node808" class="node">
<title>layer5_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="251384,-1794.68 251184,-1794.68 251184,-1750.68 251384,-1750.68 251384,-1794.68"/>
<text text-anchor="middle" x="251284" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="251284" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="251284" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="251284" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert4_mlp_ar -->
<g id="node809" class="node">
<title>layer5_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="251025" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="251025" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="251025" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="251025" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="251025" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert4_mlp_res -->
<g id="node810" class="node">
<title>layer5_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="250865.2,-1816.68 250535.59,-1816.68 250450.8,-1728.68 250780.41,-1728.68 250865.2,-1816.68"/>
<text text-anchor="middle" x="250658" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="250658" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="250658" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="250658" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert4_ln2 -->
<g id="node811" class="node">
<title>layer5_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="250433,-1794.68 250233,-1794.68 250233,-1750.68 250433,-1750.68 250433,-1794.68"/>
<text text-anchor="middle" x="250333" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="250333" y="-1775.28" font-family="Arial" font-size="8.00">L5_E4</text>
<text text-anchor="middle" x="250333" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="250333" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert5_route -->
<g id="node812" class="node">
<title>layer5_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="250209,-1794.68 250009,-1794.68 250009,-1750.68 250209,-1750.68 250209,-1794.68"/>
<text text-anchor="middle" x="250109" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="250109" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="250109" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="250109" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert5_gate -->
<g id="node813" class="node">
<title>layer5_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="249991.04,-1816.68 249676,-1816.68 249594.96,-1728.68 249910,-1728.68 249991.04,-1816.68"/>
<text text-anchor="middle" x="249793" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="249793" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="249793" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="249793" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer5_expert5_a2a -->
<g id="node814" class="node">
<title>layer5_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="249436" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="249436" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="249436" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="249436" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="249436" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert5_attn_split -->
<g id="node815" class="node">
<title>layer5_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="249276.48,-1816.68 248951.2,-1816.68 248867.52,-1728.68 249192.8,-1728.68 249276.48,-1816.68"/>
<text text-anchor="middle" x="249072" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="249072" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="249072" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="249072" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert5_q_proj -->
<g id="node816" class="node">
<title>layer5_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="248849.5,-1794.68 248652.5,-1794.68 248652.5,-1750.68 248849.5,-1750.68 248849.5,-1794.68"/>
<text text-anchor="middle" x="248751" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="248751" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="248751" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="248751" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert5_k_proj -->
<g id="node817" class="node">
<title>layer5_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="248634.5,-1794.68 248437.5,-1794.68 248437.5,-1750.68 248634.5,-1750.68 248634.5,-1794.68"/>
<text text-anchor="middle" x="248536" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="248536" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="248536" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="248536" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert5_v_proj -->
<g id="node818" class="node">
<title>layer5_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="248419.5,-1794.68 248222.5,-1794.68 248222.5,-1750.68 248419.5,-1750.68 248419.5,-1794.68"/>
<text text-anchor="middle" x="248321" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="248321" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="248321" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="248321" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert5_attn -->
<g id="node819" class="node">
<title>layer5_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="248204.5,-1794.68 248007.5,-1794.68 248007.5,-1750.68 248204.5,-1750.68 248204.5,-1794.68"/>
<text text-anchor="middle" x="248106" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="248106" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="248106" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="248106" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert5_attn_out -->
<g id="node820" class="node">
<title>layer5_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="247989,-1794.68 247789,-1794.68 247789,-1750.68 247989,-1750.68 247989,-1794.68"/>
<text text-anchor="middle" x="247889" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="247889" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="247889" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="247889" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert5_attn_ar -->
<g id="node821" class="node">
<title>layer5_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="247630" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="247630" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="247630" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="247630" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="247630" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert5_attn_res -->
<g id="node822" class="node">
<title>layer5_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="247470.2,-1816.68 247140.59,-1816.68 247055.8,-1728.68 247385.41,-1728.68 247470.2,-1816.68"/>
<text text-anchor="middle" x="247263" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="247263" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="247263" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="247263" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert5_ln1 -->
<g id="node823" class="node">
<title>layer5_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="247038,-1794.68 246838,-1794.68 246838,-1750.68 247038,-1750.68 247038,-1794.68"/>
<text text-anchor="middle" x="246938" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="246938" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="246938" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="246938" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert5_mlp1 -->
<g id="node824" class="node">
<title>layer5_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="246820,-1794.68 246624,-1794.68 246624,-1750.68 246820,-1750.68 246820,-1794.68"/>
<text text-anchor="middle" x="246722" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="246722" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="246722" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="246722" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert5_gelu -->
<g id="node825" class="node">
<title>layer5_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="246606,-1794.68 246410,-1794.68 246410,-1750.68 246606,-1750.68 246606,-1794.68"/>
<text text-anchor="middle" x="246508" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="246508" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="246508" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="246508" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert5_mlp2 -->
<g id="node826" class="node">
<title>layer5_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="246392,-1794.68 246192,-1794.68 246192,-1750.68 246392,-1750.68 246392,-1794.68"/>
<text text-anchor="middle" x="246292" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="246292" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="246292" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="246292" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert5_mlp_ar -->
<g id="node827" class="node">
<title>layer5_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="246033" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="246033" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="246033" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="246033" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="246033" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert5_mlp_res -->
<g id="node828" class="node">
<title>layer5_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="245873.2,-1816.68 245543.59,-1816.68 245458.8,-1728.68 245788.41,-1728.68 245873.2,-1816.68"/>
<text text-anchor="middle" x="245666" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="245666" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="245666" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="245666" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert5_ln2 -->
<g id="node829" class="node">
<title>layer5_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="245441,-1794.68 245241,-1794.68 245241,-1750.68 245441,-1750.68 245441,-1794.68"/>
<text text-anchor="middle" x="245341" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="245341" y="-1775.28" font-family="Arial" font-size="8.00">L5_E5</text>
<text text-anchor="middle" x="245341" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="245341" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert6_route -->
<g id="node830" class="node">
<title>layer5_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="245217,-1794.68 245017,-1794.68 245017,-1750.68 245217,-1750.68 245217,-1794.68"/>
<text text-anchor="middle" x="245117" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="245117" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="245117" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="245117" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert6_gate -->
<g id="node831" class="node">
<title>layer5_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="244999.04,-1816.68 244684,-1816.68 244602.96,-1728.68 244918,-1728.68 244999.04,-1816.68"/>
<text text-anchor="middle" x="244801" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="244801" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="244801" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="244801" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer5_expert6_a2a -->
<g id="node832" class="node">
<title>layer5_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="244444" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="244444" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="244444" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="244444" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="244444" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert6_attn_split -->
<g id="node833" class="node">
<title>layer5_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="244284.48,-1816.68 243959.2,-1816.68 243875.52,-1728.68 244200.8,-1728.68 244284.48,-1816.68"/>
<text text-anchor="middle" x="244080" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="244080" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="244080" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="244080" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert6_q_proj -->
<g id="node834" class="node">
<title>layer5_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="243857.5,-1794.68 243660.5,-1794.68 243660.5,-1750.68 243857.5,-1750.68 243857.5,-1794.68"/>
<text text-anchor="middle" x="243759" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="243759" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="243759" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="243759" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert6_k_proj -->
<g id="node835" class="node">
<title>layer5_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="243642.5,-1794.68 243445.5,-1794.68 243445.5,-1750.68 243642.5,-1750.68 243642.5,-1794.68"/>
<text text-anchor="middle" x="243544" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="243544" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="243544" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="243544" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert6_v_proj -->
<g id="node836" class="node">
<title>layer5_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="243427.5,-1794.68 243230.5,-1794.68 243230.5,-1750.68 243427.5,-1750.68 243427.5,-1794.68"/>
<text text-anchor="middle" x="243329" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="243329" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="243329" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="243329" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert6_attn -->
<g id="node837" class="node">
<title>layer5_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="243212.5,-1794.68 243015.5,-1794.68 243015.5,-1750.68 243212.5,-1750.68 243212.5,-1794.68"/>
<text text-anchor="middle" x="243114" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="243114" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="243114" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="243114" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert6_attn_out -->
<g id="node838" class="node">
<title>layer5_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="242997,-1794.68 242797,-1794.68 242797,-1750.68 242997,-1750.68 242997,-1794.68"/>
<text text-anchor="middle" x="242897" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="242897" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="242897" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="242897" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert6_attn_ar -->
<g id="node839" class="node">
<title>layer5_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="242638" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="242638" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="242638" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="242638" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="242638" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert6_attn_res -->
<g id="node840" class="node">
<title>layer5_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="242478.2,-1816.68 242148.59,-1816.68 242063.8,-1728.68 242393.41,-1728.68 242478.2,-1816.68"/>
<text text-anchor="middle" x="242271" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="242271" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="242271" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="242271" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert6_ln1 -->
<g id="node841" class="node">
<title>layer5_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="242046,-1794.68 241846,-1794.68 241846,-1750.68 242046,-1750.68 242046,-1794.68"/>
<text text-anchor="middle" x="241946" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="241946" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="241946" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="241946" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert6_mlp1 -->
<g id="node842" class="node">
<title>layer5_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="241828,-1794.68 241632,-1794.68 241632,-1750.68 241828,-1750.68 241828,-1794.68"/>
<text text-anchor="middle" x="241730" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="241730" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="241730" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="241730" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert6_gelu -->
<g id="node843" class="node">
<title>layer5_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="241614,-1794.68 241418,-1794.68 241418,-1750.68 241614,-1750.68 241614,-1794.68"/>
<text text-anchor="middle" x="241516" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="241516" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="241516" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="241516" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert6_mlp2 -->
<g id="node844" class="node">
<title>layer5_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="241400,-1794.68 241200,-1794.68 241200,-1750.68 241400,-1750.68 241400,-1794.68"/>
<text text-anchor="middle" x="241300" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="241300" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="241300" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="241300" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert6_mlp_ar -->
<g id="node845" class="node">
<title>layer5_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="241041" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="241041" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="241041" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="241041" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="241041" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert6_mlp_res -->
<g id="node846" class="node">
<title>layer5_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="240881.2,-1816.68 240551.59,-1816.68 240466.8,-1728.68 240796.41,-1728.68 240881.2,-1816.68"/>
<text text-anchor="middle" x="240674" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="240674" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="240674" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="240674" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert6_ln2 -->
<g id="node847" class="node">
<title>layer5_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="240449,-1794.68 240249,-1794.68 240249,-1750.68 240449,-1750.68 240449,-1794.68"/>
<text text-anchor="middle" x="240349" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="240349" y="-1775.28" font-family="Arial" font-size="8.00">L5_E6</text>
<text text-anchor="middle" x="240349" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="240349" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert7_route -->
<g id="node848" class="node">
<title>layer5_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="240225,-1794.68 240025,-1794.68 240025,-1750.68 240225,-1750.68 240225,-1794.68"/>
<text text-anchor="middle" x="240125" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="240125" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="240125" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="240125" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert7_gate -->
<g id="node849" class="node">
<title>layer5_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="240007.04,-1816.68 239692,-1816.68 239610.96,-1728.68 239926,-1728.68 240007.04,-1816.68"/>
<text text-anchor="middle" x="239809" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="239809" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="239809" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="239809" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer5_expert7_a2a -->
<g id="node850" class="node">
<title>layer5_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="239452" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="239452" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="239452" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="239452" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="239452" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert7_attn_split -->
<g id="node851" class="node">
<title>layer5_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="239292.48,-1816.68 238967.2,-1816.68 238883.52,-1728.68 239208.8,-1728.68 239292.48,-1816.68"/>
<text text-anchor="middle" x="239088" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="239088" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="239088" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="239088" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert7_q_proj -->
<g id="node852" class="node">
<title>layer5_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="238865.5,-1794.68 238668.5,-1794.68 238668.5,-1750.68 238865.5,-1750.68 238865.5,-1794.68"/>
<text text-anchor="middle" x="238767" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="238767" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="238767" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="238767" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert7_k_proj -->
<g id="node853" class="node">
<title>layer5_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="238650.5,-1794.68 238453.5,-1794.68 238453.5,-1750.68 238650.5,-1750.68 238650.5,-1794.68"/>
<text text-anchor="middle" x="238552" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="238552" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="238552" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="238552" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert7_v_proj -->
<g id="node854" class="node">
<title>layer5_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="238435.5,-1794.68 238238.5,-1794.68 238238.5,-1750.68 238435.5,-1750.68 238435.5,-1794.68"/>
<text text-anchor="middle" x="238337" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="238337" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="238337" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="238337" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert7_attn -->
<g id="node855" class="node">
<title>layer5_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="238220.5,-1794.68 238023.5,-1794.68 238023.5,-1750.68 238220.5,-1750.68 238220.5,-1794.68"/>
<text text-anchor="middle" x="238122" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="238122" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="238122" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="238122" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer5_expert7_attn_out -->
<g id="node856" class="node">
<title>layer5_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="238005,-1794.68 237805,-1794.68 237805,-1750.68 238005,-1750.68 238005,-1794.68"/>
<text text-anchor="middle" x="237905" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="237905" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="237905" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="237905" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert7_attn_ar -->
<g id="node857" class="node">
<title>layer5_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="237646" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="237646" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="237646" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="237646" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="237646" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert7_attn_res -->
<g id="node858" class="node">
<title>layer5_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="237486.2,-1816.68 237156.59,-1816.68 237071.8,-1728.68 237401.41,-1728.68 237486.2,-1816.68"/>
<text text-anchor="middle" x="237279" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="237279" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="237279" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="237279" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert7_ln1 -->
<g id="node859" class="node">
<title>layer5_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="237054,-1794.68 236854,-1794.68 236854,-1750.68 237054,-1750.68 237054,-1794.68"/>
<text text-anchor="middle" x="236954" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="236954" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="236954" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="236954" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert7_mlp1 -->
<g id="node860" class="node">
<title>layer5_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="236836,-1794.68 236640,-1794.68 236640,-1750.68 236836,-1750.68 236836,-1794.68"/>
<text text-anchor="middle" x="236738" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="236738" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="236738" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="236738" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert7_gelu -->
<g id="node861" class="node">
<title>layer5_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="236622,-1794.68 236426,-1794.68 236426,-1750.68 236622,-1750.68 236622,-1794.68"/>
<text text-anchor="middle" x="236524" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="236524" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="236524" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="236524" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer5_expert7_mlp2 -->
<g id="node862" class="node">
<title>layer5_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="236408,-1794.68 236208,-1794.68 236208,-1750.68 236408,-1750.68 236408,-1794.68"/>
<text text-anchor="middle" x="236308" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="236308" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="236308" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="236308" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert7_mlp_ar -->
<g id="node863" class="node">
<title>layer5_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="236049" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="236049" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="236049" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="236049" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="236049" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert7_mlp_res -->
<g id="node864" class="node">
<title>layer5_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="235889.2,-1816.68 235559.59,-1816.68 235474.8,-1728.68 235804.41,-1728.68 235889.2,-1816.68"/>
<text text-anchor="middle" x="235682" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="235682" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="235682" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="235682" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer5_expert7_ln2 -->
<g id="node865" class="node">
<title>layer5_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="235457,-1794.68 235257,-1794.68 235257,-1750.68 235457,-1750.68 235457,-1794.68"/>
<text text-anchor="middle" x="235357" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="235357" y="-1775.28" font-family="Arial" font-size="8.00">L5_E7</text>
<text text-anchor="middle" x="235357" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="235357" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert0_route -->
<g id="node866" class="node">
<title>layer6_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="235217,-1794.68 235017,-1794.68 235017,-1750.68 235217,-1750.68 235217,-1794.68"/>
<text text-anchor="middle" x="235117" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="235117" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="235117" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="235117" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert0_gate -->
<g id="node867" class="node">
<title>layer6_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="234999.04,-1816.68 234684,-1816.68 234602.96,-1728.68 234918,-1728.68 234999.04,-1816.68"/>
<text text-anchor="middle" x="234801" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="234801" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="234801" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="234801" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer6_expert0_a2a -->
<g id="node868" class="node">
<title>layer6_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="234444" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="234444" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="234444" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="234444" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="234444" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert0_attn_split -->
<g id="node869" class="node">
<title>layer6_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="234284.48,-1816.68 233959.2,-1816.68 233875.52,-1728.68 234200.8,-1728.68 234284.48,-1816.68"/>
<text text-anchor="middle" x="234080" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="234080" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="234080" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="234080" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert0_q_proj -->
<g id="node870" class="node">
<title>layer6_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="233857.5,-1794.68 233660.5,-1794.68 233660.5,-1750.68 233857.5,-1750.68 233857.5,-1794.68"/>
<text text-anchor="middle" x="233759" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="233759" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="233759" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="233759" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert0_k_proj -->
<g id="node871" class="node">
<title>layer6_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="233642.5,-1794.68 233445.5,-1794.68 233445.5,-1750.68 233642.5,-1750.68 233642.5,-1794.68"/>
<text text-anchor="middle" x="233544" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="233544" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="233544" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="233544" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert0_v_proj -->
<g id="node872" class="node">
<title>layer6_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="233427.5,-1794.68 233230.5,-1794.68 233230.5,-1750.68 233427.5,-1750.68 233427.5,-1794.68"/>
<text text-anchor="middle" x="233329" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="233329" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="233329" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="233329" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert0_attn -->
<g id="node873" class="node">
<title>layer6_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="233212.5,-1794.68 233015.5,-1794.68 233015.5,-1750.68 233212.5,-1750.68 233212.5,-1794.68"/>
<text text-anchor="middle" x="233114" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="233114" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="233114" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="233114" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert0_attn_out -->
<g id="node874" class="node">
<title>layer6_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="232997,-1794.68 232797,-1794.68 232797,-1750.68 232997,-1750.68 232997,-1794.68"/>
<text text-anchor="middle" x="232897" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="232897" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="232897" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="232897" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert0_attn_ar -->
<g id="node875" class="node">
<title>layer6_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="232638" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="232638" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="232638" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="232638" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="232638" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert0_attn_res -->
<g id="node876" class="node">
<title>layer6_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="232478.2,-1816.68 232148.59,-1816.68 232063.8,-1728.68 232393.41,-1728.68 232478.2,-1816.68"/>
<text text-anchor="middle" x="232271" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="232271" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="232271" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="232271" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert0_ln1 -->
<g id="node877" class="node">
<title>layer6_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="232046,-1794.68 231846,-1794.68 231846,-1750.68 232046,-1750.68 232046,-1794.68"/>
<text text-anchor="middle" x="231946" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="231946" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="231946" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="231946" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert0_mlp1 -->
<g id="node878" class="node">
<title>layer6_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="231828,-1794.68 231632,-1794.68 231632,-1750.68 231828,-1750.68 231828,-1794.68"/>
<text text-anchor="middle" x="231730" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="231730" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="231730" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="231730" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert0_gelu -->
<g id="node879" class="node">
<title>layer6_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="231614,-1794.68 231418,-1794.68 231418,-1750.68 231614,-1750.68 231614,-1794.68"/>
<text text-anchor="middle" x="231516" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="231516" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="231516" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="231516" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert0_mlp2 -->
<g id="node880" class="node">
<title>layer6_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="231400,-1794.68 231200,-1794.68 231200,-1750.68 231400,-1750.68 231400,-1794.68"/>
<text text-anchor="middle" x="231300" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="231300" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="231300" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="231300" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert0_mlp_ar -->
<g id="node881" class="node">
<title>layer6_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="231041" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="231041" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="231041" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="231041" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="231041" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert0_mlp_res -->
<g id="node882" class="node">
<title>layer6_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="230881.2,-1816.68 230551.59,-1816.68 230466.8,-1728.68 230796.41,-1728.68 230881.2,-1816.68"/>
<text text-anchor="middle" x="230674" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="230674" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="230674" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="230674" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert0_ln2 -->
<g id="node883" class="node">
<title>layer6_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="230449,-1794.68 230249,-1794.68 230249,-1750.68 230449,-1750.68 230449,-1794.68"/>
<text text-anchor="middle" x="230349" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="230349" y="-1775.28" font-family="Arial" font-size="8.00">L6_E0</text>
<text text-anchor="middle" x="230349" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="230349" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert1_route -->
<g id="node884" class="node">
<title>layer6_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="230225,-1794.68 230025,-1794.68 230025,-1750.68 230225,-1750.68 230225,-1794.68"/>
<text text-anchor="middle" x="230125" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="230125" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="230125" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="230125" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert1_gate -->
<g id="node885" class="node">
<title>layer6_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="230007.04,-1816.68 229692,-1816.68 229610.96,-1728.68 229926,-1728.68 230007.04,-1816.68"/>
<text text-anchor="middle" x="229809" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="229809" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="229809" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="229809" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer6_expert1_a2a -->
<g id="node886" class="node">
<title>layer6_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="229452" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="229452" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="229452" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="229452" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="229452" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert1_attn_split -->
<g id="node887" class="node">
<title>layer6_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="229292.48,-1816.68 228967.2,-1816.68 228883.52,-1728.68 229208.8,-1728.68 229292.48,-1816.68"/>
<text text-anchor="middle" x="229088" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="229088" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="229088" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="229088" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert1_q_proj -->
<g id="node888" class="node">
<title>layer6_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="228865.5,-1794.68 228668.5,-1794.68 228668.5,-1750.68 228865.5,-1750.68 228865.5,-1794.68"/>
<text text-anchor="middle" x="228767" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="228767" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="228767" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="228767" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert1_k_proj -->
<g id="node889" class="node">
<title>layer6_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="228650.5,-1794.68 228453.5,-1794.68 228453.5,-1750.68 228650.5,-1750.68 228650.5,-1794.68"/>
<text text-anchor="middle" x="228552" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="228552" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="228552" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="228552" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert1_v_proj -->
<g id="node890" class="node">
<title>layer6_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="228435.5,-1794.68 228238.5,-1794.68 228238.5,-1750.68 228435.5,-1750.68 228435.5,-1794.68"/>
<text text-anchor="middle" x="228337" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="228337" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="228337" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="228337" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert1_attn -->
<g id="node891" class="node">
<title>layer6_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="228220.5,-1794.68 228023.5,-1794.68 228023.5,-1750.68 228220.5,-1750.68 228220.5,-1794.68"/>
<text text-anchor="middle" x="228122" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="228122" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="228122" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="228122" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert1_attn_out -->
<g id="node892" class="node">
<title>layer6_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="228005,-1794.68 227805,-1794.68 227805,-1750.68 228005,-1750.68 228005,-1794.68"/>
<text text-anchor="middle" x="227905" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="227905" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="227905" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="227905" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert1_attn_ar -->
<g id="node893" class="node">
<title>layer6_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="227646" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="227646" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="227646" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="227646" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="227646" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert1_attn_res -->
<g id="node894" class="node">
<title>layer6_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="227486.2,-1816.68 227156.59,-1816.68 227071.8,-1728.68 227401.41,-1728.68 227486.2,-1816.68"/>
<text text-anchor="middle" x="227279" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="227279" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="227279" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="227279" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert1_ln1 -->
<g id="node895" class="node">
<title>layer6_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="227054,-1794.68 226854,-1794.68 226854,-1750.68 227054,-1750.68 227054,-1794.68"/>
<text text-anchor="middle" x="226954" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="226954" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="226954" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="226954" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert1_mlp1 -->
<g id="node896" class="node">
<title>layer6_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="226836,-1794.68 226640,-1794.68 226640,-1750.68 226836,-1750.68 226836,-1794.68"/>
<text text-anchor="middle" x="226738" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="226738" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="226738" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="226738" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert1_gelu -->
<g id="node897" class="node">
<title>layer6_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="226622,-1794.68 226426,-1794.68 226426,-1750.68 226622,-1750.68 226622,-1794.68"/>
<text text-anchor="middle" x="226524" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="226524" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="226524" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="226524" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert1_mlp2 -->
<g id="node898" class="node">
<title>layer6_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="226408,-1794.68 226208,-1794.68 226208,-1750.68 226408,-1750.68 226408,-1794.68"/>
<text text-anchor="middle" x="226308" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="226308" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="226308" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="226308" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert1_mlp_ar -->
<g id="node899" class="node">
<title>layer6_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="226049" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="226049" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="226049" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="226049" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="226049" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert1_mlp_res -->
<g id="node900" class="node">
<title>layer6_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="225889.2,-1816.68 225559.59,-1816.68 225474.8,-1728.68 225804.41,-1728.68 225889.2,-1816.68"/>
<text text-anchor="middle" x="225682" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="225682" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="225682" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="225682" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert1_ln2 -->
<g id="node901" class="node">
<title>layer6_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="225457,-1794.68 225257,-1794.68 225257,-1750.68 225457,-1750.68 225457,-1794.68"/>
<text text-anchor="middle" x="225357" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="225357" y="-1775.28" font-family="Arial" font-size="8.00">L6_E1</text>
<text text-anchor="middle" x="225357" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="225357" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert2_route -->
<g id="node902" class="node">
<title>layer6_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="225233,-1794.68 225033,-1794.68 225033,-1750.68 225233,-1750.68 225233,-1794.68"/>
<text text-anchor="middle" x="225133" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="225133" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="225133" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="225133" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert2_gate -->
<g id="node903" class="node">
<title>layer6_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="225015.04,-1816.68 224700,-1816.68 224618.96,-1728.68 224934,-1728.68 225015.04,-1816.68"/>
<text text-anchor="middle" x="224817" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="224817" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="224817" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="224817" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer6_expert2_a2a -->
<g id="node904" class="node">
<title>layer6_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="224460" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="224460" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="224460" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="224460" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="224460" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert2_attn_split -->
<g id="node905" class="node">
<title>layer6_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="224300.48,-1816.68 223975.2,-1816.68 223891.52,-1728.68 224216.8,-1728.68 224300.48,-1816.68"/>
<text text-anchor="middle" x="224096" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="224096" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="224096" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="224096" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert2_q_proj -->
<g id="node906" class="node">
<title>layer6_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="223873.5,-1794.68 223676.5,-1794.68 223676.5,-1750.68 223873.5,-1750.68 223873.5,-1794.68"/>
<text text-anchor="middle" x="223775" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="223775" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="223775" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="223775" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert2_k_proj -->
<g id="node907" class="node">
<title>layer6_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="223658.5,-1794.68 223461.5,-1794.68 223461.5,-1750.68 223658.5,-1750.68 223658.5,-1794.68"/>
<text text-anchor="middle" x="223560" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="223560" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="223560" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="223560" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert2_v_proj -->
<g id="node908" class="node">
<title>layer6_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="223443.5,-1794.68 223246.5,-1794.68 223246.5,-1750.68 223443.5,-1750.68 223443.5,-1794.68"/>
<text text-anchor="middle" x="223345" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="223345" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="223345" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="223345" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert2_attn -->
<g id="node909" class="node">
<title>layer6_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="223228.5,-1794.68 223031.5,-1794.68 223031.5,-1750.68 223228.5,-1750.68 223228.5,-1794.68"/>
<text text-anchor="middle" x="223130" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="223130" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="223130" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="223130" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert2_attn_out -->
<g id="node910" class="node">
<title>layer6_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="223013,-1794.68 222813,-1794.68 222813,-1750.68 223013,-1750.68 223013,-1794.68"/>
<text text-anchor="middle" x="222913" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="222913" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="222913" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="222913" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert2_attn_ar -->
<g id="node911" class="node">
<title>layer6_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="222654" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="222654" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="222654" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="222654" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="222654" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert2_attn_res -->
<g id="node912" class="node">
<title>layer6_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="222494.2,-1816.68 222164.59,-1816.68 222079.8,-1728.68 222409.41,-1728.68 222494.2,-1816.68"/>
<text text-anchor="middle" x="222287" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="222287" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="222287" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="222287" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert2_ln1 -->
<g id="node913" class="node">
<title>layer6_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="222062,-1794.68 221862,-1794.68 221862,-1750.68 222062,-1750.68 222062,-1794.68"/>
<text text-anchor="middle" x="221962" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="221962" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="221962" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="221962" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert2_mlp1 -->
<g id="node914" class="node">
<title>layer6_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="221844,-1794.68 221648,-1794.68 221648,-1750.68 221844,-1750.68 221844,-1794.68"/>
<text text-anchor="middle" x="221746" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="221746" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="221746" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="221746" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert2_gelu -->
<g id="node915" class="node">
<title>layer6_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="221630,-1794.68 221434,-1794.68 221434,-1750.68 221630,-1750.68 221630,-1794.68"/>
<text text-anchor="middle" x="221532" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="221532" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="221532" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="221532" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert2_mlp2 -->
<g id="node916" class="node">
<title>layer6_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="221416,-1794.68 221216,-1794.68 221216,-1750.68 221416,-1750.68 221416,-1794.68"/>
<text text-anchor="middle" x="221316" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="221316" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="221316" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="221316" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert2_mlp_ar -->
<g id="node917" class="node">
<title>layer6_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="221057" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="221057" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="221057" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="221057" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="221057" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert2_mlp_res -->
<g id="node918" class="node">
<title>layer6_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="220897.2,-1816.68 220567.59,-1816.68 220482.8,-1728.68 220812.41,-1728.68 220897.2,-1816.68"/>
<text text-anchor="middle" x="220690" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="220690" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="220690" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="220690" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert2_ln2 -->
<g id="node919" class="node">
<title>layer6_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="220465,-1794.68 220265,-1794.68 220265,-1750.68 220465,-1750.68 220465,-1794.68"/>
<text text-anchor="middle" x="220365" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="220365" y="-1775.28" font-family="Arial" font-size="8.00">L6_E2</text>
<text text-anchor="middle" x="220365" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="220365" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert3_route -->
<g id="node920" class="node">
<title>layer6_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="220241,-1794.68 220041,-1794.68 220041,-1750.68 220241,-1750.68 220241,-1794.68"/>
<text text-anchor="middle" x="220141" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="220141" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="220141" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="220141" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert3_gate -->
<g id="node921" class="node">
<title>layer6_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="220023.04,-1816.68 219708,-1816.68 219626.96,-1728.68 219942,-1728.68 220023.04,-1816.68"/>
<text text-anchor="middle" x="219825" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="219825" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="219825" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="219825" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer6_expert3_a2a -->
<g id="node922" class="node">
<title>layer6_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="219468" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="219468" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="219468" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="219468" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="219468" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert3_attn_split -->
<g id="node923" class="node">
<title>layer6_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="219308.48,-1816.68 218983.2,-1816.68 218899.52,-1728.68 219224.8,-1728.68 219308.48,-1816.68"/>
<text text-anchor="middle" x="219104" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="219104" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="219104" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="219104" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert3_q_proj -->
<g id="node924" class="node">
<title>layer6_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="218881.5,-1794.68 218684.5,-1794.68 218684.5,-1750.68 218881.5,-1750.68 218881.5,-1794.68"/>
<text text-anchor="middle" x="218783" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="218783" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="218783" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="218783" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert3_k_proj -->
<g id="node925" class="node">
<title>layer6_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="218666.5,-1794.68 218469.5,-1794.68 218469.5,-1750.68 218666.5,-1750.68 218666.5,-1794.68"/>
<text text-anchor="middle" x="218568" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="218568" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="218568" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="218568" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert3_v_proj -->
<g id="node926" class="node">
<title>layer6_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="218451.5,-1794.68 218254.5,-1794.68 218254.5,-1750.68 218451.5,-1750.68 218451.5,-1794.68"/>
<text text-anchor="middle" x="218353" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="218353" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="218353" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="218353" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert3_attn -->
<g id="node927" class="node">
<title>layer6_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="218236.5,-1794.68 218039.5,-1794.68 218039.5,-1750.68 218236.5,-1750.68 218236.5,-1794.68"/>
<text text-anchor="middle" x="218138" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="218138" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="218138" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="218138" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert3_attn_out -->
<g id="node928" class="node">
<title>layer6_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="218021,-1794.68 217821,-1794.68 217821,-1750.68 218021,-1750.68 218021,-1794.68"/>
<text text-anchor="middle" x="217921" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="217921" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="217921" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="217921" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert3_attn_ar -->
<g id="node929" class="node">
<title>layer6_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="217662" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="217662" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="217662" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="217662" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="217662" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert3_attn_res -->
<g id="node930" class="node">
<title>layer6_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="217502.2,-1816.68 217172.59,-1816.68 217087.8,-1728.68 217417.41,-1728.68 217502.2,-1816.68"/>
<text text-anchor="middle" x="217295" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="217295" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="217295" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="217295" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert3_ln1 -->
<g id="node931" class="node">
<title>layer6_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="217070,-1794.68 216870,-1794.68 216870,-1750.68 217070,-1750.68 217070,-1794.68"/>
<text text-anchor="middle" x="216970" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="216970" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="216970" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="216970" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert3_mlp1 -->
<g id="node932" class="node">
<title>layer6_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="216852,-1794.68 216656,-1794.68 216656,-1750.68 216852,-1750.68 216852,-1794.68"/>
<text text-anchor="middle" x="216754" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="216754" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="216754" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="216754" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert3_gelu -->
<g id="node933" class="node">
<title>layer6_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="216638,-1794.68 216442,-1794.68 216442,-1750.68 216638,-1750.68 216638,-1794.68"/>
<text text-anchor="middle" x="216540" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="216540" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="216540" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="216540" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert3_mlp2 -->
<g id="node934" class="node">
<title>layer6_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="216424,-1794.68 216224,-1794.68 216224,-1750.68 216424,-1750.68 216424,-1794.68"/>
<text text-anchor="middle" x="216324" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="216324" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="216324" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="216324" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert3_mlp_ar -->
<g id="node935" class="node">
<title>layer6_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="216065" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="216065" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="216065" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="216065" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="216065" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert3_mlp_res -->
<g id="node936" class="node">
<title>layer6_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="215905.2,-1816.68 215575.59,-1816.68 215490.8,-1728.68 215820.41,-1728.68 215905.2,-1816.68"/>
<text text-anchor="middle" x="215698" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="215698" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="215698" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="215698" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert3_ln2 -->
<g id="node937" class="node">
<title>layer6_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="215473,-1794.68 215273,-1794.68 215273,-1750.68 215473,-1750.68 215473,-1794.68"/>
<text text-anchor="middle" x="215373" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="215373" y="-1775.28" font-family="Arial" font-size="8.00">L6_E3</text>
<text text-anchor="middle" x="215373" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="215373" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert4_route -->
<g id="node938" class="node">
<title>layer6_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="215249,-1794.68 215049,-1794.68 215049,-1750.68 215249,-1750.68 215249,-1794.68"/>
<text text-anchor="middle" x="215149" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="215149" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="215149" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="215149" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert4_gate -->
<g id="node939" class="node">
<title>layer6_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="215031.04,-1816.68 214716,-1816.68 214634.96,-1728.68 214950,-1728.68 215031.04,-1816.68"/>
<text text-anchor="middle" x="214833" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="214833" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="214833" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="214833" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer6_expert4_a2a -->
<g id="node940" class="node">
<title>layer6_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="214476" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="214476" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="214476" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="214476" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="214476" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert4_attn_split -->
<g id="node941" class="node">
<title>layer6_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="214316.48,-1816.68 213991.2,-1816.68 213907.52,-1728.68 214232.8,-1728.68 214316.48,-1816.68"/>
<text text-anchor="middle" x="214112" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="214112" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="214112" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="214112" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert4_q_proj -->
<g id="node942" class="node">
<title>layer6_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="213889.5,-1794.68 213692.5,-1794.68 213692.5,-1750.68 213889.5,-1750.68 213889.5,-1794.68"/>
<text text-anchor="middle" x="213791" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="213791" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="213791" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="213791" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert4_k_proj -->
<g id="node943" class="node">
<title>layer6_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="213674.5,-1794.68 213477.5,-1794.68 213477.5,-1750.68 213674.5,-1750.68 213674.5,-1794.68"/>
<text text-anchor="middle" x="213576" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="213576" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="213576" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="213576" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert4_v_proj -->
<g id="node944" class="node">
<title>layer6_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="213459.5,-1794.68 213262.5,-1794.68 213262.5,-1750.68 213459.5,-1750.68 213459.5,-1794.68"/>
<text text-anchor="middle" x="213361" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="213361" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="213361" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="213361" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert4_attn -->
<g id="node945" class="node">
<title>layer6_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="213244.5,-1794.68 213047.5,-1794.68 213047.5,-1750.68 213244.5,-1750.68 213244.5,-1794.68"/>
<text text-anchor="middle" x="213146" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="213146" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="213146" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="213146" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert4_attn_out -->
<g id="node946" class="node">
<title>layer6_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="213029,-1794.68 212829,-1794.68 212829,-1750.68 213029,-1750.68 213029,-1794.68"/>
<text text-anchor="middle" x="212929" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="212929" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="212929" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="212929" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert4_attn_ar -->
<g id="node947" class="node">
<title>layer6_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="212670" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="212670" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="212670" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="212670" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="212670" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert4_attn_res -->
<g id="node948" class="node">
<title>layer6_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="212510.2,-1816.68 212180.59,-1816.68 212095.8,-1728.68 212425.41,-1728.68 212510.2,-1816.68"/>
<text text-anchor="middle" x="212303" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="212303" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="212303" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="212303" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert4_ln1 -->
<g id="node949" class="node">
<title>layer6_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="212078,-1794.68 211878,-1794.68 211878,-1750.68 212078,-1750.68 212078,-1794.68"/>
<text text-anchor="middle" x="211978" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="211978" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="211978" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="211978" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert4_mlp1 -->
<g id="node950" class="node">
<title>layer6_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="211860,-1794.68 211664,-1794.68 211664,-1750.68 211860,-1750.68 211860,-1794.68"/>
<text text-anchor="middle" x="211762" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="211762" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="211762" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="211762" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert4_gelu -->
<g id="node951" class="node">
<title>layer6_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="211646,-1794.68 211450,-1794.68 211450,-1750.68 211646,-1750.68 211646,-1794.68"/>
<text text-anchor="middle" x="211548" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="211548" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="211548" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="211548" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert4_mlp2 -->
<g id="node952" class="node">
<title>layer6_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="211432,-1794.68 211232,-1794.68 211232,-1750.68 211432,-1750.68 211432,-1794.68"/>
<text text-anchor="middle" x="211332" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="211332" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="211332" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="211332" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert4_mlp_ar -->
<g id="node953" class="node">
<title>layer6_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="211073" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="211073" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="211073" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="211073" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="211073" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert4_mlp_res -->
<g id="node954" class="node">
<title>layer6_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="210913.2,-1816.68 210583.59,-1816.68 210498.8,-1728.68 210828.41,-1728.68 210913.2,-1816.68"/>
<text text-anchor="middle" x="210706" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="210706" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="210706" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="210706" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert4_ln2 -->
<g id="node955" class="node">
<title>layer6_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="210481,-1794.68 210281,-1794.68 210281,-1750.68 210481,-1750.68 210481,-1794.68"/>
<text text-anchor="middle" x="210381" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="210381" y="-1775.28" font-family="Arial" font-size="8.00">L6_E4</text>
<text text-anchor="middle" x="210381" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="210381" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert5_route -->
<g id="node956" class="node">
<title>layer6_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="210257,-1794.68 210057,-1794.68 210057,-1750.68 210257,-1750.68 210257,-1794.68"/>
<text text-anchor="middle" x="210157" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="210157" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="210157" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="210157" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert5_gate -->
<g id="node957" class="node">
<title>layer6_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="210039.04,-1816.68 209724,-1816.68 209642.96,-1728.68 209958,-1728.68 210039.04,-1816.68"/>
<text text-anchor="middle" x="209841" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="209841" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="209841" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="209841" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer6_expert5_a2a -->
<g id="node958" class="node">
<title>layer6_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="209484" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="209484" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="209484" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="209484" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="209484" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert5_attn_split -->
<g id="node959" class="node">
<title>layer6_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="209324.48,-1816.68 208999.2,-1816.68 208915.52,-1728.68 209240.8,-1728.68 209324.48,-1816.68"/>
<text text-anchor="middle" x="209120" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="209120" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="209120" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="209120" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert5_q_proj -->
<g id="node960" class="node">
<title>layer6_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="208897.5,-1794.68 208700.5,-1794.68 208700.5,-1750.68 208897.5,-1750.68 208897.5,-1794.68"/>
<text text-anchor="middle" x="208799" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="208799" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="208799" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="208799" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert5_k_proj -->
<g id="node961" class="node">
<title>layer6_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="208682.5,-1794.68 208485.5,-1794.68 208485.5,-1750.68 208682.5,-1750.68 208682.5,-1794.68"/>
<text text-anchor="middle" x="208584" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="208584" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="208584" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="208584" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert5_v_proj -->
<g id="node962" class="node">
<title>layer6_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="208467.5,-1794.68 208270.5,-1794.68 208270.5,-1750.68 208467.5,-1750.68 208467.5,-1794.68"/>
<text text-anchor="middle" x="208369" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="208369" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="208369" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="208369" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert5_attn -->
<g id="node963" class="node">
<title>layer6_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="208252.5,-1794.68 208055.5,-1794.68 208055.5,-1750.68 208252.5,-1750.68 208252.5,-1794.68"/>
<text text-anchor="middle" x="208154" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="208154" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="208154" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="208154" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert5_attn_out -->
<g id="node964" class="node">
<title>layer6_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="208037,-1794.68 207837,-1794.68 207837,-1750.68 208037,-1750.68 208037,-1794.68"/>
<text text-anchor="middle" x="207937" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="207937" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="207937" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="207937" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert5_attn_ar -->
<g id="node965" class="node">
<title>layer6_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="207678" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="207678" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="207678" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="207678" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="207678" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert5_attn_res -->
<g id="node966" class="node">
<title>layer6_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="207518.2,-1816.68 207188.59,-1816.68 207103.8,-1728.68 207433.41,-1728.68 207518.2,-1816.68"/>
<text text-anchor="middle" x="207311" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="207311" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="207311" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="207311" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert5_ln1 -->
<g id="node967" class="node">
<title>layer6_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="207086,-1794.68 206886,-1794.68 206886,-1750.68 207086,-1750.68 207086,-1794.68"/>
<text text-anchor="middle" x="206986" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="206986" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="206986" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="206986" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert5_mlp1 -->
<g id="node968" class="node">
<title>layer6_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="206868,-1794.68 206672,-1794.68 206672,-1750.68 206868,-1750.68 206868,-1794.68"/>
<text text-anchor="middle" x="206770" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="206770" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="206770" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="206770" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert5_gelu -->
<g id="node969" class="node">
<title>layer6_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="206654,-1794.68 206458,-1794.68 206458,-1750.68 206654,-1750.68 206654,-1794.68"/>
<text text-anchor="middle" x="206556" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="206556" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="206556" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="206556" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert5_mlp2 -->
<g id="node970" class="node">
<title>layer6_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="206440,-1794.68 206240,-1794.68 206240,-1750.68 206440,-1750.68 206440,-1794.68"/>
<text text-anchor="middle" x="206340" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="206340" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="206340" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="206340" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert5_mlp_ar -->
<g id="node971" class="node">
<title>layer6_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="206081" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="206081" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="206081" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="206081" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="206081" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert5_mlp_res -->
<g id="node972" class="node">
<title>layer6_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="205921.2,-1816.68 205591.59,-1816.68 205506.8,-1728.68 205836.41,-1728.68 205921.2,-1816.68"/>
<text text-anchor="middle" x="205714" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="205714" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="205714" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="205714" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert5_ln2 -->
<g id="node973" class="node">
<title>layer6_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="205489,-1794.68 205289,-1794.68 205289,-1750.68 205489,-1750.68 205489,-1794.68"/>
<text text-anchor="middle" x="205389" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="205389" y="-1775.28" font-family="Arial" font-size="8.00">L6_E5</text>
<text text-anchor="middle" x="205389" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="205389" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert6_route -->
<g id="node974" class="node">
<title>layer6_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="205265,-1794.68 205065,-1794.68 205065,-1750.68 205265,-1750.68 205265,-1794.68"/>
<text text-anchor="middle" x="205165" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="205165" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="205165" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="205165" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert6_gate -->
<g id="node975" class="node">
<title>layer6_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="205047.04,-1816.68 204732,-1816.68 204650.96,-1728.68 204966,-1728.68 205047.04,-1816.68"/>
<text text-anchor="middle" x="204849" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="204849" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="204849" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="204849" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer6_expert6_a2a -->
<g id="node976" class="node">
<title>layer6_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="204492" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="204492" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="204492" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="204492" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="204492" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert6_attn_split -->
<g id="node977" class="node">
<title>layer6_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="204332.48,-1816.68 204007.2,-1816.68 203923.52,-1728.68 204248.8,-1728.68 204332.48,-1816.68"/>
<text text-anchor="middle" x="204128" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="204128" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="204128" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="204128" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert6_q_proj -->
<g id="node978" class="node">
<title>layer6_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="203905.5,-1794.68 203708.5,-1794.68 203708.5,-1750.68 203905.5,-1750.68 203905.5,-1794.68"/>
<text text-anchor="middle" x="203807" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="203807" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="203807" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="203807" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert6_k_proj -->
<g id="node979" class="node">
<title>layer6_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="203690.5,-1794.68 203493.5,-1794.68 203493.5,-1750.68 203690.5,-1750.68 203690.5,-1794.68"/>
<text text-anchor="middle" x="203592" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="203592" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="203592" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="203592" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert6_v_proj -->
<g id="node980" class="node">
<title>layer6_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="203475.5,-1794.68 203278.5,-1794.68 203278.5,-1750.68 203475.5,-1750.68 203475.5,-1794.68"/>
<text text-anchor="middle" x="203377" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="203377" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="203377" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="203377" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert6_attn -->
<g id="node981" class="node">
<title>layer6_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="203260.5,-1794.68 203063.5,-1794.68 203063.5,-1750.68 203260.5,-1750.68 203260.5,-1794.68"/>
<text text-anchor="middle" x="203162" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="203162" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="203162" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="203162" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert6_attn_out -->
<g id="node982" class="node">
<title>layer6_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="203045,-1794.68 202845,-1794.68 202845,-1750.68 203045,-1750.68 203045,-1794.68"/>
<text text-anchor="middle" x="202945" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="202945" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="202945" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="202945" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert6_attn_ar -->
<g id="node983" class="node">
<title>layer6_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="202686" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="202686" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="202686" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="202686" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="202686" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert6_attn_res -->
<g id="node984" class="node">
<title>layer6_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="202526.2,-1816.68 202196.59,-1816.68 202111.8,-1728.68 202441.41,-1728.68 202526.2,-1816.68"/>
<text text-anchor="middle" x="202319" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="202319" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="202319" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="202319" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert6_ln1 -->
<g id="node985" class="node">
<title>layer6_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="202094,-1794.68 201894,-1794.68 201894,-1750.68 202094,-1750.68 202094,-1794.68"/>
<text text-anchor="middle" x="201994" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="201994" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="201994" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="201994" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert6_mlp1 -->
<g id="node986" class="node">
<title>layer6_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="201876,-1794.68 201680,-1794.68 201680,-1750.68 201876,-1750.68 201876,-1794.68"/>
<text text-anchor="middle" x="201778" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="201778" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="201778" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="201778" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert6_gelu -->
<g id="node987" class="node">
<title>layer6_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="201662,-1794.68 201466,-1794.68 201466,-1750.68 201662,-1750.68 201662,-1794.68"/>
<text text-anchor="middle" x="201564" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="201564" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="201564" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="201564" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert6_mlp2 -->
<g id="node988" class="node">
<title>layer6_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="201448,-1794.68 201248,-1794.68 201248,-1750.68 201448,-1750.68 201448,-1794.68"/>
<text text-anchor="middle" x="201348" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="201348" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="201348" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="201348" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert6_mlp_ar -->
<g id="node989" class="node">
<title>layer6_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="201089" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="201089" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="201089" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="201089" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="201089" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert6_mlp_res -->
<g id="node990" class="node">
<title>layer6_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="200929.2,-1816.68 200599.59,-1816.68 200514.8,-1728.68 200844.41,-1728.68 200929.2,-1816.68"/>
<text text-anchor="middle" x="200722" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="200722" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="200722" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="200722" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert6_ln2 -->
<g id="node991" class="node">
<title>layer6_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="200497,-1794.68 200297,-1794.68 200297,-1750.68 200497,-1750.68 200497,-1794.68"/>
<text text-anchor="middle" x="200397" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="200397" y="-1775.28" font-family="Arial" font-size="8.00">L6_E6</text>
<text text-anchor="middle" x="200397" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="200397" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert7_route -->
<g id="node992" class="node">
<title>layer6_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="200273,-1794.68 200073,-1794.68 200073,-1750.68 200273,-1750.68 200273,-1794.68"/>
<text text-anchor="middle" x="200173" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="200173" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="200173" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="200173" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert7_gate -->
<g id="node993" class="node">
<title>layer6_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="200055.04,-1816.68 199740,-1816.68 199658.96,-1728.68 199974,-1728.68 200055.04,-1816.68"/>
<text text-anchor="middle" x="199857" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="199857" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="199857" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="199857" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer6_expert7_a2a -->
<g id="node994" class="node">
<title>layer6_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="199500" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="199500" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="199500" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="199500" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="199500" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert7_attn_split -->
<g id="node995" class="node">
<title>layer6_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="199340.48,-1816.68 199015.2,-1816.68 198931.52,-1728.68 199256.8,-1728.68 199340.48,-1816.68"/>
<text text-anchor="middle" x="199136" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="199136" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="199136" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="199136" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert7_q_proj -->
<g id="node996" class="node">
<title>layer6_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="198913.5,-1794.68 198716.5,-1794.68 198716.5,-1750.68 198913.5,-1750.68 198913.5,-1794.68"/>
<text text-anchor="middle" x="198815" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="198815" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="198815" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="198815" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert7_k_proj -->
<g id="node997" class="node">
<title>layer6_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="198698.5,-1794.68 198501.5,-1794.68 198501.5,-1750.68 198698.5,-1750.68 198698.5,-1794.68"/>
<text text-anchor="middle" x="198600" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="198600" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="198600" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="198600" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert7_v_proj -->
<g id="node998" class="node">
<title>layer6_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="198483.5,-1794.68 198286.5,-1794.68 198286.5,-1750.68 198483.5,-1750.68 198483.5,-1794.68"/>
<text text-anchor="middle" x="198385" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="198385" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="198385" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="198385" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert7_attn -->
<g id="node999" class="node">
<title>layer6_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="198268.5,-1794.68 198071.5,-1794.68 198071.5,-1750.68 198268.5,-1750.68 198268.5,-1794.68"/>
<text text-anchor="middle" x="198170" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="198170" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="198170" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="198170" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer6_expert7_attn_out -->
<g id="node1000" class="node">
<title>layer6_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="198053,-1794.68 197853,-1794.68 197853,-1750.68 198053,-1750.68 198053,-1794.68"/>
<text text-anchor="middle" x="197953" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="197953" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="197953" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="197953" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert7_attn_ar -->
<g id="node1001" class="node">
<title>layer6_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="197694" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="197694" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="197694" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="197694" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="197694" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert7_attn_res -->
<g id="node1002" class="node">
<title>layer6_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="197534.2,-1816.68 197204.59,-1816.68 197119.8,-1728.68 197449.41,-1728.68 197534.2,-1816.68"/>
<text text-anchor="middle" x="197327" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="197327" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="197327" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="197327" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert7_ln1 -->
<g id="node1003" class="node">
<title>layer6_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="197102,-1794.68 196902,-1794.68 196902,-1750.68 197102,-1750.68 197102,-1794.68"/>
<text text-anchor="middle" x="197002" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="197002" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="197002" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="197002" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert7_mlp1 -->
<g id="node1004" class="node">
<title>layer6_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="196884,-1794.68 196688,-1794.68 196688,-1750.68 196884,-1750.68 196884,-1794.68"/>
<text text-anchor="middle" x="196786" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="196786" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="196786" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="196786" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert7_gelu -->
<g id="node1005" class="node">
<title>layer6_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="196670,-1794.68 196474,-1794.68 196474,-1750.68 196670,-1750.68 196670,-1794.68"/>
<text text-anchor="middle" x="196572" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="196572" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="196572" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="196572" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer6_expert7_mlp2 -->
<g id="node1006" class="node">
<title>layer6_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="196456,-1794.68 196256,-1794.68 196256,-1750.68 196456,-1750.68 196456,-1794.68"/>
<text text-anchor="middle" x="196356" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="196356" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="196356" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="196356" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert7_mlp_ar -->
<g id="node1007" class="node">
<title>layer6_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="196097" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="196097" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="196097" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="196097" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="196097" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert7_mlp_res -->
<g id="node1008" class="node">
<title>layer6_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="195937.2,-1816.68 195607.59,-1816.68 195522.8,-1728.68 195852.41,-1728.68 195937.2,-1816.68"/>
<text text-anchor="middle" x="195730" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="195730" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="195730" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="195730" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer6_expert7_ln2 -->
<g id="node1009" class="node">
<title>layer6_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="195505,-1794.68 195305,-1794.68 195305,-1750.68 195505,-1750.68 195505,-1794.68"/>
<text text-anchor="middle" x="195405" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="195405" y="-1775.28" font-family="Arial" font-size="8.00">L6_E7</text>
<text text-anchor="middle" x="195405" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="195405" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert0_route -->
<g id="node1010" class="node">
<title>layer7_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="195265,-1794.68 195065,-1794.68 195065,-1750.68 195265,-1750.68 195265,-1794.68"/>
<text text-anchor="middle" x="195165" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="195165" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="195165" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="195165" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert0_gate -->
<g id="node1011" class="node">
<title>layer7_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="195047.04,-1816.68 194732,-1816.68 194650.96,-1728.68 194966,-1728.68 195047.04,-1816.68"/>
<text text-anchor="middle" x="194849" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="194849" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="194849" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="194849" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer7_expert0_a2a -->
<g id="node1012" class="node">
<title>layer7_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="194492" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="194492" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="194492" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="194492" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="194492" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert0_attn_split -->
<g id="node1013" class="node">
<title>layer7_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="194332.48,-1816.68 194007.2,-1816.68 193923.52,-1728.68 194248.8,-1728.68 194332.48,-1816.68"/>
<text text-anchor="middle" x="194128" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="194128" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="194128" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="194128" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert0_q_proj -->
<g id="node1014" class="node">
<title>layer7_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="193905.5,-1794.68 193708.5,-1794.68 193708.5,-1750.68 193905.5,-1750.68 193905.5,-1794.68"/>
<text text-anchor="middle" x="193807" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="193807" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="193807" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="193807" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert0_k_proj -->
<g id="node1015" class="node">
<title>layer7_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="193690.5,-1794.68 193493.5,-1794.68 193493.5,-1750.68 193690.5,-1750.68 193690.5,-1794.68"/>
<text text-anchor="middle" x="193592" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="193592" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="193592" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="193592" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert0_v_proj -->
<g id="node1016" class="node">
<title>layer7_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="193475.5,-1794.68 193278.5,-1794.68 193278.5,-1750.68 193475.5,-1750.68 193475.5,-1794.68"/>
<text text-anchor="middle" x="193377" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="193377" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="193377" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="193377" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert0_attn -->
<g id="node1017" class="node">
<title>layer7_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="193260.5,-1794.68 193063.5,-1794.68 193063.5,-1750.68 193260.5,-1750.68 193260.5,-1794.68"/>
<text text-anchor="middle" x="193162" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="193162" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="193162" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="193162" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert0_attn_out -->
<g id="node1018" class="node">
<title>layer7_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="193045,-1794.68 192845,-1794.68 192845,-1750.68 193045,-1750.68 193045,-1794.68"/>
<text text-anchor="middle" x="192945" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="192945" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="192945" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="192945" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert0_attn_ar -->
<g id="node1019" class="node">
<title>layer7_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="192686" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="192686" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="192686" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="192686" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="192686" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert0_attn_res -->
<g id="node1020" class="node">
<title>layer7_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="192526.2,-1816.68 192196.59,-1816.68 192111.8,-1728.68 192441.41,-1728.68 192526.2,-1816.68"/>
<text text-anchor="middle" x="192319" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="192319" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="192319" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="192319" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert0_ln1 -->
<g id="node1021" class="node">
<title>layer7_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="192094,-1794.68 191894,-1794.68 191894,-1750.68 192094,-1750.68 192094,-1794.68"/>
<text text-anchor="middle" x="191994" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="191994" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="191994" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="191994" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert0_mlp1 -->
<g id="node1022" class="node">
<title>layer7_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="191876,-1794.68 191680,-1794.68 191680,-1750.68 191876,-1750.68 191876,-1794.68"/>
<text text-anchor="middle" x="191778" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="191778" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="191778" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="191778" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert0_gelu -->
<g id="node1023" class="node">
<title>layer7_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="191662,-1794.68 191466,-1794.68 191466,-1750.68 191662,-1750.68 191662,-1794.68"/>
<text text-anchor="middle" x="191564" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="191564" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="191564" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="191564" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert0_mlp2 -->
<g id="node1024" class="node">
<title>layer7_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="191448,-1794.68 191248,-1794.68 191248,-1750.68 191448,-1750.68 191448,-1794.68"/>
<text text-anchor="middle" x="191348" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="191348" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="191348" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="191348" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert0_mlp_ar -->
<g id="node1025" class="node">
<title>layer7_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="191089" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="191089" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="191089" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="191089" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="191089" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert0_mlp_res -->
<g id="node1026" class="node">
<title>layer7_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="190929.2,-1816.68 190599.59,-1816.68 190514.8,-1728.68 190844.41,-1728.68 190929.2,-1816.68"/>
<text text-anchor="middle" x="190722" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="190722" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="190722" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="190722" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert0_ln2 -->
<g id="node1027" class="node">
<title>layer7_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="190497,-1794.68 190297,-1794.68 190297,-1750.68 190497,-1750.68 190497,-1794.68"/>
<text text-anchor="middle" x="190397" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="190397" y="-1775.28" font-family="Arial" font-size="8.00">L7_E0</text>
<text text-anchor="middle" x="190397" y="-1766.28" font-family="Arial" font-size="8.00">GPU:16</text>
<text text-anchor="middle" x="190397" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert1_route -->
<g id="node1028" class="node">
<title>layer7_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="190273,-1794.68 190073,-1794.68 190073,-1750.68 190273,-1750.68 190273,-1794.68"/>
<text text-anchor="middle" x="190173" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="190173" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="190173" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="190173" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert1_gate -->
<g id="node1029" class="node">
<title>layer7_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="190055.04,-1816.68 189740,-1816.68 189658.96,-1728.68 189974,-1728.68 190055.04,-1816.68"/>
<text text-anchor="middle" x="189857" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="189857" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="189857" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="189857" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer7_expert1_a2a -->
<g id="node1030" class="node">
<title>layer7_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="189500" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="189500" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="189500" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="189500" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="189500" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert1_attn_split -->
<g id="node1031" class="node">
<title>layer7_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="189340.48,-1816.68 189015.2,-1816.68 188931.52,-1728.68 189256.8,-1728.68 189340.48,-1816.68"/>
<text text-anchor="middle" x="189136" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="189136" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="189136" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="189136" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert1_q_proj -->
<g id="node1032" class="node">
<title>layer7_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="188913.5,-1794.68 188716.5,-1794.68 188716.5,-1750.68 188913.5,-1750.68 188913.5,-1794.68"/>
<text text-anchor="middle" x="188815" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="188815" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="188815" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="188815" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert1_k_proj -->
<g id="node1033" class="node">
<title>layer7_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="188698.5,-1794.68 188501.5,-1794.68 188501.5,-1750.68 188698.5,-1750.68 188698.5,-1794.68"/>
<text text-anchor="middle" x="188600" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="188600" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="188600" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="188600" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert1_v_proj -->
<g id="node1034" class="node">
<title>layer7_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="188483.5,-1794.68 188286.5,-1794.68 188286.5,-1750.68 188483.5,-1750.68 188483.5,-1794.68"/>
<text text-anchor="middle" x="188385" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="188385" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="188385" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="188385" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert1_attn -->
<g id="node1035" class="node">
<title>layer7_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="188268.5,-1794.68 188071.5,-1794.68 188071.5,-1750.68 188268.5,-1750.68 188268.5,-1794.68"/>
<text text-anchor="middle" x="188170" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="188170" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="188170" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="188170" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert1_attn_out -->
<g id="node1036" class="node">
<title>layer7_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="188053,-1794.68 187853,-1794.68 187853,-1750.68 188053,-1750.68 188053,-1794.68"/>
<text text-anchor="middle" x="187953" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="187953" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="187953" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="187953" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert1_attn_ar -->
<g id="node1037" class="node">
<title>layer7_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="187694" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="187694" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="187694" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="187694" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="187694" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert1_attn_res -->
<g id="node1038" class="node">
<title>layer7_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="187534.2,-1816.68 187204.59,-1816.68 187119.8,-1728.68 187449.41,-1728.68 187534.2,-1816.68"/>
<text text-anchor="middle" x="187327" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="187327" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="187327" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="187327" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert1_ln1 -->
<g id="node1039" class="node">
<title>layer7_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="187102,-1794.68 186902,-1794.68 186902,-1750.68 187102,-1750.68 187102,-1794.68"/>
<text text-anchor="middle" x="187002" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="187002" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="187002" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="187002" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert1_mlp1 -->
<g id="node1040" class="node">
<title>layer7_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="186884,-1794.68 186688,-1794.68 186688,-1750.68 186884,-1750.68 186884,-1794.68"/>
<text text-anchor="middle" x="186786" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="186786" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="186786" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="186786" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert1_gelu -->
<g id="node1041" class="node">
<title>layer7_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="186670,-1794.68 186474,-1794.68 186474,-1750.68 186670,-1750.68 186670,-1794.68"/>
<text text-anchor="middle" x="186572" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="186572" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="186572" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="186572" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert1_mlp2 -->
<g id="node1042" class="node">
<title>layer7_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="186456,-1794.68 186256,-1794.68 186256,-1750.68 186456,-1750.68 186456,-1794.68"/>
<text text-anchor="middle" x="186356" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="186356" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="186356" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="186356" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert1_mlp_ar -->
<g id="node1043" class="node">
<title>layer7_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="186097" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="186097" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="186097" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="186097" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="186097" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert1_mlp_res -->
<g id="node1044" class="node">
<title>layer7_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="185937.2,-1816.68 185607.59,-1816.68 185522.8,-1728.68 185852.41,-1728.68 185937.2,-1816.68"/>
<text text-anchor="middle" x="185730" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="185730" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="185730" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="185730" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert1_ln2 -->
<g id="node1045" class="node">
<title>layer7_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="185505,-1794.68 185305,-1794.68 185305,-1750.68 185505,-1750.68 185505,-1794.68"/>
<text text-anchor="middle" x="185405" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="185405" y="-1775.28" font-family="Arial" font-size="8.00">L7_E1</text>
<text text-anchor="middle" x="185405" y="-1766.28" font-family="Arial" font-size="8.00">GPU:18</text>
<text text-anchor="middle" x="185405" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert2_route -->
<g id="node1046" class="node">
<title>layer7_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="185281,-1794.68 185081,-1794.68 185081,-1750.68 185281,-1750.68 185281,-1794.68"/>
<text text-anchor="middle" x="185181" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="185181" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="185181" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="185181" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert2_gate -->
<g id="node1047" class="node">
<title>layer7_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="185063.04,-1816.68 184748,-1816.68 184666.96,-1728.68 184982,-1728.68 185063.04,-1816.68"/>
<text text-anchor="middle" x="184865" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="184865" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="184865" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="184865" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer7_expert2_a2a -->
<g id="node1048" class="node">
<title>layer7_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="184508" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="184508" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="184508" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="184508" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="184508" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert2_attn_split -->
<g id="node1049" class="node">
<title>layer7_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="184348.48,-1816.68 184023.2,-1816.68 183939.52,-1728.68 184264.8,-1728.68 184348.48,-1816.68"/>
<text text-anchor="middle" x="184144" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="184144" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="184144" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="184144" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert2_q_proj -->
<g id="node1050" class="node">
<title>layer7_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="183921.5,-1794.68 183724.5,-1794.68 183724.5,-1750.68 183921.5,-1750.68 183921.5,-1794.68"/>
<text text-anchor="middle" x="183823" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="183823" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="183823" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="183823" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert2_k_proj -->
<g id="node1051" class="node">
<title>layer7_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="183706.5,-1794.68 183509.5,-1794.68 183509.5,-1750.68 183706.5,-1750.68 183706.5,-1794.68"/>
<text text-anchor="middle" x="183608" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="183608" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="183608" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="183608" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert2_v_proj -->
<g id="node1052" class="node">
<title>layer7_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="183491.5,-1794.68 183294.5,-1794.68 183294.5,-1750.68 183491.5,-1750.68 183491.5,-1794.68"/>
<text text-anchor="middle" x="183393" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="183393" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="183393" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="183393" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert2_attn -->
<g id="node1053" class="node">
<title>layer7_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="183276.5,-1794.68 183079.5,-1794.68 183079.5,-1750.68 183276.5,-1750.68 183276.5,-1794.68"/>
<text text-anchor="middle" x="183178" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="183178" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="183178" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="183178" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert2_attn_out -->
<g id="node1054" class="node">
<title>layer7_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="183061,-1794.68 182861,-1794.68 182861,-1750.68 183061,-1750.68 183061,-1794.68"/>
<text text-anchor="middle" x="182961" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="182961" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="182961" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="182961" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert2_attn_ar -->
<g id="node1055" class="node">
<title>layer7_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="182702" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="182702" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="182702" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="182702" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="182702" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert2_attn_res -->
<g id="node1056" class="node">
<title>layer7_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="182542.2,-1816.68 182212.59,-1816.68 182127.8,-1728.68 182457.41,-1728.68 182542.2,-1816.68"/>
<text text-anchor="middle" x="182335" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="182335" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="182335" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="182335" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert2_ln1 -->
<g id="node1057" class="node">
<title>layer7_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="182110,-1794.68 181910,-1794.68 181910,-1750.68 182110,-1750.68 182110,-1794.68"/>
<text text-anchor="middle" x="182010" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="182010" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="182010" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="182010" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert2_mlp1 -->
<g id="node1058" class="node">
<title>layer7_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="181892,-1794.68 181696,-1794.68 181696,-1750.68 181892,-1750.68 181892,-1794.68"/>
<text text-anchor="middle" x="181794" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="181794" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="181794" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="181794" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert2_gelu -->
<g id="node1059" class="node">
<title>layer7_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="181678,-1794.68 181482,-1794.68 181482,-1750.68 181678,-1750.68 181678,-1794.68"/>
<text text-anchor="middle" x="181580" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="181580" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="181580" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="181580" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert2_mlp2 -->
<g id="node1060" class="node">
<title>layer7_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="181464,-1794.68 181264,-1794.68 181264,-1750.68 181464,-1750.68 181464,-1794.68"/>
<text text-anchor="middle" x="181364" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="181364" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="181364" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="181364" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert2_mlp_ar -->
<g id="node1061" class="node">
<title>layer7_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="181105" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="181105" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="181105" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="181105" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="181105" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert2_mlp_res -->
<g id="node1062" class="node">
<title>layer7_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="180945.2,-1816.68 180615.59,-1816.68 180530.8,-1728.68 180860.41,-1728.68 180945.2,-1816.68"/>
<text text-anchor="middle" x="180738" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="180738" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="180738" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="180738" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert2_ln2 -->
<g id="node1063" class="node">
<title>layer7_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="180513,-1794.68 180313,-1794.68 180313,-1750.68 180513,-1750.68 180513,-1794.68"/>
<text text-anchor="middle" x="180413" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="180413" y="-1775.28" font-family="Arial" font-size="8.00">L7_E2</text>
<text text-anchor="middle" x="180413" y="-1766.28" font-family="Arial" font-size="8.00">GPU:20</text>
<text text-anchor="middle" x="180413" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert3_route -->
<g id="node1064" class="node">
<title>layer7_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="180289,-1794.68 180089,-1794.68 180089,-1750.68 180289,-1750.68 180289,-1794.68"/>
<text text-anchor="middle" x="180189" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="180189" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="180189" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="180189" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert3_gate -->
<g id="node1065" class="node">
<title>layer7_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="180071.04,-1816.68 179756,-1816.68 179674.96,-1728.68 179990,-1728.68 180071.04,-1816.68"/>
<text text-anchor="middle" x="179873" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="179873" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="179873" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="179873" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer7_expert3_a2a -->
<g id="node1066" class="node">
<title>layer7_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="179516" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="179516" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="179516" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="179516" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="179516" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert3_attn_split -->
<g id="node1067" class="node">
<title>layer7_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="179356.48,-1816.68 179031.2,-1816.68 178947.52,-1728.68 179272.8,-1728.68 179356.48,-1816.68"/>
<text text-anchor="middle" x="179152" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="179152" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="179152" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="179152" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert3_q_proj -->
<g id="node1068" class="node">
<title>layer7_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="178929.5,-1794.68 178732.5,-1794.68 178732.5,-1750.68 178929.5,-1750.68 178929.5,-1794.68"/>
<text text-anchor="middle" x="178831" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="178831" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="178831" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="178831" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert3_k_proj -->
<g id="node1069" class="node">
<title>layer7_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="178714.5,-1794.68 178517.5,-1794.68 178517.5,-1750.68 178714.5,-1750.68 178714.5,-1794.68"/>
<text text-anchor="middle" x="178616" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="178616" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="178616" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="178616" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert3_v_proj -->
<g id="node1070" class="node">
<title>layer7_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="178499.5,-1794.68 178302.5,-1794.68 178302.5,-1750.68 178499.5,-1750.68 178499.5,-1794.68"/>
<text text-anchor="middle" x="178401" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="178401" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="178401" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="178401" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert3_attn -->
<g id="node1071" class="node">
<title>layer7_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="178284.5,-1794.68 178087.5,-1794.68 178087.5,-1750.68 178284.5,-1750.68 178284.5,-1794.68"/>
<text text-anchor="middle" x="178186" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="178186" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="178186" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="178186" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert3_attn_out -->
<g id="node1072" class="node">
<title>layer7_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="178069,-1794.68 177869,-1794.68 177869,-1750.68 178069,-1750.68 178069,-1794.68"/>
<text text-anchor="middle" x="177969" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="177969" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="177969" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="177969" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert3_attn_ar -->
<g id="node1073" class="node">
<title>layer7_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="177710" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="177710" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="177710" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="177710" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="177710" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert3_attn_res -->
<g id="node1074" class="node">
<title>layer7_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="177550.2,-1816.68 177220.59,-1816.68 177135.8,-1728.68 177465.41,-1728.68 177550.2,-1816.68"/>
<text text-anchor="middle" x="177343" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="177343" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="177343" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="177343" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert3_ln1 -->
<g id="node1075" class="node">
<title>layer7_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="177118,-1794.68 176918,-1794.68 176918,-1750.68 177118,-1750.68 177118,-1794.68"/>
<text text-anchor="middle" x="177018" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="177018" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="177018" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="177018" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert3_mlp1 -->
<g id="node1076" class="node">
<title>layer7_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="176900,-1794.68 176704,-1794.68 176704,-1750.68 176900,-1750.68 176900,-1794.68"/>
<text text-anchor="middle" x="176802" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="176802" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="176802" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="176802" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert3_gelu -->
<g id="node1077" class="node">
<title>layer7_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="176686,-1794.68 176490,-1794.68 176490,-1750.68 176686,-1750.68 176686,-1794.68"/>
<text text-anchor="middle" x="176588" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="176588" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="176588" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="176588" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert3_mlp2 -->
<g id="node1078" class="node">
<title>layer7_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="176472,-1794.68 176272,-1794.68 176272,-1750.68 176472,-1750.68 176472,-1794.68"/>
<text text-anchor="middle" x="176372" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="176372" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="176372" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="176372" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert3_mlp_ar -->
<g id="node1079" class="node">
<title>layer7_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="176113" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="176113" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="176113" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="176113" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="176113" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert3_mlp_res -->
<g id="node1080" class="node">
<title>layer7_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="175953.2,-1816.68 175623.59,-1816.68 175538.8,-1728.68 175868.41,-1728.68 175953.2,-1816.68"/>
<text text-anchor="middle" x="175746" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="175746" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="175746" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="175746" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert3_ln2 -->
<g id="node1081" class="node">
<title>layer7_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="175521,-1794.68 175321,-1794.68 175321,-1750.68 175521,-1750.68 175521,-1794.68"/>
<text text-anchor="middle" x="175421" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="175421" y="-1775.28" font-family="Arial" font-size="8.00">L7_E3</text>
<text text-anchor="middle" x="175421" y="-1766.28" font-family="Arial" font-size="8.00">GPU:22</text>
<text text-anchor="middle" x="175421" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert4_route -->
<g id="node1082" class="node">
<title>layer7_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="175297,-1794.68 175097,-1794.68 175097,-1750.68 175297,-1750.68 175297,-1794.68"/>
<text text-anchor="middle" x="175197" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="175197" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="175197" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="175197" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert4_gate -->
<g id="node1083" class="node">
<title>layer7_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="175079.04,-1816.68 174764,-1816.68 174682.96,-1728.68 174998,-1728.68 175079.04,-1816.68"/>
<text text-anchor="middle" x="174881" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="174881" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="174881" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="174881" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer7_expert4_a2a -->
<g id="node1084" class="node">
<title>layer7_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="174524" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="174524" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="174524" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="174524" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="174524" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert4_attn_split -->
<g id="node1085" class="node">
<title>layer7_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="174364.48,-1816.68 174039.2,-1816.68 173955.52,-1728.68 174280.8,-1728.68 174364.48,-1816.68"/>
<text text-anchor="middle" x="174160" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="174160" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="174160" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="174160" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert4_q_proj -->
<g id="node1086" class="node">
<title>layer7_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="173937.5,-1794.68 173740.5,-1794.68 173740.5,-1750.68 173937.5,-1750.68 173937.5,-1794.68"/>
<text text-anchor="middle" x="173839" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="173839" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="173839" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="173839" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert4_k_proj -->
<g id="node1087" class="node">
<title>layer7_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="173722.5,-1794.68 173525.5,-1794.68 173525.5,-1750.68 173722.5,-1750.68 173722.5,-1794.68"/>
<text text-anchor="middle" x="173624" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="173624" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="173624" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="173624" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert4_v_proj -->
<g id="node1088" class="node">
<title>layer7_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="173507.5,-1794.68 173310.5,-1794.68 173310.5,-1750.68 173507.5,-1750.68 173507.5,-1794.68"/>
<text text-anchor="middle" x="173409" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="173409" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="173409" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="173409" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert4_attn -->
<g id="node1089" class="node">
<title>layer7_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="173292.5,-1794.68 173095.5,-1794.68 173095.5,-1750.68 173292.5,-1750.68 173292.5,-1794.68"/>
<text text-anchor="middle" x="173194" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="173194" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="173194" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="173194" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert4_attn_out -->
<g id="node1090" class="node">
<title>layer7_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="173077,-1794.68 172877,-1794.68 172877,-1750.68 173077,-1750.68 173077,-1794.68"/>
<text text-anchor="middle" x="172977" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="172977" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="172977" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="172977" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert4_attn_ar -->
<g id="node1091" class="node">
<title>layer7_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="172718" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="172718" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="172718" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="172718" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="172718" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert4_attn_res -->
<g id="node1092" class="node">
<title>layer7_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="172558.2,-1816.68 172228.59,-1816.68 172143.8,-1728.68 172473.41,-1728.68 172558.2,-1816.68"/>
<text text-anchor="middle" x="172351" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="172351" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="172351" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="172351" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert4_ln1 -->
<g id="node1093" class="node">
<title>layer7_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="172126,-1794.68 171926,-1794.68 171926,-1750.68 172126,-1750.68 172126,-1794.68"/>
<text text-anchor="middle" x="172026" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="172026" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="172026" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="172026" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert4_mlp1 -->
<g id="node1094" class="node">
<title>layer7_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="171908,-1794.68 171712,-1794.68 171712,-1750.68 171908,-1750.68 171908,-1794.68"/>
<text text-anchor="middle" x="171810" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="171810" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="171810" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="171810" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert4_gelu -->
<g id="node1095" class="node">
<title>layer7_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="171694,-1794.68 171498,-1794.68 171498,-1750.68 171694,-1750.68 171694,-1794.68"/>
<text text-anchor="middle" x="171596" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="171596" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="171596" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="171596" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert4_mlp2 -->
<g id="node1096" class="node">
<title>layer7_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="171480,-1794.68 171280,-1794.68 171280,-1750.68 171480,-1750.68 171480,-1794.68"/>
<text text-anchor="middle" x="171380" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="171380" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="171380" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="171380" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert4_mlp_ar -->
<g id="node1097" class="node">
<title>layer7_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="171121" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="171121" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="171121" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="171121" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="171121" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert4_mlp_res -->
<g id="node1098" class="node">
<title>layer7_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="170961.2,-1816.68 170631.59,-1816.68 170546.8,-1728.68 170876.41,-1728.68 170961.2,-1816.68"/>
<text text-anchor="middle" x="170754" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="170754" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="170754" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="170754" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert4_ln2 -->
<g id="node1099" class="node">
<title>layer7_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="170529,-1794.68 170329,-1794.68 170329,-1750.68 170529,-1750.68 170529,-1794.68"/>
<text text-anchor="middle" x="170429" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="170429" y="-1775.28" font-family="Arial" font-size="8.00">L7_E4</text>
<text text-anchor="middle" x="170429" y="-1766.28" font-family="Arial" font-size="8.00">GPU:24</text>
<text text-anchor="middle" x="170429" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert5_route -->
<g id="node1100" class="node">
<title>layer7_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="170305,-1794.68 170105,-1794.68 170105,-1750.68 170305,-1750.68 170305,-1794.68"/>
<text text-anchor="middle" x="170205" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="170205" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="170205" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="170205" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert5_gate -->
<g id="node1101" class="node">
<title>layer7_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="170087.04,-1816.68 169772,-1816.68 169690.96,-1728.68 170006,-1728.68 170087.04,-1816.68"/>
<text text-anchor="middle" x="169889" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="169889" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="169889" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="169889" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer7_expert5_a2a -->
<g id="node1102" class="node">
<title>layer7_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="169532" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="169532" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="169532" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="169532" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="169532" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert5_attn_split -->
<g id="node1103" class="node">
<title>layer7_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="169372.48,-1816.68 169047.2,-1816.68 168963.52,-1728.68 169288.8,-1728.68 169372.48,-1816.68"/>
<text text-anchor="middle" x="169168" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="169168" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="169168" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="169168" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert5_q_proj -->
<g id="node1104" class="node">
<title>layer7_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="168945.5,-1794.68 168748.5,-1794.68 168748.5,-1750.68 168945.5,-1750.68 168945.5,-1794.68"/>
<text text-anchor="middle" x="168847" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="168847" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="168847" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="168847" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert5_k_proj -->
<g id="node1105" class="node">
<title>layer7_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="168730.5,-1794.68 168533.5,-1794.68 168533.5,-1750.68 168730.5,-1750.68 168730.5,-1794.68"/>
<text text-anchor="middle" x="168632" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="168632" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="168632" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="168632" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert5_v_proj -->
<g id="node1106" class="node">
<title>layer7_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="168515.5,-1794.68 168318.5,-1794.68 168318.5,-1750.68 168515.5,-1750.68 168515.5,-1794.68"/>
<text text-anchor="middle" x="168417" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="168417" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="168417" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="168417" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert5_attn -->
<g id="node1107" class="node">
<title>layer7_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="168300.5,-1794.68 168103.5,-1794.68 168103.5,-1750.68 168300.5,-1750.68 168300.5,-1794.68"/>
<text text-anchor="middle" x="168202" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="168202" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="168202" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="168202" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert5_attn_out -->
<g id="node1108" class="node">
<title>layer7_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="168085,-1794.68 167885,-1794.68 167885,-1750.68 168085,-1750.68 168085,-1794.68"/>
<text text-anchor="middle" x="167985" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="167985" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="167985" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="167985" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert5_attn_ar -->
<g id="node1109" class="node">
<title>layer7_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="167726" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="167726" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="167726" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="167726" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="167726" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert5_attn_res -->
<g id="node1110" class="node">
<title>layer7_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="167566.2,-1816.68 167236.59,-1816.68 167151.8,-1728.68 167481.41,-1728.68 167566.2,-1816.68"/>
<text text-anchor="middle" x="167359" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="167359" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="167359" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="167359" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert5_ln1 -->
<g id="node1111" class="node">
<title>layer7_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="167134,-1794.68 166934,-1794.68 166934,-1750.68 167134,-1750.68 167134,-1794.68"/>
<text text-anchor="middle" x="167034" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="167034" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="167034" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="167034" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert5_mlp1 -->
<g id="node1112" class="node">
<title>layer7_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="166916,-1794.68 166720,-1794.68 166720,-1750.68 166916,-1750.68 166916,-1794.68"/>
<text text-anchor="middle" x="166818" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="166818" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="166818" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="166818" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert5_gelu -->
<g id="node1113" class="node">
<title>layer7_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="166702,-1794.68 166506,-1794.68 166506,-1750.68 166702,-1750.68 166702,-1794.68"/>
<text text-anchor="middle" x="166604" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="166604" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="166604" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="166604" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert5_mlp2 -->
<g id="node1114" class="node">
<title>layer7_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="166488,-1794.68 166288,-1794.68 166288,-1750.68 166488,-1750.68 166488,-1794.68"/>
<text text-anchor="middle" x="166388" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="166388" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="166388" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="166388" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert5_mlp_ar -->
<g id="node1115" class="node">
<title>layer7_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="166129" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="166129" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="166129" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="166129" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="166129" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert5_mlp_res -->
<g id="node1116" class="node">
<title>layer7_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="165969.2,-1816.68 165639.59,-1816.68 165554.8,-1728.68 165884.41,-1728.68 165969.2,-1816.68"/>
<text text-anchor="middle" x="165762" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="165762" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="165762" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="165762" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert5_ln2 -->
<g id="node1117" class="node">
<title>layer7_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="165537,-1794.68 165337,-1794.68 165337,-1750.68 165537,-1750.68 165537,-1794.68"/>
<text text-anchor="middle" x="165437" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="165437" y="-1775.28" font-family="Arial" font-size="8.00">L7_E5</text>
<text text-anchor="middle" x="165437" y="-1766.28" font-family="Arial" font-size="8.00">GPU:26</text>
<text text-anchor="middle" x="165437" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert6_route -->
<g id="node1118" class="node">
<title>layer7_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="165313,-1794.68 165113,-1794.68 165113,-1750.68 165313,-1750.68 165313,-1794.68"/>
<text text-anchor="middle" x="165213" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="165213" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="165213" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="165213" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert6_gate -->
<g id="node1119" class="node">
<title>layer7_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="165095.04,-1816.68 164780,-1816.68 164698.96,-1728.68 165014,-1728.68 165095.04,-1816.68"/>
<text text-anchor="middle" x="164897" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="164897" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="164897" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="164897" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer7_expert6_a2a -->
<g id="node1120" class="node">
<title>layer7_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="164540" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="164540" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="164540" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="164540" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="164540" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert6_attn_split -->
<g id="node1121" class="node">
<title>layer7_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="164380.48,-1816.68 164055.2,-1816.68 163971.52,-1728.68 164296.8,-1728.68 164380.48,-1816.68"/>
<text text-anchor="middle" x="164176" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="164176" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="164176" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="164176" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert6_q_proj -->
<g id="node1122" class="node">
<title>layer7_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="163953.5,-1794.68 163756.5,-1794.68 163756.5,-1750.68 163953.5,-1750.68 163953.5,-1794.68"/>
<text text-anchor="middle" x="163855" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="163855" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="163855" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="163855" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert6_k_proj -->
<g id="node1123" class="node">
<title>layer7_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="163738.5,-1794.68 163541.5,-1794.68 163541.5,-1750.68 163738.5,-1750.68 163738.5,-1794.68"/>
<text text-anchor="middle" x="163640" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="163640" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="163640" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="163640" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert6_v_proj -->
<g id="node1124" class="node">
<title>layer7_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="163523.5,-1794.68 163326.5,-1794.68 163326.5,-1750.68 163523.5,-1750.68 163523.5,-1794.68"/>
<text text-anchor="middle" x="163425" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="163425" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="163425" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="163425" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert6_attn -->
<g id="node1125" class="node">
<title>layer7_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="163308.5,-1794.68 163111.5,-1794.68 163111.5,-1750.68 163308.5,-1750.68 163308.5,-1794.68"/>
<text text-anchor="middle" x="163210" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="163210" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="163210" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="163210" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert6_attn_out -->
<g id="node1126" class="node">
<title>layer7_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="163093,-1794.68 162893,-1794.68 162893,-1750.68 163093,-1750.68 163093,-1794.68"/>
<text text-anchor="middle" x="162993" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="162993" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="162993" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="162993" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert6_attn_ar -->
<g id="node1127" class="node">
<title>layer7_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="162734" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="162734" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="162734" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="162734" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="162734" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert6_attn_res -->
<g id="node1128" class="node">
<title>layer7_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="162574.2,-1816.68 162244.59,-1816.68 162159.8,-1728.68 162489.41,-1728.68 162574.2,-1816.68"/>
<text text-anchor="middle" x="162367" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="162367" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="162367" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="162367" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert6_ln1 -->
<g id="node1129" class="node">
<title>layer7_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="162142,-1794.68 161942,-1794.68 161942,-1750.68 162142,-1750.68 162142,-1794.68"/>
<text text-anchor="middle" x="162042" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="162042" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="162042" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="162042" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert6_mlp1 -->
<g id="node1130" class="node">
<title>layer7_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="161924,-1794.68 161728,-1794.68 161728,-1750.68 161924,-1750.68 161924,-1794.68"/>
<text text-anchor="middle" x="161826" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="161826" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="161826" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="161826" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert6_gelu -->
<g id="node1131" class="node">
<title>layer7_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="161710,-1794.68 161514,-1794.68 161514,-1750.68 161710,-1750.68 161710,-1794.68"/>
<text text-anchor="middle" x="161612" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="161612" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="161612" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="161612" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert6_mlp2 -->
<g id="node1132" class="node">
<title>layer7_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="161496,-1794.68 161296,-1794.68 161296,-1750.68 161496,-1750.68 161496,-1794.68"/>
<text text-anchor="middle" x="161396" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="161396" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="161396" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="161396" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert6_mlp_ar -->
<g id="node1133" class="node">
<title>layer7_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="161137" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="161137" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="161137" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="161137" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="161137" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert6_mlp_res -->
<g id="node1134" class="node">
<title>layer7_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="160977.2,-1816.68 160647.59,-1816.68 160562.8,-1728.68 160892.41,-1728.68 160977.2,-1816.68"/>
<text text-anchor="middle" x="160770" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="160770" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="160770" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="160770" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert6_ln2 -->
<g id="node1135" class="node">
<title>layer7_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="160545,-1794.68 160345,-1794.68 160345,-1750.68 160545,-1750.68 160545,-1794.68"/>
<text text-anchor="middle" x="160445" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="160445" y="-1775.28" font-family="Arial" font-size="8.00">L7_E6</text>
<text text-anchor="middle" x="160445" y="-1766.28" font-family="Arial" font-size="8.00">GPU:28</text>
<text text-anchor="middle" x="160445" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert7_route -->
<g id="node1136" class="node">
<title>layer7_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="160321,-1794.68 160121,-1794.68 160121,-1750.68 160321,-1750.68 160321,-1794.68"/>
<text text-anchor="middle" x="160221" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="160221" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="160221" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="160221" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert7_gate -->
<g id="node1137" class="node">
<title>layer7_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="160103.04,-1816.68 159788,-1816.68 159706.96,-1728.68 160022,-1728.68 160103.04,-1816.68"/>
<text text-anchor="middle" x="159905" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="159905" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="159905" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="159905" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer7_expert7_a2a -->
<g id="node1138" class="node">
<title>layer7_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="159548" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="159548" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="159548" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="159548" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="159548" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert7_attn_split -->
<g id="node1139" class="node">
<title>layer7_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="159388.48,-1816.68 159063.2,-1816.68 158979.52,-1728.68 159304.8,-1728.68 159388.48,-1816.68"/>
<text text-anchor="middle" x="159184" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="159184" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="159184" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="159184" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert7_q_proj -->
<g id="node1140" class="node">
<title>layer7_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="158961.5,-1794.68 158764.5,-1794.68 158764.5,-1750.68 158961.5,-1750.68 158961.5,-1794.68"/>
<text text-anchor="middle" x="158863" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="158863" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="158863" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="158863" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert7_k_proj -->
<g id="node1141" class="node">
<title>layer7_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="158746.5,-1794.68 158549.5,-1794.68 158549.5,-1750.68 158746.5,-1750.68 158746.5,-1794.68"/>
<text text-anchor="middle" x="158648" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="158648" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="158648" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="158648" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert7_v_proj -->
<g id="node1142" class="node">
<title>layer7_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="158531.5,-1794.68 158334.5,-1794.68 158334.5,-1750.68 158531.5,-1750.68 158531.5,-1794.68"/>
<text text-anchor="middle" x="158433" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="158433" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="158433" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="158433" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert7_attn -->
<g id="node1143" class="node">
<title>layer7_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="158316.5,-1794.68 158119.5,-1794.68 158119.5,-1750.68 158316.5,-1750.68 158316.5,-1794.68"/>
<text text-anchor="middle" x="158218" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="158218" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="158218" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="158218" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer7_expert7_attn_out -->
<g id="node1144" class="node">
<title>layer7_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="158101,-1794.68 157901,-1794.68 157901,-1750.68 158101,-1750.68 158101,-1794.68"/>
<text text-anchor="middle" x="158001" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="158001" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="158001" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="158001" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert7_attn_ar -->
<g id="node1145" class="node">
<title>layer7_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="157742" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="157742" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="157742" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="157742" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="157742" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert7_attn_res -->
<g id="node1146" class="node">
<title>layer7_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="157582.2,-1816.68 157252.59,-1816.68 157167.8,-1728.68 157497.41,-1728.68 157582.2,-1816.68"/>
<text text-anchor="middle" x="157375" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="157375" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="157375" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="157375" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert7_ln1 -->
<g id="node1147" class="node">
<title>layer7_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="157150,-1794.68 156950,-1794.68 156950,-1750.68 157150,-1750.68 157150,-1794.68"/>
<text text-anchor="middle" x="157050" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="157050" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="157050" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="157050" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert7_mlp1 -->
<g id="node1148" class="node">
<title>layer7_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="156932,-1794.68 156736,-1794.68 156736,-1750.68 156932,-1750.68 156932,-1794.68"/>
<text text-anchor="middle" x="156834" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="156834" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="156834" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="156834" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert7_gelu -->
<g id="node1149" class="node">
<title>layer7_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="156718,-1794.68 156522,-1794.68 156522,-1750.68 156718,-1750.68 156718,-1794.68"/>
<text text-anchor="middle" x="156620" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="156620" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="156620" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="156620" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer7_expert7_mlp2 -->
<g id="node1150" class="node">
<title>layer7_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="156504,-1794.68 156304,-1794.68 156304,-1750.68 156504,-1750.68 156504,-1794.68"/>
<text text-anchor="middle" x="156404" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="156404" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="156404" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="156404" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert7_mlp_ar -->
<g id="node1151" class="node">
<title>layer7_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="156145" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="156145" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="156145" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="156145" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="156145" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert7_mlp_res -->
<g id="node1152" class="node">
<title>layer7_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="155985.2,-1816.68 155655.59,-1816.68 155570.8,-1728.68 155900.41,-1728.68 155985.2,-1816.68"/>
<text text-anchor="middle" x="155778" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="155778" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="155778" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="155778" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer7_expert7_ln2 -->
<g id="node1153" class="node">
<title>layer7_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="155553,-1794.68 155353,-1794.68 155353,-1750.68 155553,-1750.68 155553,-1794.68"/>
<text text-anchor="middle" x="155453" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="155453" y="-1775.28" font-family="Arial" font-size="8.00">L7_E7</text>
<text text-anchor="middle" x="155453" y="-1766.28" font-family="Arial" font-size="8.00">GPU:30</text>
<text text-anchor="middle" x="155453" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert0_route -->
<g id="node1154" class="node">
<title>layer8_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="474945,-1794.68 474745,-1794.68 474745,-1750.68 474945,-1750.68 474945,-1794.68"/>
<text text-anchor="middle" x="474845" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="474845" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="474845" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="474845" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert0_gate -->
<g id="node1155" class="node">
<title>layer8_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="474727.04,-1816.68 474412,-1816.68 474330.96,-1728.68 474646,-1728.68 474727.04,-1816.68"/>
<text text-anchor="middle" x="474529" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="474529" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="474529" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="474529" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer8_expert0_a2a -->
<g id="node1156" class="node">
<title>layer8_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="474172" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="474172" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="474172" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="474172" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="474172" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert0_attn_split -->
<g id="node1157" class="node">
<title>layer8_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="474012.48,-1816.68 473687.2,-1816.68 473603.52,-1728.68 473928.8,-1728.68 474012.48,-1816.68"/>
<text text-anchor="middle" x="473808" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="473808" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="473808" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="473808" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert0_q_proj -->
<g id="node1158" class="node">
<title>layer8_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="473585.5,-1794.68 473388.5,-1794.68 473388.5,-1750.68 473585.5,-1750.68 473585.5,-1794.68"/>
<text text-anchor="middle" x="473487" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="473487" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="473487" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="473487" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert0_k_proj -->
<g id="node1159" class="node">
<title>layer8_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="473370.5,-1794.68 473173.5,-1794.68 473173.5,-1750.68 473370.5,-1750.68 473370.5,-1794.68"/>
<text text-anchor="middle" x="473272" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="473272" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="473272" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="473272" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert0_v_proj -->
<g id="node1160" class="node">
<title>layer8_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="473155.5,-1794.68 472958.5,-1794.68 472958.5,-1750.68 473155.5,-1750.68 473155.5,-1794.68"/>
<text text-anchor="middle" x="473057" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="473057" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="473057" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="473057" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert0_attn -->
<g id="node1161" class="node">
<title>layer8_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="472940.5,-1794.68 472743.5,-1794.68 472743.5,-1750.68 472940.5,-1750.68 472940.5,-1794.68"/>
<text text-anchor="middle" x="472842" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="472842" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="472842" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="472842" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert0_attn_out -->
<g id="node1162" class="node">
<title>layer8_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="472725,-1794.68 472525,-1794.68 472525,-1750.68 472725,-1750.68 472725,-1794.68"/>
<text text-anchor="middle" x="472625" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="472625" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="472625" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="472625" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert0_attn_ar -->
<g id="node1163" class="node">
<title>layer8_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="472366" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="472366" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="472366" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="472366" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="472366" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert0_attn_res -->
<g id="node1164" class="node">
<title>layer8_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="472206.2,-1816.68 471876.59,-1816.68 471791.8,-1728.68 472121.41,-1728.68 472206.2,-1816.68"/>
<text text-anchor="middle" x="471999" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="471999" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="471999" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="471999" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert0_ln1 -->
<g id="node1165" class="node">
<title>layer8_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="471774,-1794.68 471574,-1794.68 471574,-1750.68 471774,-1750.68 471774,-1794.68"/>
<text text-anchor="middle" x="471674" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="471674" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="471674" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="471674" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert0_mlp1 -->
<g id="node1166" class="node">
<title>layer8_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="471556,-1794.68 471360,-1794.68 471360,-1750.68 471556,-1750.68 471556,-1794.68"/>
<text text-anchor="middle" x="471458" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="471458" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="471458" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="471458" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert0_gelu -->
<g id="node1167" class="node">
<title>layer8_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="471342,-1794.68 471146,-1794.68 471146,-1750.68 471342,-1750.68 471342,-1794.68"/>
<text text-anchor="middle" x="471244" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="471244" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="471244" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="471244" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert0_mlp2 -->
<g id="node1168" class="node">
<title>layer8_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="471128,-1794.68 470928,-1794.68 470928,-1750.68 471128,-1750.68 471128,-1794.68"/>
<text text-anchor="middle" x="471028" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="471028" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="471028" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="471028" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert0_mlp_ar -->
<g id="node1169" class="node">
<title>layer8_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="470769" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="470769" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="470769" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="470769" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="470769" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert0_mlp_res -->
<g id="node1170" class="node">
<title>layer8_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="470609.2,-1816.68 470279.59,-1816.68 470194.8,-1728.68 470524.41,-1728.68 470609.2,-1816.68"/>
<text text-anchor="middle" x="470402" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="470402" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="470402" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="470402" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert0_ln2 -->
<g id="node1171" class="node">
<title>layer8_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="470177,-1794.68 469977,-1794.68 469977,-1750.68 470177,-1750.68 470177,-1794.68"/>
<text text-anchor="middle" x="470077" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="470077" y="-1775.28" font-family="Arial" font-size="8.00">L8_E0</text>
<text text-anchor="middle" x="470077" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="470077" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert1_route -->
<g id="node1172" class="node">
<title>layer8_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="469953,-1794.68 469753,-1794.68 469753,-1750.68 469953,-1750.68 469953,-1794.68"/>
<text text-anchor="middle" x="469853" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="469853" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="469853" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="469853" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert1_gate -->
<g id="node1173" class="node">
<title>layer8_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="469735.04,-1816.68 469420,-1816.68 469338.96,-1728.68 469654,-1728.68 469735.04,-1816.68"/>
<text text-anchor="middle" x="469537" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="469537" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="469537" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="469537" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer8_expert1_a2a -->
<g id="node1174" class="node">
<title>layer8_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="469180" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="469180" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="469180" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="469180" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="469180" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert1_attn_split -->
<g id="node1175" class="node">
<title>layer8_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="469020.48,-1816.68 468695.2,-1816.68 468611.52,-1728.68 468936.8,-1728.68 469020.48,-1816.68"/>
<text text-anchor="middle" x="468816" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="468816" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="468816" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="468816" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert1_q_proj -->
<g id="node1176" class="node">
<title>layer8_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="468593.5,-1794.68 468396.5,-1794.68 468396.5,-1750.68 468593.5,-1750.68 468593.5,-1794.68"/>
<text text-anchor="middle" x="468495" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="468495" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="468495" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="468495" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert1_k_proj -->
<g id="node1177" class="node">
<title>layer8_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="468378.5,-1794.68 468181.5,-1794.68 468181.5,-1750.68 468378.5,-1750.68 468378.5,-1794.68"/>
<text text-anchor="middle" x="468280" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="468280" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="468280" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="468280" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert1_v_proj -->
<g id="node1178" class="node">
<title>layer8_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="468163.5,-1794.68 467966.5,-1794.68 467966.5,-1750.68 468163.5,-1750.68 468163.5,-1794.68"/>
<text text-anchor="middle" x="468065" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="468065" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="468065" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="468065" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert1_attn -->
<g id="node1179" class="node">
<title>layer8_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="467948.5,-1794.68 467751.5,-1794.68 467751.5,-1750.68 467948.5,-1750.68 467948.5,-1794.68"/>
<text text-anchor="middle" x="467850" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="467850" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="467850" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="467850" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert1_attn_out -->
<g id="node1180" class="node">
<title>layer8_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="467733,-1794.68 467533,-1794.68 467533,-1750.68 467733,-1750.68 467733,-1794.68"/>
<text text-anchor="middle" x="467633" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="467633" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="467633" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="467633" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert1_attn_ar -->
<g id="node1181" class="node">
<title>layer8_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="467374" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="467374" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="467374" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="467374" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="467374" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert1_attn_res -->
<g id="node1182" class="node">
<title>layer8_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="467214.2,-1816.68 466884.59,-1816.68 466799.8,-1728.68 467129.41,-1728.68 467214.2,-1816.68"/>
<text text-anchor="middle" x="467007" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="467007" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="467007" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="467007" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert1_ln1 -->
<g id="node1183" class="node">
<title>layer8_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="466782,-1794.68 466582,-1794.68 466582,-1750.68 466782,-1750.68 466782,-1794.68"/>
<text text-anchor="middle" x="466682" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="466682" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="466682" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="466682" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert1_mlp1 -->
<g id="node1184" class="node">
<title>layer8_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="466564,-1794.68 466368,-1794.68 466368,-1750.68 466564,-1750.68 466564,-1794.68"/>
<text text-anchor="middle" x="466466" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="466466" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="466466" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="466466" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert1_gelu -->
<g id="node1185" class="node">
<title>layer8_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="466350,-1794.68 466154,-1794.68 466154,-1750.68 466350,-1750.68 466350,-1794.68"/>
<text text-anchor="middle" x="466252" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="466252" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="466252" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="466252" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert1_mlp2 -->
<g id="node1186" class="node">
<title>layer8_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="466136,-1794.68 465936,-1794.68 465936,-1750.68 466136,-1750.68 466136,-1794.68"/>
<text text-anchor="middle" x="466036" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="466036" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="466036" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="466036" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert1_mlp_ar -->
<g id="node1187" class="node">
<title>layer8_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="465777" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="465777" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="465777" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="465777" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="465777" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert1_mlp_res -->
<g id="node1188" class="node">
<title>layer8_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="465617.2,-1816.68 465287.59,-1816.68 465202.8,-1728.68 465532.41,-1728.68 465617.2,-1816.68"/>
<text text-anchor="middle" x="465410" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="465410" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="465410" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="465410" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert1_ln2 -->
<g id="node1189" class="node">
<title>layer8_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="465185,-1794.68 464985,-1794.68 464985,-1750.68 465185,-1750.68 465185,-1794.68"/>
<text text-anchor="middle" x="465085" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="465085" y="-1775.28" font-family="Arial" font-size="8.00">L8_E1</text>
<text text-anchor="middle" x="465085" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="465085" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert2_route -->
<g id="node1190" class="node">
<title>layer8_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="464961,-1794.68 464761,-1794.68 464761,-1750.68 464961,-1750.68 464961,-1794.68"/>
<text text-anchor="middle" x="464861" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="464861" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="464861" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="464861" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert2_gate -->
<g id="node1191" class="node">
<title>layer8_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="464743.04,-1816.68 464428,-1816.68 464346.96,-1728.68 464662,-1728.68 464743.04,-1816.68"/>
<text text-anchor="middle" x="464545" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="464545" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="464545" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="464545" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer8_expert2_a2a -->
<g id="node1192" class="node">
<title>layer8_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="464188" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="464188" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="464188" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="464188" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="464188" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert2_attn_split -->
<g id="node1193" class="node">
<title>layer8_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="464028.48,-1816.68 463703.2,-1816.68 463619.52,-1728.68 463944.8,-1728.68 464028.48,-1816.68"/>
<text text-anchor="middle" x="463824" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="463824" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="463824" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="463824" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert2_q_proj -->
<g id="node1194" class="node">
<title>layer8_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="463601.5,-1794.68 463404.5,-1794.68 463404.5,-1750.68 463601.5,-1750.68 463601.5,-1794.68"/>
<text text-anchor="middle" x="463503" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="463503" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="463503" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="463503" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert2_k_proj -->
<g id="node1195" class="node">
<title>layer8_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="463386.5,-1794.68 463189.5,-1794.68 463189.5,-1750.68 463386.5,-1750.68 463386.5,-1794.68"/>
<text text-anchor="middle" x="463288" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="463288" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="463288" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="463288" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert2_v_proj -->
<g id="node1196" class="node">
<title>layer8_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="463171.5,-1794.68 462974.5,-1794.68 462974.5,-1750.68 463171.5,-1750.68 463171.5,-1794.68"/>
<text text-anchor="middle" x="463073" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="463073" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="463073" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="463073" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert2_attn -->
<g id="node1197" class="node">
<title>layer8_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="462956.5,-1794.68 462759.5,-1794.68 462759.5,-1750.68 462956.5,-1750.68 462956.5,-1794.68"/>
<text text-anchor="middle" x="462858" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="462858" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="462858" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="462858" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert2_attn_out -->
<g id="node1198" class="node">
<title>layer8_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="462741,-1794.68 462541,-1794.68 462541,-1750.68 462741,-1750.68 462741,-1794.68"/>
<text text-anchor="middle" x="462641" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="462641" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="462641" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="462641" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert2_attn_ar -->
<g id="node1199" class="node">
<title>layer8_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="462382" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="462382" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="462382" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="462382" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="462382" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert2_attn_res -->
<g id="node1200" class="node">
<title>layer8_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="462222.2,-1816.68 461892.59,-1816.68 461807.8,-1728.68 462137.41,-1728.68 462222.2,-1816.68"/>
<text text-anchor="middle" x="462015" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="462015" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="462015" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="462015" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert2_ln1 -->
<g id="node1201" class="node">
<title>layer8_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="461790,-1794.68 461590,-1794.68 461590,-1750.68 461790,-1750.68 461790,-1794.68"/>
<text text-anchor="middle" x="461690" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="461690" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="461690" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="461690" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert2_mlp1 -->
<g id="node1202" class="node">
<title>layer8_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="461572,-1794.68 461376,-1794.68 461376,-1750.68 461572,-1750.68 461572,-1794.68"/>
<text text-anchor="middle" x="461474" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="461474" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="461474" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="461474" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert2_gelu -->
<g id="node1203" class="node">
<title>layer8_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="461358,-1794.68 461162,-1794.68 461162,-1750.68 461358,-1750.68 461358,-1794.68"/>
<text text-anchor="middle" x="461260" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="461260" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="461260" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="461260" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert2_mlp2 -->
<g id="node1204" class="node">
<title>layer8_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="461144,-1794.68 460944,-1794.68 460944,-1750.68 461144,-1750.68 461144,-1794.68"/>
<text text-anchor="middle" x="461044" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="461044" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="461044" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="461044" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert2_mlp_ar -->
<g id="node1205" class="node">
<title>layer8_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="460785" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="460785" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="460785" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="460785" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="460785" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert2_mlp_res -->
<g id="node1206" class="node">
<title>layer8_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="460625.2,-1816.68 460295.59,-1816.68 460210.8,-1728.68 460540.41,-1728.68 460625.2,-1816.68"/>
<text text-anchor="middle" x="460418" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="460418" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="460418" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="460418" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert2_ln2 -->
<g id="node1207" class="node">
<title>layer8_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="460193,-1794.68 459993,-1794.68 459993,-1750.68 460193,-1750.68 460193,-1794.68"/>
<text text-anchor="middle" x="460093" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="460093" y="-1775.28" font-family="Arial" font-size="8.00">L8_E2</text>
<text text-anchor="middle" x="460093" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="460093" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert3_route -->
<g id="node1208" class="node">
<title>layer8_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="459969,-1794.68 459769,-1794.68 459769,-1750.68 459969,-1750.68 459969,-1794.68"/>
<text text-anchor="middle" x="459869" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="459869" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="459869" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="459869" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert3_gate -->
<g id="node1209" class="node">
<title>layer8_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="459751.04,-1816.68 459436,-1816.68 459354.96,-1728.68 459670,-1728.68 459751.04,-1816.68"/>
<text text-anchor="middle" x="459553" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="459553" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="459553" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="459553" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer8_expert3_a2a -->
<g id="node1210" class="node">
<title>layer8_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="459196" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="459196" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="459196" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="459196" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="459196" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert3_attn_split -->
<g id="node1211" class="node">
<title>layer8_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="459036.48,-1816.68 458711.2,-1816.68 458627.52,-1728.68 458952.8,-1728.68 459036.48,-1816.68"/>
<text text-anchor="middle" x="458832" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="458832" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="458832" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="458832" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert3_q_proj -->
<g id="node1212" class="node">
<title>layer8_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="458609.5,-1794.68 458412.5,-1794.68 458412.5,-1750.68 458609.5,-1750.68 458609.5,-1794.68"/>
<text text-anchor="middle" x="458511" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="458511" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="458511" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="458511" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert3_k_proj -->
<g id="node1213" class="node">
<title>layer8_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="458394.5,-1794.68 458197.5,-1794.68 458197.5,-1750.68 458394.5,-1750.68 458394.5,-1794.68"/>
<text text-anchor="middle" x="458296" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="458296" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="458296" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="458296" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert3_v_proj -->
<g id="node1214" class="node">
<title>layer8_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="458179.5,-1794.68 457982.5,-1794.68 457982.5,-1750.68 458179.5,-1750.68 458179.5,-1794.68"/>
<text text-anchor="middle" x="458081" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="458081" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="458081" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="458081" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert3_attn -->
<g id="node1215" class="node">
<title>layer8_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="457964.5,-1794.68 457767.5,-1794.68 457767.5,-1750.68 457964.5,-1750.68 457964.5,-1794.68"/>
<text text-anchor="middle" x="457866" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="457866" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="457866" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="457866" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert3_attn_out -->
<g id="node1216" class="node">
<title>layer8_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="457749,-1794.68 457549,-1794.68 457549,-1750.68 457749,-1750.68 457749,-1794.68"/>
<text text-anchor="middle" x="457649" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="457649" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="457649" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="457649" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert3_attn_ar -->
<g id="node1217" class="node">
<title>layer8_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="457390" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="457390" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="457390" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="457390" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="457390" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert3_attn_res -->
<g id="node1218" class="node">
<title>layer8_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="457230.2,-1816.68 456900.59,-1816.68 456815.8,-1728.68 457145.41,-1728.68 457230.2,-1816.68"/>
<text text-anchor="middle" x="457023" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="457023" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="457023" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="457023" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert3_ln1 -->
<g id="node1219" class="node">
<title>layer8_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="456798,-1794.68 456598,-1794.68 456598,-1750.68 456798,-1750.68 456798,-1794.68"/>
<text text-anchor="middle" x="456698" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="456698" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="456698" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="456698" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert3_mlp1 -->
<g id="node1220" class="node">
<title>layer8_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="456580,-1794.68 456384,-1794.68 456384,-1750.68 456580,-1750.68 456580,-1794.68"/>
<text text-anchor="middle" x="456482" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="456482" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="456482" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="456482" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert3_gelu -->
<g id="node1221" class="node">
<title>layer8_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="456366,-1794.68 456170,-1794.68 456170,-1750.68 456366,-1750.68 456366,-1794.68"/>
<text text-anchor="middle" x="456268" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="456268" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="456268" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="456268" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert3_mlp2 -->
<g id="node1222" class="node">
<title>layer8_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="456152,-1794.68 455952,-1794.68 455952,-1750.68 456152,-1750.68 456152,-1794.68"/>
<text text-anchor="middle" x="456052" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="456052" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="456052" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="456052" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert3_mlp_ar -->
<g id="node1223" class="node">
<title>layer8_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="455793" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="455793" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="455793" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="455793" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="455793" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert3_mlp_res -->
<g id="node1224" class="node">
<title>layer8_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="455633.2,-1816.68 455303.59,-1816.68 455218.8,-1728.68 455548.41,-1728.68 455633.2,-1816.68"/>
<text text-anchor="middle" x="455426" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="455426" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="455426" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="455426" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert3_ln2 -->
<g id="node1225" class="node">
<title>layer8_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="455201,-1794.68 455001,-1794.68 455001,-1750.68 455201,-1750.68 455201,-1794.68"/>
<text text-anchor="middle" x="455101" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="455101" y="-1775.28" font-family="Arial" font-size="8.00">L8_E3</text>
<text text-anchor="middle" x="455101" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="455101" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert4_route -->
<g id="node1226" class="node">
<title>layer8_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="454977,-1794.68 454777,-1794.68 454777,-1750.68 454977,-1750.68 454977,-1794.68"/>
<text text-anchor="middle" x="454877" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="454877" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="454877" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="454877" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert4_gate -->
<g id="node1227" class="node">
<title>layer8_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="454759.04,-1816.68 454444,-1816.68 454362.96,-1728.68 454678,-1728.68 454759.04,-1816.68"/>
<text text-anchor="middle" x="454561" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="454561" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="454561" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="454561" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer8_expert4_a2a -->
<g id="node1228" class="node">
<title>layer8_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="454204" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="454204" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="454204" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="454204" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="454204" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert4_attn_split -->
<g id="node1229" class="node">
<title>layer8_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="454044.48,-1816.68 453719.2,-1816.68 453635.52,-1728.68 453960.8,-1728.68 454044.48,-1816.68"/>
<text text-anchor="middle" x="453840" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="453840" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="453840" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="453840" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert4_q_proj -->
<g id="node1230" class="node">
<title>layer8_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="453617.5,-1794.68 453420.5,-1794.68 453420.5,-1750.68 453617.5,-1750.68 453617.5,-1794.68"/>
<text text-anchor="middle" x="453519" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="453519" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="453519" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="453519" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert4_k_proj -->
<g id="node1231" class="node">
<title>layer8_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="453402.5,-1794.68 453205.5,-1794.68 453205.5,-1750.68 453402.5,-1750.68 453402.5,-1794.68"/>
<text text-anchor="middle" x="453304" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="453304" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="453304" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="453304" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert4_v_proj -->
<g id="node1232" class="node">
<title>layer8_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="453187.5,-1794.68 452990.5,-1794.68 452990.5,-1750.68 453187.5,-1750.68 453187.5,-1794.68"/>
<text text-anchor="middle" x="453089" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="453089" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="453089" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="453089" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert4_attn -->
<g id="node1233" class="node">
<title>layer8_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="452972.5,-1794.68 452775.5,-1794.68 452775.5,-1750.68 452972.5,-1750.68 452972.5,-1794.68"/>
<text text-anchor="middle" x="452874" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="452874" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="452874" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="452874" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert4_attn_out -->
<g id="node1234" class="node">
<title>layer8_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="452757,-1794.68 452557,-1794.68 452557,-1750.68 452757,-1750.68 452757,-1794.68"/>
<text text-anchor="middle" x="452657" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="452657" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="452657" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="452657" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert4_attn_ar -->
<g id="node1235" class="node">
<title>layer8_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="452398" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="452398" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="452398" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="452398" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="452398" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert4_attn_res -->
<g id="node1236" class="node">
<title>layer8_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="452238.2,-1816.68 451908.59,-1816.68 451823.8,-1728.68 452153.41,-1728.68 452238.2,-1816.68"/>
<text text-anchor="middle" x="452031" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="452031" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="452031" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="452031" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert4_ln1 -->
<g id="node1237" class="node">
<title>layer8_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="451806,-1794.68 451606,-1794.68 451606,-1750.68 451806,-1750.68 451806,-1794.68"/>
<text text-anchor="middle" x="451706" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="451706" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="451706" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="451706" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert4_mlp1 -->
<g id="node1238" class="node">
<title>layer8_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="451588,-1794.68 451392,-1794.68 451392,-1750.68 451588,-1750.68 451588,-1794.68"/>
<text text-anchor="middle" x="451490" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="451490" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="451490" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="451490" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert4_gelu -->
<g id="node1239" class="node">
<title>layer8_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="451374,-1794.68 451178,-1794.68 451178,-1750.68 451374,-1750.68 451374,-1794.68"/>
<text text-anchor="middle" x="451276" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="451276" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="451276" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="451276" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert4_mlp2 -->
<g id="node1240" class="node">
<title>layer8_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="451160,-1794.68 450960,-1794.68 450960,-1750.68 451160,-1750.68 451160,-1794.68"/>
<text text-anchor="middle" x="451060" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="451060" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="451060" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="451060" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert4_mlp_ar -->
<g id="node1241" class="node">
<title>layer8_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="450801" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="450801" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="450801" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="450801" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="450801" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert4_mlp_res -->
<g id="node1242" class="node">
<title>layer8_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="450641.2,-1816.68 450311.59,-1816.68 450226.8,-1728.68 450556.41,-1728.68 450641.2,-1816.68"/>
<text text-anchor="middle" x="450434" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="450434" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="450434" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="450434" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert4_ln2 -->
<g id="node1243" class="node">
<title>layer8_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="450209,-1794.68 450009,-1794.68 450009,-1750.68 450209,-1750.68 450209,-1794.68"/>
<text text-anchor="middle" x="450109" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="450109" y="-1775.28" font-family="Arial" font-size="8.00">L8_E4</text>
<text text-anchor="middle" x="450109" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="450109" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert5_route -->
<g id="node1244" class="node">
<title>layer8_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="449985,-1794.68 449785,-1794.68 449785,-1750.68 449985,-1750.68 449985,-1794.68"/>
<text text-anchor="middle" x="449885" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="449885" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="449885" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="449885" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert5_gate -->
<g id="node1245" class="node">
<title>layer8_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="449767.04,-1816.68 449452,-1816.68 449370.96,-1728.68 449686,-1728.68 449767.04,-1816.68"/>
<text text-anchor="middle" x="449569" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="449569" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="449569" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="449569" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer8_expert5_a2a -->
<g id="node1246" class="node">
<title>layer8_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="449212" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="449212" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="449212" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="449212" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="449212" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert5_attn_split -->
<g id="node1247" class="node">
<title>layer8_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="449052.48,-1816.68 448727.2,-1816.68 448643.52,-1728.68 448968.8,-1728.68 449052.48,-1816.68"/>
<text text-anchor="middle" x="448848" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="448848" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="448848" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="448848" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert5_q_proj -->
<g id="node1248" class="node">
<title>layer8_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="448625.5,-1794.68 448428.5,-1794.68 448428.5,-1750.68 448625.5,-1750.68 448625.5,-1794.68"/>
<text text-anchor="middle" x="448527" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="448527" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="448527" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="448527" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert5_k_proj -->
<g id="node1249" class="node">
<title>layer8_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="448410.5,-1794.68 448213.5,-1794.68 448213.5,-1750.68 448410.5,-1750.68 448410.5,-1794.68"/>
<text text-anchor="middle" x="448312" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="448312" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="448312" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="448312" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert5_v_proj -->
<g id="node1250" class="node">
<title>layer8_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="448195.5,-1794.68 447998.5,-1794.68 447998.5,-1750.68 448195.5,-1750.68 448195.5,-1794.68"/>
<text text-anchor="middle" x="448097" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="448097" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="448097" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="448097" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert5_attn -->
<g id="node1251" class="node">
<title>layer8_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="447980.5,-1794.68 447783.5,-1794.68 447783.5,-1750.68 447980.5,-1750.68 447980.5,-1794.68"/>
<text text-anchor="middle" x="447882" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="447882" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="447882" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="447882" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert5_attn_out -->
<g id="node1252" class="node">
<title>layer8_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="447765,-1794.68 447565,-1794.68 447565,-1750.68 447765,-1750.68 447765,-1794.68"/>
<text text-anchor="middle" x="447665" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="447665" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="447665" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="447665" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert5_attn_ar -->
<g id="node1253" class="node">
<title>layer8_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="447406" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="447406" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="447406" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="447406" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="447406" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert5_attn_res -->
<g id="node1254" class="node">
<title>layer8_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="447246.2,-1816.68 446916.59,-1816.68 446831.8,-1728.68 447161.41,-1728.68 447246.2,-1816.68"/>
<text text-anchor="middle" x="447039" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="447039" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="447039" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="447039" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert5_ln1 -->
<g id="node1255" class="node">
<title>layer8_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="446814,-1794.68 446614,-1794.68 446614,-1750.68 446814,-1750.68 446814,-1794.68"/>
<text text-anchor="middle" x="446714" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="446714" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="446714" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="446714" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert5_mlp1 -->
<g id="node1256" class="node">
<title>layer8_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="446596,-1794.68 446400,-1794.68 446400,-1750.68 446596,-1750.68 446596,-1794.68"/>
<text text-anchor="middle" x="446498" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="446498" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="446498" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="446498" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert5_gelu -->
<g id="node1257" class="node">
<title>layer8_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="446382,-1794.68 446186,-1794.68 446186,-1750.68 446382,-1750.68 446382,-1794.68"/>
<text text-anchor="middle" x="446284" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="446284" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="446284" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="446284" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert5_mlp2 -->
<g id="node1258" class="node">
<title>layer8_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="446168,-1794.68 445968,-1794.68 445968,-1750.68 446168,-1750.68 446168,-1794.68"/>
<text text-anchor="middle" x="446068" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="446068" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="446068" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="446068" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert5_mlp_ar -->
<g id="node1259" class="node">
<title>layer8_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="445809" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="445809" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="445809" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="445809" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="445809" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert5_mlp_res -->
<g id="node1260" class="node">
<title>layer8_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="445649.2,-1816.68 445319.59,-1816.68 445234.8,-1728.68 445564.41,-1728.68 445649.2,-1816.68"/>
<text text-anchor="middle" x="445442" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="445442" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="445442" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="445442" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert5_ln2 -->
<g id="node1261" class="node">
<title>layer8_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="445217,-1794.68 445017,-1794.68 445017,-1750.68 445217,-1750.68 445217,-1794.68"/>
<text text-anchor="middle" x="445117" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="445117" y="-1775.28" font-family="Arial" font-size="8.00">L8_E5</text>
<text text-anchor="middle" x="445117" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="445117" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert6_route -->
<g id="node1262" class="node">
<title>layer8_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="444993,-1794.68 444793,-1794.68 444793,-1750.68 444993,-1750.68 444993,-1794.68"/>
<text text-anchor="middle" x="444893" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="444893" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="444893" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="444893" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert6_gate -->
<g id="node1263" class="node">
<title>layer8_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="444775.04,-1816.68 444460,-1816.68 444378.96,-1728.68 444694,-1728.68 444775.04,-1816.68"/>
<text text-anchor="middle" x="444577" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="444577" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="444577" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="444577" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer8_expert6_a2a -->
<g id="node1264" class="node">
<title>layer8_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="444220" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="444220" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="444220" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="444220" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="444220" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert6_attn_split -->
<g id="node1265" class="node">
<title>layer8_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="444060.48,-1816.68 443735.2,-1816.68 443651.52,-1728.68 443976.8,-1728.68 444060.48,-1816.68"/>
<text text-anchor="middle" x="443856" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="443856" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="443856" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="443856" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert6_q_proj -->
<g id="node1266" class="node">
<title>layer8_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="443633.5,-1794.68 443436.5,-1794.68 443436.5,-1750.68 443633.5,-1750.68 443633.5,-1794.68"/>
<text text-anchor="middle" x="443535" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="443535" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="443535" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="443535" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert6_k_proj -->
<g id="node1267" class="node">
<title>layer8_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="443418.5,-1794.68 443221.5,-1794.68 443221.5,-1750.68 443418.5,-1750.68 443418.5,-1794.68"/>
<text text-anchor="middle" x="443320" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="443320" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="443320" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="443320" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert6_v_proj -->
<g id="node1268" class="node">
<title>layer8_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="443203.5,-1794.68 443006.5,-1794.68 443006.5,-1750.68 443203.5,-1750.68 443203.5,-1794.68"/>
<text text-anchor="middle" x="443105" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="443105" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="443105" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="443105" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert6_attn -->
<g id="node1269" class="node">
<title>layer8_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="442988.5,-1794.68 442791.5,-1794.68 442791.5,-1750.68 442988.5,-1750.68 442988.5,-1794.68"/>
<text text-anchor="middle" x="442890" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="442890" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="442890" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="442890" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert6_attn_out -->
<g id="node1270" class="node">
<title>layer8_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="442773,-1794.68 442573,-1794.68 442573,-1750.68 442773,-1750.68 442773,-1794.68"/>
<text text-anchor="middle" x="442673" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="442673" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="442673" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="442673" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert6_attn_ar -->
<g id="node1271" class="node">
<title>layer8_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="442414" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="442414" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="442414" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="442414" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="442414" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert6_attn_res -->
<g id="node1272" class="node">
<title>layer8_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="442254.2,-1816.68 441924.59,-1816.68 441839.8,-1728.68 442169.41,-1728.68 442254.2,-1816.68"/>
<text text-anchor="middle" x="442047" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="442047" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="442047" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="442047" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert6_ln1 -->
<g id="node1273" class="node">
<title>layer8_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="441822,-1794.68 441622,-1794.68 441622,-1750.68 441822,-1750.68 441822,-1794.68"/>
<text text-anchor="middle" x="441722" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="441722" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="441722" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="441722" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert6_mlp1 -->
<g id="node1274" class="node">
<title>layer8_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="441604,-1794.68 441408,-1794.68 441408,-1750.68 441604,-1750.68 441604,-1794.68"/>
<text text-anchor="middle" x="441506" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="441506" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="441506" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="441506" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert6_gelu -->
<g id="node1275" class="node">
<title>layer8_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="441390,-1794.68 441194,-1794.68 441194,-1750.68 441390,-1750.68 441390,-1794.68"/>
<text text-anchor="middle" x="441292" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="441292" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="441292" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="441292" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert6_mlp2 -->
<g id="node1276" class="node">
<title>layer8_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="441176,-1794.68 440976,-1794.68 440976,-1750.68 441176,-1750.68 441176,-1794.68"/>
<text text-anchor="middle" x="441076" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="441076" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="441076" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="441076" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert6_mlp_ar -->
<g id="node1277" class="node">
<title>layer8_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="440817" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="440817" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="440817" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="440817" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="440817" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert6_mlp_res -->
<g id="node1278" class="node">
<title>layer8_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="440657.2,-1816.68 440327.59,-1816.68 440242.8,-1728.68 440572.41,-1728.68 440657.2,-1816.68"/>
<text text-anchor="middle" x="440450" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="440450" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="440450" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="440450" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert6_ln2 -->
<g id="node1279" class="node">
<title>layer8_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="440225,-1794.68 440025,-1794.68 440025,-1750.68 440225,-1750.68 440225,-1794.68"/>
<text text-anchor="middle" x="440125" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="440125" y="-1775.28" font-family="Arial" font-size="8.00">L8_E6</text>
<text text-anchor="middle" x="440125" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="440125" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert7_route -->
<g id="node1280" class="node">
<title>layer8_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="440001,-1794.68 439801,-1794.68 439801,-1750.68 440001,-1750.68 440001,-1794.68"/>
<text text-anchor="middle" x="439901" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="439901" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="439901" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="439901" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert7_gate -->
<g id="node1281" class="node">
<title>layer8_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="439783.04,-1816.68 439468,-1816.68 439386.96,-1728.68 439702,-1728.68 439783.04,-1816.68"/>
<text text-anchor="middle" x="439585" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="439585" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="439585" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="439585" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer8_expert7_a2a -->
<g id="node1282" class="node">
<title>layer8_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="439228" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="439228" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="439228" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="439228" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="439228" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert7_attn_split -->
<g id="node1283" class="node">
<title>layer8_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="439068.48,-1816.68 438743.2,-1816.68 438659.52,-1728.68 438984.8,-1728.68 439068.48,-1816.68"/>
<text text-anchor="middle" x="438864" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="438864" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="438864" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="438864" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert7_q_proj -->
<g id="node1284" class="node">
<title>layer8_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="438641.5,-1794.68 438444.5,-1794.68 438444.5,-1750.68 438641.5,-1750.68 438641.5,-1794.68"/>
<text text-anchor="middle" x="438543" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="438543" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="438543" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="438543" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert7_k_proj -->
<g id="node1285" class="node">
<title>layer8_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="438426.5,-1794.68 438229.5,-1794.68 438229.5,-1750.68 438426.5,-1750.68 438426.5,-1794.68"/>
<text text-anchor="middle" x="438328" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="438328" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="438328" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="438328" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert7_v_proj -->
<g id="node1286" class="node">
<title>layer8_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="438211.5,-1794.68 438014.5,-1794.68 438014.5,-1750.68 438211.5,-1750.68 438211.5,-1794.68"/>
<text text-anchor="middle" x="438113" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="438113" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="438113" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="438113" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert7_attn -->
<g id="node1287" class="node">
<title>layer8_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="437996.5,-1794.68 437799.5,-1794.68 437799.5,-1750.68 437996.5,-1750.68 437996.5,-1794.68"/>
<text text-anchor="middle" x="437898" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="437898" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="437898" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="437898" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer8_expert7_attn_out -->
<g id="node1288" class="node">
<title>layer8_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="437781,-1794.68 437581,-1794.68 437581,-1750.68 437781,-1750.68 437781,-1794.68"/>
<text text-anchor="middle" x="437681" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="437681" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="437681" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="437681" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert7_attn_ar -->
<g id="node1289" class="node">
<title>layer8_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="437422" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="437422" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="437422" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="437422" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="437422" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert7_attn_res -->
<g id="node1290" class="node">
<title>layer8_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="437262.2,-1816.68 436932.59,-1816.68 436847.8,-1728.68 437177.41,-1728.68 437262.2,-1816.68"/>
<text text-anchor="middle" x="437055" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="437055" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="437055" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="437055" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert7_ln1 -->
<g id="node1291" class="node">
<title>layer8_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="436830,-1794.68 436630,-1794.68 436630,-1750.68 436830,-1750.68 436830,-1794.68"/>
<text text-anchor="middle" x="436730" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="436730" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="436730" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="436730" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert7_mlp1 -->
<g id="node1292" class="node">
<title>layer8_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="436612,-1794.68 436416,-1794.68 436416,-1750.68 436612,-1750.68 436612,-1794.68"/>
<text text-anchor="middle" x="436514" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="436514" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="436514" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="436514" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert7_gelu -->
<g id="node1293" class="node">
<title>layer8_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="436398,-1794.68 436202,-1794.68 436202,-1750.68 436398,-1750.68 436398,-1794.68"/>
<text text-anchor="middle" x="436300" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="436300" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="436300" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="436300" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer8_expert7_mlp2 -->
<g id="node1294" class="node">
<title>layer8_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="436184,-1794.68 435984,-1794.68 435984,-1750.68 436184,-1750.68 436184,-1794.68"/>
<text text-anchor="middle" x="436084" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="436084" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="436084" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="436084" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert7_mlp_ar -->
<g id="node1295" class="node">
<title>layer8_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="435825" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="435825" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="435825" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="435825" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="435825" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert7_mlp_res -->
<g id="node1296" class="node">
<title>layer8_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="435665.2,-1816.68 435335.59,-1816.68 435250.8,-1728.68 435580.41,-1728.68 435665.2,-1816.68"/>
<text text-anchor="middle" x="435458" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="435458" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="435458" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="435458" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer8_expert7_ln2 -->
<g id="node1297" class="node">
<title>layer8_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="435233,-1794.68 435033,-1794.68 435033,-1750.68 435233,-1750.68 435233,-1794.68"/>
<text text-anchor="middle" x="435133" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="435133" y="-1775.28" font-family="Arial" font-size="8.00">L8_E7</text>
<text text-anchor="middle" x="435133" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="435133" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert0_route -->
<g id="node1298" class="node">
<title>layer9_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="434993,-1794.68 434793,-1794.68 434793,-1750.68 434993,-1750.68 434993,-1794.68"/>
<text text-anchor="middle" x="434893" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="434893" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="434893" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="434893" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert0_gate -->
<g id="node1299" class="node">
<title>layer9_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="434775.04,-1816.68 434460,-1816.68 434378.96,-1728.68 434694,-1728.68 434775.04,-1816.68"/>
<text text-anchor="middle" x="434577" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="434577" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="434577" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="434577" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer9_expert0_a2a -->
<g id="node1300" class="node">
<title>layer9_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="434220" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="434220" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="434220" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="434220" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="434220" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert0_attn_split -->
<g id="node1301" class="node">
<title>layer9_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="434060.48,-1816.68 433735.2,-1816.68 433651.52,-1728.68 433976.8,-1728.68 434060.48,-1816.68"/>
<text text-anchor="middle" x="433856" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="433856" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="433856" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="433856" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert0_q_proj -->
<g id="node1302" class="node">
<title>layer9_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="433633.5,-1794.68 433436.5,-1794.68 433436.5,-1750.68 433633.5,-1750.68 433633.5,-1794.68"/>
<text text-anchor="middle" x="433535" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="433535" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="433535" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="433535" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert0_k_proj -->
<g id="node1303" class="node">
<title>layer9_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="433418.5,-1794.68 433221.5,-1794.68 433221.5,-1750.68 433418.5,-1750.68 433418.5,-1794.68"/>
<text text-anchor="middle" x="433320" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="433320" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="433320" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="433320" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert0_v_proj -->
<g id="node1304" class="node">
<title>layer9_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="433203.5,-1794.68 433006.5,-1794.68 433006.5,-1750.68 433203.5,-1750.68 433203.5,-1794.68"/>
<text text-anchor="middle" x="433105" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="433105" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="433105" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="433105" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert0_attn -->
<g id="node1305" class="node">
<title>layer9_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="432988.5,-1794.68 432791.5,-1794.68 432791.5,-1750.68 432988.5,-1750.68 432988.5,-1794.68"/>
<text text-anchor="middle" x="432890" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="432890" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="432890" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="432890" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert0_attn_out -->
<g id="node1306" class="node">
<title>layer9_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="432773,-1794.68 432573,-1794.68 432573,-1750.68 432773,-1750.68 432773,-1794.68"/>
<text text-anchor="middle" x="432673" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="432673" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="432673" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="432673" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert0_attn_ar -->
<g id="node1307" class="node">
<title>layer9_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="432414" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="432414" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="432414" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="432414" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="432414" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert0_attn_res -->
<g id="node1308" class="node">
<title>layer9_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="432254.2,-1816.68 431924.59,-1816.68 431839.8,-1728.68 432169.41,-1728.68 432254.2,-1816.68"/>
<text text-anchor="middle" x="432047" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="432047" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="432047" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="432047" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert0_ln1 -->
<g id="node1309" class="node">
<title>layer9_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="431822,-1794.68 431622,-1794.68 431622,-1750.68 431822,-1750.68 431822,-1794.68"/>
<text text-anchor="middle" x="431722" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="431722" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="431722" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="431722" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert0_mlp1 -->
<g id="node1310" class="node">
<title>layer9_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="431604,-1794.68 431408,-1794.68 431408,-1750.68 431604,-1750.68 431604,-1794.68"/>
<text text-anchor="middle" x="431506" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="431506" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="431506" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="431506" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert0_gelu -->
<g id="node1311" class="node">
<title>layer9_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="431390,-1794.68 431194,-1794.68 431194,-1750.68 431390,-1750.68 431390,-1794.68"/>
<text text-anchor="middle" x="431292" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="431292" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="431292" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="431292" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert0_mlp2 -->
<g id="node1312" class="node">
<title>layer9_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="431176,-1794.68 430976,-1794.68 430976,-1750.68 431176,-1750.68 431176,-1794.68"/>
<text text-anchor="middle" x="431076" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="431076" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="431076" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="431076" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert0_mlp_ar -->
<g id="node1313" class="node">
<title>layer9_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="430817" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="430817" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="430817" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="430817" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="430817" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert0_mlp_res -->
<g id="node1314" class="node">
<title>layer9_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="430657.2,-1816.68 430327.59,-1816.68 430242.8,-1728.68 430572.41,-1728.68 430657.2,-1816.68"/>
<text text-anchor="middle" x="430450" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="430450" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="430450" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="430450" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert0_ln2 -->
<g id="node1315" class="node">
<title>layer9_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="430225,-1794.68 430025,-1794.68 430025,-1750.68 430225,-1750.68 430225,-1794.68"/>
<text text-anchor="middle" x="430125" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="430125" y="-1775.28" font-family="Arial" font-size="8.00">L9_E0</text>
<text text-anchor="middle" x="430125" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="430125" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert1_route -->
<g id="node1316" class="node">
<title>layer9_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="430001,-1794.68 429801,-1794.68 429801,-1750.68 430001,-1750.68 430001,-1794.68"/>
<text text-anchor="middle" x="429901" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="429901" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="429901" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="429901" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert1_gate -->
<g id="node1317" class="node">
<title>layer9_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="429783.04,-1816.68 429468,-1816.68 429386.96,-1728.68 429702,-1728.68 429783.04,-1816.68"/>
<text text-anchor="middle" x="429585" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="429585" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="429585" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="429585" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer9_expert1_a2a -->
<g id="node1318" class="node">
<title>layer9_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="429228" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="429228" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="429228" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="429228" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="429228" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert1_attn_split -->
<g id="node1319" class="node">
<title>layer9_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="429068.48,-1816.68 428743.2,-1816.68 428659.52,-1728.68 428984.8,-1728.68 429068.48,-1816.68"/>
<text text-anchor="middle" x="428864" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="428864" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="428864" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="428864" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert1_q_proj -->
<g id="node1320" class="node">
<title>layer9_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="428641.5,-1794.68 428444.5,-1794.68 428444.5,-1750.68 428641.5,-1750.68 428641.5,-1794.68"/>
<text text-anchor="middle" x="428543" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="428543" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="428543" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="428543" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert1_k_proj -->
<g id="node1321" class="node">
<title>layer9_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="428426.5,-1794.68 428229.5,-1794.68 428229.5,-1750.68 428426.5,-1750.68 428426.5,-1794.68"/>
<text text-anchor="middle" x="428328" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="428328" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="428328" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="428328" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert1_v_proj -->
<g id="node1322" class="node">
<title>layer9_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="428211.5,-1794.68 428014.5,-1794.68 428014.5,-1750.68 428211.5,-1750.68 428211.5,-1794.68"/>
<text text-anchor="middle" x="428113" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="428113" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="428113" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="428113" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert1_attn -->
<g id="node1323" class="node">
<title>layer9_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="427996.5,-1794.68 427799.5,-1794.68 427799.5,-1750.68 427996.5,-1750.68 427996.5,-1794.68"/>
<text text-anchor="middle" x="427898" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="427898" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="427898" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="427898" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert1_attn_out -->
<g id="node1324" class="node">
<title>layer9_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="427781,-1794.68 427581,-1794.68 427581,-1750.68 427781,-1750.68 427781,-1794.68"/>
<text text-anchor="middle" x="427681" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="427681" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="427681" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="427681" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert1_attn_ar -->
<g id="node1325" class="node">
<title>layer9_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="427422" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="427422" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="427422" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="427422" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="427422" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert1_attn_res -->
<g id="node1326" class="node">
<title>layer9_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="427262.2,-1816.68 426932.59,-1816.68 426847.8,-1728.68 427177.41,-1728.68 427262.2,-1816.68"/>
<text text-anchor="middle" x="427055" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="427055" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="427055" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="427055" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert1_ln1 -->
<g id="node1327" class="node">
<title>layer9_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="426830,-1794.68 426630,-1794.68 426630,-1750.68 426830,-1750.68 426830,-1794.68"/>
<text text-anchor="middle" x="426730" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="426730" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="426730" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="426730" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert1_mlp1 -->
<g id="node1328" class="node">
<title>layer9_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="426612,-1794.68 426416,-1794.68 426416,-1750.68 426612,-1750.68 426612,-1794.68"/>
<text text-anchor="middle" x="426514" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="426514" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="426514" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="426514" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert1_gelu -->
<g id="node1329" class="node">
<title>layer9_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="426398,-1794.68 426202,-1794.68 426202,-1750.68 426398,-1750.68 426398,-1794.68"/>
<text text-anchor="middle" x="426300" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="426300" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="426300" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="426300" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert1_mlp2 -->
<g id="node1330" class="node">
<title>layer9_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="426184,-1794.68 425984,-1794.68 425984,-1750.68 426184,-1750.68 426184,-1794.68"/>
<text text-anchor="middle" x="426084" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="426084" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="426084" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="426084" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert1_mlp_ar -->
<g id="node1331" class="node">
<title>layer9_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="425825" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="425825" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="425825" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="425825" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="425825" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert1_mlp_res -->
<g id="node1332" class="node">
<title>layer9_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="425665.2,-1816.68 425335.59,-1816.68 425250.8,-1728.68 425580.41,-1728.68 425665.2,-1816.68"/>
<text text-anchor="middle" x="425458" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="425458" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="425458" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="425458" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert1_ln2 -->
<g id="node1333" class="node">
<title>layer9_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="425233,-1794.68 425033,-1794.68 425033,-1750.68 425233,-1750.68 425233,-1794.68"/>
<text text-anchor="middle" x="425133" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="425133" y="-1775.28" font-family="Arial" font-size="8.00">L9_E1</text>
<text text-anchor="middle" x="425133" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="425133" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert2_route -->
<g id="node1334" class="node">
<title>layer9_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="425009,-1794.68 424809,-1794.68 424809,-1750.68 425009,-1750.68 425009,-1794.68"/>
<text text-anchor="middle" x="424909" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="424909" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="424909" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="424909" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert2_gate -->
<g id="node1335" class="node">
<title>layer9_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="424791.04,-1816.68 424476,-1816.68 424394.96,-1728.68 424710,-1728.68 424791.04,-1816.68"/>
<text text-anchor="middle" x="424593" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="424593" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="424593" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="424593" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer9_expert2_a2a -->
<g id="node1336" class="node">
<title>layer9_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="424236" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="424236" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="424236" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="424236" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="424236" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert2_attn_split -->
<g id="node1337" class="node">
<title>layer9_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="424076.48,-1816.68 423751.2,-1816.68 423667.52,-1728.68 423992.8,-1728.68 424076.48,-1816.68"/>
<text text-anchor="middle" x="423872" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="423872" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="423872" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="423872" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert2_q_proj -->
<g id="node1338" class="node">
<title>layer9_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="423649.5,-1794.68 423452.5,-1794.68 423452.5,-1750.68 423649.5,-1750.68 423649.5,-1794.68"/>
<text text-anchor="middle" x="423551" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="423551" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="423551" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="423551" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert2_k_proj -->
<g id="node1339" class="node">
<title>layer9_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="423434.5,-1794.68 423237.5,-1794.68 423237.5,-1750.68 423434.5,-1750.68 423434.5,-1794.68"/>
<text text-anchor="middle" x="423336" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="423336" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="423336" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="423336" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert2_v_proj -->
<g id="node1340" class="node">
<title>layer9_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="423219.5,-1794.68 423022.5,-1794.68 423022.5,-1750.68 423219.5,-1750.68 423219.5,-1794.68"/>
<text text-anchor="middle" x="423121" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="423121" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="423121" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="423121" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert2_attn -->
<g id="node1341" class="node">
<title>layer9_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="423004.5,-1794.68 422807.5,-1794.68 422807.5,-1750.68 423004.5,-1750.68 423004.5,-1794.68"/>
<text text-anchor="middle" x="422906" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="422906" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="422906" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="422906" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert2_attn_out -->
<g id="node1342" class="node">
<title>layer9_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="422789,-1794.68 422589,-1794.68 422589,-1750.68 422789,-1750.68 422789,-1794.68"/>
<text text-anchor="middle" x="422689" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="422689" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="422689" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="422689" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert2_attn_ar -->
<g id="node1343" class="node">
<title>layer9_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="422430" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="422430" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="422430" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="422430" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="422430" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert2_attn_res -->
<g id="node1344" class="node">
<title>layer9_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="422270.2,-1816.68 421940.59,-1816.68 421855.8,-1728.68 422185.41,-1728.68 422270.2,-1816.68"/>
<text text-anchor="middle" x="422063" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="422063" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="422063" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="422063" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert2_ln1 -->
<g id="node1345" class="node">
<title>layer9_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="421838,-1794.68 421638,-1794.68 421638,-1750.68 421838,-1750.68 421838,-1794.68"/>
<text text-anchor="middle" x="421738" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="421738" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="421738" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="421738" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert2_mlp1 -->
<g id="node1346" class="node">
<title>layer9_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="421620,-1794.68 421424,-1794.68 421424,-1750.68 421620,-1750.68 421620,-1794.68"/>
<text text-anchor="middle" x="421522" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="421522" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="421522" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="421522" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert2_gelu -->
<g id="node1347" class="node">
<title>layer9_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="421406,-1794.68 421210,-1794.68 421210,-1750.68 421406,-1750.68 421406,-1794.68"/>
<text text-anchor="middle" x="421308" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="421308" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="421308" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="421308" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert2_mlp2 -->
<g id="node1348" class="node">
<title>layer9_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="421192,-1794.68 420992,-1794.68 420992,-1750.68 421192,-1750.68 421192,-1794.68"/>
<text text-anchor="middle" x="421092" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="421092" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="421092" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="421092" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert2_mlp_ar -->
<g id="node1349" class="node">
<title>layer9_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="420833" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="420833" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="420833" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="420833" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="420833" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert2_mlp_res -->
<g id="node1350" class="node">
<title>layer9_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="420673.2,-1816.68 420343.59,-1816.68 420258.8,-1728.68 420588.41,-1728.68 420673.2,-1816.68"/>
<text text-anchor="middle" x="420466" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="420466" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="420466" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="420466" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert2_ln2 -->
<g id="node1351" class="node">
<title>layer9_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="420241,-1794.68 420041,-1794.68 420041,-1750.68 420241,-1750.68 420241,-1794.68"/>
<text text-anchor="middle" x="420141" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="420141" y="-1775.28" font-family="Arial" font-size="8.00">L9_E2</text>
<text text-anchor="middle" x="420141" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="420141" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert3_route -->
<g id="node1352" class="node">
<title>layer9_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="420017,-1794.68 419817,-1794.68 419817,-1750.68 420017,-1750.68 420017,-1794.68"/>
<text text-anchor="middle" x="419917" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="419917" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="419917" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="419917" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert3_gate -->
<g id="node1353" class="node">
<title>layer9_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="419799.04,-1816.68 419484,-1816.68 419402.96,-1728.68 419718,-1728.68 419799.04,-1816.68"/>
<text text-anchor="middle" x="419601" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="419601" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="419601" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="419601" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer9_expert3_a2a -->
<g id="node1354" class="node">
<title>layer9_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="419244" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="419244" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="419244" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="419244" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="419244" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert3_attn_split -->
<g id="node1355" class="node">
<title>layer9_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="419084.48,-1816.68 418759.2,-1816.68 418675.52,-1728.68 419000.8,-1728.68 419084.48,-1816.68"/>
<text text-anchor="middle" x="418880" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="418880" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="418880" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="418880" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert3_q_proj -->
<g id="node1356" class="node">
<title>layer9_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="418657.5,-1794.68 418460.5,-1794.68 418460.5,-1750.68 418657.5,-1750.68 418657.5,-1794.68"/>
<text text-anchor="middle" x="418559" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="418559" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="418559" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="418559" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert3_k_proj -->
<g id="node1357" class="node">
<title>layer9_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="418442.5,-1794.68 418245.5,-1794.68 418245.5,-1750.68 418442.5,-1750.68 418442.5,-1794.68"/>
<text text-anchor="middle" x="418344" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="418344" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="418344" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="418344" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert3_v_proj -->
<g id="node1358" class="node">
<title>layer9_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="418227.5,-1794.68 418030.5,-1794.68 418030.5,-1750.68 418227.5,-1750.68 418227.5,-1794.68"/>
<text text-anchor="middle" x="418129" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="418129" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="418129" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="418129" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert3_attn -->
<g id="node1359" class="node">
<title>layer9_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="418012.5,-1794.68 417815.5,-1794.68 417815.5,-1750.68 418012.5,-1750.68 418012.5,-1794.68"/>
<text text-anchor="middle" x="417914" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="417914" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="417914" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="417914" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert3_attn_out -->
<g id="node1360" class="node">
<title>layer9_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="417797,-1794.68 417597,-1794.68 417597,-1750.68 417797,-1750.68 417797,-1794.68"/>
<text text-anchor="middle" x="417697" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="417697" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="417697" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="417697" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert3_attn_ar -->
<g id="node1361" class="node">
<title>layer9_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="417438" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="417438" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="417438" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="417438" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="417438" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert3_attn_res -->
<g id="node1362" class="node">
<title>layer9_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="417278.2,-1816.68 416948.59,-1816.68 416863.8,-1728.68 417193.41,-1728.68 417278.2,-1816.68"/>
<text text-anchor="middle" x="417071" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="417071" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="417071" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="417071" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert3_ln1 -->
<g id="node1363" class="node">
<title>layer9_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="416846,-1794.68 416646,-1794.68 416646,-1750.68 416846,-1750.68 416846,-1794.68"/>
<text text-anchor="middle" x="416746" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="416746" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="416746" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="416746" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert3_mlp1 -->
<g id="node1364" class="node">
<title>layer9_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="416628,-1794.68 416432,-1794.68 416432,-1750.68 416628,-1750.68 416628,-1794.68"/>
<text text-anchor="middle" x="416530" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="416530" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="416530" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="416530" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert3_gelu -->
<g id="node1365" class="node">
<title>layer9_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="416414,-1794.68 416218,-1794.68 416218,-1750.68 416414,-1750.68 416414,-1794.68"/>
<text text-anchor="middle" x="416316" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="416316" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="416316" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="416316" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert3_mlp2 -->
<g id="node1366" class="node">
<title>layer9_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="416200,-1794.68 416000,-1794.68 416000,-1750.68 416200,-1750.68 416200,-1794.68"/>
<text text-anchor="middle" x="416100" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="416100" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="416100" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="416100" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert3_mlp_ar -->
<g id="node1367" class="node">
<title>layer9_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="415841" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="415841" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="415841" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="415841" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="415841" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert3_mlp_res -->
<g id="node1368" class="node">
<title>layer9_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="415681.2,-1816.68 415351.59,-1816.68 415266.8,-1728.68 415596.41,-1728.68 415681.2,-1816.68"/>
<text text-anchor="middle" x="415474" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="415474" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="415474" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="415474" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert3_ln2 -->
<g id="node1369" class="node">
<title>layer9_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="415249,-1794.68 415049,-1794.68 415049,-1750.68 415249,-1750.68 415249,-1794.68"/>
<text text-anchor="middle" x="415149" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="415149" y="-1775.28" font-family="Arial" font-size="8.00">L9_E3</text>
<text text-anchor="middle" x="415149" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="415149" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert4_route -->
<g id="node1370" class="node">
<title>layer9_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="415025,-1794.68 414825,-1794.68 414825,-1750.68 415025,-1750.68 415025,-1794.68"/>
<text text-anchor="middle" x="414925" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="414925" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="414925" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="414925" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert4_gate -->
<g id="node1371" class="node">
<title>layer9_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="414807.04,-1816.68 414492,-1816.68 414410.96,-1728.68 414726,-1728.68 414807.04,-1816.68"/>
<text text-anchor="middle" x="414609" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="414609" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="414609" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="414609" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer9_expert4_a2a -->
<g id="node1372" class="node">
<title>layer9_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="414252" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="414252" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="414252" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="414252" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="414252" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert4_attn_split -->
<g id="node1373" class="node">
<title>layer9_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="414092.48,-1816.68 413767.2,-1816.68 413683.52,-1728.68 414008.8,-1728.68 414092.48,-1816.68"/>
<text text-anchor="middle" x="413888" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="413888" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="413888" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="413888" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert4_q_proj -->
<g id="node1374" class="node">
<title>layer9_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="413665.5,-1794.68 413468.5,-1794.68 413468.5,-1750.68 413665.5,-1750.68 413665.5,-1794.68"/>
<text text-anchor="middle" x="413567" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="413567" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="413567" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="413567" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert4_k_proj -->
<g id="node1375" class="node">
<title>layer9_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="413450.5,-1794.68 413253.5,-1794.68 413253.5,-1750.68 413450.5,-1750.68 413450.5,-1794.68"/>
<text text-anchor="middle" x="413352" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="413352" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="413352" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="413352" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert4_v_proj -->
<g id="node1376" class="node">
<title>layer9_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="413235.5,-1794.68 413038.5,-1794.68 413038.5,-1750.68 413235.5,-1750.68 413235.5,-1794.68"/>
<text text-anchor="middle" x="413137" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="413137" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="413137" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="413137" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert4_attn -->
<g id="node1377" class="node">
<title>layer9_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="413020.5,-1794.68 412823.5,-1794.68 412823.5,-1750.68 413020.5,-1750.68 413020.5,-1794.68"/>
<text text-anchor="middle" x="412922" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="412922" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="412922" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="412922" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert4_attn_out -->
<g id="node1378" class="node">
<title>layer9_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="412805,-1794.68 412605,-1794.68 412605,-1750.68 412805,-1750.68 412805,-1794.68"/>
<text text-anchor="middle" x="412705" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="412705" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="412705" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="412705" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert4_attn_ar -->
<g id="node1379" class="node">
<title>layer9_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="412446" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="412446" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="412446" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="412446" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="412446" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert4_attn_res -->
<g id="node1380" class="node">
<title>layer9_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="412286.2,-1816.68 411956.59,-1816.68 411871.8,-1728.68 412201.41,-1728.68 412286.2,-1816.68"/>
<text text-anchor="middle" x="412079" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="412079" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="412079" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="412079" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert4_ln1 -->
<g id="node1381" class="node">
<title>layer9_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="411854,-1794.68 411654,-1794.68 411654,-1750.68 411854,-1750.68 411854,-1794.68"/>
<text text-anchor="middle" x="411754" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="411754" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="411754" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="411754" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert4_mlp1 -->
<g id="node1382" class="node">
<title>layer9_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="411636,-1794.68 411440,-1794.68 411440,-1750.68 411636,-1750.68 411636,-1794.68"/>
<text text-anchor="middle" x="411538" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="411538" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="411538" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="411538" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert4_gelu -->
<g id="node1383" class="node">
<title>layer9_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="411422,-1794.68 411226,-1794.68 411226,-1750.68 411422,-1750.68 411422,-1794.68"/>
<text text-anchor="middle" x="411324" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="411324" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="411324" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="411324" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert4_mlp2 -->
<g id="node1384" class="node">
<title>layer9_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="411208,-1794.68 411008,-1794.68 411008,-1750.68 411208,-1750.68 411208,-1794.68"/>
<text text-anchor="middle" x="411108" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="411108" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="411108" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="411108" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert4_mlp_ar -->
<g id="node1385" class="node">
<title>layer9_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="410849" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="410849" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="410849" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="410849" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="410849" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert4_mlp_res -->
<g id="node1386" class="node">
<title>layer9_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="410689.2,-1816.68 410359.59,-1816.68 410274.8,-1728.68 410604.41,-1728.68 410689.2,-1816.68"/>
<text text-anchor="middle" x="410482" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="410482" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="410482" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="410482" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert4_ln2 -->
<g id="node1387" class="node">
<title>layer9_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="410257,-1794.68 410057,-1794.68 410057,-1750.68 410257,-1750.68 410257,-1794.68"/>
<text text-anchor="middle" x="410157" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="410157" y="-1775.28" font-family="Arial" font-size="8.00">L9_E4</text>
<text text-anchor="middle" x="410157" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="410157" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert5_route -->
<g id="node1388" class="node">
<title>layer9_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="410033,-1794.68 409833,-1794.68 409833,-1750.68 410033,-1750.68 410033,-1794.68"/>
<text text-anchor="middle" x="409933" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="409933" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="409933" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="409933" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert5_gate -->
<g id="node1389" class="node">
<title>layer9_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="409815.04,-1816.68 409500,-1816.68 409418.96,-1728.68 409734,-1728.68 409815.04,-1816.68"/>
<text text-anchor="middle" x="409617" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="409617" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="409617" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="409617" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer9_expert5_a2a -->
<g id="node1390" class="node">
<title>layer9_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="409260" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="409260" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="409260" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="409260" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="409260" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert5_attn_split -->
<g id="node1391" class="node">
<title>layer9_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="409100.48,-1816.68 408775.2,-1816.68 408691.52,-1728.68 409016.8,-1728.68 409100.48,-1816.68"/>
<text text-anchor="middle" x="408896" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="408896" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="408896" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="408896" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert5_q_proj -->
<g id="node1392" class="node">
<title>layer9_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="408673.5,-1794.68 408476.5,-1794.68 408476.5,-1750.68 408673.5,-1750.68 408673.5,-1794.68"/>
<text text-anchor="middle" x="408575" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="408575" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="408575" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="408575" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert5_k_proj -->
<g id="node1393" class="node">
<title>layer9_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="408458.5,-1794.68 408261.5,-1794.68 408261.5,-1750.68 408458.5,-1750.68 408458.5,-1794.68"/>
<text text-anchor="middle" x="408360" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="408360" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="408360" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="408360" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert5_v_proj -->
<g id="node1394" class="node">
<title>layer9_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="408243.5,-1794.68 408046.5,-1794.68 408046.5,-1750.68 408243.5,-1750.68 408243.5,-1794.68"/>
<text text-anchor="middle" x="408145" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="408145" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="408145" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="408145" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert5_attn -->
<g id="node1395" class="node">
<title>layer9_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="408028.5,-1794.68 407831.5,-1794.68 407831.5,-1750.68 408028.5,-1750.68 408028.5,-1794.68"/>
<text text-anchor="middle" x="407930" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="407930" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="407930" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="407930" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert5_attn_out -->
<g id="node1396" class="node">
<title>layer9_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="407813,-1794.68 407613,-1794.68 407613,-1750.68 407813,-1750.68 407813,-1794.68"/>
<text text-anchor="middle" x="407713" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="407713" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="407713" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="407713" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert5_attn_ar -->
<g id="node1397" class="node">
<title>layer9_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="407454" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="407454" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="407454" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="407454" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="407454" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert5_attn_res -->
<g id="node1398" class="node">
<title>layer9_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="407294.2,-1816.68 406964.59,-1816.68 406879.8,-1728.68 407209.41,-1728.68 407294.2,-1816.68"/>
<text text-anchor="middle" x="407087" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="407087" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="407087" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="407087" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert5_ln1 -->
<g id="node1399" class="node">
<title>layer9_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="406862,-1794.68 406662,-1794.68 406662,-1750.68 406862,-1750.68 406862,-1794.68"/>
<text text-anchor="middle" x="406762" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="406762" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="406762" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="406762" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert5_mlp1 -->
<g id="node1400" class="node">
<title>layer9_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="406644,-1794.68 406448,-1794.68 406448,-1750.68 406644,-1750.68 406644,-1794.68"/>
<text text-anchor="middle" x="406546" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="406546" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="406546" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="406546" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert5_gelu -->
<g id="node1401" class="node">
<title>layer9_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="406430,-1794.68 406234,-1794.68 406234,-1750.68 406430,-1750.68 406430,-1794.68"/>
<text text-anchor="middle" x="406332" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="406332" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="406332" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="406332" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert5_mlp2 -->
<g id="node1402" class="node">
<title>layer9_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="406216,-1794.68 406016,-1794.68 406016,-1750.68 406216,-1750.68 406216,-1794.68"/>
<text text-anchor="middle" x="406116" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="406116" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="406116" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="406116" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert5_mlp_ar -->
<g id="node1403" class="node">
<title>layer9_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="405857" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="405857" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="405857" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="405857" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="405857" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert5_mlp_res -->
<g id="node1404" class="node">
<title>layer9_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="405697.2,-1816.68 405367.59,-1816.68 405282.8,-1728.68 405612.41,-1728.68 405697.2,-1816.68"/>
<text text-anchor="middle" x="405490" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="405490" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="405490" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="405490" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert5_ln2 -->
<g id="node1405" class="node">
<title>layer9_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="405265,-1794.68 405065,-1794.68 405065,-1750.68 405265,-1750.68 405265,-1794.68"/>
<text text-anchor="middle" x="405165" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="405165" y="-1775.28" font-family="Arial" font-size="8.00">L9_E5</text>
<text text-anchor="middle" x="405165" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="405165" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert6_route -->
<g id="node1406" class="node">
<title>layer9_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="405041,-1794.68 404841,-1794.68 404841,-1750.68 405041,-1750.68 405041,-1794.68"/>
<text text-anchor="middle" x="404941" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="404941" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="404941" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="404941" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert6_gate -->
<g id="node1407" class="node">
<title>layer9_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="404823.04,-1816.68 404508,-1816.68 404426.96,-1728.68 404742,-1728.68 404823.04,-1816.68"/>
<text text-anchor="middle" x="404625" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="404625" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="404625" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="404625" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer9_expert6_a2a -->
<g id="node1408" class="node">
<title>layer9_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="404268" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="404268" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="404268" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="404268" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="404268" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert6_attn_split -->
<g id="node1409" class="node">
<title>layer9_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="404108.48,-1816.68 403783.2,-1816.68 403699.52,-1728.68 404024.8,-1728.68 404108.48,-1816.68"/>
<text text-anchor="middle" x="403904" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="403904" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="403904" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="403904" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert6_q_proj -->
<g id="node1410" class="node">
<title>layer9_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="403681.5,-1794.68 403484.5,-1794.68 403484.5,-1750.68 403681.5,-1750.68 403681.5,-1794.68"/>
<text text-anchor="middle" x="403583" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="403583" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="403583" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="403583" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert6_k_proj -->
<g id="node1411" class="node">
<title>layer9_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="403466.5,-1794.68 403269.5,-1794.68 403269.5,-1750.68 403466.5,-1750.68 403466.5,-1794.68"/>
<text text-anchor="middle" x="403368" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="403368" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="403368" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="403368" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert6_v_proj -->
<g id="node1412" class="node">
<title>layer9_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="403251.5,-1794.68 403054.5,-1794.68 403054.5,-1750.68 403251.5,-1750.68 403251.5,-1794.68"/>
<text text-anchor="middle" x="403153" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="403153" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="403153" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="403153" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert6_attn -->
<g id="node1413" class="node">
<title>layer9_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="403036.5,-1794.68 402839.5,-1794.68 402839.5,-1750.68 403036.5,-1750.68 403036.5,-1794.68"/>
<text text-anchor="middle" x="402938" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="402938" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="402938" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="402938" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert6_attn_out -->
<g id="node1414" class="node">
<title>layer9_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="402821,-1794.68 402621,-1794.68 402621,-1750.68 402821,-1750.68 402821,-1794.68"/>
<text text-anchor="middle" x="402721" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="402721" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="402721" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="402721" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert6_attn_ar -->
<g id="node1415" class="node">
<title>layer9_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="402462" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="402462" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="402462" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="402462" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="402462" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert6_attn_res -->
<g id="node1416" class="node">
<title>layer9_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="402302.2,-1816.68 401972.59,-1816.68 401887.8,-1728.68 402217.41,-1728.68 402302.2,-1816.68"/>
<text text-anchor="middle" x="402095" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="402095" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="402095" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="402095" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert6_ln1 -->
<g id="node1417" class="node">
<title>layer9_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="401870,-1794.68 401670,-1794.68 401670,-1750.68 401870,-1750.68 401870,-1794.68"/>
<text text-anchor="middle" x="401770" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="401770" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="401770" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="401770" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert6_mlp1 -->
<g id="node1418" class="node">
<title>layer9_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="401652,-1794.68 401456,-1794.68 401456,-1750.68 401652,-1750.68 401652,-1794.68"/>
<text text-anchor="middle" x="401554" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="401554" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="401554" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="401554" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert6_gelu -->
<g id="node1419" class="node">
<title>layer9_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="401438,-1794.68 401242,-1794.68 401242,-1750.68 401438,-1750.68 401438,-1794.68"/>
<text text-anchor="middle" x="401340" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="401340" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="401340" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="401340" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert6_mlp2 -->
<g id="node1420" class="node">
<title>layer9_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="401224,-1794.68 401024,-1794.68 401024,-1750.68 401224,-1750.68 401224,-1794.68"/>
<text text-anchor="middle" x="401124" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="401124" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="401124" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="401124" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert6_mlp_ar -->
<g id="node1421" class="node">
<title>layer9_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="400865" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="400865" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="400865" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="400865" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="400865" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert6_mlp_res -->
<g id="node1422" class="node">
<title>layer9_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="400705.2,-1816.68 400375.59,-1816.68 400290.8,-1728.68 400620.41,-1728.68 400705.2,-1816.68"/>
<text text-anchor="middle" x="400498" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="400498" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="400498" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="400498" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert6_ln2 -->
<g id="node1423" class="node">
<title>layer9_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="400273,-1794.68 400073,-1794.68 400073,-1750.68 400273,-1750.68 400273,-1794.68"/>
<text text-anchor="middle" x="400173" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="400173" y="-1775.28" font-family="Arial" font-size="8.00">L9_E6</text>
<text text-anchor="middle" x="400173" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="400173" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert7_route -->
<g id="node1424" class="node">
<title>layer9_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="400049,-1794.68 399849,-1794.68 399849,-1750.68 400049,-1750.68 400049,-1794.68"/>
<text text-anchor="middle" x="399949" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="399949" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="399949" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="399949" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert7_gate -->
<g id="node1425" class="node">
<title>layer9_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="399831.04,-1816.68 399516,-1816.68 399434.96,-1728.68 399750,-1728.68 399831.04,-1816.68"/>
<text text-anchor="middle" x="399633" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="399633" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="399633" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="399633" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer9_expert7_a2a -->
<g id="node1426" class="node">
<title>layer9_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="399276" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="399276" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="399276" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="399276" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="399276" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert7_attn_split -->
<g id="node1427" class="node">
<title>layer9_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="399116.48,-1816.68 398791.2,-1816.68 398707.52,-1728.68 399032.8,-1728.68 399116.48,-1816.68"/>
<text text-anchor="middle" x="398912" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="398912" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="398912" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="398912" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert7_q_proj -->
<g id="node1428" class="node">
<title>layer9_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="398689.5,-1794.68 398492.5,-1794.68 398492.5,-1750.68 398689.5,-1750.68 398689.5,-1794.68"/>
<text text-anchor="middle" x="398591" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="398591" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="398591" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="398591" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert7_k_proj -->
<g id="node1429" class="node">
<title>layer9_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="398474.5,-1794.68 398277.5,-1794.68 398277.5,-1750.68 398474.5,-1750.68 398474.5,-1794.68"/>
<text text-anchor="middle" x="398376" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="398376" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="398376" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="398376" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert7_v_proj -->
<g id="node1430" class="node">
<title>layer9_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="398259.5,-1794.68 398062.5,-1794.68 398062.5,-1750.68 398259.5,-1750.68 398259.5,-1794.68"/>
<text text-anchor="middle" x="398161" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="398161" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="398161" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="398161" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert7_attn -->
<g id="node1431" class="node">
<title>layer9_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="398044.5,-1794.68 397847.5,-1794.68 397847.5,-1750.68 398044.5,-1750.68 398044.5,-1794.68"/>
<text text-anchor="middle" x="397946" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="397946" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="397946" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="397946" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer9_expert7_attn_out -->
<g id="node1432" class="node">
<title>layer9_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="397829,-1794.68 397629,-1794.68 397629,-1750.68 397829,-1750.68 397829,-1794.68"/>
<text text-anchor="middle" x="397729" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="397729" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="397729" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="397729" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert7_attn_ar -->
<g id="node1433" class="node">
<title>layer9_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="397470" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="397470" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="397470" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="397470" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="397470" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert7_attn_res -->
<g id="node1434" class="node">
<title>layer9_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="397310.2,-1816.68 396980.59,-1816.68 396895.8,-1728.68 397225.41,-1728.68 397310.2,-1816.68"/>
<text text-anchor="middle" x="397103" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="397103" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="397103" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="397103" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert7_ln1 -->
<g id="node1435" class="node">
<title>layer9_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="396878,-1794.68 396678,-1794.68 396678,-1750.68 396878,-1750.68 396878,-1794.68"/>
<text text-anchor="middle" x="396778" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="396778" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="396778" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="396778" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert7_mlp1 -->
<g id="node1436" class="node">
<title>layer9_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="396660,-1794.68 396464,-1794.68 396464,-1750.68 396660,-1750.68 396660,-1794.68"/>
<text text-anchor="middle" x="396562" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="396562" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="396562" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="396562" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert7_gelu -->
<g id="node1437" class="node">
<title>layer9_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="396446,-1794.68 396250,-1794.68 396250,-1750.68 396446,-1750.68 396446,-1794.68"/>
<text text-anchor="middle" x="396348" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="396348" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="396348" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="396348" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer9_expert7_mlp2 -->
<g id="node1438" class="node">
<title>layer9_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="396232,-1794.68 396032,-1794.68 396032,-1750.68 396232,-1750.68 396232,-1794.68"/>
<text text-anchor="middle" x="396132" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="396132" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="396132" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="396132" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert7_mlp_ar -->
<g id="node1439" class="node">
<title>layer9_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="395873" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="395873" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="395873" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="395873" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="395873" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert7_mlp_res -->
<g id="node1440" class="node">
<title>layer9_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="395713.2,-1816.68 395383.59,-1816.68 395298.8,-1728.68 395628.41,-1728.68 395713.2,-1816.68"/>
<text text-anchor="middle" x="395506" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="395506" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="395506" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="395506" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer9_expert7_ln2 -->
<g id="node1441" class="node">
<title>layer9_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="395281,-1794.68 395081,-1794.68 395081,-1750.68 395281,-1750.68 395281,-1794.68"/>
<text text-anchor="middle" x="395181" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="395181" y="-1775.28" font-family="Arial" font-size="8.00">L9_E7</text>
<text text-anchor="middle" x="395181" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="395181" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert0_route -->
<g id="node1442" class="node">
<title>layer10_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="395041,-1794.68 394841,-1794.68 394841,-1750.68 395041,-1750.68 395041,-1794.68"/>
<text text-anchor="middle" x="394941" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="394941" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="394941" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="394941" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert0_gate -->
<g id="node1443" class="node">
<title>layer10_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="394823.04,-1816.68 394508,-1816.68 394426.96,-1728.68 394742,-1728.68 394823.04,-1816.68"/>
<text text-anchor="middle" x="394625" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="394625" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="394625" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="394625" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer10_expert0_a2a -->
<g id="node1444" class="node">
<title>layer10_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="394268" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="394268" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="394268" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="394268" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="394268" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert0_attn_split -->
<g id="node1445" class="node">
<title>layer10_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="394108.48,-1816.68 393783.2,-1816.68 393699.52,-1728.68 394024.8,-1728.68 394108.48,-1816.68"/>
<text text-anchor="middle" x="393904" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="393904" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="393904" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="393904" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert0_q_proj -->
<g id="node1446" class="node">
<title>layer10_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="393681.5,-1794.68 393484.5,-1794.68 393484.5,-1750.68 393681.5,-1750.68 393681.5,-1794.68"/>
<text text-anchor="middle" x="393583" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="393583" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="393583" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="393583" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert0_k_proj -->
<g id="node1447" class="node">
<title>layer10_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="393466.5,-1794.68 393269.5,-1794.68 393269.5,-1750.68 393466.5,-1750.68 393466.5,-1794.68"/>
<text text-anchor="middle" x="393368" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="393368" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="393368" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="393368" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert0_v_proj -->
<g id="node1448" class="node">
<title>layer10_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="393251.5,-1794.68 393054.5,-1794.68 393054.5,-1750.68 393251.5,-1750.68 393251.5,-1794.68"/>
<text text-anchor="middle" x="393153" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="393153" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="393153" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="393153" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert0_attn -->
<g id="node1449" class="node">
<title>layer10_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="393036.5,-1794.68 392839.5,-1794.68 392839.5,-1750.68 393036.5,-1750.68 393036.5,-1794.68"/>
<text text-anchor="middle" x="392938" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="392938" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="392938" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="392938" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert0_attn_out -->
<g id="node1450" class="node">
<title>layer10_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="392821,-1794.68 392621,-1794.68 392621,-1750.68 392821,-1750.68 392821,-1794.68"/>
<text text-anchor="middle" x="392721" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="392721" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="392721" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="392721" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert0_attn_ar -->
<g id="node1451" class="node">
<title>layer10_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="392462" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="392462" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="392462" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="392462" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="392462" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert0_attn_res -->
<g id="node1452" class="node">
<title>layer10_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="392302.2,-1816.68 391972.59,-1816.68 391887.8,-1728.68 392217.41,-1728.68 392302.2,-1816.68"/>
<text text-anchor="middle" x="392095" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="392095" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="392095" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="392095" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert0_ln1 -->
<g id="node1453" class="node">
<title>layer10_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="391870,-1794.68 391670,-1794.68 391670,-1750.68 391870,-1750.68 391870,-1794.68"/>
<text text-anchor="middle" x="391770" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="391770" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="391770" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="391770" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert0_mlp1 -->
<g id="node1454" class="node">
<title>layer10_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="391652,-1794.68 391456,-1794.68 391456,-1750.68 391652,-1750.68 391652,-1794.68"/>
<text text-anchor="middle" x="391554" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="391554" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="391554" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="391554" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert0_gelu -->
<g id="node1455" class="node">
<title>layer10_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="391438,-1794.68 391242,-1794.68 391242,-1750.68 391438,-1750.68 391438,-1794.68"/>
<text text-anchor="middle" x="391340" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="391340" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="391340" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="391340" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert0_mlp2 -->
<g id="node1456" class="node">
<title>layer10_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="391224,-1794.68 391024,-1794.68 391024,-1750.68 391224,-1750.68 391224,-1794.68"/>
<text text-anchor="middle" x="391124" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="391124" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="391124" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="391124" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert0_mlp_ar -->
<g id="node1457" class="node">
<title>layer10_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="390865" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="390865" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="390865" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="390865" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="390865" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert0_mlp_res -->
<g id="node1458" class="node">
<title>layer10_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="390705.2,-1816.68 390375.59,-1816.68 390290.8,-1728.68 390620.41,-1728.68 390705.2,-1816.68"/>
<text text-anchor="middle" x="390498" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="390498" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="390498" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="390498" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert0_ln2 -->
<g id="node1459" class="node">
<title>layer10_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="390273,-1794.68 390073,-1794.68 390073,-1750.68 390273,-1750.68 390273,-1794.68"/>
<text text-anchor="middle" x="390173" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="390173" y="-1775.28" font-family="Arial" font-size="8.00">L10_E0</text>
<text text-anchor="middle" x="390173" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="390173" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert1_route -->
<g id="node1460" class="node">
<title>layer10_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="390049,-1794.68 389849,-1794.68 389849,-1750.68 390049,-1750.68 390049,-1794.68"/>
<text text-anchor="middle" x="389949" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="389949" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="389949" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="389949" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert1_gate -->
<g id="node1461" class="node">
<title>layer10_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="389831.04,-1816.68 389516,-1816.68 389434.96,-1728.68 389750,-1728.68 389831.04,-1816.68"/>
<text text-anchor="middle" x="389633" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="389633" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="389633" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="389633" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer10_expert1_a2a -->
<g id="node1462" class="node">
<title>layer10_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="389276" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="389276" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="389276" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="389276" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="389276" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert1_attn_split -->
<g id="node1463" class="node">
<title>layer10_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="389116.48,-1816.68 388791.2,-1816.68 388707.52,-1728.68 389032.8,-1728.68 389116.48,-1816.68"/>
<text text-anchor="middle" x="388912" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="388912" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="388912" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="388912" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert1_q_proj -->
<g id="node1464" class="node">
<title>layer10_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="388689.5,-1794.68 388492.5,-1794.68 388492.5,-1750.68 388689.5,-1750.68 388689.5,-1794.68"/>
<text text-anchor="middle" x="388591" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="388591" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="388591" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="388591" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert1_k_proj -->
<g id="node1465" class="node">
<title>layer10_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="388474.5,-1794.68 388277.5,-1794.68 388277.5,-1750.68 388474.5,-1750.68 388474.5,-1794.68"/>
<text text-anchor="middle" x="388376" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="388376" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="388376" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="388376" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert1_v_proj -->
<g id="node1466" class="node">
<title>layer10_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="388259.5,-1794.68 388062.5,-1794.68 388062.5,-1750.68 388259.5,-1750.68 388259.5,-1794.68"/>
<text text-anchor="middle" x="388161" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="388161" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="388161" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="388161" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert1_attn -->
<g id="node1467" class="node">
<title>layer10_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="388044.5,-1794.68 387847.5,-1794.68 387847.5,-1750.68 388044.5,-1750.68 388044.5,-1794.68"/>
<text text-anchor="middle" x="387946" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="387946" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="387946" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="387946" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert1_attn_out -->
<g id="node1468" class="node">
<title>layer10_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="387829,-1794.68 387629,-1794.68 387629,-1750.68 387829,-1750.68 387829,-1794.68"/>
<text text-anchor="middle" x="387729" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="387729" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="387729" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="387729" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert1_attn_ar -->
<g id="node1469" class="node">
<title>layer10_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="387470" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="387470" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="387470" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="387470" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="387470" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert1_attn_res -->
<g id="node1470" class="node">
<title>layer10_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="387310.2,-1816.68 386980.59,-1816.68 386895.8,-1728.68 387225.41,-1728.68 387310.2,-1816.68"/>
<text text-anchor="middle" x="387103" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="387103" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="387103" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="387103" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert1_ln1 -->
<g id="node1471" class="node">
<title>layer10_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="386878,-1794.68 386678,-1794.68 386678,-1750.68 386878,-1750.68 386878,-1794.68"/>
<text text-anchor="middle" x="386778" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="386778" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="386778" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="386778" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert1_mlp1 -->
<g id="node1472" class="node">
<title>layer10_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="386660,-1794.68 386464,-1794.68 386464,-1750.68 386660,-1750.68 386660,-1794.68"/>
<text text-anchor="middle" x="386562" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="386562" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="386562" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="386562" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert1_gelu -->
<g id="node1473" class="node">
<title>layer10_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="386446,-1794.68 386250,-1794.68 386250,-1750.68 386446,-1750.68 386446,-1794.68"/>
<text text-anchor="middle" x="386348" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="386348" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="386348" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="386348" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert1_mlp2 -->
<g id="node1474" class="node">
<title>layer10_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="386232,-1794.68 386032,-1794.68 386032,-1750.68 386232,-1750.68 386232,-1794.68"/>
<text text-anchor="middle" x="386132" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="386132" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="386132" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="386132" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert1_mlp_ar -->
<g id="node1475" class="node">
<title>layer10_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="385873" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="385873" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="385873" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="385873" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="385873" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert1_mlp_res -->
<g id="node1476" class="node">
<title>layer10_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="385713.2,-1816.68 385383.59,-1816.68 385298.8,-1728.68 385628.41,-1728.68 385713.2,-1816.68"/>
<text text-anchor="middle" x="385506" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="385506" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="385506" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="385506" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert1_ln2 -->
<g id="node1477" class="node">
<title>layer10_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="385281,-1794.68 385081,-1794.68 385081,-1750.68 385281,-1750.68 385281,-1794.68"/>
<text text-anchor="middle" x="385181" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="385181" y="-1775.28" font-family="Arial" font-size="8.00">L10_E1</text>
<text text-anchor="middle" x="385181" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="385181" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert2_route -->
<g id="node1478" class="node">
<title>layer10_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="385057,-1794.68 384857,-1794.68 384857,-1750.68 385057,-1750.68 385057,-1794.68"/>
<text text-anchor="middle" x="384957" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="384957" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="384957" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="384957" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert2_gate -->
<g id="node1479" class="node">
<title>layer10_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="384839.04,-1816.68 384524,-1816.68 384442.96,-1728.68 384758,-1728.68 384839.04,-1816.68"/>
<text text-anchor="middle" x="384641" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="384641" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="384641" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="384641" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer10_expert2_a2a -->
<g id="node1480" class="node">
<title>layer10_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="384284" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="384284" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="384284" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="384284" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="384284" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert2_attn_split -->
<g id="node1481" class="node">
<title>layer10_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="384124.48,-1816.68 383799.2,-1816.68 383715.52,-1728.68 384040.8,-1728.68 384124.48,-1816.68"/>
<text text-anchor="middle" x="383920" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="383920" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="383920" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="383920" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert2_q_proj -->
<g id="node1482" class="node">
<title>layer10_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="383697.5,-1794.68 383500.5,-1794.68 383500.5,-1750.68 383697.5,-1750.68 383697.5,-1794.68"/>
<text text-anchor="middle" x="383599" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="383599" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="383599" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="383599" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert2_k_proj -->
<g id="node1483" class="node">
<title>layer10_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="383482.5,-1794.68 383285.5,-1794.68 383285.5,-1750.68 383482.5,-1750.68 383482.5,-1794.68"/>
<text text-anchor="middle" x="383384" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="383384" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="383384" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="383384" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert2_v_proj -->
<g id="node1484" class="node">
<title>layer10_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="383267.5,-1794.68 383070.5,-1794.68 383070.5,-1750.68 383267.5,-1750.68 383267.5,-1794.68"/>
<text text-anchor="middle" x="383169" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="383169" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="383169" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="383169" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert2_attn -->
<g id="node1485" class="node">
<title>layer10_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="383052.5,-1794.68 382855.5,-1794.68 382855.5,-1750.68 383052.5,-1750.68 383052.5,-1794.68"/>
<text text-anchor="middle" x="382954" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="382954" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="382954" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="382954" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert2_attn_out -->
<g id="node1486" class="node">
<title>layer10_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="382837,-1794.68 382637,-1794.68 382637,-1750.68 382837,-1750.68 382837,-1794.68"/>
<text text-anchor="middle" x="382737" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="382737" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="382737" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="382737" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert2_attn_ar -->
<g id="node1487" class="node">
<title>layer10_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="382478" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="382478" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="382478" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="382478" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="382478" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert2_attn_res -->
<g id="node1488" class="node">
<title>layer10_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="382318.2,-1816.68 381988.59,-1816.68 381903.8,-1728.68 382233.41,-1728.68 382318.2,-1816.68"/>
<text text-anchor="middle" x="382111" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="382111" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="382111" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="382111" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert2_ln1 -->
<g id="node1489" class="node">
<title>layer10_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="381886,-1794.68 381686,-1794.68 381686,-1750.68 381886,-1750.68 381886,-1794.68"/>
<text text-anchor="middle" x="381786" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="381786" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="381786" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="381786" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert2_mlp1 -->
<g id="node1490" class="node">
<title>layer10_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="381668,-1794.68 381472,-1794.68 381472,-1750.68 381668,-1750.68 381668,-1794.68"/>
<text text-anchor="middle" x="381570" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="381570" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="381570" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="381570" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert2_gelu -->
<g id="node1491" class="node">
<title>layer10_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="381454,-1794.68 381258,-1794.68 381258,-1750.68 381454,-1750.68 381454,-1794.68"/>
<text text-anchor="middle" x="381356" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="381356" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="381356" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="381356" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert2_mlp2 -->
<g id="node1492" class="node">
<title>layer10_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="381240,-1794.68 381040,-1794.68 381040,-1750.68 381240,-1750.68 381240,-1794.68"/>
<text text-anchor="middle" x="381140" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="381140" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="381140" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="381140" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert2_mlp_ar -->
<g id="node1493" class="node">
<title>layer10_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="380881" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="380881" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="380881" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="380881" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="380881" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert2_mlp_res -->
<g id="node1494" class="node">
<title>layer10_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="380721.2,-1816.68 380391.59,-1816.68 380306.8,-1728.68 380636.41,-1728.68 380721.2,-1816.68"/>
<text text-anchor="middle" x="380514" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="380514" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="380514" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="380514" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert2_ln2 -->
<g id="node1495" class="node">
<title>layer10_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="380289,-1794.68 380089,-1794.68 380089,-1750.68 380289,-1750.68 380289,-1794.68"/>
<text text-anchor="middle" x="380189" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="380189" y="-1775.28" font-family="Arial" font-size="8.00">L10_E2</text>
<text text-anchor="middle" x="380189" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="380189" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert3_route -->
<g id="node1496" class="node">
<title>layer10_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="380065,-1794.68 379865,-1794.68 379865,-1750.68 380065,-1750.68 380065,-1794.68"/>
<text text-anchor="middle" x="379965" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="379965" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="379965" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="379965" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert3_gate -->
<g id="node1497" class="node">
<title>layer10_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="379847.04,-1816.68 379532,-1816.68 379450.96,-1728.68 379766,-1728.68 379847.04,-1816.68"/>
<text text-anchor="middle" x="379649" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="379649" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="379649" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="379649" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer10_expert3_a2a -->
<g id="node1498" class="node">
<title>layer10_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="379292" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="379292" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="379292" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="379292" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="379292" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert3_attn_split -->
<g id="node1499" class="node">
<title>layer10_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="379132.48,-1816.68 378807.2,-1816.68 378723.52,-1728.68 379048.8,-1728.68 379132.48,-1816.68"/>
<text text-anchor="middle" x="378928" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="378928" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="378928" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="378928" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert3_q_proj -->
<g id="node1500" class="node">
<title>layer10_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="378705.5,-1794.68 378508.5,-1794.68 378508.5,-1750.68 378705.5,-1750.68 378705.5,-1794.68"/>
<text text-anchor="middle" x="378607" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="378607" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="378607" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="378607" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert3_k_proj -->
<g id="node1501" class="node">
<title>layer10_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="378490.5,-1794.68 378293.5,-1794.68 378293.5,-1750.68 378490.5,-1750.68 378490.5,-1794.68"/>
<text text-anchor="middle" x="378392" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="378392" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="378392" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="378392" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert3_v_proj -->
<g id="node1502" class="node">
<title>layer10_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="378275.5,-1794.68 378078.5,-1794.68 378078.5,-1750.68 378275.5,-1750.68 378275.5,-1794.68"/>
<text text-anchor="middle" x="378177" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="378177" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="378177" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="378177" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert3_attn -->
<g id="node1503" class="node">
<title>layer10_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="378060.5,-1794.68 377863.5,-1794.68 377863.5,-1750.68 378060.5,-1750.68 378060.5,-1794.68"/>
<text text-anchor="middle" x="377962" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="377962" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="377962" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="377962" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert3_attn_out -->
<g id="node1504" class="node">
<title>layer10_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="377845,-1794.68 377645,-1794.68 377645,-1750.68 377845,-1750.68 377845,-1794.68"/>
<text text-anchor="middle" x="377745" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="377745" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="377745" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="377745" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert3_attn_ar -->
<g id="node1505" class="node">
<title>layer10_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="377486" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="377486" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="377486" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="377486" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="377486" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert3_attn_res -->
<g id="node1506" class="node">
<title>layer10_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="377326.2,-1816.68 376996.59,-1816.68 376911.8,-1728.68 377241.41,-1728.68 377326.2,-1816.68"/>
<text text-anchor="middle" x="377119" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="377119" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="377119" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="377119" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert3_ln1 -->
<g id="node1507" class="node">
<title>layer10_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="376894,-1794.68 376694,-1794.68 376694,-1750.68 376894,-1750.68 376894,-1794.68"/>
<text text-anchor="middle" x="376794" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="376794" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="376794" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="376794" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert3_mlp1 -->
<g id="node1508" class="node">
<title>layer10_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="376676,-1794.68 376480,-1794.68 376480,-1750.68 376676,-1750.68 376676,-1794.68"/>
<text text-anchor="middle" x="376578" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="376578" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="376578" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="376578" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert3_gelu -->
<g id="node1509" class="node">
<title>layer10_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="376462,-1794.68 376266,-1794.68 376266,-1750.68 376462,-1750.68 376462,-1794.68"/>
<text text-anchor="middle" x="376364" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="376364" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="376364" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="376364" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert3_mlp2 -->
<g id="node1510" class="node">
<title>layer10_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="376248,-1794.68 376048,-1794.68 376048,-1750.68 376248,-1750.68 376248,-1794.68"/>
<text text-anchor="middle" x="376148" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="376148" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="376148" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="376148" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert3_mlp_ar -->
<g id="node1511" class="node">
<title>layer10_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="375889" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="375889" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="375889" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="375889" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="375889" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert3_mlp_res -->
<g id="node1512" class="node">
<title>layer10_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="375729.2,-1816.68 375399.59,-1816.68 375314.8,-1728.68 375644.41,-1728.68 375729.2,-1816.68"/>
<text text-anchor="middle" x="375522" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="375522" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="375522" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="375522" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert3_ln2 -->
<g id="node1513" class="node">
<title>layer10_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="375297,-1794.68 375097,-1794.68 375097,-1750.68 375297,-1750.68 375297,-1794.68"/>
<text text-anchor="middle" x="375197" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="375197" y="-1775.28" font-family="Arial" font-size="8.00">L10_E3</text>
<text text-anchor="middle" x="375197" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="375197" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert4_route -->
<g id="node1514" class="node">
<title>layer10_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="375073,-1794.68 374873,-1794.68 374873,-1750.68 375073,-1750.68 375073,-1794.68"/>
<text text-anchor="middle" x="374973" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="374973" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="374973" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="374973" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert4_gate -->
<g id="node1515" class="node">
<title>layer10_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="374855.04,-1816.68 374540,-1816.68 374458.96,-1728.68 374774,-1728.68 374855.04,-1816.68"/>
<text text-anchor="middle" x="374657" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="374657" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="374657" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="374657" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer10_expert4_a2a -->
<g id="node1516" class="node">
<title>layer10_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="374300" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="374300" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="374300" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="374300" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="374300" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert4_attn_split -->
<g id="node1517" class="node">
<title>layer10_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="374140.48,-1816.68 373815.2,-1816.68 373731.52,-1728.68 374056.8,-1728.68 374140.48,-1816.68"/>
<text text-anchor="middle" x="373936" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="373936" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="373936" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="373936" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert4_q_proj -->
<g id="node1518" class="node">
<title>layer10_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="373713.5,-1794.68 373516.5,-1794.68 373516.5,-1750.68 373713.5,-1750.68 373713.5,-1794.68"/>
<text text-anchor="middle" x="373615" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="373615" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="373615" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="373615" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert4_k_proj -->
<g id="node1519" class="node">
<title>layer10_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="373498.5,-1794.68 373301.5,-1794.68 373301.5,-1750.68 373498.5,-1750.68 373498.5,-1794.68"/>
<text text-anchor="middle" x="373400" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="373400" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="373400" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="373400" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert4_v_proj -->
<g id="node1520" class="node">
<title>layer10_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="373283.5,-1794.68 373086.5,-1794.68 373086.5,-1750.68 373283.5,-1750.68 373283.5,-1794.68"/>
<text text-anchor="middle" x="373185" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="373185" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="373185" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="373185" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert4_attn -->
<g id="node1521" class="node">
<title>layer10_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="373068.5,-1794.68 372871.5,-1794.68 372871.5,-1750.68 373068.5,-1750.68 373068.5,-1794.68"/>
<text text-anchor="middle" x="372970" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="372970" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="372970" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="372970" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert4_attn_out -->
<g id="node1522" class="node">
<title>layer10_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="372853,-1794.68 372653,-1794.68 372653,-1750.68 372853,-1750.68 372853,-1794.68"/>
<text text-anchor="middle" x="372753" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="372753" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="372753" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="372753" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert4_attn_ar -->
<g id="node1523" class="node">
<title>layer10_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="372494" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="372494" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="372494" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="372494" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="372494" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert4_attn_res -->
<g id="node1524" class="node">
<title>layer10_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="372334.2,-1816.68 372004.59,-1816.68 371919.8,-1728.68 372249.41,-1728.68 372334.2,-1816.68"/>
<text text-anchor="middle" x="372127" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="372127" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="372127" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="372127" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert4_ln1 -->
<g id="node1525" class="node">
<title>layer10_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="371902,-1794.68 371702,-1794.68 371702,-1750.68 371902,-1750.68 371902,-1794.68"/>
<text text-anchor="middle" x="371802" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="371802" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="371802" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="371802" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert4_mlp1 -->
<g id="node1526" class="node">
<title>layer10_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="371684,-1794.68 371488,-1794.68 371488,-1750.68 371684,-1750.68 371684,-1794.68"/>
<text text-anchor="middle" x="371586" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="371586" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="371586" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="371586" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert4_gelu -->
<g id="node1527" class="node">
<title>layer10_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="371470,-1794.68 371274,-1794.68 371274,-1750.68 371470,-1750.68 371470,-1794.68"/>
<text text-anchor="middle" x="371372" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="371372" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="371372" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="371372" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert4_mlp2 -->
<g id="node1528" class="node">
<title>layer10_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="371256,-1794.68 371056,-1794.68 371056,-1750.68 371256,-1750.68 371256,-1794.68"/>
<text text-anchor="middle" x="371156" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="371156" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="371156" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="371156" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert4_mlp_ar -->
<g id="node1529" class="node">
<title>layer10_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="370897" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="370897" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="370897" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="370897" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="370897" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert4_mlp_res -->
<g id="node1530" class="node">
<title>layer10_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="370737.2,-1816.68 370407.59,-1816.68 370322.8,-1728.68 370652.41,-1728.68 370737.2,-1816.68"/>
<text text-anchor="middle" x="370530" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="370530" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="370530" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="370530" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert4_ln2 -->
<g id="node1531" class="node">
<title>layer10_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="370305,-1794.68 370105,-1794.68 370105,-1750.68 370305,-1750.68 370305,-1794.68"/>
<text text-anchor="middle" x="370205" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="370205" y="-1775.28" font-family="Arial" font-size="8.00">L10_E4</text>
<text text-anchor="middle" x="370205" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="370205" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert5_route -->
<g id="node1532" class="node">
<title>layer10_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="370081,-1794.68 369881,-1794.68 369881,-1750.68 370081,-1750.68 370081,-1794.68"/>
<text text-anchor="middle" x="369981" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="369981" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="369981" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="369981" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert5_gate -->
<g id="node1533" class="node">
<title>layer10_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="369863.04,-1816.68 369548,-1816.68 369466.96,-1728.68 369782,-1728.68 369863.04,-1816.68"/>
<text text-anchor="middle" x="369665" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="369665" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="369665" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="369665" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer10_expert5_a2a -->
<g id="node1534" class="node">
<title>layer10_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="369308" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="369308" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="369308" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="369308" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="369308" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert5_attn_split -->
<g id="node1535" class="node">
<title>layer10_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="369148.48,-1816.68 368823.2,-1816.68 368739.52,-1728.68 369064.8,-1728.68 369148.48,-1816.68"/>
<text text-anchor="middle" x="368944" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="368944" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="368944" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="368944" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert5_q_proj -->
<g id="node1536" class="node">
<title>layer10_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="368721.5,-1794.68 368524.5,-1794.68 368524.5,-1750.68 368721.5,-1750.68 368721.5,-1794.68"/>
<text text-anchor="middle" x="368623" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="368623" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="368623" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="368623" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert5_k_proj -->
<g id="node1537" class="node">
<title>layer10_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="368506.5,-1794.68 368309.5,-1794.68 368309.5,-1750.68 368506.5,-1750.68 368506.5,-1794.68"/>
<text text-anchor="middle" x="368408" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="368408" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="368408" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="368408" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert5_v_proj -->
<g id="node1538" class="node">
<title>layer10_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="368291.5,-1794.68 368094.5,-1794.68 368094.5,-1750.68 368291.5,-1750.68 368291.5,-1794.68"/>
<text text-anchor="middle" x="368193" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="368193" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="368193" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="368193" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert5_attn -->
<g id="node1539" class="node">
<title>layer10_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="368076.5,-1794.68 367879.5,-1794.68 367879.5,-1750.68 368076.5,-1750.68 368076.5,-1794.68"/>
<text text-anchor="middle" x="367978" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="367978" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="367978" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="367978" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert5_attn_out -->
<g id="node1540" class="node">
<title>layer10_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="367861,-1794.68 367661,-1794.68 367661,-1750.68 367861,-1750.68 367861,-1794.68"/>
<text text-anchor="middle" x="367761" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="367761" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="367761" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="367761" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert5_attn_ar -->
<g id="node1541" class="node">
<title>layer10_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="367502" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="367502" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="367502" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="367502" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="367502" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert5_attn_res -->
<g id="node1542" class="node">
<title>layer10_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="367342.2,-1816.68 367012.59,-1816.68 366927.8,-1728.68 367257.41,-1728.68 367342.2,-1816.68"/>
<text text-anchor="middle" x="367135" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="367135" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="367135" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="367135" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert5_ln1 -->
<g id="node1543" class="node">
<title>layer10_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="366910,-1794.68 366710,-1794.68 366710,-1750.68 366910,-1750.68 366910,-1794.68"/>
<text text-anchor="middle" x="366810" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="366810" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="366810" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="366810" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert5_mlp1 -->
<g id="node1544" class="node">
<title>layer10_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="366692,-1794.68 366496,-1794.68 366496,-1750.68 366692,-1750.68 366692,-1794.68"/>
<text text-anchor="middle" x="366594" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="366594" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="366594" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="366594" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert5_gelu -->
<g id="node1545" class="node">
<title>layer10_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="366478,-1794.68 366282,-1794.68 366282,-1750.68 366478,-1750.68 366478,-1794.68"/>
<text text-anchor="middle" x="366380" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="366380" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="366380" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="366380" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert5_mlp2 -->
<g id="node1546" class="node">
<title>layer10_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="366264,-1794.68 366064,-1794.68 366064,-1750.68 366264,-1750.68 366264,-1794.68"/>
<text text-anchor="middle" x="366164" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="366164" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="366164" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="366164" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert5_mlp_ar -->
<g id="node1547" class="node">
<title>layer10_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="365905" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="365905" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="365905" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="365905" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="365905" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert5_mlp_res -->
<g id="node1548" class="node">
<title>layer10_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="365745.2,-1816.68 365415.59,-1816.68 365330.8,-1728.68 365660.41,-1728.68 365745.2,-1816.68"/>
<text text-anchor="middle" x="365538" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="365538" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="365538" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="365538" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert5_ln2 -->
<g id="node1549" class="node">
<title>layer10_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="365313,-1794.68 365113,-1794.68 365113,-1750.68 365313,-1750.68 365313,-1794.68"/>
<text text-anchor="middle" x="365213" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="365213" y="-1775.28" font-family="Arial" font-size="8.00">L10_E5</text>
<text text-anchor="middle" x="365213" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="365213" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert6_route -->
<g id="node1550" class="node">
<title>layer10_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="365089,-1794.68 364889,-1794.68 364889,-1750.68 365089,-1750.68 365089,-1794.68"/>
<text text-anchor="middle" x="364989" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="364989" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="364989" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="364989" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert6_gate -->
<g id="node1551" class="node">
<title>layer10_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="364871.04,-1816.68 364556,-1816.68 364474.96,-1728.68 364790,-1728.68 364871.04,-1816.68"/>
<text text-anchor="middle" x="364673" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="364673" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="364673" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="364673" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer10_expert6_a2a -->
<g id="node1552" class="node">
<title>layer10_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="364316" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="364316" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="364316" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="364316" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="364316" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert6_attn_split -->
<g id="node1553" class="node">
<title>layer10_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="364156.48,-1816.68 363831.2,-1816.68 363747.52,-1728.68 364072.8,-1728.68 364156.48,-1816.68"/>
<text text-anchor="middle" x="363952" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="363952" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="363952" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="363952" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert6_q_proj -->
<g id="node1554" class="node">
<title>layer10_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="363729.5,-1794.68 363532.5,-1794.68 363532.5,-1750.68 363729.5,-1750.68 363729.5,-1794.68"/>
<text text-anchor="middle" x="363631" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="363631" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="363631" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="363631" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert6_k_proj -->
<g id="node1555" class="node">
<title>layer10_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="363514.5,-1794.68 363317.5,-1794.68 363317.5,-1750.68 363514.5,-1750.68 363514.5,-1794.68"/>
<text text-anchor="middle" x="363416" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="363416" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="363416" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="363416" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert6_v_proj -->
<g id="node1556" class="node">
<title>layer10_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="363299.5,-1794.68 363102.5,-1794.68 363102.5,-1750.68 363299.5,-1750.68 363299.5,-1794.68"/>
<text text-anchor="middle" x="363201" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="363201" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="363201" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="363201" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert6_attn -->
<g id="node1557" class="node">
<title>layer10_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="363084.5,-1794.68 362887.5,-1794.68 362887.5,-1750.68 363084.5,-1750.68 363084.5,-1794.68"/>
<text text-anchor="middle" x="362986" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="362986" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="362986" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="362986" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert6_attn_out -->
<g id="node1558" class="node">
<title>layer10_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="362869,-1794.68 362669,-1794.68 362669,-1750.68 362869,-1750.68 362869,-1794.68"/>
<text text-anchor="middle" x="362769" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="362769" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="362769" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="362769" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert6_attn_ar -->
<g id="node1559" class="node">
<title>layer10_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="362510" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="362510" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="362510" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="362510" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="362510" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert6_attn_res -->
<g id="node1560" class="node">
<title>layer10_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="362350.2,-1816.68 362020.59,-1816.68 361935.8,-1728.68 362265.41,-1728.68 362350.2,-1816.68"/>
<text text-anchor="middle" x="362143" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="362143" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="362143" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="362143" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert6_ln1 -->
<g id="node1561" class="node">
<title>layer10_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="361918,-1794.68 361718,-1794.68 361718,-1750.68 361918,-1750.68 361918,-1794.68"/>
<text text-anchor="middle" x="361818" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="361818" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="361818" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="361818" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert6_mlp1 -->
<g id="node1562" class="node">
<title>layer10_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="361700,-1794.68 361504,-1794.68 361504,-1750.68 361700,-1750.68 361700,-1794.68"/>
<text text-anchor="middle" x="361602" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="361602" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="361602" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="361602" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert6_gelu -->
<g id="node1563" class="node">
<title>layer10_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="361486,-1794.68 361290,-1794.68 361290,-1750.68 361486,-1750.68 361486,-1794.68"/>
<text text-anchor="middle" x="361388" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="361388" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="361388" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="361388" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert6_mlp2 -->
<g id="node1564" class="node">
<title>layer10_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="361272,-1794.68 361072,-1794.68 361072,-1750.68 361272,-1750.68 361272,-1794.68"/>
<text text-anchor="middle" x="361172" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="361172" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="361172" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="361172" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert6_mlp_ar -->
<g id="node1565" class="node">
<title>layer10_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="360913" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="360913" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="360913" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="360913" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="360913" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert6_mlp_res -->
<g id="node1566" class="node">
<title>layer10_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="360753.2,-1816.68 360423.59,-1816.68 360338.8,-1728.68 360668.41,-1728.68 360753.2,-1816.68"/>
<text text-anchor="middle" x="360546" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="360546" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="360546" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="360546" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert6_ln2 -->
<g id="node1567" class="node">
<title>layer10_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="360321,-1794.68 360121,-1794.68 360121,-1750.68 360321,-1750.68 360321,-1794.68"/>
<text text-anchor="middle" x="360221" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="360221" y="-1775.28" font-family="Arial" font-size="8.00">L10_E6</text>
<text text-anchor="middle" x="360221" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="360221" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert7_route -->
<g id="node1568" class="node">
<title>layer10_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="360097,-1794.68 359897,-1794.68 359897,-1750.68 360097,-1750.68 360097,-1794.68"/>
<text text-anchor="middle" x="359997" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="359997" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="359997" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="359997" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert7_gate -->
<g id="node1569" class="node">
<title>layer10_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="359879.04,-1816.68 359564,-1816.68 359482.96,-1728.68 359798,-1728.68 359879.04,-1816.68"/>
<text text-anchor="middle" x="359681" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="359681" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="359681" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="359681" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer10_expert7_a2a -->
<g id="node1570" class="node">
<title>layer10_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="359324" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="359324" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="359324" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="359324" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="359324" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert7_attn_split -->
<g id="node1571" class="node">
<title>layer10_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="359164.48,-1816.68 358839.2,-1816.68 358755.52,-1728.68 359080.8,-1728.68 359164.48,-1816.68"/>
<text text-anchor="middle" x="358960" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="358960" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="358960" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="358960" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert7_q_proj -->
<g id="node1572" class="node">
<title>layer10_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="358737.5,-1794.68 358540.5,-1794.68 358540.5,-1750.68 358737.5,-1750.68 358737.5,-1794.68"/>
<text text-anchor="middle" x="358639" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="358639" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="358639" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="358639" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert7_k_proj -->
<g id="node1573" class="node">
<title>layer10_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="358522.5,-1794.68 358325.5,-1794.68 358325.5,-1750.68 358522.5,-1750.68 358522.5,-1794.68"/>
<text text-anchor="middle" x="358424" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="358424" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="358424" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="358424" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert7_v_proj -->
<g id="node1574" class="node">
<title>layer10_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="358307.5,-1794.68 358110.5,-1794.68 358110.5,-1750.68 358307.5,-1750.68 358307.5,-1794.68"/>
<text text-anchor="middle" x="358209" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="358209" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="358209" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="358209" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert7_attn -->
<g id="node1575" class="node">
<title>layer10_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="358092.5,-1794.68 357895.5,-1794.68 357895.5,-1750.68 358092.5,-1750.68 358092.5,-1794.68"/>
<text text-anchor="middle" x="357994" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="357994" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="357994" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="357994" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer10_expert7_attn_out -->
<g id="node1576" class="node">
<title>layer10_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="357877,-1794.68 357677,-1794.68 357677,-1750.68 357877,-1750.68 357877,-1794.68"/>
<text text-anchor="middle" x="357777" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="357777" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="357777" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="357777" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert7_attn_ar -->
<g id="node1577" class="node">
<title>layer10_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="357518" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="357518" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="357518" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="357518" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="357518" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert7_attn_res -->
<g id="node1578" class="node">
<title>layer10_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="357358.2,-1816.68 357028.59,-1816.68 356943.8,-1728.68 357273.41,-1728.68 357358.2,-1816.68"/>
<text text-anchor="middle" x="357151" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="357151" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="357151" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="357151" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert7_ln1 -->
<g id="node1579" class="node">
<title>layer10_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="356926,-1794.68 356726,-1794.68 356726,-1750.68 356926,-1750.68 356926,-1794.68"/>
<text text-anchor="middle" x="356826" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="356826" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="356826" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="356826" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert7_mlp1 -->
<g id="node1580" class="node">
<title>layer10_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="356708,-1794.68 356512,-1794.68 356512,-1750.68 356708,-1750.68 356708,-1794.68"/>
<text text-anchor="middle" x="356610" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="356610" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="356610" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="356610" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert7_gelu -->
<g id="node1581" class="node">
<title>layer10_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="356494,-1794.68 356298,-1794.68 356298,-1750.68 356494,-1750.68 356494,-1794.68"/>
<text text-anchor="middle" x="356396" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="356396" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="356396" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="356396" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer10_expert7_mlp2 -->
<g id="node1582" class="node">
<title>layer10_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="356280,-1794.68 356080,-1794.68 356080,-1750.68 356280,-1750.68 356280,-1794.68"/>
<text text-anchor="middle" x="356180" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="356180" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="356180" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="356180" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert7_mlp_ar -->
<g id="node1583" class="node">
<title>layer10_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="355921" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="355921" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="355921" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="355921" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="355921" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert7_mlp_res -->
<g id="node1584" class="node">
<title>layer10_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="355761.2,-1816.68 355431.59,-1816.68 355346.8,-1728.68 355676.41,-1728.68 355761.2,-1816.68"/>
<text text-anchor="middle" x="355554" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="355554" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="355554" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="355554" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer10_expert7_ln2 -->
<g id="node1585" class="node">
<title>layer10_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="355329,-1794.68 355129,-1794.68 355129,-1750.68 355329,-1750.68 355329,-1794.68"/>
<text text-anchor="middle" x="355229" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="355229" y="-1775.28" font-family="Arial" font-size="8.00">L10_E7</text>
<text text-anchor="middle" x="355229" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="355229" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert0_route -->
<g id="node1586" class="node">
<title>layer11_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="355089,-1794.68 354889,-1794.68 354889,-1750.68 355089,-1750.68 355089,-1794.68"/>
<text text-anchor="middle" x="354989" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="354989" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="354989" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="354989" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert0_gate -->
<g id="node1587" class="node">
<title>layer11_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="354871.04,-1816.68 354556,-1816.68 354474.96,-1728.68 354790,-1728.68 354871.04,-1816.68"/>
<text text-anchor="middle" x="354673" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="354673" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="354673" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="354673" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer11_expert0_a2a -->
<g id="node1588" class="node">
<title>layer11_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="354316" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="354316" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="354316" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="354316" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="354316" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert0_attn_split -->
<g id="node1589" class="node">
<title>layer11_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="354156.48,-1816.68 353831.2,-1816.68 353747.52,-1728.68 354072.8,-1728.68 354156.48,-1816.68"/>
<text text-anchor="middle" x="353952" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="353952" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="353952" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="353952" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert0_q_proj -->
<g id="node1590" class="node">
<title>layer11_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="353729.5,-1794.68 353532.5,-1794.68 353532.5,-1750.68 353729.5,-1750.68 353729.5,-1794.68"/>
<text text-anchor="middle" x="353631" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="353631" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="353631" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="353631" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert0_k_proj -->
<g id="node1591" class="node">
<title>layer11_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="353514.5,-1794.68 353317.5,-1794.68 353317.5,-1750.68 353514.5,-1750.68 353514.5,-1794.68"/>
<text text-anchor="middle" x="353416" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="353416" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="353416" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="353416" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert0_v_proj -->
<g id="node1592" class="node">
<title>layer11_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="353299.5,-1794.68 353102.5,-1794.68 353102.5,-1750.68 353299.5,-1750.68 353299.5,-1794.68"/>
<text text-anchor="middle" x="353201" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="353201" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="353201" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="353201" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert0_attn -->
<g id="node1593" class="node">
<title>layer11_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="353084.5,-1794.68 352887.5,-1794.68 352887.5,-1750.68 353084.5,-1750.68 353084.5,-1794.68"/>
<text text-anchor="middle" x="352986" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="352986" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="352986" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="352986" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert0_attn_out -->
<g id="node1594" class="node">
<title>layer11_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="352869,-1794.68 352669,-1794.68 352669,-1750.68 352869,-1750.68 352869,-1794.68"/>
<text text-anchor="middle" x="352769" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="352769" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="352769" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="352769" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert0_attn_ar -->
<g id="node1595" class="node">
<title>layer11_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="352510" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="352510" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="352510" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="352510" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="352510" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert0_attn_res -->
<g id="node1596" class="node">
<title>layer11_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="352350.2,-1816.68 352020.59,-1816.68 351935.8,-1728.68 352265.41,-1728.68 352350.2,-1816.68"/>
<text text-anchor="middle" x="352143" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="352143" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="352143" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="352143" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert0_ln1 -->
<g id="node1597" class="node">
<title>layer11_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="351918,-1794.68 351718,-1794.68 351718,-1750.68 351918,-1750.68 351918,-1794.68"/>
<text text-anchor="middle" x="351818" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="351818" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="351818" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="351818" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert0_mlp1 -->
<g id="node1598" class="node">
<title>layer11_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="351700,-1794.68 351504,-1794.68 351504,-1750.68 351700,-1750.68 351700,-1794.68"/>
<text text-anchor="middle" x="351602" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="351602" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="351602" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="351602" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert0_gelu -->
<g id="node1599" class="node">
<title>layer11_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="351486,-1794.68 351290,-1794.68 351290,-1750.68 351486,-1750.68 351486,-1794.68"/>
<text text-anchor="middle" x="351388" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="351388" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="351388" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="351388" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert0_mlp2 -->
<g id="node1600" class="node">
<title>layer11_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="351272,-1794.68 351072,-1794.68 351072,-1750.68 351272,-1750.68 351272,-1794.68"/>
<text text-anchor="middle" x="351172" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="351172" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="351172" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="351172" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert0_mlp_ar -->
<g id="node1601" class="node">
<title>layer11_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="350913" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="350913" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="350913" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="350913" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="350913" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert0_mlp_res -->
<g id="node1602" class="node">
<title>layer11_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="350753.2,-1816.68 350423.59,-1816.68 350338.8,-1728.68 350668.41,-1728.68 350753.2,-1816.68"/>
<text text-anchor="middle" x="350546" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="350546" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="350546" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="350546" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert0_ln2 -->
<g id="node1603" class="node">
<title>layer11_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="350321,-1794.68 350121,-1794.68 350121,-1750.68 350321,-1750.68 350321,-1794.68"/>
<text text-anchor="middle" x="350221" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="350221" y="-1775.28" font-family="Arial" font-size="8.00">L11_E0</text>
<text text-anchor="middle" x="350221" y="-1766.28" font-family="Arial" font-size="8.00">GPU:32</text>
<text text-anchor="middle" x="350221" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert1_route -->
<g id="node1604" class="node">
<title>layer11_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="350097,-1794.68 349897,-1794.68 349897,-1750.68 350097,-1750.68 350097,-1794.68"/>
<text text-anchor="middle" x="349997" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="349997" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="349997" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="349997" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert1_gate -->
<g id="node1605" class="node">
<title>layer11_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="349879.04,-1816.68 349564,-1816.68 349482.96,-1728.68 349798,-1728.68 349879.04,-1816.68"/>
<text text-anchor="middle" x="349681" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="349681" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="349681" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="349681" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer11_expert1_a2a -->
<g id="node1606" class="node">
<title>layer11_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="349324" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="349324" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="349324" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="349324" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="349324" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert1_attn_split -->
<g id="node1607" class="node">
<title>layer11_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="349164.48,-1816.68 348839.2,-1816.68 348755.52,-1728.68 349080.8,-1728.68 349164.48,-1816.68"/>
<text text-anchor="middle" x="348960" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="348960" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="348960" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="348960" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert1_q_proj -->
<g id="node1608" class="node">
<title>layer11_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="348737.5,-1794.68 348540.5,-1794.68 348540.5,-1750.68 348737.5,-1750.68 348737.5,-1794.68"/>
<text text-anchor="middle" x="348639" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="348639" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="348639" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="348639" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert1_k_proj -->
<g id="node1609" class="node">
<title>layer11_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="348522.5,-1794.68 348325.5,-1794.68 348325.5,-1750.68 348522.5,-1750.68 348522.5,-1794.68"/>
<text text-anchor="middle" x="348424" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="348424" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="348424" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="348424" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert1_v_proj -->
<g id="node1610" class="node">
<title>layer11_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="348307.5,-1794.68 348110.5,-1794.68 348110.5,-1750.68 348307.5,-1750.68 348307.5,-1794.68"/>
<text text-anchor="middle" x="348209" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="348209" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="348209" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="348209" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert1_attn -->
<g id="node1611" class="node">
<title>layer11_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="348092.5,-1794.68 347895.5,-1794.68 347895.5,-1750.68 348092.5,-1750.68 348092.5,-1794.68"/>
<text text-anchor="middle" x="347994" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="347994" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="347994" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="347994" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert1_attn_out -->
<g id="node1612" class="node">
<title>layer11_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="347877,-1794.68 347677,-1794.68 347677,-1750.68 347877,-1750.68 347877,-1794.68"/>
<text text-anchor="middle" x="347777" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="347777" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="347777" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="347777" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert1_attn_ar -->
<g id="node1613" class="node">
<title>layer11_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="347518" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="347518" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="347518" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="347518" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="347518" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert1_attn_res -->
<g id="node1614" class="node">
<title>layer11_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="347358.2,-1816.68 347028.59,-1816.68 346943.8,-1728.68 347273.41,-1728.68 347358.2,-1816.68"/>
<text text-anchor="middle" x="347151" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="347151" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="347151" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="347151" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert1_ln1 -->
<g id="node1615" class="node">
<title>layer11_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="346926,-1794.68 346726,-1794.68 346726,-1750.68 346926,-1750.68 346926,-1794.68"/>
<text text-anchor="middle" x="346826" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="346826" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="346826" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="346826" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert1_mlp1 -->
<g id="node1616" class="node">
<title>layer11_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="346708,-1794.68 346512,-1794.68 346512,-1750.68 346708,-1750.68 346708,-1794.68"/>
<text text-anchor="middle" x="346610" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="346610" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="346610" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="346610" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert1_gelu -->
<g id="node1617" class="node">
<title>layer11_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="346494,-1794.68 346298,-1794.68 346298,-1750.68 346494,-1750.68 346494,-1794.68"/>
<text text-anchor="middle" x="346396" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="346396" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="346396" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="346396" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert1_mlp2 -->
<g id="node1618" class="node">
<title>layer11_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="346280,-1794.68 346080,-1794.68 346080,-1750.68 346280,-1750.68 346280,-1794.68"/>
<text text-anchor="middle" x="346180" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="346180" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="346180" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="346180" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert1_mlp_ar -->
<g id="node1619" class="node">
<title>layer11_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="345921" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="345921" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="345921" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="345921" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="345921" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert1_mlp_res -->
<g id="node1620" class="node">
<title>layer11_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="345761.2,-1816.68 345431.59,-1816.68 345346.8,-1728.68 345676.41,-1728.68 345761.2,-1816.68"/>
<text text-anchor="middle" x="345554" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="345554" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="345554" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="345554" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert1_ln2 -->
<g id="node1621" class="node">
<title>layer11_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="345329,-1794.68 345129,-1794.68 345129,-1750.68 345329,-1750.68 345329,-1794.68"/>
<text text-anchor="middle" x="345229" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="345229" y="-1775.28" font-family="Arial" font-size="8.00">L11_E1</text>
<text text-anchor="middle" x="345229" y="-1766.28" font-family="Arial" font-size="8.00">GPU:34</text>
<text text-anchor="middle" x="345229" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert2_route -->
<g id="node1622" class="node">
<title>layer11_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="345105,-1794.68 344905,-1794.68 344905,-1750.68 345105,-1750.68 345105,-1794.68"/>
<text text-anchor="middle" x="345005" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="345005" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="345005" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="345005" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert2_gate -->
<g id="node1623" class="node">
<title>layer11_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="344887.04,-1816.68 344572,-1816.68 344490.96,-1728.68 344806,-1728.68 344887.04,-1816.68"/>
<text text-anchor="middle" x="344689" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="344689" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="344689" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="344689" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer11_expert2_a2a -->
<g id="node1624" class="node">
<title>layer11_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="344332" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="344332" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="344332" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="344332" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="344332" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert2_attn_split -->
<g id="node1625" class="node">
<title>layer11_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="344172.48,-1816.68 343847.2,-1816.68 343763.52,-1728.68 344088.8,-1728.68 344172.48,-1816.68"/>
<text text-anchor="middle" x="343968" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="343968" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="343968" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="343968" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert2_q_proj -->
<g id="node1626" class="node">
<title>layer11_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="343745.5,-1794.68 343548.5,-1794.68 343548.5,-1750.68 343745.5,-1750.68 343745.5,-1794.68"/>
<text text-anchor="middle" x="343647" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="343647" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="343647" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="343647" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert2_k_proj -->
<g id="node1627" class="node">
<title>layer11_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="343530.5,-1794.68 343333.5,-1794.68 343333.5,-1750.68 343530.5,-1750.68 343530.5,-1794.68"/>
<text text-anchor="middle" x="343432" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="343432" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="343432" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="343432" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert2_v_proj -->
<g id="node1628" class="node">
<title>layer11_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="343315.5,-1794.68 343118.5,-1794.68 343118.5,-1750.68 343315.5,-1750.68 343315.5,-1794.68"/>
<text text-anchor="middle" x="343217" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="343217" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="343217" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="343217" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert2_attn -->
<g id="node1629" class="node">
<title>layer11_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="343100.5,-1794.68 342903.5,-1794.68 342903.5,-1750.68 343100.5,-1750.68 343100.5,-1794.68"/>
<text text-anchor="middle" x="343002" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="343002" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="343002" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="343002" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert2_attn_out -->
<g id="node1630" class="node">
<title>layer11_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="342885,-1794.68 342685,-1794.68 342685,-1750.68 342885,-1750.68 342885,-1794.68"/>
<text text-anchor="middle" x="342785" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="342785" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="342785" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="342785" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert2_attn_ar -->
<g id="node1631" class="node">
<title>layer11_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="342526" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="342526" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="342526" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="342526" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="342526" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert2_attn_res -->
<g id="node1632" class="node">
<title>layer11_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="342366.2,-1816.68 342036.59,-1816.68 341951.8,-1728.68 342281.41,-1728.68 342366.2,-1816.68"/>
<text text-anchor="middle" x="342159" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="342159" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="342159" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="342159" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert2_ln1 -->
<g id="node1633" class="node">
<title>layer11_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="341934,-1794.68 341734,-1794.68 341734,-1750.68 341934,-1750.68 341934,-1794.68"/>
<text text-anchor="middle" x="341834" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="341834" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="341834" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="341834" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert2_mlp1 -->
<g id="node1634" class="node">
<title>layer11_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="341716,-1794.68 341520,-1794.68 341520,-1750.68 341716,-1750.68 341716,-1794.68"/>
<text text-anchor="middle" x="341618" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="341618" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="341618" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="341618" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert2_gelu -->
<g id="node1635" class="node">
<title>layer11_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="341502,-1794.68 341306,-1794.68 341306,-1750.68 341502,-1750.68 341502,-1794.68"/>
<text text-anchor="middle" x="341404" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="341404" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="341404" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="341404" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert2_mlp2 -->
<g id="node1636" class="node">
<title>layer11_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="341288,-1794.68 341088,-1794.68 341088,-1750.68 341288,-1750.68 341288,-1794.68"/>
<text text-anchor="middle" x="341188" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="341188" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="341188" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="341188" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert2_mlp_ar -->
<g id="node1637" class="node">
<title>layer11_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="340929" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="340929" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="340929" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="340929" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="340929" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert2_mlp_res -->
<g id="node1638" class="node">
<title>layer11_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="340769.2,-1816.68 340439.59,-1816.68 340354.8,-1728.68 340684.41,-1728.68 340769.2,-1816.68"/>
<text text-anchor="middle" x="340562" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="340562" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="340562" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="340562" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert2_ln2 -->
<g id="node1639" class="node">
<title>layer11_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="340337,-1794.68 340137,-1794.68 340137,-1750.68 340337,-1750.68 340337,-1794.68"/>
<text text-anchor="middle" x="340237" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="340237" y="-1775.28" font-family="Arial" font-size="8.00">L11_E2</text>
<text text-anchor="middle" x="340237" y="-1766.28" font-family="Arial" font-size="8.00">GPU:36</text>
<text text-anchor="middle" x="340237" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert3_route -->
<g id="node1640" class="node">
<title>layer11_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="340113,-1794.68 339913,-1794.68 339913,-1750.68 340113,-1750.68 340113,-1794.68"/>
<text text-anchor="middle" x="340013" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="340013" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="340013" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="340013" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert3_gate -->
<g id="node1641" class="node">
<title>layer11_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="339895.04,-1816.68 339580,-1816.68 339498.96,-1728.68 339814,-1728.68 339895.04,-1816.68"/>
<text text-anchor="middle" x="339697" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="339697" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="339697" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="339697" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer11_expert3_a2a -->
<g id="node1642" class="node">
<title>layer11_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="339340" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="339340" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="339340" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="339340" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="339340" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert3_attn_split -->
<g id="node1643" class="node">
<title>layer11_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="339180.48,-1816.68 338855.2,-1816.68 338771.52,-1728.68 339096.8,-1728.68 339180.48,-1816.68"/>
<text text-anchor="middle" x="338976" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="338976" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="338976" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="338976" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert3_q_proj -->
<g id="node1644" class="node">
<title>layer11_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="338753.5,-1794.68 338556.5,-1794.68 338556.5,-1750.68 338753.5,-1750.68 338753.5,-1794.68"/>
<text text-anchor="middle" x="338655" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="338655" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="338655" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="338655" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert3_k_proj -->
<g id="node1645" class="node">
<title>layer11_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="338538.5,-1794.68 338341.5,-1794.68 338341.5,-1750.68 338538.5,-1750.68 338538.5,-1794.68"/>
<text text-anchor="middle" x="338440" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="338440" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="338440" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="338440" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert3_v_proj -->
<g id="node1646" class="node">
<title>layer11_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="338323.5,-1794.68 338126.5,-1794.68 338126.5,-1750.68 338323.5,-1750.68 338323.5,-1794.68"/>
<text text-anchor="middle" x="338225" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="338225" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="338225" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="338225" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert3_attn -->
<g id="node1647" class="node">
<title>layer11_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="338108.5,-1794.68 337911.5,-1794.68 337911.5,-1750.68 338108.5,-1750.68 338108.5,-1794.68"/>
<text text-anchor="middle" x="338010" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="338010" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="338010" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="338010" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert3_attn_out -->
<g id="node1648" class="node">
<title>layer11_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="337893,-1794.68 337693,-1794.68 337693,-1750.68 337893,-1750.68 337893,-1794.68"/>
<text text-anchor="middle" x="337793" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="337793" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="337793" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="337793" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert3_attn_ar -->
<g id="node1649" class="node">
<title>layer11_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="337534" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="337534" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="337534" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="337534" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="337534" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert3_attn_res -->
<g id="node1650" class="node">
<title>layer11_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="337374.2,-1816.68 337044.59,-1816.68 336959.8,-1728.68 337289.41,-1728.68 337374.2,-1816.68"/>
<text text-anchor="middle" x="337167" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="337167" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="337167" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="337167" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert3_ln1 -->
<g id="node1651" class="node">
<title>layer11_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="336942,-1794.68 336742,-1794.68 336742,-1750.68 336942,-1750.68 336942,-1794.68"/>
<text text-anchor="middle" x="336842" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="336842" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="336842" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="336842" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert3_mlp1 -->
<g id="node1652" class="node">
<title>layer11_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="336724,-1794.68 336528,-1794.68 336528,-1750.68 336724,-1750.68 336724,-1794.68"/>
<text text-anchor="middle" x="336626" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="336626" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="336626" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="336626" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert3_gelu -->
<g id="node1653" class="node">
<title>layer11_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="336510,-1794.68 336314,-1794.68 336314,-1750.68 336510,-1750.68 336510,-1794.68"/>
<text text-anchor="middle" x="336412" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="336412" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="336412" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="336412" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert3_mlp2 -->
<g id="node1654" class="node">
<title>layer11_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="336296,-1794.68 336096,-1794.68 336096,-1750.68 336296,-1750.68 336296,-1794.68"/>
<text text-anchor="middle" x="336196" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="336196" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="336196" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="336196" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert3_mlp_ar -->
<g id="node1655" class="node">
<title>layer11_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="335937" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="335937" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="335937" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="335937" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="335937" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert3_mlp_res -->
<g id="node1656" class="node">
<title>layer11_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="335777.2,-1816.68 335447.59,-1816.68 335362.8,-1728.68 335692.41,-1728.68 335777.2,-1816.68"/>
<text text-anchor="middle" x="335570" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="335570" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="335570" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="335570" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert3_ln2 -->
<g id="node1657" class="node">
<title>layer11_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="335345,-1794.68 335145,-1794.68 335145,-1750.68 335345,-1750.68 335345,-1794.68"/>
<text text-anchor="middle" x="335245" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="335245" y="-1775.28" font-family="Arial" font-size="8.00">L11_E3</text>
<text text-anchor="middle" x="335245" y="-1766.28" font-family="Arial" font-size="8.00">GPU:38</text>
<text text-anchor="middle" x="335245" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert4_route -->
<g id="node1658" class="node">
<title>layer11_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="335121,-1794.68 334921,-1794.68 334921,-1750.68 335121,-1750.68 335121,-1794.68"/>
<text text-anchor="middle" x="335021" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="335021" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="335021" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="335021" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert4_gate -->
<g id="node1659" class="node">
<title>layer11_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="334903.04,-1816.68 334588,-1816.68 334506.96,-1728.68 334822,-1728.68 334903.04,-1816.68"/>
<text text-anchor="middle" x="334705" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="334705" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="334705" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="334705" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer11_expert4_a2a -->
<g id="node1660" class="node">
<title>layer11_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="334348" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="334348" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="334348" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="334348" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="334348" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert4_attn_split -->
<g id="node1661" class="node">
<title>layer11_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="334188.48,-1816.68 333863.2,-1816.68 333779.52,-1728.68 334104.8,-1728.68 334188.48,-1816.68"/>
<text text-anchor="middle" x="333984" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="333984" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="333984" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="333984" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert4_q_proj -->
<g id="node1662" class="node">
<title>layer11_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="333761.5,-1794.68 333564.5,-1794.68 333564.5,-1750.68 333761.5,-1750.68 333761.5,-1794.68"/>
<text text-anchor="middle" x="333663" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="333663" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="333663" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="333663" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert4_k_proj -->
<g id="node1663" class="node">
<title>layer11_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="333546.5,-1794.68 333349.5,-1794.68 333349.5,-1750.68 333546.5,-1750.68 333546.5,-1794.68"/>
<text text-anchor="middle" x="333448" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="333448" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="333448" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="333448" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert4_v_proj -->
<g id="node1664" class="node">
<title>layer11_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="333331.5,-1794.68 333134.5,-1794.68 333134.5,-1750.68 333331.5,-1750.68 333331.5,-1794.68"/>
<text text-anchor="middle" x="333233" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="333233" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="333233" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="333233" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert4_attn -->
<g id="node1665" class="node">
<title>layer11_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="333116.5,-1794.68 332919.5,-1794.68 332919.5,-1750.68 333116.5,-1750.68 333116.5,-1794.68"/>
<text text-anchor="middle" x="333018" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="333018" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="333018" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="333018" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert4_attn_out -->
<g id="node1666" class="node">
<title>layer11_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="332901,-1794.68 332701,-1794.68 332701,-1750.68 332901,-1750.68 332901,-1794.68"/>
<text text-anchor="middle" x="332801" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="332801" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="332801" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="332801" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert4_attn_ar -->
<g id="node1667" class="node">
<title>layer11_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="332542" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="332542" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="332542" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="332542" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="332542" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert4_attn_res -->
<g id="node1668" class="node">
<title>layer11_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="332382.2,-1816.68 332052.59,-1816.68 331967.8,-1728.68 332297.41,-1728.68 332382.2,-1816.68"/>
<text text-anchor="middle" x="332175" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="332175" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="332175" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="332175" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert4_ln1 -->
<g id="node1669" class="node">
<title>layer11_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="331950,-1794.68 331750,-1794.68 331750,-1750.68 331950,-1750.68 331950,-1794.68"/>
<text text-anchor="middle" x="331850" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="331850" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="331850" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="331850" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert4_mlp1 -->
<g id="node1670" class="node">
<title>layer11_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="331732,-1794.68 331536,-1794.68 331536,-1750.68 331732,-1750.68 331732,-1794.68"/>
<text text-anchor="middle" x="331634" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="331634" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="331634" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="331634" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert4_gelu -->
<g id="node1671" class="node">
<title>layer11_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="331518,-1794.68 331322,-1794.68 331322,-1750.68 331518,-1750.68 331518,-1794.68"/>
<text text-anchor="middle" x="331420" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="331420" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="331420" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="331420" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert4_mlp2 -->
<g id="node1672" class="node">
<title>layer11_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="331304,-1794.68 331104,-1794.68 331104,-1750.68 331304,-1750.68 331304,-1794.68"/>
<text text-anchor="middle" x="331204" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="331204" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="331204" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="331204" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert4_mlp_ar -->
<g id="node1673" class="node">
<title>layer11_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="330945" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="330945" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="330945" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="330945" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="330945" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert4_mlp_res -->
<g id="node1674" class="node">
<title>layer11_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="330785.2,-1816.68 330455.59,-1816.68 330370.8,-1728.68 330700.41,-1728.68 330785.2,-1816.68"/>
<text text-anchor="middle" x="330578" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="330578" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="330578" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="330578" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert4_ln2 -->
<g id="node1675" class="node">
<title>layer11_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="330353,-1794.68 330153,-1794.68 330153,-1750.68 330353,-1750.68 330353,-1794.68"/>
<text text-anchor="middle" x="330253" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="330253" y="-1775.28" font-family="Arial" font-size="8.00">L11_E4</text>
<text text-anchor="middle" x="330253" y="-1766.28" font-family="Arial" font-size="8.00">GPU:40</text>
<text text-anchor="middle" x="330253" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert5_route -->
<g id="node1676" class="node">
<title>layer11_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="330129,-1794.68 329929,-1794.68 329929,-1750.68 330129,-1750.68 330129,-1794.68"/>
<text text-anchor="middle" x="330029" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="330029" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="330029" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="330029" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert5_gate -->
<g id="node1677" class="node">
<title>layer11_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="329911.04,-1816.68 329596,-1816.68 329514.96,-1728.68 329830,-1728.68 329911.04,-1816.68"/>
<text text-anchor="middle" x="329713" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="329713" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="329713" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="329713" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer11_expert5_a2a -->
<g id="node1678" class="node">
<title>layer11_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="329356" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="329356" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="329356" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="329356" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="329356" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert5_attn_split -->
<g id="node1679" class="node">
<title>layer11_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="329196.48,-1816.68 328871.2,-1816.68 328787.52,-1728.68 329112.8,-1728.68 329196.48,-1816.68"/>
<text text-anchor="middle" x="328992" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="328992" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="328992" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="328992" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert5_q_proj -->
<g id="node1680" class="node">
<title>layer11_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="328769.5,-1794.68 328572.5,-1794.68 328572.5,-1750.68 328769.5,-1750.68 328769.5,-1794.68"/>
<text text-anchor="middle" x="328671" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="328671" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="328671" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="328671" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert5_k_proj -->
<g id="node1681" class="node">
<title>layer11_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="328554.5,-1794.68 328357.5,-1794.68 328357.5,-1750.68 328554.5,-1750.68 328554.5,-1794.68"/>
<text text-anchor="middle" x="328456" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="328456" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="328456" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="328456" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert5_v_proj -->
<g id="node1682" class="node">
<title>layer11_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="328339.5,-1794.68 328142.5,-1794.68 328142.5,-1750.68 328339.5,-1750.68 328339.5,-1794.68"/>
<text text-anchor="middle" x="328241" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="328241" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="328241" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="328241" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert5_attn -->
<g id="node1683" class="node">
<title>layer11_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="328124.5,-1794.68 327927.5,-1794.68 327927.5,-1750.68 328124.5,-1750.68 328124.5,-1794.68"/>
<text text-anchor="middle" x="328026" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="328026" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="328026" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="328026" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert5_attn_out -->
<g id="node1684" class="node">
<title>layer11_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="327909,-1794.68 327709,-1794.68 327709,-1750.68 327909,-1750.68 327909,-1794.68"/>
<text text-anchor="middle" x="327809" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="327809" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="327809" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="327809" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert5_attn_ar -->
<g id="node1685" class="node">
<title>layer11_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="327550" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="327550" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="327550" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="327550" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="327550" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert5_attn_res -->
<g id="node1686" class="node">
<title>layer11_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="327390.2,-1816.68 327060.59,-1816.68 326975.8,-1728.68 327305.41,-1728.68 327390.2,-1816.68"/>
<text text-anchor="middle" x="327183" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="327183" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="327183" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="327183" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert5_ln1 -->
<g id="node1687" class="node">
<title>layer11_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="326958,-1794.68 326758,-1794.68 326758,-1750.68 326958,-1750.68 326958,-1794.68"/>
<text text-anchor="middle" x="326858" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="326858" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="326858" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="326858" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert5_mlp1 -->
<g id="node1688" class="node">
<title>layer11_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="326740,-1794.68 326544,-1794.68 326544,-1750.68 326740,-1750.68 326740,-1794.68"/>
<text text-anchor="middle" x="326642" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="326642" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="326642" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="326642" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert5_gelu -->
<g id="node1689" class="node">
<title>layer11_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="326526,-1794.68 326330,-1794.68 326330,-1750.68 326526,-1750.68 326526,-1794.68"/>
<text text-anchor="middle" x="326428" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="326428" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="326428" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="326428" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert5_mlp2 -->
<g id="node1690" class="node">
<title>layer11_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="326312,-1794.68 326112,-1794.68 326112,-1750.68 326312,-1750.68 326312,-1794.68"/>
<text text-anchor="middle" x="326212" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="326212" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="326212" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="326212" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert5_mlp_ar -->
<g id="node1691" class="node">
<title>layer11_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="325953" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="325953" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="325953" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="325953" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="325953" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert5_mlp_res -->
<g id="node1692" class="node">
<title>layer11_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="325793.2,-1816.68 325463.59,-1816.68 325378.8,-1728.68 325708.41,-1728.68 325793.2,-1816.68"/>
<text text-anchor="middle" x="325586" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="325586" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="325586" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="325586" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert5_ln2 -->
<g id="node1693" class="node">
<title>layer11_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="325361,-1794.68 325161,-1794.68 325161,-1750.68 325361,-1750.68 325361,-1794.68"/>
<text text-anchor="middle" x="325261" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="325261" y="-1775.28" font-family="Arial" font-size="8.00">L11_E5</text>
<text text-anchor="middle" x="325261" y="-1766.28" font-family="Arial" font-size="8.00">GPU:42</text>
<text text-anchor="middle" x="325261" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert6_route -->
<g id="node1694" class="node">
<title>layer11_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="325137,-1794.68 324937,-1794.68 324937,-1750.68 325137,-1750.68 325137,-1794.68"/>
<text text-anchor="middle" x="325037" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="325037" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="325037" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="325037" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert6_gate -->
<g id="node1695" class="node">
<title>layer11_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="324919.04,-1816.68 324604,-1816.68 324522.96,-1728.68 324838,-1728.68 324919.04,-1816.68"/>
<text text-anchor="middle" x="324721" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="324721" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="324721" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="324721" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer11_expert6_a2a -->
<g id="node1696" class="node">
<title>layer11_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="324364" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="324364" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="324364" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="324364" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="324364" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert6_attn_split -->
<g id="node1697" class="node">
<title>layer11_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="324204.48,-1816.68 323879.2,-1816.68 323795.52,-1728.68 324120.8,-1728.68 324204.48,-1816.68"/>
<text text-anchor="middle" x="324000" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="324000" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="324000" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="324000" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert6_q_proj -->
<g id="node1698" class="node">
<title>layer11_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="323777.5,-1794.68 323580.5,-1794.68 323580.5,-1750.68 323777.5,-1750.68 323777.5,-1794.68"/>
<text text-anchor="middle" x="323679" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="323679" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="323679" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="323679" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert6_k_proj -->
<g id="node1699" class="node">
<title>layer11_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="323562.5,-1794.68 323365.5,-1794.68 323365.5,-1750.68 323562.5,-1750.68 323562.5,-1794.68"/>
<text text-anchor="middle" x="323464" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="323464" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="323464" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="323464" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert6_v_proj -->
<g id="node1700" class="node">
<title>layer11_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="323347.5,-1794.68 323150.5,-1794.68 323150.5,-1750.68 323347.5,-1750.68 323347.5,-1794.68"/>
<text text-anchor="middle" x="323249" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="323249" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="323249" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="323249" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert6_attn -->
<g id="node1701" class="node">
<title>layer11_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="323132.5,-1794.68 322935.5,-1794.68 322935.5,-1750.68 323132.5,-1750.68 323132.5,-1794.68"/>
<text text-anchor="middle" x="323034" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="323034" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="323034" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="323034" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert6_attn_out -->
<g id="node1702" class="node">
<title>layer11_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="322917,-1794.68 322717,-1794.68 322717,-1750.68 322917,-1750.68 322917,-1794.68"/>
<text text-anchor="middle" x="322817" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="322817" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="322817" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="322817" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert6_attn_ar -->
<g id="node1703" class="node">
<title>layer11_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="322558" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="322558" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="322558" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="322558" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="322558" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert6_attn_res -->
<g id="node1704" class="node">
<title>layer11_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="322398.2,-1816.68 322068.59,-1816.68 321983.8,-1728.68 322313.41,-1728.68 322398.2,-1816.68"/>
<text text-anchor="middle" x="322191" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="322191" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="322191" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="322191" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert6_ln1 -->
<g id="node1705" class="node">
<title>layer11_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="321966,-1794.68 321766,-1794.68 321766,-1750.68 321966,-1750.68 321966,-1794.68"/>
<text text-anchor="middle" x="321866" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="321866" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="321866" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="321866" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert6_mlp1 -->
<g id="node1706" class="node">
<title>layer11_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="321748,-1794.68 321552,-1794.68 321552,-1750.68 321748,-1750.68 321748,-1794.68"/>
<text text-anchor="middle" x="321650" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="321650" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="321650" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="321650" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert6_gelu -->
<g id="node1707" class="node">
<title>layer11_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="321534,-1794.68 321338,-1794.68 321338,-1750.68 321534,-1750.68 321534,-1794.68"/>
<text text-anchor="middle" x="321436" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="321436" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="321436" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="321436" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert6_mlp2 -->
<g id="node1708" class="node">
<title>layer11_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="321320,-1794.68 321120,-1794.68 321120,-1750.68 321320,-1750.68 321320,-1794.68"/>
<text text-anchor="middle" x="321220" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="321220" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="321220" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="321220" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert6_mlp_ar -->
<g id="node1709" class="node">
<title>layer11_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="320961" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="320961" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="320961" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="320961" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="320961" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert6_mlp_res -->
<g id="node1710" class="node">
<title>layer11_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="320801.2,-1816.68 320471.59,-1816.68 320386.8,-1728.68 320716.41,-1728.68 320801.2,-1816.68"/>
<text text-anchor="middle" x="320594" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="320594" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="320594" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="320594" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert6_ln2 -->
<g id="node1711" class="node">
<title>layer11_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="320369,-1794.68 320169,-1794.68 320169,-1750.68 320369,-1750.68 320369,-1794.68"/>
<text text-anchor="middle" x="320269" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="320269" y="-1775.28" font-family="Arial" font-size="8.00">L11_E6</text>
<text text-anchor="middle" x="320269" y="-1766.28" font-family="Arial" font-size="8.00">GPU:44</text>
<text text-anchor="middle" x="320269" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert7_route -->
<g id="node1712" class="node">
<title>layer11_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="320145,-1794.68 319945,-1794.68 319945,-1750.68 320145,-1750.68 320145,-1794.68"/>
<text text-anchor="middle" x="320045" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="320045" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="320045" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="320045" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert7_gate -->
<g id="node1713" class="node">
<title>layer11_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="319927.04,-1816.68 319612,-1816.68 319530.96,-1728.68 319846,-1728.68 319927.04,-1816.68"/>
<text text-anchor="middle" x="319729" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="319729" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="319729" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="319729" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer11_expert7_a2a -->
<g id="node1714" class="node">
<title>layer11_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="319372" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="319372" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="319372" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="319372" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="319372" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert7_attn_split -->
<g id="node1715" class="node">
<title>layer11_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="319212.48,-1816.68 318887.2,-1816.68 318803.52,-1728.68 319128.8,-1728.68 319212.48,-1816.68"/>
<text text-anchor="middle" x="319008" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="319008" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="319008" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="319008" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert7_q_proj -->
<g id="node1716" class="node">
<title>layer11_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="318785.5,-1794.68 318588.5,-1794.68 318588.5,-1750.68 318785.5,-1750.68 318785.5,-1794.68"/>
<text text-anchor="middle" x="318687" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="318687" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="318687" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="318687" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert7_k_proj -->
<g id="node1717" class="node">
<title>layer11_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="318570.5,-1794.68 318373.5,-1794.68 318373.5,-1750.68 318570.5,-1750.68 318570.5,-1794.68"/>
<text text-anchor="middle" x="318472" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="318472" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="318472" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="318472" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert7_v_proj -->
<g id="node1718" class="node">
<title>layer11_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="318355.5,-1794.68 318158.5,-1794.68 318158.5,-1750.68 318355.5,-1750.68 318355.5,-1794.68"/>
<text text-anchor="middle" x="318257" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="318257" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="318257" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="318257" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert7_attn -->
<g id="node1719" class="node">
<title>layer11_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="318140.5,-1794.68 317943.5,-1794.68 317943.5,-1750.68 318140.5,-1750.68 318140.5,-1794.68"/>
<text text-anchor="middle" x="318042" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="318042" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="318042" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="318042" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer11_expert7_attn_out -->
<g id="node1720" class="node">
<title>layer11_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="317925,-1794.68 317725,-1794.68 317725,-1750.68 317925,-1750.68 317925,-1794.68"/>
<text text-anchor="middle" x="317825" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="317825" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="317825" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="317825" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert7_attn_ar -->
<g id="node1721" class="node">
<title>layer11_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="317566" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="317566" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="317566" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="317566" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="317566" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert7_attn_res -->
<g id="node1722" class="node">
<title>layer11_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="317406.2,-1816.68 317076.59,-1816.68 316991.8,-1728.68 317321.41,-1728.68 317406.2,-1816.68"/>
<text text-anchor="middle" x="317199" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="317199" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="317199" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="317199" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert7_ln1 -->
<g id="node1723" class="node">
<title>layer11_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="316974,-1794.68 316774,-1794.68 316774,-1750.68 316974,-1750.68 316974,-1794.68"/>
<text text-anchor="middle" x="316874" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="316874" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="316874" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="316874" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert7_mlp1 -->
<g id="node1724" class="node">
<title>layer11_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="316756,-1794.68 316560,-1794.68 316560,-1750.68 316756,-1750.68 316756,-1794.68"/>
<text text-anchor="middle" x="316658" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="316658" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="316658" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="316658" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert7_gelu -->
<g id="node1725" class="node">
<title>layer11_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="316542,-1794.68 316346,-1794.68 316346,-1750.68 316542,-1750.68 316542,-1794.68"/>
<text text-anchor="middle" x="316444" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="316444" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="316444" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="316444" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer11_expert7_mlp2 -->
<g id="node1726" class="node">
<title>layer11_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="316328,-1794.68 316128,-1794.68 316128,-1750.68 316328,-1750.68 316328,-1794.68"/>
<text text-anchor="middle" x="316228" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="316228" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="316228" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="316228" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert7_mlp_ar -->
<g id="node1727" class="node">
<title>layer11_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="315969" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="315969" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="315969" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="315969" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="315969" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert7_mlp_res -->
<g id="node1728" class="node">
<title>layer11_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="315809.2,-1816.68 315479.59,-1816.68 315394.8,-1728.68 315724.41,-1728.68 315809.2,-1816.68"/>
<text text-anchor="middle" x="315602" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="315602" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="315602" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="315602" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer11_expert7_ln2 -->
<g id="node1729" class="node">
<title>layer11_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="315377,-1794.68 315177,-1794.68 315177,-1750.68 315377,-1750.68 315377,-1794.68"/>
<text text-anchor="middle" x="315277" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="315277" y="-1775.28" font-family="Arial" font-size="8.00">L11_E7</text>
<text text-anchor="middle" x="315277" y="-1766.28" font-family="Arial" font-size="8.00">GPU:46</text>
<text text-anchor="middle" x="315277" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert0_route -->
<g id="node1730" class="node">
<title>layer12_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="634769,-1794.68 634569,-1794.68 634569,-1750.68 634769,-1750.68 634769,-1794.68"/>
<text text-anchor="middle" x="634669" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="634669" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="634669" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="634669" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert0_gate -->
<g id="node1731" class="node">
<title>layer12_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="634551.04,-1816.68 634236,-1816.68 634154.96,-1728.68 634470,-1728.68 634551.04,-1816.68"/>
<text text-anchor="middle" x="634353" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="634353" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="634353" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="634353" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer12_expert0_a2a -->
<g id="node1732" class="node">
<title>layer12_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="633996" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="633996" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="633996" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="633996" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="633996" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert0_attn_split -->
<g id="node1733" class="node">
<title>layer12_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="633836.48,-1816.68 633511.2,-1816.68 633427.52,-1728.68 633752.8,-1728.68 633836.48,-1816.68"/>
<text text-anchor="middle" x="633632" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="633632" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="633632" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="633632" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert0_q_proj -->
<g id="node1734" class="node">
<title>layer12_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="633409.5,-1794.68 633212.5,-1794.68 633212.5,-1750.68 633409.5,-1750.68 633409.5,-1794.68"/>
<text text-anchor="middle" x="633311" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="633311" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="633311" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="633311" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert0_k_proj -->
<g id="node1735" class="node">
<title>layer12_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="633194.5,-1794.68 632997.5,-1794.68 632997.5,-1750.68 633194.5,-1750.68 633194.5,-1794.68"/>
<text text-anchor="middle" x="633096" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="633096" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="633096" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="633096" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert0_v_proj -->
<g id="node1736" class="node">
<title>layer12_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="632979.5,-1794.68 632782.5,-1794.68 632782.5,-1750.68 632979.5,-1750.68 632979.5,-1794.68"/>
<text text-anchor="middle" x="632881" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="632881" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="632881" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="632881" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert0_attn -->
<g id="node1737" class="node">
<title>layer12_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="632764.5,-1794.68 632567.5,-1794.68 632567.5,-1750.68 632764.5,-1750.68 632764.5,-1794.68"/>
<text text-anchor="middle" x="632666" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="632666" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="632666" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="632666" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert0_attn_out -->
<g id="node1738" class="node">
<title>layer12_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="632549,-1794.68 632349,-1794.68 632349,-1750.68 632549,-1750.68 632549,-1794.68"/>
<text text-anchor="middle" x="632449" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="632449" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="632449" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="632449" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert0_attn_ar -->
<g id="node1739" class="node">
<title>layer12_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="632190" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="632190" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="632190" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="632190" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="632190" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert0_attn_res -->
<g id="node1740" class="node">
<title>layer12_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="632030.2,-1816.68 631700.59,-1816.68 631615.8,-1728.68 631945.41,-1728.68 632030.2,-1816.68"/>
<text text-anchor="middle" x="631823" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="631823" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="631823" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="631823" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert0_ln1 -->
<g id="node1741" class="node">
<title>layer12_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="631598,-1794.68 631398,-1794.68 631398,-1750.68 631598,-1750.68 631598,-1794.68"/>
<text text-anchor="middle" x="631498" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="631498" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="631498" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="631498" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert0_mlp1 -->
<g id="node1742" class="node">
<title>layer12_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="631380,-1794.68 631184,-1794.68 631184,-1750.68 631380,-1750.68 631380,-1794.68"/>
<text text-anchor="middle" x="631282" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="631282" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="631282" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="631282" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert0_gelu -->
<g id="node1743" class="node">
<title>layer12_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="631166,-1794.68 630970,-1794.68 630970,-1750.68 631166,-1750.68 631166,-1794.68"/>
<text text-anchor="middle" x="631068" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="631068" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="631068" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="631068" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert0_mlp2 -->
<g id="node1744" class="node">
<title>layer12_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="630952,-1794.68 630752,-1794.68 630752,-1750.68 630952,-1750.68 630952,-1794.68"/>
<text text-anchor="middle" x="630852" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="630852" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="630852" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="630852" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert0_mlp_ar -->
<g id="node1745" class="node">
<title>layer12_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="630593" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="630593" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="630593" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="630593" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="630593" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert0_mlp_res -->
<g id="node1746" class="node">
<title>layer12_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="630433.2,-1816.68 630103.59,-1816.68 630018.8,-1728.68 630348.41,-1728.68 630433.2,-1816.68"/>
<text text-anchor="middle" x="630226" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="630226" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="630226" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="630226" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert0_ln2 -->
<g id="node1747" class="node">
<title>layer12_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="630001,-1794.68 629801,-1794.68 629801,-1750.68 630001,-1750.68 630001,-1794.68"/>
<text text-anchor="middle" x="629901" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="629901" y="-1775.28" font-family="Arial" font-size="8.00">L12_E0</text>
<text text-anchor="middle" x="629901" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="629901" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert1_route -->
<g id="node1748" class="node">
<title>layer12_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="629777,-1794.68 629577,-1794.68 629577,-1750.68 629777,-1750.68 629777,-1794.68"/>
<text text-anchor="middle" x="629677" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="629677" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="629677" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="629677" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert1_gate -->
<g id="node1749" class="node">
<title>layer12_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="629559.04,-1816.68 629244,-1816.68 629162.96,-1728.68 629478,-1728.68 629559.04,-1816.68"/>
<text text-anchor="middle" x="629361" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="629361" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="629361" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="629361" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer12_expert1_a2a -->
<g id="node1750" class="node">
<title>layer12_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="629004" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="629004" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="629004" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="629004" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="629004" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert1_attn_split -->
<g id="node1751" class="node">
<title>layer12_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="628844.48,-1816.68 628519.2,-1816.68 628435.52,-1728.68 628760.8,-1728.68 628844.48,-1816.68"/>
<text text-anchor="middle" x="628640" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="628640" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="628640" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="628640" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert1_q_proj -->
<g id="node1752" class="node">
<title>layer12_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="628417.5,-1794.68 628220.5,-1794.68 628220.5,-1750.68 628417.5,-1750.68 628417.5,-1794.68"/>
<text text-anchor="middle" x="628319" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="628319" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="628319" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="628319" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert1_k_proj -->
<g id="node1753" class="node">
<title>layer12_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="628202.5,-1794.68 628005.5,-1794.68 628005.5,-1750.68 628202.5,-1750.68 628202.5,-1794.68"/>
<text text-anchor="middle" x="628104" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="628104" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="628104" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="628104" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert1_v_proj -->
<g id="node1754" class="node">
<title>layer12_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="627987.5,-1794.68 627790.5,-1794.68 627790.5,-1750.68 627987.5,-1750.68 627987.5,-1794.68"/>
<text text-anchor="middle" x="627889" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="627889" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="627889" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="627889" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert1_attn -->
<g id="node1755" class="node">
<title>layer12_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="627772.5,-1794.68 627575.5,-1794.68 627575.5,-1750.68 627772.5,-1750.68 627772.5,-1794.68"/>
<text text-anchor="middle" x="627674" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="627674" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="627674" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="627674" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert1_attn_out -->
<g id="node1756" class="node">
<title>layer12_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="627557,-1794.68 627357,-1794.68 627357,-1750.68 627557,-1750.68 627557,-1794.68"/>
<text text-anchor="middle" x="627457" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="627457" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="627457" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="627457" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert1_attn_ar -->
<g id="node1757" class="node">
<title>layer12_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="627198" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="627198" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="627198" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="627198" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="627198" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert1_attn_res -->
<g id="node1758" class="node">
<title>layer12_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="627038.2,-1816.68 626708.59,-1816.68 626623.8,-1728.68 626953.41,-1728.68 627038.2,-1816.68"/>
<text text-anchor="middle" x="626831" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="626831" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="626831" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="626831" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert1_ln1 -->
<g id="node1759" class="node">
<title>layer12_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="626606,-1794.68 626406,-1794.68 626406,-1750.68 626606,-1750.68 626606,-1794.68"/>
<text text-anchor="middle" x="626506" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="626506" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="626506" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="626506" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert1_mlp1 -->
<g id="node1760" class="node">
<title>layer12_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="626388,-1794.68 626192,-1794.68 626192,-1750.68 626388,-1750.68 626388,-1794.68"/>
<text text-anchor="middle" x="626290" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="626290" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="626290" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="626290" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert1_gelu -->
<g id="node1761" class="node">
<title>layer12_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="626174,-1794.68 625978,-1794.68 625978,-1750.68 626174,-1750.68 626174,-1794.68"/>
<text text-anchor="middle" x="626076" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="626076" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="626076" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="626076" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert1_mlp2 -->
<g id="node1762" class="node">
<title>layer12_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="625960,-1794.68 625760,-1794.68 625760,-1750.68 625960,-1750.68 625960,-1794.68"/>
<text text-anchor="middle" x="625860" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="625860" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="625860" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="625860" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert1_mlp_ar -->
<g id="node1763" class="node">
<title>layer12_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="625601" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="625601" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="625601" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="625601" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="625601" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert1_mlp_res -->
<g id="node1764" class="node">
<title>layer12_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="625441.2,-1816.68 625111.59,-1816.68 625026.8,-1728.68 625356.41,-1728.68 625441.2,-1816.68"/>
<text text-anchor="middle" x="625234" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="625234" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="625234" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="625234" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert1_ln2 -->
<g id="node1765" class="node">
<title>layer12_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="625009,-1794.68 624809,-1794.68 624809,-1750.68 625009,-1750.68 625009,-1794.68"/>
<text text-anchor="middle" x="624909" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="624909" y="-1775.28" font-family="Arial" font-size="8.00">L12_E1</text>
<text text-anchor="middle" x="624909" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="624909" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert2_route -->
<g id="node1766" class="node">
<title>layer12_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="624785,-1794.68 624585,-1794.68 624585,-1750.68 624785,-1750.68 624785,-1794.68"/>
<text text-anchor="middle" x="624685" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="624685" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="624685" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="624685" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert2_gate -->
<g id="node1767" class="node">
<title>layer12_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="624567.04,-1816.68 624252,-1816.68 624170.96,-1728.68 624486,-1728.68 624567.04,-1816.68"/>
<text text-anchor="middle" x="624369" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="624369" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="624369" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="624369" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer12_expert2_a2a -->
<g id="node1768" class="node">
<title>layer12_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="624012" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="624012" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="624012" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="624012" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="624012" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert2_attn_split -->
<g id="node1769" class="node">
<title>layer12_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="623852.48,-1816.68 623527.2,-1816.68 623443.52,-1728.68 623768.8,-1728.68 623852.48,-1816.68"/>
<text text-anchor="middle" x="623648" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="623648" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="623648" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="623648" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert2_q_proj -->
<g id="node1770" class="node">
<title>layer12_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="623425.5,-1794.68 623228.5,-1794.68 623228.5,-1750.68 623425.5,-1750.68 623425.5,-1794.68"/>
<text text-anchor="middle" x="623327" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="623327" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="623327" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="623327" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert2_k_proj -->
<g id="node1771" class="node">
<title>layer12_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="623210.5,-1794.68 623013.5,-1794.68 623013.5,-1750.68 623210.5,-1750.68 623210.5,-1794.68"/>
<text text-anchor="middle" x="623112" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="623112" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="623112" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="623112" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert2_v_proj -->
<g id="node1772" class="node">
<title>layer12_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="622995.5,-1794.68 622798.5,-1794.68 622798.5,-1750.68 622995.5,-1750.68 622995.5,-1794.68"/>
<text text-anchor="middle" x="622897" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="622897" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="622897" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="622897" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert2_attn -->
<g id="node1773" class="node">
<title>layer12_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="622780.5,-1794.68 622583.5,-1794.68 622583.5,-1750.68 622780.5,-1750.68 622780.5,-1794.68"/>
<text text-anchor="middle" x="622682" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="622682" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="622682" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="622682" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert2_attn_out -->
<g id="node1774" class="node">
<title>layer12_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="622565,-1794.68 622365,-1794.68 622365,-1750.68 622565,-1750.68 622565,-1794.68"/>
<text text-anchor="middle" x="622465" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="622465" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="622465" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="622465" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert2_attn_ar -->
<g id="node1775" class="node">
<title>layer12_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="622206" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="622206" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="622206" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="622206" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="622206" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert2_attn_res -->
<g id="node1776" class="node">
<title>layer12_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="622046.2,-1816.68 621716.59,-1816.68 621631.8,-1728.68 621961.41,-1728.68 622046.2,-1816.68"/>
<text text-anchor="middle" x="621839" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="621839" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="621839" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="621839" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert2_ln1 -->
<g id="node1777" class="node">
<title>layer12_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="621614,-1794.68 621414,-1794.68 621414,-1750.68 621614,-1750.68 621614,-1794.68"/>
<text text-anchor="middle" x="621514" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="621514" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="621514" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="621514" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert2_mlp1 -->
<g id="node1778" class="node">
<title>layer12_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="621396,-1794.68 621200,-1794.68 621200,-1750.68 621396,-1750.68 621396,-1794.68"/>
<text text-anchor="middle" x="621298" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="621298" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="621298" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="621298" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert2_gelu -->
<g id="node1779" class="node">
<title>layer12_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="621182,-1794.68 620986,-1794.68 620986,-1750.68 621182,-1750.68 621182,-1794.68"/>
<text text-anchor="middle" x="621084" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="621084" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="621084" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="621084" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert2_mlp2 -->
<g id="node1780" class="node">
<title>layer12_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="620968,-1794.68 620768,-1794.68 620768,-1750.68 620968,-1750.68 620968,-1794.68"/>
<text text-anchor="middle" x="620868" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="620868" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="620868" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="620868" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert2_mlp_ar -->
<g id="node1781" class="node">
<title>layer12_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="620609" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="620609" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="620609" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="620609" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="620609" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert2_mlp_res -->
<g id="node1782" class="node">
<title>layer12_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="620449.2,-1816.68 620119.59,-1816.68 620034.8,-1728.68 620364.41,-1728.68 620449.2,-1816.68"/>
<text text-anchor="middle" x="620242" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="620242" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="620242" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="620242" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert2_ln2 -->
<g id="node1783" class="node">
<title>layer12_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="620017,-1794.68 619817,-1794.68 619817,-1750.68 620017,-1750.68 620017,-1794.68"/>
<text text-anchor="middle" x="619917" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="619917" y="-1775.28" font-family="Arial" font-size="8.00">L12_E2</text>
<text text-anchor="middle" x="619917" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="619917" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert3_route -->
<g id="node1784" class="node">
<title>layer12_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="619793,-1794.68 619593,-1794.68 619593,-1750.68 619793,-1750.68 619793,-1794.68"/>
<text text-anchor="middle" x="619693" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="619693" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="619693" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="619693" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert3_gate -->
<g id="node1785" class="node">
<title>layer12_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="619575.04,-1816.68 619260,-1816.68 619178.96,-1728.68 619494,-1728.68 619575.04,-1816.68"/>
<text text-anchor="middle" x="619377" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="619377" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="619377" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="619377" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer12_expert3_a2a -->
<g id="node1786" class="node">
<title>layer12_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="619020" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="619020" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="619020" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="619020" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="619020" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert3_attn_split -->
<g id="node1787" class="node">
<title>layer12_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="618860.48,-1816.68 618535.2,-1816.68 618451.52,-1728.68 618776.8,-1728.68 618860.48,-1816.68"/>
<text text-anchor="middle" x="618656" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="618656" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="618656" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="618656" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert3_q_proj -->
<g id="node1788" class="node">
<title>layer12_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="618433.5,-1794.68 618236.5,-1794.68 618236.5,-1750.68 618433.5,-1750.68 618433.5,-1794.68"/>
<text text-anchor="middle" x="618335" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="618335" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="618335" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="618335" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert3_k_proj -->
<g id="node1789" class="node">
<title>layer12_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="618218.5,-1794.68 618021.5,-1794.68 618021.5,-1750.68 618218.5,-1750.68 618218.5,-1794.68"/>
<text text-anchor="middle" x="618120" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="618120" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="618120" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="618120" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert3_v_proj -->
<g id="node1790" class="node">
<title>layer12_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="618003.5,-1794.68 617806.5,-1794.68 617806.5,-1750.68 618003.5,-1750.68 618003.5,-1794.68"/>
<text text-anchor="middle" x="617905" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="617905" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="617905" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="617905" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert3_attn -->
<g id="node1791" class="node">
<title>layer12_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="617788.5,-1794.68 617591.5,-1794.68 617591.5,-1750.68 617788.5,-1750.68 617788.5,-1794.68"/>
<text text-anchor="middle" x="617690" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="617690" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="617690" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="617690" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert3_attn_out -->
<g id="node1792" class="node">
<title>layer12_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="617573,-1794.68 617373,-1794.68 617373,-1750.68 617573,-1750.68 617573,-1794.68"/>
<text text-anchor="middle" x="617473" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="617473" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="617473" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="617473" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert3_attn_ar -->
<g id="node1793" class="node">
<title>layer12_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="617214" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="617214" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="617214" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="617214" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="617214" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert3_attn_res -->
<g id="node1794" class="node">
<title>layer12_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="617054.2,-1816.68 616724.59,-1816.68 616639.8,-1728.68 616969.41,-1728.68 617054.2,-1816.68"/>
<text text-anchor="middle" x="616847" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="616847" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="616847" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="616847" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert3_ln1 -->
<g id="node1795" class="node">
<title>layer12_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="616622,-1794.68 616422,-1794.68 616422,-1750.68 616622,-1750.68 616622,-1794.68"/>
<text text-anchor="middle" x="616522" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="616522" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="616522" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="616522" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert3_mlp1 -->
<g id="node1796" class="node">
<title>layer12_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="616404,-1794.68 616208,-1794.68 616208,-1750.68 616404,-1750.68 616404,-1794.68"/>
<text text-anchor="middle" x="616306" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="616306" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="616306" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="616306" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert3_gelu -->
<g id="node1797" class="node">
<title>layer12_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="616190,-1794.68 615994,-1794.68 615994,-1750.68 616190,-1750.68 616190,-1794.68"/>
<text text-anchor="middle" x="616092" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="616092" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="616092" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="616092" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert3_mlp2 -->
<g id="node1798" class="node">
<title>layer12_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="615976,-1794.68 615776,-1794.68 615776,-1750.68 615976,-1750.68 615976,-1794.68"/>
<text text-anchor="middle" x="615876" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="615876" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="615876" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="615876" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert3_mlp_ar -->
<g id="node1799" class="node">
<title>layer12_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="615617" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="615617" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="615617" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="615617" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="615617" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert3_mlp_res -->
<g id="node1800" class="node">
<title>layer12_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="615457.2,-1816.68 615127.59,-1816.68 615042.8,-1728.68 615372.41,-1728.68 615457.2,-1816.68"/>
<text text-anchor="middle" x="615250" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="615250" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="615250" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="615250" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert3_ln2 -->
<g id="node1801" class="node">
<title>layer12_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="615025,-1794.68 614825,-1794.68 614825,-1750.68 615025,-1750.68 615025,-1794.68"/>
<text text-anchor="middle" x="614925" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="614925" y="-1775.28" font-family="Arial" font-size="8.00">L12_E3</text>
<text text-anchor="middle" x="614925" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="614925" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert4_route -->
<g id="node1802" class="node">
<title>layer12_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="614801,-1794.68 614601,-1794.68 614601,-1750.68 614801,-1750.68 614801,-1794.68"/>
<text text-anchor="middle" x="614701" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="614701" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="614701" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="614701" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert4_gate -->
<g id="node1803" class="node">
<title>layer12_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="614583.04,-1816.68 614268,-1816.68 614186.96,-1728.68 614502,-1728.68 614583.04,-1816.68"/>
<text text-anchor="middle" x="614385" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="614385" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="614385" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="614385" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer12_expert4_a2a -->
<g id="node1804" class="node">
<title>layer12_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="614028" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="614028" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="614028" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="614028" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="614028" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert4_attn_split -->
<g id="node1805" class="node">
<title>layer12_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="613868.48,-1816.68 613543.2,-1816.68 613459.52,-1728.68 613784.8,-1728.68 613868.48,-1816.68"/>
<text text-anchor="middle" x="613664" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="613664" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="613664" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="613664" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert4_q_proj -->
<g id="node1806" class="node">
<title>layer12_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="613441.5,-1794.68 613244.5,-1794.68 613244.5,-1750.68 613441.5,-1750.68 613441.5,-1794.68"/>
<text text-anchor="middle" x="613343" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="613343" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="613343" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="613343" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert4_k_proj -->
<g id="node1807" class="node">
<title>layer12_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="613226.5,-1794.68 613029.5,-1794.68 613029.5,-1750.68 613226.5,-1750.68 613226.5,-1794.68"/>
<text text-anchor="middle" x="613128" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="613128" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="613128" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="613128" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert4_v_proj -->
<g id="node1808" class="node">
<title>layer12_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="613011.5,-1794.68 612814.5,-1794.68 612814.5,-1750.68 613011.5,-1750.68 613011.5,-1794.68"/>
<text text-anchor="middle" x="612913" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="612913" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="612913" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="612913" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert4_attn -->
<g id="node1809" class="node">
<title>layer12_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="612796.5,-1794.68 612599.5,-1794.68 612599.5,-1750.68 612796.5,-1750.68 612796.5,-1794.68"/>
<text text-anchor="middle" x="612698" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="612698" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="612698" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="612698" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert4_attn_out -->
<g id="node1810" class="node">
<title>layer12_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="612581,-1794.68 612381,-1794.68 612381,-1750.68 612581,-1750.68 612581,-1794.68"/>
<text text-anchor="middle" x="612481" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="612481" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="612481" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="612481" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert4_attn_ar -->
<g id="node1811" class="node">
<title>layer12_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="612222" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="612222" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="612222" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="612222" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="612222" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert4_attn_res -->
<g id="node1812" class="node">
<title>layer12_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="612062.2,-1816.68 611732.59,-1816.68 611647.8,-1728.68 611977.41,-1728.68 612062.2,-1816.68"/>
<text text-anchor="middle" x="611855" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="611855" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="611855" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="611855" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert4_ln1 -->
<g id="node1813" class="node">
<title>layer12_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="611630,-1794.68 611430,-1794.68 611430,-1750.68 611630,-1750.68 611630,-1794.68"/>
<text text-anchor="middle" x="611530" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="611530" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="611530" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="611530" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert4_mlp1 -->
<g id="node1814" class="node">
<title>layer12_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="611412,-1794.68 611216,-1794.68 611216,-1750.68 611412,-1750.68 611412,-1794.68"/>
<text text-anchor="middle" x="611314" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="611314" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="611314" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="611314" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert4_gelu -->
<g id="node1815" class="node">
<title>layer12_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="611198,-1794.68 611002,-1794.68 611002,-1750.68 611198,-1750.68 611198,-1794.68"/>
<text text-anchor="middle" x="611100" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="611100" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="611100" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="611100" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert4_mlp2 -->
<g id="node1816" class="node">
<title>layer12_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="610984,-1794.68 610784,-1794.68 610784,-1750.68 610984,-1750.68 610984,-1794.68"/>
<text text-anchor="middle" x="610884" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="610884" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="610884" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="610884" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert4_mlp_ar -->
<g id="node1817" class="node">
<title>layer12_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="610625" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="610625" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="610625" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="610625" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="610625" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert4_mlp_res -->
<g id="node1818" class="node">
<title>layer12_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="610465.2,-1816.68 610135.59,-1816.68 610050.8,-1728.68 610380.41,-1728.68 610465.2,-1816.68"/>
<text text-anchor="middle" x="610258" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="610258" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="610258" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="610258" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert4_ln2 -->
<g id="node1819" class="node">
<title>layer12_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="610033,-1794.68 609833,-1794.68 609833,-1750.68 610033,-1750.68 610033,-1794.68"/>
<text text-anchor="middle" x="609933" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="609933" y="-1775.28" font-family="Arial" font-size="8.00">L12_E4</text>
<text text-anchor="middle" x="609933" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="609933" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert5_route -->
<g id="node1820" class="node">
<title>layer12_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="609809,-1794.68 609609,-1794.68 609609,-1750.68 609809,-1750.68 609809,-1794.68"/>
<text text-anchor="middle" x="609709" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="609709" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="609709" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="609709" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert5_gate -->
<g id="node1821" class="node">
<title>layer12_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="609591.04,-1816.68 609276,-1816.68 609194.96,-1728.68 609510,-1728.68 609591.04,-1816.68"/>
<text text-anchor="middle" x="609393" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="609393" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="609393" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="609393" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer12_expert5_a2a -->
<g id="node1822" class="node">
<title>layer12_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="609036" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="609036" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="609036" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="609036" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="609036" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert5_attn_split -->
<g id="node1823" class="node">
<title>layer12_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="608876.48,-1816.68 608551.2,-1816.68 608467.52,-1728.68 608792.8,-1728.68 608876.48,-1816.68"/>
<text text-anchor="middle" x="608672" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="608672" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="608672" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="608672" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert5_q_proj -->
<g id="node1824" class="node">
<title>layer12_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="608449.5,-1794.68 608252.5,-1794.68 608252.5,-1750.68 608449.5,-1750.68 608449.5,-1794.68"/>
<text text-anchor="middle" x="608351" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="608351" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="608351" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="608351" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert5_k_proj -->
<g id="node1825" class="node">
<title>layer12_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="608234.5,-1794.68 608037.5,-1794.68 608037.5,-1750.68 608234.5,-1750.68 608234.5,-1794.68"/>
<text text-anchor="middle" x="608136" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="608136" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="608136" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="608136" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert5_v_proj -->
<g id="node1826" class="node">
<title>layer12_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="608019.5,-1794.68 607822.5,-1794.68 607822.5,-1750.68 608019.5,-1750.68 608019.5,-1794.68"/>
<text text-anchor="middle" x="607921" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="607921" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="607921" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="607921" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert5_attn -->
<g id="node1827" class="node">
<title>layer12_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="607804.5,-1794.68 607607.5,-1794.68 607607.5,-1750.68 607804.5,-1750.68 607804.5,-1794.68"/>
<text text-anchor="middle" x="607706" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="607706" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="607706" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="607706" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert5_attn_out -->
<g id="node1828" class="node">
<title>layer12_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="607589,-1794.68 607389,-1794.68 607389,-1750.68 607589,-1750.68 607589,-1794.68"/>
<text text-anchor="middle" x="607489" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="607489" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="607489" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="607489" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert5_attn_ar -->
<g id="node1829" class="node">
<title>layer12_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="607230" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="607230" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="607230" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="607230" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="607230" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert5_attn_res -->
<g id="node1830" class="node">
<title>layer12_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="607070.2,-1816.68 606740.59,-1816.68 606655.8,-1728.68 606985.41,-1728.68 607070.2,-1816.68"/>
<text text-anchor="middle" x="606863" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="606863" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="606863" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="606863" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert5_ln1 -->
<g id="node1831" class="node">
<title>layer12_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="606638,-1794.68 606438,-1794.68 606438,-1750.68 606638,-1750.68 606638,-1794.68"/>
<text text-anchor="middle" x="606538" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="606538" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="606538" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="606538" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert5_mlp1 -->
<g id="node1832" class="node">
<title>layer12_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="606420,-1794.68 606224,-1794.68 606224,-1750.68 606420,-1750.68 606420,-1794.68"/>
<text text-anchor="middle" x="606322" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="606322" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="606322" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="606322" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert5_gelu -->
<g id="node1833" class="node">
<title>layer12_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="606206,-1794.68 606010,-1794.68 606010,-1750.68 606206,-1750.68 606206,-1794.68"/>
<text text-anchor="middle" x="606108" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="606108" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="606108" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="606108" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert5_mlp2 -->
<g id="node1834" class="node">
<title>layer12_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="605992,-1794.68 605792,-1794.68 605792,-1750.68 605992,-1750.68 605992,-1794.68"/>
<text text-anchor="middle" x="605892" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="605892" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="605892" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="605892" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert5_mlp_ar -->
<g id="node1835" class="node">
<title>layer12_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="605633" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="605633" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="605633" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="605633" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="605633" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert5_mlp_res -->
<g id="node1836" class="node">
<title>layer12_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="605473.2,-1816.68 605143.59,-1816.68 605058.8,-1728.68 605388.41,-1728.68 605473.2,-1816.68"/>
<text text-anchor="middle" x="605266" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="605266" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="605266" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="605266" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert5_ln2 -->
<g id="node1837" class="node">
<title>layer12_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="605041,-1794.68 604841,-1794.68 604841,-1750.68 605041,-1750.68 605041,-1794.68"/>
<text text-anchor="middle" x="604941" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="604941" y="-1775.28" font-family="Arial" font-size="8.00">L12_E5</text>
<text text-anchor="middle" x="604941" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="604941" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert6_route -->
<g id="node1838" class="node">
<title>layer12_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="604817,-1794.68 604617,-1794.68 604617,-1750.68 604817,-1750.68 604817,-1794.68"/>
<text text-anchor="middle" x="604717" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="604717" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="604717" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="604717" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert6_gate -->
<g id="node1839" class="node">
<title>layer12_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="604599.04,-1816.68 604284,-1816.68 604202.96,-1728.68 604518,-1728.68 604599.04,-1816.68"/>
<text text-anchor="middle" x="604401" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="604401" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="604401" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="604401" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer12_expert6_a2a -->
<g id="node1840" class="node">
<title>layer12_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="604044" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="604044" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="604044" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="604044" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="604044" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert6_attn_split -->
<g id="node1841" class="node">
<title>layer12_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="603884.48,-1816.68 603559.2,-1816.68 603475.52,-1728.68 603800.8,-1728.68 603884.48,-1816.68"/>
<text text-anchor="middle" x="603680" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="603680" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="603680" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="603680" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert6_q_proj -->
<g id="node1842" class="node">
<title>layer12_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="603457.5,-1794.68 603260.5,-1794.68 603260.5,-1750.68 603457.5,-1750.68 603457.5,-1794.68"/>
<text text-anchor="middle" x="603359" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="603359" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="603359" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="603359" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert6_k_proj -->
<g id="node1843" class="node">
<title>layer12_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="603242.5,-1794.68 603045.5,-1794.68 603045.5,-1750.68 603242.5,-1750.68 603242.5,-1794.68"/>
<text text-anchor="middle" x="603144" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="603144" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="603144" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="603144" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert6_v_proj -->
<g id="node1844" class="node">
<title>layer12_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="603027.5,-1794.68 602830.5,-1794.68 602830.5,-1750.68 603027.5,-1750.68 603027.5,-1794.68"/>
<text text-anchor="middle" x="602929" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="602929" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="602929" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="602929" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert6_attn -->
<g id="node1845" class="node">
<title>layer12_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="602812.5,-1794.68 602615.5,-1794.68 602615.5,-1750.68 602812.5,-1750.68 602812.5,-1794.68"/>
<text text-anchor="middle" x="602714" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="602714" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="602714" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="602714" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert6_attn_out -->
<g id="node1846" class="node">
<title>layer12_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="602597,-1794.68 602397,-1794.68 602397,-1750.68 602597,-1750.68 602597,-1794.68"/>
<text text-anchor="middle" x="602497" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="602497" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="602497" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="602497" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert6_attn_ar -->
<g id="node1847" class="node">
<title>layer12_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="602238" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="602238" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="602238" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="602238" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="602238" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert6_attn_res -->
<g id="node1848" class="node">
<title>layer12_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="602078.2,-1816.68 601748.59,-1816.68 601663.8,-1728.68 601993.41,-1728.68 602078.2,-1816.68"/>
<text text-anchor="middle" x="601871" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="601871" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="601871" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="601871" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert6_ln1 -->
<g id="node1849" class="node">
<title>layer12_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="601646,-1794.68 601446,-1794.68 601446,-1750.68 601646,-1750.68 601646,-1794.68"/>
<text text-anchor="middle" x="601546" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="601546" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="601546" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="601546" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert6_mlp1 -->
<g id="node1850" class="node">
<title>layer12_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="601428,-1794.68 601232,-1794.68 601232,-1750.68 601428,-1750.68 601428,-1794.68"/>
<text text-anchor="middle" x="601330" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="601330" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="601330" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="601330" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert6_gelu -->
<g id="node1851" class="node">
<title>layer12_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="601214,-1794.68 601018,-1794.68 601018,-1750.68 601214,-1750.68 601214,-1794.68"/>
<text text-anchor="middle" x="601116" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="601116" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="601116" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="601116" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert6_mlp2 -->
<g id="node1852" class="node">
<title>layer12_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="601000,-1794.68 600800,-1794.68 600800,-1750.68 601000,-1750.68 601000,-1794.68"/>
<text text-anchor="middle" x="600900" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="600900" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="600900" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="600900" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert6_mlp_ar -->
<g id="node1853" class="node">
<title>layer12_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="600641" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="600641" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="600641" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="600641" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="600641" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert6_mlp_res -->
<g id="node1854" class="node">
<title>layer12_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="600481.2,-1816.68 600151.59,-1816.68 600066.8,-1728.68 600396.41,-1728.68 600481.2,-1816.68"/>
<text text-anchor="middle" x="600274" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="600274" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="600274" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="600274" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert6_ln2 -->
<g id="node1855" class="node">
<title>layer12_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="600049,-1794.68 599849,-1794.68 599849,-1750.68 600049,-1750.68 600049,-1794.68"/>
<text text-anchor="middle" x="599949" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="599949" y="-1775.28" font-family="Arial" font-size="8.00">L12_E6</text>
<text text-anchor="middle" x="599949" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="599949" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert7_route -->
<g id="node1856" class="node">
<title>layer12_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="599825,-1794.68 599625,-1794.68 599625,-1750.68 599825,-1750.68 599825,-1794.68"/>
<text text-anchor="middle" x="599725" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="599725" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="599725" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="599725" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert7_gate -->
<g id="node1857" class="node">
<title>layer12_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="599607.04,-1816.68 599292,-1816.68 599210.96,-1728.68 599526,-1728.68 599607.04,-1816.68"/>
<text text-anchor="middle" x="599409" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="599409" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="599409" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="599409" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer12_expert7_a2a -->
<g id="node1858" class="node">
<title>layer12_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="599052" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="599052" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="599052" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="599052" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="599052" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert7_attn_split -->
<g id="node1859" class="node">
<title>layer12_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="598892.48,-1816.68 598567.2,-1816.68 598483.52,-1728.68 598808.8,-1728.68 598892.48,-1816.68"/>
<text text-anchor="middle" x="598688" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="598688" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="598688" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="598688" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert7_q_proj -->
<g id="node1860" class="node">
<title>layer12_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="598465.5,-1794.68 598268.5,-1794.68 598268.5,-1750.68 598465.5,-1750.68 598465.5,-1794.68"/>
<text text-anchor="middle" x="598367" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="598367" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="598367" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="598367" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert7_k_proj -->
<g id="node1861" class="node">
<title>layer12_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="598250.5,-1794.68 598053.5,-1794.68 598053.5,-1750.68 598250.5,-1750.68 598250.5,-1794.68"/>
<text text-anchor="middle" x="598152" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="598152" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="598152" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="598152" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert7_v_proj -->
<g id="node1862" class="node">
<title>layer12_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="598035.5,-1794.68 597838.5,-1794.68 597838.5,-1750.68 598035.5,-1750.68 598035.5,-1794.68"/>
<text text-anchor="middle" x="597937" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="597937" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="597937" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="597937" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert7_attn -->
<g id="node1863" class="node">
<title>layer12_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="597820.5,-1794.68 597623.5,-1794.68 597623.5,-1750.68 597820.5,-1750.68 597820.5,-1794.68"/>
<text text-anchor="middle" x="597722" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="597722" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="597722" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="597722" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer12_expert7_attn_out -->
<g id="node1864" class="node">
<title>layer12_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="597605,-1794.68 597405,-1794.68 597405,-1750.68 597605,-1750.68 597605,-1794.68"/>
<text text-anchor="middle" x="597505" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="597505" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="597505" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="597505" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert7_attn_ar -->
<g id="node1865" class="node">
<title>layer12_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="597246" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="597246" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="597246" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="597246" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="597246" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert7_attn_res -->
<g id="node1866" class="node">
<title>layer12_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="597086.2,-1816.68 596756.59,-1816.68 596671.8,-1728.68 597001.41,-1728.68 597086.2,-1816.68"/>
<text text-anchor="middle" x="596879" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="596879" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="596879" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="596879" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert7_ln1 -->
<g id="node1867" class="node">
<title>layer12_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="596654,-1794.68 596454,-1794.68 596454,-1750.68 596654,-1750.68 596654,-1794.68"/>
<text text-anchor="middle" x="596554" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="596554" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="596554" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="596554" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert7_mlp1 -->
<g id="node1868" class="node">
<title>layer12_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="596436,-1794.68 596240,-1794.68 596240,-1750.68 596436,-1750.68 596436,-1794.68"/>
<text text-anchor="middle" x="596338" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="596338" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="596338" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="596338" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert7_gelu -->
<g id="node1869" class="node">
<title>layer12_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="596222,-1794.68 596026,-1794.68 596026,-1750.68 596222,-1750.68 596222,-1794.68"/>
<text text-anchor="middle" x="596124" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="596124" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="596124" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="596124" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer12_expert7_mlp2 -->
<g id="node1870" class="node">
<title>layer12_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="596008,-1794.68 595808,-1794.68 595808,-1750.68 596008,-1750.68 596008,-1794.68"/>
<text text-anchor="middle" x="595908" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="595908" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="595908" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="595908" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert7_mlp_ar -->
<g id="node1871" class="node">
<title>layer12_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="595649" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="595649" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="595649" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="595649" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="595649" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert7_mlp_res -->
<g id="node1872" class="node">
<title>layer12_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="595489.2,-1816.68 595159.59,-1816.68 595074.8,-1728.68 595404.41,-1728.68 595489.2,-1816.68"/>
<text text-anchor="middle" x="595282" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="595282" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="595282" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="595282" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer12_expert7_ln2 -->
<g id="node1873" class="node">
<title>layer12_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="595057,-1794.68 594857,-1794.68 594857,-1750.68 595057,-1750.68 595057,-1794.68"/>
<text text-anchor="middle" x="594957" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="594957" y="-1775.28" font-family="Arial" font-size="8.00">L12_E7</text>
<text text-anchor="middle" x="594957" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="594957" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert0_route -->
<g id="node1874" class="node">
<title>layer13_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="594817,-1794.68 594617,-1794.68 594617,-1750.68 594817,-1750.68 594817,-1794.68"/>
<text text-anchor="middle" x="594717" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="594717" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="594717" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="594717" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert0_gate -->
<g id="node1875" class="node">
<title>layer13_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="594599.04,-1816.68 594284,-1816.68 594202.96,-1728.68 594518,-1728.68 594599.04,-1816.68"/>
<text text-anchor="middle" x="594401" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="594401" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="594401" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="594401" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer13_expert0_a2a -->
<g id="node1876" class="node">
<title>layer13_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="594044" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="594044" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="594044" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="594044" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="594044" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert0_attn_split -->
<g id="node1877" class="node">
<title>layer13_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="593884.48,-1816.68 593559.2,-1816.68 593475.52,-1728.68 593800.8,-1728.68 593884.48,-1816.68"/>
<text text-anchor="middle" x="593680" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="593680" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="593680" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="593680" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert0_q_proj -->
<g id="node1878" class="node">
<title>layer13_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="593457.5,-1794.68 593260.5,-1794.68 593260.5,-1750.68 593457.5,-1750.68 593457.5,-1794.68"/>
<text text-anchor="middle" x="593359" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="593359" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="593359" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="593359" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert0_k_proj -->
<g id="node1879" class="node">
<title>layer13_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="593242.5,-1794.68 593045.5,-1794.68 593045.5,-1750.68 593242.5,-1750.68 593242.5,-1794.68"/>
<text text-anchor="middle" x="593144" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="593144" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="593144" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="593144" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert0_v_proj -->
<g id="node1880" class="node">
<title>layer13_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="593027.5,-1794.68 592830.5,-1794.68 592830.5,-1750.68 593027.5,-1750.68 593027.5,-1794.68"/>
<text text-anchor="middle" x="592929" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="592929" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="592929" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="592929" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert0_attn -->
<g id="node1881" class="node">
<title>layer13_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="592812.5,-1794.68 592615.5,-1794.68 592615.5,-1750.68 592812.5,-1750.68 592812.5,-1794.68"/>
<text text-anchor="middle" x="592714" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="592714" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="592714" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="592714" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert0_attn_out -->
<g id="node1882" class="node">
<title>layer13_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="592597,-1794.68 592397,-1794.68 592397,-1750.68 592597,-1750.68 592597,-1794.68"/>
<text text-anchor="middle" x="592497" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="592497" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="592497" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="592497" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert0_attn_ar -->
<g id="node1883" class="node">
<title>layer13_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="592238" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="592238" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="592238" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="592238" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="592238" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert0_attn_res -->
<g id="node1884" class="node">
<title>layer13_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="592078.2,-1816.68 591748.59,-1816.68 591663.8,-1728.68 591993.41,-1728.68 592078.2,-1816.68"/>
<text text-anchor="middle" x="591871" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="591871" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="591871" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="591871" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert0_ln1 -->
<g id="node1885" class="node">
<title>layer13_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="591646,-1794.68 591446,-1794.68 591446,-1750.68 591646,-1750.68 591646,-1794.68"/>
<text text-anchor="middle" x="591546" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="591546" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="591546" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="591546" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert0_mlp1 -->
<g id="node1886" class="node">
<title>layer13_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="591428,-1794.68 591232,-1794.68 591232,-1750.68 591428,-1750.68 591428,-1794.68"/>
<text text-anchor="middle" x="591330" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="591330" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="591330" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="591330" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert0_gelu -->
<g id="node1887" class="node">
<title>layer13_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="591214,-1794.68 591018,-1794.68 591018,-1750.68 591214,-1750.68 591214,-1794.68"/>
<text text-anchor="middle" x="591116" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="591116" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="591116" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="591116" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert0_mlp2 -->
<g id="node1888" class="node">
<title>layer13_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="591000,-1794.68 590800,-1794.68 590800,-1750.68 591000,-1750.68 591000,-1794.68"/>
<text text-anchor="middle" x="590900" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="590900" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="590900" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="590900" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert0_mlp_ar -->
<g id="node1889" class="node">
<title>layer13_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="590641" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="590641" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="590641" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="590641" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="590641" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert0_mlp_res -->
<g id="node1890" class="node">
<title>layer13_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="590481.2,-1816.68 590151.59,-1816.68 590066.8,-1728.68 590396.41,-1728.68 590481.2,-1816.68"/>
<text text-anchor="middle" x="590274" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="590274" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="590274" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="590274" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert0_ln2 -->
<g id="node1891" class="node">
<title>layer13_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="590049,-1794.68 589849,-1794.68 589849,-1750.68 590049,-1750.68 590049,-1794.68"/>
<text text-anchor="middle" x="589949" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="589949" y="-1775.28" font-family="Arial" font-size="8.00">L13_E0</text>
<text text-anchor="middle" x="589949" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="589949" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert1_route -->
<g id="node1892" class="node">
<title>layer13_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="589825,-1794.68 589625,-1794.68 589625,-1750.68 589825,-1750.68 589825,-1794.68"/>
<text text-anchor="middle" x="589725" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="589725" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="589725" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="589725" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert1_gate -->
<g id="node1893" class="node">
<title>layer13_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="589607.04,-1816.68 589292,-1816.68 589210.96,-1728.68 589526,-1728.68 589607.04,-1816.68"/>
<text text-anchor="middle" x="589409" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="589409" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="589409" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="589409" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer13_expert1_a2a -->
<g id="node1894" class="node">
<title>layer13_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="589052" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="589052" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="589052" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="589052" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="589052" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert1_attn_split -->
<g id="node1895" class="node">
<title>layer13_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="588892.48,-1816.68 588567.2,-1816.68 588483.52,-1728.68 588808.8,-1728.68 588892.48,-1816.68"/>
<text text-anchor="middle" x="588688" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="588688" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="588688" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="588688" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert1_q_proj -->
<g id="node1896" class="node">
<title>layer13_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="588465.5,-1794.68 588268.5,-1794.68 588268.5,-1750.68 588465.5,-1750.68 588465.5,-1794.68"/>
<text text-anchor="middle" x="588367" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="588367" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="588367" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="588367" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert1_k_proj -->
<g id="node1897" class="node">
<title>layer13_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="588250.5,-1794.68 588053.5,-1794.68 588053.5,-1750.68 588250.5,-1750.68 588250.5,-1794.68"/>
<text text-anchor="middle" x="588152" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="588152" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="588152" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="588152" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert1_v_proj -->
<g id="node1898" class="node">
<title>layer13_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="588035.5,-1794.68 587838.5,-1794.68 587838.5,-1750.68 588035.5,-1750.68 588035.5,-1794.68"/>
<text text-anchor="middle" x="587937" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="587937" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="587937" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="587937" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert1_attn -->
<g id="node1899" class="node">
<title>layer13_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="587820.5,-1794.68 587623.5,-1794.68 587623.5,-1750.68 587820.5,-1750.68 587820.5,-1794.68"/>
<text text-anchor="middle" x="587722" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="587722" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="587722" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="587722" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert1_attn_out -->
<g id="node1900" class="node">
<title>layer13_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="587605,-1794.68 587405,-1794.68 587405,-1750.68 587605,-1750.68 587605,-1794.68"/>
<text text-anchor="middle" x="587505" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="587505" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="587505" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="587505" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert1_attn_ar -->
<g id="node1901" class="node">
<title>layer13_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="587246" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="587246" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="587246" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="587246" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="587246" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert1_attn_res -->
<g id="node1902" class="node">
<title>layer13_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="587086.2,-1816.68 586756.59,-1816.68 586671.8,-1728.68 587001.41,-1728.68 587086.2,-1816.68"/>
<text text-anchor="middle" x="586879" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="586879" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="586879" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="586879" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert1_ln1 -->
<g id="node1903" class="node">
<title>layer13_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="586654,-1794.68 586454,-1794.68 586454,-1750.68 586654,-1750.68 586654,-1794.68"/>
<text text-anchor="middle" x="586554" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="586554" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="586554" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="586554" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert1_mlp1 -->
<g id="node1904" class="node">
<title>layer13_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="586436,-1794.68 586240,-1794.68 586240,-1750.68 586436,-1750.68 586436,-1794.68"/>
<text text-anchor="middle" x="586338" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="586338" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="586338" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="586338" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert1_gelu -->
<g id="node1905" class="node">
<title>layer13_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="586222,-1794.68 586026,-1794.68 586026,-1750.68 586222,-1750.68 586222,-1794.68"/>
<text text-anchor="middle" x="586124" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="586124" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="586124" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="586124" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert1_mlp2 -->
<g id="node1906" class="node">
<title>layer13_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="586008,-1794.68 585808,-1794.68 585808,-1750.68 586008,-1750.68 586008,-1794.68"/>
<text text-anchor="middle" x="585908" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="585908" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="585908" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="585908" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert1_mlp_ar -->
<g id="node1907" class="node">
<title>layer13_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="585649" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="585649" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="585649" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="585649" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="585649" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert1_mlp_res -->
<g id="node1908" class="node">
<title>layer13_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="585489.2,-1816.68 585159.59,-1816.68 585074.8,-1728.68 585404.41,-1728.68 585489.2,-1816.68"/>
<text text-anchor="middle" x="585282" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="585282" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="585282" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="585282" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert1_ln2 -->
<g id="node1909" class="node">
<title>layer13_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="585057,-1794.68 584857,-1794.68 584857,-1750.68 585057,-1750.68 585057,-1794.68"/>
<text text-anchor="middle" x="584957" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="584957" y="-1775.28" font-family="Arial" font-size="8.00">L13_E1</text>
<text text-anchor="middle" x="584957" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="584957" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert2_route -->
<g id="node1910" class="node">
<title>layer13_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="584833,-1794.68 584633,-1794.68 584633,-1750.68 584833,-1750.68 584833,-1794.68"/>
<text text-anchor="middle" x="584733" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="584733" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="584733" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="584733" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert2_gate -->
<g id="node1911" class="node">
<title>layer13_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="584615.04,-1816.68 584300,-1816.68 584218.96,-1728.68 584534,-1728.68 584615.04,-1816.68"/>
<text text-anchor="middle" x="584417" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="584417" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="584417" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="584417" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer13_expert2_a2a -->
<g id="node1912" class="node">
<title>layer13_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="584060" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="584060" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="584060" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="584060" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="584060" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert2_attn_split -->
<g id="node1913" class="node">
<title>layer13_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="583900.48,-1816.68 583575.2,-1816.68 583491.52,-1728.68 583816.8,-1728.68 583900.48,-1816.68"/>
<text text-anchor="middle" x="583696" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="583696" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="583696" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="583696" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert2_q_proj -->
<g id="node1914" class="node">
<title>layer13_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="583473.5,-1794.68 583276.5,-1794.68 583276.5,-1750.68 583473.5,-1750.68 583473.5,-1794.68"/>
<text text-anchor="middle" x="583375" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="583375" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="583375" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="583375" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert2_k_proj -->
<g id="node1915" class="node">
<title>layer13_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="583258.5,-1794.68 583061.5,-1794.68 583061.5,-1750.68 583258.5,-1750.68 583258.5,-1794.68"/>
<text text-anchor="middle" x="583160" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="583160" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="583160" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="583160" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert2_v_proj -->
<g id="node1916" class="node">
<title>layer13_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="583043.5,-1794.68 582846.5,-1794.68 582846.5,-1750.68 583043.5,-1750.68 583043.5,-1794.68"/>
<text text-anchor="middle" x="582945" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="582945" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="582945" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="582945" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert2_attn -->
<g id="node1917" class="node">
<title>layer13_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="582828.5,-1794.68 582631.5,-1794.68 582631.5,-1750.68 582828.5,-1750.68 582828.5,-1794.68"/>
<text text-anchor="middle" x="582730" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="582730" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="582730" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="582730" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert2_attn_out -->
<g id="node1918" class="node">
<title>layer13_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="582613,-1794.68 582413,-1794.68 582413,-1750.68 582613,-1750.68 582613,-1794.68"/>
<text text-anchor="middle" x="582513" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="582513" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="582513" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="582513" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert2_attn_ar -->
<g id="node1919" class="node">
<title>layer13_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="582254" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="582254" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="582254" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="582254" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="582254" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert2_attn_res -->
<g id="node1920" class="node">
<title>layer13_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="582094.2,-1816.68 581764.59,-1816.68 581679.8,-1728.68 582009.41,-1728.68 582094.2,-1816.68"/>
<text text-anchor="middle" x="581887" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="581887" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="581887" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="581887" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert2_ln1 -->
<g id="node1921" class="node">
<title>layer13_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="581662,-1794.68 581462,-1794.68 581462,-1750.68 581662,-1750.68 581662,-1794.68"/>
<text text-anchor="middle" x="581562" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="581562" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="581562" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="581562" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert2_mlp1 -->
<g id="node1922" class="node">
<title>layer13_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="581444,-1794.68 581248,-1794.68 581248,-1750.68 581444,-1750.68 581444,-1794.68"/>
<text text-anchor="middle" x="581346" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="581346" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="581346" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="581346" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert2_gelu -->
<g id="node1923" class="node">
<title>layer13_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="581230,-1794.68 581034,-1794.68 581034,-1750.68 581230,-1750.68 581230,-1794.68"/>
<text text-anchor="middle" x="581132" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="581132" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="581132" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="581132" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert2_mlp2 -->
<g id="node1924" class="node">
<title>layer13_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="581016,-1794.68 580816,-1794.68 580816,-1750.68 581016,-1750.68 581016,-1794.68"/>
<text text-anchor="middle" x="580916" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="580916" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="580916" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="580916" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert2_mlp_ar -->
<g id="node1925" class="node">
<title>layer13_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="580657" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="580657" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="580657" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="580657" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="580657" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert2_mlp_res -->
<g id="node1926" class="node">
<title>layer13_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="580497.2,-1816.68 580167.59,-1816.68 580082.8,-1728.68 580412.41,-1728.68 580497.2,-1816.68"/>
<text text-anchor="middle" x="580290" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="580290" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="580290" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="580290" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert2_ln2 -->
<g id="node1927" class="node">
<title>layer13_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="580065,-1794.68 579865,-1794.68 579865,-1750.68 580065,-1750.68 580065,-1794.68"/>
<text text-anchor="middle" x="579965" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="579965" y="-1775.28" font-family="Arial" font-size="8.00">L13_E2</text>
<text text-anchor="middle" x="579965" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="579965" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert3_route -->
<g id="node1928" class="node">
<title>layer13_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="579841,-1794.68 579641,-1794.68 579641,-1750.68 579841,-1750.68 579841,-1794.68"/>
<text text-anchor="middle" x="579741" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="579741" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="579741" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="579741" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert3_gate -->
<g id="node1929" class="node">
<title>layer13_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="579623.04,-1816.68 579308,-1816.68 579226.96,-1728.68 579542,-1728.68 579623.04,-1816.68"/>
<text text-anchor="middle" x="579425" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="579425" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="579425" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="579425" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer13_expert3_a2a -->
<g id="node1930" class="node">
<title>layer13_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="579068" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="579068" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="579068" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="579068" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="579068" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert3_attn_split -->
<g id="node1931" class="node">
<title>layer13_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="578908.48,-1816.68 578583.2,-1816.68 578499.52,-1728.68 578824.8,-1728.68 578908.48,-1816.68"/>
<text text-anchor="middle" x="578704" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="578704" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="578704" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="578704" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert3_q_proj -->
<g id="node1932" class="node">
<title>layer13_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="578481.5,-1794.68 578284.5,-1794.68 578284.5,-1750.68 578481.5,-1750.68 578481.5,-1794.68"/>
<text text-anchor="middle" x="578383" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="578383" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="578383" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="578383" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert3_k_proj -->
<g id="node1933" class="node">
<title>layer13_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="578266.5,-1794.68 578069.5,-1794.68 578069.5,-1750.68 578266.5,-1750.68 578266.5,-1794.68"/>
<text text-anchor="middle" x="578168" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="578168" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="578168" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="578168" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert3_v_proj -->
<g id="node1934" class="node">
<title>layer13_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="578051.5,-1794.68 577854.5,-1794.68 577854.5,-1750.68 578051.5,-1750.68 578051.5,-1794.68"/>
<text text-anchor="middle" x="577953" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="577953" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="577953" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="577953" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert3_attn -->
<g id="node1935" class="node">
<title>layer13_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="577836.5,-1794.68 577639.5,-1794.68 577639.5,-1750.68 577836.5,-1750.68 577836.5,-1794.68"/>
<text text-anchor="middle" x="577738" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="577738" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="577738" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="577738" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert3_attn_out -->
<g id="node1936" class="node">
<title>layer13_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="577621,-1794.68 577421,-1794.68 577421,-1750.68 577621,-1750.68 577621,-1794.68"/>
<text text-anchor="middle" x="577521" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="577521" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="577521" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="577521" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert3_attn_ar -->
<g id="node1937" class="node">
<title>layer13_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="577262" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="577262" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="577262" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="577262" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="577262" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert3_attn_res -->
<g id="node1938" class="node">
<title>layer13_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="577102.2,-1816.68 576772.59,-1816.68 576687.8,-1728.68 577017.41,-1728.68 577102.2,-1816.68"/>
<text text-anchor="middle" x="576895" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="576895" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="576895" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="576895" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert3_ln1 -->
<g id="node1939" class="node">
<title>layer13_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="576670,-1794.68 576470,-1794.68 576470,-1750.68 576670,-1750.68 576670,-1794.68"/>
<text text-anchor="middle" x="576570" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="576570" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="576570" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="576570" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert3_mlp1 -->
<g id="node1940" class="node">
<title>layer13_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="576452,-1794.68 576256,-1794.68 576256,-1750.68 576452,-1750.68 576452,-1794.68"/>
<text text-anchor="middle" x="576354" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="576354" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="576354" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="576354" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert3_gelu -->
<g id="node1941" class="node">
<title>layer13_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="576238,-1794.68 576042,-1794.68 576042,-1750.68 576238,-1750.68 576238,-1794.68"/>
<text text-anchor="middle" x="576140" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="576140" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="576140" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="576140" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert3_mlp2 -->
<g id="node1942" class="node">
<title>layer13_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="576024,-1794.68 575824,-1794.68 575824,-1750.68 576024,-1750.68 576024,-1794.68"/>
<text text-anchor="middle" x="575924" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="575924" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="575924" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="575924" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert3_mlp_ar -->
<g id="node1943" class="node">
<title>layer13_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="575665" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="575665" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="575665" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="575665" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="575665" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert3_mlp_res -->
<g id="node1944" class="node">
<title>layer13_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="575505.2,-1816.68 575175.59,-1816.68 575090.8,-1728.68 575420.41,-1728.68 575505.2,-1816.68"/>
<text text-anchor="middle" x="575298" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="575298" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="575298" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="575298" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert3_ln2 -->
<g id="node1945" class="node">
<title>layer13_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="575073,-1794.68 574873,-1794.68 574873,-1750.68 575073,-1750.68 575073,-1794.68"/>
<text text-anchor="middle" x="574973" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="574973" y="-1775.28" font-family="Arial" font-size="8.00">L13_E3</text>
<text text-anchor="middle" x="574973" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="574973" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert4_route -->
<g id="node1946" class="node">
<title>layer13_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="574849,-1794.68 574649,-1794.68 574649,-1750.68 574849,-1750.68 574849,-1794.68"/>
<text text-anchor="middle" x="574749" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="574749" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="574749" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="574749" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert4_gate -->
<g id="node1947" class="node">
<title>layer13_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="574631.04,-1816.68 574316,-1816.68 574234.96,-1728.68 574550,-1728.68 574631.04,-1816.68"/>
<text text-anchor="middle" x="574433" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="574433" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="574433" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="574433" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer13_expert4_a2a -->
<g id="node1948" class="node">
<title>layer13_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="574076" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="574076" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="574076" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="574076" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="574076" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert4_attn_split -->
<g id="node1949" class="node">
<title>layer13_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="573916.48,-1816.68 573591.2,-1816.68 573507.52,-1728.68 573832.8,-1728.68 573916.48,-1816.68"/>
<text text-anchor="middle" x="573712" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="573712" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="573712" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="573712" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert4_q_proj -->
<g id="node1950" class="node">
<title>layer13_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="573489.5,-1794.68 573292.5,-1794.68 573292.5,-1750.68 573489.5,-1750.68 573489.5,-1794.68"/>
<text text-anchor="middle" x="573391" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="573391" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="573391" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="573391" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert4_k_proj -->
<g id="node1951" class="node">
<title>layer13_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="573274.5,-1794.68 573077.5,-1794.68 573077.5,-1750.68 573274.5,-1750.68 573274.5,-1794.68"/>
<text text-anchor="middle" x="573176" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="573176" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="573176" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="573176" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert4_v_proj -->
<g id="node1952" class="node">
<title>layer13_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="573059.5,-1794.68 572862.5,-1794.68 572862.5,-1750.68 573059.5,-1750.68 573059.5,-1794.68"/>
<text text-anchor="middle" x="572961" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="572961" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="572961" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="572961" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert4_attn -->
<g id="node1953" class="node">
<title>layer13_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="572844.5,-1794.68 572647.5,-1794.68 572647.5,-1750.68 572844.5,-1750.68 572844.5,-1794.68"/>
<text text-anchor="middle" x="572746" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="572746" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="572746" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="572746" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert4_attn_out -->
<g id="node1954" class="node">
<title>layer13_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="572629,-1794.68 572429,-1794.68 572429,-1750.68 572629,-1750.68 572629,-1794.68"/>
<text text-anchor="middle" x="572529" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="572529" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="572529" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="572529" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert4_attn_ar -->
<g id="node1955" class="node">
<title>layer13_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="572270" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="572270" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="572270" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="572270" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="572270" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert4_attn_res -->
<g id="node1956" class="node">
<title>layer13_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="572110.2,-1816.68 571780.59,-1816.68 571695.8,-1728.68 572025.41,-1728.68 572110.2,-1816.68"/>
<text text-anchor="middle" x="571903" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="571903" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="571903" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="571903" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert4_ln1 -->
<g id="node1957" class="node">
<title>layer13_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="571678,-1794.68 571478,-1794.68 571478,-1750.68 571678,-1750.68 571678,-1794.68"/>
<text text-anchor="middle" x="571578" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="571578" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="571578" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="571578" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert4_mlp1 -->
<g id="node1958" class="node">
<title>layer13_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="571460,-1794.68 571264,-1794.68 571264,-1750.68 571460,-1750.68 571460,-1794.68"/>
<text text-anchor="middle" x="571362" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="571362" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="571362" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="571362" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert4_gelu -->
<g id="node1959" class="node">
<title>layer13_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="571246,-1794.68 571050,-1794.68 571050,-1750.68 571246,-1750.68 571246,-1794.68"/>
<text text-anchor="middle" x="571148" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="571148" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="571148" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="571148" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert4_mlp2 -->
<g id="node1960" class="node">
<title>layer13_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="571032,-1794.68 570832,-1794.68 570832,-1750.68 571032,-1750.68 571032,-1794.68"/>
<text text-anchor="middle" x="570932" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="570932" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="570932" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="570932" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert4_mlp_ar -->
<g id="node1961" class="node">
<title>layer13_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="570673" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="570673" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="570673" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="570673" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="570673" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert4_mlp_res -->
<g id="node1962" class="node">
<title>layer13_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="570513.2,-1816.68 570183.59,-1816.68 570098.8,-1728.68 570428.41,-1728.68 570513.2,-1816.68"/>
<text text-anchor="middle" x="570306" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="570306" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="570306" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="570306" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert4_ln2 -->
<g id="node1963" class="node">
<title>layer13_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="570081,-1794.68 569881,-1794.68 569881,-1750.68 570081,-1750.68 570081,-1794.68"/>
<text text-anchor="middle" x="569981" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="569981" y="-1775.28" font-family="Arial" font-size="8.00">L13_E4</text>
<text text-anchor="middle" x="569981" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="569981" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert5_route -->
<g id="node1964" class="node">
<title>layer13_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="569857,-1794.68 569657,-1794.68 569657,-1750.68 569857,-1750.68 569857,-1794.68"/>
<text text-anchor="middle" x="569757" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="569757" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="569757" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="569757" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert5_gate -->
<g id="node1965" class="node">
<title>layer13_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="569639.04,-1816.68 569324,-1816.68 569242.96,-1728.68 569558,-1728.68 569639.04,-1816.68"/>
<text text-anchor="middle" x="569441" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="569441" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="569441" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="569441" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer13_expert5_a2a -->
<g id="node1966" class="node">
<title>layer13_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="569084" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="569084" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="569084" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="569084" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="569084" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert5_attn_split -->
<g id="node1967" class="node">
<title>layer13_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="568924.48,-1816.68 568599.2,-1816.68 568515.52,-1728.68 568840.8,-1728.68 568924.48,-1816.68"/>
<text text-anchor="middle" x="568720" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="568720" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="568720" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="568720" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert5_q_proj -->
<g id="node1968" class="node">
<title>layer13_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="568497.5,-1794.68 568300.5,-1794.68 568300.5,-1750.68 568497.5,-1750.68 568497.5,-1794.68"/>
<text text-anchor="middle" x="568399" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="568399" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="568399" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="568399" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert5_k_proj -->
<g id="node1969" class="node">
<title>layer13_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="568282.5,-1794.68 568085.5,-1794.68 568085.5,-1750.68 568282.5,-1750.68 568282.5,-1794.68"/>
<text text-anchor="middle" x="568184" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="568184" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="568184" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="568184" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert5_v_proj -->
<g id="node1970" class="node">
<title>layer13_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="568067.5,-1794.68 567870.5,-1794.68 567870.5,-1750.68 568067.5,-1750.68 568067.5,-1794.68"/>
<text text-anchor="middle" x="567969" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="567969" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="567969" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="567969" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert5_attn -->
<g id="node1971" class="node">
<title>layer13_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="567852.5,-1794.68 567655.5,-1794.68 567655.5,-1750.68 567852.5,-1750.68 567852.5,-1794.68"/>
<text text-anchor="middle" x="567754" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="567754" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="567754" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="567754" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert5_attn_out -->
<g id="node1972" class="node">
<title>layer13_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="567637,-1794.68 567437,-1794.68 567437,-1750.68 567637,-1750.68 567637,-1794.68"/>
<text text-anchor="middle" x="567537" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="567537" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="567537" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="567537" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert5_attn_ar -->
<g id="node1973" class="node">
<title>layer13_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="567278" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="567278" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="567278" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="567278" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="567278" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert5_attn_res -->
<g id="node1974" class="node">
<title>layer13_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="567118.2,-1816.68 566788.59,-1816.68 566703.8,-1728.68 567033.41,-1728.68 567118.2,-1816.68"/>
<text text-anchor="middle" x="566911" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="566911" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="566911" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="566911" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert5_ln1 -->
<g id="node1975" class="node">
<title>layer13_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="566686,-1794.68 566486,-1794.68 566486,-1750.68 566686,-1750.68 566686,-1794.68"/>
<text text-anchor="middle" x="566586" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="566586" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="566586" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="566586" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert5_mlp1 -->
<g id="node1976" class="node">
<title>layer13_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="566468,-1794.68 566272,-1794.68 566272,-1750.68 566468,-1750.68 566468,-1794.68"/>
<text text-anchor="middle" x="566370" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="566370" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="566370" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="566370" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert5_gelu -->
<g id="node1977" class="node">
<title>layer13_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="566254,-1794.68 566058,-1794.68 566058,-1750.68 566254,-1750.68 566254,-1794.68"/>
<text text-anchor="middle" x="566156" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="566156" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="566156" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="566156" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert5_mlp2 -->
<g id="node1978" class="node">
<title>layer13_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="566040,-1794.68 565840,-1794.68 565840,-1750.68 566040,-1750.68 566040,-1794.68"/>
<text text-anchor="middle" x="565940" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="565940" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="565940" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="565940" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert5_mlp_ar -->
<g id="node1979" class="node">
<title>layer13_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="565681" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="565681" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="565681" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="565681" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="565681" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert5_mlp_res -->
<g id="node1980" class="node">
<title>layer13_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="565521.2,-1816.68 565191.59,-1816.68 565106.8,-1728.68 565436.41,-1728.68 565521.2,-1816.68"/>
<text text-anchor="middle" x="565314" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="565314" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="565314" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="565314" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert5_ln2 -->
<g id="node1981" class="node">
<title>layer13_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="565089,-1794.68 564889,-1794.68 564889,-1750.68 565089,-1750.68 565089,-1794.68"/>
<text text-anchor="middle" x="564989" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="564989" y="-1775.28" font-family="Arial" font-size="8.00">L13_E5</text>
<text text-anchor="middle" x="564989" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="564989" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert6_route -->
<g id="node1982" class="node">
<title>layer13_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="564865,-1794.68 564665,-1794.68 564665,-1750.68 564865,-1750.68 564865,-1794.68"/>
<text text-anchor="middle" x="564765" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="564765" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="564765" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="564765" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert6_gate -->
<g id="node1983" class="node">
<title>layer13_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="564647.04,-1816.68 564332,-1816.68 564250.96,-1728.68 564566,-1728.68 564647.04,-1816.68"/>
<text text-anchor="middle" x="564449" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="564449" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="564449" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="564449" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer13_expert6_a2a -->
<g id="node1984" class="node">
<title>layer13_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="564092" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="564092" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="564092" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="564092" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="564092" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert6_attn_split -->
<g id="node1985" class="node">
<title>layer13_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="563932.48,-1816.68 563607.2,-1816.68 563523.52,-1728.68 563848.8,-1728.68 563932.48,-1816.68"/>
<text text-anchor="middle" x="563728" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="563728" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="563728" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="563728" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert6_q_proj -->
<g id="node1986" class="node">
<title>layer13_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="563505.5,-1794.68 563308.5,-1794.68 563308.5,-1750.68 563505.5,-1750.68 563505.5,-1794.68"/>
<text text-anchor="middle" x="563407" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="563407" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="563407" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="563407" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert6_k_proj -->
<g id="node1987" class="node">
<title>layer13_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="563290.5,-1794.68 563093.5,-1794.68 563093.5,-1750.68 563290.5,-1750.68 563290.5,-1794.68"/>
<text text-anchor="middle" x="563192" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="563192" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="563192" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="563192" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert6_v_proj -->
<g id="node1988" class="node">
<title>layer13_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="563075.5,-1794.68 562878.5,-1794.68 562878.5,-1750.68 563075.5,-1750.68 563075.5,-1794.68"/>
<text text-anchor="middle" x="562977" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="562977" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="562977" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="562977" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert6_attn -->
<g id="node1989" class="node">
<title>layer13_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="562860.5,-1794.68 562663.5,-1794.68 562663.5,-1750.68 562860.5,-1750.68 562860.5,-1794.68"/>
<text text-anchor="middle" x="562762" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="562762" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="562762" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="562762" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert6_attn_out -->
<g id="node1990" class="node">
<title>layer13_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="562645,-1794.68 562445,-1794.68 562445,-1750.68 562645,-1750.68 562645,-1794.68"/>
<text text-anchor="middle" x="562545" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="562545" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="562545" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="562545" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert6_attn_ar -->
<g id="node1991" class="node">
<title>layer13_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="562286" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="562286" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="562286" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="562286" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="562286" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert6_attn_res -->
<g id="node1992" class="node">
<title>layer13_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="562126.2,-1816.68 561796.59,-1816.68 561711.8,-1728.68 562041.41,-1728.68 562126.2,-1816.68"/>
<text text-anchor="middle" x="561919" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="561919" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="561919" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="561919" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert6_ln1 -->
<g id="node1993" class="node">
<title>layer13_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="561694,-1794.68 561494,-1794.68 561494,-1750.68 561694,-1750.68 561694,-1794.68"/>
<text text-anchor="middle" x="561594" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="561594" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="561594" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="561594" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert6_mlp1 -->
<g id="node1994" class="node">
<title>layer13_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="561476,-1794.68 561280,-1794.68 561280,-1750.68 561476,-1750.68 561476,-1794.68"/>
<text text-anchor="middle" x="561378" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="561378" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="561378" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="561378" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert6_gelu -->
<g id="node1995" class="node">
<title>layer13_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="561262,-1794.68 561066,-1794.68 561066,-1750.68 561262,-1750.68 561262,-1794.68"/>
<text text-anchor="middle" x="561164" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="561164" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="561164" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="561164" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert6_mlp2 -->
<g id="node1996" class="node">
<title>layer13_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="561048,-1794.68 560848,-1794.68 560848,-1750.68 561048,-1750.68 561048,-1794.68"/>
<text text-anchor="middle" x="560948" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="560948" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="560948" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="560948" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert6_mlp_ar -->
<g id="node1997" class="node">
<title>layer13_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="560689" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="560689" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="560689" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="560689" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="560689" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert6_mlp_res -->
<g id="node1998" class="node">
<title>layer13_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="560529.2,-1816.68 560199.59,-1816.68 560114.8,-1728.68 560444.41,-1728.68 560529.2,-1816.68"/>
<text text-anchor="middle" x="560322" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="560322" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="560322" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="560322" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert6_ln2 -->
<g id="node1999" class="node">
<title>layer13_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="560097,-1794.68 559897,-1794.68 559897,-1750.68 560097,-1750.68 560097,-1794.68"/>
<text text-anchor="middle" x="559997" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="559997" y="-1775.28" font-family="Arial" font-size="8.00">L13_E6</text>
<text text-anchor="middle" x="559997" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="559997" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert7_route -->
<g id="node2000" class="node">
<title>layer13_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="559873,-1794.68 559673,-1794.68 559673,-1750.68 559873,-1750.68 559873,-1794.68"/>
<text text-anchor="middle" x="559773" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="559773" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="559773" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="559773" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert7_gate -->
<g id="node2001" class="node">
<title>layer13_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="559655.04,-1816.68 559340,-1816.68 559258.96,-1728.68 559574,-1728.68 559655.04,-1816.68"/>
<text text-anchor="middle" x="559457" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="559457" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="559457" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="559457" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer13_expert7_a2a -->
<g id="node2002" class="node">
<title>layer13_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="559100" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="559100" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="559100" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="559100" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="559100" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert7_attn_split -->
<g id="node2003" class="node">
<title>layer13_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="558940.48,-1816.68 558615.2,-1816.68 558531.52,-1728.68 558856.8,-1728.68 558940.48,-1816.68"/>
<text text-anchor="middle" x="558736" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="558736" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="558736" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="558736" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert7_q_proj -->
<g id="node2004" class="node">
<title>layer13_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="558513.5,-1794.68 558316.5,-1794.68 558316.5,-1750.68 558513.5,-1750.68 558513.5,-1794.68"/>
<text text-anchor="middle" x="558415" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="558415" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="558415" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="558415" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert7_k_proj -->
<g id="node2005" class="node">
<title>layer13_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="558298.5,-1794.68 558101.5,-1794.68 558101.5,-1750.68 558298.5,-1750.68 558298.5,-1794.68"/>
<text text-anchor="middle" x="558200" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="558200" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="558200" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="558200" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert7_v_proj -->
<g id="node2006" class="node">
<title>layer13_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="558083.5,-1794.68 557886.5,-1794.68 557886.5,-1750.68 558083.5,-1750.68 558083.5,-1794.68"/>
<text text-anchor="middle" x="557985" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="557985" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="557985" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="557985" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert7_attn -->
<g id="node2007" class="node">
<title>layer13_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="557868.5,-1794.68 557671.5,-1794.68 557671.5,-1750.68 557868.5,-1750.68 557868.5,-1794.68"/>
<text text-anchor="middle" x="557770" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="557770" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="557770" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="557770" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer13_expert7_attn_out -->
<g id="node2008" class="node">
<title>layer13_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="557653,-1794.68 557453,-1794.68 557453,-1750.68 557653,-1750.68 557653,-1794.68"/>
<text text-anchor="middle" x="557553" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="557553" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="557553" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="557553" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert7_attn_ar -->
<g id="node2009" class="node">
<title>layer13_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="557294" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="557294" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="557294" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="557294" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="557294" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert7_attn_res -->
<g id="node2010" class="node">
<title>layer13_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="557134.2,-1816.68 556804.59,-1816.68 556719.8,-1728.68 557049.41,-1728.68 557134.2,-1816.68"/>
<text text-anchor="middle" x="556927" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="556927" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="556927" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="556927" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert7_ln1 -->
<g id="node2011" class="node">
<title>layer13_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="556702,-1794.68 556502,-1794.68 556502,-1750.68 556702,-1750.68 556702,-1794.68"/>
<text text-anchor="middle" x="556602" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="556602" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="556602" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="556602" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert7_mlp1 -->
<g id="node2012" class="node">
<title>layer13_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="556484,-1794.68 556288,-1794.68 556288,-1750.68 556484,-1750.68 556484,-1794.68"/>
<text text-anchor="middle" x="556386" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="556386" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="556386" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="556386" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert7_gelu -->
<g id="node2013" class="node">
<title>layer13_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="556270,-1794.68 556074,-1794.68 556074,-1750.68 556270,-1750.68 556270,-1794.68"/>
<text text-anchor="middle" x="556172" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="556172" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="556172" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="556172" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer13_expert7_mlp2 -->
<g id="node2014" class="node">
<title>layer13_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="556056,-1794.68 555856,-1794.68 555856,-1750.68 556056,-1750.68 556056,-1794.68"/>
<text text-anchor="middle" x="555956" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="555956" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="555956" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="555956" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert7_mlp_ar -->
<g id="node2015" class="node">
<title>layer13_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="555697" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="555697" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="555697" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="555697" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="555697" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert7_mlp_res -->
<g id="node2016" class="node">
<title>layer13_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="555537.2,-1816.68 555207.59,-1816.68 555122.8,-1728.68 555452.41,-1728.68 555537.2,-1816.68"/>
<text text-anchor="middle" x="555330" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="555330" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="555330" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="555330" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer13_expert7_ln2 -->
<g id="node2017" class="node">
<title>layer13_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="555105,-1794.68 554905,-1794.68 554905,-1750.68 555105,-1750.68 555105,-1794.68"/>
<text text-anchor="middle" x="555005" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="555005" y="-1775.28" font-family="Arial" font-size="8.00">L13_E7</text>
<text text-anchor="middle" x="555005" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="555005" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert0_route -->
<g id="node2018" class="node">
<title>layer14_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="554865,-1794.68 554665,-1794.68 554665,-1750.68 554865,-1750.68 554865,-1794.68"/>
<text text-anchor="middle" x="554765" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="554765" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="554765" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="554765" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert0_gate -->
<g id="node2019" class="node">
<title>layer14_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="554647.04,-1816.68 554332,-1816.68 554250.96,-1728.68 554566,-1728.68 554647.04,-1816.68"/>
<text text-anchor="middle" x="554449" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="554449" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="554449" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="554449" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer14_expert0_a2a -->
<g id="node2020" class="node">
<title>layer14_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="554092" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="554092" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="554092" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="554092" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="554092" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert0_attn_split -->
<g id="node2021" class="node">
<title>layer14_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="553932.48,-1816.68 553607.2,-1816.68 553523.52,-1728.68 553848.8,-1728.68 553932.48,-1816.68"/>
<text text-anchor="middle" x="553728" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="553728" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="553728" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="553728" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert0_q_proj -->
<g id="node2022" class="node">
<title>layer14_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="553505.5,-1794.68 553308.5,-1794.68 553308.5,-1750.68 553505.5,-1750.68 553505.5,-1794.68"/>
<text text-anchor="middle" x="553407" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="553407" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="553407" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="553407" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert0_k_proj -->
<g id="node2023" class="node">
<title>layer14_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="553290.5,-1794.68 553093.5,-1794.68 553093.5,-1750.68 553290.5,-1750.68 553290.5,-1794.68"/>
<text text-anchor="middle" x="553192" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="553192" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="553192" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="553192" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert0_v_proj -->
<g id="node2024" class="node">
<title>layer14_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="553075.5,-1794.68 552878.5,-1794.68 552878.5,-1750.68 553075.5,-1750.68 553075.5,-1794.68"/>
<text text-anchor="middle" x="552977" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="552977" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="552977" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="552977" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert0_attn -->
<g id="node2025" class="node">
<title>layer14_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="552860.5,-1794.68 552663.5,-1794.68 552663.5,-1750.68 552860.5,-1750.68 552860.5,-1794.68"/>
<text text-anchor="middle" x="552762" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="552762" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="552762" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="552762" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert0_attn_out -->
<g id="node2026" class="node">
<title>layer14_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="552645,-1794.68 552445,-1794.68 552445,-1750.68 552645,-1750.68 552645,-1794.68"/>
<text text-anchor="middle" x="552545" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="552545" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="552545" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="552545" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert0_attn_ar -->
<g id="node2027" class="node">
<title>layer14_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="552286" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="552286" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="552286" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="552286" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="552286" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert0_attn_res -->
<g id="node2028" class="node">
<title>layer14_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="552126.2,-1816.68 551796.59,-1816.68 551711.8,-1728.68 552041.41,-1728.68 552126.2,-1816.68"/>
<text text-anchor="middle" x="551919" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="551919" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="551919" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="551919" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert0_ln1 -->
<g id="node2029" class="node">
<title>layer14_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="551694,-1794.68 551494,-1794.68 551494,-1750.68 551694,-1750.68 551694,-1794.68"/>
<text text-anchor="middle" x="551594" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="551594" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="551594" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="551594" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert0_mlp1 -->
<g id="node2030" class="node">
<title>layer14_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="551476,-1794.68 551280,-1794.68 551280,-1750.68 551476,-1750.68 551476,-1794.68"/>
<text text-anchor="middle" x="551378" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="551378" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="551378" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="551378" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert0_gelu -->
<g id="node2031" class="node">
<title>layer14_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="551262,-1794.68 551066,-1794.68 551066,-1750.68 551262,-1750.68 551262,-1794.68"/>
<text text-anchor="middle" x="551164" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="551164" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="551164" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="551164" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert0_mlp2 -->
<g id="node2032" class="node">
<title>layer14_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="551048,-1794.68 550848,-1794.68 550848,-1750.68 551048,-1750.68 551048,-1794.68"/>
<text text-anchor="middle" x="550948" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="550948" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="550948" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="550948" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert0_mlp_ar -->
<g id="node2033" class="node">
<title>layer14_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="550689" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="550689" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="550689" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="550689" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="550689" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert0_mlp_res -->
<g id="node2034" class="node">
<title>layer14_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="550529.2,-1816.68 550199.59,-1816.68 550114.8,-1728.68 550444.41,-1728.68 550529.2,-1816.68"/>
<text text-anchor="middle" x="550322" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="550322" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="550322" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="550322" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert0_ln2 -->
<g id="node2035" class="node">
<title>layer14_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="550097,-1794.68 549897,-1794.68 549897,-1750.68 550097,-1750.68 550097,-1794.68"/>
<text text-anchor="middle" x="549997" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="549997" y="-1775.28" font-family="Arial" font-size="8.00">L14_E0</text>
<text text-anchor="middle" x="549997" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="549997" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert1_route -->
<g id="node2036" class="node">
<title>layer14_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="549873,-1794.68 549673,-1794.68 549673,-1750.68 549873,-1750.68 549873,-1794.68"/>
<text text-anchor="middle" x="549773" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="549773" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="549773" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="549773" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert1_gate -->
<g id="node2037" class="node">
<title>layer14_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="549655.04,-1816.68 549340,-1816.68 549258.96,-1728.68 549574,-1728.68 549655.04,-1816.68"/>
<text text-anchor="middle" x="549457" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="549457" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="549457" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="549457" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer14_expert1_a2a -->
<g id="node2038" class="node">
<title>layer14_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="549100" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="549100" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="549100" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="549100" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="549100" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert1_attn_split -->
<g id="node2039" class="node">
<title>layer14_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="548940.48,-1816.68 548615.2,-1816.68 548531.52,-1728.68 548856.8,-1728.68 548940.48,-1816.68"/>
<text text-anchor="middle" x="548736" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="548736" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="548736" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="548736" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert1_q_proj -->
<g id="node2040" class="node">
<title>layer14_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="548513.5,-1794.68 548316.5,-1794.68 548316.5,-1750.68 548513.5,-1750.68 548513.5,-1794.68"/>
<text text-anchor="middle" x="548415" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="548415" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="548415" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="548415" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert1_k_proj -->
<g id="node2041" class="node">
<title>layer14_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="548298.5,-1794.68 548101.5,-1794.68 548101.5,-1750.68 548298.5,-1750.68 548298.5,-1794.68"/>
<text text-anchor="middle" x="548200" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="548200" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="548200" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="548200" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert1_v_proj -->
<g id="node2042" class="node">
<title>layer14_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="548083.5,-1794.68 547886.5,-1794.68 547886.5,-1750.68 548083.5,-1750.68 548083.5,-1794.68"/>
<text text-anchor="middle" x="547985" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="547985" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="547985" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="547985" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert1_attn -->
<g id="node2043" class="node">
<title>layer14_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="547868.5,-1794.68 547671.5,-1794.68 547671.5,-1750.68 547868.5,-1750.68 547868.5,-1794.68"/>
<text text-anchor="middle" x="547770" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="547770" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="547770" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="547770" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert1_attn_out -->
<g id="node2044" class="node">
<title>layer14_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="547653,-1794.68 547453,-1794.68 547453,-1750.68 547653,-1750.68 547653,-1794.68"/>
<text text-anchor="middle" x="547553" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="547553" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="547553" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="547553" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert1_attn_ar -->
<g id="node2045" class="node">
<title>layer14_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="547294" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="547294" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="547294" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="547294" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="547294" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert1_attn_res -->
<g id="node2046" class="node">
<title>layer14_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="547134.2,-1816.68 546804.59,-1816.68 546719.8,-1728.68 547049.41,-1728.68 547134.2,-1816.68"/>
<text text-anchor="middle" x="546927" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="546927" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="546927" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="546927" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert1_ln1 -->
<g id="node2047" class="node">
<title>layer14_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="546702,-1794.68 546502,-1794.68 546502,-1750.68 546702,-1750.68 546702,-1794.68"/>
<text text-anchor="middle" x="546602" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="546602" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="546602" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="546602" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert1_mlp1 -->
<g id="node2048" class="node">
<title>layer14_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="546484,-1794.68 546288,-1794.68 546288,-1750.68 546484,-1750.68 546484,-1794.68"/>
<text text-anchor="middle" x="546386" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="546386" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="546386" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="546386" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert1_gelu -->
<g id="node2049" class="node">
<title>layer14_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="546270,-1794.68 546074,-1794.68 546074,-1750.68 546270,-1750.68 546270,-1794.68"/>
<text text-anchor="middle" x="546172" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="546172" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="546172" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="546172" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert1_mlp2 -->
<g id="node2050" class="node">
<title>layer14_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="546056,-1794.68 545856,-1794.68 545856,-1750.68 546056,-1750.68 546056,-1794.68"/>
<text text-anchor="middle" x="545956" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="545956" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="545956" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="545956" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert1_mlp_ar -->
<g id="node2051" class="node">
<title>layer14_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="545697" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="545697" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="545697" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="545697" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="545697" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert1_mlp_res -->
<g id="node2052" class="node">
<title>layer14_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="545537.2,-1816.68 545207.59,-1816.68 545122.8,-1728.68 545452.41,-1728.68 545537.2,-1816.68"/>
<text text-anchor="middle" x="545330" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="545330" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="545330" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="545330" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert1_ln2 -->
<g id="node2053" class="node">
<title>layer14_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="545105,-1794.68 544905,-1794.68 544905,-1750.68 545105,-1750.68 545105,-1794.68"/>
<text text-anchor="middle" x="545005" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="545005" y="-1775.28" font-family="Arial" font-size="8.00">L14_E1</text>
<text text-anchor="middle" x="545005" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="545005" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert2_route -->
<g id="node2054" class="node">
<title>layer14_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="544881,-1794.68 544681,-1794.68 544681,-1750.68 544881,-1750.68 544881,-1794.68"/>
<text text-anchor="middle" x="544781" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="544781" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="544781" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="544781" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert2_gate -->
<g id="node2055" class="node">
<title>layer14_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="544663.04,-1816.68 544348,-1816.68 544266.96,-1728.68 544582,-1728.68 544663.04,-1816.68"/>
<text text-anchor="middle" x="544465" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="544465" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="544465" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="544465" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer14_expert2_a2a -->
<g id="node2056" class="node">
<title>layer14_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="544108" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="544108" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="544108" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="544108" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="544108" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert2_attn_split -->
<g id="node2057" class="node">
<title>layer14_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="543948.48,-1816.68 543623.2,-1816.68 543539.52,-1728.68 543864.8,-1728.68 543948.48,-1816.68"/>
<text text-anchor="middle" x="543744" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="543744" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="543744" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="543744" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert2_q_proj -->
<g id="node2058" class="node">
<title>layer14_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="543521.5,-1794.68 543324.5,-1794.68 543324.5,-1750.68 543521.5,-1750.68 543521.5,-1794.68"/>
<text text-anchor="middle" x="543423" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="543423" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="543423" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="543423" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert2_k_proj -->
<g id="node2059" class="node">
<title>layer14_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="543306.5,-1794.68 543109.5,-1794.68 543109.5,-1750.68 543306.5,-1750.68 543306.5,-1794.68"/>
<text text-anchor="middle" x="543208" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="543208" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="543208" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="543208" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert2_v_proj -->
<g id="node2060" class="node">
<title>layer14_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="543091.5,-1794.68 542894.5,-1794.68 542894.5,-1750.68 543091.5,-1750.68 543091.5,-1794.68"/>
<text text-anchor="middle" x="542993" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="542993" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="542993" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="542993" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert2_attn -->
<g id="node2061" class="node">
<title>layer14_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="542876.5,-1794.68 542679.5,-1794.68 542679.5,-1750.68 542876.5,-1750.68 542876.5,-1794.68"/>
<text text-anchor="middle" x="542778" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="542778" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="542778" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="542778" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert2_attn_out -->
<g id="node2062" class="node">
<title>layer14_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="542661,-1794.68 542461,-1794.68 542461,-1750.68 542661,-1750.68 542661,-1794.68"/>
<text text-anchor="middle" x="542561" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="542561" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="542561" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="542561" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert2_attn_ar -->
<g id="node2063" class="node">
<title>layer14_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="542302" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="542302" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="542302" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="542302" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="542302" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert2_attn_res -->
<g id="node2064" class="node">
<title>layer14_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="542142.2,-1816.68 541812.59,-1816.68 541727.8,-1728.68 542057.41,-1728.68 542142.2,-1816.68"/>
<text text-anchor="middle" x="541935" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="541935" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="541935" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="541935" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert2_ln1 -->
<g id="node2065" class="node">
<title>layer14_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="541710,-1794.68 541510,-1794.68 541510,-1750.68 541710,-1750.68 541710,-1794.68"/>
<text text-anchor="middle" x="541610" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="541610" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="541610" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="541610" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert2_mlp1 -->
<g id="node2066" class="node">
<title>layer14_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="541492,-1794.68 541296,-1794.68 541296,-1750.68 541492,-1750.68 541492,-1794.68"/>
<text text-anchor="middle" x="541394" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="541394" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="541394" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="541394" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert2_gelu -->
<g id="node2067" class="node">
<title>layer14_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="541278,-1794.68 541082,-1794.68 541082,-1750.68 541278,-1750.68 541278,-1794.68"/>
<text text-anchor="middle" x="541180" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="541180" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="541180" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="541180" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert2_mlp2 -->
<g id="node2068" class="node">
<title>layer14_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="541064,-1794.68 540864,-1794.68 540864,-1750.68 541064,-1750.68 541064,-1794.68"/>
<text text-anchor="middle" x="540964" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="540964" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="540964" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="540964" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert2_mlp_ar -->
<g id="node2069" class="node">
<title>layer14_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="540705" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="540705" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="540705" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="540705" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="540705" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert2_mlp_res -->
<g id="node2070" class="node">
<title>layer14_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="540545.2,-1816.68 540215.59,-1816.68 540130.8,-1728.68 540460.41,-1728.68 540545.2,-1816.68"/>
<text text-anchor="middle" x="540338" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="540338" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="540338" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="540338" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert2_ln2 -->
<g id="node2071" class="node">
<title>layer14_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="540113,-1794.68 539913,-1794.68 539913,-1750.68 540113,-1750.68 540113,-1794.68"/>
<text text-anchor="middle" x="540013" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="540013" y="-1775.28" font-family="Arial" font-size="8.00">L14_E2</text>
<text text-anchor="middle" x="540013" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="540013" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert3_route -->
<g id="node2072" class="node">
<title>layer14_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="539889,-1794.68 539689,-1794.68 539689,-1750.68 539889,-1750.68 539889,-1794.68"/>
<text text-anchor="middle" x="539789" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="539789" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="539789" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="539789" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert3_gate -->
<g id="node2073" class="node">
<title>layer14_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="539671.04,-1816.68 539356,-1816.68 539274.96,-1728.68 539590,-1728.68 539671.04,-1816.68"/>
<text text-anchor="middle" x="539473" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="539473" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="539473" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="539473" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer14_expert3_a2a -->
<g id="node2074" class="node">
<title>layer14_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="539116" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="539116" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="539116" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="539116" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="539116" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert3_attn_split -->
<g id="node2075" class="node">
<title>layer14_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="538956.48,-1816.68 538631.2,-1816.68 538547.52,-1728.68 538872.8,-1728.68 538956.48,-1816.68"/>
<text text-anchor="middle" x="538752" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="538752" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="538752" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="538752" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert3_q_proj -->
<g id="node2076" class="node">
<title>layer14_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="538529.5,-1794.68 538332.5,-1794.68 538332.5,-1750.68 538529.5,-1750.68 538529.5,-1794.68"/>
<text text-anchor="middle" x="538431" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="538431" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="538431" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="538431" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert3_k_proj -->
<g id="node2077" class="node">
<title>layer14_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="538314.5,-1794.68 538117.5,-1794.68 538117.5,-1750.68 538314.5,-1750.68 538314.5,-1794.68"/>
<text text-anchor="middle" x="538216" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="538216" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="538216" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="538216" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert3_v_proj -->
<g id="node2078" class="node">
<title>layer14_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="538099.5,-1794.68 537902.5,-1794.68 537902.5,-1750.68 538099.5,-1750.68 538099.5,-1794.68"/>
<text text-anchor="middle" x="538001" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="538001" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="538001" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="538001" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert3_attn -->
<g id="node2079" class="node">
<title>layer14_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="537884.5,-1794.68 537687.5,-1794.68 537687.5,-1750.68 537884.5,-1750.68 537884.5,-1794.68"/>
<text text-anchor="middle" x="537786" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="537786" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="537786" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="537786" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert3_attn_out -->
<g id="node2080" class="node">
<title>layer14_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="537669,-1794.68 537469,-1794.68 537469,-1750.68 537669,-1750.68 537669,-1794.68"/>
<text text-anchor="middle" x="537569" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="537569" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="537569" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="537569" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert3_attn_ar -->
<g id="node2081" class="node">
<title>layer14_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="537310" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="537310" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="537310" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="537310" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="537310" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert3_attn_res -->
<g id="node2082" class="node">
<title>layer14_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="537150.2,-1816.68 536820.59,-1816.68 536735.8,-1728.68 537065.41,-1728.68 537150.2,-1816.68"/>
<text text-anchor="middle" x="536943" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="536943" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="536943" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="536943" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert3_ln1 -->
<g id="node2083" class="node">
<title>layer14_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="536718,-1794.68 536518,-1794.68 536518,-1750.68 536718,-1750.68 536718,-1794.68"/>
<text text-anchor="middle" x="536618" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="536618" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="536618" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="536618" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert3_mlp1 -->
<g id="node2084" class="node">
<title>layer14_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="536500,-1794.68 536304,-1794.68 536304,-1750.68 536500,-1750.68 536500,-1794.68"/>
<text text-anchor="middle" x="536402" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="536402" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="536402" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="536402" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert3_gelu -->
<g id="node2085" class="node">
<title>layer14_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="536286,-1794.68 536090,-1794.68 536090,-1750.68 536286,-1750.68 536286,-1794.68"/>
<text text-anchor="middle" x="536188" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="536188" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="536188" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="536188" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert3_mlp2 -->
<g id="node2086" class="node">
<title>layer14_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="536072,-1794.68 535872,-1794.68 535872,-1750.68 536072,-1750.68 536072,-1794.68"/>
<text text-anchor="middle" x="535972" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="535972" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="535972" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="535972" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert3_mlp_ar -->
<g id="node2087" class="node">
<title>layer14_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="535713" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="535713" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="535713" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="535713" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="535713" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert3_mlp_res -->
<g id="node2088" class="node">
<title>layer14_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="535553.2,-1816.68 535223.59,-1816.68 535138.8,-1728.68 535468.41,-1728.68 535553.2,-1816.68"/>
<text text-anchor="middle" x="535346" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="535346" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="535346" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="535346" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert3_ln2 -->
<g id="node2089" class="node">
<title>layer14_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="535121,-1794.68 534921,-1794.68 534921,-1750.68 535121,-1750.68 535121,-1794.68"/>
<text text-anchor="middle" x="535021" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="535021" y="-1775.28" font-family="Arial" font-size="8.00">L14_E3</text>
<text text-anchor="middle" x="535021" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="535021" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert4_route -->
<g id="node2090" class="node">
<title>layer14_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="534897,-1794.68 534697,-1794.68 534697,-1750.68 534897,-1750.68 534897,-1794.68"/>
<text text-anchor="middle" x="534797" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="534797" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="534797" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="534797" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert4_gate -->
<g id="node2091" class="node">
<title>layer14_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="534679.04,-1816.68 534364,-1816.68 534282.96,-1728.68 534598,-1728.68 534679.04,-1816.68"/>
<text text-anchor="middle" x="534481" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="534481" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="534481" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="534481" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer14_expert4_a2a -->
<g id="node2092" class="node">
<title>layer14_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="534124" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="534124" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="534124" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="534124" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="534124" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert4_attn_split -->
<g id="node2093" class="node">
<title>layer14_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="533964.48,-1816.68 533639.2,-1816.68 533555.52,-1728.68 533880.8,-1728.68 533964.48,-1816.68"/>
<text text-anchor="middle" x="533760" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="533760" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="533760" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="533760" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert4_q_proj -->
<g id="node2094" class="node">
<title>layer14_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="533537.5,-1794.68 533340.5,-1794.68 533340.5,-1750.68 533537.5,-1750.68 533537.5,-1794.68"/>
<text text-anchor="middle" x="533439" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="533439" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="533439" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="533439" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert4_k_proj -->
<g id="node2095" class="node">
<title>layer14_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="533322.5,-1794.68 533125.5,-1794.68 533125.5,-1750.68 533322.5,-1750.68 533322.5,-1794.68"/>
<text text-anchor="middle" x="533224" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="533224" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="533224" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="533224" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert4_v_proj -->
<g id="node2096" class="node">
<title>layer14_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="533107.5,-1794.68 532910.5,-1794.68 532910.5,-1750.68 533107.5,-1750.68 533107.5,-1794.68"/>
<text text-anchor="middle" x="533009" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="533009" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="533009" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="533009" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert4_attn -->
<g id="node2097" class="node">
<title>layer14_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="532892.5,-1794.68 532695.5,-1794.68 532695.5,-1750.68 532892.5,-1750.68 532892.5,-1794.68"/>
<text text-anchor="middle" x="532794" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="532794" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="532794" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="532794" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert4_attn_out -->
<g id="node2098" class="node">
<title>layer14_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="532677,-1794.68 532477,-1794.68 532477,-1750.68 532677,-1750.68 532677,-1794.68"/>
<text text-anchor="middle" x="532577" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="532577" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="532577" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="532577" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert4_attn_ar -->
<g id="node2099" class="node">
<title>layer14_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="532318" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="532318" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="532318" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="532318" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="532318" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert4_attn_res -->
<g id="node2100" class="node">
<title>layer14_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="532158.2,-1816.68 531828.59,-1816.68 531743.8,-1728.68 532073.41,-1728.68 532158.2,-1816.68"/>
<text text-anchor="middle" x="531951" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="531951" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="531951" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="531951" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert4_ln1 -->
<g id="node2101" class="node">
<title>layer14_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="531726,-1794.68 531526,-1794.68 531526,-1750.68 531726,-1750.68 531726,-1794.68"/>
<text text-anchor="middle" x="531626" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="531626" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="531626" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="531626" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert4_mlp1 -->
<g id="node2102" class="node">
<title>layer14_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="531508,-1794.68 531312,-1794.68 531312,-1750.68 531508,-1750.68 531508,-1794.68"/>
<text text-anchor="middle" x="531410" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="531410" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="531410" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="531410" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert4_gelu -->
<g id="node2103" class="node">
<title>layer14_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="531294,-1794.68 531098,-1794.68 531098,-1750.68 531294,-1750.68 531294,-1794.68"/>
<text text-anchor="middle" x="531196" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="531196" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="531196" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="531196" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert4_mlp2 -->
<g id="node2104" class="node">
<title>layer14_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="531080,-1794.68 530880,-1794.68 530880,-1750.68 531080,-1750.68 531080,-1794.68"/>
<text text-anchor="middle" x="530980" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="530980" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="530980" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="530980" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert4_mlp_ar -->
<g id="node2105" class="node">
<title>layer14_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="530721" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="530721" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="530721" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="530721" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="530721" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert4_mlp_res -->
<g id="node2106" class="node">
<title>layer14_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="530561.2,-1816.68 530231.59,-1816.68 530146.8,-1728.68 530476.41,-1728.68 530561.2,-1816.68"/>
<text text-anchor="middle" x="530354" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="530354" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="530354" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="530354" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert4_ln2 -->
<g id="node2107" class="node">
<title>layer14_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="530129,-1794.68 529929,-1794.68 529929,-1750.68 530129,-1750.68 530129,-1794.68"/>
<text text-anchor="middle" x="530029" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="530029" y="-1775.28" font-family="Arial" font-size="8.00">L14_E4</text>
<text text-anchor="middle" x="530029" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="530029" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert5_route -->
<g id="node2108" class="node">
<title>layer14_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="529905,-1794.68 529705,-1794.68 529705,-1750.68 529905,-1750.68 529905,-1794.68"/>
<text text-anchor="middle" x="529805" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="529805" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="529805" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="529805" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert5_gate -->
<g id="node2109" class="node">
<title>layer14_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="529687.04,-1816.68 529372,-1816.68 529290.96,-1728.68 529606,-1728.68 529687.04,-1816.68"/>
<text text-anchor="middle" x="529489" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="529489" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="529489" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="529489" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer14_expert5_a2a -->
<g id="node2110" class="node">
<title>layer14_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="529132" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="529132" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="529132" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="529132" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="529132" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert5_attn_split -->
<g id="node2111" class="node">
<title>layer14_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="528972.48,-1816.68 528647.2,-1816.68 528563.52,-1728.68 528888.8,-1728.68 528972.48,-1816.68"/>
<text text-anchor="middle" x="528768" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="528768" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="528768" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="528768" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert5_q_proj -->
<g id="node2112" class="node">
<title>layer14_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="528545.5,-1794.68 528348.5,-1794.68 528348.5,-1750.68 528545.5,-1750.68 528545.5,-1794.68"/>
<text text-anchor="middle" x="528447" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="528447" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="528447" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="528447" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert5_k_proj -->
<g id="node2113" class="node">
<title>layer14_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="528330.5,-1794.68 528133.5,-1794.68 528133.5,-1750.68 528330.5,-1750.68 528330.5,-1794.68"/>
<text text-anchor="middle" x="528232" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="528232" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="528232" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="528232" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert5_v_proj -->
<g id="node2114" class="node">
<title>layer14_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="528115.5,-1794.68 527918.5,-1794.68 527918.5,-1750.68 528115.5,-1750.68 528115.5,-1794.68"/>
<text text-anchor="middle" x="528017" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="528017" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="528017" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="528017" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert5_attn -->
<g id="node2115" class="node">
<title>layer14_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="527900.5,-1794.68 527703.5,-1794.68 527703.5,-1750.68 527900.5,-1750.68 527900.5,-1794.68"/>
<text text-anchor="middle" x="527802" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="527802" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="527802" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="527802" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert5_attn_out -->
<g id="node2116" class="node">
<title>layer14_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="527685,-1794.68 527485,-1794.68 527485,-1750.68 527685,-1750.68 527685,-1794.68"/>
<text text-anchor="middle" x="527585" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="527585" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="527585" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="527585" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert5_attn_ar -->
<g id="node2117" class="node">
<title>layer14_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="527326" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="527326" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="527326" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="527326" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="527326" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert5_attn_res -->
<g id="node2118" class="node">
<title>layer14_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="527166.2,-1816.68 526836.59,-1816.68 526751.8,-1728.68 527081.41,-1728.68 527166.2,-1816.68"/>
<text text-anchor="middle" x="526959" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="526959" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="526959" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="526959" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert5_ln1 -->
<g id="node2119" class="node">
<title>layer14_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="526734,-1794.68 526534,-1794.68 526534,-1750.68 526734,-1750.68 526734,-1794.68"/>
<text text-anchor="middle" x="526634" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="526634" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="526634" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="526634" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert5_mlp1 -->
<g id="node2120" class="node">
<title>layer14_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="526516,-1794.68 526320,-1794.68 526320,-1750.68 526516,-1750.68 526516,-1794.68"/>
<text text-anchor="middle" x="526418" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="526418" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="526418" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="526418" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert5_gelu -->
<g id="node2121" class="node">
<title>layer14_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="526302,-1794.68 526106,-1794.68 526106,-1750.68 526302,-1750.68 526302,-1794.68"/>
<text text-anchor="middle" x="526204" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="526204" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="526204" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="526204" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert5_mlp2 -->
<g id="node2122" class="node">
<title>layer14_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="526088,-1794.68 525888,-1794.68 525888,-1750.68 526088,-1750.68 526088,-1794.68"/>
<text text-anchor="middle" x="525988" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="525988" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="525988" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="525988" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert5_mlp_ar -->
<g id="node2123" class="node">
<title>layer14_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="525729" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="525729" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="525729" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="525729" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="525729" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert5_mlp_res -->
<g id="node2124" class="node">
<title>layer14_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="525569.2,-1816.68 525239.59,-1816.68 525154.8,-1728.68 525484.41,-1728.68 525569.2,-1816.68"/>
<text text-anchor="middle" x="525362" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="525362" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="525362" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="525362" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert5_ln2 -->
<g id="node2125" class="node">
<title>layer14_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="525137,-1794.68 524937,-1794.68 524937,-1750.68 525137,-1750.68 525137,-1794.68"/>
<text text-anchor="middle" x="525037" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="525037" y="-1775.28" font-family="Arial" font-size="8.00">L14_E5</text>
<text text-anchor="middle" x="525037" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="525037" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert6_route -->
<g id="node2126" class="node">
<title>layer14_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="524913,-1794.68 524713,-1794.68 524713,-1750.68 524913,-1750.68 524913,-1794.68"/>
<text text-anchor="middle" x="524813" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="524813" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="524813" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="524813" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert6_gate -->
<g id="node2127" class="node">
<title>layer14_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="524695.04,-1816.68 524380,-1816.68 524298.96,-1728.68 524614,-1728.68 524695.04,-1816.68"/>
<text text-anchor="middle" x="524497" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="524497" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="524497" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="524497" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer14_expert6_a2a -->
<g id="node2128" class="node">
<title>layer14_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="524140" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="524140" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="524140" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="524140" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="524140" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert6_attn_split -->
<g id="node2129" class="node">
<title>layer14_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="523980.48,-1816.68 523655.2,-1816.68 523571.52,-1728.68 523896.8,-1728.68 523980.48,-1816.68"/>
<text text-anchor="middle" x="523776" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="523776" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="523776" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="523776" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert6_q_proj -->
<g id="node2130" class="node">
<title>layer14_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="523553.5,-1794.68 523356.5,-1794.68 523356.5,-1750.68 523553.5,-1750.68 523553.5,-1794.68"/>
<text text-anchor="middle" x="523455" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="523455" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="523455" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="523455" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert6_k_proj -->
<g id="node2131" class="node">
<title>layer14_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="523338.5,-1794.68 523141.5,-1794.68 523141.5,-1750.68 523338.5,-1750.68 523338.5,-1794.68"/>
<text text-anchor="middle" x="523240" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="523240" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="523240" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="523240" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert6_v_proj -->
<g id="node2132" class="node">
<title>layer14_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="523123.5,-1794.68 522926.5,-1794.68 522926.5,-1750.68 523123.5,-1750.68 523123.5,-1794.68"/>
<text text-anchor="middle" x="523025" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="523025" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="523025" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="523025" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert6_attn -->
<g id="node2133" class="node">
<title>layer14_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="522908.5,-1794.68 522711.5,-1794.68 522711.5,-1750.68 522908.5,-1750.68 522908.5,-1794.68"/>
<text text-anchor="middle" x="522810" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="522810" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="522810" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="522810" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert6_attn_out -->
<g id="node2134" class="node">
<title>layer14_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="522693,-1794.68 522493,-1794.68 522493,-1750.68 522693,-1750.68 522693,-1794.68"/>
<text text-anchor="middle" x="522593" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="522593" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="522593" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="522593" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert6_attn_ar -->
<g id="node2135" class="node">
<title>layer14_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="522334" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="522334" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="522334" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="522334" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="522334" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert6_attn_res -->
<g id="node2136" class="node">
<title>layer14_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="522174.2,-1816.68 521844.59,-1816.68 521759.8,-1728.68 522089.41,-1728.68 522174.2,-1816.68"/>
<text text-anchor="middle" x="521967" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="521967" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="521967" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="521967" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert6_ln1 -->
<g id="node2137" class="node">
<title>layer14_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="521742,-1794.68 521542,-1794.68 521542,-1750.68 521742,-1750.68 521742,-1794.68"/>
<text text-anchor="middle" x="521642" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="521642" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="521642" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="521642" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert6_mlp1 -->
<g id="node2138" class="node">
<title>layer14_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="521524,-1794.68 521328,-1794.68 521328,-1750.68 521524,-1750.68 521524,-1794.68"/>
<text text-anchor="middle" x="521426" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="521426" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="521426" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="521426" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert6_gelu -->
<g id="node2139" class="node">
<title>layer14_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="521310,-1794.68 521114,-1794.68 521114,-1750.68 521310,-1750.68 521310,-1794.68"/>
<text text-anchor="middle" x="521212" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="521212" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="521212" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="521212" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert6_mlp2 -->
<g id="node2140" class="node">
<title>layer14_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="521096,-1794.68 520896,-1794.68 520896,-1750.68 521096,-1750.68 521096,-1794.68"/>
<text text-anchor="middle" x="520996" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="520996" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="520996" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="520996" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert6_mlp_ar -->
<g id="node2141" class="node">
<title>layer14_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="520737" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="520737" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="520737" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="520737" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="520737" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert6_mlp_res -->
<g id="node2142" class="node">
<title>layer14_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="520577.2,-1816.68 520247.59,-1816.68 520162.8,-1728.68 520492.41,-1728.68 520577.2,-1816.68"/>
<text text-anchor="middle" x="520370" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="520370" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="520370" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="520370" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert6_ln2 -->
<g id="node2143" class="node">
<title>layer14_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="520145,-1794.68 519945,-1794.68 519945,-1750.68 520145,-1750.68 520145,-1794.68"/>
<text text-anchor="middle" x="520045" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="520045" y="-1775.28" font-family="Arial" font-size="8.00">L14_E6</text>
<text text-anchor="middle" x="520045" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="520045" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert7_route -->
<g id="node2144" class="node">
<title>layer14_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="519921,-1794.68 519721,-1794.68 519721,-1750.68 519921,-1750.68 519921,-1794.68"/>
<text text-anchor="middle" x="519821" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="519821" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="519821" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="519821" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert7_gate -->
<g id="node2145" class="node">
<title>layer14_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="519703.04,-1816.68 519388,-1816.68 519306.96,-1728.68 519622,-1728.68 519703.04,-1816.68"/>
<text text-anchor="middle" x="519505" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="519505" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="519505" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="519505" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer14_expert7_a2a -->
<g id="node2146" class="node">
<title>layer14_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="519148" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="519148" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="519148" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="519148" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="519148" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert7_attn_split -->
<g id="node2147" class="node">
<title>layer14_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="518988.48,-1816.68 518663.2,-1816.68 518579.52,-1728.68 518904.8,-1728.68 518988.48,-1816.68"/>
<text text-anchor="middle" x="518784" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="518784" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="518784" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="518784" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert7_q_proj -->
<g id="node2148" class="node">
<title>layer14_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="518561.5,-1794.68 518364.5,-1794.68 518364.5,-1750.68 518561.5,-1750.68 518561.5,-1794.68"/>
<text text-anchor="middle" x="518463" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="518463" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="518463" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="518463" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert7_k_proj -->
<g id="node2149" class="node">
<title>layer14_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="518346.5,-1794.68 518149.5,-1794.68 518149.5,-1750.68 518346.5,-1750.68 518346.5,-1794.68"/>
<text text-anchor="middle" x="518248" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="518248" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="518248" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="518248" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert7_v_proj -->
<g id="node2150" class="node">
<title>layer14_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="518131.5,-1794.68 517934.5,-1794.68 517934.5,-1750.68 518131.5,-1750.68 518131.5,-1794.68"/>
<text text-anchor="middle" x="518033" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="518033" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="518033" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="518033" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert7_attn -->
<g id="node2151" class="node">
<title>layer14_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="517916.5,-1794.68 517719.5,-1794.68 517719.5,-1750.68 517916.5,-1750.68 517916.5,-1794.68"/>
<text text-anchor="middle" x="517818" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="517818" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="517818" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="517818" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer14_expert7_attn_out -->
<g id="node2152" class="node">
<title>layer14_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="517701,-1794.68 517501,-1794.68 517501,-1750.68 517701,-1750.68 517701,-1794.68"/>
<text text-anchor="middle" x="517601" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="517601" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="517601" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="517601" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert7_attn_ar -->
<g id="node2153" class="node">
<title>layer14_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="517342" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="517342" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="517342" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="517342" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="517342" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert7_attn_res -->
<g id="node2154" class="node">
<title>layer14_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="517182.2,-1816.68 516852.59,-1816.68 516767.8,-1728.68 517097.41,-1728.68 517182.2,-1816.68"/>
<text text-anchor="middle" x="516975" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="516975" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="516975" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="516975" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert7_ln1 -->
<g id="node2155" class="node">
<title>layer14_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="516750,-1794.68 516550,-1794.68 516550,-1750.68 516750,-1750.68 516750,-1794.68"/>
<text text-anchor="middle" x="516650" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="516650" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="516650" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="516650" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert7_mlp1 -->
<g id="node2156" class="node">
<title>layer14_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="516532,-1794.68 516336,-1794.68 516336,-1750.68 516532,-1750.68 516532,-1794.68"/>
<text text-anchor="middle" x="516434" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="516434" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="516434" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="516434" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert7_gelu -->
<g id="node2157" class="node">
<title>layer14_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="516318,-1794.68 516122,-1794.68 516122,-1750.68 516318,-1750.68 516318,-1794.68"/>
<text text-anchor="middle" x="516220" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="516220" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="516220" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="516220" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer14_expert7_mlp2 -->
<g id="node2158" class="node">
<title>layer14_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="516104,-1794.68 515904,-1794.68 515904,-1750.68 516104,-1750.68 516104,-1794.68"/>
<text text-anchor="middle" x="516004" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="516004" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="516004" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="516004" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert7_mlp_ar -->
<g id="node2159" class="node">
<title>layer14_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="515745" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="515745" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="515745" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="515745" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="515745" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert7_mlp_res -->
<g id="node2160" class="node">
<title>layer14_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="515585.2,-1816.68 515255.59,-1816.68 515170.8,-1728.68 515500.41,-1728.68 515585.2,-1816.68"/>
<text text-anchor="middle" x="515378" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="515378" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="515378" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="515378" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer14_expert7_ln2 -->
<g id="node2161" class="node">
<title>layer14_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="515153,-1794.68 514953,-1794.68 514953,-1750.68 515153,-1750.68 515153,-1794.68"/>
<text text-anchor="middle" x="515053" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="515053" y="-1775.28" font-family="Arial" font-size="8.00">L14_E7</text>
<text text-anchor="middle" x="515053" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="515053" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert0_route -->
<g id="node2162" class="node">
<title>layer15_expert0_route</title>
<polygon fill="lightyellow" stroke="black" points="514913,-1794.68 514713,-1794.68 514713,-1750.68 514913,-1750.68 514913,-1794.68"/>
<text text-anchor="middle" x="514813" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="514813" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="514813" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="514813" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert0_gate -->
<g id="node2163" class="node">
<title>layer15_expert0_gate</title>
<polygon fill="lightyellow" stroke="black" points="514695.04,-1816.68 514380,-1816.68 514298.96,-1728.68 514614,-1728.68 514695.04,-1816.68"/>
<text text-anchor="middle" x="514497" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="514497" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="514497" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="514497" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer15_expert0_a2a -->
<g id="node2164" class="node">
<title>layer15_expert0_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="514140" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="514140" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="514140" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="514140" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="514140" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert0_attn_split -->
<g id="node2165" class="node">
<title>layer15_expert0_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="513980.48,-1816.68 513655.2,-1816.68 513571.52,-1728.68 513896.8,-1728.68 513980.48,-1816.68"/>
<text text-anchor="middle" x="513776" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="513776" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="513776" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="513776" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert0_q_proj -->
<g id="node2166" class="node">
<title>layer15_expert0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="513553.5,-1794.68 513356.5,-1794.68 513356.5,-1750.68 513553.5,-1750.68 513553.5,-1794.68"/>
<text text-anchor="middle" x="513455" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="513455" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="513455" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="513455" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert0_k_proj -->
<g id="node2167" class="node">
<title>layer15_expert0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="513338.5,-1794.68 513141.5,-1794.68 513141.5,-1750.68 513338.5,-1750.68 513338.5,-1794.68"/>
<text text-anchor="middle" x="513240" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="513240" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="513240" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="513240" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert0_v_proj -->
<g id="node2168" class="node">
<title>layer15_expert0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="513123.5,-1794.68 512926.5,-1794.68 512926.5,-1750.68 513123.5,-1750.68 513123.5,-1794.68"/>
<text text-anchor="middle" x="513025" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="513025" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="513025" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="513025" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert0_attn -->
<g id="node2169" class="node">
<title>layer15_expert0_attn</title>
<polygon fill="lightgreen" stroke="black" points="512908.5,-1794.68 512711.5,-1794.68 512711.5,-1750.68 512908.5,-1750.68 512908.5,-1794.68"/>
<text text-anchor="middle" x="512810" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="512810" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="512810" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="512810" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert0_attn_out -->
<g id="node2170" class="node">
<title>layer15_expert0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="512693,-1794.68 512493,-1794.68 512493,-1750.68 512693,-1750.68 512693,-1794.68"/>
<text text-anchor="middle" x="512593" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="512593" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="512593" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="512593" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert0_attn_ar -->
<g id="node2171" class="node">
<title>layer15_expert0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="512334" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="512334" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="512334" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="512334" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="512334" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert0_attn_res -->
<g id="node2172" class="node">
<title>layer15_expert0_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="512174.2,-1816.68 511844.59,-1816.68 511759.8,-1728.68 512089.41,-1728.68 512174.2,-1816.68"/>
<text text-anchor="middle" x="511967" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="511967" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="511967" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="511967" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert0_ln1 -->
<g id="node2173" class="node">
<title>layer15_expert0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="511742,-1794.68 511542,-1794.68 511542,-1750.68 511742,-1750.68 511742,-1794.68"/>
<text text-anchor="middle" x="511642" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="511642" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="511642" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="511642" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert0_mlp1 -->
<g id="node2174" class="node">
<title>layer15_expert0_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="511524,-1794.68 511328,-1794.68 511328,-1750.68 511524,-1750.68 511524,-1794.68"/>
<text text-anchor="middle" x="511426" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="511426" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="511426" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="511426" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert0_gelu -->
<g id="node2175" class="node">
<title>layer15_expert0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="511310,-1794.68 511114,-1794.68 511114,-1750.68 511310,-1750.68 511310,-1794.68"/>
<text text-anchor="middle" x="511212" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="511212" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="511212" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="511212" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert0_mlp2 -->
<g id="node2176" class="node">
<title>layer15_expert0_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="511096,-1794.68 510896,-1794.68 510896,-1750.68 511096,-1750.68 511096,-1794.68"/>
<text text-anchor="middle" x="510996" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="510996" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="510996" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="510996" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert0_mlp_ar -->
<g id="node2177" class="node">
<title>layer15_expert0_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="510737" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="510737" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="510737" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="510737" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="510737" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert0_mlp_res -->
<g id="node2178" class="node">
<title>layer15_expert0_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="510577.2,-1816.68 510247.59,-1816.68 510162.8,-1728.68 510492.41,-1728.68 510577.2,-1816.68"/>
<text text-anchor="middle" x="510370" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="510370" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="510370" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="510370" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert0_ln2 -->
<g id="node2179" class="node">
<title>layer15_expert0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="510145,-1794.68 509945,-1794.68 509945,-1750.68 510145,-1750.68 510145,-1794.68"/>
<text text-anchor="middle" x="510045" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="510045" y="-1775.28" font-family="Arial" font-size="8.00">L15_E0</text>
<text text-anchor="middle" x="510045" y="-1766.28" font-family="Arial" font-size="8.00">GPU:48</text>
<text text-anchor="middle" x="510045" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert1_route -->
<g id="node2180" class="node">
<title>layer15_expert1_route</title>
<polygon fill="lightyellow" stroke="black" points="509921,-1794.68 509721,-1794.68 509721,-1750.68 509921,-1750.68 509921,-1794.68"/>
<text text-anchor="middle" x="509821" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="509821" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="509821" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="509821" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert1_gate -->
<g id="node2181" class="node">
<title>layer15_expert1_gate</title>
<polygon fill="lightyellow" stroke="black" points="509703.04,-1816.68 509388,-1816.68 509306.96,-1728.68 509622,-1728.68 509703.04,-1816.68"/>
<text text-anchor="middle" x="509505" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="509505" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="509505" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="509505" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer15_expert1_a2a -->
<g id="node2182" class="node">
<title>layer15_expert1_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="509148" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="509148" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="509148" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="509148" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="509148" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert1_attn_split -->
<g id="node2183" class="node">
<title>layer15_expert1_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="508988.48,-1816.68 508663.2,-1816.68 508579.52,-1728.68 508904.8,-1728.68 508988.48,-1816.68"/>
<text text-anchor="middle" x="508784" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="508784" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="508784" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="508784" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert1_q_proj -->
<g id="node2184" class="node">
<title>layer15_expert1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="508561.5,-1794.68 508364.5,-1794.68 508364.5,-1750.68 508561.5,-1750.68 508561.5,-1794.68"/>
<text text-anchor="middle" x="508463" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="508463" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="508463" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="508463" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert1_k_proj -->
<g id="node2185" class="node">
<title>layer15_expert1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="508346.5,-1794.68 508149.5,-1794.68 508149.5,-1750.68 508346.5,-1750.68 508346.5,-1794.68"/>
<text text-anchor="middle" x="508248" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="508248" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="508248" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="508248" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert1_v_proj -->
<g id="node2186" class="node">
<title>layer15_expert1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="508131.5,-1794.68 507934.5,-1794.68 507934.5,-1750.68 508131.5,-1750.68 508131.5,-1794.68"/>
<text text-anchor="middle" x="508033" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="508033" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="508033" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="508033" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert1_attn -->
<g id="node2187" class="node">
<title>layer15_expert1_attn</title>
<polygon fill="lightgreen" stroke="black" points="507916.5,-1794.68 507719.5,-1794.68 507719.5,-1750.68 507916.5,-1750.68 507916.5,-1794.68"/>
<text text-anchor="middle" x="507818" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="507818" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="507818" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="507818" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert1_attn_out -->
<g id="node2188" class="node">
<title>layer15_expert1_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="507701,-1794.68 507501,-1794.68 507501,-1750.68 507701,-1750.68 507701,-1794.68"/>
<text text-anchor="middle" x="507601" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="507601" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="507601" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="507601" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert1_attn_ar -->
<g id="node2189" class="node">
<title>layer15_expert1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="507342" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="507342" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="507342" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="507342" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="507342" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert1_attn_res -->
<g id="node2190" class="node">
<title>layer15_expert1_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="507182.2,-1816.68 506852.59,-1816.68 506767.8,-1728.68 507097.41,-1728.68 507182.2,-1816.68"/>
<text text-anchor="middle" x="506975" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="506975" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="506975" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="506975" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert1_ln1 -->
<g id="node2191" class="node">
<title>layer15_expert1_ln1</title>
<polygon fill="lightgreen" stroke="black" points="506750,-1794.68 506550,-1794.68 506550,-1750.68 506750,-1750.68 506750,-1794.68"/>
<text text-anchor="middle" x="506650" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="506650" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="506650" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="506650" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert1_mlp1 -->
<g id="node2192" class="node">
<title>layer15_expert1_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="506532,-1794.68 506336,-1794.68 506336,-1750.68 506532,-1750.68 506532,-1794.68"/>
<text text-anchor="middle" x="506434" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="506434" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="506434" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="506434" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert1_gelu -->
<g id="node2193" class="node">
<title>layer15_expert1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="506318,-1794.68 506122,-1794.68 506122,-1750.68 506318,-1750.68 506318,-1794.68"/>
<text text-anchor="middle" x="506220" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="506220" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="506220" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="506220" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert1_mlp2 -->
<g id="node2194" class="node">
<title>layer15_expert1_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="506104,-1794.68 505904,-1794.68 505904,-1750.68 506104,-1750.68 506104,-1794.68"/>
<text text-anchor="middle" x="506004" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="506004" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="506004" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="506004" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert1_mlp_ar -->
<g id="node2195" class="node">
<title>layer15_expert1_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="505745" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="505745" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="505745" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="505745" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="505745" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert1_mlp_res -->
<g id="node2196" class="node">
<title>layer15_expert1_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="505585.2,-1816.68 505255.59,-1816.68 505170.8,-1728.68 505500.41,-1728.68 505585.2,-1816.68"/>
<text text-anchor="middle" x="505378" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="505378" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="505378" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="505378" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert1_ln2 -->
<g id="node2197" class="node">
<title>layer15_expert1_ln2</title>
<polygon fill="lightgreen" stroke="black" points="505153,-1794.68 504953,-1794.68 504953,-1750.68 505153,-1750.68 505153,-1794.68"/>
<text text-anchor="middle" x="505053" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="505053" y="-1775.28" font-family="Arial" font-size="8.00">L15_E1</text>
<text text-anchor="middle" x="505053" y="-1766.28" font-family="Arial" font-size="8.00">GPU:50</text>
<text text-anchor="middle" x="505053" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert2_route -->
<g id="node2198" class="node">
<title>layer15_expert2_route</title>
<polygon fill="lightyellow" stroke="black" points="504929,-1794.68 504729,-1794.68 504729,-1750.68 504929,-1750.68 504929,-1794.68"/>
<text text-anchor="middle" x="504829" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="504829" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="504829" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="504829" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert2_gate -->
<g id="node2199" class="node">
<title>layer15_expert2_gate</title>
<polygon fill="lightyellow" stroke="black" points="504711.04,-1816.68 504396,-1816.68 504314.96,-1728.68 504630,-1728.68 504711.04,-1816.68"/>
<text text-anchor="middle" x="504513" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="504513" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="504513" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="504513" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer15_expert2_a2a -->
<g id="node2200" class="node">
<title>layer15_expert2_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="504156" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="504156" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="504156" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="504156" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="504156" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert2_attn_split -->
<g id="node2201" class="node">
<title>layer15_expert2_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="503996.48,-1816.68 503671.2,-1816.68 503587.52,-1728.68 503912.8,-1728.68 503996.48,-1816.68"/>
<text text-anchor="middle" x="503792" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="503792" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="503792" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="503792" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert2_q_proj -->
<g id="node2202" class="node">
<title>layer15_expert2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="503569.5,-1794.68 503372.5,-1794.68 503372.5,-1750.68 503569.5,-1750.68 503569.5,-1794.68"/>
<text text-anchor="middle" x="503471" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="503471" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="503471" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="503471" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert2_k_proj -->
<g id="node2203" class="node">
<title>layer15_expert2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="503354.5,-1794.68 503157.5,-1794.68 503157.5,-1750.68 503354.5,-1750.68 503354.5,-1794.68"/>
<text text-anchor="middle" x="503256" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="503256" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="503256" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="503256" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert2_v_proj -->
<g id="node2204" class="node">
<title>layer15_expert2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="503139.5,-1794.68 502942.5,-1794.68 502942.5,-1750.68 503139.5,-1750.68 503139.5,-1794.68"/>
<text text-anchor="middle" x="503041" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="503041" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="503041" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="503041" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert2_attn -->
<g id="node2205" class="node">
<title>layer15_expert2_attn</title>
<polygon fill="lightgreen" stroke="black" points="502924.5,-1794.68 502727.5,-1794.68 502727.5,-1750.68 502924.5,-1750.68 502924.5,-1794.68"/>
<text text-anchor="middle" x="502826" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="502826" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="502826" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="502826" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert2_attn_out -->
<g id="node2206" class="node">
<title>layer15_expert2_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="502709,-1794.68 502509,-1794.68 502509,-1750.68 502709,-1750.68 502709,-1794.68"/>
<text text-anchor="middle" x="502609" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="502609" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="502609" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="502609" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert2_attn_ar -->
<g id="node2207" class="node">
<title>layer15_expert2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="502350" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="502350" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="502350" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="502350" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="502350" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert2_attn_res -->
<g id="node2208" class="node">
<title>layer15_expert2_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="502190.2,-1816.68 501860.59,-1816.68 501775.8,-1728.68 502105.41,-1728.68 502190.2,-1816.68"/>
<text text-anchor="middle" x="501983" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="501983" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="501983" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="501983" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert2_ln1 -->
<g id="node2209" class="node">
<title>layer15_expert2_ln1</title>
<polygon fill="lightgreen" stroke="black" points="501758,-1794.68 501558,-1794.68 501558,-1750.68 501758,-1750.68 501758,-1794.68"/>
<text text-anchor="middle" x="501658" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="501658" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="501658" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="501658" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert2_mlp1 -->
<g id="node2210" class="node">
<title>layer15_expert2_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="501540,-1794.68 501344,-1794.68 501344,-1750.68 501540,-1750.68 501540,-1794.68"/>
<text text-anchor="middle" x="501442" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="501442" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="501442" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="501442" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert2_gelu -->
<g id="node2211" class="node">
<title>layer15_expert2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="501326,-1794.68 501130,-1794.68 501130,-1750.68 501326,-1750.68 501326,-1794.68"/>
<text text-anchor="middle" x="501228" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="501228" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="501228" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="501228" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert2_mlp2 -->
<g id="node2212" class="node">
<title>layer15_expert2_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="501112,-1794.68 500912,-1794.68 500912,-1750.68 501112,-1750.68 501112,-1794.68"/>
<text text-anchor="middle" x="501012" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="501012" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="501012" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="501012" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert2_mlp_ar -->
<g id="node2213" class="node">
<title>layer15_expert2_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="500753" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="500753" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="500753" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="500753" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="500753" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert2_mlp_res -->
<g id="node2214" class="node">
<title>layer15_expert2_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="500593.2,-1816.68 500263.59,-1816.68 500178.8,-1728.68 500508.41,-1728.68 500593.2,-1816.68"/>
<text text-anchor="middle" x="500386" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="500386" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="500386" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="500386" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert2_ln2 -->
<g id="node2215" class="node">
<title>layer15_expert2_ln2</title>
<polygon fill="lightgreen" stroke="black" points="500161,-1794.68 499961,-1794.68 499961,-1750.68 500161,-1750.68 500161,-1794.68"/>
<text text-anchor="middle" x="500061" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="500061" y="-1775.28" font-family="Arial" font-size="8.00">L15_E2</text>
<text text-anchor="middle" x="500061" y="-1766.28" font-family="Arial" font-size="8.00">GPU:52</text>
<text text-anchor="middle" x="500061" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert3_route -->
<g id="node2216" class="node">
<title>layer15_expert3_route</title>
<polygon fill="lightyellow" stroke="black" points="499937,-1794.68 499737,-1794.68 499737,-1750.68 499937,-1750.68 499937,-1794.68"/>
<text text-anchor="middle" x="499837" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="499837" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="499837" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="499837" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert3_gate -->
<g id="node2217" class="node">
<title>layer15_expert3_gate</title>
<polygon fill="lightyellow" stroke="black" points="499719.04,-1816.68 499404,-1816.68 499322.96,-1728.68 499638,-1728.68 499719.04,-1816.68"/>
<text text-anchor="middle" x="499521" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="499521" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="499521" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="499521" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer15_expert3_a2a -->
<g id="node2218" class="node">
<title>layer15_expert3_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="499164" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="499164" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="499164" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="499164" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="499164" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert3_attn_split -->
<g id="node2219" class="node">
<title>layer15_expert3_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="499004.48,-1816.68 498679.2,-1816.68 498595.52,-1728.68 498920.8,-1728.68 499004.48,-1816.68"/>
<text text-anchor="middle" x="498800" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="498800" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="498800" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="498800" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert3_q_proj -->
<g id="node2220" class="node">
<title>layer15_expert3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="498577.5,-1794.68 498380.5,-1794.68 498380.5,-1750.68 498577.5,-1750.68 498577.5,-1794.68"/>
<text text-anchor="middle" x="498479" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="498479" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="498479" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="498479" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert3_k_proj -->
<g id="node2221" class="node">
<title>layer15_expert3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="498362.5,-1794.68 498165.5,-1794.68 498165.5,-1750.68 498362.5,-1750.68 498362.5,-1794.68"/>
<text text-anchor="middle" x="498264" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="498264" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="498264" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="498264" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert3_v_proj -->
<g id="node2222" class="node">
<title>layer15_expert3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="498147.5,-1794.68 497950.5,-1794.68 497950.5,-1750.68 498147.5,-1750.68 498147.5,-1794.68"/>
<text text-anchor="middle" x="498049" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="498049" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="498049" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="498049" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert3_attn -->
<g id="node2223" class="node">
<title>layer15_expert3_attn</title>
<polygon fill="lightgreen" stroke="black" points="497932.5,-1794.68 497735.5,-1794.68 497735.5,-1750.68 497932.5,-1750.68 497932.5,-1794.68"/>
<text text-anchor="middle" x="497834" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="497834" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="497834" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="497834" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert3_attn_out -->
<g id="node2224" class="node">
<title>layer15_expert3_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="497717,-1794.68 497517,-1794.68 497517,-1750.68 497717,-1750.68 497717,-1794.68"/>
<text text-anchor="middle" x="497617" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="497617" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="497617" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="497617" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert3_attn_ar -->
<g id="node2225" class="node">
<title>layer15_expert3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="497358" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="497358" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="497358" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="497358" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="497358" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert3_attn_res -->
<g id="node2226" class="node">
<title>layer15_expert3_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="497198.2,-1816.68 496868.59,-1816.68 496783.8,-1728.68 497113.41,-1728.68 497198.2,-1816.68"/>
<text text-anchor="middle" x="496991" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="496991" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="496991" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="496991" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert3_ln1 -->
<g id="node2227" class="node">
<title>layer15_expert3_ln1</title>
<polygon fill="lightgreen" stroke="black" points="496766,-1794.68 496566,-1794.68 496566,-1750.68 496766,-1750.68 496766,-1794.68"/>
<text text-anchor="middle" x="496666" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="496666" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="496666" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="496666" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert3_mlp1 -->
<g id="node2228" class="node">
<title>layer15_expert3_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="496548,-1794.68 496352,-1794.68 496352,-1750.68 496548,-1750.68 496548,-1794.68"/>
<text text-anchor="middle" x="496450" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="496450" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="496450" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="496450" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert3_gelu -->
<g id="node2229" class="node">
<title>layer15_expert3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="496334,-1794.68 496138,-1794.68 496138,-1750.68 496334,-1750.68 496334,-1794.68"/>
<text text-anchor="middle" x="496236" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="496236" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="496236" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="496236" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert3_mlp2 -->
<g id="node2230" class="node">
<title>layer15_expert3_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="496120,-1794.68 495920,-1794.68 495920,-1750.68 496120,-1750.68 496120,-1794.68"/>
<text text-anchor="middle" x="496020" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="496020" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="496020" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="496020" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert3_mlp_ar -->
<g id="node2231" class="node">
<title>layer15_expert3_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="495761" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="495761" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="495761" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="495761" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="495761" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert3_mlp_res -->
<g id="node2232" class="node">
<title>layer15_expert3_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="495601.2,-1816.68 495271.59,-1816.68 495186.8,-1728.68 495516.41,-1728.68 495601.2,-1816.68"/>
<text text-anchor="middle" x="495394" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="495394" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="495394" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="495394" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert3_ln2 -->
<g id="node2233" class="node">
<title>layer15_expert3_ln2</title>
<polygon fill="lightgreen" stroke="black" points="495169,-1794.68 494969,-1794.68 494969,-1750.68 495169,-1750.68 495169,-1794.68"/>
<text text-anchor="middle" x="495069" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="495069" y="-1775.28" font-family="Arial" font-size="8.00">L15_E3</text>
<text text-anchor="middle" x="495069" y="-1766.28" font-family="Arial" font-size="8.00">GPU:54</text>
<text text-anchor="middle" x="495069" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert4_route -->
<g id="node2234" class="node">
<title>layer15_expert4_route</title>
<polygon fill="lightyellow" stroke="black" points="494945,-1794.68 494745,-1794.68 494745,-1750.68 494945,-1750.68 494945,-1794.68"/>
<text text-anchor="middle" x="494845" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="494845" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="494845" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="494845" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert4_gate -->
<g id="node2235" class="node">
<title>layer15_expert4_gate</title>
<polygon fill="lightyellow" stroke="black" points="494727.04,-1816.68 494412,-1816.68 494330.96,-1728.68 494646,-1728.68 494727.04,-1816.68"/>
<text text-anchor="middle" x="494529" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="494529" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="494529" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="494529" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer15_expert4_a2a -->
<g id="node2236" class="node">
<title>layer15_expert4_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="494172" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="494172" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="494172" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="494172" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="494172" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert4_attn_split -->
<g id="node2237" class="node">
<title>layer15_expert4_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="494012.48,-1816.68 493687.2,-1816.68 493603.52,-1728.68 493928.8,-1728.68 494012.48,-1816.68"/>
<text text-anchor="middle" x="493808" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="493808" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="493808" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="493808" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert4_q_proj -->
<g id="node2238" class="node">
<title>layer15_expert4_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="493585.5,-1794.68 493388.5,-1794.68 493388.5,-1750.68 493585.5,-1750.68 493585.5,-1794.68"/>
<text text-anchor="middle" x="493487" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="493487" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="493487" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="493487" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert4_k_proj -->
<g id="node2239" class="node">
<title>layer15_expert4_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="493370.5,-1794.68 493173.5,-1794.68 493173.5,-1750.68 493370.5,-1750.68 493370.5,-1794.68"/>
<text text-anchor="middle" x="493272" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="493272" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="493272" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="493272" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert4_v_proj -->
<g id="node2240" class="node">
<title>layer15_expert4_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="493155.5,-1794.68 492958.5,-1794.68 492958.5,-1750.68 493155.5,-1750.68 493155.5,-1794.68"/>
<text text-anchor="middle" x="493057" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="493057" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="493057" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="493057" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert4_attn -->
<g id="node2241" class="node">
<title>layer15_expert4_attn</title>
<polygon fill="lightgreen" stroke="black" points="492940.5,-1794.68 492743.5,-1794.68 492743.5,-1750.68 492940.5,-1750.68 492940.5,-1794.68"/>
<text text-anchor="middle" x="492842" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="492842" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="492842" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="492842" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert4_attn_out -->
<g id="node2242" class="node">
<title>layer15_expert4_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="492725,-1794.68 492525,-1794.68 492525,-1750.68 492725,-1750.68 492725,-1794.68"/>
<text text-anchor="middle" x="492625" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="492625" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="492625" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="492625" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert4_attn_ar -->
<g id="node2243" class="node">
<title>layer15_expert4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="492366" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="492366" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="492366" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="492366" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="492366" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert4_attn_res -->
<g id="node2244" class="node">
<title>layer15_expert4_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="492206.2,-1816.68 491876.59,-1816.68 491791.8,-1728.68 492121.41,-1728.68 492206.2,-1816.68"/>
<text text-anchor="middle" x="491999" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="491999" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="491999" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="491999" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert4_ln1 -->
<g id="node2245" class="node">
<title>layer15_expert4_ln1</title>
<polygon fill="lightgreen" stroke="black" points="491774,-1794.68 491574,-1794.68 491574,-1750.68 491774,-1750.68 491774,-1794.68"/>
<text text-anchor="middle" x="491674" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="491674" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="491674" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="491674" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert4_mlp1 -->
<g id="node2246" class="node">
<title>layer15_expert4_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="491556,-1794.68 491360,-1794.68 491360,-1750.68 491556,-1750.68 491556,-1794.68"/>
<text text-anchor="middle" x="491458" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="491458" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="491458" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="491458" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert4_gelu -->
<g id="node2247" class="node">
<title>layer15_expert4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="491342,-1794.68 491146,-1794.68 491146,-1750.68 491342,-1750.68 491342,-1794.68"/>
<text text-anchor="middle" x="491244" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="491244" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="491244" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="491244" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert4_mlp2 -->
<g id="node2248" class="node">
<title>layer15_expert4_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="491128,-1794.68 490928,-1794.68 490928,-1750.68 491128,-1750.68 491128,-1794.68"/>
<text text-anchor="middle" x="491028" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="491028" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="491028" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="491028" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert4_mlp_ar -->
<g id="node2249" class="node">
<title>layer15_expert4_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="490769" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="490769" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="490769" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="490769" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="490769" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert4_mlp_res -->
<g id="node2250" class="node">
<title>layer15_expert4_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="490609.2,-1816.68 490279.59,-1816.68 490194.8,-1728.68 490524.41,-1728.68 490609.2,-1816.68"/>
<text text-anchor="middle" x="490402" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="490402" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="490402" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="490402" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert4_ln2 -->
<g id="node2251" class="node">
<title>layer15_expert4_ln2</title>
<polygon fill="lightgreen" stroke="black" points="490177,-1794.68 489977,-1794.68 489977,-1750.68 490177,-1750.68 490177,-1794.68"/>
<text text-anchor="middle" x="490077" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="490077" y="-1775.28" font-family="Arial" font-size="8.00">L15_E4</text>
<text text-anchor="middle" x="490077" y="-1766.28" font-family="Arial" font-size="8.00">GPU:56</text>
<text text-anchor="middle" x="490077" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert5_route -->
<g id="node2252" class="node">
<title>layer15_expert5_route</title>
<polygon fill="lightyellow" stroke="black" points="489953,-1794.68 489753,-1794.68 489753,-1750.68 489953,-1750.68 489953,-1794.68"/>
<text text-anchor="middle" x="489853" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="489853" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="489853" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="489853" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert5_gate -->
<g id="node2253" class="node">
<title>layer15_expert5_gate</title>
<polygon fill="lightyellow" stroke="black" points="489735.04,-1816.68 489420,-1816.68 489338.96,-1728.68 489654,-1728.68 489735.04,-1816.68"/>
<text text-anchor="middle" x="489537" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="489537" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="489537" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="489537" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer15_expert5_a2a -->
<g id="node2254" class="node">
<title>layer15_expert5_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="489180" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="489180" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="489180" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="489180" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="489180" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert5_attn_split -->
<g id="node2255" class="node">
<title>layer15_expert5_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="489020.48,-1816.68 488695.2,-1816.68 488611.52,-1728.68 488936.8,-1728.68 489020.48,-1816.68"/>
<text text-anchor="middle" x="488816" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="488816" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="488816" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="488816" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert5_q_proj -->
<g id="node2256" class="node">
<title>layer15_expert5_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="488593.5,-1794.68 488396.5,-1794.68 488396.5,-1750.68 488593.5,-1750.68 488593.5,-1794.68"/>
<text text-anchor="middle" x="488495" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="488495" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="488495" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="488495" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert5_k_proj -->
<g id="node2257" class="node">
<title>layer15_expert5_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="488378.5,-1794.68 488181.5,-1794.68 488181.5,-1750.68 488378.5,-1750.68 488378.5,-1794.68"/>
<text text-anchor="middle" x="488280" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="488280" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="488280" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="488280" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert5_v_proj -->
<g id="node2258" class="node">
<title>layer15_expert5_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="488163.5,-1794.68 487966.5,-1794.68 487966.5,-1750.68 488163.5,-1750.68 488163.5,-1794.68"/>
<text text-anchor="middle" x="488065" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="488065" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="488065" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="488065" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert5_attn -->
<g id="node2259" class="node">
<title>layer15_expert5_attn</title>
<polygon fill="lightgreen" stroke="black" points="487948.5,-1794.68 487751.5,-1794.68 487751.5,-1750.68 487948.5,-1750.68 487948.5,-1794.68"/>
<text text-anchor="middle" x="487850" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="487850" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="487850" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="487850" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert5_attn_out -->
<g id="node2260" class="node">
<title>layer15_expert5_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="487733,-1794.68 487533,-1794.68 487533,-1750.68 487733,-1750.68 487733,-1794.68"/>
<text text-anchor="middle" x="487633" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="487633" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="487633" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="487633" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert5_attn_ar -->
<g id="node2261" class="node">
<title>layer15_expert5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="487374" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="487374" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="487374" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="487374" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="487374" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert5_attn_res -->
<g id="node2262" class="node">
<title>layer15_expert5_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="487214.2,-1816.68 486884.59,-1816.68 486799.8,-1728.68 487129.41,-1728.68 487214.2,-1816.68"/>
<text text-anchor="middle" x="487007" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="487007" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="487007" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="487007" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert5_ln1 -->
<g id="node2263" class="node">
<title>layer15_expert5_ln1</title>
<polygon fill="lightgreen" stroke="black" points="486782,-1794.68 486582,-1794.68 486582,-1750.68 486782,-1750.68 486782,-1794.68"/>
<text text-anchor="middle" x="486682" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="486682" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="486682" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="486682" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert5_mlp1 -->
<g id="node2264" class="node">
<title>layer15_expert5_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="486564,-1794.68 486368,-1794.68 486368,-1750.68 486564,-1750.68 486564,-1794.68"/>
<text text-anchor="middle" x="486466" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="486466" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="486466" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="486466" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert5_gelu -->
<g id="node2265" class="node">
<title>layer15_expert5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="486350,-1794.68 486154,-1794.68 486154,-1750.68 486350,-1750.68 486350,-1794.68"/>
<text text-anchor="middle" x="486252" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="486252" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="486252" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="486252" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert5_mlp2 -->
<g id="node2266" class="node">
<title>layer15_expert5_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="486136,-1794.68 485936,-1794.68 485936,-1750.68 486136,-1750.68 486136,-1794.68"/>
<text text-anchor="middle" x="486036" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="486036" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="486036" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="486036" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert5_mlp_ar -->
<g id="node2267" class="node">
<title>layer15_expert5_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="485777" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="485777" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="485777" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="485777" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="485777" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert5_mlp_res -->
<g id="node2268" class="node">
<title>layer15_expert5_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="485617.2,-1816.68 485287.59,-1816.68 485202.8,-1728.68 485532.41,-1728.68 485617.2,-1816.68"/>
<text text-anchor="middle" x="485410" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="485410" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="485410" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="485410" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert5_ln2 -->
<g id="node2269" class="node">
<title>layer15_expert5_ln2</title>
<polygon fill="lightgreen" stroke="black" points="485185,-1794.68 484985,-1794.68 484985,-1750.68 485185,-1750.68 485185,-1794.68"/>
<text text-anchor="middle" x="485085" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="485085" y="-1775.28" font-family="Arial" font-size="8.00">L15_E5</text>
<text text-anchor="middle" x="485085" y="-1766.28" font-family="Arial" font-size="8.00">GPU:58</text>
<text text-anchor="middle" x="485085" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert6_route -->
<g id="node2270" class="node">
<title>layer15_expert6_route</title>
<polygon fill="lightyellow" stroke="black" points="484961,-1794.68 484761,-1794.68 484761,-1750.68 484961,-1750.68 484961,-1794.68"/>
<text text-anchor="middle" x="484861" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="484861" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="484861" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="484861" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert6_gate -->
<g id="node2271" class="node">
<title>layer15_expert6_gate</title>
<polygon fill="lightyellow" stroke="black" points="484743.04,-1816.68 484428,-1816.68 484346.96,-1728.68 484662,-1728.68 484743.04,-1816.68"/>
<text text-anchor="middle" x="484545" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="484545" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="484545" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="484545" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer15_expert6_a2a -->
<g id="node2272" class="node">
<title>layer15_expert6_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="484188" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="484188" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="484188" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="484188" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="484188" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert6_attn_split -->
<g id="node2273" class="node">
<title>layer15_expert6_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="484028.48,-1816.68 483703.2,-1816.68 483619.52,-1728.68 483944.8,-1728.68 484028.48,-1816.68"/>
<text text-anchor="middle" x="483824" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="483824" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="483824" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="483824" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert6_q_proj -->
<g id="node2274" class="node">
<title>layer15_expert6_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="483601.5,-1794.68 483404.5,-1794.68 483404.5,-1750.68 483601.5,-1750.68 483601.5,-1794.68"/>
<text text-anchor="middle" x="483503" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="483503" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="483503" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="483503" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert6_k_proj -->
<g id="node2275" class="node">
<title>layer15_expert6_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="483386.5,-1794.68 483189.5,-1794.68 483189.5,-1750.68 483386.5,-1750.68 483386.5,-1794.68"/>
<text text-anchor="middle" x="483288" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="483288" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="483288" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="483288" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert6_v_proj -->
<g id="node2276" class="node">
<title>layer15_expert6_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="483171.5,-1794.68 482974.5,-1794.68 482974.5,-1750.68 483171.5,-1750.68 483171.5,-1794.68"/>
<text text-anchor="middle" x="483073" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="483073" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="483073" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="483073" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert6_attn -->
<g id="node2277" class="node">
<title>layer15_expert6_attn</title>
<polygon fill="lightgreen" stroke="black" points="482956.5,-1794.68 482759.5,-1794.68 482759.5,-1750.68 482956.5,-1750.68 482956.5,-1794.68"/>
<text text-anchor="middle" x="482858" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="482858" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="482858" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="482858" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert6_attn_out -->
<g id="node2278" class="node">
<title>layer15_expert6_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="482741,-1794.68 482541,-1794.68 482541,-1750.68 482741,-1750.68 482741,-1794.68"/>
<text text-anchor="middle" x="482641" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="482641" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="482641" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="482641" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert6_attn_ar -->
<g id="node2279" class="node">
<title>layer15_expert6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="482382" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="482382" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="482382" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="482382" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="482382" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert6_attn_res -->
<g id="node2280" class="node">
<title>layer15_expert6_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="482222.2,-1816.68 481892.59,-1816.68 481807.8,-1728.68 482137.41,-1728.68 482222.2,-1816.68"/>
<text text-anchor="middle" x="482015" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="482015" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="482015" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="482015" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert6_ln1 -->
<g id="node2281" class="node">
<title>layer15_expert6_ln1</title>
<polygon fill="lightgreen" stroke="black" points="481790,-1794.68 481590,-1794.68 481590,-1750.68 481790,-1750.68 481790,-1794.68"/>
<text text-anchor="middle" x="481690" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="481690" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="481690" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="481690" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert6_mlp1 -->
<g id="node2282" class="node">
<title>layer15_expert6_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="481572,-1794.68 481376,-1794.68 481376,-1750.68 481572,-1750.68 481572,-1794.68"/>
<text text-anchor="middle" x="481474" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="481474" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="481474" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="481474" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert6_gelu -->
<g id="node2283" class="node">
<title>layer15_expert6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="481358,-1794.68 481162,-1794.68 481162,-1750.68 481358,-1750.68 481358,-1794.68"/>
<text text-anchor="middle" x="481260" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="481260" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="481260" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="481260" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert6_mlp2 -->
<g id="node2284" class="node">
<title>layer15_expert6_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="481144,-1794.68 480944,-1794.68 480944,-1750.68 481144,-1750.68 481144,-1794.68"/>
<text text-anchor="middle" x="481044" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="481044" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="481044" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="481044" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert6_mlp_ar -->
<g id="node2285" class="node">
<title>layer15_expert6_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="480785" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="480785" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="480785" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="480785" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="480785" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert6_mlp_res -->
<g id="node2286" class="node">
<title>layer15_expert6_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="480625.2,-1816.68 480295.59,-1816.68 480210.8,-1728.68 480540.41,-1728.68 480625.2,-1816.68"/>
<text text-anchor="middle" x="480418" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="480418" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="480418" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="480418" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert6_ln2 -->
<g id="node2287" class="node">
<title>layer15_expert6_ln2</title>
<polygon fill="lightgreen" stroke="black" points="480193,-1794.68 479993,-1794.68 479993,-1750.68 480193,-1750.68 480193,-1794.68"/>
<text text-anchor="middle" x="480093" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="480093" y="-1775.28" font-family="Arial" font-size="8.00">L15_E6</text>
<text text-anchor="middle" x="480093" y="-1766.28" font-family="Arial" font-size="8.00">GPU:60</text>
<text text-anchor="middle" x="480093" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert7_route -->
<g id="node2288" class="node">
<title>layer15_expert7_route</title>
<polygon fill="lightyellow" stroke="black" points="479969,-1794.68 479769,-1794.68 479769,-1750.68 479969,-1750.68 479969,-1794.68"/>
<text text-anchor="middle" x="479869" y="-1784.28" font-family="Arial" font-size="8.00">Expert Routing</text>
<text text-anchor="middle" x="479869" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="479869" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="479869" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert7_gate -->
<g id="node2289" class="node">
<title>layer15_expert7_gate</title>
<polygon fill="lightyellow" stroke="black" points="479751.04,-1816.68 479436,-1816.68 479354.96,-1728.68 479670,-1728.68 479751.04,-1816.68"/>
<text text-anchor="middle" x="479553" y="-1784.28" font-family="Arial" font-size="8.00">Expert Gate</text>
<text text-anchor="middle" x="479553" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="479553" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="479553" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, num_experts=8]</text>
</g>
<!-- layer15_expert7_a2a -->
<g id="node2290" class="node">
<title>layer15_expert7_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="479196" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="479196" y="-1784.28" font-family="Arial" font-size="8.00">All&#45;to&#45;All Comm</text>
<text text-anchor="middle" x="479196" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="479196" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="479196" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert7_attn_split -->
<g id="node2291" class="node">
<title>layer15_expert7_attn_split</title>
<polygon fill="lightyellow" stroke="black" points="479036.48,-1816.68 478711.2,-1816.68 478627.52,-1728.68 478952.8,-1728.68 479036.48,-1816.68"/>
<text text-anchor="middle" x="478832" y="-1784.28" font-family="Arial" font-size="8.00">Attention Head Split</text>
<text text-anchor="middle" x="478832" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="478832" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="478832" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert7_q_proj -->
<g id="node2292" class="node">
<title>layer15_expert7_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="478609.5,-1794.68 478412.5,-1794.68 478412.5,-1750.68 478609.5,-1750.68 478609.5,-1794.68"/>
<text text-anchor="middle" x="478511" y="-1784.28" font-family="Arial" font-size="8.00">Q Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="478511" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="478511" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="478511" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert7_k_proj -->
<g id="node2293" class="node">
<title>layer15_expert7_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="478394.5,-1794.68 478197.5,-1794.68 478197.5,-1750.68 478394.5,-1750.68 478394.5,-1794.68"/>
<text text-anchor="middle" x="478296" y="-1784.28" font-family="Arial" font-size="8.00">K Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="478296" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="478296" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="478296" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert7_v_proj -->
<g id="node2294" class="node">
<title>layer15_expert7_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="478179.5,-1794.68 477982.5,-1794.68 477982.5,-1750.68 478179.5,-1750.68 478179.5,-1794.68"/>
<text text-anchor="middle" x="478081" y="-1784.28" font-family="Arial" font-size="8.00">V Projection (Col&#45;Par)</text>
<text text-anchor="middle" x="478081" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="478081" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="478081" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert7_attn -->
<g id="node2295" class="node">
<title>layer15_expert7_attn</title>
<polygon fill="lightgreen" stroke="black" points="477964.5,-1794.68 477767.5,-1794.68 477767.5,-1750.68 477964.5,-1750.68 477964.5,-1794.68"/>
<text text-anchor="middle" x="477866" y="-1784.28" font-family="Arial" font-size="8.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="477866" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="477866" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="477866" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- layer15_expert7_attn_out -->
<g id="node2296" class="node">
<title>layer15_expert7_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="477749,-1794.68 477549,-1794.68 477549,-1750.68 477749,-1750.68 477749,-1794.68"/>
<text text-anchor="middle" x="477649" y="-1784.28" font-family="Arial" font-size="8.00">Attention Output (Row&#45;Par)</text>
<text text-anchor="middle" x="477649" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="477649" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="477649" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert7_attn_ar -->
<g id="node2297" class="node">
<title>layer15_expert7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="477390" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="477390" y="-1784.28" font-family="Arial" font-size="8.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="477390" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="477390" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="477390" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert7_attn_res -->
<g id="node2298" class="node">
<title>layer15_expert7_attn_res</title>
<polygon fill="lightyellow" stroke="black" points="477230.2,-1816.68 476900.59,-1816.68 476815.8,-1728.68 477145.41,-1728.68 477230.2,-1816.68"/>
<text text-anchor="middle" x="477023" y="-1784.28" font-family="Arial" font-size="8.00">Attention + Residual</text>
<text text-anchor="middle" x="477023" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="477023" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="477023" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert7_ln1 -->
<g id="node2299" class="node">
<title>layer15_expert7_ln1</title>
<polygon fill="lightgreen" stroke="black" points="476798,-1794.68 476598,-1794.68 476598,-1750.68 476798,-1750.68 476798,-1794.68"/>
<text text-anchor="middle" x="476698" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 1</text>
<text text-anchor="middle" x="476698" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="476698" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="476698" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert7_mlp1 -->
<g id="node2300" class="node">
<title>layer15_expert7_mlp1</title>
<polygon fill="lightgreen" stroke="black" points="476580,-1794.68 476384,-1794.68 476384,-1750.68 476580,-1750.68 476580,-1794.68"/>
<text text-anchor="middle" x="476482" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 1 (Col&#45;Par)</text>
<text text-anchor="middle" x="476482" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="476482" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="476482" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert7_gelu -->
<g id="node2301" class="node">
<title>layer15_expert7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="476366,-1794.68 476170,-1794.68 476170,-1750.68 476366,-1750.68 476366,-1794.68"/>
<text text-anchor="middle" x="476268" y="-1784.28" font-family="Arial" font-size="8.00">GELU Activation</text>
<text text-anchor="middle" x="476268" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="476268" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="476268" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, ffn_hidden=1024]</text>
</g>
<!-- layer15_expert7_mlp2 -->
<g id="node2302" class="node">
<title>layer15_expert7_mlp2</title>
<polygon fill="lightgreen" stroke="black" points="476152,-1794.68 475952,-1794.68 475952,-1750.68 476152,-1750.68 476152,-1794.68"/>
<text text-anchor="middle" x="476052" y="-1784.28" font-family="Arial" font-size="8.00">MLP Linear 2 (Row&#45;Par)</text>
<text text-anchor="middle" x="476052" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="476052" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="476052" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert7_mlp_ar -->
<g id="node2303" class="node">
<title>layer15_expert7_mlp_ar</title>
<ellipse fill="lightblue" stroke="black" cx="475793" cy="-1772.68" rx="141.34" ry="31.23"/>
<text text-anchor="middle" x="475793" y="-1784.28" font-family="Arial" font-size="8.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="475793" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="475793" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="475793" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert7_mlp_res -->
<g id="node2304" class="node">
<title>layer15_expert7_mlp_res</title>
<polygon fill="lightyellow" stroke="black" points="475633.2,-1816.68 475303.59,-1816.68 475218.8,-1728.68 475548.41,-1728.68 475633.2,-1816.68"/>
<text text-anchor="middle" x="475426" y="-1784.28" font-family="Arial" font-size="8.00">MLP + Residual</text>
<text text-anchor="middle" x="475426" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="475426" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="475426" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
<!-- layer15_expert7_ln2 -->
<g id="node2305" class="node">
<title>layer15_expert7_ln2</title>
<polygon fill="lightgreen" stroke="black" points="475201,-1794.68 475001,-1794.68 475001,-1750.68 475201,-1750.68 475201,-1794.68"/>
<text text-anchor="middle" x="475101" y="-1784.28" font-family="Arial" font-size="8.00">Layer Norm 2</text>
<text text-anchor="middle" x="475101" y="-1775.28" font-family="Arial" font-size="8.00">L15_E7</text>
<text text-anchor="middle" x="475101" y="-1766.28" font-family="Arial" font-size="8.00">GPU:62</text>
<text text-anchor="middle" x="475101" y="-1757.28" font-family="Arial" font-size="8.00">[batch_size=128, seq_len=1024, hidden_dim=1024]</text>
</g>
</g>
</svg>
