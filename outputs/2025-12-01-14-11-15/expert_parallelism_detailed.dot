// Expert Parallelism Detailed View
digraph {
	dpi=300 rankdir=TB size="30,30"
	input_tokens [label="Input Tokens\n[batch_size=128, seq_len=1024, hidden_dim=1024]"]
	gate_0 [label="Gate 0\n[batch_size=128, seq_len=1024, num_experts=8]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
	expert_select_0 [label="Expert Selection 0\n[batch_size=128, seq_len=1024]\nGPU: 0" fillcolor=lightyellow shape=parallelogram]
	expert_0 [label="Expert 0\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
	expert_1 [label="Expert 1\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
	expert_2 [label="Expert 2\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
	expert_3 [label="Expert 3\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
	expert_4 [label="Expert 4\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
	expert_5 [label="Expert 5\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
	expert_6 [label="Expert 6\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
	expert_7 [label="Expert 7\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 0" fillcolor=lightgreen shape=rectangle]
	gate_1 [label="Gate 1\n[batch_size=128, seq_len=1024, num_experts=8]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
	expert_select_1 [label="Expert Selection 1\n[batch_size=128, seq_len=1024]\nGPU: 1" fillcolor=lightyellow shape=parallelogram]
	expert_8 [label="Expert 8\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
	expert_9 [label="Expert 9\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
	expert_10 [label="Expert 10\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
	expert_11 [label="Expert 11\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
	expert_12 [label="Expert 12\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
	expert_13 [label="Expert 13\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
	expert_14 [label="Expert 14\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
	expert_15 [label="Expert 15\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 1" fillcolor=lightgreen shape=rectangle]
	gate_2 [label="Gate 2\n[batch_size=128, seq_len=1024, num_experts=8]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
	expert_select_2 [label="Expert Selection 2\n[batch_size=128, seq_len=1024]\nGPU: 2" fillcolor=lightyellow shape=parallelogram]
	expert_16 [label="Expert 16\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
	expert_17 [label="Expert 17\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
	expert_18 [label="Expert 18\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
	expert_19 [label="Expert 19\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
	expert_20 [label="Expert 20\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
	expert_21 [label="Expert 21\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
	expert_22 [label="Expert 22\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
	expert_23 [label="Expert 23\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 2" fillcolor=lightgreen shape=rectangle]
	gate_3 [label="Gate 3\n[batch_size=128, seq_len=1024, num_experts=8]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
	expert_select_3 [label="Expert Selection 3\n[batch_size=128, seq_len=1024]\nGPU: 3" fillcolor=lightyellow shape=parallelogram]
	expert_24 [label="Expert 24\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
	expert_25 [label="Expert 25\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
	expert_26 [label="Expert 26\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
	expert_27 [label="Expert 27\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
	expert_28 [label="Expert 28\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
	expert_29 [label="Expert 29\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
	expert_30 [label="Expert 30\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
	expert_31 [label="Expert 31\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 3" fillcolor=lightgreen shape=rectangle]
	gate_4 [label="Gate 4\n[batch_size=128, seq_len=1024, num_experts=8]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
	expert_select_4 [label="Expert Selection 4\n[batch_size=128, seq_len=1024]\nGPU: 4" fillcolor=lightyellow shape=parallelogram]
	expert_32 [label="Expert 32\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
	expert_33 [label="Expert 33\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
	expert_34 [label="Expert 34\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
	expert_35 [label="Expert 35\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
	expert_36 [label="Expert 36\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
	expert_37 [label="Expert 37\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
	expert_38 [label="Expert 38\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
	expert_39 [label="Expert 39\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 4" fillcolor=lightgreen shape=rectangle]
	gate_5 [label="Gate 5\n[batch_size=128, seq_len=1024, num_experts=8]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
	expert_select_5 [label="Expert Selection 5\n[batch_size=128, seq_len=1024]\nGPU: 5" fillcolor=lightyellow shape=parallelogram]
	expert_40 [label="Expert 40\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
	expert_41 [label="Expert 41\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
	expert_42 [label="Expert 42\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
	expert_43 [label="Expert 43\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
	expert_44 [label="Expert 44\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
	expert_45 [label="Expert 45\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
	expert_46 [label="Expert 46\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
	expert_47 [label="Expert 47\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 5" fillcolor=lightgreen shape=rectangle]
	gate_6 [label="Gate 6\n[batch_size=128, seq_len=1024, num_experts=8]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
	expert_select_6 [label="Expert Selection 6\n[batch_size=128, seq_len=1024]\nGPU: 6" fillcolor=lightyellow shape=parallelogram]
	expert_48 [label="Expert 48\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
	expert_49 [label="Expert 49\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
	expert_50 [label="Expert 50\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
	expert_51 [label="Expert 51\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
	expert_52 [label="Expert 52\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
	expert_53 [label="Expert 53\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
	expert_54 [label="Expert 54\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
	expert_55 [label="Expert 55\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 6" fillcolor=lightgreen shape=rectangle]
	gate_7 [label="Gate 7\n[batch_size=128, seq_len=1024, num_experts=8]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
	expert_select_7 [label="Expert Selection 7\n[batch_size=128, seq_len=1024]\nGPU: 7" fillcolor=lightyellow shape=parallelogram]
	expert_56 [label="Expert 56\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
	expert_57 [label="Expert 57\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
	expert_58 [label="Expert 58\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
	expert_59 [label="Expert 59\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
	expert_60 [label="Expert 60\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
	expert_61 [label="Expert 61\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
	expert_62 [label="Expert 62\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
	expert_63 [label="Expert 63\n[batch_size=16, seq_len=1024, hidden_dim=1024]\nGPU: 7" fillcolor=lightgreen shape=rectangle]
	a2a_comm [label="All-to-All Communication\nExpert Assignment\n[batch_size=128, seq_len=1024, hidden_dim=1024]" fillcolor=lightblue shape=ellipse]
	expert_agg [label="Expert Aggregation\n[batch_size=128, seq_len=1024, hidden_dim=1024]" fillcolor=lightyellow shape=parallelogram]
	input_tokens -> gate_0
	input_tokens -> gate_1
	input_tokens -> gate_2
	input_tokens -> gate_3
	input_tokens -> gate_4
	input_tokens -> gate_5
	input_tokens -> gate_6
	input_tokens -> gate_7
	gate_0 -> expert_select_0
	expert_select_0 -> a2a_comm
	a2a_comm -> expert_0
	expert_0 -> expert_agg
	a2a_comm -> expert_1
	expert_1 -> expert_agg
	a2a_comm -> expert_2
	expert_2 -> expert_agg
	a2a_comm -> expert_3
	expert_3 -> expert_agg
	a2a_comm -> expert_4
	expert_4 -> expert_agg
	a2a_comm -> expert_5
	expert_5 -> expert_agg
	a2a_comm -> expert_6
	expert_6 -> expert_agg
	a2a_comm -> expert_7
	expert_7 -> expert_agg
	gate_1 -> expert_select_1
	expert_select_1 -> a2a_comm
	a2a_comm -> expert_8
	expert_8 -> expert_agg
	a2a_comm -> expert_9
	expert_9 -> expert_agg
	a2a_comm -> expert_10
	expert_10 -> expert_agg
	a2a_comm -> expert_11
	expert_11 -> expert_agg
	a2a_comm -> expert_12
	expert_12 -> expert_agg
	a2a_comm -> expert_13
	expert_13 -> expert_agg
	a2a_comm -> expert_14
	expert_14 -> expert_agg
	a2a_comm -> expert_15
	expert_15 -> expert_agg
	gate_2 -> expert_select_2
	expert_select_2 -> a2a_comm
	a2a_comm -> expert_16
	expert_16 -> expert_agg
	a2a_comm -> expert_17
	expert_17 -> expert_agg
	a2a_comm -> expert_18
	expert_18 -> expert_agg
	a2a_comm -> expert_19
	expert_19 -> expert_agg
	a2a_comm -> expert_20
	expert_20 -> expert_agg
	a2a_comm -> expert_21
	expert_21 -> expert_agg
	a2a_comm -> expert_22
	expert_22 -> expert_agg
	a2a_comm -> expert_23
	expert_23 -> expert_agg
	gate_3 -> expert_select_3
	expert_select_3 -> a2a_comm
	a2a_comm -> expert_24
	expert_24 -> expert_agg
	a2a_comm -> expert_25
	expert_25 -> expert_agg
	a2a_comm -> expert_26
	expert_26 -> expert_agg
	a2a_comm -> expert_27
	expert_27 -> expert_agg
	a2a_comm -> expert_28
	expert_28 -> expert_agg
	a2a_comm -> expert_29
	expert_29 -> expert_agg
	a2a_comm -> expert_30
	expert_30 -> expert_agg
	a2a_comm -> expert_31
	expert_31 -> expert_agg
	gate_4 -> expert_select_4
	expert_select_4 -> a2a_comm
	a2a_comm -> expert_32
	expert_32 -> expert_agg
	a2a_comm -> expert_33
	expert_33 -> expert_agg
	a2a_comm -> expert_34
	expert_34 -> expert_agg
	a2a_comm -> expert_35
	expert_35 -> expert_agg
	a2a_comm -> expert_36
	expert_36 -> expert_agg
	a2a_comm -> expert_37
	expert_37 -> expert_agg
	a2a_comm -> expert_38
	expert_38 -> expert_agg
	a2a_comm -> expert_39
	expert_39 -> expert_agg
	gate_5 -> expert_select_5
	expert_select_5 -> a2a_comm
	a2a_comm -> expert_40
	expert_40 -> expert_agg
	a2a_comm -> expert_41
	expert_41 -> expert_agg
	a2a_comm -> expert_42
	expert_42 -> expert_agg
	a2a_comm -> expert_43
	expert_43 -> expert_agg
	a2a_comm -> expert_44
	expert_44 -> expert_agg
	a2a_comm -> expert_45
	expert_45 -> expert_agg
	a2a_comm -> expert_46
	expert_46 -> expert_agg
	a2a_comm -> expert_47
	expert_47 -> expert_agg
	gate_6 -> expert_select_6
	expert_select_6 -> a2a_comm
	a2a_comm -> expert_48
	expert_48 -> expert_agg
	a2a_comm -> expert_49
	expert_49 -> expert_agg
	a2a_comm -> expert_50
	expert_50 -> expert_agg
	a2a_comm -> expert_51
	expert_51 -> expert_agg
	a2a_comm -> expert_52
	expert_52 -> expert_agg
	a2a_comm -> expert_53
	expert_53 -> expert_agg
	a2a_comm -> expert_54
	expert_54 -> expert_agg
	a2a_comm -> expert_55
	expert_55 -> expert_agg
	gate_7 -> expert_select_7
	expert_select_7 -> a2a_comm
	a2a_comm -> expert_56
	expert_56 -> expert_agg
	a2a_comm -> expert_57
	expert_57 -> expert_agg
	a2a_comm -> expert_58
	expert_58 -> expert_agg
	a2a_comm -> expert_59
	expert_59 -> expert_agg
	a2a_comm -> expert_60
	expert_60 -> expert_agg
	a2a_comm -> expert_61
	expert_61 -> expert_agg
	a2a_comm -> expert_62
	expert_62 -> expert_agg
	a2a_comm -> expert_63
	expert_63 -> expert_agg
}
