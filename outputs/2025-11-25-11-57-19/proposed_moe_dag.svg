<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_moe_dag Pages: 1 -->
<svg width="6842pt" height="44119pt"
 viewBox="0.00 0.00 6842.00 44118.66" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 44114.66)">
<title>proposed_moe_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-44114.66 6838,-44114.66 6838,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="375,-41275.16 375,-43843.5 6714,-43843.5 6714,-41275.16 375,-41275.16"/>
<text text-anchor="middle" x="3544.5" y="-43828.3" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="3544.5" y="-43813.3" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_1</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="470,-38543.83 470,-41112.16 6809,-41112.16 6809,-38543.83 470,-38543.83"/>
<text text-anchor="middle" x="3639.5" y="-41096.96" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3639.5" y="-41081.96" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_2</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="238,-35812.5 238,-38380.83 6577,-38380.83 6577,-35812.5 238,-35812.5"/>
<text text-anchor="middle" x="3407.5" y="-38365.63" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3407.5" y="-38350.63" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_3</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="265,-33081.16 265,-35649.5 6604,-35649.5 6604,-33081.16 265,-33081.16"/>
<text text-anchor="middle" x="3434.5" y="-35634.3" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3434.5" y="-35619.3" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_4</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="145,-30349.83 145,-32918.16 6484,-32918.16 6484,-30349.83 145,-30349.83"/>
<text text-anchor="middle" x="3314.5" y="-32902.96" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="3314.5" y="-32887.96" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_5</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="473,-27618.5 473,-30186.83 6812,-30186.83 6812,-27618.5 473,-27618.5"/>
<text text-anchor="middle" x="3642.5" y="-30171.63" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="3642.5" y="-30156.63" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer_6</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="126,-24887.16 126,-27455.5 6465,-27455.5 6465,-24887.16 126,-24887.16"/>
<text text-anchor="middle" x="3295.5" y="-27440.3" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="3295.5" y="-27425.3" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer_7</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="113,-22155.83 113,-24724.16 6452,-24724.16 6452,-22155.83 113,-22155.83"/>
<text text-anchor="middle" x="3282.5" y="-24708.96" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="3282.5" y="-24693.96" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer_8</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="255,-19424.5 255,-21992.83 6594,-21992.83 6594,-19424.5 255,-19424.5"/>
<text text-anchor="middle" x="3424.5" y="-21977.63" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="3424.5" y="-21962.63" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer_9</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="375,-16693.16 375,-19261.5 6714,-19261.5 6714,-16693.16 375,-16693.16"/>
<text text-anchor="middle" x="3544.5" y="-19246.3" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="3544.5" y="-19231.3" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_10</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="145,-13961.83 145,-16530.16 6484,-16530.16 6484,-13961.83 145,-13961.83"/>
<text text-anchor="middle" x="3314.5" y="-16514.96" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="3314.5" y="-16499.96" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer_11</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="487,-11230.5 487,-13798.83 6826,-13798.83 6826,-11230.5 487,-11230.5"/>
<text text-anchor="middle" x="3656.5" y="-13783.63" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="3656.5" y="-13768.63" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer_12</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="18,-8499.17 18,-11067.5 6357,-11067.5 6357,-8499.17 18,-8499.17"/>
<text text-anchor="middle" x="3187.5" y="-11052.3" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="3187.5" y="-11037.3" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer_13</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="363,-5767.83 363,-8336.17 6702,-8336.17 6702,-5767.83 363,-5767.83"/>
<text text-anchor="middle" x="3532.5" y="-8320.97" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="3532.5" y="-8305.97" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer_14</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="8,-3036.5 8,-5604.83 6347,-5604.83 6347,-3036.5 8,-3036.5"/>
<text text-anchor="middle" x="3177.5" y="-5589.63" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="3177.5" y="-5574.63" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer_15</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="113,-305.17 113,-2873.5 6452,-2873.5 6452,-305.17 113,-305.17"/>
<text text-anchor="middle" x="3282.5" y="-2858.3" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="3282.5" y="-2843.3" font-family="Times,serif" font-size="14.00">EP=16 (16 GPUs)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="4068" cy="-44062.58" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="4068" y="-44081.38" font-family="Times,serif" font-size="14.00">Total Input</text>
<text text-anchor="middle" x="4068" y="-44066.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4068" y="-44051.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4068" y="-44036.38" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer_0_qkv -->
<g id="node2" class="node">
<title>layer_0_qkv</title>
<polygon fill="lightblue" stroke="black" points="4107.5,-43797.5 3698.5,-43797.5 3698.5,-43729.5 4107.5,-43729.5 4107.5,-43797.5"/>
<text text-anchor="middle" x="3903" y="-43782.3" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3903" y="-43767.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3903" y="-43752.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3903" y="-43737.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer_0_qkv -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_qkv</title>
<path fill="none" stroke="black" d="M3959.76,-44018.77C3959.76,-44018.77 3959.76,-43807.66 3959.76,-43807.66"/>
<polygon fill="black" stroke="black" points="3963.26,-43807.66 3959.76,-43797.66 3956.26,-43807.66 3963.26,-43807.66"/>
</g>
<!-- layer_0_add_norm1 -->
<g id="node5" class="node">
<title>layer_0_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4322,-42942.5 3960,-42942.5 3960,-42874.5 4322,-42874.5 4322,-42942.5"/>
<text text-anchor="middle" x="4141" y="-42927.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4141" y="-42912.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4141" y="-42897.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4141" y="-42882.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer_0_add_norm1 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;layer_0_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4214.75,-44022.85C4214.75,-44022.85 4214.75,-42952.6 4214.75,-42952.6"/>
<polygon fill="black" stroke="black" points="4218.25,-42952.6 4214.75,-42942.6 4211.25,-42952.6 4218.25,-42952.6"/>
<text text-anchor="middle" x="4263" y="-43474.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_0_attn -->
<g id="node3" class="node">
<title>layer_0_attn</title>
<polygon fill="lightblue" stroke="black" points="4089.5,-43512.5 3680.5,-43512.5 3680.5,-43444.5 4089.5,-43444.5 4089.5,-43512.5"/>
<text text-anchor="middle" x="3885" y="-43497.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3885" y="-43482.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3885" y="-43467.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3885" y="-43452.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_qkv&#45;&gt;layer_0_attn -->
<g id="edge2" class="edge">
<title>layer_0_qkv&#45;&gt;layer_0_attn</title>
<path fill="none" stroke="black" d="M3894,-43729.4C3894,-43729.4 3894,-43522.63 3894,-43522.63"/>
<polygon fill="black" stroke="black" points="3897.5,-43522.63 3894,-43512.63 3890.5,-43522.63 3897.5,-43522.63"/>
</g>
<!-- layer_0_proj -->
<g id="node4" class="node">
<title>layer_0_proj</title>
<polygon fill="lightblue" stroke="black" points="4104.5,-43227.5 3707.5,-43227.5 3707.5,-43159.5 4104.5,-43159.5 4104.5,-43227.5"/>
<text text-anchor="middle" x="3906" y="-43212.3" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3906" y="-43197.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3906" y="-43182.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3906" y="-43167.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_attn&#45;&gt;layer_0_proj -->
<g id="edge3" class="edge">
<title>layer_0_attn&#45;&gt;layer_0_proj</title>
<path fill="none" stroke="black" d="M3898.5,-43444.4C3898.5,-43444.4 3898.5,-43237.63 3898.5,-43237.63"/>
<polygon fill="black" stroke="black" points="3902,-43237.63 3898.5,-43227.63 3895,-43237.63 3902,-43237.63"/>
</g>
<!-- layer_0_proj&#45;&gt;layer_0_add_norm1 -->
<g id="edge4" class="edge">
<title>layer_0_proj&#45;&gt;layer_0_add_norm1</title>
<path fill="none" stroke="black" d="M4032.25,-43159.4C4032.25,-43159.4 4032.25,-42952.63 4032.25,-42952.63"/>
<polygon fill="black" stroke="black" points="4035.75,-42952.63 4032.25,-42942.63 4028.75,-42952.63 4035.75,-42952.63"/>
</g>
<!-- layer_0_gate -->
<g id="node6" class="node">
<title>layer_0_gate</title>
<polygon fill="yellow" stroke="black" points="4067.73,-42657.5 3490.71,-42657.5 3342.27,-42521.5 3919.29,-42521.5 4067.73,-42657.5"/>
<text text-anchor="middle" x="3705" y="-42608.3" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3705" y="-42593.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-42578.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3705" y="-42563.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_gate -->
<g id="edge6" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" d="M4013.93,-42874.36C4013.93,-42874.36 4013.93,-42667.62 4013.93,-42667.62"/>
<polygon fill="black" stroke="black" points="4017.43,-42667.62 4013.93,-42657.62 4010.43,-42667.62 4017.43,-42667.62"/>
</g>
<!-- layer_0_scatter -->
<g id="node7" class="node">
<title>layer_0_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3705" cy="-42242.41" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3705" y="-42261.21" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3705" y="-42246.21" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-42231.21" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-42216.21" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_scatter -->
<g id="edge7" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_scatter</title>
<path fill="none" stroke="black" d="M4164.68,-42874.15C4164.68,-42742.58 4164.68,-42278 4164.68,-42278 4164.68,-42278 3881.61,-42278 3881.61,-42278"/>
<polygon fill="black" stroke="black" points="3881.61,-42274.5 3871.61,-42278 3881.61,-42281.5 3881.61,-42274.5"/>
</g>
<!-- layer_0_add_norm2 -->
<g id="node25" class="node">
<title>layer_0_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4406,-41351.16 4044,-41351.16 4044,-41283.16 4406,-41283.16 4406,-41351.16"/>
<text text-anchor="middle" x="4225" y="-41335.96" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4225" y="-41320.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4225" y="-41305.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4225" y="-41290.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_add_norm2 -->
<g id="edge42" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4291.75,-42874.15C4291.75,-42874.15 4291.75,-41361.46 4291.75,-41361.46"/>
<polygon fill="black" stroke="black" points="4295.25,-41361.46 4291.75,-41351.46 4288.25,-41361.46 4295.25,-41361.46"/>
<text text-anchor="middle" x="6677" y="-42075.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_scatter -->
<g id="edge8" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3705,-42521.34C3705,-42521.34 3705,-42300.6 3705,-42300.6"/>
<polygon fill="black" stroke="black" points="3708.5,-42300.6 3705,-42290.6 3701.5,-42300.6 3708.5,-42300.6"/>
<text text-anchor="middle" x="3748.5" y="-42402.3" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_0_expert_0 -->
<g id="node8" class="node">
<title>layer_0_expert_0</title>
<polygon fill="lightblue" stroke="black" points="706.5,-41963.33 383.5,-41963.33 383.5,-41895.33 706.5,-41895.33 706.5,-41963.33"/>
<text text-anchor="middle" x="545" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="545" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="545" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="545" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_0 -->
<g id="edge9" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_0</title>
<path fill="none" stroke="black" d="M3538.45,-42278C2886.7,-42278 545,-42278 545,-42278 545,-42278 545,-41973.4 545,-41973.4"/>
<polygon fill="black" stroke="black" points="548.5,-41973.4 545,-41963.4 541.5,-41973.4 548.5,-41973.4"/>
<text text-anchor="middle" x="772" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_0</text>
</g>
<!-- layer_0_expert_1 -->
<g id="node10" class="node">
<title>layer_0_expert_1</title>
<polygon fill="lightblue" stroke="black" points="1101.5,-41963.33 778.5,-41963.33 778.5,-41895.33 1101.5,-41895.33 1101.5,-41963.33"/>
<text text-anchor="middle" x="940" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="940" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="940" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="940" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_1 -->
<g id="edge11" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_1</title>
<path fill="none" stroke="black" d="M3489.19,-42266C2838.45,-42266 940,-42266 940,-42266 940,-42266 940,-41973.46 940,-41973.46"/>
<polygon fill="black" stroke="black" points="943.5,-41973.46 940,-41963.46 936.5,-41973.46 943.5,-41973.46"/>
<text text-anchor="middle" x="1111" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_1</text>
</g>
<!-- layer_0_expert_2 -->
<g id="node11" class="node">
<title>layer_0_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1496.5,-41963.33 1173.5,-41963.33 1173.5,-41895.33 1496.5,-41895.33 1496.5,-41963.33"/>
<text text-anchor="middle" x="1335" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1335" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1335" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1335" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_2 -->
<g id="edge13" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_2</title>
<path fill="none" stroke="black" d="M3464.71,-42254C2862.19,-42254 1335,-42254 1335,-42254 1335,-42254 1335,-41973.46 1335,-41973.46"/>
<polygon fill="black" stroke="black" points="1338.5,-41973.46 1335,-41963.46 1331.5,-41973.46 1338.5,-41973.46"/>
<text text-anchor="middle" x="1394" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_2</text>
</g>
<!-- layer_0_expert_3 -->
<g id="node12" class="node">
<title>layer_0_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1891.5,-41963.33 1568.5,-41963.33 1568.5,-41895.33 1891.5,-41895.33 1891.5,-41963.33"/>
<text text-anchor="middle" x="1730" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1730" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1730" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1730" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_3 -->
<g id="edge15" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_3</title>
<path fill="none" stroke="black" d="M3457.33,-42242C2955.3,-42242 1865,-42242 1865,-42242 1865,-42242 1865,-41973.39 1865,-41973.39"/>
<polygon fill="black" stroke="black" points="1868.5,-41973.39 1865,-41963.39 1861.5,-41973.39 1868.5,-41973.39"/>
<text text-anchor="middle" x="2285" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_3</text>
</g>
<!-- layer_0_expert_4 -->
<g id="node13" class="node">
<title>layer_0_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2286.5,-41963.33 1963.5,-41963.33 1963.5,-41895.33 2286.5,-41895.33 2286.5,-41963.33"/>
<text text-anchor="middle" x="2125" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2125" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2125" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2125" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_4 -->
<g id="edge17" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_4</title>
<path fill="none" stroke="black" d="M3465.53,-42230C3056.51,-42230 2267,-42230 2267,-42230 2267,-42230 2267,-41973.53 2267,-41973.53"/>
<polygon fill="black" stroke="black" points="2270.5,-41973.53 2267,-41963.53 2263.5,-41973.53 2270.5,-41973.53"/>
<text text-anchor="middle" x="2804" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_4</text>
</g>
<!-- layer_0_expert_5 -->
<g id="node14" class="node">
<title>layer_0_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2681.5,-41963.33 2358.5,-41963.33 2358.5,-41895.33 2681.5,-41895.33 2681.5,-41963.33"/>
<text text-anchor="middle" x="2520" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2520" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2520" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2520" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_5 -->
<g id="edge19" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_5</title>
<path fill="none" stroke="black" d="M3491.78,-42218C3150.61,-42218 2520,-42218 2520,-42218 2520,-42218 2520,-41973.58 2520,-41973.58"/>
<polygon fill="black" stroke="black" points="2523.5,-41973.58 2520,-41963.58 2516.5,-41973.58 2523.5,-41973.58"/>
<text text-anchor="middle" x="3137" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_5</text>
</g>
<!-- layer_0_expert_6 -->
<g id="node15" class="node">
<title>layer_0_expert_6</title>
<polygon fill="lightblue" stroke="black" points="3076.5,-41963.33 2753.5,-41963.33 2753.5,-41895.33 3076.5,-41895.33 3076.5,-41963.33"/>
<text text-anchor="middle" x="2915" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2915" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2915" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2915" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_6 -->
<g id="edge21" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_6</title>
<path fill="none" stroke="black" d="M3543.23,-42206C3312.1,-42206 2915,-42206 2915,-42206 2915,-42206 2915,-41973.53 2915,-41973.53"/>
<polygon fill="black" stroke="black" points="2918.5,-41973.53 2915,-41963.53 2911.5,-41973.53 2918.5,-41973.53"/>
<text text-anchor="middle" x="3377" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_6</text>
</g>
<!-- layer_0_expert_7 -->
<g id="node16" class="node">
<title>layer_0_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3471.5,-41963.33 3148.5,-41963.33 3148.5,-41895.33 3471.5,-41895.33 3471.5,-41963.33"/>
<text text-anchor="middle" x="3310" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3310" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3310" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3310" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_7 -->
<g id="edge23" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_7</title>
<path fill="none" stroke="black" d="M3464.51,-42230.9C3464.51,-42230.9 3464.51,-41973.34 3464.51,-41973.34"/>
<polygon fill="black" stroke="black" points="3468.01,-41973.34 3464.51,-41963.34 3461.01,-41973.34 3468.01,-41973.34"/>
<text text-anchor="middle" x="3570" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_7</text>
</g>
<!-- layer_0_expert_8 -->
<g id="node17" class="node">
<title>layer_0_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3866.5,-41963.33 3543.5,-41963.33 3543.5,-41895.33 3866.5,-41895.33 3866.5,-41963.33"/>
<text text-anchor="middle" x="3705" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3705" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_8 -->
<g id="edge25" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_8</title>
<path fill="none" stroke="black" d="M3705,-42194.18C3705,-42194.18 3705,-41973.59 3705,-41973.59"/>
<polygon fill="black" stroke="black" points="3708.5,-41973.59 3705,-41963.59 3701.5,-41973.59 3708.5,-41973.59"/>
<text text-anchor="middle" x="3740" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_8</text>
</g>
<!-- layer_0_expert_9 -->
<g id="node18" class="node">
<title>layer_0_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4261.5,-41963.33 3938.5,-41963.33 3938.5,-41895.33 4261.5,-41895.33 4261.5,-41963.33"/>
<text text-anchor="middle" x="4100" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4100" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4100" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4100" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_9 -->
<g id="edge27" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_9</title>
<path fill="none" stroke="black" d="M3945.49,-42230.9C3945.49,-42230.9 3945.49,-41973.34 3945.49,-41973.34"/>
<polygon fill="black" stroke="black" points="3948.99,-41973.34 3945.49,-41963.34 3941.99,-41973.34 3948.99,-41973.34"/>
<text text-anchor="middle" x="4011" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_9</text>
</g>
<!-- layer_0_expert_10 -->
<g id="node19" class="node">
<title>layer_0_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4656.5,-41963.33 4333.5,-41963.33 4333.5,-41895.33 4656.5,-41895.33 4656.5,-41963.33"/>
<text text-anchor="middle" x="4495" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4495" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4495" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4495" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_10 -->
<g id="edge29" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_10</title>
<path fill="none" stroke="black" d="M3866.77,-42206C4097.9,-42206 4495,-42206 4495,-42206 4495,-42206 4495,-41973.53 4495,-41973.53"/>
<polygon fill="black" stroke="black" points="4498.5,-41973.53 4495,-41963.53 4491.5,-41973.53 4498.5,-41973.53"/>
<text text-anchor="middle" x="4348.5" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_10</text>
</g>
<!-- layer_0_expert_11 -->
<g id="node20" class="node">
<title>layer_0_expert_11</title>
<polygon fill="lightblue" stroke="black" points="5051.5,-41963.33 4728.5,-41963.33 4728.5,-41895.33 5051.5,-41895.33 5051.5,-41963.33"/>
<text text-anchor="middle" x="4890" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4890" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4890" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4890" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_11 -->
<g id="edge31" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_11</title>
<path fill="none" stroke="black" d="M3918.22,-42218C4259.39,-42218 4890,-42218 4890,-42218 4890,-42218 4890,-41973.58 4890,-41973.58"/>
<polygon fill="black" stroke="black" points="4893.5,-41973.58 4890,-41963.58 4886.5,-41973.58 4893.5,-41973.58"/>
<text text-anchor="middle" x="4716.5" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_11</text>
</g>
<!-- layer_0_expert_12 -->
<g id="node21" class="node">
<title>layer_0_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5446.5,-41963.33 5123.5,-41963.33 5123.5,-41895.33 5446.5,-41895.33 5446.5,-41963.33"/>
<text text-anchor="middle" x="5285" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5285" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5285" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5285" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_12 -->
<g id="edge33" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_12</title>
<path fill="none" stroke="black" d="M3944.11,-42230C4385.8,-42230 5285,-42230 5285,-42230 5285,-42230 5285,-41973.53 5285,-41973.53"/>
<polygon fill="black" stroke="black" points="5288.5,-41973.53 5285,-41963.53 5281.5,-41973.53 5288.5,-41973.53"/>
<text text-anchor="middle" x="5098.5" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_12</text>
</g>
<!-- layer_0_expert_13 -->
<g id="node22" class="node">
<title>layer_0_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5841.5,-41963.33 5518.5,-41963.33 5518.5,-41895.33 5841.5,-41895.33 5841.5,-41963.33"/>
<text text-anchor="middle" x="5680" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5680" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5680" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5680" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_13 -->
<g id="edge35" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_13</title>
<path fill="none" stroke="black" d="M3952.64,-42242C4482.83,-42242 5680,-42242 5680,-42242 5680,-42242 5680,-41973.39 5680,-41973.39"/>
<polygon fill="black" stroke="black" points="5683.5,-41973.39 5680,-41963.39 5676.5,-41973.39 5683.5,-41973.39"/>
<text text-anchor="middle" x="5486.5" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_13</text>
</g>
<!-- layer_0_expert_14 -->
<g id="node23" class="node">
<title>layer_0_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6236.5,-41963.33 5913.5,-41963.33 5913.5,-41895.33 6236.5,-41895.33 6236.5,-41963.33"/>
<text text-anchor="middle" x="6075" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="6075" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6075" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6075" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_14 -->
<g id="edge37" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_14</title>
<path fill="none" stroke="black" d="M3945.29,-42254C4547.81,-42254 6075,-42254 6075,-42254 6075,-42254 6075,-41973.46 6075,-41973.46"/>
<polygon fill="black" stroke="black" points="6078.5,-41973.46 6075,-41963.46 6071.5,-41973.46 6078.5,-41973.46"/>
<text text-anchor="middle" x="5818.5" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_14</text>
</g>
<!-- layer_0_expert_15 -->
<g id="node24" class="node">
<title>layer_0_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6631.5,-41963.33 6308.5,-41963.33 6308.5,-41895.33 6631.5,-41895.33 6631.5,-41963.33"/>
<text text-anchor="middle" x="6470" y="-41948.13" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6470" y="-41933.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6470" y="-41918.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6470" y="-41903.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_scatter&#45;&gt;layer_0_expert_15 -->
<g id="edge39" class="edge">
<title>layer_0_scatter&#45;&gt;layer_0_expert_15</title>
<path fill="none" stroke="black" d="M3920.81,-42266C4571.55,-42266 6470,-42266 6470,-42266 6470,-42266 6470,-41973.46 6470,-41973.46"/>
<polygon fill="black" stroke="black" points="6473.5,-41973.46 6470,-41963.46 6466.5,-41973.46 6473.5,-41973.46"/>
<text text-anchor="middle" x="6151.5" y="-42075.13" font-family="Times,serif" font-size="14.00">to_GPU_15</text>
</g>
<!-- layer_0_gather -->
<g id="node9" class="node">
<title>layer_0_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3705" cy="-41616.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3705" y="-41635.05" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3705" y="-41620.05" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-41605.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-41590.05" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_0_expert_0&#45;&gt;layer_0_gather -->
<g id="edge10" class="edge">
<title>layer_0_expert_0&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M592.5,-41895.2C592.5,-41807.3 592.5,-41580 592.5,-41580 592.5,-41580 3526.55,-41580 3526.55,-41580"/>
<polygon fill="black" stroke="black" points="3526.55,-41583.5 3536.55,-41580 3526.55,-41576.5 3526.55,-41583.5"/>
<text text-anchor="middle" x="936.5" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_0</text>
</g>
<!-- layer_0_gather&#45;&gt;layer_0_add_norm2 -->
<g id="edge41" class="edge">
<title>layer_0_gather&#45;&gt;layer_0_add_norm2</title>
<path fill="none" stroke="black" d="M3876.24,-41580.45C3876.24,-41501.02 3876.24,-41317 3876.24,-41317 3876.24,-41317 4033.98,-41317 4033.98,-41317"/>
<polygon fill="black" stroke="black" points="4033.98,-41320.5 4043.98,-41317 4033.98,-41313.5 4033.98,-41320.5"/>
</g>
<!-- layer_0_expert_1&#45;&gt;layer_0_gather -->
<g id="edge12" class="edge">
<title>layer_0_expert_1&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M987.5,-41895.13C987.5,-41809.37 987.5,-41592 987.5,-41592 987.5,-41592 3473.77,-41592 3473.77,-41592"/>
<polygon fill="black" stroke="black" points="3473.77,-41595.5 3483.77,-41592 3473.77,-41588.5 3473.77,-41595.5"/>
<text text-anchor="middle" x="1216.5" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_1</text>
</g>
<!-- layer_0_expert_2&#45;&gt;layer_0_gather -->
<g id="edge14" class="edge">
<title>layer_0_expert_2&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M1382.5,-41895.13C1382.5,-41811.6 1382.5,-41604 1382.5,-41604 1382.5,-41604 3447.28,-41604 3447.28,-41604"/>
<polygon fill="black" stroke="black" points="3447.28,-41607.5 3457.28,-41604 3447.28,-41600.5 3447.28,-41607.5"/>
<text text-anchor="middle" x="1615.5" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_2</text>
</g>
<!-- layer_0_expert_3&#45;&gt;layer_0_gather -->
<g id="edge16" class="edge">
<title>layer_0_expert_3&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M1824.5,-41895.2C1824.5,-41813.99 1824.5,-41616 1824.5,-41616 1824.5,-41616 3438.94,-41616 3438.94,-41616"/>
<polygon fill="black" stroke="black" points="3438.94,-41619.5 3448.94,-41616 3438.94,-41612.5 3438.94,-41619.5"/>
<text text-anchor="middle" x="2017.5" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_3</text>
</g>
<!-- layer_0_expert_4&#45;&gt;layer_0_gather -->
<g id="edge18" class="edge">
<title>layer_0_expert_4&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M2226.5,-41895.06C2226.5,-41816.08 2226.5,-41628 2226.5,-41628 2226.5,-41628 3446.7,-41628 3446.7,-41628"/>
<polygon fill="black" stroke="black" points="3446.7,-41631.5 3456.7,-41628 3446.7,-41624.5 3446.7,-41631.5"/>
<text text-anchor="middle" x="2427.5" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_4</text>
</g>
<!-- layer_0_expert_5&#45;&gt;layer_0_gather -->
<g id="edge20" class="edge">
<title>layer_0_expert_5&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M2567.5,-41895.29C2567.5,-41818.81 2567.5,-41640 2567.5,-41640 2567.5,-41640 3472.3,-41640 3472.3,-41640"/>
<polygon fill="black" stroke="black" points="3472.3,-41643.5 3482.3,-41640 3472.3,-41636.5 3472.3,-41643.5"/>
<text text-anchor="middle" x="2851.5" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_5</text>
</g>
<!-- layer_0_expert_6&#45;&gt;layer_0_gather -->
<g id="edge22" class="edge">
<title>layer_0_expert_6&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M2962.5,-41895.32C2962.5,-41821.27 2962.5,-41652 2962.5,-41652 2962.5,-41652 3523.72,-41652 3523.72,-41652"/>
<polygon fill="black" stroke="black" points="3523.72,-41655.5 3533.72,-41652 3523.72,-41648.5 3523.72,-41655.5"/>
<text text-anchor="middle" x="3131.5" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_6</text>
</g>
<!-- layer_0_expert_7&#45;&gt;layer_0_gather -->
<g id="edge24" class="edge">
<title>layer_0_expert_7&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M3460.26,-41895.23C3460.26,-41895.23 3460.26,-41640.5 3460.26,-41640.5"/>
<polygon fill="black" stroke="black" points="3463.76,-41640.5 3460.26,-41630.5 3456.76,-41640.5 3463.76,-41640.5"/>
<text text-anchor="middle" x="3469.5" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_7</text>
</g>
<!-- layer_0_expert_8&#45;&gt;layer_0_gather -->
<g id="edge26" class="edge">
<title>layer_0_expert_8&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M3705,-41895.23C3705,-41895.23 3705,-41674.33 3705,-41674.33"/>
<polygon fill="black" stroke="black" points="3708.5,-41674.33 3705,-41664.33 3701.5,-41674.34 3708.5,-41674.33"/>
<text text-anchor="middle" x="3749.5" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_8</text>
</g>
<!-- layer_0_expert_9&#45;&gt;layer_0_gather -->
<g id="edge28" class="edge">
<title>layer_0_expert_9&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M3949.74,-41895.23C3949.74,-41895.23 3949.74,-41640.5 3949.74,-41640.5"/>
<polygon fill="black" stroke="black" points="3953.24,-41640.5 3949.74,-41630.5 3946.24,-41640.5 3953.24,-41640.5"/>
<text text-anchor="middle" x="4029.5" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_9</text>
</g>
<!-- layer_0_expert_10&#45;&gt;layer_0_gather -->
<g id="edge30" class="edge">
<title>layer_0_expert_10&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M4369.75,-41895.08C4369.75,-41820.49 4369.75,-41650 4369.75,-41650 4369.75,-41650 3897.53,-41650 3897.53,-41650"/>
<polygon fill="black" stroke="black" points="3897.53,-41646.5 3887.53,-41650 3897.53,-41653.5 3897.53,-41646.5"/>
<text text-anchor="middle" x="4367" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_10</text>
</g>
<!-- layer_0_expert_11&#45;&gt;layer_0_gather -->
<g id="edge32" class="edge">
<title>layer_0_expert_11&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M4740,-41895.11C4740,-41817.73 4740,-41636 4740,-41636 4740,-41636 3948.56,-41636 3948.56,-41636"/>
<polygon fill="black" stroke="black" points="3948.56,-41632.5 3938.56,-41636 3948.56,-41639.5 3948.56,-41632.5"/>
<text text-anchor="middle" x="4626" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_11</text>
</g>
<!-- layer_0_expert_12&#45;&gt;layer_0_gather -->
<g id="edge34" class="edge">
<title>layer_0_expert_12&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M5135,-41895.08C5135,-41815.15 5135,-41623 5135,-41623 5135,-41623 3968.6,-41623 3968.6,-41623"/>
<polygon fill="black" stroke="black" points="3968.6,-41619.5 3958.6,-41623 3968.6,-41626.5 3968.6,-41619.5"/>
<text text-anchor="middle" x="4885" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_12</text>
</g>
<!-- layer_0_expert_13&#45;&gt;layer_0_gather -->
<g id="edge36" class="edge">
<title>layer_0_expert_13&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M5530,-41895.05C5530,-41812.41 5530,-41609 5530,-41609 5530,-41609 3968.28,-41609 3968.28,-41609"/>
<polygon fill="black" stroke="black" points="3968.28,-41605.5 3958.28,-41609 3968.28,-41612.5 3968.28,-41605.5"/>
<text text-anchor="middle" x="5395" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_13</text>
</g>
<!-- layer_0_expert_14&#45;&gt;layer_0_gather -->
<g id="edge38" class="edge">
<title>layer_0_expert_14&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M5925,-41895.12C5925,-41809.91 5925,-41595 5925,-41595 5925,-41595 3944.74,-41595 3944.74,-41595"/>
<polygon fill="black" stroke="black" points="3944.74,-41591.5 3934.74,-41595 3944.74,-41598.5 3944.74,-41591.5"/>
<text text-anchor="middle" x="5847" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_14</text>
</g>
<!-- layer_0_expert_15&#45;&gt;layer_0_gather -->
<g id="edge40" class="edge">
<title>layer_0_expert_15&#45;&gt;layer_0_gather</title>
<path fill="none" stroke="black" d="M6320,-41895.3C6320,-41807.65 6320,-41581 6320,-41581 6320,-41581 3889.36,-41581 3889.36,-41581"/>
<polygon fill="black" stroke="black" points="3889.36,-41577.5 3879.36,-41581 3889.36,-41584.5 3889.36,-41577.5"/>
<text text-anchor="middle" x="6271" y="-41776.13" font-family="Times,serif" font-size="14.00">from_GPU_15</text>
</g>
<!-- layer_1_qkv -->
<g id="node27" class="node">
<title>layer_1_qkv</title>
<polygon fill="lightblue" stroke="black" points="4200.5,-41066.16 3791.5,-41066.16 3791.5,-40998.16 4200.5,-40998.16 4200.5,-41066.16"/>
<text text-anchor="middle" x="3996" y="-41050.96" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3996" y="-41035.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3996" y="-41020.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3996" y="-41005.96" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- layer_0_add_norm2&#45;&gt;layer_1_qkv -->
<g id="edge43" class="edge">
<title>layer_0_add_norm2&#45;&gt;layer_1_qkv</title>
<path fill="none" stroke="black" d="M4122.25,-41283.07C4122.25,-41283.07 4122.25,-41076.3 4122.25,-41076.3"/>
<polygon fill="black" stroke="black" points="4125.75,-41076.3 4122.25,-41066.3 4118.75,-41076.3 4125.75,-41076.3"/>
</g>
<!-- layer_1_add_norm1 -->
<g id="node30" class="node">
<title>layer_1_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4417,-40211.16 4055,-40211.16 4055,-40143.16 4417,-40143.16 4417,-40211.16"/>
<text text-anchor="middle" x="4236" y="-40195.96" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4236" y="-40180.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4236" y="-40165.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4236" y="-40150.96" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- layer_0_add_norm2&#45;&gt;layer_1_add_norm1 -->
<g id="edge47" class="edge">
<title>layer_0_add_norm2&#45;&gt;layer_1_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4306.25,-41283.04C4306.25,-41283.04 4306.25,-40221.42 4306.25,-40221.42"/>
<polygon fill="black" stroke="black" points="4309.75,-40221.42 4306.25,-40211.42 4302.75,-40221.42 4309.75,-40221.42"/>
<text text-anchor="middle" x="4356" y="-40743.46" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_0_mha -->
<g id="node26" class="node">
<title>layer_0_mha</title>
<polygon fill="lightblue" stroke="black" points="2247.5,-43797.5 1838.5,-43797.5 1838.5,-43729.5 2247.5,-43729.5 2247.5,-43797.5"/>
<text text-anchor="middle" x="2043" y="-43782.3" font-family="Times,serif" font-size="14.00">MHA Layer 0</text>
<text text-anchor="middle" x="2043" y="-43767.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2043" y="-43752.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2043" y="-43737.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_attn -->
<g id="node28" class="node">
<title>layer_1_attn</title>
<polygon fill="lightblue" stroke="black" points="4182.5,-40781.16 3773.5,-40781.16 3773.5,-40713.16 4182.5,-40713.16 4182.5,-40781.16"/>
<text text-anchor="middle" x="3978" y="-40765.96" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3978" y="-40750.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3978" y="-40735.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3978" y="-40720.96" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- layer_1_qkv&#45;&gt;layer_1_attn -->
<g id="edge44" class="edge">
<title>layer_1_qkv&#45;&gt;layer_1_attn</title>
<path fill="none" stroke="black" d="M3987,-40998.07C3987,-40998.07 3987,-40791.3 3987,-40791.3"/>
<polygon fill="black" stroke="black" points="3990.5,-40791.3 3987,-40781.3 3983.5,-40791.3 3990.5,-40791.3"/>
</g>
<!-- layer_1_proj -->
<g id="node29" class="node">
<title>layer_1_proj</title>
<polygon fill="lightblue" stroke="black" points="4206.5,-40496.16 3809.5,-40496.16 3809.5,-40428.16 4206.5,-40428.16 4206.5,-40496.16"/>
<text text-anchor="middle" x="4008" y="-40480.96" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="4008" y="-40465.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4008" y="-40450.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4008" y="-40435.96" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- layer_1_attn&#45;&gt;layer_1_proj -->
<g id="edge45" class="edge">
<title>layer_1_attn&#45;&gt;layer_1_proj</title>
<path fill="none" stroke="black" d="M3996,-40713.07C3996,-40713.07 3996,-40506.3 3996,-40506.3"/>
<polygon fill="black" stroke="black" points="3999.5,-40506.3 3996,-40496.3 3992.5,-40506.3 3999.5,-40506.3"/>
</g>
<!-- layer_1_proj&#45;&gt;layer_1_add_norm1 -->
<g id="edge46" class="edge">
<title>layer_1_proj&#45;&gt;layer_1_add_norm1</title>
<path fill="none" stroke="black" d="M4130.75,-40428.07C4130.75,-40428.07 4130.75,-40221.3 4130.75,-40221.3"/>
<polygon fill="black" stroke="black" points="4134.25,-40221.3 4130.75,-40211.3 4127.25,-40221.3 4134.25,-40221.3"/>
</g>
<!-- layer_1_gate -->
<g id="node31" class="node">
<title>layer_1_gate</title>
<polygon fill="yellow" stroke="black" points="4162.73,-39926.16 3585.71,-39926.16 3437.27,-39790.16 4014.29,-39790.16 4162.73,-39926.16"/>
<text text-anchor="middle" x="3800" y="-39876.96" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3800" y="-39861.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3800" y="-39846.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3800" y="-39831.96" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_gate -->
<g id="edge48" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" d="M4108.93,-40143.02C4108.93,-40143.02 4108.93,-39936.28 4108.93,-39936.28"/>
<polygon fill="black" stroke="black" points="4112.43,-39936.28 4108.93,-39926.28 4105.43,-39936.28 4112.43,-39936.28"/>
</g>
<!-- layer_1_scatter -->
<g id="node32" class="node">
<title>layer_1_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3800" cy="-39511.08" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3800" y="-39529.88" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3800" y="-39514.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3800" y="-39499.88" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3800" y="-39484.88" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_scatter -->
<g id="edge49" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_scatter</title>
<path fill="none" stroke="black" d="M4259.68,-40142.83C4259.68,-40011.33 4259.68,-39547 4259.68,-39547 4259.68,-39547 3974.66,-39547 3974.66,-39547"/>
<polygon fill="black" stroke="black" points="3974.66,-39543.5 3964.66,-39547 3974.66,-39550.5 3974.66,-39543.5"/>
</g>
<!-- layer_1_add_norm2 -->
<g id="node50" class="node">
<title>layer_1_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4175,-38619.83 3813,-38619.83 3813,-38551.83 4175,-38551.83 4175,-38619.83"/>
<text text-anchor="middle" x="3994" y="-38604.63" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3994" y="-38589.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3994" y="-38574.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3994" y="-38559.63" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_add_norm2 -->
<g id="edge84" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4386.75,-40142.8C4386.75,-39911.01 4386.75,-38585 4386.75,-38585 4386.75,-38585 4185.14,-38585 4185.14,-38585"/>
<polygon fill="black" stroke="black" points="4185.14,-38581.5 4175.14,-38585 4185.14,-38588.5 4185.14,-38581.5"/>
<text text-anchor="middle" x="6772" y="-39343.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_scatter -->
<g id="edge50" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3800,-39790C3800,-39790 3800,-39569.27 3800,-39569.27"/>
<polygon fill="black" stroke="black" points="3803.5,-39569.27 3800,-39559.27 3796.5,-39569.27 3803.5,-39569.27"/>
<text text-anchor="middle" x="3843.5" y="-39670.96" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_1_expert_0 -->
<g id="node33" class="node">
<title>layer_1_expert_0</title>
<polygon fill="lightblue" stroke="black" points="801.5,-39232 478.5,-39232 478.5,-39164 801.5,-39164 801.5,-39232"/>
<text text-anchor="middle" x="640" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="640" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="640" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="640" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_0 -->
<g id="edge51" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_0</title>
<path fill="none" stroke="black" d="M3635.23,-39547C3006.02,-39547 790,-39547 790,-39547 790,-39547 790,-39242.1 790,-39242.1"/>
<polygon fill="black" stroke="black" points="793.5,-39242.1 790,-39232.1 786.5,-39242.1 793.5,-39242.1"/>
<text text-anchor="middle" x="864.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_16</text>
</g>
<!-- layer_1_expert_1 -->
<g id="node35" class="node">
<title>layer_1_expert_1</title>
<polygon fill="lightblue" stroke="black" points="1196.5,-39232 873.5,-39232 873.5,-39164 1196.5,-39164 1196.5,-39232"/>
<text text-anchor="middle" x="1035" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1035" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1035" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1035" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_1 -->
<g id="edge53" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_1</title>
<path fill="none" stroke="black" d="M3585.17,-39535C2959.89,-39535 1185,-39535 1185,-39535 1185,-39535 1185,-39242.16 1185,-39242.16"/>
<polygon fill="black" stroke="black" points="1188.5,-39242.16 1185,-39232.16 1181.5,-39242.16 1188.5,-39242.16"/>
<text text-anchor="middle" x="1205.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_17</text>
</g>
<!-- layer_1_expert_2 -->
<g id="node36" class="node">
<title>layer_1_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1591.5,-39232 1268.5,-39232 1268.5,-39164 1591.5,-39164 1591.5,-39232"/>
<text text-anchor="middle" x="1430" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1430" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1430" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1430" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_2 -->
<g id="edge55" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_2</title>
<path fill="none" stroke="black" d="M3560.05,-39523C2985.84,-39523 1580,-39523 1580,-39523 1580,-39523 1580,-39242.16 1580,-39242.16"/>
<polygon fill="black" stroke="black" points="1583.5,-39242.16 1580,-39232.16 1576.5,-39242.16 1583.5,-39242.16"/>
<text text-anchor="middle" x="1492.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_18</text>
</g>
<!-- layer_1_expert_3 -->
<g id="node37" class="node">
<title>layer_1_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1986.5,-39232 1663.5,-39232 1663.5,-39164 1986.5,-39164 1986.5,-39232"/>
<text text-anchor="middle" x="1825" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1825" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1825" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1825" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_3 -->
<g id="edge57" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_3</title>
<path fill="none" stroke="black" d="M3552.39,-39511C3031.9,-39511 1872,-39511 1872,-39511 1872,-39511 1872,-39242.09 1872,-39242.09"/>
<polygon fill="black" stroke="black" points="1875.5,-39242.09 1872,-39232.09 1868.5,-39242.09 1875.5,-39242.09"/>
<text text-anchor="middle" x="2365.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_19</text>
</g>
<!-- layer_1_expert_4 -->
<g id="node38" class="node">
<title>layer_1_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2381.5,-39232 2058.5,-39232 2058.5,-39164 2381.5,-39164 2381.5,-39232"/>
<text text-anchor="middle" x="2220" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2220" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2220" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2220" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_4 -->
<g id="edge59" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_4</title>
<path fill="none" stroke="black" d="M3560.25,-39499C3153.05,-39499 2370,-39499 2370,-39499 2370,-39499 2370,-39242.23 2370,-39242.23"/>
<polygon fill="black" stroke="black" points="2373.5,-39242.23 2370,-39232.23 2366.5,-39242.23 2373.5,-39242.23"/>
<text text-anchor="middle" x="2879.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_20</text>
</g>
<!-- layer_1_expert_5 -->
<g id="node39" class="node">
<title>layer_1_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2776.5,-39232 2453.5,-39232 2453.5,-39164 2776.5,-39164 2776.5,-39232"/>
<text text-anchor="middle" x="2615" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2615" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2615" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2615" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_5 -->
<g id="edge61" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_5</title>
<path fill="none" stroke="black" d="M3585.55,-39487C3282.39,-39487 2765,-39487 2765,-39487 2765,-39487 2765,-39242 2765,-39242"/>
<polygon fill="black" stroke="black" points="2768.5,-39242 2765,-39232 2761.5,-39242 2768.5,-39242"/>
<text text-anchor="middle" x="3214.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_21</text>
</g>
<!-- layer_1_expert_6 -->
<g id="node40" class="node">
<title>layer_1_expert_6</title>
<polygon fill="lightblue" stroke="black" points="3171.5,-39232 2848.5,-39232 2848.5,-39164 3171.5,-39164 3171.5,-39232"/>
<text text-anchor="middle" x="3010" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3010" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3010" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3010" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_6 -->
<g id="edge63" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_6</title>
<path fill="none" stroke="black" d="M3636.02,-39475C3446.39,-39475 3160,-39475 3160,-39475 3160,-39475 3160,-39242.24 3160,-39242.24"/>
<polygon fill="black" stroke="black" points="3163.5,-39242.24 3160,-39232.24 3156.5,-39242.24 3163.5,-39242.24"/>
<text text-anchor="middle" x="3460.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_22</text>
</g>
<!-- layer_1_expert_7 -->
<g id="node41" class="node">
<title>layer_1_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3566.5,-39232 3243.5,-39232 3243.5,-39164 3566.5,-39164 3566.5,-39232"/>
<text text-anchor="middle" x="3405" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3405" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3405" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3405" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_7 -->
<g id="edge65" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_7</title>
<path fill="none" stroke="black" d="M3559.51,-39499.56C3559.51,-39499.56 3559.51,-39242 3559.51,-39242"/>
<polygon fill="black" stroke="black" points="3563.01,-39242 3559.51,-39232 3556.01,-39242 3563.01,-39242"/>
<text text-anchor="middle" x="3661.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_23</text>
</g>
<!-- layer_1_expert_8 -->
<g id="node42" class="node">
<title>layer_1_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3961.5,-39232 3638.5,-39232 3638.5,-39164 3961.5,-39164 3961.5,-39232"/>
<text text-anchor="middle" x="3800" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3800" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3800" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3800" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 24</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_8 -->
<g id="edge67" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_8</title>
<path fill="none" stroke="black" d="M3800,-39462.85C3800,-39462.85 3800,-39242.26 3800,-39242.26"/>
<polygon fill="black" stroke="black" points="3803.5,-39242.26 3800,-39232.26 3796.5,-39242.26 3803.5,-39242.26"/>
<text text-anchor="middle" x="3839.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_24</text>
</g>
<!-- layer_1_expert_9 -->
<g id="node43" class="node">
<title>layer_1_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4356.5,-39232 4033.5,-39232 4033.5,-39164 4356.5,-39164 4356.5,-39232"/>
<text text-anchor="middle" x="4195" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4195" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4195" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4195" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 25</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_9 -->
<g id="edge69" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_9</title>
<path fill="none" stroke="black" d="M4040.49,-39499.56C4040.49,-39499.56 4040.49,-39242 4040.49,-39242"/>
<polygon fill="black" stroke="black" points="4043.99,-39242 4040.49,-39232 4036.99,-39242 4043.99,-39242"/>
<text text-anchor="middle" x="4115.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_25</text>
</g>
<!-- layer_1_expert_10 -->
<g id="node44" class="node">
<title>layer_1_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4751.5,-39232 4428.5,-39232 4428.5,-39164 4751.5,-39164 4751.5,-39232"/>
<text text-anchor="middle" x="4590" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4590" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4590" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4590" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 26</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_10 -->
<g id="edge71" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_10</title>
<path fill="none" stroke="black" d="M3963.86,-39475C4182.52,-39475 4542.5,-39475 4542.5,-39475 4542.5,-39475 4542.5,-39242.24 4542.5,-39242.24"/>
<polygon fill="black" stroke="black" points="4546,-39242.24 4542.5,-39232.24 4539,-39242.24 4546,-39242.24"/>
<text text-anchor="middle" x="4390.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_26</text>
</g>
<!-- layer_1_expert_11 -->
<g id="node45" class="node">
<title>layer_1_expert_11</title>
<polygon fill="lightblue" stroke="black" points="5146.5,-39232 4823.5,-39232 4823.5,-39164 5146.5,-39164 5146.5,-39232"/>
<text text-anchor="middle" x="4985" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4985" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4985" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4985" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 27</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_11 -->
<g id="edge73" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_11</title>
<path fill="none" stroke="black" d="M4014.29,-39487C4343.86,-39487 4937.5,-39487 4937.5,-39487 4937.5,-39487 4937.5,-39242 4937.5,-39242"/>
<polygon fill="black" stroke="black" points="4941,-39242 4937.5,-39232 4934,-39242 4941,-39242"/>
<text text-anchor="middle" x="4845.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_27</text>
</g>
<!-- layer_1_expert_12 -->
<g id="node46" class="node">
<title>layer_1_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5541.5,-39232 5218.5,-39232 5218.5,-39164 5541.5,-39164 5541.5,-39232"/>
<text text-anchor="middle" x="5380" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5380" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5380" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5380" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 28</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_12 -->
<g id="edge75" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_12</title>
<path fill="none" stroke="black" d="M4039.87,-39499C4471.03,-39499 5332.5,-39499 5332.5,-39499 5332.5,-39499 5332.5,-39242.23 5332.5,-39242.23"/>
<polygon fill="black" stroke="black" points="5336,-39242.23 5332.5,-39232.23 5329,-39242.23 5336,-39242.23"/>
<text text-anchor="middle" x="5210.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_28</text>
</g>
<!-- layer_1_expert_13 -->
<g id="node47" class="node">
<title>layer_1_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5936.5,-39232 5613.5,-39232 5613.5,-39164 5936.5,-39164 5936.5,-39232"/>
<text text-anchor="middle" x="5775" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5775" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5775" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5775" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 29</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_13 -->
<g id="edge77" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_13</title>
<path fill="none" stroke="black" d="M4047.55,-39511C4567.9,-39511 5727.5,-39511 5727.5,-39511 5727.5,-39511 5727.5,-39242.09 5727.5,-39242.09"/>
<polygon fill="black" stroke="black" points="5731,-39242.09 5727.5,-39232.09 5724,-39242.09 5731,-39242.09"/>
<text text-anchor="middle" x="5590.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_29</text>
</g>
<!-- layer_1_expert_14 -->
<g id="node48" class="node">
<title>layer_1_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6331.5,-39232 6008.5,-39232 6008.5,-39164 6331.5,-39164 6331.5,-39232"/>
<text text-anchor="middle" x="6170" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="6170" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6170" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6170" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 30</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_14 -->
<g id="edge79" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_14</title>
<path fill="none" stroke="black" d="M4039.8,-39523C4633.2,-39523 6122.5,-39523 6122.5,-39523 6122.5,-39523 6122.5,-39242.16 6122.5,-39242.16"/>
<polygon fill="black" stroke="black" points="6126,-39242.16 6122.5,-39232.16 6119,-39242.16 6126,-39242.16"/>
<text text-anchor="middle" x="5918.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_30</text>
</g>
<!-- layer_1_expert_15 -->
<g id="node49" class="node">
<title>layer_1_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6726.5,-39232 6403.5,-39232 6403.5,-39164 6726.5,-39164 6726.5,-39232"/>
<text text-anchor="middle" x="6565" y="-39216.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6565" y="-39201.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6565" y="-39186.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6565" y="-39171.8" font-family="Times,serif" font-size="14.00">GPU: 31</text>
</g>
<!-- layer_1_scatter&#45;&gt;layer_1_expert_15 -->
<g id="edge81" class="edge">
<title>layer_1_scatter&#45;&gt;layer_1_expert_15</title>
<path fill="none" stroke="black" d="M4014.94,-39535C4657.16,-39535 6517.5,-39535 6517.5,-39535 6517.5,-39535 6517.5,-39242.16 6517.5,-39242.16"/>
<polygon fill="black" stroke="black" points="6521,-39242.16 6517.5,-39232.16 6514,-39242.16 6521,-39242.16"/>
<text text-anchor="middle" x="6246.5" y="-39343.8" font-family="Times,serif" font-size="14.00">to_GPU_31</text>
</g>
<!-- layer_1_gather -->
<g id="node34" class="node">
<title>layer_1_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3800" cy="-38884.91" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3800" y="-38903.71" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3800" y="-38888.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3800" y="-38873.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3800" y="-38858.71" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_1_expert_0&#45;&gt;layer_1_gather -->
<g id="edge52" class="edge">
<title>layer_1_expert_0&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M721.5,-39163.8C721.5,-39075.73 721.5,-38848 721.5,-38848 721.5,-38848 3625.85,-38848 3625.85,-38848"/>
<polygon fill="black" stroke="black" points="3625.85,-38851.5 3635.85,-38848 3625.85,-38844.5 3625.85,-38851.5"/>
<text text-anchor="middle" x="914" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_16</text>
</g>
<!-- layer_1_gather&#45;&gt;layer_1_add_norm2 -->
<g id="edge83" class="edge">
<title>layer_1_gather&#45;&gt;layer_1_add_norm2</title>
<path fill="none" stroke="black" d="M3934.49,-38843.95C3934.49,-38843.95 3934.49,-38630.27 3934.49,-38630.27"/>
<polygon fill="black" stroke="black" points="3937.99,-38630.27 3934.49,-38620.27 3930.99,-38630.27 3937.99,-38630.27"/>
</g>
<!-- layer_1_expert_1&#45;&gt;layer_1_gather -->
<g id="edge54" class="edge">
<title>layer_1_expert_1&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M1116.5,-39163.73C1116.5,-39077.8 1116.5,-38860 1116.5,-38860 1116.5,-38860 3570.97,-38860 3570.97,-38860"/>
<polygon fill="black" stroke="black" points="3570.97,-38863.5 3580.97,-38860 3570.97,-38856.5 3570.97,-38863.5"/>
<text text-anchor="middle" x="1314" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_17</text>
</g>
<!-- layer_1_expert_2&#45;&gt;layer_1_gather -->
<g id="edge56" class="edge">
<title>layer_1_expert_2&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M1511.5,-39163.72C1511.5,-39080.03 1511.5,-38872 1511.5,-38872 1511.5,-38872 3543.19,-38872 3543.19,-38872"/>
<polygon fill="black" stroke="black" points="3543.19,-38875.5 3553.19,-38872 3543.19,-38868.5 3543.19,-38875.5"/>
<text text-anchor="middle" x="1719" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_18</text>
</g>
<!-- layer_1_expert_3&#45;&gt;layer_1_gather -->
<g id="edge58" class="edge">
<title>layer_1_expert_3&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M1843.5,-39163.79C1843.5,-39082.41 1843.5,-38884 1843.5,-38884 1843.5,-38884 3533.97,-38884 3533.97,-38884"/>
<polygon fill="black" stroke="black" points="3533.97,-38887.5 3543.97,-38884 3533.97,-38880.5 3533.97,-38887.5"/>
<text text-anchor="middle" x="2135" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_19</text>
</g>
<!-- layer_1_expert_4&#45;&gt;layer_1_gather -->
<g id="edge60" class="edge">
<title>layer_1_expert_4&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M2301.5,-39163.94C2301.5,-39084.96 2301.5,-38896 2301.5,-38896 2301.5,-38896 3540.87,-38896 3540.87,-38896"/>
<polygon fill="black" stroke="black" points="3540.87,-38899.5 3550.87,-38896 3540.87,-38892.5 3540.87,-38899.5"/>
<text text-anchor="middle" x="2571" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_20</text>
</g>
<!-- layer_1_expert_5&#45;&gt;layer_1_gather -->
<g id="edge62" class="edge">
<title>layer_1_expert_5&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M2696.5,-39163.88C2696.5,-39087.22 2696.5,-38908 2696.5,-38908 2696.5,-38908 3565.36,-38908 3565.36,-38908"/>
<polygon fill="black" stroke="black" points="3565.36,-38911.5 3575.36,-38908 3565.36,-38904.5 3565.36,-38911.5"/>
<text text-anchor="middle" x="2856" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_21</text>
</g>
<!-- layer_1_expert_6&#45;&gt;layer_1_gather -->
<g id="edge64" class="edge">
<title>layer_1_expert_6&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M3091.5,-39163.91C3091.5,-39089.68 3091.5,-38920 3091.5,-38920 3091.5,-38920 3614.87,-38920 3614.87,-38920"/>
<polygon fill="black" stroke="black" points="3614.87,-38923.5 3624.87,-38920 3614.87,-38916.5 3614.87,-38923.5"/>
<text text-anchor="middle" x="3224" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_22</text>
</g>
<!-- layer_1_expert_7&#45;&gt;layer_1_gather -->
<g id="edge66" class="edge">
<title>layer_1_expert_7&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M3555.26,-39163.89C3555.26,-39163.89 3555.26,-38909.17 3555.26,-38909.17"/>
<polygon fill="black" stroke="black" points="3558.76,-38909.17 3555.26,-38899.17 3551.76,-38909.17 3558.76,-38909.17"/>
<text text-anchor="middle" x="3564" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_23</text>
</g>
<!-- layer_1_expert_8&#45;&gt;layer_1_gather -->
<g id="edge68" class="edge">
<title>layer_1_expert_8&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M3800,-39163.89C3800,-39163.89 3800,-38943 3800,-38943"/>
<polygon fill="black" stroke="black" points="3803.5,-38943 3800,-38933 3796.5,-38943 3803.5,-38943"/>
<text text-anchor="middle" x="3849" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_24</text>
</g>
<!-- layer_1_expert_9&#45;&gt;layer_1_gather -->
<g id="edge70" class="edge">
<title>layer_1_expert_9&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M4044.74,-39163.89C4044.74,-39163.89 4044.74,-38909.17 4044.74,-38909.17"/>
<polygon fill="black" stroke="black" points="4048.24,-38909.17 4044.74,-38899.17 4041.24,-38909.17 4048.24,-38909.17"/>
<text text-anchor="middle" x="4134" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_25</text>
</g>
<!-- layer_1_expert_10&#45;&gt;layer_1_gather -->
<g id="edge72" class="edge">
<title>layer_1_expert_10&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M4474,-39163.79C4474,-39089.29 4474,-38919 4474,-38919 4474,-38919 3990.62,-38919 3990.62,-38919"/>
<polygon fill="black" stroke="black" points="3990.62,-38915.5 3980.62,-38919 3990.62,-38922.5 3990.62,-38915.5"/>
<text text-anchor="middle" x="4529" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_26</text>
</g>
<!-- layer_1_expert_11&#45;&gt;layer_1_gather -->
<g id="edge74" class="edge">
<title>layer_1_expert_11&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M4869,-39163.81C4869,-39086.52 4869,-38905 4869,-38905 4869,-38905 4042.62,-38905 4042.62,-38905"/>
<polygon fill="black" stroke="black" points="4042.62,-38901.5 4032.62,-38905 4042.62,-38908.5 4042.62,-38901.5"/>
<text text-anchor="middle" x="4869" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_27</text>
</g>
<!-- layer_1_expert_12&#45;&gt;layer_1_gather -->
<g id="edge76" class="edge">
<title>layer_1_expert_12&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M5264,-39163.97C5264,-39084.04 5264,-38891 5264,-38891 5264,-38891 4064.17,-38891 4064.17,-38891"/>
<polygon fill="black" stroke="black" points="4064.17,-38887.5 4054.17,-38891 4064.17,-38894.5 4064.17,-38887.5"/>
<text text-anchor="middle" x="5237" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_28</text>
</g>
<!-- layer_1_expert_13&#45;&gt;layer_1_gather -->
<g id="edge78" class="edge">
<title>layer_1_expert_13&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M5659,-39163.75C5659,-39081.2 5659,-38878 5659,-38878 5659,-38878 4063.62,-38878 4063.62,-38878"/>
<polygon fill="black" stroke="black" points="4063.62,-38874.5 4053.62,-38878 4063.62,-38881.5 4063.62,-38874.5"/>
<text text-anchor="middle" x="5618" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_29</text>
</g>
<!-- layer_1_expert_14&#45;&gt;layer_1_gather -->
<g id="edge80" class="edge">
<title>layer_1_expert_14&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M6054,-39163.82C6054,-39078.7 6054,-38864 6054,-38864 6054,-38864 4040.62,-38864 4040.62,-38864"/>
<polygon fill="black" stroke="black" points="4040.62,-38860.5 4030.62,-38864 4040.62,-38867.5 4040.62,-38860.5"/>
<text text-anchor="middle" x="6109" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_30</text>
</g>
<!-- layer_1_expert_15&#45;&gt;layer_1_gather -->
<g id="edge82" class="edge">
<title>layer_1_expert_15&#45;&gt;layer_1_gather</title>
<path fill="none" stroke="black" d="M6449,-39163.99C6449,-39076.43 6449,-38850 6449,-38850 6449,-38850 3986.12,-38850 3986.12,-38850"/>
<polygon fill="black" stroke="black" points="3986.12,-38846.5 3976.12,-38850 3986.12,-38853.5 3986.12,-38846.5"/>
<text text-anchor="middle" x="6449" y="-39044.8" font-family="Times,serif" font-size="14.00">from_GPU_31</text>
</g>
<!-- layer_2_qkv -->
<g id="node52" class="node">
<title>layer_2_qkv</title>
<polygon fill="lightblue" stroke="black" points="3969.5,-38334.83 3560.5,-38334.83 3560.5,-38266.83 3969.5,-38266.83 3969.5,-38334.83"/>
<text text-anchor="middle" x="3765" y="-38319.63" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3765" y="-38304.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3765" y="-38289.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3765" y="-38274.63" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- layer_1_add_norm2&#45;&gt;layer_2_qkv -->
<g id="edge85" class="edge">
<title>layer_1_add_norm2&#45;&gt;layer_2_qkv</title>
<path fill="none" stroke="black" d="M3891.25,-38551.73C3891.25,-38551.73 3891.25,-38344.96 3891.25,-38344.96"/>
<polygon fill="black" stroke="black" points="3894.75,-38344.96 3891.25,-38334.96 3887.75,-38344.96 3894.75,-38344.96"/>
</g>
<!-- layer_2_add_norm1 -->
<g id="node55" class="node">
<title>layer_2_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4185,-37479.83 3823,-37479.83 3823,-37411.83 4185,-37411.83 4185,-37479.83"/>
<text text-anchor="middle" x="4004" y="-37464.63" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4004" y="-37449.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4004" y="-37434.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4004" y="-37419.63" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- layer_1_add_norm2&#45;&gt;layer_2_add_norm1 -->
<g id="edge89" class="edge">
<title>layer_1_add_norm2&#45;&gt;layer_2_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4072.25,-38551.71C4072.25,-38551.71 4072.25,-37490.09 4072.25,-37490.09"/>
<polygon fill="black" stroke="black" points="4075.75,-37490.09 4072.25,-37480.09 4068.75,-37490.09 4075.75,-37490.09"/>
<text text-anchor="middle" x="4125" y="-38012.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_1_mha -->
<g id="node51" class="node">
<title>layer_1_mha</title>
<polygon fill="lightblue" stroke="black" points="2166.5,-41066.16 1757.5,-41066.16 1757.5,-40998.16 2166.5,-40998.16 2166.5,-41066.16"/>
<text text-anchor="middle" x="1962" y="-41050.96" font-family="Times,serif" font-size="14.00">MHA Layer 1</text>
<text text-anchor="middle" x="1962" y="-41035.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1962" y="-41020.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1962" y="-41005.96" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- layer_2_attn -->
<g id="node53" class="node">
<title>layer_2_attn</title>
<polygon fill="lightblue" stroke="black" points="3951.5,-38049.83 3542.5,-38049.83 3542.5,-37981.83 3951.5,-37981.83 3951.5,-38049.83"/>
<text text-anchor="middle" x="3747" y="-38034.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3747" y="-38019.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3747" y="-38004.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3747" y="-37989.63" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- layer_2_qkv&#45;&gt;layer_2_attn -->
<g id="edge86" class="edge">
<title>layer_2_qkv&#45;&gt;layer_2_attn</title>
<path fill="none" stroke="black" d="M3756,-38266.73C3756,-38266.73 3756,-38059.96 3756,-38059.96"/>
<polygon fill="black" stroke="black" points="3759.5,-38059.96 3756,-38049.96 3752.5,-38059.96 3759.5,-38059.96"/>
</g>
<!-- layer_2_proj -->
<g id="node54" class="node">
<title>layer_2_proj</title>
<polygon fill="lightblue" stroke="black" points="3966.5,-37764.83 3569.5,-37764.83 3569.5,-37696.83 3966.5,-37696.83 3966.5,-37764.83"/>
<text text-anchor="middle" x="3768" y="-37749.63" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3768" y="-37734.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3768" y="-37719.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3768" y="-37704.63" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- layer_2_attn&#45;&gt;layer_2_proj -->
<g id="edge87" class="edge">
<title>layer_2_attn&#45;&gt;layer_2_proj</title>
<path fill="none" stroke="black" d="M3760.5,-37981.73C3760.5,-37981.73 3760.5,-37774.96 3760.5,-37774.96"/>
<polygon fill="black" stroke="black" points="3764,-37774.96 3760.5,-37764.96 3757,-37774.96 3764,-37774.96"/>
</g>
<!-- layer_2_proj&#45;&gt;layer_2_add_norm1 -->
<g id="edge88" class="edge">
<title>layer_2_proj&#45;&gt;layer_2_add_norm1</title>
<path fill="none" stroke="black" d="M3894.75,-37696.73C3894.75,-37696.73 3894.75,-37489.96 3894.75,-37489.96"/>
<polygon fill="black" stroke="black" points="3898.25,-37489.96 3894.75,-37479.96 3891.25,-37489.96 3898.25,-37489.96"/>
</g>
<!-- layer_2_gate -->
<g id="node56" class="node">
<title>layer_2_gate</title>
<polygon fill="yellow" stroke="black" points="3930.73,-37194.83 3353.71,-37194.83 3205.27,-37058.83 3782.29,-37058.83 3930.73,-37194.83"/>
<text text-anchor="middle" x="3568" y="-37145.63" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3568" y="-37130.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3568" y="-37115.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3568" y="-37100.63" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_gate -->
<g id="edge90" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" d="M3876.93,-37411.69C3876.93,-37411.69 3876.93,-37204.95 3876.93,-37204.95"/>
<polygon fill="black" stroke="black" points="3880.43,-37204.95 3876.93,-37194.95 3873.43,-37204.95 3880.43,-37204.95"/>
</g>
<!-- layer_2_scatter -->
<g id="node57" class="node">
<title>layer_2_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3568" cy="-36779.75" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3568" y="-36798.55" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3568" y="-36783.55" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3568" y="-36768.55" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3568" y="-36753.55" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_scatter -->
<g id="edge91" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_scatter</title>
<path fill="none" stroke="black" d="M4027.68,-37411.47C4027.68,-37279.83 4027.68,-36815 4027.68,-36815 4027.68,-36815 3746.56,-36815 3746.56,-36815"/>
<polygon fill="black" stroke="black" points="3746.56,-36811.5 3736.56,-36815 3746.56,-36818.5 3746.56,-36811.5"/>
</g>
<!-- layer_2_add_norm2 -->
<g id="node75" class="node">
<title>layer_2_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4278,-35888.5 3916,-35888.5 3916,-35820.5 4278,-35820.5 4278,-35888.5"/>
<text text-anchor="middle" x="4097" y="-35873.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4097" y="-35858.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4097" y="-35843.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4097" y="-35828.3" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_add_norm2 -->
<g id="edge126" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4154.75,-37411.48C4154.75,-37411.48 4154.75,-35898.79 4154.75,-35898.79"/>
<polygon fill="black" stroke="black" points="4158.25,-35898.79 4154.75,-35888.79 4151.25,-35898.79 4158.25,-35898.79"/>
<text text-anchor="middle" x="6540" y="-36612.46" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_scatter -->
<g id="edge92" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3568,-37058.67C3568,-37058.67 3568,-36837.93 3568,-36837.93"/>
<polygon fill="black" stroke="black" points="3571.5,-36837.93 3568,-36827.93 3564.5,-36837.93 3571.5,-36837.93"/>
<text text-anchor="middle" x="3611.5" y="-36939.63" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_2_expert_0 -->
<g id="node58" class="node">
<title>layer_2_expert_0</title>
<polygon fill="lightblue" stroke="black" points="569.5,-36500.66 246.5,-36500.66 246.5,-36432.66 569.5,-36432.66 569.5,-36500.66"/>
<text text-anchor="middle" x="408" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="408" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="408" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="408" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_0 -->
<g id="edge93" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_0</title>
<path fill="none" stroke="black" d="M3399.46,-36815C2760.59,-36815 524,-36815 524,-36815 524,-36815 524,-36510.7 524,-36510.7"/>
<polygon fill="black" stroke="black" points="527.5,-36510.7 524,-36500.7 520.5,-36510.7 527.5,-36510.7"/>
<text text-anchor="middle" x="701.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_32</text>
</g>
<!-- layer_2_expert_1 -->
<g id="node60" class="node">
<title>layer_2_expert_1</title>
<polygon fill="lightblue" stroke="black" points="964.5,-36500.66 641.5,-36500.66 641.5,-36432.66 964.5,-36432.66 964.5,-36500.66"/>
<text text-anchor="middle" x="803" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="803" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="803" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="803" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 33</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_1 -->
<g id="edge95" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_1</title>
<path fill="none" stroke="black" d="M3351.22,-36803C2718.56,-36803 919,-36803 919,-36803 919,-36803 919,-36510.76 919,-36510.76"/>
<polygon fill="black" stroke="black" points="922.5,-36510.76 919,-36500.76 915.5,-36510.76 922.5,-36510.76"/>
<text text-anchor="middle" x="1111.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_33</text>
</g>
<!-- layer_2_expert_2 -->
<g id="node61" class="node">
<title>layer_2_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1359.5,-36500.66 1036.5,-36500.66 1036.5,-36432.66 1359.5,-36432.66 1359.5,-36500.66"/>
<text text-anchor="middle" x="1198" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1198" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1198" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1198" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 34</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_2 -->
<g id="edge97" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_2</title>
<path fill="none" stroke="black" d="M3327.32,-36791C2746.19,-36791 1314,-36791 1314,-36791 1314,-36791 1314,-36510.76 1314,-36510.76"/>
<polygon fill="black" stroke="black" points="1317.5,-36510.76 1314,-36500.76 1310.5,-36510.76 1317.5,-36510.76"/>
<text text-anchor="middle" x="1506.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_34</text>
</g>
<!-- layer_2_expert_3 -->
<g id="node62" class="node">
<title>layer_2_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1754.5,-36500.66 1431.5,-36500.66 1431.5,-36432.66 1754.5,-36432.66 1754.5,-36500.66"/>
<text text-anchor="middle" x="1593" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1593" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1593" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1593" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 35</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_3 -->
<g id="edge99" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_3</title>
<path fill="none" stroke="black" d="M3320.26,-36779C2818.1,-36779 1727.5,-36779 1727.5,-36779 1727.5,-36779 1727.5,-36510.68 1727.5,-36510.68"/>
<polygon fill="black" stroke="black" points="1731,-36510.68 1727.5,-36500.68 1724,-36510.68 1731,-36510.68"/>
<text text-anchor="middle" x="1781.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_35</text>
</g>
<!-- layer_2_expert_4 -->
<g id="node63" class="node">
<title>layer_2_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2149.5,-36500.66 1826.5,-36500.66 1826.5,-36432.66 2149.5,-36432.66 2149.5,-36500.66"/>
<text text-anchor="middle" x="1988" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1988" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1988" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1988" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 36</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_4 -->
<g id="edge101" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_4</title>
<path fill="none" stroke="black" d="M3329.25,-36767C2920.32,-36767 2129.5,-36767 2129.5,-36767 2129.5,-36767 2129.5,-36510.82 2129.5,-36510.82"/>
<polygon fill="black" stroke="black" points="2133,-36510.82 2129.5,-36500.82 2126,-36510.82 2133,-36510.82"/>
<text text-anchor="middle" x="2087.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_36</text>
</g>
<!-- layer_2_expert_5 -->
<g id="node64" class="node">
<title>layer_2_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2544.5,-36500.66 2221.5,-36500.66 2221.5,-36432.66 2544.5,-36432.66 2544.5,-36500.66"/>
<text text-anchor="middle" x="2383" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2383" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2383" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2383" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 37</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_5 -->
<g id="edge103" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_5</title>
<path fill="none" stroke="black" d="M3355.52,-36755C3043.77,-36755 2499,-36755 2499,-36755 2499,-36755 2499,-36510.87 2499,-36510.87"/>
<polygon fill="black" stroke="black" points="2502.5,-36510.87 2499,-36500.87 2495.5,-36510.87 2502.5,-36510.87"/>
<text text-anchor="middle" x="2721.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_37</text>
</g>
<!-- layer_2_expert_6 -->
<g id="node65" class="node">
<title>layer_2_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2939.5,-36500.66 2616.5,-36500.66 2616.5,-36432.66 2939.5,-36432.66 2939.5,-36500.66"/>
<text text-anchor="middle" x="2778" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2778" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2778" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2778" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 38</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_6 -->
<g id="edge105" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_6</title>
<path fill="none" stroke="black" d="M3408.27,-36743C3208.96,-36743 2894,-36743 2894,-36743 2894,-36743 2894,-36510.82 2894,-36510.82"/>
<polygon fill="black" stroke="black" points="2897.5,-36510.82 2894,-36500.82 2890.5,-36510.82 2897.5,-36510.82"/>
<text text-anchor="middle" x="3116.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_38</text>
</g>
<!-- layer_2_expert_7 -->
<g id="node66" class="node">
<title>layer_2_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3334.5,-36500.66 3011.5,-36500.66 3011.5,-36432.66 3334.5,-36432.66 3334.5,-36500.66"/>
<text text-anchor="middle" x="3173" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3173" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3173" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3173" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 39</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_7 -->
<g id="edge107" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_7</title>
<path fill="none" stroke="black" d="M3327.51,-36768.23C3327.51,-36768.23 3327.51,-36510.67 3327.51,-36510.67"/>
<polygon fill="black" stroke="black" points="3331.01,-36510.67 3327.51,-36500.67 3324.01,-36510.67 3331.01,-36510.67"/>
<text text-anchor="middle" x="3391.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_39</text>
</g>
<!-- layer_2_expert_8 -->
<g id="node67" class="node">
<title>layer_2_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3729.5,-36500.66 3406.5,-36500.66 3406.5,-36432.66 3729.5,-36432.66 3729.5,-36500.66"/>
<text text-anchor="middle" x="3568" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3568" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3568" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3568" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 40</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_8 -->
<g id="edge109" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_8</title>
<path fill="none" stroke="black" d="M3568,-36731.51C3568,-36731.51 3568,-36510.93 3568,-36510.93"/>
<polygon fill="black" stroke="black" points="3571.5,-36510.93 3568,-36500.93 3564.5,-36510.93 3571.5,-36510.93"/>
<text text-anchor="middle" x="3607.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_40</text>
</g>
<!-- layer_2_expert_9 -->
<g id="node68" class="node">
<title>layer_2_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4124.5,-36500.66 3801.5,-36500.66 3801.5,-36432.66 4124.5,-36432.66 4124.5,-36500.66"/>
<text text-anchor="middle" x="3963" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3963" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3963" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3963" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 41</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_9 -->
<g id="edge111" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_9</title>
<path fill="none" stroke="black" d="M3808.49,-36768.23C3808.49,-36768.23 3808.49,-36510.67 3808.49,-36510.67"/>
<polygon fill="black" stroke="black" points="3811.99,-36510.67 3808.49,-36500.67 3804.99,-36510.67 3811.99,-36510.67"/>
<text text-anchor="middle" x="3882.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_41</text>
</g>
<!-- layer_2_expert_10 -->
<g id="node69" class="node">
<title>layer_2_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4519.5,-36500.66 4196.5,-36500.66 4196.5,-36432.66 4519.5,-36432.66 4519.5,-36500.66"/>
<text text-anchor="middle" x="4358" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4358" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4358" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4358" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 42</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_10 -->
<g id="edge113" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_10</title>
<path fill="none" stroke="black" d="M3727.88,-36743C3936.85,-36743 4276.5,-36743 4276.5,-36743 4276.5,-36743 4276.5,-36510.82 4276.5,-36510.82"/>
<polygon fill="black" stroke="black" points="4280,-36510.82 4276.5,-36500.82 4273,-36510.82 4280,-36510.82"/>
<text text-anchor="middle" x="4158.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_42</text>
</g>
<!-- layer_2_expert_11 -->
<g id="node70" class="node">
<title>layer_2_expert_11</title>
<polygon fill="lightblue" stroke="black" points="4914.5,-36500.66 4591.5,-36500.66 4591.5,-36432.66 4914.5,-36432.66 4914.5,-36500.66"/>
<text text-anchor="middle" x="4753" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4753" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4753" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4753" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 43</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_11 -->
<g id="edge115" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_11</title>
<path fill="none" stroke="black" d="M3780.44,-36755C4101.04,-36755 4671.5,-36755 4671.5,-36755 4671.5,-36755 4671.5,-36510.87 4671.5,-36510.87"/>
<polygon fill="black" stroke="black" points="4675,-36510.87 4671.5,-36500.87 4668,-36510.87 4675,-36510.87"/>
<text text-anchor="middle" x="4553.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_43</text>
</g>
<!-- layer_2_expert_12 -->
<g id="node71" class="node">
<title>layer_2_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5309.5,-36500.66 4986.5,-36500.66 4986.5,-36432.66 5309.5,-36432.66 5309.5,-36500.66"/>
<text text-anchor="middle" x="5148" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5148" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5148" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5148" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 44</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_12 -->
<g id="edge117" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_12</title>
<path fill="none" stroke="black" d="M3806.68,-36767C4229.62,-36767 5066.5,-36767 5066.5,-36767 5066.5,-36767 5066.5,-36510.82 5066.5,-36510.82"/>
<polygon fill="black" stroke="black" points="5070,-36510.82 5066.5,-36500.82 5063,-36510.82 5070,-36510.82"/>
<text text-anchor="middle" x="4948.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_44</text>
</g>
<!-- layer_2_expert_13 -->
<g id="node72" class="node">
<title>layer_2_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5704.5,-36500.66 5381.5,-36500.66 5381.5,-36432.66 5704.5,-36432.66 5704.5,-36500.66"/>
<text text-anchor="middle" x="5543" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5543" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5543" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5543" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 45</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_13 -->
<g id="edge119" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_13</title>
<path fill="none" stroke="black" d="M3815.54,-36779C4328.8,-36779 5461.5,-36779 5461.5,-36779 5461.5,-36779 5461.5,-36510.68 5461.5,-36510.68"/>
<polygon fill="black" stroke="black" points="5465,-36510.68 5461.5,-36500.68 5458,-36510.68 5465,-36510.68"/>
<text text-anchor="middle" x="5343.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_45</text>
</g>
<!-- layer_2_expert_14 -->
<g id="node73" class="node">
<title>layer_2_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6099.5,-36500.66 5776.5,-36500.66 5776.5,-36432.66 6099.5,-36432.66 6099.5,-36500.66"/>
<text text-anchor="middle" x="5938" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5938" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5938" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5938" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 46</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_14 -->
<g id="edge121" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_14</title>
<path fill="none" stroke="black" d="M3808.85,-36791C4396.59,-36791 5856.5,-36791 5856.5,-36791 5856.5,-36791 5856.5,-36510.76 5856.5,-36510.76"/>
<polygon fill="black" stroke="black" points="5860,-36510.76 5856.5,-36500.76 5853,-36510.76 5860,-36510.76"/>
<text text-anchor="middle" x="5738.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_46</text>
</g>
<!-- layer_2_expert_15 -->
<g id="node74" class="node">
<title>layer_2_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6494.5,-36500.66 6171.5,-36500.66 6171.5,-36432.66 6494.5,-36432.66 6494.5,-36500.66"/>
<text text-anchor="middle" x="6333" y="-36485.46" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6333" y="-36470.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6333" y="-36455.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6333" y="-36440.46" font-family="Times,serif" font-size="14.00">GPU: 47</text>
</g>
<!-- layer_2_scatter&#45;&gt;layer_2_expert_15 -->
<g id="edge123" class="edge">
<title>layer_2_scatter&#45;&gt;layer_2_expert_15</title>
<path fill="none" stroke="black" d="M3784.76,-36803C4423.1,-36803 6251.5,-36803 6251.5,-36803 6251.5,-36803 6251.5,-36510.76 6251.5,-36510.76"/>
<polygon fill="black" stroke="black" points="6255,-36510.76 6251.5,-36500.76 6248,-36510.76 6255,-36510.76"/>
<text text-anchor="middle" x="6133.5" y="-36612.46" font-family="Times,serif" font-size="14.00">to_GPU_47</text>
</g>
<!-- layer_2_gather -->
<g id="node59" class="node">
<title>layer_2_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3568" cy="-36153.58" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3568" y="-36172.38" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3568" y="-36157.38" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3568" y="-36142.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3568" y="-36127.38" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_2_expert_0&#45;&gt;layer_2_gather -->
<g id="edge94" class="edge">
<title>layer_2_expert_0&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M421.5,-36432.5C421.5,-36344.51 421.5,-36117 421.5,-36117 421.5,-36117 3391.61,-36117 3391.61,-36117"/>
<polygon fill="black" stroke="black" points="3391.61,-36120.5 3401.61,-36117 3391.61,-36113.5 3391.61,-36120.5"/>
<text text-anchor="middle" x="683" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_32</text>
</g>
<!-- layer_2_gather&#45;&gt;layer_2_add_norm2 -->
<g id="edge125" class="edge">
<title>layer_2_gather&#45;&gt;layer_2_add_norm2</title>
<path fill="none" stroke="black" d="M3712.24,-36113.8C3712.24,-36032.31 3712.24,-35854 3712.24,-35854 3712.24,-35854 3905.88,-35854 3905.88,-35854"/>
<polygon fill="black" stroke="black" points="3905.88,-35857.5 3915.88,-35854 3905.88,-35850.5 3905.88,-35857.5"/>
</g>
<!-- layer_2_expert_1&#45;&gt;layer_2_gather -->
<g id="edge96" class="edge">
<title>layer_2_expert_1&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M816.5,-36432.43C816.5,-36346.58 816.5,-36129 816.5,-36129 816.5,-36129 3337.77,-36129 3337.77,-36129"/>
<polygon fill="black" stroke="black" points="3337.77,-36132.5 3347.77,-36129 3337.77,-36125.5 3337.77,-36132.5"/>
<text text-anchor="middle" x="1085" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_33</text>
</g>
<!-- layer_2_expert_2&#45;&gt;layer_2_gather -->
<g id="edge98" class="edge">
<title>layer_2_expert_2&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M1211.5,-36432.43C1211.5,-36348.81 1211.5,-36141 1211.5,-36141 1211.5,-36141 3310.82,-36141 3310.82,-36141"/>
<polygon fill="black" stroke="black" points="3310.82,-36144.5 3320.82,-36141 3310.82,-36137.5 3310.82,-36144.5"/>
<text text-anchor="middle" x="1494" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_34</text>
</g>
<!-- layer_2_expert_3&#45;&gt;layer_2_gather -->
<g id="edge100" class="edge">
<title>layer_2_expert_3&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M1670.5,-36432.5C1670.5,-36351.2 1670.5,-36153 1670.5,-36153 1670.5,-36153 3301.6,-36153 3301.6,-36153"/>
<polygon fill="black" stroke="black" points="3301.6,-36156.5 3311.6,-36153 3301.6,-36149.5 3301.6,-36156.5"/>
<text text-anchor="middle" x="1917" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_35</text>
</g>
<!-- layer_2_expert_4&#45;&gt;layer_2_gather -->
<g id="edge102" class="edge">
<title>layer_2_expert_4&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M2072.5,-36432.64C2072.5,-36353.75 2072.5,-36165 2072.5,-36165 2072.5,-36165 3308.95,-36165 3308.95,-36165"/>
<polygon fill="black" stroke="black" points="3308.95,-36168.5 3318.95,-36165 3308.95,-36161.5 3308.95,-36168.5"/>
<text text-anchor="middle" x="2367" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_36</text>
</g>
<!-- layer_2_expert_5&#45;&gt;layer_2_gather -->
<g id="edge104" class="edge">
<title>layer_2_expert_5&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M2396.5,-36432.58C2396.5,-36356.01 2396.5,-36177 2396.5,-36177 2396.5,-36177 3334.2,-36177 3334.2,-36177"/>
<polygon fill="black" stroke="black" points="3334.2,-36180.5 3344.2,-36177 3334.2,-36173.5 3334.2,-36180.5"/>
<text text-anchor="middle" x="2652" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_37</text>
</g>
<!-- layer_2_expert_6&#45;&gt;layer_2_gather -->
<g id="edge106" class="edge">
<title>layer_2_expert_6&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M2791.5,-36432.62C2791.5,-36358.47 2791.5,-36189 2791.5,-36189 2791.5,-36189 3384.7,-36189 3384.7,-36189"/>
<polygon fill="black" stroke="black" points="3384.7,-36192.5 3394.7,-36189 3384.7,-36185.5 3384.7,-36192.5"/>
<text text-anchor="middle" x="3047" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_38</text>
</g>
<!-- layer_2_expert_7&#45;&gt;layer_2_gather -->
<g id="edge108" class="edge">
<title>layer_2_expert_7&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M3323.26,-36432.56C3323.26,-36432.56 3323.26,-36177.84 3323.26,-36177.84"/>
<polygon fill="black" stroke="black" points="3326.76,-36177.84 3323.26,-36167.84 3319.76,-36177.84 3326.76,-36177.84"/>
<text text-anchor="middle" x="3332" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_39</text>
</g>
<!-- layer_2_expert_8&#45;&gt;layer_2_gather -->
<g id="edge110" class="edge">
<title>layer_2_expert_8&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M3568,-36432.56C3568,-36432.56 3568,-36211.67 3568,-36211.67"/>
<polygon fill="black" stroke="black" points="3571.5,-36211.67 3568,-36201.67 3564.5,-36211.67 3571.5,-36211.67"/>
<text text-anchor="middle" x="3617" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_40</text>
</g>
<!-- layer_2_expert_9&#45;&gt;layer_2_gather -->
<g id="edge112" class="edge">
<title>layer_2_expert_9&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M3812.74,-36432.56C3812.74,-36432.56 3812.74,-36177.84 3812.74,-36177.84"/>
<polygon fill="black" stroke="black" points="3816.24,-36177.84 3812.74,-36167.84 3809.24,-36177.84 3816.24,-36177.84"/>
<text text-anchor="middle" x="3902" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_41</text>
</g>
<!-- layer_2_expert_10&#45;&gt;layer_2_gather -->
<g id="edge114" class="edge">
<title>layer_2_expert_10&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M4237.25,-36432.65C4237.25,-36358.12 4237.25,-36187 4237.25,-36187 4237.25,-36187 3762.2,-36187 3762.2,-36187"/>
<polygon fill="black" stroke="black" points="3762.2,-36183.5 3752.2,-36187 3762.2,-36190.5 3762.2,-36183.5"/>
<text text-anchor="middle" x="4242" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_42</text>
</g>
<!-- layer_2_expert_11&#45;&gt;layer_2_gather -->
<g id="edge116" class="edge">
<title>layer_2_expert_11&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M4605,-36432.52C4605,-36355.32 4605,-36174 4605,-36174 4605,-36174 3809.75,-36174 3809.75,-36174"/>
<polygon fill="black" stroke="black" points="3809.75,-36170.5 3799.75,-36174 3809.75,-36177.5 3809.75,-36170.5"/>
<text text-anchor="middle" x="4610" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_43</text>
</g>
<!-- layer_2_expert_12&#45;&gt;layer_2_gather -->
<g id="edge118" class="edge">
<title>layer_2_expert_12&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M5000,-36432.38C5000,-36352.35 5000,-36160 5000,-36160 5000,-36160 3831.95,-36160 3831.95,-36160"/>
<polygon fill="black" stroke="black" points="3831.95,-36156.5 3821.95,-36160 3831.95,-36163.5 3831.95,-36156.5"/>
<text text-anchor="middle" x="4991" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_44</text>
</g>
<!-- layer_2_expert_13&#45;&gt;layer_2_gather -->
<g id="edge120" class="edge">
<title>layer_2_expert_13&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M5395,-36432.65C5395,-36350.12 5395,-36146 5395,-36146 5395,-36146 3831.08,-36146 3831.08,-36146"/>
<polygon fill="black" stroke="black" points="3831.08,-36142.5 3821.08,-36146 3831.08,-36149.5 3831.08,-36142.5"/>
<text text-anchor="middle" x="5379" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_45</text>
</g>
<!-- layer_2_expert_14&#45;&gt;layer_2_gather -->
<g id="edge122" class="edge">
<title>layer_2_expert_14&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M5790,-36432.42C5790,-36347.13 5790,-36132 5790,-36132 5790,-36132 3806.9,-36132 3806.9,-36132"/>
<polygon fill="black" stroke="black" points="3806.9,-36128.5 3796.9,-36132 3806.9,-36135.5 3806.9,-36128.5"/>
<text text-anchor="middle" x="5771" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_46</text>
</g>
<!-- layer_2_expert_15&#45;&gt;layer_2_gather -->
<g id="edge124" class="edge">
<title>layer_2_expert_15&#45;&gt;layer_2_gather</title>
<path fill="none" stroke="black" d="M6185,-36432.38C6185,-36344.67 6185,-36119 6185,-36119 6185,-36119 3756.08,-36119 3756.08,-36119"/>
<polygon fill="black" stroke="black" points="3756.08,-36115.5 3746.08,-36119 3756.08,-36122.5 3756.08,-36115.5"/>
<text text-anchor="middle" x="6164" y="-36313.46" font-family="Times,serif" font-size="14.00">from_GPU_47</text>
</g>
<!-- layer_3_qkv -->
<g id="node77" class="node">
<title>layer_3_qkv</title>
<polygon fill="lightblue" stroke="black" points="4009.5,-35603.5 3600.5,-35603.5 3600.5,-35535.5 4009.5,-35535.5 4009.5,-35603.5"/>
<text text-anchor="middle" x="3805" y="-35588.3" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3805" y="-35573.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3805" y="-35558.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3805" y="-35543.3" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- layer_2_add_norm2&#45;&gt;layer_3_qkv -->
<g id="edge127" class="edge">
<title>layer_2_add_norm2&#45;&gt;layer_3_qkv</title>
<path fill="none" stroke="black" d="M3962.75,-35820.4C3962.75,-35820.4 3962.75,-35613.63 3962.75,-35613.63"/>
<polygon fill="black" stroke="black" points="3966.25,-35613.63 3962.75,-35603.63 3959.25,-35613.63 3966.25,-35613.63"/>
</g>
<!-- layer_3_add_norm1 -->
<g id="node80" class="node">
<title>layer_3_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4212,-34748.5 3850,-34748.5 3850,-34680.5 4212,-34680.5 4212,-34748.5"/>
<text text-anchor="middle" x="4031" y="-34733.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4031" y="-34718.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4031" y="-34703.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4031" y="-34688.3" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- layer_2_add_norm2&#45;&gt;layer_3_add_norm1 -->
<g id="edge131" class="edge">
<title>layer_2_add_norm2&#45;&gt;layer_3_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4110.75,-35820.38C4110.75,-35820.38 4110.75,-34758.76 4110.75,-34758.76"/>
<polygon fill="black" stroke="black" points="4114.25,-34758.76 4110.75,-34748.76 4107.25,-34758.76 4114.25,-34758.76"/>
<text text-anchor="middle" x="4165" y="-35280.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_2_mha -->
<g id="node76" class="node">
<title>layer_2_mha</title>
<polygon fill="lightblue" stroke="black" points="2109.5,-38334.83 1700.5,-38334.83 1700.5,-38266.83 2109.5,-38266.83 2109.5,-38334.83"/>
<text text-anchor="middle" x="1905" y="-38319.63" font-family="Times,serif" font-size="14.00">MHA Layer 2</text>
<text text-anchor="middle" x="1905" y="-38304.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1905" y="-38289.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1905" y="-38274.63" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- layer_3_attn -->
<g id="node78" class="node">
<title>layer_3_attn</title>
<polygon fill="lightblue" stroke="black" points="3991.5,-35318.5 3582.5,-35318.5 3582.5,-35250.5 3991.5,-35250.5 3991.5,-35318.5"/>
<text text-anchor="middle" x="3787" y="-35303.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3787" y="-35288.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3787" y="-35273.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3787" y="-35258.3" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- layer_3_qkv&#45;&gt;layer_3_attn -->
<g id="edge128" class="edge">
<title>layer_3_qkv&#45;&gt;layer_3_attn</title>
<path fill="none" stroke="black" d="M3796,-35535.4C3796,-35535.4 3796,-35328.63 3796,-35328.63"/>
<polygon fill="black" stroke="black" points="3799.5,-35328.63 3796,-35318.63 3792.5,-35328.63 3799.5,-35328.63"/>
</g>
<!-- layer_3_proj -->
<g id="node79" class="node">
<title>layer_3_proj</title>
<polygon fill="lightblue" stroke="black" points="4006.5,-35033.5 3609.5,-35033.5 3609.5,-34965.5 4006.5,-34965.5 4006.5,-35033.5"/>
<text text-anchor="middle" x="3808" y="-35018.3" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3808" y="-35003.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3808" y="-34988.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3808" y="-34973.3" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- layer_3_attn&#45;&gt;layer_3_proj -->
<g id="edge129" class="edge">
<title>layer_3_attn&#45;&gt;layer_3_proj</title>
<path fill="none" stroke="black" d="M3800.5,-35250.4C3800.5,-35250.4 3800.5,-35043.63 3800.5,-35043.63"/>
<polygon fill="black" stroke="black" points="3804,-35043.63 3800.5,-35033.63 3797,-35043.63 3804,-35043.63"/>
</g>
<!-- layer_3_proj&#45;&gt;layer_3_add_norm1 -->
<g id="edge130" class="edge">
<title>layer_3_proj&#45;&gt;layer_3_add_norm1</title>
<path fill="none" stroke="black" d="M3928.25,-34965.4C3928.25,-34965.4 3928.25,-34758.63 3928.25,-34758.63"/>
<polygon fill="black" stroke="black" points="3931.75,-34758.63 3928.25,-34748.63 3924.75,-34758.63 3931.75,-34758.63"/>
</g>
<!-- layer_3_gate -->
<g id="node81" class="node">
<title>layer_3_gate</title>
<polygon fill="yellow" stroke="black" points="3957.73,-34463.5 3380.71,-34463.5 3232.27,-34327.5 3809.29,-34327.5 3957.73,-34463.5"/>
<text text-anchor="middle" x="3595" y="-34414.3" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3595" y="-34399.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3595" y="-34384.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3595" y="-34369.3" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_gate -->
<g id="edge132" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" d="M3903.93,-34680.36C3903.93,-34680.36 3903.93,-34473.62 3903.93,-34473.62"/>
<polygon fill="black" stroke="black" points="3907.43,-34473.62 3903.93,-34463.62 3900.43,-34473.62 3907.43,-34473.62"/>
</g>
<!-- layer_3_scatter -->
<g id="node82" class="node">
<title>layer_3_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3595" cy="-34048.41" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3595" y="-34067.21" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3595" y="-34052.21" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3595" y="-34037.21" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3595" y="-34022.21" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_scatter -->
<g id="edge133" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_scatter</title>
<path fill="none" stroke="black" d="M4054.68,-34680.15C4054.68,-34548.58 4054.68,-34084 4054.68,-34084 4054.68,-34084 3771.61,-34084 3771.61,-34084"/>
<polygon fill="black" stroke="black" points="3771.61,-34080.5 3761.61,-34084 3771.61,-34087.5 3771.61,-34080.5"/>
</g>
<!-- layer_3_add_norm2 -->
<g id="node100" class="node">
<title>layer_3_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4081,-33157.16 3719,-33157.16 3719,-33089.16 4081,-33089.16 4081,-33157.16"/>
<text text-anchor="middle" x="3900" y="-33141.96" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3900" y="-33126.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3900" y="-33111.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3900" y="-33096.96" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_add_norm2 -->
<g id="edge168" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4181.75,-34680.15C4181.75,-34448.45 4181.75,-33123 4181.75,-33123 4181.75,-33123 4091.23,-33123 4091.23,-33123"/>
<polygon fill="black" stroke="black" points="4091.23,-33119.5 4081.23,-33123 4091.23,-33126.5 4091.23,-33119.5"/>
<text text-anchor="middle" x="6567" y="-33881.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_scatter -->
<g id="edge134" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3595,-34327.34C3595,-34327.34 3595,-34106.6 3595,-34106.6"/>
<polygon fill="black" stroke="black" points="3598.5,-34106.6 3595,-34096.6 3591.5,-34106.6 3598.5,-34106.6"/>
<text text-anchor="middle" x="3638.5" y="-34208.3" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_3_expert_0 -->
<g id="node83" class="node">
<title>layer_3_expert_0</title>
<polygon fill="lightblue" stroke="black" points="596.5,-33769.33 273.5,-33769.33 273.5,-33701.33 596.5,-33701.33 596.5,-33769.33"/>
<text text-anchor="middle" x="435" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="435" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="435" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="435" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_0 -->
<g id="edge135" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_0</title>
<path fill="none" stroke="black" d="M3428.5,-34084C2796.71,-34084 583,-34084 583,-34084 583,-34084 583,-33779.4 583,-33779.4"/>
<polygon fill="black" stroke="black" points="586.5,-33779.4 583,-33769.4 579.5,-33779.4 586.5,-33779.4"/>
<text text-anchor="middle" x="659.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_48</text>
</g>
<!-- layer_3_expert_1 -->
<g id="node85" class="node">
<title>layer_3_expert_1</title>
<polygon fill="lightblue" stroke="black" points="991.5,-33769.33 668.5,-33769.33 668.5,-33701.33 991.5,-33701.33 991.5,-33769.33"/>
<text text-anchor="middle" x="830" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="830" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="830" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="830" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 49</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_1 -->
<g id="edge137" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_1</title>
<path fill="none" stroke="black" d="M3379.17,-34072C2752.67,-34072 978,-34072 978,-34072 978,-34072 978,-33779.46 978,-33779.46"/>
<polygon fill="black" stroke="black" points="981.5,-33779.46 978,-33769.46 974.5,-33779.46 981.5,-33779.46"/>
<text text-anchor="middle" x="1000.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_49</text>
</g>
<!-- layer_3_expert_2 -->
<g id="node86" class="node">
<title>layer_3_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1386.5,-33769.33 1063.5,-33769.33 1063.5,-33701.33 1386.5,-33701.33 1386.5,-33769.33"/>
<text text-anchor="middle" x="1225" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1225" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1225" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1225" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 50</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_2 -->
<g id="edge139" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_2</title>
<path fill="none" stroke="black" d="M3354.57,-34060C2779.67,-34060 1373,-34060 1373,-34060 1373,-34060 1373,-33779.46 1373,-33779.46"/>
<polygon fill="black" stroke="black" points="1376.5,-33779.46 1373,-33769.46 1369.5,-33779.46 1376.5,-33779.46"/>
<text text-anchor="middle" x="1287.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_50</text>
</g>
<!-- layer_3_expert_3 -->
<g id="node87" class="node">
<title>layer_3_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1781.5,-33769.33 1458.5,-33769.33 1458.5,-33701.33 1781.5,-33701.33 1781.5,-33769.33"/>
<text text-anchor="middle" x="1620" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1620" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1620" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1620" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 51</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_3 -->
<g id="edge141" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_3</title>
<path fill="none" stroke="black" d="M3347.13,-34048C2830.06,-34048 1684,-34048 1684,-34048 1684,-34048 1684,-33779.39 1684,-33779.39"/>
<polygon fill="black" stroke="black" points="1687.5,-33779.39 1684,-33769.39 1680.5,-33779.39 1687.5,-33779.39"/>
<text text-anchor="middle" x="2160.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_51</text>
</g>
<!-- layer_3_expert_4 -->
<g id="node88" class="node">
<title>layer_3_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2176.5,-33769.33 1853.5,-33769.33 1853.5,-33701.33 2176.5,-33701.33 2176.5,-33769.33"/>
<text text-anchor="middle" x="2015" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2015" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2015" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2015" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 52</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_4 -->
<g id="edge143" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_4</title>
<path fill="none" stroke="black" d="M3355.72,-34036C2948.18,-34036 2163,-34036 2163,-34036 2163,-34036 2163,-33779.53 2163,-33779.53"/>
<polygon fill="black" stroke="black" points="2166.5,-33779.53 2163,-33769.53 2159.5,-33779.53 2166.5,-33779.53"/>
<text text-anchor="middle" x="2674.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_52</text>
</g>
<!-- layer_3_expert_5 -->
<g id="node89" class="node">
<title>layer_3_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2571.5,-33769.33 2248.5,-33769.33 2248.5,-33701.33 2571.5,-33701.33 2571.5,-33769.33"/>
<text text-anchor="middle" x="2410" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2410" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2410" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2410" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 53</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_5 -->
<g id="edge145" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_5</title>
<path fill="none" stroke="black" d="M3381.7,-34024C3078.18,-34024 2558,-34024 2558,-34024 2558,-34024 2558,-33779.58 2558,-33779.58"/>
<polygon fill="black" stroke="black" points="2561.5,-33779.58 2558,-33769.58 2554.5,-33779.58 2561.5,-33779.58"/>
<text text-anchor="middle" x="3009.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_53</text>
</g>
<!-- layer_3_expert_6 -->
<g id="node90" class="node">
<title>layer_3_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2966.5,-33769.33 2643.5,-33769.33 2643.5,-33701.33 2966.5,-33701.33 2966.5,-33769.33"/>
<text text-anchor="middle" x="2805" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2805" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2805" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2805" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 54</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_6 -->
<g id="edge147" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_6</title>
<path fill="none" stroke="black" d="M3433,-34012C3242.81,-34012 2953,-34012 2953,-34012 2953,-34012 2953,-33779.53 2953,-33779.53"/>
<polygon fill="black" stroke="black" points="2956.5,-33779.53 2953,-33769.53 2949.5,-33779.53 2956.5,-33779.53"/>
<text text-anchor="middle" x="3255.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_54</text>
</g>
<!-- layer_3_expert_7 -->
<g id="node91" class="node">
<title>layer_3_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3361.5,-33769.33 3038.5,-33769.33 3038.5,-33701.33 3361.5,-33701.33 3361.5,-33769.33"/>
<text text-anchor="middle" x="3200" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3200" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3200" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3200" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 55</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_7 -->
<g id="edge149" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_7</title>
<path fill="none" stroke="black" d="M3354.51,-34036.9C3354.51,-34036.9 3354.51,-33779.34 3354.51,-33779.34"/>
<polygon fill="black" stroke="black" points="3358.01,-33779.34 3354.51,-33769.34 3351.01,-33779.34 3358.01,-33779.34"/>
<text text-anchor="middle" x="3456.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_55</text>
</g>
<!-- layer_3_expert_8 -->
<g id="node92" class="node">
<title>layer_3_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3756.5,-33769.33 3433.5,-33769.33 3433.5,-33701.33 3756.5,-33701.33 3756.5,-33769.33"/>
<text text-anchor="middle" x="3595" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3595" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3595" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3595" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 56</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_8 -->
<g id="edge151" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_8</title>
<path fill="none" stroke="black" d="M3595,-34000.18C3595,-34000.18 3595,-33779.59 3595,-33779.59"/>
<polygon fill="black" stroke="black" points="3598.5,-33779.59 3595,-33769.59 3591.5,-33779.59 3598.5,-33779.59"/>
<text text-anchor="middle" x="3634.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_56</text>
</g>
<!-- layer_3_expert_9 -->
<g id="node93" class="node">
<title>layer_3_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4151.5,-33769.33 3828.5,-33769.33 3828.5,-33701.33 4151.5,-33701.33 4151.5,-33769.33"/>
<text text-anchor="middle" x="3990" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3990" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3990" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3990" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 57</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_9 -->
<g id="edge153" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_9</title>
<path fill="none" stroke="black" d="M3835.49,-34036.9C3835.49,-34036.9 3835.49,-33779.34 3835.49,-33779.34"/>
<polygon fill="black" stroke="black" points="3838.99,-33779.34 3835.49,-33769.34 3831.99,-33779.34 3838.99,-33779.34"/>
<text text-anchor="middle" x="3909.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_57</text>
</g>
<!-- layer_3_expert_10 -->
<g id="node94" class="node">
<title>layer_3_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4546.5,-33769.33 4223.5,-33769.33 4223.5,-33701.33 4546.5,-33701.33 4546.5,-33769.33"/>
<text text-anchor="middle" x="4385" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4385" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4385" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4385" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 58</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_10 -->
<g id="edge155" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_10</title>
<path fill="none" stroke="black" d="M3756.67,-34012C3950.85,-34012 4250.75,-34012 4250.75,-34012 4250.75,-34012 4250.75,-33779.53 4250.75,-33779.53"/>
<polygon fill="black" stroke="black" points="4254.25,-33779.53 4250.75,-33769.53 4247.25,-33779.53 4254.25,-33779.53"/>
<text text-anchor="middle" x="4245.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_58</text>
</g>
<!-- layer_3_expert_11 -->
<g id="node95" class="node">
<title>layer_3_expert_11</title>
<polygon fill="lightblue" stroke="black" points="4941.5,-33769.33 4618.5,-33769.33 4618.5,-33701.33 4941.5,-33701.33 4941.5,-33769.33"/>
<text text-anchor="middle" x="4780" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4780" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4780" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4780" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 59</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_11 -->
<g id="edge157" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_11</title>
<path fill="none" stroke="black" d="M3808.51,-34024C4146.41,-34024 4766.5,-34024 4766.5,-34024 4766.5,-34024 4766.5,-33779.58 4766.5,-33779.58"/>
<polygon fill="black" stroke="black" points="4770,-33779.58 4766.5,-33769.58 4763,-33779.58 4770,-33779.58"/>
<text text-anchor="middle" x="4700.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_59</text>
</g>
<!-- layer_3_expert_12 -->
<g id="node96" class="node">
<title>layer_3_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5336.5,-33769.33 5013.5,-33769.33 5013.5,-33701.33 5336.5,-33701.33 5336.5,-33769.33"/>
<text text-anchor="middle" x="5175" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5175" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5175" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5175" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 60</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_12 -->
<g id="edge159" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_12</title>
<path fill="none" stroke="black" d="M3834.2,-34036C4272.87,-34036 5161.5,-34036 5161.5,-34036 5161.5,-34036 5161.5,-33779.53 5161.5,-33779.53"/>
<polygon fill="black" stroke="black" points="5165,-33779.53 5161.5,-33769.53 5158,-33779.53 5165,-33779.53"/>
<text text-anchor="middle" x="5035.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_60</text>
</g>
<!-- layer_3_expert_13 -->
<g id="node97" class="node">
<title>layer_3_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5731.5,-33769.33 5408.5,-33769.33 5408.5,-33701.33 5731.5,-33701.33 5731.5,-33769.33"/>
<text text-anchor="middle" x="5570" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5570" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5570" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5570" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 61</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_13 -->
<g id="edge161" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_13</title>
<path fill="none" stroke="black" d="M3842.93,-34048C4370.49,-34048 5556.5,-34048 5556.5,-34048 5556.5,-34048 5556.5,-33779.39 5556.5,-33779.39"/>
<polygon fill="black" stroke="black" points="5560,-33779.39 5556.5,-33769.39 5553,-33779.39 5560,-33779.39"/>
<text text-anchor="middle" x="5400.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_61</text>
</g>
<!-- layer_3_expert_14 -->
<g id="node98" class="node">
<title>layer_3_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6126.5,-33769.33 5803.5,-33769.33 5803.5,-33701.33 6126.5,-33701.33 6126.5,-33769.33"/>
<text text-anchor="middle" x="5965" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5965" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5965" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5965" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 62</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_14 -->
<g id="edge163" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_14</title>
<path fill="none" stroke="black" d="M3835.29,-34060C4435.32,-34060 5951.5,-34060 5951.5,-34060 5951.5,-34060 5951.5,-33779.46 5951.5,-33779.46"/>
<polygon fill="black" stroke="black" points="5955,-33779.46 5951.5,-33769.46 5948,-33779.46 5955,-33779.46"/>
<text text-anchor="middle" x="5780.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_62</text>
</g>
<!-- layer_3_expert_15 -->
<g id="node99" class="node">
<title>layer_3_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6521.5,-33769.33 6198.5,-33769.33 6198.5,-33701.33 6521.5,-33701.33 6521.5,-33769.33"/>
<text text-anchor="middle" x="6360" y="-33754.13" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6360" y="-33739.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6360" y="-33724.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6360" y="-33709.13" font-family="Times,serif" font-size="14.00">GPU: 63</text>
</g>
<!-- layer_3_scatter&#45;&gt;layer_3_expert_15 -->
<g id="edge165" class="edge">
<title>layer_3_scatter&#45;&gt;layer_3_expert_15</title>
<path fill="none" stroke="black" d="M3810.91,-34072C4459.55,-34072 6346.5,-34072 6346.5,-34072 6346.5,-34072 6346.5,-33779.46 6346.5,-33779.46"/>
<polygon fill="black" stroke="black" points="6350,-33779.46 6346.5,-33769.46 6343,-33779.46 6350,-33779.46"/>
<text text-anchor="middle" x="6280.5" y="-33881.13" font-family="Times,serif" font-size="14.00">to_GPU_63</text>
</g>
<!-- layer_3_gather -->
<g id="node84" class="node">
<title>layer_3_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3595" cy="-33422.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3595" y="-33441.05" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3595" y="-33426.05" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3595" y="-33411.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3595" y="-33396.05" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_3_expert_0&#45;&gt;layer_3_gather -->
<g id="edge136" class="edge">
<title>layer_3_expert_0&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M572.5,-33701.2C572.5,-33613.3 572.5,-33386 572.5,-33386 572.5,-33386 3416.56,-33386 3416.56,-33386"/>
<polygon fill="black" stroke="black" points="3416.56,-33389.5 3426.56,-33386 3416.56,-33382.5 3416.56,-33389.5"/>
<text text-anchor="middle" x="734" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_48</text>
</g>
<!-- layer_3_gather&#45;&gt;layer_3_add_norm2 -->
<g id="edge167" class="edge">
<title>layer_3_gather&#45;&gt;layer_3_add_norm2</title>
<path fill="none" stroke="black" d="M3784.99,-33389.96C3784.99,-33389.96 3784.99,-33167.61 3784.99,-33167.61"/>
<polygon fill="black" stroke="black" points="3788.49,-33167.61 3784.99,-33157.61 3781.49,-33167.61 3788.49,-33167.61"/>
</g>
<!-- layer_3_expert_1&#45;&gt;layer_3_gather -->
<g id="edge138" class="edge">
<title>layer_3_expert_1&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M967.5,-33701.13C967.5,-33615.37 967.5,-33398 967.5,-33398 967.5,-33398 3363.81,-33398 3363.81,-33398"/>
<polygon fill="black" stroke="black" points="3363.81,-33401.5 3373.81,-33398 3363.81,-33394.5 3363.81,-33401.5"/>
<text text-anchor="middle" x="1160" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_49</text>
</g>
<!-- layer_3_expert_2&#45;&gt;layer_3_gather -->
<g id="edge140" class="edge">
<title>layer_3_expert_2&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M1362.5,-33701.13C1362.5,-33617.6 1362.5,-33410 1362.5,-33410 1362.5,-33410 3337.29,-33410 3337.29,-33410"/>
<polygon fill="black" stroke="black" points="3337.29,-33413.5 3347.29,-33410 3337.28,-33406.5 3337.29,-33413.5"/>
<text text-anchor="middle" x="1617" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_50</text>
</g>
<!-- layer_3_expert_3&#45;&gt;layer_3_gather -->
<g id="edge142" class="edge">
<title>layer_3_expert_3&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M1620,-33701.2C1620,-33619.99 1620,-33422 1620,-33422 1620,-33422 3328.83,-33422 3328.83,-33422"/>
<polygon fill="black" stroke="black" points="3328.83,-33425.5 3338.83,-33422 3328.83,-33418.5 3328.83,-33425.5"/>
<text text-anchor="middle" x="1902" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_51</text>
</g>
<!-- layer_3_expert_4&#45;&gt;layer_3_gather -->
<g id="edge144" class="edge">
<title>layer_3_expert_4&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M2152.5,-33701.06C2152.5,-33622.08 2152.5,-33434 2152.5,-33434 2152.5,-33434 3336.62,-33434 3336.62,-33434"/>
<polygon fill="black" stroke="black" points="3336.62,-33437.5 3346.62,-33434 3336.62,-33430.5 3336.62,-33437.5"/>
<text text-anchor="middle" x="2311" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_52</text>
</g>
<!-- layer_3_expert_5&#45;&gt;layer_3_gather -->
<g id="edge146" class="edge">
<title>layer_3_expert_5&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M2547.5,-33701.29C2547.5,-33624.81 2547.5,-33446 2547.5,-33446 2547.5,-33446 3362.21,-33446 3362.21,-33446"/>
<polygon fill="black" stroke="black" points="3362.21,-33449.5 3372.21,-33446 3362.21,-33442.5 3362.21,-33449.5"/>
<text text-anchor="middle" x="2734" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_53</text>
</g>
<!-- layer_3_expert_6&#45;&gt;layer_3_gather -->
<g id="edge148" class="edge">
<title>layer_3_expert_6&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M2942.5,-33701.32C2942.5,-33627.27 2942.5,-33458 2942.5,-33458 2942.5,-33458 3413.56,-33458 3413.56,-33458"/>
<polygon fill="black" stroke="black" points="3413.56,-33461.5 3423.56,-33458 3413.56,-33454.5 3413.56,-33461.5"/>
<text text-anchor="middle" x="3019" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_54</text>
</g>
<!-- layer_3_expert_7&#45;&gt;layer_3_gather -->
<g id="edge150" class="edge">
<title>layer_3_expert_7&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M3350.26,-33701.23C3350.26,-33701.23 3350.26,-33446.5 3350.26,-33446.5"/>
<polygon fill="black" stroke="black" points="3353.76,-33446.5 3350.26,-33436.5 3346.76,-33446.5 3353.76,-33446.5"/>
<text text-anchor="middle" x="3359" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_55</text>
</g>
<!-- layer_3_expert_8&#45;&gt;layer_3_gather -->
<g id="edge152" class="edge">
<title>layer_3_expert_8&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M3595,-33701.23C3595,-33701.23 3595,-33480.34 3595,-33480.34"/>
<polygon fill="black" stroke="black" points="3598.5,-33480.34 3595,-33470.34 3591.5,-33480.34 3598.5,-33480.34"/>
<text text-anchor="middle" x="3644" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_56</text>
</g>
<!-- layer_3_expert_9&#45;&gt;layer_3_gather -->
<g id="edge154" class="edge">
<title>layer_3_expert_9&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M3839.74,-33701.23C3839.74,-33701.23 3839.74,-33446.5 3839.74,-33446.5"/>
<polygon fill="black" stroke="black" points="3843.24,-33446.5 3839.74,-33436.5 3836.24,-33446.5 3843.24,-33446.5"/>
<text text-anchor="middle" x="3929" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_57</text>
</g>
<!-- layer_3_expert_10&#45;&gt;layer_3_gather -->
<g id="edge156" class="edge">
<title>layer_3_expert_10&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M4325,-33701.08C4325,-33626.49 4325,-33456 4325,-33456 4325,-33456 3787.33,-33456 3787.33,-33456"/>
<polygon fill="black" stroke="black" points="3787.33,-33452.5 3777.33,-33456 3787.33,-33459.5 3787.33,-33452.5"/>
<text text-anchor="middle" x="4269" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_58</text>
</g>
<!-- layer_3_expert_11&#45;&gt;layer_3_gather -->
<g id="edge158" class="edge">
<title>layer_3_expert_11&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M4720,-33701.11C4720,-33623.73 4720,-33442 4720,-33442 4720,-33442 3838.44,-33442 3838.44,-33442"/>
<polygon fill="black" stroke="black" points="3838.44,-33438.5 3828.44,-33442 3838.44,-33445.5 3838.44,-33438.5"/>
<text text-anchor="middle" x="4637" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_59</text>
</g>
<!-- layer_3_expert_12&#45;&gt;layer_3_gather -->
<g id="edge160" class="edge">
<title>layer_3_expert_12&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M5115,-33701.08C5115,-33621.15 5115,-33429 5115,-33429 5115,-33429 3858.56,-33429 3858.56,-33429"/>
<polygon fill="black" stroke="black" points="3858.56,-33425.5 3848.56,-33429 3858.56,-33432.5 3858.56,-33425.5"/>
<text text-anchor="middle" x="5018" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_60</text>
</g>
<!-- layer_3_expert_13&#45;&gt;layer_3_gather -->
<g id="edge162" class="edge">
<title>layer_3_expert_13&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M5510,-33701.05C5510,-33618.41 5510,-33415 5510,-33415 5510,-33415 3858.31,-33415 3858.31,-33415"/>
<polygon fill="black" stroke="black" points="3858.31,-33411.5 3848.31,-33415 3858.31,-33418.5 3858.31,-33411.5"/>
<text text-anchor="middle" x="5406" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_61</text>
</g>
<!-- layer_3_expert_14&#45;&gt;layer_3_gather -->
<g id="edge164" class="edge">
<title>layer_3_expert_14&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M5905,-33701.12C5905,-33615.91 5905,-33401 5905,-33401 5905,-33401 3834.67,-33401 3834.67,-33401"/>
<polygon fill="black" stroke="black" points="3834.67,-33397.5 3824.67,-33401 3834.67,-33404.5 3834.67,-33397.5"/>
<text text-anchor="middle" x="5691" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_62</text>
</g>
<!-- layer_3_expert_15&#45;&gt;layer_3_gather -->
<g id="edge166" class="edge">
<title>layer_3_expert_15&#45;&gt;layer_3_gather</title>
<path fill="none" stroke="black" d="M6300,-33701.3C6300,-33613.65 6300,-33387 6300,-33387 6300,-33387 3779.36,-33387 3779.36,-33387"/>
<polygon fill="black" stroke="black" points="3779.36,-33383.5 3769.36,-33387 3779.36,-33390.5 3779.36,-33383.5"/>
<text text-anchor="middle" x="6138" y="-33582.13" font-family="Times,serif" font-size="14.00">from_GPU_63</text>
</g>
<!-- layer_4_qkv -->
<g id="node102" class="node">
<title>layer_4_qkv</title>
<polygon fill="lightblue" stroke="black" points="3883.5,-32872.16 3474.5,-32872.16 3474.5,-32804.16 3883.5,-32804.16 3883.5,-32872.16"/>
<text text-anchor="middle" x="3679" y="-32856.96" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3679" y="-32841.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3679" y="-32826.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3679" y="-32811.96" font-family="Times,serif" font-size="14.00">GPU: 64</text>
</g>
<!-- layer_3_add_norm2&#45;&gt;layer_4_qkv -->
<g id="edge169" class="edge">
<title>layer_3_add_norm2&#45;&gt;layer_4_qkv</title>
<path fill="none" stroke="black" d="M3801.25,-33089.07C3801.25,-33089.07 3801.25,-32882.3 3801.25,-32882.3"/>
<polygon fill="black" stroke="black" points="3804.75,-32882.3 3801.25,-32872.3 3797.75,-32882.3 3804.75,-32882.3"/>
</g>
<!-- layer_4_add_norm1 -->
<g id="node105" class="node">
<title>layer_4_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4092,-32017.16 3730,-32017.16 3730,-31949.16 4092,-31949.16 4092,-32017.16"/>
<text text-anchor="middle" x="3911" y="-32001.96" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3911" y="-31986.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3911" y="-31971.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3911" y="-31956.96" font-family="Times,serif" font-size="14.00">GPU: 64</text>
</g>
<!-- layer_3_add_norm2&#45;&gt;layer_4_add_norm1 -->
<g id="edge173" class="edge">
<title>layer_3_add_norm2&#45;&gt;layer_4_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3982.25,-33089.05C3982.25,-33089.05 3982.25,-32027.43 3982.25,-32027.43"/>
<polygon fill="black" stroke="black" points="3985.75,-32027.43 3982.25,-32017.43 3978.75,-32027.43 3985.75,-32027.43"/>
<text text-anchor="middle" x="4031" y="-32549.46" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_3_mha -->
<g id="node101" class="node">
<title>layer_3_mha</title>
<polygon fill="lightblue" stroke="black" points="1995.5,-35603.5 1586.5,-35603.5 1586.5,-35535.5 1995.5,-35535.5 1995.5,-35603.5"/>
<text text-anchor="middle" x="1791" y="-35588.3" font-family="Times,serif" font-size="14.00">MHA Layer 3</text>
<text text-anchor="middle" x="1791" y="-35573.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1791" y="-35558.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1791" y="-35543.3" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- layer_4_attn -->
<g id="node103" class="node">
<title>layer_4_attn</title>
<polygon fill="lightblue" stroke="black" points="3857.5,-32587.16 3448.5,-32587.16 3448.5,-32519.16 3857.5,-32519.16 3857.5,-32587.16"/>
<text text-anchor="middle" x="3653" y="-32571.96" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3653" y="-32556.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3653" y="-32541.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3653" y="-32526.96" font-family="Times,serif" font-size="14.00">GPU: 64</text>
</g>
<!-- layer_4_qkv&#45;&gt;layer_4_attn -->
<g id="edge170" class="edge">
<title>layer_4_qkv&#45;&gt;layer_4_attn</title>
<path fill="none" stroke="black" d="M3666,-32804.07C3666,-32804.07 3666,-32597.3 3666,-32597.3"/>
<polygon fill="black" stroke="black" points="3669.5,-32597.3 3666,-32587.3 3662.5,-32597.3 3669.5,-32597.3"/>
</g>
<!-- layer_4_proj -->
<g id="node104" class="node">
<title>layer_4_proj</title>
<polygon fill="lightblue" stroke="black" points="3881.5,-32302.16 3484.5,-32302.16 3484.5,-32234.16 3881.5,-32234.16 3881.5,-32302.16"/>
<text text-anchor="middle" x="3683" y="-32286.96" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3683" y="-32271.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3683" y="-32256.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3683" y="-32241.96" font-family="Times,serif" font-size="14.00">GPU: 64</text>
</g>
<!-- layer_4_attn&#45;&gt;layer_4_proj -->
<g id="edge171" class="edge">
<title>layer_4_attn&#45;&gt;layer_4_proj</title>
<path fill="none" stroke="black" d="M3671,-32519.07C3671,-32519.07 3671,-32312.3 3671,-32312.3"/>
<polygon fill="black" stroke="black" points="3674.5,-32312.3 3671,-32302.3 3667.5,-32312.3 3674.5,-32312.3"/>
</g>
<!-- layer_4_proj&#45;&gt;layer_4_add_norm1 -->
<g id="edge172" class="edge">
<title>layer_4_proj&#45;&gt;layer_4_add_norm1</title>
<path fill="none" stroke="black" d="M3805.75,-32234.07C3805.75,-32234.07 3805.75,-32027.3 3805.75,-32027.3"/>
<polygon fill="black" stroke="black" points="3809.25,-32027.3 3805.75,-32017.3 3802.25,-32027.3 3809.25,-32027.3"/>
</g>
<!-- layer_4_gate -->
<g id="node106" class="node">
<title>layer_4_gate</title>
<polygon fill="yellow" stroke="black" points="3837.73,-31732.16 3260.71,-31732.16 3112.27,-31596.16 3689.29,-31596.16 3837.73,-31732.16"/>
<text text-anchor="middle" x="3475" y="-31682.96" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3475" y="-31667.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-31652.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3475" y="-31637.96" font-family="Times,serif" font-size="14.00">GPU: 64</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_gate -->
<g id="edge174" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_gate</title>
<path fill="none" stroke="black" d="M3783.93,-31949.02C3783.93,-31949.02 3783.93,-31742.28 3783.93,-31742.28"/>
<polygon fill="black" stroke="black" points="3787.43,-31742.28 3783.93,-31732.28 3780.43,-31742.28 3787.43,-31742.28"/>
</g>
<!-- layer_4_scatter -->
<g id="node107" class="node">
<title>layer_4_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3475" cy="-31317.08" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3475" y="-31335.88" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3475" y="-31320.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-31305.88" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-31290.88" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_scatter -->
<g id="edge175" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_scatter</title>
<path fill="none" stroke="black" d="M3934.68,-31948.84C3934.68,-31817.33 3934.68,-31353 3934.68,-31353 3934.68,-31353 3649.66,-31353 3649.66,-31353"/>
<polygon fill="black" stroke="black" points="3649.66,-31349.5 3639.66,-31353 3649.66,-31356.5 3649.66,-31349.5"/>
</g>
<!-- layer_4_add_norm2 -->
<g id="node125" class="node">
<title>layer_4_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4471,-30425.83 4109,-30425.83 4109,-30357.83 4471,-30357.83 4471,-30425.83"/>
<text text-anchor="middle" x="4290" y="-30410.63" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4290" y="-30395.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4290" y="-30380.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4290" y="-30365.63" font-family="Times,serif" font-size="14.00">GPU: 64</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_add_norm2 -->
<g id="edge210" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4061.75,-31949.06C4061.75,-31719.01 4061.75,-30403 4061.75,-30403 4061.75,-30403 4098.77,-30403 4098.77,-30403"/>
<polygon fill="black" stroke="black" points="4098.77,-30406.5 4108.77,-30403 4098.77,-30399.5 4098.77,-30406.5"/>
<text text-anchor="middle" x="6447" y="-31149.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_scatter -->
<g id="edge176" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3475,-31596C3475,-31596 3475,-31375.27 3475,-31375.27"/>
<polygon fill="black" stroke="black" points="3478.5,-31375.27 3475,-31365.27 3471.5,-31375.27 3478.5,-31375.27"/>
<text text-anchor="middle" x="3518.5" y="-31476.96" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_4_expert_0 -->
<g id="node108" class="node">
<title>layer_4_expert_0</title>
<polygon fill="lightblue" stroke="black" points="476.5,-31038 153.5,-31038 153.5,-30970 476.5,-30970 476.5,-31038"/>
<text text-anchor="middle" x="315" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="315" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="315" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="315" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 64</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_0 -->
<g id="edge177" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_0</title>
<path fill="none" stroke="black" d="M3310.25,-31353C2668.98,-31353 375,-31353 375,-31353 375,-31353 375,-31048.1 375,-31048.1"/>
<polygon fill="black" stroke="black" points="378.5,-31048.1 375,-31038.1 371.5,-31048.1 378.5,-31048.1"/>
<text text-anchor="middle" x="539.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_64</text>
</g>
<!-- layer_4_expert_1 -->
<g id="node110" class="node">
<title>layer_4_expert_1</title>
<polygon fill="lightblue" stroke="black" points="871.5,-31038 548.5,-31038 548.5,-30970 871.5,-30970 871.5,-31038"/>
<text text-anchor="middle" x="710" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="710" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="710" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="710" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 65</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_1 -->
<g id="edge179" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_1</title>
<path fill="none" stroke="black" d="M3260.2,-31341C2620.15,-31341 770,-31341 770,-31341 770,-31341 770,-31048.16 770,-31048.16"/>
<polygon fill="black" stroke="black" points="773.5,-31048.16 770,-31038.16 766.5,-31048.16 773.5,-31048.16"/>
<text text-anchor="middle" x="880.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_65</text>
</g>
<!-- layer_4_expert_2 -->
<g id="node111" class="node">
<title>layer_4_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1266.5,-31038 943.5,-31038 943.5,-30970 1266.5,-30970 1266.5,-31038"/>
<text text-anchor="middle" x="1105" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1105" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1105" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1105" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 66</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_2 -->
<g id="edge181" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_2</title>
<path fill="none" stroke="black" d="M3235.14,-31329C2644.03,-31329 1165,-31329 1165,-31329 1165,-31329 1165,-31048.16 1165,-31048.16"/>
<polygon fill="black" stroke="black" points="1168.5,-31048.16 1165,-31038.16 1161.5,-31048.16 1168.5,-31048.16"/>
<text text-anchor="middle" x="1167.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_66</text>
</g>
<!-- layer_4_expert_3 -->
<g id="node112" class="node">
<title>layer_4_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1661.5,-31038 1338.5,-31038 1338.5,-30970 1661.5,-30970 1661.5,-31038"/>
<text text-anchor="middle" x="1500" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1500" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1500" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1500" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 67</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_3 -->
<g id="edge183" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_3</title>
<path fill="none" stroke="black" d="M3227.04,-31317C2708.98,-31317 1559.5,-31317 1559.5,-31317 1559.5,-31317 1559.5,-31048.09 1559.5,-31048.09"/>
<polygon fill="black" stroke="black" points="1563,-31048.09 1559.5,-31038.09 1556,-31048.09 1563,-31048.09"/>
<text text-anchor="middle" x="2040.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_67</text>
</g>
<!-- layer_4_expert_4 -->
<g id="node113" class="node">
<title>layer_4_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2056.5,-31038 1733.5,-31038 1733.5,-30970 2056.5,-30970 2056.5,-31038"/>
<text text-anchor="middle" x="1895" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1895" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1895" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1895" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 68</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_4 -->
<g id="edge185" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_4</title>
<path fill="none" stroke="black" d="M3235.18,-31305C2808.42,-31305 1961.5,-31305 1961.5,-31305 1961.5,-31305 1961.5,-31048.23 1961.5,-31048.23"/>
<polygon fill="black" stroke="black" points="1965,-31048.23 1961.5,-31038.23 1958,-31048.23 1965,-31048.23"/>
<text text-anchor="middle" x="2554.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_68</text>
</g>
<!-- layer_4_expert_5 -->
<g id="node114" class="node">
<title>layer_4_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2451.5,-31038 2128.5,-31038 2128.5,-30970 2451.5,-30970 2451.5,-31038"/>
<text text-anchor="middle" x="2290" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2290" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2290" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2290" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 69</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_5 -->
<g id="edge187" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_5</title>
<path fill="none" stroke="black" d="M3260.75,-31293C2934.34,-31293 2350,-31293 2350,-31293 2350,-31293 2350,-31048 2350,-31048"/>
<polygon fill="black" stroke="black" points="2353.5,-31048 2350,-31038 2346.5,-31048 2353.5,-31048"/>
<text text-anchor="middle" x="2889.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_69</text>
</g>
<!-- layer_4_expert_6 -->
<g id="node115" class="node">
<title>layer_4_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2846.5,-31038 2523.5,-31038 2523.5,-30970 2846.5,-30970 2846.5,-31038"/>
<text text-anchor="middle" x="2685" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2685" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2685" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2685" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 70</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_6 -->
<g id="edge189" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_6</title>
<path fill="none" stroke="black" d="M3311.17,-31281C3095.95,-31281 2745,-31281 2745,-31281 2745,-31281 2745,-31048.24 2745,-31048.24"/>
<polygon fill="black" stroke="black" points="2748.5,-31048.24 2745,-31038.24 2741.5,-31048.24 2748.5,-31048.24"/>
<text text-anchor="middle" x="3135.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_70</text>
</g>
<!-- layer_4_expert_7 -->
<g id="node116" class="node">
<title>layer_4_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3241.5,-31038 2918.5,-31038 2918.5,-30970 3241.5,-30970 3241.5,-31038"/>
<text text-anchor="middle" x="3080" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3080" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3080" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3080" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 71</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_7 -->
<g id="edge191" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_7</title>
<path fill="none" stroke="black" d="M3234.51,-31305.57C3234.51,-31305.57 3234.51,-31048.01 3234.51,-31048.01"/>
<polygon fill="black" stroke="black" points="3238.01,-31048.01 3234.51,-31038.01 3231.01,-31048.01 3238.01,-31048.01"/>
<text text-anchor="middle" x="3336.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_71</text>
</g>
<!-- layer_4_expert_8 -->
<g id="node117" class="node">
<title>layer_4_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3636.5,-31038 3313.5,-31038 3313.5,-30970 3636.5,-30970 3636.5,-31038"/>
<text text-anchor="middle" x="3475" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3475" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 72</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_8 -->
<g id="edge193" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_8</title>
<path fill="none" stroke="black" d="M3475,-31268.85C3475,-31268.85 3475,-31048.26 3475,-31048.26"/>
<polygon fill="black" stroke="black" points="3478.5,-31048.26 3475,-31038.26 3471.5,-31048.26 3478.5,-31048.26"/>
<text text-anchor="middle" x="3514.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_72</text>
</g>
<!-- layer_4_expert_9 -->
<g id="node118" class="node">
<title>layer_4_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4031.5,-31038 3708.5,-31038 3708.5,-30970 4031.5,-30970 4031.5,-31038"/>
<text text-anchor="middle" x="3870" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3870" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3870" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3870" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 73</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_9 -->
<g id="edge195" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_9</title>
<path fill="none" stroke="black" d="M3715.49,-31305.57C3715.49,-31305.57 3715.49,-31048.01 3715.49,-31048.01"/>
<polygon fill="black" stroke="black" points="3718.99,-31048.01 3715.49,-31038.01 3711.99,-31048.01 3718.99,-31048.01"/>
<text text-anchor="middle" x="3790.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_73</text>
</g>
<!-- layer_4_expert_10 -->
<g id="node119" class="node">
<title>layer_4_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4426.5,-31038 4103.5,-31038 4103.5,-30970 4426.5,-30970 4426.5,-31038"/>
<text text-anchor="middle" x="4265" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4265" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4265" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4265" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 74</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_10 -->
<g id="edge197" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_10</title>
<path fill="none" stroke="black" d="M3638.81,-31281C3832.09,-31281 4127.5,-31281 4127.5,-31281 4127.5,-31281 4127.5,-31048.24 4127.5,-31048.24"/>
<polygon fill="black" stroke="black" points="4131,-31048.24 4127.5,-31038.24 4124,-31048.24 4131,-31048.24"/>
<text text-anchor="middle" x="4125.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_74</text>
</g>
<!-- layer_4_expert_11 -->
<g id="node120" class="node">
<title>layer_4_expert_11</title>
<polygon fill="lightblue" stroke="black" points="4821.5,-31038 4498.5,-31038 4498.5,-30970 4821.5,-30970 4821.5,-31038"/>
<text text-anchor="middle" x="4660" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4660" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4660" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4660" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 75</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_11 -->
<g id="edge199" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_11</title>
<path fill="none" stroke="black" d="M3689.5,-31293C3995.96,-31293 4522.5,-31293 4522.5,-31293 4522.5,-31293 4522.5,-31048 4522.5,-31048"/>
<polygon fill="black" stroke="black" points="4526,-31048 4522.5,-31038 4519,-31048 4526,-31048"/>
<text text-anchor="middle" x="4490.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_75</text>
</g>
<!-- layer_4_expert_12 -->
<g id="node121" class="node">
<title>layer_4_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5216.5,-31038 4893.5,-31038 4893.5,-30970 5216.5,-30970 5216.5,-31038"/>
<text text-anchor="middle" x="5055" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5055" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5055" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5055" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 76</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_12 -->
<g id="edge201" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_12</title>
<path fill="none" stroke="black" d="M3714.82,-31305C4125,-31305 4917.5,-31305 4917.5,-31305 4917.5,-31305 4917.5,-31048.23 4917.5,-31048.23"/>
<polygon fill="black" stroke="black" points="4921,-31048.23 4917.5,-31038.23 4914,-31048.23 4921,-31048.23"/>
<text text-anchor="middle" x="4870.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_76</text>
</g>
<!-- layer_4_expert_13 -->
<g id="node122" class="node">
<title>layer_4_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5611.5,-31038 5288.5,-31038 5288.5,-30970 5611.5,-30970 5611.5,-31038"/>
<text text-anchor="middle" x="5450" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5450" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5450" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5450" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 77</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_13 -->
<g id="edge203" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_13</title>
<path fill="none" stroke="black" d="M3722.81,-31317C4224.37,-31317 5312.5,-31317 5312.5,-31317 5312.5,-31317 5312.5,-31048.09 5312.5,-31048.09"/>
<polygon fill="black" stroke="black" points="5316,-31048.09 5312.5,-31038.09 5309,-31048.09 5316,-31048.09"/>
<text text-anchor="middle" x="5258.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_77</text>
</g>
<!-- layer_4_expert_14 -->
<g id="node123" class="node">
<title>layer_4_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6006.5,-31038 5683.5,-31038 5683.5,-30970 6006.5,-30970 6006.5,-31038"/>
<text text-anchor="middle" x="5845" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5845" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5845" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5845" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 78</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_14 -->
<g id="edge205" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_14</title>
<path fill="none" stroke="black" d="M3714.98,-31329C4291.58,-31329 5707.5,-31329 5707.5,-31329 5707.5,-31329 5707.5,-31048.16 5707.5,-31048.16"/>
<polygon fill="black" stroke="black" points="5711,-31048.16 5707.5,-31038.16 5704,-31048.16 5711,-31048.16"/>
<text text-anchor="middle" x="5649.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_78</text>
</g>
<!-- layer_4_expert_15 -->
<g id="node124" class="node">
<title>layer_4_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6401.5,-31038 6078.5,-31038 6078.5,-30970 6401.5,-30970 6401.5,-31038"/>
<text text-anchor="middle" x="6240" y="-31022.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6240" y="-31007.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6240" y="-30992.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6240" y="-30977.8" font-family="Times,serif" font-size="14.00">GPU: 79</text>
</g>
<!-- layer_4_scatter&#45;&gt;layer_4_expert_15 -->
<g id="edge207" class="edge">
<title>layer_4_scatter&#45;&gt;layer_4_expert_15</title>
<path fill="none" stroke="black" d="M3689.74,-31341C4317.01,-31341 6102.5,-31341 6102.5,-31341 6102.5,-31341 6102.5,-31048.16 6102.5,-31048.16"/>
<polygon fill="black" stroke="black" points="6106,-31048.16 6102.5,-31038.16 6099,-31048.16 6106,-31048.16"/>
<text text-anchor="middle" x="6160.5" y="-31149.8" font-family="Times,serif" font-size="14.00">to_GPU_79</text>
</g>
<!-- layer_4_gather -->
<g id="node109" class="node">
<title>layer_4_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3475" cy="-30690.91" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3475" y="-30709.71" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3475" y="-30694.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-30679.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-30664.71" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_4_expert_0&#45;&gt;layer_4_gather -->
<g id="edge178" class="edge">
<title>layer_4_expert_0&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M467,-30969.8C467,-30881.73 467,-30654 467,-30654 467,-30654 3300.87,-30654 3300.87,-30654"/>
<polygon fill="black" stroke="black" points="3300.87,-30657.5 3310.87,-30654 3300.87,-30650.5 3300.87,-30657.5"/>
<text text-anchor="middle" x="663" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_64</text>
</g>
<!-- layer_4_gather&#45;&gt;layer_4_add_norm2 -->
<g id="edge209" class="edge">
<title>layer_4_gather&#45;&gt;layer_4_add_norm2</title>
<path fill="none" stroke="black" d="M3585.55,-30647.35C3585.55,-30561.79 3585.55,-30380 3585.55,-30380 3585.55,-30380 4098.59,-30380 4098.59,-30380"/>
<polygon fill="black" stroke="black" points="4098.59,-30383.5 4108.59,-30380 4098.59,-30376.5 4098.59,-30383.5"/>
</g>
<!-- layer_4_expert_1&#45;&gt;layer_4_gather -->
<g id="edge180" class="edge">
<title>layer_4_expert_1&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M862,-30969.73C862,-30883.8 862,-30666 862,-30666 862,-30666 3245.87,-30666 3245.87,-30666"/>
<polygon fill="black" stroke="black" points="3245.87,-30669.5 3255.87,-30666 3245.87,-30662.5 3245.87,-30669.5"/>
<text text-anchor="middle" x="1137" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_65</text>
</g>
<!-- layer_4_expert_2&#45;&gt;layer_4_gather -->
<g id="edge182" class="edge">
<title>layer_4_expert_2&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M1257,-30969.73C1257,-30886.03 1257,-30678 1257,-30678 1257,-30678 3218.36,-30678 3218.36,-30678"/>
<polygon fill="black" stroke="black" points="3218.36,-30681.5 3228.36,-30678 3218.36,-30674.5 3218.36,-30681.5"/>
<text text-anchor="middle" x="1422" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_66</text>
</g>
<!-- layer_4_expert_3&#45;&gt;layer_4_gather -->
<g id="edge184" class="edge">
<title>layer_4_expert_3&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M1628,-30969.8C1628,-30888.41 1628,-30690 1628,-30690 1628,-30690 3208.67,-30690 3208.67,-30690"/>
<polygon fill="black" stroke="black" points="3208.67,-30693.5 3218.67,-30690 3208.67,-30686.5 3208.67,-30693.5"/>
<text text-anchor="middle" x="1865" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_67</text>
</g>
<!-- layer_4_expert_4&#45;&gt;layer_4_gather -->
<g id="edge186" class="edge">
<title>layer_4_expert_4&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M1984.5,-30969.94C1984.5,-30890.96 1984.5,-30702 1984.5,-30702 1984.5,-30702 3215.52,-30702 3215.52,-30702"/>
<polygon fill="black" stroke="black" points="3215.52,-30705.5 3225.52,-30702 3215.52,-30698.5 3215.52,-30705.5"/>
<text text-anchor="middle" x="2150" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_68</text>
</g>
<!-- layer_4_expert_5&#45;&gt;layer_4_gather -->
<g id="edge188" class="edge">
<title>layer_4_expert_5&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M2442,-30969.88C2442,-30893.22 2442,-30714 2442,-30714 2442,-30714 3240.22,-30714 3240.22,-30714"/>
<polygon fill="black" stroke="black" points="3240.22,-30717.5 3250.22,-30714 3240.22,-30710.5 3240.22,-30717.5"/>
<text text-anchor="middle" x="2531" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_69</text>
</g>
<!-- layer_4_expert_6&#45;&gt;layer_4_gather -->
<g id="edge190" class="edge">
<title>layer_4_expert_6&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M2837,-30969.91C2837,-30895.68 2837,-30726 2837,-30726 2837,-30726 3289.82,-30726 3289.82,-30726"/>
<polygon fill="black" stroke="black" points="3289.82,-30729.5 3299.82,-30726 3289.82,-30722.5 3289.82,-30729.5"/>
<text text-anchor="middle" x="2899" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_70</text>
</g>
<!-- layer_4_expert_7&#45;&gt;layer_4_gather -->
<g id="edge192" class="edge">
<title>layer_4_expert_7&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M3230.26,-30969.9C3230.26,-30969.9 3230.26,-30715.17 3230.26,-30715.17"/>
<polygon fill="black" stroke="black" points="3233.76,-30715.17 3230.26,-30705.17 3226.76,-30715.17 3233.76,-30715.17"/>
<text text-anchor="middle" x="3239" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_71</text>
</g>
<!-- layer_4_expert_8&#45;&gt;layer_4_gather -->
<g id="edge194" class="edge">
<title>layer_4_expert_8&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M3475,-30969.9C3475,-30969.9 3475,-30749 3475,-30749"/>
<polygon fill="black" stroke="black" points="3478.5,-30749 3475,-30739 3471.5,-30749 3478.5,-30749"/>
<text text-anchor="middle" x="3524" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_72</text>
</g>
<!-- layer_4_expert_9&#45;&gt;layer_4_gather -->
<g id="edge196" class="edge">
<title>layer_4_expert_9&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M3719.74,-30969.9C3719.74,-30969.9 3719.74,-30715.17 3719.74,-30715.17"/>
<polygon fill="black" stroke="black" points="3723.24,-30715.17 3719.74,-30705.17 3716.24,-30715.17 3723.24,-30715.17"/>
<text text-anchor="middle" x="3809" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_73</text>
</g>
<!-- layer_4_expert_10&#45;&gt;layer_4_gather -->
<g id="edge198" class="edge">
<title>layer_4_expert_10&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M4267.75,-30969.79C4267.75,-30895.29 4267.75,-30725 4267.75,-30725 4267.75,-30725 3665.88,-30725 3665.88,-30725"/>
<polygon fill="black" stroke="black" points="3665.88,-30721.5 3655.88,-30725 3665.88,-30728.5 3665.88,-30721.5"/>
<text text-anchor="middle" x="4149" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_74</text>
</g>
<!-- layer_4_expert_11&#45;&gt;layer_4_gather -->
<g id="edge200" class="edge">
<title>layer_4_expert_11&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M4626.5,-30969.81C4626.5,-30892.52 4626.5,-30711 4626.5,-30711 4626.5,-30711 3717.68,-30711 3717.68,-30711"/>
<polygon fill="black" stroke="black" points="3717.68,-30707.5 3707.68,-30711 3717.68,-30714.5 3717.68,-30707.5"/>
<text text-anchor="middle" x="4516" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_75</text>
</g>
<!-- layer_4_expert_12&#45;&gt;layer_4_gather -->
<g id="edge202" class="edge">
<title>layer_4_expert_12&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M5021.5,-30969.97C5021.5,-30890.04 5021.5,-30697 5021.5,-30697 5021.5,-30697 3739.07,-30697 3739.07,-30697"/>
<polygon fill="black" stroke="black" points="3739.07,-30693.5 3729.07,-30697 3739.07,-30700.5 3739.07,-30693.5"/>
<text text-anchor="middle" x="4898" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_76</text>
</g>
<!-- layer_4_expert_13&#45;&gt;layer_4_gather -->
<g id="edge204" class="edge">
<title>layer_4_expert_13&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M5416.5,-30969.75C5416.5,-30887.2 5416.5,-30684 5416.5,-30684 5416.5,-30684 3738.32,-30684 3738.32,-30684"/>
<polygon fill="black" stroke="black" points="3738.32,-30680.5 3728.32,-30684 3738.32,-30687.5 3738.32,-30680.5"/>
<text text-anchor="middle" x="5389" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_77</text>
</g>
<!-- layer_4_expert_14&#45;&gt;layer_4_gather -->
<g id="edge206" class="edge">
<title>layer_4_expert_14&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M5811.5,-30969.82C5811.5,-30884.7 5811.5,-30670 5811.5,-30670 5811.5,-30670 3715.7,-30670 3715.7,-30670"/>
<polygon fill="black" stroke="black" points="3715.7,-30666.5 3705.7,-30670 3715.7,-30673.5 3715.7,-30666.5"/>
<text text-anchor="middle" x="5729" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_78</text>
</g>
<!-- layer_4_expert_15&#45;&gt;layer_4_gather -->
<g id="edge208" class="edge">
<title>layer_4_expert_15&#45;&gt;layer_4_gather</title>
<path fill="none" stroke="black" d="M6206.5,-30970C6206.5,-30882.43 6206.5,-30656 6206.5,-30656 6206.5,-30656 3661.07,-30656 3661.07,-30656"/>
<polygon fill="black" stroke="black" points="3661.07,-30652.5 3651.07,-30656 3661.07,-30659.5 3661.07,-30652.5"/>
<text text-anchor="middle" x="6096" y="-30850.8" font-family="Times,serif" font-size="14.00">from_GPU_79</text>
</g>
<!-- layer_5_qkv -->
<g id="node127" class="node">
<title>layer_5_qkv</title>
<polygon fill="lightblue" stroke="black" points="4202.5,-30140.83 3793.5,-30140.83 3793.5,-30072.83 4202.5,-30072.83 4202.5,-30140.83"/>
<text text-anchor="middle" x="3998" y="-30125.63" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3998" y="-30110.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3998" y="-30095.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3998" y="-30080.63" font-family="Times,serif" font-size="14.00">GPU: 80</text>
</g>
<!-- layer_4_add_norm2&#45;&gt;layer_5_qkv -->
<g id="edge211" class="edge">
<title>layer_4_add_norm2&#45;&gt;layer_5_qkv</title>
<path fill="none" stroke="black" d="M4155.75,-30357.74C4155.75,-30357.74 4155.75,-30150.96 4155.75,-30150.96"/>
<polygon fill="black" stroke="black" points="4159.25,-30150.96 4155.75,-30140.96 4152.25,-30150.96 4159.25,-30150.96"/>
</g>
<!-- layer_5_add_norm1 -->
<g id="node130" class="node">
<title>layer_5_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4420,-29285.83 4058,-29285.83 4058,-29217.83 4420,-29217.83 4420,-29285.83"/>
<text text-anchor="middle" x="4239" y="-29270.63" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4239" y="-29255.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4239" y="-29240.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4239" y="-29225.63" font-family="Times,serif" font-size="14.00">GPU: 80</text>
</g>
<!-- layer_4_add_norm2&#45;&gt;layer_5_add_norm1 -->
<g id="edge215" class="edge">
<title>layer_4_add_norm2&#45;&gt;layer_5_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4314.75,-30357.71C4314.75,-30357.71 4314.75,-29296.09 4314.75,-29296.09"/>
<polygon fill="black" stroke="black" points="4318.25,-29296.09 4314.75,-29286.09 4311.25,-29296.09 4318.25,-29296.09"/>
<text text-anchor="middle" x="4358" y="-29818.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_4_mha -->
<g id="node126" class="node">
<title>layer_4_mha</title>
<polygon fill="lightblue" stroke="black" points="1866.5,-32872.16 1457.5,-32872.16 1457.5,-32804.16 1866.5,-32804.16 1866.5,-32872.16"/>
<text text-anchor="middle" x="1662" y="-32856.96" font-family="Times,serif" font-size="14.00">MHA Layer 4</text>
<text text-anchor="middle" x="1662" y="-32841.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1662" y="-32826.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1662" y="-32811.96" font-family="Times,serif" font-size="14.00">GPU: 64</text>
</g>
<!-- layer_5_attn -->
<g id="node128" class="node">
<title>layer_5_attn</title>
<polygon fill="lightblue" stroke="black" points="4184.5,-29855.83 3775.5,-29855.83 3775.5,-29787.83 4184.5,-29787.83 4184.5,-29855.83"/>
<text text-anchor="middle" x="3980" y="-29840.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3980" y="-29825.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3980" y="-29810.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3980" y="-29795.63" font-family="Times,serif" font-size="14.00">GPU: 80</text>
</g>
<!-- layer_5_qkv&#45;&gt;layer_5_attn -->
<g id="edge212" class="edge">
<title>layer_5_qkv&#45;&gt;layer_5_attn</title>
<path fill="none" stroke="black" d="M3989,-30072.74C3989,-30072.74 3989,-29865.96 3989,-29865.96"/>
<polygon fill="black" stroke="black" points="3992.5,-29865.96 3989,-29855.96 3985.5,-29865.96 3992.5,-29865.96"/>
</g>
<!-- layer_5_proj -->
<g id="node129" class="node">
<title>layer_5_proj</title>
<polygon fill="lightblue" stroke="black" points="4209.5,-29570.83 3812.5,-29570.83 3812.5,-29502.83 4209.5,-29502.83 4209.5,-29570.83"/>
<text text-anchor="middle" x="4011" y="-29555.63" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="4011" y="-29540.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4011" y="-29525.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4011" y="-29510.63" font-family="Times,serif" font-size="14.00">GPU: 80</text>
</g>
<!-- layer_5_attn&#45;&gt;layer_5_proj -->
<g id="edge213" class="edge">
<title>layer_5_attn&#45;&gt;layer_5_proj</title>
<path fill="none" stroke="black" d="M3998.5,-29787.74C3998.5,-29787.74 3998.5,-29580.96 3998.5,-29580.96"/>
<polygon fill="black" stroke="black" points="4002,-29580.96 3998.5,-29570.96 3995,-29580.96 4002,-29580.96"/>
</g>
<!-- layer_5_proj&#45;&gt;layer_5_add_norm1 -->
<g id="edge214" class="edge">
<title>layer_5_proj&#45;&gt;layer_5_add_norm1</title>
<path fill="none" stroke="black" d="M4133.75,-29502.74C4133.75,-29502.74 4133.75,-29295.96 4133.75,-29295.96"/>
<polygon fill="black" stroke="black" points="4137.25,-29295.96 4133.75,-29285.96 4130.25,-29295.96 4137.25,-29295.96"/>
</g>
<!-- layer_5_gate -->
<g id="node131" class="node">
<title>layer_5_gate</title>
<polygon fill="yellow" stroke="black" points="4165.73,-29000.83 3588.71,-29000.83 3440.27,-28864.83 4017.29,-28864.83 4165.73,-29000.83"/>
<text text-anchor="middle" x="3803" y="-28951.63" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3803" y="-28936.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3803" y="-28921.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3803" y="-28906.63" font-family="Times,serif" font-size="14.00">GPU: 80</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_gate -->
<g id="edge216" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_gate</title>
<path fill="none" stroke="black" d="M4111.93,-29217.69C4111.93,-29217.69 4111.93,-29010.95 4111.93,-29010.95"/>
<polygon fill="black" stroke="black" points="4115.43,-29010.95 4111.93,-29000.95 4108.43,-29010.95 4115.43,-29010.95"/>
</g>
<!-- layer_5_scatter -->
<g id="node132" class="node">
<title>layer_5_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3803" cy="-28585.75" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3803" y="-28604.55" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3803" y="-28589.55" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3803" y="-28574.55" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3803" y="-28559.55" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_scatter -->
<g id="edge217" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_scatter</title>
<path fill="none" stroke="black" d="M4262.68,-29217.47C4262.68,-29085.83 4262.68,-28621 4262.68,-28621 4262.68,-28621 3981.56,-28621 3981.56,-28621"/>
<polygon fill="black" stroke="black" points="3981.56,-28617.5 3971.56,-28621 3981.56,-28624.5 3981.56,-28617.5"/>
</g>
<!-- layer_5_add_norm2 -->
<g id="node150" class="node">
<title>layer_5_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4061,-27694.5 3699,-27694.5 3699,-27626.5 4061,-27626.5 4061,-27694.5"/>
<text text-anchor="middle" x="3880" y="-27679.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3880" y="-27664.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3880" y="-27649.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3880" y="-27634.3" font-family="Times,serif" font-size="14.00">GPU: 80</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_add_norm2 -->
<g id="edge252" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4383.5,-29217.47C4383.5,-28985.73 4383.5,-27660 4383.5,-27660 4383.5,-27660 4071.06,-27660 4071.06,-27660"/>
<polygon fill="black" stroke="black" points="4071.06,-27656.5 4061.06,-27660 4071.06,-27663.5 4071.06,-27656.5"/>
<text text-anchor="middle" x="6775" y="-28418.46" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_scatter -->
<g id="edge218" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803,-28864.67C3803,-28864.67 3803,-28643.93 3803,-28643.93"/>
<polygon fill="black" stroke="black" points="3806.5,-28643.93 3803,-28633.93 3799.5,-28643.93 3806.5,-28643.93"/>
<text text-anchor="middle" x="3846.5" y="-28745.63" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_5_expert_0 -->
<g id="node133" class="node">
<title>layer_5_expert_0</title>
<polygon fill="lightblue" stroke="black" points="804.5,-28306.66 481.5,-28306.66 481.5,-28238.66 804.5,-28238.66 804.5,-28306.66"/>
<text text-anchor="middle" x="643" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="643" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="643" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="643" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 80</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_0 -->
<g id="edge219" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_0</title>
<path fill="none" stroke="black" d="M3634.63,-28621C2984.84,-28621 676.5,-28621 676.5,-28621 676.5,-28621 676.5,-28316.7 676.5,-28316.7"/>
<polygon fill="black" stroke="black" points="680,-28316.7 676.5,-28306.7 673,-28316.7 680,-28316.7"/>
<text text-anchor="middle" x="867.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_80</text>
</g>
<!-- layer_5_expert_1 -->
<g id="node135" class="node">
<title>layer_5_expert_1</title>
<polygon fill="lightblue" stroke="black" points="1199.5,-28306.66 876.5,-28306.66 876.5,-28238.66 1199.5,-28238.66 1199.5,-28306.66"/>
<text text-anchor="middle" x="1038" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1038" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1038" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1038" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 81</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_1 -->
<g id="edge221" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_1</title>
<path fill="none" stroke="black" d="M3586.09,-28609C2939.77,-28609 1071.5,-28609 1071.5,-28609 1071.5,-28609 1071.5,-28316.76 1071.5,-28316.76"/>
<polygon fill="black" stroke="black" points="1075,-28316.76 1071.5,-28306.76 1068,-28316.76 1075,-28316.76"/>
<text text-anchor="middle" x="1208.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_81</text>
</g>
<!-- layer_5_expert_2 -->
<g id="node136" class="node">
<title>layer_5_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1594.5,-28306.66 1271.5,-28306.66 1271.5,-28238.66 1594.5,-28238.66 1594.5,-28306.66"/>
<text text-anchor="middle" x="1433" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1433" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1433" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1433" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 82</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_2 -->
<g id="edge223" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_2</title>
<path fill="none" stroke="black" d="M3562.3,-28597C2965.7,-28597 1466.5,-28597 1466.5,-28597 1466.5,-28597 1466.5,-28316.76 1466.5,-28316.76"/>
<polygon fill="black" stroke="black" points="1470,-28316.76 1466.5,-28306.76 1463,-28316.76 1470,-28316.76"/>
<text text-anchor="middle" x="1495.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_82</text>
</g>
<!-- layer_5_expert_3 -->
<g id="node137" class="node">
<title>layer_5_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1989.5,-28306.66 1666.5,-28306.66 1666.5,-28238.66 1989.5,-28238.66 1989.5,-28306.66"/>
<text text-anchor="middle" x="1828" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1828" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1828" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1828" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 83</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_3 -->
<g id="edge225" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_3</title>
<path fill="none" stroke="black" d="M3555.15,-28585C3050.5,-28585 1951,-28585 1951,-28585 1951,-28585 1951,-28316.68 1951,-28316.68"/>
<polygon fill="black" stroke="black" points="1954.5,-28316.68 1951,-28306.68 1947.5,-28316.68 1954.5,-28316.68"/>
<text text-anchor="middle" x="2368.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_83</text>
</g>
<!-- layer_5_expert_4 -->
<g id="node138" class="node">
<title>layer_5_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2384.5,-28306.66 2061.5,-28306.66 2061.5,-28238.66 2384.5,-28238.66 2384.5,-28306.66"/>
<text text-anchor="middle" x="2223" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2223" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2223" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2223" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 84</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_4 -->
<g id="edge227" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_4</title>
<path fill="none" stroke="black" d="M3563.97,-28573C3152.25,-28573 2353,-28573 2353,-28573 2353,-28573 2353,-28316.82 2353,-28316.82"/>
<polygon fill="black" stroke="black" points="2356.5,-28316.82 2353,-28306.82 2349.5,-28316.82 2356.5,-28316.82"/>
<text text-anchor="middle" x="2882.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_84</text>
</g>
<!-- layer_5_expert_5 -->
<g id="node139" class="node">
<title>layer_5_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2779.5,-28306.66 2456.5,-28306.66 2456.5,-28238.66 2779.5,-28238.66 2779.5,-28306.66"/>
<text text-anchor="middle" x="2618" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2618" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2618" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2618" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 85</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_5 -->
<g id="edge229" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_5</title>
<path fill="none" stroke="black" d="M3590.79,-28561C3258.14,-28561 2651.5,-28561 2651.5,-28561 2651.5,-28561 2651.5,-28316.87 2651.5,-28316.87"/>
<polygon fill="black" stroke="black" points="2655,-28316.87 2651.5,-28306.87 2648,-28316.87 2655,-28316.87"/>
<text text-anchor="middle" x="3217.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_85</text>
</g>
<!-- layer_5_expert_6 -->
<g id="node140" class="node">
<title>layer_5_expert_6</title>
<polygon fill="lightblue" stroke="black" points="3174.5,-28306.66 2851.5,-28306.66 2851.5,-28238.66 3174.5,-28238.66 3174.5,-28306.66"/>
<text text-anchor="middle" x="3013" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3013" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3013" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3013" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 86</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_6 -->
<g id="edge231" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_6</title>
<path fill="none" stroke="black" d="M3643.03,-28549C3421.02,-28549 3046.5,-28549 3046.5,-28549 3046.5,-28549 3046.5,-28316.82 3046.5,-28316.82"/>
<polygon fill="black" stroke="black" points="3050,-28316.82 3046.5,-28306.82 3043,-28316.82 3050,-28316.82"/>
<text text-anchor="middle" x="3463.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_86</text>
</g>
<!-- layer_5_expert_7 -->
<g id="node141" class="node">
<title>layer_5_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3569.5,-28306.66 3246.5,-28306.66 3246.5,-28238.66 3569.5,-28238.66 3569.5,-28306.66"/>
<text text-anchor="middle" x="3408" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3408" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3408" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3408" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 87</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_7 -->
<g id="edge233" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_7</title>
<path fill="none" stroke="black" d="M3562.51,-28574.23C3562.51,-28574.23 3562.51,-28316.67 3562.51,-28316.67"/>
<polygon fill="black" stroke="black" points="3566.01,-28316.67 3562.51,-28306.67 3559.01,-28316.67 3566.01,-28316.67"/>
<text text-anchor="middle" x="3664.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_87</text>
</g>
<!-- layer_5_expert_8 -->
<g id="node142" class="node">
<title>layer_5_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3964.5,-28306.66 3641.5,-28306.66 3641.5,-28238.66 3964.5,-28238.66 3964.5,-28306.66"/>
<text text-anchor="middle" x="3803" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3803" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3803" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3803" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 88</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_8 -->
<g id="edge235" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_8</title>
<path fill="none" stroke="black" d="M3803,-28537.51C3803,-28537.51 3803,-28316.93 3803,-28316.93"/>
<polygon fill="black" stroke="black" points="3806.5,-28316.93 3803,-28306.93 3799.5,-28316.93 3806.5,-28316.93"/>
<text text-anchor="middle" x="3842.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_88</text>
</g>
<!-- layer_5_expert_9 -->
<g id="node143" class="node">
<title>layer_5_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4359.5,-28306.66 4036.5,-28306.66 4036.5,-28238.66 4359.5,-28238.66 4359.5,-28306.66"/>
<text text-anchor="middle" x="4198" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4198" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4198" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4198" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 89</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_9 -->
<g id="edge237" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_9</title>
<path fill="none" stroke="black" d="M4043.49,-28574.23C4043.49,-28574.23 4043.49,-28316.67 4043.49,-28316.67"/>
<polygon fill="black" stroke="black" points="4046.99,-28316.67 4043.49,-28306.67 4039.99,-28316.67 4046.99,-28316.67"/>
<text text-anchor="middle" x="4117.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_89</text>
</g>
<!-- layer_5_expert_10 -->
<g id="node144" class="node">
<title>layer_5_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4754.5,-28306.66 4431.5,-28306.66 4431.5,-28238.66 4754.5,-28238.66 4754.5,-28306.66"/>
<text text-anchor="middle" x="4593" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4593" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4593" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4593" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 90</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_10 -->
<g id="edge239" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_10</title>
<path fill="none" stroke="black" d="M3962.83,-28549C4154.78,-28549 4451.25,-28549 4451.25,-28549 4451.25,-28549 4451.25,-28316.82 4451.25,-28316.82"/>
<polygon fill="black" stroke="black" points="4454.75,-28316.82 4451.25,-28306.82 4447.75,-28316.82 4454.75,-28316.82"/>
<text text-anchor="middle" x="4453.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_90</text>
</g>
<!-- layer_5_expert_11 -->
<g id="node145" class="node">
<title>layer_5_expert_11</title>
<polygon fill="lightblue" stroke="black" points="5149.5,-28306.66 4826.5,-28306.66 4826.5,-28238.66 5149.5,-28238.66 5149.5,-28306.66"/>
<text text-anchor="middle" x="4988" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4988" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4988" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4988" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 91</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_11 -->
<g id="edge241" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_11</title>
<path fill="none" stroke="black" d="M4015.31,-28561C4323.92,-28561 4860,-28561 4860,-28561 4860,-28561 4860,-28316.87 4860,-28316.87"/>
<polygon fill="black" stroke="black" points="4863.5,-28316.87 4860,-28306.87 4856.5,-28316.87 4863.5,-28316.87"/>
<text text-anchor="middle" x="4728.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_91</text>
</g>
<!-- layer_5_expert_12 -->
<g id="node146" class="node">
<title>layer_5_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5544.5,-28306.66 5221.5,-28306.66 5221.5,-28238.66 5544.5,-28238.66 5544.5,-28306.66"/>
<text text-anchor="middle" x="5383" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5383" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5383" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5383" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 92</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_12 -->
<g id="edge243" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_12</title>
<path fill="none" stroke="black" d="M4041.95,-28573C4454.12,-28573 5255,-28573 5255,-28573 5255,-28573 5255,-28316.82 5255,-28316.82"/>
<polygon fill="black" stroke="black" points="5258.5,-28316.82 5255,-28306.82 5251.5,-28316.82 5258.5,-28316.82"/>
<text text-anchor="middle" x="5063.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_92</text>
</g>
<!-- layer_5_expert_13 -->
<g id="node147" class="node">
<title>layer_5_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5939.5,-28306.66 5616.5,-28306.66 5616.5,-28238.66 5939.5,-28238.66 5939.5,-28306.66"/>
<text text-anchor="middle" x="5778" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5778" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5778" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5778" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 93</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_13 -->
<g id="edge245" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_13</title>
<path fill="none" stroke="black" d="M4050.66,-28585C4554.16,-28585 5650,-28585 5650,-28585 5650,-28585 5650,-28316.68 5650,-28316.68"/>
<polygon fill="black" stroke="black" points="5653.5,-28316.68 5650,-28306.68 5646.5,-28316.68 5653.5,-28316.68"/>
<text text-anchor="middle" x="5428.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_93</text>
</g>
<!-- layer_5_expert_14 -->
<g id="node148" class="node">
<title>layer_5_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6334.5,-28306.66 6011.5,-28306.66 6011.5,-28238.66 6334.5,-28238.66 6334.5,-28306.66"/>
<text text-anchor="middle" x="6173" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="6173" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6173" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6173" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 94</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_14 -->
<g id="edge247" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_14</title>
<path fill="none" stroke="black" d="M4043.73,-28597C4622.62,-28597 6045,-28597 6045,-28597 6045,-28597 6045,-28316.76 6045,-28316.76"/>
<polygon fill="black" stroke="black" points="6048.5,-28316.76 6045,-28306.76 6041.5,-28316.76 6048.5,-28316.76"/>
<text text-anchor="middle" x="5808.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_94</text>
</g>
<!-- layer_5_expert_15 -->
<g id="node149" class="node">
<title>layer_5_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6729.5,-28306.66 6406.5,-28306.66 6406.5,-28238.66 6729.5,-28238.66 6729.5,-28306.66"/>
<text text-anchor="middle" x="6568" y="-28291.46" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6568" y="-28276.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6568" y="-28261.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6568" y="-28246.46" font-family="Times,serif" font-size="14.00">GPU: 95</text>
</g>
<!-- layer_5_scatter&#45;&gt;layer_5_expert_15 -->
<g id="edge249" class="edge">
<title>layer_5_scatter&#45;&gt;layer_5_expert_15</title>
<path fill="none" stroke="black" d="M4019.63,-28609C4654.14,-28609 6464,-28609 6464,-28609 6464,-28609 6464,-28316.76 6464,-28316.76"/>
<polygon fill="black" stroke="black" points="6467.5,-28316.76 6464,-28306.76 6460.5,-28316.76 6467.5,-28316.76"/>
<text text-anchor="middle" x="6196.5" y="-28418.46" font-family="Times,serif" font-size="14.00">to_GPU_95</text>
</g>
<!-- layer_5_gather -->
<g id="node134" class="node">
<title>layer_5_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3803" cy="-27959.58" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3803" y="-27978.38" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3803" y="-27963.38" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3803" y="-27948.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3803" y="-27933.38" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_5_expert_0&#45;&gt;layer_5_gather -->
<g id="edge220" class="edge">
<title>layer_5_expert_0&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M667,-28238.5C667,-28150.52 667,-27923 667,-27923 667,-27923 3626.61,-27923 3626.61,-27923"/>
<polygon fill="black" stroke="black" points="3626.61,-27926.5 3636.61,-27923 3626.61,-27919.5 3626.61,-27926.5"/>
<text text-anchor="middle" x="946" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_80</text>
</g>
<!-- layer_5_gather&#45;&gt;layer_5_add_norm2 -->
<g id="edge251" class="edge">
<title>layer_5_gather&#45;&gt;layer_5_add_norm2</title>
<path fill="none" stroke="black" d="M3878.99,-27913.5C3878.99,-27913.5 3878.99,-27704.53 3878.99,-27704.53"/>
<polygon fill="black" stroke="black" points="3882.49,-27704.53 3878.99,-27694.53 3875.49,-27704.53 3882.49,-27704.53"/>
</g>
<!-- layer_5_expert_1&#45;&gt;layer_5_gather -->
<g id="edge222" class="edge">
<title>layer_5_expert_1&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M1062,-28238.43C1062,-28152.58 1062,-27935 1062,-27935 1062,-27935 3572.75,-27935 3572.75,-27935"/>
<polygon fill="black" stroke="black" points="3572.75,-27938.5 3582.75,-27935 3572.75,-27931.5 3572.75,-27938.5"/>
<text text-anchor="middle" x="1375" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_81</text>
</g>
<!-- layer_5_expert_2&#45;&gt;layer_5_gather -->
<g id="edge224" class="edge">
<title>layer_5_expert_2&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M1590.5,-28238.43C1590.5,-28154.81 1590.5,-27947 1590.5,-27947 1590.5,-27947 3545.91,-27947 3545.91,-27947"/>
<polygon fill="black" stroke="black" points="3545.91,-27950.5 3555.91,-27947 3545.91,-27943.5 3545.91,-27950.5"/>
<text text-anchor="middle" x="1839" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_82</text>
</g>
<!-- layer_5_expert_3&#45;&gt;layer_5_gather -->
<g id="edge226" class="edge">
<title>layer_5_expert_3&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M1828,-28238.5C1828,-28157.2 1828,-27959 1828,-27959 1828,-27959 3536.83,-27959 3536.83,-27959"/>
<polygon fill="black" stroke="black" points="3536.83,-27962.5 3546.83,-27959 3536.83,-27955.5 3536.83,-27962.5"/>
<text text-anchor="middle" x="2234" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_83</text>
</g>
<!-- layer_5_expert_4&#45;&gt;layer_5_gather -->
<g id="edge228" class="edge">
<title>layer_5_expert_4&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M2247,-28238.65C2247,-28159.75 2247,-27971 2247,-27971 2247,-27971 3544.3,-27971 3544.3,-27971"/>
<polygon fill="black" stroke="black" points="3544.3,-27974.5 3554.3,-27971 3544.3,-27967.5 3544.3,-27974.5"/>
<text text-anchor="middle" x="2519" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_84</text>
</g>
<!-- layer_5_expert_5&#45;&gt;layer_5_gather -->
<g id="edge230" class="edge">
<title>layer_5_expert_5&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M2642,-28238.58C2642,-28162.01 2642,-27983 2642,-27983 2642,-27983 3569.15,-27983 3569.15,-27983"/>
<polygon fill="black" stroke="black" points="3569.15,-27986.5 3579.15,-27983 3569.15,-27979.5 3569.15,-27986.5"/>
<text text-anchor="middle" x="2942" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_85</text>
</g>
<!-- layer_5_expert_6&#45;&gt;layer_5_gather -->
<g id="edge232" class="edge">
<title>layer_5_expert_6&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M3133.82,-28238.62C3133.82,-28164.47 3133.82,-27995 3133.82,-27995 3133.82,-27995 3619.8,-27995 3619.8,-27995"/>
<polygon fill="black" stroke="black" points="3619.8,-27998.5 3629.8,-27995 3619.8,-27991.5 3619.8,-27998.5"/>
<text text-anchor="middle" x="3227" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_86</text>
</g>
<!-- layer_5_expert_7&#45;&gt;layer_5_gather -->
<g id="edge234" class="edge">
<title>layer_5_expert_7&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M3558.26,-28238.56C3558.26,-28238.56 3558.26,-27983.84 3558.26,-27983.84"/>
<polygon fill="black" stroke="black" points="3561.76,-27983.84 3558.26,-27973.84 3554.76,-27983.84 3561.76,-27983.84"/>
<text text-anchor="middle" x="3567" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_87</text>
</g>
<!-- layer_5_expert_8&#45;&gt;layer_5_gather -->
<g id="edge236" class="edge">
<title>layer_5_expert_8&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M3803,-28238.56C3803,-28238.56 3803,-28017.67 3803,-28017.67"/>
<polygon fill="black" stroke="black" points="3806.5,-28017.67 3803,-28007.67 3799.5,-28017.67 3806.5,-28017.67"/>
<text text-anchor="middle" x="3852" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_88</text>
</g>
<!-- layer_5_expert_9&#45;&gt;layer_5_gather -->
<g id="edge238" class="edge">
<title>layer_5_expert_9&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M4047.74,-28238.56C4047.74,-28238.56 4047.74,-27983.84 4047.74,-27983.84"/>
<polygon fill="black" stroke="black" points="4051.24,-27983.84 4047.74,-27973.84 4044.24,-27983.84 4051.24,-27983.84"/>
<text text-anchor="middle" x="4137" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_89</text>
</g>
<!-- layer_5_expert_10&#45;&gt;layer_5_gather -->
<g id="edge240" class="edge">
<title>layer_5_expert_10&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M4449,-28238.65C4449,-28164.12 4449,-27993 4449,-27993 4449,-27993 3997.25,-27993 3997.25,-27993"/>
<polygon fill="black" stroke="black" points="3997.25,-27989.5 3987.25,-27993 3997.25,-27996.5 3997.25,-27989.5"/>
<text text-anchor="middle" x="4477" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_90</text>
</g>
<!-- layer_5_expert_11&#45;&gt;layer_5_gather -->
<g id="edge242" class="edge">
<title>layer_5_expert_11&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M4844,-28238.52C4844,-28161.32 4844,-27980 4844,-27980 4844,-27980 4045,-27980 4045,-27980"/>
<polygon fill="black" stroke="black" points="4045,-27976.5 4035,-27980 4045,-27983.5 4045,-27976.5"/>
<text text-anchor="middle" x="4762" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_91</text>
</g>
<!-- layer_5_expert_12&#45;&gt;layer_5_gather -->
<g id="edge244" class="edge">
<title>layer_5_expert_12&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M5239,-28238.38C5239,-28158.36 5239,-27966 5239,-27966 5239,-27966 4066.83,-27966 4066.83,-27966"/>
<polygon fill="black" stroke="black" points="4066.83,-27962.5 4056.83,-27966 4066.83,-27969.5 4066.83,-27962.5"/>
<text text-anchor="middle" x="5102" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_92</text>
</g>
<!-- layer_5_expert_13&#45;&gt;layer_5_gather -->
<g id="edge246" class="edge">
<title>layer_5_expert_13&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M5634,-28238.65C5634,-28156.12 5634,-27952 5634,-27952 5634,-27952 4066.15,-27952 4066.15,-27952"/>
<polygon fill="black" stroke="black" points="4066.15,-27948.5 4056.15,-27952 4066.15,-27955.5 4066.15,-27948.5"/>
<text text-anchor="middle" x="5359" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_93</text>
</g>
<!-- layer_5_expert_14&#45;&gt;layer_5_gather -->
<g id="edge248" class="edge">
<title>layer_5_expert_14&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M6029,-28238.42C6029,-28153.13 6029,-27938 6029,-27938 6029,-27938 4041.8,-27938 4041.8,-27938"/>
<polygon fill="black" stroke="black" points="4041.8,-27934.5 4031.8,-27938 4041.8,-27941.5 4041.8,-27934.5"/>
<text text-anchor="middle" x="5782" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_94</text>
</g>
<!-- layer_5_expert_15&#45;&gt;layer_5_gather -->
<g id="edge250" class="edge">
<title>layer_5_expert_15&#45;&gt;layer_5_gather</title>
<path fill="none" stroke="black" d="M6459,-28238.38C6459,-28150.67 6459,-27925 6459,-27925 6459,-27925 3990.87,-27925 3990.87,-27925"/>
<polygon fill="black" stroke="black" points="3990.87,-27921.5 3980.87,-27925 3990.87,-27928.5 3990.87,-27921.5"/>
<text text-anchor="middle" x="6287" y="-28119.46" font-family="Times,serif" font-size="14.00">from_GPU_95</text>
</g>
<!-- layer_6_qkv -->
<g id="node152" class="node">
<title>layer_6_qkv</title>
<polygon fill="lightblue" stroke="black" points="3855.5,-27409.5 3446.5,-27409.5 3446.5,-27341.5 3855.5,-27341.5 3855.5,-27409.5"/>
<text text-anchor="middle" x="3651" y="-27394.3" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3651" y="-27379.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3651" y="-27364.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3651" y="-27349.3" font-family="Times,serif" font-size="14.00">GPU: 96</text>
</g>
<!-- layer_5_add_norm2&#45;&gt;layer_6_qkv -->
<g id="edge253" class="edge">
<title>layer_5_add_norm2&#45;&gt;layer_6_qkv</title>
<path fill="none" stroke="black" d="M3777.25,-27626.4C3777.25,-27626.4 3777.25,-27419.63 3777.25,-27419.63"/>
<polygon fill="black" stroke="black" points="3780.75,-27419.63 3777.25,-27409.63 3773.75,-27419.63 3780.75,-27419.63"/>
</g>
<!-- layer_6_add_norm1 -->
<g id="node155" class="node">
<title>layer_6_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4073,-26554.5 3711,-26554.5 3711,-26486.5 4073,-26486.5 4073,-26554.5"/>
<text text-anchor="middle" x="3892" y="-26539.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3892" y="-26524.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3892" y="-26509.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3892" y="-26494.3" font-family="Times,serif" font-size="14.00">GPU: 96</text>
</g>
<!-- layer_5_add_norm2&#45;&gt;layer_6_add_norm1 -->
<g id="edge257" class="edge">
<title>layer_5_add_norm2&#45;&gt;layer_6_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3961.75,-27626.38C3961.75,-27626.38 3961.75,-26564.76 3961.75,-26564.76"/>
<polygon fill="black" stroke="black" points="3965.25,-26564.76 3961.75,-26554.76 3958.25,-26564.76 3965.25,-26564.76"/>
<text text-anchor="middle" x="4011" y="-27086.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_5_mha -->
<g id="node151" class="node">
<title>layer_5_mha</title>
<polygon fill="lightblue" stroke="black" points="2321.5,-30140.83 1912.5,-30140.83 1912.5,-30072.83 2321.5,-30072.83 2321.5,-30140.83"/>
<text text-anchor="middle" x="2117" y="-30125.63" font-family="Times,serif" font-size="14.00">MHA Layer 5</text>
<text text-anchor="middle" x="2117" y="-30110.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2117" y="-30095.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2117" y="-30080.63" font-family="Times,serif" font-size="14.00">GPU: 80</text>
</g>
<!-- layer_6_attn -->
<g id="node153" class="node">
<title>layer_6_attn</title>
<polygon fill="lightblue" stroke="black" points="3837.5,-27124.5 3428.5,-27124.5 3428.5,-27056.5 3837.5,-27056.5 3837.5,-27124.5"/>
<text text-anchor="middle" x="3633" y="-27109.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3633" y="-27094.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3633" y="-27079.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3633" y="-27064.3" font-family="Times,serif" font-size="14.00">GPU: 96</text>
</g>
<!-- layer_6_qkv&#45;&gt;layer_6_attn -->
<g id="edge254" class="edge">
<title>layer_6_qkv&#45;&gt;layer_6_attn</title>
<path fill="none" stroke="black" d="M3642,-27341.4C3642,-27341.4 3642,-27134.63 3642,-27134.63"/>
<polygon fill="black" stroke="black" points="3645.5,-27134.63 3642,-27124.63 3638.5,-27134.63 3645.5,-27134.63"/>
</g>
<!-- layer_6_proj -->
<g id="node154" class="node">
<title>layer_6_proj</title>
<polygon fill="lightblue" stroke="black" points="3862.5,-26839.5 3465.5,-26839.5 3465.5,-26771.5 3862.5,-26771.5 3862.5,-26839.5"/>
<text text-anchor="middle" x="3664" y="-26824.3" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3664" y="-26809.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3664" y="-26794.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3664" y="-26779.3" font-family="Times,serif" font-size="14.00">GPU: 96</text>
</g>
<!-- layer_6_attn&#45;&gt;layer_6_proj -->
<g id="edge255" class="edge">
<title>layer_6_attn&#45;&gt;layer_6_proj</title>
<path fill="none" stroke="black" d="M3651.5,-27056.4C3651.5,-27056.4 3651.5,-26849.63 3651.5,-26849.63"/>
<polygon fill="black" stroke="black" points="3655,-26849.63 3651.5,-26839.63 3648,-26849.63 3655,-26849.63"/>
</g>
<!-- layer_6_proj&#45;&gt;layer_6_add_norm1 -->
<g id="edge256" class="edge">
<title>layer_6_proj&#45;&gt;layer_6_add_norm1</title>
<path fill="none" stroke="black" d="M3786.75,-26771.4C3786.75,-26771.4 3786.75,-26564.63 3786.75,-26564.63"/>
<polygon fill="black" stroke="black" points="3790.25,-26564.63 3786.75,-26554.63 3783.25,-26564.63 3790.25,-26564.63"/>
</g>
<!-- layer_6_gate -->
<g id="node156" class="node">
<title>layer_6_gate</title>
<polygon fill="yellow" stroke="black" points="3818.73,-26269.5 3241.71,-26269.5 3093.27,-26133.5 3670.29,-26133.5 3818.73,-26269.5"/>
<text text-anchor="middle" x="3456" y="-26220.3" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3456" y="-26205.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3456" y="-26190.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3456" y="-26175.3" font-family="Times,serif" font-size="14.00">GPU: 96</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_gate -->
<g id="edge258" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_gate</title>
<path fill="none" stroke="black" d="M3764.93,-26486.36C3764.93,-26486.36 3764.93,-26279.62 3764.93,-26279.62"/>
<polygon fill="black" stroke="black" points="3768.43,-26279.62 3764.93,-26269.62 3761.43,-26279.62 3768.43,-26279.62"/>
</g>
<!-- layer_6_scatter -->
<g id="node157" class="node">
<title>layer_6_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3456" cy="-25854.41" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3456" y="-25873.21" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3456" y="-25858.21" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3456" y="-25843.21" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3456" y="-25828.21" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_scatter -->
<g id="edge259" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_scatter</title>
<path fill="none" stroke="black" d="M3915.68,-26486.15C3915.68,-26354.58 3915.68,-25890 3915.68,-25890 3915.68,-25890 3632.61,-25890 3632.61,-25890"/>
<polygon fill="black" stroke="black" points="3632.61,-25886.5 3622.61,-25890 3632.61,-25893.5 3632.61,-25886.5"/>
</g>
<!-- layer_6_add_norm2 -->
<g id="node175" class="node">
<title>layer_6_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4048,-24963.16 3686,-24963.16 3686,-24895.16 4048,-24895.16 4048,-24963.16"/>
<text text-anchor="middle" x="3867" y="-24947.96" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3867" y="-24932.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3867" y="-24917.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3867" y="-24902.96" font-family="Times,serif" font-size="14.00">GPU: 96</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_add_norm2 -->
<g id="edge294" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4030.25,-26486.15C4030.25,-26486.15 4030.25,-24973.46 4030.25,-24973.46"/>
<polygon fill="black" stroke="black" points="4033.75,-24973.46 4030.25,-24963.46 4026.75,-24973.46 4033.75,-24973.46"/>
<text text-anchor="middle" x="6428" y="-25687.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_scatter -->
<g id="edge260" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3456,-26133.34C3456,-26133.34 3456,-25912.6 3456,-25912.6"/>
<polygon fill="black" stroke="black" points="3459.5,-25912.6 3456,-25902.6 3452.5,-25912.6 3459.5,-25912.6"/>
<text text-anchor="middle" x="3499.5" y="-26014.3" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_6_expert_0 -->
<g id="node158" class="node">
<title>layer_6_expert_0</title>
<polygon fill="lightblue" stroke="black" points="457.5,-25575.33 134.5,-25575.33 134.5,-25507.33 457.5,-25507.33 457.5,-25575.33"/>
<text text-anchor="middle" x="296" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="296" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="296" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="296" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 96</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_0 -->
<g id="edge261" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_0</title>
<path fill="none" stroke="black" d="M3289.39,-25890C2638.84,-25890 305.5,-25890 305.5,-25890 305.5,-25890 305.5,-25585.4 305.5,-25585.4"/>
<polygon fill="black" stroke="black" points="309,-25585.4 305.5,-25575.4 302,-25585.4 309,-25585.4"/>
<text text-anchor="middle" x="548.5" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_96</text>
</g>
<!-- layer_6_expert_1 -->
<g id="node160" class="node">
<title>layer_6_expert_1</title>
<polygon fill="lightblue" stroke="black" points="852.5,-25575.33 529.5,-25575.33 529.5,-25507.33 852.5,-25507.33 852.5,-25575.33"/>
<text text-anchor="middle" x="691" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="691" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="691" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="691" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 97</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_1 -->
<g id="edge263" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_1</title>
<path fill="none" stroke="black" d="M3240.14,-25878C2611.87,-25878 828.5,-25878 828.5,-25878 828.5,-25878 828.5,-25585.46 828.5,-25585.46"/>
<polygon fill="black" stroke="black" points="832,-25585.46 828.5,-25575.46 825,-25585.46 832,-25585.46"/>
<text text-anchor="middle" x="918.5" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_97</text>
</g>
<!-- layer_6_expert_2 -->
<g id="node161" class="node">
<title>layer_6_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1247.5,-25575.33 924.5,-25575.33 924.5,-25507.33 1247.5,-25507.33 1247.5,-25575.33"/>
<text text-anchor="middle" x="1086" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1086" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1086" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1086" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 98</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_2 -->
<g id="edge265" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_2</title>
<path fill="none" stroke="black" d="M3215.76,-25866C2638.99,-25866 1223.5,-25866 1223.5,-25866 1223.5,-25866 1223.5,-25585.46 1223.5,-25585.46"/>
<polygon fill="black" stroke="black" points="1227,-25585.46 1223.5,-25575.46 1220,-25585.46 1227,-25585.46"/>
<text text-anchor="middle" x="1263.5" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_98</text>
</g>
<!-- layer_6_expert_3 -->
<g id="node162" class="node">
<title>layer_6_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1642.5,-25575.33 1319.5,-25575.33 1319.5,-25507.33 1642.5,-25507.33 1642.5,-25575.33"/>
<text text-anchor="middle" x="1481" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1481" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1481" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1481" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 99</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_3 -->
<g id="edge267" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_3</title>
<path fill="none" stroke="black" d="M3208.13,-25854C2705.69,-25854 1614.5,-25854 1614.5,-25854 1614.5,-25854 1614.5,-25585.39 1614.5,-25585.39"/>
<polygon fill="black" stroke="black" points="1618,-25585.39 1614.5,-25575.39 1611,-25585.39 1618,-25585.39"/>
<text text-anchor="middle" x="1557.5" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_99</text>
</g>
<!-- layer_6_expert_4 -->
<g id="node163" class="node">
<title>layer_6_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2037.5,-25575.33 1714.5,-25575.33 1714.5,-25507.33 2037.5,-25507.33 2037.5,-25575.33"/>
<text text-anchor="middle" x="1876" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1876" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1876" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1876" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 100</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_4 -->
<g id="edge269" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_4</title>
<path fill="none" stroke="black" d="M3216.68,-25842C2807.35,-25842 2016.5,-25842 2016.5,-25842 2016.5,-25842 2016.5,-25585.53 2016.5,-25585.53"/>
<polygon fill="black" stroke="black" points="2020,-25585.53 2016.5,-25575.53 2013,-25585.53 2020,-25585.53"/>
<text text-anchor="middle" x="2297" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_100</text>
</g>
<!-- layer_6_expert_5 -->
<g id="node164" class="node">
<title>layer_6_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2432.5,-25575.33 2109.5,-25575.33 2109.5,-25507.33 2432.5,-25507.33 2432.5,-25575.33"/>
<text text-anchor="middle" x="2271" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2271" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2271" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2271" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 101</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_5 -->
<g id="edge271" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_5</title>
<path fill="none" stroke="black" d="M3242.76,-25830C2936.49,-25830 2408.5,-25830 2408.5,-25830 2408.5,-25830 2408.5,-25585.58 2408.5,-25585.58"/>
<polygon fill="black" stroke="black" points="2412,-25585.58 2408.5,-25575.58 2405,-25585.58 2412,-25585.58"/>
<text text-anchor="middle" x="2752" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_101</text>
</g>
<!-- layer_6_expert_6 -->
<g id="node165" class="node">
<title>layer_6_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2827.5,-25575.33 2504.5,-25575.33 2504.5,-25507.33 2827.5,-25507.33 2827.5,-25575.33"/>
<text text-anchor="middle" x="2666" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2666" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2666" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2666" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 102</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_6 -->
<g id="edge273" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_6</title>
<path fill="none" stroke="black" d="M3294.29,-25818C3101.05,-25818 2803.5,-25818 2803.5,-25818 2803.5,-25818 2803.5,-25585.53 2803.5,-25585.53"/>
<polygon fill="black" stroke="black" points="2807,-25585.53 2803.5,-25575.53 2800,-25585.53 2807,-25585.53"/>
<text text-anchor="middle" x="3062" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_102</text>
</g>
<!-- layer_6_expert_7 -->
<g id="node166" class="node">
<title>layer_6_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3222.5,-25575.33 2899.5,-25575.33 2899.5,-25507.33 3222.5,-25507.33 3222.5,-25575.33"/>
<text text-anchor="middle" x="3061" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3061" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3061" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3061" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 103</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_7 -->
<g id="edge275" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_7</title>
<path fill="none" stroke="black" d="M3215.51,-25842.9C3215.51,-25842.9 3215.51,-25585.34 3215.51,-25585.34"/>
<polygon fill="black" stroke="black" points="3219.01,-25585.34 3215.51,-25575.34 3212.01,-25585.34 3219.01,-25585.34"/>
<text text-anchor="middle" x="3299" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_103</text>
</g>
<!-- layer_6_expert_8 -->
<g id="node167" class="node">
<title>layer_6_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3617.5,-25575.33 3294.5,-25575.33 3294.5,-25507.33 3617.5,-25507.33 3617.5,-25575.33"/>
<text text-anchor="middle" x="3456" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3456" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3456" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3456" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 104</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_8 -->
<g id="edge277" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_8</title>
<path fill="none" stroke="black" d="M3456,-25806.18C3456,-25806.18 3456,-25585.6 3456,-25585.6"/>
<polygon fill="black" stroke="black" points="3459.5,-25585.6 3456,-25575.6 3452.5,-25585.6 3459.5,-25585.6"/>
<text text-anchor="middle" x="3500" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_104</text>
</g>
<!-- layer_6_expert_9 -->
<g id="node168" class="node">
<title>layer_6_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4012.5,-25575.33 3689.5,-25575.33 3689.5,-25507.33 4012.5,-25507.33 4012.5,-25575.33"/>
<text text-anchor="middle" x="3851" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3851" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3851" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3851" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 105</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_9 -->
<g id="edge279" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_9</title>
<path fill="none" stroke="black" d="M3696.49,-25842.9C3696.49,-25842.9 3696.49,-25585.34 3696.49,-25585.34"/>
<polygon fill="black" stroke="black" points="3699.99,-25585.34 3696.49,-25575.34 3692.99,-25585.34 3699.99,-25585.34"/>
<text text-anchor="middle" x="3780" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_105</text>
</g>
<!-- layer_6_expert_10 -->
<g id="node169" class="node">
<title>layer_6_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4407.5,-25575.33 4084.5,-25575.33 4084.5,-25507.33 4407.5,-25507.33 4407.5,-25575.33"/>
<text text-anchor="middle" x="4246" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4246" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4246" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4246" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 106</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_10 -->
<g id="edge281" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_10</title>
<path fill="none" stroke="black" d="M3617.98,-25818C3842.78,-25818 4222,-25818 4222,-25818 4222,-25818 4222,-25585.53 4222,-25585.53"/>
<polygon fill="black" stroke="black" points="4225.5,-25585.53 4222,-25575.53 4218.5,-25585.53 4225.5,-25585.53"/>
<text text-anchor="middle" x="4175" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_106</text>
</g>
<!-- layer_6_expert_11 -->
<g id="node170" class="node">
<title>layer_6_expert_11</title>
<polygon fill="lightblue" stroke="black" points="4802.5,-25575.33 4479.5,-25575.33 4479.5,-25507.33 4802.5,-25507.33 4802.5,-25575.33"/>
<text text-anchor="middle" x="4641" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4641" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4641" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4641" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 107</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_11 -->
<g id="edge283" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_11</title>
<path fill="none" stroke="black" d="M3669.28,-25830C4004.53,-25830 4617,-25830 4617,-25830 4617,-25830 4617,-25585.58 4617,-25585.58"/>
<polygon fill="black" stroke="black" points="4620.5,-25585.58 4617,-25575.58 4613.5,-25585.58 4620.5,-25585.58"/>
<text text-anchor="middle" x="4484" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_107</text>
</g>
<!-- layer_6_expert_12 -->
<g id="node171" class="node">
<title>layer_6_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5197.5,-25575.33 4874.5,-25575.33 4874.5,-25507.33 5197.5,-25507.33 5197.5,-25575.33"/>
<text text-anchor="middle" x="5036" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5036" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5036" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5036" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 108</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_12 -->
<g id="edge285" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_12</title>
<path fill="none" stroke="black" d="M3695.29,-25842C4131.61,-25842 5012,-25842 5012,-25842 5012,-25842 5012,-25585.53 5012,-25585.53"/>
<polygon fill="black" stroke="black" points="5015.5,-25585.53 5012,-25575.53 5008.5,-25585.53 5015.5,-25585.53"/>
<text text-anchor="middle" x="4793" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_108</text>
</g>
<!-- layer_6_expert_13 -->
<g id="node172" class="node">
<title>layer_6_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5592.5,-25575.33 5269.5,-25575.33 5269.5,-25507.33 5592.5,-25507.33 5592.5,-25575.33"/>
<text text-anchor="middle" x="5431" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5431" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5431" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5431" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 109</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_13 -->
<g id="edge287" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_13</title>
<path fill="none" stroke="black" d="M3703.59,-25854C4228.82,-25854 5407,-25854 5407,-25854 5407,-25854 5407,-25585.39 5407,-25585.39"/>
<polygon fill="black" stroke="black" points="5410.5,-25585.39 5407,-25575.39 5403.5,-25585.39 5410.5,-25585.39"/>
<text text-anchor="middle" x="5217" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_109</text>
</g>
<!-- layer_6_expert_14 -->
<g id="node173" class="node">
<title>layer_6_expert_14</title>
<polygon fill="lightblue" stroke="black" points="5987.5,-25575.33 5664.5,-25575.33 5664.5,-25507.33 5987.5,-25507.33 5987.5,-25575.33"/>
<text text-anchor="middle" x="5826" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5826" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5826" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5826" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 110</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_14 -->
<g id="edge289" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_14</title>
<path fill="none" stroke="black" d="M3696.31,-25866C4294.41,-25866 5802,-25866 5802,-25866 5802,-25866 5802,-25585.46 5802,-25585.46"/>
<polygon fill="black" stroke="black" points="5805.5,-25585.46 5802,-25575.46 5798.5,-25585.46 5805.5,-25585.46"/>
<text text-anchor="middle" x="5626" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_110</text>
</g>
<!-- layer_6_expert_15 -->
<g id="node174" class="node">
<title>layer_6_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6382.5,-25575.33 6059.5,-25575.33 6059.5,-25507.33 6382.5,-25507.33 6382.5,-25575.33"/>
<text text-anchor="middle" x="6221" y="-25560.13" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6221" y="-25545.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6221" y="-25530.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6221" y="-25515.13" font-family="Times,serif" font-size="14.00">GPU: 111</text>
</g>
<!-- layer_6_scatter&#45;&gt;layer_6_expert_15 -->
<g id="edge291" class="edge">
<title>layer_6_scatter&#45;&gt;layer_6_expert_15</title>
<path fill="none" stroke="black" d="M3671.94,-25878C4318.91,-25878 6197,-25878 6197,-25878 6197,-25878 6197,-25585.46 6197,-25585.46"/>
<polygon fill="black" stroke="black" points="6200.5,-25585.46 6197,-25575.46 6193.5,-25585.46 6200.5,-25585.46"/>
<text text-anchor="middle" x="6028" y="-25687.13" font-family="Times,serif" font-size="14.00">to_GPU_111</text>
</g>
<!-- layer_6_gather -->
<g id="node159" class="node">
<title>layer_6_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3456" cy="-25228.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3456" y="-25247.05" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3456" y="-25232.05" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3456" y="-25217.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3456" y="-25202.05" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_6_expert_0&#45;&gt;layer_6_gather -->
<g id="edge262" class="edge">
<title>layer_6_expert_0&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M451,-25507.2C451,-25419.3 451,-25192 451,-25192 451,-25192 3277.73,-25192 3277.73,-25192"/>
<polygon fill="black" stroke="black" points="3277.73,-25195.5 3287.73,-25192 3277.73,-25188.5 3277.73,-25195.5"/>
<text text-anchor="middle" x="567" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_96</text>
</g>
<!-- layer_6_gather&#45;&gt;layer_6_add_norm2 -->
<g id="edge293" class="edge">
<title>layer_6_gather&#45;&gt;layer_6_add_norm2</title>
<path fill="none" stroke="black" d="M3698.99,-25213C3698.99,-25213 3698.99,-24973.17 3698.99,-24973.17"/>
<polygon fill="black" stroke="black" points="3702.49,-24973.17 3698.99,-24963.17 3695.49,-24973.17 3702.49,-24973.17"/>
</g>
<!-- layer_6_expert_1&#45;&gt;layer_6_gather -->
<g id="edge264" class="edge">
<title>layer_6_expert_1&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M846,-25507.13C846,-25421.37 846,-25204 846,-25204 846,-25204 3224.88,-25204 3224.88,-25204"/>
<polygon fill="black" stroke="black" points="3224.88,-25207.5 3234.88,-25204 3224.88,-25200.5 3224.88,-25207.5"/>
<text text-anchor="middle" x="965" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_97</text>
</g>
<!-- layer_6_expert_2&#45;&gt;layer_6_gather -->
<g id="edge266" class="edge">
<title>layer_6_expert_2&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M1241,-25507.13C1241,-25423.6 1241,-25216 1241,-25216 1241,-25216 3198.36,-25216 3198.36,-25216"/>
<polygon fill="black" stroke="black" points="3198.36,-25219.5 3208.36,-25216 3198.36,-25212.5 3198.36,-25219.5"/>
<text text-anchor="middle" x="1366" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_98</text>
</g>
<!-- layer_6_expert_3&#45;&gt;layer_6_gather -->
<g id="edge268" class="edge">
<title>layer_6_expert_3&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M1608,-25507.2C1608,-25425.99 1608,-25228 1608,-25228 1608,-25228 3190.01,-25228 3190.01,-25228"/>
<polygon fill="black" stroke="black" points="3190.01,-25231.5 3200.01,-25228 3190.01,-25224.5 3190.01,-25231.5"/>
<text text-anchor="middle" x="1772" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_99</text>
</g>
<!-- layer_6_expert_4&#45;&gt;layer_6_gather -->
<g id="edge270" class="edge">
<title>layer_6_expert_4&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M2031,-25507.06C2031,-25428.08 2031,-25240 2031,-25240 2031,-25240 3197.78,-25240 3197.78,-25240"/>
<polygon fill="black" stroke="black" points="3197.78,-25243.5 3207.78,-25240 3197.78,-25236.5 3197.78,-25243.5"/>
<text text-anchor="middle" x="2193.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_100</text>
</g>
<!-- layer_6_expert_5&#45;&gt;layer_6_gather -->
<g id="edge272" class="edge">
<title>layer_6_expert_5&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M2426,-25507.29C2426,-25430.81 2426,-25252 2426,-25252 2426,-25252 3223.14,-25252 3223.14,-25252"/>
<polygon fill="black" stroke="black" points="3223.14,-25255.5 3233.14,-25252 3223.14,-25248.5 3223.14,-25255.5"/>
<text text-anchor="middle" x="2482.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_101</text>
</g>
<!-- layer_6_expert_6&#45;&gt;layer_6_gather -->
<g id="edge274" class="edge">
<title>layer_6_expert_6&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M2821,-25507.32C2821,-25433.27 2821,-25264 2821,-25264 2821,-25264 3274.58,-25264 3274.58,-25264"/>
<polygon fill="black" stroke="black" points="3274.58,-25267.5 3284.58,-25264 3274.58,-25260.5 3274.58,-25267.5"/>
<text text-anchor="middle" x="2825.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_102</text>
</g>
<!-- layer_6_expert_7&#45;&gt;layer_6_gather -->
<g id="edge276" class="edge">
<title>layer_6_expert_7&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M3211.26,-25507.23C3211.26,-25507.23 3211.26,-25252.5 3211.26,-25252.5"/>
<polygon fill="black" stroke="black" points="3214.76,-25252.5 3211.26,-25242.5 3207.76,-25252.5 3214.76,-25252.5"/>
<text text-anchor="middle" x="3220.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_103</text>
</g>
<!-- layer_6_expert_8&#45;&gt;layer_6_gather -->
<g id="edge278" class="edge">
<title>layer_6_expert_8&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M3456,-25507.23C3456,-25507.23 3456,-25286.34 3456,-25286.34"/>
<polygon fill="black" stroke="black" points="3459.5,-25286.34 3456,-25276.34 3452.5,-25286.34 3459.5,-25286.34"/>
<text text-anchor="middle" x="3509.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_104</text>
</g>
<!-- layer_6_expert_9&#45;&gt;layer_6_gather -->
<g id="edge280" class="edge">
<title>layer_6_expert_9&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M3700.74,-25507.23C3700.74,-25507.23 3700.74,-25252.5 3700.74,-25252.5"/>
<polygon fill="black" stroke="black" points="3704.24,-25252.5 3700.74,-25242.5 3697.24,-25252.5 3704.24,-25252.5"/>
<text text-anchor="middle" x="3799.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_105</text>
</g>
<!-- layer_6_expert_10&#45;&gt;layer_6_gather -->
<g id="edge282" class="edge">
<title>layer_6_expert_10&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M4239.5,-25507.08C4239.5,-25432.49 4239.5,-25262 4239.5,-25262 4239.5,-25262 3648.71,-25262 3648.71,-25262"/>
<polygon fill="black" stroke="black" points="3648.71,-25258.5 3638.71,-25262 3648.71,-25265.5 3648.71,-25258.5"/>
<text text-anchor="middle" x="4088.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_106</text>
</g>
<!-- layer_6_expert_11&#45;&gt;layer_6_gather -->
<g id="edge284" class="edge">
<title>layer_6_expert_11&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M4634.5,-25507.11C4634.5,-25429.73 4634.5,-25248 4634.5,-25248 4634.5,-25248 3699.54,-25248 3699.54,-25248"/>
<polygon fill="black" stroke="black" points="3699.54,-25244.5 3689.54,-25248 3699.54,-25251.5 3699.54,-25244.5"/>
<text text-anchor="middle" x="4430.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_107</text>
</g>
<!-- layer_6_expert_12&#45;&gt;layer_6_gather -->
<g id="edge286" class="edge">
<title>layer_6_expert_12&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M5029.5,-25507.08C5029.5,-25427.15 5029.5,-25235 5029.5,-25235 5029.5,-25235 3719.68,-25235 3719.68,-25235"/>
<polygon fill="black" stroke="black" points="3719.68,-25231.5 3709.68,-25235 3719.68,-25238.5 3719.68,-25231.5"/>
<text text-anchor="middle" x="4799.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_108</text>
</g>
<!-- layer_6_expert_13&#45;&gt;layer_6_gather -->
<g id="edge288" class="edge">
<title>layer_6_expert_13&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M5424.5,-25507.05C5424.5,-25424.41 5424.5,-25221 5424.5,-25221 5424.5,-25221 3719.07,-25221 3719.07,-25221"/>
<polygon fill="black" stroke="black" points="3719.07,-25217.5 3709.07,-25221 3719.07,-25224.5 3719.07,-25217.5"/>
<text text-anchor="middle" x="5234.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_109</text>
</g>
<!-- layer_6_expert_14&#45;&gt;layer_6_gather -->
<g id="edge290" class="edge">
<title>layer_6_expert_14&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M5819.5,-25507.12C5819.5,-25421.91 5819.5,-25207 5819.5,-25207 5819.5,-25207 3695.85,-25207 3695.85,-25207"/>
<polygon fill="black" stroke="black" points="3695.85,-25203.5 3685.85,-25207 3695.85,-25210.5 3695.85,-25203.5"/>
<text text-anchor="middle" x="5774.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_110</text>
</g>
<!-- layer_6_expert_15&#45;&gt;layer_6_gather -->
<g id="edge292" class="edge">
<title>layer_6_expert_15&#45;&gt;layer_6_gather</title>
<path fill="none" stroke="black" d="M6214.5,-25507.3C6214.5,-25419.65 6214.5,-25193 6214.5,-25193 6214.5,-25193 3640.13,-25193 3640.13,-25193"/>
<polygon fill="black" stroke="black" points="3640.13,-25189.5 3630.13,-25193 3640.12,-25196.5 3640.13,-25189.5"/>
<text text-anchor="middle" x="6116.5" y="-25388.13" font-family="Times,serif" font-size="14.00">from_GPU_111</text>
</g>
<!-- layer_7_qkv -->
<g id="node177" class="node">
<title>layer_7_qkv</title>
<polygon fill="lightblue" stroke="black" points="3842.5,-24678.16 3433.5,-24678.16 3433.5,-24610.16 3842.5,-24610.16 3842.5,-24678.16"/>
<text text-anchor="middle" x="3638" y="-24662.96" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3638" y="-24647.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3638" y="-24632.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3638" y="-24617.96" font-family="Times,serif" font-size="14.00">GPU: 112</text>
</g>
<!-- layer_6_add_norm2&#45;&gt;layer_7_qkv -->
<g id="edge295" class="edge">
<title>layer_6_add_norm2&#45;&gt;layer_7_qkv</title>
<path fill="none" stroke="black" d="M3764.25,-24895.07C3764.25,-24895.07 3764.25,-24688.3 3764.25,-24688.3"/>
<polygon fill="black" stroke="black" points="3767.75,-24688.3 3764.25,-24678.3 3760.75,-24688.3 3767.75,-24688.3"/>
</g>
<!-- layer_7_add_norm1 -->
<g id="node180" class="node">
<title>layer_7_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4060,-23823.16 3698,-23823.16 3698,-23755.16 4060,-23755.16 4060,-23823.16"/>
<text text-anchor="middle" x="3879" y="-23807.96" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3879" y="-23792.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3879" y="-23777.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3879" y="-23762.96" font-family="Times,serif" font-size="14.00">GPU: 112</text>
</g>
<!-- layer_6_add_norm2&#45;&gt;layer_7_add_norm1 -->
<g id="edge299" class="edge">
<title>layer_6_add_norm2&#45;&gt;layer_7_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3948.75,-24895.05C3948.75,-24895.05 3948.75,-23833.43 3948.75,-23833.43"/>
<polygon fill="black" stroke="black" points="3952.25,-23833.43 3948.75,-23823.43 3945.25,-23833.43 3952.25,-23833.43"/>
<text text-anchor="middle" x="3998" y="-24355.46" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_6_mha -->
<g id="node176" class="node">
<title>layer_6_mha</title>
<polygon fill="lightblue" stroke="black" points="1995.5,-27409.5 1586.5,-27409.5 1586.5,-27341.5 1995.5,-27341.5 1995.5,-27409.5"/>
<text text-anchor="middle" x="1791" y="-27394.3" font-family="Times,serif" font-size="14.00">MHA Layer 6</text>
<text text-anchor="middle" x="1791" y="-27379.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1791" y="-27364.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1791" y="-27349.3" font-family="Times,serif" font-size="14.00">GPU: 96</text>
</g>
<!-- layer_7_attn -->
<g id="node178" class="node">
<title>layer_7_attn</title>
<polygon fill="lightblue" stroke="black" points="3824.5,-24393.16 3415.5,-24393.16 3415.5,-24325.16 3824.5,-24325.16 3824.5,-24393.16"/>
<text text-anchor="middle" x="3620" y="-24377.96" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3620" y="-24362.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3620" y="-24347.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3620" y="-24332.96" font-family="Times,serif" font-size="14.00">GPU: 112</text>
</g>
<!-- layer_7_qkv&#45;&gt;layer_7_attn -->
<g id="edge296" class="edge">
<title>layer_7_qkv&#45;&gt;layer_7_attn</title>
<path fill="none" stroke="black" d="M3629,-24610.07C3629,-24610.07 3629,-24403.3 3629,-24403.3"/>
<polygon fill="black" stroke="black" points="3632.5,-24403.3 3629,-24393.3 3625.5,-24403.3 3632.5,-24403.3"/>
</g>
<!-- layer_7_proj -->
<g id="node179" class="node">
<title>layer_7_proj</title>
<polygon fill="lightblue" stroke="black" points="3849.5,-24108.16 3452.5,-24108.16 3452.5,-24040.16 3849.5,-24040.16 3849.5,-24108.16"/>
<text text-anchor="middle" x="3651" y="-24092.96" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3651" y="-24077.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3651" y="-24062.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3651" y="-24047.96" font-family="Times,serif" font-size="14.00">GPU: 112</text>
</g>
<!-- layer_7_attn&#45;&gt;layer_7_proj -->
<g id="edge297" class="edge">
<title>layer_7_attn&#45;&gt;layer_7_proj</title>
<path fill="none" stroke="black" d="M3638.5,-24325.07C3638.5,-24325.07 3638.5,-24118.3 3638.5,-24118.3"/>
<polygon fill="black" stroke="black" points="3642,-24118.3 3638.5,-24108.3 3635,-24118.3 3642,-24118.3"/>
</g>
<!-- layer_7_proj&#45;&gt;layer_7_add_norm1 -->
<g id="edge298" class="edge">
<title>layer_7_proj&#45;&gt;layer_7_add_norm1</title>
<path fill="none" stroke="black" d="M3773.75,-24040.07C3773.75,-24040.07 3773.75,-23833.3 3773.75,-23833.3"/>
<polygon fill="black" stroke="black" points="3777.25,-23833.3 3773.75,-23823.3 3770.25,-23833.3 3777.25,-23833.3"/>
</g>
<!-- layer_7_gate -->
<g id="node181" class="node">
<title>layer_7_gate</title>
<polygon fill="yellow" stroke="black" points="3805.73,-23538.16 3228.71,-23538.16 3080.27,-23402.16 3657.29,-23402.16 3805.73,-23538.16"/>
<text text-anchor="middle" x="3443" y="-23488.96" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3443" y="-23473.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-23458.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3443" y="-23443.96" font-family="Times,serif" font-size="14.00">GPU: 112</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_gate -->
<g id="edge300" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_gate</title>
<path fill="none" stroke="black" d="M3751.93,-23755.03C3751.93,-23755.03 3751.93,-23548.29 3751.93,-23548.29"/>
<polygon fill="black" stroke="black" points="3755.43,-23548.29 3751.93,-23538.29 3748.43,-23548.29 3755.43,-23548.29"/>
</g>
<!-- layer_7_scatter -->
<g id="node182" class="node">
<title>layer_7_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3443" cy="-23123.08" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3443" y="-23141.88" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3443" y="-23126.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-23111.88" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-23096.88" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_scatter -->
<g id="edge301" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_scatter</title>
<path fill="none" stroke="black" d="M3902.68,-23754.84C3902.68,-23623.33 3902.68,-23159 3902.68,-23159 3902.68,-23159 3617.66,-23159 3617.66,-23159"/>
<polygon fill="black" stroke="black" points="3617.66,-23155.5 3607.66,-23159 3617.66,-23162.5 3617.66,-23155.5"/>
</g>
<!-- layer_7_add_norm2 -->
<g id="node200" class="node">
<title>layer_7_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4253,-22231.83 3891,-22231.83 3891,-22163.83 4253,-22163.83 4253,-22231.83"/>
<text text-anchor="middle" x="4072" y="-22216.63" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4072" y="-22201.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4072" y="-22186.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4072" y="-22171.63" font-family="Times,serif" font-size="14.00">GPU: 112</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_add_norm2 -->
<g id="edge336" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4029.75,-23754.82C4029.75,-23754.82 4029.75,-22242.13 4029.75,-22242.13"/>
<polygon fill="black" stroke="black" points="4033.25,-22242.13 4029.75,-22232.13 4026.25,-22242.13 4033.25,-22242.13"/>
<text text-anchor="middle" x="6415" y="-22955.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_scatter -->
<g id="edge302" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3443,-23402.01C3443,-23402.01 3443,-23181.27 3443,-23181.27"/>
<polygon fill="black" stroke="black" points="3446.5,-23181.27 3443,-23171.27 3439.5,-23181.27 3446.5,-23181.27"/>
<text text-anchor="middle" x="3486.5" y="-23282.96" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_7_expert_0 -->
<g id="node183" class="node">
<title>layer_7_expert_0</title>
<polygon fill="lightblue" stroke="black" points="444.5,-22844 121.5,-22844 121.5,-22776 444.5,-22776 444.5,-22844"/>
<text text-anchor="middle" x="283" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="283" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="283" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="283" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 112</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_0 -->
<g id="edge303" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_0</title>
<path fill="none" stroke="black" d="M3278.45,-23159C2630.36,-23159 289.5,-23159 289.5,-23159 289.5,-23159 289.5,-22854.1 289.5,-22854.1"/>
<polygon fill="black" stroke="black" points="293,-22854.1 289.5,-22844.1 286,-22854.1 293,-22854.1"/>
<text text-anchor="middle" x="566" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_112</text>
</g>
<!-- layer_7_expert_1 -->
<g id="node185" class="node">
<title>layer_7_expert_1</title>
<polygon fill="lightblue" stroke="black" points="839.5,-22844 516.5,-22844 516.5,-22776 839.5,-22776 839.5,-22844"/>
<text text-anchor="middle" x="678" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="678" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="678" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="678" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 113</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_1 -->
<g id="edge305" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_1</title>
<path fill="none" stroke="black" d="M3228.27,-23147C2579.6,-23147 684.5,-23147 684.5,-23147 684.5,-23147 684.5,-22854.17 684.5,-22854.17"/>
<polygon fill="black" stroke="black" points="688,-22854.17 684.5,-22844.17 681,-22854.17 688,-22854.17"/>
<text text-anchor="middle" x="970" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_113</text>
</g>
<!-- layer_7_expert_2 -->
<g id="node186" class="node">
<title>layer_7_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1234.5,-22844 911.5,-22844 911.5,-22776 1234.5,-22776 1234.5,-22844"/>
<text text-anchor="middle" x="1073" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1073" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1073" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1073" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 114</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_2 -->
<g id="edge307" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_2</title>
<path fill="none" stroke="black" d="M3203.09,-23135C2602.03,-23135 1079.5,-23135 1079.5,-23135 1079.5,-23135 1079.5,-22854.16 1079.5,-22854.16"/>
<polygon fill="black" stroke="black" points="1083,-22854.16 1079.5,-22844.16 1076,-22854.16 1083,-22854.16"/>
<text text-anchor="middle" x="1250" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_114</text>
</g>
<!-- layer_7_expert_3 -->
<g id="node187" class="node">
<title>layer_7_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1629.5,-22844 1306.5,-22844 1306.5,-22776 1629.5,-22776 1629.5,-22844"/>
<text text-anchor="middle" x="1468" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1468" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1468" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1468" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 115</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_3 -->
<g id="edge309" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_3</title>
<path fill="none" stroke="black" d="M3195.13,-23123C2692.69,-23123 1601.5,-23123 1601.5,-23123 1601.5,-23123 1601.5,-22854.09 1601.5,-22854.09"/>
<polygon fill="black" stroke="black" points="1605,-22854.09 1601.5,-22844.09 1598,-22854.09 1605,-22854.09"/>
<text text-anchor="middle" x="1548" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_115</text>
</g>
<!-- layer_7_expert_4 -->
<g id="node188" class="node">
<title>layer_7_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2024.5,-22844 1701.5,-22844 1701.5,-22776 2024.5,-22776 2024.5,-22844"/>
<text text-anchor="middle" x="1863" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1863" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1863" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1863" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 116</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_4 -->
<g id="edge311" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_4</title>
<path fill="none" stroke="black" d="M3203.28,-23111C2793.83,-23111 2003.5,-23111 2003.5,-23111 2003.5,-23111 2003.5,-22854.23 2003.5,-22854.23"/>
<polygon fill="black" stroke="black" points="2007,-22854.23 2003.5,-22844.23 2000,-22854.23 2007,-22854.23"/>
<text text-anchor="middle" x="2288" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_116</text>
</g>
<!-- layer_7_expert_5 -->
<g id="node189" class="node">
<title>layer_7_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2419.5,-22844 2096.5,-22844 2096.5,-22776 2419.5,-22776 2419.5,-22844"/>
<text text-anchor="middle" x="2258" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2258" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2258" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2258" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 117</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_5 -->
<g id="edge313" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_5</title>
<path fill="none" stroke="black" d="M3228.56,-23099C2888.71,-23099 2264.5,-23099 2264.5,-23099 2264.5,-23099 2264.5,-22854 2264.5,-22854"/>
<polygon fill="black" stroke="black" points="2268,-22854 2264.5,-22844 2261,-22854 2268,-22854"/>
<text text-anchor="middle" x="2740" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_117</text>
</g>
<!-- layer_7_expert_6 -->
<g id="node190" class="node">
<title>layer_7_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2814.5,-22844 2491.5,-22844 2491.5,-22776 2814.5,-22776 2814.5,-22844"/>
<text text-anchor="middle" x="2653" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2653" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2653" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2653" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 118</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_6 -->
<g id="edge315" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_6</title>
<path fill="none" stroke="black" d="M3279.23,-23087C3049.55,-23087 2659.5,-23087 2659.5,-23087 2659.5,-23087 2659.5,-22854.24 2659.5,-22854.24"/>
<polygon fill="black" stroke="black" points="2663,-22854.24 2659.5,-22844.24 2656,-22854.24 2663,-22854.24"/>
<text text-anchor="middle" x="3049" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_118</text>
</g>
<!-- layer_7_expert_7 -->
<g id="node191" class="node">
<title>layer_7_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3209.5,-22844 2886.5,-22844 2886.5,-22776 3209.5,-22776 3209.5,-22844"/>
<text text-anchor="middle" x="3048" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3048" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3048" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3048" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 119</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_7 -->
<g id="edge317" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_7</title>
<path fill="none" stroke="black" d="M3202.51,-23111.57C3202.51,-23111.57 3202.51,-22854.01 3202.51,-22854.01"/>
<polygon fill="black" stroke="black" points="3206.01,-22854.01 3202.51,-22844.01 3199.01,-22854.01 3206.01,-22854.01"/>
<text text-anchor="middle" x="3286" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_119</text>
</g>
<!-- layer_7_expert_8 -->
<g id="node192" class="node">
<title>layer_7_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3604.5,-22844 3281.5,-22844 3281.5,-22776 3604.5,-22776 3604.5,-22844"/>
<text text-anchor="middle" x="3443" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3443" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 120</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_8 -->
<g id="edge319" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_8</title>
<path fill="none" stroke="black" d="M3443,-23074.85C3443,-23074.85 3443,-22854.26 3443,-22854.26"/>
<polygon fill="black" stroke="black" points="3446.5,-22854.26 3443,-22844.26 3439.5,-22854.26 3446.5,-22854.26"/>
<text text-anchor="middle" x="3487" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_120</text>
</g>
<!-- layer_7_expert_9 -->
<g id="node193" class="node">
<title>layer_7_expert_9</title>
<polygon fill="lightblue" stroke="black" points="3999.5,-22844 3676.5,-22844 3676.5,-22776 3999.5,-22776 3999.5,-22844"/>
<text text-anchor="middle" x="3838" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3838" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3838" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3838" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 121</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_9 -->
<g id="edge321" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_9</title>
<path fill="none" stroke="black" d="M3683.49,-23111.57C3683.49,-23111.57 3683.49,-22854.01 3683.49,-22854.01"/>
<polygon fill="black" stroke="black" points="3686.99,-22854.01 3683.49,-22844.01 3679.99,-22854.01 3686.99,-22854.01"/>
<text text-anchor="middle" x="3767" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_121</text>
</g>
<!-- layer_7_expert_10 -->
<g id="node194" class="node">
<title>layer_7_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4394.5,-22844 4071.5,-22844 4071.5,-22776 4394.5,-22776 4394.5,-22844"/>
<text text-anchor="middle" x="4233" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4233" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4233" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4233" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 122</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_10 -->
<g id="edge323" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_10</title>
<path fill="none" stroke="black" d="M3606.72,-23087C3795.09,-23087 4078.75,-23087 4078.75,-23087 4078.75,-23087 4078.75,-22854.24 4078.75,-22854.24"/>
<polygon fill="black" stroke="black" points="4082.25,-22854.24 4078.75,-22844.24 4075.25,-22854.24 4082.25,-22854.24"/>
<text text-anchor="middle" x="4105" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_122</text>
</g>
<!-- layer_7_expert_11 -->
<g id="node195" class="node">
<title>layer_7_expert_11</title>
<polygon fill="lightblue" stroke="black" points="4789.5,-22844 4466.5,-22844 4466.5,-22776 4789.5,-22776 4789.5,-22844"/>
<text text-anchor="middle" x="4628" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4628" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4628" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4628" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 123</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_11 -->
<g id="edge325" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_11</title>
<path fill="none" stroke="black" d="M3657.35,-23099C3959.18,-23099 4473,-23099 4473,-23099 4473,-23099 4473,-22854 4473,-22854"/>
<polygon fill="black" stroke="black" points="4476.5,-22854 4473,-22844 4469.5,-22854 4476.5,-22854"/>
<text text-anchor="middle" x="4557" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_123</text>
</g>
<!-- layer_7_expert_12 -->
<g id="node196" class="node">
<title>layer_7_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5184.5,-22844 4861.5,-22844 4861.5,-22776 5184.5,-22776 5184.5,-22844"/>
<text text-anchor="middle" x="5023" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5023" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5023" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5023" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 124</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_12 -->
<g id="edge327" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_12</title>
<path fill="none" stroke="black" d="M3682.72,-23111C4088.72,-23111 4868,-23111 4868,-23111 4868,-23111 4868,-22854.23 4868,-22854.23"/>
<polygon fill="black" stroke="black" points="4871.5,-22854.23 4868,-22844.23 4864.5,-22854.23 4871.5,-22854.23"/>
<text text-anchor="middle" x="4952" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_124</text>
</g>
<!-- layer_7_expert_13 -->
<g id="node197" class="node">
<title>layer_7_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5579.5,-22844 5256.5,-22844 5256.5,-22776 5579.5,-22776 5579.5,-22844"/>
<text text-anchor="middle" x="5418" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5418" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5418" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5418" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 125</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_13 -->
<g id="edge329" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_13</title>
<path fill="none" stroke="black" d="M3690.82,-23123C4188.65,-23123 5263,-23123 5263,-23123 5263,-23123 5263,-22854.09 5263,-22854.09"/>
<polygon fill="black" stroke="black" points="5266.5,-22854.09 5263,-22844.09 5259.5,-22854.09 5266.5,-22854.09"/>
<text text-anchor="middle" x="5347" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_125</text>
</g>
<!-- layer_7_expert_14 -->
<g id="node198" class="node">
<title>layer_7_expert_14</title>
<polygon fill="lightblue" stroke="black" points="5974.5,-22844 5651.5,-22844 5651.5,-22776 5974.5,-22776 5974.5,-22844"/>
<text text-anchor="middle" x="5813" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5813" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5813" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5813" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 126</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_14 -->
<g id="edge331" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_14</title>
<path fill="none" stroke="black" d="M3682.94,-23135C4256.19,-23135 5658,-23135 5658,-23135 5658,-23135 5658,-22854.16 5658,-22854.16"/>
<polygon fill="black" stroke="black" points="5661.5,-22854.16 5658,-22844.16 5654.5,-22854.16 5661.5,-22854.16"/>
<text text-anchor="middle" x="5685" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_126</text>
</g>
<!-- layer_7_expert_15 -->
<g id="node199" class="node">
<title>layer_7_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6369.5,-22844 6046.5,-22844 6046.5,-22776 6369.5,-22776 6369.5,-22844"/>
<text text-anchor="middle" x="6208" y="-22828.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6208" y="-22813.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6208" y="-22798.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6208" y="-22783.8" font-family="Times,serif" font-size="14.00">GPU: 127</text>
</g>
<!-- layer_7_scatter&#45;&gt;layer_7_expert_15 -->
<g id="edge333" class="edge">
<title>layer_7_scatter&#45;&gt;layer_7_expert_15</title>
<path fill="none" stroke="black" d="M3657.7,-23147C4282.03,-23147 6053,-23147 6053,-23147 6053,-23147 6053,-22854.17 6053,-22854.17"/>
<polygon fill="black" stroke="black" points="6056.5,-22854.17 6053,-22844.17 6049.5,-22854.17 6056.5,-22854.17"/>
<text text-anchor="middle" x="6137" y="-22955.8" font-family="Times,serif" font-size="14.00">to_GPU_127</text>
</g>
<!-- layer_7_gather -->
<g id="node184" class="node">
<title>layer_7_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3443" cy="-22496.91" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3443" y="-22515.71" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3443" y="-22500.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-22485.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-22470.71" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_7_expert_0&#45;&gt;layer_7_gather -->
<g id="edge304" class="edge">
<title>layer_7_expert_0&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M354,-22775.8C354,-22687.73 354,-22460 354,-22460 354,-22460 3268.83,-22460 3268.83,-22460"/>
<polygon fill="black" stroke="black" points="3268.83,-22463.5 3278.83,-22460 3268.83,-22456.5 3268.83,-22463.5"/>
<text text-anchor="middle" x="547.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_112</text>
</g>
<!-- layer_7_gather&#45;&gt;layer_7_add_norm2 -->
<g id="edge335" class="edge">
<title>layer_7_gather&#45;&gt;layer_7_add_norm2</title>
<path fill="none" stroke="black" d="M3637.24,-22465.38C3637.24,-22388.38 3637.24,-22197 3637.24,-22197 3637.24,-22197 3880.77,-22197 3880.77,-22197"/>
<polygon fill="black" stroke="black" points="3880.77,-22200.5 3890.77,-22197 3880.77,-22193.5 3880.77,-22200.5"/>
</g>
<!-- layer_7_expert_1&#45;&gt;layer_7_gather -->
<g id="edge306" class="edge">
<title>layer_7_expert_1&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M749,-22775.73C749,-22689.8 749,-22472 749,-22472 749,-22472 3213.97,-22472 3213.97,-22472"/>
<polygon fill="black" stroke="black" points="3213.97,-22475.5 3223.97,-22472 3213.97,-22468.5 3213.97,-22475.5"/>
<text text-anchor="middle" x="942.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_113</text>
</g>
<!-- layer_7_expert_2&#45;&gt;layer_7_gather -->
<g id="edge308" class="edge">
<title>layer_7_expert_2&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M1144,-22775.73C1144,-22692.03 1144,-22484 1144,-22484 1144,-22484 3186.42,-22484 3186.42,-22484"/>
<polygon fill="black" stroke="black" points="3186.42,-22487.5 3196.42,-22484 3186.42,-22480.5 3186.42,-22487.5"/>
<text text-anchor="middle" x="1337.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_114</text>
</g>
<!-- layer_7_expert_3&#45;&gt;layer_7_gather -->
<g id="edge310" class="edge">
<title>layer_7_expert_3&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M1539,-22775.8C1539,-22694.42 1539,-22496 1539,-22496 1539,-22496 3176.71,-22496 3176.71,-22496"/>
<polygon fill="black" stroke="black" points="3176.71,-22499.5 3186.71,-22496 3176.71,-22492.5 3176.71,-22499.5"/>
<text text-anchor="middle" x="1732.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_115</text>
</g>
<!-- layer_7_expert_4&#45;&gt;layer_7_gather -->
<g id="edge312" class="edge">
<title>layer_7_expert_4&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M1863,-22775.94C1863,-22696.96 1863,-22508 1863,-22508 1863,-22508 3183.52,-22508 3183.52,-22508"/>
<polygon fill="black" stroke="black" points="3183.52,-22511.5 3193.52,-22508 3183.52,-22504.5 3183.52,-22511.5"/>
<text text-anchor="middle" x="2127.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_116</text>
</g>
<!-- layer_7_expert_5&#45;&gt;layer_7_gather -->
<g id="edge314" class="edge">
<title>layer_7_expert_5&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M2329,-22775.88C2329,-22699.22 2329,-22520 2329,-22520 2329,-22520 3208.24,-22520 3208.24,-22520"/>
<polygon fill="black" stroke="black" points="3208.24,-22523.5 3218.24,-22520 3208.24,-22516.5 3208.24,-22523.5"/>
<text text-anchor="middle" x="2522.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_117</text>
</g>
<!-- layer_7_expert_6&#45;&gt;layer_7_gather -->
<g id="edge316" class="edge">
<title>layer_7_expert_6&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M2724,-22775.91C2724,-22701.68 2724,-22532 2724,-22532 2724,-22532 3257.57,-22532 3257.57,-22532"/>
<polygon fill="black" stroke="black" points="3257.57,-22535.5 3267.57,-22532 3257.57,-22528.5 3257.57,-22535.5"/>
<text text-anchor="middle" x="2917.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_118</text>
</g>
<!-- layer_7_expert_7&#45;&gt;layer_7_gather -->
<g id="edge318" class="edge">
<title>layer_7_expert_7&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M3198.26,-22775.9C3198.26,-22775.9 3198.26,-22521.17 3198.26,-22521.17"/>
<polygon fill="black" stroke="black" points="3201.76,-22521.17 3198.26,-22511.17 3194.76,-22521.17 3201.76,-22521.17"/>
<text text-anchor="middle" x="3206.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_119</text>
</g>
<!-- layer_7_expert_8&#45;&gt;layer_7_gather -->
<g id="edge320" class="edge">
<title>layer_7_expert_8&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M3443,-22775.9C3443,-22775.9 3443,-22555 3443,-22555"/>
<polygon fill="black" stroke="black" points="3446.5,-22555 3443,-22545 3439.5,-22555 3446.5,-22555"/>
<text text-anchor="middle" x="3496.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_120</text>
</g>
<!-- layer_7_expert_9&#45;&gt;layer_7_gather -->
<g id="edge322" class="edge">
<title>layer_7_expert_9&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M3687.74,-22775.9C3687.74,-22775.9 3687.74,-22521.17 3687.74,-22521.17"/>
<polygon fill="black" stroke="black" points="3691.24,-22521.17 3687.74,-22511.17 3684.24,-22521.17 3691.24,-22521.17"/>
<text text-anchor="middle" x="3786.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_121</text>
</g>
<!-- layer_7_expert_10&#45;&gt;layer_7_gather -->
<g id="edge324" class="edge">
<title>layer_7_expert_10&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M4162.25,-22775.79C4162.25,-22701.29 4162.25,-22531 4162.25,-22531 4162.25,-22531 3633.57,-22531 3633.57,-22531"/>
<polygon fill="black" stroke="black" points="3633.57,-22527.5 3623.57,-22531 3633.57,-22534.5 3633.57,-22527.5"/>
<text text-anchor="middle" x="4181.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_122</text>
</g>
<!-- layer_7_expert_11&#45;&gt;layer_7_gather -->
<g id="edge326" class="edge">
<title>layer_7_expert_11&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M4501.5,-22775.81C4501.5,-22698.52 4501.5,-22517 4501.5,-22517 4501.5,-22517 3685.62,-22517 3685.62,-22517"/>
<polygon fill="black" stroke="black" points="3685.62,-22513.5 3675.62,-22517 3685.62,-22520.5 3685.62,-22513.5"/>
<text text-anchor="middle" x="4576.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_123</text>
</g>
<!-- layer_7_expert_12&#45;&gt;layer_7_gather -->
<g id="edge328" class="edge">
<title>layer_7_expert_12&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M4896.5,-22775.97C4896.5,-22696.04 4896.5,-22503 4896.5,-22503 4896.5,-22503 3707.01,-22503 3707.01,-22503"/>
<polygon fill="black" stroke="black" points="3707.01,-22499.5 3697.01,-22503 3707.01,-22506.5 3707.01,-22499.5"/>
<text text-anchor="middle" x="4918.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_124</text>
</g>
<!-- layer_7_expert_13&#45;&gt;layer_7_gather -->
<g id="edge330" class="edge">
<title>layer_7_expert_13&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M5291.5,-22775.75C5291.5,-22693.2 5291.5,-22490 5291.5,-22490 5291.5,-22490 3706.63,-22490 3706.63,-22490"/>
<polygon fill="black" stroke="black" points="3706.63,-22486.5 3696.63,-22490 3706.63,-22493.5 3706.63,-22486.5"/>
<text text-anchor="middle" x="5286.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_125</text>
</g>
<!-- layer_7_expert_14&#45;&gt;layer_7_gather -->
<g id="edge332" class="edge">
<title>layer_7_expert_14&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M5686.5,-22775.82C5686.5,-22690.7 5686.5,-22476 5686.5,-22476 5686.5,-22476 3683.6,-22476 3683.6,-22476"/>
<polygon fill="black" stroke="black" points="3683.6,-22472.5 3673.6,-22476 3683.6,-22479.5 3683.6,-22472.5"/>
<text text-anchor="middle" x="5668.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_126</text>
</g>
<!-- layer_7_expert_15&#45;&gt;layer_7_gather -->
<g id="edge334" class="edge">
<title>layer_7_expert_15&#45;&gt;layer_7_gather</title>
<path fill="none" stroke="black" d="M6081.5,-22776C6081.5,-22688.43 6081.5,-22462 6081.5,-22462 6081.5,-22462 3629.19,-22462 3629.19,-22462"/>
<polygon fill="black" stroke="black" points="3629.19,-22458.5 3619.19,-22462 3629.19,-22465.5 3629.19,-22458.5"/>
<text text-anchor="middle" x="6057.5" y="-22656.8" font-family="Times,serif" font-size="14.00">from_GPU_127</text>
</g>
<!-- layer_8_qkv -->
<g id="node202" class="node">
<title>layer_8_qkv</title>
<polygon fill="lightblue" stroke="black" points="3984.5,-21946.83 3575.5,-21946.83 3575.5,-21878.83 3984.5,-21878.83 3984.5,-21946.83"/>
<text text-anchor="middle" x="3780" y="-21931.63" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3780" y="-21916.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3780" y="-21901.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3780" y="-21886.63" font-family="Times,serif" font-size="14.00">GPU: 128</text>
</g>
<!-- layer_7_add_norm2&#45;&gt;layer_8_qkv -->
<g id="edge337" class="edge">
<title>layer_7_add_norm2&#45;&gt;layer_8_qkv</title>
<path fill="none" stroke="black" d="M3937.75,-22163.74C3937.75,-22163.74 3937.75,-21956.96 3937.75,-21956.96"/>
<polygon fill="black" stroke="black" points="3941.25,-21956.96 3937.75,-21946.96 3934.25,-21956.96 3941.25,-21956.96"/>
</g>
<!-- layer_8_add_norm1 -->
<g id="node205" class="node">
<title>layer_8_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4202,-21091.83 3840,-21091.83 3840,-21023.83 4202,-21023.83 4202,-21091.83"/>
<text text-anchor="middle" x="4021" y="-21076.63" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4021" y="-21061.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4021" y="-21046.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4021" y="-21031.63" font-family="Times,serif" font-size="14.00">GPU: 128</text>
</g>
<!-- layer_7_add_norm2&#45;&gt;layer_8_add_norm1 -->
<g id="edge341" class="edge">
<title>layer_7_add_norm2&#45;&gt;layer_8_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4096.75,-22163.71C4096.75,-22163.71 4096.75,-21102.09 4096.75,-21102.09"/>
<polygon fill="black" stroke="black" points="4100.25,-21102.09 4096.75,-21092.09 4093.25,-21102.09 4100.25,-21102.09"/>
<text text-anchor="middle" x="4140" y="-21624.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_7_mha -->
<g id="node201" class="node">
<title>layer_7_mha</title>
<polygon fill="lightblue" stroke="black" points="1982.5,-24678.16 1573.5,-24678.16 1573.5,-24610.16 1982.5,-24610.16 1982.5,-24678.16"/>
<text text-anchor="middle" x="1778" y="-24662.96" font-family="Times,serif" font-size="14.00">MHA Layer 7</text>
<text text-anchor="middle" x="1778" y="-24647.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1778" y="-24632.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1778" y="-24617.96" font-family="Times,serif" font-size="14.00">GPU: 112</text>
</g>
<!-- layer_8_attn -->
<g id="node203" class="node">
<title>layer_8_attn</title>
<polygon fill="lightblue" stroke="black" points="3966.5,-21661.83 3557.5,-21661.83 3557.5,-21593.83 3966.5,-21593.83 3966.5,-21661.83"/>
<text text-anchor="middle" x="3762" y="-21646.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3762" y="-21631.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3762" y="-21616.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3762" y="-21601.63" font-family="Times,serif" font-size="14.00">GPU: 128</text>
</g>
<!-- layer_8_qkv&#45;&gt;layer_8_attn -->
<g id="edge338" class="edge">
<title>layer_8_qkv&#45;&gt;layer_8_attn</title>
<path fill="none" stroke="black" d="M3771,-21878.74C3771,-21878.74 3771,-21671.96 3771,-21671.96"/>
<polygon fill="black" stroke="black" points="3774.5,-21671.96 3771,-21661.96 3767.5,-21671.96 3774.5,-21671.96"/>
</g>
<!-- layer_8_proj -->
<g id="node204" class="node">
<title>layer_8_proj</title>
<polygon fill="lightblue" stroke="black" points="3991.5,-21376.83 3594.5,-21376.83 3594.5,-21308.83 3991.5,-21308.83 3991.5,-21376.83"/>
<text text-anchor="middle" x="3793" y="-21361.63" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3793" y="-21346.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3793" y="-21331.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3793" y="-21316.63" font-family="Times,serif" font-size="14.00">GPU: 128</text>
</g>
<!-- layer_8_attn&#45;&gt;layer_8_proj -->
<g id="edge339" class="edge">
<title>layer_8_attn&#45;&gt;layer_8_proj</title>
<path fill="none" stroke="black" d="M3780.5,-21593.74C3780.5,-21593.74 3780.5,-21386.96 3780.5,-21386.96"/>
<polygon fill="black" stroke="black" points="3784,-21386.96 3780.5,-21376.96 3777,-21386.96 3784,-21386.96"/>
</g>
<!-- layer_8_proj&#45;&gt;layer_8_add_norm1 -->
<g id="edge340" class="edge">
<title>layer_8_proj&#45;&gt;layer_8_add_norm1</title>
<path fill="none" stroke="black" d="M3915.75,-21308.74C3915.75,-21308.74 3915.75,-21101.96 3915.75,-21101.96"/>
<polygon fill="black" stroke="black" points="3919.25,-21101.96 3915.75,-21091.96 3912.25,-21101.96 3919.25,-21101.96"/>
</g>
<!-- layer_8_gate -->
<g id="node206" class="node">
<title>layer_8_gate</title>
<polygon fill="yellow" stroke="black" points="3947.73,-20806.83 3370.71,-20806.83 3222.27,-20670.83 3799.29,-20670.83 3947.73,-20806.83"/>
<text text-anchor="middle" x="3585" y="-20757.63" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3585" y="-20742.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3585" y="-20727.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3585" y="-20712.63" font-family="Times,serif" font-size="14.00">GPU: 128</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_gate -->
<g id="edge342" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_gate</title>
<path fill="none" stroke="black" d="M3893.93,-21023.69C3893.93,-21023.69 3893.93,-20816.95 3893.93,-20816.95"/>
<polygon fill="black" stroke="black" points="3897.43,-20816.95 3893.93,-20806.95 3890.43,-20816.95 3897.43,-20816.95"/>
</g>
<!-- layer_8_scatter -->
<g id="node207" class="node">
<title>layer_8_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3585" cy="-20391.75" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3585" y="-20410.55" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3585" y="-20395.55" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3585" y="-20380.55" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3585" y="-20365.55" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_scatter -->
<g id="edge343" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_scatter</title>
<path fill="none" stroke="black" d="M4044.68,-21023.47C4044.68,-20891.83 4044.68,-20427 4044.68,-20427 4044.68,-20427 3763.56,-20427 3763.56,-20427"/>
<polygon fill="black" stroke="black" points="3763.56,-20423.5 3753.56,-20427 3763.56,-20430.5 3763.56,-20423.5"/>
</g>
<!-- layer_8_add_norm2 -->
<g id="node225" class="node">
<title>layer_8_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4313,-19500.5 3951,-19500.5 3951,-19432.5 4313,-19432.5 4313,-19500.5"/>
<text text-anchor="middle" x="4132" y="-19485.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4132" y="-19470.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4132" y="-19455.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4132" y="-19440.3" font-family="Times,serif" font-size="14.00">GPU: 128</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_add_norm2 -->
<g id="edge378" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4171.75,-21023.49C4171.75,-21023.49 4171.75,-19510.79 4171.75,-19510.79"/>
<polygon fill="black" stroke="black" points="4175.25,-19510.79 4171.75,-19500.79 4168.25,-19510.79 4175.25,-19510.79"/>
<text text-anchor="middle" x="6557" y="-20224.46" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_scatter -->
<g id="edge344" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3585,-20670.67C3585,-20670.67 3585,-20449.94 3585,-20449.94"/>
<polygon fill="black" stroke="black" points="3588.5,-20449.93 3585,-20439.94 3581.5,-20449.94 3588.5,-20449.93"/>
<text text-anchor="middle" x="3628.5" y="-20551.63" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_8_expert_0 -->
<g id="node208" class="node">
<title>layer_8_expert_0</title>
<polygon fill="lightblue" stroke="black" points="586.5,-20112.66 263.5,-20112.66 263.5,-20044.66 586.5,-20044.66 586.5,-20112.66"/>
<text text-anchor="middle" x="425" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="425" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="425" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="425" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 128</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_0 -->
<g id="edge345" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_0</title>
<path fill="none" stroke="black" d="M3416.5,-20427C2779.11,-20427 551.5,-20427 551.5,-20427 551.5,-20427 551.5,-20122.7 551.5,-20122.7"/>
<polygon fill="black" stroke="black" points="555,-20122.7 551.5,-20112.7 548,-20122.7 555,-20122.7"/>
<text text-anchor="middle" x="590" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_128</text>
</g>
<!-- layer_8_expert_1 -->
<g id="node210" class="node">
<title>layer_8_expert_1</title>
<polygon fill="lightblue" stroke="black" points="981.5,-20112.66 658.5,-20112.66 658.5,-20044.66 981.5,-20044.66 981.5,-20112.66"/>
<text text-anchor="middle" x="820" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="820" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="820" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="820" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 129</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_1 -->
<g id="edge347" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_1</title>
<path fill="none" stroke="black" d="M3368.24,-20415C2737.34,-20415 946.5,-20415 946.5,-20415 946.5,-20415 946.5,-20122.76 946.5,-20122.76"/>
<polygon fill="black" stroke="black" points="950,-20122.76 946.5,-20112.76 943,-20122.76 950,-20122.76"/>
<text text-anchor="middle" x="877" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_129</text>
</g>
<!-- layer_8_expert_2 -->
<g id="node211" class="node">
<title>layer_8_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1376.5,-20112.66 1053.5,-20112.66 1053.5,-20044.66 1376.5,-20044.66 1376.5,-20112.66"/>
<text text-anchor="middle" x="1215" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1215" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1215" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1215" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 130</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_2 -->
<g id="edge349" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_2</title>
<path fill="none" stroke="black" d="M3344.37,-20403C2765.27,-20403 1341.5,-20403 1341.5,-20403 1341.5,-20403 1341.5,-20122.76 1341.5,-20122.76"/>
<polygon fill="black" stroke="black" points="1345,-20122.76 1341.5,-20112.76 1338,-20122.76 1345,-20122.76"/>
<text text-anchor="middle" x="1847" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_130</text>
</g>
<!-- layer_8_expert_3 -->
<g id="node212" class="node">
<title>layer_8_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1771.5,-20112.66 1448.5,-20112.66 1448.5,-20044.66 1771.5,-20044.66 1771.5,-20112.66"/>
<text text-anchor="middle" x="1610" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1610" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1610" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1610" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 131</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_3 -->
<g id="edge351" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_3</title>
<path fill="none" stroke="black" d="M3337.15,-20391C2832.5,-20391 1733,-20391 1733,-20391 1733,-20391 1733,-20122.68 1733,-20122.68"/>
<polygon fill="black" stroke="black" points="1736.5,-20122.68 1733,-20112.68 1729.5,-20122.68 1736.5,-20122.68"/>
<text text-anchor="middle" x="2414" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_131</text>
</g>
<!-- layer_8_expert_4 -->
<g id="node213" class="node">
<title>layer_8_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2166.5,-20112.66 1843.5,-20112.66 1843.5,-20044.66 2166.5,-20044.66 2166.5,-20112.66"/>
<text text-anchor="middle" x="2005" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2005" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2005" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2005" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 132</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_4 -->
<g id="edge353" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_4</title>
<path fill="none" stroke="black" d="M3345.97,-20379C2934.25,-20379 2135,-20379 2135,-20379 2135,-20379 2135,-20122.82 2135,-20122.82"/>
<polygon fill="black" stroke="black" points="2138.5,-20122.82 2135,-20112.82 2131.5,-20122.82 2138.5,-20122.82"/>
<text text-anchor="middle" x="2780" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_132</text>
</g>
<!-- layer_8_expert_5 -->
<g id="node214" class="node">
<title>layer_8_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2561.5,-20112.66 2238.5,-20112.66 2238.5,-20044.66 2561.5,-20044.66 2561.5,-20112.66"/>
<text text-anchor="middle" x="2400" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2400" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2400" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2400" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 133</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_5 -->
<g id="edge355" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_5</title>
<path fill="none" stroke="black" d="M3372.71,-20367C3063.71,-20367 2526.5,-20367 2526.5,-20367 2526.5,-20367 2526.5,-20122.87 2526.5,-20122.87"/>
<polygon fill="black" stroke="black" points="2530,-20122.87 2526.5,-20112.87 2523,-20122.87 2530,-20122.87"/>
<text text-anchor="middle" x="3046" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_133</text>
</g>
<!-- layer_8_expert_6 -->
<g id="node215" class="node">
<title>layer_8_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2956.5,-20112.66 2633.5,-20112.66 2633.5,-20044.66 2956.5,-20044.66 2956.5,-20112.66"/>
<text text-anchor="middle" x="2795" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2795" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2795" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2795" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 134</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_6 -->
<g id="edge357" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_6</title>
<path fill="none" stroke="black" d="M3425.23,-20355C3228.9,-20355 2921.5,-20355 2921.5,-20355 2921.5,-20355 2921.5,-20122.83 2921.5,-20122.83"/>
<polygon fill="black" stroke="black" points="2925,-20122.83 2921.5,-20112.83 2918,-20122.83 2925,-20122.83"/>
<text text-anchor="middle" x="3261" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_134</text>
</g>
<!-- layer_8_expert_7 -->
<g id="node216" class="node">
<title>layer_8_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3351.5,-20112.66 3028.5,-20112.66 3028.5,-20044.66 3351.5,-20044.66 3351.5,-20112.66"/>
<text text-anchor="middle" x="3190" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3190" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3190" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3190" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 135</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_7 -->
<g id="edge359" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_7</title>
<path fill="none" stroke="black" d="M3344.51,-20380.23C3344.51,-20380.23 3344.51,-20122.67 3344.51,-20122.67"/>
<polygon fill="black" stroke="black" points="3348.01,-20122.67 3344.51,-20112.67 3341.01,-20122.67 3348.01,-20122.67"/>
<text text-anchor="middle" x="3451" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_135</text>
</g>
<!-- layer_8_expert_8 -->
<g id="node217" class="node">
<title>layer_8_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3746.5,-20112.66 3423.5,-20112.66 3423.5,-20044.66 3746.5,-20044.66 3746.5,-20112.66"/>
<text text-anchor="middle" x="3585" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3585" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3585" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3585" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 136</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_8 -->
<g id="edge361" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_8</title>
<path fill="none" stroke="black" d="M3585,-20343.51C3585,-20343.51 3585,-20122.93 3585,-20122.93"/>
<polygon fill="black" stroke="black" points="3588.5,-20122.93 3585,-20112.93 3581.5,-20122.93 3588.5,-20122.93"/>
<text text-anchor="middle" x="3629" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_136</text>
</g>
<!-- layer_8_expert_9 -->
<g id="node218" class="node">
<title>layer_8_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4141.5,-20112.66 3818.5,-20112.66 3818.5,-20044.66 4141.5,-20044.66 4141.5,-20112.66"/>
<text text-anchor="middle" x="3980" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3980" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3980" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3980" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 137</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_9 -->
<g id="edge363" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_9</title>
<path fill="none" stroke="black" d="M3825.49,-20380.23C3825.49,-20380.23 3825.49,-20122.67 3825.49,-20122.67"/>
<polygon fill="black" stroke="black" points="3828.99,-20122.67 3825.49,-20112.67 3821.99,-20122.67 3828.99,-20122.67"/>
<text text-anchor="middle" x="3909" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_137</text>
</g>
<!-- layer_8_expert_10 -->
<g id="node219" class="node">
<title>layer_8_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4536.5,-20112.66 4213.5,-20112.66 4213.5,-20044.66 4536.5,-20044.66 4536.5,-20112.66"/>
<text text-anchor="middle" x="4375" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4375" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4375" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4375" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 138</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_10 -->
<g id="edge365" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_10</title>
<path fill="none" stroke="black" d="M3744.83,-20355C3936.78,-20355 4233.25,-20355 4233.25,-20355 4233.25,-20355 4233.25,-20122.83 4233.25,-20122.83"/>
<polygon fill="black" stroke="black" points="4236.75,-20122.83 4233.25,-20112.83 4229.75,-20122.83 4236.75,-20122.83"/>
<text text-anchor="middle" x="4189" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_138</text>
</g>
<!-- layer_8_expert_11 -->
<g id="node220" class="node">
<title>layer_8_expert_11</title>
<polygon fill="lightblue" stroke="black" points="4931.5,-20112.66 4608.5,-20112.66 4608.5,-20044.66 4931.5,-20044.66 4931.5,-20112.66"/>
<text text-anchor="middle" x="4770" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4770" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4770" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4770" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 139</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_11 -->
<g id="edge367" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_11</title>
<path fill="none" stroke="black" d="M3797.49,-20367C4120.77,-20367 4699,-20367 4699,-20367 4699,-20367 4699,-20122.87 4699,-20122.87"/>
<polygon fill="black" stroke="black" points="4702.5,-20122.87 4699,-20112.87 4695.5,-20122.87 4702.5,-20122.87"/>
<text text-anchor="middle" x="4526" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_139</text>
</g>
<!-- layer_8_expert_12 -->
<g id="node221" class="node">
<title>layer_8_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5326.5,-20112.66 5003.5,-20112.66 5003.5,-20044.66 5326.5,-20044.66 5326.5,-20112.66"/>
<text text-anchor="middle" x="5165" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5165" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5165" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5165" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 140</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_12 -->
<g id="edge369" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_12</title>
<path fill="none" stroke="black" d="M3823.69,-20379C4249.05,-20379 5094,-20379 5094,-20379 5094,-20379 5094,-20122.82 5094,-20122.82"/>
<polygon fill="black" stroke="black" points="5097.5,-20122.82 5094,-20112.82 5090.5,-20122.82 5097.5,-20122.82"/>
<text text-anchor="middle" x="4892" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_140</text>
</g>
<!-- layer_8_expert_13 -->
<g id="node222" class="node">
<title>layer_8_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5721.5,-20112.66 5398.5,-20112.66 5398.5,-20044.66 5721.5,-20044.66 5721.5,-20112.66"/>
<text text-anchor="middle" x="5560" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5560" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5560" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5560" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 141</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_13 -->
<g id="edge371" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_13</title>
<path fill="none" stroke="black" d="M3832.94,-20391C4348.58,-20391 5489,-20391 5489,-20391 5489,-20391 5489,-20122.68 5489,-20122.68"/>
<polygon fill="black" stroke="black" points="5492.5,-20122.68 5489,-20112.68 5485.5,-20122.68 5492.5,-20122.68"/>
<text text-anchor="middle" x="5158" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_141</text>
</g>
<!-- layer_8_expert_14 -->
<g id="node223" class="node">
<title>layer_8_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6116.5,-20112.66 5793.5,-20112.66 5793.5,-20044.66 6116.5,-20044.66 6116.5,-20112.66"/>
<text text-anchor="middle" x="5955" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5955" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5955" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5955" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 142</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_14 -->
<g id="edge373" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_14</title>
<path fill="none" stroke="black" d="M3825.88,-20403C4415.6,-20403 5884,-20403 5884,-20403 5884,-20403 5884,-20122.76 5884,-20122.76"/>
<polygon fill="black" stroke="black" points="5887.5,-20122.76 5884,-20112.76 5880.5,-20122.76 5887.5,-20122.76"/>
<text text-anchor="middle" x="5373" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_142</text>
</g>
<!-- layer_8_expert_15 -->
<g id="node224" class="node">
<title>layer_8_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6511.5,-20112.66 6188.5,-20112.66 6188.5,-20044.66 6511.5,-20044.66 6511.5,-20112.66"/>
<text text-anchor="middle" x="6350" y="-20097.46" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6350" y="-20082.46" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6350" y="-20067.46" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6350" y="-20052.46" font-family="Times,serif" font-size="14.00">GPU: 143</text>
</g>
<!-- layer_8_scatter&#45;&gt;layer_8_expert_15 -->
<g id="edge375" class="edge">
<title>layer_8_scatter&#45;&gt;layer_8_expert_15</title>
<path fill="none" stroke="black" d="M3801.76,-20415C4441.81,-20415 6279,-20415 6279,-20415 6279,-20415 6279,-20122.76 6279,-20122.76"/>
<polygon fill="black" stroke="black" points="6282.5,-20122.76 6279,-20112.76 6275.5,-20122.76 6282.5,-20122.76"/>
<text text-anchor="middle" x="5704" y="-20224.46" font-family="Times,serif" font-size="14.00">to_GPU_143</text>
</g>
<!-- layer_8_gather -->
<g id="node209" class="node">
<title>layer_8_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3585" cy="-19765.58" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3585" y="-19784.38" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3585" y="-19769.38" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3585" y="-19754.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3585" y="-19739.38" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_8_expert_0&#45;&gt;layer_8_gather -->
<g id="edge346" class="edge">
<title>layer_8_expert_0&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M485,-20044.5C485,-19956.52 485,-19729 485,-19729 485,-19729 3408.6,-19729 3408.6,-19729"/>
<polygon fill="black" stroke="black" points="3408.6,-19732.5 3418.6,-19729 3408.6,-19725.5 3408.6,-19732.5"/>
<text text-anchor="middle" x="689.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_128</text>
</g>
<!-- layer_8_gather&#45;&gt;layer_8_add_norm2 -->
<g id="edge377" class="edge">
<title>layer_8_gather&#45;&gt;layer_8_add_norm2</title>
<path fill="none" stroke="black" d="M3769.74,-19732.09C3769.74,-19653.91 3769.74,-19466 3769.74,-19466 3769.74,-19466 3940.87,-19466 3940.87,-19466"/>
<polygon fill="black" stroke="black" points="3940.87,-19469.5 3950.87,-19466 3940.87,-19462.5 3940.87,-19469.5"/>
</g>
<!-- layer_8_expert_1&#45;&gt;layer_8_gather -->
<g id="edge348" class="edge">
<title>layer_8_expert_1&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M880,-20044.43C880,-19958.58 880,-19741 880,-19741 880,-19741 3354.79,-19741 3354.79,-19741"/>
<polygon fill="black" stroke="black" points="3354.79,-19744.5 3364.79,-19741 3354.79,-19737.5 3354.79,-19744.5"/>
<text text-anchor="middle" x="1084.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_129</text>
</g>
<!-- layer_8_expert_2&#45;&gt;layer_8_gather -->
<g id="edge350" class="edge">
<title>layer_8_expert_2&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M1275,-20044.43C1275,-19960.82 1275,-19753 1275,-19753 1275,-19753 3327.79,-19753 3327.79,-19753"/>
<polygon fill="black" stroke="black" points="3327.79,-19756.5 3337.79,-19753 3327.79,-19749.5 3327.79,-19756.5"/>
<text text-anchor="middle" x="1479.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_130</text>
</g>
<!-- layer_8_expert_3&#45;&gt;layer_8_gather -->
<g id="edge352" class="edge">
<title>layer_8_expert_3&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M1728,-20044.5C1728,-19963.2 1728,-19765 1728,-19765 1728,-19765 3318.74,-19765 3318.74,-19765"/>
<polygon fill="black" stroke="black" points="3318.74,-19768.5 3328.74,-19765 3318.74,-19761.5 3318.74,-19768.5"/>
<text text-anchor="middle" x="1874.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_131</text>
</g>
<!-- layer_8_expert_4&#45;&gt;layer_8_gather -->
<g id="edge354" class="edge">
<title>layer_8_expert_4&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M2130,-20044.65C2130,-19965.75 2130,-19777 2130,-19777 2130,-19777 3326.12,-19777 3326.12,-19777"/>
<polygon fill="black" stroke="black" points="3326.12,-19780.5 3336.12,-19777 3326.12,-19773.5 3326.12,-19780.5"/>
<text text-anchor="middle" x="2269.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_132</text>
</g>
<!-- layer_8_expert_5&#45;&gt;layer_8_gather -->
<g id="edge356" class="edge">
<title>layer_8_expert_5&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M2460,-20044.58C2460,-19968.01 2460,-19789 2460,-19789 2460,-19789 3351.39,-19789 3351.39,-19789"/>
<polygon fill="black" stroke="black" points="3351.39,-19792.5 3361.39,-19789 3351.39,-19785.5 3351.39,-19792.5"/>
<text text-anchor="middle" x="2664.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_133</text>
</g>
<!-- layer_8_expert_6&#45;&gt;layer_8_gather -->
<g id="edge358" class="edge">
<title>layer_8_expert_6&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M2855,-20044.62C2855,-19970.47 2855,-19801 2855,-19801 2855,-19801 3401.54,-19801 3401.54,-19801"/>
<polygon fill="black" stroke="black" points="3401.54,-19804.5 3411.54,-19801 3401.54,-19797.5 3401.54,-19804.5"/>
<text text-anchor="middle" x="3059.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_134</text>
</g>
<!-- layer_8_expert_7&#45;&gt;layer_8_gather -->
<g id="edge360" class="edge">
<title>layer_8_expert_7&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M3340.26,-20044.56C3340.26,-20044.56 3340.26,-19789.84 3340.26,-19789.84"/>
<polygon fill="black" stroke="black" points="3343.76,-19789.84 3340.26,-19779.84 3336.76,-19789.84 3343.76,-19789.84"/>
<text text-anchor="middle" x="3348.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_135</text>
</g>
<!-- layer_8_expert_8&#45;&gt;layer_8_gather -->
<g id="edge362" class="edge">
<title>layer_8_expert_8&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M3585,-20044.56C3585,-20044.56 3585,-19823.67 3585,-19823.67"/>
<polygon fill="black" stroke="black" points="3588.5,-19823.67 3585,-19813.67 3581.5,-19823.67 3588.5,-19823.67"/>
<text text-anchor="middle" x="3638.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_136</text>
</g>
<!-- layer_8_expert_9&#45;&gt;layer_8_gather -->
<g id="edge364" class="edge">
<title>layer_8_expert_9&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M3829.74,-20044.56C3829.74,-20044.56 3829.74,-19789.84 3829.74,-19789.84"/>
<polygon fill="black" stroke="black" points="3833.24,-19789.84 3829.74,-19779.84 3826.24,-19789.84 3833.24,-19789.84"/>
<text text-anchor="middle" x="3927.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_137</text>
</g>
<!-- layer_8_expert_10&#45;&gt;layer_8_gather -->
<g id="edge366" class="edge">
<title>layer_8_expert_10&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M4263.25,-20044.65C4263.25,-19970.12 4263.25,-19799 4263.25,-19799 4263.25,-19799 3779.44,-19799 3779.44,-19799"/>
<polygon fill="black" stroke="black" points="3779.44,-19795.5 3769.44,-19799 3779.44,-19802.5 3779.44,-19795.5"/>
<text text-anchor="middle" x="4217.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_138</text>
</g>
<!-- layer_8_expert_11&#45;&gt;layer_8_gather -->
<g id="edge368" class="edge">
<title>layer_8_expert_11&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M4632.5,-20044.52C4632.5,-19967.32 4632.5,-19786 4632.5,-19786 4632.5,-19786 3826.82,-19786 3826.82,-19786"/>
<polygon fill="black" stroke="black" points="3826.82,-19782.5 3816.82,-19786 3826.82,-19789.5 3826.82,-19782.5"/>
<text text-anchor="middle" x="4718.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_139</text>
</g>
<!-- layer_8_expert_12&#45;&gt;layer_8_gather -->
<g id="edge370" class="edge">
<title>layer_8_expert_12&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M5027.5,-20044.38C5027.5,-19964.36 5027.5,-19772 5027.5,-19772 5027.5,-19772 3848.74,-19772 3848.74,-19772"/>
<polygon fill="black" stroke="black" points="3848.74,-19768.5 3838.74,-19772 3848.74,-19775.5 3848.74,-19768.5"/>
<text text-anchor="middle" x="5007.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_140</text>
</g>
<!-- layer_8_expert_13&#45;&gt;layer_8_gather -->
<g id="edge372" class="edge">
<title>layer_8_expert_13&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M5422.5,-20044.65C5422.5,-19962.12 5422.5,-19758 5422.5,-19758 5422.5,-19758 3848.09,-19758 3848.09,-19758"/>
<polygon fill="black" stroke="black" points="3848.09,-19754.5 3838.09,-19758 3848.09,-19761.5 3848.09,-19754.5"/>
<text text-anchor="middle" x="5455.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_141</text>
</g>
<!-- layer_8_expert_14&#45;&gt;layer_8_gather -->
<g id="edge374" class="edge">
<title>layer_8_expert_14&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M5817.5,-20044.42C5817.5,-19959.13 5817.5,-19744 5817.5,-19744 5817.5,-19744 3823.95,-19744 3823.95,-19744"/>
<polygon fill="black" stroke="black" points="3823.95,-19740.5 3813.95,-19744 3823.95,-19747.5 3823.95,-19740.5"/>
<text text-anchor="middle" x="5824.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_142</text>
</g>
<!-- layer_8_expert_15&#45;&gt;layer_8_gather -->
<g id="edge376" class="edge">
<title>layer_8_expert_15&#45;&gt;layer_8_gather</title>
<path fill="none" stroke="black" d="M6212.5,-20044.38C6212.5,-19956.67 6212.5,-19731 6212.5,-19731 6212.5,-19731 3773.02,-19731 3773.02,-19731"/>
<polygon fill="black" stroke="black" points="3773.02,-19727.5 3763.02,-19731 3773.02,-19734.5 3773.02,-19727.5"/>
<text text-anchor="middle" x="6206.5" y="-19925.46" font-family="Times,serif" font-size="14.00">from_GPU_143</text>
</g>
<!-- layer_9_qkv -->
<g id="node227" class="node">
<title>layer_9_qkv</title>
<polygon fill="lightblue" stroke="black" points="4107.5,-19215.5 3698.5,-19215.5 3698.5,-19147.5 4107.5,-19147.5 4107.5,-19215.5"/>
<text text-anchor="middle" x="3903" y="-19200.3" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3903" y="-19185.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3903" y="-19170.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3903" y="-19155.3" font-family="Times,serif" font-size="14.00">GPU: 144</text>
</g>
<!-- layer_8_add_norm2&#45;&gt;layer_9_qkv -->
<g id="edge379" class="edge">
<title>layer_8_add_norm2&#45;&gt;layer_9_qkv</title>
<path fill="none" stroke="black" d="M4029.25,-19432.4C4029.25,-19432.4 4029.25,-19225.63 4029.25,-19225.63"/>
<polygon fill="black" stroke="black" points="4032.75,-19225.63 4029.25,-19215.63 4025.75,-19225.63 4032.75,-19225.63"/>
</g>
<!-- layer_9_add_norm1 -->
<g id="node230" class="node">
<title>layer_9_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4322,-18360.5 3960,-18360.5 3960,-18292.5 4322,-18292.5 4322,-18360.5"/>
<text text-anchor="middle" x="4141" y="-18345.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4141" y="-18330.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4141" y="-18315.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4141" y="-18300.3" font-family="Times,serif" font-size="14.00">GPU: 144</text>
</g>
<!-- layer_8_add_norm2&#45;&gt;layer_9_add_norm1 -->
<g id="edge383" class="edge">
<title>layer_8_add_norm2&#45;&gt;layer_9_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4210.25,-19432.38C4210.25,-19432.38 4210.25,-18370.76 4210.25,-18370.76"/>
<polygon fill="black" stroke="black" points="4213.75,-18370.76 4210.25,-18360.76 4206.75,-18370.76 4213.75,-18370.76"/>
<text text-anchor="middle" x="4263" y="-18892.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_8_mha -->
<g id="node226" class="node">
<title>layer_8_mha</title>
<polygon fill="lightblue" stroke="black" points="2103.5,-21946.83 1694.5,-21946.83 1694.5,-21878.83 2103.5,-21878.83 2103.5,-21946.83"/>
<text text-anchor="middle" x="1899" y="-21931.63" font-family="Times,serif" font-size="14.00">MHA Layer 8</text>
<text text-anchor="middle" x="1899" y="-21916.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1899" y="-21901.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1899" y="-21886.63" font-family="Times,serif" font-size="14.00">GPU: 128</text>
</g>
<!-- layer_9_attn -->
<g id="node228" class="node">
<title>layer_9_attn</title>
<polygon fill="lightblue" stroke="black" points="4089.5,-18930.5 3680.5,-18930.5 3680.5,-18862.5 4089.5,-18862.5 4089.5,-18930.5"/>
<text text-anchor="middle" x="3885" y="-18915.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3885" y="-18900.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3885" y="-18885.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3885" y="-18870.3" font-family="Times,serif" font-size="14.00">GPU: 144</text>
</g>
<!-- layer_9_qkv&#45;&gt;layer_9_attn -->
<g id="edge380" class="edge">
<title>layer_9_qkv&#45;&gt;layer_9_attn</title>
<path fill="none" stroke="black" d="M3894,-19147.4C3894,-19147.4 3894,-18940.63 3894,-18940.63"/>
<polygon fill="black" stroke="black" points="3897.5,-18940.63 3894,-18930.63 3890.5,-18940.63 3897.5,-18940.63"/>
</g>
<!-- layer_9_proj -->
<g id="node229" class="node">
<title>layer_9_proj</title>
<polygon fill="lightblue" stroke="black" points="4104.5,-18645.5 3707.5,-18645.5 3707.5,-18577.5 4104.5,-18577.5 4104.5,-18645.5"/>
<text text-anchor="middle" x="3906" y="-18630.3" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3906" y="-18615.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3906" y="-18600.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3906" y="-18585.3" font-family="Times,serif" font-size="14.00">GPU: 144</text>
</g>
<!-- layer_9_attn&#45;&gt;layer_9_proj -->
<g id="edge381" class="edge">
<title>layer_9_attn&#45;&gt;layer_9_proj</title>
<path fill="none" stroke="black" d="M3898.5,-18862.4C3898.5,-18862.4 3898.5,-18655.63 3898.5,-18655.63"/>
<polygon fill="black" stroke="black" points="3902,-18655.63 3898.5,-18645.63 3895,-18655.63 3902,-18655.63"/>
</g>
<!-- layer_9_proj&#45;&gt;layer_9_add_norm1 -->
<g id="edge382" class="edge">
<title>layer_9_proj&#45;&gt;layer_9_add_norm1</title>
<path fill="none" stroke="black" d="M4032.25,-18577.4C4032.25,-18577.4 4032.25,-18370.63 4032.25,-18370.63"/>
<polygon fill="black" stroke="black" points="4035.75,-18370.63 4032.25,-18360.63 4028.75,-18370.63 4035.75,-18370.63"/>
</g>
<!-- layer_9_gate -->
<g id="node231" class="node">
<title>layer_9_gate</title>
<polygon fill="yellow" stroke="black" points="4067.73,-18075.5 3490.71,-18075.5 3342.27,-17939.5 3919.29,-17939.5 4067.73,-18075.5"/>
<text text-anchor="middle" x="3705" y="-18026.3" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3705" y="-18011.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-17996.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3705" y="-17981.3" font-family="Times,serif" font-size="14.00">GPU: 144</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_gate -->
<g id="edge384" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_gate</title>
<path fill="none" stroke="black" d="M4013.93,-18292.36C4013.93,-18292.36 4013.93,-18085.62 4013.93,-18085.62"/>
<polygon fill="black" stroke="black" points="4017.43,-18085.62 4013.93,-18075.62 4010.43,-18085.62 4017.43,-18085.62"/>
</g>
<!-- layer_9_scatter -->
<g id="node232" class="node">
<title>layer_9_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3705" cy="-17660.41" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3705" y="-17679.21" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3705" y="-17664.21" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-17649.21" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-17634.21" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_scatter -->
<g id="edge385" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_scatter</title>
<path fill="none" stroke="black" d="M4164.68,-18292.15C4164.68,-18160.58 4164.68,-17696 4164.68,-17696 4164.68,-17696 3881.61,-17696 3881.61,-17696"/>
<polygon fill="black" stroke="black" points="3881.61,-17692.5 3871.61,-17696 3881.61,-17699.5 3881.61,-17692.5"/>
</g>
<!-- layer_9_add_norm2 -->
<g id="node250" class="node">
<title>layer_9_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4081,-16769.16 3719,-16769.16 3719,-16701.16 4081,-16701.16 4081,-16769.16"/>
<text text-anchor="middle" x="3900" y="-16753.96" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3900" y="-16738.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3900" y="-16723.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3900" y="-16708.96" font-family="Times,serif" font-size="14.00">GPU: 144</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_add_norm2 -->
<g id="edge420" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4291.75,-18292.15C4291.75,-18060.45 4291.75,-16735 4291.75,-16735 4291.75,-16735 4091.25,-16735 4091.25,-16735"/>
<polygon fill="black" stroke="black" points="4091.25,-16731.5 4081.25,-16735 4091.25,-16738.5 4091.25,-16731.5"/>
<text text-anchor="middle" x="6677" y="-17493.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_scatter -->
<g id="edge386" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3705,-17939.34C3705,-17939.34 3705,-17718.6 3705,-17718.6"/>
<polygon fill="black" stroke="black" points="3708.5,-17718.6 3705,-17708.6 3701.5,-17718.6 3708.5,-17718.6"/>
<text text-anchor="middle" x="3748.5" y="-17820.3" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_9_expert_0 -->
<g id="node233" class="node">
<title>layer_9_expert_0</title>
<polygon fill="lightblue" stroke="black" points="706.5,-17381.33 383.5,-17381.33 383.5,-17313.33 706.5,-17313.33 706.5,-17381.33"/>
<text text-anchor="middle" x="545" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="545" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="545" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="545" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 144</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_0 -->
<g id="edge387" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_0</title>
<path fill="none" stroke="black" d="M3538.46,-17696C2905.19,-17696 682.5,-17696 682.5,-17696 682.5,-17696 682.5,-17391.4 682.5,-17391.4"/>
<polygon fill="black" stroke="black" points="686,-17391.4 682.5,-17381.4 679,-17391.4 686,-17391.4"/>
<text text-anchor="middle" x="794" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_144</text>
</g>
<!-- layer_9_expert_1 -->
<g id="node235" class="node">
<title>layer_9_expert_1</title>
<polygon fill="lightblue" stroke="black" points="1101.5,-17381.33 778.5,-17381.33 778.5,-17313.33 1101.5,-17313.33 1101.5,-17381.33"/>
<text text-anchor="middle" x="940" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="940" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="940" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="940" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 145</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_1 -->
<g id="edge389" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_1</title>
<path fill="none" stroke="black" d="M3489.14,-17684C2860.87,-17684 1077.5,-17684 1077.5,-17684 1077.5,-17684 1077.5,-17391.47 1077.5,-17391.47"/>
<polygon fill="black" stroke="black" points="1081,-17391.47 1077.5,-17381.47 1074,-17391.47 1081,-17391.47"/>
<text text-anchor="middle" x="1165" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_145</text>
</g>
<!-- layer_9_expert_2 -->
<g id="node236" class="node">
<title>layer_9_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1496.5,-17381.33 1173.5,-17381.33 1173.5,-17313.33 1496.5,-17313.33 1496.5,-17381.33"/>
<text text-anchor="middle" x="1335" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1335" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1335" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1335" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 146</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_2 -->
<g id="edge391" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_2</title>
<path fill="none" stroke="black" d="M3464.76,-17672C2887.99,-17672 1472.5,-17672 1472.5,-17672 1472.5,-17672 1472.5,-17391.46 1472.5,-17391.46"/>
<polygon fill="black" stroke="black" points="1476,-17391.46 1472.5,-17381.46 1469,-17391.46 1476,-17391.46"/>
<text text-anchor="middle" x="1512" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_146</text>
</g>
<!-- layer_9_expert_3 -->
<g id="node237" class="node">
<title>layer_9_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1891.5,-17381.33 1568.5,-17381.33 1568.5,-17313.33 1891.5,-17313.33 1891.5,-17381.33"/>
<text text-anchor="middle" x="1730" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1730" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1730" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1730" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 147</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_3 -->
<g id="edge393" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_3</title>
<path fill="none" stroke="black" d="M3457.33,-17660C2939.11,-17660 1788,-17660 1788,-17660 1788,-17660 1788,-17391.39 1788,-17391.39"/>
<polygon fill="black" stroke="black" points="1791.5,-17391.39 1788,-17381.39 1784.5,-17391.39 1791.5,-17391.39"/>
<text text-anchor="middle" x="1810" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_147</text>
</g>
<!-- layer_9_expert_4 -->
<g id="node238" class="node">
<title>layer_9_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2286.5,-17381.33 1963.5,-17381.33 1963.5,-17313.33 2286.5,-17313.33 2286.5,-17381.33"/>
<text text-anchor="middle" x="2125" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2125" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2125" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2125" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 148</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_4 -->
<g id="edge395" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_4</title>
<path fill="none" stroke="black" d="M3465.59,-17648C3055.52,-17648 2262.5,-17648 2262.5,-17648 2262.5,-17648 2262.5,-17391.53 2262.5,-17391.53"/>
<polygon fill="black" stroke="black" points="2266,-17391.53 2262.5,-17381.53 2259,-17391.53 2266,-17391.53"/>
<text text-anchor="middle" x="2550" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_148</text>
</g>
<!-- layer_9_expert_5 -->
<g id="node239" class="node">
<title>layer_9_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2681.5,-17381.33 2358.5,-17381.33 2358.5,-17313.33 2681.5,-17313.33 2681.5,-17381.33"/>
<text text-anchor="middle" x="2520" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2520" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2520" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2520" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 149</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_5 -->
<g id="edge397" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_5</title>
<path fill="none" stroke="black" d="M3491.76,-17636C3185.49,-17636 2657.5,-17636 2657.5,-17636 2657.5,-17636 2657.5,-17391.58 2657.5,-17391.58"/>
<polygon fill="black" stroke="black" points="2661,-17391.58 2657.5,-17381.58 2654,-17391.58 2661,-17391.58"/>
<text text-anchor="middle" x="3002" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_149</text>
</g>
<!-- layer_9_expert_6 -->
<g id="node240" class="node">
<title>layer_9_expert_6</title>
<polygon fill="lightblue" stroke="black" points="3076.5,-17381.33 2753.5,-17381.33 2753.5,-17313.33 3076.5,-17313.33 3076.5,-17381.33"/>
<text text-anchor="middle" x="2915" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2915" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2915" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2915" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 150</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_6 -->
<g id="edge399" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_6</title>
<path fill="none" stroke="black" d="M3543.29,-17624C3350.05,-17624 3052.5,-17624 3052.5,-17624 3052.5,-17624 3052.5,-17391.53 3052.5,-17391.53"/>
<polygon fill="black" stroke="black" points="3056,-17391.53 3052.5,-17381.53 3049,-17391.53 3056,-17391.53"/>
<text text-anchor="middle" x="3311" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_150</text>
</g>
<!-- layer_9_expert_7 -->
<g id="node241" class="node">
<title>layer_9_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3471.5,-17381.33 3148.5,-17381.33 3148.5,-17313.33 3471.5,-17313.33 3471.5,-17381.33"/>
<text text-anchor="middle" x="3310" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3310" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3310" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3310" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 151</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_7 -->
<g id="edge401" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_7</title>
<path fill="none" stroke="black" d="M3464.51,-17648.9C3464.51,-17648.9 3464.51,-17391.34 3464.51,-17391.34"/>
<polygon fill="black" stroke="black" points="3468.01,-17391.34 3464.51,-17381.34 3461.01,-17391.34 3468.01,-17391.34"/>
<text text-anchor="middle" x="3548" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_151</text>
</g>
<!-- layer_9_expert_8 -->
<g id="node242" class="node">
<title>layer_9_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3866.5,-17381.33 3543.5,-17381.33 3543.5,-17313.33 3866.5,-17313.33 3866.5,-17381.33"/>
<text text-anchor="middle" x="3705" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3705" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 152</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_8 -->
<g id="edge403" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_8</title>
<path fill="none" stroke="black" d="M3705,-17612.18C3705,-17612.18 3705,-17391.6 3705,-17391.6"/>
<polygon fill="black" stroke="black" points="3708.5,-17391.6 3705,-17381.6 3701.5,-17391.6 3708.5,-17391.6"/>
<text text-anchor="middle" x="3749" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_152</text>
</g>
<!-- layer_9_expert_9 -->
<g id="node243" class="node">
<title>layer_9_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4261.5,-17381.33 3938.5,-17381.33 3938.5,-17313.33 4261.5,-17313.33 4261.5,-17381.33"/>
<text text-anchor="middle" x="4100" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4100" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4100" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4100" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 153</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_9 -->
<g id="edge405" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_9</title>
<path fill="none" stroke="black" d="M3945.49,-17648.9C3945.49,-17648.9 3945.49,-17391.34 3945.49,-17391.34"/>
<polygon fill="black" stroke="black" points="3948.99,-17391.34 3945.49,-17381.34 3941.99,-17391.34 3948.99,-17391.34"/>
<text text-anchor="middle" x="4029" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_153</text>
</g>
<!-- layer_9_expert_10 -->
<g id="node244" class="node">
<title>layer_9_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4656.5,-17381.33 4333.5,-17381.33 4333.5,-17313.33 4656.5,-17313.33 4656.5,-17381.33"/>
<text text-anchor="middle" x="4495" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4495" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4495" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4495" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 154</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_10 -->
<g id="edge407" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_10</title>
<path fill="none" stroke="black" d="M3867.01,-17624C4082.07,-17624 4435,-17624 4435,-17624 4435,-17624 4435,-17391.53 4435,-17391.53"/>
<polygon fill="black" stroke="black" points="4438.5,-17391.53 4435,-17381.53 4431.5,-17391.53 4438.5,-17391.53"/>
<text text-anchor="middle" x="4309" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_154</text>
</g>
<!-- layer_9_expert_11 -->
<g id="node245" class="node">
<title>layer_9_expert_11</title>
<polygon fill="lightblue" stroke="black" points="5051.5,-17381.33 4728.5,-17381.33 4728.5,-17313.33 5051.5,-17313.33 5051.5,-17381.33"/>
<text text-anchor="middle" x="4890" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4890" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4890" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4890" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 155</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_11 -->
<g id="edge409" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_11</title>
<path fill="none" stroke="black" d="M3918.26,-17636C4244.47,-17636 4830,-17636 4830,-17636 4830,-17636 4830,-17391.58 4830,-17391.58"/>
<polygon fill="black" stroke="black" points="4833.5,-17391.58 4830,-17381.58 4826.5,-17391.58 4833.5,-17391.58"/>
<text text-anchor="middle" x="4646" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_155</text>
</g>
<!-- layer_9_expert_12 -->
<g id="node246" class="node">
<title>layer_9_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5446.5,-17381.33 5123.5,-17381.33 5123.5,-17313.33 5446.5,-17313.33 5446.5,-17381.33"/>
<text text-anchor="middle" x="5285" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5285" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5285" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5285" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 156</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_12 -->
<g id="edge411" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_12</title>
<path fill="none" stroke="black" d="M3944.17,-17648C4372.23,-17648 5225,-17648 5225,-17648 5225,-17648 5225,-17391.53 5225,-17391.53"/>
<polygon fill="black" stroke="black" points="5228.5,-17391.53 5225,-17381.53 5221.5,-17391.53 5228.5,-17391.53"/>
<text text-anchor="middle" x="5012" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_156</text>
</g>
<!-- layer_9_expert_13 -->
<g id="node247" class="node">
<title>layer_9_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5841.5,-17381.33 5518.5,-17381.33 5518.5,-17313.33 5841.5,-17313.33 5841.5,-17381.33"/>
<text text-anchor="middle" x="5680" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5680" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5680" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5680" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 157</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_13 -->
<g id="edge413" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_13</title>
<path fill="none" stroke="black" d="M3952.9,-17660C4470.82,-17660 5620,-17660 5620,-17660 5620,-17660 5620,-17391.39 5620,-17391.39"/>
<polygon fill="black" stroke="black" points="5623.5,-17391.39 5620,-17381.39 5616.5,-17391.39 5623.5,-17391.39"/>
<text text-anchor="middle" x="5393" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_157</text>
</g>
<!-- layer_9_expert_14 -->
<g id="node248" class="node">
<title>layer_9_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6236.5,-17381.33 5913.5,-17381.33 5913.5,-17313.33 6236.5,-17313.33 6236.5,-17381.33"/>
<text text-anchor="middle" x="6075" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="6075" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6075" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6075" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 158</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_14 -->
<g id="edge415" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_14</title>
<path fill="none" stroke="black" d="M3945.4,-17672C4536.87,-17672 6015,-17672 6015,-17672 6015,-17672 6015,-17391.46 6015,-17391.46"/>
<polygon fill="black" stroke="black" points="6018.5,-17391.46 6015,-17381.46 6011.5,-17391.46 6018.5,-17391.46"/>
<text text-anchor="middle" x="5781" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_158</text>
</g>
<!-- layer_9_expert_15 -->
<g id="node249" class="node">
<title>layer_9_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6631.5,-17381.33 6308.5,-17381.33 6308.5,-17313.33 6631.5,-17313.33 6631.5,-17381.33"/>
<text text-anchor="middle" x="6470" y="-17366.13" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6470" y="-17351.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6470" y="-17336.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6470" y="-17321.13" font-family="Times,serif" font-size="14.00">GPU: 159</text>
</g>
<!-- layer_9_scatter&#45;&gt;layer_9_expert_15 -->
<g id="edge417" class="edge">
<title>layer_9_scatter&#45;&gt;layer_9_expert_15</title>
<path fill="none" stroke="black" d="M3920.94,-17684C4562.04,-17684 6410,-17684 6410,-17684 6410,-17684 6410,-17391.47 6410,-17391.47"/>
<polygon fill="black" stroke="black" points="6413.5,-17391.47 6410,-17381.47 6406.5,-17391.47 6413.5,-17391.47"/>
<text text-anchor="middle" x="6172" y="-17493.13" font-family="Times,serif" font-size="14.00">to_GPU_159</text>
</g>
<!-- layer_9_gather -->
<g id="node234" class="node">
<title>layer_9_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3705" cy="-17034.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3705" y="-17053.05" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3705" y="-17038.05" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-17023.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3705" y="-17008.05" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_9_expert_0&#45;&gt;layer_9_gather -->
<g id="edge388" class="edge">
<title>layer_9_expert_0&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M627.5,-17313.2C627.5,-17225.3 627.5,-16998 627.5,-16998 627.5,-16998 3526.81,-16998 3526.81,-16998"/>
<polygon fill="black" stroke="black" points="3526.81,-17001.5 3536.81,-16998 3526.81,-16994.5 3526.81,-17001.5"/>
<text text-anchor="middle" x="921.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_144</text>
</g>
<!-- layer_9_gather&#45;&gt;layer_9_add_norm2 -->
<g id="edge419" class="edge">
<title>layer_9_gather&#45;&gt;layer_9_add_norm2</title>
<path fill="none" stroke="black" d="M3839.99,-16993.29C3839.99,-16993.29 3839.99,-16779.61 3839.99,-16779.61"/>
<polygon fill="black" stroke="black" points="3843.49,-16779.61 3839.99,-16769.61 3836.49,-16779.61 3843.49,-16779.61"/>
</g>
<!-- layer_9_expert_1&#45;&gt;layer_9_gather -->
<g id="edge390" class="edge">
<title>layer_9_expert_1&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M1022.5,-17313.13C1022.5,-17227.37 1022.5,-17010 1022.5,-17010 1022.5,-17010 3473.77,-17010 3473.77,-17010"/>
<polygon fill="black" stroke="black" points="3473.77,-17013.5 3483.77,-17010 3473.77,-17006.5 3473.77,-17013.5"/>
<text text-anchor="middle" x="1210.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_145</text>
</g>
<!-- layer_9_expert_2&#45;&gt;layer_9_gather -->
<g id="edge392" class="edge">
<title>layer_9_expert_2&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M1474.5,-17313.13C1474.5,-17229.6 1474.5,-17022 1474.5,-17022 1474.5,-17022 3447.24,-17022 3447.24,-17022"/>
<polygon fill="black" stroke="black" points="3447.24,-17025.5 3457.24,-17022 3447.24,-17018.5 3447.24,-17025.5"/>
<text text-anchor="middle" x="1612.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_146</text>
</g>
<!-- layer_9_expert_3&#45;&gt;layer_9_gather -->
<g id="edge394" class="edge">
<title>layer_9_expert_3&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M1876.5,-17313.2C1876.5,-17231.99 1876.5,-17034 1876.5,-17034 1876.5,-17034 3438.83,-17034 3438.83,-17034"/>
<polygon fill="black" stroke="black" points="3438.83,-17037.5 3448.83,-17034 3438.83,-17030.5 3438.83,-17037.5"/>
<text text-anchor="middle" x="2020.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_147</text>
</g>
<!-- layer_9_expert_4&#45;&gt;layer_9_gather -->
<g id="edge396" class="edge">
<title>layer_9_expert_4&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M2207.5,-17313.06C2207.5,-17234.08 2207.5,-17046 2207.5,-17046 2207.5,-17046 3446.46,-17046 3446.46,-17046"/>
<polygon fill="black" stroke="black" points="3446.46,-17049.5 3456.46,-17046 3446.46,-17042.5 3446.46,-17049.5"/>
<text text-anchor="middle" x="2442.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_148</text>
</g>
<!-- layer_9_expert_5&#45;&gt;layer_9_gather -->
<g id="edge398" class="edge">
<title>layer_9_expert_5&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M2602.5,-17313.29C2602.5,-17236.81 2602.5,-17058 2602.5,-17058 2602.5,-17058 3472.22,-17058 3472.22,-17058"/>
<polygon fill="black" stroke="black" points="3472.22,-17061.5 3482.22,-17058 3472.22,-17054.5 3472.22,-17061.5"/>
<text text-anchor="middle" x="2837.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_149</text>
</g>
<!-- layer_9_expert_6&#45;&gt;layer_9_gather -->
<g id="edge400" class="edge">
<title>layer_9_expert_6&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M2997.5,-17313.33C2997.5,-17239.27 2997.5,-17070 2997.5,-17070 2997.5,-17070 3523.73,-17070 3523.73,-17070"/>
<polygon fill="black" stroke="black" points="3523.73,-17073.5 3533.73,-17070 3523.73,-17066.5 3523.73,-17073.5"/>
<text text-anchor="middle" x="3126.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_150</text>
</g>
<!-- layer_9_expert_7&#45;&gt;layer_9_gather -->
<g id="edge402" class="edge">
<title>layer_9_expert_7&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M3460.26,-17313.23C3460.26,-17313.23 3460.26,-17058.51 3460.26,-17058.51"/>
<polygon fill="black" stroke="black" points="3463.76,-17058.51 3460.26,-17048.51 3456.76,-17058.51 3463.76,-17058.51"/>
<text text-anchor="middle" x="3468.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_151</text>
</g>
<!-- layer_9_expert_8&#45;&gt;layer_9_gather -->
<g id="edge404" class="edge">
<title>layer_9_expert_8&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M3705,-17313.23C3705,-17313.23 3705,-17092.34 3705,-17092.34"/>
<polygon fill="black" stroke="black" points="3708.5,-17092.34 3705,-17082.34 3701.5,-17092.34 3708.5,-17092.34"/>
<text text-anchor="middle" x="3758.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_152</text>
</g>
<!-- layer_9_expert_9&#45;&gt;layer_9_gather -->
<g id="edge406" class="edge">
<title>layer_9_expert_9&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M3949.74,-17313.23C3949.74,-17313.23 3949.74,-17058.51 3949.74,-17058.51"/>
<polygon fill="black" stroke="black" points="3953.24,-17058.51 3949.74,-17048.51 3946.24,-17058.51 3953.24,-17058.51"/>
<text text-anchor="middle" x="4048.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_153</text>
</g>
<!-- layer_9_expert_10&#45;&gt;layer_9_gather -->
<g id="edge408" class="edge">
<title>layer_9_expert_10&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M4380,-17313.08C4380,-17238.49 4380,-17068 4380,-17068 4380,-17068 3897.66,-17068 3897.66,-17068"/>
<polygon fill="black" stroke="black" points="3897.66,-17064.5 3887.66,-17068 3897.66,-17071.5 3897.66,-17064.5"/>
<text text-anchor="middle" x="4443.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_154</text>
</g>
<!-- layer_9_expert_11&#45;&gt;layer_9_gather -->
<g id="edge410" class="edge">
<title>layer_9_expert_11&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M4775,-17313.11C4775,-17235.73 4775,-17054 4775,-17054 4775,-17054 3948.49,-17054 3948.49,-17054"/>
<polygon fill="black" stroke="black" points="3948.49,-17050.5 3938.49,-17054 3948.49,-17057.5 3948.49,-17050.5"/>
<text text-anchor="middle" x="4785.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_155</text>
</g>
<!-- layer_9_expert_12&#45;&gt;layer_9_gather -->
<g id="edge412" class="edge">
<title>layer_9_expert_12&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M5170,-17313.08C5170,-17233.15 5170,-17041 5170,-17041 5170,-17041 3968.51,-17041 3968.51,-17041"/>
<polygon fill="black" stroke="black" points="3968.51,-17037.5 3958.51,-17041 3968.51,-17044.5 3968.51,-17037.5"/>
<text text-anchor="middle" x="5233.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_156</text>
</g>
<!-- layer_9_expert_13&#45;&gt;layer_9_gather -->
<g id="edge414" class="edge">
<title>layer_9_expert_13&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M5565,-17313.05C5565,-17230.41 5565,-17027 5565,-17027 5565,-17027 3968.27,-17027 3968.27,-17027"/>
<polygon fill="black" stroke="black" points="3968.27,-17023.5 3958.27,-17027 3968.27,-17030.5 3968.27,-17023.5"/>
<text text-anchor="middle" x="5575.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_157</text>
</g>
<!-- layer_9_expert_14&#45;&gt;layer_9_gather -->
<g id="edge416" class="edge">
<title>layer_9_expert_14&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M5960,-17313.12C5960,-17227.91 5960,-17013 5960,-17013 5960,-17013 3944.68,-17013 3944.68,-17013"/>
<polygon fill="black" stroke="black" points="3944.68,-17009.5 3934.68,-17013 3944.68,-17016.5 3944.68,-17009.5"/>
<text text-anchor="middle" x="5944.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_158</text>
</g>
<!-- layer_9_expert_15&#45;&gt;layer_9_gather -->
<g id="edge418" class="edge">
<title>layer_9_expert_15&#45;&gt;layer_9_gather</title>
<path fill="none" stroke="black" d="M6355,-17313.3C6355,-17225.65 6355,-16999 6355,-16999 6355,-16999 3889.13,-16999 3889.13,-16999"/>
<polygon fill="black" stroke="black" points="3889.13,-16995.5 3879.13,-16999 3889.13,-17002.5 3889.13,-16995.5"/>
<text text-anchor="middle" x="6325.5" y="-17194.13" font-family="Times,serif" font-size="14.00">from_GPU_159</text>
</g>
<!-- layer_10_qkv -->
<g id="node252" class="node">
<title>layer_10_qkv</title>
<polygon fill="lightblue" stroke="black" points="3875.5,-16484.16 3466.5,-16484.16 3466.5,-16416.16 3875.5,-16416.16 3875.5,-16484.16"/>
<text text-anchor="middle" x="3671" y="-16468.96" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3671" y="-16453.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3671" y="-16438.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3671" y="-16423.96" font-family="Times,serif" font-size="14.00">GPU: 160</text>
</g>
<!-- layer_9_add_norm2&#45;&gt;layer_10_qkv -->
<g id="edge421" class="edge">
<title>layer_9_add_norm2&#45;&gt;layer_10_qkv</title>
<path fill="none" stroke="black" d="M3797.25,-16701.07C3797.25,-16701.07 3797.25,-16494.3 3797.25,-16494.3"/>
<polygon fill="black" stroke="black" points="3800.75,-16494.3 3797.25,-16484.3 3793.75,-16494.3 3800.75,-16494.3"/>
</g>
<!-- layer_10_add_norm1 -->
<g id="node255" class="node">
<title>layer_10_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4092,-15629.16 3730,-15629.16 3730,-15561.16 4092,-15561.16 4092,-15629.16"/>
<text text-anchor="middle" x="3911" y="-15613.96" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3911" y="-15598.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3911" y="-15583.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3911" y="-15568.96" font-family="Times,serif" font-size="14.00">GPU: 160</text>
</g>
<!-- layer_9_add_norm2&#45;&gt;layer_10_add_norm1 -->
<g id="edge425" class="edge">
<title>layer_9_add_norm2&#45;&gt;layer_10_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3981.75,-16701.05C3981.75,-16701.05 3981.75,-15639.43 3981.75,-15639.43"/>
<polygon fill="black" stroke="black" points="3985.25,-15639.43 3981.75,-15629.43 3978.25,-15639.43 3985.25,-15639.43"/>
<text text-anchor="middle" x="4031" y="-16161.46" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_9_mha -->
<g id="node251" class="node">
<title>layer_9_mha</title>
<polygon fill="lightblue" stroke="black" points="2093.5,-19215.5 1684.5,-19215.5 1684.5,-19147.5 2093.5,-19147.5 2093.5,-19215.5"/>
<text text-anchor="middle" x="1889" y="-19200.3" font-family="Times,serif" font-size="14.00">MHA Layer 9</text>
<text text-anchor="middle" x="1889" y="-19185.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1889" y="-19170.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1889" y="-19155.3" font-family="Times,serif" font-size="14.00">GPU: 144</text>
</g>
<!-- layer_10_attn -->
<g id="node253" class="node">
<title>layer_10_attn</title>
<polygon fill="lightblue" stroke="black" points="3857.5,-16199.16 3448.5,-16199.16 3448.5,-16131.16 3857.5,-16131.16 3857.5,-16199.16"/>
<text text-anchor="middle" x="3653" y="-16183.96" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3653" y="-16168.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3653" y="-16153.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3653" y="-16138.96" font-family="Times,serif" font-size="14.00">GPU: 160</text>
</g>
<!-- layer_10_qkv&#45;&gt;layer_10_attn -->
<g id="edge422" class="edge">
<title>layer_10_qkv&#45;&gt;layer_10_attn</title>
<path fill="none" stroke="black" d="M3662,-16416.07C3662,-16416.07 3662,-16209.3 3662,-16209.3"/>
<polygon fill="black" stroke="black" points="3665.5,-16209.3 3662,-16199.3 3658.5,-16209.3 3665.5,-16209.3"/>
</g>
<!-- layer_10_proj -->
<g id="node254" class="node">
<title>layer_10_proj</title>
<polygon fill="lightblue" stroke="black" points="3882.5,-15914.16 3485.5,-15914.16 3485.5,-15846.16 3882.5,-15846.16 3882.5,-15914.16"/>
<text text-anchor="middle" x="3684" y="-15898.96" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3684" y="-15883.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3684" y="-15868.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3684" y="-15853.96" font-family="Times,serif" font-size="14.00">GPU: 160</text>
</g>
<!-- layer_10_attn&#45;&gt;layer_10_proj -->
<g id="edge423" class="edge">
<title>layer_10_attn&#45;&gt;layer_10_proj</title>
<path fill="none" stroke="black" d="M3671.5,-16131.07C3671.5,-16131.07 3671.5,-15924.3 3671.5,-15924.3"/>
<polygon fill="black" stroke="black" points="3675,-15924.3 3671.5,-15914.3 3668,-15924.3 3675,-15924.3"/>
</g>
<!-- layer_10_proj&#45;&gt;layer_10_add_norm1 -->
<g id="edge424" class="edge">
<title>layer_10_proj&#45;&gt;layer_10_add_norm1</title>
<path fill="none" stroke="black" d="M3806.25,-15846.07C3806.25,-15846.07 3806.25,-15639.3 3806.25,-15639.3"/>
<polygon fill="black" stroke="black" points="3809.75,-15639.3 3806.25,-15629.3 3802.75,-15639.3 3809.75,-15639.3"/>
</g>
<!-- layer_10_gate -->
<g id="node256" class="node">
<title>layer_10_gate</title>
<polygon fill="yellow" stroke="black" points="3837.73,-15344.16 3260.71,-15344.16 3112.27,-15208.16 3689.29,-15208.16 3837.73,-15344.16"/>
<text text-anchor="middle" x="3475" y="-15294.96" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3475" y="-15279.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-15264.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3475" y="-15249.96" font-family="Times,serif" font-size="14.00">GPU: 160</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_gate -->
<g id="edge426" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_gate</title>
<path fill="none" stroke="black" d="M3783.93,-15561.03C3783.93,-15561.03 3783.93,-15354.29 3783.93,-15354.29"/>
<polygon fill="black" stroke="black" points="3787.43,-15354.29 3783.93,-15344.29 3780.43,-15354.29 3787.43,-15354.29"/>
</g>
<!-- layer_10_scatter -->
<g id="node257" class="node">
<title>layer_10_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3475" cy="-14929.08" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3475" y="-14947.88" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3475" y="-14932.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-14917.88" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-14902.88" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_scatter -->
<g id="edge427" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_scatter</title>
<path fill="none" stroke="black" d="M3934.68,-15560.84C3934.68,-15429.34 3934.68,-14965 3934.68,-14965 3934.68,-14965 3649.66,-14965 3649.66,-14965"/>
<polygon fill="black" stroke="black" points="3649.66,-14961.5 3639.66,-14965 3649.66,-14968.5 3649.66,-14961.5"/>
</g>
<!-- layer_10_add_norm2 -->
<g id="node275" class="node">
<title>layer_10_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4485,-14037.83 4123,-14037.83 4123,-13969.83 4485,-13969.83 4485,-14037.83"/>
<text text-anchor="middle" x="4304" y="-14022.63" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4304" y="-14007.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4304" y="-13992.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4304" y="-13977.63" font-family="Times,serif" font-size="14.00">GPU: 160</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_add_norm2 -->
<g id="edge462" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4061.75,-15561.06C4061.75,-15331.02 4061.75,-14015 4061.75,-14015 4061.75,-14015 4112.88,-14015 4112.88,-14015"/>
<polygon fill="black" stroke="black" points="4112.88,-14018.5 4122.88,-14015 4112.88,-14011.5 4112.88,-14018.5"/>
<text text-anchor="middle" x="6447" y="-14761.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_scatter -->
<g id="edge428" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3475,-15208.01C3475,-15208.01 3475,-14987.27 3475,-14987.27"/>
<polygon fill="black" stroke="black" points="3478.5,-14987.27 3475,-14977.27 3471.5,-14987.27 3478.5,-14987.27"/>
<text text-anchor="middle" x="3518.5" y="-15088.96" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_10_expert_0 -->
<g id="node258" class="node">
<title>layer_10_expert_0</title>
<polygon fill="lightblue" stroke="black" points="476.5,-14650 153.5,-14650 153.5,-14582 476.5,-14582 476.5,-14650"/>
<text text-anchor="middle" x="315" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="315" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="315" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="315" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 160</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_0 -->
<g id="edge429" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_0</title>
<path fill="none" stroke="black" d="M3310.21,-14965C2676.26,-14965 430,-14965 430,-14965 430,-14965 430,-14660.1 430,-14660.1"/>
<polygon fill="black" stroke="black" points="433.5,-14660.1 430,-14650.1 426.5,-14660.1 433.5,-14660.1"/>
<text text-anchor="middle" x="480" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_160</text>
</g>
<!-- layer_10_expert_1 -->
<g id="node260" class="node">
<title>layer_10_expert_1</title>
<polygon fill="lightblue" stroke="black" points="871.5,-14650 548.5,-14650 548.5,-14582 871.5,-14582 871.5,-14650"/>
<text text-anchor="middle" x="710" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="710" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="710" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="710" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 161</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_1 -->
<g id="edge431" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_1</title>
<path fill="none" stroke="black" d="M3260.1,-14953C2628.98,-14953 825,-14953 825,-14953 825,-14953 825,-14660.17 825,-14660.17"/>
<polygon fill="black" stroke="black" points="828.5,-14660.17 825,-14650.17 821.5,-14660.17 828.5,-14660.17"/>
<text text-anchor="middle" x="767" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_161</text>
</g>
<!-- layer_10_expert_2 -->
<g id="node261" class="node">
<title>layer_10_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1266.5,-14650 943.5,-14650 943.5,-14582 1266.5,-14582 1266.5,-14650"/>
<text text-anchor="middle" x="1105" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1105" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1105" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1105" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 162</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_2 -->
<g id="edge433" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_2</title>
<path fill="none" stroke="black" d="M3235.01,-14941C2654.14,-14941 1220,-14941 1220,-14941 1220,-14941 1220,-14660.16 1220,-14660.16"/>
<polygon fill="black" stroke="black" points="1223.5,-14660.16 1220,-14650.16 1216.5,-14660.16 1223.5,-14660.16"/>
<text text-anchor="middle" x="1737" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_162</text>
</g>
<!-- layer_10_expert_3 -->
<g id="node262" class="node">
<title>layer_10_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1661.5,-14650 1338.5,-14650 1338.5,-14582 1661.5,-14582 1661.5,-14650"/>
<text text-anchor="middle" x="1500" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1500" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1500" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1500" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 163</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_3 -->
<g id="edge435" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_3</title>
<path fill="none" stroke="black" d="M3227.2,-14929C2708.71,-14929 1557,-14929 1557,-14929 1557,-14929 1557,-14660.09 1557,-14660.09"/>
<polygon fill="black" stroke="black" points="1560.5,-14660.09 1557,-14650.09 1553.5,-14660.09 1560.5,-14660.09"/>
<text text-anchor="middle" x="2304" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_163</text>
</g>
<!-- layer_10_expert_4 -->
<g id="node263" class="node">
<title>layer_10_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2056.5,-14650 1733.5,-14650 1733.5,-14582 2056.5,-14582 2056.5,-14650"/>
<text text-anchor="middle" x="1895" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1895" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1895" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1895" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 164</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_4 -->
<g id="edge437" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_4</title>
<path fill="none" stroke="black" d="M3235.13,-14917C2819.64,-14917 2010,-14917 2010,-14917 2010,-14917 2010,-14660.23 2010,-14660.23"/>
<polygon fill="black" stroke="black" points="2013.5,-14660.23 2010,-14650.23 2006.5,-14660.23 2013.5,-14660.23"/>
<text text-anchor="middle" x="2670" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_164</text>
</g>
<!-- layer_10_expert_5 -->
<g id="node264" class="node">
<title>layer_10_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2451.5,-14650 2128.5,-14650 2128.5,-14582 2451.5,-14582 2451.5,-14650"/>
<text text-anchor="middle" x="2290" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2290" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2290" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2290" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 165</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_5 -->
<g id="edge439" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_5</title>
<path fill="none" stroke="black" d="M3260.72,-14905C2948.42,-14905 2405,-14905 2405,-14905 2405,-14905 2405,-14660 2405,-14660"/>
<polygon fill="black" stroke="black" points="2408.5,-14660 2405,-14650 2401.5,-14660 2408.5,-14660"/>
<text text-anchor="middle" x="2936" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_165</text>
</g>
<!-- layer_10_expert_6 -->
<g id="node265" class="node">
<title>layer_10_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2846.5,-14650 2523.5,-14650 2523.5,-14582 2846.5,-14582 2846.5,-14650"/>
<text text-anchor="middle" x="2685" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2685" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2685" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2685" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 166</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_6 -->
<g id="edge441" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_6</title>
<path fill="none" stroke="black" d="M3311.17,-14893C3111.39,-14893 2800,-14893 2800,-14893 2800,-14893 2800,-14660.24 2800,-14660.24"/>
<polygon fill="black" stroke="black" points="2803.5,-14660.24 2800,-14650.24 2796.5,-14660.24 2803.5,-14660.24"/>
<text text-anchor="middle" x="3151" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_166</text>
</g>
<!-- layer_10_expert_7 -->
<g id="node266" class="node">
<title>layer_10_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3241.5,-14650 2918.5,-14650 2918.5,-14582 3241.5,-14582 3241.5,-14650"/>
<text text-anchor="middle" x="3080" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3080" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3080" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3080" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 167</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_7 -->
<g id="edge443" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_7</title>
<path fill="none" stroke="black" d="M3234.51,-14917.57C3234.51,-14917.57 3234.51,-14660.01 3234.51,-14660.01"/>
<polygon fill="black" stroke="black" points="3238.01,-14660.01 3234.51,-14650.01 3231.01,-14660.01 3238.01,-14660.01"/>
<text text-anchor="middle" x="3341" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_167</text>
</g>
<!-- layer_10_expert_8 -->
<g id="node267" class="node">
<title>layer_10_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3636.5,-14650 3313.5,-14650 3313.5,-14582 3636.5,-14582 3636.5,-14650"/>
<text text-anchor="middle" x="3475" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3475" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 168</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_8 -->
<g id="edge445" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_8</title>
<path fill="none" stroke="black" d="M3475,-14880.85C3475,-14880.85 3475,-14660.26 3475,-14660.26"/>
<polygon fill="black" stroke="black" points="3478.5,-14660.26 3475,-14650.26 3471.5,-14660.26 3478.5,-14660.26"/>
<text text-anchor="middle" x="3519" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_168</text>
</g>
<!-- layer_10_expert_9 -->
<g id="node268" class="node">
<title>layer_10_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4031.5,-14650 3708.5,-14650 3708.5,-14582 4031.5,-14582 4031.5,-14650"/>
<text text-anchor="middle" x="3870" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3870" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3870" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3870" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 169</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_9 -->
<g id="edge447" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_9</title>
<path fill="none" stroke="black" d="M3715.49,-14917.57C3715.49,-14917.57 3715.49,-14660.01 3715.49,-14660.01"/>
<polygon fill="black" stroke="black" points="3718.99,-14660.01 3715.49,-14650.01 3711.99,-14660.01 3718.99,-14660.01"/>
<text text-anchor="middle" x="3799" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_169</text>
</g>
<!-- layer_10_expert_10 -->
<g id="node269" class="node">
<title>layer_10_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4426.5,-14650 4103.5,-14650 4103.5,-14582 4426.5,-14582 4426.5,-14650"/>
<text text-anchor="middle" x="4265" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4265" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4265" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4265" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 170</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_10 -->
<g id="edge449" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_10</title>
<path fill="none" stroke="black" d="M3638.65,-14893C3847.62,-14893 4182.5,-14893 4182.5,-14893 4182.5,-14893 4182.5,-14660.24 4182.5,-14660.24"/>
<polygon fill="black" stroke="black" points="4186,-14660.24 4182.5,-14650.24 4179,-14660.24 4186,-14660.24"/>
<text text-anchor="middle" x="4137" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_170</text>
</g>
<!-- layer_10_expert_11 -->
<g id="node270" class="node">
<title>layer_10_expert_11</title>
<polygon fill="lightblue" stroke="black" points="4821.5,-14650 4498.5,-14650 4498.5,-14582 4821.5,-14582 4821.5,-14650"/>
<text text-anchor="middle" x="4660" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4660" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4660" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4660" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 171</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_11 -->
<g id="edge451" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_11</title>
<path fill="none" stroke="black" d="M3689.53,-14905C4010.27,-14905 4577.5,-14905 4577.5,-14905 4577.5,-14905 4577.5,-14660 4577.5,-14660"/>
<polygon fill="black" stroke="black" points="4581,-14660 4577.5,-14650 4574,-14660 4581,-14660"/>
<text text-anchor="middle" x="4589" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_171</text>
</g>
<!-- layer_10_expert_12 -->
<g id="node271" class="node">
<title>layer_10_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5216.5,-14650 4893.5,-14650 4893.5,-14582 5216.5,-14582 5216.5,-14650"/>
<text text-anchor="middle" x="5055" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5055" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5055" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5055" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 172</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_12 -->
<g id="edge453" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_12</title>
<path fill="none" stroke="black" d="M3714.77,-14917C4137.82,-14917 4972.5,-14917 4972.5,-14917 4972.5,-14917 4972.5,-14660.23 4972.5,-14660.23"/>
<polygon fill="black" stroke="black" points="4976,-14660.23 4972.5,-14650.23 4969,-14660.23 4976,-14660.23"/>
<text text-anchor="middle" x="4926" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_172</text>
</g>
<!-- layer_10_expert_13 -->
<g id="node272" class="node">
<title>layer_10_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5611.5,-14650 5288.5,-14650 5288.5,-14582 5611.5,-14582 5611.5,-14650"/>
<text text-anchor="middle" x="5450" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5450" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5450" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5450" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 173</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_13 -->
<g id="edge455" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_13</title>
<path fill="none" stroke="black" d="M3722.9,-14929C4236.11,-14929 5367.5,-14929 5367.5,-14929 5367.5,-14929 5367.5,-14660.09 5367.5,-14660.09"/>
<polygon fill="black" stroke="black" points="5371,-14660.09 5367.5,-14650.09 5364,-14660.09 5371,-14660.09"/>
<text text-anchor="middle" x="5292" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_173</text>
</g>
<!-- layer_10_expert_14 -->
<g id="node273" class="node">
<title>layer_10_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6006.5,-14650 5683.5,-14650 5683.5,-14582 6006.5,-14582 6006.5,-14650"/>
<text text-anchor="middle" x="5845" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5845" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5845" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5845" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 174</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_14 -->
<g id="edge457" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_14</title>
<path fill="none" stroke="black" d="M3714.94,-14941C4301.89,-14941 5762.5,-14941 5762.5,-14941 5762.5,-14941 5762.5,-14660.16 5762.5,-14660.16"/>
<polygon fill="black" stroke="black" points="5766,-14660.16 5762.5,-14650.16 5759,-14660.16 5766,-14660.16"/>
<text text-anchor="middle" x="5673" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_174</text>
</g>
<!-- layer_10_expert_15 -->
<g id="node274" class="node">
<title>layer_10_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6401.5,-14650 6078.5,-14650 6078.5,-14582 6401.5,-14582 6401.5,-14650"/>
<text text-anchor="middle" x="6240" y="-14634.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6240" y="-14619.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6240" y="-14604.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6240" y="-14589.8" font-family="Times,serif" font-size="14.00">GPU: 175</text>
</g>
<!-- layer_10_scatter&#45;&gt;layer_10_expert_15 -->
<g id="edge459" class="edge">
<title>layer_10_scatter&#45;&gt;layer_10_expert_15</title>
<path fill="none" stroke="black" d="M3689.7,-14953C4325.99,-14953 6157.5,-14953 6157.5,-14953 6157.5,-14953 6157.5,-14660.17 6157.5,-14660.17"/>
<polygon fill="black" stroke="black" points="6161,-14660.17 6157.5,-14650.17 6154,-14660.17 6161,-14660.17"/>
<text text-anchor="middle" x="6061" y="-14761.8" font-family="Times,serif" font-size="14.00">to_GPU_175</text>
</g>
<!-- layer_10_gather -->
<g id="node259" class="node">
<title>layer_10_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3475" cy="-14302.92" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3475" y="-14321.72" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3475" y="-14306.72" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-14291.72" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3475" y="-14276.72" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_10_expert_0&#45;&gt;layer_10_gather -->
<g id="edge430" class="edge">
<title>layer_10_expert_0&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M449,-14581.8C449,-14493.73 449,-14266 449,-14266 449,-14266 3300.97,-14266 3300.97,-14266"/>
<polygon fill="black" stroke="black" points="3300.97,-14269.5 3310.97,-14266 3300.97,-14262.5 3300.97,-14269.5"/>
<text text-anchor="middle" x="628.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_160</text>
</g>
<!-- layer_10_gather&#45;&gt;layer_10_add_norm2 -->
<g id="edge461" class="edge">
<title>layer_10_gather&#45;&gt;layer_10_add_norm2</title>
<path fill="none" stroke="black" d="M3592.55,-14260.01C3592.55,-14174.72 3592.55,-13992 3592.55,-13992 3592.55,-13992 4112.63,-13992 4112.63,-13992"/>
<polygon fill="black" stroke="black" points="4112.63,-13995.5 4122.63,-13992 4112.63,-13988.5 4112.63,-13995.5"/>
</g>
<!-- layer_10_expert_1&#45;&gt;layer_10_gather -->
<g id="edge432" class="edge">
<title>layer_10_expert_1&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M845,-14581.73C845,-14495.8 845,-14278 845,-14278 845,-14278 3245.85,-14278 3245.85,-14278"/>
<polygon fill="black" stroke="black" points="3245.85,-14281.5 3255.85,-14278 3245.85,-14274.5 3245.85,-14281.5"/>
<text text-anchor="middle" x="1073.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_161</text>
</g>
<!-- layer_10_expert_2&#45;&gt;layer_10_gather -->
<g id="edge434" class="edge">
<title>layer_10_expert_2&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M1240,-14581.73C1240,-14498.03 1240,-14290 1240,-14290 1240,-14290 3218.35,-14290 3218.35,-14290"/>
<polygon fill="black" stroke="black" points="3218.35,-14293.5 3228.35,-14290 3218.35,-14286.5 3218.35,-14293.5"/>
<text text-anchor="middle" x="1362.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_162</text>
</g>
<!-- layer_10_expert_3&#45;&gt;layer_10_gather -->
<g id="edge436" class="edge">
<title>layer_10_expert_3&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M1635,-14581.8C1635,-14500.42 1635,-14302 1635,-14302 1635,-14302 3208.67,-14302 3208.67,-14302"/>
<polygon fill="black" stroke="black" points="3208.67,-14305.5 3218.67,-14302 3208.67,-14298.5 3208.67,-14305.5"/>
<text text-anchor="middle" x="1750.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_163</text>
</g>
<!-- layer_10_expert_4&#45;&gt;layer_10_gather -->
<g id="edge438" class="edge">
<title>layer_10_expert_4&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M2002,-14581.94C2002,-14502.96 2002,-14314 2002,-14314 2002,-14314 3215.54,-14314 3215.54,-14314"/>
<polygon fill="black" stroke="black" points="3215.54,-14317.5 3225.54,-14314 3215.54,-14310.5 3215.54,-14317.5"/>
<text text-anchor="middle" x="2132.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_164</text>
</g>
<!-- layer_10_expert_5&#45;&gt;layer_10_gather -->
<g id="edge440" class="edge">
<title>layer_10_expert_5&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M2425,-14581.88C2425,-14505.22 2425,-14326 2425,-14326 2425,-14326 3240.39,-14326 3240.39,-14326"/>
<polygon fill="black" stroke="black" points="3240.39,-14329.5 3250.39,-14326 3240.39,-14322.5 3240.39,-14329.5"/>
<text text-anchor="middle" x="2501.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_165</text>
</g>
<!-- layer_10_expert_6&#45;&gt;layer_10_gather -->
<g id="edge442" class="edge">
<title>layer_10_expert_6&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M2820,-14581.91C2820,-14507.68 2820,-14338 2820,-14338 2820,-14338 3289.9,-14338 3289.9,-14338"/>
<polygon fill="black" stroke="black" points="3289.9,-14341.5 3299.9,-14338 3289.9,-14334.5 3289.9,-14341.5"/>
<text text-anchor="middle" x="2844.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_166</text>
</g>
<!-- layer_10_expert_7&#45;&gt;layer_10_gather -->
<g id="edge444" class="edge">
<title>layer_10_expert_7&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M3230.26,-14581.9C3230.26,-14581.9 3230.26,-14327.17 3230.26,-14327.17"/>
<polygon fill="black" stroke="black" points="3233.76,-14327.17 3230.26,-14317.17 3226.76,-14327.17 3233.76,-14327.17"/>
<text text-anchor="middle" x="3239.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_167</text>
</g>
<!-- layer_10_expert_8&#45;&gt;layer_10_gather -->
<g id="edge446" class="edge">
<title>layer_10_expert_8&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M3475,-14581.9C3475,-14581.9 3475,-14361 3475,-14361"/>
<polygon fill="black" stroke="black" points="3478.5,-14361 3475,-14351 3471.5,-14361 3478.5,-14361"/>
<text text-anchor="middle" x="3528.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_168</text>
</g>
<!-- layer_10_expert_9&#45;&gt;layer_10_gather -->
<g id="edge448" class="edge">
<title>layer_10_expert_9&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M3719.74,-14581.9C3719.74,-14581.9 3719.74,-14327.17 3719.74,-14327.17"/>
<polygon fill="black" stroke="black" points="3723.24,-14327.17 3719.74,-14317.17 3716.24,-14327.17 3723.24,-14327.17"/>
<text text-anchor="middle" x="3817.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_169</text>
</g>
<!-- layer_10_expert_10&#45;&gt;layer_10_gather -->
<g id="edge450" class="edge">
<title>layer_10_expert_10&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M4113.25,-14581.79C4113.25,-14507.29 4113.25,-14337 4113.25,-14337 4113.25,-14337 3665.76,-14337 3665.76,-14337"/>
<polygon fill="black" stroke="black" points="3665.76,-14333.5 3655.76,-14337 3665.76,-14340.5 3665.76,-14333.5"/>
<text text-anchor="middle" x="4159.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_170</text>
</g>
<!-- layer_10_expert_11&#45;&gt;layer_10_gather -->
<g id="edge452" class="edge">
<title>layer_10_expert_11&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M4633.5,-14581.81C4633.5,-14504.52 4633.5,-14323 4633.5,-14323 4633.5,-14323 3717.7,-14323 3717.7,-14323"/>
<polygon fill="black" stroke="black" points="3717.7,-14319.5 3707.7,-14323 3717.7,-14326.5 3717.7,-14319.5"/>
<text text-anchor="middle" x="4528.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_171</text>
</g>
<!-- layer_10_expert_12&#45;&gt;layer_10_gather -->
<g id="edge454" class="edge">
<title>layer_10_expert_12&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M5028.5,-14581.97C5028.5,-14502.04 5028.5,-14309 5028.5,-14309 5028.5,-14309 3738.92,-14309 3738.92,-14309"/>
<polygon fill="black" stroke="black" points="3738.92,-14305.5 3728.92,-14309 3738.92,-14312.5 3738.92,-14305.5"/>
<text text-anchor="middle" x="4910.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_172</text>
</g>
<!-- layer_10_expert_13&#45;&gt;layer_10_gather -->
<g id="edge456" class="edge">
<title>layer_10_expert_13&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M5423.5,-14581.75C5423.5,-14499.2 5423.5,-14296 5423.5,-14296 5423.5,-14296 3738.73,-14296 3738.73,-14296"/>
<polygon fill="black" stroke="black" points="3738.73,-14292.5 3728.73,-14296 3738.73,-14299.5 3738.73,-14292.5"/>
<text text-anchor="middle" x="5298.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_173</text>
</g>
<!-- layer_10_expert_14&#45;&gt;layer_10_gather -->
<g id="edge458" class="edge">
<title>layer_10_expert_14&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M5818.5,-14581.82C5818.5,-14496.7 5818.5,-14282 5818.5,-14282 5818.5,-14282 3715.58,-14282 3715.58,-14282"/>
<polygon fill="black" stroke="black" points="3715.58,-14278.5 3705.58,-14282 3715.58,-14285.5 3715.58,-14278.5"/>
<text text-anchor="middle" x="5690.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_174</text>
</g>
<!-- layer_10_expert_15&#45;&gt;layer_10_gather -->
<g id="edge460" class="edge">
<title>layer_10_expert_15&#45;&gt;layer_10_gather</title>
<path fill="none" stroke="black" d="M6213.5,-14582C6213.5,-14494.43 6213.5,-14268 6213.5,-14268 6213.5,-14268 3661,-14268 3661,-14268"/>
<polygon fill="black" stroke="black" points="3661,-14264.5 3651,-14268 3661,-14271.5 3661,-14264.5"/>
<text text-anchor="middle" x="6084.5" y="-14462.8" font-family="Times,serif" font-size="14.00">from_GPU_175</text>
</g>
<!-- layer_11_qkv -->
<g id="node277" class="node">
<title>layer_11_qkv</title>
<polygon fill="lightblue" stroke="black" points="4216.5,-13752.83 3807.5,-13752.83 3807.5,-13684.83 4216.5,-13684.83 4216.5,-13752.83"/>
<text text-anchor="middle" x="4012" y="-13737.63" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="4012" y="-13722.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4012" y="-13707.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4012" y="-13692.63" font-family="Times,serif" font-size="14.00">GPU: 176</text>
</g>
<!-- layer_10_add_norm2&#45;&gt;layer_11_qkv -->
<g id="edge463" class="edge">
<title>layer_10_add_norm2&#45;&gt;layer_11_qkv</title>
<path fill="none" stroke="black" d="M4169.75,-13969.74C4169.75,-13969.74 4169.75,-13762.97 4169.75,-13762.97"/>
<polygon fill="black" stroke="black" points="4173.25,-13762.97 4169.75,-13752.97 4166.25,-13762.97 4173.25,-13762.97"/>
</g>
<!-- layer_11_add_norm1 -->
<g id="node280" class="node">
<title>layer_11_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4434,-12897.83 4072,-12897.83 4072,-12829.83 4434,-12829.83 4434,-12897.83"/>
<text text-anchor="middle" x="4253" y="-12882.63" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4253" y="-12867.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4253" y="-12852.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4253" y="-12837.63" font-family="Times,serif" font-size="14.00">GPU: 176</text>
</g>
<!-- layer_10_add_norm2&#45;&gt;layer_11_add_norm1 -->
<g id="edge467" class="edge">
<title>layer_10_add_norm2&#45;&gt;layer_11_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4328.75,-13969.71C4328.75,-13969.71 4328.75,-12908.09 4328.75,-12908.09"/>
<polygon fill="black" stroke="black" points="4332.25,-12908.09 4328.75,-12898.09 4325.25,-12908.09 4332.25,-12908.09"/>
<text text-anchor="middle" x="4372" y="-13430.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_10_mha -->
<g id="node276" class="node">
<title>layer_10_mha</title>
<polygon fill="lightblue" stroke="black" points="1861.5,-16484.16 1452.5,-16484.16 1452.5,-16416.16 1861.5,-16416.16 1861.5,-16484.16"/>
<text text-anchor="middle" x="1657" y="-16468.96" font-family="Times,serif" font-size="14.00">MHA Layer 10</text>
<text text-anchor="middle" x="1657" y="-16453.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1657" y="-16438.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1657" y="-16423.96" font-family="Times,serif" font-size="14.00">GPU: 160</text>
</g>
<!-- layer_11_attn -->
<g id="node278" class="node">
<title>layer_11_attn</title>
<polygon fill="lightblue" stroke="black" points="4198.5,-13467.83 3789.5,-13467.83 3789.5,-13399.83 4198.5,-13399.83 4198.5,-13467.83"/>
<text text-anchor="middle" x="3994" y="-13452.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3994" y="-13437.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3994" y="-13422.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3994" y="-13407.63" font-family="Times,serif" font-size="14.00">GPU: 176</text>
</g>
<!-- layer_11_qkv&#45;&gt;layer_11_attn -->
<g id="edge464" class="edge">
<title>layer_11_qkv&#45;&gt;layer_11_attn</title>
<path fill="none" stroke="black" d="M4003,-13684.74C4003,-13684.74 4003,-13477.97 4003,-13477.97"/>
<polygon fill="black" stroke="black" points="4006.5,-13477.97 4003,-13467.97 3999.5,-13477.97 4006.5,-13477.97"/>
</g>
<!-- layer_11_proj -->
<g id="node279" class="node">
<title>layer_11_proj</title>
<polygon fill="lightblue" stroke="black" points="4223.5,-13182.83 3826.5,-13182.83 3826.5,-13114.83 4223.5,-13114.83 4223.5,-13182.83"/>
<text text-anchor="middle" x="4025" y="-13167.63" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="4025" y="-13152.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4025" y="-13137.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4025" y="-13122.63" font-family="Times,serif" font-size="14.00">GPU: 176</text>
</g>
<!-- layer_11_attn&#45;&gt;layer_11_proj -->
<g id="edge465" class="edge">
<title>layer_11_attn&#45;&gt;layer_11_proj</title>
<path fill="none" stroke="black" d="M4012.5,-13399.74C4012.5,-13399.74 4012.5,-13192.97 4012.5,-13192.97"/>
<polygon fill="black" stroke="black" points="4016,-13192.97 4012.5,-13182.97 4009,-13192.97 4016,-13192.97"/>
</g>
<!-- layer_11_proj&#45;&gt;layer_11_add_norm1 -->
<g id="edge466" class="edge">
<title>layer_11_proj&#45;&gt;layer_11_add_norm1</title>
<path fill="none" stroke="black" d="M4147.75,-13114.74C4147.75,-13114.74 4147.75,-12907.97 4147.75,-12907.97"/>
<polygon fill="black" stroke="black" points="4151.25,-12907.97 4147.75,-12897.97 4144.25,-12907.97 4151.25,-12907.97"/>
</g>
<!-- layer_11_gate -->
<g id="node281" class="node">
<title>layer_11_gate</title>
<polygon fill="yellow" stroke="black" points="4179.73,-12612.83 3602.71,-12612.83 3454.27,-12476.83 4031.29,-12476.83 4179.73,-12612.83"/>
<text text-anchor="middle" x="3817" y="-12563.63" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3817" y="-12548.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3817" y="-12533.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3817" y="-12518.63" font-family="Times,serif" font-size="14.00">GPU: 176</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_gate -->
<g id="edge468" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_gate</title>
<path fill="none" stroke="black" d="M4125.93,-12829.69C4125.93,-12829.69 4125.93,-12622.95 4125.93,-12622.95"/>
<polygon fill="black" stroke="black" points="4129.43,-12622.95 4125.93,-12612.95 4122.43,-12622.95 4129.43,-12622.95"/>
</g>
<!-- layer_11_scatter -->
<g id="node282" class="node">
<title>layer_11_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3817" cy="-12197.75" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3817" y="-12216.55" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3817" y="-12201.55" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3817" y="-12186.55" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3817" y="-12171.55" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_scatter -->
<g id="edge469" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_scatter</title>
<path fill="none" stroke="black" d="M4276.68,-12829.47C4276.68,-12697.83 4276.68,-12233 4276.68,-12233 4276.68,-12233 3995.56,-12233 3995.56,-12233"/>
<polygon fill="black" stroke="black" points="3995.56,-12229.5 3985.56,-12233 3995.56,-12236.5 3995.56,-12229.5"/>
</g>
<!-- layer_11_add_norm2 -->
<g id="node300" class="node">
<title>layer_11_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4188,-11306.5 3826,-11306.5 3826,-11238.5 4188,-11238.5 4188,-11306.5"/>
<text text-anchor="middle" x="4007" y="-11291.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4007" y="-11276.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4007" y="-11261.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4007" y="-11246.3" font-family="Times,serif" font-size="14.00">GPU: 176</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_add_norm2 -->
<g id="edge504" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4393.67,-12829.48C4393.67,-12597.73 4393.67,-11272 4393.67,-11272 4393.67,-11272 4198.16,-11272 4198.16,-11272"/>
<polygon fill="black" stroke="black" points="4198.16,-11268.5 4188.16,-11272 4198.16,-11275.5 4198.16,-11268.5"/>
<text text-anchor="middle" x="6789" y="-12030.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_scatter -->
<g id="edge470" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3817,-12476.67C3817,-12476.67 3817,-12255.94 3817,-12255.94"/>
<polygon fill="black" stroke="black" points="3820.5,-12255.94 3817,-12245.94 3813.5,-12255.94 3820.5,-12255.94"/>
<text text-anchor="middle" x="3860.5" y="-12357.63" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_11_expert_0 -->
<g id="node283" class="node">
<title>layer_11_expert_0</title>
<polygon fill="lightblue" stroke="black" points="818.5,-11918.67 495.5,-11918.67 495.5,-11850.67 818.5,-11850.67 818.5,-11918.67"/>
<text text-anchor="middle" x="657" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="657" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="657" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="657" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 176</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_0 -->
<g id="edge471" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_0</title>
<path fill="none" stroke="black" d="M3648.53,-12233C2997.67,-12233 683.5,-12233 683.5,-12233 683.5,-12233 683.5,-11928.7 683.5,-11928.7"/>
<polygon fill="black" stroke="black" points="687,-11928.7 683.5,-11918.7 680,-11928.7 687,-11928.7"/>
<text text-anchor="middle" x="879" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_176</text>
</g>
<!-- layer_11_expert_1 -->
<g id="node285" class="node">
<title>layer_11_expert_1</title>
<polygon fill="lightblue" stroke="black" points="1213.5,-11918.67 890.5,-11918.67 890.5,-11850.67 1213.5,-11850.67 1213.5,-11918.67"/>
<text text-anchor="middle" x="1052" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1052" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1052" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1052" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 177</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_1 -->
<g id="edge473" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_1</title>
<path fill="none" stroke="black" d="M3600.11,-12221C2952.67,-12221 1078.5,-12221 1078.5,-12221 1078.5,-12221 1078.5,-11928.77 1078.5,-11928.77"/>
<polygon fill="black" stroke="black" points="1082,-11928.77 1078.5,-11918.77 1075,-11928.77 1082,-11928.77"/>
<text text-anchor="middle" x="1222" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_177</text>
</g>
<!-- layer_11_expert_2 -->
<g id="node286" class="node">
<title>layer_11_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1608.5,-11918.67 1285.5,-11918.67 1285.5,-11850.67 1608.5,-11850.67 1608.5,-11918.67"/>
<text text-anchor="middle" x="1447" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1447" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1447" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1447" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 178</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_2 -->
<g id="edge475" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_2</title>
<path fill="none" stroke="black" d="M3576.13,-12209C2978.1,-12209 1473.5,-12209 1473.5,-12209 1473.5,-12209 1473.5,-11928.76 1473.5,-11928.76"/>
<polygon fill="black" stroke="black" points="1477,-11928.76 1473.5,-11918.76 1470,-11928.76 1477,-11928.76"/>
<text text-anchor="middle" x="1513" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_178</text>
</g>
<!-- layer_11_expert_3 -->
<g id="node287" class="node">
<title>layer_11_expert_3</title>
<polygon fill="lightblue" stroke="black" points="2003.5,-11918.67 1680.5,-11918.67 1680.5,-11850.67 2003.5,-11850.67 2003.5,-11918.67"/>
<text text-anchor="middle" x="1842" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1842" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1842" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1842" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 179</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_3 -->
<g id="edge477" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_3</title>
<path fill="none" stroke="black" d="M3569.13,-12197C3066.69,-12197 1975.5,-12197 1975.5,-12197 1975.5,-12197 1975.5,-11928.69 1975.5,-11928.69"/>
<polygon fill="black" stroke="black" points="1979,-11928.69 1975.5,-11918.69 1972,-11928.69 1979,-11928.69"/>
<text text-anchor="middle" x="2368" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_179</text>
</g>
<!-- layer_11_expert_4 -->
<g id="node288" class="node">
<title>layer_11_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2398.5,-11918.67 2075.5,-11918.67 2075.5,-11850.67 2398.5,-11850.67 2398.5,-11918.67"/>
<text text-anchor="middle" x="2237" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2237" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2237" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2237" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 180</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_4 -->
<g id="edge479" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_4</title>
<path fill="none" stroke="black" d="M3578.08,-12185C3168.87,-12185 2377.5,-12185 2377.5,-12185 2377.5,-12185 2377.5,-11928.83 2377.5,-11928.83"/>
<polygon fill="black" stroke="black" points="2381,-11928.83 2377.5,-11918.83 2374,-11928.83 2381,-11928.83"/>
<text text-anchor="middle" x="2878" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_180</text>
</g>
<!-- layer_11_expert_5 -->
<g id="node289" class="node">
<title>layer_11_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2793.5,-11918.67 2470.5,-11918.67 2470.5,-11850.67 2793.5,-11850.67 2793.5,-11918.67"/>
<text text-anchor="middle" x="2632" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2632" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2632" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2632" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 181</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_5 -->
<g id="edge481" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_5</title>
<path fill="none" stroke="black" d="M3604.51,-12173C3270.06,-12173 2658.5,-12173 2658.5,-12173 2658.5,-12173 2658.5,-11928.87 2658.5,-11928.87"/>
<polygon fill="black" stroke="black" points="2662,-11928.87 2658.5,-11918.87 2655,-11928.87 2662,-11928.87"/>
<text text-anchor="middle" x="3215" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_181</text>
</g>
<!-- layer_11_expert_6 -->
<g id="node290" class="node">
<title>layer_11_expert_6</title>
<polygon fill="lightblue" stroke="black" points="3188.5,-11918.67 2865.5,-11918.67 2865.5,-11850.67 3188.5,-11850.67 3188.5,-11918.67"/>
<text text-anchor="middle" x="3027" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3027" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3027" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3027" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 182</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_6 -->
<g id="edge483" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_6</title>
<path fill="none" stroke="black" d="M3656.95,-12161C3433.06,-12161 3053.5,-12161 3053.5,-12161 3053.5,-12161 3053.5,-11928.83 3053.5,-11928.83"/>
<polygon fill="black" stroke="black" points="3057,-11928.83 3053.5,-11918.83 3050,-11928.83 3057,-11928.83"/>
<text text-anchor="middle" x="3466" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_182</text>
</g>
<!-- layer_11_expert_7 -->
<g id="node291" class="node">
<title>layer_11_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3583.5,-11918.67 3260.5,-11918.67 3260.5,-11850.67 3583.5,-11850.67 3583.5,-11918.67"/>
<text text-anchor="middle" x="3422" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3422" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3422" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3422" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 183</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_7 -->
<g id="edge485" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_7</title>
<path fill="none" stroke="black" d="M3576.51,-12186.23C3576.51,-12186.23 3576.51,-11928.67 3576.51,-11928.67"/>
<polygon fill="black" stroke="black" points="3580.01,-11928.67 3576.51,-11918.67 3573.01,-11928.67 3580.01,-11928.67"/>
<text text-anchor="middle" x="3674" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_183</text>
</g>
<!-- layer_11_expert_8 -->
<g id="node292" class="node">
<title>layer_11_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3978.5,-11918.67 3655.5,-11918.67 3655.5,-11850.67 3978.5,-11850.67 3978.5,-11918.67"/>
<text text-anchor="middle" x="3817" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3817" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3817" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3817" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 184</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_8 -->
<g id="edge487" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_8</title>
<path fill="none" stroke="black" d="M3817,-12149.52C3817,-12149.52 3817,-11928.93 3817,-11928.93"/>
<polygon fill="black" stroke="black" points="3820.5,-11928.93 3817,-11918.93 3813.5,-11928.93 3820.5,-11928.93"/>
<text text-anchor="middle" x="3861" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_184</text>
</g>
<!-- layer_11_expert_9 -->
<g id="node293" class="node">
<title>layer_11_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4373.5,-11918.67 4050.5,-11918.67 4050.5,-11850.67 4373.5,-11850.67 4373.5,-11918.67"/>
<text text-anchor="middle" x="4212" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4212" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4212" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4212" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 185</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_9 -->
<g id="edge489" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_9</title>
<path fill="none" stroke="black" d="M4057.49,-12186.23C4057.49,-12186.23 4057.49,-11928.67 4057.49,-11928.67"/>
<polygon fill="black" stroke="black" points="4060.99,-11928.67 4057.49,-11918.67 4053.99,-11928.67 4060.99,-11928.67"/>
<text text-anchor="middle" x="4141" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_185</text>
</g>
<!-- layer_11_expert_10 -->
<g id="node294" class="node">
<title>layer_11_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4768.5,-11918.67 4445.5,-11918.67 4445.5,-11850.67 4768.5,-11850.67 4768.5,-11918.67"/>
<text text-anchor="middle" x="4607" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4607" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4607" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4607" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 186</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_10 -->
<g id="edge491" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_10</title>
<path fill="none" stroke="black" d="M3976.83,-12161C4168.78,-12161 4465.25,-12161 4465.25,-12161 4465.25,-12161 4465.25,-11928.83 4465.25,-11928.83"/>
<polygon fill="black" stroke="black" points="4468.75,-11928.83 4465.25,-11918.83 4461.75,-11928.83 4468.75,-11928.83"/>
<text text-anchor="middle" x="4536" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_186</text>
</g>
<!-- layer_11_expert_11 -->
<g id="node295" class="node">
<title>layer_11_expert_11</title>
<polygon fill="lightblue" stroke="black" points="5163.5,-11918.67 4840.5,-11918.67 4840.5,-11850.67 5163.5,-11850.67 5163.5,-11918.67"/>
<text text-anchor="middle" x="5002" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="5002" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5002" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5002" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 187</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_11 -->
<g id="edge493" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_11</title>
<path fill="none" stroke="black" d="M4029.48,-12173C4336.3,-12173 4867,-12173 4867,-12173 4867,-12173 4867,-11928.87 4867,-11928.87"/>
<polygon fill="black" stroke="black" points="4870.5,-11928.87 4867,-11918.87 4863.5,-11928.87 4870.5,-11928.87"/>
<text text-anchor="middle" x="4873" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_187</text>
</g>
<!-- layer_11_expert_12 -->
<g id="node296" class="node">
<title>layer_11_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5558.5,-11918.67 5235.5,-11918.67 5235.5,-11850.67 5558.5,-11850.67 5558.5,-11918.67"/>
<text text-anchor="middle" x="5397" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5397" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5397" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5397" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 188</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_12 -->
<g id="edge495" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_12</title>
<path fill="none" stroke="black" d="M4056.02,-12185C4466.56,-12185 5262,-12185 5262,-12185 5262,-12185 5262,-11928.83 5262,-11928.83"/>
<polygon fill="black" stroke="black" points="5265.5,-11928.83 5262,-11918.83 5258.5,-11928.83 5265.5,-11928.83"/>
<text text-anchor="middle" x="5239" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_188</text>
</g>
<!-- layer_11_expert_13 -->
<g id="node297" class="node">
<title>layer_11_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5953.5,-11918.67 5630.5,-11918.67 5630.5,-11850.67 5953.5,-11850.67 5953.5,-11918.67"/>
<text text-anchor="middle" x="5792" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5792" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5792" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5792" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 189</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_13 -->
<g id="edge497" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_13</title>
<path fill="none" stroke="black" d="M4064.67,-12197C4566.7,-12197 5657,-12197 5657,-12197 5657,-12197 5657,-11928.69 5657,-11928.69"/>
<polygon fill="black" stroke="black" points="5660.5,-11928.69 5657,-11918.69 5653.5,-11928.69 5660.5,-11928.69"/>
<text text-anchor="middle" x="5620" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_189</text>
</g>
<!-- layer_11_expert_14 -->
<g id="node298" class="node">
<title>layer_11_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6348.5,-11918.67 6025.5,-11918.67 6025.5,-11850.67 6348.5,-11850.67 6348.5,-11918.67"/>
<text text-anchor="middle" x="6187" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="6187" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6187" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6187" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 190</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_14 -->
<g id="edge499" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_14</title>
<path fill="none" stroke="black" d="M4057.78,-12209C4635.36,-12209 6052,-12209 6052,-12209 6052,-12209 6052,-11928.76 6052,-11928.76"/>
<polygon fill="black" stroke="black" points="6055.5,-11928.76 6052,-11918.76 6048.5,-11928.76 6055.5,-11928.76"/>
<text text-anchor="middle" x="6008" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_190</text>
</g>
<!-- layer_11_expert_15 -->
<g id="node299" class="node">
<title>layer_11_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6743.5,-11918.67 6420.5,-11918.67 6420.5,-11850.67 6743.5,-11850.67 6743.5,-11918.67"/>
<text text-anchor="middle" x="6582" y="-11903.47" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6582" y="-11888.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6582" y="-11873.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6582" y="-11858.47" font-family="Times,serif" font-size="14.00">GPU: 191</text>
</g>
<!-- layer_11_scatter&#45;&gt;layer_11_expert_15 -->
<g id="edge501" class="edge">
<title>layer_11_scatter&#45;&gt;layer_11_expert_15</title>
<path fill="none" stroke="black" d="M4033.82,-12221C4676.4,-12221 6526,-12221 6526,-12221 6526,-12221 6526,-11928.77 6526,-11928.77"/>
<polygon fill="black" stroke="black" points="6529.5,-11928.77 6526,-11918.77 6522.5,-11928.77 6529.5,-11928.77"/>
<text text-anchor="middle" x="6511" y="-12030.47" font-family="Times,serif" font-size="14.00">to_GPU_191</text>
</g>
<!-- layer_11_gather -->
<g id="node284" class="node">
<title>layer_11_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3817" cy="-11571.58" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3817" y="-11590.38" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3817" y="-11575.38" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3817" y="-11560.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3817" y="-11545.38" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_11_expert_0&#45;&gt;layer_11_gather -->
<g id="edge472" class="edge">
<title>layer_11_expert_0&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M791.5,-11850.5C791.5,-11762.52 791.5,-11535 791.5,-11535 791.5,-11535 3640.84,-11535 3640.84,-11535"/>
<polygon fill="black" stroke="black" points="3640.84,-11538.5 3650.84,-11535 3640.84,-11531.5 3640.84,-11538.5"/>
<text text-anchor="middle" x="957.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_176</text>
</g>
<!-- layer_11_gather&#45;&gt;layer_11_add_norm2 -->
<g id="edge503" class="edge">
<title>layer_11_gather&#45;&gt;layer_11_add_norm2</title>
<path fill="none" stroke="black" d="M3949.49,-11530.31C3949.49,-11530.31 3949.49,-11316.86 3949.49,-11316.86"/>
<polygon fill="black" stroke="black" points="3952.99,-11316.86 3949.49,-11306.86 3945.99,-11316.86 3952.99,-11316.86"/>
</g>
<!-- layer_11_expert_1&#45;&gt;layer_11_gather -->
<g id="edge474" class="edge">
<title>layer_11_expert_1&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M1186.5,-11850.43C1186.5,-11764.59 1186.5,-11547 1186.5,-11547 1186.5,-11547 3586.97,-11547 3586.97,-11547"/>
<polygon fill="black" stroke="black" points="3586.97,-11550.5 3596.97,-11547 3586.97,-11543.5 3586.97,-11550.5"/>
<text text-anchor="middle" x="1388.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_177</text>
</g>
<!-- layer_11_expert_2&#45;&gt;layer_11_gather -->
<g id="edge476" class="edge">
<title>layer_11_expert_2&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M1571,-11850.43C1571,-11766.82 1571,-11559 1571,-11559 1571,-11559 3559.94,-11559 3559.94,-11559"/>
<polygon fill="black" stroke="black" points="3559.94,-11562.5 3569.94,-11559 3559.94,-11555.5 3559.94,-11562.5"/>
<text text-anchor="middle" x="1856.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_178</text>
</g>
<!-- layer_11_expert_3&#45;&gt;layer_11_gather -->
<g id="edge478" class="edge">
<title>layer_11_expert_3&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M1972,-11850.5C1972,-11769.21 1972,-11571 1972,-11571 1972,-11571 3550.95,-11571 3550.95,-11571"/>
<polygon fill="black" stroke="black" points="3550.95,-11574.5 3560.95,-11571 3550.95,-11567.5 3550.95,-11574.5"/>
<text text-anchor="middle" x="2145.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_179</text>
</g>
<!-- layer_11_expert_4&#45;&gt;layer_11_gather -->
<g id="edge480" class="edge">
<title>layer_11_expert_4&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M2371.5,-11850.65C2371.5,-11771.75 2371.5,-11583 2371.5,-11583 2371.5,-11583 3558.1,-11583 3558.1,-11583"/>
<polygon fill="black" stroke="black" points="3558.1,-11586.5 3568.1,-11583 3558.1,-11579.5 3558.1,-11586.5"/>
<text text-anchor="middle" x="2580.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_180</text>
</g>
<!-- layer_11_expert_5&#45;&gt;layer_11_gather -->
<g id="edge482" class="edge">
<title>layer_11_expert_5&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M2766.5,-11850.59C2766.5,-11774.01 2766.5,-11595 2766.5,-11595 2766.5,-11595 3583.25,-11595 3583.25,-11595"/>
<polygon fill="black" stroke="black" points="3583.25,-11598.5 3593.25,-11595 3583.25,-11591.5 3583.25,-11598.5"/>
<text text-anchor="middle" x="2869.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_181</text>
</g>
<!-- layer_11_expert_6&#45;&gt;layer_11_gather -->
<g id="edge484" class="edge">
<title>layer_11_expert_6&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M3086.82,-11850.62C3086.82,-11776.47 3086.82,-11607 3086.82,-11607 3086.82,-11607 3633.49,-11607 3633.49,-11607"/>
<polygon fill="black" stroke="black" points="3633.49,-11610.5 3643.49,-11607 3633.49,-11603.5 3633.49,-11610.5"/>
<text text-anchor="middle" x="3238.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_182</text>
</g>
<!-- layer_11_expert_7&#45;&gt;layer_11_gather -->
<g id="edge486" class="edge">
<title>layer_11_expert_7&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M3572.26,-11850.56C3572.26,-11850.56 3572.26,-11595.84 3572.26,-11595.84"/>
<polygon fill="black" stroke="black" points="3575.76,-11595.84 3572.26,-11585.84 3568.76,-11595.84 3575.76,-11595.84"/>
<text text-anchor="middle" x="3581.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_183</text>
</g>
<!-- layer_11_expert_8&#45;&gt;layer_11_gather -->
<g id="edge488" class="edge">
<title>layer_11_expert_8&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M3817,-11850.56C3817,-11850.56 3817,-11629.67 3817,-11629.67"/>
<polygon fill="black" stroke="black" points="3820.5,-11629.67 3817,-11619.67 3813.5,-11629.67 3820.5,-11629.67"/>
<text text-anchor="middle" x="3870.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_184</text>
</g>
<!-- layer_11_expert_9&#45;&gt;layer_11_gather -->
<g id="edge490" class="edge">
<title>layer_11_expert_9&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M4061.74,-11850.56C4061.74,-11850.56 4061.74,-11595.84 4061.74,-11595.84"/>
<polygon fill="black" stroke="black" points="4065.24,-11595.84 4061.74,-11585.84 4058.24,-11595.84 4065.24,-11595.84"/>
<text text-anchor="middle" x="4160.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_185</text>
</g>
<!-- layer_11_expert_10&#45;&gt;layer_11_gather -->
<g id="edge492" class="edge">
<title>layer_11_expert_10&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M4570,-11850.65C4570,-11776.12 4570,-11605 4570,-11605 4570,-11605 4011.2,-11605 4011.2,-11605"/>
<polygon fill="black" stroke="black" points="4011.2,-11601.5 4001.2,-11605 4011.2,-11608.5 4011.2,-11601.5"/>
<text text-anchor="middle" x="4449.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_186</text>
</g>
<!-- layer_11_expert_11&#45;&gt;layer_11_gather -->
<g id="edge494" class="edge">
<title>layer_11_expert_11&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M4965,-11850.52C4965,-11773.32 4965,-11592 4965,-11592 4965,-11592 4058.97,-11592 4058.97,-11592"/>
<polygon fill="black" stroke="black" points="4058.97,-11588.5 4048.97,-11592 4058.97,-11595.5 4058.97,-11588.5"/>
<text text-anchor="middle" x="4791.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_187</text>
</g>
<!-- layer_11_expert_12&#45;&gt;layer_11_gather -->
<g id="edge496" class="edge">
<title>layer_11_expert_12&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M5360,-11850.38C5360,-11770.36 5360,-11578 5360,-11578 5360,-11578 4080.93,-11578 4080.93,-11578"/>
<polygon fill="black" stroke="black" points="4080.93,-11574.5 4070.93,-11578 4080.93,-11581.5 4080.93,-11574.5"/>
<text text-anchor="middle" x="5160.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_188</text>
</g>
<!-- layer_11_expert_13&#45;&gt;layer_11_gather -->
<g id="edge498" class="edge">
<title>layer_11_expert_13&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M5755,-11850.65C5755,-11768.12 5755,-11564 5755,-11564 5755,-11564 4079.86,-11564 4079.86,-11564"/>
<polygon fill="black" stroke="black" points="4079.86,-11560.5 4069.86,-11564 4079.86,-11567.5 4079.86,-11560.5"/>
<text text-anchor="middle" x="5595.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_189</text>
</g>
<!-- layer_11_expert_14&#45;&gt;layer_11_gather -->
<g id="edge500" class="edge">
<title>layer_11_expert_14&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M6150,-11850.42C6150,-11765.13 6150,-11550 6150,-11550 6150,-11550 4055.75,-11550 4055.75,-11550"/>
<polygon fill="black" stroke="black" points="4055.75,-11546.5 4045.75,-11550 4055.75,-11553.5 4055.75,-11546.5"/>
<text text-anchor="middle" x="6135.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_190</text>
</g>
<!-- layer_11_expert_15&#45;&gt;layer_11_gather -->
<g id="edge502" class="edge">
<title>layer_11_expert_15&#45;&gt;layer_11_gather</title>
<path fill="none" stroke="black" d="M6520,-11850.38C6520,-11762.67 6520,-11537 6520,-11537 6520,-11537 4004.87,-11537 4004.87,-11537"/>
<polygon fill="black" stroke="black" points="4004.87,-11533.5 3994.87,-11537 4004.87,-11540.5 4004.87,-11533.5"/>
<text text-anchor="middle" x="6477.5" y="-11731.47" font-family="Times,serif" font-size="14.00">from_GPU_191</text>
</g>
<!-- layer_12_qkv -->
<g id="node302" class="node">
<title>layer_12_qkv</title>
<polygon fill="lightblue" stroke="black" points="3956.5,-11021.5 3547.5,-11021.5 3547.5,-10953.5 3956.5,-10953.5 3956.5,-11021.5"/>
<text text-anchor="middle" x="3752" y="-11006.3" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3752" y="-10991.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3752" y="-10976.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3752" y="-10961.3" font-family="Times,serif" font-size="14.00">GPU: 192</text>
</g>
<!-- layer_11_add_norm2&#45;&gt;layer_12_qkv -->
<g id="edge505" class="edge">
<title>layer_11_add_norm2&#45;&gt;layer_12_qkv</title>
<path fill="none" stroke="black" d="M3891.25,-11238.4C3891.25,-11238.4 3891.25,-11031.63 3891.25,-11031.63"/>
<polygon fill="black" stroke="black" points="3894.75,-11031.63 3891.25,-11021.63 3887.75,-11031.63 3894.75,-11031.63"/>
</g>
<!-- layer_12_add_norm1 -->
<g id="node305" class="node">
<title>layer_12_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="3965,-10166.5 3603,-10166.5 3603,-10098.5 3965,-10098.5 3965,-10166.5"/>
<text text-anchor="middle" x="3784" y="-10151.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3784" y="-10136.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3784" y="-10121.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3784" y="-10106.3" font-family="Times,serif" font-size="14.00">GPU: 192</text>
</g>
<!-- layer_11_add_norm2&#45;&gt;layer_12_add_norm1 -->
<g id="edge509" class="edge">
<title>layer_11_add_norm2&#45;&gt;layer_12_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3960.75,-11238.38C3960.75,-11238.38 3960.75,-10176.76 3960.75,-10176.76"/>
<polygon fill="black" stroke="black" points="3964.25,-10176.76 3960.75,-10166.76 3957.25,-10176.76 3964.25,-10176.76"/>
<text text-anchor="middle" x="4112" y="-10698.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_11_mha -->
<g id="node301" class="node">
<title>layer_11_mha</title>
<polygon fill="lightblue" stroke="black" points="2356.5,-13752.83 1947.5,-13752.83 1947.5,-13684.83 2356.5,-13684.83 2356.5,-13752.83"/>
<text text-anchor="middle" x="2152" y="-13737.63" font-family="Times,serif" font-size="14.00">MHA Layer 11</text>
<text text-anchor="middle" x="2152" y="-13722.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2152" y="-13707.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2152" y="-13692.63" font-family="Times,serif" font-size="14.00">GPU: 176</text>
</g>
<!-- layer_12_attn -->
<g id="node303" class="node">
<title>layer_12_attn</title>
<polygon fill="lightblue" stroke="black" points="3938.5,-10736.5 3529.5,-10736.5 3529.5,-10668.5 3938.5,-10668.5 3938.5,-10736.5"/>
<text text-anchor="middle" x="3734" y="-10721.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3734" y="-10706.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3734" y="-10691.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3734" y="-10676.3" font-family="Times,serif" font-size="14.00">GPU: 192</text>
</g>
<!-- layer_12_qkv&#45;&gt;layer_12_attn -->
<g id="edge506" class="edge">
<title>layer_12_qkv&#45;&gt;layer_12_attn</title>
<path fill="none" stroke="black" d="M3743,-10953.4C3743,-10953.4 3743,-10746.63 3743,-10746.63"/>
<polygon fill="black" stroke="black" points="3746.5,-10746.63 3743,-10736.63 3739.5,-10746.63 3746.5,-10746.63"/>
</g>
<!-- layer_12_proj -->
<g id="node304" class="node">
<title>layer_12_proj</title>
<polygon fill="lightblue" stroke="black" points="3953.5,-10451.5 3556.5,-10451.5 3556.5,-10383.5 3953.5,-10383.5 3953.5,-10451.5"/>
<text text-anchor="middle" x="3755" y="-10436.3" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3755" y="-10421.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3755" y="-10406.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3755" y="-10391.3" font-family="Times,serif" font-size="14.00">GPU: 192</text>
</g>
<!-- layer_12_attn&#45;&gt;layer_12_proj -->
<g id="edge507" class="edge">
<title>layer_12_attn&#45;&gt;layer_12_proj</title>
<path fill="none" stroke="black" d="M3747.5,-10668.4C3747.5,-10668.4 3747.5,-10461.63 3747.5,-10461.63"/>
<polygon fill="black" stroke="black" points="3751,-10461.63 3747.5,-10451.63 3744,-10461.63 3751,-10461.63"/>
</g>
<!-- layer_12_proj&#45;&gt;layer_12_add_norm1 -->
<g id="edge508" class="edge">
<title>layer_12_proj&#45;&gt;layer_12_add_norm1</title>
<path fill="none" stroke="black" d="M3778.25,-10383.4C3778.25,-10383.4 3778.25,-10176.63 3778.25,-10176.63"/>
<polygon fill="black" stroke="black" points="3781.75,-10176.63 3778.25,-10166.63 3774.75,-10176.63 3781.75,-10176.63"/>
</g>
<!-- layer_12_gate -->
<g id="node306" class="node">
<title>layer_12_gate</title>
<polygon fill="yellow" stroke="black" points="3710.73,-9881.5 3133.71,-9881.5 2985.27,-9745.5 3562.29,-9745.5 3710.73,-9881.5"/>
<text text-anchor="middle" x="3348" y="-9832.3" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3348" y="-9817.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3348" y="-9802.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3348" y="-9787.3" font-family="Times,serif" font-size="14.00">GPU: 192</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_gate -->
<g id="edge510" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_gate</title>
<path fill="none" stroke="black" d="M3656.93,-10098.36C3656.93,-10098.36 3656.93,-9891.62 3656.93,-9891.62"/>
<polygon fill="black" stroke="black" points="3660.43,-9891.62 3656.93,-9881.62 3653.43,-9891.62 3660.43,-9891.62"/>
</g>
<!-- layer_12_scatter -->
<g id="node307" class="node">
<title>layer_12_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3348" cy="-9466.42" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3348" y="-9485.22" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3348" y="-9470.22" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3348" y="-9455.22" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3348" y="-9440.22" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_scatter -->
<g id="edge511" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_scatter</title>
<path fill="none" stroke="black" d="M3807.68,-10098.15C3807.68,-9966.58 3807.68,-9502 3807.68,-9502 3807.68,-9502 3524.61,-9502 3524.61,-9502"/>
<polygon fill="black" stroke="black" points="3524.61,-9498.5 3514.61,-9502 3524.61,-9505.5 3524.61,-9498.5"/>
</g>
<!-- layer_12_add_norm2 -->
<g id="node325" class="node">
<title>layer_12_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4288,-8575.17 3926,-8575.17 3926,-8507.17 4288,-8507.17 4288,-8575.17"/>
<text text-anchor="middle" x="4107" y="-8559.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4107" y="-8544.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4107" y="-8529.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4107" y="-8514.97" font-family="Times,serif" font-size="14.00">GPU: 192</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_add_norm2 -->
<g id="edge546" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3952,-10098.15C3952,-10098.15 3952,-8585.46 3952,-8585.46"/>
<polygon fill="black" stroke="black" points="3955.5,-8585.46 3952,-8575.46 3948.5,-8585.46 3955.5,-8585.46"/>
<text text-anchor="middle" x="6320" y="-9299.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_scatter -->
<g id="edge512" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3348,-9745.34C3348,-9745.34 3348,-9524.6 3348,-9524.6"/>
<polygon fill="black" stroke="black" points="3351.5,-9524.6 3348,-9514.6 3344.5,-9524.6 3351.5,-9524.6"/>
<text text-anchor="middle" x="3391.5" y="-9626.3" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_12_expert_0 -->
<g id="node308" class="node">
<title>layer_12_expert_0</title>
<polygon fill="lightblue" stroke="black" points="349.5,-9187.33 26.5,-9187.33 26.5,-9119.33 349.5,-9119.33 349.5,-9187.33"/>
<text text-anchor="middle" x="188" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="188" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="188" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="188" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 192</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_0 -->
<g id="edge513" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_0</title>
<path fill="none" stroke="black" d="M3181.52,-9502C2538.34,-9502 251.5,-9502 251.5,-9502 251.5,-9502 251.5,-9197.4 251.5,-9197.4"/>
<polygon fill="black" stroke="black" points="255,-9197.4 251.5,-9187.4 248,-9197.4 255,-9197.4"/>
<text text-anchor="middle" x="410" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_192</text>
</g>
<!-- layer_12_expert_1 -->
<g id="node310" class="node">
<title>layer_12_expert_1</title>
<polygon fill="lightblue" stroke="black" points="744.5,-9187.33 421.5,-9187.33 421.5,-9119.33 744.5,-9119.33 744.5,-9187.33"/>
<text text-anchor="middle" x="583" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="583" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="583" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="583" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 193</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_1 -->
<g id="edge515" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_1</title>
<path fill="none" stroke="black" d="M3132.23,-9490C2487.53,-9490 620,-9490 620,-9490 620,-9490 620,-9197.47 620,-9197.47"/>
<polygon fill="black" stroke="black" points="623.5,-9197.47 620,-9187.47 616.5,-9197.47 623.5,-9197.47"/>
<text text-anchor="middle" x="753" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_193</text>
</g>
<!-- layer_12_expert_2 -->
<g id="node311" class="node">
<title>layer_12_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1139.5,-9187.33 816.5,-9187.33 816.5,-9119.33 1139.5,-9119.33 1139.5,-9187.33"/>
<text text-anchor="middle" x="978" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="978" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="978" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="978" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 194</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_2 -->
<g id="edge517" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_2</title>
<path fill="none" stroke="black" d="M3107.66,-9478C2511.95,-9478 1015,-9478 1015,-9478 1015,-9478 1015,-9197.46 1015,-9197.46"/>
<polygon fill="black" stroke="black" points="1018.5,-9197.46 1015,-9187.46 1011.5,-9197.46 1018.5,-9197.46"/>
<text text-anchor="middle" x="1044" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_194</text>
</g>
<!-- layer_12_expert_3 -->
<g id="node312" class="node">
<title>layer_12_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1534.5,-9187.33 1211.5,-9187.33 1211.5,-9119.33 1534.5,-9119.33 1534.5,-9187.33"/>
<text text-anchor="middle" x="1373" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1373" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1373" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1373" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 195</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_3 -->
<g id="edge519" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_3</title>
<path fill="none" stroke="black" d="M3100.52,-9466C2577.92,-9466 1409.5,-9466 1409.5,-9466 1409.5,-9466 1409.5,-9197.39 1409.5,-9197.39"/>
<polygon fill="black" stroke="black" points="1413,-9197.39 1409.5,-9187.39 1406,-9197.39 1413,-9197.39"/>
<text text-anchor="middle" x="1899" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_195</text>
</g>
<!-- layer_12_expert_4 -->
<g id="node313" class="node">
<title>layer_12_expert_4</title>
<polygon fill="lightblue" stroke="black" points="1929.5,-9187.33 1606.5,-9187.33 1606.5,-9119.33 1929.5,-9119.33 1929.5,-9187.33"/>
<text text-anchor="middle" x="1768" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1768" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1768" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1768" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 196</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_4 -->
<g id="edge521" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_4</title>
<path fill="none" stroke="black" d="M3108.89,-9454C2667.2,-9454 1768,-9454 1768,-9454 1768,-9454 1768,-9197.53 1768,-9197.53"/>
<polygon fill="black" stroke="black" points="1771.5,-9197.53 1768,-9187.53 1764.5,-9197.53 1771.5,-9197.53"/>
<text text-anchor="middle" x="2409" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_196</text>
</g>
<!-- layer_12_expert_5 -->
<g id="node314" class="node">
<title>layer_12_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2324.5,-9187.33 2001.5,-9187.33 2001.5,-9119.33 2324.5,-9119.33 2324.5,-9187.33"/>
<text text-anchor="middle" x="2163" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2163" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2163" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2163" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 197</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_5 -->
<g id="edge523" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_5</title>
<path fill="none" stroke="black" d="M3134.76,-9442C2802.77,-9442 2200,-9442 2200,-9442 2200,-9442 2200,-9197.58 2200,-9197.58"/>
<polygon fill="black" stroke="black" points="2203.5,-9197.58 2200,-9187.58 2196.5,-9197.58 2203.5,-9197.58"/>
<text text-anchor="middle" x="2746" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_197</text>
</g>
<!-- layer_12_expert_6 -->
<g id="node315" class="node">
<title>layer_12_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2719.5,-9187.33 2396.5,-9187.33 2396.5,-9119.33 2719.5,-9119.33 2719.5,-9187.33"/>
<text text-anchor="middle" x="2558" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2558" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2558" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2558" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 198</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_6 -->
<g id="edge525" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_6</title>
<path fill="none" stroke="black" d="M3186,-9430C2964.69,-9430 2595,-9430 2595,-9430 2595,-9430 2595,-9197.53 2595,-9197.53"/>
<polygon fill="black" stroke="black" points="2598.5,-9197.53 2595,-9187.53 2591.5,-9197.53 2598.5,-9197.53"/>
<text text-anchor="middle" x="2997" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_198</text>
</g>
<!-- layer_12_expert_7 -->
<g id="node316" class="node">
<title>layer_12_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3114.5,-9187.33 2791.5,-9187.33 2791.5,-9119.33 3114.5,-9119.33 3114.5,-9187.33"/>
<text text-anchor="middle" x="2953" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2953" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2953" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2953" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 199</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_7 -->
<g id="edge527" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_7</title>
<path fill="none" stroke="black" d="M3107.51,-9454.9C3107.51,-9454.9 3107.51,-9197.34 3107.51,-9197.34"/>
<polygon fill="black" stroke="black" points="3111.01,-9197.34 3107.51,-9187.34 3104.01,-9197.34 3111.01,-9197.34"/>
<text text-anchor="middle" x="3205" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_199</text>
</g>
<!-- layer_12_expert_8 -->
<g id="node317" class="node">
<title>layer_12_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3509.5,-9187.33 3186.5,-9187.33 3186.5,-9119.33 3509.5,-9119.33 3509.5,-9187.33"/>
<text text-anchor="middle" x="3348" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3348" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3348" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3348" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 200</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_8 -->
<g id="edge529" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_8</title>
<path fill="none" stroke="black" d="M3348,-9418.18C3348,-9418.18 3348,-9197.6 3348,-9197.6"/>
<polygon fill="black" stroke="black" points="3351.5,-9197.6 3348,-9187.6 3344.5,-9197.6 3351.5,-9197.6"/>
<text text-anchor="middle" x="3392" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_200</text>
</g>
<!-- layer_12_expert_9 -->
<g id="node318" class="node">
<title>layer_12_expert_9</title>
<polygon fill="lightblue" stroke="black" points="3904.5,-9187.33 3581.5,-9187.33 3581.5,-9119.33 3904.5,-9119.33 3904.5,-9187.33"/>
<text text-anchor="middle" x="3743" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3743" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3743" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3743" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 201</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_9 -->
<g id="edge531" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_9</title>
<path fill="none" stroke="black" d="M3588.49,-9454.9C3588.49,-9454.9 3588.49,-9197.34 3588.49,-9197.34"/>
<polygon fill="black" stroke="black" points="3591.99,-9197.34 3588.49,-9187.34 3584.99,-9197.34 3591.99,-9197.34"/>
<text text-anchor="middle" x="3672" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_201</text>
</g>
<!-- layer_12_expert_10 -->
<g id="node319" class="node">
<title>layer_12_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4299.5,-9187.33 3976.5,-9187.33 3976.5,-9119.33 4299.5,-9119.33 4299.5,-9187.33"/>
<text text-anchor="middle" x="4138" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4138" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4138" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4138" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 202</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_10 -->
<g id="edge533" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_10</title>
<path fill="none" stroke="black" d="M3510.04,-9430C3726.27,-9430 4082.25,-9430 4082.25,-9430 4082.25,-9430 4082.25,-9197.53 4082.25,-9197.53"/>
<polygon fill="black" stroke="black" points="4085.75,-9197.53 4082.25,-9187.53 4078.75,-9197.53 4085.75,-9197.53"/>
<text text-anchor="middle" x="3952" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_202</text>
</g>
<!-- layer_12_expert_11 -->
<g id="node320" class="node">
<title>layer_12_expert_11</title>
<polygon fill="lightblue" stroke="black" points="4694.5,-9187.33 4371.5,-9187.33 4371.5,-9119.33 4694.5,-9119.33 4694.5,-9187.33"/>
<text text-anchor="middle" x="4533" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4533" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4533" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4533" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 203</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_11 -->
<g id="edge535" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_11</title>
<path fill="none" stroke="black" d="M3561.45,-9442C3872.53,-9442 4413.83,-9442 4413.83,-9442 4413.83,-9442 4413.83,-9197.58 4413.83,-9197.58"/>
<polygon fill="black" stroke="black" points="4417.33,-9197.58 4413.83,-9187.58 4410.33,-9197.58 4417.33,-9197.58"/>
<text text-anchor="middle" x="4347" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_203</text>
</g>
<!-- layer_12_expert_12 -->
<g id="node321" class="node">
<title>layer_12_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5089.5,-9187.33 4766.5,-9187.33 4766.5,-9119.33 5089.5,-9119.33 5089.5,-9187.33"/>
<text text-anchor="middle" x="4928" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="4928" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4928" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4928" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 204</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_12 -->
<g id="edge537" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_12</title>
<path fill="none" stroke="black" d="M3587.35,-9454C3998.46,-9454 4795,-9454 4795,-9454 4795,-9454 4795,-9197.53 4795,-9197.53"/>
<polygon fill="black" stroke="black" points="4798.5,-9197.53 4795,-9187.53 4791.5,-9197.53 4798.5,-9197.53"/>
<text text-anchor="middle" x="4742" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_204</text>
</g>
<!-- layer_12_expert_13 -->
<g id="node322" class="node">
<title>layer_12_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5484.5,-9187.33 5161.5,-9187.33 5161.5,-9119.33 5484.5,-9119.33 5484.5,-9187.33"/>
<text text-anchor="middle" x="5323" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5323" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5323" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5323" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 205</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_13 -->
<g id="edge539" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_13</title>
<path fill="none" stroke="black" d="M3595.94,-9466C4098.52,-9466 5190,-9466 5190,-9466 5190,-9466 5190,-9197.39 5190,-9197.39"/>
<polygon fill="black" stroke="black" points="5193.5,-9197.39 5190,-9187.39 5186.5,-9197.39 5193.5,-9197.39"/>
<text text-anchor="middle" x="5137" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_205</text>
</g>
<!-- layer_12_expert_14 -->
<g id="node323" class="node">
<title>layer_12_expert_14</title>
<polygon fill="lightblue" stroke="black" points="5879.5,-9187.33 5556.5,-9187.33 5556.5,-9119.33 5879.5,-9119.33 5879.5,-9187.33"/>
<text text-anchor="middle" x="5718" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5718" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5718" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5718" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 206</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_14 -->
<g id="edge541" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_14</title>
<path fill="none" stroke="black" d="M3588.46,-9478C4166.22,-9478 5585,-9478 5585,-9478 5585,-9478 5585,-9197.46 5585,-9197.46"/>
<polygon fill="black" stroke="black" points="5588.5,-9197.46 5585,-9187.46 5581.5,-9197.46 5588.5,-9197.46"/>
<text text-anchor="middle" x="5532" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_206</text>
</g>
<!-- layer_12_expert_15 -->
<g id="node324" class="node">
<title>layer_12_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6274.5,-9187.33 5951.5,-9187.33 5951.5,-9119.33 6274.5,-9119.33 6274.5,-9187.33"/>
<text text-anchor="middle" x="6113" y="-9172.13" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6113" y="-9157.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6113" y="-9142.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6113" y="-9127.13" font-family="Times,serif" font-size="14.00">GPU: 207</text>
</g>
<!-- layer_12_scatter&#45;&gt;layer_12_expert_15 -->
<g id="edge543" class="edge">
<title>layer_12_scatter&#45;&gt;layer_12_expert_15</title>
<path fill="none" stroke="black" d="M3563.95,-9490C4193.05,-9490 5980,-9490 5980,-9490 5980,-9490 5980,-9197.47 5980,-9197.47"/>
<polygon fill="black" stroke="black" points="5983.5,-9197.47 5980,-9187.47 5976.5,-9197.47 5983.5,-9197.47"/>
<text text-anchor="middle" x="5927" y="-9299.13" font-family="Times,serif" font-size="14.00">to_GPU_207</text>
</g>
<!-- layer_12_gather -->
<g id="node309" class="node">
<title>layer_12_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3348" cy="-8840.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3348" y="-8859.05" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3348" y="-8844.05" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3348" y="-8829.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3348" y="-8814.05" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_12_expert_0&#45;&gt;layer_12_gather -->
<g id="edge514" class="edge">
<title>layer_12_expert_0&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M344.5,-9119.2C344.5,-9031.3 344.5,-8804 344.5,-8804 344.5,-8804 3169.81,-8804 3169.81,-8804"/>
<polygon fill="black" stroke="black" points="3169.81,-8807.5 3179.81,-8804 3169.81,-8800.5 3169.81,-8807.5"/>
<text text-anchor="middle" x="453.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_192</text>
</g>
<!-- layer_12_gather&#45;&gt;layer_12_add_norm2 -->
<g id="edge545" class="edge">
<title>layer_12_gather&#45;&gt;layer_12_add_norm2</title>
<path fill="none" stroke="black" d="M3516.57,-8804C3691.25,-8804 3939,-8804 3939,-8804 3939,-8804 3939,-8585.26 3939,-8585.26"/>
<polygon fill="black" stroke="black" points="3942.5,-8585.26 3939,-8575.26 3935.5,-8585.26 3942.5,-8585.26"/>
</g>
<!-- layer_12_expert_1&#45;&gt;layer_12_gather -->
<g id="edge516" class="edge">
<title>layer_12_expert_1&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M739.5,-9119.13C739.5,-9033.37 739.5,-8816 739.5,-8816 739.5,-8816 3116.73,-8816 3116.73,-8816"/>
<polygon fill="black" stroke="black" points="3116.73,-8819.5 3126.73,-8816 3116.73,-8812.5 3116.73,-8819.5"/>
<text text-anchor="middle" x="850.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_193</text>
</g>
<!-- layer_12_expert_2&#45;&gt;layer_12_gather -->
<g id="edge518" class="edge">
<title>layer_12_expert_2&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M1134.5,-9119.13C1134.5,-9035.6 1134.5,-8828 1134.5,-8828 1134.5,-8828 3090.26,-8828 3090.26,-8828"/>
<polygon fill="black" stroke="black" points="3090.26,-8831.5 3100.26,-8828 3090.26,-8824.5 3090.26,-8831.5"/>
<text text-anchor="middle" x="1248.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_194</text>
</g>
<!-- layer_12_expert_3&#45;&gt;layer_12_gather -->
<g id="edge520" class="edge">
<title>layer_12_expert_3&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M1509.5,-9119.2C1509.5,-9037.99 1509.5,-8840 1509.5,-8840 1509.5,-8840 3081.88,-8840 3081.88,-8840"/>
<polygon fill="black" stroke="black" points="3081.88,-8843.5 3091.88,-8840 3081.88,-8836.5 3081.88,-8843.5"/>
<text text-anchor="middle" x="1650.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_195</text>
</g>
<!-- layer_12_expert_4&#45;&gt;layer_12_gather -->
<g id="edge522" class="edge">
<title>layer_12_expert_4&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M1784.5,-9119.06C1784.5,-9040.08 1784.5,-8852 1784.5,-8852 1784.5,-8852 3089.39,-8852 3089.39,-8852"/>
<polygon fill="black" stroke="black" points="3089.39,-8855.5 3099.39,-8852 3089.39,-8848.5 3089.39,-8855.5"/>
<text text-anchor="middle" x="2058.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_196</text>
</g>
<!-- layer_12_expert_5&#45;&gt;layer_12_gather -->
<g id="edge524" class="edge">
<title>layer_12_expert_5&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M2319.5,-9119.29C2319.5,-9042.81 2319.5,-8864 2319.5,-8864 2319.5,-8864 3115.15,-8864 3115.15,-8864"/>
<polygon fill="black" stroke="black" points="3115.15,-8867.5 3125.15,-8864 3115.15,-8860.5 3115.15,-8867.5"/>
<text text-anchor="middle" x="2480.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_197</text>
</g>
<!-- layer_12_expert_6&#45;&gt;layer_12_gather -->
<g id="edge526" class="edge">
<title>layer_12_expert_6&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M2714.5,-9119.33C2714.5,-9045.27 2714.5,-8876 2714.5,-8876 2714.5,-8876 3166.57,-8876 3166.57,-8876"/>
<polygon fill="black" stroke="black" points="3166.57,-8879.5 3176.57,-8876 3166.57,-8872.5 3166.57,-8879.5"/>
<text text-anchor="middle" x="2769.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_198</text>
</g>
<!-- layer_12_expert_7&#45;&gt;layer_12_gather -->
<g id="edge528" class="edge">
<title>layer_12_expert_7&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M3103.26,-9119.23C3103.26,-9119.23 3103.26,-8864.51 3103.26,-8864.51"/>
<polygon fill="black" stroke="black" points="3106.76,-8864.51 3103.26,-8854.51 3099.76,-8864.51 3106.76,-8864.51"/>
<text text-anchor="middle" x="3112.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_199</text>
</g>
<!-- layer_12_expert_8&#45;&gt;layer_12_gather -->
<g id="edge530" class="edge">
<title>layer_12_expert_8&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M3348,-9119.23C3348,-9119.23 3348,-8898.34 3348,-8898.34"/>
<polygon fill="black" stroke="black" points="3351.5,-8898.34 3348,-8888.34 3344.5,-8898.34 3351.5,-8898.34"/>
<text text-anchor="middle" x="3401.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_200</text>
</g>
<!-- layer_12_expert_9&#45;&gt;layer_12_gather -->
<g id="edge532" class="edge">
<title>layer_12_expert_9&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M3592.74,-9119.23C3592.74,-9119.23 3592.74,-8864.51 3592.74,-8864.51"/>
<polygon fill="black" stroke="black" points="3596.24,-8864.51 3592.74,-8854.51 3589.24,-8864.51 3596.24,-8864.51"/>
<text text-anchor="middle" x="3690.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_201</text>
</g>
<!-- layer_12_expert_10&#45;&gt;layer_12_gather -->
<g id="edge534" class="edge">
<title>layer_12_expert_10&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M4132.25,-9119.33C4132.25,-9045.27 4132.25,-8876 4132.25,-8876 4132.25,-8876 3529.62,-8876 3529.62,-8876"/>
<polygon fill="black" stroke="black" points="3529.62,-8872.5 3519.62,-8876 3529.62,-8879.5 3529.62,-8872.5"/>
<text text-anchor="middle" x="4033.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_202</text>
</g>
<!-- layer_12_expert_11&#45;&gt;layer_12_gather -->
<g id="edge536" class="edge">
<title>layer_12_expert_11&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M4508,-9119.29C4508,-9042.81 4508,-8864 4508,-8864 4508,-8864 3580.63,-8864 3580.63,-8864"/>
<polygon fill="black" stroke="black" points="3580.63,-8860.5 3570.63,-8864 3580.63,-8867.5 3580.63,-8860.5"/>
<text text-anchor="middle" x="4322.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_203</text>
</g>
<!-- layer_12_expert_12&#45;&gt;layer_12_gather -->
<g id="edge538" class="edge">
<title>layer_12_expert_12&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M4903,-9119.06C4903,-9040.08 4903,-8852 4903,-8852 4903,-8852 3606.54,-8852 3606.54,-8852"/>
<polygon fill="black" stroke="black" points="3606.54,-8848.5 3596.54,-8852 3606.54,-8855.5 3606.54,-8848.5"/>
<text text-anchor="middle" x="4664.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_204</text>
</g>
<!-- layer_12_expert_13&#45;&gt;layer_12_gather -->
<g id="edge540" class="edge">
<title>layer_12_expert_13&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M5298,-9119.2C5298,-9037.99 5298,-8840 5298,-8840 5298,-8840 3614.18,-8840 3614.18,-8840"/>
<polygon fill="black" stroke="black" points="3614.18,-8836.5 3604.18,-8840 3614.18,-8843.5 3614.18,-8836.5"/>
<text text-anchor="middle" x="5033.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_205</text>
</g>
<!-- layer_12_expert_14&#45;&gt;layer_12_gather -->
<g id="edge542" class="edge">
<title>layer_12_expert_14&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M5693,-9119.13C5693,-9035.6 5693,-8828 5693,-8828 5693,-8828 3605.63,-8828 3605.63,-8828"/>
<polygon fill="black" stroke="black" points="3605.63,-8824.5 3595.63,-8828 3605.63,-8831.5 3605.63,-8824.5"/>
<text text-anchor="middle" x="5415.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_206</text>
</g>
<!-- layer_12_expert_15&#45;&gt;layer_12_gather -->
<g id="edge544" class="edge">
<title>layer_12_expert_15&#45;&gt;layer_12_gather</title>
<path fill="none" stroke="black" d="M6088,-9119.13C6088,-9033.37 6088,-8816 6088,-8816 6088,-8816 3579.33,-8816 3579.33,-8816"/>
<polygon fill="black" stroke="black" points="3579.33,-8812.5 3569.33,-8816 3579.33,-8819.5 3579.33,-8812.5"/>
<text text-anchor="middle" x="5803.5" y="-9000.13" font-family="Times,serif" font-size="14.00">from_GPU_207</text>
</g>
<!-- layer_13_qkv -->
<g id="node327" class="node">
<title>layer_13_qkv</title>
<polygon fill="lightblue" stroke="black" points="4082.5,-8290.17 3673.5,-8290.17 3673.5,-8222.17 4082.5,-8222.17 4082.5,-8290.17"/>
<text text-anchor="middle" x="3878" y="-8274.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3878" y="-8259.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3878" y="-8244.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3878" y="-8229.97" font-family="Times,serif" font-size="14.00">GPU: 208</text>
</g>
<!-- layer_12_add_norm2&#45;&gt;layer_13_qkv -->
<g id="edge547" class="edge">
<title>layer_12_add_norm2&#45;&gt;layer_13_qkv</title>
<path fill="none" stroke="black" d="M4004.25,-8507.07C4004.25,-8507.07 4004.25,-8300.3 4004.25,-8300.3"/>
<polygon fill="black" stroke="black" points="4007.75,-8300.3 4004.25,-8290.3 4000.75,-8300.3 4007.75,-8300.3"/>
</g>
<!-- layer_13_add_norm1 -->
<g id="node330" class="node">
<title>layer_13_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4310,-7435.17 3948,-7435.17 3948,-7367.17 4310,-7367.17 4310,-7435.17"/>
<text text-anchor="middle" x="4129" y="-7419.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4129" y="-7404.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4129" y="-7389.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4129" y="-7374.97" font-family="Times,serif" font-size="14.00">GPU: 208</text>
</g>
<!-- layer_12_add_norm2&#45;&gt;layer_13_add_norm1 -->
<g id="edge551" class="edge">
<title>layer_12_add_norm2&#45;&gt;layer_13_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4188.25,-8507.05C4188.25,-8507.05 4188.25,-7445.43 4188.25,-7445.43"/>
<polygon fill="black" stroke="black" points="4191.75,-7445.43 4188.25,-7435.43 4184.75,-7445.43 4191.75,-7445.43"/>
<text text-anchor="middle" x="4238" y="-7967.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_12_mha -->
<g id="node326" class="node">
<title>layer_12_mha</title>
<polygon fill="lightblue" stroke="black" points="1942.5,-11021.5 1533.5,-11021.5 1533.5,-10953.5 1942.5,-10953.5 1942.5,-11021.5"/>
<text text-anchor="middle" x="1738" y="-11006.3" font-family="Times,serif" font-size="14.00">MHA Layer 12</text>
<text text-anchor="middle" x="1738" y="-10991.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1738" y="-10976.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1738" y="-10961.3" font-family="Times,serif" font-size="14.00">GPU: 192</text>
</g>
<!-- layer_13_attn -->
<g id="node328" class="node">
<title>layer_13_attn</title>
<polygon fill="lightblue" stroke="black" points="4064.5,-8005.17 3655.5,-8005.17 3655.5,-7937.17 4064.5,-7937.17 4064.5,-8005.17"/>
<text text-anchor="middle" x="3860" y="-7989.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3860" y="-7974.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3860" y="-7959.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3860" y="-7944.97" font-family="Times,serif" font-size="14.00">GPU: 208</text>
</g>
<!-- layer_13_qkv&#45;&gt;layer_13_attn -->
<g id="edge548" class="edge">
<title>layer_13_qkv&#45;&gt;layer_13_attn</title>
<path fill="none" stroke="black" d="M3869,-8222.07C3869,-8222.07 3869,-8015.3 3869,-8015.3"/>
<polygon fill="black" stroke="black" points="3872.5,-8015.3 3869,-8005.3 3865.5,-8015.3 3872.5,-8015.3"/>
</g>
<!-- layer_13_proj -->
<g id="node329" class="node">
<title>layer_13_proj</title>
<polygon fill="lightblue" stroke="black" points="4088.5,-7720.17 3691.5,-7720.17 3691.5,-7652.17 4088.5,-7652.17 4088.5,-7720.17"/>
<text text-anchor="middle" x="3890" y="-7704.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3890" y="-7689.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3890" y="-7674.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3890" y="-7659.97" font-family="Times,serif" font-size="14.00">GPU: 208</text>
</g>
<!-- layer_13_attn&#45;&gt;layer_13_proj -->
<g id="edge549" class="edge">
<title>layer_13_attn&#45;&gt;layer_13_proj</title>
<path fill="none" stroke="black" d="M3878,-7937.07C3878,-7937.07 3878,-7730.3 3878,-7730.3"/>
<polygon fill="black" stroke="black" points="3881.5,-7730.3 3878,-7720.3 3874.5,-7730.3 3881.5,-7730.3"/>
</g>
<!-- layer_13_proj&#45;&gt;layer_13_add_norm1 -->
<g id="edge550" class="edge">
<title>layer_13_proj&#45;&gt;layer_13_add_norm1</title>
<path fill="none" stroke="black" d="M4018.25,-7652.07C4018.25,-7652.07 4018.25,-7445.3 4018.25,-7445.3"/>
<polygon fill="black" stroke="black" points="4021.75,-7445.3 4018.25,-7435.3 4014.75,-7445.3 4021.75,-7445.3"/>
</g>
<!-- layer_13_gate -->
<g id="node331" class="node">
<title>layer_13_gate</title>
<polygon fill="yellow" stroke="black" points="4055.73,-7150.17 3478.71,-7150.17 3330.27,-7014.17 3907.29,-7014.17 4055.73,-7150.17"/>
<text text-anchor="middle" x="3693" y="-7100.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3693" y="-7085.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3693" y="-7070.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3693" y="-7055.97" font-family="Times,serif" font-size="14.00">GPU: 208</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_gate -->
<g id="edge552" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_gate</title>
<path fill="none" stroke="black" d="M4001.93,-7367.03C4001.93,-7367.03 4001.93,-7160.29 4001.93,-7160.29"/>
<polygon fill="black" stroke="black" points="4005.43,-7160.29 4001.93,-7150.29 3998.43,-7160.29 4005.43,-7160.29"/>
</g>
<!-- layer_13_scatter -->
<g id="node332" class="node">
<title>layer_13_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3693" cy="-6735.08" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3693" y="-6753.88" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3693" y="-6738.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3693" y="-6723.88" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3693" y="-6708.88" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_scatter -->
<g id="edge553" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_scatter</title>
<path fill="none" stroke="black" d="M4152.68,-7366.84C4152.68,-7235.34 4152.68,-6771 4152.68,-6771 4152.68,-6771 3867.66,-6771 3867.66,-6771"/>
<polygon fill="black" stroke="black" points="3867.66,-6767.5 3857.66,-6771 3867.66,-6774.5 3867.66,-6767.5"/>
</g>
<!-- layer_13_add_norm2 -->
<g id="node350" class="node">
<title>layer_13_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="3935,-5843.83 3573,-5843.83 3573,-5775.83 3935,-5775.83 3935,-5843.83"/>
<text text-anchor="middle" x="3754" y="-5828.63" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3754" y="-5813.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3754" y="-5798.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3754" y="-5783.63" font-family="Times,serif" font-size="14.00">GPU: 208</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_add_norm2 -->
<g id="edge588" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4269.5,-7366.8C4269.5,-7135.01 4269.5,-5809 4269.5,-5809 4269.5,-5809 3945.02,-5809 3945.02,-5809"/>
<polygon fill="black" stroke="black" points="3945.02,-5805.5 3935.02,-5809 3945.02,-5812.5 3945.02,-5805.5"/>
<text text-anchor="middle" x="6665" y="-6567.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_scatter -->
<g id="edge554" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3693,-7014.01C3693,-7014.01 3693,-6793.27 3693,-6793.27"/>
<polygon fill="black" stroke="black" points="3696.5,-6793.27 3693,-6783.27 3689.5,-6793.27 3696.5,-6793.27"/>
<text text-anchor="middle" x="3736.5" y="-6894.97" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_13_expert_0 -->
<g id="node333" class="node">
<title>layer_13_expert_0</title>
<polygon fill="lightblue" stroke="black" points="694.5,-6456 371.5,-6456 371.5,-6388 694.5,-6388 694.5,-6456"/>
<text text-anchor="middle" x="533" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="533" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="533" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="533" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 208</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_0 -->
<g id="edge555" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_0</title>
<path fill="none" stroke="black" d="M3528.31,-6771C2882.49,-6771 558,-6771 558,-6771 558,-6771 558,-6466.1 558,-6466.1"/>
<polygon fill="black" stroke="black" points="561.5,-6466.1 558,-6456.1 554.5,-6466.1 561.5,-6466.1"/>
<text text-anchor="middle" x="818" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_208</text>
</g>
<!-- layer_13_expert_1 -->
<g id="node335" class="node">
<title>layer_13_expert_1</title>
<polygon fill="lightblue" stroke="black" points="1089.5,-6456 766.5,-6456 766.5,-6388 1089.5,-6388 1089.5,-6456"/>
<text text-anchor="middle" x="928" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="928" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="928" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="928" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 209</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_1 -->
<g id="edge557" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_1</title>
<path fill="none" stroke="black" d="M3478.28,-6759C2832.62,-6759 953,-6759 953,-6759 953,-6759 953,-6466.17 953,-6466.17"/>
<polygon fill="black" stroke="black" points="956.5,-6466.17 953,-6456.17 949.5,-6466.17 956.5,-6466.17"/>
<text text-anchor="middle" x="1098" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_209</text>
</g>
<!-- layer_13_expert_2 -->
<g id="node336" class="node">
<title>layer_13_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1484.5,-6456 1161.5,-6456 1161.5,-6388 1484.5,-6388 1484.5,-6456"/>
<text text-anchor="middle" x="1323" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1323" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1323" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1323" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 210</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_2 -->
<g id="edge559" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_2</title>
<path fill="none" stroke="black" d="M3453.06,-6747C2855.4,-6747 1348,-6747 1348,-6747 1348,-6747 1348,-6466.17 1348,-6466.17"/>
<polygon fill="black" stroke="black" points="1351.5,-6466.17 1348,-6456.17 1344.5,-6466.17 1351.5,-6466.17"/>
<text text-anchor="middle" x="1389" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_210</text>
</g>
<!-- layer_13_expert_3 -->
<g id="node337" class="node">
<title>layer_13_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1879.5,-6456 1556.5,-6456 1556.5,-6388 1879.5,-6388 1879.5,-6456"/>
<text text-anchor="middle" x="1718" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1718" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1718" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1718" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 211</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_3 -->
<g id="edge561" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_3</title>
<path fill="none" stroke="black" d="M3445.17,-6735C2923.44,-6735 1759.5,-6735 1759.5,-6735 1759.5,-6735 1759.5,-6466.09 1759.5,-6466.09"/>
<polygon fill="black" stroke="black" points="1763,-6466.09 1759.5,-6456.09 1756,-6466.09 1763,-6466.09"/>
<text text-anchor="middle" x="2244" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_211</text>
</g>
<!-- layer_13_expert_4 -->
<g id="node338" class="node">
<title>layer_13_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2274.5,-6456 1951.5,-6456 1951.5,-6388 2274.5,-6388 2274.5,-6456"/>
<text text-anchor="middle" x="2113" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2113" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2113" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2113" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 212</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_4 -->
<g id="edge563" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_4</title>
<path fill="none" stroke="black" d="M3453.28,-6723C3022.41,-6723 2161.5,-6723 2161.5,-6723 2161.5,-6723 2161.5,-6466.23 2161.5,-6466.23"/>
<polygon fill="black" stroke="black" points="2165,-6466.23 2161.5,-6456.23 2158,-6466.23 2165,-6466.23"/>
<text text-anchor="middle" x="2754" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_212</text>
</g>
<!-- layer_13_expert_5 -->
<g id="node339" class="node">
<title>layer_13_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2669.5,-6456 2346.5,-6456 2346.5,-6388 2669.5,-6388 2669.5,-6456"/>
<text text-anchor="middle" x="2508" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2508" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2508" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2508" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 213</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_5 -->
<g id="edge565" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_5</title>
<path fill="none" stroke="black" d="M3478.55,-6711C3143.3,-6711 2533,-6711 2533,-6711 2533,-6711 2533,-6466 2533,-6466"/>
<polygon fill="black" stroke="black" points="2536.5,-6466 2533,-6456 2529.5,-6466 2536.5,-6466"/>
<text text-anchor="middle" x="3091" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_213</text>
</g>
<!-- layer_13_expert_6 -->
<g id="node340" class="node">
<title>layer_13_expert_6</title>
<polygon fill="lightblue" stroke="black" points="3064.5,-6456 2741.5,-6456 2741.5,-6388 3064.5,-6388 3064.5,-6456"/>
<text text-anchor="middle" x="2903" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2903" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2903" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2903" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 214</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_6 -->
<g id="edge567" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_6</title>
<path fill="none" stroke="black" d="M3529.36,-6699C3304.63,-6699 2928,-6699 2928,-6699 2928,-6699 2928,-6466.24 2928,-6466.24"/>
<polygon fill="black" stroke="black" points="2931.5,-6466.24 2928,-6456.24 2924.5,-6466.24 2931.5,-6466.24"/>
<text text-anchor="middle" x="3342" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_214</text>
</g>
<!-- layer_13_expert_7 -->
<g id="node341" class="node">
<title>layer_13_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3459.5,-6456 3136.5,-6456 3136.5,-6388 3459.5,-6388 3459.5,-6456"/>
<text text-anchor="middle" x="3298" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3298" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3298" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3298" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 215</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_7 -->
<g id="edge569" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_7</title>
<path fill="none" stroke="black" d="M3452.51,-6723.57C3452.51,-6723.57 3452.51,-6466.01 3452.51,-6466.01"/>
<polygon fill="black" stroke="black" points="3456.01,-6466.01 3452.51,-6456.01 3449.01,-6466.01 3456.01,-6466.01"/>
<text text-anchor="middle" x="3550" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_215</text>
</g>
<!-- layer_13_expert_8 -->
<g id="node342" class="node">
<title>layer_13_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3854.5,-6456 3531.5,-6456 3531.5,-6388 3854.5,-6388 3854.5,-6456"/>
<text text-anchor="middle" x="3693" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3693" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3693" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3693" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 216</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_8 -->
<g id="edge571" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_8</title>
<path fill="none" stroke="black" d="M3693,-6686.85C3693,-6686.85 3693,-6466.26 3693,-6466.26"/>
<polygon fill="black" stroke="black" points="3696.5,-6466.26 3693,-6456.26 3689.5,-6466.26 3696.5,-6466.26"/>
<text text-anchor="middle" x="3737" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_216</text>
</g>
<!-- layer_13_expert_9 -->
<g id="node343" class="node">
<title>layer_13_expert_9</title>
<polygon fill="lightblue" stroke="black" points="4249.5,-6456 3926.5,-6456 3926.5,-6388 4249.5,-6388 4249.5,-6456"/>
<text text-anchor="middle" x="4088" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4088" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4088" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4088" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 217</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_9 -->
<g id="edge573" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_9</title>
<path fill="none" stroke="black" d="M3933.49,-6723.57C3933.49,-6723.57 3933.49,-6466.01 3933.49,-6466.01"/>
<polygon fill="black" stroke="black" points="3936.99,-6466.01 3933.49,-6456.01 3929.99,-6466.01 3936.99,-6466.01"/>
<text text-anchor="middle" x="4017" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_217</text>
</g>
<!-- layer_13_expert_10 -->
<g id="node344" class="node">
<title>layer_13_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4644.5,-6456 4321.5,-6456 4321.5,-6388 4644.5,-6388 4644.5,-6456"/>
<text text-anchor="middle" x="4483" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4483" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4483" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4483" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 218</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_10 -->
<g id="edge575" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_10</title>
<path fill="none" stroke="black" d="M3856.64,-6699C4050.21,-6699 4346.5,-6699 4346.5,-6699 4346.5,-6699 4346.5,-6466.24 4346.5,-6466.24"/>
<polygon fill="black" stroke="black" points="4350,-6466.24 4346.5,-6456.24 4343,-6466.24 4350,-6466.24"/>
<text text-anchor="middle" x="4297" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_218</text>
</g>
<!-- layer_13_expert_11 -->
<g id="node345" class="node">
<title>layer_13_expert_11</title>
<polygon fill="lightblue" stroke="black" points="5039.5,-6456 4716.5,-6456 4716.5,-6388 5039.5,-6388 5039.5,-6456"/>
<text text-anchor="middle" x="4878" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4878" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4878" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4878" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 219</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_11 -->
<g id="edge577" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_11</title>
<path fill="none" stroke="black" d="M3907.39,-6711C4214.1,-6711 4741.5,-6711 4741.5,-6711 4741.5,-6711 4741.5,-6466 4741.5,-6466"/>
<polygon fill="black" stroke="black" points="4745,-6466 4741.5,-6456 4738,-6466 4745,-6466"/>
<text text-anchor="middle" x="4577" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_219</text>
</g>
<!-- layer_13_expert_12 -->
<g id="node346" class="node">
<title>layer_13_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5434.5,-6456 5111.5,-6456 5111.5,-6388 5434.5,-6388 5434.5,-6456"/>
<text text-anchor="middle" x="5273" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5273" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5273" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5273" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 220</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_12 -->
<g id="edge579" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_12</title>
<path fill="none" stroke="black" d="M3932.58,-6723C4342.93,-6723 5136.5,-6723 5136.5,-6723 5136.5,-6723 5136.5,-6466.23 5136.5,-6466.23"/>
<polygon fill="black" stroke="black" points="5140,-6466.23 5136.5,-6456.23 5133,-6466.23 5140,-6466.23"/>
<text text-anchor="middle" x="5030" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_220</text>
</g>
<!-- layer_13_expert_13 -->
<g id="node347" class="node">
<title>layer_13_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5829.5,-6456 5506.5,-6456 5506.5,-6388 5829.5,-6388 5829.5,-6456"/>
<text text-anchor="middle" x="5668" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5668" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5668" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5668" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 221</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_13 -->
<g id="edge581" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_13</title>
<path fill="none" stroke="black" d="M3940.95,-6735C4442.78,-6735 5531.5,-6735 5531.5,-6735 5531.5,-6735 5531.5,-6466.09 5531.5,-6466.09"/>
<polygon fill="black" stroke="black" points="5535,-6466.09 5531.5,-6456.09 5528,-6466.09 5535,-6466.09"/>
<text text-anchor="middle" x="5597" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_221</text>
</g>
<!-- layer_13_expert_14 -->
<g id="node348" class="node">
<title>layer_13_expert_14</title>
<polygon fill="lightblue" stroke="black" points="6224.5,-6456 5901.5,-6456 5901.5,-6388 6224.5,-6388 6224.5,-6456"/>
<text text-anchor="middle" x="6063" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="6063" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6063" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6063" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 222</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_14 -->
<g id="edge583" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_14</title>
<path fill="none" stroke="black" d="M3932.82,-6747C4509.51,-6747 5926.5,-6747 5926.5,-6747 5926.5,-6747 5926.5,-6466.17 5926.5,-6466.17"/>
<polygon fill="black" stroke="black" points="5930,-6466.17 5926.5,-6456.17 5923,-6466.17 5930,-6466.17"/>
<text text-anchor="middle" x="5935" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_222</text>
</g>
<!-- layer_13_expert_15 -->
<g id="node349" class="node">
<title>layer_13_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6619.5,-6456 6296.5,-6456 6296.5,-6388 6619.5,-6388 6619.5,-6456"/>
<text text-anchor="middle" x="6458" y="-6440.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6458" y="-6425.8" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6458" y="-6410.8" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6458" y="-6395.8" font-family="Times,serif" font-size="14.00">GPU: 223</text>
</g>
<!-- layer_13_scatter&#45;&gt;layer_13_expert_15 -->
<g id="edge585" class="edge">
<title>layer_13_scatter&#45;&gt;layer_13_expert_15</title>
<path fill="none" stroke="black" d="M3907.9,-6759C4535.66,-6759 6322.5,-6759 6322.5,-6759 6322.5,-6759 6322.5,-6466.17 6322.5,-6466.17"/>
<polygon fill="black" stroke="black" points="6326,-6466.17 6322.5,-6456.17 6319,-6466.17 6326,-6466.17"/>
<text text-anchor="middle" x="6387" y="-6567.8" font-family="Times,serif" font-size="14.00">to_GPU_223</text>
</g>
<!-- layer_13_gather -->
<g id="node334" class="node">
<title>layer_13_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3693" cy="-6108.92" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3693" y="-6127.72" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3693" y="-6112.72" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3693" y="-6097.72" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3693" y="-6082.72" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_13_expert_0&#45;&gt;layer_13_gather -->
<g id="edge556" class="edge">
<title>layer_13_expert_0&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M553,-6387.8C553,-6299.73 553,-6072 553,-6072 553,-6072 3518.88,-6072 3518.88,-6072"/>
<polygon fill="black" stroke="black" points="3518.88,-6075.5 3528.88,-6072 3518.88,-6068.5 3518.88,-6075.5"/>
<text text-anchor="middle" x="798.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_208</text>
</g>
<!-- layer_13_gather&#45;&gt;layer_13_add_norm2 -->
<g id="edge587" class="edge">
<title>layer_13_gather&#45;&gt;layer_13_add_norm2</title>
<path fill="none" stroke="black" d="M3754,-6062.18C3754,-6062.18 3754,-5854.14 3754,-5854.14"/>
<polygon fill="black" stroke="black" points="3757.5,-5854.14 3754,-5844.14 3750.5,-5854.14 3757.5,-5854.14"/>
</g>
<!-- layer_13_expert_1&#45;&gt;layer_13_gather -->
<g id="edge558" class="edge">
<title>layer_13_expert_1&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M948,-6387.73C948,-6301.8 948,-6084 948,-6084 948,-6084 3463.87,-6084 3463.87,-6084"/>
<polygon fill="black" stroke="black" points="3463.87,-6087.5 3473.87,-6084 3463.87,-6080.5 3463.87,-6087.5"/>
<text text-anchor="middle" x="1195.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_209</text>
</g>
<!-- layer_13_expert_2&#45;&gt;layer_13_gather -->
<g id="edge560" class="edge">
<title>layer_13_expert_2&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M1379.5,-6387.73C1379.5,-6304.03 1379.5,-6096 1379.5,-6096 1379.5,-6096 3436.24,-6096 3436.24,-6096"/>
<polygon fill="black" stroke="black" points="3436.24,-6099.5 3446.24,-6096 3436.24,-6092.5 3436.24,-6099.5"/>
<text text-anchor="middle" x="1593.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_210</text>
</g>
<!-- layer_13_expert_3&#45;&gt;layer_13_gather -->
<g id="edge562" class="edge">
<title>layer_13_expert_3&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M1781.5,-6387.8C1781.5,-6306.42 1781.5,-6108 1781.5,-6108 1781.5,-6108 3426.69,-6108 3426.69,-6108"/>
<polygon fill="black" stroke="black" points="3426.69,-6111.5 3436.69,-6108 3426.69,-6104.5 3426.69,-6111.5"/>
<text text-anchor="middle" x="1995.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_211</text>
</g>
<!-- layer_13_expert_4&#45;&gt;layer_13_gather -->
<g id="edge564" class="edge">
<title>layer_13_expert_4&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M2133,-6387.94C2133,-6308.96 2133,-6120 2133,-6120 2133,-6120 3433.66,-6120 3433.66,-6120"/>
<polygon fill="black" stroke="black" points="3433.66,-6123.5 3443.66,-6120 3433.66,-6116.5 3433.66,-6123.5"/>
<text text-anchor="middle" x="2403.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_212</text>
</g>
<!-- layer_13_expert_5&#45;&gt;layer_13_gather -->
<g id="edge566" class="edge">
<title>layer_13_expert_5&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M2528,-6387.88C2528,-6311.22 2528,-6132 2528,-6132 2528,-6132 3458.38,-6132 3458.38,-6132"/>
<polygon fill="black" stroke="black" points="3458.38,-6135.5 3468.38,-6132 3458.38,-6128.5 3458.38,-6135.5"/>
<text text-anchor="middle" x="2825.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_213</text>
</g>
<!-- layer_13_expert_6&#45;&gt;layer_13_gather -->
<g id="edge568" class="edge">
<title>layer_13_expert_6&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M3019.82,-6387.91C3019.82,-6313.68 3019.82,-6144 3019.82,-6144 3019.82,-6144 3507.89,-6144 3507.89,-6144"/>
<polygon fill="black" stroke="black" points="3507.89,-6147.5 3517.89,-6144 3507.89,-6140.5 3507.89,-6147.5"/>
<text text-anchor="middle" x="3114.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_214</text>
</g>
<!-- layer_13_expert_7&#45;&gt;layer_13_gather -->
<g id="edge570" class="edge">
<title>layer_13_expert_7&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M3448.26,-6387.9C3448.26,-6387.9 3448.26,-6133.17 3448.26,-6133.17"/>
<polygon fill="black" stroke="black" points="3451.76,-6133.17 3448.26,-6123.17 3444.76,-6133.17 3451.76,-6133.17"/>
<text text-anchor="middle" x="3457.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_215</text>
</g>
<!-- layer_13_expert_8&#45;&gt;layer_13_gather -->
<g id="edge572" class="edge">
<title>layer_13_expert_8&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M3693,-6387.9C3693,-6387.9 3693,-6167.01 3693,-6167.01"/>
<polygon fill="black" stroke="black" points="3696.5,-6167.01 3693,-6157.01 3689.5,-6167.01 3696.5,-6167.01"/>
<text text-anchor="middle" x="3746.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_216</text>
</g>
<!-- layer_13_expert_9&#45;&gt;layer_13_gather -->
<g id="edge574" class="edge">
<title>layer_13_expert_9&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M3937.74,-6387.9C3937.74,-6387.9 3937.74,-6133.17 3937.74,-6133.17"/>
<polygon fill="black" stroke="black" points="3941.24,-6133.17 3937.74,-6123.17 3934.24,-6133.17 3941.24,-6133.17"/>
<text text-anchor="middle" x="4035.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_217</text>
</g>
<!-- layer_13_expert_10&#45;&gt;layer_13_gather -->
<g id="edge576" class="edge">
<title>layer_13_expert_10&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M4341.5,-6387.79C4341.5,-6313.29 4341.5,-6143 4341.5,-6143 4341.5,-6143 3883.64,-6143 3883.64,-6143"/>
<polygon fill="black" stroke="black" points="3883.64,-6139.5 3873.64,-6143 3883.64,-6146.5 3883.64,-6139.5"/>
<text text-anchor="middle" x="4378.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_218</text>
</g>
<!-- layer_13_expert_11&#45;&gt;layer_13_gather -->
<g id="edge578" class="edge">
<title>layer_13_expert_11&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M4736.5,-6387.81C4736.5,-6310.53 4736.5,-6129 4736.5,-6129 4736.5,-6129 3935.88,-6129 3935.88,-6129"/>
<polygon fill="black" stroke="black" points="3935.88,-6125.5 3925.88,-6129 3935.88,-6132.5 3935.88,-6125.5"/>
<text text-anchor="middle" x="4826.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_219</text>
</g>
<!-- layer_13_expert_12&#45;&gt;layer_13_gather -->
<g id="edge580" class="edge">
<title>layer_13_expert_12&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M5131.5,-6387.97C5131.5,-6308.04 5131.5,-6115 5131.5,-6115 5131.5,-6115 3957.28,-6115 3957.28,-6115"/>
<polygon fill="black" stroke="black" points="3957.28,-6111.5 3947.28,-6115 3957.28,-6118.5 3957.28,-6111.5"/>
<text text-anchor="middle" x="5168.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_220</text>
</g>
<!-- layer_13_expert_13&#45;&gt;layer_13_gather -->
<g id="edge582" class="edge">
<title>layer_13_expert_13&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M5526.5,-6387.75C5526.5,-6305.2 5526.5,-6102 5526.5,-6102 5526.5,-6102 3956.5,-6102 3956.5,-6102"/>
<polygon fill="black" stroke="black" points="3956.5,-6098.5 3946.5,-6102 3956.5,-6105.5 3956.5,-6098.5"/>
<text text-anchor="middle" x="5537.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_221</text>
</g>
<!-- layer_13_expert_14&#45;&gt;layer_13_gather -->
<g id="edge584" class="edge">
<title>layer_13_expert_14&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M5921.5,-6387.82C5921.5,-6302.7 5921.5,-6088 5921.5,-6088 5921.5,-6088 3933.62,-6088 3933.62,-6088"/>
<polygon fill="black" stroke="black" points="3933.62,-6084.5 3923.62,-6088 3933.62,-6091.5 3933.62,-6084.5"/>
<text text-anchor="middle" x="6011.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_222</text>
</g>
<!-- layer_13_expert_15&#45;&gt;layer_13_gather -->
<g id="edge586" class="edge">
<title>layer_13_expert_15&#45;&gt;layer_13_gather</title>
<path fill="none" stroke="black" d="M6333,-6388C6333,-6300.43 6333,-6074 6333,-6074 6333,-6074 3879.03,-6074 3879.03,-6074"/>
<polygon fill="black" stroke="black" points="3879.03,-6070.5 3869.03,-6074 3879.03,-6077.5 3879.03,-6070.5"/>
<text text-anchor="middle" x="6406.5" y="-6268.8" font-family="Times,serif" font-size="14.00">from_GPU_223</text>
</g>
<!-- layer_14_qkv -->
<g id="node352" class="node">
<title>layer_14_qkv</title>
<polygon fill="lightblue" stroke="black" points="3652.5,-5558.83 3243.5,-5558.83 3243.5,-5490.83 3652.5,-5490.83 3652.5,-5558.83"/>
<text text-anchor="middle" x="3448" y="-5543.63" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3448" y="-5528.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3448" y="-5513.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3448" y="-5498.63" font-family="Times,serif" font-size="14.00">GPU: 224</text>
</g>
<!-- layer_13_add_norm2&#45;&gt;layer_14_qkv -->
<g id="edge589" class="edge">
<title>layer_13_add_norm2&#45;&gt;layer_14_qkv</title>
<path fill="none" stroke="black" d="M3612.75,-5775.74C3612.75,-5775.74 3612.75,-5568.97 3612.75,-5568.97"/>
<polygon fill="black" stroke="black" points="3616.25,-5568.97 3612.75,-5558.97 3609.25,-5568.97 3616.25,-5568.97"/>
</g>
<!-- layer_14_add_norm1 -->
<g id="node355" class="node">
<title>layer_14_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="3955,-4703.83 3593,-4703.83 3593,-4635.83 3955,-4635.83 3955,-4703.83"/>
<text text-anchor="middle" x="3774" y="-4688.63" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3774" y="-4673.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3774" y="-4658.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3774" y="-4643.63" font-family="Times,serif" font-size="14.00">GPU: 224</text>
</g>
<!-- layer_13_add_norm2&#45;&gt;layer_14_add_norm1 -->
<g id="edge593" class="edge">
<title>layer_13_add_norm2&#45;&gt;layer_14_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3797.25,-5775.71C3797.25,-5775.71 3797.25,-4714.1 3797.25,-4714.1"/>
<polygon fill="black" stroke="black" points="3800.75,-4714.1 3797.25,-4704.1 3793.75,-4714.1 3800.75,-4714.1"/>
<text text-anchor="middle" x="3808" y="-5236.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_13_mha -->
<g id="node351" class="node">
<title>layer_13_mha</title>
<polygon fill="lightblue" stroke="black" points="2048.5,-8290.17 1639.5,-8290.17 1639.5,-8222.17 2048.5,-8222.17 2048.5,-8290.17"/>
<text text-anchor="middle" x="1844" y="-8274.97" font-family="Times,serif" font-size="14.00">MHA Layer 13</text>
<text text-anchor="middle" x="1844" y="-8259.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1844" y="-8244.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1844" y="-8229.97" font-family="Times,serif" font-size="14.00">GPU: 208</text>
</g>
<!-- layer_14_attn -->
<g id="node353" class="node">
<title>layer_14_attn</title>
<polygon fill="lightblue" stroke="black" points="3634.5,-5273.83 3225.5,-5273.83 3225.5,-5205.83 3634.5,-5205.83 3634.5,-5273.83"/>
<text text-anchor="middle" x="3430" y="-5258.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3430" y="-5243.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3430" y="-5228.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3430" y="-5213.63" font-family="Times,serif" font-size="14.00">GPU: 224</text>
</g>
<!-- layer_14_qkv&#45;&gt;layer_14_attn -->
<g id="edge590" class="edge">
<title>layer_14_qkv&#45;&gt;layer_14_attn</title>
<path fill="none" stroke="black" d="M3439,-5490.74C3439,-5490.74 3439,-5283.97 3439,-5283.97"/>
<polygon fill="black" stroke="black" points="3442.5,-5283.97 3439,-5273.97 3435.5,-5283.97 3442.5,-5283.97"/>
</g>
<!-- layer_14_proj -->
<g id="node354" class="node">
<title>layer_14_proj</title>
<polygon fill="lightblue" stroke="black" points="3659.5,-4988.83 3262.5,-4988.83 3262.5,-4920.83 3659.5,-4920.83 3659.5,-4988.83"/>
<text text-anchor="middle" x="3461" y="-4973.63" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3461" y="-4958.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3461" y="-4943.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3461" y="-4928.63" font-family="Times,serif" font-size="14.00">GPU: 224</text>
</g>
<!-- layer_14_attn&#45;&gt;layer_14_proj -->
<g id="edge591" class="edge">
<title>layer_14_attn&#45;&gt;layer_14_proj</title>
<path fill="none" stroke="black" d="M3448.5,-5205.74C3448.5,-5205.74 3448.5,-4998.97 3448.5,-4998.97"/>
<polygon fill="black" stroke="black" points="3452,-4998.97 3448.5,-4988.97 3445,-4998.97 3452,-4998.97"/>
</g>
<!-- layer_14_proj&#45;&gt;layer_14_add_norm1 -->
<g id="edge592" class="edge">
<title>layer_14_proj&#45;&gt;layer_14_add_norm1</title>
<path fill="none" stroke="black" d="M3626.25,-4920.74C3626.25,-4920.74 3626.25,-4713.97 3626.25,-4713.97"/>
<polygon fill="black" stroke="black" points="3629.75,-4713.97 3626.25,-4703.97 3622.75,-4713.97 3629.75,-4713.97"/>
</g>
<!-- layer_14_gate -->
<g id="node356" class="node">
<title>layer_14_gate</title>
<polygon fill="yellow" stroke="black" points="3700.73,-4418.83 3123.71,-4418.83 2975.27,-4282.83 3552.29,-4282.83 3700.73,-4418.83"/>
<text text-anchor="middle" x="3338" y="-4369.63" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3338" y="-4354.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3338" y="-4339.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3338" y="-4324.63" font-family="Times,serif" font-size="14.00">GPU: 224</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_gate -->
<g id="edge594" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_gate</title>
<path fill="none" stroke="black" d="M3646.93,-4635.69C3646.93,-4635.69 3646.93,-4428.95 3646.93,-4428.95"/>
<polygon fill="black" stroke="black" points="3650.43,-4428.95 3646.93,-4418.95 3643.43,-4428.95 3650.43,-4428.95"/>
</g>
<!-- layer_14_scatter -->
<g id="node357" class="node">
<title>layer_14_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3338" cy="-4003.75" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3338" y="-4022.55" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3338" y="-4007.55" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3338" y="-3992.55" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3338" y="-3977.55" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_scatter -->
<g id="edge595" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_scatter</title>
<path fill="none" stroke="black" d="M3797.68,-4635.47C3797.68,-4503.83 3797.68,-4039 3797.68,-4039 3797.68,-4039 3516.56,-4039 3516.56,-4039"/>
<polygon fill="black" stroke="black" points="3516.56,-4035.5 3506.56,-4039 3516.56,-4042.5 3516.56,-4035.5"/>
</g>
<!-- layer_14_add_norm2 -->
<g id="node375" class="node">
<title>layer_14_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4026,-3112.5 3664,-3112.5 3664,-3044.5 4026,-3044.5 4026,-3112.5"/>
<text text-anchor="middle" x="3845" y="-3097.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3845" y="-3082.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3845" y="-3067.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3845" y="-3052.3" font-family="Times,serif" font-size="14.00">GPU: 224</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_add_norm2 -->
<g id="edge630" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3924.75,-4635.49C3924.75,-4635.49 3924.75,-3122.8 3924.75,-3122.8"/>
<polygon fill="black" stroke="black" points="3928.25,-3122.8 3924.75,-3112.8 3921.25,-3122.8 3928.25,-3122.8"/>
<text text-anchor="middle" x="6310" y="-3836.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_scatter -->
<g id="edge596" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3338,-4282.67C3338,-4282.67 3338,-4061.94 3338,-4061.94"/>
<polygon fill="black" stroke="black" points="3341.5,-4061.94 3338,-4051.94 3334.5,-4061.94 3341.5,-4061.94"/>
<text text-anchor="middle" x="3381.5" y="-4163.63" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_14_expert_0 -->
<g id="node358" class="node">
<title>layer_14_expert_0</title>
<polygon fill="lightblue" stroke="black" points="339.5,-3724.67 16.5,-3724.67 16.5,-3656.67 339.5,-3656.67 339.5,-3724.67"/>
<text text-anchor="middle" x="178" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="178" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="178" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="178" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 224</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_0 -->
<g id="edge597" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_0</title>
<path fill="none" stroke="black" d="M3169.49,-4039C2515.7,-4039 183,-4039 183,-4039 183,-4039 183,-3734.7 183,-3734.7"/>
<polygon fill="black" stroke="black" points="186.5,-3734.7 183,-3724.7 179.5,-3734.7 186.5,-3734.7"/>
<text text-anchor="middle" x="400" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_224</text>
</g>
<!-- layer_14_expert_1 -->
<g id="node360" class="node">
<title>layer_14_expert_1</title>
<polygon fill="lightblue" stroke="black" points="734.5,-3724.67 411.5,-3724.67 411.5,-3656.67 734.5,-3656.67 734.5,-3724.67"/>
<text text-anchor="middle" x="573" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="573" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="573" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="573" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 225</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_1 -->
<g id="edge599" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_1</title>
<path fill="none" stroke="black" d="M3121.36,-4027C2493.05,-4027 714.5,-4027 714.5,-4027 714.5,-4027 714.5,-3734.77 714.5,-3734.77"/>
<polygon fill="black" stroke="black" points="718,-3734.77 714.5,-3724.77 711,-3734.77 718,-3734.77"/>
<text text-anchor="middle" x="743" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_225</text>
</g>
<!-- layer_14_expert_2 -->
<g id="node361" class="node">
<title>layer_14_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1129.5,-3724.67 806.5,-3724.67 806.5,-3656.67 1129.5,-3656.67 1129.5,-3724.67"/>
<text text-anchor="middle" x="968" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="968" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="968" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="968" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 226</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_2 -->
<g id="edge601" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_2</title>
<path fill="none" stroke="black" d="M3097.13,-4015C2520.72,-4015 1109.5,-4015 1109.5,-4015 1109.5,-4015 1109.5,-3734.76 1109.5,-3734.76"/>
<polygon fill="black" stroke="black" points="1113,-3734.76 1109.5,-3724.76 1106,-3734.76 1113,-3734.76"/>
<text text-anchor="middle" x="1034" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_226</text>
</g>
<!-- layer_14_expert_3 -->
<g id="node362" class="node">
<title>layer_14_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1524.5,-3724.67 1201.5,-3724.67 1201.5,-3656.67 1524.5,-3656.67 1524.5,-3724.67"/>
<text text-anchor="middle" x="1363" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1363" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1363" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1363" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 227</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_3 -->
<g id="edge603" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_3</title>
<path fill="none" stroke="black" d="M3090.52,-4003C2567.92,-4003 1399.5,-4003 1399.5,-4003 1399.5,-4003 1399.5,-3734.69 1399.5,-3734.69"/>
<polygon fill="black" stroke="black" points="1403,-3734.69 1399.5,-3724.69 1396,-3734.69 1403,-3734.69"/>
<text text-anchor="middle" x="1889" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_227</text>
</g>
<!-- layer_14_expert_4 -->
<g id="node363" class="node">
<title>layer_14_expert_4</title>
<polygon fill="lightblue" stroke="black" points="1919.5,-3724.67 1596.5,-3724.67 1596.5,-3656.67 1919.5,-3656.67 1919.5,-3724.67"/>
<text text-anchor="middle" x="1758" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1758" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1758" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1758" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 228</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_4 -->
<g id="edge605" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_4</title>
<path fill="none" stroke="black" d="M3099.25,-3991C2690.32,-3991 1899.5,-3991 1899.5,-3991 1899.5,-3991 1899.5,-3734.83 1899.5,-3734.83"/>
<polygon fill="black" stroke="black" points="1903,-3734.83 1899.5,-3724.83 1896,-3734.83 1903,-3734.83"/>
<text text-anchor="middle" x="2399" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_228</text>
</g>
<!-- layer_14_expert_5 -->
<g id="node364" class="node">
<title>layer_14_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2314.5,-3724.67 1991.5,-3724.67 1991.5,-3656.67 2314.5,-3656.67 2314.5,-3724.67"/>
<text text-anchor="middle" x="2153" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2153" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2153" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2153" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 229</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_5 -->
<g id="edge607" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_5</title>
<path fill="none" stroke="black" d="M3125.57,-3979C2820.47,-3979 2294.5,-3979 2294.5,-3979 2294.5,-3979 2294.5,-3734.87 2294.5,-3734.87"/>
<polygon fill="black" stroke="black" points="2298,-3734.87 2294.5,-3724.87 2291,-3734.87 2298,-3734.87"/>
<text text-anchor="middle" x="2736" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_229</text>
</g>
<!-- layer_14_expert_6 -->
<g id="node365" class="node">
<title>layer_14_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2709.5,-3724.67 2386.5,-3724.67 2386.5,-3656.67 2709.5,-3656.67 2709.5,-3724.67"/>
<text text-anchor="middle" x="2548" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2548" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2548" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2548" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 230</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_6 -->
<g id="edge609" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_6</title>
<path fill="none" stroke="black" d="M3178.11,-3967C2986.09,-3967 2689.5,-3967 2689.5,-3967 2689.5,-3967 2689.5,-3734.83 2689.5,-3734.83"/>
<polygon fill="black" stroke="black" points="2693,-3734.83 2689.5,-3724.83 2686,-3734.83 2693,-3734.83"/>
<text text-anchor="middle" x="2987" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_230</text>
</g>
<!-- layer_14_expert_7 -->
<g id="node366" class="node">
<title>layer_14_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3104.5,-3724.67 2781.5,-3724.67 2781.5,-3656.67 3104.5,-3656.67 3104.5,-3724.67"/>
<text text-anchor="middle" x="2943" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2943" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2943" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2943" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 231</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_7 -->
<g id="edge611" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_7</title>
<path fill="none" stroke="black" d="M3097.51,-3992.24C3097.51,-3992.24 3097.51,-3734.67 3097.51,-3734.67"/>
<polygon fill="black" stroke="black" points="3101.01,-3734.67 3097.51,-3724.67 3094.01,-3734.67 3101.01,-3734.67"/>
<text text-anchor="middle" x="3195" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_231</text>
</g>
<!-- layer_14_expert_8 -->
<g id="node367" class="node">
<title>layer_14_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3499.5,-3724.67 3176.5,-3724.67 3176.5,-3656.67 3499.5,-3656.67 3499.5,-3724.67"/>
<text text-anchor="middle" x="3338" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3338" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3338" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3338" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 232</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_8 -->
<g id="edge613" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_8</title>
<path fill="none" stroke="black" d="M3338,-3955.52C3338,-3955.52 3338,-3734.93 3338,-3734.93"/>
<polygon fill="black" stroke="black" points="3341.5,-3734.93 3338,-3724.93 3334.5,-3734.93 3341.5,-3734.93"/>
<text text-anchor="middle" x="3382" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_232</text>
</g>
<!-- layer_14_expert_9 -->
<g id="node368" class="node">
<title>layer_14_expert_9</title>
<polygon fill="lightblue" stroke="black" points="3894.5,-3724.67 3571.5,-3724.67 3571.5,-3656.67 3894.5,-3656.67 3894.5,-3724.67"/>
<text text-anchor="middle" x="3733" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3733" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3733" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3733" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 233</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_9 -->
<g id="edge615" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_9</title>
<path fill="none" stroke="black" d="M3578.49,-3992.24C3578.49,-3992.24 3578.49,-3734.67 3578.49,-3734.67"/>
<polygon fill="black" stroke="black" points="3581.99,-3734.67 3578.49,-3724.67 3574.99,-3734.67 3581.99,-3734.67"/>
<text text-anchor="middle" x="3662" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_233</text>
</g>
<!-- layer_14_expert_10 -->
<g id="node369" class="node">
<title>layer_14_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4289.5,-3724.67 3966.5,-3724.67 3966.5,-3656.67 4289.5,-3656.67 4289.5,-3724.67"/>
<text text-anchor="middle" x="4128" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4128" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4128" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4128" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 234</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_10 -->
<g id="edge617" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_10</title>
<path fill="none" stroke="black" d="M3498.01,-3967C3723.61,-3967 4108,-3967 4108,-3967 4108,-3967 4108,-3734.83 4108,-3734.83"/>
<polygon fill="black" stroke="black" points="4111.5,-3734.83 4108,-3724.83 4104.5,-3734.83 4111.5,-3734.83"/>
<text text-anchor="middle" x="4057" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_234</text>
</g>
<!-- layer_14_expert_11 -->
<g id="node370" class="node">
<title>layer_14_expert_11</title>
<polygon fill="lightblue" stroke="black" points="4684.5,-3724.67 4361.5,-3724.67 4361.5,-3656.67 4684.5,-3656.67 4684.5,-3724.67"/>
<text text-anchor="middle" x="4523" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4523" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4523" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4523" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 235</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_11 -->
<g id="edge619" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_11</title>
<path fill="none" stroke="black" d="M3550.32,-3979C3886.35,-3979 4503,-3979 4503,-3979 4503,-3979 4503,-3734.87 4503,-3734.87"/>
<polygon fill="black" stroke="black" points="4506.5,-3734.87 4503,-3724.87 4499.5,-3734.87 4506.5,-3734.87"/>
<text text-anchor="middle" x="4394" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_235</text>
</g>
<!-- layer_14_expert_12 -->
<g id="node371" class="node">
<title>layer_14_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5079.5,-3724.67 4756.5,-3724.67 4756.5,-3656.67 5079.5,-3656.67 5079.5,-3724.67"/>
<text text-anchor="middle" x="4918" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="4918" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4918" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4918" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 236</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_12 -->
<g id="edge621" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_12</title>
<path fill="none" stroke="black" d="M3577.05,-3991C4014.2,-3991 4898,-3991 4898,-3991 4898,-3991 4898,-3734.83 4898,-3734.83"/>
<polygon fill="black" stroke="black" points="4901.5,-3734.83 4898,-3724.83 4894.5,-3734.83 4901.5,-3734.83"/>
<text text-anchor="middle" x="4732" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_236</text>
</g>
<!-- layer_14_expert_13 -->
<g id="node372" class="node">
<title>layer_14_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5474.5,-3724.67 5151.5,-3724.67 5151.5,-3656.67 5474.5,-3656.67 5474.5,-3724.67"/>
<text text-anchor="middle" x="5313" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5313" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5313" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5313" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 237</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_13 -->
<g id="edge623" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_13</title>
<path fill="none" stroke="black" d="M3585.6,-4003C4111.67,-4003 5293,-4003 5293,-4003 5293,-4003 5293,-3734.69 5293,-3734.69"/>
<polygon fill="black" stroke="black" points="5296.5,-3734.69 5293,-3724.69 5289.5,-3734.69 5296.5,-3734.69"/>
<text text-anchor="middle" x="5127" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_237</text>
</g>
<!-- layer_14_expert_14 -->
<g id="node373" class="node">
<title>layer_14_expert_14</title>
<polygon fill="lightblue" stroke="black" points="5869.5,-3724.67 5546.5,-3724.67 5546.5,-3656.67 5869.5,-3656.67 5869.5,-3724.67"/>
<text text-anchor="middle" x="5708" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5708" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5708" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5708" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 238</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_14 -->
<g id="edge625" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_14</title>
<path fill="none" stroke="black" d="M3578.72,-4015C4177.84,-4015 5688,-4015 5688,-4015 5688,-4015 5688,-3734.76 5688,-3734.76"/>
<polygon fill="black" stroke="black" points="5691.5,-3734.76 5688,-3724.76 5684.5,-3734.76 5691.5,-3734.76"/>
<text text-anchor="middle" x="5522" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_238</text>
</g>
<!-- layer_14_expert_15 -->
<g id="node374" class="node">
<title>layer_14_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6264.5,-3724.67 5941.5,-3724.67 5941.5,-3656.67 6264.5,-3656.67 6264.5,-3724.67"/>
<text text-anchor="middle" x="6103" y="-3709.47" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6103" y="-3694.47" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6103" y="-3679.47" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6103" y="-3664.47" font-family="Times,serif" font-size="14.00">GPU: 239</text>
</g>
<!-- layer_14_scatter&#45;&gt;layer_14_expert_15 -->
<g id="edge627" class="edge">
<title>layer_14_scatter&#45;&gt;layer_14_expert_15</title>
<path fill="none" stroke="black" d="M3554.83,-4027C4203.28,-4027 6083,-4027 6083,-4027 6083,-4027 6083,-3734.77 6083,-3734.77"/>
<polygon fill="black" stroke="black" points="6086.5,-3734.77 6083,-3724.77 6079.5,-3734.77 6086.5,-3734.77"/>
<text text-anchor="middle" x="6032" y="-3836.47" font-family="Times,serif" font-size="14.00">to_GPU_239</text>
</g>
<!-- layer_14_gather -->
<g id="node359" class="node">
<title>layer_14_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3338" cy="-3377.58" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3338" y="-3396.38" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3338" y="-3381.38" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3338" y="-3366.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3338" y="-3351.38" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_14_expert_0&#45;&gt;layer_14_gather -->
<g id="edge598" class="edge">
<title>layer_14_expert_0&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M230.5,-3656.5C230.5,-3568.52 230.5,-3341 230.5,-3341 230.5,-3341 3161.75,-3341 3161.75,-3341"/>
<polygon fill="black" stroke="black" points="3161.75,-3344.5 3171.75,-3341 3161.75,-3337.5 3161.75,-3344.5"/>
<text text-anchor="middle" x="342.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_224</text>
</g>
<!-- layer_14_gather&#45;&gt;layer_14_add_norm2 -->
<g id="edge629" class="edge">
<title>layer_14_gather&#45;&gt;layer_14_add_norm2</title>
<path fill="none" stroke="black" d="M3502.74,-3340.55C3502.74,-3260.39 3502.74,-3078 3502.74,-3078 3502.74,-3078 3653.85,-3078 3653.85,-3078"/>
<polygon fill="black" stroke="black" points="3653.85,-3081.5 3663.85,-3078 3653.85,-3074.5 3653.85,-3081.5"/>
</g>
<!-- layer_14_expert_1&#45;&gt;layer_14_gather -->
<g id="edge600" class="edge">
<title>layer_14_expert_1&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M625.5,-3656.43C625.5,-3570.59 625.5,-3353 625.5,-3353 625.5,-3353 3107.75,-3353 3107.75,-3353"/>
<polygon fill="black" stroke="black" points="3107.75,-3356.5 3117.75,-3353 3107.75,-3349.5 3107.75,-3356.5"/>
<text text-anchor="middle" x="638.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_225</text>
</g>
<!-- layer_14_expert_2&#45;&gt;layer_14_gather -->
<g id="edge602" class="edge">
<title>layer_14_expert_2&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M1020.5,-3656.43C1020.5,-3572.82 1020.5,-3365 1020.5,-3365 1020.5,-3365 3080.81,-3365 3080.81,-3365"/>
<polygon fill="black" stroke="black" points="3080.81,-3368.5 3090.81,-3365 3080.81,-3361.5 3080.81,-3368.5"/>
<text text-anchor="middle" x="1560.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_226</text>
</g>
<!-- layer_14_expert_3&#45;&gt;layer_14_gather -->
<g id="edge604" class="edge">
<title>layer_14_expert_3&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M1451,-3656.5C1451,-3575.21 1451,-3377 1451,-3377 1451,-3377 3072.04,-3377 3072.04,-3377"/>
<polygon fill="black" stroke="black" points="3072.04,-3380.5 3082.04,-3377 3072.04,-3373.5 3072.04,-3380.5"/>
<text text-anchor="middle" x="2113.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_227</text>
</g>
<!-- layer_14_expert_4&#45;&gt;layer_14_gather -->
<g id="edge606" class="edge">
<title>layer_14_expert_4&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M1853,-3656.65C1853,-3577.75 1853,-3389 1853,-3389 1853,-3389 3079.03,-3389 3079.03,-3389"/>
<polygon fill="black" stroke="black" points="3079.03,-3392.5 3089.03,-3389 3079.03,-3385.5 3079.03,-3392.5"/>
<text text-anchor="middle" x="2482.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_228</text>
</g>
<!-- layer_14_expert_5&#45;&gt;layer_14_gather -->
<g id="edge608" class="edge">
<title>layer_14_expert_5&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M2205.5,-3656.59C2205.5,-3580.02 2205.5,-3401 2205.5,-3401 2205.5,-3401 3104.25,-3401 3104.25,-3401"/>
<polygon fill="black" stroke="black" points="3104.25,-3404.5 3114.25,-3401 3104.25,-3397.5 3104.25,-3404.5"/>
<text text-anchor="middle" x="2758.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_229</text>
</g>
<!-- layer_14_expert_6&#45;&gt;layer_14_gather -->
<g id="edge610" class="edge">
<title>layer_14_expert_6&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M2600.5,-3656.62C2600.5,-3582.47 2600.5,-3413 2600.5,-3413 2600.5,-3413 3154.62,-3413 3154.62,-3413"/>
<polygon fill="black" stroke="black" points="3154.62,-3416.5 3164.62,-3413 3154.62,-3409.5 3154.62,-3416.5"/>
<text text-anchor="middle" x="2988.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_230</text>
</g>
<!-- layer_14_expert_7&#45;&gt;layer_14_gather -->
<g id="edge612" class="edge">
<title>layer_14_expert_7&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M3093.26,-3656.56C3093.26,-3656.56 3093.26,-3401.84 3093.26,-3401.84"/>
<polygon fill="black" stroke="black" points="3096.76,-3401.84 3093.26,-3391.84 3089.76,-3401.84 3096.76,-3401.84"/>
<text text-anchor="middle" x="3195.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_231</text>
</g>
<!-- layer_14_expert_8&#45;&gt;layer_14_gather -->
<g id="edge614" class="edge">
<title>layer_14_expert_8&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M3338,-3656.56C3338,-3656.56 3338,-3435.67 3338,-3435.67"/>
<polygon fill="black" stroke="black" points="3341.5,-3435.67 3338,-3425.67 3334.5,-3435.67 3341.5,-3435.67"/>
<text text-anchor="middle" x="3391.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_232</text>
</g>
<!-- layer_14_expert_9&#45;&gt;layer_14_gather -->
<g id="edge616" class="edge">
<title>layer_14_expert_9&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M3582.74,-3656.56C3582.74,-3656.56 3582.74,-3401.84 3582.74,-3401.84"/>
<polygon fill="black" stroke="black" points="3586.24,-3401.84 3582.74,-3391.84 3579.24,-3401.84 3586.24,-3401.84"/>
<text text-anchor="middle" x="3681.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_233</text>
</g>
<!-- layer_14_expert_10&#45;&gt;layer_14_gather -->
<g id="edge618" class="edge">
<title>layer_14_expert_10&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M3996.25,-3656.65C3996.25,-3582.12 3996.25,-3411 3996.25,-3411 3996.25,-3411 3532.23,-3411 3532.23,-3411"/>
<polygon fill="black" stroke="black" points="3532.23,-3407.5 3522.23,-3411 3532.23,-3414.5 3532.23,-3407.5"/>
<text text-anchor="middle" x="4023.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_234</text>
</g>
<!-- layer_14_expert_11&#45;&gt;layer_14_gather -->
<g id="edge620" class="edge">
<title>layer_14_expert_11&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M4378,-3656.52C4378,-3579.32 4378,-3398 4378,-3398 4378,-3398 3579.78,-3398 3579.78,-3398"/>
<polygon fill="black" stroke="black" points="3579.78,-3394.5 3569.78,-3398 3579.78,-3401.5 3579.78,-3394.5"/>
<text text-anchor="middle" x="4391.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_235</text>
</g>
<!-- layer_14_expert_12&#45;&gt;layer_14_gather -->
<g id="edge622" class="edge">
<title>layer_14_expert_12&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M4773,-3656.38C4773,-3576.36 4773,-3384 4773,-3384 4773,-3384 3602.07,-3384 3602.07,-3384"/>
<polygon fill="black" stroke="black" points="3602.07,-3380.5 3592.07,-3384 3602.07,-3387.5 3602.07,-3380.5"/>
<text text-anchor="middle" x="4773.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_236</text>
</g>
<!-- layer_14_expert_13&#45;&gt;layer_14_gather -->
<g id="edge624" class="edge">
<title>layer_14_expert_13&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M5168,-3656.65C5168,-3574.13 5168,-3370 5168,-3370 5168,-3370 3601.01,-3370 3601.01,-3370"/>
<polygon fill="black" stroke="black" points="3601.01,-3366.5 3591.01,-3370 3601.01,-3373.5 3601.01,-3366.5"/>
<text text-anchor="middle" x="5161.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_237</text>
</g>
<!-- layer_14_expert_14&#45;&gt;layer_14_gather -->
<g id="edge626" class="edge">
<title>layer_14_expert_14&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M5563,-3656.42C5563,-3571.13 5563,-3356 5563,-3356 5563,-3356 3576.95,-3356 3576.95,-3356"/>
<polygon fill="black" stroke="black" points="3576.95,-3352.5 3566.95,-3356 3576.95,-3359.5 3576.95,-3352.5"/>
<text text-anchor="middle" x="5553.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_238</text>
</g>
<!-- layer_14_expert_15&#45;&gt;layer_14_gather -->
<g id="edge628" class="edge">
<title>layer_14_expert_15&#45;&gt;layer_14_gather</title>
<path fill="none" stroke="black" d="M5958,-3656.38C5958,-3568.67 5958,-3343 5958,-3343 5958,-3343 3526.02,-3343 3526.02,-3343"/>
<polygon fill="black" stroke="black" points="3526.02,-3339.5 3516.02,-3343 3526.02,-3346.5 3526.02,-3339.5"/>
<text text-anchor="middle" x="5947.5" y="-3537.47" font-family="Times,serif" font-size="14.00">from_GPU_239</text>
</g>
<!-- layer_15_qkv -->
<g id="node377" class="node">
<title>layer_15_qkv</title>
<polygon fill="lightblue" stroke="black" points="3820.5,-2827.5 3411.5,-2827.5 3411.5,-2759.5 3820.5,-2759.5 3820.5,-2827.5"/>
<text text-anchor="middle" x="3616" y="-2812.3" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3616" y="-2797.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3616" y="-2782.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3616" y="-2767.3" font-family="Times,serif" font-size="14.00">GPU: 240</text>
</g>
<!-- layer_14_add_norm2&#45;&gt;layer_15_qkv -->
<g id="edge631" class="edge">
<title>layer_14_add_norm2&#45;&gt;layer_15_qkv</title>
<path fill="none" stroke="black" d="M3742.25,-3044.4C3742.25,-3044.4 3742.25,-2837.63 3742.25,-2837.63"/>
<polygon fill="black" stroke="black" points="3745.75,-2837.63 3742.25,-2827.63 3738.75,-2837.63 3745.75,-2837.63"/>
</g>
<!-- layer_15_add_norm1 -->
<g id="node380" class="node">
<title>layer_15_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4060,-1972.5 3698,-1972.5 3698,-1904.5 4060,-1904.5 4060,-1972.5"/>
<text text-anchor="middle" x="3879" y="-1957.3" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3879" y="-1942.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3879" y="-1927.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3879" y="-1912.3" font-family="Times,serif" font-size="14.00">GPU: 240</text>
</g>
<!-- layer_14_add_norm2&#45;&gt;layer_15_add_norm1 -->
<g id="edge635" class="edge">
<title>layer_14_add_norm2&#45;&gt;layer_15_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3926.25,-3044.38C3926.25,-3044.38 3926.25,-1982.76 3926.25,-1982.76"/>
<polygon fill="black" stroke="black" points="3929.75,-1982.76 3926.25,-1972.76 3922.75,-1982.76 3929.75,-1982.76"/>
<text text-anchor="middle" x="3976" y="-2504.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_14_mha -->
<g id="node376" class="node">
<title>layer_14_mha</title>
<polygon fill="lightblue" stroke="black" points="1683.5,-5558.83 1274.5,-5558.83 1274.5,-5490.83 1683.5,-5490.83 1683.5,-5558.83"/>
<text text-anchor="middle" x="1479" y="-5543.63" font-family="Times,serif" font-size="14.00">MHA Layer 14</text>
<text text-anchor="middle" x="1479" y="-5528.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1479" y="-5513.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1479" y="-5498.63" font-family="Times,serif" font-size="14.00">GPU: 224</text>
</g>
<!-- layer_15_attn -->
<g id="node378" class="node">
<title>layer_15_attn</title>
<polygon fill="lightblue" stroke="black" points="3802.5,-2542.5 3393.5,-2542.5 3393.5,-2474.5 3802.5,-2474.5 3802.5,-2542.5"/>
<text text-anchor="middle" x="3598" y="-2527.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3598" y="-2512.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3598" y="-2497.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3598" y="-2482.3" font-family="Times,serif" font-size="14.00">GPU: 240</text>
</g>
<!-- layer_15_qkv&#45;&gt;layer_15_attn -->
<g id="edge632" class="edge">
<title>layer_15_qkv&#45;&gt;layer_15_attn</title>
<path fill="none" stroke="black" d="M3607,-2759.4C3607,-2759.4 3607,-2552.63 3607,-2552.63"/>
<polygon fill="black" stroke="black" points="3610.5,-2552.63 3607,-2542.63 3603.5,-2552.63 3610.5,-2552.63"/>
</g>
<!-- layer_15_proj -->
<g id="node379" class="node">
<title>layer_15_proj</title>
<polygon fill="lightblue" stroke="black" points="3826.5,-2257.5 3429.5,-2257.5 3429.5,-2189.5 3826.5,-2189.5 3826.5,-2257.5"/>
<text text-anchor="middle" x="3628" y="-2242.3" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3628" y="-2227.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3628" y="-2212.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3628" y="-2197.3" font-family="Times,serif" font-size="14.00">GPU: 240</text>
</g>
<!-- layer_15_attn&#45;&gt;layer_15_proj -->
<g id="edge633" class="edge">
<title>layer_15_attn&#45;&gt;layer_15_proj</title>
<path fill="none" stroke="black" d="M3616,-2474.4C3616,-2474.4 3616,-2267.63 3616,-2267.63"/>
<polygon fill="black" stroke="black" points="3619.5,-2267.63 3616,-2257.63 3612.5,-2267.63 3619.5,-2267.63"/>
</g>
<!-- layer_15_proj&#45;&gt;layer_15_add_norm1 -->
<g id="edge634" class="edge">
<title>layer_15_proj&#45;&gt;layer_15_add_norm1</title>
<path fill="none" stroke="black" d="M3762.25,-2189.4C3762.25,-2189.4 3762.25,-1982.63 3762.25,-1982.63"/>
<polygon fill="black" stroke="black" points="3765.75,-1982.63 3762.25,-1972.63 3758.75,-1982.63 3765.75,-1982.63"/>
</g>
<!-- layer_15_gate -->
<g id="node381" class="node">
<title>layer_15_gate</title>
<polygon fill="yellow" stroke="black" points="3805.73,-1687.5 3228.71,-1687.5 3080.27,-1551.5 3657.29,-1551.5 3805.73,-1687.5"/>
<text text-anchor="middle" x="3443" y="-1638.3" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3443" y="-1623.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-1608.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3443" y="-1593.3" font-family="Times,serif" font-size="14.00">GPU: 240</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_gate -->
<g id="edge636" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_gate</title>
<path fill="none" stroke="black" d="M3751.93,-1904.36C3751.93,-1904.36 3751.93,-1697.62 3751.93,-1697.62"/>
<polygon fill="black" stroke="black" points="3755.43,-1697.62 3751.93,-1687.62 3748.43,-1697.62 3755.43,-1697.62"/>
</g>
<!-- layer_15_scatter -->
<g id="node382" class="node">
<title>layer_15_scatter</title>
<ellipse fill="lightgray" stroke="black" cx="3443" cy="-1272.42" rx="247.47" ry="48.17"/>
<text text-anchor="middle" x="3443" y="-1291.22" font-family="Times,serif" font-size="14.00">Token Scatter</text>
<text text-anchor="middle" x="3443" y="-1276.22" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-1261.22" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-1246.22" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_scatter -->
<g id="edge637" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_scatter</title>
<path fill="none" stroke="black" d="M3902.68,-1904.15C3902.68,-1772.58 3902.68,-1308 3902.68,-1308 3902.68,-1308 3619.61,-1308 3619.61,-1308"/>
<polygon fill="black" stroke="black" points="3619.61,-1304.5 3609.61,-1308 3619.61,-1311.5 3619.61,-1304.5"/>
</g>
<!-- layer_15_add_norm2 -->
<g id="node400" class="node">
<title>layer_15_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="5034,-381.17 4672,-381.17 4672,-313.17 5034,-313.17 5034,-381.17"/>
<text text-anchor="middle" x="4853" y="-365.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="4853" y="-350.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4853" y="-335.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4853" y="-320.97" font-family="Times,serif" font-size="14.00">GPU: 240</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_add_norm2 -->
<g id="edge672" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4029.75,-1904.15C4029.75,-1672.46 4029.75,-347 4029.75,-347 4029.75,-347 4661.82,-347 4661.82,-347"/>
<polygon fill="black" stroke="black" points="4661.82,-350.5 4671.82,-347 4661.82,-343.5 4661.82,-350.5"/>
<text text-anchor="middle" x="6415" y="-1105.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_scatter -->
<g id="edge638" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_scatter</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3443,-1551.34C3443,-1551.34 3443,-1330.6 3443,-1330.6"/>
<polygon fill="black" stroke="black" points="3446.5,-1330.6 3443,-1320.6 3439.5,-1330.6 3446.5,-1330.6"/>
<text text-anchor="middle" x="3486.5" y="-1432.3" font-family="Times,serif" font-size="14.00">routing_info</text>
</g>
<!-- layer_15_expert_0 -->
<g id="node383" class="node">
<title>layer_15_expert_0</title>
<polygon fill="lightblue" stroke="black" points="444.5,-993.33 121.5,-993.33 121.5,-925.33 444.5,-925.33 444.5,-993.33"/>
<text text-anchor="middle" x="283" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="283" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="283" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="283" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 240</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_0 -->
<g id="edge639" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_0</title>
<path fill="none" stroke="black" d="M3276.34,-1308C2643.91,-1308 428,-1308 428,-1308 428,-1308 428,-1003.4 428,-1003.4"/>
<polygon fill="black" stroke="black" points="431.5,-1003.4 428,-993.4 424.5,-1003.4 431.5,-1003.4"/>
<text text-anchor="middle" x="505" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_240</text>
</g>
<!-- layer_15_expert_1 -->
<g id="node385" class="node">
<title>layer_15_expert_1</title>
<polygon fill="lightblue" stroke="black" points="839.5,-993.33 516.5,-993.33 516.5,-925.33 839.5,-925.33 839.5,-993.33"/>
<text text-anchor="middle" x="678" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="678" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="678" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="678" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 241</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_1 -->
<g id="edge641" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_1</title>
<path fill="none" stroke="black" d="M3227.2,-1296C2600.23,-1296 823,-1296 823,-1296 823,-1296 823,-1003.47 823,-1003.47"/>
<polygon fill="black" stroke="black" points="826.5,-1003.47 823,-993.47 819.5,-1003.47 826.5,-1003.47"/>
<text text-anchor="middle" x="848" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_241</text>
</g>
<!-- layer_15_expert_2 -->
<g id="node386" class="node">
<title>layer_15_expert_2</title>
<polygon fill="lightblue" stroke="black" points="1234.5,-993.33 911.5,-993.33 911.5,-925.33 1234.5,-925.33 1234.5,-993.33"/>
<text text-anchor="middle" x="1073" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1073" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1073" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1073" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 242</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_2 -->
<g id="edge643" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_2</title>
<path fill="none" stroke="black" d="M3202.77,-1284C2627.44,-1284 1218,-1284 1218,-1284 1218,-1284 1218,-1003.46 1218,-1003.46"/>
<polygon fill="black" stroke="black" points="1221.5,-1003.46 1218,-993.46 1214.5,-1003.46 1221.5,-1003.46"/>
<text text-anchor="middle" x="1139" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_242</text>
</g>
<!-- layer_15_expert_3 -->
<g id="node387" class="node">
<title>layer_15_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1629.5,-993.33 1306.5,-993.33 1306.5,-925.33 1629.5,-925.33 1629.5,-993.33"/>
<text text-anchor="middle" x="1468" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1468" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1468" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1468" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 243</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_3 -->
<g id="edge645" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_3</title>
<path fill="none" stroke="black" d="M3195.39,-1272C2672.53,-1272 1503.5,-1272 1503.5,-1272 1503.5,-1272 1503.5,-1003.39 1503.5,-1003.39"/>
<polygon fill="black" stroke="black" points="1507,-1003.39 1503.5,-993.39 1500,-1003.39 1507,-1003.39"/>
<text text-anchor="middle" x="1994" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_243</text>
</g>
<!-- layer_15_expert_4 -->
<g id="node388" class="node">
<title>layer_15_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2024.5,-993.33 1701.5,-993.33 1701.5,-925.33 2024.5,-925.33 2024.5,-993.33"/>
<text text-anchor="middle" x="1863" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1863" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1863" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="1863" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 244</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_4 -->
<g id="edge647" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_4</title>
<path fill="none" stroke="black" d="M3203.62,-1260C2795.34,-1260 2008,-1260 2008,-1260 2008,-1260 2008,-1003.53 2008,-1003.53"/>
<polygon fill="black" stroke="black" points="2011.5,-1003.53 2008,-993.53 2004.5,-1003.53 2011.5,-1003.53"/>
<text text-anchor="middle" x="2504" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_244</text>
</g>
<!-- layer_15_expert_5 -->
<g id="node389" class="node">
<title>layer_15_expert_5</title>
<polygon fill="lightblue" stroke="black" points="2419.5,-993.33 2096.5,-993.33 2096.5,-925.33 2419.5,-925.33 2419.5,-993.33"/>
<text text-anchor="middle" x="2258" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2258" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2258" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2258" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 245</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_5 -->
<g id="edge649" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_5</title>
<path fill="none" stroke="black" d="M3229.72,-1248C2925.41,-1248 2403,-1248 2403,-1248 2403,-1248 2403,-1003.58 2403,-1003.58"/>
<polygon fill="black" stroke="black" points="2406.5,-1003.58 2403,-993.58 2399.5,-1003.58 2406.5,-1003.58"/>
<text text-anchor="middle" x="2841" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_245</text>
</g>
<!-- layer_15_expert_6 -->
<g id="node390" class="node">
<title>layer_15_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2814.5,-993.33 2491.5,-993.33 2491.5,-925.33 2814.5,-925.33 2814.5,-993.33"/>
<text text-anchor="middle" x="2653" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2653" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2653" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="2653" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 246</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_6 -->
<g id="edge651" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_6</title>
<path fill="none" stroke="black" d="M3281.07,-1236C3090.01,-1236 2798,-1236 2798,-1236 2798,-1236 2798,-1003.54 2798,-1003.54"/>
<polygon fill="black" stroke="black" points="2801.5,-1003.54 2798,-993.54 2794.5,-1003.54 2801.5,-1003.54"/>
<text text-anchor="middle" x="3092" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_246</text>
</g>
<!-- layer_15_expert_7 -->
<g id="node391" class="node">
<title>layer_15_expert_7</title>
<polygon fill="lightblue" stroke="black" points="3209.5,-993.33 2886.5,-993.33 2886.5,-925.33 3209.5,-925.33 3209.5,-993.33"/>
<text text-anchor="middle" x="3048" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3048" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3048" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3048" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 247</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_7 -->
<g id="edge653" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_7</title>
<path fill="none" stroke="black" d="M3202.51,-1260.9C3202.51,-1260.9 3202.51,-1003.34 3202.51,-1003.34"/>
<polygon fill="black" stroke="black" points="3206.01,-1003.34 3202.51,-993.34 3199.01,-1003.34 3206.01,-1003.34"/>
<text text-anchor="middle" x="3300" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_247</text>
</g>
<!-- layer_15_expert_8 -->
<g id="node392" class="node">
<title>layer_15_expert_8</title>
<polygon fill="lightblue" stroke="black" points="3604.5,-993.33 3281.5,-993.33 3281.5,-925.33 3604.5,-925.33 3604.5,-993.33"/>
<text text-anchor="middle" x="3443" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3443" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 248</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_8 -->
<g id="edge655" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_8</title>
<path fill="none" stroke="black" d="M3443,-1224.18C3443,-1224.18 3443,-1003.6 3443,-1003.6"/>
<polygon fill="black" stroke="black" points="3446.5,-1003.6 3443,-993.6 3439.5,-1003.6 3446.5,-1003.6"/>
<text text-anchor="middle" x="3487" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_248</text>
</g>
<!-- layer_15_expert_9 -->
<g id="node393" class="node">
<title>layer_15_expert_9</title>
<polygon fill="lightblue" stroke="black" points="3999.5,-993.33 3676.5,-993.33 3676.5,-925.33 3999.5,-925.33 3999.5,-993.33"/>
<text text-anchor="middle" x="3838" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3838" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3838" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3838" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 249</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_9 -->
<g id="edge657" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_9</title>
<path fill="none" stroke="black" d="M3683.49,-1260.9C3683.49,-1260.9 3683.49,-1003.34 3683.49,-1003.34"/>
<polygon fill="black" stroke="black" points="3686.99,-1003.34 3683.49,-993.34 3679.99,-1003.34 3686.99,-1003.34"/>
<text text-anchor="middle" x="3767" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_249</text>
</g>
<!-- layer_15_expert_10 -->
<g id="node394" class="node">
<title>layer_15_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4394.5,-993.33 4071.5,-993.33 4071.5,-925.33 4394.5,-925.33 4394.5,-993.33"/>
<text text-anchor="middle" x="4233" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4233" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4233" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4233" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 250</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_10 -->
<g id="edge659" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_10</title>
<path fill="none" stroke="black" d="M3604.85,-1236C3821.94,-1236 4180.5,-1236 4180.5,-1236 4180.5,-1236 4180.5,-1003.54 4180.5,-1003.54"/>
<polygon fill="black" stroke="black" points="4184,-1003.54 4180.5,-993.54 4177,-1003.54 4184,-1003.54"/>
<text text-anchor="middle" x="4104" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_250</text>
</g>
<!-- layer_15_expert_11 -->
<g id="node395" class="node">
<title>layer_15_expert_11</title>
<polygon fill="lightblue" stroke="black" points="4789.5,-993.33 4466.5,-993.33 4466.5,-925.33 4789.5,-925.33 4789.5,-993.33"/>
<text text-anchor="middle" x="4628" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4628" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4628" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="4628" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 251</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_11 -->
<g id="edge661" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_11</title>
<path fill="none" stroke="black" d="M3656.35,-1248C3984.47,-1248 4575.5,-1248 4575.5,-1248 4575.5,-1248 4575.5,-1003.58 4575.5,-1003.58"/>
<polygon fill="black" stroke="black" points="4579,-1003.58 4575.5,-993.58 4572,-1003.58 4579,-1003.58"/>
<text text-anchor="middle" x="4470" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_251</text>
</g>
<!-- layer_15_expert_12 -->
<g id="node396" class="node">
<title>layer_15_expert_12</title>
<polygon fill="lightblue" stroke="black" points="5184.5,-993.33 4861.5,-993.33 4861.5,-925.33 5184.5,-925.33 5184.5,-993.33"/>
<text text-anchor="middle" x="5023" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5023" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5023" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5023" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 252</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_12 -->
<g id="edge663" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_12</title>
<path fill="none" stroke="black" d="M3682.51,-1260C4112.4,-1260 4970.5,-1260 4970.5,-1260 4970.5,-1260 4970.5,-1003.53 4970.5,-1003.53"/>
<polygon fill="black" stroke="black" points="4974,-1003.53 4970.5,-993.53 4967,-1003.53 4974,-1003.53"/>
<text text-anchor="middle" x="4736" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_252</text>
</g>
<!-- layer_15_expert_13 -->
<g id="node397" class="node">
<title>layer_15_expert_13</title>
<polygon fill="lightblue" stroke="black" points="5579.5,-993.33 5256.5,-993.33 5256.5,-925.33 5579.5,-925.33 5579.5,-993.33"/>
<text text-anchor="middle" x="5418" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5418" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5418" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5418" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 253</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_13 -->
<g id="edge665" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_13</title>
<path fill="none" stroke="black" d="M3690.89,-1272C4210.36,-1272 5365.5,-1272 5365.5,-1272 5365.5,-1272 5365.5,-1003.39 5365.5,-1003.39"/>
<polygon fill="black" stroke="black" points="5369,-1003.39 5365.5,-993.39 5362,-1003.39 5369,-1003.39"/>
<text text-anchor="middle" x="4951" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_253</text>
</g>
<!-- layer_15_expert_14 -->
<g id="node398" class="node">
<title>layer_15_expert_14</title>
<polygon fill="lightblue" stroke="black" points="5974.5,-993.33 5651.5,-993.33 5651.5,-925.33 5974.5,-925.33 5974.5,-993.33"/>
<text text-anchor="middle" x="5813" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5813" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5813" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="5813" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 254</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_14 -->
<g id="edge667" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_14</title>
<path fill="none" stroke="black" d="M3683.37,-1284C4276.21,-1284 5760.5,-1284 5760.5,-1284 5760.5,-1284 5760.5,-1003.46 5760.5,-1003.46"/>
<polygon fill="black" stroke="black" points="5764,-1003.46 5760.5,-993.46 5757,-1003.46 5764,-1003.46"/>
<text text-anchor="middle" x="5167" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_254</text>
</g>
<!-- layer_15_expert_15 -->
<g id="node399" class="node">
<title>layer_15_expert_15</title>
<polygon fill="lightblue" stroke="black" points="6369.5,-993.33 6046.5,-993.33 6046.5,-925.33 6369.5,-925.33 6369.5,-993.33"/>
<text text-anchor="middle" x="6208" y="-978.13" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6208" y="-963.13" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6208" y="-948.13" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="6208" y="-933.13" font-family="Times,serif" font-size="14.00">GPU: 255</text>
</g>
<!-- layer_15_scatter&#45;&gt;layer_15_expert_15 -->
<g id="edge669" class="edge">
<title>layer_15_scatter&#45;&gt;layer_15_expert_15</title>
<path fill="none" stroke="black" d="M3658.68,-1296C4300.77,-1296 6155.5,-1296 6155.5,-1296 6155.5,-1296 6155.5,-1003.47 6155.5,-1003.47"/>
<polygon fill="black" stroke="black" points="6159,-1003.47 6155.5,-993.47 6152,-1003.47 6159,-1003.47"/>
<text text-anchor="middle" x="5792" y="-1105.13" font-family="Times,serif" font-size="14.00">to_GPU_255</text>
</g>
<!-- layer_15_gather -->
<g id="node384" class="node">
<title>layer_15_gather</title>
<ellipse fill="lightgray" stroke="black" cx="3443" cy="-646.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="3443" y="-665.05" font-family="Times,serif" font-size="14.00">Token Gather</text>
<text text-anchor="middle" x="3443" y="-650.05" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-635.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3443" y="-620.05" font-family="Times,serif" font-size="14.00">GPU: All 16</text>
</g>
<!-- layer_15_expert_0&#45;&gt;layer_15_gather -->
<g id="edge640" class="edge">
<title>layer_15_expert_0&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M283,-925.2C283,-837.3 283,-610 283,-610 283,-610 3264.78,-610 3264.78,-610"/>
<polygon fill="black" stroke="black" points="3264.78,-613.5 3274.78,-610 3264.78,-606.5 3264.78,-613.5"/>
<text text-anchor="middle" x="676.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_240</text>
</g>
<!-- layer_15_gather&#45;&gt;layer_15_add_norm2 -->
<g id="edge671" class="edge">
<title>layer_15_gather&#45;&gt;layer_15_add_norm2</title>
<path fill="none" stroke="black" d="M3611.35,-610C3960.41,-610 4730.75,-610 4730.75,-610 4730.75,-610 4730.75,-391.26 4730.75,-391.26"/>
<polygon fill="black" stroke="black" points="4734.25,-391.26 4730.75,-381.26 4727.25,-391.26 4734.25,-391.26"/>
</g>
<!-- layer_15_expert_1&#45;&gt;layer_15_gather -->
<g id="edge642" class="edge">
<title>layer_15_expert_1&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M678,-925.13C678,-839.37 678,-622 678,-622 678,-622 3211.69,-622 3211.69,-622"/>
<polygon fill="black" stroke="black" points="3211.69,-625.5 3221.69,-622 3211.69,-618.5 3211.69,-625.5"/>
<text text-anchor="middle" x="965.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_241</text>
</g>
<!-- layer_15_expert_2&#45;&gt;layer_15_gather -->
<g id="edge644" class="edge">
<title>layer_15_expert_2&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M1073,-925.13C1073,-841.6 1073,-634 1073,-634 1073,-634 3185.24,-634 3185.24,-634"/>
<polygon fill="black" stroke="black" points="3185.24,-637.5 3195.24,-634 3185.24,-630.5 3185.24,-637.5"/>
<text text-anchor="middle" x="1383.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_242</text>
</g>
<!-- layer_15_expert_3&#45;&gt;layer_15_gather -->
<g id="edge646" class="edge">
<title>layer_15_expert_3&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M1468,-925.2C1468,-844 1468,-646 1468,-646 1468,-646 3176.83,-646 3176.83,-646"/>
<polygon fill="black" stroke="black" points="3176.83,-649.5 3186.83,-646 3176.83,-642.5 3176.83,-649.5"/>
<text text-anchor="middle" x="1824.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_243</text>
</g>
<!-- layer_15_expert_4&#45;&gt;layer_15_gather -->
<g id="edge648" class="edge">
<title>layer_15_expert_4&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M1863,-925.06C1863,-846.08 1863,-658 1863,-658 1863,-658 3184.39,-658 3184.39,-658"/>
<polygon fill="black" stroke="black" points="3184.39,-661.5 3194.39,-658 3184.39,-654.5 3184.39,-661.5"/>
<text text-anchor="middle" x="2113.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_244</text>
</g>
<!-- layer_15_expert_5&#45;&gt;layer_15_gather -->
<g id="edge650" class="edge">
<title>layer_15_expert_5&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M2258,-925.29C2258,-848.81 2258,-670 2258,-670 2258,-670 3210.11,-670 3210.11,-670"/>
<polygon fill="black" stroke="black" points="3210.11,-673.5 3220.11,-670 3210.11,-666.5 3210.11,-673.5"/>
<text text-anchor="middle" x="2495.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_245</text>
</g>
<!-- layer_15_expert_6&#45;&gt;layer_15_gather -->
<g id="edge652" class="edge">
<title>layer_15_expert_6&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M2653,-925.33C2653,-851.27 2653,-682 2653,-682 2653,-682 3261.58,-682 3261.58,-682"/>
<polygon fill="black" stroke="black" points="3261.58,-685.5 3271.58,-682 3261.58,-678.5 3261.58,-685.5"/>
<text text-anchor="middle" x="2864.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_246</text>
</g>
<!-- layer_15_expert_7&#45;&gt;layer_15_gather -->
<g id="edge654" class="edge">
<title>layer_15_expert_7&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M3198.26,-925.23C3198.26,-925.23 3198.26,-670.51 3198.26,-670.51"/>
<polygon fill="black" stroke="black" points="3201.76,-670.51 3198.26,-660.51 3194.76,-670.51 3201.76,-670.51"/>
<text text-anchor="middle" x="3206.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_247</text>
</g>
<!-- layer_15_expert_8&#45;&gt;layer_15_gather -->
<g id="edge656" class="edge">
<title>layer_15_expert_8&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M3443,-925.23C3443,-925.23 3443,-704.34 3443,-704.34"/>
<polygon fill="black" stroke="black" points="3446.5,-704.34 3443,-694.34 3439.5,-704.34 3446.5,-704.34"/>
<text text-anchor="middle" x="3496.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_248</text>
</g>
<!-- layer_15_expert_9&#45;&gt;layer_15_gather -->
<g id="edge658" class="edge">
<title>layer_15_expert_9&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M3687.74,-925.23C3687.74,-925.23 3687.74,-670.51 3687.74,-670.51"/>
<polygon fill="black" stroke="black" points="3691.24,-670.51 3687.74,-660.51 3684.24,-670.51 3691.24,-670.51"/>
<text text-anchor="middle" x="3785.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_249</text>
</g>
<!-- layer_15_expert_10&#45;&gt;layer_15_gather -->
<g id="edge660" class="edge">
<title>layer_15_expert_10&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M4233,-925.33C4233,-851.27 4233,-682 4233,-682 4233,-682 3624.42,-682 3624.42,-682"/>
<polygon fill="black" stroke="black" points="3624.42,-678.5 3614.42,-682 3624.42,-685.5 3624.42,-678.5"/>
<text text-anchor="middle" x="4127.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_250</text>
</g>
<!-- layer_15_expert_11&#45;&gt;layer_15_gather -->
<g id="edge662" class="edge">
<title>layer_15_expert_11&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M4531.76,-925.29C4531.76,-848.81 4531.76,-670 4531.76,-670 4531.76,-670 3675.63,-670 3675.63,-670"/>
<polygon fill="black" stroke="black" points="3675.63,-666.5 3665.63,-670 3675.63,-673.5 3675.63,-666.5"/>
<text text-anchor="middle" x="4496.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_251</text>
</g>
<!-- layer_15_expert_12&#45;&gt;layer_15_gather -->
<g id="edge664" class="edge">
<title>layer_15_expert_12&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M4947.75,-925.06C4947.75,-846.08 4947.75,-658 4947.75,-658 4947.75,-658 3701.48,-658 3701.48,-658"/>
<polygon fill="black" stroke="black" points="3701.48,-654.5 3691.48,-658 3701.48,-661.5 3701.48,-654.5"/>
<text text-anchor="middle" x="4878.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_252</text>
</g>
<!-- layer_15_expert_13&#45;&gt;layer_15_gather -->
<g id="edge666" class="edge">
<title>layer_15_expert_13&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M5418,-925.2C5418,-844 5418,-646 5418,-646 5418,-646 3709.17,-646 3709.17,-646"/>
<polygon fill="black" stroke="black" points="3709.17,-642.5 3699.17,-646 3709.17,-649.5 3709.17,-642.5"/>
<text text-anchor="middle" x="5266.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_253</text>
</g>
<!-- layer_15_expert_14&#45;&gt;layer_15_gather -->
<g id="edge668" class="edge">
<title>layer_15_expert_14&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M5813,-925.13C5813,-841.6 5813,-634 5813,-634 5813,-634 3700.76,-634 3700.76,-634"/>
<polygon fill="black" stroke="black" points="3700.76,-630.5 3690.76,-634 3700.76,-637.5 3700.76,-630.5"/>
<text text-anchor="middle" x="5658.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_254</text>
</g>
<!-- layer_15_expert_15&#45;&gt;layer_15_gather -->
<g id="edge670" class="edge">
<title>layer_15_expert_15&#45;&gt;layer_15_gather</title>
<path fill="none" stroke="black" d="M6208,-925.13C6208,-839.37 6208,-622 6208,-622 6208,-622 3674.31,-622 3674.31,-622"/>
<polygon fill="black" stroke="black" points="3674.31,-618.5 3664.31,-622 3674.31,-625.5 3674.31,-618.5"/>
<text text-anchor="middle" x="6052.5" y="-806.13" font-family="Times,serif" font-size="14.00">from_GPU_255</text>
</g>
<!-- output -->
<g id="node402" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="4853" cy="-48.08" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="4853" y="-66.88" font-family="Times,serif" font-size="14.00">Total Output</text>
<text text-anchor="middle" x="4853" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4853" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4853" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer_15_add_norm2&#45;&gt;output -->
<g id="edge673" class="edge">
<title>layer_15_add_norm2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4853,-313.15C4853,-313.15 4853,-106.37 4853,-106.37"/>
<polygon fill="black" stroke="black" points="4856.5,-106.37 4853,-96.37 4849.5,-106.37 4856.5,-106.37"/>
</g>
<!-- layer_15_mha -->
<g id="node401" class="node">
<title>layer_15_mha</title>
<polygon fill="lightblue" stroke="black" points="1786.5,-2827.5 1377.5,-2827.5 1377.5,-2759.5 1786.5,-2759.5 1786.5,-2827.5"/>
<text text-anchor="middle" x="1582" y="-2812.3" font-family="Times,serif" font-size="14.00">MHA Layer 15</text>
<text text-anchor="middle" x="1582" y="-2797.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1582" y="-2782.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1582" y="-2767.3" font-family="Times,serif" font-size="14.00">GPU: 240</text>
</g>
</g>
</svg>
