<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe_dag Pages: 1 -->
<svg width="13890pt" height="14633pt"
 viewBox="0.00 0.00 13890.00 14633.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 14629.33)">
<title>baseline_moe_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-14629.33 13886,-14629.33 13886,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="8,-233.17 8,-14445.17 6920,-14445.17 6920,-233.17 8,-233.17"/>
<text text-anchor="middle" x="3464" y="-14429.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="3464" y="-14414.97" font-family="Times,serif" font-size="14.00">Layers 0&#45;7</text>
<text text-anchor="middle" x="3464" y="-14399.97" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;7</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="6962,-233.17 6962,-14445.17 13874,-14445.17 13874,-233.17 6962,-233.17"/>
<text text-anchor="middle" x="10418" y="-14429.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="10418" y="-14414.97" font-family="Times,serif" font-size="14.00">Layers 8&#45;15</text>
<text text-anchor="middle" x="10418" y="-14399.97" font-family="Times,serif" font-size="14.00">GPUs: 8&#45;15</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="4177" cy="-14577.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="4177" y="-14596.05" font-family="Times,serif" font-size="14.00">Total Input</text>
<text text-anchor="middle" x="4177" y="-14581.05" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4177" y="-14566.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4177" y="-14551.05" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer_0_qkv -->
<g id="node2" class="node">
<title>layer_0_qkv</title>
<polygon fill="lightblue" stroke="black" points="4178.5,-14384.17 3769.5,-14384.17 3769.5,-14316.17 4178.5,-14316.17 4178.5,-14384.17"/>
<text text-anchor="middle" x="3974" y="-14368.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3974" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3974" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3974" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- input&#45;&gt;layer_0_qkv -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_qkv</title>
<path fill="none" stroke="black" d="M4049.76,-14535.33C4049.76,-14535.33 4049.76,-14394.42 4049.76,-14394.42"/>
<polygon fill="black" stroke="black" points="4053.26,-14394.42 4049.76,-14384.42 4046.26,-14394.42 4053.26,-14394.42"/>
</g>
<!-- layer_0_add_norm1 -->
<g id="node5" class="node">
<title>layer_0_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4147,-13745.17 3785,-13745.17 3785,-13677.17 4147,-13677.17 4147,-13745.17"/>
<text text-anchor="middle" x="3966" y="-13729.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3966" y="-13714.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3966" y="-13699.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3966" y="-13684.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- input&#45;&gt;layer_0_add_norm1 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;layer_0_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4197.25,-14529.13C4197.25,-14347.12 4197.25,-13711 4197.25,-13711 4197.25,-13711 4157.07,-13711 4157.07,-13711"/>
<polygon fill="black" stroke="black" points="4157.07,-13707.5 4147.07,-13711 4157.07,-13714.5 4157.07,-13707.5"/>
<text text-anchor="middle" x="4296" y="-14133.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_0_attn -->
<g id="node3" class="node">
<title>layer_0_attn</title>
<polygon fill="lightblue" stroke="black" points="4150.5,-14171.17 3741.5,-14171.17 3741.5,-14103.17 4150.5,-14103.17 4150.5,-14171.17"/>
<text text-anchor="middle" x="3946" y="-14155.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3946" y="-14140.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3946" y="-14125.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3946" y="-14110.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_0_qkv&#45;&gt;layer_0_attn -->
<g id="edge2" class="edge">
<title>layer_0_qkv&#45;&gt;layer_0_attn</title>
<path fill="none" stroke="black" d="M3960,-14315.94C3960,-14315.94 3960,-14181.3 3960,-14181.3"/>
<polygon fill="black" stroke="black" points="3963.5,-14181.3 3960,-14171.3 3956.5,-14181.3 3963.5,-14181.3"/>
</g>
<!-- layer_0_proj -->
<g id="node4" class="node">
<title>layer_0_proj</title>
<polygon fill="lightblue" stroke="black" points="4161.5,-13958.17 3764.5,-13958.17 3764.5,-13890.17 4161.5,-13890.17 4161.5,-13958.17"/>
<text text-anchor="middle" x="3963" y="-13942.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3963" y="-13927.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3963" y="-13912.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3963" y="-13897.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_0_attn&#45;&gt;layer_0_proj -->
<g id="edge3" class="edge">
<title>layer_0_attn&#45;&gt;layer_0_proj</title>
<path fill="none" stroke="black" d="M3957.5,-14102.94C3957.5,-14102.94 3957.5,-13968.3 3957.5,-13968.3"/>
<polygon fill="black" stroke="black" points="3961,-13968.3 3957.5,-13958.3 3954,-13968.3 3961,-13968.3"/>
</g>
<!-- layer_0_proj&#45;&gt;layer_0_add_norm1 -->
<g id="edge4" class="edge">
<title>layer_0_proj&#45;&gt;layer_0_add_norm1</title>
<path fill="none" stroke="black" d="M3966,-13889.94C3966,-13889.94 3966,-13755.3 3966,-13755.3"/>
<polygon fill="black" stroke="black" points="3969.5,-13755.3 3966,-13745.3 3962.5,-13755.3 3969.5,-13755.3"/>
</g>
<!-- layer_0_gate -->
<g id="node6" class="node">
<title>layer_0_gate</title>
<polygon fill="yellow" stroke="black" points="3906.73,-13532.17 3329.71,-13532.17 3181.27,-13396.17 3758.29,-13396.17 3906.73,-13532.17"/>
<text text-anchor="middle" x="3544" y="-13482.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3544" y="-13467.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3544" y="-13452.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3544" y="-13437.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_gate -->
<g id="edge6" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" d="M3845.93,-13677.08C3845.93,-13677.08 3845.93,-13542.37 3845.93,-13542.37"/>
<polygon fill="black" stroke="black" points="3849.43,-13542.37 3845.93,-13532.37 3842.43,-13542.37 3849.43,-13542.37"/>
</g>
<!-- layer_0_moe_agg -->
<g id="node7" class="node">
<title>layer_0_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="4004,-13024.17 3642,-13024.17 3642,-12956.17 4004,-12956.17 4004,-13024.17"/>
<text text-anchor="middle" x="3823" y="-13008.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="3823" y="-12993.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3823" y="-12978.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3823" y="-12963.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_moe_agg -->
<g id="edge7" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M4147.01,-13680C4163.82,-13680 4174.72,-13680 4174.72,-13680 4174.72,-13680 4174.72,-12985 4174.72,-12985 4174.72,-12985 4014.01,-12985 4014.01,-12985"/>
<polygon fill="black" stroke="black" points="4014.01,-12981.5 4004.01,-12985 4014.01,-12988.5 4014.01,-12981.5"/>
</g>
<!-- layer_0_expert_0 -->
<g id="node8" class="node">
<title>layer_0_expert_0</title>
<polygon fill="lightblue" stroke="black" points="2058,-13237.17 1696,-13237.17 1696,-13169.17 2058,-13169.17 2058,-13237.17"/>
<text text-anchor="middle" x="1877" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1877" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_0 -->
<g id="edge9" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_0</title>
<path fill="none" stroke="black" d="M3784.76,-13707C3290.12,-13707 1953.67,-13707 1953.67,-13707 1953.67,-13707 1953.67,-13247.4 1953.67,-13247.4"/>
<polygon fill="black" stroke="black" points="1957.17,-13247.4 1953.67,-13237.4 1950.17,-13247.4 1957.17,-13247.4"/>
</g>
<!-- layer_0_expert_1 -->
<g id="node9" class="node">
<title>layer_0_expert_1</title>
<polygon fill="lightblue" stroke="black" points="2478,-13237.17 2116,-13237.17 2116,-13169.17 2478,-13169.17 2478,-13237.17"/>
<text text-anchor="middle" x="2297" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2297" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_1 -->
<g id="edge12" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_1</title>
<path fill="none" stroke="black" d="M3784.64,-13699C3373.3,-13699 2405,-13699 2405,-13699 2405,-13699 2405,-13247.25 2405,-13247.25"/>
<polygon fill="black" stroke="black" points="2408.5,-13247.25 2405,-13237.25 2401.5,-13247.25 2408.5,-13247.25"/>
</g>
<!-- layer_0_expert_2 -->
<g id="node10" class="node">
<title>layer_0_expert_2</title>
<polygon fill="lightblue" stroke="black" points="5418,-13237.17 5056,-13237.17 5056,-13169.17 5418,-13169.17 5418,-13237.17"/>
<text text-anchor="middle" x="5237" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5237" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_2 -->
<g id="edge15" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_2</title>
<path fill="none" stroke="black" d="M4147.28,-13696C4511.45,-13696 5297.33,-13696 5297.33,-13696 5297.33,-13696 5297.33,-13247.43 5297.33,-13247.43"/>
<polygon fill="black" stroke="black" points="5300.83,-13247.43 5297.33,-13237.43 5293.83,-13247.43 5300.83,-13247.43"/>
</g>
<!-- layer_0_expert_3 -->
<g id="node11" class="node">
<title>layer_0_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1218,-13237.17 856,-13237.17 856,-13169.17 1218,-13169.17 1218,-13237.17"/>
<text text-anchor="middle" x="1037" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1037" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_3 -->
<g id="edge18" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_3</title>
<path fill="none" stroke="black" d="M3784.91,-13722C3147.95,-13722 1049,-13722 1049,-13722 1049,-13722 1049,-13247.21 1049,-13247.21"/>
<polygon fill="black" stroke="black" points="1052.5,-13247.21 1049,-13237.21 1045.5,-13247.21 1052.5,-13247.21"/>
</g>
<!-- layer_0_expert_4 -->
<g id="node12" class="node">
<title>layer_0_expert_4</title>
<polygon fill="lightblue" stroke="black" points="1638,-13237.17 1276,-13237.17 1276,-13169.17 1638,-13169.17 1638,-13237.17"/>
<text text-anchor="middle" x="1457" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1457" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_4 -->
<g id="edge21" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_4</title>
<path fill="none" stroke="black" d="M3784.79,-13714C3215.68,-13714 1501.67,-13714 1501.67,-13714 1501.67,-13714 1501.67,-13247.48 1501.67,-13247.48"/>
<polygon fill="black" stroke="black" points="1505.17,-13247.48 1501.67,-13237.48 1498.17,-13247.48 1505.17,-13247.48"/>
</g>
<!-- layer_0_expert_5 -->
<g id="node13" class="node">
<title>layer_0_expert_5</title>
<polygon fill="lightblue" stroke="black" points="4158,-13237.17 3796,-13237.17 3796,-13169.17 4158,-13169.17 4158,-13237.17"/>
<text text-anchor="middle" x="3977" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3977" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_5 -->
<g id="edge24" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_5</title>
<path fill="none" stroke="black" d="M4066.95,-13677.05C4066.95,-13677.05 4066.95,-13247.47 4066.95,-13247.47"/>
<polygon fill="black" stroke="black" points="4070.45,-13247.47 4066.95,-13237.47 4063.45,-13247.47 4070.45,-13247.47"/>
</g>
<!-- layer_0_expert_6 -->
<g id="node14" class="node">
<title>layer_0_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2898,-13237.17 2536,-13237.17 2536,-13169.17 2898,-13169.17 2898,-13237.17"/>
<text text-anchor="middle" x="2717" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2717" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_6 -->
<g id="edge27" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_6</title>
<path fill="none" stroke="black" d="M3784.93,-13692C3470.4,-13692 2856.33,-13692 2856.33,-13692 2856.33,-13692 2856.33,-13247.54 2856.33,-13247.54"/>
<polygon fill="black" stroke="black" points="2859.83,-13247.54 2856.33,-13237.54 2852.83,-13247.54 2859.83,-13247.54"/>
</g>
<!-- layer_0_expert_7 -->
<g id="node15" class="node">
<title>layer_0_expert_7</title>
<polygon fill="lightblue" stroke="black" points="5838,-13237.17 5476,-13237.17 5476,-13169.17 5838,-13169.17 5838,-13237.17"/>
<text text-anchor="middle" x="5657" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5657" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_7 -->
<g id="edge30" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_7</title>
<path fill="none" stroke="black" d="M4147.24,-13699C4594.97,-13699 5717.33,-13699 5717.33,-13699 5717.33,-13699 5717.33,-13247.25 5717.33,-13247.25"/>
<polygon fill="black" stroke="black" points="5720.83,-13247.25 5717.33,-13237.25 5713.83,-13247.25 5720.83,-13247.25"/>
</g>
<!-- layer_0_expert_8 -->
<g id="node16" class="node">
<title>layer_0_expert_8</title>
<polygon fill="lightblue" stroke="black" points="378,-13237.17 16,-13237.17 16,-13169.17 378,-13169.17 378,-13237.17"/>
<text text-anchor="middle" x="197" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="197" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_8 -->
<g id="edge33" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_8</title>
<path fill="none" stroke="black" d="M3784.92,-13737C3025.71,-13737 138.33,-13737 138.33,-13737 138.33,-13737 138.33,-13247.37 138.33,-13247.37"/>
<polygon fill="black" stroke="black" points="141.83,-13247.37 138.33,-13237.37 134.83,-13247.37 141.83,-13247.37"/>
</g>
<!-- layer_0_expert_9 -->
<g id="node17" class="node">
<title>layer_0_expert_9</title>
<polygon fill="lightblue" stroke="black" points="6258,-13237.17 5896,-13237.17 5896,-13169.17 6258,-13169.17 6258,-13237.17"/>
<text text-anchor="middle" x="6077" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="6077" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_9 -->
<g id="edge36" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_9</title>
<path fill="none" stroke="black" d="M4147.39,-13703C4669.25,-13703 6137.33,-13703 6137.33,-13703 6137.33,-13703 6137.33,-13247.52 6137.33,-13247.52"/>
<polygon fill="black" stroke="black" points="6140.83,-13247.52 6137.33,-13237.52 6133.83,-13247.52 6140.83,-13247.52"/>
</g>
<!-- layer_0_expert_10 -->
<g id="node18" class="node">
<title>layer_0_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4998,-13237.17 4636,-13237.17 4636,-13169.17 4998,-13169.17 4998,-13237.17"/>
<text text-anchor="middle" x="4817" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4817" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_10 -->
<g id="edge39" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_10</title>
<path fill="none" stroke="black" d="M4147.14,-13692C4412.91,-13692 4877.33,-13692 4877.33,-13692 4877.33,-13692 4877.33,-13247.54 4877.33,-13247.54"/>
<polygon fill="black" stroke="black" points="4880.83,-13247.54 4877.33,-13237.54 4873.83,-13247.54 4880.83,-13247.54"/>
</g>
<!-- layer_0_expert_11 -->
<g id="node19" class="node">
<title>layer_0_expert_11</title>
<polygon fill="lightblue" stroke="black" points="798,-13237.17 436,-13237.17 436,-13169.17 798,-13169.17 798,-13237.17"/>
<text text-anchor="middle" x="617" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="617" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_11 -->
<g id="edge42" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_11</title>
<path fill="none" stroke="black" d="M3784.76,-13730C3084.57,-13730 595,-13730 595,-13730 595,-13730 595,-13247.33 595,-13247.33"/>
<polygon fill="black" stroke="black" points="598.5,-13247.33 595,-13237.33 591.5,-13247.33 598.5,-13247.33"/>
</g>
<!-- layer_0_expert_12 -->
<g id="node20" class="node">
<title>layer_0_expert_12</title>
<polygon fill="lightblue" stroke="black" points="3318,-13237.17 2956,-13237.17 2956,-13169.17 3318,-13169.17 3318,-13237.17"/>
<text text-anchor="middle" x="3137" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3137" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_12 -->
<g id="edge45" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_12</title>
<path fill="none" stroke="black" d="M3784.93,-13684C3522.78,-13684 3068.57,-13684 3068.57,-13684 3068.57,-13684 3068.57,-13247.36 3068.57,-13247.36"/>
<polygon fill="black" stroke="black" points="3072.07,-13247.36 3068.57,-13237.36 3065.07,-13247.36 3072.07,-13247.36"/>
</g>
<!-- layer_0_expert_13 -->
<g id="node21" class="node">
<title>layer_0_expert_13</title>
<polygon fill="lightblue" stroke="black" points="6678,-13237.17 6316,-13237.17 6316,-13169.17 6678,-13169.17 6678,-13237.17"/>
<text text-anchor="middle" x="6497" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6497" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_13 -->
<g id="edge48" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_13</title>
<path fill="none" stroke="black" d="M4147.19,-13707C4735.94,-13707 6557.33,-13707 6557.33,-13707 6557.33,-13707 6557.33,-13247.4 6557.33,-13247.4"/>
<polygon fill="black" stroke="black" points="6560.83,-13247.4 6557.33,-13237.4 6553.83,-13247.4 6560.83,-13247.4"/>
</g>
<!-- layer_0_expert_14 -->
<g id="node22" class="node">
<title>layer_0_expert_14</title>
<polygon fill="lightblue" stroke="black" points="4578,-13237.17 4216,-13237.17 4216,-13169.17 4578,-13169.17 4578,-13237.17"/>
<text text-anchor="middle" x="4397" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4397" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_14 -->
<g id="edge51" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_14</title>
<path fill="none" stroke="black" d="M4147.15,-13688C4250.9,-13688 4360.65,-13688 4360.65,-13688 4360.65,-13688 4360.65,-13247.26 4360.65,-13247.26"/>
<polygon fill="black" stroke="black" points="4364.15,-13247.26 4360.65,-13237.26 4357.15,-13247.26 4364.15,-13247.26"/>
</g>
<!-- layer_0_expert_15 -->
<g id="node23" class="node">
<title>layer_0_expert_15</title>
<polygon fill="lightblue" stroke="black" points="3738,-13237.17 3376,-13237.17 3376,-13169.17 3738,-13169.17 3738,-13237.17"/>
<text text-anchor="middle" x="3557" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3557" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_15 -->
<g id="edge54" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_15</title>
<path fill="none" stroke="black" d="M3986.91,-13677.06C3986.91,-13576.79 3986.91,-13290 3986.91,-13290 3986.91,-13290 3617.33,-13290 3617.33,-13290 3617.33,-13290 3617.33,-13247.49 3617.33,-13247.49"/>
<polygon fill="black" stroke="black" points="3620.83,-13247.49 3617.33,-13237.49 3613.83,-13247.49 3620.83,-13247.49"/>
</g>
<!-- layer_0_add_norm2 -->
<g id="node24" class="node">
<title>layer_0_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4058,-12811.17 3696,-12811.17 3696,-12743.17 4058,-12743.17 4058,-12811.17"/>
<text text-anchor="middle" x="3877" y="-12795.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3877" y="-12780.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3877" y="-12765.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3877" y="-12750.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_add_norm2 -->
<g id="edge57" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4147.33,-13684C4165.04,-13684 4176.61,-13684 4176.61,-13684 4176.61,-13684 4176.61,-12777 4176.61,-12777 4176.61,-12777 4068.2,-12777 4068.2,-12777"/>
<polygon fill="black" stroke="black" points="4068.2,-12773.5 4058.2,-12777 4068.2,-12780.5 4068.2,-12773.5"/>
<text text-anchor="middle" x="6883" y="-13199.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_0 -->
<g id="edge8" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3236.43,-13447C2787.55,-13447 2005.83,-13447 2005.83,-13447 2005.83,-13447 2005.83,-13247.33 2005.83,-13247.33"/>
<polygon fill="black" stroke="black" points="2009.33,-13247.33 2005.83,-13237.33 2002.33,-13247.33 2009.33,-13247.33"/>
<text text-anchor="middle" x="2449.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_1 -->
<g id="edge11" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3218.06,-13430C2892.93,-13430 2441.5,-13430 2441.5,-13430 2441.5,-13430 2441.5,-13247.62 2441.5,-13247.62"/>
<polygon fill="black" stroke="black" points="2445,-13247.62 2441.5,-13237.62 2438,-13247.62 2445,-13247.62"/>
<text text-anchor="middle" x="3015.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_2 -->
<g id="edge14" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3821.42,-13454C4287.36,-13454 5176.67,-13454 5176.67,-13454 5176.67,-13454 5176.67,-13247.26 5176.67,-13247.26"/>
<polygon fill="black" stroke="black" points="5180.17,-13247.26 5176.67,-13237.26 5173.17,-13247.26 5180.17,-13247.26"/>
<text text-anchor="middle" x="4592.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_3 -->
<g id="edge17" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3273.63,-13481C2644.09,-13481 1133.5,-13481 1133.5,-13481 1133.5,-13481 1133.5,-13247.23 1133.5,-13247.23"/>
<polygon fill="black" stroke="black" points="1137,-13247.23 1133.5,-13237.23 1130,-13247.23 1137,-13247.23"/>
<text text-anchor="middle" x="1655.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_4 -->
<g id="edge20" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3255.09,-13464C2706.85,-13464 1569.83,-13464 1569.83,-13464 1569.83,-13464 1569.83,-13247.27 1569.83,-13247.27"/>
<polygon fill="black" stroke="black" points="1573.33,-13247.27 1569.83,-13237.27 1566.33,-13247.27 1573.33,-13247.27"/>
<text text-anchor="middle" x="2223.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_5 -->
<g id="edge23" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3851.43,-13464.12C3851.43,-13464.12 3851.43,-13247.33 3851.43,-13247.33"/>
<polygon fill="black" stroke="black" points="3854.93,-13247.33 3851.43,-13237.33 3847.93,-13247.33 3854.93,-13247.33"/>
<text text-anchor="middle" x="3810.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_6 -->
<g id="edge26" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3199.35,-13413C3036.47,-13413 2877.17,-13413 2877.17,-13413 2877.17,-13413 2877.17,-13247.35 2877.17,-13247.35"/>
<polygon fill="black" stroke="black" points="2880.67,-13247.35 2877.17,-13237.35 2873.67,-13247.35 2880.67,-13247.35"/>
<text text-anchor="middle" x="3243.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_7 -->
<g id="edge29" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3842.2,-13473C4411.4,-13473 5596.67,-13473 5596.67,-13473 5596.67,-13473 5596.67,-13247.34 5596.67,-13247.34"/>
<polygon fill="black" stroke="black" points="5600.17,-13247.34 5596.67,-13237.34 5593.17,-13247.34 5600.17,-13247.34"/>
<text text-anchor="middle" x="5007.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_8 -->
<g id="edge32" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3310.65,-13515C2560.32,-13515 258.17,-13515 258.17,-13515 258.17,-13515 258.17,-13247.43 258.17,-13247.43"/>
<polygon fill="black" stroke="black" points="261.67,-13247.43 258.17,-13237.43 254.67,-13247.43 261.67,-13247.43"/>
<text text-anchor="middle" x="1023.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_9 -->
<g id="edge35" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3864.09,-13493C4532.83,-13493 6016.67,-13493 6016.67,-13493 6016.67,-13493 6016.67,-13247.27 6016.67,-13247.27"/>
<polygon fill="black" stroke="black" points="6020.17,-13247.27 6016.67,-13237.27 6013.17,-13247.27 6020.17,-13247.27"/>
<text text-anchor="middle" x="5367.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_10 -->
<g id="edge38" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3800.8,-13435C4156.73,-13435 4756.67,-13435 4756.67,-13435 4756.67,-13435 4756.67,-13247.37 4756.67,-13247.37"/>
<polygon fill="black" stroke="black" points="4760.17,-13247.37 4756.67,-13237.37 4753.17,-13247.37 4760.17,-13247.37"/>
<text text-anchor="middle" x="4235.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_11 -->
<g id="edge41" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3292.24,-13498C2596.12,-13498 696.5,-13498 696.5,-13498 696.5,-13498 696.5,-13247.28 696.5,-13247.28"/>
<polygon fill="black" stroke="black" points="700,-13247.28 696.5,-13237.28 693,-13247.28 700,-13247.28"/>
<text text-anchor="middle" x="1368.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_12 -->
<g id="edge44" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3249.57,-13395.93C3249.57,-13395.93 3249.57,-13247.49 3249.57,-13247.49"/>
<polygon fill="black" stroke="black" points="3253.07,-13247.49 3249.57,-13237.49 3246.07,-13247.49 3253.07,-13247.49"/>
<text text-anchor="middle" x="3395.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_13 -->
<g id="edge47" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3885.04,-13512C4650.09,-13512 6436.67,-13512 6436.67,-13512 6436.67,-13512 6436.67,-13247.4 6436.67,-13247.4"/>
<polygon fill="black" stroke="black" points="6440.17,-13247.4 6436.67,-13237.4 6433.17,-13247.4 6440.17,-13247.4"/>
<text text-anchor="middle" x="5595.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_14 -->
<g id="edge50" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3779,-13415C3997.12,-13415 4288.32,-13415 4288.32,-13415 4288.32,-13415 4288.32,-13247.2 4288.32,-13247.2"/>
<polygon fill="black" stroke="black" points="4291.82,-13247.2 4288.32,-13237.2 4284.82,-13247.2 4291.82,-13247.2"/>
<text text-anchor="middle" x="4056.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_15 -->
<g id="edge53" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3496.67,-13395.93C3496.67,-13395.93 3496.67,-13247.49 3496.67,-13247.49"/>
<polygon fill="black" stroke="black" points="3500.17,-13247.49 3496.67,-13237.49 3493.17,-13247.49 3500.17,-13247.49"/>
<text text-anchor="middle" x="3574.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_0_moe_agg&#45;&gt;layer_0_add_norm2 -->
<g id="edge56" class="edge">
<title>layer_0_moe_agg&#45;&gt;layer_0_add_norm2</title>
<path fill="none" stroke="black" d="M3850,-12955.94C3850,-12955.94 3850,-12821.3 3850,-12821.3"/>
<polygon fill="black" stroke="black" points="3853.5,-12821.3 3850,-12811.3 3846.5,-12821.3 3853.5,-12821.3"/>
</g>
<!-- layer_0_expert_0&#45;&gt;layer_0_moe_agg -->
<g id="edge10" class="edge">
<title>layer_0_expert_0&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1877,-13168.93C1877,-13109.38 1877,-12993 1877,-12993 1877,-12993 3631.67,-12993 3631.67,-12993"/>
<polygon fill="black" stroke="black" points="3631.67,-12996.5 3641.67,-12993 3631.67,-12989.5 3631.67,-12996.5"/>
</g>
<!-- layer_0_expert_1&#45;&gt;layer_0_moe_agg -->
<g id="edge13" class="edge">
<title>layer_0_expert_1&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M2297,-13168.87C2297,-13111.19 2297,-13001 2297,-13001 2297,-13001 3631.96,-13001 3631.96,-13001"/>
<polygon fill="black" stroke="black" points="3631.96,-13004.5 3641.96,-13001 3631.96,-12997.5 3631.96,-13004.5"/>
</g>
<!-- layer_0_expert_2&#45;&gt;layer_0_moe_agg -->
<g id="edge16" class="edge">
<title>layer_0_expert_2&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M5327.5,-13168.71C5327.5,-13104.5 5327.5,-12973 5327.5,-12973 5327.5,-12973 4014.1,-12973 4014.1,-12973"/>
<polygon fill="black" stroke="black" points="4014.1,-12969.5 4004.1,-12973 4014.1,-12976.5 4014.1,-12969.5"/>
</g>
<!-- layer_0_expert_3&#45;&gt;layer_0_moe_agg -->
<g id="edge19" class="edge">
<title>layer_0_expert_3&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1037,-13168.97C1037,-13105.98 1037,-12978 1037,-12978 1037,-12978 3631.81,-12978 3631.81,-12978"/>
<polygon fill="black" stroke="black" points="3631.81,-12981.5 3641.81,-12978 3631.81,-12974.5 3631.81,-12981.5"/>
</g>
<!-- layer_0_expert_4&#45;&gt;layer_0_moe_agg -->
<g id="edge22" class="edge">
<title>layer_0_expert_4&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1457,-13168.76C1457,-13107.52 1457,-12986 1457,-12986 1457,-12986 3631.76,-12986 3631.76,-12986"/>
<polygon fill="black" stroke="black" points="3631.76,-12989.5 3641.76,-12986 3631.76,-12982.5 3631.76,-12989.5"/>
</g>
<!-- layer_0_expert_5&#45;&gt;layer_0_moe_agg -->
<g id="edge25" class="edge">
<title>layer_0_expert_5&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M3900,-13168.94C3900,-13168.94 3900,-13034.3 3900,-13034.3"/>
<polygon fill="black" stroke="black" points="3903.5,-13034.3 3900,-13024.3 3896.5,-13034.3 3903.5,-13034.3"/>
</g>
<!-- layer_0_expert_6&#45;&gt;layer_0_moe_agg -->
<g id="edge28" class="edge">
<title>layer_0_expert_6&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M2717,-13168.9C2717,-13113.16 2717,-13009 2717,-13009 2717,-13009 3631.91,-13009 3631.91,-13009"/>
<polygon fill="black" stroke="black" points="3631.91,-13012.5 3641.91,-13009 3631.91,-13005.5 3631.91,-13012.5"/>
</g>
<!-- layer_0_expert_7&#45;&gt;layer_0_moe_agg -->
<g id="edge31" class="edge">
<title>layer_0_expert_7&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M5747.5,-13168.97C5747.5,-13103.75 5747.5,-12968 5747.5,-12968 5747.5,-12968 4014.05,-12968 4014.05,-12968"/>
<polygon fill="black" stroke="black" points="4014.05,-12964.5 4004.05,-12968 4014.05,-12971.5 4014.05,-12964.5"/>
</g>
<!-- layer_0_expert_8&#45;&gt;layer_0_moe_agg -->
<g id="edge34" class="edge">
<title>layer_0_expert_8&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M197,-13169.01C197,-13102.71 197,-12963 197,-12963 197,-12963 3631.95,-12963 3631.95,-12963"/>
<polygon fill="black" stroke="black" points="3631.95,-12966.5 3641.95,-12963 3631.95,-12959.5 3631.95,-12966.5"/>
</g>
<!-- layer_0_expert_9&#45;&gt;layer_0_moe_agg -->
<g id="edge37" class="edge">
<title>layer_0_expert_9&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M6167.5,-13169.15C6167.5,-13103.12 6167.5,-12964 6167.5,-12964 6167.5,-12964 4014.05,-12964 4014.05,-12964"/>
<polygon fill="black" stroke="black" points="4014.05,-12960.5 4004.05,-12964 4014.05,-12967.5 4014.05,-12960.5"/>
</g>
<!-- layer_0_expert_10&#45;&gt;layer_0_moe_agg -->
<g id="edge40" class="edge">
<title>layer_0_expert_10&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M4907.5,-13168.82C4907.5,-13105.55 4907.5,-12977 4907.5,-12977 4907.5,-12977 4014.22,-12977 4014.22,-12977"/>
<polygon fill="black" stroke="black" points="4014.22,-12973.5 4004.22,-12977 4014.22,-12980.5 4014.22,-12973.5"/>
</g>
<!-- layer_0_expert_11&#45;&gt;layer_0_moe_agg -->
<g id="edge43" class="edge">
<title>layer_0_expert_11&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M617,-13168.91C617,-13104.33 617,-12971 617,-12971 617,-12971 3631.74,-12971 3631.74,-12971"/>
<polygon fill="black" stroke="black" points="3631.74,-12974.5 3641.74,-12971 3631.74,-12967.5 3631.74,-12974.5"/>
</g>
<!-- layer_0_expert_12&#45;&gt;layer_0_moe_agg -->
<g id="edge46" class="edge">
<title>layer_0_expert_12&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M3194.57,-13168.84C3194.57,-13114.8 3194.57,-13016 3194.57,-13016 3194.57,-13016 3631.65,-13016 3631.65,-13016"/>
<polygon fill="black" stroke="black" points="3631.65,-13019.5 3641.65,-13016 3631.65,-13012.5 3631.65,-13019.5"/>
</g>
<!-- layer_0_expert_13&#45;&gt;layer_0_moe_agg -->
<g id="edge49" class="edge">
<title>layer_0_expert_13&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M6587.5,-13169.1C6587.5,-13102.18 6587.5,-12960 6587.5,-12960 6587.5,-12960 4014.12,-12960 4014.12,-12960"/>
<polygon fill="black" stroke="black" points="4014.12,-12956.5 4004.12,-12960 4014.12,-12963.5 4014.12,-12956.5"/>
</g>
<!-- layer_0_expert_14&#45;&gt;layer_0_moe_agg -->
<g id="edge52" class="edge">
<title>layer_0_expert_14&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M4487.5,-13168.94C4487.5,-13106.62 4487.5,-12981 4487.5,-12981 4487.5,-12981 4014.14,-12981 4014.14,-12981"/>
<polygon fill="black" stroke="black" points="4014.14,-12977.5 4004.14,-12981 4014.14,-12984.5 4014.14,-12977.5"/>
</g>
<!-- layer_0_expert_15&#45;&gt;layer_0_moe_agg -->
<g id="edge55" class="edge">
<title>layer_0_expert_15&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M3690,-13168.94C3690,-13168.94 3690,-13034.3 3690,-13034.3"/>
<polygon fill="black" stroke="black" points="3693.5,-13034.3 3690,-13024.3 3686.5,-13034.3 3693.5,-13034.3"/>
</g>
<!-- layer_1_qkv -->
<g id="node25" class="node">
<title>layer_1_qkv</title>
<polygon fill="lightblue" stroke="black" points="3862.5,-12598.17 3453.5,-12598.17 3453.5,-12530.17 3862.5,-12530.17 3862.5,-12598.17"/>
<text text-anchor="middle" x="3658" y="-12582.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3658" y="-12567.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3658" y="-12552.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3658" y="-12537.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_0_add_norm2&#45;&gt;layer_1_qkv -->
<g id="edge58" class="edge">
<title>layer_0_add_norm2&#45;&gt;layer_1_qkv</title>
<path fill="none" stroke="black" d="M3779.25,-12742.94C3779.25,-12742.94 3779.25,-12608.3 3779.25,-12608.3"/>
<polygon fill="black" stroke="black" points="3782.75,-12608.3 3779.25,-12598.3 3775.75,-12608.3 3782.75,-12608.3"/>
</g>
<!-- layer_1_add_norm1 -->
<g id="node28" class="node">
<title>layer_1_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4037,-11959.17 3675,-11959.17 3675,-11891.17 4037,-11891.17 4037,-11959.17"/>
<text text-anchor="middle" x="3856" y="-11943.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3856" y="-11928.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3856" y="-11913.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3856" y="-11898.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_0_add_norm2&#45;&gt;layer_1_add_norm1 -->
<g id="edge62" class="edge">
<title>layer_0_add_norm2&#45;&gt;layer_1_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3955.75,-12742.98C3955.75,-12742.98 3955.75,-11969.62 3955.75,-11969.62"/>
<polygon fill="black" stroke="black" points="3959.25,-11969.62 3955.75,-11959.62 3952.25,-11969.62 3959.25,-11969.62"/>
<text text-anchor="middle" x="3979" y="-12347.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_1_attn -->
<g id="node26" class="node">
<title>layer_1_attn</title>
<polygon fill="lightblue" stroke="black" points="3833.5,-12385.17 3424.5,-12385.17 3424.5,-12317.17 3833.5,-12317.17 3833.5,-12385.17"/>
<text text-anchor="middle" x="3629" y="-12369.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3629" y="-12354.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3629" y="-12339.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3629" y="-12324.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_1_qkv&#45;&gt;layer_1_attn -->
<g id="edge59" class="edge">
<title>layer_1_qkv&#45;&gt;layer_1_attn</title>
<path fill="none" stroke="black" d="M3643.5,-12529.94C3643.5,-12529.94 3643.5,-12395.3 3643.5,-12395.3"/>
<polygon fill="black" stroke="black" points="3647,-12395.3 3643.5,-12385.3 3640,-12395.3 3647,-12395.3"/>
</g>
<!-- layer_1_proj -->
<g id="node27" class="node">
<title>layer_1_proj</title>
<polygon fill="lightblue" stroke="black" points="3874.5,-12172.17 3477.5,-12172.17 3477.5,-12104.17 3874.5,-12104.17 3874.5,-12172.17"/>
<text text-anchor="middle" x="3676" y="-12156.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3676" y="-12141.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3676" y="-12126.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3676" y="-12111.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_1_attn&#45;&gt;layer_1_proj -->
<g id="edge60" class="edge">
<title>layer_1_attn&#45;&gt;layer_1_proj</title>
<path fill="none" stroke="black" d="M3655.5,-12316.94C3655.5,-12316.94 3655.5,-12182.3 3655.5,-12182.3"/>
<polygon fill="black" stroke="black" points="3659,-12182.3 3655.5,-12172.3 3652,-12182.3 3659,-12182.3"/>
</g>
<!-- layer_1_proj&#45;&gt;layer_1_add_norm1 -->
<g id="edge61" class="edge">
<title>layer_1_proj&#45;&gt;layer_1_add_norm1</title>
<path fill="none" stroke="black" d="M3774.75,-12103.94C3774.75,-12103.94 3774.75,-11969.3 3774.75,-11969.3"/>
<polygon fill="black" stroke="black" points="3778.25,-11969.3 3774.75,-11959.3 3771.25,-11969.3 3778.25,-11969.3"/>
</g>
<!-- layer_1_gate -->
<g id="node29" class="node">
<title>layer_1_gate</title>
<polygon fill="yellow" stroke="black" points="3796.73,-11746.17 3219.71,-11746.17 3071.27,-11610.17 3648.29,-11610.17 3796.73,-11746.17"/>
<text text-anchor="middle" x="3434" y="-11696.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3434" y="-11681.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-11666.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3434" y="-11651.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_gate -->
<g id="edge63" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" d="M3735.93,-11891.08C3735.93,-11891.08 3735.93,-11756.37 3735.93,-11756.37"/>
<polygon fill="black" stroke="black" points="3739.43,-11756.37 3735.93,-11746.37 3732.43,-11756.37 3739.43,-11756.37"/>
</g>
<!-- layer_1_moe_agg -->
<g id="node30" class="node">
<title>layer_1_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="4014,-11238.17 3652,-11238.17 3652,-11170.17 4014,-11170.17 4014,-11238.17"/>
<text text-anchor="middle" x="3833" y="-11222.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="3833" y="-11207.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3833" y="-11192.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3833" y="-11177.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_moe_agg -->
<g id="edge64" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M3916.93,-11891.02C3916.93,-11788.43 3916.93,-11490 3916.93,-11490 3916.93,-11490 3757.33,-11490 3757.33,-11490 3757.33,-11490 3757.33,-11248.36 3757.33,-11248.36"/>
<polygon fill="black" stroke="black" points="3760.83,-11248.36 3757.33,-11238.36 3753.83,-11248.36 3760.83,-11248.36"/>
</g>
<!-- layer_1_expert_0 -->
<g id="node31" class="node">
<title>layer_1_expert_0</title>
<polygon fill="lightblue" stroke="black" points="2058,-11451.17 1696,-11451.17 1696,-11383.17 2058,-11383.17 2058,-11451.17"/>
<text text-anchor="middle" x="1877" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1877" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_0 -->
<g id="edge66" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_0</title>
<path fill="none" stroke="black" d="M3674.61,-11921C3169.99,-11921 1786.5,-11921 1786.5,-11921 1786.5,-11921 1786.5,-11461.4 1786.5,-11461.4"/>
<polygon fill="black" stroke="black" points="1790,-11461.4 1786.5,-11451.4 1783,-11461.4 1790,-11461.4"/>
</g>
<!-- layer_1_expert_1 -->
<g id="node32" class="node">
<title>layer_1_expert_1</title>
<polygon fill="lightblue" stroke="black" points="2478,-11451.17 2116,-11451.17 2116,-11383.17 2478,-11383.17 2478,-11451.17"/>
<text text-anchor="middle" x="2297" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2297" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_1 -->
<g id="edge69" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_1</title>
<path fill="none" stroke="black" d="M3674.76,-11913C3246.26,-11913 2206.5,-11913 2206.5,-11913 2206.5,-11913 2206.5,-11461.25 2206.5,-11461.25"/>
<polygon fill="black" stroke="black" points="2210,-11461.25 2206.5,-11451.25 2203,-11461.25 2210,-11461.25"/>
</g>
<!-- layer_1_expert_2 -->
<g id="node33" class="node">
<title>layer_1_expert_2</title>
<polygon fill="lightblue" stroke="black" points="5418,-11451.17 5056,-11451.17 5056,-11383.17 5418,-11383.17 5418,-11451.17"/>
<text text-anchor="middle" x="5237" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5237" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_2 -->
<g id="edge72" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_2</title>
<path fill="none" stroke="black" d="M4037.25,-11916C4411.92,-11916 5237,-11916 5237,-11916 5237,-11916 5237,-11461.45 5237,-11461.45"/>
<polygon fill="black" stroke="black" points="5240.5,-11461.45 5237,-11451.45 5233.5,-11461.45 5240.5,-11461.45"/>
</g>
<!-- layer_1_expert_3 -->
<g id="node34" class="node">
<title>layer_1_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1218,-11451.17 856,-11451.17 856,-11383.17 1218,-11383.17 1218,-11451.17"/>
<text text-anchor="middle" x="1037" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1037" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_3 -->
<g id="edge75" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_3</title>
<path fill="none" stroke="black" d="M3674.82,-11936C3038.84,-11936 946.5,-11936 946.5,-11936 946.5,-11936 946.5,-11461.21 946.5,-11461.21"/>
<polygon fill="black" stroke="black" points="950,-11461.21 946.5,-11451.21 943,-11461.21 950,-11461.21"/>
</g>
<!-- layer_1_expert_4 -->
<g id="node35" class="node">
<title>layer_1_expert_4</title>
<polygon fill="lightblue" stroke="black" points="1638,-11451.17 1276,-11451.17 1276,-11383.17 1638,-11383.17 1638,-11451.17"/>
<text text-anchor="middle" x="1457" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1457" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_4 -->
<g id="edge78" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_4</title>
<path fill="none" stroke="black" d="M3674.96,-11928C3102.08,-11928 1366.5,-11928 1366.5,-11928 1366.5,-11928 1366.5,-11461.48 1366.5,-11461.48"/>
<polygon fill="black" stroke="black" points="1370,-11461.48 1366.5,-11451.48 1363,-11461.48 1370,-11461.48"/>
</g>
<!-- layer_1_expert_5 -->
<g id="node36" class="node">
<title>layer_1_expert_5</title>
<polygon fill="lightblue" stroke="black" points="4158,-11451.17 3796,-11451.17 3796,-11383.17 4158,-11383.17 4158,-11451.17"/>
<text text-anchor="middle" x="3977" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3977" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_5 -->
<g id="edge81" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_5</title>
<path fill="none" stroke="black" d="M3976.97,-11891.05C3976.97,-11891.05 3976.97,-11461.47 3976.97,-11461.47"/>
<polygon fill="black" stroke="black" points="3980.47,-11461.47 3976.97,-11451.47 3973.47,-11461.47 3980.47,-11461.47"/>
</g>
<!-- layer_1_expert_6 -->
<g id="node37" class="node">
<title>layer_1_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2898,-11451.17 2536,-11451.17 2536,-11383.17 2898,-11383.17 2898,-11451.17"/>
<text text-anchor="middle" x="2717" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2717" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_6 -->
<g id="edge84" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_6</title>
<path fill="none" stroke="black" d="M3674.91,-11906C3333.03,-11906 2626.5,-11906 2626.5,-11906 2626.5,-11906 2626.5,-11461.54 2626.5,-11461.54"/>
<polygon fill="black" stroke="black" points="2630,-11461.54 2626.5,-11451.54 2623,-11461.54 2630,-11461.54"/>
</g>
<!-- layer_1_expert_7 -->
<g id="node38" class="node">
<title>layer_1_expert_7</title>
<polygon fill="lightblue" stroke="black" points="5838,-11451.17 5476,-11451.17 5476,-11383.17 5838,-11383.17 5838,-11451.17"/>
<text text-anchor="middle" x="5657" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5657" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_7 -->
<g id="edge87" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_7</title>
<path fill="none" stroke="black" d="M4037.35,-11925C4494.35,-11925 5657,-11925 5657,-11925 5657,-11925 5657,-11461.28 5657,-11461.28"/>
<polygon fill="black" stroke="black" points="5660.5,-11461.28 5657,-11451.28 5653.5,-11461.28 5660.5,-11461.28"/>
</g>
<!-- layer_1_expert_8 -->
<g id="node39" class="node">
<title>layer_1_expert_8</title>
<polygon fill="lightblue" stroke="black" points="378,-11451.17 16,-11451.17 16,-11383.17 378,-11383.17 378,-11451.17"/>
<text text-anchor="middle" x="197" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="197" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_8 -->
<g id="edge90" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_8</title>
<path fill="none" stroke="black" d="M3674.84,-11951C2925.38,-11951 106.5,-11951 106.5,-11951 106.5,-11951 106.5,-11461.37 106.5,-11461.37"/>
<polygon fill="black" stroke="black" points="110,-11461.37 106.5,-11451.37 103,-11461.37 110,-11461.37"/>
</g>
<!-- layer_1_expert_9 -->
<g id="node40" class="node">
<title>layer_1_expert_9</title>
<polygon fill="lightblue" stroke="black" points="6258,-11451.17 5896,-11451.17 5896,-11383.17 6258,-11383.17 6258,-11451.17"/>
<text text-anchor="middle" x="6077" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="6077" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_9 -->
<g id="edge93" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_9</title>
<path fill="none" stroke="black" d="M4037.28,-11933C4567.3,-11933 6077,-11933 6077,-11933 6077,-11933 6077,-11461.41 6077,-11461.41"/>
<polygon fill="black" stroke="black" points="6080.5,-11461.41 6077,-11451.41 6073.5,-11461.41 6080.5,-11461.41"/>
</g>
<!-- layer_1_expert_10 -->
<g id="node41" class="node">
<title>layer_1_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4998,-11451.17 4636,-11451.17 4636,-11383.17 4998,-11383.17 4998,-11451.17"/>
<text text-anchor="middle" x="4817" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4817" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_10 -->
<g id="edge96" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_10</title>
<path fill="none" stroke="black" d="M4037.04,-11908C4315.47,-11908 4817,-11908 4817,-11908 4817,-11908 4817,-11461.29 4817,-11461.29"/>
<polygon fill="black" stroke="black" points="4820.5,-11461.29 4817,-11451.29 4813.5,-11461.29 4820.5,-11461.29"/>
</g>
<!-- layer_1_expert_11 -->
<g id="node42" class="node">
<title>layer_1_expert_11</title>
<polygon fill="lightblue" stroke="black" points="798,-11451.17 436,-11451.17 436,-11383.17 798,-11383.17 798,-11451.17"/>
<text text-anchor="middle" x="617" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="617" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_11 -->
<g id="edge99" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_11</title>
<path fill="none" stroke="black" d="M3674.92,-11944C2980.53,-11944 526.5,-11944 526.5,-11944 526.5,-11944 526.5,-11461.33 526.5,-11461.33"/>
<polygon fill="black" stroke="black" points="530,-11461.33 526.5,-11451.33 523,-11461.33 530,-11461.33"/>
</g>
<!-- layer_1_expert_12 -->
<g id="node43" class="node">
<title>layer_1_expert_12</title>
<polygon fill="lightblue" stroke="black" points="3318,-11451.17 2956,-11451.17 2956,-11383.17 3318,-11383.17 3318,-11451.17"/>
<text text-anchor="middle" x="3137" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3137" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_12 -->
<g id="edge102" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_12</title>
<path fill="none" stroke="black" d="M3674.76,-11898C3427.17,-11898 3013.57,-11898 3013.57,-11898 3013.57,-11898 3013.57,-11461.36 3013.57,-11461.36"/>
<polygon fill="black" stroke="black" points="3017.07,-11461.36 3013.57,-11451.36 3010.07,-11461.36 3017.07,-11461.36"/>
</g>
<!-- layer_1_expert_13 -->
<g id="node44" class="node">
<title>layer_1_expert_13</title>
<polygon fill="lightblue" stroke="black" points="6678,-11451.17 6316,-11451.17 6316,-11383.17 6678,-11383.17 6678,-11451.17"/>
<text text-anchor="middle" x="6497" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6497" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_13 -->
<g id="edge105" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_13</title>
<path fill="none" stroke="black" d="M4037.01,-11942C4633.12,-11942 6497,-11942 6497,-11942 6497,-11942 6497,-11461.2 6497,-11461.2"/>
<polygon fill="black" stroke="black" points="6500.5,-11461.2 6497,-11451.2 6493.5,-11461.2 6500.5,-11461.2"/>
</g>
<!-- layer_1_expert_14 -->
<g id="node45" class="node">
<title>layer_1_expert_14</title>
<polygon fill="lightblue" stroke="black" points="4578,-11451.17 4216,-11451.17 4216,-11383.17 4578,-11383.17 4578,-11451.17"/>
<text text-anchor="middle" x="4397" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4397" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_14 -->
<g id="edge108" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_14</title>
<path fill="none" stroke="black" d="M4037.27,-11899C4194.49,-11899 4397,-11899 4397,-11899 4397,-11899 4397,-11461.43 4397,-11461.43"/>
<polygon fill="black" stroke="black" points="4400.5,-11461.43 4397,-11451.43 4393.5,-11461.43 4400.5,-11461.43"/>
</g>
<!-- layer_1_expert_15 -->
<g id="node46" class="node">
<title>layer_1_expert_15</title>
<polygon fill="lightblue" stroke="black" points="3738,-11451.17 3376,-11451.17 3376,-11383.17 3738,-11383.17 3738,-11451.17"/>
<text text-anchor="middle" x="3557" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3557" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_expert_15 -->
<g id="edge111" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_expert_15</title>
<path fill="none" stroke="black" d="M3856.9,-11891.13C3856.9,-11795.28 3856.9,-11530 3856.9,-11530 3856.9,-11530 3617.33,-11530 3617.33,-11530 3617.33,-11530 3617.33,-11461.33 3617.33,-11461.33"/>
<polygon fill="black" stroke="black" points="3620.83,-11461.33 3617.33,-11451.33 3613.83,-11461.33 3620.83,-11461.33"/>
</g>
<!-- layer_1_add_norm2 -->
<g id="node47" class="node">
<title>layer_1_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4084,-11025.17 3722,-11025.17 3722,-10957.17 4084,-10957.17 4084,-11025.17"/>
<text text-anchor="middle" x="3903" y="-11009.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3903" y="-10994.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3903" y="-10979.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3903" y="-10964.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_1_add_norm1&#45;&gt;layer_1_add_norm2 -->
<g id="edge114" class="edge">
<title>layer_1_add_norm1&#45;&gt;layer_1_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4037.25,-11895C4104.75,-11895 4165.28,-11895 4165.28,-11895 4165.28,-11895 4165.28,-10991 4165.28,-10991 4165.28,-10991 4094.09,-10991 4094.09,-10991"/>
<polygon fill="black" stroke="black" points="4094.09,-10987.5 4084.09,-10991 4094.09,-10994.5 4094.09,-10987.5"/>
<text text-anchor="middle" x="6883" y="-11413.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_0 -->
<g id="edge65" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3126.57,-11661C2696.55,-11661 1967.5,-11661 1967.5,-11661 1967.5,-11661 1967.5,-11461.33 1967.5,-11461.33"/>
<polygon fill="black" stroke="black" points="1971,-11461.33 1967.5,-11451.33 1964,-11461.33 1971,-11461.33"/>
<text text-anchor="middle" x="2688.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_1 -->
<g id="edge68" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3107.9,-11644C2800.77,-11644 2387.5,-11644 2387.5,-11644 2387.5,-11644 2387.5,-11461.62 2387.5,-11461.62"/>
<polygon fill="black" stroke="black" points="2391,-11461.62 2387.5,-11451.62 2384,-11461.62 2391,-11461.62"/>
<text text-anchor="middle" x="2934.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_2 -->
<g id="edge71" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3711.52,-11668C4196.34,-11668 5146.5,-11668 5146.5,-11668 5146.5,-11668 5146.5,-11461.26 5146.5,-11461.26"/>
<polygon fill="black" stroke="black" points="5150,-11461.26 5146.5,-11451.26 5143,-11461.26 5150,-11461.26"/>
<text text-anchor="middle" x="4505.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_3 -->
<g id="edge74" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3163.77,-11695C2554.7,-11695 1127.5,-11695 1127.5,-11695 1127.5,-11695 1127.5,-11461.23 1127.5,-11461.23"/>
<polygon fill="black" stroke="black" points="1131,-11461.23 1127.5,-11451.23 1124,-11461.23 1131,-11461.23"/>
<text text-anchor="middle" x="2069.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_4 -->
<g id="edge77" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3145.17,-11678C2616.62,-11678 1547.5,-11678 1547.5,-11678 1547.5,-11678 1547.5,-11461.27 1547.5,-11461.27"/>
<polygon fill="black" stroke="black" points="1551,-11461.27 1547.5,-11451.27 1544,-11461.27 1551,-11461.27"/>
<text text-anchor="middle" x="2435.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_5 -->
<g id="edge80" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3776.67,-11678.12C3776.67,-11674.1 3776.67,-11417 3776.67,-11417 3776.67,-11417 3785.88,-11417 3785.88,-11417"/>
<polygon fill="black" stroke="black" points="3785.88,-11420.5 3795.88,-11417 3785.88,-11413.5 3785.88,-11420.5"/>
<text text-anchor="middle" x="3762.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_6 -->
<g id="edge83" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3089.59,-11627C2944.01,-11627 2807.5,-11627 2807.5,-11627 2807.5,-11627 2807.5,-11461.35 2807.5,-11461.35"/>
<polygon fill="black" stroke="black" points="2811,-11461.35 2807.5,-11451.35 2804,-11461.35 2811,-11461.35"/>
<text text-anchor="middle" x="3223.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_7 -->
<g id="edge86" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3732.2,-11687C4318.86,-11687 5566.5,-11687 5566.5,-11687 5566.5,-11687 5566.5,-11461.34 5566.5,-11461.34"/>
<polygon fill="black" stroke="black" points="5570,-11461.34 5566.5,-11451.34 5563,-11461.34 5570,-11461.34"/>
<text text-anchor="middle" x="4962.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_8 -->
<g id="edge89" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3200.71,-11729C2472.14,-11729 287.5,-11729 287.5,-11729 287.5,-11729 287.5,-11461.43 287.5,-11461.43"/>
<polygon fill="black" stroke="black" points="291,-11461.43 287.5,-11451.43 284,-11461.43 291,-11461.43"/>
<text text-anchor="middle" x="1043.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_9 -->
<g id="edge92" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3754.05,-11707C4439.27,-11707 5986.5,-11707 5986.5,-11707 5986.5,-11707 5986.5,-11461.27 5986.5,-11461.27"/>
<polygon fill="black" stroke="black" points="5990,-11461.27 5986.5,-11451.27 5983,-11461.27 5990,-11461.27"/>
<text text-anchor="middle" x="5415.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_10 -->
<g id="edge95" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3690.9,-11649C4067.83,-11649 4726.5,-11649 4726.5,-11649 4726.5,-11649 4726.5,-11461.37 4726.5,-11461.37"/>
<polygon fill="black" stroke="black" points="4730,-11461.37 4726.5,-11451.37 4723,-11461.37 4730,-11461.37"/>
<text text-anchor="middle" x="4217.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_11 -->
<g id="edge98" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3182.38,-11712C2507.42,-11712 707.5,-11712 707.5,-11712 707.5,-11712 707.5,-11461.28 707.5,-11461.28"/>
<polygon fill="black" stroke="black" points="711,-11461.28 707.5,-11451.28 704,-11461.28 711,-11461.28"/>
<text text-anchor="middle" x="1353.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_12 -->
<g id="edge101" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3194.57,-11609.93C3194.57,-11609.93 3194.57,-11461.49 3194.57,-11461.49"/>
<polygon fill="black" stroke="black" points="3198.07,-11461.49 3194.57,-11451.49 3191.07,-11461.49 3198.07,-11461.49"/>
<text text-anchor="middle" x="3400.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_13 -->
<g id="edge104" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3774.98,-11726C4555.76,-11726 6406.5,-11726 6406.5,-11726 6406.5,-11726 6406.5,-11461.4 6406.5,-11461.4"/>
<polygon fill="black" stroke="black" points="6410,-11461.4 6406.5,-11451.4 6403,-11461.4 6410,-11461.4"/>
<text text-anchor="middle" x="5743.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_14 -->
<g id="edge107" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3668.96,-11629C3927.38,-11629 4306.5,-11629 4306.5,-11629 4306.5,-11629 4306.5,-11461.2 4306.5,-11461.2"/>
<polygon fill="black" stroke="black" points="4310,-11461.2 4306.5,-11451.2 4303,-11461.2 4310,-11461.2"/>
<text text-anchor="middle" x="3946.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_15 -->
<g id="edge110" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3496.67,-11609.93C3496.67,-11609.93 3496.67,-11461.49 3496.67,-11461.49"/>
<polygon fill="black" stroke="black" points="3500.17,-11461.49 3496.67,-11451.49 3493.17,-11461.49 3500.17,-11461.49"/>
<text text-anchor="middle" x="3579.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_1_moe_agg&#45;&gt;layer_1_add_norm2 -->
<g id="edge113" class="edge">
<title>layer_1_moe_agg&#45;&gt;layer_1_add_norm2</title>
<path fill="none" stroke="black" d="M3868,-11169.94C3868,-11169.94 3868,-11035.3 3868,-11035.3"/>
<polygon fill="black" stroke="black" points="3871.5,-11035.3 3868,-11025.3 3864.5,-11035.3 3871.5,-11035.3"/>
</g>
<!-- layer_1_expert_0&#45;&gt;layer_1_moe_agg -->
<g id="edge67" class="edge">
<title>layer_1_expert_0&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M1877,-11382.93C1877,-11323.38 1877,-11207 1877,-11207 1877,-11207 3641.62,-11207 3641.62,-11207"/>
<polygon fill="black" stroke="black" points="3641.62,-11210.5 3651.62,-11207 3641.62,-11203.5 3641.62,-11210.5"/>
</g>
<!-- layer_1_expert_1&#45;&gt;layer_1_moe_agg -->
<g id="edge70" class="edge">
<title>layer_1_expert_1&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M2297,-11382.87C2297,-11325.19 2297,-11215 2297,-11215 2297,-11215 3641.91,-11215 3641.91,-11215"/>
<polygon fill="black" stroke="black" points="3641.91,-11218.5 3651.91,-11215 3641.91,-11211.5 3641.91,-11218.5"/>
</g>
<!-- layer_1_expert_2&#45;&gt;layer_1_moe_agg -->
<g id="edge73" class="edge">
<title>layer_1_expert_2&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M5327.5,-11382.86C5327.5,-11318.93 5327.5,-11188 5327.5,-11188 5327.5,-11188 4024.02,-11188 4024.02,-11188"/>
<polygon fill="black" stroke="black" points="4024.02,-11184.5 4014.02,-11188 4024.02,-11191.5 4024.02,-11184.5"/>
</g>
<!-- layer_1_expert_3&#45;&gt;layer_1_moe_agg -->
<g id="edge76" class="edge">
<title>layer_1_expert_3&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M1037,-11382.97C1037,-11319.98 1037,-11192 1037,-11192 1037,-11192 3641.97,-11192 3641.97,-11192"/>
<polygon fill="black" stroke="black" points="3641.97,-11195.5 3651.97,-11192 3641.97,-11188.5 3641.97,-11195.5"/>
</g>
<!-- layer_1_expert_4&#45;&gt;layer_1_moe_agg -->
<g id="edge79" class="edge">
<title>layer_1_expert_4&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M1457,-11382.76C1457,-11321.52 1457,-11200 1457,-11200 1457,-11200 3641.97,-11200 3641.97,-11200"/>
<polygon fill="black" stroke="black" points="3641.97,-11203.5 3651.97,-11200 3641.97,-11196.5 3641.97,-11203.5"/>
</g>
<!-- layer_1_expert_5&#45;&gt;layer_1_moe_agg -->
<g id="edge82" class="edge">
<title>layer_1_expert_5&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M3905,-11382.94C3905,-11382.94 3905,-11248.3 3905,-11248.3"/>
<polygon fill="black" stroke="black" points="3908.5,-11248.3 3905,-11238.3 3901.5,-11248.3 3908.5,-11248.3"/>
</g>
<!-- layer_1_expert_6&#45;&gt;layer_1_moe_agg -->
<g id="edge85" class="edge">
<title>layer_1_expert_6&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M2717,-11382.9C2717,-11327.16 2717,-11223 2717,-11223 2717,-11223 3641.83,-11223 3641.83,-11223"/>
<polygon fill="black" stroke="black" points="3641.83,-11226.5 3651.83,-11223 3641.83,-11219.5 3641.83,-11226.5"/>
</g>
<!-- layer_1_expert_7&#45;&gt;layer_1_moe_agg -->
<g id="edge88" class="edge">
<title>layer_1_expert_7&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M5747.5,-11383.12C5747.5,-11318.17 5747.5,-11183 5747.5,-11183 5747.5,-11183 4024.41,-11183 4024.41,-11183"/>
<polygon fill="black" stroke="black" points="4024.41,-11179.5 4014.41,-11183 4024.41,-11186.5 4024.41,-11179.5"/>
</g>
<!-- layer_1_expert_8&#45;&gt;layer_1_moe_agg -->
<g id="edge91" class="edge">
<title>layer_1_expert_8&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M197,-11383.01C197,-11316.71 197,-11177 197,-11177 197,-11177 3641.76,-11177 3641.76,-11177"/>
<polygon fill="black" stroke="black" points="3641.76,-11180.5 3651.76,-11177 3641.76,-11173.5 3641.76,-11180.5"/>
</g>
<!-- layer_1_expert_9&#45;&gt;layer_1_moe_agg -->
<g id="edge94" class="edge">
<title>layer_1_expert_9&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M6077,-11383.04C6077,-11317.19 6077,-11179 6077,-11179 6077,-11179 4024.26,-11179 4024.26,-11179"/>
<polygon fill="black" stroke="black" points="4024.26,-11175.5 4014.26,-11179 4024.26,-11182.5 4024.26,-11175.5"/>
</g>
<!-- layer_1_expert_10&#45;&gt;layer_1_moe_agg -->
<g id="edge97" class="edge">
<title>layer_1_expert_10&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M4907.5,-11382.97C4907.5,-11319.98 4907.5,-11192 4907.5,-11192 4907.5,-11192 4024.06,-11192 4024.06,-11192"/>
<polygon fill="black" stroke="black" points="4024.06,-11188.5 4014.06,-11192 4024.06,-11195.5 4024.06,-11188.5"/>
</g>
<!-- layer_1_expert_11&#45;&gt;layer_1_moe_agg -->
<g id="edge100" class="edge">
<title>layer_1_expert_11&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M617,-11382.91C617,-11318.33 617,-11185 617,-11185 617,-11185 3641.75,-11185 3641.75,-11185"/>
<polygon fill="black" stroke="black" points="3641.75,-11188.5 3651.75,-11185 3641.75,-11181.5 3641.75,-11188.5"/>
</g>
<!-- layer_1_expert_12&#45;&gt;layer_1_moe_agg -->
<g id="edge103" class="edge">
<title>layer_1_expert_12&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M3212.07,-11382.84C3212.07,-11328.8 3212.07,-11230 3212.07,-11230 3212.07,-11230 3641.73,-11230 3641.73,-11230"/>
<polygon fill="black" stroke="black" points="3641.73,-11233.5 3651.73,-11230 3641.73,-11226.5 3641.73,-11233.5"/>
</g>
<!-- layer_1_expert_13&#45;&gt;layer_1_moe_agg -->
<g id="edge106" class="edge">
<title>layer_1_expert_13&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M6497,-11383.1C6497,-11316.18 6497,-11174 6497,-11174 6497,-11174 4024.01,-11174 4024.01,-11174"/>
<polygon fill="black" stroke="black" points="4024.01,-11170.5 4014.01,-11174 4024.01,-11177.5 4024.01,-11170.5"/>
</g>
<!-- layer_1_expert_14&#45;&gt;layer_1_moe_agg -->
<g id="edge109" class="edge">
<title>layer_1_expert_14&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M4487.5,-11382.77C4487.5,-11320.84 4487.5,-11197 4487.5,-11197 4487.5,-11197 4024.01,-11197 4024.01,-11197"/>
<polygon fill="black" stroke="black" points="4024.01,-11193.5 4014.01,-11197 4024.01,-11200.5 4024.01,-11193.5"/>
</g>
<!-- layer_1_expert_15&#45;&gt;layer_1_moe_agg -->
<g id="edge112" class="edge">
<title>layer_1_expert_15&#45;&gt;layer_1_moe_agg</title>
<path fill="none" stroke="black" d="M3695,-11382.94C3695,-11382.94 3695,-11248.3 3695,-11248.3"/>
<polygon fill="black" stroke="black" points="3698.5,-11248.3 3695,-11238.3 3691.5,-11248.3 3698.5,-11248.3"/>
</g>
<!-- layer_2_qkv -->
<g id="node48" class="node">
<title>layer_2_qkv</title>
<polygon fill="lightblue" stroke="black" points="3851.5,-10812.17 3442.5,-10812.17 3442.5,-10744.17 3851.5,-10744.17 3851.5,-10812.17"/>
<text text-anchor="middle" x="3647" y="-10796.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3647" y="-10781.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3647" y="-10766.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3647" y="-10751.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_1_add_norm2&#45;&gt;layer_2_qkv -->
<g id="edge115" class="edge">
<title>layer_1_add_norm2&#45;&gt;layer_2_qkv</title>
<path fill="none" stroke="black" d="M3786.75,-10956.94C3786.75,-10956.94 3786.75,-10822.3 3786.75,-10822.3"/>
<polygon fill="black" stroke="black" points="3790.25,-10822.3 3786.75,-10812.3 3783.25,-10822.3 3790.25,-10822.3"/>
</g>
<!-- layer_2_add_norm1 -->
<g id="node51" class="node">
<title>layer_2_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4072,-10173.17 3710,-10173.17 3710,-10105.17 4072,-10105.17 4072,-10173.17"/>
<text text-anchor="middle" x="3891" y="-10157.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3891" y="-10142.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3891" y="-10127.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3891" y="-10112.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_1_add_norm2&#45;&gt;layer_2_add_norm1 -->
<g id="edge119" class="edge">
<title>layer_1_add_norm2&#45;&gt;layer_2_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3967.75,-10956.98C3967.75,-10956.98 3967.75,-10183.62 3967.75,-10183.62"/>
<polygon fill="black" stroke="black" points="3971.25,-10183.62 3967.75,-10173.62 3964.25,-10183.62 3971.25,-10183.62"/>
<text text-anchor="middle" x="3968" y="-10561.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_2_attn -->
<g id="node49" class="node">
<title>layer_2_attn</title>
<polygon fill="lightblue" stroke="black" points="3822.5,-10599.17 3413.5,-10599.17 3413.5,-10531.17 3822.5,-10531.17 3822.5,-10599.17"/>
<text text-anchor="middle" x="3618" y="-10583.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3618" y="-10568.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3618" y="-10553.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3618" y="-10538.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_2_qkv&#45;&gt;layer_2_attn -->
<g id="edge116" class="edge">
<title>layer_2_qkv&#45;&gt;layer_2_attn</title>
<path fill="none" stroke="black" d="M3632.5,-10743.94C3632.5,-10743.94 3632.5,-10609.3 3632.5,-10609.3"/>
<polygon fill="black" stroke="black" points="3636,-10609.3 3632.5,-10599.3 3629,-10609.3 3636,-10609.3"/>
</g>
<!-- layer_2_proj -->
<g id="node50" class="node">
<title>layer_2_proj</title>
<polygon fill="lightblue" stroke="black" points="3863.5,-10386.17 3466.5,-10386.17 3466.5,-10318.17 3863.5,-10318.17 3863.5,-10386.17"/>
<text text-anchor="middle" x="3665" y="-10370.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3665" y="-10355.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3665" y="-10340.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3665" y="-10325.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_2_attn&#45;&gt;layer_2_proj -->
<g id="edge117" class="edge">
<title>layer_2_attn&#45;&gt;layer_2_proj</title>
<path fill="none" stroke="black" d="M3644.5,-10530.94C3644.5,-10530.94 3644.5,-10396.3 3644.5,-10396.3"/>
<polygon fill="black" stroke="black" points="3648,-10396.3 3644.5,-10386.3 3641,-10396.3 3648,-10396.3"/>
</g>
<!-- layer_2_proj&#45;&gt;layer_2_add_norm1 -->
<g id="edge118" class="edge">
<title>layer_2_proj&#45;&gt;layer_2_add_norm1</title>
<path fill="none" stroke="black" d="M3786.75,-10317.94C3786.75,-10317.94 3786.75,-10183.3 3786.75,-10183.3"/>
<polygon fill="black" stroke="black" points="3790.25,-10183.3 3786.75,-10173.3 3783.25,-10183.3 3790.25,-10183.3"/>
</g>
<!-- layer_2_gate -->
<g id="node52" class="node">
<title>layer_2_gate</title>
<polygon fill="yellow" stroke="black" points="3831.73,-9960.17 3254.71,-9960.17 3106.27,-9824.17 3683.29,-9824.17 3831.73,-9960.17"/>
<text text-anchor="middle" x="3469" y="-9910.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3469" y="-9895.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3469" y="-9880.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3469" y="-9865.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_gate -->
<g id="edge120" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" d="M3770.93,-10105.08C3770.93,-10105.08 3770.93,-9970.37 3770.93,-9970.37"/>
<polygon fill="black" stroke="black" points="3774.43,-9970.37 3770.93,-9960.37 3767.43,-9970.37 3774.43,-9970.37"/>
</g>
<!-- layer_2_moe_agg -->
<g id="node53" class="node">
<title>layer_2_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="4092,-9452.17 3730,-9452.17 3730,-9384.17 4092,-9384.17 4092,-9452.17"/>
<text text-anchor="middle" x="3911" y="-9436.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="3911" y="-9421.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3911" y="-9406.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3911" y="-9391.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_moe_agg -->
<g id="edge121" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M3951.93,-10104.85C3951.93,-10011.51 3951.93,-9760 3951.93,-9760 3951.93,-9760 3767,-9760 3767,-9760 3767,-9760 3767,-9462.19 3767,-9462.19"/>
<polygon fill="black" stroke="black" points="3770.5,-9462.19 3767,-9452.19 3763.5,-9462.19 3770.5,-9462.19"/>
</g>
<!-- layer_2_expert_0 -->
<g id="node54" class="node">
<title>layer_2_expert_0</title>
<polygon fill="lightblue" stroke="black" points="2058,-9665.17 1696,-9665.17 1696,-9597.17 2058,-9597.17 2058,-9665.17"/>
<text text-anchor="middle" x="1877" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1877" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_0 -->
<g id="edge123" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_0</title>
<path fill="none" stroke="black" d="M3709.75,-10135C3199.27,-10135 1786.5,-10135 1786.5,-10135 1786.5,-10135 1786.5,-9675.4 1786.5,-9675.4"/>
<polygon fill="black" stroke="black" points="1790,-9675.4 1786.5,-9665.4 1783,-9675.4 1790,-9675.4"/>
</g>
<!-- layer_2_expert_1 -->
<g id="node55" class="node">
<title>layer_2_expert_1</title>
<polygon fill="lightblue" stroke="black" points="2478,-9665.17 2116,-9665.17 2116,-9597.17 2478,-9597.17 2478,-9665.17"/>
<text text-anchor="middle" x="2297" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2297" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_1 -->
<g id="edge126" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_1</title>
<path fill="none" stroke="black" d="M3709.93,-10127C3274.86,-10127 2206.5,-10127 2206.5,-10127 2206.5,-10127 2206.5,-9675.25 2206.5,-9675.25"/>
<polygon fill="black" stroke="black" points="2210,-9675.25 2206.5,-9665.25 2203,-9675.25 2210,-9675.25"/>
</g>
<!-- layer_2_expert_2 -->
<g id="node56" class="node">
<title>layer_2_expert_2</title>
<polygon fill="lightblue" stroke="black" points="5418,-9665.17 5056,-9665.17 5056,-9597.17 5418,-9597.17 5418,-9665.17"/>
<text text-anchor="middle" x="5237" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5237" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_2 -->
<g id="edge129" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_2</title>
<path fill="none" stroke="black" d="M4072.18,-10130C4439.42,-10130 5237,-10130 5237,-10130 5237,-10130 5237,-9675.45 5237,-9675.45"/>
<polygon fill="black" stroke="black" points="5240.5,-9675.45 5237,-9665.45 5233.5,-9675.45 5240.5,-9675.45"/>
</g>
<!-- layer_2_expert_3 -->
<g id="node57" class="node">
<title>layer_2_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1218,-9665.17 856,-9665.17 856,-9597.17 1218,-9597.17 1218,-9665.17"/>
<text text-anchor="middle" x="1037" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1037" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_3 -->
<g id="edge132" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_3</title>
<path fill="none" stroke="black" d="M3709.86,-10150C3068.89,-10150 946.5,-10150 946.5,-10150 946.5,-10150 946.5,-9675.21 946.5,-9675.21"/>
<polygon fill="black" stroke="black" points="950,-9675.21 946.5,-9665.21 943,-9675.21 950,-9675.21"/>
</g>
<!-- layer_2_expert_4 -->
<g id="node58" class="node">
<title>layer_2_expert_4</title>
<polygon fill="lightblue" stroke="black" points="1638,-9665.17 1276,-9665.17 1276,-9597.17 1638,-9597.17 1638,-9665.17"/>
<text text-anchor="middle" x="1457" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1457" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_4 -->
<g id="edge135" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_4</title>
<path fill="none" stroke="black" d="M3709.95,-10142C3131.63,-10142 1366.5,-10142 1366.5,-10142 1366.5,-10142 1366.5,-9675.48 1366.5,-9675.48"/>
<polygon fill="black" stroke="black" points="1370,-9675.48 1366.5,-9665.48 1363,-9675.48 1370,-9675.48"/>
</g>
<!-- layer_2_expert_5 -->
<g id="node59" class="node">
<title>layer_2_expert_5</title>
<polygon fill="lightblue" stroke="black" points="4158,-9665.17 3796,-9665.17 3796,-9597.17 4158,-9597.17 4158,-9665.17"/>
<text text-anchor="middle" x="3977" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3977" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_5 -->
<g id="edge138" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_5</title>
<path fill="none" stroke="black" d="M4011.97,-10105.05C4011.97,-10105.05 4011.97,-9675.47 4011.97,-9675.47"/>
<polygon fill="black" stroke="black" points="4015.47,-9675.47 4011.97,-9665.47 4008.47,-9675.47 4015.47,-9675.47"/>
</g>
<!-- layer_2_expert_6 -->
<g id="node60" class="node">
<title>layer_2_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2898,-9665.17 2536,-9665.17 2536,-9597.17 2898,-9597.17 2898,-9665.17"/>
<text text-anchor="middle" x="2717" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2717" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_6 -->
<g id="edge141" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_6</title>
<path fill="none" stroke="black" d="M3709.83,-10120C3360.18,-10120 2626.5,-10120 2626.5,-10120 2626.5,-10120 2626.5,-9675.54 2626.5,-9675.54"/>
<polygon fill="black" stroke="black" points="2630,-9675.54 2626.5,-9665.54 2623,-9675.54 2630,-9675.54"/>
</g>
<!-- layer_2_expert_7 -->
<g id="node61" class="node">
<title>layer_2_expert_7</title>
<polygon fill="lightblue" stroke="black" points="5838,-9665.17 5476,-9665.17 5476,-9597.17 5838,-9597.17 5838,-9665.17"/>
<text text-anchor="middle" x="5657" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5657" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_7 -->
<g id="edge144" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_7</title>
<path fill="none" stroke="black" d="M4072.11,-10139C4522.48,-10139 5657,-10139 5657,-10139 5657,-10139 5657,-9675.28 5657,-9675.28"/>
<polygon fill="black" stroke="black" points="5660.5,-9675.28 5657,-9665.28 5653.5,-9675.28 5660.5,-9675.28"/>
</g>
<!-- layer_2_expert_8 -->
<g id="node62" class="node">
<title>layer_2_expert_8</title>
<polygon fill="lightblue" stroke="black" points="378,-9665.17 16,-9665.17 16,-9597.17 378,-9597.17 378,-9665.17"/>
<text text-anchor="middle" x="197" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="197" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_8 -->
<g id="edge147" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_8</title>
<path fill="none" stroke="black" d="M3709.74,-10165C2955.7,-10165 106.5,-10165 106.5,-10165 106.5,-10165 106.5,-9675.37 106.5,-9675.37"/>
<polygon fill="black" stroke="black" points="110,-9675.37 106.5,-9665.37 103,-9675.37 110,-9675.37"/>
</g>
<!-- layer_2_expert_9 -->
<g id="node63" class="node">
<title>layer_2_expert_9</title>
<polygon fill="lightblue" stroke="black" points="6258,-9665.17 5896,-9665.17 5896,-9597.17 6258,-9597.17 6258,-9665.17"/>
<text text-anchor="middle" x="6077" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="6077" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_9 -->
<g id="edge150" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_9</title>
<path fill="none" stroke="black" d="M4072.01,-10147C4610.9,-10147 6167.5,-10147 6167.5,-10147 6167.5,-10147 6167.5,-9675.41 6167.5,-9675.41"/>
<polygon fill="black" stroke="black" points="6171,-9675.41 6167.5,-9665.41 6164,-9675.41 6171,-9675.41"/>
</g>
<!-- layer_2_expert_10 -->
<g id="node64" class="node">
<title>layer_2_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4998,-9665.17 4636,-9665.17 4636,-9597.17 4998,-9597.17 4998,-9665.17"/>
<text text-anchor="middle" x="4817" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4817" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_10 -->
<g id="edge153" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_10</title>
<path fill="none" stroke="black" d="M4072.02,-10122C4341.55,-10122 4817,-10122 4817,-10122 4817,-10122 4817,-9675.29 4817,-9675.29"/>
<polygon fill="black" stroke="black" points="4820.5,-9675.29 4817,-9665.29 4813.5,-9675.29 4820.5,-9675.29"/>
</g>
<!-- layer_2_expert_11 -->
<g id="node65" class="node">
<title>layer_2_expert_11</title>
<polygon fill="lightblue" stroke="black" points="798,-9665.17 436,-9665.17 436,-9597.17 798,-9597.17 798,-9665.17"/>
<text text-anchor="middle" x="617" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="617" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_11 -->
<g id="edge156" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_11</title>
<path fill="none" stroke="black" d="M3709.81,-10158C3010.56,-10158 526.5,-10158 526.5,-10158 526.5,-10158 526.5,-9675.33 526.5,-9675.33"/>
<polygon fill="black" stroke="black" points="530,-9675.33 526.5,-9665.33 523,-9675.33 530,-9675.33"/>
</g>
<!-- layer_2_expert_12 -->
<g id="node66" class="node">
<title>layer_2_expert_12</title>
<polygon fill="lightblue" stroke="black" points="3318,-9665.17 2956,-9665.17 2956,-9597.17 3318,-9597.17 3318,-9665.17"/>
<text text-anchor="middle" x="3137" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3137" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_12 -->
<g id="edge159" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_12</title>
<path fill="none" stroke="black" d="M3709.94,-10112C3457.68,-10112 3031.07,-10112 3031.07,-10112 3031.07,-10112 3031.07,-9675.36 3031.07,-9675.36"/>
<polygon fill="black" stroke="black" points="3034.57,-9675.36 3031.07,-9665.36 3027.57,-9675.36 3034.57,-9675.36"/>
</g>
<!-- layer_2_expert_13 -->
<g id="node67" class="node">
<title>layer_2_expert_13</title>
<polygon fill="lightblue" stroke="black" points="6678,-9665.17 6316,-9665.17 6316,-9597.17 6678,-9597.17 6678,-9665.17"/>
<text text-anchor="middle" x="6497" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6497" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_13 -->
<g id="edge162" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_13</title>
<path fill="none" stroke="black" d="M4072.11,-10156C4676.7,-10156 6587.5,-10156 6587.5,-10156 6587.5,-10156 6587.5,-9675.2 6587.5,-9675.2"/>
<polygon fill="black" stroke="black" points="6591,-9675.2 6587.5,-9665.2 6584,-9675.2 6591,-9675.2"/>
</g>
<!-- layer_2_expert_14 -->
<g id="node68" class="node">
<title>layer_2_expert_14</title>
<polygon fill="lightblue" stroke="black" points="4578,-9665.17 4216,-9665.17 4216,-9597.17 4578,-9597.17 4578,-9665.17"/>
<text text-anchor="middle" x="4397" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4397" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_14 -->
<g id="edge165" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_14</title>
<path fill="none" stroke="black" d="M4072.25,-10113C4217.44,-10113 4397,-10113 4397,-10113 4397,-10113 4397,-9675.43 4397,-9675.43"/>
<polygon fill="black" stroke="black" points="4400.5,-9675.43 4397,-9665.43 4393.5,-9675.43 4400.5,-9675.43"/>
</g>
<!-- layer_2_expert_15 -->
<g id="node69" class="node">
<title>layer_2_expert_15</title>
<polygon fill="lightblue" stroke="black" points="3738,-9665.17 3376,-9665.17 3376,-9597.17 3738,-9597.17 3738,-9665.17"/>
<text text-anchor="middle" x="3557" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3557" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_expert_15 -->
<g id="edge168" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_expert_15</title>
<path fill="none" stroke="black" d="M3891.9,-10104.93C3891.9,-10017.34 3891.9,-9792 3891.9,-9792 3891.9,-9792 3617.33,-9792 3617.33,-9792 3617.33,-9792 3617.33,-9675.28 3617.33,-9675.28"/>
<polygon fill="black" stroke="black" points="3620.83,-9675.28 3617.33,-9665.28 3613.83,-9675.28 3620.83,-9675.28"/>
</g>
<!-- layer_2_add_norm2 -->
<g id="node70" class="node">
<title>layer_2_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4098,-9239.17 3736,-9239.17 3736,-9171.17 4098,-9171.17 4098,-9239.17"/>
<text text-anchor="middle" x="3917" y="-9223.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3917" y="-9208.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3917" y="-9193.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3917" y="-9178.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_2_add_norm1&#45;&gt;layer_2_add_norm2 -->
<g id="edge171" class="edge">
<title>layer_2_add_norm1&#45;&gt;layer_2_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4072.25,-10109C4126.07,-10109 4170.94,-10109 4170.94,-10109 4170.94,-10109 4170.94,-9205 4170.94,-9205 4170.94,-9205 4108.17,-9205 4108.17,-9205"/>
<polygon fill="black" stroke="black" points="4108.17,-9201.5 4098.17,-9205 4108.17,-9208.5 4108.17,-9201.5"/>
<text text-anchor="middle" x="6883" y="-9627.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_0 -->
<g id="edge122" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3161.53,-9875C2722.24,-9875 1967.5,-9875 1967.5,-9875 1967.5,-9875 1967.5,-9675.33 1967.5,-9675.33"/>
<polygon fill="black" stroke="black" points="1971,-9675.33 1967.5,-9665.33 1964,-9675.33 1971,-9675.33"/>
<text text-anchor="middle" x="2641.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_1 -->
<g id="edge125" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3143.05,-9858C2824.61,-9858 2387.5,-9858 2387.5,-9858 2387.5,-9858 2387.5,-9675.62 2387.5,-9675.62"/>
<polygon fill="black" stroke="black" points="2391,-9675.62 2387.5,-9665.62 2384,-9675.62 2391,-9675.62"/>
<text text-anchor="middle" x="2934.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_2 -->
<g id="edge128" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3746.48,-9882C4223.07,-9882 5146.5,-9882 5146.5,-9882 5146.5,-9882 5146.5,-9675.26 5146.5,-9675.26"/>
<polygon fill="black" stroke="black" points="5150,-9675.26 5146.5,-9665.26 5143,-9675.26 5150,-9675.26"/>
<text text-anchor="middle" x="4635.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_3 -->
<g id="edge131" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3198.69,-9909C2582.66,-9909 1127.5,-9909 1127.5,-9909 1127.5,-9909 1127.5,-9675.23 1127.5,-9675.23"/>
<polygon fill="black" stroke="black" points="1131,-9675.23 1127.5,-9665.23 1124,-9675.23 1131,-9675.23"/>
<text text-anchor="middle" x="1855.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_4 -->
<g id="edge134" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3180.29,-9892C2643.88,-9892 1547.5,-9892 1547.5,-9892 1547.5,-9892 1547.5,-9675.27 1547.5,-9675.27"/>
<polygon fill="black" stroke="black" points="1551,-9675.27 1547.5,-9665.27 1544,-9675.27 1551,-9675.27"/>
<text text-anchor="middle" x="2274.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_5 -->
<g id="edge137" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3813.93,-9892.12C3813.93,-9892.12 3813.93,-9675.33 3813.93,-9675.33"/>
<polygon fill="black" stroke="black" points="3817.43,-9675.33 3813.93,-9665.33 3810.43,-9675.33 3817.43,-9675.33"/>
<text text-anchor="middle" x="3735.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_6 -->
<g id="edge140" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3124.2,-9841C2963.64,-9841 2807.5,-9841 2807.5,-9841 2807.5,-9841 2807.5,-9675.35 2807.5,-9675.35"/>
<polygon fill="black" stroke="black" points="2811,-9675.35 2807.5,-9665.35 2804,-9675.35 2811,-9675.35"/>
<text text-anchor="middle" x="3200.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_7 -->
<g id="edge143" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3767.29,-9901C4346.38,-9901 5566.5,-9901 5566.5,-9901 5566.5,-9901 5566.5,-9675.34 5566.5,-9675.34"/>
<polygon fill="black" stroke="black" points="5570,-9675.34 5566.5,-9665.34 5563,-9675.34 5570,-9675.34"/>
<text text-anchor="middle" x="5046.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_8 -->
<g id="edge146" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3235.7,-9943C2501.62,-9943 287.5,-9943 287.5,-9943 287.5,-9943 287.5,-9675.43 287.5,-9675.43"/>
<polygon fill="black" stroke="black" points="291,-9675.43 287.5,-9665.43 284,-9675.43 291,-9675.43"/>
<text text-anchor="middle" x="929.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_9 -->
<g id="edge149" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3789.12,-9921C4467.18,-9921 5986.5,-9921 5986.5,-9921 5986.5,-9921 5986.5,-9675.27 5986.5,-9675.27"/>
<polygon fill="black" stroke="black" points="5990,-9675.27 5986.5,-9665.27 5983,-9675.27 5990,-9675.27"/>
<text text-anchor="middle" x="5463.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_10 -->
<g id="edge152" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3725.75,-9863C4093.54,-9863 4726.5,-9863 4726.5,-9863 4726.5,-9863 4726.5,-9675.37 4726.5,-9675.37"/>
<polygon fill="black" stroke="black" points="4730,-9675.37 4726.5,-9665.37 4723,-9675.37 4730,-9675.37"/>
<text text-anchor="middle" x="4252.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_11 -->
<g id="edge155" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3217.23,-9926C2536,-9926 707.5,-9926 707.5,-9926 707.5,-9926 707.5,-9675.28 707.5,-9675.28"/>
<polygon fill="black" stroke="black" points="711,-9675.28 707.5,-9665.28 704,-9675.28 711,-9675.28"/>
<text text-anchor="middle" x="1472.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_12 -->
<g id="edge158" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3212.07,-9823.93C3212.07,-9823.93 3212.07,-9675.49 3212.07,-9675.49"/>
<polygon fill="black" stroke="black" points="3215.57,-9675.49 3212.07,-9665.49 3208.57,-9675.49 3215.57,-9675.49"/>
<text text-anchor="middle" x="3392.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_13 -->
<g id="edge161" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3809.92,-9940C4583.77,-9940 6406.5,-9940 6406.5,-9940 6406.5,-9940 6406.5,-9675.4 6406.5,-9675.4"/>
<polygon fill="black" stroke="black" points="6410,-9675.4 6406.5,-9665.4 6403,-9675.4 6410,-9675.4"/>
<text text-anchor="middle" x="5747.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_14 -->
<g id="edge164" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3703.96,-9843C3951.7,-9843 4306.5,-9843 4306.5,-9843 4306.5,-9843 4306.5,-9675.2 4306.5,-9675.2"/>
<polygon fill="black" stroke="black" points="4310,-9675.2 4306.5,-9665.2 4303,-9675.2 4310,-9675.2"/>
<text text-anchor="middle" x="3981.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_15 -->
<g id="edge167" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3496.67,-9823.93C3496.67,-9823.93 3496.67,-9675.49 3496.67,-9675.49"/>
<polygon fill="black" stroke="black" points="3500.17,-9675.49 3496.67,-9665.49 3493.17,-9675.49 3500.17,-9675.49"/>
<text text-anchor="middle" x="3539.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_2_moe_agg&#45;&gt;layer_2_add_norm2 -->
<g id="edge170" class="edge">
<title>layer_2_moe_agg&#45;&gt;layer_2_add_norm2</title>
<path fill="none" stroke="black" d="M3914,-9383.94C3914,-9383.94 3914,-9249.3 3914,-9249.3"/>
<polygon fill="black" stroke="black" points="3917.5,-9249.3 3914,-9239.3 3910.5,-9249.3 3917.5,-9249.3"/>
</g>
<!-- layer_2_expert_0&#45;&gt;layer_2_moe_agg -->
<g id="edge124" class="edge">
<title>layer_2_expert_0&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M1877,-9596.93C1877,-9537.38 1877,-9421 1877,-9421 1877,-9421 3719.6,-9421 3719.6,-9421"/>
<polygon fill="black" stroke="black" points="3719.6,-9424.5 3729.6,-9421 3719.6,-9417.5 3719.6,-9424.5"/>
</g>
<!-- layer_2_expert_1&#45;&gt;layer_2_moe_agg -->
<g id="edge127" class="edge">
<title>layer_2_expert_1&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M2297,-9596.87C2297,-9539.19 2297,-9429 2297,-9429 2297,-9429 3719.77,-9429 3719.77,-9429"/>
<polygon fill="black" stroke="black" points="3719.77,-9432.5 3729.77,-9429 3719.77,-9425.5 3719.77,-9432.5"/>
</g>
<!-- layer_2_expert_2&#45;&gt;layer_2_moe_agg -->
<g id="edge130" class="edge">
<title>layer_2_expert_2&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M5327.5,-9596.86C5327.5,-9532.93 5327.5,-9402 5327.5,-9402 5327.5,-9402 4102.2,-9402 4102.2,-9402"/>
<polygon fill="black" stroke="black" points="4102.2,-9398.5 4092.2,-9402 4102.2,-9405.5 4102.2,-9398.5"/>
</g>
<!-- layer_2_expert_3&#45;&gt;layer_2_moe_agg -->
<g id="edge133" class="edge">
<title>layer_2_expert_3&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M1037,-9596.97C1037,-9533.98 1037,-9406 1037,-9406 1037,-9406 3719.86,-9406 3719.86,-9406"/>
<polygon fill="black" stroke="black" points="3719.86,-9409.5 3729.86,-9406 3719.86,-9402.5 3719.86,-9409.5"/>
</g>
<!-- layer_2_expert_4&#45;&gt;layer_2_moe_agg -->
<g id="edge136" class="edge">
<title>layer_2_expert_4&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M1457,-9596.76C1457,-9535.52 1457,-9414 1457,-9414 1457,-9414 3719.55,-9414 3719.55,-9414"/>
<polygon fill="black" stroke="black" points="3719.55,-9417.5 3729.55,-9414 3719.55,-9410.5 3719.55,-9417.5"/>
</g>
<!-- layer_2_expert_5&#45;&gt;layer_2_moe_agg -->
<g id="edge139" class="edge">
<title>layer_2_expert_5&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M3944,-9596.94C3944,-9596.94 3944,-9462.3 3944,-9462.3"/>
<polygon fill="black" stroke="black" points="3947.5,-9462.3 3944,-9452.3 3940.5,-9462.3 3947.5,-9462.3"/>
</g>
<!-- layer_2_expert_6&#45;&gt;layer_2_moe_agg -->
<g id="edge142" class="edge">
<title>layer_2_expert_6&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M2717,-9596.9C2717,-9541.16 2717,-9437 2717,-9437 2717,-9437 3719.98,-9437 3719.98,-9437"/>
<polygon fill="black" stroke="black" points="3719.98,-9440.5 3729.98,-9437 3719.98,-9433.5 3719.98,-9440.5"/>
</g>
<!-- layer_2_expert_7&#45;&gt;layer_2_moe_agg -->
<g id="edge145" class="edge">
<title>layer_2_expert_7&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M5747.5,-9597.12C5747.5,-9532.17 5747.5,-9397 5747.5,-9397 5747.5,-9397 4102.12,-9397 4102.12,-9397"/>
<polygon fill="black" stroke="black" points="4102.12,-9393.5 4092.12,-9397 4102.12,-9400.5 4102.12,-9393.5"/>
</g>
<!-- layer_2_expert_8&#45;&gt;layer_2_moe_agg -->
<g id="edge148" class="edge">
<title>layer_2_expert_8&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M106.5,-9597.01C106.5,-9530.71 106.5,-9391 106.5,-9391 106.5,-9391 3719.74,-9391 3719.74,-9391"/>
<polygon fill="black" stroke="black" points="3719.74,-9394.5 3729.74,-9391 3719.74,-9387.5 3719.74,-9394.5"/>
</g>
<!-- layer_2_expert_9&#45;&gt;layer_2_moe_agg -->
<g id="edge151" class="edge">
<title>layer_2_expert_9&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M6167.5,-9597.04C6167.5,-9531.19 6167.5,-9393 6167.5,-9393 6167.5,-9393 4102.32,-9393 4102.32,-9393"/>
<polygon fill="black" stroke="black" points="4102.32,-9389.5 4092.32,-9393 4102.32,-9396.5 4102.32,-9389.5"/>
</g>
<!-- layer_2_expert_10&#45;&gt;layer_2_moe_agg -->
<g id="edge154" class="edge">
<title>layer_2_expert_10&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M4907.5,-9596.97C4907.5,-9533.98 4907.5,-9406 4907.5,-9406 4907.5,-9406 4102.04,-9406 4102.04,-9406"/>
<polygon fill="black" stroke="black" points="4102.04,-9402.5 4092.04,-9406 4102.04,-9409.5 4102.04,-9402.5"/>
</g>
<!-- layer_2_expert_11&#45;&gt;layer_2_moe_agg -->
<g id="edge157" class="edge">
<title>layer_2_expert_11&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M526.5,-9596.91C526.5,-9532.33 526.5,-9399 526.5,-9399 526.5,-9399 3719.93,-9399 3719.93,-9399"/>
<polygon fill="black" stroke="black" points="3719.93,-9402.5 3729.93,-9399 3719.93,-9395.5 3719.93,-9402.5"/>
</g>
<!-- layer_2_expert_12&#45;&gt;layer_2_moe_agg -->
<g id="edge160" class="edge">
<title>layer_2_expert_12&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M3205.07,-9596.84C3205.07,-9542.8 3205.07,-9444 3205.07,-9444 3205.07,-9444 3719.66,-9444 3719.66,-9444"/>
<polygon fill="black" stroke="black" points="3719.66,-9447.5 3729.66,-9444 3719.66,-9440.5 3719.66,-9447.5"/>
</g>
<!-- layer_2_expert_13&#45;&gt;layer_2_moe_agg -->
<g id="edge163" class="edge">
<title>layer_2_expert_13&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M6587.5,-9597.1C6587.5,-9530.18 6587.5,-9388 6587.5,-9388 6587.5,-9388 4102.08,-9388 4102.08,-9388"/>
<polygon fill="black" stroke="black" points="4102.08,-9384.5 4092.08,-9388 4102.08,-9391.5 4102.08,-9384.5"/>
</g>
<!-- layer_2_expert_14&#45;&gt;layer_2_moe_agg -->
<g id="edge166" class="edge">
<title>layer_2_expert_14&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M4487.5,-9596.77C4487.5,-9534.84 4487.5,-9411 4487.5,-9411 4487.5,-9411 4102.22,-9411 4102.22,-9411"/>
<polygon fill="black" stroke="black" points="4102.22,-9407.5 4092.22,-9411 4102.22,-9414.5 4102.22,-9407.5"/>
</g>
<!-- layer_2_expert_15&#45;&gt;layer_2_moe_agg -->
<g id="edge169" class="edge">
<title>layer_2_expert_15&#45;&gt;layer_2_moe_agg</title>
<path fill="none" stroke="black" d="M3734,-9596.94C3734,-9596.94 3734,-9462.3 3734,-9462.3"/>
<polygon fill="black" stroke="black" points="3737.5,-9462.3 3734,-9452.3 3730.5,-9462.3 3737.5,-9462.3"/>
</g>
<!-- layer_3_qkv -->
<g id="node71" class="node">
<title>layer_3_qkv</title>
<polygon fill="lightblue" stroke="black" points="3837.5,-9026.17 3428.5,-9026.17 3428.5,-8958.17 3837.5,-8958.17 3837.5,-9026.17"/>
<text text-anchor="middle" x="3633" y="-9010.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3633" y="-8995.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3633" y="-8980.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3633" y="-8965.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_2_add_norm2&#45;&gt;layer_3_qkv -->
<g id="edge172" class="edge">
<title>layer_2_add_norm2&#45;&gt;layer_3_qkv</title>
<path fill="none" stroke="black" d="M3786.75,-9170.94C3786.75,-9170.94 3786.75,-9036.3 3786.75,-9036.3"/>
<polygon fill="black" stroke="black" points="3790.25,-9036.3 3786.75,-9026.3 3783.25,-9036.3 3790.25,-9036.3"/>
</g>
<!-- layer_3_add_norm1 -->
<g id="node74" class="node">
<title>layer_3_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4058,-8387.17 3696,-8387.17 3696,-8319.17 4058,-8319.17 4058,-8387.17"/>
<text text-anchor="middle" x="3877" y="-8371.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3877" y="-8356.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3877" y="-8341.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3877" y="-8326.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_2_add_norm2&#45;&gt;layer_3_add_norm1 -->
<g id="edge176" class="edge">
<title>layer_2_add_norm2&#45;&gt;layer_3_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3947.75,-9170.98C3947.75,-9170.98 3947.75,-8397.62 3947.75,-8397.62"/>
<polygon fill="black" stroke="black" points="3951.25,-8397.62 3947.75,-8387.62 3944.25,-8397.62 3951.25,-8397.62"/>
<text text-anchor="middle" x="3954" y="-8775.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_3_attn -->
<g id="node72" class="node">
<title>layer_3_attn</title>
<polygon fill="lightblue" stroke="black" points="3808.5,-8813.17 3399.5,-8813.17 3399.5,-8745.17 3808.5,-8745.17 3808.5,-8813.17"/>
<text text-anchor="middle" x="3604" y="-8797.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3604" y="-8782.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3604" y="-8767.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3604" y="-8752.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_3_qkv&#45;&gt;layer_3_attn -->
<g id="edge173" class="edge">
<title>layer_3_qkv&#45;&gt;layer_3_attn</title>
<path fill="none" stroke="black" d="M3618.5,-8957.94C3618.5,-8957.94 3618.5,-8823.3 3618.5,-8823.3"/>
<polygon fill="black" stroke="black" points="3622,-8823.3 3618.5,-8813.3 3615,-8823.3 3622,-8823.3"/>
</g>
<!-- layer_3_proj -->
<g id="node73" class="node">
<title>layer_3_proj</title>
<polygon fill="lightblue" stroke="black" points="3834.5,-8600.17 3437.5,-8600.17 3437.5,-8532.17 3834.5,-8532.17 3834.5,-8600.17"/>
<text text-anchor="middle" x="3636" y="-8584.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3636" y="-8569.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3636" y="-8554.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3636" y="-8539.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_3_attn&#45;&gt;layer_3_proj -->
<g id="edge174" class="edge">
<title>layer_3_attn&#45;&gt;layer_3_proj</title>
<path fill="none" stroke="black" d="M3623,-8744.94C3623,-8744.94 3623,-8610.3 3623,-8610.3"/>
<polygon fill="black" stroke="black" points="3626.5,-8610.3 3623,-8600.3 3619.5,-8610.3 3626.5,-8610.3"/>
</g>
<!-- layer_3_proj&#45;&gt;layer_3_add_norm1 -->
<g id="edge175" class="edge">
<title>layer_3_proj&#45;&gt;layer_3_add_norm1</title>
<path fill="none" stroke="black" d="M3765.25,-8531.94C3765.25,-8531.94 3765.25,-8397.3 3765.25,-8397.3"/>
<polygon fill="black" stroke="black" points="3768.75,-8397.3 3765.25,-8387.3 3761.75,-8397.3 3768.75,-8397.3"/>
</g>
<!-- layer_3_gate -->
<g id="node75" class="node">
<title>layer_3_gate</title>
<polygon fill="yellow" stroke="black" points="3817.73,-8174.17 3240.71,-8174.17 3092.27,-8038.17 3669.29,-8038.17 3817.73,-8174.17"/>
<text text-anchor="middle" x="3455" y="-8124.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3455" y="-8109.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3455" y="-8094.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3455" y="-8079.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_gate -->
<g id="edge177" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" d="M3756.93,-8319.08C3756.93,-8319.08 3756.93,-8184.37 3756.93,-8184.37"/>
<polygon fill="black" stroke="black" points="3760.43,-8184.37 3756.93,-8174.37 3753.43,-8184.37 3760.43,-8184.37"/>
</g>
<!-- layer_3_moe_agg -->
<g id="node76" class="node">
<title>layer_3_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="3907,-7666.17 3545,-7666.17 3545,-7598.17 3907,-7598.17 3907,-7666.17"/>
<text text-anchor="middle" x="3726" y="-7650.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="3726" y="-7635.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3726" y="-7620.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3726" y="-7605.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_moe_agg -->
<g id="edge178" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M3937.93,-8319.13C3937.93,-8215.35 3937.93,-7910 3937.93,-7910 3937.93,-7910 3767,-7910 3767,-7910 3767,-7910 3767,-7676.23 3767,-7676.23"/>
<polygon fill="black" stroke="black" points="3770.5,-7676.23 3767,-7666.23 3763.5,-7676.23 3770.5,-7676.23"/>
</g>
<!-- layer_3_expert_0 -->
<g id="node77" class="node">
<title>layer_3_expert_0</title>
<polygon fill="lightblue" stroke="black" points="2058,-7879.17 1696,-7879.17 1696,-7811.17 2058,-7811.17 2058,-7879.17"/>
<text text-anchor="middle" x="1877" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1877" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_0 -->
<g id="edge180" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_0</title>
<path fill="none" stroke="black" d="M3695.59,-8349C3187.37,-8349 1786.5,-8349 1786.5,-8349 1786.5,-8349 1786.5,-7889.4 1786.5,-7889.4"/>
<polygon fill="black" stroke="black" points="1790,-7889.4 1786.5,-7879.4 1783,-7889.4 1790,-7889.4"/>
</g>
<!-- layer_3_expert_1 -->
<g id="node78" class="node">
<title>layer_3_expert_1</title>
<polygon fill="lightblue" stroke="black" points="2478,-7879.17 2116,-7879.17 2116,-7811.17 2478,-7811.17 2478,-7879.17"/>
<text text-anchor="middle" x="2297" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2297" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_1 -->
<g id="edge183" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_1</title>
<path fill="none" stroke="black" d="M3695.84,-8341C3263.39,-8341 2206.5,-8341 2206.5,-8341 2206.5,-8341 2206.5,-7889.25 2206.5,-7889.25"/>
<polygon fill="black" stroke="black" points="2210,-7889.25 2206.5,-7879.25 2203,-7889.25 2210,-7889.25"/>
</g>
<!-- layer_3_expert_2 -->
<g id="node79" class="node">
<title>layer_3_expert_2</title>
<polygon fill="lightblue" stroke="black" points="5418,-7879.17 5056,-7879.17 5056,-7811.17 5418,-7811.17 5418,-7879.17"/>
<text text-anchor="middle" x="5237" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5237" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_2 -->
<g id="edge186" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_2</title>
<path fill="none" stroke="black" d="M4058.3,-8344C4428.57,-8344 5237,-8344 5237,-8344 5237,-8344 5237,-7889.45 5237,-7889.45"/>
<polygon fill="black" stroke="black" points="5240.5,-7889.45 5237,-7879.45 5233.5,-7889.45 5240.5,-7889.45"/>
</g>
<!-- layer_3_expert_3 -->
<g id="node80" class="node">
<title>layer_3_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1218,-7879.17 856,-7879.17 856,-7811.17 1218,-7811.17 1218,-7879.17"/>
<text text-anchor="middle" x="1037" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1037" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_3 -->
<g id="edge189" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_3</title>
<path fill="none" stroke="black" d="M3695.9,-8364C3056.98,-8364 946.5,-8364 946.5,-8364 946.5,-8364 946.5,-7889.21 946.5,-7889.21"/>
<polygon fill="black" stroke="black" points="950,-7889.21 946.5,-7879.21 943,-7889.21 950,-7889.21"/>
</g>
<!-- layer_3_expert_4 -->
<g id="node81" class="node">
<title>layer_3_expert_4</title>
<polygon fill="lightblue" stroke="black" points="1638,-7879.17 1276,-7879.17 1276,-7811.17 1638,-7811.17 1638,-7879.17"/>
<text text-anchor="middle" x="1457" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1457" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_4 -->
<g id="edge192" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_4</title>
<path fill="none" stroke="black" d="M3695.95,-8356C3119.79,-8356 1366.5,-8356 1366.5,-8356 1366.5,-8356 1366.5,-7889.48 1366.5,-7889.48"/>
<polygon fill="black" stroke="black" points="1370,-7889.48 1366.5,-7879.48 1363,-7889.48 1370,-7889.48"/>
</g>
<!-- layer_3_expert_5 -->
<g id="node82" class="node">
<title>layer_3_expert_5</title>
<polygon fill="lightblue" stroke="black" points="4158,-7879.17 3796,-7879.17 3796,-7811.17 4158,-7811.17 4158,-7879.17"/>
<text text-anchor="middle" x="3977" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3977" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_5 -->
<g id="edge195" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_5</title>
<path fill="none" stroke="black" d="M3997.97,-8319.05C3997.97,-8319.05 3997.97,-7889.47 3997.97,-7889.47"/>
<polygon fill="black" stroke="black" points="4001.47,-7889.47 3997.97,-7879.47 3994.47,-7889.47 4001.47,-7889.47"/>
</g>
<!-- layer_3_expert_6 -->
<g id="node83" class="node">
<title>layer_3_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2898,-7879.17 2536,-7879.17 2536,-7811.17 2898,-7811.17 2898,-7879.17"/>
<text text-anchor="middle" x="2717" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2717" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_6 -->
<g id="edge198" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_6</title>
<path fill="none" stroke="black" d="M3695.83,-8334C3349.27,-8334 2626.5,-8334 2626.5,-8334 2626.5,-8334 2626.5,-7889.54 2626.5,-7889.54"/>
<polygon fill="black" stroke="black" points="2630,-7889.54 2626.5,-7879.54 2623,-7889.54 2630,-7889.54"/>
</g>
<!-- layer_3_expert_7 -->
<g id="node84" class="node">
<title>layer_3_expert_7</title>
<polygon fill="lightblue" stroke="black" points="5838,-7879.17 5476,-7879.17 5476,-7811.17 5838,-7811.17 5838,-7879.17"/>
<text text-anchor="middle" x="5657" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5657" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_7 -->
<g id="edge201" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_7</title>
<path fill="none" stroke="black" d="M4058.3,-8353C4511.39,-8353 5657,-8353 5657,-8353 5657,-8353 5657,-7889.28 5657,-7889.28"/>
<polygon fill="black" stroke="black" points="5660.5,-7889.28 5657,-7879.28 5653.5,-7889.28 5660.5,-7889.28"/>
</g>
<!-- layer_3_expert_8 -->
<g id="node85" class="node">
<title>layer_3_expert_8</title>
<polygon fill="lightblue" stroke="black" points="378,-7879.17 16,-7879.17 16,-7811.17 378,-7811.17 378,-7879.17"/>
<text text-anchor="middle" x="197" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="197" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_8 -->
<g id="edge204" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_8</title>
<path fill="none" stroke="black" d="M3695.76,-8379C2955.07,-8379 197,-8379 197,-8379 197,-8379 197,-7889.37 197,-7889.37"/>
<polygon fill="black" stroke="black" points="200.5,-7889.37 197,-7879.37 193.5,-7889.37 200.5,-7889.37"/>
</g>
<!-- layer_3_expert_9 -->
<g id="node86" class="node">
<title>layer_3_expert_9</title>
<polygon fill="lightblue" stroke="black" points="6258,-7879.17 5896,-7879.17 5896,-7811.17 6258,-7811.17 6258,-7879.17"/>
<text text-anchor="middle" x="6077" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="6077" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_9 -->
<g id="edge207" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_9</title>
<path fill="none" stroke="black" d="M4058.44,-8361C4585.11,-8361 6077,-8361 6077,-8361 6077,-8361 6077,-7889.41 6077,-7889.41"/>
<polygon fill="black" stroke="black" points="6080.5,-7889.41 6077,-7879.41 6073.5,-7889.41 6080.5,-7889.41"/>
</g>
<!-- layer_3_expert_10 -->
<g id="node87" class="node">
<title>layer_3_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4998,-7879.17 4636,-7879.17 4636,-7811.17 4998,-7811.17 4998,-7879.17"/>
<text text-anchor="middle" x="4817" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4817" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_10 -->
<g id="edge210" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_10</title>
<path fill="none" stroke="black" d="M4058.24,-8336C4331.39,-8336 4817,-8336 4817,-8336 4817,-8336 4817,-7889.29 4817,-7889.29"/>
<polygon fill="black" stroke="black" points="4820.5,-7889.29 4817,-7879.29 4813.5,-7889.29 4820.5,-7889.29"/>
</g>
<!-- layer_3_expert_11 -->
<g id="node88" class="node">
<title>layer_3_expert_11</title>
<polygon fill="lightblue" stroke="black" points="798,-7879.17 436,-7879.17 436,-7811.17 798,-7811.17 798,-7879.17"/>
<text text-anchor="middle" x="617" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="617" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_11 -->
<g id="edge213" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_11</title>
<path fill="none" stroke="black" d="M3695.92,-8372C3010.93,-8372 617,-8372 617,-8372 617,-8372 617,-7889.33 617,-7889.33"/>
<polygon fill="black" stroke="black" points="620.5,-7889.33 617,-7879.33 613.5,-7889.33 620.5,-7889.33"/>
</g>
<!-- layer_3_expert_12 -->
<g id="node89" class="node">
<title>layer_3_expert_12</title>
<polygon fill="lightblue" stroke="black" points="3318,-7879.17 2956,-7879.17 2956,-7811.17 3318,-7811.17 3318,-7879.17"/>
<text text-anchor="middle" x="3137" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3137" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_12 -->
<g id="edge216" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_12</title>
<path fill="none" stroke="black" d="M3695.85,-8326C3445.45,-8326 3024.07,-8326 3024.07,-8326 3024.07,-8326 3024.07,-7889.36 3024.07,-7889.36"/>
<polygon fill="black" stroke="black" points="3027.57,-7889.36 3024.07,-7879.36 3020.57,-7889.36 3027.57,-7889.36"/>
</g>
<!-- layer_3_expert_13 -->
<g id="node90" class="node">
<title>layer_3_expert_13</title>
<polygon fill="lightblue" stroke="black" points="6678,-7879.17 6316,-7879.17 6316,-7811.17 6678,-7811.17 6678,-7879.17"/>
<text text-anchor="middle" x="6497" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6497" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_13 -->
<g id="edge219" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_13</title>
<path fill="none" stroke="black" d="M4058.12,-8370C4651.16,-8370 6497,-8370 6497,-8370 6497,-8370 6497,-7889.2 6497,-7889.2"/>
<polygon fill="black" stroke="black" points="6500.5,-7889.2 6497,-7879.2 6493.5,-7889.2 6500.5,-7889.2"/>
</g>
<!-- layer_3_expert_14 -->
<g id="node91" class="node">
<title>layer_3_expert_14</title>
<polygon fill="lightblue" stroke="black" points="4578,-7879.17 4216,-7879.17 4216,-7811.17 4578,-7811.17 4578,-7879.17"/>
<text text-anchor="middle" x="4397" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4397" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_14 -->
<g id="edge222" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_14</title>
<path fill="none" stroke="black" d="M4058.14,-8327C4208.21,-8327 4397,-8327 4397,-8327 4397,-8327 4397,-7889.43 4397,-7889.43"/>
<polygon fill="black" stroke="black" points="4400.5,-7889.43 4397,-7879.43 4393.5,-7889.43 4400.5,-7889.43"/>
</g>
<!-- layer_3_expert_15 -->
<g id="node92" class="node">
<title>layer_3_expert_15</title>
<polygon fill="lightblue" stroke="black" points="3738,-7879.17 3376,-7879.17 3376,-7811.17 3738,-7811.17 3738,-7879.17"/>
<text text-anchor="middle" x="3557" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3557" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_expert_15 -->
<g id="edge225" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_expert_15</title>
<path fill="none" stroke="black" d="M3877.9,-8318.82C3877.9,-8220 3877.9,-7942 3877.9,-7942 3877.9,-7942 3617.33,-7942 3617.33,-7942 3617.33,-7942 3617.33,-7889.31 3617.33,-7889.31"/>
<polygon fill="black" stroke="black" points="3620.83,-7889.31 3617.33,-7879.31 3613.83,-7889.31 3620.83,-7889.31"/>
</g>
<!-- layer_3_add_norm2 -->
<g id="node93" class="node">
<title>layer_3_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4038,-7453.17 3676,-7453.17 3676,-7385.17 4038,-7385.17 4038,-7453.17"/>
<text text-anchor="middle" x="3857" y="-7437.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3857" y="-7422.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3857" y="-7407.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3857" y="-7392.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_3_add_norm1&#45;&gt;layer_3_add_norm2 -->
<g id="edge228" class="edge">
<title>layer_3_add_norm1&#45;&gt;layer_3_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4058.03,-8323C4119.45,-8323 4172.83,-8323 4172.83,-8323 4172.83,-8323 4172.83,-7419 4172.83,-7419 4172.83,-7419 4048.43,-7419 4048.43,-7419"/>
<polygon fill="black" stroke="black" points="4048.43,-7415.5 4038.43,-7419 4048.43,-7422.5 4048.43,-7415.5"/>
<text text-anchor="middle" x="6883" y="-7841.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_0 -->
<g id="edge179" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3147.69,-8089C2712.12,-8089 1967.5,-8089 1967.5,-8089 1967.5,-8089 1967.5,-7889.33 1967.5,-7889.33"/>
<polygon fill="black" stroke="black" points="1971,-7889.33 1967.5,-7879.33 1964,-7889.33 1971,-7889.33"/>
<text text-anchor="middle" x="2638.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_1 -->
<g id="edge182" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3128.91,-8072C2814.98,-8072 2387.5,-8072 2387.5,-8072 2387.5,-8072 2387.5,-7889.62 2387.5,-7889.62"/>
<polygon fill="black" stroke="black" points="2391,-7889.62 2387.5,-7879.62 2384,-7889.62 2391,-7889.62"/>
<text text-anchor="middle" x="2978.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_2 -->
<g id="edge185" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3732.42,-8096C4212.3,-8096 5146.5,-8096 5146.5,-8096 5146.5,-8096 5146.5,-7889.26 5146.5,-7889.26"/>
<polygon fill="black" stroke="black" points="5150,-7889.26 5146.5,-7879.26 5143,-7889.26 5150,-7889.26"/>
<text text-anchor="middle" x="4575.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_3 -->
<g id="edge188" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3184.59,-8123C2571.27,-8123 1127.5,-8123 1127.5,-8123 1127.5,-8123 1127.5,-7889.23 1127.5,-7889.23"/>
<polygon fill="black" stroke="black" points="1131,-7889.23 1127.5,-7879.23 1124,-7889.23 1131,-7889.23"/>
<text text-anchor="middle" x="1933.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_4 -->
<g id="edge191" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3166.07,-8106C2632.73,-8106 1547.5,-8106 1547.5,-8106 1547.5,-8106 1547.5,-7889.27 1547.5,-7889.27"/>
<polygon fill="black" stroke="black" points="1551,-7889.27 1547.5,-7879.27 1544,-7889.27 1551,-7889.27"/>
<text text-anchor="middle" x="2293.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_5 -->
<g id="edge194" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3806.93,-8106.12C3806.93,-8106.12 3806.93,-7889.33 3806.93,-7889.33"/>
<polygon fill="black" stroke="black" points="3810.43,-7889.33 3806.93,-7879.33 3803.43,-7889.33 3810.43,-7889.33"/>
<text text-anchor="middle" x="3753.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_6 -->
<g id="edge197" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3110.4,-8055C2955.76,-8055 2807.5,-8055 2807.5,-8055 2807.5,-8055 2807.5,-7889.35 2807.5,-7889.35"/>
<polygon fill="black" stroke="black" points="2811,-7889.35 2807.5,-7879.35 2804,-7889.35 2811,-7889.35"/>
<text text-anchor="middle" x="3186.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_7 -->
<g id="edge200" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3753.33,-8115C4335.48,-8115 5566.5,-8115 5566.5,-8115 5566.5,-8115 5566.5,-7889.34 5566.5,-7889.34"/>
<polygon fill="black" stroke="black" points="5570,-7889.34 5566.5,-7879.34 5563,-7889.34 5570,-7889.34"/>
<text text-anchor="middle" x="4958.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_8 -->
<g id="edge203" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3221.76,-8157C2489.95,-8157 287.5,-8157 287.5,-8157 287.5,-8157 287.5,-7889.43 287.5,-7889.43"/>
<polygon fill="black" stroke="black" points="291,-7889.43 287.5,-7879.43 284,-7889.43 291,-7889.43"/>
<text text-anchor="middle" x="1004.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_9 -->
<g id="edge206" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3775.3,-8135C4456.33,-8135 5986.5,-8135 5986.5,-8135 5986.5,-8135 5986.5,-7889.27 5986.5,-7889.27"/>
<polygon fill="black" stroke="black" points="5990,-7889.27 5986.5,-7879.27 5983,-7889.27 5990,-7889.27"/>
<text text-anchor="middle" x="5369.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_10 -->
<g id="edge209" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3711.92,-8077C4083.4,-8077 4726.5,-8077 4726.5,-8077 4726.5,-8077 4726.5,-7889.37 4726.5,-7889.37"/>
<polygon fill="black" stroke="black" points="4730,-7889.37 4726.5,-7879.37 4723,-7889.37 4730,-7889.37"/>
<text text-anchor="middle" x="4185.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_11 -->
<g id="edge212" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3203.28,-8140C2524.55,-8140 707.5,-8140 707.5,-8140 707.5,-8140 707.5,-7889.28 707.5,-7889.28"/>
<polygon fill="black" stroke="black" points="711,-7889.28 707.5,-7879.28 704,-7889.28 711,-7889.28"/>
<text text-anchor="middle" x="1424.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_12 -->
<g id="edge215" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.07,-8037.93C3205.07,-8037.93 3205.07,-7889.49 3205.07,-7889.49"/>
<polygon fill="black" stroke="black" points="3208.57,-7889.49 3205.07,-7879.49 3201.57,-7889.49 3208.57,-7889.49"/>
<text text-anchor="middle" x="3333.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_13 -->
<g id="edge218" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3795.74,-8154C4572.25,-8154 6406.5,-8154 6406.5,-8154 6406.5,-8154 6406.5,-7889.4 6406.5,-7889.4"/>
<polygon fill="black" stroke="black" points="6410,-7889.4 6406.5,-7879.4 6403,-7889.4 6410,-7889.4"/>
<text text-anchor="middle" x="5748.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_14 -->
<g id="edge221" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3689.93,-8057C3941.97,-8057 4306.5,-8057 4306.5,-8057 4306.5,-8057 4306.5,-7889.2 4306.5,-7889.2"/>
<polygon fill="black" stroke="black" points="4310,-7889.2 4306.5,-7879.2 4303,-7889.2 4310,-7889.2"/>
<text text-anchor="middle" x="3967.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_15 -->
<g id="edge224" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3496.67,-8037.93C3496.67,-8037.93 3496.67,-7889.49 3496.67,-7889.49"/>
<polygon fill="black" stroke="black" points="3500.17,-7889.49 3496.67,-7879.49 3493.17,-7889.49 3500.17,-7889.49"/>
<text text-anchor="middle" x="3514.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_3_moe_agg&#45;&gt;layer_3_add_norm2 -->
<g id="edge227" class="edge">
<title>layer_3_moe_agg&#45;&gt;layer_3_add_norm2</title>
<path fill="none" stroke="black" d="M3791.5,-7597.94C3791.5,-7597.94 3791.5,-7463.3 3791.5,-7463.3"/>
<polygon fill="black" stroke="black" points="3795,-7463.3 3791.5,-7453.3 3788,-7463.3 3795,-7463.3"/>
</g>
<!-- layer_3_expert_0&#45;&gt;layer_3_moe_agg -->
<g id="edge181" class="edge">
<title>layer_3_expert_0&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M1877,-7810.93C1877,-7751.38 1877,-7635 1877,-7635 1877,-7635 3534.92,-7635 3534.92,-7635"/>
<polygon fill="black" stroke="black" points="3534.92,-7638.5 3544.92,-7635 3534.92,-7631.5 3534.92,-7638.5"/>
</g>
<!-- layer_3_expert_1&#45;&gt;layer_3_moe_agg -->
<g id="edge184" class="edge">
<title>layer_3_expert_1&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M2297,-7810.87C2297,-7753.19 2297,-7643 2297,-7643 2297,-7643 3534.65,-7643 3534.65,-7643"/>
<polygon fill="black" stroke="black" points="3534.65,-7646.5 3544.65,-7643 3534.65,-7639.5 3534.65,-7646.5"/>
</g>
<!-- layer_3_expert_2&#45;&gt;layer_3_moe_agg -->
<g id="edge187" class="edge">
<title>layer_3_expert_2&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M5237,-7811.08C5237,-7755.62 5237,-7652 5237,-7652 5237,-7652 3917.14,-7652 3917.14,-7652"/>
<polygon fill="black" stroke="black" points="3917.14,-7648.5 3907.14,-7652 3917.14,-7655.5 3917.14,-7648.5"/>
</g>
<!-- layer_3_expert_3&#45;&gt;layer_3_moe_agg -->
<g id="edge190" class="edge">
<title>layer_3_expert_3&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M1037,-7810.97C1037,-7747.98 1037,-7620 1037,-7620 1037,-7620 3534.87,-7620 3534.87,-7620"/>
<polygon fill="black" stroke="black" points="3534.87,-7623.5 3544.87,-7620 3534.87,-7616.5 3534.87,-7623.5"/>
</g>
<!-- layer_3_expert_4&#45;&gt;layer_3_moe_agg -->
<g id="edge193" class="edge">
<title>layer_3_expert_4&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M1457,-7810.76C1457,-7749.52 1457,-7628 1457,-7628 1457,-7628 3534.63,-7628 3534.63,-7628"/>
<polygon fill="black" stroke="black" points="3534.63,-7631.5 3544.63,-7628 3534.63,-7624.5 3534.63,-7631.5"/>
</g>
<!-- layer_3_expert_5&#45;&gt;layer_3_moe_agg -->
<g id="edge196" class="edge">
<title>layer_3_expert_5&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M3851.5,-7810.94C3851.5,-7810.94 3851.5,-7676.3 3851.5,-7676.3"/>
<polygon fill="black" stroke="black" points="3855,-7676.3 3851.5,-7666.3 3848,-7676.3 3855,-7676.3"/>
</g>
<!-- layer_3_expert_6&#45;&gt;layer_3_moe_agg -->
<g id="edge199" class="edge">
<title>layer_3_expert_6&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M2717,-7810.9C2717,-7755.16 2717,-7651 2717,-7651 2717,-7651 3534.74,-7651 3534.74,-7651"/>
<polygon fill="black" stroke="black" points="3534.74,-7654.5 3544.74,-7651 3534.74,-7647.5 3534.74,-7654.5"/>
</g>
<!-- layer_3_expert_7&#45;&gt;layer_3_moe_agg -->
<g id="edge202" class="edge">
<title>layer_3_expert_7&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M5657,-7810.82C5657,-7754.33 5657,-7648 5657,-7648 5657,-7648 3917.23,-7648 3917.23,-7648"/>
<polygon fill="black" stroke="black" points="3917.23,-7644.5 3907.23,-7648 3917.23,-7651.5 3917.23,-7644.5"/>
</g>
<!-- layer_3_expert_8&#45;&gt;layer_3_moe_agg -->
<g id="edge205" class="edge">
<title>layer_3_expert_8&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M197,-7811.01C197,-7744.71 197,-7605 197,-7605 197,-7605 3534.92,-7605 3534.92,-7605"/>
<polygon fill="black" stroke="black" points="3534.92,-7608.5 3544.92,-7605 3534.92,-7601.5 3534.92,-7608.5"/>
</g>
<!-- layer_3_expert_9&#45;&gt;layer_3_moe_agg -->
<g id="edge208" class="edge">
<title>layer_3_expert_9&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M6077,-7810.87C6077,-7753.19 6077,-7643 6077,-7643 6077,-7643 3917.06,-7643 3917.06,-7643"/>
<polygon fill="black" stroke="black" points="3917.06,-7639.5 3907.06,-7643 3917.06,-7646.5 3917.06,-7639.5"/>
</g>
<!-- layer_3_expert_10&#45;&gt;layer_3_moe_agg -->
<g id="edge211" class="edge">
<title>layer_3_expert_10&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M4817,-7811.09C4817,-7756.87 4817,-7657 4817,-7657 4817,-7657 3917.07,-7657 3917.07,-7657"/>
<polygon fill="black" stroke="black" points="3917.07,-7653.5 3907.07,-7657 3917.07,-7660.5 3917.07,-7653.5"/>
</g>
<!-- layer_3_expert_11&#45;&gt;layer_3_moe_agg -->
<g id="edge214" class="edge">
<title>layer_3_expert_11&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M617,-7810.91C617,-7746.33 617,-7613 617,-7613 617,-7613 3534.84,-7613 3534.84,-7613"/>
<polygon fill="black" stroke="black" points="3534.84,-7616.5 3544.84,-7613 3534.84,-7609.5 3534.84,-7616.5"/>
</g>
<!-- layer_3_expert_12&#45;&gt;layer_3_moe_agg -->
<g id="edge217" class="edge">
<title>layer_3_expert_12&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M3195.57,-7810.84C3195.57,-7756.8 3195.57,-7658 3195.57,-7658 3195.57,-7658 3534.94,-7658 3534.94,-7658"/>
<polygon fill="black" stroke="black" points="3534.94,-7661.5 3544.94,-7658 3534.94,-7654.5 3534.94,-7661.5"/>
</g>
<!-- layer_3_expert_13&#45;&gt;layer_3_moe_agg -->
<g id="edge220" class="edge">
<title>layer_3_expert_13&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M6497,-7810.96C6497,-7752.12 6497,-7638 6497,-7638 6497,-7638 3917.01,-7638 3917.01,-7638"/>
<polygon fill="black" stroke="black" points="3917.01,-7634.5 3907.01,-7638 3917.01,-7641.5 3917.01,-7634.5"/>
</g>
<!-- layer_3_expert_14&#45;&gt;layer_3_moe_agg -->
<g id="edge223" class="edge">
<title>layer_3_expert_14&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M4487.5,-7810.96C4487.5,-7757.7 4487.5,-7661 4487.5,-7661 4487.5,-7661 3917.43,-7661 3917.43,-7661"/>
<polygon fill="black" stroke="black" points="3917.43,-7657.5 3907.43,-7661 3917.43,-7664.5 3917.43,-7657.5"/>
</g>
<!-- layer_3_expert_15&#45;&gt;layer_3_moe_agg -->
<g id="edge226" class="edge">
<title>layer_3_expert_15&#45;&gt;layer_3_moe_agg</title>
<path fill="none" stroke="black" d="M3641.5,-7810.94C3641.5,-7810.94 3641.5,-7676.3 3641.5,-7676.3"/>
<polygon fill="black" stroke="black" points="3645,-7676.3 3641.5,-7666.3 3638,-7676.3 3645,-7676.3"/>
</g>
<!-- layer_4_qkv -->
<g id="node94" class="node">
<title>layer_4_qkv</title>
<polygon fill="lightblue" stroke="black" points="3822.5,-7240.17 3413.5,-7240.17 3413.5,-7172.17 3822.5,-7172.17 3822.5,-7240.17"/>
<text text-anchor="middle" x="3618" y="-7224.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3618" y="-7209.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3618" y="-7194.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3618" y="-7179.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_3_add_norm2&#45;&gt;layer_4_qkv -->
<g id="edge229" class="edge">
<title>layer_3_add_norm2&#45;&gt;layer_4_qkv</title>
<path fill="none" stroke="black" d="M3749.25,-7384.94C3749.25,-7384.94 3749.25,-7250.3 3749.25,-7250.3"/>
<polygon fill="black" stroke="black" points="3752.75,-7250.3 3749.25,-7240.3 3745.75,-7250.3 3752.75,-7250.3"/>
</g>
<!-- layer_4_add_norm1 -->
<g id="node97" class="node">
<title>layer_4_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4039,-6601.17 3677,-6601.17 3677,-6533.17 4039,-6533.17 4039,-6601.17"/>
<text text-anchor="middle" x="3858" y="-6585.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3858" y="-6570.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3858" y="-6555.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3858" y="-6540.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_3_add_norm2&#45;&gt;layer_4_add_norm1 -->
<g id="edge233" class="edge">
<title>layer_3_add_norm2&#45;&gt;layer_4_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3930.25,-7384.98C3930.25,-7384.98 3930.25,-6611.62 3930.25,-6611.62"/>
<polygon fill="black" stroke="black" points="3933.75,-6611.62 3930.25,-6601.62 3926.75,-6611.62 3933.75,-6611.62"/>
<text text-anchor="middle" x="3939" y="-6989.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_4_attn -->
<g id="node95" class="node">
<title>layer_4_attn</title>
<polygon fill="lightblue" stroke="black" points="3793.5,-7027.17 3384.5,-7027.17 3384.5,-6959.17 3793.5,-6959.17 3793.5,-7027.17"/>
<text text-anchor="middle" x="3589" y="-7011.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3589" y="-6996.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3589" y="-6981.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3589" y="-6966.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_4_qkv&#45;&gt;layer_4_attn -->
<g id="edge230" class="edge">
<title>layer_4_qkv&#45;&gt;layer_4_attn</title>
<path fill="none" stroke="black" d="M3603.5,-7171.94C3603.5,-7171.94 3603.5,-7037.3 3603.5,-7037.3"/>
<polygon fill="black" stroke="black" points="3607,-7037.3 3603.5,-7027.3 3600,-7037.3 3607,-7037.3"/>
</g>
<!-- layer_4_proj -->
<g id="node96" class="node">
<title>layer_4_proj</title>
<polygon fill="lightblue" stroke="black" points="3819.5,-6814.17 3422.5,-6814.17 3422.5,-6746.17 3819.5,-6746.17 3819.5,-6814.17"/>
<text text-anchor="middle" x="3621" y="-6798.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3621" y="-6783.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3621" y="-6768.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3621" y="-6753.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_4_attn&#45;&gt;layer_4_proj -->
<g id="edge231" class="edge">
<title>layer_4_attn&#45;&gt;layer_4_proj</title>
<path fill="none" stroke="black" d="M3608,-6958.94C3608,-6958.94 3608,-6824.3 3608,-6824.3"/>
<polygon fill="black" stroke="black" points="3611.5,-6824.3 3608,-6814.3 3604.5,-6824.3 3611.5,-6824.3"/>
</g>
<!-- layer_4_proj&#45;&gt;layer_4_add_norm1 -->
<g id="edge232" class="edge">
<title>layer_4_proj&#45;&gt;layer_4_add_norm1</title>
<path fill="none" stroke="black" d="M3748.25,-6745.94C3748.25,-6745.94 3748.25,-6611.3 3748.25,-6611.3"/>
<polygon fill="black" stroke="black" points="3751.75,-6611.3 3748.25,-6601.3 3744.75,-6611.3 3751.75,-6611.3"/>
</g>
<!-- layer_4_gate -->
<g id="node98" class="node">
<title>layer_4_gate</title>
<polygon fill="yellow" stroke="black" points="3798.73,-6388.17 3221.71,-6388.17 3073.27,-6252.17 3650.29,-6252.17 3798.73,-6388.17"/>
<text text-anchor="middle" x="3436" y="-6338.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3436" y="-6323.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3436" y="-6308.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3436" y="-6293.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_gate -->
<g id="edge234" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_gate</title>
<path fill="none" stroke="black" d="M3737.93,-6533.08C3737.93,-6533.08 3737.93,-6398.37 3737.93,-6398.37"/>
<polygon fill="black" stroke="black" points="3741.43,-6398.37 3737.93,-6388.37 3734.43,-6398.37 3741.43,-6398.37"/>
</g>
<!-- layer_4_moe_agg -->
<g id="node99" class="node">
<title>layer_4_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="3859,-5880.17 3497,-5880.17 3497,-5812.17 3859,-5812.17 3859,-5880.17"/>
<text text-anchor="middle" x="3678" y="-5864.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="3678" y="-5849.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3678" y="-5834.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3678" y="-5819.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_moe_agg -->
<g id="edge235" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M3918.93,-6533.13C3918.93,-6429.35 3918.93,-6124 3918.93,-6124 3918.93,-6124 3757.33,-6124 3757.33,-6124 3757.33,-6124 3757.33,-5890.23 3757.33,-5890.23"/>
<polygon fill="black" stroke="black" points="3760.83,-5890.23 3757.33,-5880.23 3753.83,-5890.23 3760.83,-5890.23"/>
</g>
<!-- layer_4_expert_0 -->
<g id="node100" class="node">
<title>layer_4_expert_0</title>
<polygon fill="lightblue" stroke="black" points="2058,-6093.17 1696,-6093.17 1696,-6025.17 2058,-6025.17 2058,-6093.17"/>
<text text-anchor="middle" x="1877" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1877" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_0 -->
<g id="edge237" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_0</title>
<path fill="none" stroke="black" d="M3676.89,-6563C3172.15,-6563 1786.5,-6563 1786.5,-6563 1786.5,-6563 1786.5,-6103.4 1786.5,-6103.4"/>
<polygon fill="black" stroke="black" points="1790,-6103.4 1786.5,-6093.4 1783,-6103.4 1790,-6103.4"/>
</g>
<!-- layer_4_expert_1 -->
<g id="node101" class="node">
<title>layer_4_expert_1</title>
<polygon fill="lightblue" stroke="black" points="2478,-6093.17 2116,-6093.17 2116,-6025.17 2478,-6025.17 2478,-6093.17"/>
<text text-anchor="middle" x="2297" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2297" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_1 -->
<g id="edge240" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_1</title>
<path fill="none" stroke="black" d="M3676.93,-6555C3248.16,-6555 2206.5,-6555 2206.5,-6555 2206.5,-6555 2206.5,-6103.25 2206.5,-6103.25"/>
<polygon fill="black" stroke="black" points="2210,-6103.25 2206.5,-6093.25 2203,-6103.25 2210,-6103.25"/>
</g>
<!-- layer_4_expert_2 -->
<g id="node102" class="node">
<title>layer_4_expert_2</title>
<polygon fill="lightblue" stroke="black" points="5418,-6093.17 5056,-6093.17 5056,-6025.17 5418,-6025.17 5418,-6093.17"/>
<text text-anchor="middle" x="5237" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5237" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_2 -->
<g id="edge243" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_2</title>
<path fill="none" stroke="black" d="M4039.29,-6558C4432.27,-6558 5327.5,-6558 5327.5,-6558 5327.5,-6558 5327.5,-6103.45 5327.5,-6103.45"/>
<polygon fill="black" stroke="black" points="5331,-6103.45 5327.5,-6093.45 5324,-6103.45 5331,-6103.45"/>
</g>
<!-- layer_4_expert_3 -->
<g id="node103" class="node">
<title>layer_4_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1218,-6093.17 856,-6093.17 856,-6025.17 1218,-6025.17 1218,-6093.17"/>
<text text-anchor="middle" x="1037" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1037" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_3 -->
<g id="edge246" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_3</title>
<path fill="none" stroke="black" d="M3676.97,-6578C3040.89,-6578 946.5,-6578 946.5,-6578 946.5,-6578 946.5,-6103.21 946.5,-6103.21"/>
<polygon fill="black" stroke="black" points="950,-6103.21 946.5,-6093.21 943,-6103.21 950,-6103.21"/>
</g>
<!-- layer_4_expert_4 -->
<g id="node104" class="node">
<title>layer_4_expert_4</title>
<polygon fill="lightblue" stroke="black" points="1638,-6093.17 1276,-6093.17 1276,-6025.17 1638,-6025.17 1638,-6093.17"/>
<text text-anchor="middle" x="1457" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1457" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_4 -->
<g id="edge249" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_4</title>
<path fill="none" stroke="black" d="M3676.81,-6570C3103.47,-6570 1366.5,-6570 1366.5,-6570 1366.5,-6570 1366.5,-6103.48 1366.5,-6103.48"/>
<polygon fill="black" stroke="black" points="1370,-6103.48 1366.5,-6093.48 1363,-6103.48 1370,-6103.48"/>
</g>
<!-- layer_4_expert_5 -->
<g id="node105" class="node">
<title>layer_4_expert_5</title>
<polygon fill="lightblue" stroke="black" points="4158,-6093.17 3796,-6093.17 3796,-6025.17 4158,-6025.17 4158,-6093.17"/>
<text text-anchor="middle" x="3977" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3977" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_5 -->
<g id="edge252" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_5</title>
<path fill="none" stroke="black" d="M3978.97,-6533.05C3978.97,-6533.05 3978.97,-6103.47 3978.97,-6103.47"/>
<polygon fill="black" stroke="black" points="3982.47,-6103.47 3978.97,-6093.47 3975.47,-6103.47 3982.47,-6103.47"/>
</g>
<!-- layer_4_expert_6 -->
<g id="node106" class="node">
<title>layer_4_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2898,-6093.17 2536,-6093.17 2536,-6025.17 2898,-6025.17 2898,-6093.17"/>
<text text-anchor="middle" x="2717" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2717" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_6 -->
<g id="edge255" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_6</title>
<path fill="none" stroke="black" d="M3676.95,-6548C3334.64,-6548 2626.5,-6548 2626.5,-6548 2626.5,-6548 2626.5,-6103.54 2626.5,-6103.54"/>
<polygon fill="black" stroke="black" points="2630,-6103.54 2626.5,-6093.54 2623,-6103.54 2630,-6103.54"/>
</g>
<!-- layer_4_expert_7 -->
<g id="node107" class="node">
<title>layer_4_expert_7</title>
<polygon fill="lightblue" stroke="black" points="5838,-6093.17 5476,-6093.17 5476,-6025.17 5838,-6025.17 5838,-6093.17"/>
<text text-anchor="middle" x="5657" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5657" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_7 -->
<g id="edge258" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_7</title>
<path fill="none" stroke="black" d="M4039.17,-6567C4512.1,-6567 5747.5,-6567 5747.5,-6567 5747.5,-6567 5747.5,-6103.28 5747.5,-6103.28"/>
<polygon fill="black" stroke="black" points="5751,-6103.28 5747.5,-6093.28 5744,-6103.28 5751,-6103.28"/>
</g>
<!-- layer_4_expert_8 -->
<g id="node108" class="node">
<title>layer_4_expert_8</title>
<polygon fill="lightblue" stroke="black" points="378,-6093.17 16,-6093.17 16,-6025.17 378,-6025.17 378,-6093.17"/>
<text text-anchor="middle" x="197" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="197" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_8 -->
<g id="edge261" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_8</title>
<path fill="none" stroke="black" d="M3676.74,-6593C2926.89,-6593 106.5,-6593 106.5,-6593 106.5,-6593 106.5,-6103.37 106.5,-6103.37"/>
<polygon fill="black" stroke="black" points="110,-6103.37 106.5,-6093.37 103,-6103.37 110,-6103.37"/>
</g>
<!-- layer_4_expert_9 -->
<g id="node109" class="node">
<title>layer_4_expert_9</title>
<polygon fill="lightblue" stroke="black" points="6258,-6093.17 5896,-6093.17 5896,-6025.17 6258,-6025.17 6258,-6093.17"/>
<text text-anchor="middle" x="6077" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="6077" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_9 -->
<g id="edge264" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_9</title>
<path fill="none" stroke="black" d="M4039.22,-6575C4583.67,-6575 6167.5,-6575 6167.5,-6575 6167.5,-6575 6167.5,-6103.41 6167.5,-6103.41"/>
<polygon fill="black" stroke="black" points="6171,-6103.41 6167.5,-6093.41 6164,-6103.41 6171,-6103.41"/>
</g>
<!-- layer_4_expert_10 -->
<g id="node110" class="node">
<title>layer_4_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4998,-6093.17 4636,-6093.17 4636,-6025.17 4998,-6025.17 4998,-6093.17"/>
<text text-anchor="middle" x="4817" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4817" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_10 -->
<g id="edge267" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_10</title>
<path fill="none" stroke="black" d="M4039.01,-6550C4339.24,-6550 4907.5,-6550 4907.5,-6550 4907.5,-6550 4907.5,-6103.29 4907.5,-6103.29"/>
<polygon fill="black" stroke="black" points="4911,-6103.29 4907.5,-6093.29 4904,-6103.29 4911,-6103.29"/>
</g>
<!-- layer_4_expert_11 -->
<g id="node111" class="node">
<title>layer_4_expert_11</title>
<polygon fill="lightblue" stroke="black" points="798,-6093.17 436,-6093.17 436,-6025.17 798,-6025.17 798,-6093.17"/>
<text text-anchor="middle" x="617" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="617" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_11 -->
<g id="edge270" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_11</title>
<path fill="none" stroke="black" d="M3676.81,-6586C2982.01,-6586 526.5,-6586 526.5,-6586 526.5,-6586 526.5,-6103.33 526.5,-6103.33"/>
<polygon fill="black" stroke="black" points="530,-6103.33 526.5,-6093.33 523,-6103.33 530,-6103.33"/>
</g>
<!-- layer_4_expert_12 -->
<g id="node112" class="node">
<title>layer_4_expert_12</title>
<polygon fill="lightblue" stroke="black" points="3318,-6093.17 2956,-6093.17 2956,-6025.17 3318,-6025.17 3318,-6093.17"/>
<text text-anchor="middle" x="3137" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3137" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_12 -->
<g id="edge273" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_12</title>
<path fill="none" stroke="black" d="M3676.8,-6540C3428.95,-6540 3014.57,-6540 3014.57,-6540 3014.57,-6540 3014.57,-6103.36 3014.57,-6103.36"/>
<polygon fill="black" stroke="black" points="3018.07,-6103.36 3014.57,-6093.36 3011.07,-6103.36 3018.07,-6103.36"/>
</g>
<!-- layer_4_expert_13 -->
<g id="node113" class="node">
<title>layer_4_expert_13</title>
<polygon fill="lightblue" stroke="black" points="6678,-6093.17 6316,-6093.17 6316,-6025.17 6678,-6025.17 6678,-6093.17"/>
<text text-anchor="middle" x="6497" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6497" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_13 -->
<g id="edge276" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_13</title>
<path fill="none" stroke="black" d="M4039.2,-6584C4648.83,-6584 6587.5,-6584 6587.5,-6584 6587.5,-6584 6587.5,-6103.2 6587.5,-6103.2"/>
<polygon fill="black" stroke="black" points="6591,-6103.2 6587.5,-6093.2 6584,-6103.2 6591,-6103.2"/>
</g>
<!-- layer_4_expert_14 -->
<g id="node114" class="node">
<title>layer_4_expert_14</title>
<polygon fill="lightblue" stroke="black" points="4578,-6093.17 4216,-6093.17 4216,-6025.17 4578,-6025.17 4578,-6093.17"/>
<text text-anchor="middle" x="4397" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4397" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_14 -->
<g id="edge279" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_14</title>
<path fill="none" stroke="black" d="M4039.35,-6541C4195.89,-6541 4397,-6541 4397,-6541 4397,-6541 4397,-6103.43 4397,-6103.43"/>
<polygon fill="black" stroke="black" points="4400.5,-6103.43 4397,-6093.43 4393.5,-6103.43 4400.5,-6103.43"/>
</g>
<!-- layer_4_expert_15 -->
<g id="node115" class="node">
<title>layer_4_expert_15</title>
<polygon fill="lightblue" stroke="black" points="3738,-6093.17 3376,-6093.17 3376,-6025.17 3738,-6025.17 3738,-6093.17"/>
<text text-anchor="middle" x="3557" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3557" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_expert_15 -->
<g id="edge282" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_expert_15</title>
<path fill="none" stroke="black" d="M3858.9,-6532.82C3858.9,-6434 3858.9,-6156 3858.9,-6156 3858.9,-6156 3617.33,-6156 3617.33,-6156 3617.33,-6156 3617.33,-6103.31 3617.33,-6103.31"/>
<polygon fill="black" stroke="black" points="3620.83,-6103.31 3617.33,-6093.31 3613.83,-6103.31 3620.83,-6103.31"/>
</g>
<!-- layer_4_add_norm2 -->
<g id="node116" class="node">
<title>layer_4_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4117,-5667.17 3755,-5667.17 3755,-5599.17 4117,-5599.17 4117,-5667.17"/>
<text text-anchor="middle" x="3936" y="-5651.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3936" y="-5636.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3936" y="-5621.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3936" y="-5606.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_4_add_norm1&#45;&gt;layer_4_add_norm2 -->
<g id="edge285" class="edge">
<title>layer_4_add_norm1&#45;&gt;layer_4_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4039.18,-6537C4104.94,-6537 4163.39,-6537 4163.39,-6537 4163.39,-6537 4163.39,-5633 4163.39,-5633 4163.39,-5633 4127.1,-5633 4127.1,-5633"/>
<polygon fill="black" stroke="black" points="4127.1,-5629.5 4117.1,-5633 4127.1,-5636.5 4127.1,-5629.5"/>
<text text-anchor="middle" x="6883" y="-6055.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_0 -->
<g id="edge236" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3128.6,-6303C2698.05,-6303 1967.5,-6303 1967.5,-6303 1967.5,-6303 1967.5,-6103.33 1967.5,-6103.33"/>
<polygon fill="black" stroke="black" points="1971,-6103.33 1967.5,-6093.33 1964,-6103.33 1971,-6103.33"/>
<text text-anchor="middle" x="2678.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_1 -->
<g id="edge239" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3110,-6286C2802.21,-6286 2387.5,-6286 2387.5,-6286 2387.5,-6286 2387.5,-6103.62 2387.5,-6103.62"/>
<polygon fill="black" stroke="black" points="2391,-6103.62 2387.5,-6093.62 2384,-6103.62 2391,-6103.62"/>
<text text-anchor="middle" x="2934.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_2 -->
<g id="edge242" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3713.67,-6310C4198.08,-6310 5146.5,-6310 5146.5,-6310 5146.5,-6310 5146.5,-6103.26 5146.5,-6103.26"/>
<polygon fill="black" stroke="black" points="5150,-6103.26 5146.5,-6093.26 5143,-6103.26 5150,-6103.26"/>
<text text-anchor="middle" x="4602.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_3 -->
<g id="edge245" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3165.82,-6337C2556.38,-6337 1127.5,-6337 1127.5,-6337 1127.5,-6337 1127.5,-6103.23 1127.5,-6103.23"/>
<polygon fill="black" stroke="black" points="1131,-6103.23 1127.5,-6093.23 1124,-6103.23 1131,-6103.23"/>
<text text-anchor="middle" x="1865.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_4 -->
<g id="edge248" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3147.12,-6320C2618.1,-6320 1547.5,-6320 1547.5,-6320 1547.5,-6320 1547.5,-6103.27 1547.5,-6103.27"/>
<polygon fill="black" stroke="black" points="1551,-6103.27 1547.5,-6093.27 1544,-6103.27 1551,-6103.27"/>
<text text-anchor="middle" x="2359.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_5 -->
<g id="edge251" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3776.67,-6320.12C3776.67,-6316.1 3776.67,-6059 3776.67,-6059 3776.67,-6059 3785.88,-6059 3785.88,-6059"/>
<polygon fill="black" stroke="black" points="3785.88,-6062.5 3795.88,-6059 3785.88,-6055.5 3785.88,-6062.5"/>
<text text-anchor="middle" x="3698.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_6 -->
<g id="edge254" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3091.41,-6269C2945.02,-6269 2807.5,-6269 2807.5,-6269 2807.5,-6269 2807.5,-6103.35 2807.5,-6103.35"/>
<polygon fill="black" stroke="black" points="2811,-6103.35 2807.5,-6093.35 2804,-6103.35 2811,-6103.35"/>
<text text-anchor="middle" x="3225.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_7 -->
<g id="edge257" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3734.2,-6329C4320.43,-6329 5566.5,-6329 5566.5,-6329 5566.5,-6329 5566.5,-6103.34 5566.5,-6103.34"/>
<polygon fill="black" stroke="black" points="5570,-6103.34 5566.5,-6093.34 5563,-6103.34 5570,-6103.34"/>
<text text-anchor="middle" x="5013.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_8 -->
<g id="edge260" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3202.88,-6371C2474.17,-6371 287.5,-6371 287.5,-6371 287.5,-6371 287.5,-6103.43 287.5,-6103.43"/>
<polygon fill="black" stroke="black" points="291,-6103.43 287.5,-6093.43 284,-6103.43 291,-6103.43"/>
<text text-anchor="middle" x="1240.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_9 -->
<g id="edge263" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3756.12,-6349C4440.97,-6349 5986.5,-6349 5986.5,-6349 5986.5,-6349 5986.5,-6103.27 5986.5,-6103.27"/>
<polygon fill="black" stroke="black" points="5990,-6103.27 5986.5,-6093.27 5983,-6103.27 5990,-6103.27"/>
<text text-anchor="middle" x="5298.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_10 -->
<g id="edge266" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3692.89,-6291C4069.3,-6291 4726.5,-6291 4726.5,-6291 4726.5,-6291 4726.5,-6103.37 4726.5,-6103.37"/>
<polygon fill="black" stroke="black" points="4730,-6103.37 4726.5,-6093.37 4723,-6103.37 4730,-6103.37"/>
<text text-anchor="middle" x="4219.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_11 -->
<g id="edge269" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3184.2,-6354C2508.74,-6354 707.5,-6354 707.5,-6354 707.5,-6354 707.5,-6103.28 707.5,-6103.28"/>
<polygon fill="black" stroke="black" points="711,-6103.28 707.5,-6093.28 704,-6103.28 711,-6103.28"/>
<text text-anchor="middle" x="1512.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_12 -->
<g id="edge272" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3195.57,-6251.93C3195.57,-6251.93 3195.57,-6103.49 3195.57,-6103.49"/>
<polygon fill="black" stroke="black" points="3199.07,-6103.49 3195.57,-6093.49 3192.07,-6103.49 3199.07,-6103.49"/>
<text text-anchor="middle" x="3373.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_13 -->
<g id="edge275" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3776.75,-6368C4557.01,-6368 6406.5,-6368 6406.5,-6368 6406.5,-6368 6406.5,-6103.4 6406.5,-6103.4"/>
<polygon fill="black" stroke="black" points="6410,-6103.4 6406.5,-6093.4 6403,-6103.4 6410,-6103.4"/>
<text text-anchor="middle" x="5469.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_14 -->
<g id="edge278" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3671,-6271C3928.81,-6271 4306.5,-6271 4306.5,-6271 4306.5,-6271 4306.5,-6103.2 4306.5,-6103.2"/>
<polygon fill="black" stroke="black" points="4310,-6103.2 4306.5,-6093.2 4303,-6103.2 4310,-6103.2"/>
<text text-anchor="middle" x="3948.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_15 -->
<g id="edge281" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3496.67,-6251.93C3496.67,-6251.93 3496.67,-6103.49 3496.67,-6103.49"/>
<polygon fill="black" stroke="black" points="3500.17,-6103.49 3496.67,-6093.49 3493.17,-6103.49 3500.17,-6103.49"/>
<text text-anchor="middle" x="3521.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_4_moe_agg&#45;&gt;layer_4_add_norm2 -->
<g id="edge284" class="edge">
<title>layer_4_moe_agg&#45;&gt;layer_4_add_norm2</title>
<path fill="none" stroke="black" d="M3807,-5811.94C3807,-5811.94 3807,-5677.3 3807,-5677.3"/>
<polygon fill="black" stroke="black" points="3810.5,-5677.3 3807,-5667.3 3803.5,-5677.3 3810.5,-5677.3"/>
</g>
<!-- layer_4_expert_0&#45;&gt;layer_4_moe_agg -->
<g id="edge238" class="edge">
<title>layer_4_expert_0&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M1877,-6024.93C1877,-5965.38 1877,-5849 1877,-5849 1877,-5849 3486.65,-5849 3486.65,-5849"/>
<polygon fill="black" stroke="black" points="3486.65,-5852.5 3496.65,-5849 3486.65,-5845.5 3486.65,-5852.5"/>
</g>
<!-- layer_4_expert_1&#45;&gt;layer_4_moe_agg -->
<g id="edge241" class="edge">
<title>layer_4_expert_1&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M2297,-6024.87C2297,-5967.19 2297,-5857 2297,-5857 2297,-5857 3486.75,-5857 3486.75,-5857"/>
<polygon fill="black" stroke="black" points="3486.75,-5860.5 3496.75,-5857 3486.75,-5853.5 3486.75,-5860.5"/>
</g>
<!-- layer_4_expert_2&#45;&gt;layer_4_moe_agg -->
<g id="edge244" class="edge">
<title>layer_4_expert_2&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M5237,-6024.86C5237,-5960.93 5237,-5830 5237,-5830 5237,-5830 3869.12,-5830 3869.12,-5830"/>
<polygon fill="black" stroke="black" points="3869.12,-5826.5 3859.12,-5830 3869.12,-5833.5 3869.12,-5826.5"/>
</g>
<!-- layer_4_expert_3&#45;&gt;layer_4_moe_agg -->
<g id="edge247" class="edge">
<title>layer_4_expert_3&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M1037,-6024.97C1037,-5961.98 1037,-5834 1037,-5834 1037,-5834 3486.99,-5834 3486.99,-5834"/>
<polygon fill="black" stroke="black" points="3486.99,-5837.5 3496.99,-5834 3486.99,-5830.5 3486.99,-5837.5"/>
</g>
<!-- layer_4_expert_4&#45;&gt;layer_4_moe_agg -->
<g id="edge250" class="edge">
<title>layer_4_expert_4&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M1457,-6024.76C1457,-5963.52 1457,-5842 1457,-5842 1457,-5842 3486.72,-5842 3486.72,-5842"/>
<polygon fill="black" stroke="black" points="3486.72,-5845.5 3496.72,-5842 3486.72,-5838.5 3486.72,-5845.5"/>
</g>
<!-- layer_4_expert_5&#45;&gt;layer_4_moe_agg -->
<g id="edge253" class="edge">
<title>layer_4_expert_5&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M3827.5,-6024.94C3827.5,-6024.94 3827.5,-5890.3 3827.5,-5890.3"/>
<polygon fill="black" stroke="black" points="3831,-5890.3 3827.5,-5880.3 3824,-5890.3 3831,-5890.3"/>
</g>
<!-- layer_4_expert_6&#45;&gt;layer_4_moe_agg -->
<g id="edge256" class="edge">
<title>layer_4_expert_6&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M2717,-6024.9C2717,-5969.16 2717,-5865 2717,-5865 2717,-5865 3486.96,-5865 3486.96,-5865"/>
<polygon fill="black" stroke="black" points="3486.96,-5868.5 3496.96,-5865 3486.96,-5861.5 3486.96,-5868.5"/>
</g>
<!-- layer_4_expert_7&#45;&gt;layer_4_moe_agg -->
<g id="edge259" class="edge">
<title>layer_4_expert_7&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M5657,-6025.12C5657,-5960.17 5657,-5825 5657,-5825 5657,-5825 3869.31,-5825 3869.31,-5825"/>
<polygon fill="black" stroke="black" points="3869.31,-5821.5 3859.31,-5825 3869.31,-5828.5 3869.31,-5821.5"/>
</g>
<!-- layer_4_expert_8&#45;&gt;layer_4_moe_agg -->
<g id="edge262" class="edge">
<title>layer_4_expert_8&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M197,-6025.01C197,-5958.71 197,-5819 197,-5819 197,-5819 3486.96,-5819 3486.96,-5819"/>
<polygon fill="black" stroke="black" points="3486.96,-5822.5 3496.96,-5819 3486.96,-5815.5 3486.96,-5822.5"/>
</g>
<!-- layer_4_expert_9&#45;&gt;layer_4_moe_agg -->
<g id="edge265" class="edge">
<title>layer_4_expert_9&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M6077,-6025.04C6077,-5959.19 6077,-5821 6077,-5821 6077,-5821 3869.3,-5821 3869.3,-5821"/>
<polygon fill="black" stroke="black" points="3869.3,-5817.5 3859.3,-5821 3869.3,-5824.5 3869.3,-5817.5"/>
</g>
<!-- layer_4_expert_10&#45;&gt;layer_4_moe_agg -->
<g id="edge268" class="edge">
<title>layer_4_expert_10&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M4817,-6024.97C4817,-5961.98 4817,-5834 4817,-5834 4817,-5834 3869.11,-5834 3869.11,-5834"/>
<polygon fill="black" stroke="black" points="3869.11,-5830.5 3859.11,-5834 3869.11,-5837.5 3869.11,-5830.5"/>
</g>
<!-- layer_4_expert_11&#45;&gt;layer_4_moe_agg -->
<g id="edge271" class="edge">
<title>layer_4_expert_11&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M617,-6024.91C617,-5960.33 617,-5827 617,-5827 617,-5827 3486.82,-5827 3486.82,-5827"/>
<polygon fill="black" stroke="black" points="3486.82,-5830.5 3496.82,-5827 3486.82,-5823.5 3486.82,-5830.5"/>
</g>
<!-- layer_4_expert_12&#45;&gt;layer_4_moe_agg -->
<g id="edge274" class="edge">
<title>layer_4_expert_12&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M3209.07,-6024.84C3209.07,-5970.8 3209.07,-5872 3209.07,-5872 3209.07,-5872 3486.7,-5872 3486.7,-5872"/>
<polygon fill="black" stroke="black" points="3486.7,-5875.5 3496.7,-5872 3486.7,-5868.5 3486.7,-5875.5"/>
</g>
<!-- layer_4_expert_13&#45;&gt;layer_4_moe_agg -->
<g id="edge277" class="edge">
<title>layer_4_expert_13&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M6497,-6025.1C6497,-5958.18 6497,-5816 6497,-5816 6497,-5816 3869.17,-5816 3869.17,-5816"/>
<polygon fill="black" stroke="black" points="3869.17,-5812.5 3859.17,-5816 3869.17,-5819.5 3869.17,-5812.5"/>
</g>
<!-- layer_4_expert_14&#45;&gt;layer_4_moe_agg -->
<g id="edge280" class="edge">
<title>layer_4_expert_14&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M4397,-6024.77C4397,-5962.84 4397,-5839 4397,-5839 4397,-5839 3869.43,-5839 3869.43,-5839"/>
<polygon fill="black" stroke="black" points="3869.43,-5835.5 3859.43,-5839 3869.43,-5842.5 3869.43,-5835.5"/>
</g>
<!-- layer_4_expert_15&#45;&gt;layer_4_moe_agg -->
<g id="edge283" class="edge">
<title>layer_4_expert_15&#45;&gt;layer_4_moe_agg</title>
<path fill="none" stroke="black" d="M3617.5,-6024.94C3617.5,-6024.94 3617.5,-5890.3 3617.5,-5890.3"/>
<polygon fill="black" stroke="black" points="3621,-5890.3 3617.5,-5880.3 3614,-5890.3 3621,-5890.3"/>
</g>
<!-- layer_5_qkv -->
<g id="node117" class="node">
<title>layer_5_qkv</title>
<polygon fill="lightblue" stroke="black" points="3915.5,-5454.17 3506.5,-5454.17 3506.5,-5386.17 3915.5,-5386.17 3915.5,-5454.17"/>
<text text-anchor="middle" x="3711" y="-5438.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3711" y="-5423.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3711" y="-5408.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3711" y="-5393.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_4_add_norm2&#45;&gt;layer_5_qkv -->
<g id="edge286" class="edge">
<title>layer_4_add_norm2&#45;&gt;layer_5_qkv</title>
<path fill="none" stroke="black" d="M3835.25,-5598.94C3835.25,-5598.94 3835.25,-5464.3 3835.25,-5464.3"/>
<polygon fill="black" stroke="black" points="3838.75,-5464.3 3835.25,-5454.3 3831.75,-5464.3 3838.75,-5464.3"/>
</g>
<!-- layer_5_add_norm1 -->
<g id="node120" class="node">
<title>layer_5_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4066,-4815.17 3704,-4815.17 3704,-4747.17 4066,-4747.17 4066,-4815.17"/>
<text text-anchor="middle" x="3885" y="-4799.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3885" y="-4784.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3885" y="-4769.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3885" y="-4754.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_4_add_norm2&#45;&gt;layer_5_add_norm1 -->
<g id="edge290" class="edge">
<title>layer_4_add_norm2&#45;&gt;layer_5_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3990.75,-5598.98C3990.75,-5598.98 3990.75,-4825.62 3990.75,-4825.62"/>
<polygon fill="black" stroke="black" points="3994.25,-4825.62 3990.75,-4815.62 3987.25,-4825.62 3994.25,-4825.62"/>
<text text-anchor="middle" x="4032" y="-5203.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_5_attn -->
<g id="node118" class="node">
<title>layer_5_attn</title>
<polygon fill="lightblue" stroke="black" points="3886.5,-5241.17 3477.5,-5241.17 3477.5,-5173.17 3886.5,-5173.17 3886.5,-5241.17"/>
<text text-anchor="middle" x="3682" y="-5225.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3682" y="-5210.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3682" y="-5195.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3682" y="-5180.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_5_qkv&#45;&gt;layer_5_attn -->
<g id="edge287" class="edge">
<title>layer_5_qkv&#45;&gt;layer_5_attn</title>
<path fill="none" stroke="black" d="M3696.5,-5385.94C3696.5,-5385.94 3696.5,-5251.3 3696.5,-5251.3"/>
<polygon fill="black" stroke="black" points="3700,-5251.3 3696.5,-5241.3 3693,-5251.3 3700,-5251.3"/>
</g>
<!-- layer_5_proj -->
<g id="node119" class="node">
<title>layer_5_proj</title>
<polygon fill="lightblue" stroke="black" points="3912.5,-5028.17 3515.5,-5028.17 3515.5,-4960.17 3912.5,-4960.17 3912.5,-5028.17"/>
<text text-anchor="middle" x="3714" y="-5012.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3714" y="-4997.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3714" y="-4982.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3714" y="-4967.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_5_attn&#45;&gt;layer_5_proj -->
<g id="edge288" class="edge">
<title>layer_5_attn&#45;&gt;layer_5_proj</title>
<path fill="none" stroke="black" d="M3701,-5172.94C3701,-5172.94 3701,-5038.3 3701,-5038.3"/>
<polygon fill="black" stroke="black" points="3704.5,-5038.3 3701,-5028.3 3697.5,-5038.3 3704.5,-5038.3"/>
</g>
<!-- layer_5_proj&#45;&gt;layer_5_add_norm1 -->
<g id="edge289" class="edge">
<title>layer_5_proj&#45;&gt;layer_5_add_norm1</title>
<path fill="none" stroke="black" d="M3808.25,-4959.94C3808.25,-4959.94 3808.25,-4825.3 3808.25,-4825.3"/>
<polygon fill="black" stroke="black" points="3811.75,-4825.3 3808.25,-4815.3 3804.75,-4825.3 3811.75,-4825.3"/>
</g>
<!-- layer_5_gate -->
<g id="node121" class="node">
<title>layer_5_gate</title>
<polygon fill="yellow" stroke="black" points="3825.73,-4602.17 3248.71,-4602.17 3100.27,-4466.17 3677.29,-4466.17 3825.73,-4602.17"/>
<text text-anchor="middle" x="3463" y="-4552.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3463" y="-4537.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3463" y="-4522.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3463" y="-4507.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_gate -->
<g id="edge291" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_gate</title>
<path fill="none" stroke="black" d="M3764.93,-4747.08C3764.93,-4747.08 3764.93,-4612.37 3764.93,-4612.37"/>
<polygon fill="black" stroke="black" points="3768.43,-4612.37 3764.93,-4602.37 3761.43,-4612.37 3768.43,-4612.37"/>
</g>
<!-- layer_5_moe_agg -->
<g id="node122" class="node">
<title>layer_5_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="3998,-4094.17 3636,-4094.17 3636,-4026.17 3998,-4026.17 3998,-4094.17"/>
<text text-anchor="middle" x="3817" y="-4078.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="3817" y="-4063.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3817" y="-4048.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3817" y="-4033.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_moe_agg -->
<g id="edge292" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M3945.93,-4747.13C3945.93,-4643.35 3945.93,-4338 3945.93,-4338 3945.93,-4338 3767,-4338 3767,-4338 3767,-4338 3767,-4104.23 3767,-4104.23"/>
<polygon fill="black" stroke="black" points="3770.5,-4104.23 3767,-4094.23 3763.5,-4104.23 3770.5,-4104.23"/>
</g>
<!-- layer_5_expert_0 -->
<g id="node123" class="node">
<title>layer_5_expert_0</title>
<polygon fill="lightblue" stroke="black" points="2058,-4307.17 1696,-4307.17 1696,-4239.17 2058,-4239.17 2058,-4307.17"/>
<text text-anchor="middle" x="1877" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1877" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_0 -->
<g id="edge294" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_0</title>
<path fill="none" stroke="black" d="M3703.81,-4777C3194.41,-4777 1786.5,-4777 1786.5,-4777 1786.5,-4777 1786.5,-4317.4 1786.5,-4317.4"/>
<polygon fill="black" stroke="black" points="1790,-4317.4 1786.5,-4307.4 1783,-4317.4 1790,-4317.4"/>
</g>
<!-- layer_5_expert_1 -->
<g id="node124" class="node">
<title>layer_5_expert_1</title>
<polygon fill="lightblue" stroke="black" points="2478,-4307.17 2116,-4307.17 2116,-4239.17 2478,-4239.17 2478,-4307.17"/>
<text text-anchor="middle" x="2297" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2297" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_1 -->
<g id="edge297" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_1</title>
<path fill="none" stroke="black" d="M3703.78,-4769C3269.75,-4769 2206.5,-4769 2206.5,-4769 2206.5,-4769 2206.5,-4317.25 2206.5,-4317.25"/>
<polygon fill="black" stroke="black" points="2210,-4317.25 2206.5,-4307.25 2203,-4317.25 2210,-4317.25"/>
</g>
<!-- layer_5_expert_2 -->
<g id="node125" class="node">
<title>layer_5_expert_2</title>
<polygon fill="lightblue" stroke="black" points="5418,-4307.17 5056,-4307.17 5056,-4239.17 5418,-4239.17 5418,-4307.17"/>
<text text-anchor="middle" x="5237" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5237" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_2 -->
<g id="edge300" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_2</title>
<path fill="none" stroke="black" d="M4066.23,-4772C4453.66,-4772 5327.5,-4772 5327.5,-4772 5327.5,-4772 5327.5,-4317.45 5327.5,-4317.45"/>
<polygon fill="black" stroke="black" points="5331,-4317.45 5327.5,-4307.45 5324,-4317.45 5331,-4317.45"/>
</g>
<!-- layer_5_expert_3 -->
<g id="node126" class="node">
<title>layer_5_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1218,-4307.17 856,-4307.17 856,-4239.17 1218,-4239.17 1218,-4307.17"/>
<text text-anchor="middle" x="1037" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1037" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_3 -->
<g id="edge303" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_3</title>
<path fill="none" stroke="black" d="M3703.95,-4792C3063.96,-4792 946.5,-4792 946.5,-4792 946.5,-4792 946.5,-4317.21 946.5,-4317.21"/>
<polygon fill="black" stroke="black" points="950,-4317.21 946.5,-4307.21 943,-4317.21 950,-4317.21"/>
</g>
<!-- layer_5_expert_4 -->
<g id="node127" class="node">
<title>layer_5_expert_4</title>
<polygon fill="lightblue" stroke="black" points="1638,-4307.17 1276,-4307.17 1276,-4239.17 1638,-4239.17 1638,-4307.17"/>
<text text-anchor="middle" x="1457" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1457" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_4 -->
<g id="edge306" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_4</title>
<path fill="none" stroke="black" d="M3703.88,-4784C3126.41,-4784 1366.5,-4784 1366.5,-4784 1366.5,-4784 1366.5,-4317.48 1366.5,-4317.48"/>
<polygon fill="black" stroke="black" points="1370,-4317.48 1366.5,-4307.48 1363,-4317.48 1370,-4317.48"/>
</g>
<!-- layer_5_expert_5 -->
<g id="node128" class="node">
<title>layer_5_expert_5</title>
<polygon fill="lightblue" stroke="black" points="4158,-4307.17 3796,-4307.17 3796,-4239.17 4158,-4239.17 4158,-4307.17"/>
<text text-anchor="middle" x="3977" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3977" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_5 -->
<g id="edge309" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_5</title>
<path fill="none" stroke="black" d="M4005.97,-4747.05C4005.97,-4747.05 4005.97,-4317.47 4005.97,-4317.47"/>
<polygon fill="black" stroke="black" points="4009.47,-4317.47 4005.97,-4307.47 4002.47,-4317.47 4009.47,-4317.47"/>
</g>
<!-- layer_5_expert_6 -->
<g id="node129" class="node">
<title>layer_5_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2898,-4307.17 2536,-4307.17 2536,-4239.17 2898,-4239.17 2898,-4307.17"/>
<text text-anchor="middle" x="2717" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2717" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_6 -->
<g id="edge312" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_6</title>
<path fill="none" stroke="black" d="M3703.68,-4762C3355.3,-4762 2626.5,-4762 2626.5,-4762 2626.5,-4762 2626.5,-4317.54 2626.5,-4317.54"/>
<polygon fill="black" stroke="black" points="2630,-4317.54 2626.5,-4307.54 2623,-4317.54 2630,-4317.54"/>
</g>
<!-- layer_5_expert_7 -->
<g id="node130" class="node">
<title>layer_5_expert_7</title>
<polygon fill="lightblue" stroke="black" points="5838,-4307.17 5476,-4307.17 5476,-4239.17 5838,-4239.17 5838,-4307.17"/>
<text text-anchor="middle" x="5657" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5657" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_7 -->
<g id="edge315" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_7</title>
<path fill="none" stroke="black" d="M4066.13,-4781C4534.16,-4781 5747.5,-4781 5747.5,-4781 5747.5,-4781 5747.5,-4317.28 5747.5,-4317.28"/>
<polygon fill="black" stroke="black" points="5751,-4317.28 5747.5,-4307.28 5744,-4317.28 5751,-4317.28"/>
</g>
<!-- layer_5_expert_8 -->
<g id="node131" class="node">
<title>layer_5_expert_8</title>
<polygon fill="lightblue" stroke="black" points="378,-4307.17 16,-4307.17 16,-4239.17 378,-4239.17 378,-4307.17"/>
<text text-anchor="middle" x="197" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="197" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_8 -->
<g id="edge318" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_8</title>
<path fill="none" stroke="black" d="M3703.71,-4807C2950.39,-4807 106.5,-4807 106.5,-4807 106.5,-4807 106.5,-4317.37 106.5,-4317.37"/>
<polygon fill="black" stroke="black" points="110,-4317.37 106.5,-4307.37 103,-4317.37 110,-4317.37"/>
</g>
<!-- layer_5_expert_9 -->
<g id="node132" class="node">
<title>layer_5_expert_9</title>
<polygon fill="lightblue" stroke="black" points="6258,-4307.17 5896,-4307.17 5896,-4239.17 6258,-4239.17 6258,-4307.17"/>
<text text-anchor="middle" x="6077" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="6077" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_9 -->
<g id="edge321" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_9</title>
<path fill="none" stroke="black" d="M4066.01,-4789C4605.87,-4789 6167.5,-4789 6167.5,-4789 6167.5,-4789 6167.5,-4317.41 6167.5,-4317.41"/>
<polygon fill="black" stroke="black" points="6171,-4317.41 6167.5,-4307.41 6164,-4317.41 6171,-4317.41"/>
</g>
<!-- layer_5_expert_10 -->
<g id="node133" class="node">
<title>layer_5_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4998,-4307.17 4636,-4307.17 4636,-4239.17 4998,-4239.17 4998,-4307.17"/>
<text text-anchor="middle" x="4817" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4817" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_10 -->
<g id="edge324" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_10</title>
<path fill="none" stroke="black" d="M4066.04,-4764C4359.72,-4764 4907.5,-4764 4907.5,-4764 4907.5,-4764 4907.5,-4317.29 4907.5,-4317.29"/>
<polygon fill="black" stroke="black" points="4911,-4317.29 4907.5,-4307.29 4904,-4317.29 4911,-4317.29"/>
</g>
<!-- layer_5_expert_11 -->
<g id="node134" class="node">
<title>layer_5_expert_11</title>
<polygon fill="lightblue" stroke="black" points="798,-4307.17 436,-4307.17 436,-4239.17 798,-4239.17 798,-4307.17"/>
<text text-anchor="middle" x="617" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="617" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_11 -->
<g id="edge327" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_11</title>
<path fill="none" stroke="black" d="M3703.84,-4800C3005.43,-4800 526.5,-4800 526.5,-4800 526.5,-4800 526.5,-4317.33 526.5,-4317.33"/>
<polygon fill="black" stroke="black" points="530,-4317.33 526.5,-4307.33 523,-4317.33 530,-4317.33"/>
</g>
<!-- layer_5_expert_12 -->
<g id="node135" class="node">
<title>layer_5_expert_12</title>
<polygon fill="lightblue" stroke="black" points="3318,-4307.17 2956,-4307.17 2956,-4239.17 3318,-4239.17 3318,-4307.17"/>
<text text-anchor="middle" x="3137" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3137" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_12 -->
<g id="edge330" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_12</title>
<path fill="none" stroke="black" d="M3703.79,-4754C3452.31,-4754 3028.07,-4754 3028.07,-4754 3028.07,-4754 3028.07,-4317.36 3028.07,-4317.36"/>
<polygon fill="black" stroke="black" points="3031.57,-4317.36 3028.07,-4307.36 3024.57,-4317.36 3031.57,-4317.36"/>
</g>
<!-- layer_5_expert_13 -->
<g id="node136" class="node">
<title>layer_5_expert_13</title>
<polygon fill="lightblue" stroke="black" points="6678,-4307.17 6316,-4307.17 6316,-4239.17 6678,-4239.17 6678,-4307.17"/>
<text text-anchor="middle" x="6497" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6497" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_13 -->
<g id="edge333" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_13</title>
<path fill="none" stroke="black" d="M4066.25,-4798C4671.89,-4798 6587.5,-4798 6587.5,-4798 6587.5,-4798 6587.5,-4317.2 6587.5,-4317.2"/>
<polygon fill="black" stroke="black" points="6591,-4317.2 6587.5,-4307.2 6584,-4317.2 6591,-4317.2"/>
</g>
<!-- layer_5_expert_14 -->
<g id="node137" class="node">
<title>layer_5_expert_14</title>
<polygon fill="lightblue" stroke="black" points="4578,-4307.17 4216,-4307.17 4216,-4239.17 4578,-4239.17 4578,-4307.17"/>
<text text-anchor="middle" x="4397" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4397" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_14 -->
<g id="edge336" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_14</title>
<path fill="none" stroke="black" d="M4066.18,-4755C4243.61,-4755 4487.5,-4755 4487.5,-4755 4487.5,-4755 4487.5,-4317.43 4487.5,-4317.43"/>
<polygon fill="black" stroke="black" points="4491,-4317.43 4487.5,-4307.43 4484,-4317.43 4491,-4317.43"/>
</g>
<!-- layer_5_expert_15 -->
<g id="node138" class="node">
<title>layer_5_expert_15</title>
<polygon fill="lightblue" stroke="black" points="3738,-4307.17 3376,-4307.17 3376,-4239.17 3738,-4239.17 3738,-4307.17"/>
<text text-anchor="middle" x="3557" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3557" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_expert_15 -->
<g id="edge339" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_expert_15</title>
<path fill="none" stroke="black" d="M3885.9,-4746.82C3885.9,-4648 3885.9,-4370 3885.9,-4370 3885.9,-4370 3617.33,-4370 3617.33,-4370 3617.33,-4370 3617.33,-4317.31 3617.33,-4317.31"/>
<polygon fill="black" stroke="black" points="3620.83,-4317.31 3617.33,-4307.31 3613.83,-4317.31 3620.83,-4317.31"/>
</g>
<!-- layer_5_add_norm2 -->
<g id="node139" class="node">
<title>layer_5_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4109,-3881.17 3747,-3881.17 3747,-3813.17 4109,-3813.17 4109,-3881.17"/>
<text text-anchor="middle" x="3928" y="-3865.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3928" y="-3850.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3928" y="-3835.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3928" y="-3820.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_5_add_norm1&#45;&gt;layer_5_add_norm2 -->
<g id="edge342" class="edge">
<title>layer_5_add_norm1&#45;&gt;layer_5_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4066.1,-4751C4121.04,-4751 4167.17,-4751 4167.17,-4751 4167.17,-4751 4167.17,-3847 4167.17,-3847 4167.17,-3847 4119.27,-3847 4119.27,-3847"/>
<polygon fill="black" stroke="black" points="4119.27,-3843.5 4109.27,-3847 4119.27,-3850.5 4119.27,-3843.5"/>
<text text-anchor="middle" x="6883" y="-4269.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_0 -->
<g id="edge293" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3155.4,-4517C2717.67,-4517 1967.5,-4517 1967.5,-4517 1967.5,-4517 1967.5,-4317.33 1967.5,-4317.33"/>
<polygon fill="black" stroke="black" points="1971,-4317.33 1967.5,-4307.33 1964,-4317.33 1971,-4317.33"/>
<text text-anchor="middle" x="2689.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_1 -->
<g id="edge296" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3137.03,-4500C2820.52,-4500 2387.5,-4500 2387.5,-4500 2387.5,-4500 2387.5,-4317.62 2387.5,-4317.62"/>
<polygon fill="black" stroke="black" points="2391,-4317.62 2387.5,-4307.62 2384,-4317.62 2391,-4317.62"/>
<text text-anchor="middle" x="2966.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_2 -->
<g id="edge299" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3740.52,-4524C4218.55,-4524 5146.5,-4524 5146.5,-4524 5146.5,-4524 5146.5,-4317.26 5146.5,-4317.26"/>
<polygon fill="black" stroke="black" points="5150,-4317.26 5146.5,-4307.26 5143,-4317.26 5150,-4317.26"/>
<text text-anchor="middle" x="4626.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_3 -->
<g id="edge302" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3192.81,-4551C2578.03,-4551 1127.5,-4551 1127.5,-4551 1127.5,-4551 1127.5,-4317.23 1127.5,-4317.23"/>
<polygon fill="black" stroke="black" points="1131,-4317.23 1127.5,-4307.23 1124,-4317.23 1131,-4317.23"/>
<text text-anchor="middle" x="1918.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_4 -->
<g id="edge305" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3174.16,-4534C2639.04,-4534 1547.5,-4534 1547.5,-4534 1547.5,-4534 1547.5,-4317.27 1547.5,-4317.27"/>
<polygon fill="black" stroke="black" points="1551,-4317.27 1547.5,-4307.27 1544,-4317.27 1551,-4317.27"/>
<text text-anchor="middle" x="2261.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_5 -->
<g id="edge308" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3810.93,-4534.12C3810.93,-4534.12 3810.93,-4317.33 3810.93,-4317.33"/>
<polygon fill="black" stroke="black" points="3814.43,-4317.33 3810.93,-4307.33 3807.43,-4317.33 3814.43,-4317.33"/>
<text text-anchor="middle" x="3791.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_6 -->
<g id="edge311" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3118.45,-4483C2960.36,-4483 2807.5,-4483 2807.5,-4483 2807.5,-4483 2807.5,-4317.35 2807.5,-4317.35"/>
<polygon fill="black" stroke="black" points="2811,-4317.35 2807.5,-4307.35 2804,-4317.35 2811,-4317.35"/>
<text text-anchor="middle" x="3191.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_7 -->
<g id="edge314" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3761.31,-4543C4341.71,-4543 5566.5,-4543 5566.5,-4543 5566.5,-4543 5566.5,-4317.34 5566.5,-4317.34"/>
<polygon fill="black" stroke="black" points="5570,-4317.34 5566.5,-4307.34 5563,-4317.34 5570,-4317.34"/>
<text text-anchor="middle" x="5064.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_8 -->
<g id="edge317" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3229.82,-4585C2496.8,-4585 287.5,-4585 287.5,-4585 287.5,-4585 287.5,-4317.43 287.5,-4317.43"/>
<polygon fill="black" stroke="black" points="291,-4317.43 287.5,-4307.43 284,-4317.43 291,-4317.43"/>
<text text-anchor="middle" x="1041.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_9 -->
<g id="edge320" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3783.24,-4563C4462.6,-4563 5986.5,-4563 5986.5,-4563 5986.5,-4563 5986.5,-4317.27 5986.5,-4317.27"/>
<polygon fill="black" stroke="black" points="5990,-4317.27 5986.5,-4307.27 5983,-4317.27 5990,-4317.27"/>
<text text-anchor="middle" x="5489.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_10 -->
<g id="edge323" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3719.83,-4505C4089.2,-4505 4726.5,-4505 4726.5,-4505 4726.5,-4505 4726.5,-4317.37 4726.5,-4317.37"/>
<polygon fill="black" stroke="black" points="4730,-4317.37 4726.5,-4307.37 4723,-4317.37 4730,-4317.37"/>
<text text-anchor="middle" x="4132.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_11 -->
<g id="edge326" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3211.16,-4568C2530.94,-4568 707.5,-4568 707.5,-4568 707.5,-4568 707.5,-4317.28 707.5,-4317.28"/>
<polygon fill="black" stroke="black" points="711,-4317.28 707.5,-4307.28 704,-4317.28 711,-4317.28"/>
<text text-anchor="middle" x="1350.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_12 -->
<g id="edge329" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3209.07,-4465.93C3209.07,-4465.93 3209.07,-4317.49 3209.07,-4317.49"/>
<polygon fill="black" stroke="black" points="3212.57,-4317.49 3209.07,-4307.49 3205.57,-4317.49 3212.57,-4317.49"/>
<text text-anchor="middle" x="3368.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_13 -->
<g id="edge332" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.89,-4582C4578.92,-4582 6406.5,-4582 6406.5,-4582 6406.5,-4582 6406.5,-4317.4 6406.5,-4317.4"/>
<polygon fill="black" stroke="black" points="6410,-4317.4 6406.5,-4307.4 6403,-4317.4 6410,-4317.4"/>
<text text-anchor="middle" x="5910.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_14 -->
<g id="edge335" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3697.96,-4485C3947.55,-4485 4306.5,-4485 4306.5,-4485 4306.5,-4485 4306.5,-4317.2 4306.5,-4317.2"/>
<polygon fill="black" stroke="black" points="4310,-4317.2 4306.5,-4307.2 4303,-4317.2 4310,-4317.2"/>
<text text-anchor="middle" x="3975.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_15 -->
<g id="edge338" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3496.67,-4465.93C3496.67,-4465.93 3496.67,-4317.49 3496.67,-4317.49"/>
<polygon fill="black" stroke="black" points="3500.17,-4317.49 3496.67,-4307.49 3493.17,-4317.49 3500.17,-4317.49"/>
<text text-anchor="middle" x="3521.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_5_moe_agg&#45;&gt;layer_5_add_norm2 -->
<g id="edge341" class="edge">
<title>layer_5_moe_agg&#45;&gt;layer_5_add_norm2</title>
<path fill="none" stroke="black" d="M3872.5,-4025.94C3872.5,-4025.94 3872.5,-3891.3 3872.5,-3891.3"/>
<polygon fill="black" stroke="black" points="3876,-3891.3 3872.5,-3881.3 3869,-3891.3 3876,-3891.3"/>
</g>
<!-- layer_5_expert_0&#45;&gt;layer_5_moe_agg -->
<g id="edge295" class="edge">
<title>layer_5_expert_0&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M1877,-4238.93C1877,-4179.38 1877,-4063 1877,-4063 1877,-4063 3625.8,-4063 3625.8,-4063"/>
<polygon fill="black" stroke="black" points="3625.8,-4066.5 3635.8,-4063 3625.8,-4059.5 3625.8,-4066.5"/>
</g>
<!-- layer_5_expert_1&#45;&gt;layer_5_moe_agg -->
<g id="edge298" class="edge">
<title>layer_5_expert_1&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M2297,-4238.87C2297,-4181.19 2297,-4071 2297,-4071 2297,-4071 3625.92,-4071 3625.92,-4071"/>
<polygon fill="black" stroke="black" points="3625.92,-4074.5 3635.92,-4071 3625.92,-4067.5 3625.92,-4074.5"/>
</g>
<!-- layer_5_expert_2&#45;&gt;layer_5_moe_agg -->
<g id="edge301" class="edge">
<title>layer_5_expert_2&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M5327.5,-4238.86C5327.5,-4174.93 5327.5,-4044 5327.5,-4044 5327.5,-4044 4008.08,-4044 4008.08,-4044"/>
<polygon fill="black" stroke="black" points="4008.08,-4040.5 3998.08,-4044 4008.08,-4047.5 4008.08,-4040.5"/>
</g>
<!-- layer_5_expert_3&#45;&gt;layer_5_moe_agg -->
<g id="edge304" class="edge">
<title>layer_5_expert_3&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M1037,-4238.97C1037,-4175.98 1037,-4048 1037,-4048 1037,-4048 3625.94,-4048 3625.94,-4048"/>
<polygon fill="black" stroke="black" points="3625.94,-4051.5 3635.94,-4048 3625.94,-4044.5 3625.94,-4051.5"/>
</g>
<!-- layer_5_expert_4&#45;&gt;layer_5_moe_agg -->
<g id="edge307" class="edge">
<title>layer_5_expert_4&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M1457,-4238.76C1457,-4177.52 1457,-4056 1457,-4056 1457,-4056 3625.73,-4056 3625.73,-4056"/>
<polygon fill="black" stroke="black" points="3625.73,-4059.5 3635.73,-4056 3625.73,-4052.5 3625.73,-4059.5"/>
</g>
<!-- layer_5_expert_5&#45;&gt;layer_5_moe_agg -->
<g id="edge310" class="edge">
<title>layer_5_expert_5&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M3897,-4238.94C3897,-4238.94 3897,-4104.3 3897,-4104.3"/>
<polygon fill="black" stroke="black" points="3900.5,-4104.3 3897,-4094.3 3893.5,-4104.3 3900.5,-4104.3"/>
</g>
<!-- layer_5_expert_6&#45;&gt;layer_5_moe_agg -->
<g id="edge313" class="edge">
<title>layer_5_expert_6&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M2717,-4238.9C2717,-4183.16 2717,-4079 2717,-4079 2717,-4079 3625.97,-4079 3625.97,-4079"/>
<polygon fill="black" stroke="black" points="3625.97,-4082.5 3635.97,-4079 3625.97,-4075.5 3625.97,-4082.5"/>
</g>
<!-- layer_5_expert_7&#45;&gt;layer_5_moe_agg -->
<g id="edge316" class="edge">
<title>layer_5_expert_7&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M5657,-4239.12C5657,-4174.17 5657,-4039 5657,-4039 5657,-4039 4008.04,-4039 4008.04,-4039"/>
<polygon fill="black" stroke="black" points="4008.04,-4035.5 3998.04,-4039 4008.04,-4042.5 4008.04,-4035.5"/>
</g>
<!-- layer_5_expert_8&#45;&gt;layer_5_moe_agg -->
<g id="edge319" class="edge">
<title>layer_5_expert_8&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M197,-4239.01C197,-4172.71 197,-4033 197,-4033 197,-4033 3625.93,-4033 3625.93,-4033"/>
<polygon fill="black" stroke="black" points="3625.93,-4036.5 3635.93,-4033 3625.93,-4029.5 3625.93,-4036.5"/>
</g>
<!-- layer_5_expert_9&#45;&gt;layer_5_moe_agg -->
<g id="edge322" class="edge">
<title>layer_5_expert_9&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M6077,-4239.04C6077,-4173.19 6077,-4035 6077,-4035 6077,-4035 4008.12,-4035 4008.12,-4035"/>
<polygon fill="black" stroke="black" points="4008.13,-4031.5 3998.12,-4035 4008.12,-4038.5 4008.13,-4031.5"/>
</g>
<!-- layer_5_expert_10&#45;&gt;layer_5_moe_agg -->
<g id="edge325" class="edge">
<title>layer_5_expert_10&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M4907.5,-4238.97C4907.5,-4175.98 4907.5,-4048 4907.5,-4048 4907.5,-4048 4008.3,-4048 4008.3,-4048"/>
<polygon fill="black" stroke="black" points="4008.3,-4044.5 3998.3,-4048 4008.3,-4051.5 4008.3,-4044.5"/>
</g>
<!-- layer_5_expert_11&#45;&gt;layer_5_moe_agg -->
<g id="edge328" class="edge">
<title>layer_5_expert_11&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M617,-4238.91C617,-4174.33 617,-4041 617,-4041 617,-4041 3625.79,-4041 3625.79,-4041"/>
<polygon fill="black" stroke="black" points="3625.79,-4044.5 3635.79,-4041 3625.79,-4037.5 3625.79,-4044.5"/>
</g>
<!-- layer_5_expert_12&#45;&gt;layer_5_moe_agg -->
<g id="edge331" class="edge">
<title>layer_5_expert_12&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M3212.07,-4238.84C3212.07,-4184.8 3212.07,-4086 3212.07,-4086 3212.07,-4086 3625.91,-4086 3625.91,-4086"/>
<polygon fill="black" stroke="black" points="3625.91,-4089.5 3635.91,-4086 3625.91,-4082.5 3625.91,-4089.5"/>
</g>
<!-- layer_5_expert_13&#45;&gt;layer_5_moe_agg -->
<g id="edge334" class="edge">
<title>layer_5_expert_13&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M6497,-4239.1C6497,-4172.18 6497,-4030 6497,-4030 6497,-4030 4008.05,-4030 4008.05,-4030"/>
<polygon fill="black" stroke="black" points="4008.05,-4026.5 3998.05,-4030 4008.05,-4033.5 4008.05,-4026.5"/>
</g>
<!-- layer_5_expert_14&#45;&gt;layer_5_moe_agg -->
<g id="edge337" class="edge">
<title>layer_5_expert_14&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M4487.5,-4238.77C4487.5,-4176.84 4487.5,-4053 4487.5,-4053 4487.5,-4053 4008.01,-4053 4008.01,-4053"/>
<polygon fill="black" stroke="black" points="4008.01,-4049.5 3998.01,-4053 4008.01,-4056.5 4008.01,-4049.5"/>
</g>
<!-- layer_5_expert_15&#45;&gt;layer_5_moe_agg -->
<g id="edge340" class="edge">
<title>layer_5_expert_15&#45;&gt;layer_5_moe_agg</title>
<path fill="none" stroke="black" d="M3687,-4238.94C3687,-4238.94 3687,-4104.3 3687,-4104.3"/>
<polygon fill="black" stroke="black" points="3690.5,-4104.3 3687,-4094.3 3683.5,-4104.3 3690.5,-4104.3"/>
</g>
<!-- layer_6_qkv -->
<g id="node140" class="node">
<title>layer_6_qkv</title>
<polygon fill="lightblue" stroke="black" points="3857.5,-3668.17 3448.5,-3668.17 3448.5,-3600.17 3857.5,-3600.17 3857.5,-3668.17"/>
<text text-anchor="middle" x="3653" y="-3652.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3653" y="-3637.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3653" y="-3622.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3653" y="-3607.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_5_add_norm2&#45;&gt;layer_6_qkv -->
<g id="edge343" class="edge">
<title>layer_5_add_norm2&#45;&gt;layer_6_qkv</title>
<path fill="none" stroke="black" d="M3802.25,-3812.94C3802.25,-3812.94 3802.25,-3678.3 3802.25,-3678.3"/>
<polygon fill="black" stroke="black" points="3805.75,-3678.3 3802.25,-3668.3 3798.75,-3678.3 3805.75,-3678.3"/>
</g>
<!-- layer_6_add_norm1 -->
<g id="node143" class="node">
<title>layer_6_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4072,-3029.17 3710,-3029.17 3710,-2961.17 4072,-2961.17 4072,-3029.17"/>
<text text-anchor="middle" x="3891" y="-3013.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3891" y="-2998.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3891" y="-2983.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3891" y="-2968.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_5_add_norm2&#45;&gt;layer_6_add_norm1 -->
<g id="edge347" class="edge">
<title>layer_5_add_norm2&#45;&gt;layer_6_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3970.75,-3812.98C3970.75,-3812.98 3970.75,-3039.62 3970.75,-3039.62"/>
<polygon fill="black" stroke="black" points="3974.25,-3039.62 3970.75,-3029.62 3967.25,-3039.62 3974.25,-3039.62"/>
<text text-anchor="middle" x="3974" y="-3417.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_6_attn -->
<g id="node141" class="node">
<title>layer_6_attn</title>
<polygon fill="lightblue" stroke="black" points="3828.5,-3455.17 3419.5,-3455.17 3419.5,-3387.17 3828.5,-3387.17 3828.5,-3455.17"/>
<text text-anchor="middle" x="3624" y="-3439.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3624" y="-3424.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3624" y="-3409.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3624" y="-3394.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_6_qkv&#45;&gt;layer_6_attn -->
<g id="edge344" class="edge">
<title>layer_6_qkv&#45;&gt;layer_6_attn</title>
<path fill="none" stroke="black" d="M3638.5,-3599.94C3638.5,-3599.94 3638.5,-3465.3 3638.5,-3465.3"/>
<polygon fill="black" stroke="black" points="3642,-3465.3 3638.5,-3455.3 3635,-3465.3 3642,-3465.3"/>
</g>
<!-- layer_6_proj -->
<g id="node142" class="node">
<title>layer_6_proj</title>
<polygon fill="lightblue" stroke="black" points="3869.5,-3242.17 3472.5,-3242.17 3472.5,-3174.17 3869.5,-3174.17 3869.5,-3242.17"/>
<text text-anchor="middle" x="3671" y="-3226.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3671" y="-3211.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3671" y="-3196.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3671" y="-3181.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_6_attn&#45;&gt;layer_6_proj -->
<g id="edge345" class="edge">
<title>layer_6_attn&#45;&gt;layer_6_proj</title>
<path fill="none" stroke="black" d="M3650.5,-3386.94C3650.5,-3386.94 3650.5,-3252.3 3650.5,-3252.3"/>
<polygon fill="black" stroke="black" points="3654,-3252.3 3650.5,-3242.3 3647,-3252.3 3654,-3252.3"/>
</g>
<!-- layer_6_proj&#45;&gt;layer_6_add_norm1 -->
<g id="edge346" class="edge">
<title>layer_6_proj&#45;&gt;layer_6_add_norm1</title>
<path fill="none" stroke="black" d="M3789.75,-3173.94C3789.75,-3173.94 3789.75,-3039.3 3789.75,-3039.3"/>
<polygon fill="black" stroke="black" points="3793.25,-3039.3 3789.75,-3029.3 3786.25,-3039.3 3793.25,-3039.3"/>
</g>
<!-- layer_6_gate -->
<g id="node144" class="node">
<title>layer_6_gate</title>
<polygon fill="yellow" stroke="black" points="3831.73,-2816.17 3254.71,-2816.17 3106.27,-2680.17 3683.29,-2680.17 3831.73,-2816.17"/>
<text text-anchor="middle" x="3469" y="-2766.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3469" y="-2751.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3469" y="-2736.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3469" y="-2721.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_gate -->
<g id="edge348" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_gate</title>
<path fill="none" stroke="black" d="M3770.93,-2961.08C3770.93,-2961.08 3770.93,-2826.37 3770.93,-2826.37"/>
<polygon fill="black" stroke="black" points="3774.43,-2826.37 3770.93,-2816.37 3767.43,-2826.37 3774.43,-2826.37"/>
</g>
<!-- layer_6_moe_agg -->
<g id="node145" class="node">
<title>layer_6_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="3845,-2308.17 3483,-2308.17 3483,-2240.17 3845,-2240.17 3845,-2308.17"/>
<text text-anchor="middle" x="3664" y="-2292.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="3664" y="-2277.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3664" y="-2262.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3664" y="-2247.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_moe_agg -->
<g id="edge349" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M3951.93,-2960.85C3951.93,-2867.51 3951.93,-2616 3951.93,-2616 3951.93,-2616 3767,-2616 3767,-2616 3767,-2616 3767,-2318.19 3767,-2318.19"/>
<polygon fill="black" stroke="black" points="3770.5,-2318.19 3767,-2308.19 3763.5,-2318.19 3770.5,-2318.19"/>
</g>
<!-- layer_6_expert_0 -->
<g id="node146" class="node">
<title>layer_6_expert_0</title>
<polygon fill="lightblue" stroke="black" points="2058,-2521.17 1696,-2521.17 1696,-2453.17 2058,-2453.17 2058,-2521.17"/>
<text text-anchor="middle" x="1877" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1877" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_0 -->
<g id="edge351" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_0</title>
<path fill="none" stroke="black" d="M3709.75,-2991C3199.27,-2991 1786.5,-2991 1786.5,-2991 1786.5,-2991 1786.5,-2531.4 1786.5,-2531.4"/>
<polygon fill="black" stroke="black" points="1790,-2531.4 1786.5,-2521.4 1783,-2531.4 1790,-2531.4"/>
</g>
<!-- layer_6_expert_1 -->
<g id="node147" class="node">
<title>layer_6_expert_1</title>
<polygon fill="lightblue" stroke="black" points="2478,-2521.17 2116,-2521.17 2116,-2453.17 2478,-2453.17 2478,-2521.17"/>
<text text-anchor="middle" x="2297" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2297" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_1 -->
<g id="edge354" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_1</title>
<path fill="none" stroke="black" d="M3709.93,-2983C3274.86,-2983 2206.5,-2983 2206.5,-2983 2206.5,-2983 2206.5,-2531.25 2206.5,-2531.25"/>
<polygon fill="black" stroke="black" points="2210,-2531.25 2206.5,-2521.25 2203,-2531.25 2210,-2531.25"/>
</g>
<!-- layer_6_expert_2 -->
<g id="node148" class="node">
<title>layer_6_expert_2</title>
<polygon fill="lightblue" stroke="black" points="5418,-2521.17 5056,-2521.17 5056,-2453.17 5418,-2453.17 5418,-2521.17"/>
<text text-anchor="middle" x="5237" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5237" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_2 -->
<g id="edge357" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_2</title>
<path fill="none" stroke="black" d="M4072.18,-2986C4439.42,-2986 5237,-2986 5237,-2986 5237,-2986 5237,-2531.45 5237,-2531.45"/>
<polygon fill="black" stroke="black" points="5240.5,-2531.45 5237,-2521.45 5233.5,-2531.45 5240.5,-2531.45"/>
</g>
<!-- layer_6_expert_3 -->
<g id="node149" class="node">
<title>layer_6_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1218,-2521.17 856,-2521.17 856,-2453.17 1218,-2453.17 1218,-2521.17"/>
<text text-anchor="middle" x="1037" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1037" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_3 -->
<g id="edge360" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_3</title>
<path fill="none" stroke="black" d="M3709.86,-3006C3068.89,-3006 946.5,-3006 946.5,-3006 946.5,-3006 946.5,-2531.21 946.5,-2531.21"/>
<polygon fill="black" stroke="black" points="950,-2531.21 946.5,-2521.21 943,-2531.21 950,-2531.21"/>
</g>
<!-- layer_6_expert_4 -->
<g id="node150" class="node">
<title>layer_6_expert_4</title>
<polygon fill="lightblue" stroke="black" points="1638,-2521.17 1276,-2521.17 1276,-2453.17 1638,-2453.17 1638,-2521.17"/>
<text text-anchor="middle" x="1457" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1457" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_4 -->
<g id="edge363" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_4</title>
<path fill="none" stroke="black" d="M3709.95,-2998C3131.63,-2998 1366.5,-2998 1366.5,-2998 1366.5,-2998 1366.5,-2531.48 1366.5,-2531.48"/>
<polygon fill="black" stroke="black" points="1370,-2531.48 1366.5,-2521.48 1363,-2531.48 1370,-2531.48"/>
</g>
<!-- layer_6_expert_5 -->
<g id="node151" class="node">
<title>layer_6_expert_5</title>
<polygon fill="lightblue" stroke="black" points="4158,-2521.17 3796,-2521.17 3796,-2453.17 4158,-2453.17 4158,-2521.17"/>
<text text-anchor="middle" x="3977" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3977" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_5 -->
<g id="edge366" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_5</title>
<path fill="none" stroke="black" d="M4011.97,-2961.05C4011.97,-2961.05 4011.97,-2531.47 4011.97,-2531.47"/>
<polygon fill="black" stroke="black" points="4015.47,-2531.47 4011.97,-2521.47 4008.47,-2531.47 4015.47,-2531.47"/>
</g>
<!-- layer_6_expert_6 -->
<g id="node152" class="node">
<title>layer_6_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2898,-2521.17 2536,-2521.17 2536,-2453.17 2898,-2453.17 2898,-2521.17"/>
<text text-anchor="middle" x="2717" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2717" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_6 -->
<g id="edge369" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_6</title>
<path fill="none" stroke="black" d="M3709.83,-2976C3360.18,-2976 2626.5,-2976 2626.5,-2976 2626.5,-2976 2626.5,-2531.54 2626.5,-2531.54"/>
<polygon fill="black" stroke="black" points="2630,-2531.54 2626.5,-2521.54 2623,-2531.54 2630,-2531.54"/>
</g>
<!-- layer_6_expert_7 -->
<g id="node153" class="node">
<title>layer_6_expert_7</title>
<polygon fill="lightblue" stroke="black" points="5838,-2521.17 5476,-2521.17 5476,-2453.17 5838,-2453.17 5838,-2521.17"/>
<text text-anchor="middle" x="5657" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5657" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_7 -->
<g id="edge372" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_7</title>
<path fill="none" stroke="black" d="M4072.39,-2995C4539.53,-2995 5747.5,-2995 5747.5,-2995 5747.5,-2995 5747.5,-2531.28 5747.5,-2531.28"/>
<polygon fill="black" stroke="black" points="5751,-2531.28 5747.5,-2521.28 5744,-2531.28 5751,-2531.28"/>
</g>
<!-- layer_6_expert_8 -->
<g id="node154" class="node">
<title>layer_6_expert_8</title>
<polygon fill="lightblue" stroke="black" points="378,-2521.17 16,-2521.17 16,-2453.17 378,-2453.17 378,-2521.17"/>
<text text-anchor="middle" x="197" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="197" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_8 -->
<g id="edge375" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_8</title>
<path fill="none" stroke="black" d="M3709.74,-3021C2955.7,-3021 106.5,-3021 106.5,-3021 106.5,-3021 106.5,-2531.37 106.5,-2531.37"/>
<polygon fill="black" stroke="black" points="110,-2531.37 106.5,-2521.37 103,-2531.37 110,-2531.37"/>
</g>
<!-- layer_6_expert_9 -->
<g id="node155" class="node">
<title>layer_6_expert_9</title>
<polygon fill="lightblue" stroke="black" points="6258,-2521.17 5896,-2521.17 5896,-2453.17 6258,-2453.17 6258,-2521.17"/>
<text text-anchor="middle" x="6077" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="6077" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_9 -->
<g id="edge378" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_9</title>
<path fill="none" stroke="black" d="M4072.01,-3003C4610.9,-3003 6167.5,-3003 6167.5,-3003 6167.5,-3003 6167.5,-2531.41 6167.5,-2531.41"/>
<polygon fill="black" stroke="black" points="6171,-2531.41 6167.5,-2521.41 6164,-2531.41 6171,-2531.41"/>
</g>
<!-- layer_6_expert_10 -->
<g id="node156" class="node">
<title>layer_6_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4998,-2521.17 4636,-2521.17 4636,-2453.17 4998,-2453.17 4998,-2521.17"/>
<text text-anchor="middle" x="4817" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4817" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_10 -->
<g id="edge381" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_10</title>
<path fill="none" stroke="black" d="M4072.02,-2978C4341.55,-2978 4817,-2978 4817,-2978 4817,-2978 4817,-2531.29 4817,-2531.29"/>
<polygon fill="black" stroke="black" points="4820.5,-2531.29 4817,-2521.29 4813.5,-2531.29 4820.5,-2531.29"/>
</g>
<!-- layer_6_expert_11 -->
<g id="node157" class="node">
<title>layer_6_expert_11</title>
<polygon fill="lightblue" stroke="black" points="798,-2521.17 436,-2521.17 436,-2453.17 798,-2453.17 798,-2521.17"/>
<text text-anchor="middle" x="617" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="617" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_11 -->
<g id="edge384" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_11</title>
<path fill="none" stroke="black" d="M3709.81,-3014C3010.56,-3014 526.5,-3014 526.5,-3014 526.5,-3014 526.5,-2531.33 526.5,-2531.33"/>
<polygon fill="black" stroke="black" points="530,-2531.33 526.5,-2521.33 523,-2531.33 530,-2531.33"/>
</g>
<!-- layer_6_expert_12 -->
<g id="node158" class="node">
<title>layer_6_expert_12</title>
<polygon fill="lightblue" stroke="black" points="3318,-2521.17 2956,-2521.17 2956,-2453.17 3318,-2453.17 3318,-2521.17"/>
<text text-anchor="middle" x="3137" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3137" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_12 -->
<g id="edge387" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_12</title>
<path fill="none" stroke="black" d="M3709.94,-2968C3457.68,-2968 3031.07,-2968 3031.07,-2968 3031.07,-2968 3031.07,-2531.36 3031.07,-2531.36"/>
<polygon fill="black" stroke="black" points="3034.57,-2531.36 3031.07,-2521.36 3027.57,-2531.36 3034.57,-2531.36"/>
</g>
<!-- layer_6_expert_13 -->
<g id="node159" class="node">
<title>layer_6_expert_13</title>
<polygon fill="lightblue" stroke="black" points="6678,-2521.17 6316,-2521.17 6316,-2453.17 6678,-2453.17 6678,-2521.17"/>
<text text-anchor="middle" x="6497" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6497" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_13 -->
<g id="edge390" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_13</title>
<path fill="none" stroke="black" d="M4072.11,-3012C4676.7,-3012 6587.5,-3012 6587.5,-3012 6587.5,-3012 6587.5,-2531.2 6587.5,-2531.2"/>
<polygon fill="black" stroke="black" points="6591,-2531.2 6587.5,-2521.2 6584,-2531.2 6591,-2531.2"/>
</g>
<!-- layer_6_expert_14 -->
<g id="node160" class="node">
<title>layer_6_expert_14</title>
<polygon fill="lightblue" stroke="black" points="4578,-2521.17 4216,-2521.17 4216,-2453.17 4578,-2453.17 4578,-2521.17"/>
<text text-anchor="middle" x="4397" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4397" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_14 -->
<g id="edge393" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_14</title>
<path fill="none" stroke="black" d="M4072.25,-2969C4217.44,-2969 4397,-2969 4397,-2969 4397,-2969 4397,-2531.43 4397,-2531.43"/>
<polygon fill="black" stroke="black" points="4400.5,-2531.43 4397,-2521.43 4393.5,-2531.43 4400.5,-2531.43"/>
</g>
<!-- layer_6_expert_15 -->
<g id="node161" class="node">
<title>layer_6_expert_15</title>
<polygon fill="lightblue" stroke="black" points="3738,-2521.17 3376,-2521.17 3376,-2453.17 3738,-2453.17 3738,-2521.17"/>
<text text-anchor="middle" x="3557" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3557" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_expert_15 -->
<g id="edge396" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_expert_15</title>
<path fill="none" stroke="black" d="M3891.9,-2960.93C3891.9,-2873.34 3891.9,-2648 3891.9,-2648 3891.9,-2648 3617.33,-2648 3617.33,-2648 3617.33,-2648 3617.33,-2531.28 3617.33,-2531.28"/>
<polygon fill="black" stroke="black" points="3620.83,-2531.28 3617.33,-2521.28 3613.83,-2531.28 3620.83,-2531.28"/>
</g>
<!-- layer_6_add_norm2 -->
<g id="node162" class="node">
<title>layer_6_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4104,-2095.17 3742,-2095.17 3742,-2027.17 4104,-2027.17 4104,-2095.17"/>
<text text-anchor="middle" x="3923" y="-2079.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3923" y="-2064.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3923" y="-2049.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3923" y="-2034.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_6_add_norm1&#45;&gt;layer_6_add_norm2 -->
<g id="edge399" class="edge">
<title>layer_6_add_norm1&#45;&gt;layer_6_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4072.2,-2965C4125.13,-2965 4169.06,-2965 4169.06,-2965 4169.06,-2965 4169.06,-2061 4169.06,-2061 4169.06,-2061 4114.09,-2061 4114.09,-2061"/>
<polygon fill="black" stroke="black" points="4114.09,-2057.5 4104.09,-2061 4114.09,-2064.5 4114.09,-2057.5"/>
<text text-anchor="middle" x="6883" y="-2483.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_0 -->
<g id="edge350" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3161.53,-2731C2722.24,-2731 1967.5,-2731 1967.5,-2731 1967.5,-2731 1967.5,-2531.33 1967.5,-2531.33"/>
<polygon fill="black" stroke="black" points="1971,-2531.33 1967.5,-2521.33 1964,-2531.33 1971,-2531.33"/>
<text text-anchor="middle" x="2531.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_1 -->
<g id="edge353" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3143.05,-2714C2824.61,-2714 2387.5,-2714 2387.5,-2714 2387.5,-2714 2387.5,-2531.62 2387.5,-2531.62"/>
<polygon fill="black" stroke="black" points="2391,-2531.62 2387.5,-2521.62 2384,-2531.62 2391,-2531.62"/>
<text text-anchor="middle" x="2972.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_2 -->
<g id="edge356" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3746.48,-2738C4223.07,-2738 5146.5,-2738 5146.5,-2738 5146.5,-2738 5146.5,-2531.26 5146.5,-2531.26"/>
<polygon fill="black" stroke="black" points="5150,-2531.26 5146.5,-2521.26 5143,-2531.26 5150,-2531.26"/>
<text text-anchor="middle" x="4505.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_3 -->
<g id="edge359" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3198.69,-2765C2582.66,-2765 1127.5,-2765 1127.5,-2765 1127.5,-2765 1127.5,-2531.23 1127.5,-2531.23"/>
<polygon fill="black" stroke="black" points="1131,-2531.23 1127.5,-2521.23 1124,-2531.23 1131,-2531.23"/>
<text text-anchor="middle" x="1769.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_4 -->
<g id="edge362" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3180.29,-2748C2643.88,-2748 1547.5,-2748 1547.5,-2748 1547.5,-2748 1547.5,-2531.27 1547.5,-2531.27"/>
<polygon fill="black" stroke="black" points="1551,-2531.27 1547.5,-2521.27 1544,-2531.27 1551,-2531.27"/>
<text text-anchor="middle" x="2225.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_5 -->
<g id="edge365" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3813.93,-2748.12C3813.93,-2748.12 3813.93,-2531.33 3813.93,-2531.33"/>
<polygon fill="black" stroke="black" points="3817.43,-2531.33 3813.93,-2521.33 3810.43,-2531.33 3817.43,-2531.33"/>
<text text-anchor="middle" x="3735.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_6 -->
<g id="edge368" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3124.2,-2697C2963.64,-2697 2807.5,-2697 2807.5,-2697 2807.5,-2697 2807.5,-2531.35 2807.5,-2531.35"/>
<polygon fill="black" stroke="black" points="2811,-2531.35 2807.5,-2521.35 2804,-2531.35 2811,-2531.35"/>
<text text-anchor="middle" x="3200.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_7 -->
<g id="edge371" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3767.29,-2757C4346.38,-2757 5566.5,-2757 5566.5,-2757 5566.5,-2757 5566.5,-2531.34 5566.5,-2531.34"/>
<polygon fill="black" stroke="black" points="5570,-2531.34 5566.5,-2521.34 5563,-2531.34 5570,-2531.34"/>
<text text-anchor="middle" x="4962.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_8 -->
<g id="edge374" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3235.7,-2799C2501.62,-2799 287.5,-2799 287.5,-2799 287.5,-2799 287.5,-2531.43 287.5,-2531.43"/>
<polygon fill="black" stroke="black" points="291,-2531.43 287.5,-2521.43 284,-2531.43 291,-2531.43"/>
<text text-anchor="middle" x="1041.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_9 -->
<g id="edge377" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3789.12,-2777C4467.18,-2777 5986.5,-2777 5986.5,-2777 5986.5,-2777 5986.5,-2531.27 5986.5,-2531.27"/>
<polygon fill="black" stroke="black" points="5990,-2531.27 5986.5,-2521.27 5983,-2531.27 5990,-2531.27"/>
<text text-anchor="middle" x="5415.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_10 -->
<g id="edge380" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3725.75,-2719C4093.54,-2719 4726.5,-2719 4726.5,-2719 4726.5,-2719 4726.5,-2531.37 4726.5,-2531.37"/>
<polygon fill="black" stroke="black" points="4730,-2531.37 4726.5,-2521.37 4723,-2531.37 4730,-2531.37"/>
<text text-anchor="middle" x="4252.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_11 -->
<g id="edge383" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3217.23,-2782C2536,-2782 707.5,-2782 707.5,-2782 707.5,-2782 707.5,-2531.28 707.5,-2531.28"/>
<polygon fill="black" stroke="black" points="711,-2531.28 707.5,-2521.28 704,-2531.28 711,-2531.28"/>
<text text-anchor="middle" x="1386.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_12 -->
<g id="edge386" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3212.07,-2679.93C3212.07,-2679.93 3212.07,-2531.49 3212.07,-2531.49"/>
<polygon fill="black" stroke="black" points="3215.57,-2531.49 3212.07,-2521.49 3208.57,-2531.49 3215.57,-2531.49"/>
<text text-anchor="middle" x="3392.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_13 -->
<g id="edge389" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3809.92,-2796C4583.77,-2796 6406.5,-2796 6406.5,-2796 6406.5,-2796 6406.5,-2531.4 6406.5,-2531.4"/>
<polygon fill="black" stroke="black" points="6410,-2531.4 6406.5,-2521.4 6403,-2531.4 6410,-2531.4"/>
<text text-anchor="middle" x="5743.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_14 -->
<g id="edge392" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3703.96,-2699C3951.7,-2699 4306.5,-2699 4306.5,-2699 4306.5,-2699 4306.5,-2531.2 4306.5,-2531.2"/>
<polygon fill="black" stroke="black" points="4310,-2531.2 4306.5,-2521.2 4303,-2531.2 4310,-2531.2"/>
<text text-anchor="middle" x="3981.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_15 -->
<g id="edge395" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3496.67,-2679.93C3496.67,-2679.93 3496.67,-2531.49 3496.67,-2531.49"/>
<polygon fill="black" stroke="black" points="3500.17,-2531.49 3496.67,-2521.49 3493.17,-2531.49 3500.17,-2531.49"/>
<text text-anchor="middle" x="3539.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_6_moe_agg&#45;&gt;layer_6_add_norm2 -->
<g id="edge398" class="edge">
<title>layer_6_moe_agg&#45;&gt;layer_6_add_norm2</title>
<path fill="none" stroke="black" d="M3793.5,-2239.94C3793.5,-2239.94 3793.5,-2105.3 3793.5,-2105.3"/>
<polygon fill="black" stroke="black" points="3797,-2105.3 3793.5,-2095.3 3790,-2105.3 3797,-2105.3"/>
</g>
<!-- layer_6_expert_0&#45;&gt;layer_6_moe_agg -->
<g id="edge352" class="edge">
<title>layer_6_expert_0&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M1877,-2452.93C1877,-2393.38 1877,-2277 1877,-2277 1877,-2277 3472.82,-2277 3472.82,-2277"/>
<polygon fill="black" stroke="black" points="3472.82,-2280.5 3482.82,-2277 3472.82,-2273.5 3472.82,-2280.5"/>
</g>
<!-- layer_6_expert_1&#45;&gt;layer_6_moe_agg -->
<g id="edge355" class="edge">
<title>layer_6_expert_1&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M2297,-2452.87C2297,-2395.19 2297,-2285 2297,-2285 2297,-2285 3472.83,-2285 3472.83,-2285"/>
<polygon fill="black" stroke="black" points="3472.83,-2288.5 3482.83,-2285 3472.83,-2281.5 3472.83,-2288.5"/>
</g>
<!-- layer_6_expert_2&#45;&gt;layer_6_moe_agg -->
<g id="edge358" class="edge">
<title>layer_6_expert_2&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M5237,-2453.08C5237,-2397.62 5237,-2294 5237,-2294 5237,-2294 3855.21,-2294 3855.21,-2294"/>
<polygon fill="black" stroke="black" points="3855.21,-2290.5 3845.21,-2294 3855.21,-2297.5 3855.21,-2290.5"/>
</g>
<!-- layer_6_expert_3&#45;&gt;layer_6_moe_agg -->
<g id="edge361" class="edge">
<title>layer_6_expert_3&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M1037,-2452.97C1037,-2389.98 1037,-2262 1037,-2262 1037,-2262 3472.92,-2262 3472.92,-2262"/>
<polygon fill="black" stroke="black" points="3472.92,-2265.5 3482.92,-2262 3472.92,-2258.5 3472.92,-2265.5"/>
</g>
<!-- layer_6_expert_4&#45;&gt;layer_6_moe_agg -->
<g id="edge364" class="edge">
<title>layer_6_expert_4&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M1457,-2452.76C1457,-2391.52 1457,-2270 1457,-2270 1457,-2270 3472.92,-2270 3472.92,-2270"/>
<polygon fill="black" stroke="black" points="3472.92,-2273.5 3482.92,-2270 3472.92,-2266.5 3472.92,-2273.5"/>
</g>
<!-- layer_6_expert_5&#45;&gt;layer_6_moe_agg -->
<g id="edge367" class="edge">
<title>layer_6_expert_5&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M3820.5,-2452.94C3820.5,-2452.94 3820.5,-2318.3 3820.5,-2318.3"/>
<polygon fill="black" stroke="black" points="3824,-2318.3 3820.5,-2308.3 3817,-2318.3 3824,-2318.3"/>
</g>
<!-- layer_6_expert_6&#45;&gt;layer_6_moe_agg -->
<g id="edge370" class="edge">
<title>layer_6_expert_6&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M2717,-2452.9C2717,-2397.16 2717,-2293 2717,-2293 2717,-2293 3472.81,-2293 3472.81,-2293"/>
<polygon fill="black" stroke="black" points="3472.81,-2296.5 3482.81,-2293 3472.81,-2289.5 3472.81,-2296.5"/>
</g>
<!-- layer_6_expert_7&#45;&gt;layer_6_moe_agg -->
<g id="edge373" class="edge">
<title>layer_6_expert_7&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M5657,-2452.82C5657,-2396.33 5657,-2290 5657,-2290 5657,-2290 3855.26,-2290 3855.26,-2290"/>
<polygon fill="black" stroke="black" points="3855.26,-2286.5 3845.26,-2290 3855.26,-2293.5 3855.26,-2286.5"/>
</g>
<!-- layer_6_expert_8&#45;&gt;layer_6_moe_agg -->
<g id="edge376" class="edge">
<title>layer_6_expert_8&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M197,-2453.01C197,-2386.71 197,-2247 197,-2247 197,-2247 3472.78,-2247 3472.78,-2247"/>
<polygon fill="black" stroke="black" points="3472.78,-2250.5 3482.78,-2247 3472.78,-2243.5 3472.78,-2250.5"/>
</g>
<!-- layer_6_expert_9&#45;&gt;layer_6_moe_agg -->
<g id="edge379" class="edge">
<title>layer_6_expert_9&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M6077,-2452.87C6077,-2395.19 6077,-2285 6077,-2285 6077,-2285 3855.37,-2285 3855.37,-2285"/>
<polygon fill="black" stroke="black" points="3855.37,-2281.5 3845.37,-2285 3855.37,-2288.5 3855.37,-2281.5"/>
</g>
<!-- layer_6_expert_10&#45;&gt;layer_6_moe_agg -->
<g id="edge382" class="edge">
<title>layer_6_expert_10&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M4817,-2453.09C4817,-2398.87 4817,-2299 4817,-2299 4817,-2299 3855.11,-2299 3855.11,-2299"/>
<polygon fill="black" stroke="black" points="3855.11,-2295.5 3845.11,-2299 3855.11,-2302.5 3855.11,-2295.5"/>
</g>
<!-- layer_6_expert_11&#45;&gt;layer_6_moe_agg -->
<g id="edge385" class="edge">
<title>layer_6_expert_11&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M617,-2452.91C617,-2388.33 617,-2255 617,-2255 617,-2255 3472.8,-2255 3472.8,-2255"/>
<polygon fill="black" stroke="black" points="3472.8,-2258.5 3482.8,-2255 3472.8,-2251.5 3472.8,-2258.5"/>
</g>
<!-- layer_6_expert_12&#45;&gt;layer_6_moe_agg -->
<g id="edge388" class="edge">
<title>layer_6_expert_12&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M3233.07,-2452.84C3233.07,-2398.8 3233.07,-2300 3233.07,-2300 3233.07,-2300 3472.81,-2300 3472.81,-2300"/>
<polygon fill="black" stroke="black" points="3472.81,-2303.5 3482.81,-2300 3472.81,-2296.5 3472.81,-2303.5"/>
</g>
<!-- layer_6_expert_13&#45;&gt;layer_6_moe_agg -->
<g id="edge391" class="edge">
<title>layer_6_expert_13&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M6497,-2452.96C6497,-2394.12 6497,-2280 6497,-2280 6497,-2280 3855.26,-2280 3855.26,-2280"/>
<polygon fill="black" stroke="black" points="3855.26,-2276.5 3845.26,-2280 3855.26,-2283.5 3855.26,-2276.5"/>
</g>
<!-- layer_6_expert_14&#45;&gt;layer_6_moe_agg -->
<g id="edge394" class="edge">
<title>layer_6_expert_14&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M4397,-2452.96C4397,-2399.7 4397,-2303 4397,-2303 4397,-2303 3855.19,-2303 3855.19,-2303"/>
<polygon fill="black" stroke="black" points="3855.19,-2299.5 3845.19,-2303 3855.19,-2306.5 3855.19,-2299.5"/>
</g>
<!-- layer_6_expert_15&#45;&gt;layer_6_moe_agg -->
<g id="edge397" class="edge">
<title>layer_6_expert_15&#45;&gt;layer_6_moe_agg</title>
<path fill="none" stroke="black" d="M3610.5,-2452.94C3610.5,-2452.94 3610.5,-2318.3 3610.5,-2318.3"/>
<polygon fill="black" stroke="black" points="3614,-2318.3 3610.5,-2308.3 3607,-2318.3 3614,-2318.3"/>
</g>
<!-- layer_7_qkv -->
<g id="node163" class="node">
<title>layer_7_qkv</title>
<polygon fill="lightblue" stroke="black" points="3902.5,-1882.17 3493.5,-1882.17 3493.5,-1814.17 3902.5,-1814.17 3902.5,-1882.17"/>
<text text-anchor="middle" x="3698" y="-1866.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3698" y="-1851.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3698" y="-1836.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3698" y="-1821.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_6_add_norm2&#45;&gt;layer_7_qkv -->
<g id="edge400" class="edge">
<title>layer_6_add_norm2&#45;&gt;layer_7_qkv</title>
<path fill="none" stroke="black" d="M3822.25,-2026.94C3822.25,-2026.94 3822.25,-1892.3 3822.25,-1892.3"/>
<polygon fill="black" stroke="black" points="3825.75,-1892.3 3822.25,-1882.3 3818.75,-1892.3 3825.75,-1892.3"/>
</g>
<!-- layer_7_add_norm1 -->
<g id="node166" class="node">
<title>layer_7_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4114,-1243.17 3752,-1243.17 3752,-1175.17 4114,-1175.17 4114,-1243.17"/>
<text text-anchor="middle" x="3933" y="-1227.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="3933" y="-1212.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3933" y="-1197.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3933" y="-1182.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_6_add_norm2&#45;&gt;layer_7_add_norm1 -->
<g id="edge404" class="edge">
<title>layer_6_add_norm2&#45;&gt;layer_7_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4009.25,-2026.98C4009.25,-2026.98 4009.25,-1253.62 4009.25,-1253.62"/>
<polygon fill="black" stroke="black" points="4012.75,-1253.62 4009.25,-1243.62 4005.75,-1253.62 4012.75,-1253.62"/>
<text text-anchor="middle" x="4019" y="-1631.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_7_attn -->
<g id="node164" class="node">
<title>layer_7_attn</title>
<polygon fill="lightblue" stroke="black" points="3873.5,-1669.17 3464.5,-1669.17 3464.5,-1601.17 3873.5,-1601.17 3873.5,-1669.17"/>
<text text-anchor="middle" x="3669" y="-1653.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3669" y="-1638.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3669" y="-1623.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3669" y="-1608.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_7_qkv&#45;&gt;layer_7_attn -->
<g id="edge401" class="edge">
<title>layer_7_qkv&#45;&gt;layer_7_attn</title>
<path fill="none" stroke="black" d="M3683.5,-1813.94C3683.5,-1813.94 3683.5,-1679.3 3683.5,-1679.3"/>
<polygon fill="black" stroke="black" points="3687,-1679.3 3683.5,-1669.3 3680,-1679.3 3687,-1679.3"/>
</g>
<!-- layer_7_proj -->
<g id="node165" class="node">
<title>layer_7_proj</title>
<polygon fill="lightblue" stroke="black" points="3914.5,-1456.17 3517.5,-1456.17 3517.5,-1388.17 3914.5,-1388.17 3914.5,-1456.17"/>
<text text-anchor="middle" x="3716" y="-1440.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="3716" y="-1425.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3716" y="-1410.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3716" y="-1395.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_7_attn&#45;&gt;layer_7_proj -->
<g id="edge402" class="edge">
<title>layer_7_attn&#45;&gt;layer_7_proj</title>
<path fill="none" stroke="black" d="M3695.5,-1600.94C3695.5,-1600.94 3695.5,-1466.3 3695.5,-1466.3"/>
<polygon fill="black" stroke="black" points="3699,-1466.3 3695.5,-1456.3 3692,-1466.3 3699,-1466.3"/>
</g>
<!-- layer_7_proj&#45;&gt;layer_7_add_norm1 -->
<g id="edge403" class="edge">
<title>layer_7_proj&#45;&gt;layer_7_add_norm1</title>
<path fill="none" stroke="black" d="M3833.25,-1387.94C3833.25,-1387.94 3833.25,-1253.3 3833.25,-1253.3"/>
<polygon fill="black" stroke="black" points="3836.75,-1253.3 3833.25,-1243.3 3829.75,-1253.3 3836.75,-1253.3"/>
</g>
<!-- layer_7_gate -->
<g id="node167" class="node">
<title>layer_7_gate</title>
<polygon fill="yellow" stroke="black" points="3873.73,-1030.17 3296.71,-1030.17 3148.27,-894.17 3725.29,-894.17 3873.73,-1030.17"/>
<text text-anchor="middle" x="3511" y="-980.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3511" y="-965.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3511" y="-950.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="3511" y="-935.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_gate -->
<g id="edge405" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_gate</title>
<path fill="none" stroke="black" d="M3812.93,-1175.08C3812.93,-1175.08 3812.93,-1040.37 3812.93,-1040.37"/>
<polygon fill="black" stroke="black" points="3816.43,-1040.37 3812.93,-1030.37 3809.43,-1040.37 3816.43,-1040.37"/>
</g>
<!-- layer_7_moe_agg -->
<g id="node168" class="node">
<title>layer_7_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="4000,-522.17 3638,-522.17 3638,-454.17 4000,-454.17 4000,-522.17"/>
<text text-anchor="middle" x="3819" y="-506.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="3819" y="-491.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3819" y="-476.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3819" y="-461.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_moe_agg -->
<g id="edge406" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M3993.93,-1174.85C3993.93,-1081.51 3993.93,-830 3993.93,-830 3993.93,-830 3767,-830 3767,-830 3767,-830 3767,-532.19 3767,-532.19"/>
<polygon fill="black" stroke="black" points="3770.5,-532.19 3767,-522.19 3763.5,-532.19 3770.5,-532.19"/>
</g>
<!-- layer_7_expert_0 -->
<g id="node169" class="node">
<title>layer_7_expert_0</title>
<polygon fill="lightblue" stroke="black" points="2058,-735.17 1696,-735.17 1696,-667.17 2058,-667.17 2058,-735.17"/>
<text text-anchor="middle" x="1877" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1877" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1877" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_0 -->
<g id="edge408" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_0</title>
<path fill="none" stroke="black" d="M3751.84,-1205C3234.35,-1205 1786.5,-1205 1786.5,-1205 1786.5,-1205 1786.5,-745.4 1786.5,-745.4"/>
<polygon fill="black" stroke="black" points="1790,-745.4 1786.5,-735.4 1783,-745.4 1790,-745.4"/>
</g>
<!-- layer_7_expert_1 -->
<g id="node170" class="node">
<title>layer_7_expert_1</title>
<polygon fill="lightblue" stroke="black" points="2478,-735.17 2116,-735.17 2116,-667.17 2478,-667.17 2478,-735.17"/>
<text text-anchor="middle" x="2297" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2297" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2297" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_1 -->
<g id="edge411" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_1</title>
<path fill="none" stroke="black" d="M3751.9,-1197C3308.9,-1197 2206.5,-1197 2206.5,-1197 2206.5,-1197 2206.5,-745.25 2206.5,-745.25"/>
<polygon fill="black" stroke="black" points="2210,-745.25 2206.5,-735.25 2203,-745.25 2210,-745.25"/>
</g>
<!-- layer_7_expert_2 -->
<g id="node171" class="node">
<title>layer_7_expert_2</title>
<polygon fill="lightblue" stroke="black" points="5418,-735.17 5056,-735.17 5056,-667.17 5418,-667.17 5418,-735.17"/>
<text text-anchor="middle" x="5237" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5237" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5237" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_2 -->
<g id="edge414" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_2</title>
<path fill="none" stroke="black" d="M4114.23,-1196C4491.72,-1196 5327.5,-1196 5327.5,-1196 5327.5,-1196 5327.5,-745.18 5327.5,-745.18"/>
<polygon fill="black" stroke="black" points="5331,-745.18 5327.5,-735.18 5324,-745.18 5331,-745.18"/>
</g>
<!-- layer_7_expert_3 -->
<g id="node172" class="node">
<title>layer_7_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1218,-735.17 856,-735.17 856,-667.17 1218,-667.17 1218,-735.17"/>
<text text-anchor="middle" x="1037" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1037" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1037" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_3 -->
<g id="edge417" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_3</title>
<path fill="none" stroke="black" d="M3751.79,-1220C3104.74,-1220 946.5,-1220 946.5,-1220 946.5,-1220 946.5,-745.21 946.5,-745.21"/>
<polygon fill="black" stroke="black" points="950,-745.21 946.5,-735.21 943,-745.21 950,-745.21"/>
</g>
<!-- layer_7_expert_4 -->
<g id="node173" class="node">
<title>layer_7_expert_4</title>
<polygon fill="lightblue" stroke="black" points="1638,-735.17 1276,-735.17 1276,-667.17 1638,-667.17 1638,-735.17"/>
<text text-anchor="middle" x="1457" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1457" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1457" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_4 -->
<g id="edge420" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_4</title>
<path fill="none" stroke="black" d="M3751.76,-1212C3166.76,-1212 1366.5,-1212 1366.5,-1212 1366.5,-1212 1366.5,-745.48 1366.5,-745.48"/>
<polygon fill="black" stroke="black" points="1370,-745.48 1366.5,-735.48 1363,-745.48 1370,-745.48"/>
</g>
<!-- layer_7_expert_5 -->
<g id="node174" class="node">
<title>layer_7_expert_5</title>
<polygon fill="lightblue" stroke="black" points="4158,-735.17 3796,-735.17 3796,-667.17 4158,-667.17 4158,-735.17"/>
<text text-anchor="middle" x="3977" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3977" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3977" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_5 -->
<g id="edge423" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_5</title>
<path fill="none" stroke="black" d="M4053.97,-1175.05C4053.97,-1175.05 4053.97,-745.47 4053.97,-745.47"/>
<polygon fill="black" stroke="black" points="4057.47,-745.47 4053.97,-735.47 4050.47,-745.47 4057.47,-745.47"/>
</g>
<!-- layer_7_expert_6 -->
<g id="node175" class="node">
<title>layer_7_expert_6</title>
<polygon fill="lightblue" stroke="black" points="2898,-735.17 2536,-735.17 2536,-667.17 2898,-667.17 2898,-735.17"/>
<text text-anchor="middle" x="2717" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2717" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2717" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_6 -->
<g id="edge426" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_6</title>
<path fill="none" stroke="black" d="M3751.68,-1190C3392.83,-1190 2626.5,-1190 2626.5,-1190 2626.5,-1190 2626.5,-745.54 2626.5,-745.54"/>
<polygon fill="black" stroke="black" points="2630,-745.54 2626.5,-735.54 2623,-745.54 2630,-745.54"/>
</g>
<!-- layer_7_expert_7 -->
<g id="node176" class="node">
<title>layer_7_expert_7</title>
<polygon fill="lightblue" stroke="black" points="5838,-735.17 5476,-735.17 5476,-667.17 5838,-667.17 5838,-735.17"/>
<text text-anchor="middle" x="5657" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5657" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5657" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_7 -->
<g id="edge429" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_7</title>
<path fill="none" stroke="black" d="M4114.03,-1204C4573.28,-1204 5747.5,-1204 5747.5,-1204 5747.5,-1204 5747.5,-745.33 5747.5,-745.33"/>
<polygon fill="black" stroke="black" points="5751,-745.33 5747.5,-735.33 5744,-745.33 5751,-745.33"/>
</g>
<!-- layer_7_expert_8 -->
<g id="node177" class="node">
<title>layer_7_expert_8</title>
<polygon fill="lightblue" stroke="black" points="378,-735.17 16,-735.17 16,-667.17 378,-667.17 378,-735.17"/>
<text text-anchor="middle" x="197" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="197" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="197" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_8 -->
<g id="edge432" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_8</title>
<path fill="none" stroke="black" d="M3751.98,-1235C2993,-1235 106.5,-1235 106.5,-1235 106.5,-1235 106.5,-745.37 106.5,-745.37"/>
<polygon fill="black" stroke="black" points="110,-745.37 106.5,-735.37 103,-745.37 110,-745.37"/>
</g>
<!-- layer_7_expert_9 -->
<g id="node178" class="node">
<title>layer_7_expert_9</title>
<polygon fill="lightblue" stroke="black" points="6258,-735.17 5896,-735.17 5896,-667.17 6258,-667.17 6258,-735.17"/>
<text text-anchor="middle" x="6077" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="6077" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6077" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_9 -->
<g id="edge435" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_9</title>
<path fill="none" stroke="black" d="M4114.44,-1217C4646.82,-1217 6167.5,-1217 6167.5,-1217 6167.5,-1217 6167.5,-745.41 6167.5,-745.41"/>
<polygon fill="black" stroke="black" points="6171,-745.41 6167.5,-735.41 6164,-745.41 6171,-745.41"/>
</g>
<!-- layer_7_expert_10 -->
<g id="node179" class="node">
<title>layer_7_expert_10</title>
<polygon fill="lightblue" stroke="black" points="4998,-735.17 4636,-735.17 4636,-667.17 4998,-667.17 4998,-735.17"/>
<text text-anchor="middle" x="4817" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4817" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4817" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_10 -->
<g id="edge438" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_10</title>
<path fill="none" stroke="black" d="M4114.01,-1187C4395.83,-1187 4907.5,-1187 4907.5,-1187 4907.5,-1187 4907.5,-745.33 4907.5,-745.33"/>
<polygon fill="black" stroke="black" points="4911,-745.33 4907.5,-735.33 4904,-745.33 4911,-745.33"/>
</g>
<!-- layer_7_expert_11 -->
<g id="node180" class="node">
<title>layer_7_expert_11</title>
<polygon fill="lightblue" stroke="black" points="798,-735.17 436,-735.17 436,-667.17 798,-667.17 798,-735.17"/>
<text text-anchor="middle" x="617" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="617" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="617" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_11 -->
<g id="edge441" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_11</title>
<path fill="none" stroke="black" d="M3751.96,-1228C3047.29,-1228 526.5,-1228 526.5,-1228 526.5,-1228 526.5,-745.33 526.5,-745.33"/>
<polygon fill="black" stroke="black" points="530,-745.33 526.5,-735.33 523,-745.33 530,-745.33"/>
</g>
<!-- layer_7_expert_12 -->
<g id="node181" class="node">
<title>layer_7_expert_12</title>
<polygon fill="lightblue" stroke="black" points="3318,-735.17 2956,-735.17 2956,-667.17 3318,-667.17 3318,-735.17"/>
<text text-anchor="middle" x="3137" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3137" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3137" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_12 -->
<g id="edge444" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_12</title>
<path fill="none" stroke="black" d="M3751.81,-1182C3493.96,-1182 3052.07,-1182 3052.07,-1182 3052.07,-1182 3052.07,-745.36 3052.07,-745.36"/>
<polygon fill="black" stroke="black" points="3055.57,-745.36 3052.07,-735.36 3048.57,-745.36 3055.57,-745.36"/>
</g>
<!-- layer_7_expert_13 -->
<g id="node182" class="node">
<title>layer_7_expert_13</title>
<polygon fill="lightblue" stroke="black" points="6678,-735.17 6316,-735.17 6316,-667.17 6678,-667.17 6678,-735.17"/>
<text text-anchor="middle" x="6497" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6497" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="6497" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_13 -->
<g id="edge447" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_13</title>
<path fill="none" stroke="black" d="M4114.15,-1226C4712.46,-1226 6587.5,-1226 6587.5,-1226 6587.5,-1226 6587.5,-745.2 6587.5,-745.2"/>
<polygon fill="black" stroke="black" points="6591,-745.2 6587.5,-735.2 6584,-745.2 6591,-745.2"/>
</g>
<!-- layer_7_expert_14 -->
<g id="node183" class="node">
<title>layer_7_expert_14</title>
<polygon fill="lightblue" stroke="black" points="4578,-735.17 4216,-735.17 4216,-667.17 4578,-667.17 4578,-735.17"/>
<text text-anchor="middle" x="4397" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4397" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4397" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_14 -->
<g id="edge450" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_14</title>
<path fill="none" stroke="black" d="M4114.18,-1179C4275.95,-1179 4487.5,-1179 4487.5,-1179 4487.5,-1179 4487.5,-745.53 4487.5,-745.53"/>
<polygon fill="black" stroke="black" points="4491,-745.53 4487.5,-735.53 4484,-745.53 4491,-745.53"/>
</g>
<!-- layer_7_expert_15 -->
<g id="node184" class="node">
<title>layer_7_expert_15</title>
<polygon fill="lightblue" stroke="black" points="3738,-735.17 3376,-735.17 3376,-667.17 3738,-667.17 3738,-735.17"/>
<text text-anchor="middle" x="3557" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3557" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3557" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_expert_15 -->
<g id="edge453" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_expert_15</title>
<path fill="none" stroke="black" d="M3933.9,-1174.93C3933.9,-1087.34 3933.9,-862 3933.9,-862 3933.9,-862 3617.33,-862 3617.33,-862 3617.33,-862 3617.33,-745.28 3617.33,-745.28"/>
<polygon fill="black" stroke="black" points="3620.83,-745.28 3617.33,-735.28 3613.83,-745.28 3620.83,-745.28"/>
</g>
<!-- layer_7_add_norm2 -->
<g id="node185" class="node">
<title>layer_7_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="6145,-309.17 5783,-309.17 5783,-241.17 6145,-241.17 6145,-309.17"/>
<text text-anchor="middle" x="5964" y="-293.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="5964" y="-278.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5964" y="-263.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="5964" y="-248.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_7_add_norm1&#45;&gt;layer_7_add_norm2 -->
<g id="edge456" class="edge">
<title>layer_7_add_norm1&#45;&gt;layer_7_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4114.08,-1213C4594.86,-1213 5867,-1213 5867,-1213 5867,-1213 5867,-319.38 5867,-319.38"/>
<polygon fill="black" stroke="black" points="5870.5,-319.38 5867,-309.38 5863.5,-319.38 5870.5,-319.38"/>
<text text-anchor="middle" x="6883" y="-697.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_0 -->
<g id="edge407" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3203.75,-945C2753.54,-945 1967.5,-945 1967.5,-945 1967.5,-945 1967.5,-745.33 1967.5,-745.33"/>
<polygon fill="black" stroke="black" points="1971,-745.33 1967.5,-735.33 1964,-745.33 1971,-745.33"/>
<text text-anchor="middle" x="2416.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_1 -->
<g id="edge410" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3184.91,-928C2853.16,-928 2387.5,-928 2387.5,-928 2387.5,-928 2387.5,-745.62 2387.5,-745.62"/>
<polygon fill="black" stroke="black" points="2391,-745.62 2387.5,-735.62 2384,-745.62 2391,-745.62"/>
<text text-anchor="middle" x="2982.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_2 -->
<g id="edge413" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3788.44,-952C4255.06,-952 5146.5,-952 5146.5,-952 5146.5,-952 5146.5,-745.26 5146.5,-745.26"/>
<polygon fill="black" stroke="black" points="5150,-745.26 5146.5,-735.26 5143,-745.26 5150,-745.26"/>
<text text-anchor="middle" x="4568.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_3 -->
<g id="edge416" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3240.77,-979C2616.57,-979 1127.5,-979 1127.5,-979 1127.5,-979 1127.5,-745.23 1127.5,-745.23"/>
<polygon fill="black" stroke="black" points="1131,-745.23 1127.5,-735.23 1124,-745.23 1131,-745.23"/>
<text text-anchor="middle" x="1812.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_4 -->
<g id="edge419" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3222.07,-962C2676.19,-962 1547.5,-962 1547.5,-962 1547.5,-962 1547.5,-745.27 1547.5,-745.27"/>
<polygon fill="black" stroke="black" points="1551,-745.27 1547.5,-735.27 1544,-745.27 1551,-745.27"/>
<text text-anchor="middle" x="2199.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_5 -->
<g id="edge422" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3834.93,-962.12C3834.93,-962.12 3834.93,-745.33 3834.93,-745.33"/>
<polygon fill="black" stroke="black" points="3838.43,-745.33 3834.93,-735.33 3831.43,-745.33 3838.43,-745.33"/>
<text text-anchor="middle" x="3777.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_6 -->
<g id="edge425" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3166.46,-911C2988.22,-911 2807.5,-911 2807.5,-911 2807.5,-911 2807.5,-745.35 2807.5,-745.35"/>
<polygon fill="black" stroke="black" points="2811,-745.35 2807.5,-735.35 2804,-745.35 2811,-745.35"/>
<text text-anchor="middle" x="3242.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_7 -->
<g id="edge428" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3809.34,-971C4379.21,-971 5566.5,-971 5566.5,-971 5566.5,-971 5566.5,-745.34 5566.5,-745.34"/>
<polygon fill="black" stroke="black" points="5570,-745.34 5566.5,-735.34 5563,-745.34 5570,-745.34"/>
<text text-anchor="middle" x="4967.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_8 -->
<g id="edge431" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3277.88,-1013C2537.42,-1013 287.5,-1013 287.5,-1013 287.5,-1013 287.5,-745.43 287.5,-745.43"/>
<polygon fill="black" stroke="black" points="291,-745.43 287.5,-735.43 284,-745.43 291,-745.43"/>
<text text-anchor="middle" x="1004.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_9 -->
<g id="edge434" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3831.14,-991C4500.5,-991 5986.5,-991 5986.5,-991 5986.5,-991 5986.5,-745.27 5986.5,-745.27"/>
<polygon fill="black" stroke="black" points="5990,-745.27 5986.5,-735.27 5983,-745.27 5990,-745.27"/>
<text text-anchor="middle" x="5381.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_10 -->
<g id="edge437" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3768.03,-933C4124.74,-933 4726.5,-933 4726.5,-933 4726.5,-933 4726.5,-745.37 4726.5,-745.37"/>
<polygon fill="black" stroke="black" points="4730,-745.37 4726.5,-735.37 4723,-745.37 4730,-745.37"/>
<text text-anchor="middle" x="4232.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_11 -->
<g id="edge440" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3259.12,-996C2570.5,-996 707.5,-996 707.5,-996 707.5,-996 707.5,-745.28 707.5,-745.28"/>
<polygon fill="black" stroke="black" points="711,-745.28 707.5,-735.28 704,-745.28 711,-745.28"/>
<text text-anchor="middle" x="1423.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_12 -->
<g id="edge443" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3233.07,-893.93C3233.07,-893.93 3233.07,-745.49 3233.07,-745.49"/>
<polygon fill="black" stroke="black" points="3236.57,-745.49 3233.07,-735.49 3229.57,-745.49 3236.57,-745.49"/>
<text text-anchor="middle" x="3399.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_13 -->
<g id="edge446" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3852.02,-1010C4617.62,-1010 6406.5,-1010 6406.5,-1010 6406.5,-1010 6406.5,-745.4 6406.5,-745.4"/>
<polygon fill="black" stroke="black" points="6410,-745.4 6406.5,-735.4 6403,-745.4 6410,-745.4"/>
<text text-anchor="middle" x="5747.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_14 -->
<g id="edge449" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3745.91,-913C3980.52,-913 4306.5,-913 4306.5,-913 4306.5,-913 4306.5,-745.2 4306.5,-745.2"/>
<polygon fill="black" stroke="black" points="4310,-745.2 4306.5,-735.2 4303,-745.2 4310,-745.2"/>
<text text-anchor="middle" x="4023.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_15 -->
<g id="edge452" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3496.67,-893.93C3496.67,-893.93 3496.67,-745.49 3496.67,-745.49"/>
<polygon fill="black" stroke="black" points="3500.17,-745.49 3496.67,-735.49 3493.17,-745.49 3500.17,-745.49"/>
<text text-anchor="middle" x="3546.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_7_moe_agg&#45;&gt;layer_7_add_norm2 -->
<g id="edge455" class="edge">
<title>layer_7_moe_agg&#45;&gt;layer_7_add_norm2</title>
<path fill="none" stroke="black" d="M4000.13,-492C4491.05,-492 5810.5,-492 5810.5,-492 5810.5,-492 5810.5,-319.52 5810.5,-319.52"/>
<polygon fill="black" stroke="black" points="5814,-319.52 5810.5,-309.52 5807,-319.52 5814,-319.52"/>
</g>
<!-- layer_7_expert_0&#45;&gt;layer_7_moe_agg -->
<g id="edge409" class="edge">
<title>layer_7_expert_0&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M1877,-666.93C1877,-607.38 1877,-491 1877,-491 1877,-491 3627.61,-491 3627.61,-491"/>
<polygon fill="black" stroke="black" points="3627.61,-494.5 3637.61,-491 3627.61,-487.5 3627.61,-494.5"/>
</g>
<!-- layer_7_expert_1&#45;&gt;layer_7_moe_agg -->
<g id="edge412" class="edge">
<title>layer_7_expert_1&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M2297,-666.87C2297,-609.19 2297,-499 2297,-499 2297,-499 3627.68,-499 3627.68,-499"/>
<polygon fill="black" stroke="black" points="3627.68,-502.5 3637.68,-499 3627.68,-495.5 3627.68,-502.5"/>
</g>
<!-- layer_7_expert_2&#45;&gt;layer_7_moe_agg -->
<g id="edge415" class="edge">
<title>layer_7_expert_2&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M5237,-666.81C5237,-611.54 5237,-509 5237,-509 5237,-509 4010.03,-509 4010.03,-509"/>
<polygon fill="black" stroke="black" points="4010.03,-505.5 4000.03,-509 4010.03,-512.5 4010.03,-505.5"/>
</g>
<!-- layer_7_expert_3&#45;&gt;layer_7_moe_agg -->
<g id="edge418" class="edge">
<title>layer_7_expert_3&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M1037,-666.97C1037,-603.98 1037,-476 1037,-476 1037,-476 3627.81,-476 3627.81,-476"/>
<polygon fill="black" stroke="black" points="3627.81,-479.5 3637.81,-476 3627.81,-472.5 3627.81,-479.5"/>
</g>
<!-- layer_7_expert_4&#45;&gt;layer_7_moe_agg -->
<g id="edge421" class="edge">
<title>layer_7_expert_4&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M1457,-666.76C1457,-605.52 1457,-484 1457,-484 1457,-484 3627.58,-484 3627.58,-484"/>
<polygon fill="black" stroke="black" points="3627.58,-487.5 3637.58,-484 3627.58,-480.5 3627.58,-487.5"/>
</g>
<!-- layer_7_expert_5&#45;&gt;layer_7_moe_agg -->
<g id="edge424" class="edge">
<title>layer_7_expert_5&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M3898,-666.94C3898,-666.94 3898,-532.3 3898,-532.3"/>
<polygon fill="black" stroke="black" points="3901.5,-532.3 3898,-522.3 3894.5,-532.3 3901.5,-532.3"/>
</g>
<!-- layer_7_expert_6&#45;&gt;layer_7_moe_agg -->
<g id="edge427" class="edge">
<title>layer_7_expert_6&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M2717,-666.9C2717,-611.16 2717,-507 2717,-507 2717,-507 3627.95,-507 3627.95,-507"/>
<polygon fill="black" stroke="black" points="3627.95,-510.5 3637.95,-507 3627.95,-503.5 3627.95,-510.5"/>
</g>
<!-- layer_7_expert_7&#45;&gt;layer_7_moe_agg -->
<g id="edge430" class="edge">
<title>layer_7_expert_7&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M5629.5,-667C5629.5,-610.79 5629.5,-505 5629.5,-505 5629.5,-505 4010.05,-505 4010.05,-505"/>
<polygon fill="black" stroke="black" points="4010.05,-501.5 4000.05,-505 4010.05,-508.5 4010.05,-501.5"/>
</g>
<!-- layer_7_expert_8&#45;&gt;layer_7_moe_agg -->
<g id="edge433" class="edge">
<title>layer_7_expert_8&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M197,-667.01C197,-600.71 197,-461 197,-461 197,-461 3627.83,-461 3627.83,-461"/>
<polygon fill="black" stroke="black" points="3627.83,-464.5 3637.83,-461 3627.83,-457.5 3627.83,-464.5"/>
</g>
<!-- layer_7_expert_9&#45;&gt;layer_7_moe_agg -->
<g id="edge436" class="edge">
<title>layer_7_expert_9&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M6020.5,-667.04C6020.5,-609.65 6020.5,-500 6020.5,-500 6020.5,-500 4010.09,-500 4010.09,-500"/>
<polygon fill="black" stroke="black" points="4010.09,-496.5 4000.09,-500 4010.09,-503.5 4010.09,-496.5"/>
</g>
<!-- layer_7_expert_10&#45;&gt;layer_7_moe_agg -->
<g id="edge439" class="edge">
<title>layer_7_expert_10&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M4817,-667.09C4817,-612.87 4817,-513 4817,-513 4817,-513 4010.02,-513 4010.02,-513"/>
<polygon fill="black" stroke="black" points="4010.02,-509.5 4000.02,-513 4010.02,-516.5 4010.02,-509.5"/>
</g>
<!-- layer_7_expert_11&#45;&gt;layer_7_moe_agg -->
<g id="edge442" class="edge">
<title>layer_7_expert_11&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M617,-666.91C617,-602.33 617,-469 617,-469 617,-469 3627.96,-469 3627.96,-469"/>
<polygon fill="black" stroke="black" points="3627.96,-472.5 3637.96,-469 3627.96,-465.5 3627.96,-472.5"/>
</g>
<!-- layer_7_expert_12&#45;&gt;layer_7_moe_agg -->
<g id="edge445" class="edge">
<title>layer_7_expert_12&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M3137,-666.84C3137,-612.8 3137,-514 3137,-514 3137,-514 3627.58,-514 3627.58,-514"/>
<polygon fill="black" stroke="black" points="3627.58,-517.5 3637.58,-514 3627.58,-510.5 3627.58,-517.5"/>
</g>
<!-- layer_7_expert_13&#45;&gt;layer_7_moe_agg -->
<g id="edge448" class="edge">
<title>layer_7_expert_13&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M6497,-666.83C6497,-608.42 6497,-496 6497,-496 6497,-496 4010.18,-496 4010.18,-496"/>
<polygon fill="black" stroke="black" points="4010.18,-492.5 4000.18,-496 4010.18,-499.5 4010.18,-492.5"/>
</g>
<!-- layer_7_expert_14&#45;&gt;layer_7_moe_agg -->
<g id="edge451" class="edge">
<title>layer_7_expert_14&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M4397,-666.96C4397,-613.7 4397,-517 4397,-517 4397,-517 4010.3,-517 4010.3,-517"/>
<polygon fill="black" stroke="black" points="4010.3,-513.5 4000.3,-517 4010.3,-520.5 4010.3,-513.5"/>
</g>
<!-- layer_7_expert_15&#45;&gt;layer_7_moe_agg -->
<g id="edge454" class="edge">
<title>layer_7_expert_15&#45;&gt;layer_7_moe_agg</title>
<path fill="none" stroke="black" d="M3688,-666.94C3688,-666.94 3688,-532.3 3688,-532.3"/>
<polygon fill="black" stroke="black" points="3691.5,-532.3 3688,-522.3 3684.5,-532.3 3691.5,-532.3"/>
</g>
<!-- layer_0_mha -->
<g id="node186" class="node">
<title>layer_0_mha</title>
<polygon fill="lightblue" stroke="black" points="3711.5,-14384.17 3302.5,-14384.17 3302.5,-14316.17 3711.5,-14316.17 3711.5,-14384.17"/>
<text text-anchor="middle" x="3507" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 0</text>
<text text-anchor="middle" x="3507" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3507" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3507" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_1_mha -->
<g id="node187" class="node">
<title>layer_1_mha</title>
<polygon fill="lightblue" stroke="black" points="3244.5,-14384.17 2835.5,-14384.17 2835.5,-14316.17 3244.5,-14316.17 3244.5,-14384.17"/>
<text text-anchor="middle" x="3040" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 1</text>
<text text-anchor="middle" x="3040" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3040" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3040" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_2_mha -->
<g id="node188" class="node">
<title>layer_2_mha</title>
<polygon fill="lightblue" stroke="black" points="2777.5,-14384.17 2368.5,-14384.17 2368.5,-14316.17 2777.5,-14316.17 2777.5,-14384.17"/>
<text text-anchor="middle" x="2573" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 2</text>
<text text-anchor="middle" x="2573" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2573" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2573" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_3_mha -->
<g id="node189" class="node">
<title>layer_3_mha</title>
<polygon fill="lightblue" stroke="black" points="2310.5,-14384.17 1901.5,-14384.17 1901.5,-14316.17 2310.5,-14316.17 2310.5,-14384.17"/>
<text text-anchor="middle" x="2106" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 3</text>
<text text-anchor="middle" x="2106" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2106" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2106" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_4_mha -->
<g id="node190" class="node">
<title>layer_4_mha</title>
<polygon fill="lightblue" stroke="black" points="1842.5,-14384.17 1433.5,-14384.17 1433.5,-14316.17 1842.5,-14316.17 1842.5,-14384.17"/>
<text text-anchor="middle" x="1638" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 4</text>
<text text-anchor="middle" x="1638" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1638" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1638" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_5_mha -->
<g id="node191" class="node">
<title>layer_5_mha</title>
<polygon fill="lightblue" stroke="black" points="1373.5,-14384.17 964.5,-14384.17 964.5,-14316.17 1373.5,-14316.17 1373.5,-14384.17"/>
<text text-anchor="middle" x="1169" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 5</text>
<text text-anchor="middle" x="1169" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1169" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1169" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_6_mha -->
<g id="node192" class="node">
<title>layer_6_mha</title>
<polygon fill="lightblue" stroke="black" points="902.5,-14384.17 493.5,-14384.17 493.5,-14316.17 902.5,-14316.17 902.5,-14384.17"/>
<text text-anchor="middle" x="698" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 6</text>
<text text-anchor="middle" x="698" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="698" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="698" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layer_7_mha -->
<g id="node193" class="node">
<title>layer_7_mha</title>
<polygon fill="lightblue" stroke="black" points="427.5,-14384.17 18.5,-14384.17 18.5,-14316.17 427.5,-14316.17 427.5,-14384.17"/>
<text text-anchor="middle" x="223" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 7</text>
<text text-anchor="middle" x="223" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="223" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="223" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- comm_stage_0_1 -->
<g id="node194" class="node">
<title>comm_stage_0_1</title>
<ellipse fill="lightgray" stroke="black" cx="11130" cy="-14577.25" rx="135.11" ry="37.45"/>
<text text-anchor="middle" x="11130" y="-14588.55" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="11130" y="-14573.55" font-family="Times,serif" font-size="14.00">Stage 0  Stage 1</text>
<text text-anchor="middle" x="11130" y="-14558.55" font-family="Times,serif" font-size="14.00">GPU: 7  8</text>
</g>
<!-- layer_8_qkv -->
<g id="node195" class="node">
<title>layer_8_qkv</title>
<polygon fill="lightblue" stroke="black" points="11130.5,-14384.17 10721.5,-14384.17 10721.5,-14316.17 11130.5,-14316.17 11130.5,-14384.17"/>
<text text-anchor="middle" x="10926" y="-14368.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10926" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10926" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10926" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- comm_stage_0_1&#45;&gt;layer_8_qkv -->
<g id="edge457" class="edge">
<title>comm_stage_0_1&#45;&gt;layer_8_qkv</title>
<path fill="none" stroke="black" d="M11062.72,-14544.71C11062.72,-14544.71 11062.72,-14394.5 11062.72,-14394.5"/>
<polygon fill="black" stroke="black" points="11066.22,-14394.5 11062.72,-14384.5 11059.22,-14394.5 11066.22,-14394.5"/>
</g>
<!-- layer_8_add_norm1 -->
<g id="node198" class="node">
<title>layer_8_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="11101,-13745.17 10739,-13745.17 10739,-13677.17 11101,-13677.17 11101,-13745.17"/>
<text text-anchor="middle" x="10920" y="-13729.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10920" y="-13714.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10920" y="-13699.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10920" y="-13684.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- comm_stage_0_1&#45;&gt;layer_8_add_norm1 -->
<g id="edge461" class="edge">
<title>comm_stage_0_1&#45;&gt;layer_8_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11150.25,-14540.11C11150.25,-14377.69 11150.25,-13738 11150.25,-13738 11150.25,-13738 11111.14,-13738 11111.14,-13738"/>
<polygon fill="black" stroke="black" points="11111.14,-13734.5 11101.14,-13738 11111.14,-13741.5 11111.14,-13734.5"/>
<text text-anchor="middle" x="11248" y="-14133.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_8_attn -->
<g id="node196" class="node">
<title>layer_8_attn</title>
<polygon fill="lightblue" stroke="black" points="11102.5,-14171.17 10693.5,-14171.17 10693.5,-14103.17 11102.5,-14103.17 11102.5,-14171.17"/>
<text text-anchor="middle" x="10898" y="-14155.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10898" y="-14140.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10898" y="-14125.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10898" y="-14110.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_8_qkv&#45;&gt;layer_8_attn -->
<g id="edge458" class="edge">
<title>layer_8_qkv&#45;&gt;layer_8_attn</title>
<path fill="none" stroke="black" d="M10912,-14315.94C10912,-14315.94 10912,-14181.3 10912,-14181.3"/>
<polygon fill="black" stroke="black" points="10915.5,-14181.3 10912,-14171.3 10908.5,-14181.3 10915.5,-14181.3"/>
</g>
<!-- layer_8_proj -->
<g id="node197" class="node">
<title>layer_8_proj</title>
<polygon fill="lightblue" stroke="black" points="11113.5,-13958.17 10716.5,-13958.17 10716.5,-13890.17 11113.5,-13890.17 11113.5,-13958.17"/>
<text text-anchor="middle" x="10915" y="-13942.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="10915" y="-13927.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10915" y="-13912.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10915" y="-13897.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_8_attn&#45;&gt;layer_8_proj -->
<g id="edge459" class="edge">
<title>layer_8_attn&#45;&gt;layer_8_proj</title>
<path fill="none" stroke="black" d="M10909.5,-14102.94C10909.5,-14102.94 10909.5,-13968.3 10909.5,-13968.3"/>
<polygon fill="black" stroke="black" points="10913,-13968.3 10909.5,-13958.3 10906,-13968.3 10913,-13968.3"/>
</g>
<!-- layer_8_proj&#45;&gt;layer_8_add_norm1 -->
<g id="edge460" class="edge">
<title>layer_8_proj&#45;&gt;layer_8_add_norm1</title>
<path fill="none" stroke="black" d="M10920,-13889.94C10920,-13889.94 10920,-13755.3 10920,-13755.3"/>
<polygon fill="black" stroke="black" points="10923.5,-13755.3 10920,-13745.3 10916.5,-13755.3 10923.5,-13755.3"/>
</g>
<!-- layer_8_gate -->
<g id="node199" class="node">
<title>layer_8_gate</title>
<polygon fill="yellow" stroke="black" points="10860.73,-13532.17 10283.71,-13532.17 10135.27,-13396.17 10712.29,-13396.17 10860.73,-13532.17"/>
<text text-anchor="middle" x="10498" y="-13482.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="10498" y="-13467.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10498" y="-13452.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="10498" y="-13437.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_gate -->
<g id="edge462" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_gate</title>
<path fill="none" stroke="black" d="M10799.93,-13677.08C10799.93,-13677.08 10799.93,-13542.37 10799.93,-13542.37"/>
<polygon fill="black" stroke="black" points="10803.43,-13542.37 10799.93,-13532.37 10796.43,-13542.37 10803.43,-13542.37"/>
</g>
<!-- layer_8_moe_agg -->
<g id="node200" class="node">
<title>layer_8_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="11024,-13024.17 10662,-13024.17 10662,-12956.17 11024,-12956.17 11024,-13024.17"/>
<text text-anchor="middle" x="10843" y="-13008.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="10843" y="-12993.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10843" y="-12978.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10843" y="-12963.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_moe_agg -->
<g id="edge463" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M11101.12,-13683C11114.97,-13683 11123.7,-13683 11123.7,-13683 11123.7,-13683 11123.7,-13015 11123.7,-13015 11123.7,-13015 11034.34,-13015 11034.34,-13015"/>
<polygon fill="black" stroke="black" points="11034.34,-13011.5 11024.34,-13015 11034.34,-13018.5 11034.34,-13011.5"/>
</g>
<!-- layer_8_expert_0 -->
<g id="node201" class="node">
<title>layer_8_expert_0</title>
<polygon fill="lightblue" stroke="black" points="9012,-13237.17 8650,-13237.17 8650,-13169.17 9012,-13169.17 9012,-13237.17"/>
<text text-anchor="middle" x="8831" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8831" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_0 -->
<g id="edge465" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_0</title>
<path fill="none" stroke="black" d="M10738.64,-13726C10243.67,-13726 8906.33,-13726 8906.33,-13726 8906.33,-13726 8906.33,-13247.47 8906.33,-13247.47"/>
<polygon fill="black" stroke="black" points="8909.83,-13247.47 8906.33,-13237.47 8902.83,-13247.47 8909.83,-13247.47"/>
</g>
<!-- layer_8_expert_1 -->
<g id="node202" class="node">
<title>layer_8_expert_1</title>
<polygon fill="lightblue" stroke="black" points="9432,-13237.17 9070,-13237.17 9070,-13169.17 9432,-13169.17 9432,-13237.17"/>
<text text-anchor="middle" x="9251" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9251" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_1 -->
<g id="edge468" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_1</title>
<path fill="none" stroke="black" d="M10738.87,-13722C10327.4,-13722 9357.67,-13722 9357.67,-13722 9357.67,-13722 9357.67,-13247.21 9357.67,-13247.21"/>
<polygon fill="black" stroke="black" points="9361.17,-13247.21 9357.67,-13237.21 9354.17,-13247.21 9361.17,-13247.21"/>
</g>
<!-- layer_8_expert_2 -->
<g id="node203" class="node">
<title>layer_8_expert_2</title>
<polygon fill="lightblue" stroke="black" points="12372,-13237.17 12010,-13237.17 12010,-13169.17 12372,-13169.17 12372,-13237.17"/>
<text text-anchor="middle" x="12191" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12191" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_2 -->
<g id="edge471" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_2</title>
<path fill="none" stroke="black" d="M11101.28,-13711C11465.45,-13711 12251.33,-13711 12251.33,-13711 12251.33,-13711 12251.33,-13247.28 12251.33,-13247.28"/>
<polygon fill="black" stroke="black" points="12254.83,-13247.28 12251.33,-13237.28 12247.83,-13247.28 12254.83,-13247.28"/>
</g>
<!-- layer_8_expert_3 -->
<g id="node204" class="node">
<title>layer_8_expert_3</title>
<polygon fill="lightblue" stroke="black" points="8172,-13237.17 7810,-13237.17 7810,-13169.17 8172,-13169.17 8172,-13237.17"/>
<text text-anchor="middle" x="7991" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7991" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_3 -->
<g id="edge474" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_3</title>
<path fill="none" stroke="black" d="M10738.91,-13733C10101.95,-13733 8003,-13733 8003,-13733 8003,-13733 8003,-13247.52 8003,-13247.52"/>
<polygon fill="black" stroke="black" points="8006.5,-13247.52 8003,-13237.52 7999.5,-13247.52 8006.5,-13247.52"/>
</g>
<!-- layer_8_expert_4 -->
<g id="node205" class="node">
<title>layer_8_expert_4</title>
<polygon fill="lightblue" stroke="black" points="8592,-13237.17 8230,-13237.17 8230,-13169.17 8592,-13169.17 8592,-13237.17"/>
<text text-anchor="middle" x="8411" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8411" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_4 -->
<g id="edge477" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_4</title>
<path fill="none" stroke="black" d="M10738.74,-13730C10169.48,-13730 8455,-13730 8455,-13730 8455,-13730 8455,-13247.33 8455,-13247.33"/>
<polygon fill="black" stroke="black" points="8458.5,-13247.33 8455,-13237.33 8451.5,-13247.33 8458.5,-13247.33"/>
</g>
<!-- layer_8_expert_5 -->
<g id="node206" class="node">
<title>layer_8_expert_5</title>
<polygon fill="lightblue" stroke="black" points="11112,-13237.17 10750,-13237.17 10750,-13169.17 11112,-13169.17 11112,-13237.17"/>
<text text-anchor="middle" x="10931" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10931" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_5 -->
<g id="edge480" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_5</title>
<path fill="none" stroke="black" d="M11020.95,-13677.05C11020.95,-13677.05 11020.95,-13247.47 11020.95,-13247.47"/>
<polygon fill="black" stroke="black" points="11024.45,-13247.47 11020.95,-13237.47 11017.45,-13247.47 11024.45,-13247.47"/>
</g>
<!-- layer_8_expert_6 -->
<g id="node207" class="node">
<title>layer_8_expert_6</title>
<polygon fill="lightblue" stroke="black" points="9852,-13237.17 9490,-13237.17 9490,-13169.17 9852,-13169.17 9852,-13237.17"/>
<text text-anchor="middle" x="9671" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9671" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_6 -->
<g id="edge483" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_6</title>
<path fill="none" stroke="black" d="M10738.72,-13718C10423.81,-13718 9809,-13718 9809,-13718 9809,-13718 9809,-13247.34 9809,-13247.34"/>
<polygon fill="black" stroke="black" points="9812.5,-13247.34 9809,-13237.34 9805.5,-13247.34 9812.5,-13247.34"/>
</g>
<!-- layer_8_expert_7 -->
<g id="node208" class="node">
<title>layer_8_expert_7</title>
<polygon fill="lightblue" stroke="black" points="12792,-13237.17 12430,-13237.17 12430,-13169.17 12792,-13169.17 12792,-13237.17"/>
<text text-anchor="middle" x="12611" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12611" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_7 -->
<g id="edge486" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_7</title>
<path fill="none" stroke="black" d="M11101.24,-13717C11548.97,-13717 12671.33,-13717 12671.33,-13717 12671.33,-13717 12671.33,-13247.28 12671.33,-13247.28"/>
<polygon fill="black" stroke="black" points="12674.83,-13247.28 12671.33,-13237.28 12667.83,-13247.28 12674.83,-13247.28"/>
</g>
<!-- layer_8_expert_8 -->
<g id="node209" class="node">
<title>layer_8_expert_8</title>
<polygon fill="lightblue" stroke="black" points="7332,-13237.17 6970,-13237.17 6970,-13169.17 7332,-13169.17 7332,-13237.17"/>
<text text-anchor="middle" x="7151" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7151" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_8 -->
<g id="edge489" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_8</title>
<path fill="none" stroke="black" d="M10738.79,-13741C9979.89,-13741 7096.33,-13741 7096.33,-13741 7096.33,-13741 7096.33,-13247.22 7096.33,-13247.22"/>
<polygon fill="black" stroke="black" points="7099.83,-13247.22 7096.33,-13237.22 7092.83,-13247.22 7099.83,-13247.22"/>
</g>
<!-- layer_8_expert_9 -->
<g id="node210" class="node">
<title>layer_8_expert_9</title>
<polygon fill="lightblue" stroke="black" points="13212,-13237.17 12850,-13237.17 12850,-13169.17 13212,-13169.17 13212,-13237.17"/>
<text text-anchor="middle" x="13031" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="13031" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_9 -->
<g id="edge492" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_9</title>
<path fill="none" stroke="black" d="M11101.39,-13724C11623.25,-13724 13091.33,-13724 13091.33,-13724 13091.33,-13724 13091.33,-13247.34 13091.33,-13247.34"/>
<polygon fill="black" stroke="black" points="13094.83,-13247.34 13091.33,-13237.34 13087.83,-13247.34 13094.83,-13247.34"/>
</g>
<!-- layer_8_expert_10 -->
<g id="node211" class="node">
<title>layer_8_expert_10</title>
<polygon fill="lightblue" stroke="black" points="11952,-13237.17 11590,-13237.17 11590,-13169.17 11952,-13169.17 11952,-13237.17"/>
<text text-anchor="middle" x="11771" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="11771" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_10 -->
<g id="edge495" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_10</title>
<path fill="none" stroke="black" d="M11101.14,-13704C11366.91,-13704 11831.33,-13704 11831.33,-13704 11831.33,-13704 11831.33,-13247.2 11831.33,-13247.2"/>
<polygon fill="black" stroke="black" points="11834.83,-13247.2 11831.33,-13237.2 11827.83,-13247.2 11834.83,-13247.2"/>
</g>
<!-- layer_8_expert_11 -->
<g id="node212" class="node">
<title>layer_8_expert_11</title>
<polygon fill="lightblue" stroke="black" points="7752,-13237.17 7390,-13237.17 7390,-13169.17 7752,-13169.17 7752,-13237.17"/>
<text text-anchor="middle" x="7571" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7571" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_11 -->
<g id="edge498" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_11</title>
<path fill="none" stroke="black" d="M10738.83,-13737C10038.92,-13737 7550.33,-13737 7550.33,-13737 7550.33,-13737 7550.33,-13247.37 7550.33,-13247.37"/>
<polygon fill="black" stroke="black" points="7553.83,-13247.37 7550.33,-13237.37 7546.83,-13247.37 7553.83,-13247.37"/>
</g>
<!-- layer_8_expert_12 -->
<g id="node213" class="node">
<title>layer_8_expert_12</title>
<polygon fill="lightblue" stroke="black" points="10272,-13237.17 9910,-13237.17 9910,-13169.17 10272,-13169.17 10272,-13237.17"/>
<text text-anchor="middle" x="10091" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10091" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_12 -->
<g id="edge501" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_12</title>
<path fill="none" stroke="black" d="M10738.93,-13714C10476.78,-13714 10022.57,-13714 10022.57,-13714 10022.57,-13714 10022.57,-13247.48 10022.57,-13247.48"/>
<polygon fill="black" stroke="black" points="10026.07,-13247.48 10022.57,-13237.48 10019.07,-13247.48 10026.07,-13247.48"/>
</g>
<!-- layer_8_expert_13 -->
<g id="node214" class="node">
<title>layer_8_expert_13</title>
<polygon fill="lightblue" stroke="black" points="13632,-13237.17 13270,-13237.17 13270,-13169.17 13632,-13169.17 13632,-13237.17"/>
<text text-anchor="middle" x="13451" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="13451" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_13 -->
<g id="edge504" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_13</title>
<path fill="none" stroke="black" d="M11101.19,-13731C11689.94,-13731 13511.33,-13731 13511.33,-13731 13511.33,-13731 13511.33,-13247.39 13511.33,-13247.39"/>
<polygon fill="black" stroke="black" points="13514.83,-13247.39 13511.33,-13237.39 13507.83,-13247.39 13514.83,-13247.39"/>
</g>
<!-- layer_8_expert_14 -->
<g id="node215" class="node">
<title>layer_8_expert_14</title>
<polygon fill="lightblue" stroke="black" points="11532,-13237.17 11170,-13237.17 11170,-13169.17 11532,-13169.17 11532,-13237.17"/>
<text text-anchor="middle" x="11351" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11351" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_14 -->
<g id="edge507" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_14</title>
<path fill="none" stroke="black" d="M11101.38,-13697C11170.68,-13697 11233.37,-13697 11233.37,-13697 11233.37,-13697 11233.37,-13247.5 11233.37,-13247.5"/>
<polygon fill="black" stroke="black" points="11236.87,-13247.5 11233.37,-13237.5 11229.87,-13247.5 11236.87,-13247.5"/>
</g>
<!-- layer_8_expert_15 -->
<g id="node216" class="node">
<title>layer_8_expert_15</title>
<polygon fill="lightblue" stroke="black" points="10692,-13237.17 10330,-13237.17 10330,-13169.17 10692,-13169.17 10692,-13237.17"/>
<text text-anchor="middle" x="10511" y="-13221.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="10511" y="-13206.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-13191.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-13176.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_expert_15 -->
<g id="edge510" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_expert_15</title>
<path fill="none" stroke="black" d="M10940.91,-13676.86C10940.91,-13585.46 10940.91,-13343 10940.91,-13343 10940.91,-13343 10571.33,-13343 10571.33,-13343 10571.33,-13343 10571.33,-13247.37 10571.33,-13247.37"/>
<polygon fill="black" stroke="black" points="10574.83,-13247.37 10571.33,-13237.37 10567.83,-13247.37 10574.83,-13247.37"/>
</g>
<!-- layer_8_add_norm2 -->
<g id="node217" class="node">
<title>layer_8_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="11075,-12811.17 10713,-12811.17 10713,-12743.17 11075,-12743.17 11075,-12811.17"/>
<text text-anchor="middle" x="10894" y="-12795.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10894" y="-12780.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10894" y="-12765.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10894" y="-12750.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_8_add_norm1&#45;&gt;layer_8_add_norm2 -->
<g id="edge513" class="edge">
<title>layer_8_add_norm1&#45;&gt;layer_8_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11101.03,-13690C11115.92,-13690 11125.4,-13690 11125.4,-13690 11125.4,-13690 11125.4,-12777 11125.4,-12777 11125.4,-12777 11085.19,-12777 11085.19,-12777"/>
<polygon fill="black" stroke="black" points="11085.19,-12773.5 11075.19,-12777 11085.19,-12780.5 11085.19,-12773.5"/>
<text text-anchor="middle" x="13837" y="-13199.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_0 -->
<g id="edge464" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10187.06,-13444C9737.48,-13444 8959.17,-13444 8959.17,-13444 8959.17,-13444 8959.17,-13247.42 8959.17,-13247.42"/>
<polygon fill="black" stroke="black" points="8962.67,-13247.42 8959.17,-13237.42 8955.67,-13247.42 8962.67,-13247.42"/>
<text text-anchor="middle" x="9612.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_1 -->
<g id="edge467" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10166.64,-13425C9841.73,-13425 9394.83,-13425 9394.83,-13425 9394.83,-13425 9394.83,-13247.34 9394.83,-13247.34"/>
<polygon fill="black" stroke="black" points="9398.33,-13247.34 9394.83,-13237.34 9391.33,-13247.34 9398.33,-13247.34"/>
<text text-anchor="middle" x="9969.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_2 -->
<g id="edge470" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10775.42,-13454C11241.36,-13454 12130.67,-13454 12130.67,-13454 12130.67,-13454 12130.67,-13247.26 12130.67,-13247.26"/>
<polygon fill="black" stroke="black" points="12134.17,-13247.26 12130.67,-13237.26 12127.17,-13247.26 12134.17,-13247.26"/>
<text text-anchor="middle" x="11555.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_3 -->
<g id="edge473" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10229.95,-13483C9601.82,-13483 8087.5,-13483 8087.5,-13483 8087.5,-13483 8087.5,-13247.2 8087.5,-13247.2"/>
<polygon fill="black" stroke="black" points="8091,-13247.2 8087.5,-13237.2 8084,-13247.2 8091,-13247.2"/>
<text text-anchor="middle" x="9065.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_4 -->
<g id="edge476" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10209.31,-13464C9661.07,-13464 8523.5,-13464 8523.5,-13464 8523.5,-13464 8523.5,-13247.27 8523.5,-13247.27"/>
<polygon fill="black" stroke="black" points="8527,-13247.27 8523.5,-13237.27 8520,-13247.27 8527,-13247.27"/>
<text text-anchor="middle" x="9271.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_5 -->
<g id="edge479" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10805.43,-13464.12C10805.43,-13464.12 10805.43,-13247.33 10805.43,-13247.33"/>
<polygon fill="black" stroke="black" points="10808.93,-13247.33 10805.43,-13237.33 10801.93,-13247.33 10808.93,-13247.33"/>
<text text-anchor="middle" x="10767.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_6 -->
<g id="edge482" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10144.7,-13405C9984.59,-13405 9830.5,-13405 9830.5,-13405 9830.5,-13405 9830.5,-13247.4 9830.5,-13247.4"/>
<polygon fill="black" stroke="black" points="9834,-13247.4 9830.5,-13237.4 9827,-13247.4 9834,-13247.4"/>
<text text-anchor="middle" x="10229.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_7 -->
<g id="edge485" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10796.2,-13473C11365.4,-13473 12550.67,-13473 12550.67,-13473 12550.67,-13473 12550.67,-13247.34 12550.67,-13247.34"/>
<polygon fill="black" stroke="black" points="12554.17,-13247.34 12550.67,-13237.34 12547.17,-13247.34 12554.17,-13247.34"/>
<text text-anchor="middle" x="11954.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_8 -->
<g id="edge488" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10272.61,-13522C9531.05,-13522 7214.17,-13522 7214.17,-13522 7214.17,-13522 7214.17,-13247.29 7214.17,-13247.29"/>
<polygon fill="black" stroke="black" points="7217.67,-13247.29 7214.17,-13237.29 7210.67,-13247.29 7217.67,-13247.29"/>
<text text-anchor="middle" x="8274.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_9 -->
<g id="edge491" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10818.09,-13493C11486.83,-13493 12970.67,-13493 12970.67,-13493 12970.67,-13493 12970.67,-13247.27 12970.67,-13247.27"/>
<polygon fill="black" stroke="black" points="12974.17,-13247.27 12970.67,-13237.27 12967.17,-13247.27 12974.17,-13247.27"/>
<text text-anchor="middle" x="12267.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_10 -->
<g id="edge494" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10754.8,-13435C11110.73,-13435 11710.67,-13435 11710.67,-13435 11710.67,-13435 11710.67,-13247.37 11710.67,-13247.37"/>
<polygon fill="black" stroke="black" points="11714.17,-13247.37 11710.67,-13237.37 11707.17,-13247.37 11714.17,-13247.37"/>
<text text-anchor="middle" x="11219.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_11 -->
<g id="edge497" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10251.58,-13503C9560,-13503 7651.17,-13503 7651.17,-13503 7651.17,-13503 7651.17,-13247.27 7651.17,-13247.27"/>
<polygon fill="black" stroke="black" points="7654.67,-13247.27 7651.17,-13237.27 7647.67,-13247.27 7654.67,-13247.27"/>
<text text-anchor="middle" x="8744.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_12 -->
<g id="edge500" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10203.57,-13395.93C10203.57,-13395.93 10203.57,-13247.49 10203.57,-13247.49"/>
<polygon fill="black" stroke="black" points="10207.07,-13247.49 10203.57,-13237.49 10200.07,-13247.49 10207.07,-13247.49"/>
<text text-anchor="middle" x="10381.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_13 -->
<g id="edge503" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10839.04,-13512C11604.09,-13512 13390.67,-13512 13390.67,-13512 13390.67,-13512 13390.67,-13247.4 13390.67,-13247.4"/>
<polygon fill="black" stroke="black" points="13394.17,-13247.4 13390.67,-13237.4 13387.17,-13247.4 13394.17,-13247.4"/>
<text text-anchor="middle" x="12461.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_14 -->
<g id="edge506" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10733.3,-13415C10937.86,-13415 11201.69,-13415 11201.69,-13415 11201.69,-13415 11201.69,-13247.2 11201.69,-13247.2"/>
<polygon fill="black" stroke="black" points="11205.19,-13247.2 11201.69,-13237.2 11198.19,-13247.2 11205.19,-13247.2"/>
<text text-anchor="middle" x="11010.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_15 -->
<g id="edge509" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10450.67,-13395.93C10450.67,-13395.93 10450.67,-13247.49 10450.67,-13247.49"/>
<polygon fill="black" stroke="black" points="10454.17,-13247.49 10450.67,-13237.49 10447.17,-13247.49 10454.17,-13247.49"/>
<text text-anchor="middle" x="10528.5" y="-13312.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_8_moe_agg&#45;&gt;layer_8_add_norm2 -->
<g id="edge512" class="edge">
<title>layer_8_moe_agg&#45;&gt;layer_8_add_norm2</title>
<path fill="none" stroke="black" d="M10868.5,-12955.94C10868.5,-12955.94 10868.5,-12821.3 10868.5,-12821.3"/>
<polygon fill="black" stroke="black" points="10872,-12821.3 10868.5,-12811.3 10865,-12821.3 10872,-12821.3"/>
</g>
<!-- layer_8_expert_0&#45;&gt;layer_8_moe_agg -->
<g id="edge466" class="edge">
<title>layer_8_expert_0&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M8831,-13169C8831,-13112.79 8831,-13007 8831,-13007 8831,-13007 10651.79,-13007 10651.79,-13007"/>
<polygon fill="black" stroke="black" points="10651.79,-13010.5 10661.79,-13007 10651.79,-13003.5 10651.79,-13010.5"/>
</g>
<!-- layer_8_expert_1&#45;&gt;layer_8_moe_agg -->
<g id="edge469" class="edge">
<title>layer_8_expert_1&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M9251,-13168.81C9251,-13113.54 9251,-13011 9251,-13011 9251,-13011 10651.93,-13011 10651.93,-13011"/>
<polygon fill="black" stroke="black" points="10651.93,-13014.5 10661.93,-13011 10651.93,-13007.5 10651.93,-13014.5"/>
</g>
<!-- layer_8_expert_2&#45;&gt;layer_8_moe_agg -->
<g id="edge472" class="edge">
<title>layer_8_expert_2&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M12191,-13168.92C12191,-13108.66 12191,-12990 12191,-12990 12191,-12990 11034.1,-12990 11034.1,-12990"/>
<polygon fill="black" stroke="black" points="11034.1,-12986.5 11024.1,-12990 11034.1,-12993.5 11034.1,-12986.5"/>
</g>
<!-- layer_8_expert_3&#45;&gt;layer_8_moe_agg -->
<g id="edge475" class="edge">
<title>layer_8_expert_3&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M7991,-13168.83C7991,-13110.42 7991,-12998 7991,-12998 7991,-12998 10651.89,-12998 10651.89,-12998"/>
<polygon fill="black" stroke="black" points="10651.89,-13001.5 10661.89,-12998 10651.89,-12994.5 10651.89,-13001.5"/>
</g>
<!-- layer_8_expert_4&#45;&gt;layer_8_moe_agg -->
<g id="edge478" class="edge">
<title>layer_8_expert_4&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M8411,-13169.04C8411,-13111.65 8411,-13002 8411,-13002 8411,-13002 10651.7,-13002 10651.7,-13002"/>
<polygon fill="black" stroke="black" points="10651.7,-13005.5 10661.7,-13002 10651.7,-12998.5 10651.7,-13005.5"/>
</g>
<!-- layer_8_expert_5&#45;&gt;layer_8_moe_agg -->
<g id="edge481" class="edge">
<title>layer_8_expert_5&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M10887,-13168.94C10887,-13168.94 10887,-13034.3 10887,-13034.3"/>
<polygon fill="black" stroke="black" points="10890.5,-13034.3 10887,-13024.3 10883.5,-13034.3 10890.5,-13034.3"/>
</g>
<!-- layer_8_expert_6&#45;&gt;layer_8_moe_agg -->
<g id="edge484" class="edge">
<title>layer_8_expert_6&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M9671,-13169.09C9671,-13114.87 9671,-13015 9671,-13015 9671,-13015 10651.8,-13015 10651.8,-13015"/>
<polygon fill="black" stroke="black" points="10651.8,-13018.5 10661.8,-13015 10651.8,-13011.5 10651.8,-13018.5"/>
</g>
<!-- layer_8_expert_7&#45;&gt;layer_8_moe_agg -->
<g id="edge487" class="edge">
<title>layer_8_expert_7&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M12611,-13168.94C12611,-13106.62 12611,-12981 12611,-12981 12611,-12981 11034.31,-12981 11034.31,-12981"/>
<polygon fill="black" stroke="black" points="11034.31,-12977.5 11024.31,-12981 11034.31,-12984.5 11034.31,-12977.5"/>
</g>
<!-- layer_8_expert_8&#45;&gt;layer_8_moe_agg -->
<g id="edge490" class="edge">
<title>layer_8_expert_8&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M7151,-13168.92C7151,-13108.66 7151,-12990 7151,-12990 7151,-12990 10651.8,-12990 10651.8,-12990"/>
<polygon fill="black" stroke="black" points="10651.8,-12993.5 10661.8,-12990 10651.8,-12986.5 10651.8,-12993.5"/>
</g>
<!-- layer_8_expert_9&#45;&gt;layer_8_moe_agg -->
<g id="edge493" class="edge">
<title>layer_8_expert_9&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M13031,-13168.71C13031,-13104.5 13031,-12973 13031,-12973 13031,-12973 11034.38,-12973 11034.38,-12973"/>
<polygon fill="black" stroke="black" points="11034.38,-12969.5 11024.38,-12973 11034.38,-12976.5 11034.38,-12969.5"/>
</g>
<!-- layer_8_expert_10&#45;&gt;layer_8_moe_agg -->
<g id="edge496" class="edge">
<title>layer_8_expert_10&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M11861.5,-13168.83C11861.5,-13110.42 11861.5,-12998 11861.5,-12998 11861.5,-12998 11034.21,-12998 11034.21,-12998"/>
<polygon fill="black" stroke="black" points="11034.21,-12994.5 11024.21,-12998 11034.21,-13001.5 11034.21,-12994.5"/>
</g>
<!-- layer_8_expert_11&#45;&gt;layer_8_moe_agg -->
<g id="edge499" class="edge">
<title>layer_8_expert_11&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M7571,-13169.09C7571,-13109.82 7571,-12994 7571,-12994 7571,-12994 10651.84,-12994 10651.84,-12994"/>
<polygon fill="black" stroke="black" points="10651.84,-12997.5 10661.84,-12994 10651.84,-12990.5 10651.84,-12997.5"/>
</g>
<!-- layer_8_expert_12&#45;&gt;layer_8_moe_agg -->
<g id="edge502" class="edge">
<title>layer_8_expert_12&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M10209.57,-13168.96C10209.57,-13115.7 10209.57,-13019 10209.57,-13019 10209.57,-13019 10651.91,-13019 10651.91,-13019"/>
<polygon fill="black" stroke="black" points="10651.91,-13022.5 10661.91,-13019 10651.91,-13015.5 10651.91,-13022.5"/>
</g>
<!-- layer_8_expert_13&#45;&gt;layer_8_moe_agg -->
<g id="edge505" class="edge">
<title>layer_8_expert_13&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M13451,-13169.15C13451,-13103.12 13451,-12964 13451,-12964 13451,-12964 11034.06,-12964 11034.06,-12964"/>
<polygon fill="black" stroke="black" points="11034.06,-12960.5 11024.06,-12964 11034.06,-12967.5 11034.06,-12960.5"/>
</g>
<!-- layer_8_expert_14&#45;&gt;layer_8_moe_agg -->
<g id="edge508" class="edge">
<title>layer_8_expert_14&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M11441.5,-13169C11441.5,-13112.79 11441.5,-13007 11441.5,-13007 11441.5,-13007 11034.19,-13007 11034.19,-13007"/>
<polygon fill="black" stroke="black" points="11034.19,-13003.5 11024.19,-13007 11034.19,-13010.5 11034.19,-13003.5"/>
</g>
<!-- layer_8_expert_15&#45;&gt;layer_8_moe_agg -->
<g id="edge511" class="edge">
<title>layer_8_expert_15&#45;&gt;layer_8_moe_agg</title>
<path fill="none" stroke="black" d="M10677,-13168.94C10677,-13168.94 10677,-13034.3 10677,-13034.3"/>
<polygon fill="black" stroke="black" points="10680.5,-13034.3 10677,-13024.3 10673.5,-13034.3 10680.5,-13034.3"/>
</g>
<!-- layer_9_qkv -->
<g id="node218" class="node">
<title>layer_9_qkv</title>
<polygon fill="lightblue" stroke="black" points="10911.5,-12598.17 10502.5,-12598.17 10502.5,-12530.17 10911.5,-12530.17 10911.5,-12598.17"/>
<text text-anchor="middle" x="10707" y="-12582.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10707" y="-12567.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10707" y="-12552.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10707" y="-12537.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_8_add_norm2&#45;&gt;layer_9_qkv -->
<g id="edge514" class="edge">
<title>layer_8_add_norm2&#45;&gt;layer_9_qkv</title>
<path fill="none" stroke="black" d="M10812.25,-12742.94C10812.25,-12742.94 10812.25,-12608.3 10812.25,-12608.3"/>
<polygon fill="black" stroke="black" points="10815.75,-12608.3 10812.25,-12598.3 10808.75,-12608.3 10815.75,-12608.3"/>
</g>
<!-- layer_9_add_norm1 -->
<g id="node221" class="node">
<title>layer_9_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="11113,-11959.17 10751,-11959.17 10751,-11891.17 11113,-11891.17 11113,-11959.17"/>
<text text-anchor="middle" x="10932" y="-11943.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10932" y="-11928.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10932" y="-11913.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10932" y="-11898.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_8_add_norm2&#45;&gt;layer_9_add_norm1 -->
<g id="edge518" class="edge">
<title>layer_8_add_norm2&#45;&gt;layer_9_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10993.25,-12742.98C10993.25,-12742.98 10993.25,-11969.62 10993.25,-11969.62"/>
<polygon fill="black" stroke="black" points="10996.75,-11969.62 10993.25,-11959.62 10989.75,-11969.62 10996.75,-11969.62"/>
<text text-anchor="middle" x="11028" y="-12347.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_9_attn -->
<g id="node219" class="node">
<title>layer_9_attn</title>
<polygon fill="lightblue" stroke="black" points="10882.5,-12385.17 10473.5,-12385.17 10473.5,-12317.17 10882.5,-12317.17 10882.5,-12385.17"/>
<text text-anchor="middle" x="10678" y="-12369.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10678" y="-12354.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10678" y="-12339.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10678" y="-12324.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_9_qkv&#45;&gt;layer_9_attn -->
<g id="edge515" class="edge">
<title>layer_9_qkv&#45;&gt;layer_9_attn</title>
<path fill="none" stroke="black" d="M10692.5,-12529.94C10692.5,-12529.94 10692.5,-12395.3 10692.5,-12395.3"/>
<polygon fill="black" stroke="black" points="10696,-12395.3 10692.5,-12385.3 10689,-12395.3 10696,-12395.3"/>
</g>
<!-- layer_9_proj -->
<g id="node220" class="node">
<title>layer_9_proj</title>
<polygon fill="lightblue" stroke="black" points="10908.5,-12172.17 10511.5,-12172.17 10511.5,-12104.17 10908.5,-12104.17 10908.5,-12172.17"/>
<text text-anchor="middle" x="10710" y="-12156.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="10710" y="-12141.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10710" y="-12126.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10710" y="-12111.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_9_attn&#45;&gt;layer_9_proj -->
<g id="edge516" class="edge">
<title>layer_9_attn&#45;&gt;layer_9_proj</title>
<path fill="none" stroke="black" d="M10697,-12316.94C10697,-12316.94 10697,-12182.3 10697,-12182.3"/>
<polygon fill="black" stroke="black" points="10700.5,-12182.3 10697,-12172.3 10693.5,-12182.3 10700.5,-12182.3"/>
</g>
<!-- layer_9_proj&#45;&gt;layer_9_add_norm1 -->
<g id="edge517" class="edge">
<title>layer_9_proj&#45;&gt;layer_9_add_norm1</title>
<path fill="none" stroke="black" d="M10829.75,-12103.94C10829.75,-12103.94 10829.75,-11969.3 10829.75,-11969.3"/>
<polygon fill="black" stroke="black" points="10833.25,-11969.3 10829.75,-11959.3 10826.25,-11969.3 10833.25,-11969.3"/>
</g>
<!-- layer_9_gate -->
<g id="node222" class="node">
<title>layer_9_gate</title>
<polygon fill="yellow" stroke="black" points="10872.73,-11746.17 10295.71,-11746.17 10147.27,-11610.17 10724.29,-11610.17 10872.73,-11746.17"/>
<text text-anchor="middle" x="10510" y="-11696.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="10510" y="-11681.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10510" y="-11666.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="10510" y="-11651.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_gate -->
<g id="edge519" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_gate</title>
<path fill="none" stroke="black" d="M10811.93,-11891.08C10811.93,-11891.08 10811.93,-11756.37 10811.93,-11756.37"/>
<polygon fill="black" stroke="black" points="10815.43,-11756.37 10811.93,-11746.37 10808.43,-11756.37 10815.43,-11756.37"/>
</g>
<!-- layer_9_moe_agg -->
<g id="node223" class="node">
<title>layer_9_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="11052,-11238.17 10690,-11238.17 10690,-11170.17 11052,-11170.17 11052,-11238.17"/>
<text text-anchor="middle" x="10871" y="-11222.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="10871" y="-11207.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10871" y="-11192.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10871" y="-11177.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_moe_agg -->
<g id="edge520" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M11113.07,-11898C11121.85,-11898 11127.1,-11898 11127.1,-11898 11127.1,-11898 11127.1,-11229 11127.1,-11229 11127.1,-11229 11062.34,-11229 11062.34,-11229"/>
<polygon fill="black" stroke="black" points="11062.34,-11225.5 11052.34,-11229 11062.34,-11232.5 11062.34,-11225.5"/>
</g>
<!-- layer_9_expert_0 -->
<g id="node224" class="node">
<title>layer_9_expert_0</title>
<polygon fill="lightblue" stroke="black" points="9012,-11451.17 8650,-11451.17 8650,-11383.17 9012,-11383.17 9012,-11451.17"/>
<text text-anchor="middle" x="8831" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8831" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_0 -->
<g id="edge522" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_0</title>
<path fill="none" stroke="black" d="M10750.8,-11929C10225.74,-11929 8740.5,-11929 8740.5,-11929 8740.5,-11929 8740.5,-11461.54 8740.5,-11461.54"/>
<polygon fill="black" stroke="black" points="8744,-11461.54 8740.5,-11451.54 8737,-11461.54 8744,-11461.54"/>
</g>
<!-- layer_9_expert_1 -->
<g id="node225" class="node">
<title>layer_9_expert_1</title>
<polygon fill="lightblue" stroke="black" points="9432,-11451.17 9070,-11451.17 9070,-11383.17 9432,-11383.17 9432,-11451.17"/>
<text text-anchor="middle" x="9251" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9251" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_1 -->
<g id="edge525" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_1</title>
<path fill="none" stroke="black" d="M10750.74,-11920C10299.25,-11920 9160.5,-11920 9160.5,-11920 9160.5,-11920 9160.5,-11461.33 9160.5,-11461.33"/>
<polygon fill="black" stroke="black" points="9164,-11461.33 9160.5,-11451.33 9157,-11461.33 9164,-11461.33"/>
</g>
<!-- layer_9_expert_2 -->
<g id="node226" class="node">
<title>layer_9_expert_2</title>
<polygon fill="lightblue" stroke="black" points="12372,-11451.17 12010,-11451.17 12010,-11383.17 12372,-11383.17 12372,-11451.17"/>
<text text-anchor="middle" x="12191" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12191" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_2 -->
<g id="edge528" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_2</title>
<path fill="none" stroke="black" d="M11113.3,-11928C11481.34,-11928 12281.5,-11928 12281.5,-11928 12281.5,-11928 12281.5,-11461.48 12281.5,-11461.48"/>
<polygon fill="black" stroke="black" points="12285,-11461.48 12281.5,-11451.48 12278,-11461.48 12285,-11461.48"/>
</g>
<!-- layer_9_expert_3 -->
<g id="node227" class="node">
<title>layer_9_expert_3</title>
<polygon fill="lightblue" stroke="black" points="8172,-11451.17 7810,-11451.17 7810,-11383.17 8172,-11383.17 8172,-11451.17"/>
<text text-anchor="middle" x="7991" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7991" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_3 -->
<g id="edge531" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_3</title>
<path fill="none" stroke="black" d="M10750.88,-11946C10097.56,-11946 7900.5,-11946 7900.5,-11946 7900.5,-11946 7900.5,-11461.46 7900.5,-11461.46"/>
<polygon fill="black" stroke="black" points="7904,-11461.46 7900.5,-11451.46 7897,-11461.46 7904,-11461.46"/>
</g>
<!-- layer_9_expert_4 -->
<g id="node228" class="node">
<title>layer_9_expert_4</title>
<polygon fill="lightblue" stroke="black" points="8592,-11451.17 8230,-11451.17 8230,-11383.17 8592,-11383.17 8592,-11451.17"/>
<text text-anchor="middle" x="8411" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8411" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_4 -->
<g id="edge534" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_4</title>
<path fill="none" stroke="black" d="M10750.95,-11937C10159.28,-11937 8320.5,-11937 8320.5,-11937 8320.5,-11937 8320.5,-11461.27 8320.5,-11461.27"/>
<polygon fill="black" stroke="black" points="8324,-11461.27 8320.5,-11451.27 8317,-11461.27 8324,-11461.27"/>
</g>
<!-- layer_9_expert_5 -->
<g id="node229" class="node">
<title>layer_9_expert_5</title>
<polygon fill="lightblue" stroke="black" points="11112,-11451.17 10750,-11451.17 10750,-11383.17 11112,-11383.17 11112,-11451.17"/>
<text text-anchor="middle" x="10931" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10931" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_5 -->
<g id="edge537" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_5</title>
<path fill="none" stroke="black" d="M11032.29,-11891.05C11032.29,-11891.05 11032.29,-11461.47 11032.29,-11461.47"/>
<polygon fill="black" stroke="black" points="11035.79,-11461.47 11032.29,-11451.47 11028.79,-11461.47 11035.79,-11461.47"/>
</g>
<!-- layer_9_expert_6 -->
<g id="node230" class="node">
<title>layer_9_expert_6</title>
<polygon fill="lightblue" stroke="black" points="9852,-11451.17 9490,-11451.17 9490,-11383.17 9852,-11383.17 9852,-11451.17"/>
<text text-anchor="middle" x="9671" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9671" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_6 -->
<g id="edge540" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_6</title>
<path fill="none" stroke="black" d="M10750.78,-11912C10382.35,-11912 9580.5,-11912 9580.5,-11912 9580.5,-11912 9580.5,-11461.18 9580.5,-11461.18"/>
<polygon fill="black" stroke="black" points="9584,-11461.18 9580.5,-11451.18 9577,-11461.18 9584,-11461.18"/>
</g>
<!-- layer_9_expert_7 -->
<g id="node231" class="node">
<title>layer_9_expert_7</title>
<polygon fill="lightblue" stroke="black" points="12792,-11451.17 12430,-11451.17 12430,-11383.17 12792,-11383.17 12792,-11451.17"/>
<text text-anchor="middle" x="12611" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12611" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_7 -->
<g id="edge543" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_7</title>
<path fill="none" stroke="black" d="M11113.05,-11936C11564.04,-11936 12701.5,-11936 12701.5,-11936 12701.5,-11936 12701.5,-11461.21 12701.5,-11461.21"/>
<polygon fill="black" stroke="black" points="12705,-11461.21 12701.5,-11451.21 12698,-11461.21 12705,-11461.21"/>
</g>
<!-- layer_9_expert_8 -->
<g id="node232" class="node">
<title>layer_9_expert_8</title>
<polygon fill="lightblue" stroke="black" points="7332,-11451.17 6970,-11451.17 6970,-11383.17 7332,-11383.17 7332,-11451.17"/>
<text text-anchor="middle" x="7151" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7151" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_8 -->
<g id="edge546" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_8</title>
<path fill="none" stroke="black" d="M10750.78,-11954C9985.87,-11954 7060.5,-11954 7060.5,-11954 7060.5,-11954 7060.5,-11461.56 7060.5,-11461.56"/>
<polygon fill="black" stroke="black" points="7064,-11461.56 7060.5,-11451.56 7057,-11461.56 7064,-11461.56"/>
</g>
<!-- layer_9_expert_9 -->
<g id="node233" class="node">
<title>layer_9_expert_9</title>
<polygon fill="lightblue" stroke="black" points="13212,-11451.17 12850,-11451.17 12850,-11383.17 13212,-11383.17 13212,-11451.17"/>
<text text-anchor="middle" x="13031" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="13031" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_9 -->
<g id="edge549" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_9</title>
<path fill="none" stroke="black" d="M11113.04,-11944C11637.62,-11944 13121.5,-11944 13121.5,-11944 13121.5,-11944 13121.5,-11461.33 13121.5,-11461.33"/>
<polygon fill="black" stroke="black" points="13125,-11461.33 13121.5,-11451.33 13118,-11461.33 13125,-11461.33"/>
</g>
<!-- layer_9_expert_10 -->
<g id="node234" class="node">
<title>layer_9_expert_10</title>
<polygon fill="lightblue" stroke="black" points="11952,-11451.17 11590,-11451.17 11590,-11383.17 11952,-11383.17 11952,-11451.17"/>
<text text-anchor="middle" x="11771" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="11771" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_10 -->
<g id="edge552" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_10</title>
<path fill="none" stroke="black" d="M11113.02,-11921C11359.66,-11921 11771,-11921 11771,-11921 11771,-11921 11771,-11461.4 11771,-11461.4"/>
<polygon fill="black" stroke="black" points="11774.5,-11461.4 11771,-11451.4 11767.5,-11461.4 11774.5,-11461.4"/>
</g>
<!-- layer_9_expert_11 -->
<g id="node235" class="node">
<title>layer_9_expert_11</title>
<polygon fill="lightblue" stroke="black" points="7752,-11451.17 7390,-11451.17 7390,-11383.17 7752,-11383.17 7752,-11451.17"/>
<text text-anchor="middle" x="7571" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7571" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_11 -->
<g id="edge555" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_11</title>
<path fill="none" stroke="black" d="M10750.99,-11950C10040.39,-11950 7480.5,-11950 7480.5,-11950 7480.5,-11950 7480.5,-11461.31 7480.5,-11461.31"/>
<polygon fill="black" stroke="black" points="7484,-11461.31 7480.5,-11451.31 7477,-11461.31 7484,-11461.31"/>
</g>
<!-- layer_9_expert_12 -->
<g id="node236" class="node">
<title>layer_9_expert_12</title>
<polygon fill="lightblue" stroke="black" points="10272,-11451.17 9910,-11451.17 9910,-11383.17 10272,-11383.17 10272,-11451.17"/>
<text text-anchor="middle" x="10091" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10091" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_12 -->
<g id="edge558" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_12</title>
<path fill="none" stroke="black" d="M10750.81,-11903C10487.08,-11903 10028.57,-11903 10028.57,-11903 10028.57,-11903 10028.57,-11461.33 10028.57,-11461.33"/>
<polygon fill="black" stroke="black" points="10032.07,-11461.33 10028.57,-11451.33 10025.07,-11461.33 10032.07,-11461.33"/>
</g>
<!-- layer_9_expert_13 -->
<g id="node237" class="node">
<title>layer_9_expert_13</title>
<polygon fill="lightblue" stroke="black" points="13632,-11451.17 13270,-11451.17 13270,-11383.17 13632,-11383.17 13632,-11451.17"/>
<text text-anchor="middle" x="13451" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="13451" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_13 -->
<g id="edge561" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_13</title>
<path fill="none" stroke="black" d="M11113.16,-11951C11704.67,-11951 13541.5,-11951 13541.5,-11951 13541.5,-11951 13541.5,-11461.37 13541.5,-11461.37"/>
<polygon fill="black" stroke="black" points="13545,-11461.37 13541.5,-11451.37 13538,-11461.37 13545,-11461.37"/>
</g>
<!-- layer_9_expert_14 -->
<g id="node238" class="node">
<title>layer_9_expert_14</title>
<polygon fill="lightblue" stroke="black" points="11532,-11451.17 11170,-11451.17 11170,-11383.17 11532,-11383.17 11532,-11451.17"/>
<text text-anchor="middle" x="11351" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11351" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_14 -->
<g id="edge564" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_14</title>
<path fill="none" stroke="black" d="M11113.04,-11913C11226.36,-11913 11351,-11913 11351,-11913 11351,-11913 11351,-11461.25 11351,-11461.25"/>
<polygon fill="black" stroke="black" points="11354.5,-11461.25 11351,-11451.25 11347.5,-11461.25 11354.5,-11461.25"/>
</g>
<!-- layer_9_expert_15 -->
<g id="node239" class="node">
<title>layer_9_expert_15</title>
<polygon fill="lightblue" stroke="black" points="10692,-11451.17 10330,-11451.17 10330,-11383.17 10692,-11383.17 10692,-11451.17"/>
<text text-anchor="middle" x="10511" y="-11435.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="10511" y="-11420.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-11405.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-11390.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_expert_15 -->
<g id="edge567" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_expert_15</title>
<path fill="none" stroke="black" d="M10952.58,-11891.11C10952.58,-11802.22 10952.58,-11570 10952.58,-11570 10952.58,-11570 10571.33,-11570 10571.33,-11570 10571.33,-11570 10571.33,-11461.47 10571.33,-11461.47"/>
<polygon fill="black" stroke="black" points="10574.83,-11461.47 10571.33,-11451.47 10567.83,-11461.47 10574.83,-11461.47"/>
</g>
<!-- layer_9_add_norm2 -->
<g id="node240" class="node">
<title>layer_9_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="11056,-11025.17 10694,-11025.17 10694,-10957.17 11056,-10957.17 11056,-11025.17"/>
<text text-anchor="middle" x="10875" y="-11009.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10875" y="-10994.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10875" y="-10979.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10875" y="-10964.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_9_add_norm1&#45;&gt;layer_9_add_norm2 -->
<g id="edge570" class="edge">
<title>layer_9_add_norm1&#45;&gt;layer_9_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11113.03,-11906C11122.85,-11906 11128.8,-11906 11128.8,-11906 11128.8,-11906 11128.8,-10991 11128.8,-10991 11128.8,-10991 11066.07,-10991 11066.07,-10991"/>
<polygon fill="black" stroke="black" points="11066.07,-10987.5 11056.07,-10991 11066.07,-10994.5 11066.07,-10987.5"/>
<text text-anchor="middle" x="13837" y="-11413.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_0 -->
<g id="edge521" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10199.48,-11658C9737.11,-11658 8921.5,-11658 8921.5,-11658 8921.5,-11658 8921.5,-11461.42 8921.5,-11461.42"/>
<polygon fill="black" stroke="black" points="8925,-11461.42 8921.5,-11451.42 8918,-11461.42 8925,-11461.42"/>
<text text-anchor="middle" x="9600.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_1 -->
<g id="edge524" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10178.67,-11639C9833.19,-11639 9341.5,-11639 9341.5,-11639 9341.5,-11639 9341.5,-11461.34 9341.5,-11461.34"/>
<polygon fill="black" stroke="black" points="9345,-11461.34 9341.5,-11451.34 9338,-11461.34 9345,-11461.34"/>
<text text-anchor="middle" x="9981.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_2 -->
<g id="edge527" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10787.5,-11668C11243.3,-11668 12100.5,-11668 12100.5,-11668 12100.5,-11668 12100.5,-11461.26 12100.5,-11461.26"/>
<polygon fill="black" stroke="black" points="12104,-11461.26 12100.5,-11451.26 12097,-11461.26 12104,-11461.26"/>
<text text-anchor="middle" x="11483.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_3 -->
<g id="edge530" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10242,-11697C9610.42,-11697 8081.5,-11697 8081.5,-11697 8081.5,-11697 8081.5,-11461.2 8081.5,-11461.2"/>
<polygon fill="black" stroke="black" points="8085,-11461.2 8081.5,-11451.2 8078,-11461.2 8085,-11461.2"/>
<text text-anchor="middle" x="8872.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_4 -->
<g id="edge533" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10221.16,-11678C9665.37,-11678 8501.5,-11678 8501.5,-11678 8501.5,-11678 8501.5,-11461.27 8501.5,-11461.27"/>
<polygon fill="black" stroke="black" points="8505,-11461.27 8501.5,-11451.27 8498,-11461.27 8505,-11461.27"/>
<text text-anchor="middle" x="9236.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_5 -->
<g id="edge536" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10811.43,-11678.12C10811.43,-11678.12 10811.43,-11461.33 10811.43,-11461.33"/>
<polygon fill="black" stroke="black" points="10814.93,-11461.33 10811.43,-11451.33 10807.93,-11461.33 10814.93,-11461.33"/>
<text text-anchor="middle" x="10776.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_6 -->
<g id="edge539" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10156.85,-11619C9962.96,-11619 9761.5,-11619 9761.5,-11619 9761.5,-11619 9761.5,-11461.4 9761.5,-11461.4"/>
<polygon fill="black" stroke="black" points="9765,-11461.4 9761.5,-11451.4 9758,-11461.4 9765,-11461.4"/>
<text text-anchor="middle" x="10241.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_7 -->
<g id="edge542" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10808.28,-11687C11368.14,-11687 12520.5,-11687 12520.5,-11687 12520.5,-11687 12520.5,-11461.34 12520.5,-11461.34"/>
<polygon fill="black" stroke="black" points="12524,-11461.34 12520.5,-11451.34 12517,-11461.34 12524,-11461.34"/>
<text text-anchor="middle" x="11924.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_8 -->
<g id="edge545" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10284.38,-11736C9544.89,-11736 7241.5,-11736 7241.5,-11736 7241.5,-11736 7241.5,-11461.29 7241.5,-11461.29"/>
<polygon fill="black" stroke="black" points="7245,-11461.29 7241.5,-11451.29 7238,-11461.29 7245,-11461.29"/>
<text text-anchor="middle" x="7995.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_9 -->
<g id="edge548" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10830.24,-11707C11490.23,-11707 12940.5,-11707 12940.5,-11707 12940.5,-11707 12940.5,-11461.27 12940.5,-11461.27"/>
<polygon fill="black" stroke="black" points="12944,-11461.27 12940.5,-11451.27 12937,-11461.27 12944,-11461.27"/>
<text text-anchor="middle" x="12371.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_10 -->
<g id="edge551" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10766.87,-11649C11111.43,-11649 11680.5,-11649 11680.5,-11649 11680.5,-11649 11680.5,-11461.37 11680.5,-11461.37"/>
<polygon fill="black" stroke="black" points="11684,-11461.37 11680.5,-11451.37 11677,-11461.37 11684,-11461.37"/>
<text text-anchor="middle" x="11231.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_11 -->
<g id="edge554" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10263.75,-11717C9572.02,-11717 7661.5,-11717 7661.5,-11717 7661.5,-11717 7661.5,-11461.27 7661.5,-11461.27"/>
<polygon fill="black" stroke="black" points="7665,-11461.27 7661.5,-11451.27 7658,-11461.27 7665,-11461.27"/>
<text text-anchor="middle" x="8340.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_12 -->
<g id="edge557" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10209.57,-11609.93C10209.57,-11609.93 10209.57,-11461.49 10209.57,-11461.49"/>
<polygon fill="black" stroke="black" points="10213.07,-11461.49 10209.57,-11451.49 10206.07,-11461.49 10213.07,-11461.49"/>
<text text-anchor="middle" x="10388.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_13 -->
<g id="edge560" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10851.01,-11726C11607.62,-11726 13360.5,-11726 13360.5,-11726 13360.5,-11726 13360.5,-11461.4 13360.5,-11461.4"/>
<polygon fill="black" stroke="black" points="13364,-11461.4 13360.5,-11451.4 13357,-11461.4 13364,-11461.4"/>
<text text-anchor="middle" x="12698.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_14 -->
<g id="edge563" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10744.89,-11629C10965.04,-11629 11260.5,-11629 11260.5,-11629 11260.5,-11629 11260.5,-11461.2 11260.5,-11461.2"/>
<polygon fill="black" stroke="black" points="11264,-11461.2 11260.5,-11451.2 11257,-11461.2 11264,-11461.2"/>
<text text-anchor="middle" x="11022.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_15 -->
<g id="edge566" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10450.67,-11609.93C10450.67,-11609.93 10450.67,-11461.49 10450.67,-11461.49"/>
<polygon fill="black" stroke="black" points="10454.17,-11461.49 10450.67,-11451.49 10447.17,-11461.49 10454.17,-11461.49"/>
<text text-anchor="middle" x="10536.5" y="-11526.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_9_moe_agg&#45;&gt;layer_9_add_norm2 -->
<g id="edge569" class="edge">
<title>layer_9_moe_agg&#45;&gt;layer_9_add_norm2</title>
<path fill="none" stroke="black" d="M10873,-11169.94C10873,-11169.94 10873,-11035.3 10873,-11035.3"/>
<polygon fill="black" stroke="black" points="10876.5,-11035.3 10873,-11025.3 10869.5,-11035.3 10876.5,-11035.3"/>
</g>
<!-- layer_9_expert_0&#45;&gt;layer_9_moe_agg -->
<g id="edge523" class="edge">
<title>layer_9_expert_0&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M8831,-11382.82C8831,-11326.33 8831,-11220 8831,-11220 8831,-11220 10679.96,-11220 10679.96,-11220"/>
<polygon fill="black" stroke="black" points="10679.96,-11223.5 10689.96,-11220 10679.96,-11216.5 10679.96,-11223.5"/>
</g>
<!-- layer_9_expert_1&#45;&gt;layer_9_moe_agg -->
<g id="edge526" class="edge">
<title>layer_9_expert_1&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M9251,-11383.08C9251,-11327.62 9251,-11224 9251,-11224 9251,-11224 10679.88,-11224 10679.88,-11224"/>
<polygon fill="black" stroke="black" points="10679.88,-11227.5 10689.88,-11224 10679.88,-11220.5 10679.88,-11227.5"/>
</g>
<!-- layer_9_expert_2&#45;&gt;layer_9_moe_agg -->
<g id="edge529" class="edge">
<title>layer_9_expert_2&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M12281.5,-11382.92C12281.5,-11322.66 12281.5,-11204 12281.5,-11204 12281.5,-11204 11062.15,-11204 11062.15,-11204"/>
<polygon fill="black" stroke="black" points="11062.15,-11200.5 11052.15,-11204 11062.15,-11207.5 11062.15,-11200.5"/>
</g>
<!-- layer_9_expert_3&#45;&gt;layer_9_moe_agg -->
<g id="edge532" class="edge">
<title>layer_9_expert_3&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M7900.5,-11382.96C7900.5,-11324.12 7900.5,-11210 7900.5,-11210 7900.5,-11210 10679.93,-11210 10679.93,-11210"/>
<polygon fill="black" stroke="black" points="10679.93,-11213.5 10689.93,-11210 10679.93,-11206.5 10679.93,-11213.5"/>
</g>
<!-- layer_9_expert_4&#45;&gt;layer_9_moe_agg -->
<g id="edge535" class="edge">
<title>layer_9_expert_4&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M8411,-11382.87C8411,-11325.19 8411,-11215 8411,-11215 8411,-11215 10679.61,-11215 10679.61,-11215"/>
<polygon fill="black" stroke="black" points="10679.61,-11218.5 10689.61,-11215 10679.61,-11211.5 10679.61,-11218.5"/>
</g>
<!-- layer_9_expert_5&#45;&gt;layer_9_moe_agg -->
<g id="edge538" class="edge">
<title>layer_9_expert_5&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M10901,-11382.94C10901,-11382.94 10901,-11248.3 10901,-11248.3"/>
<polygon fill="black" stroke="black" points="10904.5,-11248.3 10901,-11238.3 10897.5,-11248.3 10904.5,-11248.3"/>
</g>
<!-- layer_9_expert_6&#45;&gt;layer_9_moe_agg -->
<g id="edge541" class="edge">
<title>layer_9_expert_6&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M9671,-11383.09C9671,-11328.87 9671,-11229 9671,-11229 9671,-11229 10679.72,-11229 10679.72,-11229"/>
<polygon fill="black" stroke="black" points="10679.72,-11232.5 10689.72,-11229 10679.72,-11225.5 10679.72,-11232.5"/>
</g>
<!-- layer_9_expert_7&#45;&gt;layer_9_moe_agg -->
<g id="edge544" class="edge">
<title>layer_9_expert_7&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M12701.5,-11382.94C12701.5,-11320.62 12701.5,-11195 12701.5,-11195 12701.5,-11195 11062.37,-11195 11062.37,-11195"/>
<polygon fill="black" stroke="black" points="11062.37,-11191.5 11052.37,-11195 11062.37,-11198.5 11062.37,-11191.5"/>
</g>
<!-- layer_9_expert_8&#45;&gt;layer_9_moe_agg -->
<g id="edge547" class="edge">
<title>layer_9_expert_8&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M7060.5,-11382.91C7060.5,-11321.96 7060.5,-11201 7060.5,-11201 7060.5,-11201 10679.78,-11201 10679.78,-11201"/>
<polygon fill="black" stroke="black" points="10679.78,-11204.5 10689.78,-11201 10679.78,-11197.5 10679.78,-11204.5"/>
</g>
<!-- layer_9_expert_9&#45;&gt;layer_9_moe_agg -->
<g id="edge550" class="edge">
<title>layer_9_expert_9&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M13121.5,-11382.71C13121.5,-11318.5 13121.5,-11187 13121.5,-11187 13121.5,-11187 11062.31,-11187 11062.31,-11187"/>
<polygon fill="black" stroke="black" points="11062.31,-11183.5 11052.31,-11187 11062.31,-11190.5 11062.31,-11183.5"/>
</g>
<!-- layer_9_expert_10&#45;&gt;layer_9_moe_agg -->
<g id="edge553" class="edge">
<title>layer_9_expert_10&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M11861.5,-11382.83C11861.5,-11324.42 11861.5,-11212 11861.5,-11212 11861.5,-11212 11062.1,-11212 11062.1,-11212"/>
<polygon fill="black" stroke="black" points="11062.1,-11208.5 11052.1,-11212 11062.1,-11215.5 11062.1,-11208.5"/>
</g>
<!-- layer_9_expert_11&#45;&gt;layer_9_moe_agg -->
<g id="edge556" class="edge">
<title>layer_9_expert_11&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M7480.5,-11382.77C7480.5,-11322.93 7480.5,-11206 7480.5,-11206 7480.5,-11206 10679.91,-11206 10679.91,-11206"/>
<polygon fill="black" stroke="black" points="10679.91,-11209.5 10689.91,-11206 10679.91,-11202.5 10679.91,-11209.5"/>
</g>
<!-- layer_9_expert_12&#45;&gt;layer_9_moe_agg -->
<g id="edge559" class="edge">
<title>layer_9_expert_12&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M10160.07,-11382.96C10160.07,-11329.7 10160.07,-11233 10160.07,-11233 10160.07,-11233 10679.76,-11233 10679.76,-11233"/>
<polygon fill="black" stroke="black" points="10679.76,-11236.5 10689.76,-11233 10679.76,-11229.5 10679.76,-11236.5"/>
</g>
<!-- layer_9_expert_13&#45;&gt;layer_9_moe_agg -->
<g id="edge562" class="edge">
<title>layer_9_expert_13&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M13541.5,-11383.15C13541.5,-11317.12 13541.5,-11178 13541.5,-11178 13541.5,-11178 11062.19,-11178 11062.19,-11178"/>
<polygon fill="black" stroke="black" points="11062.19,-11174.5 11052.19,-11178 11062.19,-11181.5 11062.19,-11174.5"/>
</g>
<!-- layer_9_expert_14&#45;&gt;layer_9_moe_agg -->
<g id="edge565" class="edge">
<title>layer_9_expert_14&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M11441.5,-11383C11441.5,-11326.79 11441.5,-11221 11441.5,-11221 11441.5,-11221 11062.29,-11221 11062.29,-11221"/>
<polygon fill="black" stroke="black" points="11062.29,-11217.5 11052.29,-11221 11062.29,-11224.5 11062.29,-11217.5"/>
</g>
<!-- layer_9_expert_15&#45;&gt;layer_9_moe_agg -->
<g id="edge568" class="edge">
<title>layer_9_expert_15&#45;&gt;layer_9_moe_agg</title>
<path fill="none" stroke="black" d="M10692.24,-11417C10709.66,-11417 10721,-11417 10721,-11417 10721,-11417 10721,-11248.36 10721,-11248.36"/>
<polygon fill="black" stroke="black" points="10724.5,-11248.36 10721,-11238.36 10717.5,-11248.36 10724.5,-11248.36"/>
</g>
<!-- layer_10_qkv -->
<g id="node241" class="node">
<title>layer_10_qkv</title>
<polygon fill="lightblue" stroke="black" points="10793.5,-10812.17 10384.5,-10812.17 10384.5,-10744.17 10793.5,-10744.17 10793.5,-10812.17"/>
<text text-anchor="middle" x="10589" y="-10796.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10589" y="-10781.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10589" y="-10766.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10589" y="-10751.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_9_add_norm2&#45;&gt;layer_10_qkv -->
<g id="edge571" class="edge">
<title>layer_9_add_norm2&#45;&gt;layer_10_qkv</title>
<path fill="none" stroke="black" d="M10743.75,-10956.94C10743.75,-10956.94 10743.75,-10822.3 10743.75,-10822.3"/>
<polygon fill="black" stroke="black" points="10747.25,-10822.3 10743.75,-10812.3 10740.25,-10822.3 10747.25,-10822.3"/>
</g>
<!-- layer_10_add_norm1 -->
<g id="node244" class="node">
<title>layer_10_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="11014,-10173.17 10652,-10173.17 10652,-10105.17 11014,-10105.17 11014,-10173.17"/>
<text text-anchor="middle" x="10833" y="-10157.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10833" y="-10142.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10833" y="-10127.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10833" y="-10112.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_9_add_norm2&#45;&gt;layer_10_add_norm1 -->
<g id="edge575" class="edge">
<title>layer_9_add_norm2&#45;&gt;layer_10_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10903.75,-10956.98C10903.75,-10956.98 10903.75,-10183.62 10903.75,-10183.62"/>
<polygon fill="black" stroke="black" points="10907.25,-10183.62 10903.75,-10173.62 10900.25,-10183.62 10907.25,-10183.62"/>
<text text-anchor="middle" x="10910" y="-10561.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_10_attn -->
<g id="node242" class="node">
<title>layer_10_attn</title>
<polygon fill="lightblue" stroke="black" points="10764.5,-10599.17 10355.5,-10599.17 10355.5,-10531.17 10764.5,-10531.17 10764.5,-10599.17"/>
<text text-anchor="middle" x="10560" y="-10583.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10560" y="-10568.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10560" y="-10553.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10560" y="-10538.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_10_qkv&#45;&gt;layer_10_attn -->
<g id="edge572" class="edge">
<title>layer_10_qkv&#45;&gt;layer_10_attn</title>
<path fill="none" stroke="black" d="M10574.5,-10743.94C10574.5,-10743.94 10574.5,-10609.3 10574.5,-10609.3"/>
<polygon fill="black" stroke="black" points="10578,-10609.3 10574.5,-10599.3 10571,-10609.3 10578,-10609.3"/>
</g>
<!-- layer_10_proj -->
<g id="node243" class="node">
<title>layer_10_proj</title>
<polygon fill="lightblue" stroke="black" points="10790.5,-10386.17 10393.5,-10386.17 10393.5,-10318.17 10790.5,-10318.17 10790.5,-10386.17"/>
<text text-anchor="middle" x="10592" y="-10370.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="10592" y="-10355.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10592" y="-10340.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10592" y="-10325.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_10_attn&#45;&gt;layer_10_proj -->
<g id="edge573" class="edge">
<title>layer_10_attn&#45;&gt;layer_10_proj</title>
<path fill="none" stroke="black" d="M10579,-10530.94C10579,-10530.94 10579,-10396.3 10579,-10396.3"/>
<polygon fill="black" stroke="black" points="10582.5,-10396.3 10579,-10386.3 10575.5,-10396.3 10582.5,-10396.3"/>
</g>
<!-- layer_10_proj&#45;&gt;layer_10_add_norm1 -->
<g id="edge574" class="edge">
<title>layer_10_proj&#45;&gt;layer_10_add_norm1</title>
<path fill="none" stroke="black" d="M10721.25,-10317.94C10721.25,-10317.94 10721.25,-10183.3 10721.25,-10183.3"/>
<polygon fill="black" stroke="black" points="10724.75,-10183.3 10721.25,-10173.3 10717.75,-10183.3 10724.75,-10183.3"/>
</g>
<!-- layer_10_gate -->
<g id="node245" class="node">
<title>layer_10_gate</title>
<polygon fill="yellow" stroke="black" points="10773.73,-9960.17 10196.71,-9960.17 10048.27,-9824.17 10625.29,-9824.17 10773.73,-9960.17"/>
<text text-anchor="middle" x="10411" y="-9910.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="10411" y="-9895.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10411" y="-9880.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="10411" y="-9865.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_gate -->
<g id="edge576" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_gate</title>
<path fill="none" stroke="black" d="M10712.93,-10105.08C10712.93,-10105.08 10712.93,-9970.37 10712.93,-9970.37"/>
<polygon fill="black" stroke="black" points="10716.43,-9970.37 10712.93,-9960.37 10709.43,-9970.37 10716.43,-9970.37"/>
</g>
<!-- layer_10_moe_agg -->
<g id="node246" class="node">
<title>layer_10_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="11024,-9452.17 10662,-9452.17 10662,-9384.17 11024,-9384.17 11024,-9452.17"/>
<text text-anchor="middle" x="10843" y="-9436.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="10843" y="-9421.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10843" y="-9406.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10843" y="-9391.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_moe_agg -->
<g id="edge577" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M10893.93,-10105.13C10893.93,-10001.35 10893.93,-9696 10893.93,-9696 10893.93,-9696 10721,-9696 10721,-9696 10721,-9696 10721,-9462.23 10721,-9462.23"/>
<polygon fill="black" stroke="black" points="10724.5,-9462.23 10721,-9452.23 10717.5,-9462.23 10724.5,-9462.23"/>
</g>
<!-- layer_10_expert_0 -->
<g id="node247" class="node">
<title>layer_10_expert_0</title>
<polygon fill="lightblue" stroke="black" points="9012,-9665.17 8650,-9665.17 8650,-9597.17 9012,-9597.17 9012,-9665.17"/>
<text text-anchor="middle" x="8831" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8831" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_0 -->
<g id="edge579" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_0</title>
<path fill="none" stroke="black" d="M10651.88,-10143C10143.55,-10143 8740.5,-10143 8740.5,-10143 8740.5,-10143 8740.5,-9675.54 8740.5,-9675.54"/>
<polygon fill="black" stroke="black" points="8744,-9675.54 8740.5,-9665.54 8737,-9675.54 8744,-9675.54"/>
</g>
<!-- layer_10_expert_1 -->
<g id="node248" class="node">
<title>layer_10_expert_1</title>
<polygon fill="lightblue" stroke="black" points="9432,-9665.17 9070,-9665.17 9070,-9597.17 9432,-9597.17 9432,-9665.17"/>
<text text-anchor="middle" x="9251" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9251" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_1 -->
<g id="edge582" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_1</title>
<path fill="none" stroke="black" d="M10651.63,-10134C10218.65,-10134 9160.5,-10134 9160.5,-10134 9160.5,-10134 9160.5,-9675.33 9160.5,-9675.33"/>
<polygon fill="black" stroke="black" points="9164,-9675.33 9160.5,-9665.33 9157,-9675.33 9164,-9675.33"/>
</g>
<!-- layer_10_expert_2 -->
<g id="node249" class="node">
<title>layer_10_expert_2</title>
<polygon fill="lightblue" stroke="black" points="12372,-9665.17 12010,-9665.17 12010,-9597.17 12372,-9597.17 12372,-9665.17"/>
<text text-anchor="middle" x="12191" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12191" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_2 -->
<g id="edge585" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_2</title>
<path fill="none" stroke="black" d="M11014.03,-10139C11383.76,-10139 12191,-10139 12191,-10139 12191,-10139 12191,-9675.28 12191,-9675.28"/>
<polygon fill="black" stroke="black" points="12194.5,-9675.28 12191,-9665.28 12187.5,-9675.28 12194.5,-9675.28"/>
</g>
<!-- layer_10_expert_3 -->
<g id="node250" class="node">
<title>layer_10_expert_3</title>
<polygon fill="lightblue" stroke="black" points="8172,-9665.17 7810,-9665.17 7810,-9597.17 8172,-9597.17 8172,-9665.17"/>
<text text-anchor="middle" x="7991" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7991" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_3 -->
<g id="edge588" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_3</title>
<path fill="none" stroke="black" d="M10651.98,-10160C10025.99,-10160 7991,-10160 7991,-10160 7991,-10160 7991,-9675.46 7991,-9675.46"/>
<polygon fill="black" stroke="black" points="7994.5,-9675.46 7991,-9665.46 7987.5,-9675.46 7994.5,-9675.46"/>
</g>
<!-- layer_10_expert_4 -->
<g id="node251" class="node">
<title>layer_10_expert_4</title>
<polygon fill="lightblue" stroke="black" points="8592,-9665.17 8230,-9665.17 8230,-9597.17 8592,-9597.17 8592,-9665.17"/>
<text text-anchor="middle" x="8411" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8411" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_4 -->
<g id="edge591" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_4</title>
<path fill="none" stroke="black" d="M10651.8,-10151C10075.19,-10151 8320.5,-10151 8320.5,-10151 8320.5,-10151 8320.5,-9675.27 8320.5,-9675.27"/>
<polygon fill="black" stroke="black" points="8324,-9675.27 8320.5,-9665.27 8317,-9675.27 8324,-9675.27"/>
</g>
<!-- layer_10_expert_5 -->
<g id="node252" class="node">
<title>layer_10_expert_5</title>
<polygon fill="lightblue" stroke="black" points="11112,-9665.17 10750,-9665.17 10750,-9597.17 11112,-9597.17 11112,-9665.17"/>
<text text-anchor="middle" x="10931" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10931" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_5 -->
<g id="edge594" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_5</title>
<path fill="none" stroke="black" d="M10953.97,-10105.05C10953.97,-10105.05 10953.97,-9675.47 10953.97,-9675.47"/>
<polygon fill="black" stroke="black" points="10957.47,-9675.47 10953.97,-9665.47 10950.47,-9675.47 10957.47,-9675.47"/>
</g>
<!-- layer_10_expert_6 -->
<g id="node253" class="node">
<title>layer_10_expert_6</title>
<polygon fill="lightblue" stroke="black" points="9852,-9665.17 9490,-9665.17 9490,-9597.17 9852,-9597.17 9852,-9665.17"/>
<text text-anchor="middle" x="9671" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9671" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_6 -->
<g id="edge597" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_6</title>
<path fill="none" stroke="black" d="M10651.88,-10126C10304.89,-10126 9580.5,-10126 9580.5,-10126 9580.5,-10126 9580.5,-9675.18 9580.5,-9675.18"/>
<polygon fill="black" stroke="black" points="9584,-9675.18 9580.5,-9665.18 9577,-9675.18 9584,-9675.18"/>
</g>
<!-- layer_10_expert_7 -->
<g id="node254" class="node">
<title>layer_10_expert_7</title>
<polygon fill="lightblue" stroke="black" points="12792,-9665.17 12430,-9665.17 12430,-9597.17 12792,-9597.17 12792,-9665.17"/>
<text text-anchor="middle" x="12611" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12611" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_7 -->
<g id="edge600" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_7</title>
<path fill="none" stroke="black" d="M11014.09,-10147C11466.68,-10147 12611,-10147 12611,-10147 12611,-10147 12611,-9675.41 12611,-9675.41"/>
<polygon fill="black" stroke="black" points="12614.5,-9675.41 12611,-9665.41 12607.5,-9675.41 12614.5,-9675.41"/>
</g>
<!-- layer_10_expert_8 -->
<g id="node255" class="node">
<title>layer_10_expert_8</title>
<polygon fill="lightblue" stroke="black" points="7332,-9665.17 6970,-9665.17 6970,-9597.17 7332,-9597.17 7332,-9665.17"/>
<text text-anchor="middle" x="7151" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7151" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_8 -->
<g id="edge603" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_8</title>
<path fill="none" stroke="black" d="M10651.98,-10168C9911.35,-10168 7151,-10168 7151,-10168 7151,-10168 7151,-9675.56 7151,-9675.56"/>
<polygon fill="black" stroke="black" points="7154.5,-9675.56 7151,-9665.56 7147.5,-9675.56 7154.5,-9675.56"/>
</g>
<!-- layer_10_expert_9 -->
<g id="node256" class="node">
<title>layer_10_expert_9</title>
<polygon fill="lightblue" stroke="black" points="13212,-9665.17 12850,-9665.17 12850,-9597.17 13212,-9597.17 13212,-9665.17"/>
<text text-anchor="middle" x="13031" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="13031" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_9 -->
<g id="edge606" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_9</title>
<path fill="none" stroke="black" d="M11014.27,-10156C11540.47,-10156 13031,-10156 13031,-10156 13031,-10156 13031,-9675.2 13031,-9675.2"/>
<polygon fill="black" stroke="black" points="13034.5,-9675.2 13031,-9665.2 13027.5,-9675.2 13034.5,-9675.2"/>
</g>
<!-- layer_10_expert_10 -->
<g id="node257" class="node">
<title>layer_10_expert_10</title>
<polygon fill="lightblue" stroke="black" points="11952,-9665.17 11590,-9665.17 11590,-9597.17 11952,-9597.17 11952,-9665.17"/>
<text text-anchor="middle" x="11771" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="11771" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_10 -->
<g id="edge609" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_10</title>
<path fill="none" stroke="black" d="M11014.13,-10130C11286.76,-10130 11771,-10130 11771,-10130 11771,-10130 11771,-9675.45 11771,-9675.45"/>
<polygon fill="black" stroke="black" points="11774.5,-9675.45 11771,-9665.45 11767.5,-9675.45 11774.5,-9675.45"/>
</g>
<!-- layer_10_expert_11 -->
<g id="node258" class="node">
<title>layer_10_expert_11</title>
<polygon fill="lightblue" stroke="black" points="7752,-9665.17 7390,-9665.17 7390,-9597.17 7752,-9597.17 7752,-9665.17"/>
<text text-anchor="middle" x="7571" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7571" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_11 -->
<g id="edge612" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_11</title>
<path fill="none" stroke="black" d="M10651.8,-10164C9966.4,-10164 7571,-10164 7571,-10164 7571,-10164 7571,-9675.31 7571,-9675.31"/>
<polygon fill="black" stroke="black" points="7574.5,-9675.31 7571,-9665.31 7567.5,-9675.31 7574.5,-9675.31"/>
</g>
<!-- layer_10_expert_12 -->
<g id="node259" class="node">
<title>layer_10_expert_12</title>
<polygon fill="lightblue" stroke="black" points="10272,-9665.17 9910,-9665.17 9910,-9597.17 10272,-9597.17 10272,-9665.17"/>
<text text-anchor="middle" x="10091" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10091" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_12 -->
<g id="edge615" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_12</title>
<path fill="none" stroke="black" d="M10651.9,-10117C10401.24,-10117 9979.07,-10117 9979.07,-10117 9979.07,-10117 9979.07,-9675.33 9979.07,-9675.33"/>
<polygon fill="black" stroke="black" points="9982.57,-9675.33 9979.07,-9665.33 9975.57,-9675.33 9982.57,-9675.33"/>
</g>
<!-- layer_10_expert_13 -->
<g id="node260" class="node">
<title>layer_10_expert_13</title>
<polygon fill="lightblue" stroke="black" points="13632,-9665.17 13270,-9665.17 13270,-9597.17 13632,-9597.17 13632,-9665.17"/>
<text text-anchor="middle" x="13451" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="13451" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_13 -->
<g id="edge618" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_13</title>
<path fill="none" stroke="black" d="M11014.24,-10164C11607.11,-10164 13451,-10164 13451,-10164 13451,-10164 13451,-9675.31 13451,-9675.31"/>
<polygon fill="black" stroke="black" points="13454.5,-9675.31 13451,-9665.31 13447.5,-9675.31 13454.5,-9675.31"/>
</g>
<!-- layer_10_expert_14 -->
<g id="node261" class="node">
<title>layer_10_expert_14</title>
<polygon fill="lightblue" stroke="black" points="11532,-9665.17 11170,-9665.17 11170,-9597.17 11532,-9597.17 11532,-9665.17"/>
<text text-anchor="middle" x="11351" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11351" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_14 -->
<g id="edge621" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_14</title>
<path fill="none" stroke="black" d="M11014.17,-10122C11163.55,-10122 11351,-10122 11351,-10122 11351,-10122 11351,-9675.29 11351,-9675.29"/>
<polygon fill="black" stroke="black" points="11354.5,-9675.29 11351,-9665.29 11347.5,-9675.29 11354.5,-9675.29"/>
</g>
<!-- layer_10_expert_15 -->
<g id="node262" class="node">
<title>layer_10_expert_15</title>
<polygon fill="lightblue" stroke="black" points="10692,-9665.17 10330,-9665.17 10330,-9597.17 10692,-9597.17 10692,-9665.17"/>
<text text-anchor="middle" x="10511" y="-9649.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="10511" y="-9634.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-9619.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-9604.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_expert_15 -->
<g id="edge624" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_expert_15</title>
<path fill="none" stroke="black" d="M10833.9,-10104.82C10833.9,-10006 10833.9,-9728 10833.9,-9728 10833.9,-9728 10571.33,-9728 10571.33,-9728 10571.33,-9728 10571.33,-9675.31 10571.33,-9675.31"/>
<polygon fill="black" stroke="black" points="10574.83,-9675.31 10571.33,-9665.31 10567.83,-9675.31 10574.83,-9675.31"/>
</g>
<!-- layer_10_add_norm2 -->
<g id="node263" class="node">
<title>layer_10_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="11075,-9239.17 10713,-9239.17 10713,-9171.17 11075,-9171.17 11075,-9239.17"/>
<text text-anchor="middle" x="10894" y="-9223.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10894" y="-9208.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10894" y="-9193.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10894" y="-9178.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_10_add_norm1&#45;&gt;layer_10_add_norm2 -->
<g id="edge627" class="edge">
<title>layer_10_add_norm1&#45;&gt;layer_10_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11014,-10113C11069.82,-10113 11116.9,-10113 11116.9,-10113 11116.9,-10113 11116.9,-9205 11116.9,-9205 11116.9,-9205 11085.24,-9205 11085.24,-9205"/>
<polygon fill="black" stroke="black" points="11085.24,-9201.5 11075.24,-9205 11085.24,-9208.5 11085.24,-9201.5"/>
<text text-anchor="middle" x="13837" y="-9627.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_0 -->
<g id="edge578" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10100.11,-9872C9663.52,-9872 8921.5,-9872 8921.5,-9872 8921.5,-9872 8921.5,-9675.42 8921.5,-9675.42"/>
<polygon fill="black" stroke="black" points="8925,-9675.42 8921.5,-9665.42 8918,-9675.42 8925,-9675.42"/>
<text text-anchor="middle" x="9592.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_1 -->
<g id="edge581" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10079.56,-9853C9765.5,-9853 9341.5,-9853 9341.5,-9853 9341.5,-9853 9341.5,-9675.34 9341.5,-9675.34"/>
<polygon fill="black" stroke="black" points="9345,-9675.34 9341.5,-9665.34 9338,-9675.34 9345,-9675.34"/>
<text text-anchor="middle" x="9935.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_2 -->
<g id="edge584" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10688.57,-9882C11168.01,-9882 12100.5,-9882 12100.5,-9882 12100.5,-9882 12100.5,-9675.26 12100.5,-9675.26"/>
<polygon fill="black" stroke="black" points="12104,-9675.26 12100.5,-9665.26 12097,-9675.26 12104,-9675.26"/>
<text text-anchor="middle" x="11522.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_3 -->
<g id="edge587" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10142.92,-9911C9530.55,-9911 8081.5,-9911 8081.5,-9911 8081.5,-9911 8081.5,-9675.2 8081.5,-9675.2"/>
<polygon fill="black" stroke="black" points="8085,-9675.2 8081.5,-9665.2 8078,-9675.2 8085,-9675.2"/>
<text text-anchor="middle" x="8723.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_4 -->
<g id="edge590" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10122.28,-9892C9588.57,-9892 8501.5,-9892 8501.5,-9892 8501.5,-9892 8501.5,-9675.27 8501.5,-9675.27"/>
<polygon fill="black" stroke="black" points="8505,-9675.27 8501.5,-9665.27 8498,-9675.27 8505,-9675.27"/>
<text text-anchor="middle" x="9195.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_5 -->
<g id="edge593" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10761.93,-9892.12C10761.93,-9892.12 10761.93,-9675.33 10761.93,-9675.33"/>
<polygon fill="black" stroke="black" points="10765.43,-9675.33 10761.93,-9665.33 10758.43,-9675.33 10765.43,-9675.33"/>
<text text-anchor="middle" x="10708.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_6 -->
<g id="edge596" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10057.74,-9833C9905.4,-9833 9761.5,-9833 9761.5,-9833 9761.5,-9833 9761.5,-9675.4 9761.5,-9675.4"/>
<polygon fill="black" stroke="black" points="9765,-9675.4 9761.5,-9665.4 9758,-9675.4 9765,-9675.4"/>
<text text-anchor="middle" x="10173.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_7 -->
<g id="edge599" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10709.32,-9901C11291.04,-9901 12520.5,-9901 12520.5,-9901 12520.5,-9901 12520.5,-9675.34 12520.5,-9675.34"/>
<polygon fill="black" stroke="black" points="12524,-9675.34 12520.5,-9665.34 12517,-9675.34 12524,-9675.34"/>
<text text-anchor="middle" x="11927.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_8 -->
<g id="edge602" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10185.6,-9950C9461.5,-9950 7241.5,-9950 7241.5,-9950 7241.5,-9950 7241.5,-9675.29 7241.5,-9675.29"/>
<polygon fill="black" stroke="black" points="7245,-9675.29 7241.5,-9665.29 7238,-9675.29 7245,-9675.29"/>
<text text-anchor="middle" x="7995.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_9 -->
<g id="edge605" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10731.04,-9921C11411.54,-9921 12940.5,-9921 12940.5,-9921 12940.5,-9921 12940.5,-9675.27 12940.5,-9675.27"/>
<polygon fill="black" stroke="black" points="12944,-9675.27 12940.5,-9665.27 12937,-9675.27 12944,-9675.27"/>
<text text-anchor="middle" x="12343.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_10 -->
<g id="edge608" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10667.9,-9863C11038.85,-9863 11680.5,-9863 11680.5,-9863 11680.5,-9863 11680.5,-9675.37 11680.5,-9675.37"/>
<polygon fill="black" stroke="black" points="11684,-9675.37 11680.5,-9665.37 11677,-9675.37 11684,-9675.37"/>
<text text-anchor="middle" x="11163.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_11 -->
<g id="edge611" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10164.58,-9931C9489.71,-9931 7661.5,-9931 7661.5,-9931 7661.5,-9931 7661.5,-9675.27 7661.5,-9675.27"/>
<polygon fill="black" stroke="black" points="7665,-9675.27 7661.5,-9665.27 7658,-9675.27 7665,-9675.27"/>
<text text-anchor="middle" x="8340.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_12 -->
<g id="edge614" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10160.07,-9823.93C10160.07,-9823.93 10160.07,-9675.49 10160.07,-9675.49"/>
<polygon fill="black" stroke="black" points="10163.57,-9675.49 10160.07,-9665.49 10156.57,-9675.49 10163.57,-9675.49"/>
<text text-anchor="middle" x="10351.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_13 -->
<g id="edge617" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10751.87,-9940C11528.06,-9940 13360.5,-9940 13360.5,-9940 13360.5,-9940 13360.5,-9675.4 13360.5,-9675.4"/>
<polygon fill="black" stroke="black" points="13364,-9675.4 13360.5,-9665.4 13357,-9675.4 13364,-9675.4"/>
<text text-anchor="middle" x="12701.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_14 -->
<g id="edge620" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10645.94,-9843C10897.37,-9843 11260.5,-9843 11260.5,-9843 11260.5,-9843 11260.5,-9675.2 11260.5,-9675.2"/>
<polygon fill="black" stroke="black" points="11264,-9675.2 11260.5,-9665.2 11257,-9675.2 11264,-9675.2"/>
<text text-anchor="middle" x="10923.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_15 -->
<g id="edge623" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10450.67,-9823.93C10450.67,-9823.93 10450.67,-9675.49 10450.67,-9675.49"/>
<polygon fill="black" stroke="black" points="10454.17,-9675.49 10450.67,-9665.49 10447.17,-9675.49 10454.17,-9675.49"/>
<text text-anchor="middle" x="10514.5" y="-9740.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_10_moe_agg&#45;&gt;layer_10_add_norm2 -->
<g id="edge626" class="edge">
<title>layer_10_moe_agg&#45;&gt;layer_10_add_norm2</title>
<path fill="none" stroke="black" d="M10868.5,-9383.94C10868.5,-9383.94 10868.5,-9249.3 10868.5,-9249.3"/>
<polygon fill="black" stroke="black" points="10872,-9249.3 10868.5,-9239.3 10865,-9249.3 10872,-9249.3"/>
</g>
<!-- layer_10_expert_0&#45;&gt;layer_10_moe_agg -->
<g id="edge580" class="edge">
<title>layer_10_expert_0&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M8831,-9596.82C8831,-9540.33 8831,-9434 8831,-9434 8831,-9434 10651.79,-9434 10651.79,-9434"/>
<polygon fill="black" stroke="black" points="10651.79,-9437.5 10661.79,-9434 10651.79,-9430.5 10651.79,-9437.5"/>
</g>
<!-- layer_10_expert_1&#45;&gt;layer_10_moe_agg -->
<g id="edge583" class="edge">
<title>layer_10_expert_1&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M9251,-9597.08C9251,-9541.62 9251,-9438 9251,-9438 9251,-9438 10651.93,-9438 10651.93,-9438"/>
<polygon fill="black" stroke="black" points="10651.93,-9441.5 10661.93,-9438 10651.93,-9434.5 10651.93,-9441.5"/>
</g>
<!-- layer_10_expert_2&#45;&gt;layer_10_moe_agg -->
<g id="edge586" class="edge">
<title>layer_10_expert_2&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M12191,-9596.79C12191,-9537.67 12191,-9423 12191,-9423 12191,-9423 11034.1,-9423 11034.1,-9423"/>
<polygon fill="black" stroke="black" points="11034.1,-9419.5 11024.1,-9423 11034.1,-9426.5 11034.1,-9419.5"/>
</g>
<!-- layer_10_expert_3&#45;&gt;layer_10_moe_agg -->
<g id="edge589" class="edge">
<title>layer_10_expert_3&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M7991,-9596.96C7991,-9538.12 7991,-9424 7991,-9424 7991,-9424 10651.89,-9424 10651.89,-9424"/>
<polygon fill="black" stroke="black" points="10651.89,-9427.5 10661.89,-9424 10651.89,-9420.5 10651.89,-9427.5"/>
</g>
<!-- layer_10_expert_4&#45;&gt;layer_10_moe_agg -->
<g id="edge592" class="edge">
<title>layer_10_expert_4&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M8411,-9596.87C8411,-9539.19 8411,-9429 8411,-9429 8411,-9429 10651.7,-9429 10651.7,-9429"/>
<polygon fill="black" stroke="black" points="10651.7,-9432.5 10661.7,-9429 10651.7,-9425.5 10651.7,-9432.5"/>
</g>
<!-- layer_10_expert_5&#45;&gt;layer_10_moe_agg -->
<g id="edge595" class="edge">
<title>layer_10_expert_5&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M10887,-9596.94C10887,-9596.94 10887,-9462.3 10887,-9462.3"/>
<polygon fill="black" stroke="black" points="10890.5,-9462.3 10887,-9452.3 10883.5,-9462.3 10890.5,-9462.3"/>
</g>
<!-- layer_10_expert_6&#45;&gt;layer_10_moe_agg -->
<g id="edge598" class="edge">
<title>layer_10_expert_6&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M9671,-9597.09C9671,-9542.87 9671,-9443 9671,-9443 9671,-9443 10651.8,-9443 10651.8,-9443"/>
<polygon fill="black" stroke="black" points="10651.8,-9446.5 10661.8,-9443 10651.8,-9439.5 10651.8,-9446.5"/>
</g>
<!-- layer_10_expert_7&#45;&gt;layer_10_moe_agg -->
<g id="edge601" class="edge">
<title>layer_10_expert_7&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M12611,-9597.08C12611,-9535.72 12611,-9413 12611,-9413 12611,-9413 11034.31,-9413 11034.31,-9413"/>
<polygon fill="black" stroke="black" points="11034.31,-9409.5 11024.31,-9413 11034.31,-9416.5 11034.31,-9409.5"/>
</g>
<!-- layer_10_expert_8&#45;&gt;layer_10_moe_agg -->
<g id="edge604" class="edge">
<title>layer_10_expert_8&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M7151,-9596.91C7151,-9535.96 7151,-9415 7151,-9415 7151,-9415 10651.8,-9415 10651.8,-9415"/>
<polygon fill="black" stroke="black" points="10651.8,-9418.5 10661.8,-9415 10651.8,-9411.5 10651.8,-9418.5"/>
</g>
<!-- layer_10_expert_9&#45;&gt;layer_10_moe_agg -->
<g id="edge607" class="edge">
<title>layer_10_expert_9&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M13031,-9597.01C13031,-9533.36 13031,-9403 13031,-9403 13031,-9403 11034.38,-9403 11034.38,-9403"/>
<polygon fill="black" stroke="black" points="11034.38,-9399.5 11024.38,-9403 11034.38,-9406.5 11034.38,-9399.5"/>
</g>
<!-- layer_10_expert_10&#45;&gt;layer_10_moe_agg -->
<g id="edge610" class="edge">
<title>layer_10_expert_10&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M11861.5,-9596.93C11861.5,-9539.98 11861.5,-9432 11861.5,-9432 11861.5,-9432 11034.21,-9432 11034.21,-9432"/>
<polygon fill="black" stroke="black" points="11034.21,-9428.5 11024.21,-9432 11034.21,-9435.5 11034.21,-9428.5"/>
</g>
<!-- layer_10_expert_11&#45;&gt;layer_10_moe_agg -->
<g id="edge613" class="edge">
<title>layer_10_expert_11&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M7571,-9596.77C7571,-9536.93 7571,-9420 7571,-9420 7571,-9420 10651.84,-9420 10651.84,-9420"/>
<polygon fill="black" stroke="black" points="10651.84,-9423.5 10661.84,-9420 10651.84,-9416.5 10651.84,-9423.5"/>
</g>
<!-- layer_10_expert_12&#45;&gt;layer_10_moe_agg -->
<g id="edge616" class="edge">
<title>layer_10_expert_12&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M10209.57,-9596.96C10209.57,-9543.7 10209.57,-9447 10209.57,-9447 10209.57,-9447 10651.91,-9447 10651.91,-9447"/>
<polygon fill="black" stroke="black" points="10651.91,-9450.5 10661.91,-9447 10651.91,-9443.5 10651.91,-9450.5"/>
</g>
<!-- layer_10_expert_13&#45;&gt;layer_10_moe_agg -->
<g id="edge619" class="edge">
<title>layer_10_expert_13&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M13451,-9597.04C13451,-9531.19 13451,-9393 13451,-9393 13451,-9393 11034.06,-9393 11034.06,-9393"/>
<polygon fill="black" stroke="black" points="11034.06,-9389.5 11024.06,-9393 11034.06,-9396.5 11034.06,-9389.5"/>
</g>
<!-- layer_10_expert_14&#45;&gt;layer_10_moe_agg -->
<g id="edge622" class="edge">
<title>layer_10_expert_14&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M11441.5,-9596.91C11441.5,-9542.4 11441.5,-9442 11441.5,-9442 11441.5,-9442 11034.19,-9442 11034.19,-9442"/>
<polygon fill="black" stroke="black" points="11034.19,-9438.5 11024.19,-9442 11034.19,-9445.5 11034.19,-9438.5"/>
</g>
<!-- layer_10_expert_15&#45;&gt;layer_10_moe_agg -->
<g id="edge625" class="edge">
<title>layer_10_expert_15&#45;&gt;layer_10_moe_agg</title>
<path fill="none" stroke="black" d="M10677,-9596.94C10677,-9596.94 10677,-9462.3 10677,-9462.3"/>
<polygon fill="black" stroke="black" points="10680.5,-9462.3 10677,-9452.3 10673.5,-9462.3 10680.5,-9462.3"/>
</g>
<!-- layer_11_qkv -->
<g id="node264" class="node">
<title>layer_11_qkv</title>
<polygon fill="lightblue" stroke="black" points="10911.5,-9026.17 10502.5,-9026.17 10502.5,-8958.17 10911.5,-8958.17 10911.5,-9026.17"/>
<text text-anchor="middle" x="10707" y="-9010.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10707" y="-8995.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10707" y="-8980.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10707" y="-8965.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_10_add_norm2&#45;&gt;layer_11_qkv -->
<g id="edge628" class="edge">
<title>layer_10_add_norm2&#45;&gt;layer_11_qkv</title>
<path fill="none" stroke="black" d="M10812.25,-9170.94C10812.25,-9170.94 10812.25,-9036.3 10812.25,-9036.3"/>
<polygon fill="black" stroke="black" points="10815.75,-9036.3 10812.25,-9026.3 10808.75,-9036.3 10815.75,-9036.3"/>
</g>
<!-- layer_11_add_norm1 -->
<g id="node267" class="node">
<title>layer_11_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="11113,-8387.17 10751,-8387.17 10751,-8319.17 11113,-8319.17 11113,-8387.17"/>
<text text-anchor="middle" x="10932" y="-8371.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10932" y="-8356.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10932" y="-8341.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10932" y="-8326.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_10_add_norm2&#45;&gt;layer_11_add_norm1 -->
<g id="edge632" class="edge">
<title>layer_10_add_norm2&#45;&gt;layer_11_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10993.25,-9170.98C10993.25,-9170.98 10993.25,-8397.62 10993.25,-8397.62"/>
<polygon fill="black" stroke="black" points="10996.75,-8397.62 10993.25,-8387.62 10989.75,-8397.62 10996.75,-8397.62"/>
<text text-anchor="middle" x="11028" y="-8775.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_11_attn -->
<g id="node265" class="node">
<title>layer_11_attn</title>
<polygon fill="lightblue" stroke="black" points="10882.5,-8813.17 10473.5,-8813.17 10473.5,-8745.17 10882.5,-8745.17 10882.5,-8813.17"/>
<text text-anchor="middle" x="10678" y="-8797.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10678" y="-8782.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10678" y="-8767.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10678" y="-8752.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_11_qkv&#45;&gt;layer_11_attn -->
<g id="edge629" class="edge">
<title>layer_11_qkv&#45;&gt;layer_11_attn</title>
<path fill="none" stroke="black" d="M10692.5,-8957.94C10692.5,-8957.94 10692.5,-8823.3 10692.5,-8823.3"/>
<polygon fill="black" stroke="black" points="10696,-8823.3 10692.5,-8813.3 10689,-8823.3 10696,-8823.3"/>
</g>
<!-- layer_11_proj -->
<g id="node266" class="node">
<title>layer_11_proj</title>
<polygon fill="lightblue" stroke="black" points="10908.5,-8600.17 10511.5,-8600.17 10511.5,-8532.17 10908.5,-8532.17 10908.5,-8600.17"/>
<text text-anchor="middle" x="10710" y="-8584.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="10710" y="-8569.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10710" y="-8554.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10710" y="-8539.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_11_attn&#45;&gt;layer_11_proj -->
<g id="edge630" class="edge">
<title>layer_11_attn&#45;&gt;layer_11_proj</title>
<path fill="none" stroke="black" d="M10697,-8744.94C10697,-8744.94 10697,-8610.3 10697,-8610.3"/>
<polygon fill="black" stroke="black" points="10700.5,-8610.3 10697,-8600.3 10693.5,-8610.3 10700.5,-8610.3"/>
</g>
<!-- layer_11_proj&#45;&gt;layer_11_add_norm1 -->
<g id="edge631" class="edge">
<title>layer_11_proj&#45;&gt;layer_11_add_norm1</title>
<path fill="none" stroke="black" d="M10829.75,-8531.94C10829.75,-8531.94 10829.75,-8397.3 10829.75,-8397.3"/>
<polygon fill="black" stroke="black" points="10833.25,-8397.3 10829.75,-8387.3 10826.25,-8397.3 10833.25,-8397.3"/>
</g>
<!-- layer_11_gate -->
<g id="node268" class="node">
<title>layer_11_gate</title>
<polygon fill="yellow" stroke="black" points="10872.73,-8174.17 10295.71,-8174.17 10147.27,-8038.17 10724.29,-8038.17 10872.73,-8174.17"/>
<text text-anchor="middle" x="10510" y="-8124.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="10510" y="-8109.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10510" y="-8094.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="10510" y="-8079.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_gate -->
<g id="edge633" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_gate</title>
<path fill="none" stroke="black" d="M10811.93,-8319.08C10811.93,-8319.08 10811.93,-8184.37 10811.93,-8184.37"/>
<polygon fill="black" stroke="black" points="10815.43,-8184.37 10811.93,-8174.37 10808.43,-8184.37 10815.43,-8184.37"/>
</g>
<!-- layer_11_moe_agg -->
<g id="node269" class="node">
<title>layer_11_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="10799,-7666.17 10437,-7666.17 10437,-7598.17 10799,-7598.17 10799,-7666.17"/>
<text text-anchor="middle" x="10618" y="-7650.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="10618" y="-7635.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10618" y="-7620.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10618" y="-7605.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_moe_agg -->
<g id="edge634" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M10992.43,-8318.85C10992.43,-8225.51 10992.43,-7974 10992.43,-7974 10992.43,-7974 10721,-7974 10721,-7974 10721,-7974 10721,-7676.19 10721,-7676.19"/>
<polygon fill="black" stroke="black" points="10724.5,-7676.19 10721,-7666.19 10717.5,-7676.19 10724.5,-7676.19"/>
</g>
<!-- layer_11_expert_0 -->
<g id="node270" class="node">
<title>layer_11_expert_0</title>
<polygon fill="lightblue" stroke="black" points="9012,-7879.17 8650,-7879.17 8650,-7811.17 9012,-7811.17 9012,-7879.17"/>
<text text-anchor="middle" x="8831" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8831" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_0 -->
<g id="edge636" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_0</title>
<path fill="none" stroke="black" d="M10750.8,-8357C10225.74,-8357 8740.5,-8357 8740.5,-8357 8740.5,-8357 8740.5,-7889.54 8740.5,-7889.54"/>
<polygon fill="black" stroke="black" points="8744,-7889.54 8740.5,-7879.54 8737,-7889.54 8744,-7889.54"/>
</g>
<!-- layer_11_expert_1 -->
<g id="node271" class="node">
<title>layer_11_expert_1</title>
<polygon fill="lightblue" stroke="black" points="9432,-7879.17 9070,-7879.17 9070,-7811.17 9432,-7811.17 9432,-7879.17"/>
<text text-anchor="middle" x="9251" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9251" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_1 -->
<g id="edge639" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_1</title>
<path fill="none" stroke="black" d="M10750.74,-8348C10299.25,-8348 9160.5,-8348 9160.5,-8348 9160.5,-8348 9160.5,-7889.33 9160.5,-7889.33"/>
<polygon fill="black" stroke="black" points="9164,-7889.33 9160.5,-7879.33 9157,-7889.33 9164,-7889.33"/>
</g>
<!-- layer_11_expert_2 -->
<g id="node272" class="node">
<title>layer_11_expert_2</title>
<polygon fill="lightblue" stroke="black" points="12372,-7879.17 12010,-7879.17 12010,-7811.17 12372,-7811.17 12372,-7879.17"/>
<text text-anchor="middle" x="12191" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12191" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_2 -->
<g id="edge642" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_2</title>
<path fill="none" stroke="black" d="M11113.3,-8353C11481.34,-8353 12281.5,-8353 12281.5,-8353 12281.5,-8353 12281.5,-7889.28 12281.5,-7889.28"/>
<polygon fill="black" stroke="black" points="12285,-7889.28 12281.5,-7879.28 12278,-7889.28 12285,-7889.28"/>
</g>
<!-- layer_11_expert_3 -->
<g id="node273" class="node">
<title>layer_11_expert_3</title>
<polygon fill="lightblue" stroke="black" points="8172,-7879.17 7810,-7879.17 7810,-7811.17 8172,-7811.17 8172,-7879.17"/>
<text text-anchor="middle" x="7991" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7991" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_3 -->
<g id="edge645" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_3</title>
<path fill="none" stroke="black" d="M10750.88,-8374C10097.56,-8374 7900.5,-8374 7900.5,-8374 7900.5,-8374 7900.5,-7889.46 7900.5,-7889.46"/>
<polygon fill="black" stroke="black" points="7904,-7889.46 7900.5,-7879.46 7897,-7889.46 7904,-7889.46"/>
</g>
<!-- layer_11_expert_4 -->
<g id="node274" class="node">
<title>layer_11_expert_4</title>
<polygon fill="lightblue" stroke="black" points="8592,-7879.17 8230,-7879.17 8230,-7811.17 8592,-7811.17 8592,-7879.17"/>
<text text-anchor="middle" x="8411" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8411" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_4 -->
<g id="edge648" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_4</title>
<path fill="none" stroke="black" d="M10750.95,-8365C10159.28,-8365 8320.5,-8365 8320.5,-8365 8320.5,-8365 8320.5,-7889.27 8320.5,-7889.27"/>
<polygon fill="black" stroke="black" points="8324,-7889.27 8320.5,-7879.27 8317,-7889.27 8324,-7889.27"/>
</g>
<!-- layer_11_expert_5 -->
<g id="node275" class="node">
<title>layer_11_expert_5</title>
<polygon fill="lightblue" stroke="black" points="11112,-7879.17 10750,-7879.17 10750,-7811.17 11112,-7811.17 11112,-7879.17"/>
<text text-anchor="middle" x="10931" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10931" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_5 -->
<g id="edge651" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_5</title>
<path fill="none" stroke="black" d="M11052.22,-8319.05C11052.22,-8319.05 11052.22,-7889.47 11052.22,-7889.47"/>
<polygon fill="black" stroke="black" points="11055.72,-7889.47 11052.22,-7879.47 11048.72,-7889.47 11055.72,-7889.47"/>
</g>
<!-- layer_11_expert_6 -->
<g id="node276" class="node">
<title>layer_11_expert_6</title>
<polygon fill="lightblue" stroke="black" points="9852,-7879.17 9490,-7879.17 9490,-7811.17 9852,-7811.17 9852,-7879.17"/>
<text text-anchor="middle" x="9671" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9671" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_6 -->
<g id="edge654" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_6</title>
<path fill="none" stroke="black" d="M10750.78,-8340C10382.35,-8340 9580.5,-8340 9580.5,-8340 9580.5,-8340 9580.5,-7889.18 9580.5,-7889.18"/>
<polygon fill="black" stroke="black" points="9584,-7889.18 9580.5,-7879.18 9577,-7889.18 9584,-7889.18"/>
</g>
<!-- layer_11_expert_7 -->
<g id="node277" class="node">
<title>layer_11_expert_7</title>
<polygon fill="lightblue" stroke="black" points="12792,-7879.17 12430,-7879.17 12430,-7811.17 12792,-7811.17 12792,-7879.17"/>
<text text-anchor="middle" x="12611" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12611" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_7 -->
<g id="edge657" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_7</title>
<path fill="none" stroke="black" d="M11113.05,-8361C11564.04,-8361 12701.5,-8361 12701.5,-8361 12701.5,-8361 12701.5,-7889.41 12701.5,-7889.41"/>
<polygon fill="black" stroke="black" points="12705,-7889.41 12701.5,-7879.41 12698,-7889.41 12705,-7889.41"/>
</g>
<!-- layer_11_expert_8 -->
<g id="node278" class="node">
<title>layer_11_expert_8</title>
<polygon fill="lightblue" stroke="black" points="7332,-7879.17 6970,-7879.17 6970,-7811.17 7332,-7811.17 7332,-7879.17"/>
<text text-anchor="middle" x="7151" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7151" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_8 -->
<g id="edge660" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_8</title>
<path fill="none" stroke="black" d="M10750.78,-8382C9985.87,-8382 7060.5,-8382 7060.5,-8382 7060.5,-8382 7060.5,-7889.56 7060.5,-7889.56"/>
<polygon fill="black" stroke="black" points="7064,-7889.56 7060.5,-7879.56 7057,-7889.56 7064,-7889.56"/>
</g>
<!-- layer_11_expert_9 -->
<g id="node279" class="node">
<title>layer_11_expert_9</title>
<polygon fill="lightblue" stroke="black" points="13212,-7879.17 12850,-7879.17 12850,-7811.17 13212,-7811.17 13212,-7879.17"/>
<text text-anchor="middle" x="13031" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="13031" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_9 -->
<g id="edge663" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_9</title>
<path fill="none" stroke="black" d="M11113.04,-8370C11637.62,-8370 13121.5,-8370 13121.5,-8370 13121.5,-8370 13121.5,-7889.2 13121.5,-7889.2"/>
<polygon fill="black" stroke="black" points="13125,-7889.2 13121.5,-7879.2 13118,-7889.2 13125,-7889.2"/>
</g>
<!-- layer_11_expert_10 -->
<g id="node280" class="node">
<title>layer_11_expert_10</title>
<polygon fill="lightblue" stroke="black" points="11952,-7879.17 11590,-7879.17 11590,-7811.17 11952,-7811.17 11952,-7879.17"/>
<text text-anchor="middle" x="11771" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="11771" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_10 -->
<g id="edge666" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_10</title>
<path fill="none" stroke="black" d="M11113.02,-8344C11359.66,-8344 11771,-8344 11771,-8344 11771,-8344 11771,-7889.45 11771,-7889.45"/>
<polygon fill="black" stroke="black" points="11774.5,-7889.45 11771,-7879.45 11767.5,-7889.45 11774.5,-7889.45"/>
</g>
<!-- layer_11_expert_11 -->
<g id="node281" class="node">
<title>layer_11_expert_11</title>
<polygon fill="lightblue" stroke="black" points="7752,-7879.17 7390,-7879.17 7390,-7811.17 7752,-7811.17 7752,-7879.17"/>
<text text-anchor="middle" x="7571" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7571" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_11 -->
<g id="edge669" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_11</title>
<path fill="none" stroke="black" d="M10750.99,-8378C10040.39,-8378 7480.5,-8378 7480.5,-8378 7480.5,-8378 7480.5,-7889.31 7480.5,-7889.31"/>
<polygon fill="black" stroke="black" points="7484,-7889.31 7480.5,-7879.31 7477,-7889.31 7484,-7889.31"/>
</g>
<!-- layer_11_expert_12 -->
<g id="node282" class="node">
<title>layer_11_expert_12</title>
<polygon fill="lightblue" stroke="black" points="10272,-7879.17 9910,-7879.17 9910,-7811.17 10272,-7811.17 10272,-7879.17"/>
<text text-anchor="middle" x="10091" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10091" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_12 -->
<g id="edge672" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_12</title>
<path fill="none" stroke="black" d="M10750.81,-8331C10487.08,-8331 10028.57,-8331 10028.57,-8331 10028.57,-8331 10028.57,-7889.33 10028.57,-7889.33"/>
<polygon fill="black" stroke="black" points="10032.07,-7889.33 10028.57,-7879.33 10025.07,-7889.33 10032.07,-7889.33"/>
</g>
<!-- layer_11_expert_13 -->
<g id="node283" class="node">
<title>layer_11_expert_13</title>
<polygon fill="lightblue" stroke="black" points="13632,-7879.17 13270,-7879.17 13270,-7811.17 13632,-7811.17 13632,-7879.17"/>
<text text-anchor="middle" x="13451" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="13451" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_13 -->
<g id="edge675" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_13</title>
<path fill="none" stroke="black" d="M11113.16,-8378C11704.67,-8378 13541.5,-8378 13541.5,-8378 13541.5,-8378 13541.5,-7889.31 13541.5,-7889.31"/>
<polygon fill="black" stroke="black" points="13545,-7889.31 13541.5,-7879.31 13538,-7889.31 13545,-7889.31"/>
</g>
<!-- layer_11_expert_14 -->
<g id="node284" class="node">
<title>layer_11_expert_14</title>
<polygon fill="lightblue" stroke="black" points="11532,-7879.17 11170,-7879.17 11170,-7811.17 11532,-7811.17 11532,-7879.17"/>
<text text-anchor="middle" x="11351" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11351" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_14 -->
<g id="edge678" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_14</title>
<path fill="none" stroke="black" d="M11113.04,-8336C11226.36,-8336 11351,-8336 11351,-8336 11351,-8336 11351,-7889.29 11351,-7889.29"/>
<polygon fill="black" stroke="black" points="11354.5,-7889.29 11351,-7879.29 11347.5,-7889.29 11354.5,-7889.29"/>
</g>
<!-- layer_11_expert_15 -->
<g id="node285" class="node">
<title>layer_11_expert_15</title>
<polygon fill="lightblue" stroke="black" points="10692,-7879.17 10330,-7879.17 10330,-7811.17 10692,-7811.17 10692,-7879.17"/>
<text text-anchor="middle" x="10511" y="-7863.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="10511" y="-7848.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-7833.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-7818.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_expert_15 -->
<g id="edge681" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_expert_15</title>
<path fill="none" stroke="black" d="M10932.65,-8318.93C10932.65,-8231.34 10932.65,-8006 10932.65,-8006 10932.65,-8006 10571.33,-8006 10571.33,-8006 10571.33,-8006 10571.33,-7889.28 10571.33,-7889.28"/>
<polygon fill="black" stroke="black" points="10574.83,-7889.28 10571.33,-7879.28 10567.83,-7889.28 10574.83,-7889.28"/>
</g>
<!-- layer_11_add_norm2 -->
<g id="node286" class="node">
<title>layer_11_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="11025,-7453.17 10663,-7453.17 10663,-7385.17 11025,-7385.17 11025,-7453.17"/>
<text text-anchor="middle" x="10844" y="-7437.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10844" y="-7422.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10844" y="-7407.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10844" y="-7392.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_11_add_norm1&#45;&gt;layer_11_add_norm2 -->
<g id="edge684" class="edge">
<title>layer_11_add_norm1&#45;&gt;layer_11_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11113.14,-8327C11114.48,-8327 11115.2,-8327 11115.2,-8327 11115.2,-8327 11115.2,-7419 11115.2,-7419 11115.2,-7419 11035.27,-7419 11035.27,-7419"/>
<polygon fill="black" stroke="black" points="11035.27,-7415.5 11025.27,-7419 11035.27,-7422.5 11035.27,-7415.5"/>
<text text-anchor="middle" x="13837" y="-7841.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_0 -->
<g id="edge635" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10199.48,-8086C9737.11,-8086 8921.5,-8086 8921.5,-8086 8921.5,-8086 8921.5,-7889.42 8921.5,-7889.42"/>
<polygon fill="black" stroke="black" points="8925,-7889.42 8921.5,-7879.42 8918,-7889.42 8925,-7889.42"/>
<text text-anchor="middle" x="9637.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_1 -->
<g id="edge638" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10178.67,-8067C9833.19,-8067 9341.5,-8067 9341.5,-8067 9341.5,-8067 9341.5,-7889.34 9341.5,-7889.34"/>
<polygon fill="black" stroke="black" points="9345,-7889.34 9341.5,-7879.34 9338,-7889.34 9345,-7889.34"/>
<text text-anchor="middle" x="9981.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_2 -->
<g id="edge641" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10787.5,-8096C11243.3,-8096 12100.5,-8096 12100.5,-8096 12100.5,-8096 12100.5,-7889.26 12100.5,-7889.26"/>
<polygon fill="black" stroke="black" points="12104,-7889.26 12100.5,-7879.26 12097,-7889.26 12104,-7889.26"/>
<text text-anchor="middle" x="11567.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_3 -->
<g id="edge644" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10242,-8125C9610.42,-8125 8081.5,-8125 8081.5,-8125 8081.5,-8125 8081.5,-7889.2 8081.5,-7889.2"/>
<polygon fill="black" stroke="black" points="8085,-7889.2 8081.5,-7879.2 8078,-7889.2 8085,-7889.2"/>
<text text-anchor="middle" x="8872.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_4 -->
<g id="edge647" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10221.16,-8106C9665.37,-8106 8501.5,-8106 8501.5,-8106 8501.5,-8106 8501.5,-7889.27 8501.5,-7889.27"/>
<polygon fill="black" stroke="black" points="8505,-7889.27 8501.5,-7879.27 8498,-7889.27 8505,-7889.27"/>
<text text-anchor="middle" x="9254.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_5 -->
<g id="edge650" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10811.43,-8106.12C10811.43,-8106.12 10811.43,-7889.33 10811.43,-7889.33"/>
<polygon fill="black" stroke="black" points="10814.93,-7889.33 10811.43,-7879.33 10807.93,-7889.33 10814.93,-7889.33"/>
<text text-anchor="middle" x="10776.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_6 -->
<g id="edge653" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10156.85,-8047C9962.96,-8047 9761.5,-8047 9761.5,-8047 9761.5,-8047 9761.5,-7889.4 9761.5,-7889.4"/>
<polygon fill="black" stroke="black" points="9765,-7889.4 9761.5,-7879.4 9758,-7889.4 9765,-7889.4"/>
<text text-anchor="middle" x="10241.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_7 -->
<g id="edge656" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10808.28,-8115C11368.14,-8115 12520.5,-8115 12520.5,-8115 12520.5,-8115 12520.5,-7889.34 12520.5,-7889.34"/>
<polygon fill="black" stroke="black" points="12524,-7889.34 12520.5,-7879.34 12517,-7889.34 12524,-7889.34"/>
<text text-anchor="middle" x="11872.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_8 -->
<g id="edge659" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10284.38,-8164C9544.89,-8164 7241.5,-8164 7241.5,-8164 7241.5,-8164 7241.5,-7889.29 7241.5,-7889.29"/>
<polygon fill="black" stroke="black" points="7245,-7889.29 7241.5,-7879.29 7238,-7889.29 7245,-7889.29"/>
<text text-anchor="middle" x="7883.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_9 -->
<g id="edge662" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10830.24,-8135C11490.23,-8135 12940.5,-8135 12940.5,-8135 12940.5,-8135 12940.5,-7889.27 12940.5,-7889.27"/>
<polygon fill="black" stroke="black" points="12944,-7889.27 12940.5,-7879.27 12937,-7889.27 12944,-7889.27"/>
<text text-anchor="middle" x="12334.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_10 -->
<g id="edge665" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10766.87,-8077C11111.43,-8077 11680.5,-8077 11680.5,-8077 11680.5,-8077 11680.5,-7889.37 11680.5,-7889.37"/>
<polygon fill="black" stroke="black" points="11684,-7889.37 11680.5,-7879.37 11677,-7889.37 11684,-7889.37"/>
<text text-anchor="middle" x="11231.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_11 -->
<g id="edge668" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10263.75,-8145C9572.02,-8145 7661.5,-8145 7661.5,-8145 7661.5,-8145 7661.5,-7889.27 7661.5,-7889.27"/>
<polygon fill="black" stroke="black" points="7665,-7889.27 7661.5,-7879.27 7658,-7889.27 7665,-7889.27"/>
<text text-anchor="middle" x="8340.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_12 -->
<g id="edge671" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10209.57,-8037.93C10209.57,-8037.93 10209.57,-7889.49 10209.57,-7889.49"/>
<polygon fill="black" stroke="black" points="10213.07,-7889.49 10209.57,-7879.49 10206.07,-7889.49 10213.07,-7889.49"/>
<text text-anchor="middle" x="10389.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_13 -->
<g id="edge674" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10851.01,-8154C11607.62,-8154 13360.5,-8154 13360.5,-8154 13360.5,-8154 13360.5,-7889.4 13360.5,-7889.4"/>
<polygon fill="black" stroke="black" points="13364,-7889.4 13360.5,-7879.4 13357,-7889.4 13364,-7889.4"/>
<text text-anchor="middle" x="12730.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_14 -->
<g id="edge677" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10744.89,-8057C10965.04,-8057 11260.5,-8057 11260.5,-8057 11260.5,-8057 11260.5,-7889.2 11260.5,-7889.2"/>
<polygon fill="black" stroke="black" points="11264,-7889.2 11260.5,-7879.2 11257,-7889.2 11264,-7889.2"/>
<text text-anchor="middle" x="11022.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_15 -->
<g id="edge680" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10450.67,-8037.93C10450.67,-8037.93 10450.67,-7889.49 10450.67,-7889.49"/>
<polygon fill="black" stroke="black" points="10454.17,-7889.49 10450.67,-7879.49 10447.17,-7889.49 10454.17,-7889.49"/>
<text text-anchor="middle" x="10536.5" y="-7954.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_11_moe_agg&#45;&gt;layer_11_add_norm2 -->
<g id="edge683" class="edge">
<title>layer_11_moe_agg&#45;&gt;layer_11_add_norm2</title>
<path fill="none" stroke="black" d="M10731,-7597.94C10731,-7597.94 10731,-7463.3 10731,-7463.3"/>
<polygon fill="black" stroke="black" points="10734.5,-7463.3 10731,-7453.3 10727.5,-7463.3 10734.5,-7463.3"/>
</g>
<!-- layer_11_expert_0&#45;&gt;layer_11_moe_agg -->
<g id="edge637" class="edge">
<title>layer_11_expert_0&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M8831,-7810.97C8831,-7747.98 8831,-7620 8831,-7620 8831,-7620 10426.82,-7620 10426.82,-7620"/>
<polygon fill="black" stroke="black" points="10426.82,-7623.5 10436.82,-7620 10426.82,-7616.5 10426.82,-7623.5"/>
</g>
<!-- layer_11_expert_1&#45;&gt;layer_11_moe_agg -->
<g id="edge640" class="edge">
<title>layer_11_expert_1&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M9251,-7810.77C9251,-7748.84 9251,-7625 9251,-7625 9251,-7625 10426.83,-7625 10426.83,-7625"/>
<polygon fill="black" stroke="black" points="10426.83,-7628.5 10436.83,-7625 10426.83,-7621.5 10426.83,-7628.5"/>
</g>
<!-- layer_11_expert_2&#45;&gt;layer_11_moe_agg -->
<g id="edge643" class="edge">
<title>layer_11_expert_2&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M12191,-7810.79C12191,-7751.67 12191,-7637 12191,-7637 12191,-7637 10809.21,-7637 10809.21,-7637"/>
<polygon fill="black" stroke="black" points="10809.21,-7633.5 10799.21,-7637 10809.21,-7640.5 10809.21,-7633.5"/>
</g>
<!-- layer_11_expert_3&#45;&gt;layer_11_moe_agg -->
<g id="edge646" class="edge">
<title>layer_11_expert_3&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M7991,-7811.12C7991,-7746.17 7991,-7611 7991,-7611 7991,-7611 10426.92,-7611 10426.92,-7611"/>
<polygon fill="black" stroke="black" points="10426.92,-7614.5 10436.92,-7611 10426.92,-7607.5 10426.92,-7614.5"/>
</g>
<!-- layer_11_expert_4&#45;&gt;layer_11_moe_agg -->
<g id="edge649" class="edge">
<title>layer_11_expert_4&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M8411,-7810.86C8411,-7746.93 8411,-7616 8411,-7616 8411,-7616 10426.92,-7616 10426.92,-7616"/>
<polygon fill="black" stroke="black" points="10426.92,-7619.5 10436.92,-7616 10426.92,-7612.5 10426.92,-7619.5"/>
</g>
<!-- layer_11_expert_5&#45;&gt;layer_11_moe_agg -->
<g id="edge652" class="edge">
<title>layer_11_expert_5&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M10774.5,-7810.94C10774.5,-7810.94 10774.5,-7676.3 10774.5,-7676.3"/>
<polygon fill="black" stroke="black" points="10778,-7676.3 10774.5,-7666.3 10771,-7676.3 10778,-7676.3"/>
</g>
<!-- layer_11_expert_6&#45;&gt;layer_11_moe_agg -->
<g id="edge655" class="edge">
<title>layer_11_expert_6&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M9671,-7810.91C9671,-7749.96 9671,-7629 9671,-7629 9671,-7629 10426.81,-7629 10426.81,-7629"/>
<polygon fill="black" stroke="black" points="10426.81,-7632.5 10436.81,-7629 10426.81,-7625.5 10426.81,-7632.5"/>
</g>
<!-- layer_11_expert_7&#45;&gt;layer_11_moe_agg -->
<g id="edge658" class="edge">
<title>layer_11_expert_7&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M12611,-7811.08C12611,-7749.72 12611,-7627 12611,-7627 12611,-7627 10809.26,-7627 10809.26,-7627"/>
<polygon fill="black" stroke="black" points="10809.26,-7623.5 10799.26,-7627 10809.26,-7630.5 10809.26,-7623.5"/>
</g>
<!-- layer_11_expert_8&#45;&gt;layer_11_moe_agg -->
<g id="edge661" class="edge">
<title>layer_11_expert_8&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M7151,-7811.1C7151,-7744.18 7151,-7602 7151,-7602 7151,-7602 10426.78,-7602 10426.78,-7602"/>
<polygon fill="black" stroke="black" points="10426.78,-7605.5 10436.78,-7602 10426.78,-7598.5 10426.78,-7605.5"/>
</g>
<!-- layer_11_expert_9&#45;&gt;layer_11_moe_agg -->
<g id="edge664" class="edge">
<title>layer_11_expert_9&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M13031,-7811.01C13031,-7747.36 13031,-7617 13031,-7617 13031,-7617 10809.37,-7617 10809.37,-7617"/>
<polygon fill="black" stroke="black" points="10809.37,-7613.5 10799.37,-7617 10809.37,-7620.5 10809.37,-7613.5"/>
</g>
<!-- layer_11_expert_10&#45;&gt;layer_11_moe_agg -->
<g id="edge667" class="edge">
<title>layer_11_expert_10&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M11771,-7810.93C11771,-7753.98 11771,-7646 11771,-7646 11771,-7646 10809.11,-7646 10809.11,-7646"/>
<polygon fill="black" stroke="black" points="10809.11,-7642.5 10799.11,-7646 10809.11,-7649.5 10809.11,-7642.5"/>
</g>
<!-- layer_11_expert_11&#45;&gt;layer_11_moe_agg -->
<g id="edge670" class="edge">
<title>layer_11_expert_11&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M7571,-7811.04C7571,-7745.19 7571,-7607 7571,-7607 7571,-7607 10426.8,-7607 10426.8,-7607"/>
<polygon fill="black" stroke="black" points="10426.8,-7610.5 10436.8,-7607 10426.8,-7603.5 10426.8,-7610.5"/>
</g>
<!-- layer_11_expert_12&#45;&gt;layer_11_moe_agg -->
<g id="edge673" class="edge">
<title>layer_11_expert_12&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M10166.07,-7810.77C10166.07,-7750.93 10166.07,-7634 10166.07,-7634 10166.07,-7634 10426.79,-7634 10426.79,-7634"/>
<polygon fill="black" stroke="black" points="10426.79,-7637.5 10436.79,-7634 10426.79,-7630.5 10426.79,-7637.5"/>
</g>
<!-- layer_11_expert_13&#45;&gt;layer_11_moe_agg -->
<g id="edge676" class="edge">
<title>layer_11_expert_13&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M13451,-7811.04C13451,-7745.19 13451,-7607 13451,-7607 13451,-7607 10809.26,-7607 10809.26,-7607"/>
<polygon fill="black" stroke="black" points="10809.26,-7603.5 10799.26,-7607 10809.26,-7610.5 10809.26,-7603.5"/>
</g>
<!-- layer_11_expert_14&#45;&gt;layer_11_moe_agg -->
<g id="edge679" class="edge">
<title>layer_11_expert_14&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M11351,-7810.91C11351,-7756.4 11351,-7656 11351,-7656 11351,-7656 10809.19,-7656 10809.19,-7656"/>
<polygon fill="black" stroke="black" points="10809.19,-7652.5 10799.19,-7656 10809.19,-7659.5 10809.19,-7652.5"/>
</g>
<!-- layer_11_expert_15&#45;&gt;layer_11_moe_agg -->
<g id="edge682" class="edge">
<title>layer_11_expert_15&#45;&gt;layer_11_moe_agg</title>
<path fill="none" stroke="black" d="M10564.5,-7810.94C10564.5,-7810.94 10564.5,-7676.3 10564.5,-7676.3"/>
<polygon fill="black" stroke="black" points="10568,-7676.3 10564.5,-7666.3 10561,-7676.3 10568,-7676.3"/>
</g>
<!-- layer_12_qkv -->
<g id="node287" class="node">
<title>layer_12_qkv</title>
<polygon fill="lightblue" stroke="black" points="10851.5,-7240.17 10442.5,-7240.17 10442.5,-7172.17 10851.5,-7172.17 10851.5,-7240.17"/>
<text text-anchor="middle" x="10647" y="-7224.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10647" y="-7209.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10647" y="-7194.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10647" y="-7179.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_11_add_norm2&#45;&gt;layer_12_qkv -->
<g id="edge685" class="edge">
<title>layer_11_add_norm2&#45;&gt;layer_12_qkv</title>
<path fill="none" stroke="black" d="M10757.25,-7384.94C10757.25,-7384.94 10757.25,-7250.3 10757.25,-7250.3"/>
<polygon fill="black" stroke="black" points="10760.75,-7250.3 10757.25,-7240.3 10753.75,-7250.3 10760.75,-7250.3"/>
</g>
<!-- layer_12_add_norm1 -->
<g id="node290" class="node">
<title>layer_12_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="11026,-6601.17 10664,-6601.17 10664,-6533.17 11026,-6533.17 11026,-6601.17"/>
<text text-anchor="middle" x="10845" y="-6585.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10845" y="-6570.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10845" y="-6555.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10845" y="-6540.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_11_add_norm2&#45;&gt;layer_12_add_norm1 -->
<g id="edge689" class="edge">
<title>layer_11_add_norm2&#45;&gt;layer_12_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10938.25,-7384.98C10938.25,-7384.98 10938.25,-6611.62 10938.25,-6611.62"/>
<polygon fill="black" stroke="black" points="10941.75,-6611.62 10938.25,-6601.62 10934.75,-6611.62 10941.75,-6611.62"/>
<text text-anchor="middle" x="10955" y="-6989.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_12_attn -->
<g id="node288" class="node">
<title>layer_12_attn</title>
<polygon fill="lightblue" stroke="black" points="10809.5,-7027.17 10400.5,-7027.17 10400.5,-6959.17 10809.5,-6959.17 10809.5,-7027.17"/>
<text text-anchor="middle" x="10605" y="-7011.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10605" y="-6996.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10605" y="-6981.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10605" y="-6966.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_12_qkv&#45;&gt;layer_12_attn -->
<g id="edge686" class="edge">
<title>layer_12_qkv&#45;&gt;layer_12_attn</title>
<path fill="none" stroke="black" d="M10626,-7171.94C10626,-7171.94 10626,-7037.3 10626,-7037.3"/>
<polygon fill="black" stroke="black" points="10629.5,-7037.3 10626,-7027.3 10622.5,-7037.3 10629.5,-7037.3"/>
</g>
<!-- layer_12_proj -->
<g id="node289" class="node">
<title>layer_12_proj</title>
<polygon fill="lightblue" stroke="black" points="10850.5,-6814.17 10453.5,-6814.17 10453.5,-6746.17 10850.5,-6746.17 10850.5,-6814.17"/>
<text text-anchor="middle" x="10652" y="-6798.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="10652" y="-6783.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10652" y="-6768.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10652" y="-6753.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_12_attn&#45;&gt;layer_12_proj -->
<g id="edge687" class="edge">
<title>layer_12_attn&#45;&gt;layer_12_proj</title>
<path fill="none" stroke="black" d="M10631.5,-6958.94C10631.5,-6958.94 10631.5,-6824.3 10631.5,-6824.3"/>
<polygon fill="black" stroke="black" points="10635,-6824.3 10631.5,-6814.3 10628,-6824.3 10635,-6824.3"/>
</g>
<!-- layer_12_proj&#45;&gt;layer_12_add_norm1 -->
<g id="edge688" class="edge">
<title>layer_12_proj&#45;&gt;layer_12_add_norm1</title>
<path fill="none" stroke="black" d="M10757.25,-6745.94C10757.25,-6745.94 10757.25,-6611.3 10757.25,-6611.3"/>
<polygon fill="black" stroke="black" points="10760.75,-6611.3 10757.25,-6601.3 10753.75,-6611.3 10760.75,-6611.3"/>
</g>
<!-- layer_12_gate -->
<g id="node291" class="node">
<title>layer_12_gate</title>
<polygon fill="yellow" stroke="black" points="10785.73,-6388.17 10208.71,-6388.17 10060.27,-6252.17 10637.29,-6252.17 10785.73,-6388.17"/>
<text text-anchor="middle" x="10423" y="-6338.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="10423" y="-6323.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10423" y="-6308.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="10423" y="-6293.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_gate -->
<g id="edge690" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_gate</title>
<path fill="none" stroke="black" d="M10724.93,-6533.08C10724.93,-6533.08 10724.93,-6398.37 10724.93,-6398.37"/>
<polygon fill="black" stroke="black" points="10728.43,-6398.37 10724.93,-6388.37 10721.43,-6398.37 10728.43,-6398.37"/>
</g>
<!-- layer_12_moe_agg -->
<g id="node292" class="node">
<title>layer_12_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="11057,-5880.17 10695,-5880.17 10695,-5812.17 11057,-5812.17 11057,-5880.17"/>
<text text-anchor="middle" x="10876" y="-5864.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="10876" y="-5849.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10876" y="-5834.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10876" y="-5819.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_moe_agg -->
<g id="edge691" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M10905.93,-6532.85C10905.93,-6439.51 10905.93,-6188 10905.93,-6188 10905.93,-6188 10731.67,-6188 10731.67,-6188 10731.67,-6188 10731.67,-5890.19 10731.67,-5890.19"/>
<polygon fill="black" stroke="black" points="10735.17,-5890.19 10731.67,-5880.19 10728.17,-5890.19 10735.17,-5890.19"/>
</g>
<!-- layer_12_expert_0 -->
<g id="node293" class="node">
<title>layer_12_expert_0</title>
<polygon fill="lightblue" stroke="black" points="9012,-6093.17 8650,-6093.17 8650,-6025.17 9012,-6025.17 9012,-6093.17"/>
<text text-anchor="middle" x="8831" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8831" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_0 -->
<g id="edge693" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_0</title>
<path fill="none" stroke="black" d="M10663.75,-6571C10153.27,-6571 8740.5,-6571 8740.5,-6571 8740.5,-6571 8740.5,-6103.54 8740.5,-6103.54"/>
<polygon fill="black" stroke="black" points="8744,-6103.54 8740.5,-6093.54 8737,-6103.54 8744,-6103.54"/>
</g>
<!-- layer_12_expert_1 -->
<g id="node294" class="node">
<title>layer_12_expert_1</title>
<polygon fill="lightblue" stroke="black" points="9432,-6093.17 9070,-6093.17 9070,-6025.17 9432,-6025.17 9432,-6093.17"/>
<text text-anchor="middle" x="9251" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9251" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_1 -->
<g id="edge696" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_1</title>
<path fill="none" stroke="black" d="M10663.93,-6562C10228.86,-6562 9160.5,-6562 9160.5,-6562 9160.5,-6562 9160.5,-6103.33 9160.5,-6103.33"/>
<polygon fill="black" stroke="black" points="9164,-6103.33 9160.5,-6093.33 9157,-6103.33 9164,-6103.33"/>
</g>
<!-- layer_12_expert_2 -->
<g id="node295" class="node">
<title>layer_12_expert_2</title>
<polygon fill="lightblue" stroke="black" points="12372,-6093.17 12010,-6093.17 12010,-6025.17 12372,-6025.17 12372,-6093.17"/>
<text text-anchor="middle" x="12191" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12191" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_2 -->
<g id="edge699" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_2</title>
<path fill="none" stroke="black" d="M11026.21,-6567C11412.38,-6567 12281.5,-6567 12281.5,-6567 12281.5,-6567 12281.5,-6103.28 12281.5,-6103.28"/>
<polygon fill="black" stroke="black" points="12285,-6103.28 12281.5,-6093.28 12278,-6103.28 12285,-6103.28"/>
</g>
<!-- layer_12_expert_3 -->
<g id="node296" class="node">
<title>layer_12_expert_3</title>
<polygon fill="lightblue" stroke="black" points="8172,-6093.17 7810,-6093.17 7810,-6025.17 8172,-6025.17 8172,-6093.17"/>
<text text-anchor="middle" x="7991" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7991" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_3 -->
<g id="edge702" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_3</title>
<path fill="none" stroke="black" d="M10663.86,-6588C10022.89,-6588 7900.5,-6588 7900.5,-6588 7900.5,-6588 7900.5,-6103.46 7900.5,-6103.46"/>
<polygon fill="black" stroke="black" points="7904,-6103.46 7900.5,-6093.46 7897,-6103.46 7904,-6103.46"/>
</g>
<!-- layer_12_expert_4 -->
<g id="node297" class="node">
<title>layer_12_expert_4</title>
<polygon fill="lightblue" stroke="black" points="8592,-6093.17 8230,-6093.17 8230,-6025.17 8592,-6025.17 8592,-6093.17"/>
<text text-anchor="middle" x="8411" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8411" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_4 -->
<g id="edge705" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_4</title>
<path fill="none" stroke="black" d="M10663.95,-6579C10085.63,-6579 8320.5,-6579 8320.5,-6579 8320.5,-6579 8320.5,-6103.27 8320.5,-6103.27"/>
<polygon fill="black" stroke="black" points="8324,-6103.27 8320.5,-6093.27 8317,-6103.27 8324,-6103.27"/>
</g>
<!-- layer_12_expert_5 -->
<g id="node298" class="node">
<title>layer_12_expert_5</title>
<polygon fill="lightblue" stroke="black" points="11112,-6093.17 10750,-6093.17 10750,-6025.17 11112,-6025.17 11112,-6093.17"/>
<text text-anchor="middle" x="10931" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10931" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_5 -->
<g id="edge708" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_5</title>
<path fill="none" stroke="black" d="M10965.97,-6533.05C10965.97,-6533.05 10965.97,-6103.47 10965.97,-6103.47"/>
<polygon fill="black" stroke="black" points="10969.47,-6103.47 10965.97,-6093.47 10962.47,-6103.47 10969.47,-6103.47"/>
</g>
<!-- layer_12_expert_6 -->
<g id="node299" class="node">
<title>layer_12_expert_6</title>
<polygon fill="lightblue" stroke="black" points="9852,-6093.17 9490,-6093.17 9490,-6025.17 9852,-6025.17 9852,-6093.17"/>
<text text-anchor="middle" x="9671" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9671" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_6 -->
<g id="edge711" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_6</title>
<path fill="none" stroke="black" d="M10663.83,-6554C10314.18,-6554 9580.5,-6554 9580.5,-6554 9580.5,-6554 9580.5,-6103.18 9580.5,-6103.18"/>
<polygon fill="black" stroke="black" points="9584,-6103.18 9580.5,-6093.18 9577,-6103.18 9584,-6103.18"/>
</g>
<!-- layer_12_expert_7 -->
<g id="node300" class="node">
<title>layer_12_expert_7</title>
<polygon fill="lightblue" stroke="black" points="12792,-6093.17 12430,-6093.17 12430,-6025.17 12792,-6025.17 12792,-6093.17"/>
<text text-anchor="middle" x="12611" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12611" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_7 -->
<g id="edge714" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_7</title>
<path fill="none" stroke="black" d="M11026.39,-6575C11493.53,-6575 12701.5,-6575 12701.5,-6575 12701.5,-6575 12701.5,-6103.41 12701.5,-6103.41"/>
<polygon fill="black" stroke="black" points="12705,-6103.41 12701.5,-6093.41 12698,-6103.41 12705,-6103.41"/>
</g>
<!-- layer_12_expert_8 -->
<g id="node301" class="node">
<title>layer_12_expert_8</title>
<polygon fill="lightblue" stroke="black" points="7332,-6093.17 6970,-6093.17 6970,-6025.17 7332,-6025.17 7332,-6093.17"/>
<text text-anchor="middle" x="7151" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7151" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_8 -->
<g id="edge717" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_8</title>
<path fill="none" stroke="black" d="M10663.74,-6596C9909.7,-6596 7060.5,-6596 7060.5,-6596 7060.5,-6596 7060.5,-6103.56 7060.5,-6103.56"/>
<polygon fill="black" stroke="black" points="7064,-6103.56 7060.5,-6093.56 7057,-6103.56 7064,-6103.56"/>
</g>
<!-- layer_12_expert_9 -->
<g id="node302" class="node">
<title>layer_12_expert_9</title>
<polygon fill="lightblue" stroke="black" points="13212,-6093.17 12850,-6093.17 12850,-6025.17 13212,-6025.17 13212,-6093.17"/>
<text text-anchor="middle" x="13031" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="13031" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_9 -->
<g id="edge720" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_9</title>
<path fill="none" stroke="black" d="M11026.01,-6584C11564.9,-6584 13121.5,-6584 13121.5,-6584 13121.5,-6584 13121.5,-6103.2 13121.5,-6103.2"/>
<polygon fill="black" stroke="black" points="13125,-6103.2 13121.5,-6093.2 13118,-6103.2 13125,-6103.2"/>
</g>
<!-- layer_12_expert_10 -->
<g id="node303" class="node">
<title>layer_12_expert_10</title>
<polygon fill="lightblue" stroke="black" points="11952,-6093.17 11590,-6093.17 11590,-6025.17 11952,-6025.17 11952,-6093.17"/>
<text text-anchor="middle" x="11771" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="11771" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_10 -->
<g id="edge723" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_10</title>
<path fill="none" stroke="black" d="M11026.14,-6558C11318.39,-6558 11861.5,-6558 11861.5,-6558 11861.5,-6558 11861.5,-6103.45 11861.5,-6103.45"/>
<polygon fill="black" stroke="black" points="11865,-6103.45 11861.5,-6093.45 11858,-6103.45 11865,-6103.45"/>
</g>
<!-- layer_12_expert_11 -->
<g id="node304" class="node">
<title>layer_12_expert_11</title>
<polygon fill="lightblue" stroke="black" points="7752,-6093.17 7390,-6093.17 7390,-6025.17 7752,-6025.17 7752,-6093.17"/>
<text text-anchor="middle" x="7571" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7571" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_11 -->
<g id="edge726" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_11</title>
<path fill="none" stroke="black" d="M10663.81,-6592C9964.56,-6592 7480.5,-6592 7480.5,-6592 7480.5,-6592 7480.5,-6103.31 7480.5,-6103.31"/>
<polygon fill="black" stroke="black" points="7484,-6103.31 7480.5,-6093.31 7477,-6103.31 7484,-6103.31"/>
</g>
<!-- layer_12_expert_12 -->
<g id="node305" class="node">
<title>layer_12_expert_12</title>
<polygon fill="lightblue" stroke="black" points="10272,-6093.17 9910,-6093.17 9910,-6025.17 10272,-6025.17 10272,-6093.17"/>
<text text-anchor="middle" x="10091" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10091" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_12 -->
<g id="edge729" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_12</title>
<path fill="none" stroke="black" d="M10663.94,-6545C10411.68,-6545 9985.07,-6545 9985.07,-6545 9985.07,-6545 9985.07,-6103.33 9985.07,-6103.33"/>
<polygon fill="black" stroke="black" points="9988.57,-6103.33 9985.07,-6093.33 9981.57,-6103.33 9988.57,-6103.33"/>
</g>
<!-- layer_12_expert_13 -->
<g id="node306" class="node">
<title>layer_12_expert_13</title>
<polygon fill="lightblue" stroke="black" points="13632,-6093.17 13270,-6093.17 13270,-6025.17 13632,-6025.17 13632,-6093.17"/>
<text text-anchor="middle" x="13451" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="13451" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_13 -->
<g id="edge732" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_13</title>
<path fill="none" stroke="black" d="M11026.11,-6592C11630.7,-6592 13541.5,-6592 13541.5,-6592 13541.5,-6592 13541.5,-6103.31 13541.5,-6103.31"/>
<polygon fill="black" stroke="black" points="13545,-6103.31 13541.5,-6093.31 13538,-6103.31 13545,-6103.31"/>
</g>
<!-- layer_12_expert_14 -->
<g id="node307" class="node">
<title>layer_12_expert_14</title>
<polygon fill="lightblue" stroke="black" points="11532,-6093.17 11170,-6093.17 11170,-6025.17 11532,-6025.17 11532,-6093.17"/>
<text text-anchor="middle" x="11351" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11351" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_14 -->
<g id="edge735" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_14</title>
<path fill="none" stroke="black" d="M11026.4,-6550C11201.89,-6550 11441.5,-6550 11441.5,-6550 11441.5,-6550 11441.5,-6103.29 11441.5,-6103.29"/>
<polygon fill="black" stroke="black" points="11445,-6103.29 11441.5,-6093.29 11438,-6103.29 11445,-6103.29"/>
</g>
<!-- layer_12_expert_15 -->
<g id="node308" class="node">
<title>layer_12_expert_15</title>
<polygon fill="lightblue" stroke="black" points="10692,-6093.17 10330,-6093.17 10330,-6025.17 10692,-6025.17 10692,-6093.17"/>
<text text-anchor="middle" x="10511" y="-6077.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="10511" y="-6062.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-6047.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-6032.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_expert_15 -->
<g id="edge738" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_expert_15</title>
<path fill="none" stroke="black" d="M10845.9,-6532.93C10845.9,-6445.34 10845.9,-6220 10845.9,-6220 10845.9,-6220 10571.33,-6220 10571.33,-6220 10571.33,-6220 10571.33,-6103.28 10571.33,-6103.28"/>
<polygon fill="black" stroke="black" points="10574.83,-6103.28 10571.33,-6093.28 10567.83,-6103.28 10574.83,-6103.28"/>
</g>
<!-- layer_12_add_norm2 -->
<g id="node309" class="node">
<title>layer_12_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="11058,-5667.17 10696,-5667.17 10696,-5599.17 11058,-5599.17 11058,-5667.17"/>
<text text-anchor="middle" x="10877" y="-5651.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10877" y="-5636.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10877" y="-5621.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10877" y="-5606.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_12_add_norm1&#45;&gt;layer_12_add_norm2 -->
<g id="edge741" class="edge">
<title>layer_12_add_norm1&#45;&gt;layer_12_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11026.33,-6541C11077.87,-6541 11120.3,-6541 11120.3,-6541 11120.3,-6541 11120.3,-5633 11120.3,-5633 11120.3,-5633 11068.28,-5633 11068.28,-5633"/>
<polygon fill="black" stroke="black" points="11068.28,-5629.5 11058.28,-5633 11068.28,-5636.5 11068.28,-5629.5"/>
<text text-anchor="middle" x="13837" y="-6055.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_0 -->
<g id="edge692" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10112.34,-6300C9672.61,-6300 8921.5,-6300 8921.5,-6300 8921.5,-6300 8921.5,-6103.42 8921.5,-6103.42"/>
<polygon fill="black" stroke="black" points="8925,-6103.42 8921.5,-6093.42 8918,-6103.42 8925,-6103.42"/>
<text text-anchor="middle" x="9646.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_1 -->
<g id="edge695" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10091.53,-6281C9773.59,-6281 9341.5,-6281 9341.5,-6281 9341.5,-6281 9341.5,-6103.34 9341.5,-6103.34"/>
<polygon fill="black" stroke="black" points="9345,-6103.34 9341.5,-6093.34 9338,-6103.34 9345,-6103.34"/>
<text text-anchor="middle" x="9926.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_2 -->
<g id="edge698" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10700.48,-6310C11177.07,-6310 12100.5,-6310 12100.5,-6310 12100.5,-6310 12100.5,-6103.26 12100.5,-6103.26"/>
<polygon fill="black" stroke="black" points="12104,-6103.26 12100.5,-6093.26 12097,-6103.26 12104,-6103.26"/>
<text text-anchor="middle" x="11589.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_3 -->
<g id="edge701" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10154.97,-6339C9540.27,-6339 8081.5,-6339 8081.5,-6339 8081.5,-6339 8081.5,-6103.2 8081.5,-6103.2"/>
<polygon fill="black" stroke="black" points="8085,-6103.2 8081.5,-6093.2 8078,-6103.2 8085,-6103.2"/>
<text text-anchor="middle" x="8723.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_4 -->
<g id="edge704" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10134.29,-6320C9597.88,-6320 8501.5,-6320 8501.5,-6320 8501.5,-6320 8501.5,-6103.27 8501.5,-6103.27"/>
<polygon fill="black" stroke="black" points="8505,-6103.27 8501.5,-6093.27 8498,-6103.27 8505,-6103.27"/>
<text text-anchor="middle" x="9179.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_5 -->
<g id="edge707" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10767.93,-6320.12C10767.93,-6320.12 10767.93,-6103.33 10767.93,-6103.33"/>
<polygon fill="black" stroke="black" points="10771.43,-6103.33 10767.93,-6093.33 10764.43,-6103.33 10771.43,-6103.33"/>
<text text-anchor="middle" x="10689.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_6 -->
<g id="edge710" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10069.49,-6261C9912.04,-6261 9761.5,-6261 9761.5,-6261 9761.5,-6261 9761.5,-6103.4 9761.5,-6103.4"/>
<polygon fill="black" stroke="black" points="9765,-6103.4 9761.5,-6093.4 9758,-6103.4 9765,-6103.4"/>
<text text-anchor="middle" x="10154.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_7 -->
<g id="edge713" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10721.29,-6329C11300.38,-6329 12520.5,-6329 12520.5,-6329 12520.5,-6329 12520.5,-6103.34 12520.5,-6103.34"/>
<polygon fill="black" stroke="black" points="12524,-6103.34 12520.5,-6093.34 12517,-6103.34 12524,-6103.34"/>
<text text-anchor="middle" x="11963.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_8 -->
<g id="edge716" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10197.38,-6378C9471.2,-6378 7241.5,-6378 7241.5,-6378 7241.5,-6378 7241.5,-6103.29 7241.5,-6103.29"/>
<polygon fill="black" stroke="black" points="7245,-6103.29 7241.5,-6093.29 7238,-6103.29 7245,-6103.29"/>
<text text-anchor="middle" x="7995.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_9 -->
<g id="edge719" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10743.12,-6349C11421.18,-6349 12940.5,-6349 12940.5,-6349 12940.5,-6349 12940.5,-6103.27 12940.5,-6103.27"/>
<polygon fill="black" stroke="black" points="12944,-6103.27 12940.5,-6093.27 12937,-6103.27 12944,-6103.27"/>
<text text-anchor="middle" x="12380.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_10 -->
<g id="edge722" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10679.75,-6291C11047.54,-6291 11680.5,-6291 11680.5,-6291 11680.5,-6291 11680.5,-6103.37 11680.5,-6103.37"/>
<polygon fill="black" stroke="black" points="11684,-6103.37 11680.5,-6093.37 11677,-6103.37 11684,-6103.37"/>
<text text-anchor="middle" x="11206.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_11 -->
<g id="edge725" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10176.72,-6359C9499.89,-6359 7661.5,-6359 7661.5,-6359 7661.5,-6359 7661.5,-6103.27 7661.5,-6103.27"/>
<polygon fill="black" stroke="black" points="7665,-6103.27 7661.5,-6093.27 7658,-6103.27 7665,-6103.27"/>
<text text-anchor="middle" x="8304.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_12 -->
<g id="edge728" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10166.07,-6251.93C10166.07,-6251.93 10166.07,-6103.49 10166.07,-6103.49"/>
<polygon fill="black" stroke="black" points="10169.57,-6103.49 10166.07,-6093.49 10162.57,-6103.49 10169.57,-6103.49"/>
<text text-anchor="middle" x="10346.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_13 -->
<g id="edge731" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10763.92,-6368C11537.77,-6368 13360.5,-6368 13360.5,-6368 13360.5,-6368 13360.5,-6103.4 13360.5,-6103.4"/>
<polygon fill="black" stroke="black" points="13364,-6103.4 13360.5,-6093.4 13357,-6103.4 13364,-6103.4"/>
<text text-anchor="middle" x="12667.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_14 -->
<g id="edge734" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10657.96,-6271C10905.7,-6271 11260.5,-6271 11260.5,-6271 11260.5,-6271 11260.5,-6103.2 11260.5,-6103.2"/>
<polygon fill="black" stroke="black" points="11264,-6103.2 11260.5,-6093.2 11257,-6103.2 11264,-6103.2"/>
<text text-anchor="middle" x="10935.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_15 -->
<g id="edge737" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10450.67,-6251.93C10450.67,-6251.93 10450.67,-6103.49 10450.67,-6103.49"/>
<polygon fill="black" stroke="black" points="10454.17,-6103.49 10450.67,-6093.49 10447.17,-6103.49 10454.17,-6103.49"/>
<text text-anchor="middle" x="10493.5" y="-6168.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_12_moe_agg&#45;&gt;layer_12_add_norm2 -->
<g id="edge740" class="edge">
<title>layer_12_moe_agg&#45;&gt;layer_12_add_norm2</title>
<path fill="none" stroke="black" d="M10876.5,-5811.94C10876.5,-5811.94 10876.5,-5677.3 10876.5,-5677.3"/>
<polygon fill="black" stroke="black" points="10880,-5677.3 10876.5,-5667.3 10873,-5677.3 10880,-5677.3"/>
</g>
<!-- layer_12_expert_0&#45;&gt;layer_12_moe_agg -->
<g id="edge694" class="edge">
<title>layer_12_expert_0&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M8831,-6024.82C8831,-5968.33 8831,-5862 8831,-5862 8831,-5862 10684.97,-5862 10684.97,-5862"/>
<polygon fill="black" stroke="black" points="10684.97,-5865.5 10694.97,-5862 10684.97,-5858.5 10684.97,-5865.5"/>
</g>
<!-- layer_12_expert_1&#45;&gt;layer_12_moe_agg -->
<g id="edge697" class="edge">
<title>layer_12_expert_1&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M9251,-6025.08C9251,-5969.62 9251,-5866 9251,-5866 9251,-5866 10684.71,-5866 10684.71,-5866"/>
<polygon fill="black" stroke="black" points="10684.71,-5869.5 10694.71,-5866 10684.71,-5862.5 10684.71,-5869.5"/>
</g>
<!-- layer_12_expert_2&#45;&gt;layer_12_moe_agg -->
<g id="edge700" class="edge">
<title>layer_12_expert_2&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M12281.5,-6024.79C12281.5,-5965.67 12281.5,-5851 12281.5,-5851 12281.5,-5851 11067.23,-5851 11067.23,-5851"/>
<polygon fill="black" stroke="black" points="11067.23,-5847.5 11057.23,-5851 11067.23,-5854.5 11067.23,-5847.5"/>
</g>
<!-- layer_12_expert_3&#45;&gt;layer_12_moe_agg -->
<g id="edge703" class="edge">
<title>layer_12_expert_3&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M7991,-6024.96C7991,-5966.12 7991,-5852 7991,-5852 7991,-5852 10684.98,-5852 10684.98,-5852"/>
<polygon fill="black" stroke="black" points="10684.98,-5855.5 10694.98,-5852 10684.98,-5848.5 10684.98,-5855.5"/>
</g>
<!-- layer_12_expert_4&#45;&gt;layer_12_moe_agg -->
<g id="edge706" class="edge">
<title>layer_12_expert_4&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M8411,-6024.87C8411,-5967.19 8411,-5857 8411,-5857 8411,-5857 10684.74,-5857 10684.74,-5857"/>
<polygon fill="black" stroke="black" points="10684.74,-5860.5 10694.74,-5857 10684.74,-5853.5 10684.74,-5860.5"/>
</g>
<!-- layer_12_expert_5&#45;&gt;layer_12_moe_agg -->
<g id="edge709" class="edge">
<title>layer_12_expert_5&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M10903.5,-6024.94C10903.5,-6024.94 10903.5,-5890.3 10903.5,-5890.3"/>
<polygon fill="black" stroke="black" points="10907,-5890.3 10903.5,-5880.3 10900,-5890.3 10907,-5890.3"/>
</g>
<!-- layer_12_expert_6&#45;&gt;layer_12_moe_agg -->
<g id="edge712" class="edge">
<title>layer_12_expert_6&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M9671,-6025.09C9671,-5970.87 9671,-5871 9671,-5871 9671,-5871 10684.95,-5871 10684.95,-5871"/>
<polygon fill="black" stroke="black" points="10684.95,-5874.5 10694.95,-5871 10684.95,-5867.5 10684.95,-5874.5"/>
</g>
<!-- layer_12_expert_7&#45;&gt;layer_12_moe_agg -->
<g id="edge715" class="edge">
<title>layer_12_expert_7&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M12701.5,-6025.08C12701.5,-5963.72 12701.5,-5841 12701.5,-5841 12701.5,-5841 11067.29,-5841 11067.29,-5841"/>
<polygon fill="black" stroke="black" points="11067.29,-5837.5 11057.29,-5841 11067.29,-5844.5 11067.29,-5837.5"/>
</g>
<!-- layer_12_expert_8&#45;&gt;layer_12_moe_agg -->
<g id="edge718" class="edge">
<title>layer_12_expert_8&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M7151,-6024.91C7151,-5963.96 7151,-5843 7151,-5843 7151,-5843 10684.76,-5843 10684.76,-5843"/>
<polygon fill="black" stroke="black" points="10684.76,-5846.5 10694.76,-5843 10684.76,-5839.5 10684.76,-5846.5"/>
</g>
<!-- layer_12_expert_9&#45;&gt;layer_12_moe_agg -->
<g id="edge721" class="edge">
<title>layer_12_expert_9&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M13121.5,-6025.01C13121.5,-5961.36 13121.5,-5831 13121.5,-5831 13121.5,-5831 11067.38,-5831 11067.38,-5831"/>
<polygon fill="black" stroke="black" points="11067.38,-5827.5 11057.38,-5831 11067.38,-5834.5 11067.38,-5827.5"/>
</g>
<!-- layer_12_expert_10&#45;&gt;layer_12_moe_agg -->
<g id="edge724" class="edge">
<title>layer_12_expert_10&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M11861.5,-6024.93C11861.5,-5967.98 11861.5,-5860 11861.5,-5860 11861.5,-5860 11067.04,-5860 11067.04,-5860"/>
<polygon fill="black" stroke="black" points="11067.04,-5856.5 11057.04,-5860 11067.04,-5863.5 11067.04,-5856.5"/>
</g>
<!-- layer_12_expert_11&#45;&gt;layer_12_moe_agg -->
<g id="edge727" class="edge">
<title>layer_12_expert_11&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M7571,-6024.77C7571,-5964.93 7571,-5848 7571,-5848 7571,-5848 10684.78,-5848 10684.78,-5848"/>
<polygon fill="black" stroke="black" points="10684.78,-5851.5 10694.78,-5848 10684.78,-5844.5 10684.78,-5851.5"/>
</g>
<!-- layer_12_expert_12&#45;&gt;layer_12_moe_agg -->
<g id="edge730" class="edge">
<title>layer_12_expert_12&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M10181.57,-6024.96C10181.57,-5971.7 10181.57,-5875 10181.57,-5875 10181.57,-5875 10684.91,-5875 10684.91,-5875"/>
<polygon fill="black" stroke="black" points="10684.91,-5878.5 10694.91,-5875 10684.91,-5871.5 10684.91,-5878.5"/>
</g>
<!-- layer_12_expert_13&#45;&gt;layer_12_moe_agg -->
<g id="edge733" class="edge">
<title>layer_12_expert_13&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M13541.5,-6025.04C13541.5,-5959.19 13541.5,-5821 13541.5,-5821 13541.5,-5821 11067.12,-5821 11067.12,-5821"/>
<polygon fill="black" stroke="black" points="11067.12,-5817.5 11057.12,-5821 11067.12,-5824.5 11067.12,-5817.5"/>
</g>
<!-- layer_12_expert_14&#45;&gt;layer_12_moe_agg -->
<g id="edge736" class="edge">
<title>layer_12_expert_14&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M11441.5,-6024.91C11441.5,-5970.4 11441.5,-5870 11441.5,-5870 11441.5,-5870 11067.26,-5870 11067.26,-5870"/>
<polygon fill="black" stroke="black" points="11067.26,-5866.5 11057.26,-5870 11067.26,-5873.5 11067.26,-5866.5"/>
</g>
<!-- layer_12_expert_15&#45;&gt;layer_12_moe_agg -->
<g id="edge739" class="edge">
<title>layer_12_expert_15&#45;&gt;layer_12_moe_agg</title>
<path fill="none" stroke="black" d="M10692.06,-6059C10705.14,-6059 10713.33,-6059 10713.33,-6059 10713.33,-6059 10713.33,-5890.36 10713.33,-5890.36"/>
<polygon fill="black" stroke="black" points="10716.83,-5890.36 10713.33,-5880.36 10709.83,-5890.36 10716.83,-5890.36"/>
</g>
<!-- layer_13_qkv -->
<g id="node310" class="node">
<title>layer_13_qkv</title>
<polygon fill="lightblue" stroke="black" points="10791.5,-5454.17 10382.5,-5454.17 10382.5,-5386.17 10791.5,-5386.17 10791.5,-5454.17"/>
<text text-anchor="middle" x="10587" y="-5438.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10587" y="-5423.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10587" y="-5408.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10587" y="-5393.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_12_add_norm2&#45;&gt;layer_13_qkv -->
<g id="edge742" class="edge">
<title>layer_12_add_norm2&#45;&gt;layer_13_qkv</title>
<path fill="none" stroke="black" d="M10743.75,-5598.94C10743.75,-5598.94 10743.75,-5464.3 10743.75,-5464.3"/>
<polygon fill="black" stroke="black" points="10747.25,-5464.3 10743.75,-5454.3 10740.25,-5464.3 10747.25,-5464.3"/>
</g>
<!-- layer_13_add_norm1 -->
<g id="node313" class="node">
<title>layer_13_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="11057,-4815.17 10695,-4815.17 10695,-4747.17 11057,-4747.17 11057,-4815.17"/>
<text text-anchor="middle" x="10876" y="-4799.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10876" y="-4784.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10876" y="-4769.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10876" y="-4754.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_12_add_norm2&#45;&gt;layer_13_add_norm1 -->
<g id="edge746" class="edge">
<title>layer_12_add_norm2&#45;&gt;layer_13_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10930.25,-5598.98C10930.25,-5598.98 10930.25,-4825.62 10930.25,-4825.62"/>
<polygon fill="black" stroke="black" points="10933.75,-4825.62 10930.25,-4815.62 10926.75,-4825.62 10933.75,-4825.62"/>
<text text-anchor="middle" x="10908" y="-5203.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_13_attn -->
<g id="node311" class="node">
<title>layer_13_attn</title>
<polygon fill="lightblue" stroke="black" points="10762.5,-5241.17 10353.5,-5241.17 10353.5,-5173.17 10762.5,-5173.17 10762.5,-5241.17"/>
<text text-anchor="middle" x="10558" y="-5225.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10558" y="-5210.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10558" y="-5195.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10558" y="-5180.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_13_qkv&#45;&gt;layer_13_attn -->
<g id="edge743" class="edge">
<title>layer_13_qkv&#45;&gt;layer_13_attn</title>
<path fill="none" stroke="black" d="M10572.5,-5385.94C10572.5,-5385.94 10572.5,-5251.3 10572.5,-5251.3"/>
<polygon fill="black" stroke="black" points="10576,-5251.3 10572.5,-5241.3 10569,-5251.3 10576,-5251.3"/>
</g>
<!-- layer_13_proj -->
<g id="node312" class="node">
<title>layer_13_proj</title>
<polygon fill="lightblue" stroke="black" points="10803.5,-5028.17 10406.5,-5028.17 10406.5,-4960.17 10803.5,-4960.17 10803.5,-5028.17"/>
<text text-anchor="middle" x="10605" y="-5012.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="10605" y="-4997.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10605" y="-4982.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10605" y="-4967.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_13_attn&#45;&gt;layer_13_proj -->
<g id="edge744" class="edge">
<title>layer_13_attn&#45;&gt;layer_13_proj</title>
<path fill="none" stroke="black" d="M10584.5,-5172.94C10584.5,-5172.94 10584.5,-5038.3 10584.5,-5038.3"/>
<polygon fill="black" stroke="black" points="10588,-5038.3 10584.5,-5028.3 10581,-5038.3 10588,-5038.3"/>
</g>
<!-- layer_13_proj&#45;&gt;layer_13_add_norm1 -->
<g id="edge745" class="edge">
<title>layer_13_proj&#45;&gt;layer_13_add_norm1</title>
<path fill="none" stroke="black" d="M10749.25,-4959.94C10749.25,-4959.94 10749.25,-4825.3 10749.25,-4825.3"/>
<polygon fill="black" stroke="black" points="10752.75,-4825.3 10749.25,-4815.3 10745.75,-4825.3 10752.75,-4825.3"/>
</g>
<!-- layer_13_gate -->
<g id="node314" class="node">
<title>layer_13_gate</title>
<polygon fill="yellow" stroke="black" points="10816.73,-4602.17 10239.71,-4602.17 10091.27,-4466.17 10668.29,-4466.17 10816.73,-4602.17"/>
<text text-anchor="middle" x="10454" y="-4552.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="10454" y="-4537.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10454" y="-4522.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="10454" y="-4507.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_gate -->
<g id="edge747" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_gate</title>
<path fill="none" stroke="black" d="M10755.93,-4747.08C10755.93,-4747.08 10755.93,-4612.37 10755.93,-4612.37"/>
<polygon fill="black" stroke="black" points="10759.43,-4612.37 10755.93,-4602.37 10752.43,-4612.37 10759.43,-4612.37"/>
</g>
<!-- layer_13_moe_agg -->
<g id="node315" class="node">
<title>layer_13_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="10979,-4094.17 10617,-4094.17 10617,-4026.17 10979,-4026.17 10979,-4094.17"/>
<text text-anchor="middle" x="10798" y="-4078.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="10798" y="-4063.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10798" y="-4048.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10798" y="-4033.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_moe_agg -->
<g id="edge748" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M10936.93,-4746.85C10936.93,-4653.51 10936.93,-4402 10936.93,-4402 10936.93,-4402 10721,-4402 10721,-4402 10721,-4402 10721,-4104.19 10721,-4104.19"/>
<polygon fill="black" stroke="black" points="10724.5,-4104.19 10721,-4094.19 10717.5,-4104.19 10724.5,-4104.19"/>
</g>
<!-- layer_13_expert_0 -->
<g id="node316" class="node">
<title>layer_13_expert_0</title>
<polygon fill="lightblue" stroke="black" points="9012,-4307.17 8650,-4307.17 8650,-4239.17 9012,-4239.17 9012,-4307.17"/>
<text text-anchor="middle" x="8831" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8831" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_0 -->
<g id="edge750" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_0</title>
<path fill="none" stroke="black" d="M10694.85,-4785C10179.22,-4785 8740.5,-4785 8740.5,-4785 8740.5,-4785 8740.5,-4317.54 8740.5,-4317.54"/>
<polygon fill="black" stroke="black" points="8744,-4317.54 8740.5,-4307.54 8737,-4317.54 8744,-4317.54"/>
</g>
<!-- layer_13_expert_1 -->
<g id="node317" class="node">
<title>layer_13_expert_1</title>
<polygon fill="lightblue" stroke="black" points="9432,-4307.17 9070,-4307.17 9070,-4239.17 9432,-4239.17 9432,-4307.17"/>
<text text-anchor="middle" x="9251" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9251" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_1 -->
<g id="edge753" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_1</title>
<path fill="none" stroke="black" d="M10694.85,-4776C10253.87,-4776 9160.5,-4776 9160.5,-4776 9160.5,-4776 9160.5,-4317.33 9160.5,-4317.33"/>
<polygon fill="black" stroke="black" points="9164,-4317.33 9160.5,-4307.33 9157,-4317.33 9164,-4317.33"/>
</g>
<!-- layer_13_expert_2 -->
<g id="node318" class="node">
<title>layer_13_expert_2</title>
<polygon fill="lightblue" stroke="black" points="12372,-4307.17 12010,-4307.17 12010,-4239.17 12372,-4239.17 12372,-4307.17"/>
<text text-anchor="middle" x="12191" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12191" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_2 -->
<g id="edge756" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_2</title>
<path fill="none" stroke="black" d="M11057.12,-4781C11417.71,-4781 12191,-4781 12191,-4781 12191,-4781 12191,-4317.28 12191,-4317.28"/>
<polygon fill="black" stroke="black" points="12194.5,-4317.28 12191,-4307.28 12187.5,-4317.28 12194.5,-4317.28"/>
</g>
<!-- layer_13_expert_3 -->
<g id="node319" class="node">
<title>layer_13_expert_3</title>
<polygon fill="lightblue" stroke="black" points="8172,-4307.17 7810,-4307.17 7810,-4239.17 8172,-4239.17 8172,-4307.17"/>
<text text-anchor="middle" x="7991" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7991" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_3 -->
<g id="edge759" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_3</title>
<path fill="none" stroke="black" d="M10694.9,-4802C10049.56,-4802 7900.5,-4802 7900.5,-4802 7900.5,-4802 7900.5,-4317.46 7900.5,-4317.46"/>
<polygon fill="black" stroke="black" points="7904,-4317.46 7900.5,-4307.46 7897,-4317.46 7904,-4317.46"/>
</g>
<!-- layer_13_expert_4 -->
<g id="node320" class="node">
<title>layer_13_expert_4</title>
<polygon fill="lightblue" stroke="black" points="8592,-4307.17 8230,-4307.17 8230,-4239.17 8592,-4239.17 8592,-4307.17"/>
<text text-anchor="middle" x="8411" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8411" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_4 -->
<g id="edge762" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_4</title>
<path fill="none" stroke="black" d="M10694.77,-4793C10111.48,-4793 8320.5,-4793 8320.5,-4793 8320.5,-4793 8320.5,-4317.27 8320.5,-4317.27"/>
<polygon fill="black" stroke="black" points="8324,-4317.27 8320.5,-4307.27 8317,-4317.27 8324,-4317.27"/>
</g>
<!-- layer_13_expert_5 -->
<g id="node321" class="node">
<title>layer_13_expert_5</title>
<polygon fill="lightblue" stroke="black" points="11112,-4307.17 10750,-4307.17 10750,-4239.17 11112,-4239.17 11112,-4307.17"/>
<text text-anchor="middle" x="10931" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10931" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_5 -->
<g id="edge765" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_5</title>
<path fill="none" stroke="black" d="M10996.97,-4747.05C10996.97,-4747.05 10996.97,-4317.47 10996.97,-4317.47"/>
<polygon fill="black" stroke="black" points="11000.47,-4317.47 10996.97,-4307.47 10993.47,-4317.47 11000.47,-4317.47"/>
</g>
<!-- layer_13_expert_6 -->
<g id="node322" class="node">
<title>layer_13_expert_6</title>
<polygon fill="lightblue" stroke="black" points="9852,-4307.17 9490,-4307.17 9490,-4239.17 9852,-4239.17 9852,-4307.17"/>
<text text-anchor="middle" x="9671" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9671" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_6 -->
<g id="edge768" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_6</title>
<path fill="none" stroke="black" d="M10694.84,-4768C10338.45,-4768 9580.5,-4768 9580.5,-4768 9580.5,-4768 9580.5,-4317.18 9580.5,-4317.18"/>
<polygon fill="black" stroke="black" points="9584,-4317.18 9580.5,-4307.18 9577,-4317.18 9584,-4317.18"/>
</g>
<!-- layer_13_expert_7 -->
<g id="node323" class="node">
<title>layer_13_expert_7</title>
<polygon fill="lightblue" stroke="black" points="12792,-4307.17 12430,-4307.17 12430,-4239.17 12792,-4239.17 12792,-4307.17"/>
<text text-anchor="middle" x="12611" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12611" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_7 -->
<g id="edge771" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_7</title>
<path fill="none" stroke="black" d="M11057.17,-4789C11501.82,-4789 12611,-4789 12611,-4789 12611,-4789 12611,-4317.41 12611,-4317.41"/>
<polygon fill="black" stroke="black" points="12614.5,-4317.41 12611,-4307.41 12607.5,-4317.41 12614.5,-4317.41"/>
</g>
<!-- layer_13_expert_8 -->
<g id="node324" class="node">
<title>layer_13_expert_8</title>
<polygon fill="lightblue" stroke="black" points="7332,-4307.17 6970,-4307.17 6970,-4239.17 7332,-4239.17 7332,-4307.17"/>
<text text-anchor="middle" x="7151" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7151" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_8 -->
<g id="edge774" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_8</title>
<path fill="none" stroke="black" d="M10694.86,-4810C9937.08,-4810 7060.5,-4810 7060.5,-4810 7060.5,-4810 7060.5,-4317.56 7060.5,-4317.56"/>
<polygon fill="black" stroke="black" points="7064,-4317.56 7060.5,-4307.56 7057,-4317.56 7064,-4317.56"/>
</g>
<!-- layer_13_expert_9 -->
<g id="node325" class="node">
<title>layer_13_expert_9</title>
<polygon fill="lightblue" stroke="black" points="13212,-4307.17 12850,-4307.17 12850,-4239.17 13212,-4239.17 13212,-4307.17"/>
<text text-anchor="middle" x="13031" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="13031" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_9 -->
<g id="edge777" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_9</title>
<path fill="none" stroke="black" d="M11057.41,-4798C11576.55,-4798 13031,-4798 13031,-4798 13031,-4798 13031,-4317.2 13031,-4317.2"/>
<polygon fill="black" stroke="black" points="13034.5,-4317.2 13031,-4307.2 13027.5,-4317.2 13034.5,-4317.2"/>
</g>
<!-- layer_13_expert_10 -->
<g id="node326" class="node">
<title>layer_13_expert_10</title>
<polygon fill="lightblue" stroke="black" points="11952,-4307.17 11590,-4307.17 11590,-4239.17 11952,-4239.17 11952,-4307.17"/>
<text text-anchor="middle" x="11771" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="11771" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_10 -->
<g id="edge780" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_10</title>
<path fill="none" stroke="black" d="M11057.12,-4772C11318.64,-4772 11771,-4772 11771,-4772 11771,-4772 11771,-4317.45 11771,-4317.45"/>
<polygon fill="black" stroke="black" points="11774.5,-4317.45 11771,-4307.45 11767.5,-4317.45 11774.5,-4317.45"/>
</g>
<!-- layer_13_expert_11 -->
<g id="node327" class="node">
<title>layer_13_expert_11</title>
<polygon fill="lightblue" stroke="black" points="7752,-4307.17 7390,-4307.17 7390,-4239.17 7752,-4239.17 7752,-4307.17"/>
<text text-anchor="middle" x="7571" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7571" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_11 -->
<g id="edge783" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_11</title>
<path fill="none" stroke="black" d="M10694.94,-4806C9991.73,-4806 7480.5,-4806 7480.5,-4806 7480.5,-4806 7480.5,-4317.31 7480.5,-4317.31"/>
<polygon fill="black" stroke="black" points="7484,-4317.31 7480.5,-4307.31 7477,-4317.31 7484,-4317.31"/>
</g>
<!-- layer_13_expert_12 -->
<g id="node328" class="node">
<title>layer_13_expert_12</title>
<polygon fill="lightblue" stroke="black" points="10272,-4307.17 9910,-4307.17 9910,-4239.17 10272,-4239.17 10272,-4307.17"/>
<text text-anchor="middle" x="10091" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10091" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_12 -->
<g id="edge786" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_12</title>
<path fill="none" stroke="black" d="M10694.88,-4759C10438.49,-4759 10000.57,-4759 10000.57,-4759 10000.57,-4759 10000.57,-4317.33 10000.57,-4317.33"/>
<polygon fill="black" stroke="black" points="10004.07,-4317.33 10000.57,-4307.33 9997.07,-4317.33 10004.07,-4317.33"/>
</g>
<!-- layer_13_expert_13 -->
<g id="node329" class="node">
<title>layer_13_expert_13</title>
<polygon fill="lightblue" stroke="black" points="13632,-4307.17 13270,-4307.17 13270,-4239.17 13632,-4239.17 13632,-4307.17"/>
<text text-anchor="middle" x="13451" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="13451" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_13 -->
<g id="edge789" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_13</title>
<path fill="none" stroke="black" d="M11057.07,-4806C11643.19,-4806 13451,-4806 13451,-4806 13451,-4806 13451,-4317.31 13451,-4317.31"/>
<polygon fill="black" stroke="black" points="13454.5,-4317.31 13451,-4307.31 13447.5,-4317.31 13454.5,-4317.31"/>
</g>
<!-- layer_13_expert_14 -->
<g id="node330" class="node">
<title>layer_13_expert_14</title>
<polygon fill="lightblue" stroke="black" points="11532,-4307.17 11170,-4307.17 11170,-4239.17 11532,-4239.17 11532,-4307.17"/>
<text text-anchor="middle" x="11351" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11351" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_14 -->
<g id="edge792" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_14</title>
<path fill="none" stroke="black" d="M11057.27,-4764C11191.44,-4764 11351,-4764 11351,-4764 11351,-4764 11351,-4317.29 11351,-4317.29"/>
<polygon fill="black" stroke="black" points="11354.5,-4317.29 11351,-4307.29 11347.5,-4317.29 11354.5,-4317.29"/>
</g>
<!-- layer_13_expert_15 -->
<g id="node331" class="node">
<title>layer_13_expert_15</title>
<polygon fill="lightblue" stroke="black" points="10692,-4307.17 10330,-4307.17 10330,-4239.17 10692,-4239.17 10692,-4307.17"/>
<text text-anchor="middle" x="10511" y="-4291.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="10511" y="-4276.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-4261.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-4246.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_expert_15 -->
<g id="edge795" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_expert_15</title>
<path fill="none" stroke="black" d="M10876.9,-4746.93C10876.9,-4659.34 10876.9,-4434 10876.9,-4434 10876.9,-4434 10571.33,-4434 10571.33,-4434 10571.33,-4434 10571.33,-4317.28 10571.33,-4317.28"/>
<polygon fill="black" stroke="black" points="10574.83,-4317.28 10571.33,-4307.28 10567.83,-4317.28 10574.83,-4317.28"/>
</g>
<!-- layer_13_add_norm2 -->
<g id="node332" class="node">
<title>layer_13_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="11016,-3881.17 10654,-3881.17 10654,-3813.17 11016,-3813.17 11016,-3881.17"/>
<text text-anchor="middle" x="10835" y="-3865.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10835" y="-3850.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10835" y="-3835.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10835" y="-3820.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_13_add_norm1&#45;&gt;layer_13_add_norm2 -->
<g id="edge798" class="edge">
<title>layer_13_add_norm1&#45;&gt;layer_13_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11057.07,-4755C11092.32,-4755 11118.6,-4755 11118.6,-4755 11118.6,-4755 11118.6,-3847 11118.6,-3847 11118.6,-3847 11026.21,-3847 11026.21,-3847"/>
<polygon fill="black" stroke="black" points="11026.21,-3843.5 11016.21,-3847 11026.21,-3850.5 11026.21,-3843.5"/>
<text text-anchor="middle" x="13837" y="-4269.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_0 -->
<g id="edge749" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10143.41,-4514C9695.54,-4514 8921.5,-4514 8921.5,-4514 8921.5,-4514 8921.5,-4317.42 8921.5,-4317.42"/>
<polygon fill="black" stroke="black" points="8925,-4317.42 8921.5,-4307.42 8918,-4317.42 8925,-4317.42"/>
<text text-anchor="middle" x="9600.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_1 -->
<g id="edge752" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10122.47,-4495C9794.6,-4495 9341.5,-4495 9341.5,-4495 9341.5,-4495 9341.5,-4317.34 9341.5,-4317.34"/>
<polygon fill="black" stroke="black" points="9345,-4317.34 9341.5,-4307.34 9338,-4317.34 9345,-4317.34"/>
<text text-anchor="middle" x="9980.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_2 -->
<g id="edge755" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10731.44,-4524C11200.68,-4524 12100.5,-4524 12100.5,-4524 12100.5,-4524 12100.5,-4317.26 12100.5,-4317.26"/>
<polygon fill="black" stroke="black" points="12104,-4317.26 12100.5,-4307.26 12097,-4317.26 12104,-4317.26"/>
<text text-anchor="middle" x="11512.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_3 -->
<g id="edge758" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10185.88,-4553C9565.07,-4553 8081.5,-4553 8081.5,-4553 8081.5,-4553 8081.5,-4317.2 8081.5,-4317.2"/>
<polygon fill="black" stroke="black" points="8085,-4317.2 8081.5,-4307.2 8078,-4317.2 8085,-4317.2"/>
<text text-anchor="middle" x="8723.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_4 -->
<g id="edge761" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10165.11,-4534C9621.7,-4534 8501.5,-4534 8501.5,-4534 8501.5,-4534 8501.5,-4317.27 8501.5,-4317.27"/>
<polygon fill="black" stroke="black" points="8505,-4317.27 8501.5,-4307.27 8498,-4317.27 8505,-4317.27"/>
<text text-anchor="middle" x="9199.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_5 -->
<g id="edge764" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10783.43,-4534.12C10783.43,-4534.12 10783.43,-4317.33 10783.43,-4317.33"/>
<polygon fill="black" stroke="black" points="10786.93,-4317.33 10783.43,-4307.33 10779.93,-4317.33 10786.93,-4317.33"/>
<text text-anchor="middle" x="10720.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_6 -->
<g id="edge767" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10100.9,-4475C9930.09,-4475 9761.5,-4475 9761.5,-4475 9761.5,-4475 9761.5,-4317.4 9761.5,-4317.4"/>
<polygon fill="black" stroke="black" points="9765,-4317.4 9761.5,-4307.4 9758,-4317.4 9765,-4317.4"/>
<text text-anchor="middle" x="10185.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_7 -->
<g id="edge770" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10752.28,-4543C11324.56,-4543 12520.5,-4543 12520.5,-4543 12520.5,-4543 12520.5,-4317.34 12520.5,-4317.34"/>
<polygon fill="black" stroke="black" points="12524,-4317.34 12520.5,-4307.34 12517,-4317.34 12524,-4317.34"/>
<text text-anchor="middle" x="11967.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_8 -->
<g id="edge773" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10228.42,-4592C9497.53,-4592 7241.5,-4592 7241.5,-4592 7241.5,-4592 7241.5,-4317.29 7241.5,-4317.29"/>
<polygon fill="black" stroke="black" points="7245,-4317.29 7241.5,-4307.29 7238,-4317.29 7245,-4317.29"/>
<text text-anchor="middle" x="7995.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_9 -->
<g id="edge776" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10774.29,-4563C11446.01,-4563 12940.5,-4563 12940.5,-4563 12940.5,-4563 12940.5,-4317.27 12940.5,-4317.27"/>
<polygon fill="black" stroke="black" points="12944,-4317.27 12940.5,-4307.27 12937,-4317.27 12944,-4317.27"/>
<text text-anchor="middle" x="12381.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_10 -->
<g id="edge779" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10710.74,-4505C11070.34,-4505 11680.5,-4505 11680.5,-4505 11680.5,-4505 11680.5,-4317.37 11680.5,-4317.37"/>
<polygon fill="black" stroke="black" points="11684,-4317.37 11680.5,-4307.37 11677,-4317.37 11684,-4317.37"/>
<text text-anchor="middle" x="11176.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_11 -->
<g id="edge782" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10207.72,-4573C9525.54,-4573 7661.5,-4573 7661.5,-4573 7661.5,-4573 7661.5,-4317.27 7661.5,-4317.27"/>
<polygon fill="black" stroke="black" points="7665,-4317.27 7661.5,-4307.27 7658,-4317.27 7665,-4317.27"/>
<text text-anchor="middle" x="8340.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_12 -->
<g id="edge785" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10181.57,-4465.93C10181.57,-4465.93 10181.57,-4317.49 10181.57,-4317.49"/>
<polygon fill="black" stroke="black" points="10185.07,-4317.49 10181.57,-4307.49 10178.07,-4317.49 10185.07,-4317.49"/>
<text text-anchor="middle" x="10334.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_13 -->
<g id="edge788" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10794.89,-4582C11562.6,-4582 13360.5,-4582 13360.5,-4582 13360.5,-4582 13360.5,-4317.4 13360.5,-4317.4"/>
<polygon fill="black" stroke="black" points="13364,-4317.4 13360.5,-4307.4 13357,-4317.4 13364,-4317.4"/>
<text text-anchor="middle" x="12667.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_14 -->
<g id="edge791" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10688.9,-4485C10926.98,-4485 11260.5,-4485 11260.5,-4485 11260.5,-4485 11260.5,-4317.2 11260.5,-4317.2"/>
<polygon fill="black" stroke="black" points="11264,-4317.2 11260.5,-4307.2 11257,-4317.2 11264,-4317.2"/>
<text text-anchor="middle" x="10966.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_15 -->
<g id="edge794" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10450.67,-4465.93C10450.67,-4465.93 10450.67,-4317.49 10450.67,-4317.49"/>
<polygon fill="black" stroke="black" points="10454.17,-4317.49 10450.67,-4307.49 10447.17,-4317.49 10454.17,-4317.49"/>
<text text-anchor="middle" x="10481.5" y="-4382.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_13_moe_agg&#45;&gt;layer_13_add_norm2 -->
<g id="edge797" class="edge">
<title>layer_13_moe_agg&#45;&gt;layer_13_add_norm2</title>
<path fill="none" stroke="black" d="M10816.5,-4025.94C10816.5,-4025.94 10816.5,-3891.3 10816.5,-3891.3"/>
<polygon fill="black" stroke="black" points="10820,-3891.3 10816.5,-3881.3 10813,-3891.3 10820,-3891.3"/>
</g>
<!-- layer_13_expert_0&#45;&gt;layer_13_moe_agg -->
<g id="edge751" class="edge">
<title>layer_13_expert_0&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M8831,-4238.82C8831,-4182.33 8831,-4076 8831,-4076 8831,-4076 10606.91,-4076 10606.91,-4076"/>
<polygon fill="black" stroke="black" points="10606.91,-4079.5 10616.91,-4076 10606.91,-4072.5 10606.91,-4079.5"/>
</g>
<!-- layer_13_expert_1&#45;&gt;layer_13_moe_agg -->
<g id="edge754" class="edge">
<title>layer_13_expert_1&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M9251,-4239.08C9251,-4183.62 9251,-4080 9251,-4080 9251,-4080 10606.75,-4080 10606.75,-4080"/>
<polygon fill="black" stroke="black" points="10606.75,-4083.5 10616.75,-4080 10606.75,-4076.5 10606.75,-4083.5"/>
</g>
<!-- layer_13_expert_2&#45;&gt;layer_13_moe_agg -->
<g id="edge757" class="edge">
<title>layer_13_expert_2&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M12281.5,-4238.79C12281.5,-4179.67 12281.5,-4065 12281.5,-4065 12281.5,-4065 10989.16,-4065 10989.16,-4065"/>
<polygon fill="black" stroke="black" points="10989.16,-4061.5 10979.16,-4065 10989.16,-4068.5 10989.16,-4061.5"/>
</g>
<!-- layer_13_expert_3&#45;&gt;layer_13_moe_agg -->
<g id="edge760" class="edge">
<title>layer_13_expert_3&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M7991,-4238.96C7991,-4180.12 7991,-4066 7991,-4066 7991,-4066 10606.8,-4066 10606.8,-4066"/>
<polygon fill="black" stroke="black" points="10606.8,-4069.5 10616.8,-4066 10606.8,-4062.5 10606.8,-4069.5"/>
</g>
<!-- layer_13_expert_4&#45;&gt;layer_13_moe_agg -->
<g id="edge763" class="edge">
<title>layer_13_expert_4&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M8411,-4238.87C8411,-4181.19 8411,-4071 8411,-4071 8411,-4071 10606.63,-4071 10606.63,-4071"/>
<polygon fill="black" stroke="black" points="10606.63,-4074.5 10616.63,-4071 10606.63,-4067.5 10606.63,-4074.5"/>
</g>
<!-- layer_13_expert_5&#45;&gt;layer_13_moe_agg -->
<g id="edge766" class="edge">
<title>layer_13_expert_5&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M10864.5,-4238.94C10864.5,-4238.94 10864.5,-4104.3 10864.5,-4104.3"/>
<polygon fill="black" stroke="black" points="10868,-4104.3 10864.5,-4094.3 10861,-4104.3 10868,-4104.3"/>
</g>
<!-- layer_13_expert_6&#45;&gt;layer_13_moe_agg -->
<g id="edge769" class="edge">
<title>layer_13_expert_6&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M9671,-4239.09C9671,-4184.87 9671,-4085 9671,-4085 9671,-4085 10606.93,-4085 10606.93,-4085"/>
<polygon fill="black" stroke="black" points="10606.93,-4088.5 10616.93,-4085 10606.93,-4081.5 10606.93,-4088.5"/>
</g>
<!-- layer_13_expert_7&#45;&gt;layer_13_moe_agg -->
<g id="edge772" class="edge">
<title>layer_13_expert_7&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M12701.5,-4239.08C12701.5,-4177.72 12701.5,-4055 12701.5,-4055 12701.5,-4055 10989.22,-4055 10989.22,-4055"/>
<polygon fill="black" stroke="black" points="10989.22,-4051.5 10979.22,-4055 10989.22,-4058.5 10989.22,-4051.5"/>
</g>
<!-- layer_13_expert_8&#45;&gt;layer_13_moe_agg -->
<g id="edge775" class="edge">
<title>layer_13_expert_8&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M7151,-4238.91C7151,-4177.96 7151,-4057 7151,-4057 7151,-4057 10606.83,-4057 10606.83,-4057"/>
<polygon fill="black" stroke="black" points="10606.83,-4060.5 10616.83,-4057 10606.83,-4053.5 10606.83,-4060.5"/>
</g>
<!-- layer_13_expert_9&#45;&gt;layer_13_moe_agg -->
<g id="edge778" class="edge">
<title>layer_13_expert_9&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M13121.5,-4239.01C13121.5,-4175.36 13121.5,-4045 13121.5,-4045 13121.5,-4045 10989.35,-4045 10989.35,-4045"/>
<polygon fill="black" stroke="black" points="10989.35,-4041.5 10979.35,-4045 10989.35,-4048.5 10989.35,-4041.5"/>
</g>
<!-- layer_13_expert_10&#45;&gt;layer_13_moe_agg -->
<g id="edge781" class="edge">
<title>layer_13_expert_10&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M11861.5,-4238.93C11861.5,-4181.98 11861.5,-4074 11861.5,-4074 11861.5,-4074 10989.01,-4074 10989.01,-4074"/>
<polygon fill="black" stroke="black" points="10989.01,-4070.5 10979.01,-4074 10989.01,-4077.5 10989.01,-4070.5"/>
</g>
<!-- layer_13_expert_11&#45;&gt;layer_13_moe_agg -->
<g id="edge784" class="edge">
<title>layer_13_expert_11&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M7571,-4238.77C7571,-4178.93 7571,-4062 7571,-4062 7571,-4062 10606.72,-4062 10606.72,-4062"/>
<polygon fill="black" stroke="black" points="10606.72,-4065.5 10616.72,-4062 10606.72,-4058.5 10606.72,-4065.5"/>
</g>
<!-- layer_13_expert_12&#45;&gt;layer_13_moe_agg -->
<g id="edge787" class="edge">
<title>layer_13_expert_12&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M10163.07,-4238.96C10163.07,-4185.7 10163.07,-4089 10163.07,-4089 10163.07,-4089 10606.9,-4089 10606.9,-4089"/>
<polygon fill="black" stroke="black" points="10606.9,-4092.5 10616.9,-4089 10606.9,-4085.5 10606.9,-4092.5"/>
</g>
<!-- layer_13_expert_13&#45;&gt;layer_13_moe_agg -->
<g id="edge790" class="edge">
<title>layer_13_expert_13&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M13451,-4239.04C13451,-4173.19 13451,-4035 13451,-4035 13451,-4035 10989.05,-4035 10989.05,-4035"/>
<polygon fill="black" stroke="black" points="10989.05,-4031.5 10979.05,-4035 10989.05,-4038.5 10989.05,-4031.5"/>
</g>
<!-- layer_13_expert_14&#45;&gt;layer_13_moe_agg -->
<g id="edge793" class="edge">
<title>layer_13_expert_14&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M11441.5,-4238.91C11441.5,-4184.4 11441.5,-4084 11441.5,-4084 11441.5,-4084 10989.39,-4084 10989.39,-4084"/>
<polygon fill="black" stroke="black" points="10989.39,-4080.5 10979.39,-4084 10989.39,-4087.5 10989.39,-4080.5"/>
</g>
<!-- layer_13_expert_15&#45;&gt;layer_13_moe_agg -->
<g id="edge796" class="edge">
<title>layer_13_expert_15&#45;&gt;layer_13_moe_agg</title>
<path fill="none" stroke="black" d="M10654.5,-4238.94C10654.5,-4238.94 10654.5,-4104.3 10654.5,-4104.3"/>
<polygon fill="black" stroke="black" points="10658,-4104.3 10654.5,-4094.3 10651,-4104.3 10658,-4104.3"/>
</g>
<!-- layer_14_qkv -->
<g id="node333" class="node">
<title>layer_14_qkv</title>
<polygon fill="lightblue" stroke="black" points="10796.5,-3668.17 10387.5,-3668.17 10387.5,-3600.17 10796.5,-3600.17 10796.5,-3668.17"/>
<text text-anchor="middle" x="10592" y="-3652.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10592" y="-3637.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10592" y="-3622.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10592" y="-3607.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_13_add_norm2&#45;&gt;layer_14_qkv -->
<g id="edge799" class="edge">
<title>layer_13_add_norm2&#45;&gt;layer_14_qkv</title>
<path fill="none" stroke="black" d="M10725.25,-3812.94C10725.25,-3812.94 10725.25,-3678.3 10725.25,-3678.3"/>
<polygon fill="black" stroke="black" points="10728.75,-3678.3 10725.25,-3668.3 10721.75,-3678.3 10728.75,-3678.3"/>
</g>
<!-- layer_14_add_norm1 -->
<g id="node336" class="node">
<title>layer_14_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="11020,-3029.17 10658,-3029.17 10658,-2961.17 11020,-2961.17 11020,-3029.17"/>
<text text-anchor="middle" x="10839" y="-3013.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10839" y="-2998.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10839" y="-2983.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10839" y="-2968.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_13_add_norm2&#45;&gt;layer_14_add_norm1 -->
<g id="edge803" class="edge">
<title>layer_13_add_norm2&#45;&gt;layer_14_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10906.25,-3812.98C10906.25,-3812.98 10906.25,-3039.62 10906.25,-3039.62"/>
<polygon fill="black" stroke="black" points="10909.75,-3039.62 10906.25,-3029.62 10902.75,-3039.62 10909.75,-3039.62"/>
<text text-anchor="middle" x="10913" y="-3417.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_14_attn -->
<g id="node334" class="node">
<title>layer_14_attn</title>
<polygon fill="lightblue" stroke="black" points="10767.5,-3455.17 10358.5,-3455.17 10358.5,-3387.17 10767.5,-3387.17 10767.5,-3455.17"/>
<text text-anchor="middle" x="10563" y="-3439.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10563" y="-3424.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10563" y="-3409.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10563" y="-3394.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_14_qkv&#45;&gt;layer_14_attn -->
<g id="edge800" class="edge">
<title>layer_14_qkv&#45;&gt;layer_14_attn</title>
<path fill="none" stroke="black" d="M10577.5,-3599.94C10577.5,-3599.94 10577.5,-3465.3 10577.5,-3465.3"/>
<polygon fill="black" stroke="black" points="10581,-3465.3 10577.5,-3455.3 10574,-3465.3 10581,-3465.3"/>
</g>
<!-- layer_14_proj -->
<g id="node335" class="node">
<title>layer_14_proj</title>
<polygon fill="lightblue" stroke="black" points="10793.5,-3242.17 10396.5,-3242.17 10396.5,-3174.17 10793.5,-3174.17 10793.5,-3242.17"/>
<text text-anchor="middle" x="10595" y="-3226.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="10595" y="-3211.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10595" y="-3196.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10595" y="-3181.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_14_attn&#45;&gt;layer_14_proj -->
<g id="edge801" class="edge">
<title>layer_14_attn&#45;&gt;layer_14_proj</title>
<path fill="none" stroke="black" d="M10582,-3386.94C10582,-3386.94 10582,-3252.3 10582,-3252.3"/>
<polygon fill="black" stroke="black" points="10585.5,-3252.3 10582,-3242.3 10578.5,-3252.3 10585.5,-3252.3"/>
</g>
<!-- layer_14_proj&#45;&gt;layer_14_add_norm1 -->
<g id="edge802" class="edge">
<title>layer_14_proj&#45;&gt;layer_14_add_norm1</title>
<path fill="none" stroke="black" d="M10725.75,-3173.94C10725.75,-3173.94 10725.75,-3039.3 10725.75,-3039.3"/>
<polygon fill="black" stroke="black" points="10729.25,-3039.3 10725.75,-3029.3 10722.25,-3039.3 10729.25,-3039.3"/>
</g>
<!-- layer_14_gate -->
<g id="node337" class="node">
<title>layer_14_gate</title>
<polygon fill="yellow" stroke="black" points="10779.73,-2816.17 10202.71,-2816.17 10054.27,-2680.17 10631.29,-2680.17 10779.73,-2816.17"/>
<text text-anchor="middle" x="10417" y="-2766.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="10417" y="-2751.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10417" y="-2736.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="10417" y="-2721.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_gate -->
<g id="edge804" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_gate</title>
<path fill="none" stroke="black" d="M10718.93,-2961.08C10718.93,-2961.08 10718.93,-2826.37 10718.93,-2826.37"/>
<polygon fill="black" stroke="black" points="10722.43,-2826.37 10718.93,-2816.37 10715.43,-2826.37 10722.43,-2826.37"/>
</g>
<!-- layer_14_moe_agg -->
<g id="node338" class="node">
<title>layer_14_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="10941,-2308.17 10579,-2308.17 10579,-2240.17 10941,-2240.17 10941,-2308.17"/>
<text text-anchor="middle" x="10760" y="-2292.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="10760" y="-2277.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10760" y="-2262.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10760" y="-2247.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_moe_agg -->
<g id="edge805" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M10899.93,-2961.13C10899.93,-2857.35 10899.93,-2552 10899.93,-2552 10899.93,-2552 10721,-2552 10721,-2552 10721,-2552 10721,-2318.23 10721,-2318.23"/>
<polygon fill="black" stroke="black" points="10724.5,-2318.23 10721,-2308.23 10717.5,-2318.23 10724.5,-2318.23"/>
</g>
<!-- layer_14_expert_0 -->
<g id="node339" class="node">
<title>layer_14_expert_0</title>
<polygon fill="lightblue" stroke="black" points="9012,-2521.17 8650,-2521.17 8650,-2453.17 9012,-2453.17 9012,-2521.17"/>
<text text-anchor="middle" x="8831" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8831" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_0 -->
<g id="edge807" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_0</title>
<path fill="none" stroke="black" d="M10657.81,-2999C10148.41,-2999 8740.5,-2999 8740.5,-2999 8740.5,-2999 8740.5,-2531.54 8740.5,-2531.54"/>
<polygon fill="black" stroke="black" points="8744,-2531.54 8740.5,-2521.54 8737,-2531.54 8744,-2531.54"/>
</g>
<!-- layer_14_expert_1 -->
<g id="node340" class="node">
<title>layer_14_expert_1</title>
<polygon fill="lightblue" stroke="black" points="9432,-2521.17 9070,-2521.17 9070,-2453.17 9432,-2453.17 9432,-2521.17"/>
<text text-anchor="middle" x="9251" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9251" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_1 -->
<g id="edge810" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_1</title>
<path fill="none" stroke="black" d="M10657.78,-2990C10223.75,-2990 9160.5,-2990 9160.5,-2990 9160.5,-2990 9160.5,-2531.33 9160.5,-2531.33"/>
<polygon fill="black" stroke="black" points="9164,-2531.33 9160.5,-2521.33 9157,-2531.33 9164,-2531.33"/>
</g>
<!-- layer_14_expert_2 -->
<g id="node341" class="node">
<title>layer_14_expert_2</title>
<polygon fill="lightblue" stroke="black" points="12372,-2521.17 12010,-2521.17 12010,-2453.17 12372,-2453.17 12372,-2521.17"/>
<text text-anchor="middle" x="12191" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12191" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_2 -->
<g id="edge813" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_2</title>
<path fill="none" stroke="black" d="M11020.28,-2995C11388.85,-2995 12191,-2995 12191,-2995 12191,-2995 12191,-2531.28 12191,-2531.28"/>
<polygon fill="black" stroke="black" points="12194.5,-2531.28 12191,-2521.28 12187.5,-2531.28 12194.5,-2531.28"/>
</g>
<!-- layer_14_expert_3 -->
<g id="node342" class="node">
<title>layer_14_expert_3</title>
<polygon fill="lightblue" stroke="black" points="8172,-2521.17 7810,-2521.17 7810,-2453.17 8172,-2453.17 8172,-2521.17"/>
<text text-anchor="middle" x="7991" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7991" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_3 -->
<g id="edge816" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_3</title>
<path fill="none" stroke="black" d="M10657.95,-3016C10017.96,-3016 7900.5,-3016 7900.5,-3016 7900.5,-3016 7900.5,-2531.46 7900.5,-2531.46"/>
<polygon fill="black" stroke="black" points="7904,-2531.46 7900.5,-2521.46 7897,-2531.46 7904,-2531.46"/>
</g>
<!-- layer_14_expert_4 -->
<g id="node343" class="node">
<title>layer_14_expert_4</title>
<polygon fill="lightblue" stroke="black" points="8592,-2521.17 8230,-2521.17 8230,-2453.17 8592,-2453.17 8592,-2521.17"/>
<text text-anchor="middle" x="8411" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8411" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_4 -->
<g id="edge819" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_4</title>
<path fill="none" stroke="black" d="M10657.88,-3007C10080.41,-3007 8320.5,-3007 8320.5,-3007 8320.5,-3007 8320.5,-2531.27 8320.5,-2531.27"/>
<polygon fill="black" stroke="black" points="8324,-2531.27 8320.5,-2521.27 8317,-2531.27 8324,-2531.27"/>
</g>
<!-- layer_14_expert_5 -->
<g id="node344" class="node">
<title>layer_14_expert_5</title>
<polygon fill="lightblue" stroke="black" points="11112,-2521.17 10750,-2521.17 10750,-2453.17 11112,-2453.17 11112,-2521.17"/>
<text text-anchor="middle" x="10931" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10931" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_5 -->
<g id="edge822" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_5</title>
<path fill="none" stroke="black" d="M10959.97,-2961.05C10959.97,-2961.05 10959.97,-2531.47 10959.97,-2531.47"/>
<polygon fill="black" stroke="black" points="10963.47,-2531.47 10959.97,-2521.47 10956.47,-2531.47 10963.47,-2531.47"/>
</g>
<!-- layer_14_expert_6 -->
<g id="node345" class="node">
<title>layer_14_expert_6</title>
<polygon fill="lightblue" stroke="black" points="9852,-2521.17 9490,-2521.17 9490,-2453.17 9852,-2453.17 9852,-2521.17"/>
<text text-anchor="middle" x="9671" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9671" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_6 -->
<g id="edge825" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_6</title>
<path fill="none" stroke="black" d="M10657.68,-2982C10309.3,-2982 9580.5,-2982 9580.5,-2982 9580.5,-2982 9580.5,-2531.18 9580.5,-2531.18"/>
<polygon fill="black" stroke="black" points="9584,-2531.18 9580.5,-2521.18 9577,-2531.18 9584,-2531.18"/>
</g>
<!-- layer_14_expert_7 -->
<g id="node346" class="node">
<title>layer_14_expert_7</title>
<polygon fill="lightblue" stroke="black" points="12792,-2521.17 12430,-2521.17 12430,-2453.17 12792,-2453.17 12792,-2521.17"/>
<text text-anchor="middle" x="12611" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12611" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_7 -->
<g id="edge828" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_7</title>
<path fill="none" stroke="black" d="M11020.31,-3003C11471.93,-3003 12611,-3003 12611,-3003 12611,-3003 12611,-2531.41 12611,-2531.41"/>
<polygon fill="black" stroke="black" points="12614.5,-2531.41 12611,-2521.41 12607.5,-2531.41 12614.5,-2531.41"/>
</g>
<!-- layer_14_expert_8 -->
<g id="node347" class="node">
<title>layer_14_expert_8</title>
<polygon fill="lightblue" stroke="black" points="7332,-2521.17 6970,-2521.17 6970,-2453.17 7332,-2453.17 7332,-2521.17"/>
<text text-anchor="middle" x="7151" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7151" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_8 -->
<g id="edge831" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_8</title>
<path fill="none" stroke="black" d="M10657.71,-3024C9904.39,-3024 7060.5,-3024 7060.5,-3024 7060.5,-3024 7060.5,-2531.56 7060.5,-2531.56"/>
<polygon fill="black" stroke="black" points="7064,-2531.56 7060.5,-2521.56 7057,-2531.56 7064,-2531.56"/>
</g>
<!-- layer_14_expert_9 -->
<g id="node348" class="node">
<title>layer_14_expert_9</title>
<polygon fill="lightblue" stroke="black" points="13212,-2521.17 12850,-2521.17 12850,-2453.17 13212,-2453.17 13212,-2521.17"/>
<text text-anchor="middle" x="13031" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="13031" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_9 -->
<g id="edge834" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_9</title>
<path fill="none" stroke="black" d="M11020.25,-3012C11545.42,-3012 13031,-3012 13031,-3012 13031,-3012 13031,-2531.2 13031,-2531.2"/>
<polygon fill="black" stroke="black" points="13034.5,-2531.2 13031,-2521.2 13027.5,-2531.2 13034.5,-2531.2"/>
</g>
<!-- layer_14_expert_10 -->
<g id="node349" class="node">
<title>layer_14_expert_10</title>
<polygon fill="lightblue" stroke="black" points="11952,-2521.17 11590,-2521.17 11590,-2453.17 11952,-2453.17 11952,-2521.17"/>
<text text-anchor="middle" x="11771" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="11771" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_10 -->
<g id="edge837" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_10</title>
<path fill="none" stroke="black" d="M11020.08,-2986C11291.16,-2986 11771,-2986 11771,-2986 11771,-2986 11771,-2531.45 11771,-2531.45"/>
<polygon fill="black" stroke="black" points="11774.5,-2531.45 11771,-2521.45 11767.5,-2531.45 11774.5,-2531.45"/>
</g>
<!-- layer_14_expert_11 -->
<g id="node350" class="node">
<title>layer_14_expert_11</title>
<polygon fill="lightblue" stroke="black" points="7752,-2521.17 7390,-2521.17 7390,-2453.17 7752,-2453.17 7752,-2521.17"/>
<text text-anchor="middle" x="7571" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7571" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_11 -->
<g id="edge840" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_11</title>
<path fill="none" stroke="black" d="M10657.84,-3020C9959.43,-3020 7480.5,-3020 7480.5,-3020 7480.5,-3020 7480.5,-2531.31 7480.5,-2531.31"/>
<polygon fill="black" stroke="black" points="7484,-2531.31 7480.5,-2521.31 7477,-2531.31 7484,-2531.31"/>
</g>
<!-- layer_14_expert_12 -->
<g id="node351" class="node">
<title>layer_14_expert_12</title>
<polygon fill="lightblue" stroke="black" points="10272,-2521.17 9910,-2521.17 9910,-2453.17 10272,-2453.17 10272,-2521.17"/>
<text text-anchor="middle" x="10091" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10091" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_12 -->
<g id="edge843" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_12</title>
<path fill="none" stroke="black" d="M10657.79,-2973C10406.31,-2973 9982.07,-2973 9982.07,-2973 9982.07,-2973 9982.07,-2531.33 9982.07,-2531.33"/>
<polygon fill="black" stroke="black" points="9985.57,-2531.33 9982.07,-2521.33 9978.57,-2531.33 9985.57,-2531.33"/>
</g>
<!-- layer_14_expert_13 -->
<g id="node352" class="node">
<title>layer_14_expert_13</title>
<polygon fill="lightblue" stroke="black" points="13632,-2521.17 13270,-2521.17 13270,-2453.17 13632,-2453.17 13632,-2521.17"/>
<text text-anchor="middle" x="13451" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="13451" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_13 -->
<g id="edge846" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_13</title>
<path fill="none" stroke="black" d="M11020.25,-3020C11625.89,-3020 13541.5,-3020 13541.5,-3020 13541.5,-3020 13541.5,-2531.31 13541.5,-2531.31"/>
<polygon fill="black" stroke="black" points="13545,-2531.31 13541.5,-2521.31 13538,-2531.31 13545,-2531.31"/>
</g>
<!-- layer_14_expert_14 -->
<g id="node353" class="node">
<title>layer_14_expert_14</title>
<polygon fill="lightblue" stroke="black" points="11532,-2521.17 11170,-2521.17 11170,-2453.17 11532,-2453.17 11532,-2521.17"/>
<text text-anchor="middle" x="11351" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11351" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_14 -->
<g id="edge849" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_14</title>
<path fill="none" stroke="black" d="M11020.23,-2978C11167.52,-2978 11351,-2978 11351,-2978 11351,-2978 11351,-2531.29 11351,-2531.29"/>
<polygon fill="black" stroke="black" points="11354.5,-2531.29 11351,-2521.29 11347.5,-2531.29 11354.5,-2531.29"/>
</g>
<!-- layer_14_expert_15 -->
<g id="node354" class="node">
<title>layer_14_expert_15</title>
<polygon fill="lightblue" stroke="black" points="10692,-2521.17 10330,-2521.17 10330,-2453.17 10692,-2453.17 10692,-2521.17"/>
<text text-anchor="middle" x="10511" y="-2505.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="10511" y="-2490.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-2475.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-2460.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_expert_15 -->
<g id="edge852" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_expert_15</title>
<path fill="none" stroke="black" d="M10839.9,-2960.82C10839.9,-2862 10839.9,-2584 10839.9,-2584 10839.9,-2584 10571.33,-2584 10571.33,-2584 10571.33,-2584 10571.33,-2531.31 10571.33,-2531.31"/>
<polygon fill="black" stroke="black" points="10574.83,-2531.31 10571.33,-2521.31 10567.83,-2531.31 10574.83,-2531.31"/>
</g>
<!-- layer_14_add_norm2 -->
<g id="node355" class="node">
<title>layer_14_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="11037,-2095.17 10675,-2095.17 10675,-2027.17 11037,-2027.17 11037,-2095.17"/>
<text text-anchor="middle" x="10856" y="-2079.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10856" y="-2064.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10856" y="-2049.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10856" y="-2034.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_14_add_norm1&#45;&gt;layer_14_add_norm2 -->
<g id="edge855" class="edge">
<title>layer_14_add_norm1&#45;&gt;layer_14_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11020.23,-2969C11075.52,-2969 11122,-2969 11122,-2969 11122,-2969 11122,-2061 11122,-2061 11122,-2061 11047.1,-2061 11047.1,-2061"/>
<polygon fill="black" stroke="black" points="11047.1,-2057.5 11037.1,-2061 11047.1,-2064.5 11047.1,-2057.5"/>
<text text-anchor="middle" x="13837" y="-2483.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_0 -->
<g id="edge806" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10106.22,-2728C9668.06,-2728 8921.5,-2728 8921.5,-2728 8921.5,-2728 8921.5,-2531.42 8921.5,-2531.42"/>
<polygon fill="black" stroke="black" points="8925,-2531.42 8921.5,-2521.42 8918,-2531.42 8925,-2531.42"/>
<text text-anchor="middle" x="9643.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_1 -->
<g id="edge809" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10085.54,-2709C9769.53,-2709 9341.5,-2709 9341.5,-2709 9341.5,-2709 9341.5,-2531.34 9341.5,-2531.34"/>
<polygon fill="black" stroke="black" points="9345,-2531.34 9341.5,-2521.34 9338,-2531.34 9345,-2531.34"/>
<text text-anchor="middle" x="9920.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_2 -->
<g id="edge812" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10694.52,-2738C11172.55,-2738 12100.5,-2738 12100.5,-2738 12100.5,-2738 12100.5,-2531.26 12100.5,-2531.26"/>
<polygon fill="black" stroke="black" points="12104,-2531.26 12100.5,-2521.26 12097,-2531.26 12104,-2531.26"/>
<text text-anchor="middle" x="11583.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_3 -->
<g id="edge815" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10148.8,-2767C9535.18,-2767 8081.5,-2767 8081.5,-2767 8081.5,-2767 8081.5,-2531.2 8081.5,-2531.2"/>
<polygon fill="black" stroke="black" points="8085,-2531.2 8081.5,-2521.2 8078,-2531.2 8085,-2531.2"/>
<text text-anchor="middle" x="8897.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_4 -->
<g id="edge818" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10128.16,-2748C9593.04,-2748 8501.5,-2748 8501.5,-2748 8501.5,-2748 8501.5,-2531.27 8501.5,-2531.27"/>
<polygon fill="black" stroke="black" points="8505,-2531.27 8501.5,-2521.27 8498,-2531.27 8505,-2531.27"/>
<text text-anchor="middle" x="9178.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_5 -->
<g id="edge821" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10764.93,-2748.12C10764.93,-2748.12 10764.93,-2531.33 10764.93,-2531.33"/>
<polygon fill="black" stroke="black" points="10768.43,-2531.33 10764.93,-2521.33 10761.43,-2531.33 10768.43,-2531.33"/>
<text text-anchor="middle" x="10745.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_6 -->
<g id="edge824" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10063.83,-2689C9908.85,-2689 9761.5,-2689 9761.5,-2689 9761.5,-2689 9761.5,-2531.4 9761.5,-2531.4"/>
<polygon fill="black" stroke="black" points="9765,-2531.4 9761.5,-2521.4 9758,-2531.4 9765,-2531.4"/>
<text text-anchor="middle" x="10145.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_7 -->
<g id="edge827" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10715.31,-2757C11295.71,-2757 12520.5,-2757 12520.5,-2757 12520.5,-2757 12520.5,-2531.34 12520.5,-2531.34"/>
<polygon fill="black" stroke="black" points="12524,-2531.34 12520.5,-2521.34 12517,-2531.34 12524,-2531.34"/>
<text text-anchor="middle" x="11994.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_8 -->
<g id="edge830" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10191.49,-2806C9466.35,-2806 7241.5,-2806 7241.5,-2806 7241.5,-2806 7241.5,-2531.29 7241.5,-2531.29"/>
<polygon fill="black" stroke="black" points="7245,-2531.29 7241.5,-2521.29 7238,-2531.29 7245,-2531.29"/>
<text text-anchor="middle" x="8358.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_9 -->
<g id="edge833" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10737.24,-2777C11416.6,-2777 12940.5,-2777 12940.5,-2777 12940.5,-2777 12940.5,-2531.27 12940.5,-2531.27"/>
<polygon fill="black" stroke="black" points="12944,-2531.27 12940.5,-2521.27 12937,-2531.27 12944,-2531.27"/>
<text text-anchor="middle" x="12411.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_10 -->
<g id="edge836" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10673.83,-2719C11043.2,-2719 11680.5,-2719 11680.5,-2719 11680.5,-2719 11680.5,-2531.37 11680.5,-2531.37"/>
<polygon fill="black" stroke="black" points="11684,-2531.37 11680.5,-2521.37 11677,-2531.37 11684,-2531.37"/>
<text text-anchor="middle" x="11200.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_11 -->
<g id="edge839" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10170.65,-2787C9494.8,-2787 7661.5,-2787 7661.5,-2787 7661.5,-2787 7661.5,-2531.27 7661.5,-2531.27"/>
<polygon fill="black" stroke="black" points="7665,-2531.27 7661.5,-2521.27 7658,-2531.27 7665,-2531.27"/>
<text text-anchor="middle" x="8657.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_12 -->
<g id="edge842" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10163.07,-2679.93C10163.07,-2679.93 10163.07,-2531.49 10163.07,-2531.49"/>
<polygon fill="black" stroke="black" points="10166.57,-2531.49 10163.07,-2521.49 10159.57,-2531.49 10166.57,-2531.49"/>
<text text-anchor="middle" x="10322.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_13 -->
<g id="edge845" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10757.89,-2796C11532.92,-2796 13360.5,-2796 13360.5,-2796 13360.5,-2796 13360.5,-2531.4 13360.5,-2531.4"/>
<polygon fill="black" stroke="black" points="13364,-2531.4 13360.5,-2521.4 13357,-2531.4 13364,-2531.4"/>
<text text-anchor="middle" x="12701.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_14 -->
<g id="edge848" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10651.96,-2699C10901.55,-2699 11260.5,-2699 11260.5,-2699 11260.5,-2699 11260.5,-2531.2 11260.5,-2531.2"/>
<polygon fill="black" stroke="black" points="11264,-2531.2 11260.5,-2521.2 11257,-2531.2 11264,-2531.2"/>
<text text-anchor="middle" x="10929.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_15 -->
<g id="edge851" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10450.67,-2679.93C10450.67,-2679.93 10450.67,-2531.49 10450.67,-2531.49"/>
<polygon fill="black" stroke="black" points="10454.17,-2531.49 10450.67,-2521.49 10447.17,-2531.49 10454.17,-2531.49"/>
<text text-anchor="middle" x="10475.5" y="-2596.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_14_moe_agg&#45;&gt;layer_14_add_norm2 -->
<g id="edge854" class="edge">
<title>layer_14_moe_agg&#45;&gt;layer_14_add_norm2</title>
<path fill="none" stroke="black" d="M10808,-2239.94C10808,-2239.94 10808,-2105.3 10808,-2105.3"/>
<polygon fill="black" stroke="black" points="10811.5,-2105.3 10808,-2095.3 10804.5,-2105.3 10811.5,-2105.3"/>
</g>
<!-- layer_14_expert_0&#45;&gt;layer_14_moe_agg -->
<g id="edge808" class="edge">
<title>layer_14_expert_0&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M8831,-2452.97C8831,-2389.98 8831,-2262 8831,-2262 8831,-2262 10568.96,-2262 10568.96,-2262"/>
<polygon fill="black" stroke="black" points="10568.96,-2265.5 10578.96,-2262 10568.96,-2258.5 10568.96,-2265.5"/>
</g>
<!-- layer_14_expert_1&#45;&gt;layer_14_moe_agg -->
<g id="edge811" class="edge">
<title>layer_14_expert_1&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M9251,-2452.77C9251,-2390.84 9251,-2267 9251,-2267 9251,-2267 10568.73,-2267 10568.73,-2267"/>
<polygon fill="black" stroke="black" points="10568.73,-2270.5 10578.73,-2267 10568.73,-2263.5 10568.73,-2270.5"/>
</g>
<!-- layer_14_expert_2&#45;&gt;layer_14_moe_agg -->
<g id="edge814" class="edge">
<title>layer_14_expert_2&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M12281.5,-2452.79C12281.5,-2393.67 12281.5,-2279 12281.5,-2279 12281.5,-2279 10951.26,-2279 10951.26,-2279"/>
<polygon fill="black" stroke="black" points="10951.26,-2275.5 10941.26,-2279 10951.26,-2282.5 10951.26,-2275.5"/>
</g>
<!-- layer_14_expert_3&#45;&gt;layer_14_moe_agg -->
<g id="edge817" class="edge">
<title>layer_14_expert_3&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M7991,-2453.12C7991,-2388.17 7991,-2253 7991,-2253 7991,-2253 10568.85,-2253 10568.85,-2253"/>
<polygon fill="black" stroke="black" points="10568.85,-2256.5 10578.85,-2253 10568.85,-2249.5 10568.85,-2256.5"/>
</g>
<!-- layer_14_expert_4&#45;&gt;layer_14_moe_agg -->
<g id="edge820" class="edge">
<title>layer_14_expert_4&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M8411,-2452.86C8411,-2388.93 8411,-2258 8411,-2258 8411,-2258 10568.61,-2258 10568.61,-2258"/>
<polygon fill="black" stroke="black" points="10568.61,-2261.5 10578.61,-2258 10568.61,-2254.5 10568.61,-2261.5"/>
</g>
<!-- layer_14_expert_5&#45;&gt;layer_14_moe_agg -->
<g id="edge823" class="edge">
<title>layer_14_expert_5&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M10845.5,-2452.94C10845.5,-2452.94 10845.5,-2318.3 10845.5,-2318.3"/>
<polygon fill="black" stroke="black" points="10849,-2318.3 10845.5,-2308.3 10842,-2318.3 10849,-2318.3"/>
</g>
<!-- layer_14_expert_6&#45;&gt;layer_14_moe_agg -->
<g id="edge826" class="edge">
<title>layer_14_expert_6&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M9671,-2452.91C9671,-2391.96 9671,-2271 9671,-2271 9671,-2271 10568.95,-2271 10568.95,-2271"/>
<polygon fill="black" stroke="black" points="10568.95,-2274.5 10578.95,-2271 10568.95,-2267.5 10568.95,-2274.5"/>
</g>
<!-- layer_14_expert_7&#45;&gt;layer_14_moe_agg -->
<g id="edge829" class="edge">
<title>layer_14_expert_7&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M12701.5,-2453.08C12701.5,-2391.72 12701.5,-2269 12701.5,-2269 12701.5,-2269 10951.34,-2269 10951.34,-2269"/>
<polygon fill="black" stroke="black" points="10951.34,-2265.5 10941.34,-2269 10951.34,-2272.5 10951.34,-2265.5"/>
</g>
<!-- layer_14_expert_8&#45;&gt;layer_14_moe_agg -->
<g id="edge832" class="edge">
<title>layer_14_expert_8&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M7151,-2453.1C7151,-2386.18 7151,-2244 7151,-2244 7151,-2244 10568.87,-2244 10568.87,-2244"/>
<polygon fill="black" stroke="black" points="10568.87,-2247.5 10578.87,-2244 10568.87,-2240.5 10568.87,-2247.5"/>
</g>
<!-- layer_14_expert_9&#45;&gt;layer_14_moe_agg -->
<g id="edge835" class="edge">
<title>layer_14_expert_9&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M13031,-2453.01C13031,-2389.36 13031,-2259 13031,-2259 13031,-2259 10951.05,-2259 10951.05,-2259"/>
<polygon fill="black" stroke="black" points="10951.05,-2255.5 10941.05,-2259 10951.05,-2262.5 10951.05,-2255.5"/>
</g>
<!-- layer_14_expert_10&#45;&gt;layer_14_moe_agg -->
<g id="edge838" class="edge">
<title>layer_14_expert_10&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M11861.5,-2452.93C11861.5,-2395.98 11861.5,-2288 11861.5,-2288 11861.5,-2288 10951.27,-2288 10951.27,-2288"/>
<polygon fill="black" stroke="black" points="10951.27,-2284.5 10941.27,-2288 10951.27,-2291.5 10951.27,-2284.5"/>
</g>
<!-- layer_14_expert_11&#45;&gt;layer_14_moe_agg -->
<g id="edge841" class="edge">
<title>layer_14_expert_11&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M7571,-2453.04C7571,-2387.19 7571,-2249 7571,-2249 7571,-2249 10568.83,-2249 10568.83,-2249"/>
<polygon fill="black" stroke="black" points="10568.83,-2252.5 10578.83,-2249 10568.83,-2245.5 10568.83,-2252.5"/>
</g>
<!-- layer_14_expert_12&#45;&gt;layer_14_moe_agg -->
<g id="edge844" class="edge">
<title>layer_14_expert_12&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M10149.57,-2452.77C10149.57,-2392.93 10149.57,-2276 10149.57,-2276 10149.57,-2276 10568.92,-2276 10568.92,-2276"/>
<polygon fill="black" stroke="black" points="10568.92,-2279.5 10578.92,-2276 10568.92,-2272.5 10568.92,-2279.5"/>
</g>
<!-- layer_14_expert_13&#45;&gt;layer_14_moe_agg -->
<g id="edge847" class="edge">
<title>layer_14_expert_13&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M13451,-2453.04C13451,-2387.19 13451,-2249 13451,-2249 13451,-2249 10951.01,-2249 10951.01,-2249"/>
<polygon fill="black" stroke="black" points="10951.01,-2245.5 10941.01,-2249 10951.01,-2252.5 10951.01,-2245.5"/>
</g>
<!-- layer_14_expert_14&#45;&gt;layer_14_moe_agg -->
<g id="edge850" class="edge">
<title>layer_14_expert_14&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M11441.5,-2452.91C11441.5,-2398.4 11441.5,-2298 11441.5,-2298 11441.5,-2298 10951.29,-2298 10951.29,-2298"/>
<polygon fill="black" stroke="black" points="10951.29,-2294.5 10941.29,-2298 10951.29,-2301.5 10951.29,-2294.5"/>
</g>
<!-- layer_14_expert_15&#45;&gt;layer_14_moe_agg -->
<g id="edge853" class="edge">
<title>layer_14_expert_15&#45;&gt;layer_14_moe_agg</title>
<path fill="none" stroke="black" d="M10635.5,-2452.94C10635.5,-2452.94 10635.5,-2318.3 10635.5,-2318.3"/>
<polygon fill="black" stroke="black" points="10639,-2318.3 10635.5,-2308.3 10632,-2318.3 10639,-2318.3"/>
</g>
<!-- layer_15_qkv -->
<g id="node356" class="node">
<title>layer_15_qkv</title>
<polygon fill="lightblue" stroke="black" points="10789.5,-1882.17 10380.5,-1882.17 10380.5,-1814.17 10789.5,-1814.17 10789.5,-1882.17"/>
<text text-anchor="middle" x="10585" y="-1866.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10585" y="-1851.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10585" y="-1836.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10585" y="-1821.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_14_add_norm2&#45;&gt;layer_15_qkv -->
<g id="edge856" class="edge">
<title>layer_14_add_norm2&#45;&gt;layer_15_qkv</title>
<path fill="none" stroke="black" d="M10732.25,-2026.94C10732.25,-2026.94 10732.25,-1892.3 10732.25,-1892.3"/>
<polygon fill="black" stroke="black" points="10735.75,-1892.3 10732.25,-1882.3 10728.75,-1892.3 10735.75,-1892.3"/>
</g>
<!-- layer_15_add_norm1 -->
<g id="node359" class="node">
<title>layer_15_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="10993,-1243.17 10631,-1243.17 10631,-1175.17 10993,-1175.17 10993,-1243.17"/>
<text text-anchor="middle" x="10812" y="-1227.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="10812" y="-1212.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10812" y="-1197.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10812" y="-1182.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_14_add_norm2&#45;&gt;layer_15_add_norm1 -->
<g id="edge860" class="edge">
<title>layer_14_add_norm2&#45;&gt;layer_15_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10891.25,-2026.98C10891.25,-2026.98 10891.25,-1253.62 10891.25,-1253.62"/>
<polygon fill="black" stroke="black" points="10894.75,-1253.62 10891.25,-1243.62 10887.75,-1253.62 10894.75,-1253.62"/>
<text text-anchor="middle" x="10906" y="-1631.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_15_attn -->
<g id="node357" class="node">
<title>layer_15_attn</title>
<polygon fill="lightblue" stroke="black" points="10760.5,-1669.17 10351.5,-1669.17 10351.5,-1601.17 10760.5,-1601.17 10760.5,-1669.17"/>
<text text-anchor="middle" x="10556" y="-1653.97" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10556" y="-1638.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10556" y="-1623.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10556" y="-1608.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_15_qkv&#45;&gt;layer_15_attn -->
<g id="edge857" class="edge">
<title>layer_15_qkv&#45;&gt;layer_15_attn</title>
<path fill="none" stroke="black" d="M10570.5,-1813.94C10570.5,-1813.94 10570.5,-1679.3 10570.5,-1679.3"/>
<polygon fill="black" stroke="black" points="10574,-1679.3 10570.5,-1669.3 10567,-1679.3 10574,-1679.3"/>
</g>
<!-- layer_15_proj -->
<g id="node358" class="node">
<title>layer_15_proj</title>
<polygon fill="lightblue" stroke="black" points="10786.5,-1456.17 10389.5,-1456.17 10389.5,-1388.17 10786.5,-1388.17 10786.5,-1456.17"/>
<text text-anchor="middle" x="10588" y="-1440.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="10588" y="-1425.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10588" y="-1410.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10588" y="-1395.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_15_attn&#45;&gt;layer_15_proj -->
<g id="edge858" class="edge">
<title>layer_15_attn&#45;&gt;layer_15_proj</title>
<path fill="none" stroke="black" d="M10575,-1600.94C10575,-1600.94 10575,-1466.3 10575,-1466.3"/>
<polygon fill="black" stroke="black" points="10578.5,-1466.3 10575,-1456.3 10571.5,-1466.3 10578.5,-1466.3"/>
</g>
<!-- layer_15_proj&#45;&gt;layer_15_add_norm1 -->
<g id="edge859" class="edge">
<title>layer_15_proj&#45;&gt;layer_15_add_norm1</title>
<path fill="none" stroke="black" d="M10708.75,-1387.94C10708.75,-1387.94 10708.75,-1253.3 10708.75,-1253.3"/>
<polygon fill="black" stroke="black" points="10712.25,-1253.3 10708.75,-1243.3 10705.25,-1253.3 10712.25,-1253.3"/>
</g>
<!-- layer_15_gate -->
<g id="node360" class="node">
<title>layer_15_gate</title>
<polygon fill="yellow" stroke="black" points="10752.73,-1030.17 10175.71,-1030.17 10027.27,-894.17 10604.29,-894.17 10752.73,-1030.17"/>
<text text-anchor="middle" x="10390" y="-980.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="10390" y="-965.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10390" y="-950.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, topk=2]</text>
<text text-anchor="middle" x="10390" y="-935.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_gate -->
<g id="edge861" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_gate</title>
<path fill="none" stroke="black" d="M10691.93,-1175.08C10691.93,-1175.08 10691.93,-1040.37 10691.93,-1040.37"/>
<polygon fill="black" stroke="black" points="10695.43,-1040.37 10691.93,-1030.37 10688.43,-1040.37 10695.43,-1040.37"/>
</g>
<!-- layer_15_moe_agg -->
<g id="node361" class="node">
<title>layer_15_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="10799,-522.17 10437,-522.17 10437,-454.17 10799,-454.17 10799,-522.17"/>
<text text-anchor="middle" x="10618" y="-506.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="10618" y="-491.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10618" y="-476.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10618" y="-461.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_moe_agg -->
<g id="edge862" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M10872.93,-1175.13C10872.93,-1071.35 10872.93,-766 10872.93,-766 10872.93,-766 10711.33,-766 10711.33,-766 10711.33,-766 10711.33,-532.23 10711.33,-532.23"/>
<polygon fill="black" stroke="black" points="10714.83,-532.23 10711.33,-522.23 10707.83,-532.23 10714.83,-532.23"/>
</g>
<!-- layer_15_expert_0 -->
<g id="node362" class="node">
<title>layer_15_expert_0</title>
<polygon fill="lightblue" stroke="black" points="9012,-735.17 8650,-735.17 8650,-667.17 9012,-667.17 9012,-735.17"/>
<text text-anchor="middle" x="8831" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8831" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8831" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_0 -->
<g id="edge864" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_0</title>
<path fill="none" stroke="black" d="M10630.89,-1209C10126.15,-1209 8740.5,-1209 8740.5,-1209 8740.5,-1209 8740.5,-745.28 8740.5,-745.28"/>
<polygon fill="black" stroke="black" points="8744,-745.28 8740.5,-735.28 8737,-745.28 8744,-745.28"/>
</g>
<!-- layer_15_expert_1 -->
<g id="node363" class="node">
<title>layer_15_expert_1</title>
<polygon fill="lightblue" stroke="black" points="9432,-735.17 9070,-735.17 9070,-667.17 9432,-667.17 9432,-735.17"/>
<text text-anchor="middle" x="9251" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9251" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9251" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_1 -->
<g id="edge867" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_1</title>
<path fill="none" stroke="black" d="M10630.93,-1200C10202.16,-1200 9160.5,-1200 9160.5,-1200 9160.5,-1200 9160.5,-745.45 9160.5,-745.45"/>
<polygon fill="black" stroke="black" points="9164,-745.45 9160.5,-735.45 9157,-745.45 9164,-745.45"/>
</g>
<!-- layer_15_expert_2 -->
<g id="node364" class="node">
<title>layer_15_expert_2</title>
<polygon fill="lightblue" stroke="black" points="12372,-735.17 12010,-735.17 12010,-667.17 12372,-667.17 12372,-735.17"/>
<text text-anchor="middle" x="12191" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12191" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12191" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_2 -->
<g id="edge870" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_2</title>
<path fill="none" stroke="black" d="M10993.34,-1200C11367.64,-1200 12191,-1200 12191,-1200 12191,-1200 12191,-745.45 12191,-745.45"/>
<polygon fill="black" stroke="black" points="12194.5,-745.45 12191,-735.45 12187.5,-745.45 12194.5,-745.45"/>
</g>
<!-- layer_15_expert_3 -->
<g id="node365" class="node">
<title>layer_15_expert_3</title>
<polygon fill="lightblue" stroke="black" points="8172,-735.17 7810,-735.17 7810,-667.17 8172,-667.17 8172,-735.17"/>
<text text-anchor="middle" x="7991" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7991" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7991" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_3 -->
<g id="edge873" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_3</title>
<path fill="none" stroke="black" d="M10630.97,-1230C9994.89,-1230 7900.5,-1230 7900.5,-1230 7900.5,-1230 7900.5,-745.46 7900.5,-745.46"/>
<polygon fill="black" stroke="black" points="7904,-745.46 7900.5,-735.46 7897,-745.46 7904,-745.46"/>
</g>
<!-- layer_15_expert_4 -->
<g id="node366" class="node">
<title>layer_15_expert_4</title>
<polygon fill="lightblue" stroke="black" points="8592,-735.17 8230,-735.17 8230,-667.17 8592,-667.17 8592,-735.17"/>
<text text-anchor="middle" x="8411" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8411" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="8411" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_4 -->
<g id="edge876" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_4</title>
<path fill="none" stroke="black" d="M10630.81,-1221C10057.47,-1221 8320.5,-1221 8320.5,-1221 8320.5,-1221 8320.5,-745.27 8320.5,-745.27"/>
<polygon fill="black" stroke="black" points="8324,-745.27 8320.5,-735.27 8317,-745.27 8324,-745.27"/>
</g>
<!-- layer_15_expert_5 -->
<g id="node367" class="node">
<title>layer_15_expert_5</title>
<polygon fill="lightblue" stroke="black" points="11112,-735.17 10750,-735.17 10750,-667.17 11112,-667.17 11112,-735.17"/>
<text text-anchor="middle" x="10931" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10931" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10931" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_5 -->
<g id="edge879" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_5</title>
<path fill="none" stroke="black" d="M10932.97,-1175.05C10932.97,-1175.05 10932.97,-745.47 10932.97,-745.47"/>
<polygon fill="black" stroke="black" points="10936.47,-745.47 10932.97,-735.47 10929.47,-745.47 10936.47,-745.47"/>
</g>
<!-- layer_15_expert_6 -->
<g id="node368" class="node">
<title>layer_15_expert_6</title>
<polygon fill="lightblue" stroke="black" points="9852,-735.17 9490,-735.17 9490,-667.17 9852,-667.17 9852,-735.17"/>
<text text-anchor="middle" x="9671" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9671" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="9671" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_6 -->
<g id="edge882" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_6</title>
<path fill="none" stroke="black" d="M10630.95,-1192C10288.64,-1192 9580.5,-1192 9580.5,-1192 9580.5,-1192 9580.5,-745.29 9580.5,-745.29"/>
<polygon fill="black" stroke="black" points="9584,-745.29 9580.5,-735.29 9577,-745.29 9584,-745.29"/>
</g>
<!-- layer_15_expert_7 -->
<g id="node369" class="node">
<title>layer_15_expert_7</title>
<polygon fill="lightblue" stroke="black" points="12792,-735.17 12430,-735.17 12430,-667.17 12792,-667.17 12792,-735.17"/>
<text text-anchor="middle" x="12611" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12611" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12611" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_7 -->
<g id="edge885" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_7</title>
<path fill="none" stroke="black" d="M10993.15,-1217C11449.64,-1217 12611,-1217 12611,-1217 12611,-1217 12611,-745.41 12611,-745.41"/>
<polygon fill="black" stroke="black" points="12614.5,-745.41 12611,-735.41 12607.5,-745.41 12614.5,-745.41"/>
</g>
<!-- layer_15_expert_8 -->
<g id="node370" class="node">
<title>layer_15_expert_8</title>
<polygon fill="lightblue" stroke="black" points="7332,-735.17 6970,-735.17 6970,-667.17 7332,-667.17 7332,-735.17"/>
<text text-anchor="middle" x="7151" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7151" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7151" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_8 -->
<g id="edge888" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_8</title>
<path fill="none" stroke="black" d="M10630.74,-1238C9880.89,-1238 7060.5,-1238 7060.5,-1238 7060.5,-1238 7060.5,-745.56 7060.5,-745.56"/>
<polygon fill="black" stroke="black" points="7064,-745.56 7060.5,-735.56 7057,-745.56 7064,-745.56"/>
</g>
<!-- layer_15_expert_9 -->
<g id="node371" class="node">
<title>layer_15_expert_9</title>
<polygon fill="lightblue" stroke="black" points="13212,-735.17 12850,-735.17 12850,-667.17 13212,-667.17 13212,-735.17"/>
<text text-anchor="middle" x="13031" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="13031" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13031" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_9 -->
<g id="edge891" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_9</title>
<path fill="none" stroke="black" d="M10993.22,-1226C11537.67,-1226 13121.5,-1226 13121.5,-1226 13121.5,-1226 13121.5,-745.2 13121.5,-745.2"/>
<polygon fill="black" stroke="black" points="13125,-745.2 13121.5,-735.2 13118,-745.2 13125,-745.2"/>
</g>
<!-- layer_15_expert_10 -->
<g id="node372" class="node">
<title>layer_15_expert_10</title>
<polygon fill="lightblue" stroke="black" points="11952,-735.17 11590,-735.17 11590,-667.17 11952,-667.17 11952,-735.17"/>
<text text-anchor="middle" x="11771" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="11771" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11771" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_10 -->
<g id="edge894" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_10</title>
<path fill="none" stroke="black" d="M10993.23,-1192C11271.19,-1192 11771,-1192 11771,-1192 11771,-1192 11771,-745.29 11771,-745.29"/>
<polygon fill="black" stroke="black" points="11774.5,-745.29 11771,-735.29 11767.5,-745.29 11774.5,-745.29"/>
</g>
<!-- layer_15_expert_11 -->
<g id="node373" class="node">
<title>layer_15_expert_11</title>
<polygon fill="lightblue" stroke="black" points="7752,-735.17 7390,-735.17 7390,-667.17 7752,-667.17 7752,-735.17"/>
<text text-anchor="middle" x="7571" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7571" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="7571" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_11 -->
<g id="edge897" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_11</title>
<path fill="none" stroke="black" d="M10630.81,-1234C9936.01,-1234 7480.5,-1234 7480.5,-1234 7480.5,-1234 7480.5,-745.31 7480.5,-745.31"/>
<polygon fill="black" stroke="black" points="7484,-745.31 7480.5,-735.31 7477,-745.31 7484,-745.31"/>
</g>
<!-- layer_15_expert_12 -->
<g id="node374" class="node">
<title>layer_15_expert_12</title>
<polygon fill="lightblue" stroke="black" points="10272,-735.17 9910,-735.17 9910,-667.17 10272,-667.17 10272,-735.17"/>
<text text-anchor="middle" x="10091" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10091" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10091" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_12 -->
<g id="edge900" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_12</title>
<path fill="none" stroke="black" d="M10630.8,-1183C10382.95,-1183 9968.57,-1183 9968.57,-1183 9968.57,-1183 9968.57,-745.43 9968.57,-745.43"/>
<polygon fill="black" stroke="black" points="9972.07,-745.43 9968.57,-735.43 9965.07,-745.43 9972.07,-745.43"/>
</g>
<!-- layer_15_expert_13 -->
<g id="node375" class="node">
<title>layer_15_expert_13</title>
<polygon fill="lightblue" stroke="black" points="13632,-735.17 13270,-735.17 13270,-667.17 13632,-667.17 13632,-735.17"/>
<text text-anchor="middle" x="13451" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="13451" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="13451" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_13 -->
<g id="edge903" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_13</title>
<path fill="none" stroke="black" d="M10993.2,-1234C11602.83,-1234 13541.5,-1234 13541.5,-1234 13541.5,-1234 13541.5,-745.31 13541.5,-745.31"/>
<polygon fill="black" stroke="black" points="13545,-745.31 13541.5,-735.31 13538,-745.31 13545,-745.31"/>
</g>
<!-- layer_15_expert_14 -->
<g id="node376" class="node">
<title>layer_15_expert_14</title>
<polygon fill="lightblue" stroke="black" points="11532,-735.17 11170,-735.17 11170,-667.17 11532,-667.17 11532,-735.17"/>
<text text-anchor="middle" x="11351" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11351" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="11351" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_14 -->
<g id="edge906" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_14</title>
<path fill="none" stroke="black" d="M10993.35,-1183C11149.89,-1183 11351,-1183 11351,-1183 11351,-1183 11351,-745.43 11351,-745.43"/>
<polygon fill="black" stroke="black" points="11354.5,-745.43 11351,-735.43 11347.5,-745.43 11354.5,-745.43"/>
</g>
<!-- layer_15_expert_15 -->
<g id="node377" class="node">
<title>layer_15_expert_15</title>
<polygon fill="lightblue" stroke="black" points="10692,-735.17 10330,-735.17 10330,-667.17 10692,-667.17 10692,-735.17"/>
<text text-anchor="middle" x="10511" y="-719.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="10511" y="-704.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="10511" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_expert_15 -->
<g id="edge909" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_expert_15</title>
<path fill="none" stroke="black" d="M10812.9,-1174.82C10812.9,-1076 10812.9,-798 10812.9,-798 10812.9,-798 10571.33,-798 10571.33,-798 10571.33,-798 10571.33,-745.31 10571.33,-745.31"/>
<polygon fill="black" stroke="black" points="10574.83,-745.31 10571.33,-735.31 10567.83,-745.31 10574.83,-745.31"/>
</g>
<!-- layer_15_add_norm2 -->
<g id="node378" class="node">
<title>layer_15_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="12386,-309.17 12024,-309.17 12024,-241.17 12386,-241.17 12386,-309.17"/>
<text text-anchor="middle" x="12205" y="-293.97" font-family="Times,serif" font-size="14.00">Residual+Norm</text>
<text text-anchor="middle" x="12205" y="-278.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12205" y="-263.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12205" y="-248.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_15_add_norm1&#45;&gt;layer_15_add_norm2 -->
<g id="edge912" class="edge">
<title>layer_15_add_norm1&#45;&gt;layer_15_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10993.29,-1209C11405.77,-1209 12379,-1209 12379,-1209 12379,-1209 12379,-319.23 12379,-319.23"/>
<polygon fill="black" stroke="black" points="12382.5,-319.23 12379,-309.23 12375.5,-319.23 12382.5,-319.23"/>
<text text-anchor="middle" x="13837" y="-697.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_0 -->
<g id="edge863" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10079.47,-942C9648.51,-942 8921.5,-942 8921.5,-942 8921.5,-942 8921.5,-745.42 8921.5,-745.42"/>
<polygon fill="black" stroke="black" points="8925,-745.42 8921.5,-735.42 8918,-745.42 8925,-745.42"/>
<text text-anchor="middle" x="9452.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_1 -->
<g id="edge866" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10058.61,-923C9751.39,-923 9341.5,-923 9341.5,-923 9341.5,-923 9341.5,-745.34 9341.5,-745.34"/>
<polygon fill="black" stroke="black" points="9345,-745.34 9341.5,-735.34 9338,-745.34 9345,-745.34"/>
<text text-anchor="middle" x="9893.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_2 -->
<g id="edge869" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10667.67,-952C11152.08,-952 12100.5,-952 12100.5,-952 12100.5,-952 12100.5,-745.26 12100.5,-745.26"/>
<polygon fill="black" stroke="black" points="12104,-745.26 12100.5,-735.26 12097,-745.26 12104,-745.26"/>
<text text-anchor="middle" x="11556.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_3 -->
<g id="edge872" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10121.8,-981C9513.49,-981 8081.5,-981 8081.5,-981 8081.5,-981 8081.5,-745.2 8081.5,-745.2"/>
<polygon fill="black" stroke="black" points="8085,-745.2 8081.5,-735.2 8078,-745.2 8085,-745.2"/>
<text text-anchor="middle" x="8723.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_4 -->
<g id="edge875" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10101.12,-962C9572.1,-962 8501.5,-962 8501.5,-962 8501.5,-962 8501.5,-745.27 8501.5,-745.27"/>
<polygon fill="black" stroke="black" points="8505,-745.27 8501.5,-735.27 8498,-745.27 8505,-745.27"/>
<text text-anchor="middle" x="9171.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_5 -->
<g id="edge878" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10730.67,-962.12C10730.67,-958.1 10730.67,-701 10730.67,-701 10730.67,-701 10739.88,-701 10739.88,-701"/>
<polygon fill="black" stroke="black" points="10739.88,-704.5 10749.88,-701 10739.88,-697.5 10739.88,-704.5"/>
<text text-anchor="middle" x="10718.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_6 -->
<g id="edge881" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10036.71,-903C9893.62,-903 9761.5,-903 9761.5,-903 9761.5,-903 9761.5,-745.4 9761.5,-745.4"/>
<polygon fill="black" stroke="black" points="9765,-745.4 9761.5,-735.4 9758,-745.4 9765,-745.4"/>
<text text-anchor="middle" x="10179.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_7 -->
<g id="edge884" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10688.2,-971C11274.43,-971 12520.5,-971 12520.5,-971 12520.5,-971 12520.5,-745.34 12520.5,-745.34"/>
<polygon fill="black" stroke="black" points="12524,-745.34 12520.5,-735.34 12517,-745.34 12524,-745.34"/>
<text text-anchor="middle" x="11967.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_8 -->
<g id="edge887" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10164.52,-1020C9443.57,-1020 7241.5,-1020 7241.5,-1020 7241.5,-1020 7241.5,-745.29 7241.5,-745.29"/>
<polygon fill="black" stroke="black" points="7245,-745.29 7241.5,-735.29 7238,-745.29 7245,-745.29"/>
<text text-anchor="middle" x="7995.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_9 -->
<g id="edge890" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10710.12,-991C11394.97,-991 12940.5,-991 12940.5,-991 12940.5,-991 12940.5,-745.27 12940.5,-745.27"/>
<polygon fill="black" stroke="black" points="12944,-745.27 12940.5,-735.27 12937,-745.27 12944,-745.27"/>
<text text-anchor="middle" x="12252.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_10 -->
<g id="edge893" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10646.89,-933C11023.3,-933 11680.5,-933 11680.5,-933 11680.5,-933 11680.5,-745.37 11680.5,-745.37"/>
<polygon fill="black" stroke="black" points="11684,-745.37 11680.5,-735.37 11677,-745.37 11684,-745.37"/>
<text text-anchor="middle" x="11173.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_11 -->
<g id="edge896" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10143.66,-1001C9472.49,-1001 7661.5,-1001 7661.5,-1001 7661.5,-1001 7661.5,-745.27 7661.5,-745.27"/>
<polygon fill="black" stroke="black" points="7665,-745.27 7661.5,-735.27 7658,-745.27 7665,-745.27"/>
<text text-anchor="middle" x="8340.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_12 -->
<g id="edge899" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10149.57,-893.93C10149.57,-893.93 10149.57,-745.49 10149.57,-745.49"/>
<polygon fill="black" stroke="black" points="10153.07,-745.49 10149.57,-735.49 10146.07,-745.49 10153.07,-745.49"/>
<text text-anchor="middle" x="10355.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_13 -->
<g id="edge902" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10730.75,-1010C11511.01,-1010 13360.5,-1010 13360.5,-1010 13360.5,-1010 13360.5,-745.4 13360.5,-745.4"/>
<polygon fill="black" stroke="black" points="13364,-745.4 13360.5,-735.4 13357,-745.4 13364,-745.4"/>
<text text-anchor="middle" x="12423.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_14 -->
<g id="edge905" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10625,-913C10882.81,-913 11260.5,-913 11260.5,-913 11260.5,-913 11260.5,-745.2 11260.5,-745.2"/>
<polygon fill="black" stroke="black" points="11264,-745.2 11260.5,-735.2 11257,-745.2 11264,-745.2"/>
<text text-anchor="middle" x="10902.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_15 -->
<g id="edge908" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10450.67,-893.93C10450.67,-893.93 10450.67,-745.49 10450.67,-745.49"/>
<polygon fill="black" stroke="black" points="10454.17,-745.49 10450.67,-735.49 10447.17,-745.49 10454.17,-745.49"/>
<text text-anchor="middle" x="10502.5" y="-810.97" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- layer_15_moe_agg&#45;&gt;layer_15_add_norm2 -->
<g id="edge911" class="edge">
<title>layer_15_moe_agg&#45;&gt;layer_15_add_norm2</title>
<path fill="none" stroke="black" d="M10799.25,-462C11214.26,-462 12198,-462 12198,-462 12198,-462 12198,-319.43 12198,-319.43"/>
<polygon fill="black" stroke="black" points="12201.5,-319.43 12198,-309.43 12194.5,-319.43 12201.5,-319.43"/>
</g>
<!-- layer_15_expert_0&#45;&gt;layer_15_moe_agg -->
<g id="edge865" class="edge">
<title>layer_15_expert_0&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M8831,-666.82C8831,-603.55 8831,-475 8831,-475 8831,-475 10426.82,-475 10426.82,-475"/>
<polygon fill="black" stroke="black" points="10426.82,-478.5 10436.82,-475 10426.82,-471.5 10426.82,-478.5"/>
</g>
<!-- layer_15_expert_1&#45;&gt;layer_15_moe_agg -->
<g id="edge868" class="edge">
<title>layer_15_expert_1&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M9251,-666.94C9251,-604.62 9251,-479 9251,-479 9251,-479 10426.83,-479 10426.83,-479"/>
<polygon fill="black" stroke="black" points="10426.83,-482.5 10436.83,-479 10426.83,-475.5 10426.83,-482.5"/>
</g>
<!-- layer_15_expert_2&#45;&gt;layer_15_moe_agg -->
<g id="edge871" class="edge">
<title>layer_15_expert_2&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M12017,-666.83C12017,-608.42 12017,-496 12017,-496 12017,-496 10809.1,-496 10809.1,-496"/>
<polygon fill="black" stroke="black" points="10809.1,-492.5 10799.1,-496 10809.1,-499.5 10809.1,-492.5"/>
</g>
<!-- layer_15_expert_3&#45;&gt;layer_15_moe_agg -->
<g id="edge874" class="edge">
<title>layer_15_expert_3&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M7991,-666.97C7991,-601.75 7991,-466 7991,-466 7991,-466 10426.92,-466 10426.92,-466"/>
<polygon fill="black" stroke="black" points="10426.92,-469.5 10436.92,-466 10426.92,-462.5 10426.92,-469.5"/>
</g>
<!-- layer_15_expert_4&#45;&gt;layer_15_moe_agg -->
<g id="edge877" class="edge">
<title>layer_15_expert_4&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M8411,-666.71C8411,-602.5 8411,-471 8411,-471 8411,-471 10426.92,-471 10426.92,-471"/>
<polygon fill="black" stroke="black" points="10426.92,-474.5 10436.92,-471 10426.92,-467.5 10426.92,-474.5"/>
</g>
<!-- layer_15_expert_5&#45;&gt;layer_15_moe_agg -->
<g id="edge880" class="edge">
<title>layer_15_expert_5&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M10774.5,-666.94C10774.5,-666.94 10774.5,-532.3 10774.5,-532.3"/>
<polygon fill="black" stroke="black" points="10778,-532.3 10774.5,-522.3 10771,-532.3 10778,-532.3"/>
</g>
<!-- layer_15_expert_6&#45;&gt;layer_15_moe_agg -->
<g id="edge883" class="edge">
<title>layer_15_expert_6&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M9671,-667.08C9671,-605.72 9671,-483 9671,-483 9671,-483 10426.81,-483 10426.81,-483"/>
<polygon fill="black" stroke="black" points="10426.81,-486.5 10436.81,-483 10426.81,-479.5 10426.81,-486.5"/>
</g>
<!-- layer_15_expert_7&#45;&gt;layer_15_moe_agg -->
<g id="edge886" class="edge">
<title>layer_15_expert_7&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M12445.49,-666.92C12445.49,-606.66 12445.49,-488 12445.49,-488 12445.49,-488 10809.07,-488 10809.07,-488"/>
<polygon fill="black" stroke="black" points="10809.07,-484.5 10799.07,-488 10809.07,-491.5 10809.07,-484.5"/>
</g>
<!-- layer_15_expert_8&#45;&gt;layer_15_moe_agg -->
<g id="edge889" class="edge">
<title>layer_15_expert_8&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M7151,-667.1C7151,-600.18 7151,-458 7151,-458 7151,-458 10426.78,-458 10426.78,-458"/>
<polygon fill="black" stroke="black" points="10426.78,-461.5 10436.78,-458 10426.78,-454.5 10426.78,-461.5"/>
</g>
<!-- layer_15_expert_9&#45;&gt;layer_15_moe_agg -->
<g id="edge892" class="edge">
<title>layer_15_expert_9&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M13031,-666.94C13031,-604.62 13031,-479 13031,-479 13031,-479 10809.37,-479 10809.37,-479"/>
<polygon fill="black" stroke="black" points="10809.37,-475.5 10799.37,-479 10809.37,-482.5 10809.37,-475.5"/>
</g>
<!-- layer_15_expert_10&#45;&gt;layer_15_moe_agg -->
<g id="edge895" class="edge">
<title>layer_15_expert_10&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M11769.51,-667C11769.51,-610.79 11769.51,-505 11769.51,-505 11769.51,-505 10809.19,-505 10809.19,-505"/>
<polygon fill="black" stroke="black" points="10809.19,-501.5 10799.19,-505 10809.19,-508.5 10809.19,-501.5"/>
</g>
<!-- layer_15_expert_11&#45;&gt;layer_15_moe_agg -->
<g id="edge898" class="edge">
<title>layer_15_expert_11&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M7571,-667.15C7571,-601.12 7571,-462 7571,-462 7571,-462 10426.8,-462 10426.8,-462"/>
<polygon fill="black" stroke="black" points="10426.8,-465.5 10436.8,-462 10426.8,-458.5 10426.8,-465.5"/>
</g>
<!-- layer_15_expert_12&#45;&gt;layer_15_moe_agg -->
<g id="edge901" class="edge">
<title>layer_15_expert_12&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M10091,-666.92C10091,-606.66 10091,-488 10091,-488 10091,-488 10426.64,-488 10426.64,-488"/>
<polygon fill="black" stroke="black" points="10426.64,-491.5 10436.64,-488 10426.64,-484.5 10426.64,-491.5"/>
</g>
<!-- layer_15_expert_13&#45;&gt;layer_15_moe_agg -->
<g id="edge904" class="edge">
<title>layer_15_expert_13&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M13451,-666.71C13451,-602.5 13451,-471 13451,-471 13451,-471 10809.26,-471 10809.26,-471"/>
<polygon fill="black" stroke="black" points="10809.26,-467.5 10799.26,-471 10809.26,-474.5 10809.26,-467.5"/>
</g>
<!-- layer_15_expert_14&#45;&gt;layer_15_moe_agg -->
<g id="edge907" class="edge">
<title>layer_15_expert_14&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M11351,-667.09C11351,-612.87 11351,-513 11351,-513 11351,-513 10809.19,-513 10809.19,-513"/>
<polygon fill="black" stroke="black" points="10809.19,-509.5 10799.19,-513 10809.19,-516.5 10809.19,-509.5"/>
</g>
<!-- layer_15_expert_15&#45;&gt;layer_15_moe_agg -->
<g id="edge910" class="edge">
<title>layer_15_expert_15&#45;&gt;layer_15_moe_agg</title>
<path fill="none" stroke="black" d="M10564.5,-666.94C10564.5,-666.94 10564.5,-532.3 10564.5,-532.3"/>
<polygon fill="black" stroke="black" points="10568,-532.3 10564.5,-522.3 10561,-532.3 10568,-532.3"/>
</g>
<!-- output -->
<g id="node387" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="12205" cy="-48.08" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="12205" y="-66.88" font-family="Times,serif" font-size="14.00">Total Output</text>
<text text-anchor="middle" x="12205" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12205" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="12205" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer_15_add_norm2&#45;&gt;output -->
<g id="edge913" class="edge">
<title>layer_15_add_norm2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12205,-240.68C12205,-240.68 12205,-106.4 12205,-106.4"/>
<polygon fill="black" stroke="black" points="12208.5,-106.4 12205,-96.4 12201.5,-106.4 12208.5,-106.4"/>
</g>
<!-- layer_8_mha -->
<g id="node379" class="node">
<title>layer_8_mha</title>
<polygon fill="lightblue" stroke="black" points="10663.5,-14384.17 10254.5,-14384.17 10254.5,-14316.17 10663.5,-14316.17 10663.5,-14384.17"/>
<text text-anchor="middle" x="10459" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 8</text>
<text text-anchor="middle" x="10459" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10459" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10459" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_9_mha -->
<g id="node380" class="node">
<title>layer_9_mha</title>
<polygon fill="lightblue" stroke="black" points="10196.5,-14384.17 9787.5,-14384.17 9787.5,-14316.17 10196.5,-14316.17 10196.5,-14384.17"/>
<text text-anchor="middle" x="9992" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 9</text>
<text text-anchor="middle" x="9992" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9992" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9992" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_10_mha -->
<g id="node381" class="node">
<title>layer_10_mha</title>
<polygon fill="lightblue" stroke="black" points="9729.5,-14384.17 9320.5,-14384.17 9320.5,-14316.17 9729.5,-14316.17 9729.5,-14384.17"/>
<text text-anchor="middle" x="9525" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 10</text>
<text text-anchor="middle" x="9525" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9525" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9525" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_11_mha -->
<g id="node382" class="node">
<title>layer_11_mha</title>
<polygon fill="lightblue" stroke="black" points="9262.5,-14384.17 8853.5,-14384.17 8853.5,-14316.17 9262.5,-14316.17 9262.5,-14384.17"/>
<text text-anchor="middle" x="9058" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 11</text>
<text text-anchor="middle" x="9058" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9058" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9058" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_12_mha -->
<g id="node383" class="node">
<title>layer_12_mha</title>
<polygon fill="lightblue" stroke="black" points="8795.5,-14384.17 8386.5,-14384.17 8386.5,-14316.17 8795.5,-14316.17 8795.5,-14384.17"/>
<text text-anchor="middle" x="8591" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 12</text>
<text text-anchor="middle" x="8591" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8591" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8591" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_13_mha -->
<g id="node384" class="node">
<title>layer_13_mha</title>
<polygon fill="lightblue" stroke="black" points="8327.5,-14384.17 7918.5,-14384.17 7918.5,-14316.17 8327.5,-14316.17 8327.5,-14384.17"/>
<text text-anchor="middle" x="8123" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 13</text>
<text text-anchor="middle" x="8123" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8123" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8123" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_14_mha -->
<g id="node385" class="node">
<title>layer_14_mha</title>
<polygon fill="lightblue" stroke="black" points="7858.5,-14384.17 7449.5,-14384.17 7449.5,-14316.17 7858.5,-14316.17 7858.5,-14384.17"/>
<text text-anchor="middle" x="7654" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 14</text>
<text text-anchor="middle" x="7654" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7654" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7654" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
<!-- layer_15_mha -->
<g id="node386" class="node">
<title>layer_15_mha</title>
<polygon fill="lightblue" stroke="black" points="7387.5,-14384.17 6978.5,-14384.17 6978.5,-14316.17 7387.5,-14316.17 7387.5,-14384.17"/>
<text text-anchor="middle" x="7183" y="-14368.97" font-family="Times,serif" font-size="14.00">MHA Layer 15</text>
<text text-anchor="middle" x="7183" y="-14353.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7183" y="-14338.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7183" y="-14323.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP=8)</text>
</g>
</g>
</svg>
