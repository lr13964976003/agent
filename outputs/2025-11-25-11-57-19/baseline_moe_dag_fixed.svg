<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe_dag Pages: 1 -->
<svg width="11379pt" height="1514pt"
 viewBox="0.00 0.00 11378.61 1514.12" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1510.12)">
<title>baseline_moe_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1510.12 11374.61,-1510.12 11374.61,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="1475.61" cy="-1438.12" rx="249.72" ry="48.17"/>
<text text-anchor="middle" x="1475.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Total Input</text>
<text text-anchor="middle" x="1475.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="1475.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="1475.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer_0_qkv -->
<g id="node3" class="node">
<title>layer_0_qkv</title>
<polygon fill="lightblue" stroke="black" points="1774.11,-1329.64 1379.11,-1329.64 1379.11,-1261.64 1774.11,-1261.64 1774.11,-1329.64"/>
<text text-anchor="middle" x="1576.61" y="-1314.44" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1576.61" y="-1299.44" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="1576.61" y="-1284.44" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="1576.61" y="-1269.44" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;layer_0_qkv -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_qkv</title>
<path fill="none" stroke="black" d="M1552.16,-1392.26C1552.16,-1392.26 1552.16,-1339.67 1552.16,-1339.67"/>
<polygon fill="black" stroke="black" points="1555.66,-1339.67 1552.16,-1329.67 1548.66,-1339.67 1555.66,-1339.67"/>
</g>
<!-- layer_0_add_norm1 -->
<g id="node6" class="node">
<title>layer_0_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="1527.11,-997.17 1174.11,-997.17 1174.11,-929.17 1527.11,-929.17 1527.11,-997.17"/>
<text text-anchor="middle" x="1350.61" y="-981.97" font-family="Times,serif" font-size="14.00">Add+Norm</text>
<text text-anchor="middle" x="1350.61" y="-966.97" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="1350.61" y="-951.97" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="1350.61" y="-936.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;layer_0_add_norm1 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;layer_0_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1302.55,-1403.2C1302.55,-1403.2 1302.55,-1007.18 1302.55,-1007.18"/>
<polygon fill="black" stroke="black" points="1306.05,-1007.18 1302.55,-997.18 1299.05,-1007.18 1306.05,-1007.18"/>
<text text-anchor="middle" x="1367.61" y="-1169.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- output -->
<g id="node2" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="249.61" cy="-48.08" rx="249.72" ry="48.17"/>
<text text-anchor="middle" x="249.61" y="-66.88" font-family="Times,serif" font-size="14.00">Total Output</text>
<text text-anchor="middle" x="249.61" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="249.61" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="249.61" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer_0_attn -->
<g id="node4" class="node">
<title>layer_0_attn</title>
<polygon fill="lightblue" stroke="black" points="1810.11,-1207.17 1415.11,-1207.17 1415.11,-1139.17 1810.11,-1139.17 1810.11,-1207.17"/>
<text text-anchor="middle" x="1612.61" y="-1191.97" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="1612.61" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="1612.61" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="1612.61" y="-1146.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_qkv&#45;&gt;layer_0_attn -->
<g id="edge2" class="edge">
<title>layer_0_qkv&#45;&gt;layer_0_attn</title>
<path fill="none" stroke="black" d="M1594.61,-1261.53C1594.61,-1261.53 1594.61,-1217.52 1594.61,-1217.52"/>
<polygon fill="black" stroke="black" points="1598.11,-1217.52 1594.61,-1207.52 1591.11,-1217.52 1598.11,-1217.52"/>
</g>
<!-- layer_0_proj -->
<g id="node5" class="node">
<title>layer_0_proj</title>
<polygon fill="lightblue" stroke="black" points="1776.11,-1102.17 1393.11,-1102.17 1393.11,-1034.17 1776.11,-1034.17 1776.11,-1102.17"/>
<text text-anchor="middle" x="1584.61" y="-1086.97" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="1584.61" y="-1071.97" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="1584.61" y="-1056.97" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="1584.61" y="-1041.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_attn&#45;&gt;layer_0_proj -->
<g id="edge3" class="edge">
<title>layer_0_attn&#45;&gt;layer_0_proj</title>
<path fill="none" stroke="black" d="M1595.61,-1139.08C1595.61,-1139.08 1595.61,-1112.45 1595.61,-1112.45"/>
<polygon fill="black" stroke="black" points="1599.11,-1112.45 1595.61,-1102.45 1592.11,-1112.45 1599.11,-1112.45"/>
</g>
<!-- layer_0_proj&#45;&gt;layer_0_add_norm1 -->
<g id="edge4" class="edge">
<title>layer_0_proj&#45;&gt;layer_0_add_norm1</title>
<path fill="none" stroke="black" d="M1460.11,-1034.08C1460.11,-1034.08 1460.11,-1007.45 1460.11,-1007.45"/>
<polygon fill="black" stroke="black" points="1463.61,-1007.45 1460.11,-997.45 1456.61,-1007.45 1463.61,-1007.45"/>
</g>
<!-- layer_0_gate -->
<g id="node7" class="node">
<title>layer_0_gate</title>
<polygon fill="yellow" stroke="black" points="1704.17,-892.17 1141.73,-892.17 997.04,-756.17 1559.49,-756.17 1704.17,-892.17"/>
<text text-anchor="middle" x="1350.61" y="-842.97" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="1350.61" y="-827.97" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="1350.61" y="-812.97" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,topk=2]</text>
<text text-anchor="middle" x="1350.61" y="-797.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_gate -->
<g id="edge6" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" d="M1350.61,-929.16C1350.61,-929.16 1350.61,-902.36 1350.61,-902.36"/>
<polygon fill="black" stroke="black" points="1354.11,-902.36 1350.61,-892.36 1347.11,-902.36 1354.11,-902.36"/>
</g>
<!-- layer_0_moe_agg -->
<g id="node8" class="node">
<title>layer_0_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="1501.11,-630.17 1148.11,-630.17 1148.11,-562.17 1501.11,-562.17 1501.11,-630.17"/>
<text text-anchor="middle" x="1324.61" y="-614.97" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="1324.61" y="-599.97" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="1324.61" y="-584.97" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="1324.61" y="-569.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_moe_agg -->
<g id="edge7" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1173.9,-960C1062.22,-960 938.86,-960 938.86,-960 938.86,-960 938.86,-607 938.86,-607 938.86,-607 1138.1,-607 1138.1,-607"/>
<polygon fill="black" stroke="black" points="1138.1,-610.5 1148.1,-607 1138.1,-603.5 1138.1,-610.5"/>
</g>
<!-- layer_0_add_norm2 -->
<g id="node9" class="node">
<title>layer_0_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="672.11,-525.17 319.11,-525.17 319.11,-457.17 672.11,-457.17 672.11,-525.17"/>
<text text-anchor="middle" x="495.61" y="-509.97" font-family="Times,serif" font-size="14.00">Add+Norm</text>
<text text-anchor="middle" x="495.61" y="-494.97" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="495.61" y="-479.97" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="495.61" y="-464.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_add_norm2 -->
<g id="edge57" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_add_norm2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1173.79,-984C965.69,-984 648.11,-984 648.11,-984 648.11,-984 648.11,-535.43 648.11,-535.43"/>
<polygon fill="black" stroke="black" points="651.61,-535.43 648.11,-525.43 644.61,-535.43 651.61,-535.43"/>
<text text-anchor="middle" x="512.61" y="-682.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_0_expert_0 -->
<g id="node31" class="node">
<title>layer_0_expert_0</title>
<polygon fill="lightblue" stroke="black" points="1229.11,-705.17 1150.11,-705.17 1150.11,-667.17 1229.11,-667.17 1229.11,-705.17"/>
<text text-anchor="middle" x="1189.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1189.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_0 -->
<g id="edge24" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_0</title>
<path fill="none" stroke="black" d="M1174.06,-941C1077.49,-941 977.29,-941 977.29,-941 977.29,-941 977.29,-741 977.29,-741 977.29,-741 1176.44,-741 1176.44,-741 1176.44,-741 1176.44,-715.34 1176.44,-715.34"/>
<polygon fill="black" stroke="black" points="1179.94,-715.34 1176.44,-705.34 1172.94,-715.34 1179.94,-715.34"/>
</g>
<!-- layer_0_expert_1 -->
<g id="node32" class="node">
<title>layer_0_expert_1</title>
<polygon fill="lightblue" stroke="black" points="833.11,-705.17 754.11,-705.17 754.11,-667.17 833.11,-667.17 833.11,-705.17"/>
<text text-anchor="middle" x="793.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="793.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_1 -->
<g id="edge25" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_1</title>
<path fill="none" stroke="black" d="M1173.72,-972C1006.31,-972 780.44,-972 780.44,-972 780.44,-972 780.44,-715.36 780.44,-715.36"/>
<polygon fill="black" stroke="black" points="783.94,-715.36 780.44,-705.36 776.94,-715.36 783.94,-715.36"/>
</g>
<!-- layer_0_expert_2 -->
<g id="node33" class="node">
<title>layer_0_expert_2</title>
<polygon fill="lightblue" stroke="black" points="736.11,-705.17 657.11,-705.17 657.11,-667.17 736.11,-667.17 736.11,-705.17"/>
<text text-anchor="middle" x="696.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="696.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_2 -->
<g id="edge26" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_2</title>
<path fill="none" stroke="black" d="M1174.01,-978C976.35,-978 683.44,-978 683.44,-978 683.44,-978 683.44,-715.31 683.44,-715.31"/>
<polygon fill="black" stroke="black" points="686.94,-715.31 683.44,-705.31 679.94,-715.31 686.94,-715.31"/>
</g>
<!-- layer_0_expert_3 -->
<g id="node34" class="node">
<title>layer_0_expert_3</title>
<polygon fill="lightblue" stroke="black" points="1132.11,-705.17 1053.11,-705.17 1053.11,-667.17 1132.11,-667.17 1132.11,-705.17"/>
<text text-anchor="middle" x="1092.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1092.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_3 -->
<g id="edge27" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_3</title>
<path fill="none" stroke="black" d="M1173.86,-947C1073.37,-947 967.4,-947 967.4,-947 967.4,-947 967.4,-734 967.4,-734 967.4,-734 1079.44,-734 1079.44,-734 1079.44,-734 1079.44,-715.35 1079.44,-715.35"/>
<polygon fill="black" stroke="black" points="1082.94,-715.35 1079.44,-705.35 1075.94,-715.35 1082.94,-715.35"/>
</g>
<!-- layer_0_expert_4 -->
<g id="node35" class="node">
<title>layer_0_expert_4</title>
<polygon fill="lightblue" stroke="black" points="2144.11,-705.17 2065.11,-705.17 2065.11,-667.17 2144.11,-667.17 2144.11,-705.17"/>
<text text-anchor="middle" x="2104.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2104.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_4 -->
<g id="edge28" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_4</title>
<path fill="none" stroke="black" d="M1527.13,-989C1752.55,-989 2113.78,-989 2113.78,-989 2113.78,-989 2113.78,-715.57 2113.78,-715.57"/>
<polygon fill="black" stroke="black" points="2117.28,-715.57 2113.78,-705.57 2110.28,-715.57 2117.28,-715.57"/>
</g>
<!-- layer_0_expert_5 -->
<g id="node36" class="node">
<title>layer_0_expert_5</title>
<polygon fill="lightblue" stroke="black" points="930.11,-705.17 851.11,-705.17 851.11,-667.17 930.11,-667.17 930.11,-705.17"/>
<text text-anchor="middle" x="890.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="890.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_5 -->
<g id="edge29" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_5</title>
<path fill="none" stroke="black" d="M1174.08,-966C1039.62,-966 877.44,-966 877.44,-966 877.44,-966 877.44,-715.4 877.44,-715.4"/>
<polygon fill="black" stroke="black" points="880.94,-715.4 877.44,-705.4 873.94,-715.4 880.94,-715.4"/>
</g>
<!-- layer_0_expert_6 -->
<g id="node37" class="node">
<title>layer_0_expert_6</title>
<polygon fill="lightblue" stroke="black" points="639.11,-705.17 560.11,-705.17 560.11,-667.17 639.11,-667.17 639.11,-705.17"/>
<text text-anchor="middle" x="599.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="599.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_6 -->
<g id="edge30" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_6</title>
<path fill="none" stroke="black" d="M1173.85,-990C948.14,-990 586.44,-990 586.44,-990 586.44,-990 586.44,-715.17 586.44,-715.17"/>
<polygon fill="black" stroke="black" points="589.94,-715.17 586.44,-705.17 582.94,-715.17 589.94,-715.17"/>
</g>
<!-- layer_0_expert_7 -->
<g id="node38" class="node">
<title>layer_0_expert_7</title>
<polygon fill="lightblue" stroke="black" points="1634.11,-705.17 1555.11,-705.17 1555.11,-667.17 1634.11,-667.17 1634.11,-705.17"/>
<text text-anchor="middle" x="1594.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1594.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_7 -->
<g id="edge31" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_7</title>
<path fill="none" stroke="black" d="M1527.31,-951C1624.45,-951 1725.42,-951 1725.42,-951 1725.42,-951 1725.42,-712 1725.42,-712 1725.42,-712 1607.78,-712 1607.78,-712 1607.78,-712 1607.78,-711.32 1607.78,-711.32"/>
<polygon fill="black" stroke="black" points="1611.28,-715.21 1607.78,-705.21 1604.28,-715.21 1611.28,-715.21"/>
</g>
<!-- layer_0_expert_8 -->
<g id="node39" class="node">
<title>layer_0_expert_8</title>
<polygon fill="lightblue" stroke="black" points="1537.11,-705.17 1458.11,-705.17 1458.11,-667.17 1537.11,-667.17 1537.11,-705.17"/>
<text text-anchor="middle" x="1497.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="1497.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_8 -->
<g id="edge32" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_8</title>
<path fill="none" stroke="black" d="M1527.2,-944C1621.49,-944 1718.33,-944 1718.33,-944 1718.33,-944 1718.33,-719 1718.33,-719 1718.33,-719 1510.78,-719 1510.78,-719 1510.78,-719 1510.78,-715.27 1510.78,-715.27"/>
<polygon fill="black" stroke="black" points="1514.28,-715.27 1510.78,-705.27 1507.28,-715.27 1514.28,-715.27"/>
</g>
<!-- layer_0_expert_9 -->
<g id="node40" class="node">
<title>layer_0_expert_9</title>
<polygon fill="lightblue" stroke="black" points="1942.11,-705.17 1863.11,-705.17 1863.11,-667.17 1942.11,-667.17 1942.11,-705.17"/>
<text text-anchor="middle" x="1902.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="1902.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_9 -->
<g id="edge33" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_9</title>
<path fill="none" stroke="black" d="M1527.49,-974C1693.28,-974 1915.78,-974 1915.78,-974 1915.78,-974 1915.78,-715.5 1915.78,-715.5"/>
<polygon fill="black" stroke="black" points="1919.28,-715.5 1915.78,-705.5 1912.28,-715.5 1919.28,-715.5"/>
</g>
<!-- layer_0_expert_10 -->
<g id="node41" class="node">
<title>layer_0_expert_10</title>
<polygon fill="lightblue" stroke="black" points="1440.61,-705.17 1352.61,-705.17 1352.61,-667.17 1440.61,-667.17 1440.61,-705.17"/>
<text text-anchor="middle" x="1396.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="1396.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_10 -->
<g id="edge34" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_10</title>
<path fill="none" stroke="black" d="M1527.22,-936C1618.6,-936 1711.23,-936 1711.23,-936 1711.23,-936 1711.23,-727 1711.23,-727 1711.23,-727 1411.28,-727 1411.28,-727 1411.28,-727 1411.28,-715.63 1411.28,-715.63"/>
<polygon fill="black" stroke="black" points="1414.78,-715.63 1411.28,-705.63 1407.78,-715.63 1414.78,-715.63"/>
</g>
<!-- layer_0_expert_11 -->
<g id="node42" class="node">
<title>layer_0_expert_11</title>
<polygon fill="lightblue" stroke="black" points="1334.61,-705.17 1246.61,-705.17 1246.61,-667.17 1334.61,-667.17 1334.61,-705.17"/>
<text text-anchor="middle" x="1290.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="1290.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_11 -->
<g id="edge35" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_11</title>
<path fill="none" stroke="black" d="M1173.95,-935C1081.44,-935 987.18,-935 987.18,-935 987.18,-935 987.18,-748 987.18,-748 987.18,-748 1275.94,-748 1275.94,-748 1275.94,-748 1275.94,-715.39 1275.94,-715.39"/>
<polygon fill="black" stroke="black" points="1279.44,-715.39 1275.94,-705.39 1272.44,-715.39 1279.44,-715.39"/>
</g>
<!-- layer_0_expert_12 -->
<g id="node43" class="node">
<title>layer_0_expert_12</title>
<polygon fill="lightblue" stroke="black" points="1739.61,-705.17 1651.61,-705.17 1651.61,-667.17 1739.61,-667.17 1739.61,-705.17"/>
<text text-anchor="middle" x="1695.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="1695.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_12 -->
<g id="edge36" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_12</title>
<path fill="none" stroke="black" d="M1527.31,-959C1627.29,-959 1732.52,-959 1732.52,-959 1732.52,-959 1732.52,-715.35 1732.52,-715.35"/>
<polygon fill="black" stroke="black" points="1736.02,-715.35 1732.52,-705.35 1729.02,-715.35 1736.02,-715.35"/>
</g>
<!-- layer_0_expert_13 -->
<g id="node44" class="node">
<title>layer_0_expert_13</title>
<polygon fill="lightblue" stroke="black" points="1035.61,-705.17 947.61,-705.17 947.61,-667.17 1035.61,-667.17 1035.61,-705.17"/>
<text text-anchor="middle" x="991.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="991.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_13 -->
<g id="edge37" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_13</title>
<path fill="none" stroke="black" d="M1173.89,-953C1069.47,-953 957.5,-953 957.5,-953 957.5,-953 957.5,-715.36 957.5,-715.36"/>
<polygon fill="black" stroke="black" points="961,-715.36 957.5,-705.36 954,-715.36 961,-715.36"/>
</g>
<!-- layer_0_expert_14 -->
<g id="node45" class="node">
<title>layer_0_expert_14</title>
<polygon fill="lightblue" stroke="black" points="1845.61,-705.17 1757.61,-705.17 1757.61,-667.17 1845.61,-667.17 1845.61,-705.17"/>
<text text-anchor="middle" x="1801.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="1801.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_14 -->
<g id="edge38" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_14</title>
<path fill="none" stroke="black" d="M1527.23,-966C1641.83,-966 1769.94,-966 1769.94,-966 1769.94,-966 1769.94,-715.4 1769.94,-715.4"/>
<polygon fill="black" stroke="black" points="1773.44,-715.4 1769.94,-705.4 1766.44,-715.4 1773.44,-715.4"/>
</g>
<!-- layer_0_expert_15 -->
<g id="node46" class="node">
<title>layer_0_expert_15</title>
<polygon fill="lightblue" stroke="black" points="2047.61,-705.17 1959.61,-705.17 1959.61,-667.17 2047.61,-667.17 2047.61,-705.17"/>
<text text-anchor="middle" x="2003.61" y="-689.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="2003.61" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_add_norm1&#45;&gt;layer_0_expert_15 -->
<g id="edge39" class="edge">
<title>layer_0_add_norm1&#45;&gt;layer_0_expert_15</title>
<path fill="none" stroke="black" d="M1527.34,-982C1725.15,-982 2018.28,-982 2018.28,-982 2018.28,-982 2018.28,-715.58 2018.28,-715.58"/>
<polygon fill="black" stroke="black" points="2021.78,-715.58 2018.28,-705.58 2014.78,-715.58 2021.78,-715.58"/>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_0 -->
<g id="edge8" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1202.78,-755.98C1202.78,-755.98 1202.78,-715.33 1202.78,-715.33"/>
<polygon fill="black" stroke="black" points="1206.28,-715.33 1202.78,-705.33 1199.28,-715.33 1206.28,-715.33"/>
<text text-anchor="middle" x="1228.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_1 -->
<g id="edge9" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1054.03,-810C926.77,-810 806.78,-810 806.78,-810 806.78,-810 806.78,-715.24 806.78,-715.24"/>
<polygon fill="black" stroke="black" points="810.28,-715.24 806.78,-705.24 803.28,-715.24 810.28,-715.24"/>
<text text-anchor="middle" x="830.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_2 -->
<g id="edge10" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1083.01,-837C907.29,-837 709.78,-837 709.78,-837 709.78,-837 709.78,-715.27 709.78,-715.27"/>
<polygon fill="black" stroke="black" points="713.28,-715.27 709.78,-705.27 706.28,-715.27 713.28,-715.27"/>
<text text-anchor="middle" x="743.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_3 -->
<g id="edge11" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1105.78,-755.98C1105.78,-755.98 1105.78,-715.33 1105.78,-715.33"/>
<polygon fill="black" stroke="black" points="1109.28,-715.33 1105.78,-705.33 1102.28,-715.33 1109.28,-715.33"/>
<text text-anchor="middle" x="1091.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_4 -->
<g id="edge12" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1674.4,-864C1872.99,-864 2089.44,-864 2089.44,-864 2089.44,-864 2089.44,-715.2 2089.44,-715.2"/>
<polygon fill="black" stroke="black" points="2092.94,-715.2 2089.44,-705.2 2085.94,-715.2 2092.94,-715.2"/>
<text text-anchor="middle" x="2063.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_5 -->
<g id="edge13" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1025.58,-783C956.43,-783 903.78,-783 903.78,-783 903.78,-783 903.78,-715.3 903.78,-715.3"/>
<polygon fill="black" stroke="black" points="907.28,-715.3 903.78,-705.3 900.28,-715.3 907.28,-715.3"/>
<text text-anchor="middle" x="917.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_6 -->
<g id="edge14" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1111.56,-864C896.06,-864 612.78,-864 612.78,-864 612.78,-864 612.78,-715.2 612.78,-715.2"/>
<polygon fill="black" stroke="black" points="616.28,-715.2 612.78,-705.2 609.28,-715.2 616.28,-715.2"/>
<text text-anchor="middle" x="656.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_7 -->
<g id="edge15" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1581.44,-776.67C1581.44,-776.67 1581.44,-715.32 1581.44,-715.32"/>
<polygon fill="black" stroke="black" points="1584.94,-715.32 1581.44,-705.32 1577.94,-715.32 1584.94,-715.32"/>
<text text-anchor="middle" x="1628.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_8 -->
<g id="edge16" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1484.44,-755.98C1484.44,-755.98 1484.44,-715.33 1484.44,-715.33"/>
<polygon fill="black" stroke="black" points="1487.94,-715.33 1484.44,-705.33 1480.94,-715.33 1487.94,-715.33"/>
<text text-anchor="middle" x="1475.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_9 -->
<g id="edge17" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1616.87,-810C1752.62,-810 1889.44,-810 1889.44,-810 1889.44,-810 1889.44,-715.24 1889.44,-715.24"/>
<polygon fill="black" stroke="black" points="1892.94,-715.24 1889.44,-705.24 1885.94,-715.24 1892.94,-715.24"/>
<text text-anchor="middle" x="1889.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_10 -->
<g id="edge18" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1381.94,-755.98C1381.94,-755.98 1381.94,-715.33 1381.94,-715.33"/>
<polygon fill="black" stroke="black" points="1385.44,-715.33 1381.94,-705.33 1378.44,-715.33 1385.44,-715.33"/>
<text text-anchor="middle" x="1394.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_11 -->
<g id="edge19" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1305.28,-755.98C1305.28,-755.98 1305.28,-715.33 1305.28,-715.33"/>
<polygon fill="black" stroke="black" points="1308.78,-715.33 1305.28,-705.33 1301.78,-715.33 1308.78,-715.33"/>
<text text-anchor="middle" x="1321.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_12 -->
<g id="edge20" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1677.88,-824.07C1677.88,-824.07 1677.88,-715.38 1677.88,-715.38"/>
<polygon fill="black" stroke="black" points="1681.38,-715.38 1677.88,-705.38 1674.38,-715.38 1681.38,-715.38"/>
<text text-anchor="middle" x="1715.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_13 -->
<g id="edge21" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1016.34,-824.07C1016.34,-824.07 1016.34,-715.38 1016.34,-715.38"/>
<polygon fill="black" stroke="black" points="1019.84,-715.38 1016.34,-705.38 1012.84,-715.38 1019.84,-715.38"/>
<text text-anchor="middle" x="1004.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_14 -->
<g id="edge22" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1588.26,-783C1680.22,-783 1763.78,-783 1763.78,-783 1763.78,-783 1763.78,-715.3 1763.78,-715.3"/>
<polygon fill="black" stroke="black" points="1767.28,-715.3 1763.78,-705.3 1760.28,-715.3 1767.28,-715.3"/>
<text text-anchor="middle" x="1802.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_15 -->
<g id="edge23" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1645.48,-837C1812.74,-837 1988.94,-837 1988.94,-837 1988.94,-837 1988.94,-715.27 1988.94,-715.27"/>
<polygon fill="black" stroke="black" points="1992.44,-715.27 1988.94,-705.27 1985.44,-715.27 1992.44,-715.27"/>
<text text-anchor="middle" x="1976.11" y="-726.97" font-family="Times,serif" font-size="14.00">route</text>
</g>
<!-- layer_0_moe_agg&#45;&gt;layer_0_add_norm2 -->
<g id="edge56" class="edge">
<title>layer_0_moe_agg&#45;&gt;layer_0_add_norm2</title>
<path fill="none" stroke="black" d="M1147.74,-569C952.24,-569 664.61,-569 664.61,-569 664.61,-569 664.61,-535.53 664.61,-535.53"/>
<polygon fill="black" stroke="black" points="668.11,-535.53 664.61,-525.53 661.11,-535.53 668.11,-535.53"/>
</g>
<!-- layer_1_qkv -->
<g id="node64" class="node">
<title>layer_1_qkv</title>
<polygon fill="lightblue" stroke="black" points="637.11,-420.17 536.11,-420.17 536.11,-384.17 637.11,-384.17 637.11,-420.17"/>
<text text-anchor="middle" x="586.61" y="-398.47" font-family="Times,serif" font-size="14.00">layer_1_qkv</text>
</g>
<!-- layer_0_add_norm2&#45;&gt;layer_1_qkv -->
<g id="edge58" class="edge">
<title>layer_0_add_norm2&#45;&gt;layer_1_qkv</title>
<path fill="none" stroke="black" d="M586.61,-457.01C586.61,-457.01 586.61,-430.18 586.61,-430.18"/>
<polygon fill="black" stroke="black" points="590.11,-430.18 586.61,-420.18 583.11,-430.18 590.11,-430.18"/>
</g>
<!-- layer_1_add_norm1 -->
<g id="node67" class="node">
<title>layer_1_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="587.11,-185.17 432.11,-185.17 432.11,-149.17 587.11,-149.17 587.11,-185.17"/>
<text text-anchor="middle" x="509.61" y="-163.47" font-family="Times,serif" font-size="14.00">layer_1_add_norm1</text>
</g>
<!-- layer_0_add_norm2&#45;&gt;layer_1_add_norm1 -->
<g id="edge62" class="edge">
<title>layer_0_add_norm2&#45;&gt;layer_1_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M483.86,-457.11C483.86,-457.11 483.86,-195.28 483.86,-195.28"/>
<polygon fill="black" stroke="black" points="487.36,-195.28 483.86,-185.28 480.36,-195.28 487.36,-195.28"/>
<text text-anchor="middle" x="512.61" y="-325.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_7_qkv -->
<g id="node10" class="node">
<title>layer_7_qkv</title>
<polygon fill="lightblue" stroke="black" points="2138.11,-1472.12 1743.11,-1472.12 1743.11,-1404.12 2138.11,-1404.12 2138.11,-1472.12"/>
<text text-anchor="middle" x="1940.61" y="-1456.92" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1940.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="1940.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="1940.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_7_attn -->
<g id="node11" class="node">
<title>layer_7_attn</title>
<polygon fill="lightblue" stroke="black" points="2551.11,-1472.12 2156.11,-1472.12 2156.11,-1404.12 2551.11,-1404.12 2551.11,-1472.12"/>
<text text-anchor="middle" x="2353.61" y="-1456.92" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="2353.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="2353.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="2353.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_7_proj -->
<g id="node12" class="node">
<title>layer_7_proj</title>
<polygon fill="lightblue" stroke="black" points="2952.11,-1472.12 2569.11,-1472.12 2569.11,-1404.12 2952.11,-1404.12 2952.11,-1472.12"/>
<text text-anchor="middle" x="2760.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="2760.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="2760.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="2760.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_7_add_norm1 -->
<g id="node13" class="node">
<title>layer_7_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="3323.11,-1472.12 2970.11,-1472.12 2970.11,-1404.12 3323.11,-1404.12 3323.11,-1472.12"/>
<text text-anchor="middle" x="3146.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Add+Norm</text>
<text text-anchor="middle" x="3146.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="3146.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="3146.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_7_gate -->
<g id="node14" class="node">
<title>layer_7_gate</title>
<polygon fill="yellow" stroke="black" points="4048.17,-1506.12 3485.73,-1506.12 3341.04,-1370.12 3903.49,-1370.12 4048.17,-1506.12"/>
<text text-anchor="middle" x="3694.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="3694.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="3694.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,topk=2]</text>
<text text-anchor="middle" x="3694.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_7_moe_agg -->
<g id="node15" class="node">
<title>layer_7_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="4419.11,-1472.12 4066.11,-1472.12 4066.11,-1404.12 4419.11,-1404.12 4419.11,-1472.12"/>
<text text-anchor="middle" x="4242.61" y="-1456.92" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="4242.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="4242.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="4242.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_7_add_norm2 -->
<g id="node16" class="node">
<title>layer_7_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="4790.11,-1472.12 4437.11,-1472.12 4437.11,-1404.12 4790.11,-1404.12 4790.11,-1472.12"/>
<text text-anchor="middle" x="4613.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Add+Norm</text>
<text text-anchor="middle" x="4613.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="4613.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="4613.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- comm_stage_0_1 -->
<g id="node63" class="node">
<title>comm_stage_0_1</title>
<ellipse fill="lightgray" stroke="black" cx="4613.61" cy="-1295.64" rx="135.11" ry="37.45"/>
<text text-anchor="middle" x="4613.61" y="-1306.94" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="4613.61" y="-1291.94" font-family="Times,serif" font-size="14.00">Stage 0 &#45;&gt; Stage 1</text>
<text text-anchor="middle" x="4613.61" y="-1276.94" font-family="Times,serif" font-size="14.00">GPU: 7 &#45;&gt; 8</text>
</g>
<!-- layer_7_add_norm2&#45;&gt;comm_stage_0_1 -->
<g id="edge64" class="edge">
<title>layer_7_add_norm2&#45;&gt;comm_stage_0_1</title>
<path fill="none" stroke="black" d="M4613.61,-1403.99C4613.61,-1403.99 4613.61,-1343.25 4613.61,-1343.25"/>
<polygon fill="black" stroke="black" points="4617.11,-1343.25 4613.61,-1333.25 4610.11,-1343.25 4617.11,-1343.25"/>
</g>
<!-- layer_8_qkv -->
<g id="node17" class="node">
<title>layer_8_qkv</title>
<polygon fill="lightblue" stroke="black" points="4615.11,-1207.17 4220.11,-1207.17 4220.11,-1139.17 4615.11,-1139.17 4615.11,-1207.17"/>
<text text-anchor="middle" x="4417.61" y="-1191.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="4417.61" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="4417.61" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="4417.61" y="-1146.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_8_attn -->
<g id="node18" class="node">
<title>layer_8_attn</title>
<polygon fill="lightblue" stroke="black" points="5203.11,-1472.12 4808.11,-1472.12 4808.11,-1404.12 5203.11,-1404.12 5203.11,-1472.12"/>
<text text-anchor="middle" x="5005.61" y="-1456.92" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="5005.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="5005.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="5005.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_8_proj -->
<g id="node19" class="node">
<title>layer_8_proj</title>
<polygon fill="lightblue" stroke="black" points="5604.11,-1472.12 5221.11,-1472.12 5221.11,-1404.12 5604.11,-1404.12 5604.11,-1472.12"/>
<text text-anchor="middle" x="5412.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="5412.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="5412.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="5412.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_8_add_norm1 -->
<g id="node20" class="node">
<title>layer_8_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="4986.11,-1207.17 4633.11,-1207.17 4633.11,-1139.17 4986.11,-1139.17 4986.11,-1207.17"/>
<text text-anchor="middle" x="4809.61" y="-1191.97" font-family="Times,serif" font-size="14.00">Add+Norm</text>
<text text-anchor="middle" x="4809.61" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="4809.61" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="4809.61" y="-1146.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_8_gate -->
<g id="node21" class="node">
<title>layer_8_gate</title>
<polygon fill="yellow" stroke="black" points="6329.17,-1506.12 5766.73,-1506.12 5622.04,-1370.12 6184.49,-1370.12 6329.17,-1506.12"/>
<text text-anchor="middle" x="5975.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="5975.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="5975.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,topk=2]</text>
<text text-anchor="middle" x="5975.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_8_moe_agg -->
<g id="node22" class="node">
<title>layer_8_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="6700.11,-1472.12 6347.11,-1472.12 6347.11,-1404.12 6700.11,-1404.12 6700.11,-1472.12"/>
<text text-anchor="middle" x="6523.61" y="-1456.92" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="6523.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="6523.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="6523.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_8_add_norm2 -->
<g id="node23" class="node">
<title>layer_8_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="414.11,-201.17 61.11,-201.17 61.11,-133.17 414.11,-133.17 414.11,-201.17"/>
<text text-anchor="middle" x="237.61" y="-185.97" font-family="Times,serif" font-size="14.00">Add+Norm</text>
<text text-anchor="middle" x="237.61" y="-170.97" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="237.61" y="-155.97" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="237.61" y="-140.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_8_add_norm2&#45;&gt;output -->
<g id="edge67" class="edge">
<title>layer_8_add_norm2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M237.61,-133.04C237.61,-133.04 237.61,-106.41 237.61,-106.41"/>
<polygon fill="black" stroke="black" points="241.11,-106.41 237.61,-96.41 234.11,-106.41 241.11,-106.41"/>
</g>
<!-- layer_15_qkv -->
<g id="node24" class="node">
<title>layer_15_qkv</title>
<polygon fill="lightblue" stroke="black" points="7113.11,-1472.12 6718.11,-1472.12 6718.11,-1404.12 7113.11,-1404.12 7113.11,-1472.12"/>
<text text-anchor="middle" x="6915.61" y="-1456.92" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6915.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="6915.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="6915.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_15_attn -->
<g id="node25" class="node">
<title>layer_15_attn</title>
<polygon fill="lightblue" stroke="black" points="7526.11,-1472.12 7131.11,-1472.12 7131.11,-1404.12 7526.11,-1404.12 7526.11,-1472.12"/>
<text text-anchor="middle" x="7328.61" y="-1456.92" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="7328.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="7328.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="7328.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_15_proj -->
<g id="node26" class="node">
<title>layer_15_proj</title>
<polygon fill="lightblue" stroke="black" points="7927.11,-1472.12 7544.11,-1472.12 7544.11,-1404.12 7927.11,-1404.12 7927.11,-1472.12"/>
<text text-anchor="middle" x="7735.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Projection</text>
<text text-anchor="middle" x="7735.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,heads=32,d_k=128]</text>
<text text-anchor="middle" x="7735.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="7735.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_15_add_norm1 -->
<g id="node27" class="node">
<title>layer_15_add_norm1</title>
<polygon fill="lightblue" stroke="black" points="8298.11,-1472.12 7945.11,-1472.12 7945.11,-1404.12 8298.11,-1404.12 8298.11,-1472.12"/>
<text text-anchor="middle" x="8121.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Add+Norm</text>
<text text-anchor="middle" x="8121.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="8121.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="8121.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_15_gate -->
<g id="node28" class="node">
<title>layer_15_gate</title>
<polygon fill="yellow" stroke="black" points="9023.17,-1506.12 8460.73,-1506.12 8316.04,-1370.12 8878.49,-1370.12 9023.17,-1506.12"/>
<text text-anchor="middle" x="8669.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="8669.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="8669.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,topk=2]</text>
<text text-anchor="middle" x="8669.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_15_moe_agg -->
<g id="node29" class="node">
<title>layer_15_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="9394.11,-1472.12 9041.11,-1472.12 9041.11,-1404.12 9394.11,-1404.12 9394.11,-1472.12"/>
<text text-anchor="middle" x="9217.61" y="-1456.92" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="9217.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="9217.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="9217.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_15_add_norm2 -->
<g id="node30" class="node">
<title>layer_15_add_norm2</title>
<polygon fill="lightblue" stroke="black" points="9765.11,-1472.12 9412.11,-1472.12 9412.11,-1404.12 9765.11,-1404.12 9765.11,-1472.12"/>
<text text-anchor="middle" x="9588.61" y="-1456.92" font-family="Times,serif" font-size="14.00">Add+Norm</text>
<text text-anchor="middle" x="9588.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Input: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="9588.61" y="-1426.92" font-family="Times,serif" font-size="14.00">Output: [batch=128,seq=10000,hidden=4096]</text>
<text text-anchor="middle" x="9588.61" y="-1411.92" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_0_expert_0&#45;&gt;layer_0_moe_agg -->
<g id="edge40" class="edge">
<title>layer_0_expert_0&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1189.61,-667.08C1189.61,-667.08 1189.61,-640.49 1189.61,-640.49"/>
<polygon fill="black" stroke="black" points="1193.11,-640.49 1189.61,-630.49 1186.11,-640.49 1193.11,-640.49"/>
</g>
<!-- layer_0_expert_1&#45;&gt;layer_0_moe_agg -->
<g id="edge41" class="edge">
<title>layer_0_expert_1&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M793.61,-667.11C793.61,-639.59 793.61,-592 793.61,-592 793.61,-592 1137.79,-592 1137.79,-592"/>
<polygon fill="black" stroke="black" points="1137.79,-595.5 1147.79,-592 1137.79,-588.5 1137.79,-595.5"/>
</g>
<!-- layer_0_expert_2&#45;&gt;layer_0_moe_agg -->
<g id="edge42" class="edge">
<title>layer_0_expert_2&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M704.11,-666.95C704.11,-637.35 704.11,-584 704.11,-584 704.11,-584 1138.04,-584 1138.04,-584"/>
<polygon fill="black" stroke="black" points="1138.04,-587.5 1148.04,-584 1138.04,-580.5 1138.04,-587.5"/>
</g>
<!-- layer_0_expert_3&#45;&gt;layer_0_moe_agg -->
<g id="edge43" class="edge">
<title>layer_0_expert_3&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1092.61,-666.91C1092.61,-648.01 1092.61,-622 1092.61,-622 1092.61,-622 1137.88,-622 1137.88,-622"/>
<polygon fill="black" stroke="black" points="1137.88,-625.5 1147.88,-622 1137.88,-618.5 1137.88,-625.5"/>
</g>
<!-- layer_0_expert_4&#45;&gt;layer_0_moe_agg -->
<g id="edge44" class="edge">
<title>layer_0_expert_4&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M2104.61,-667.15C2104.61,-634.44 2104.61,-571 2104.61,-571 2104.61,-571 1511.12,-571 1511.12,-571"/>
<polygon fill="black" stroke="black" points="1511.12,-567.5 1501.12,-571 1511.12,-574.5 1511.12,-567.5"/>
</g>
<!-- layer_0_expert_5&#45;&gt;layer_0_moe_agg -->
<g id="edge45" class="edge">
<title>layer_0_expert_5&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M890.61,-666.82C890.61,-641.14 890.61,-599 890.61,-599 890.61,-599 1138.08,-599 1138.08,-599"/>
<polygon fill="black" stroke="black" points="1138.08,-602.5 1148.08,-599 1138.08,-595.5 1138.08,-602.5"/>
</g>
<!-- layer_0_expert_6&#45;&gt;layer_0_moe_agg -->
<g id="edge46" class="edge">
<title>layer_0_expert_6&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M599.61,-667.15C599.61,-635.87 599.61,-577 599.61,-577 599.61,-577 1137.72,-577 1137.72,-577"/>
<polygon fill="black" stroke="black" points="1137.72,-580.5 1147.72,-577 1137.72,-573.5 1137.72,-580.5"/>
</g>
<!-- layer_0_expert_7&#45;&gt;layer_0_moe_agg -->
<g id="edge47" class="edge">
<title>layer_0_expert_7&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1594.61,-667.03C1594.61,-647.49 1594.61,-620 1594.61,-620 1594.61,-620 1511.31,-620 1511.31,-620"/>
<polygon fill="black" stroke="black" points="1511.31,-616.5 1501.31,-620 1511.31,-623.5 1511.31,-616.5"/>
</g>
<!-- layer_0_expert_8&#45;&gt;layer_0_moe_agg -->
<g id="edge48" class="edge">
<title>layer_0_expert_8&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1479.61,-667.08C1479.61,-667.08 1479.61,-640.49 1479.61,-640.49"/>
<polygon fill="black" stroke="black" points="1483.11,-640.49 1479.61,-630.49 1476.11,-640.49 1483.11,-640.49"/>
</g>
<!-- layer_0_expert_9&#45;&gt;layer_0_moe_agg -->
<g id="edge49" class="edge">
<title>layer_0_expert_9&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1902.61,-666.91C1902.61,-639.1 1902.61,-591 1902.61,-591 1902.61,-591 1511.17,-591 1511.17,-591"/>
<polygon fill="black" stroke="black" points="1511.17,-587.5 1501.17,-591 1511.17,-594.5 1511.17,-587.5"/>
</g>
<!-- layer_0_expert_10&#45;&gt;layer_0_moe_agg -->
<g id="edge50" class="edge">
<title>layer_0_expert_10&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1396.61,-667.08C1396.61,-667.08 1396.61,-640.49 1396.61,-640.49"/>
<polygon fill="black" stroke="black" points="1400.11,-640.49 1396.61,-630.49 1393.11,-640.49 1400.11,-640.49"/>
</g>
<!-- layer_0_expert_11&#45;&gt;layer_0_moe_agg -->
<g id="edge51" class="edge">
<title>layer_0_expert_11&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1290.61,-667.08C1290.61,-667.08 1290.61,-640.49 1290.61,-640.49"/>
<polygon fill="black" stroke="black" points="1294.11,-640.49 1290.61,-630.49 1287.11,-640.49 1294.11,-640.49"/>
</g>
<!-- layer_0_expert_12&#45;&gt;layer_0_moe_agg -->
<g id="edge52" class="edge">
<title>layer_0_expert_12&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1695.61,-666.95C1695.61,-644.38 1695.61,-610 1695.61,-610 1695.61,-610 1511.14,-610 1511.14,-610"/>
<polygon fill="black" stroke="black" points="1511.14,-606.5 1501.14,-610 1511.14,-613.5 1511.14,-606.5"/>
</g>
<!-- layer_0_expert_13&#45;&gt;layer_0_moe_agg -->
<g id="edge53" class="edge">
<title>layer_0_expert_13&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M991.61,-667.1C991.61,-646.01 991.61,-615 991.61,-615 991.61,-615 1137.87,-615 1137.87,-615"/>
<polygon fill="black" stroke="black" points="1137.87,-618.5 1147.87,-615 1137.87,-611.5 1137.87,-618.5"/>
</g>
<!-- layer_0_expert_14&#45;&gt;layer_0_moe_agg -->
<g id="edge54" class="edge">
<title>layer_0_expert_14&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M1801.61,-666.84C1801.61,-641.71 1801.61,-601 1801.61,-601 1801.61,-601 1511.21,-601 1511.21,-601"/>
<polygon fill="black" stroke="black" points="1511.21,-597.5 1501.21,-601 1511.21,-604.5 1511.21,-597.5"/>
</g>
<!-- layer_0_expert_15&#45;&gt;layer_0_moe_agg -->
<g id="edge55" class="edge">
<title>layer_0_expert_15&#45;&gt;layer_0_moe_agg</title>
<path fill="none" stroke="black" d="M2003.61,-666.88C2003.61,-636.52 2003.61,-581 2003.61,-581 2003.61,-581 1511.24,-581 1511.24,-581"/>
<polygon fill="black" stroke="black" points="1511.24,-577.5 1501.24,-581 1511.24,-584.5 1511.24,-577.5"/>
</g>
<!-- layer_8_expert_0 -->
<g id="node47" class="node">
<title>layer_8_expert_0</title>
<polygon fill="lightblue" stroke="black" points="9862.11,-1457.12 9783.11,-1457.12 9783.11,-1419.12 9862.11,-1419.12 9862.11,-1457.12"/>
<text text-anchor="middle" x="9822.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9822.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_8_expert_1 -->
<g id="node48" class="node">
<title>layer_8_expert_1</title>
<polygon fill="lightblue" stroke="black" points="9959.11,-1457.12 9880.11,-1457.12 9880.11,-1419.12 9959.11,-1419.12 9959.11,-1457.12"/>
<text text-anchor="middle" x="9919.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9919.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_8_expert_2 -->
<g id="node49" class="node">
<title>layer_8_expert_2</title>
<polygon fill="lightblue" stroke="black" points="10056.11,-1457.12 9977.11,-1457.12 9977.11,-1419.12 10056.11,-1419.12 10056.11,-1457.12"/>
<text text-anchor="middle" x="10016.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="10016.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_8_expert_3 -->
<g id="node50" class="node">
<title>layer_8_expert_3</title>
<polygon fill="lightblue" stroke="black" points="10153.11,-1457.12 10074.11,-1457.12 10074.11,-1419.12 10153.11,-1419.12 10153.11,-1457.12"/>
<text text-anchor="middle" x="10113.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10113.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_8_expert_4 -->
<g id="node51" class="node">
<title>layer_8_expert_4</title>
<polygon fill="lightblue" stroke="black" points="10250.11,-1457.12 10171.11,-1457.12 10171.11,-1419.12 10250.11,-1419.12 10250.11,-1457.12"/>
<text text-anchor="middle" x="10210.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10210.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_8_expert_5 -->
<g id="node52" class="node">
<title>layer_8_expert_5</title>
<polygon fill="lightblue" stroke="black" points="10347.11,-1457.12 10268.11,-1457.12 10268.11,-1419.12 10347.11,-1419.12 10347.11,-1457.12"/>
<text text-anchor="middle" x="10307.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10307.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_8_expert_6 -->
<g id="node53" class="node">
<title>layer_8_expert_6</title>
<polygon fill="lightblue" stroke="black" points="10444.11,-1457.12 10365.11,-1457.12 10365.11,-1419.12 10444.11,-1419.12 10444.11,-1457.12"/>
<text text-anchor="middle" x="10404.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10404.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_8_expert_7 -->
<g id="node54" class="node">
<title>layer_8_expert_7</title>
<polygon fill="lightblue" stroke="black" points="10541.11,-1457.12 10462.11,-1457.12 10462.11,-1419.12 10541.11,-1419.12 10541.11,-1457.12"/>
<text text-anchor="middle" x="10501.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="10501.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_8_expert_8 -->
<g id="node55" class="node">
<title>layer_8_expert_8</title>
<polygon fill="lightblue" stroke="black" points="10638.11,-1457.12 10559.11,-1457.12 10559.11,-1419.12 10638.11,-1419.12 10638.11,-1457.12"/>
<text text-anchor="middle" x="10598.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="10598.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_8_expert_9 -->
<g id="node56" class="node">
<title>layer_8_expert_9</title>
<polygon fill="lightblue" stroke="black" points="10735.11,-1457.12 10656.11,-1457.12 10656.11,-1419.12 10735.11,-1419.12 10735.11,-1457.12"/>
<text text-anchor="middle" x="10695.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="10695.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_8_expert_10 -->
<g id="node57" class="node">
<title>layer_8_expert_10</title>
<polygon fill="lightblue" stroke="black" points="10840.61,-1457.12 10752.61,-1457.12 10752.61,-1419.12 10840.61,-1419.12 10840.61,-1457.12"/>
<text text-anchor="middle" x="10796.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="10796.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_8_expert_11 -->
<g id="node58" class="node">
<title>layer_8_expert_11</title>
<polygon fill="lightblue" stroke="black" points="10946.61,-1457.12 10858.61,-1457.12 10858.61,-1419.12 10946.61,-1419.12 10946.61,-1457.12"/>
<text text-anchor="middle" x="10902.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="10902.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_8_expert_12 -->
<g id="node59" class="node">
<title>layer_8_expert_12</title>
<polygon fill="lightblue" stroke="black" points="11052.61,-1457.12 10964.61,-1457.12 10964.61,-1419.12 11052.61,-1419.12 11052.61,-1457.12"/>
<text text-anchor="middle" x="11008.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="11008.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_8_expert_13 -->
<g id="node60" class="node">
<title>layer_8_expert_13</title>
<polygon fill="lightblue" stroke="black" points="11158.61,-1457.12 11070.61,-1457.12 11070.61,-1419.12 11158.61,-1419.12 11158.61,-1457.12"/>
<text text-anchor="middle" x="11114.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11114.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_8_expert_14 -->
<g id="node61" class="node">
<title>layer_8_expert_14</title>
<polygon fill="lightblue" stroke="black" points="11264.61,-1457.12 11176.61,-1457.12 11176.61,-1419.12 11264.61,-1419.12 11264.61,-1457.12"/>
<text text-anchor="middle" x="11220.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11220.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_8_expert_15 -->
<g id="node62" class="node">
<title>layer_8_expert_15</title>
<polygon fill="lightblue" stroke="black" points="11370.61,-1457.12 11282.61,-1457.12 11282.61,-1419.12 11370.61,-1419.12 11370.61,-1457.12"/>
<text text-anchor="middle" x="11326.61" y="-1441.92" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="11326.61" y="-1426.92" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- comm_stage_0_1&#45;&gt;layer_8_qkv -->
<g id="edge65" class="edge">
<title>comm_stage_0_1&#45;&gt;layer_8_qkv</title>
<path fill="none" stroke="black" d="M4546.83,-1262.82C4546.83,-1262.82 4546.83,-1217.36 4546.83,-1217.36"/>
<polygon fill="black" stroke="black" points="4550.33,-1217.36 4546.83,-1207.36 4543.33,-1217.36 4550.33,-1217.36"/>
</g>
<!-- comm_stage_0_1&#45;&gt;layer_8_add_norm1 -->
<g id="edge66" class="edge">
<title>comm_stage_0_1&#45;&gt;layer_8_add_norm1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4690.89,-1264.74C4690.89,-1264.74 4690.89,-1217.52 4690.89,-1217.52"/>
<polygon fill="black" stroke="black" points="4694.39,-1217.52 4690.89,-1207.52 4687.39,-1217.52 4694.39,-1217.52"/>
<text text-anchor="middle" x="4838.61" y="-1228.97" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer_1_attn -->
<g id="node65" class="node">
<title>layer_1_attn</title>
<polygon fill="lightblue" stroke="black" points="663.61,-347.17 559.61,-347.17 559.61,-311.17 663.61,-311.17 663.61,-347.17"/>
<text text-anchor="middle" x="611.61" y="-325.47" font-family="Times,serif" font-size="14.00">layer_1_attn</text>
</g>
<!-- layer_1_qkv&#45;&gt;layer_1_attn -->
<g id="edge59" class="edge">
<title>layer_1_qkv&#45;&gt;layer_1_attn</title>
<path fill="none" stroke="black" d="M598.36,-384.12C598.36,-384.12 598.36,-357.26 598.36,-357.26"/>
<polygon fill="black" stroke="black" points="601.86,-357.26 598.36,-347.26 594.86,-357.26 601.86,-357.26"/>
</g>
<!-- layer_1_proj -->
<g id="node66" class="node">
<title>layer_1_proj</title>
<polygon fill="lightblue" stroke="black" points="639.61,-274.17 535.61,-274.17 535.61,-238.17 639.61,-238.17 639.61,-274.17"/>
<text text-anchor="middle" x="587.61" y="-252.47" font-family="Times,serif" font-size="14.00">layer_1_proj</text>
</g>
<!-- layer_1_attn&#45;&gt;layer_1_proj -->
<g id="edge60" class="edge">
<title>layer_1_attn&#45;&gt;layer_1_proj</title>
<path fill="none" stroke="black" d="M599.61,-311.12C599.61,-311.12 599.61,-284.26 599.61,-284.26"/>
<polygon fill="black" stroke="black" points="603.11,-284.26 599.61,-274.26 596.11,-284.26 603.11,-284.26"/>
</g>
<!-- layer_1_proj&#45;&gt;layer_1_add_norm1 -->
<g id="edge61" class="edge">
<title>layer_1_proj&#45;&gt;layer_1_add_norm1</title>
<path fill="none" stroke="black" d="M561.36,-238.16C561.36,-238.16 561.36,-195.46 561.36,-195.46"/>
<polygon fill="black" stroke="black" points="564.86,-195.46 561.36,-185.46 557.86,-195.46 564.86,-195.46"/>
</g>
<!-- layer_1_add_norm1&#45;&gt;output -->
<g id="edge63" class="edge">
<title>layer_1_add_norm1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M465.66,-149.08C465.66,-149.08 465.66,-82.55 465.66,-82.55"/>
<polygon fill="black" stroke="black" points="469.16,-82.55 465.66,-72.55 462.16,-82.55 469.16,-82.55"/>
</g>
</g>
</svg>
