<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_moe_fixed Pages: 1 -->
<svg width="3171pt" height="3826pt"
 viewBox="0.00 0.00 3170.50 3825.92" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3821.92)">
<title>proposed_moe_fixed</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3821.92 3166.5,-3821.92 3166.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<text text-anchor="middle" x="2438.5" y="-3802.72" font-family="Arial" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="2438.5" y="-3787.72" font-family="Arial" font-size="14.00">Batch: 128, Seq: 10000, Dim: 4096</text>
</g>
<!-- global_router -->
<g id="node2" class="node">
<title>global_router</title>
<polygon fill="lightgreen" stroke="black" points="2583.79,-3743.92 2352.67,-3743.92 2293.21,-3667.92 2524.33,-3667.92 2583.79,-3743.92"/>
<text text-anchor="middle" x="2438.5" y="-3709.72" font-family="Arial" font-size="14.00">Global Token Router</text>
<text text-anchor="middle" x="2438.5" y="-3694.72" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;global_router -->
<g id="edge1" class="edge">
<title>input&#45;&gt;global_router</title>
<path fill="none" stroke="black" d="M2438.5,-3779.51C2438.5,-3772.11 2438.5,-3763.21 2438.5,-3754.22"/>
<polygon fill="black" stroke="black" points="2442,-3754.11 2438.5,-3744.11 2435,-3754.11 2442,-3754.11"/>
</g>
<!-- layernorm_0 -->
<g id="node3" class="node">
<title>layernorm_0</title>
<polygon fill="lightblue" stroke="black" points="2490,-3631.92 2387,-3631.92 2387,-3593.92 2490,-3593.92 2490,-3631.92"/>
<text text-anchor="middle" x="2438.5" y="-3616.72" font-family="Arial" font-size="14.00">LayerNorm L0</text>
<text text-anchor="middle" x="2438.5" y="-3601.72" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- global_router&#45;&gt;layernorm_0 -->
<g id="edge2" class="edge">
<title>global_router&#45;&gt;layernorm_0</title>
<path fill="none" stroke="black" d="M2438.5,-3667.91C2438.5,-3659.29 2438.5,-3650.24 2438.5,-3642.08"/>
<polygon fill="black" stroke="black" points="2442,-3641.95 2438.5,-3631.95 2435,-3641.95 2442,-3641.95"/>
</g>
<!-- mha_qkv_0 -->
<g id="node4" class="node">
<title>mha_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="2459.5,-3557.92 2319.5,-3557.92 2319.5,-3519.92 2459.5,-3519.92 2459.5,-3557.92"/>
<text text-anchor="middle" x="2389.5" y="-3542.72" font-family="Arial" font-size="14.00">MHA QKV Linear L0</text>
<text text-anchor="middle" x="2389.5" y="-3527.72" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- layernorm_0&#45;&gt;mha_qkv_0 -->
<g id="edge3" class="edge">
<title>layernorm_0&#45;&gt;mha_qkv_0</title>
<path fill="none" stroke="black" d="M2426.14,-3593.75C2420.55,-3585.54 2413.84,-3575.68 2407.69,-3566.65"/>
<polygon fill="black" stroke="black" points="2410.55,-3564.63 2402.03,-3558.33 2404.76,-3568.57 2410.55,-3564.63"/>
</g>
<!-- attn_res_0 -->
<g id="node7" class="node">
<title>attn_res_0</title>
<polygon fill="lightblue" stroke="black" points="2509,-3335.92 2364,-3335.92 2364,-3297.92 2509,-3297.92 2509,-3335.92"/>
<text text-anchor="middle" x="2436.5" y="-3320.72" font-family="Arial" font-size="14.00">Attention Residual L0</text>
<text text-anchor="middle" x="2436.5" y="-3305.72" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- layernorm_0&#45;&gt;attn_res_0 -->
<g id="edge7" class="edge">
<title>layernorm_0&#45;&gt;attn_res_0</title>
<path fill="none" stroke="black" d="M2451.51,-3593.91C2457.98,-3583.85 2465.12,-3570.78 2468.5,-3557.92 2489.51,-3477.97 2491.89,-3451.5 2469.5,-3371.92 2466.83,-3362.45 2461.99,-3352.99 2456.82,-3344.7"/>
<polygon fill="black" stroke="black" points="2459.63,-3342.6 2451.18,-3336.21 2453.8,-3346.48 2459.63,-3342.6"/>
</g>
<!-- mha_attn_0 -->
<g id="node5" class="node">
<title>mha_attn_0</title>
<polygon fill="lightblue" stroke="black" points="2447.5,-3483.92 2325.5,-3483.92 2325.5,-3445.92 2447.5,-3445.92 2447.5,-3483.92"/>
<text text-anchor="middle" x="2386.5" y="-3468.72" font-family="Arial" font-size="14.00">MHA Attention L0</text>
<text text-anchor="middle" x="2386.5" y="-3453.72" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- mha_qkv_0&#45;&gt;mha_attn_0 -->
<g id="edge4" class="edge">
<title>mha_qkv_0&#45;&gt;mha_attn_0</title>
<path fill="none" stroke="black" d="M2388.74,-3519.75C2388.42,-3512.05 2388.04,-3502.9 2387.68,-3494.34"/>
<polygon fill="black" stroke="black" points="2391.18,-3494.18 2387.27,-3484.33 2384.19,-3494.47 2391.18,-3494.18"/>
</g>
<!-- mha_out_0 -->
<g id="node6" class="node">
<title>mha_out_0</title>
<polygon fill="lightblue" stroke="black" points="2460.5,-3409.92 2308.5,-3409.92 2308.5,-3371.92 2460.5,-3371.92 2460.5,-3409.92"/>
<text text-anchor="middle" x="2384.5" y="-3394.72" font-family="Arial" font-size="14.00">MHA Output Linear L0</text>
<text text-anchor="middle" x="2384.5" y="-3379.72" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- mha_attn_0&#45;&gt;mha_out_0 -->
<g id="edge5" class="edge">
<title>mha_attn_0&#45;&gt;mha_out_0</title>
<path fill="none" stroke="black" d="M2386,-3445.75C2385.78,-3438.05 2385.53,-3428.9 2385.29,-3420.34"/>
<polygon fill="black" stroke="black" points="2388.79,-3420.23 2385.01,-3410.33 2381.79,-3420.43 2388.79,-3420.23"/>
</g>
<!-- mha_out_0&#45;&gt;attn_res_0 -->
<g id="edge6" class="edge">
<title>mha_out_0&#45;&gt;attn_res_0</title>
<path fill="none" stroke="black" d="M2397.62,-3371.75C2403.55,-3363.54 2410.67,-3353.68 2417.19,-3344.65"/>
<polygon fill="black" stroke="black" points="2420.18,-3346.49 2423.2,-3336.33 2414.51,-3342.39 2420.18,-3346.49"/>
</g>
<!-- local_gating_0 -->
<g id="node8" class="node">
<title>local_gating_0</title>
<polygon fill="lightgreen" stroke="black" points="2481.81,-3261.92 2295.2,-3261.92 2247.19,-3185.92 2433.8,-3185.92 2481.81,-3261.92"/>
<text text-anchor="middle" x="2364.5" y="-3227.72" font-family="Arial" font-size="14.00">Layer Gating L0</text>
<text text-anchor="middle" x="2364.5" y="-3212.72" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- attn_res_0&#45;&gt;local_gating_0 -->
<g id="edge8" class="edge">
<title>attn_res_0&#45;&gt;local_gating_0</title>
<path fill="none" stroke="black" d="M2421.93,-3297.51C2415.64,-3289.55 2407.97,-3279.87 2400.32,-3270.19"/>
<polygon fill="black" stroke="black" points="2402.87,-3267.78 2393.92,-3262.11 2397.38,-3272.12 2402.87,-3267.78"/>
</g>
<!-- moe_res_0 -->
<g id="node28" class="node">
<title>moe_res_0</title>
<polygon fill="lightblue" stroke="black" points="2831.5,-2807.44 2711.5,-2807.44 2711.5,-2769.44 2831.5,-2769.44 2831.5,-2807.44"/>
<text text-anchor="middle" x="2771.5" y="-2792.24" font-family="Arial" font-size="14.00">MoE Residual L0</text>
<text text-anchor="middle" x="2771.5" y="-2777.24" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- attn_res_0&#45;&gt;moe_res_0 -->
<g id="edge44" class="edge">
<title>attn_res_0&#45;&gt;moe_res_0</title>
<path fill="none" stroke="black" d="M2509.1,-3312.17C2692.97,-3300.69 3162.5,-3258.25 3162.5,-3124.05 3162.5,-3124.05 3162.5,-3124.05 3162.5,-2943.31 3162.5,-2875.15 2954.18,-2824.52 2841.66,-2802.13"/>
<polygon fill="black" stroke="black" points="2842.22,-2798.68 2831.74,-2800.19 2840.87,-2805.55 2842.22,-2798.68"/>
</g>
<!-- token_route_0 -->
<g id="node9" class="node">
<title>token_route_0</title>
<ellipse fill="lightyellow" stroke="black" cx="1710.5" cy="-3123.05" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1710.5" y="-3126.85" font-family="Arial" font-size="14.00">Token Routing L0</text>
<text text-anchor="middle" x="1710.5" y="-3111.85" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- local_gating_0&#45;&gt;token_route_0 -->
<g id="edge9" class="edge">
<title>local_gating_0&#45;&gt;token_route_0</title>
<path fill="none" stroke="black" d="M2260.51,-3207.2C2132.34,-3187.82 1916.86,-3155.25 1797.2,-3137.16"/>
<polygon fill="black" stroke="black" points="1797.4,-3133.65 1786.99,-3135.61 1796.35,-3140.57 1797.4,-3133.65"/>
</g>
<!-- expert_0_0 -->
<g id="node10" class="node">
<title>expert_0_0</title>
<polygon fill="lightcoral" stroke="black" points="269,-3060.18 96,-3060.18 96,-3007.18 269,-3007.18 269,-3060.18"/>
<text text-anchor="middle" x="182.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 0 L0</text>
<text text-anchor="middle" x="182.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="182.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_0 -->
<g id="edge10" class="edge">
<title>token_route_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="black" d="M1624.51,-3120.81C1359.9,-3116.6 559.33,-3100.88 279.2,-3060.27"/>
<polygon fill="black" stroke="black" points="279.46,-3056.77 269.05,-3058.75 278.43,-3063.69 279.46,-3056.77"/>
</g>
<!-- expert_0_1 -->
<g id="node11" class="node">
<title>expert_0_1</title>
<polygon fill="lightcoral" stroke="black" points="460,-3060.18 287,-3060.18 287,-3007.18 460,-3007.18 460,-3060.18"/>
<text text-anchor="middle" x="373.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 1 L0</text>
<text text-anchor="middle" x="373.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="373.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_1 -->
<g id="edge12" class="edge">
<title>token_route_0&#45;&gt;expert_0_1</title>
<path fill="none" stroke="black" d="M1624.57,-3120.15C1384.88,-3114.46 711.34,-3095.86 470.18,-3060.27"/>
<polygon fill="black" stroke="black" points="470.47,-3056.78 460.06,-3058.73 469.42,-3063.7 470.47,-3056.78"/>
</g>
<!-- expert_0_2 -->
<g id="node12" class="node">
<title>expert_0_2</title>
<polygon fill="lightcoral" stroke="black" points="651,-3060.18 478,-3060.18 478,-3007.18 651,-3007.18 651,-3060.18"/>
<text text-anchor="middle" x="564.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 2 L0</text>
<text text-anchor="middle" x="564.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="564.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_2 -->
<g id="edge14" class="edge">
<title>token_route_0&#45;&gt;expert_0_2</title>
<path fill="none" stroke="black" d="M1624.02,-3122.88C1445.21,-3123.31 1022,-3117.69 661.18,-3060.32"/>
<polygon fill="black" stroke="black" points="661.49,-3056.82 651.06,-3058.69 660.38,-3063.74 661.49,-3056.82"/>
</g>
<!-- expert_0_3 -->
<g id="node13" class="node">
<title>expert_0_3</title>
<polygon fill="lightcoral" stroke="black" points="842,-3060.18 669,-3060.18 669,-3007.18 842,-3007.18 842,-3060.18"/>
<text text-anchor="middle" x="755.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 3 L0</text>
<text text-anchor="middle" x="755.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="755.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_3 -->
<g id="edge16" class="edge">
<title>token_route_0&#45;&gt;expert_0_3</title>
<path fill="none" stroke="black" d="M1624.41,-3121.26C1470.66,-3118.67 1138.85,-3107.73 852.25,-3060.35"/>
<polygon fill="black" stroke="black" points="852.51,-3056.84 842.07,-3058.65 851.36,-3063.75 852.51,-3056.84"/>
</g>
<!-- expert_0_4 -->
<g id="node14" class="node">
<title>expert_0_4</title>
<polygon fill="lightcoral" stroke="black" points="1033,-3060.18 860,-3060.18 860,-3007.18 1033,-3007.18 1033,-3060.18"/>
<text text-anchor="middle" x="946.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 4 L0</text>
<text text-anchor="middle" x="946.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="946.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_4 -->
<g id="edge18" class="edge">
<title>token_route_0&#45;&gt;expert_0_4</title>
<path fill="none" stroke="black" d="M1625.13,-3118.8C1499.35,-3112.99 1256.9,-3097.86 1043.24,-3060.37"/>
<polygon fill="black" stroke="black" points="1043.54,-3056.87 1033.08,-3058.57 1042.32,-3063.77 1043.54,-3056.87"/>
</g>
<!-- expert_0_5 -->
<g id="node15" class="node">
<title>expert_0_5</title>
<polygon fill="lightcoral" stroke="black" points="1224,-3060.18 1051,-3060.18 1051,-3007.18 1224,-3007.18 1224,-3060.18"/>
<text text-anchor="middle" x="1137.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 5 L0</text>
<text text-anchor="middle" x="1137.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1137.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_5 -->
<g id="edge20" class="edge">
<title>token_route_0&#45;&gt;expert_0_5</title>
<path fill="none" stroke="black" d="M1628.34,-3114.78C1534.83,-3105.75 1377.46,-3088.25 1233.98,-3060.38"/>
<polygon fill="black" stroke="black" points="1234.6,-3056.93 1224.11,-3058.44 1233.25,-3063.8 1234.6,-3056.93"/>
</g>
<!-- expert_0_6 -->
<g id="node16" class="node">
<title>expert_0_6</title>
<polygon fill="lightcoral" stroke="black" points="1415,-3060.18 1242,-3060.18 1242,-3007.18 1415,-3007.18 1415,-3060.18"/>
<text text-anchor="middle" x="1328.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 6 L0</text>
<text text-anchor="middle" x="1328.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="1328.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_6 -->
<g id="edge22" class="edge">
<title>token_route_0&#45;&gt;expert_0_6</title>
<path fill="none" stroke="black" d="M1639.51,-3107.78C1583.68,-3096.31 1503.71,-3079.37 1425.23,-3060.56"/>
<polygon fill="black" stroke="black" points="1425.72,-3057.08 1415.18,-3058.14 1424.08,-3063.88 1425.72,-3057.08"/>
</g>
<!-- expert_0_7 -->
<g id="node17" class="node">
<title>expert_0_7</title>
<polygon fill="lightcoral" stroke="black" points="1606,-3060.18 1433,-3060.18 1433,-3007.18 1606,-3007.18 1606,-3060.18"/>
<text text-anchor="middle" x="1519.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 7 L0</text>
<text text-anchor="middle" x="1519.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="1519.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_7 -->
<g id="edge24" class="edge">
<title>token_route_0&#45;&gt;expert_0_7</title>
<path fill="none" stroke="black" d="M1663.29,-3100.45C1639.58,-3089.61 1610.47,-3076.3 1584.67,-3064.49"/>
<polygon fill="black" stroke="black" points="1585.88,-3061.2 1575.33,-3060.22 1582.97,-3067.56 1585.88,-3061.2"/>
</g>
<!-- expert_0_8 -->
<g id="node18" class="node">
<title>expert_0_8</title>
<polygon fill="lightcoral" stroke="black" points="1797,-3060.18 1624,-3060.18 1624,-3007.18 1797,-3007.18 1797,-3060.18"/>
<text text-anchor="middle" x="1710.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 8 L0</text>
<text text-anchor="middle" x="1710.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1710.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_8 -->
<g id="edge26" class="edge">
<title>token_route_0&#45;&gt;expert_0_8</title>
<path fill="none" stroke="black" d="M1710.5,-3095.84C1710.5,-3087.83 1710.5,-3078.89 1710.5,-3070.37"/>
<polygon fill="black" stroke="black" points="1714,-3070.27 1710.5,-3060.27 1707,-3070.27 1714,-3070.27"/>
</g>
<!-- expert_0_9 -->
<g id="node19" class="node">
<title>expert_0_9</title>
<polygon fill="lightcoral" stroke="black" points="1988,-3060.18 1815,-3060.18 1815,-3007.18 1988,-3007.18 1988,-3060.18"/>
<text text-anchor="middle" x="1901.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 9 L0</text>
<text text-anchor="middle" x="1901.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="1901.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_9 -->
<g id="edge28" class="edge">
<title>token_route_0&#45;&gt;expert_0_9</title>
<path fill="none" stroke="black" d="M1757.71,-3100.45C1781.42,-3089.61 1810.53,-3076.3 1836.33,-3064.49"/>
<polygon fill="black" stroke="black" points="1838.03,-3067.56 1845.67,-3060.22 1835.12,-3061.2 1838.03,-3067.56"/>
</g>
<!-- expert_0_10 -->
<g id="node20" class="node">
<title>expert_0_10</title>
<polygon fill="lightcoral" stroke="black" points="2179,-3060.18 2006,-3060.18 2006,-3007.18 2179,-3007.18 2179,-3060.18"/>
<text text-anchor="middle" x="2092.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 10 L0</text>
<text text-anchor="middle" x="2092.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="2092.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_10 -->
<g id="edge30" class="edge">
<title>token_route_0&#45;&gt;expert_0_10</title>
<path fill="none" stroke="black" d="M1781.52,-3107.65C1837.14,-3096.14 1916.68,-3079.21 1995.79,-3060.31"/>
<polygon fill="black" stroke="black" points="1997.03,-3063.61 2005.94,-3057.87 1995.4,-3056.8 1997.03,-3063.61"/>
</g>
<!-- expert_0_11 -->
<g id="node21" class="node">
<title>expert_0_11</title>
<polygon fill="lightcoral" stroke="black" points="2370,-3060.18 2197,-3060.18 2197,-3007.18 2370,-3007.18 2370,-3060.18"/>
<text text-anchor="middle" x="2283.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 11 L0</text>
<text text-anchor="middle" x="2283.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2283.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_11 -->
<g id="edge32" class="edge">
<title>token_route_0&#45;&gt;expert_0_11</title>
<path fill="none" stroke="black" d="M1792.9,-3114.66C1886.26,-3105.55 2043.02,-3088 2186.86,-3060.2"/>
<polygon fill="black" stroke="black" points="2187.61,-3063.62 2196.75,-3058.27 2186.27,-3056.75 2187.61,-3063.62"/>
</g>
<!-- expert_0_12 -->
<g id="node22" class="node">
<title>expert_0_12</title>
<polygon fill="lightcoral" stroke="black" points="2561,-3060.18 2388,-3060.18 2388,-3007.18 2561,-3007.18 2561,-3060.18"/>
<text text-anchor="middle" x="2474.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 12 L0</text>
<text text-anchor="middle" x="2474.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="2474.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_12 -->
<g id="edge34" class="edge">
<title>token_route_0&#45;&gt;expert_0_12</title>
<path fill="none" stroke="black" d="M1795.73,-3118.72C1921.37,-3112.81 2163.62,-3097.54 2377.92,-3060.15"/>
<polygon fill="black" stroke="black" points="2378.54,-3063.6 2387.78,-3058.41 2377.33,-3056.7 2378.54,-3063.6"/>
</g>
<!-- expert_0_13 -->
<g id="node23" class="node">
<title>expert_0_13</title>
<polygon fill="lightcoral" stroke="black" points="2752,-3060.18 2579,-3060.18 2579,-3007.18 2752,-3007.18 2752,-3060.18"/>
<text text-anchor="middle" x="2665.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 13 L0</text>
<text text-anchor="middle" x="2665.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="2665.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_13 -->
<g id="edge36" class="edge">
<title>token_route_0&#45;&gt;expert_0_13</title>
<path fill="none" stroke="black" d="M1796.59,-3121.26C1950.34,-3118.67 2282.15,-3107.73 2568.75,-3060.35"/>
<polygon fill="black" stroke="black" points="2569.64,-3063.75 2578.93,-3058.65 2568.49,-3056.84 2569.64,-3063.75"/>
</g>
<!-- expert_0_14 -->
<g id="node24" class="node">
<title>expert_0_14</title>
<polygon fill="lightcoral" stroke="black" points="2943,-3060.18 2770,-3060.18 2770,-3007.18 2943,-3007.18 2943,-3060.18"/>
<text text-anchor="middle" x="2856.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 14 L0</text>
<text text-anchor="middle" x="2856.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="2856.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_14 -->
<g id="edge38" class="edge">
<title>token_route_0&#45;&gt;expert_0_14</title>
<path fill="none" stroke="black" d="M1796.98,-3122.88C1975.79,-3123.31 2399,-3117.69 2759.82,-3060.32"/>
<polygon fill="black" stroke="black" points="2760.62,-3063.74 2769.94,-3058.69 2759.51,-3056.82 2760.62,-3063.74"/>
</g>
<!-- expert_0_15 -->
<g id="node25" class="node">
<title>expert_0_15</title>
<polygon fill="lightcoral" stroke="black" points="3134,-3060.18 2961,-3060.18 2961,-3007.18 3134,-3007.18 3134,-3060.18"/>
<text text-anchor="middle" x="3047.5" y="-3044.98" font-family="Arial" font-size="14.00">Expert 15 L0</text>
<text text-anchor="middle" x="3047.5" y="-3029.98" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="3047.5" y="-3014.98" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_0&#45;&gt;expert_0_15 -->
<g id="edge40" class="edge">
<title>token_route_0&#45;&gt;expert_0_15</title>
<path fill="none" stroke="black" d="M1796.43,-3120.15C2036.12,-3114.46 2709.66,-3095.86 2950.82,-3060.27"/>
<polygon fill="black" stroke="black" points="2951.58,-3063.7 2960.94,-3058.73 2950.53,-3056.78 2951.58,-3063.7"/>
</g>
<!-- expert_agg_0 -->
<g id="node26" class="node">
<title>expert_agg_0</title>
<ellipse fill="lightyellow" stroke="black" cx="1710.5" cy="-2944.31" rx="106.13" ry="26.74"/>
<text text-anchor="middle" x="1710.5" y="-2948.11" font-family="Arial" font-size="14.00">Expert Aggregation L0</text>
<text text-anchor="middle" x="1710.5" y="-2933.11" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- expert_0_0&#45;&gt;expert_agg_0 -->
<g id="edge11" class="edge">
<title>expert_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M269.05,-3008.61C271.89,-3008.09 274.72,-3007.61 277.5,-3007.18 530.31,-2968.28 1300.21,-2951.97 1594.47,-2947.04"/>
<polygon fill="black" stroke="black" points="1594.8,-2950.54 1604.74,-2946.87 1594.68,-2943.54 1594.8,-2950.54"/>
</g>
<!-- expert_0_1&#45;&gt;expert_agg_0 -->
<g id="edge13" class="edge">
<title>expert_0_1&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M460.06,-3008.63C462.9,-3008.11 465.72,-3007.62 468.5,-3007.18 683.41,-2973.38 1329.67,-2954.45 1594.94,-2947.93"/>
<polygon fill="black" stroke="black" points="1595.07,-2951.43 1604.99,-2947.69 1594.9,-2944.43 1595.07,-2951.43"/>
</g>
<!-- expert_0_2&#45;&gt;expert_agg_0 -->
<g id="edge15" class="edge">
<title>expert_0_2&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M651.06,-3008.67C653.9,-3008.13 656.72,-3007.63 659.5,-3007.18 995.63,-2952.76 1399.11,-2944.78 1593.92,-2944.47"/>
<polygon fill="black" stroke="black" points="1594.18,-2947.97 1604.18,-2944.46 1594.18,-2940.97 1594.18,-2947.97"/>
</g>
<!-- expert_0_3&#45;&gt;expert_agg_0 -->
<g id="edge17" class="edge">
<title>expert_0_3&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M842.07,-3008.71C844.91,-3008.16 847.72,-3007.65 850.5,-3007.18 1114,-2962.75 1428.19,-2950.2 1594.25,-2946.67"/>
<polygon fill="black" stroke="black" points="1594.55,-2950.17 1604.48,-2946.46 1594.41,-2943.17 1594.55,-2950.17"/>
</g>
<!-- expert_0_4&#45;&gt;expert_agg_0 -->
<g id="edge19" class="edge">
<title>expert_0_4&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M1033.08,-3008.79C1035.92,-3008.22 1038.73,-3007.68 1041.5,-3007.18 1234.39,-2972.63 1462.22,-2956.78 1596.07,-2949.97"/>
<polygon fill="black" stroke="black" points="1596.52,-2953.45 1606.33,-2949.46 1596.17,-2946.46 1596.52,-2953.45"/>
</g>
<!-- expert_0_5&#45;&gt;expert_agg_0 -->
<g id="edge21" class="edge">
<title>expert_0_5&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M1224.11,-3008.92C1226.93,-3008.31 1229.74,-3007.73 1232.5,-3007.18 1357.96,-2982.34 1503.99,-2965.11 1601.32,-2955.25"/>
<polygon fill="black" stroke="black" points="1601.86,-2958.71 1611.46,-2954.23 1601.16,-2951.75 1601.86,-2958.71"/>
</g>
<!-- expert_0_6&#45;&gt;expert_agg_0 -->
<g id="edge23" class="edge">
<title>expert_0_6&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M1415.18,-3009.22C1417.98,-3008.53 1420.76,-3007.84 1423.5,-3007.18 1488.7,-2991.41 1562.71,-2975.51 1619.24,-2963.77"/>
<polygon fill="black" stroke="black" points="1620.14,-2967.16 1629.23,-2961.7 1618.72,-2960.3 1620.14,-2967.16"/>
</g>
<!-- expert_0_7&#45;&gt;expert_agg_0 -->
<g id="edge25" class="edge">
<title>expert_0_7&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M1575.26,-3007.17C1599.18,-2996.23 1627.15,-2983.44 1651.43,-2972.33"/>
<polygon fill="black" stroke="black" points="1652.89,-2975.51 1660.53,-2968.17 1649.98,-2969.14 1652.89,-2975.51"/>
</g>
<!-- expert_0_8&#45;&gt;expert_agg_0 -->
<g id="edge27" class="edge">
<title>expert_0_8&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M1710.5,-3006.94C1710.5,-2999 1710.5,-2990.09 1710.5,-2981.58"/>
<polygon fill="black" stroke="black" points="1714,-2981.47 1710.5,-2971.47 1707,-2981.47 1714,-2981.47"/>
</g>
<!-- expert_0_9&#45;&gt;expert_agg_0 -->
<g id="edge29" class="edge">
<title>expert_0_9&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M1845.74,-3007.17C1821.82,-2996.23 1793.85,-2983.44 1769.57,-2972.33"/>
<polygon fill="black" stroke="black" points="1771.02,-2969.14 1760.47,-2968.17 1768.11,-2975.51 1771.02,-2969.14"/>
</g>
<!-- expert_0_10&#45;&gt;expert_agg_0 -->
<g id="edge31" class="edge">
<title>expert_0_10&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M2005.94,-3009.49C2002.76,-3008.7 1999.6,-3007.93 1996.5,-3007.18 1931.5,-2991.53 1857.75,-2975.62 1801.43,-2963.85"/>
<polygon fill="black" stroke="black" points="1801.98,-2960.39 1791.47,-2961.78 1800.55,-2967.25 1801.98,-2960.39"/>
</g>
<!-- expert_0_11&#45;&gt;expert_agg_0 -->
<g id="edge33" class="edge">
<title>expert_0_11&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M2196.75,-3009.1C2193.64,-3008.42 2190.55,-3007.78 2187.5,-3007.18 2062.27,-2982.54 1916.55,-2965.27 1819.44,-2955.35"/>
<polygon fill="black" stroke="black" points="1819.62,-2951.85 1809.31,-2954.32 1818.91,-2958.81 1819.62,-2951.85"/>
</g>
<!-- expert_0_12&#45;&gt;expert_agg_0 -->
<g id="edge35" class="edge">
<title>expert_0_12&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M2387.78,-3008.95C2384.66,-3008.32 2381.56,-3007.72 2378.5,-3007.18 2186,-2972.95 1958.71,-2957.01 1825.04,-2950.09"/>
<polygon fill="black" stroke="black" points="1824.95,-2946.58 1814.78,-2949.57 1824.59,-2953.57 1824.95,-2946.58"/>
</g>
<!-- expert_0_13&#45;&gt;expert_agg_0 -->
<g id="edge37" class="edge">
<title>expert_0_13&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M2578.93,-3008.71C2576.09,-3008.16 2573.28,-3007.65 2570.5,-3007.18 2307,-2962.75 1992.81,-2950.2 1826.75,-2946.67"/>
<polygon fill="black" stroke="black" points="1826.59,-2943.17 1816.52,-2946.46 1826.45,-2950.17 1826.59,-2943.17"/>
</g>
<!-- expert_0_14&#45;&gt;expert_agg_0 -->
<g id="edge39" class="edge">
<title>expert_0_14&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M2769.94,-3008.67C2767.1,-3008.13 2764.28,-3007.63 2761.5,-3007.18 2425.37,-2952.76 2021.89,-2944.78 1827.08,-2944.47"/>
<polygon fill="black" stroke="black" points="1826.82,-2940.97 1816.82,-2944.46 1826.82,-2947.97 1826.82,-2940.97"/>
</g>
<!-- expert_0_15&#45;&gt;expert_agg_0 -->
<g id="edge41" class="edge">
<title>expert_0_15&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M2960.94,-3008.63C2958.1,-3008.11 2955.28,-3007.62 2952.5,-3007.18 2737.59,-2973.38 2091.33,-2954.45 1826.06,-2947.93"/>
<polygon fill="black" stroke="black" points="1826.1,-2944.43 1816.01,-2947.69 1825.93,-2951.43 1826.1,-2944.43"/>
</g>
<!-- moe_combine_0 -->
<g id="node27" class="node">
<title>moe_combine_0</title>
<polygon fill="lightblue" stroke="black" points="2464,-2881.44 2297,-2881.44 2297,-2843.44 2464,-2843.44 2464,-2881.44"/>
<text text-anchor="middle" x="2380.5" y="-2866.24" font-family="Arial" font-size="14.00">MoE Output Combine L0</text>
<text text-anchor="middle" x="2380.5" y="-2851.24" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- expert_agg_0&#45;&gt;moe_combine_0 -->
<g id="edge42" class="edge">
<title>expert_agg_0&#45;&gt;moe_combine_0</title>
<path fill="none" stroke="black" d="M1805.07,-2932.04C1932.91,-2916.8 2159.48,-2889.79 2286.84,-2874.61"/>
<polygon fill="black" stroke="black" points="2287.45,-2878.06 2296.97,-2873.4 2286.62,-2871.11 2287.45,-2878.06"/>
</g>
<!-- moe_combine_0&#45;&gt;moe_res_0 -->
<g id="edge43" class="edge">
<title>moe_combine_0&#45;&gt;moe_res_0</title>
<path fill="none" stroke="black" d="M2464.38,-2845.99C2535.03,-2832.99 2634.92,-2814.59 2701.38,-2802.35"/>
<polygon fill="black" stroke="black" points="2702.14,-2805.77 2711.34,-2800.52 2700.87,-2798.89 2702.14,-2805.77"/>
</g>
<!-- layernorm_1 -->
<g id="node29" class="node">
<title>layernorm_1</title>
<polygon fill="lightblue" stroke="black" points="2823,-2733.44 2720,-2733.44 2720,-2695.44 2823,-2695.44 2823,-2733.44"/>
<text text-anchor="middle" x="2771.5" y="-2718.24" font-family="Arial" font-size="14.00">LayerNorm L1</text>
<text text-anchor="middle" x="2771.5" y="-2703.24" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- moe_res_0&#45;&gt;layernorm_1 -->
<g id="edge45" class="edge">
<title>moe_res_0&#45;&gt;layernorm_1</title>
<path fill="none" stroke="black" d="M2771.5,-2769.27C2771.5,-2761.57 2771.5,-2752.42 2771.5,-2743.86"/>
<polygon fill="black" stroke="black" points="2775,-2743.85 2771.5,-2733.85 2768,-2743.85 2775,-2743.85"/>
</g>
<!-- mha_qkv_1 -->
<g id="node30" class="node">
<title>mha_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="2789.5,-2659.44 2649.5,-2659.44 2649.5,-2621.44 2789.5,-2621.44 2789.5,-2659.44"/>
<text text-anchor="middle" x="2719.5" y="-2644.24" font-family="Arial" font-size="14.00">MHA QKV Linear L1</text>
<text text-anchor="middle" x="2719.5" y="-2629.24" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- layernorm_1&#45;&gt;mha_qkv_1 -->
<g id="edge46" class="edge">
<title>layernorm_1&#45;&gt;mha_qkv_1</title>
<path fill="none" stroke="black" d="M2758.38,-2695.27C2752.45,-2687.06 2745.33,-2677.2 2738.81,-2668.17"/>
<polygon fill="black" stroke="black" points="2741.49,-2665.91 2732.8,-2659.85 2735.82,-2670.01 2741.49,-2665.91"/>
</g>
<!-- attn_res_1 -->
<g id="node33" class="node">
<title>attn_res_1</title>
<polygon fill="lightblue" stroke="black" points="2840,-2437.44 2695,-2437.44 2695,-2399.44 2840,-2399.44 2840,-2437.44"/>
<text text-anchor="middle" x="2767.5" y="-2422.24" font-family="Arial" font-size="14.00">Attention Residual L1</text>
<text text-anchor="middle" x="2767.5" y="-2407.24" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- layernorm_1&#45;&gt;attn_res_1 -->
<g id="edge50" class="edge">
<title>layernorm_1&#45;&gt;attn_res_1</title>
<path fill="none" stroke="black" d="M2783.18,-2695.25C2789,-2685.13 2795.43,-2672.07 2798.5,-2659.44 2818.04,-2579.11 2822.89,-2553.02 2800.5,-2473.44 2797.83,-2463.96 2792.99,-2454.51 2787.82,-2446.22"/>
<polygon fill="black" stroke="black" points="2790.63,-2444.12 2782.18,-2437.73 2784.8,-2448 2790.63,-2444.12"/>
</g>
<!-- mha_attn_1 -->
<g id="node31" class="node">
<title>mha_attn_1</title>
<polygon fill="lightblue" stroke="black" points="2777.5,-2585.44 2655.5,-2585.44 2655.5,-2547.44 2777.5,-2547.44 2777.5,-2585.44"/>
<text text-anchor="middle" x="2716.5" y="-2570.24" font-family="Arial" font-size="14.00">MHA Attention L1</text>
<text text-anchor="middle" x="2716.5" y="-2555.24" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- mha_qkv_1&#45;&gt;mha_attn_1 -->
<g id="edge47" class="edge">
<title>mha_qkv_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M2718.74,-2621.27C2718.42,-2613.57 2718.04,-2604.42 2717.68,-2595.86"/>
<polygon fill="black" stroke="black" points="2721.18,-2595.7 2717.27,-2585.85 2714.19,-2595.99 2721.18,-2595.7"/>
</g>
<!-- mha_out_1 -->
<g id="node32" class="node">
<title>mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="2791.5,-2511.44 2639.5,-2511.44 2639.5,-2473.44 2791.5,-2473.44 2791.5,-2511.44"/>
<text text-anchor="middle" x="2715.5" y="-2496.24" font-family="Arial" font-size="14.00">MHA Output Linear L1</text>
<text text-anchor="middle" x="2715.5" y="-2481.24" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- mha_attn_1&#45;&gt;mha_out_1 -->
<g id="edge48" class="edge">
<title>mha_attn_1&#45;&gt;mha_out_1</title>
<path fill="none" stroke="black" d="M2716.25,-2547.27C2716.14,-2539.57 2716.01,-2530.42 2715.89,-2521.86"/>
<polygon fill="black" stroke="black" points="2719.39,-2521.8 2715.76,-2511.85 2712.4,-2521.9 2719.39,-2521.8"/>
</g>
<!-- mha_out_1&#45;&gt;attn_res_1 -->
<g id="edge49" class="edge">
<title>mha_out_1&#45;&gt;attn_res_1</title>
<path fill="none" stroke="black" d="M2728.62,-2473.27C2734.55,-2465.06 2741.67,-2455.2 2748.19,-2446.17"/>
<polygon fill="black" stroke="black" points="2751.18,-2448.01 2754.2,-2437.85 2745.51,-2443.91 2751.18,-2448.01"/>
</g>
<!-- local_gating_1 -->
<g id="node34" class="node">
<title>local_gating_1</title>
<polygon fill="lightgreen" stroke="black" points="2158.81,-2363.44 1972.2,-2363.44 1924.19,-2287.44 2110.8,-2287.44 2158.81,-2363.44"/>
<text text-anchor="middle" x="2041.5" y="-2329.24" font-family="Arial" font-size="14.00">Layer Gating L1</text>
<text text-anchor="middle" x="2041.5" y="-2314.24" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- attn_res_1&#45;&gt;local_gating_1 -->
<g id="edge51" class="edge">
<title>attn_res_1&#45;&gt;local_gating_1</title>
<path fill="none" stroke="black" d="M2694.9,-2408.34C2567.91,-2392.42 2304.64,-2359.42 2153.93,-2340.53"/>
<polygon fill="black" stroke="black" points="2154.08,-2337.02 2143.72,-2339.25 2153.21,-2343.97 2154.08,-2337.02"/>
</g>
<!-- moe_res_1 -->
<g id="node54" class="node">
<title>moe_res_1</title>
<polygon fill="lightblue" stroke="black" points="2799.5,-1908.96 2679.5,-1908.96 2679.5,-1870.96 2799.5,-1870.96 2799.5,-1908.96"/>
<text text-anchor="middle" x="2739.5" y="-1893.76" font-family="Arial" font-size="14.00">MoE Residual L1</text>
<text text-anchor="middle" x="2739.5" y="-1878.76" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- attn_res_1&#45;&gt;moe_res_1 -->
<g id="edge87" class="edge">
<title>attn_res_1&#45;&gt;moe_res_1</title>
<path fill="none" stroke="black" d="M2840.09,-2411.24C2946.02,-2397.78 3130.5,-2355.66 3130.5,-2225.57 3130.5,-2225.57 3130.5,-2225.57 3130.5,-2044.83 3130.5,-1976.67 2922.18,-1926.04 2809.66,-1903.65"/>
<polygon fill="black" stroke="black" points="2810.22,-1900.2 2799.74,-1901.71 2808.87,-1907.07 2810.22,-1900.2"/>
</g>
<!-- token_route_1 -->
<g id="node35" class="node">
<title>token_route_1</title>
<ellipse fill="lightyellow" stroke="black" cx="1678.5" cy="-2224.57" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1678.5" y="-2228.37" font-family="Arial" font-size="14.00">Token Routing L1</text>
<text text-anchor="middle" x="1678.5" y="-2213.37" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- local_gating_1&#45;&gt;token_route_1 -->
<g id="edge52" class="edge">
<title>local_gating_1&#45;&gt;token_route_1</title>
<path fill="none" stroke="black" d="M1927.64,-2293.43C1870.23,-2277.79 1802.29,-2259.29 1751.87,-2245.56"/>
<polygon fill="black" stroke="black" points="1752.6,-2242.13 1742.03,-2242.87 1750.76,-2248.88 1752.6,-2242.13"/>
</g>
<!-- expert_1_0 -->
<g id="node36" class="node">
<title>expert_1_0</title>
<polygon fill="lightcoral" stroke="black" points="237,-2161.7 64,-2161.7 64,-2108.7 237,-2108.7 237,-2161.7"/>
<text text-anchor="middle" x="150.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 0 L1</text>
<text text-anchor="middle" x="150.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="150.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_0 -->
<g id="edge53" class="edge">
<title>token_route_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" d="M1592.51,-2222.33C1327.9,-2218.12 527.33,-2202.4 247.2,-2161.79"/>
<polygon fill="black" stroke="black" points="247.46,-2158.29 237.05,-2160.27 246.43,-2165.21 247.46,-2158.29"/>
</g>
<!-- expert_1_1 -->
<g id="node37" class="node">
<title>expert_1_1</title>
<polygon fill="lightcoral" stroke="black" points="428,-2161.7 255,-2161.7 255,-2108.7 428,-2108.7 428,-2161.7"/>
<text text-anchor="middle" x="341.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 1 L1</text>
<text text-anchor="middle" x="341.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="341.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_1 -->
<g id="edge55" class="edge">
<title>token_route_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" d="M1592.57,-2221.67C1352.88,-2215.98 679.34,-2197.38 438.18,-2161.79"/>
<polygon fill="black" stroke="black" points="438.47,-2158.29 428.06,-2160.25 437.42,-2165.21 438.47,-2158.29"/>
</g>
<!-- expert_1_2 -->
<g id="node38" class="node">
<title>expert_1_2</title>
<polygon fill="lightcoral" stroke="black" points="619,-2161.7 446,-2161.7 446,-2108.7 619,-2108.7 619,-2161.7"/>
<text text-anchor="middle" x="532.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 2 L1</text>
<text text-anchor="middle" x="532.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="532.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_2 -->
<g id="edge57" class="edge">
<title>token_route_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" d="M1592.02,-2224.4C1413.21,-2224.83 990,-2219.21 629.18,-2161.84"/>
<polygon fill="black" stroke="black" points="629.49,-2158.34 619.06,-2160.21 628.38,-2165.26 629.49,-2158.34"/>
</g>
<!-- expert_1_3 -->
<g id="node39" class="node">
<title>expert_1_3</title>
<polygon fill="lightcoral" stroke="black" points="810,-2161.7 637,-2161.7 637,-2108.7 810,-2108.7 810,-2161.7"/>
<text text-anchor="middle" x="723.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 3 L1</text>
<text text-anchor="middle" x="723.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="723.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_3 -->
<g id="edge59" class="edge">
<title>token_route_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" d="M1592.41,-2222.78C1438.66,-2220.19 1106.85,-2209.25 820.25,-2161.87"/>
<polygon fill="black" stroke="black" points="820.51,-2158.36 810.07,-2160.17 819.36,-2165.27 820.51,-2158.36"/>
</g>
<!-- expert_1_4 -->
<g id="node40" class="node">
<title>expert_1_4</title>
<polygon fill="lightcoral" stroke="black" points="1001,-2161.7 828,-2161.7 828,-2108.7 1001,-2108.7 1001,-2161.7"/>
<text text-anchor="middle" x="914.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 4 L1</text>
<text text-anchor="middle" x="914.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="914.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_4 -->
<g id="edge61" class="edge">
<title>token_route_1&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" d="M1593.13,-2220.32C1467.35,-2214.51 1224.9,-2199.38 1011.24,-2161.89"/>
<polygon fill="black" stroke="black" points="1011.54,-2158.39 1001.08,-2160.09 1010.32,-2165.29 1011.54,-2158.39"/>
</g>
<!-- expert_1_5 -->
<g id="node41" class="node">
<title>expert_1_5</title>
<polygon fill="lightcoral" stroke="black" points="1192,-2161.7 1019,-2161.7 1019,-2108.7 1192,-2108.7 1192,-2161.7"/>
<text text-anchor="middle" x="1105.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 5 L1</text>
<text text-anchor="middle" x="1105.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1105.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_5 -->
<g id="edge63" class="edge">
<title>token_route_1&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" d="M1596.34,-2216.3C1502.83,-2207.27 1345.46,-2189.77 1201.98,-2161.9"/>
<polygon fill="black" stroke="black" points="1202.6,-2158.45 1192.11,-2159.96 1201.25,-2165.32 1202.6,-2158.45"/>
</g>
<!-- expert_1_6 -->
<g id="node42" class="node">
<title>expert_1_6</title>
<polygon fill="lightcoral" stroke="black" points="1383,-2161.7 1210,-2161.7 1210,-2108.7 1383,-2108.7 1383,-2161.7"/>
<text text-anchor="middle" x="1296.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 6 L1</text>
<text text-anchor="middle" x="1296.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="1296.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_6 -->
<g id="edge65" class="edge">
<title>token_route_1&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" d="M1607.51,-2209.29C1551.68,-2197.83 1471.71,-2180.89 1393.23,-2162.08"/>
<polygon fill="black" stroke="black" points="1393.72,-2158.6 1383.18,-2159.66 1392.08,-2165.4 1393.72,-2158.6"/>
</g>
<!-- expert_1_7 -->
<g id="node43" class="node">
<title>expert_1_7</title>
<polygon fill="lightcoral" stroke="black" points="1574,-2161.7 1401,-2161.7 1401,-2108.7 1574,-2108.7 1574,-2161.7"/>
<text text-anchor="middle" x="1487.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 7 L1</text>
<text text-anchor="middle" x="1487.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="1487.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_7 -->
<g id="edge67" class="edge">
<title>token_route_1&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" d="M1631.29,-2201.97C1607.58,-2191.13 1578.47,-2177.82 1552.67,-2166.01"/>
<polygon fill="black" stroke="black" points="1553.88,-2162.72 1543.33,-2161.74 1550.97,-2169.08 1553.88,-2162.72"/>
</g>
<!-- expert_1_8 -->
<g id="node44" class="node">
<title>expert_1_8</title>
<polygon fill="lightcoral" stroke="black" points="1765,-2161.7 1592,-2161.7 1592,-2108.7 1765,-2108.7 1765,-2161.7"/>
<text text-anchor="middle" x="1678.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 8 L1</text>
<text text-anchor="middle" x="1678.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1678.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_8 -->
<g id="edge69" class="edge">
<title>token_route_1&#45;&gt;expert_1_8</title>
<path fill="none" stroke="black" d="M1678.5,-2197.36C1678.5,-2189.35 1678.5,-2180.41 1678.5,-2171.89"/>
<polygon fill="black" stroke="black" points="1682,-2171.79 1678.5,-2161.79 1675,-2171.79 1682,-2171.79"/>
</g>
<!-- expert_1_9 -->
<g id="node45" class="node">
<title>expert_1_9</title>
<polygon fill="lightcoral" stroke="black" points="1956,-2161.7 1783,-2161.7 1783,-2108.7 1956,-2108.7 1956,-2161.7"/>
<text text-anchor="middle" x="1869.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 9 L1</text>
<text text-anchor="middle" x="1869.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="1869.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_9 -->
<g id="edge71" class="edge">
<title>token_route_1&#45;&gt;expert_1_9</title>
<path fill="none" stroke="black" d="M1725.71,-2201.97C1749.42,-2191.13 1778.53,-2177.82 1804.33,-2166.01"/>
<polygon fill="black" stroke="black" points="1806.03,-2169.08 1813.67,-2161.74 1803.12,-2162.72 1806.03,-2169.08"/>
</g>
<!-- expert_1_10 -->
<g id="node46" class="node">
<title>expert_1_10</title>
<polygon fill="lightcoral" stroke="black" points="2147,-2161.7 1974,-2161.7 1974,-2108.7 2147,-2108.7 2147,-2161.7"/>
<text text-anchor="middle" x="2060.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 10 L1</text>
<text text-anchor="middle" x="2060.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="2060.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_10 -->
<g id="edge73" class="edge">
<title>token_route_1&#45;&gt;expert_1_10</title>
<path fill="none" stroke="black" d="M1749.52,-2209.17C1805.14,-2197.66 1884.68,-2180.73 1963.79,-2161.83"/>
<polygon fill="black" stroke="black" points="1965.03,-2165.13 1973.94,-2159.39 1963.4,-2158.32 1965.03,-2165.13"/>
</g>
<!-- expert_1_11 -->
<g id="node47" class="node">
<title>expert_1_11</title>
<polygon fill="lightcoral" stroke="black" points="2338,-2161.7 2165,-2161.7 2165,-2108.7 2338,-2108.7 2338,-2161.7"/>
<text text-anchor="middle" x="2251.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 11 L1</text>
<text text-anchor="middle" x="2251.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2251.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_11 -->
<g id="edge75" class="edge">
<title>token_route_1&#45;&gt;expert_1_11</title>
<path fill="none" stroke="black" d="M1760.9,-2216.18C1854.26,-2207.07 2011.02,-2189.52 2154.86,-2161.72"/>
<polygon fill="black" stroke="black" points="2155.61,-2165.14 2164.75,-2159.79 2154.27,-2158.27 2155.61,-2165.14"/>
</g>
<!-- expert_1_12 -->
<g id="node48" class="node">
<title>expert_1_12</title>
<polygon fill="lightcoral" stroke="black" points="2529,-2161.7 2356,-2161.7 2356,-2108.7 2529,-2108.7 2529,-2161.7"/>
<text text-anchor="middle" x="2442.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 12 L1</text>
<text text-anchor="middle" x="2442.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="2442.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_12 -->
<g id="edge77" class="edge">
<title>token_route_1&#45;&gt;expert_1_12</title>
<path fill="none" stroke="black" d="M1763.73,-2220.24C1889.37,-2214.33 2131.62,-2199.06 2345.92,-2161.67"/>
<polygon fill="black" stroke="black" points="2346.54,-2165.12 2355.78,-2159.93 2345.33,-2158.22 2346.54,-2165.12"/>
</g>
<!-- expert_1_13 -->
<g id="node49" class="node">
<title>expert_1_13</title>
<polygon fill="lightcoral" stroke="black" points="2720,-2161.7 2547,-2161.7 2547,-2108.7 2720,-2108.7 2720,-2161.7"/>
<text text-anchor="middle" x="2633.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 13 L1</text>
<text text-anchor="middle" x="2633.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="2633.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_13 -->
<g id="edge79" class="edge">
<title>token_route_1&#45;&gt;expert_1_13</title>
<path fill="none" stroke="black" d="M1764.59,-2222.78C1918.34,-2220.19 2250.15,-2209.25 2536.75,-2161.87"/>
<polygon fill="black" stroke="black" points="2537.64,-2165.27 2546.93,-2160.17 2536.49,-2158.36 2537.64,-2165.27"/>
</g>
<!-- expert_1_14 -->
<g id="node50" class="node">
<title>expert_1_14</title>
<polygon fill="lightcoral" stroke="black" points="2911,-2161.7 2738,-2161.7 2738,-2108.7 2911,-2108.7 2911,-2161.7"/>
<text text-anchor="middle" x="2824.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 14 L1</text>
<text text-anchor="middle" x="2824.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="2824.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_14 -->
<g id="edge81" class="edge">
<title>token_route_1&#45;&gt;expert_1_14</title>
<path fill="none" stroke="black" d="M1764.98,-2224.4C1943.79,-2224.83 2367,-2219.21 2727.82,-2161.84"/>
<polygon fill="black" stroke="black" points="2728.62,-2165.26 2737.94,-2160.21 2727.51,-2158.34 2728.62,-2165.26"/>
</g>
<!-- expert_1_15 -->
<g id="node51" class="node">
<title>expert_1_15</title>
<polygon fill="lightcoral" stroke="black" points="3102,-2161.7 2929,-2161.7 2929,-2108.7 3102,-2108.7 3102,-2161.7"/>
<text text-anchor="middle" x="3015.5" y="-2146.5" font-family="Arial" font-size="14.00">Expert 15 L1</text>
<text text-anchor="middle" x="3015.5" y="-2131.5" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="3015.5" y="-2116.5" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_1&#45;&gt;expert_1_15 -->
<g id="edge83" class="edge">
<title>token_route_1&#45;&gt;expert_1_15</title>
<path fill="none" stroke="black" d="M1764.43,-2221.67C2004.12,-2215.98 2677.66,-2197.38 2918.82,-2161.79"/>
<polygon fill="black" stroke="black" points="2919.58,-2165.21 2928.94,-2160.25 2918.53,-2158.29 2919.58,-2165.21"/>
</g>
<!-- expert_agg_1 -->
<g id="node52" class="node">
<title>expert_agg_1</title>
<ellipse fill="lightyellow" stroke="black" cx="1678.5" cy="-2045.83" rx="106.13" ry="26.74"/>
<text text-anchor="middle" x="1678.5" y="-2049.63" font-family="Arial" font-size="14.00">Expert Aggregation L1</text>
<text text-anchor="middle" x="1678.5" y="-2034.63" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- expert_1_0&#45;&gt;expert_agg_1 -->
<g id="edge54" class="edge">
<title>expert_1_0&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M237.05,-2110.13C239.89,-2109.61 242.72,-2109.13 245.5,-2108.7 498.31,-2069.79 1268.21,-2053.49 1562.47,-2048.56"/>
<polygon fill="black" stroke="black" points="1562.8,-2052.06 1572.74,-2048.39 1562.68,-2045.06 1562.8,-2052.06"/>
</g>
<!-- expert_1_1&#45;&gt;expert_agg_1 -->
<g id="edge56" class="edge">
<title>expert_1_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M428.06,-2110.15C430.9,-2109.63 433.72,-2109.14 436.5,-2108.7 651.41,-2074.9 1297.67,-2055.97 1562.94,-2049.45"/>
<polygon fill="black" stroke="black" points="1563.07,-2052.95 1572.99,-2049.21 1562.9,-2045.95 1563.07,-2052.95"/>
</g>
<!-- expert_1_2&#45;&gt;expert_agg_1 -->
<g id="edge58" class="edge">
<title>expert_1_2&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M619.06,-2110.19C621.9,-2109.65 624.72,-2109.15 627.5,-2108.7 963.63,-2054.28 1367.11,-2046.3 1561.92,-2045.99"/>
<polygon fill="black" stroke="black" points="1562.18,-2049.49 1572.18,-2045.98 1562.18,-2042.49 1562.18,-2049.49"/>
</g>
<!-- expert_1_3&#45;&gt;expert_agg_1 -->
<g id="edge60" class="edge">
<title>expert_1_3&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M810.07,-2110.23C812.91,-2109.68 815.72,-2109.17 818.5,-2108.7 1082,-2064.27 1396.19,-2051.72 1562.25,-2048.19"/>
<polygon fill="black" stroke="black" points="1562.55,-2051.69 1572.48,-2047.98 1562.41,-2044.69 1562.55,-2051.69"/>
</g>
<!-- expert_1_4&#45;&gt;expert_agg_1 -->
<g id="edge62" class="edge">
<title>expert_1_4&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1001.08,-2110.31C1003.92,-2109.74 1006.73,-2109.2 1009.5,-2108.7 1202.39,-2074.15 1430.22,-2058.3 1564.07,-2051.49"/>
<polygon fill="black" stroke="black" points="1564.52,-2054.97 1574.33,-2050.98 1564.17,-2047.98 1564.52,-2054.97"/>
</g>
<!-- expert_1_5&#45;&gt;expert_agg_1 -->
<g id="edge64" class="edge">
<title>expert_1_5&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1192.11,-2110.44C1194.93,-2109.83 1197.74,-2109.25 1200.5,-2108.7 1325.96,-2083.86 1471.99,-2066.63 1569.32,-2056.77"/>
<polygon fill="black" stroke="black" points="1569.86,-2060.23 1579.46,-2055.75 1569.16,-2053.27 1569.86,-2060.23"/>
</g>
<!-- expert_1_6&#45;&gt;expert_agg_1 -->
<g id="edge66" class="edge">
<title>expert_1_6&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1383.18,-2110.74C1385.98,-2110.05 1388.76,-2109.36 1391.5,-2108.7 1456.7,-2092.93 1530.71,-2077.03 1587.24,-2065.29"/>
<polygon fill="black" stroke="black" points="1588.14,-2068.68 1597.23,-2063.22 1586.72,-2061.82 1588.14,-2068.68"/>
</g>
<!-- expert_1_7&#45;&gt;expert_agg_1 -->
<g id="edge68" class="edge">
<title>expert_1_7&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1543.26,-2108.69C1567.18,-2097.75 1595.15,-2084.96 1619.43,-2073.85"/>
<polygon fill="black" stroke="black" points="1620.89,-2077.03 1628.53,-2069.69 1617.98,-2070.66 1620.89,-2077.03"/>
</g>
<!-- expert_1_8&#45;&gt;expert_agg_1 -->
<g id="edge70" class="edge">
<title>expert_1_8&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1678.5,-2108.46C1678.5,-2100.51 1678.5,-2091.61 1678.5,-2083.1"/>
<polygon fill="black" stroke="black" points="1682,-2082.99 1678.5,-2072.99 1675,-2082.99 1682,-2082.99"/>
</g>
<!-- expert_1_9&#45;&gt;expert_agg_1 -->
<g id="edge72" class="edge">
<title>expert_1_9&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1813.74,-2108.69C1789.82,-2097.75 1761.85,-2084.96 1737.57,-2073.85"/>
<polygon fill="black" stroke="black" points="1739.02,-2070.66 1728.47,-2069.69 1736.11,-2077.03 1739.02,-2070.66"/>
</g>
<!-- expert_1_10&#45;&gt;expert_agg_1 -->
<g id="edge74" class="edge">
<title>expert_1_10&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1973.94,-2111.01C1970.76,-2110.22 1967.6,-2109.45 1964.5,-2108.7 1899.5,-2093.05 1825.75,-2077.14 1769.43,-2065.37"/>
<polygon fill="black" stroke="black" points="1769.98,-2061.91 1759.47,-2063.3 1768.55,-2068.76 1769.98,-2061.91"/>
</g>
<!-- expert_1_11&#45;&gt;expert_agg_1 -->
<g id="edge76" class="edge">
<title>expert_1_11&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2164.75,-2110.62C2161.64,-2109.94 2158.55,-2109.3 2155.5,-2108.7 2030.27,-2084.06 1884.55,-2066.79 1787.44,-2056.87"/>
<polygon fill="black" stroke="black" points="1787.62,-2053.37 1777.31,-2055.84 1786.91,-2060.33 1787.62,-2053.37"/>
</g>
<!-- expert_1_12&#45;&gt;expert_agg_1 -->
<g id="edge78" class="edge">
<title>expert_1_12&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2355.78,-2110.47C2352.66,-2109.84 2349.56,-2109.24 2346.5,-2108.7 2154,-2074.47 1926.71,-2058.53 1793.04,-2051.61"/>
<polygon fill="black" stroke="black" points="1792.95,-2048.1 1782.78,-2051.09 1792.59,-2055.09 1792.95,-2048.1"/>
</g>
<!-- expert_1_13&#45;&gt;expert_agg_1 -->
<g id="edge80" class="edge">
<title>expert_1_13&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2546.93,-2110.23C2544.09,-2109.68 2541.28,-2109.17 2538.5,-2108.7 2275,-2064.27 1960.81,-2051.72 1794.75,-2048.19"/>
<polygon fill="black" stroke="black" points="1794.59,-2044.69 1784.52,-2047.98 1794.45,-2051.69 1794.59,-2044.69"/>
</g>
<!-- expert_1_14&#45;&gt;expert_agg_1 -->
<g id="edge82" class="edge">
<title>expert_1_14&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2737.94,-2110.19C2735.1,-2109.65 2732.28,-2109.15 2729.5,-2108.7 2393.37,-2054.28 1989.89,-2046.3 1795.08,-2045.99"/>
<polygon fill="black" stroke="black" points="1794.82,-2042.49 1784.82,-2045.98 1794.82,-2049.49 1794.82,-2042.49"/>
</g>
<!-- expert_1_15&#45;&gt;expert_agg_1 -->
<g id="edge84" class="edge">
<title>expert_1_15&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2928.94,-2110.15C2926.1,-2109.63 2923.28,-2109.14 2920.5,-2108.7 2705.59,-2074.9 2059.33,-2055.97 1794.06,-2049.45"/>
<polygon fill="black" stroke="black" points="1794.1,-2045.95 1784.01,-2049.21 1793.93,-2052.95 1794.1,-2045.95"/>
</g>
<!-- moe_combine_1 -->
<g id="node53" class="node">
<title>moe_combine_1</title>
<polygon fill="lightblue" stroke="black" points="2432,-1982.96 2265,-1982.96 2265,-1944.96 2432,-1944.96 2432,-1982.96"/>
<text text-anchor="middle" x="2348.5" y="-1967.76" font-family="Arial" font-size="14.00">MoE Output Combine L1</text>
<text text-anchor="middle" x="2348.5" y="-1952.76" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- expert_agg_1&#45;&gt;moe_combine_1 -->
<g id="edge85" class="edge">
<title>expert_agg_1&#45;&gt;moe_combine_1</title>
<path fill="none" stroke="black" d="M1773.07,-2033.56C1900.91,-2018.32 2127.48,-1991.31 2254.84,-1976.13"/>
<polygon fill="black" stroke="black" points="2255.45,-1979.58 2264.97,-1974.92 2254.62,-1972.63 2255.45,-1979.58"/>
</g>
<!-- moe_combine_1&#45;&gt;moe_res_1 -->
<g id="edge86" class="edge">
<title>moe_combine_1&#45;&gt;moe_res_1</title>
<path fill="none" stroke="black" d="M2432.38,-1947.51C2503.03,-1934.51 2602.92,-1916.11 2669.38,-1903.87"/>
<polygon fill="black" stroke="black" points="2670.14,-1907.29 2679.34,-1902.04 2668.87,-1900.41 2670.14,-1907.29"/>
</g>
<!-- layernorm_2 -->
<g id="node55" class="node">
<title>layernorm_2</title>
<polygon fill="lightblue" stroke="black" points="2791,-1834.96 2688,-1834.96 2688,-1796.96 2791,-1796.96 2791,-1834.96"/>
<text text-anchor="middle" x="2739.5" y="-1819.76" font-family="Arial" font-size="14.00">LayerNorm L2</text>
<text text-anchor="middle" x="2739.5" y="-1804.76" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- moe_res_1&#45;&gt;layernorm_2 -->
<g id="edge88" class="edge">
<title>moe_res_1&#45;&gt;layernorm_2</title>
<path fill="none" stroke="black" d="M2739.5,-1870.79C2739.5,-1863.09 2739.5,-1853.93 2739.5,-1845.38"/>
<polygon fill="black" stroke="black" points="2743,-1845.37 2739.5,-1835.37 2736,-1845.37 2743,-1845.37"/>
</g>
<!-- mha_qkv_2 -->
<g id="node56" class="node">
<title>mha_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="2757.5,-1760.96 2617.5,-1760.96 2617.5,-1722.96 2757.5,-1722.96 2757.5,-1760.96"/>
<text text-anchor="middle" x="2687.5" y="-1745.76" font-family="Arial" font-size="14.00">MHA QKV Linear L2</text>
<text text-anchor="middle" x="2687.5" y="-1730.76" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- layernorm_2&#45;&gt;mha_qkv_2 -->
<g id="edge89" class="edge">
<title>layernorm_2&#45;&gt;mha_qkv_2</title>
<path fill="none" stroke="black" d="M2726.38,-1796.79C2720.45,-1788.58 2713.33,-1778.72 2706.81,-1769.69"/>
<polygon fill="black" stroke="black" points="2709.49,-1767.43 2700.8,-1761.37 2703.82,-1771.53 2709.49,-1767.43"/>
</g>
<!-- attn_res_2 -->
<g id="node59" class="node">
<title>attn_res_2</title>
<polygon fill="lightblue" stroke="black" points="2808,-1538.96 2663,-1538.96 2663,-1500.96 2808,-1500.96 2808,-1538.96"/>
<text text-anchor="middle" x="2735.5" y="-1523.76" font-family="Arial" font-size="14.00">Attention Residual L2</text>
<text text-anchor="middle" x="2735.5" y="-1508.76" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- layernorm_2&#45;&gt;attn_res_2 -->
<g id="edge93" class="edge">
<title>layernorm_2&#45;&gt;attn_res_2</title>
<path fill="none" stroke="black" d="M2751.18,-1796.77C2757,-1786.65 2763.43,-1773.59 2766.5,-1760.96 2786.04,-1680.63 2790.89,-1654.54 2768.5,-1574.96 2765.83,-1565.48 2760.99,-1556.03 2755.82,-1547.74"/>
<polygon fill="black" stroke="black" points="2758.63,-1545.64 2750.18,-1539.25 2752.8,-1549.52 2758.63,-1545.64"/>
</g>
<!-- mha_attn_2 -->
<g id="node57" class="node">
<title>mha_attn_2</title>
<polygon fill="lightblue" stroke="black" points="2745.5,-1686.96 2623.5,-1686.96 2623.5,-1648.96 2745.5,-1648.96 2745.5,-1686.96"/>
<text text-anchor="middle" x="2684.5" y="-1671.76" font-family="Arial" font-size="14.00">MHA Attention L2</text>
<text text-anchor="middle" x="2684.5" y="-1656.76" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- mha_qkv_2&#45;&gt;mha_attn_2 -->
<g id="edge90" class="edge">
<title>mha_qkv_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M2686.74,-1722.79C2686.42,-1715.09 2686.04,-1705.93 2685.68,-1697.38"/>
<polygon fill="black" stroke="black" points="2689.18,-1697.22 2685.27,-1687.37 2682.19,-1697.51 2689.18,-1697.22"/>
</g>
<!-- mha_out_2 -->
<g id="node58" class="node">
<title>mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="2759.5,-1612.96 2607.5,-1612.96 2607.5,-1574.96 2759.5,-1574.96 2759.5,-1612.96"/>
<text text-anchor="middle" x="2683.5" y="-1597.76" font-family="Arial" font-size="14.00">MHA Output Linear L2</text>
<text text-anchor="middle" x="2683.5" y="-1582.76" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- mha_attn_2&#45;&gt;mha_out_2 -->
<g id="edge91" class="edge">
<title>mha_attn_2&#45;&gt;mha_out_2</title>
<path fill="none" stroke="black" d="M2684.25,-1648.79C2684.14,-1641.09 2684.01,-1631.93 2683.89,-1623.38"/>
<polygon fill="black" stroke="black" points="2687.39,-1623.32 2683.76,-1613.37 2680.4,-1623.42 2687.39,-1623.32"/>
</g>
<!-- mha_out_2&#45;&gt;attn_res_2 -->
<g id="edge92" class="edge">
<title>mha_out_2&#45;&gt;attn_res_2</title>
<path fill="none" stroke="black" d="M2696.62,-1574.79C2702.55,-1566.58 2709.67,-1556.72 2716.19,-1547.69"/>
<polygon fill="black" stroke="black" points="2719.18,-1549.53 2722.2,-1539.37 2713.51,-1545.43 2719.18,-1549.53"/>
</g>
<!-- local_gating_2 -->
<g id="node60" class="node">
<title>local_gating_2</title>
<polygon fill="lightgreen" stroke="black" points="2126.81,-1464.96 1940.2,-1464.96 1892.19,-1388.96 2078.8,-1388.96 2126.81,-1464.96"/>
<text text-anchor="middle" x="2009.5" y="-1430.76" font-family="Arial" font-size="14.00">Layer Gating L2</text>
<text text-anchor="middle" x="2009.5" y="-1415.76" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- attn_res_2&#45;&gt;local_gating_2 -->
<g id="edge94" class="edge">
<title>attn_res_2&#45;&gt;local_gating_2</title>
<path fill="none" stroke="black" d="M2662.9,-1509.86C2535.91,-1493.94 2272.64,-1460.94 2121.93,-1442.05"/>
<polygon fill="black" stroke="black" points="2122.08,-1438.54 2111.72,-1440.77 2121.21,-1445.49 2122.08,-1438.54"/>
</g>
<!-- moe_res_2 -->
<g id="node80" class="node">
<title>moe_res_2</title>
<polygon fill="lightblue" stroke="black" points="2767.5,-1010.48 2647.5,-1010.48 2647.5,-972.48 2767.5,-972.48 2767.5,-1010.48"/>
<text text-anchor="middle" x="2707.5" y="-995.28" font-family="Arial" font-size="14.00">MoE Residual L2</text>
<text text-anchor="middle" x="2707.5" y="-980.28" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- attn_res_2&#45;&gt;moe_res_2 -->
<g id="edge130" class="edge">
<title>attn_res_2&#45;&gt;moe_res_2</title>
<path fill="none" stroke="black" d="M2808.09,-1512.76C2914.02,-1499.3 3098.5,-1457.18 3098.5,-1327.09 3098.5,-1327.09 3098.5,-1327.09 3098.5,-1146.35 3098.5,-1078.19 2890.18,-1027.56 2777.66,-1005.17"/>
<polygon fill="black" stroke="black" points="2778.22,-1001.72 2767.74,-1003.23 2776.87,-1008.59 2778.22,-1001.72"/>
</g>
<!-- token_route_2 -->
<g id="node61" class="node">
<title>token_route_2</title>
<ellipse fill="lightyellow" stroke="black" cx="1646.5" cy="-1326.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1646.5" y="-1329.89" font-family="Arial" font-size="14.00">Token Routing L2</text>
<text text-anchor="middle" x="1646.5" y="-1314.89" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- local_gating_2&#45;&gt;token_route_2 -->
<g id="edge95" class="edge">
<title>local_gating_2&#45;&gt;token_route_2</title>
<path fill="none" stroke="black" d="M1895.64,-1394.95C1838.23,-1379.31 1770.29,-1360.81 1719.87,-1347.07"/>
<polygon fill="black" stroke="black" points="1720.6,-1343.65 1710.03,-1344.39 1718.76,-1350.4 1720.6,-1343.65"/>
</g>
<!-- expert_2_0 -->
<g id="node62" class="node">
<title>expert_2_0</title>
<polygon fill="lightcoral" stroke="black" points="205,-1263.22 32,-1263.22 32,-1210.22 205,-1210.22 205,-1263.22"/>
<text text-anchor="middle" x="118.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 0 L2</text>
<text text-anchor="middle" x="118.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="118.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_0 -->
<g id="edge96" class="edge">
<title>token_route_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" d="M1560.51,-1323.85C1295.9,-1319.64 495.33,-1303.92 215.2,-1263.31"/>
<polygon fill="black" stroke="black" points="215.46,-1259.81 205.05,-1261.79 214.43,-1266.73 215.46,-1259.81"/>
</g>
<!-- expert_2_1 -->
<g id="node63" class="node">
<title>expert_2_1</title>
<polygon fill="lightcoral" stroke="black" points="396,-1263.22 223,-1263.22 223,-1210.22 396,-1210.22 396,-1263.22"/>
<text text-anchor="middle" x="309.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 1 L2</text>
<text text-anchor="middle" x="309.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="309.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_1 -->
<g id="edge98" class="edge">
<title>token_route_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" d="M1560.57,-1323.19C1320.88,-1317.5 647.34,-1298.9 406.18,-1263.31"/>
<polygon fill="black" stroke="black" points="406.47,-1259.81 396.06,-1261.77 405.42,-1266.73 406.47,-1259.81"/>
</g>
<!-- expert_2_2 -->
<g id="node64" class="node">
<title>expert_2_2</title>
<polygon fill="lightcoral" stroke="black" points="587,-1263.22 414,-1263.22 414,-1210.22 587,-1210.22 587,-1263.22"/>
<text text-anchor="middle" x="500.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 2 L2</text>
<text text-anchor="middle" x="500.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="500.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_2 -->
<g id="edge100" class="edge">
<title>token_route_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" d="M1560.02,-1325.92C1381.21,-1326.35 958,-1320.73 597.18,-1263.36"/>
<polygon fill="black" stroke="black" points="597.49,-1259.86 587.06,-1261.73 596.38,-1266.78 597.49,-1259.86"/>
</g>
<!-- expert_2_3 -->
<g id="node65" class="node">
<title>expert_2_3</title>
<polygon fill="lightcoral" stroke="black" points="778,-1263.22 605,-1263.22 605,-1210.22 778,-1210.22 778,-1263.22"/>
<text text-anchor="middle" x="691.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 3 L2</text>
<text text-anchor="middle" x="691.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="691.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_3 -->
<g id="edge102" class="edge">
<title>token_route_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" d="M1560.41,-1324.3C1406.66,-1321.71 1074.85,-1310.77 788.25,-1263.39"/>
<polygon fill="black" stroke="black" points="788.51,-1259.88 778.07,-1261.69 787.36,-1266.79 788.51,-1259.88"/>
</g>
<!-- expert_2_4 -->
<g id="node66" class="node">
<title>expert_2_4</title>
<polygon fill="lightcoral" stroke="black" points="969,-1263.22 796,-1263.22 796,-1210.22 969,-1210.22 969,-1263.22"/>
<text text-anchor="middle" x="882.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 4 L2</text>
<text text-anchor="middle" x="882.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="882.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_4 -->
<g id="edge104" class="edge">
<title>token_route_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" d="M1561.13,-1321.84C1435.35,-1316.03 1192.9,-1300.9 979.24,-1263.41"/>
<polygon fill="black" stroke="black" points="979.54,-1259.91 969.08,-1261.61 978.32,-1266.81 979.54,-1259.91"/>
</g>
<!-- expert_2_5 -->
<g id="node67" class="node">
<title>expert_2_5</title>
<polygon fill="lightcoral" stroke="black" points="1160,-1263.22 987,-1263.22 987,-1210.22 1160,-1210.22 1160,-1263.22"/>
<text text-anchor="middle" x="1073.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 5 L2</text>
<text text-anchor="middle" x="1073.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1073.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_5 -->
<g id="edge106" class="edge">
<title>token_route_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" d="M1564.34,-1317.82C1470.83,-1308.79 1313.46,-1291.29 1169.98,-1263.42"/>
<polygon fill="black" stroke="black" points="1170.6,-1259.97 1160.11,-1261.48 1169.25,-1266.84 1170.6,-1259.97"/>
</g>
<!-- expert_2_6 -->
<g id="node68" class="node">
<title>expert_2_6</title>
<polygon fill="lightcoral" stroke="black" points="1351,-1263.22 1178,-1263.22 1178,-1210.22 1351,-1210.22 1351,-1263.22"/>
<text text-anchor="middle" x="1264.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 6 L2</text>
<text text-anchor="middle" x="1264.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="1264.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_6 -->
<g id="edge108" class="edge">
<title>token_route_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" d="M1575.51,-1310.81C1519.68,-1299.35 1439.71,-1282.41 1361.23,-1263.6"/>
<polygon fill="black" stroke="black" points="1361.72,-1260.12 1351.18,-1261.18 1360.08,-1266.92 1361.72,-1260.12"/>
</g>
<!-- expert_2_7 -->
<g id="node69" class="node">
<title>expert_2_7</title>
<polygon fill="lightcoral" stroke="black" points="1542,-1263.22 1369,-1263.22 1369,-1210.22 1542,-1210.22 1542,-1263.22"/>
<text text-anchor="middle" x="1455.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 7 L2</text>
<text text-anchor="middle" x="1455.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="1455.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_7 -->
<g id="edge110" class="edge">
<title>token_route_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" d="M1599.29,-1303.49C1575.58,-1292.65 1546.47,-1279.34 1520.67,-1267.53"/>
<polygon fill="black" stroke="black" points="1521.88,-1264.24 1511.33,-1263.26 1518.97,-1270.6 1521.88,-1264.24"/>
</g>
<!-- expert_2_8 -->
<g id="node70" class="node">
<title>expert_2_8</title>
<polygon fill="lightcoral" stroke="black" points="1733,-1263.22 1560,-1263.22 1560,-1210.22 1733,-1210.22 1733,-1263.22"/>
<text text-anchor="middle" x="1646.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 8 L2</text>
<text text-anchor="middle" x="1646.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1646.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_8 -->
<g id="edge112" class="edge">
<title>token_route_2&#45;&gt;expert_2_8</title>
<path fill="none" stroke="black" d="M1646.5,-1298.88C1646.5,-1290.87 1646.5,-1281.93 1646.5,-1273.41"/>
<polygon fill="black" stroke="black" points="1650,-1273.31 1646.5,-1263.31 1643,-1273.31 1650,-1273.31"/>
</g>
<!-- expert_2_9 -->
<g id="node71" class="node">
<title>expert_2_9</title>
<polygon fill="lightcoral" stroke="black" points="1924,-1263.22 1751,-1263.22 1751,-1210.22 1924,-1210.22 1924,-1263.22"/>
<text text-anchor="middle" x="1837.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 9 L2</text>
<text text-anchor="middle" x="1837.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="1837.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_9 -->
<g id="edge114" class="edge">
<title>token_route_2&#45;&gt;expert_2_9</title>
<path fill="none" stroke="black" d="M1693.71,-1303.49C1717.42,-1292.65 1746.53,-1279.34 1772.33,-1267.53"/>
<polygon fill="black" stroke="black" points="1774.03,-1270.6 1781.67,-1263.26 1771.12,-1264.24 1774.03,-1270.6"/>
</g>
<!-- expert_2_10 -->
<g id="node72" class="node">
<title>expert_2_10</title>
<polygon fill="lightcoral" stroke="black" points="2115,-1263.22 1942,-1263.22 1942,-1210.22 2115,-1210.22 2115,-1263.22"/>
<text text-anchor="middle" x="2028.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 10 L2</text>
<text text-anchor="middle" x="2028.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="2028.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_10 -->
<g id="edge116" class="edge">
<title>token_route_2&#45;&gt;expert_2_10</title>
<path fill="none" stroke="black" d="M1717.52,-1310.69C1773.14,-1299.18 1852.68,-1282.25 1931.79,-1263.35"/>
<polygon fill="black" stroke="black" points="1933.03,-1266.65 1941.94,-1260.91 1931.4,-1259.84 1933.03,-1266.65"/>
</g>
<!-- expert_2_11 -->
<g id="node73" class="node">
<title>expert_2_11</title>
<polygon fill="lightcoral" stroke="black" points="2306,-1263.22 2133,-1263.22 2133,-1210.22 2306,-1210.22 2306,-1263.22"/>
<text text-anchor="middle" x="2219.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 11 L2</text>
<text text-anchor="middle" x="2219.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2219.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_11 -->
<g id="edge118" class="edge">
<title>token_route_2&#45;&gt;expert_2_11</title>
<path fill="none" stroke="black" d="M1728.9,-1317.7C1822.26,-1308.59 1979.02,-1291.04 2122.86,-1263.24"/>
<polygon fill="black" stroke="black" points="2123.61,-1266.66 2132.75,-1261.31 2122.27,-1259.79 2123.61,-1266.66"/>
</g>
<!-- expert_2_12 -->
<g id="node74" class="node">
<title>expert_2_12</title>
<polygon fill="lightcoral" stroke="black" points="2497,-1263.22 2324,-1263.22 2324,-1210.22 2497,-1210.22 2497,-1263.22"/>
<text text-anchor="middle" x="2410.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 12 L2</text>
<text text-anchor="middle" x="2410.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="2410.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_12 -->
<g id="edge120" class="edge">
<title>token_route_2&#45;&gt;expert_2_12</title>
<path fill="none" stroke="black" d="M1731.73,-1321.76C1857.37,-1315.84 2099.62,-1300.58 2313.92,-1263.19"/>
<polygon fill="black" stroke="black" points="2314.54,-1266.63 2323.78,-1261.45 2313.33,-1259.74 2314.54,-1266.63"/>
</g>
<!-- expert_2_13 -->
<g id="node75" class="node">
<title>expert_2_13</title>
<polygon fill="lightcoral" stroke="black" points="2688,-1263.22 2515,-1263.22 2515,-1210.22 2688,-1210.22 2688,-1263.22"/>
<text text-anchor="middle" x="2601.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 13 L2</text>
<text text-anchor="middle" x="2601.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="2601.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_13 -->
<g id="edge122" class="edge">
<title>token_route_2&#45;&gt;expert_2_13</title>
<path fill="none" stroke="black" d="M1732.59,-1324.3C1886.34,-1321.71 2218.15,-1310.77 2504.75,-1263.39"/>
<polygon fill="black" stroke="black" points="2505.64,-1266.79 2514.93,-1261.69 2504.49,-1259.88 2505.64,-1266.79"/>
</g>
<!-- expert_2_14 -->
<g id="node76" class="node">
<title>expert_2_14</title>
<polygon fill="lightcoral" stroke="black" points="2879,-1263.22 2706,-1263.22 2706,-1210.22 2879,-1210.22 2879,-1263.22"/>
<text text-anchor="middle" x="2792.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 14 L2</text>
<text text-anchor="middle" x="2792.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="2792.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_14 -->
<g id="edge124" class="edge">
<title>token_route_2&#45;&gt;expert_2_14</title>
<path fill="none" stroke="black" d="M1732.98,-1325.92C1911.79,-1326.35 2335,-1320.73 2695.82,-1263.36"/>
<polygon fill="black" stroke="black" points="2696.62,-1266.78 2705.94,-1261.73 2695.51,-1259.86 2696.62,-1266.78"/>
</g>
<!-- expert_2_15 -->
<g id="node77" class="node">
<title>expert_2_15</title>
<polygon fill="lightcoral" stroke="black" points="3070,-1263.22 2897,-1263.22 2897,-1210.22 3070,-1210.22 3070,-1263.22"/>
<text text-anchor="middle" x="2983.5" y="-1248.02" font-family="Arial" font-size="14.00">Expert 15 L2</text>
<text text-anchor="middle" x="2983.5" y="-1233.02" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="2983.5" y="-1218.02" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_2&#45;&gt;expert_2_15 -->
<g id="edge126" class="edge">
<title>token_route_2&#45;&gt;expert_2_15</title>
<path fill="none" stroke="black" d="M1732.43,-1323.19C1972.12,-1317.5 2645.66,-1298.9 2886.82,-1263.31"/>
<polygon fill="black" stroke="black" points="2887.58,-1266.73 2896.94,-1261.77 2886.53,-1259.81 2887.58,-1266.73"/>
</g>
<!-- expert_agg_2 -->
<g id="node78" class="node">
<title>expert_agg_2</title>
<ellipse fill="lightyellow" stroke="black" cx="1646.5" cy="-1147.35" rx="106.13" ry="26.74"/>
<text text-anchor="middle" x="1646.5" y="-1151.15" font-family="Arial" font-size="14.00">Expert Aggregation L2</text>
<text text-anchor="middle" x="1646.5" y="-1136.15" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- expert_2_0&#45;&gt;expert_agg_2 -->
<g id="edge97" class="edge">
<title>expert_2_0&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M205.05,-1211.65C207.89,-1211.13 210.72,-1210.65 213.5,-1210.22 466.31,-1171.31 1236.21,-1155.01 1530.47,-1150.08"/>
<polygon fill="black" stroke="black" points="1530.8,-1153.58 1540.74,-1149.91 1530.68,-1146.58 1530.8,-1153.58"/>
</g>
<!-- expert_2_1&#45;&gt;expert_agg_2 -->
<g id="edge99" class="edge">
<title>expert_2_1&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M396.06,-1211.67C398.9,-1211.15 401.72,-1210.66 404.5,-1210.22 619.41,-1176.42 1265.67,-1157.49 1530.94,-1150.97"/>
<polygon fill="black" stroke="black" points="1531.07,-1154.47 1540.99,-1150.72 1530.9,-1147.47 1531.07,-1154.47"/>
</g>
<!-- expert_2_2&#45;&gt;expert_agg_2 -->
<g id="edge101" class="edge">
<title>expert_2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M587.06,-1211.71C589.9,-1211.17 592.72,-1210.67 595.5,-1210.22 931.63,-1155.8 1335.11,-1147.82 1529.92,-1147.51"/>
<polygon fill="black" stroke="black" points="1530.18,-1151.01 1540.18,-1147.5 1530.18,-1144.01 1530.18,-1151.01"/>
</g>
<!-- expert_2_3&#45;&gt;expert_agg_2 -->
<g id="edge103" class="edge">
<title>expert_2_3&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M778.07,-1211.75C780.91,-1211.2 783.72,-1210.69 786.5,-1210.22 1050,-1165.79 1364.19,-1153.24 1530.25,-1149.71"/>
<polygon fill="black" stroke="black" points="1530.55,-1153.21 1540.48,-1149.5 1530.41,-1146.21 1530.55,-1153.21"/>
</g>
<!-- expert_2_4&#45;&gt;expert_agg_2 -->
<g id="edge105" class="edge">
<title>expert_2_4&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M969.08,-1211.83C971.92,-1211.26 974.73,-1210.72 977.5,-1210.22 1170.39,-1175.67 1398.22,-1159.82 1532.07,-1153.01"/>
<polygon fill="black" stroke="black" points="1532.52,-1156.49 1542.33,-1152.5 1532.17,-1149.5 1532.52,-1156.49"/>
</g>
<!-- expert_2_5&#45;&gt;expert_agg_2 -->
<g id="edge107" class="edge">
<title>expert_2_5&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M1160.11,-1211.96C1162.93,-1211.35 1165.74,-1210.77 1168.5,-1210.22 1293.96,-1185.38 1439.99,-1168.15 1537.32,-1158.29"/>
<polygon fill="black" stroke="black" points="1537.86,-1161.75 1547.46,-1157.27 1537.16,-1154.79 1537.86,-1161.75"/>
</g>
<!-- expert_2_6&#45;&gt;expert_agg_2 -->
<g id="edge109" class="edge">
<title>expert_2_6&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M1351.18,-1212.26C1353.98,-1211.57 1356.76,-1210.88 1359.5,-1210.22 1424.7,-1194.45 1498.71,-1178.55 1555.24,-1166.81"/>
<polygon fill="black" stroke="black" points="1556.14,-1170.2 1565.23,-1164.74 1554.72,-1163.34 1556.14,-1170.2"/>
</g>
<!-- expert_2_7&#45;&gt;expert_agg_2 -->
<g id="edge111" class="edge">
<title>expert_2_7&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M1511.26,-1210.21C1535.18,-1199.27 1563.15,-1186.48 1587.43,-1175.37"/>
<polygon fill="black" stroke="black" points="1588.89,-1178.55 1596.53,-1171.21 1585.98,-1172.18 1588.89,-1178.55"/>
</g>
<!-- expert_2_8&#45;&gt;expert_agg_2 -->
<g id="edge113" class="edge">
<title>expert_2_8&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M1646.5,-1209.98C1646.5,-1202.03 1646.5,-1193.13 1646.5,-1184.62"/>
<polygon fill="black" stroke="black" points="1650,-1184.51 1646.5,-1174.51 1643,-1184.51 1650,-1184.51"/>
</g>
<!-- expert_2_9&#45;&gt;expert_agg_2 -->
<g id="edge115" class="edge">
<title>expert_2_9&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M1781.74,-1210.21C1757.82,-1199.27 1729.85,-1186.48 1705.57,-1175.37"/>
<polygon fill="black" stroke="black" points="1707.02,-1172.18 1696.47,-1171.21 1704.11,-1178.55 1707.02,-1172.18"/>
</g>
<!-- expert_2_10&#45;&gt;expert_agg_2 -->
<g id="edge117" class="edge">
<title>expert_2_10&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M1941.94,-1212.53C1938.76,-1211.74 1935.6,-1210.97 1932.5,-1210.22 1867.5,-1194.57 1793.75,-1178.66 1737.43,-1166.89"/>
<polygon fill="black" stroke="black" points="1737.98,-1163.43 1727.47,-1164.82 1736.55,-1170.28 1737.98,-1163.43"/>
</g>
<!-- expert_2_11&#45;&gt;expert_agg_2 -->
<g id="edge119" class="edge">
<title>expert_2_11&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M2132.75,-1212.13C2129.64,-1211.46 2126.55,-1210.82 2123.5,-1210.22 1998.27,-1185.58 1852.55,-1168.31 1755.44,-1158.39"/>
<polygon fill="black" stroke="black" points="1755.62,-1154.89 1745.31,-1157.36 1754.91,-1161.85 1755.62,-1154.89"/>
</g>
<!-- expert_2_12&#45;&gt;expert_agg_2 -->
<g id="edge121" class="edge">
<title>expert_2_12&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M2323.78,-1211.99C2320.66,-1211.36 2317.56,-1210.76 2314.5,-1210.22 2122,-1175.99 1894.71,-1160.05 1761.04,-1153.13"/>
<polygon fill="black" stroke="black" points="1760.95,-1149.62 1750.78,-1152.6 1760.59,-1156.61 1760.95,-1149.62"/>
</g>
<!-- expert_2_13&#45;&gt;expert_agg_2 -->
<g id="edge123" class="edge">
<title>expert_2_13&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M2514.93,-1211.75C2512.09,-1211.2 2509.28,-1210.69 2506.5,-1210.22 2243,-1165.79 1928.81,-1153.24 1762.75,-1149.71"/>
<polygon fill="black" stroke="black" points="1762.59,-1146.21 1752.52,-1149.5 1762.45,-1153.21 1762.59,-1146.21"/>
</g>
<!-- expert_2_14&#45;&gt;expert_agg_2 -->
<g id="edge125" class="edge">
<title>expert_2_14&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M2705.94,-1211.71C2703.1,-1211.17 2700.28,-1210.67 2697.5,-1210.22 2361.37,-1155.8 1957.89,-1147.82 1763.08,-1147.51"/>
<polygon fill="black" stroke="black" points="1762.82,-1144.01 1752.82,-1147.5 1762.82,-1151.01 1762.82,-1144.01"/>
</g>
<!-- expert_2_15&#45;&gt;expert_agg_2 -->
<g id="edge127" class="edge">
<title>expert_2_15&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M2896.94,-1211.67C2894.1,-1211.15 2891.28,-1210.66 2888.5,-1210.22 2673.59,-1176.42 2027.33,-1157.49 1762.06,-1150.97"/>
<polygon fill="black" stroke="black" points="1762.1,-1147.47 1752.01,-1150.72 1761.93,-1154.47 1762.1,-1147.47"/>
</g>
<!-- moe_combine_2 -->
<g id="node79" class="node">
<title>moe_combine_2</title>
<polygon fill="lightblue" stroke="black" points="2400,-1084.48 2233,-1084.48 2233,-1046.48 2400,-1046.48 2400,-1084.48"/>
<text text-anchor="middle" x="2316.5" y="-1069.28" font-family="Arial" font-size="14.00">MoE Output Combine L2</text>
<text text-anchor="middle" x="2316.5" y="-1054.28" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- expert_agg_2&#45;&gt;moe_combine_2 -->
<g id="edge128" class="edge">
<title>expert_agg_2&#45;&gt;moe_combine_2</title>
<path fill="none" stroke="black" d="M1741.07,-1135.08C1868.91,-1119.84 2095.48,-1092.83 2222.84,-1077.65"/>
<polygon fill="black" stroke="black" points="2223.45,-1081.1 2232.97,-1076.44 2222.62,-1074.15 2223.45,-1081.1"/>
</g>
<!-- moe_combine_2&#45;&gt;moe_res_2 -->
<g id="edge129" class="edge">
<title>moe_combine_2&#45;&gt;moe_res_2</title>
<path fill="none" stroke="black" d="M2400.38,-1049.03C2471.03,-1036.03 2570.92,-1017.63 2637.38,-1005.39"/>
<polygon fill="black" stroke="black" points="2638.14,-1008.81 2647.34,-1003.56 2636.87,-1001.93 2638.14,-1008.81"/>
</g>
<!-- layernorm_3 -->
<g id="node81" class="node">
<title>layernorm_3</title>
<polygon fill="lightblue" stroke="black" points="2759,-936.48 2656,-936.48 2656,-898.48 2759,-898.48 2759,-936.48"/>
<text text-anchor="middle" x="2707.5" y="-921.28" font-family="Arial" font-size="14.00">LayerNorm L3</text>
<text text-anchor="middle" x="2707.5" y="-906.28" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- moe_res_2&#45;&gt;layernorm_3 -->
<g id="edge131" class="edge">
<title>moe_res_2&#45;&gt;layernorm_3</title>
<path fill="none" stroke="black" d="M2707.5,-972.31C2707.5,-964.61 2707.5,-955.45 2707.5,-946.9"/>
<polygon fill="black" stroke="black" points="2711,-946.89 2707.5,-936.89 2704,-946.89 2711,-946.89"/>
</g>
<!-- mha_qkv_3 -->
<g id="node82" class="node">
<title>mha_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="2725.5,-862.48 2585.5,-862.48 2585.5,-824.48 2725.5,-824.48 2725.5,-862.48"/>
<text text-anchor="middle" x="2655.5" y="-847.28" font-family="Arial" font-size="14.00">MHA QKV Linear L3</text>
<text text-anchor="middle" x="2655.5" y="-832.28" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- layernorm_3&#45;&gt;mha_qkv_3 -->
<g id="edge132" class="edge">
<title>layernorm_3&#45;&gt;mha_qkv_3</title>
<path fill="none" stroke="black" d="M2694.38,-898.31C2688.45,-890.1 2681.33,-880.24 2674.81,-871.21"/>
<polygon fill="black" stroke="black" points="2677.49,-868.95 2668.8,-862.89 2671.82,-873.05 2677.49,-868.95"/>
</g>
<!-- attn_res_3 -->
<g id="node85" class="node">
<title>attn_res_3</title>
<polygon fill="lightblue" stroke="black" points="2776,-640.48 2631,-640.48 2631,-602.48 2776,-602.48 2776,-640.48"/>
<text text-anchor="middle" x="2703.5" y="-625.28" font-family="Arial" font-size="14.00">Attention Residual L3</text>
<text text-anchor="middle" x="2703.5" y="-610.28" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- layernorm_3&#45;&gt;attn_res_3 -->
<g id="edge136" class="edge">
<title>layernorm_3&#45;&gt;attn_res_3</title>
<path fill="none" stroke="black" d="M2719.18,-898.29C2725,-888.17 2731.43,-875.11 2734.5,-862.48 2754.04,-782.15 2758.89,-756.06 2736.5,-676.48 2733.83,-667 2728.99,-657.55 2723.82,-649.26"/>
<polygon fill="black" stroke="black" points="2726.63,-647.16 2718.18,-640.77 2720.8,-651.04 2726.63,-647.16"/>
</g>
<!-- mha_attn_3 -->
<g id="node83" class="node">
<title>mha_attn_3</title>
<polygon fill="lightblue" stroke="black" points="2713.5,-788.48 2591.5,-788.48 2591.5,-750.48 2713.5,-750.48 2713.5,-788.48"/>
<text text-anchor="middle" x="2652.5" y="-773.28" font-family="Arial" font-size="14.00">MHA Attention L3</text>
<text text-anchor="middle" x="2652.5" y="-758.28" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- mha_qkv_3&#45;&gt;mha_attn_3 -->
<g id="edge133" class="edge">
<title>mha_qkv_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M2654.74,-824.31C2654.42,-816.61 2654.04,-807.45 2653.68,-798.9"/>
<polygon fill="black" stroke="black" points="2657.18,-798.74 2653.27,-788.89 2650.19,-799.03 2657.18,-798.74"/>
</g>
<!-- mha_out_3 -->
<g id="node84" class="node">
<title>mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="2727.5,-714.48 2575.5,-714.48 2575.5,-676.48 2727.5,-676.48 2727.5,-714.48"/>
<text text-anchor="middle" x="2651.5" y="-699.28" font-family="Arial" font-size="14.00">MHA Output Linear L3</text>
<text text-anchor="middle" x="2651.5" y="-684.28" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- mha_attn_3&#45;&gt;mha_out_3 -->
<g id="edge134" class="edge">
<title>mha_attn_3&#45;&gt;mha_out_3</title>
<path fill="none" stroke="black" d="M2652.25,-750.31C2652.14,-742.61 2652.01,-733.45 2651.89,-724.9"/>
<polygon fill="black" stroke="black" points="2655.39,-724.84 2651.76,-714.89 2648.4,-724.94 2655.39,-724.84"/>
</g>
<!-- mha_out_3&#45;&gt;attn_res_3 -->
<g id="edge135" class="edge">
<title>mha_out_3&#45;&gt;attn_res_3</title>
<path fill="none" stroke="black" d="M2664.62,-676.31C2670.55,-668.1 2677.67,-658.24 2684.19,-649.21"/>
<polygon fill="black" stroke="black" points="2687.18,-651.05 2690.2,-640.89 2681.51,-646.95 2687.18,-651.05"/>
</g>
<!-- local_gating_3 -->
<g id="node86" class="node">
<title>local_gating_3</title>
<polygon fill="lightgreen" stroke="black" points="2094.81,-566.48 1908.2,-566.48 1860.19,-490.48 2046.8,-490.48 2094.81,-566.48"/>
<text text-anchor="middle" x="1977.5" y="-532.28" font-family="Arial" font-size="14.00">Layer Gating L3</text>
<text text-anchor="middle" x="1977.5" y="-517.28" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- attn_res_3&#45;&gt;local_gating_3 -->
<g id="edge137" class="edge">
<title>attn_res_3&#45;&gt;local_gating_3</title>
<path fill="none" stroke="black" d="M2630.9,-611.38C2503.91,-595.46 2240.64,-562.46 2089.93,-543.57"/>
<polygon fill="black" stroke="black" points="2090.08,-540.06 2079.72,-542.29 2089.21,-547.01 2090.08,-540.06"/>
</g>
<!-- moe_res_3 -->
<g id="node106" class="node">
<title>moe_res_3</title>
<polygon fill="lightblue" stroke="black" points="2400.5,-112 2280.5,-112 2280.5,-74 2400.5,-74 2400.5,-112"/>
<text text-anchor="middle" x="2340.5" y="-96.8" font-family="Arial" font-size="14.00">MoE Residual L3</text>
<text text-anchor="middle" x="2340.5" y="-81.8" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- attn_res_3&#45;&gt;moe_res_3 -->
<g id="edge173" class="edge">
<title>attn_res_3&#45;&gt;moe_res_3</title>
<path fill="none" stroke="black" d="M2776.09,-614.28C2882.02,-600.82 3066.5,-558.7 3066.5,-428.61 3066.5,-428.61 3066.5,-428.61 3066.5,-247.87 3066.5,-114.62 2592.56,-96.25 2410.53,-94.1"/>
<polygon fill="black" stroke="black" points="2410.57,-90.6 2400.53,-94 2410.49,-97.6 2410.57,-90.6"/>
</g>
<!-- token_route_3 -->
<g id="node87" class="node">
<title>token_route_3</title>
<ellipse fill="lightyellow" stroke="black" cx="1614.5" cy="-427.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1614.5" y="-431.41" font-family="Arial" font-size="14.00">Token Routing L3</text>
<text text-anchor="middle" x="1614.5" y="-416.41" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- local_gating_3&#45;&gt;token_route_3 -->
<g id="edge138" class="edge">
<title>local_gating_3&#45;&gt;token_route_3</title>
<path fill="none" stroke="black" d="M1863.64,-496.47C1806.23,-480.83 1738.29,-462.33 1687.87,-448.59"/>
<polygon fill="black" stroke="black" points="1688.6,-445.17 1678.03,-445.91 1686.76,-451.92 1688.6,-445.17"/>
</g>
<!-- expert_3_0 -->
<g id="node88" class="node">
<title>expert_3_0</title>
<polygon fill="lightcoral" stroke="black" points="173,-364.74 0,-364.74 0,-311.74 173,-311.74 173,-364.74"/>
<text text-anchor="middle" x="86.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 0 L3</text>
<text text-anchor="middle" x="86.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="86.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_0 -->
<g id="edge139" class="edge">
<title>token_route_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" d="M1528.51,-425.37C1263.9,-421.16 463.33,-405.44 183.2,-364.83"/>
<polygon fill="black" stroke="black" points="183.46,-361.33 173.05,-363.31 182.43,-368.25 183.46,-361.33"/>
</g>
<!-- expert_3_1 -->
<g id="node89" class="node">
<title>expert_3_1</title>
<polygon fill="lightcoral" stroke="black" points="364,-364.74 191,-364.74 191,-311.74 364,-311.74 364,-364.74"/>
<text text-anchor="middle" x="277.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 1 L3</text>
<text text-anchor="middle" x="277.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="277.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_1 -->
<g id="edge141" class="edge">
<title>token_route_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" d="M1528.57,-424.71C1288.88,-419.02 615.34,-400.41 374.18,-364.83"/>
<polygon fill="black" stroke="black" points="374.47,-361.33 364.06,-363.29 373.42,-368.25 374.47,-361.33"/>
</g>
<!-- expert_3_2 -->
<g id="node90" class="node">
<title>expert_3_2</title>
<polygon fill="lightcoral" stroke="black" points="555,-364.74 382,-364.74 382,-311.74 555,-311.74 555,-364.74"/>
<text text-anchor="middle" x="468.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 2 L3</text>
<text text-anchor="middle" x="468.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="468.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_2 -->
<g id="edge143" class="edge">
<title>token_route_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" d="M1528.02,-427.44C1349.21,-427.87 926,-422.25 565.18,-364.88"/>
<polygon fill="black" stroke="black" points="565.49,-361.38 555.06,-363.25 564.38,-368.3 565.49,-361.38"/>
</g>
<!-- expert_3_3 -->
<g id="node91" class="node">
<title>expert_3_3</title>
<polygon fill="lightcoral" stroke="black" points="746,-364.74 573,-364.74 573,-311.74 746,-311.74 746,-364.74"/>
<text text-anchor="middle" x="659.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 3 L3</text>
<text text-anchor="middle" x="659.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="659.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_3 -->
<g id="edge145" class="edge">
<title>token_route_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" d="M1528.41,-425.82C1374.66,-423.23 1042.85,-412.29 756.25,-364.91"/>
<polygon fill="black" stroke="black" points="756.51,-361.4 746.07,-363.21 755.36,-368.31 756.51,-361.4"/>
</g>
<!-- expert_3_4 -->
<g id="node92" class="node">
<title>expert_3_4</title>
<polygon fill="lightcoral" stroke="black" points="937,-364.74 764,-364.74 764,-311.74 937,-311.74 937,-364.74"/>
<text text-anchor="middle" x="850.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 4 L3</text>
<text text-anchor="middle" x="850.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="850.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_4 -->
<g id="edge147" class="edge">
<title>token_route_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" d="M1529.13,-423.36C1403.35,-417.55 1160.9,-402.42 947.24,-364.93"/>
<polygon fill="black" stroke="black" points="947.54,-361.43 937.08,-363.13 946.32,-368.33 947.54,-361.43"/>
</g>
<!-- expert_3_5 -->
<g id="node93" class="node">
<title>expert_3_5</title>
<polygon fill="lightcoral" stroke="black" points="1128,-364.74 955,-364.74 955,-311.74 1128,-311.74 1128,-364.74"/>
<text text-anchor="middle" x="1041.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 5 L3</text>
<text text-anchor="middle" x="1041.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1041.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_5 -->
<g id="edge149" class="edge">
<title>token_route_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" d="M1532.34,-419.34C1438.83,-410.31 1281.46,-392.81 1137.98,-364.94"/>
<polygon fill="black" stroke="black" points="1138.6,-361.49 1128.11,-363 1137.25,-368.36 1138.6,-361.49"/>
</g>
<!-- expert_3_6 -->
<g id="node94" class="node">
<title>expert_3_6</title>
<polygon fill="lightcoral" stroke="black" points="1319,-364.74 1146,-364.74 1146,-311.74 1319,-311.74 1319,-364.74"/>
<text text-anchor="middle" x="1232.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 6 L3</text>
<text text-anchor="middle" x="1232.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="1232.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_6 -->
<g id="edge151" class="edge">
<title>token_route_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" d="M1543.51,-412.33C1487.68,-400.87 1407.71,-383.93 1329.23,-365.12"/>
<polygon fill="black" stroke="black" points="1329.72,-361.64 1319.18,-362.7 1328.08,-368.44 1329.72,-361.64"/>
</g>
<!-- expert_3_7 -->
<g id="node95" class="node">
<title>expert_3_7</title>
<polygon fill="lightcoral" stroke="black" points="1510,-364.74 1337,-364.74 1337,-311.74 1510,-311.74 1510,-364.74"/>
<text text-anchor="middle" x="1423.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 7 L3</text>
<text text-anchor="middle" x="1423.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="1423.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_7 -->
<g id="edge153" class="edge">
<title>token_route_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" d="M1567.29,-405.01C1543.58,-394.17 1514.47,-380.86 1488.67,-369.05"/>
<polygon fill="black" stroke="black" points="1489.88,-365.76 1479.33,-364.78 1486.97,-372.12 1489.88,-365.76"/>
</g>
<!-- expert_3_8 -->
<g id="node96" class="node">
<title>expert_3_8</title>
<polygon fill="lightcoral" stroke="black" points="1701,-364.74 1528,-364.74 1528,-311.74 1701,-311.74 1701,-364.74"/>
<text text-anchor="middle" x="1614.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 8 L3</text>
<text text-anchor="middle" x="1614.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1614.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_8 -->
<g id="edge155" class="edge">
<title>token_route_3&#45;&gt;expert_3_8</title>
<path fill="none" stroke="black" d="M1614.5,-400.4C1614.5,-392.39 1614.5,-383.45 1614.5,-374.93"/>
<polygon fill="black" stroke="black" points="1618,-374.83 1614.5,-364.83 1611,-374.83 1618,-374.83"/>
</g>
<!-- expert_3_9 -->
<g id="node97" class="node">
<title>expert_3_9</title>
<polygon fill="lightcoral" stroke="black" points="1892,-364.74 1719,-364.74 1719,-311.74 1892,-311.74 1892,-364.74"/>
<text text-anchor="middle" x="1805.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 9 L3</text>
<text text-anchor="middle" x="1805.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="1805.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_9 -->
<g id="edge157" class="edge">
<title>token_route_3&#45;&gt;expert_3_9</title>
<path fill="none" stroke="black" d="M1661.71,-405.01C1685.42,-394.17 1714.53,-380.86 1740.33,-369.05"/>
<polygon fill="black" stroke="black" points="1742.03,-372.12 1749.67,-364.78 1739.12,-365.76 1742.03,-372.12"/>
</g>
<!-- expert_3_10 -->
<g id="node98" class="node">
<title>expert_3_10</title>
<polygon fill="lightcoral" stroke="black" points="2083,-364.74 1910,-364.74 1910,-311.74 2083,-311.74 2083,-364.74"/>
<text text-anchor="middle" x="1996.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 10 L3</text>
<text text-anchor="middle" x="1996.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="1996.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_10 -->
<g id="edge159" class="edge">
<title>token_route_3&#45;&gt;expert_3_10</title>
<path fill="none" stroke="black" d="M1685.52,-412.21C1741.14,-400.7 1820.68,-383.77 1899.79,-364.87"/>
<polygon fill="black" stroke="black" points="1901.03,-368.17 1909.94,-362.43 1899.4,-361.36 1901.03,-368.17"/>
</g>
<!-- expert_3_11 -->
<g id="node99" class="node">
<title>expert_3_11</title>
<polygon fill="lightcoral" stroke="black" points="2274,-364.74 2101,-364.74 2101,-311.74 2274,-311.74 2274,-364.74"/>
<text text-anchor="middle" x="2187.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 11 L3</text>
<text text-anchor="middle" x="2187.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2187.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_11 -->
<g id="edge161" class="edge">
<title>token_route_3&#45;&gt;expert_3_11</title>
<path fill="none" stroke="black" d="M1696.9,-419.22C1790.26,-410.11 1947.02,-392.56 2090.86,-364.76"/>
<polygon fill="black" stroke="black" points="2091.61,-368.18 2100.75,-362.83 2090.27,-361.31 2091.61,-368.18"/>
</g>
<!-- expert_3_12 -->
<g id="node100" class="node">
<title>expert_3_12</title>
<polygon fill="lightcoral" stroke="black" points="2465,-364.74 2292,-364.74 2292,-311.74 2465,-311.74 2465,-364.74"/>
<text text-anchor="middle" x="2378.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 12 L3</text>
<text text-anchor="middle" x="2378.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="2378.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_12 -->
<g id="edge163" class="edge">
<title>token_route_3&#45;&gt;expert_3_12</title>
<path fill="none" stroke="black" d="M1699.73,-423.28C1825.37,-417.36 2067.62,-402.1 2281.92,-364.71"/>
<polygon fill="black" stroke="black" points="2282.54,-368.15 2291.78,-362.97 2281.33,-361.26 2282.54,-368.15"/>
</g>
<!-- expert_3_13 -->
<g id="node101" class="node">
<title>expert_3_13</title>
<polygon fill="lightcoral" stroke="black" points="2656,-364.74 2483,-364.74 2483,-311.74 2656,-311.74 2656,-364.74"/>
<text text-anchor="middle" x="2569.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 13 L3</text>
<text text-anchor="middle" x="2569.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="2569.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_13 -->
<g id="edge165" class="edge">
<title>token_route_3&#45;&gt;expert_3_13</title>
<path fill="none" stroke="black" d="M1700.78,-425.74C1854.47,-423.01 2185.62,-411.85 2472.61,-364.74"/>
<polygon fill="black" stroke="black" points="2473.5,-368.14 2482.8,-363.05 2472.36,-361.24 2473.5,-368.14"/>
</g>
<!-- expert_3_14 -->
<g id="node102" class="node">
<title>expert_3_14</title>
<polygon fill="lightcoral" stroke="black" points="2847,-364.74 2674,-364.74 2674,-311.74 2847,-311.74 2847,-364.74"/>
<text text-anchor="middle" x="2760.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 14 L3</text>
<text text-anchor="middle" x="2760.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="2760.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_14 -->
<g id="edge167" class="edge">
<title>token_route_3&#45;&gt;expert_3_14</title>
<path fill="none" stroke="black" d="M1700.98,-427.44C1879.79,-427.87 2303,-422.25 2663.82,-364.88"/>
<polygon fill="black" stroke="black" points="2664.62,-368.3 2673.94,-363.25 2663.51,-361.38 2664.62,-368.3"/>
</g>
<!-- expert_3_15 -->
<g id="node103" class="node">
<title>expert_3_15</title>
<polygon fill="lightcoral" stroke="black" points="3038,-364.74 2865,-364.74 2865,-311.74 3038,-311.74 3038,-364.74"/>
<text text-anchor="middle" x="2951.5" y="-349.54" font-family="Arial" font-size="14.00">Expert 15 L3</text>
<text text-anchor="middle" x="2951.5" y="-334.54" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="2951.5" y="-319.54" font-family="Arial" font-size="14.00">FFN 4096→32768→4096</text>
</g>
<!-- token_route_3&#45;&gt;expert_3_15 -->
<g id="edge169" class="edge">
<title>token_route_3&#45;&gt;expert_3_15</title>
<path fill="none" stroke="black" d="M1700.43,-424.71C1940.12,-419.02 2613.66,-400.41 2854.82,-364.83"/>
<polygon fill="black" stroke="black" points="2855.58,-368.25 2864.94,-363.29 2854.53,-361.33 2855.58,-368.25"/>
</g>
<!-- expert_agg_3 -->
<g id="node104" class="node">
<title>expert_agg_3</title>
<ellipse fill="lightyellow" stroke="black" cx="1614.5" cy="-248.87" rx="106.13" ry="26.74"/>
<text text-anchor="middle" x="1614.5" y="-252.67" font-family="Arial" font-size="14.00">Expert Aggregation L3</text>
<text text-anchor="middle" x="1614.5" y="-237.67" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- expert_3_0&#45;&gt;expert_agg_3 -->
<g id="edge140" class="edge">
<title>expert_3_0&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M173.05,-313.17C175.89,-312.65 178.72,-312.17 181.5,-311.74 434.31,-272.83 1204.21,-256.53 1498.47,-251.6"/>
<polygon fill="black" stroke="black" points="1498.8,-255.1 1508.74,-251.43 1498.68,-248.1 1498.8,-255.1"/>
</g>
<!-- expert_3_1&#45;&gt;expert_agg_3 -->
<g id="edge142" class="edge">
<title>expert_3_1&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M364.06,-313.19C366.9,-312.67 369.72,-312.18 372.5,-311.74 587.41,-277.94 1233.67,-259.01 1498.94,-252.49"/>
<polygon fill="black" stroke="black" points="1499.07,-255.99 1508.99,-252.24 1498.9,-248.99 1499.07,-255.99"/>
</g>
<!-- expert_3_2&#45;&gt;expert_agg_3 -->
<g id="edge144" class="edge">
<title>expert_3_2&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M555.06,-313.23C557.9,-312.69 560.72,-312.19 563.5,-311.74 899.63,-257.32 1303.11,-249.34 1497.92,-249.03"/>
<polygon fill="black" stroke="black" points="1498.18,-252.53 1508.18,-249.02 1498.18,-245.53 1498.18,-252.53"/>
</g>
<!-- expert_3_3&#45;&gt;expert_agg_3 -->
<g id="edge146" class="edge">
<title>expert_3_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M746.07,-313.27C748.91,-312.72 751.72,-312.21 754.5,-311.74 1018,-267.31 1332.19,-254.76 1498.25,-251.23"/>
<polygon fill="black" stroke="black" points="1498.55,-254.73 1508.48,-251.02 1498.41,-247.73 1498.55,-254.73"/>
</g>
<!-- expert_3_4&#45;&gt;expert_agg_3 -->
<g id="edge148" class="edge">
<title>expert_3_4&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M937.08,-313.35C939.92,-312.78 942.73,-312.24 945.5,-311.74 1138.39,-277.19 1366.22,-261.34 1500.07,-254.53"/>
<polygon fill="black" stroke="black" points="1500.52,-258.01 1510.33,-254.02 1500.17,-251.02 1500.52,-258.01"/>
</g>
<!-- expert_3_5&#45;&gt;expert_agg_3 -->
<g id="edge150" class="edge">
<title>expert_3_5&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M1128.11,-313.48C1130.93,-312.87 1133.74,-312.29 1136.5,-311.74 1261.96,-286.9 1407.99,-269.67 1505.32,-259.81"/>
<polygon fill="black" stroke="black" points="1505.86,-263.27 1515.46,-258.79 1505.16,-256.31 1505.86,-263.27"/>
</g>
<!-- expert_3_6&#45;&gt;expert_agg_3 -->
<g id="edge152" class="edge">
<title>expert_3_6&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M1319.18,-313.78C1321.98,-313.09 1324.76,-312.4 1327.5,-311.74 1392.7,-295.97 1466.71,-280.07 1523.24,-268.33"/>
<polygon fill="black" stroke="black" points="1524.14,-271.72 1533.23,-266.26 1522.72,-264.86 1524.14,-271.72"/>
</g>
<!-- expert_3_7&#45;&gt;expert_agg_3 -->
<g id="edge154" class="edge">
<title>expert_3_7&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M1479.26,-311.73C1503.18,-300.79 1531.15,-288 1555.43,-276.89"/>
<polygon fill="black" stroke="black" points="1556.89,-280.07 1564.53,-272.73 1553.98,-273.7 1556.89,-280.07"/>
</g>
<!-- expert_3_8&#45;&gt;expert_agg_3 -->
<g id="edge156" class="edge">
<title>expert_3_8&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M1614.5,-311.5C1614.5,-303.55 1614.5,-294.65 1614.5,-286.14"/>
<polygon fill="black" stroke="black" points="1618,-286.03 1614.5,-276.03 1611,-286.03 1618,-286.03"/>
</g>
<!-- expert_3_9&#45;&gt;expert_agg_3 -->
<g id="edge158" class="edge">
<title>expert_3_9&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M1749.74,-311.73C1725.82,-300.79 1697.85,-288 1673.57,-276.89"/>
<polygon fill="black" stroke="black" points="1675.02,-273.7 1664.47,-272.73 1672.11,-280.07 1675.02,-273.7"/>
</g>
<!-- expert_3_10&#45;&gt;expert_agg_3 -->
<g id="edge160" class="edge">
<title>expert_3_10&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M1909.94,-314.05C1906.76,-313.26 1903.6,-312.49 1900.5,-311.74 1835.5,-296.09 1761.75,-280.18 1705.43,-268.41"/>
<polygon fill="black" stroke="black" points="1705.98,-264.95 1695.47,-266.34 1704.55,-271.8 1705.98,-264.95"/>
</g>
<!-- expert_3_11&#45;&gt;expert_agg_3 -->
<g id="edge162" class="edge">
<title>expert_3_11&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M2100.75,-313.65C2097.64,-312.98 2094.55,-312.34 2091.5,-311.74 1966.27,-287.1 1820.55,-269.83 1723.44,-259.91"/>
<polygon fill="black" stroke="black" points="1723.62,-256.41 1713.31,-258.88 1722.91,-263.37 1723.62,-256.41"/>
</g>
<!-- expert_3_12&#45;&gt;expert_agg_3 -->
<g id="edge164" class="edge">
<title>expert_3_12&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M2291.78,-313.51C2288.66,-312.88 2285.56,-312.28 2282.5,-311.74 2090,-277.51 1862.71,-261.57 1729.04,-254.65"/>
<polygon fill="black" stroke="black" points="1728.95,-251.14 1718.78,-254.12 1728.59,-258.13 1728.95,-251.14"/>
</g>
<!-- expert_3_13&#45;&gt;expert_agg_3 -->
<g id="edge166" class="edge">
<title>expert_3_13&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M2482.8,-313.43C2479.67,-312.82 2476.56,-312.25 2473.5,-311.74 2210.25,-267.7 1896.45,-254.99 1730.6,-251.34"/>
<polygon fill="black" stroke="black" points="1730.45,-247.83 1720.38,-251.12 1730.3,-254.83 1730.45,-247.83"/>
</g>
<!-- expert_3_14&#45;&gt;expert_agg_3 -->
<g id="edge168" class="edge">
<title>expert_3_14&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M2673.94,-313.23C2671.1,-312.69 2668.28,-312.19 2665.5,-311.74 2329.37,-257.32 1925.89,-249.34 1731.08,-249.03"/>
<polygon fill="black" stroke="black" points="1730.82,-245.53 1720.82,-249.02 1730.82,-252.53 1730.82,-245.53"/>
</g>
<!-- expert_3_15&#45;&gt;expert_agg_3 -->
<g id="edge170" class="edge">
<title>expert_3_15&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M2864.94,-313.19C2862.1,-312.67 2859.28,-312.18 2856.5,-311.74 2641.59,-277.94 1995.33,-259.01 1730.06,-252.49"/>
<polygon fill="black" stroke="black" points="1730.1,-248.99 1720.01,-252.24 1729.93,-255.99 1730.1,-248.99"/>
</g>
<!-- moe_combine_3 -->
<g id="node105" class="node">
<title>moe_combine_3</title>
<polygon fill="lightblue" stroke="black" points="2369,-186 2202,-186 2202,-148 2369,-148 2369,-186"/>
<text text-anchor="middle" x="2285.5" y="-170.8" font-family="Arial" font-size="14.00">MoE Output Combine L3</text>
<text text-anchor="middle" x="2285.5" y="-155.8" font-family="Arial" font-size="14.00">All GPUs</text>
</g>
<!-- expert_agg_3&#45;&gt;moe_combine_3 -->
<g id="edge171" class="edge">
<title>expert_agg_3&#45;&gt;moe_combine_3</title>
<path fill="none" stroke="black" d="M1709.21,-236.6C1837.24,-221.36 2064.15,-194.35 2191.7,-179.16"/>
<polygon fill="black" stroke="black" points="2192.33,-182.62 2201.84,-177.96 2191.5,-175.66 2192.33,-182.62"/>
</g>
<!-- moe_combine_3&#45;&gt;moe_res_3 -->
<g id="edge172" class="edge">
<title>moe_combine_3&#45;&gt;moe_res_3</title>
<path fill="none" stroke="black" d="M2299.38,-147.83C2305.71,-139.54 2313.34,-129.56 2320.29,-120.45"/>
<polygon fill="black" stroke="black" points="2323.15,-122.48 2326.43,-112.41 2317.58,-118.24 2323.15,-122.48"/>
</g>
<!-- output -->
<g id="node107" class="node">
<title>output</title>
<text text-anchor="middle" x="2340.5" y="-22.8" font-family="Arial" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="2340.5" y="-7.8" font-family="Arial" font-size="14.00">Batch: 128, Seq: 10000, Dim: 4096</text>
</g>
<!-- moe_res_3&#45;&gt;output -->
<g id="edge174" class="edge">
<title>moe_res_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2340.5,-73.83C2340.5,-66.13 2340.5,-56.97 2340.5,-48.42"/>
<polygon fill="black" stroke="black" points="2344,-48.41 2340.5,-38.41 2337,-48.41 2344,-48.41"/>
</g>
</g>
</svg>
