<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe Pages: 1 -->
<svg width="2771pt" height="4659pt"
 viewBox="0.00 0.00 2771.35 4658.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4654.51)">
<title>baseline_moe</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4654.51 2767.35,-4654.51 2767.35,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<text text-anchor="start" x="2104" y="-4636.31" font-family="Arial" font-weight="bold" font-size="14.00">Model Input</text>
<text text-anchor="start" x="2087.5" y="-4622.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Batch Size: 128</text>
<text text-anchor="start" x="2059.5" y="-4608.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Sequence Length: 10000</text>
<text text-anchor="start" x="2080.5" y="-4594.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Hidden Dim: 4096</text>
</g>
<!-- pipeline_split -->
<g id="node2" class="node">
<title>pipeline_split</title>
<polygon fill="lightgreen" stroke="black" points="2312.56,-4550.51 2042.04,-4550.51 1972.44,-4450.51 2242.96,-4450.51 2312.56,-4550.51"/>
<text text-anchor="start" x="2100" y="-4511.31" font-family="Arial" font-weight="bold" font-size="14.00">Pipeline Split</text>
<text text-anchor="start" x="2072" y="-4497.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Stage 0: Devices 0&#45;7</text>
<text text-anchor="start" x="2068.5" y="-4483.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Stage 1: Devices 8&#45;15</text>
</g>
<!-- input&#45;&gt;pipeline_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;pipeline_split</title>
<path fill="none" stroke="black" d="M2142.5,-4586.42C2142.5,-4578.43 2142.5,-4569.55 2142.5,-4560.64"/>
<polygon fill="black" stroke="black" points="2146,-4560.61 2142.5,-4550.61 2139,-4560.61 2146,-4560.61"/>
</g>
<!-- layernorm_0_s0 -->
<g id="node3" class="node">
<title>layernorm_0_s0</title>
<polygon fill="lightblue" stroke="black" points="2350,-4414.51 1935,-4414.51 1935,-4350.51 2350,-4350.51 2350,-4414.51"/>
<text text-anchor="start" x="2076" y="-4400.31" font-family="Arial" font-weight="bold" font-size="14.00">LayerNorm (Layer 0)</text>
<text text-anchor="start" x="2098.5" y="-4386.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1948.5" y="-4372.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1943" y="-4358.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- pipeline_split&#45;&gt;layernorm_0_s0 -->
<g id="edge2" class="edge">
<title>pipeline_split&#45;&gt;layernorm_0_s0</title>
<path fill="none" stroke="black" d="M2142.5,-4450.32C2142.5,-4441.81 2142.5,-4433.04 2142.5,-4424.76"/>
<polygon fill="black" stroke="black" points="2146,-4424.61 2142.5,-4414.61 2139,-4424.61 2146,-4424.61"/>
</g>
<!-- mha_qkv_0_s0 -->
<g id="node4" class="node">
<title>mha_qkv_0_s0</title>
<polygon fill="lightblue" stroke="black" points="2234,-4314.51 1815,-4314.51 1815,-4250.51 2234,-4250.51 2234,-4314.51"/>
<text text-anchor="start" x="1946.5" y="-4300.31" font-family="Arial" font-weight="bold" font-size="14.00">MHA QKV Linear (TP=8)</text>
<text text-anchor="start" x="1928.5" y="-4286.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7 (column parallel)</text>
<text text-anchor="start" x="1830.5" y="-4272.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1823" y="-4258.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, heads=4, d_k=128]</text>
</g>
<!-- layernorm_0_s0&#45;&gt;mha_qkv_0_s0 -->
<g id="edge3" class="edge">
<title>layernorm_0_s0&#45;&gt;mha_qkv_0_s0</title>
<path fill="none" stroke="black" d="M2105.16,-4350.5C2093.97,-4341.21 2081.57,-4330.91 2069.92,-4321.23"/>
<polygon fill="black" stroke="black" points="2071.93,-4318.35 2062,-4314.65 2067.45,-4323.73 2071.93,-4318.35"/>
</g>
<!-- attn_res_0_s0 -->
<g id="node7" class="node">
<title>attn_res_0_s0</title>
<polygon fill="lightblue" stroke="black" points="2359,-4014.51 1928,-4014.51 1928,-3950.51 2359,-3950.51 2359,-4014.51"/>
<text text-anchor="start" x="2069" y="-4000.31" font-family="Arial" font-weight="bold" font-size="14.00">Attention Residual Add</text>
<text text-anchor="start" x="2099.5" y="-3986.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1936" y="-3972.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096] (x2)</text>
<text text-anchor="start" x="1944" y="-3958.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layernorm_0_s0&#45;&gt;attn_res_0_s0 -->
<g id="edge7" class="edge">
<title>layernorm_0_s0&#45;&gt;attn_res_0_s0</title>
<path fill="none" stroke="black" d="M2208.92,-4350.42C2222.39,-4340.88 2234.78,-4328.98 2242.5,-4314.51 2297.75,-4211 2297.5,-4154.15 2242.5,-4050.51 2236.38,-4038.97 2227.28,-4029.05 2217.04,-4020.66"/>
<polygon fill="black" stroke="black" points="2219.09,-4017.82 2209.01,-4014.54 2214.84,-4023.39 2219.09,-4017.82"/>
</g>
<!-- mha_attn_0_s0 -->
<g id="node5" class="node">
<title>mha_attn_0_s0</title>
<polygon fill="lightblue" stroke="black" points="2229,-4214.51 1822,-4214.51 1822,-4150.51 2229,-4150.51 2229,-4214.51"/>
<text text-anchor="start" x="1955.5" y="-4200.31" font-family="Arial" font-weight="bold" font-size="14.00">MHA Attention (TP=8)</text>
<text text-anchor="start" x="1981.5" y="-4186.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1830" y="-4172.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="start" x="1830" y="-4158.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=512]</text>
</g>
<!-- mha_qkv_0_s0&#45;&gt;mha_attn_0_s0 -->
<g id="edge4" class="edge">
<title>mha_qkv_0_s0&#45;&gt;mha_attn_0_s0</title>
<path fill="none" stroke="black" d="M2024.82,-4250.5C2024.9,-4242.37 2024.99,-4233.47 2025.08,-4224.89"/>
<polygon fill="black" stroke="black" points="2028.58,-4224.69 2025.18,-4214.65 2021.58,-4224.62 2028.58,-4224.69"/>
</g>
<!-- mha_out_0_s0 -->
<g id="node6" class="node">
<title>mha_out_0_s0</title>
<polygon fill="lightblue" stroke="black" points="2234,-4114.51 1819,-4114.51 1819,-4050.51 2234,-4050.51 2234,-4114.51"/>
<text text-anchor="start" x="1941" y="-4100.31" font-family="Arial" font-weight="bold" font-size="14.00">MHA Output Linear (TP=8)</text>
<text text-anchor="start" x="1942" y="-4086.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7 (row parallel)</text>
<text text-anchor="start" x="1836.5" y="-4072.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=512]</text>
<text text-anchor="start" x="1827" y="-4058.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha_attn_0_s0&#45;&gt;mha_out_0_s0 -->
<g id="edge5" class="edge">
<title>mha_attn_0_s0&#45;&gt;mha_out_0_s0</title>
<path fill="none" stroke="black" d="M2025.82,-4150.5C2025.9,-4142.37 2025.99,-4133.47 2026.08,-4124.89"/>
<polygon fill="black" stroke="black" points="2029.58,-4124.69 2026.18,-4114.65 2022.58,-4124.62 2029.58,-4124.69"/>
</g>
<!-- mha_out_0_s0&#45;&gt;attn_res_0_s0 -->
<g id="edge6" class="edge">
<title>mha_out_0_s0&#45;&gt;attn_res_0_s0</title>
<path fill="none" stroke="black" d="M2063.52,-4050.5C2074.62,-4041.21 2086.91,-4030.91 2098.46,-4021.23"/>
<polygon fill="black" stroke="black" points="2100.9,-4023.76 2106.32,-4014.65 2096.41,-4018.39 2100.9,-4023.76"/>
</g>
<!-- moe_gating_0_s0 -->
<g id="node8" class="node">
<title>moe_gating_0_s0</title>
<polygon fill="lightgreen" stroke="black" points="1953.2,-3914.51 1287.14,-3914.51 1115.8,-3786.51 1781.86,-3786.51 1953.2,-3914.51"/>
<text text-anchor="start" x="1467" y="-3868.31" font-family="Arial" font-weight="bold" font-size="14.00">MoE Gating Network</text>
<text text-anchor="start" x="1490.5" y="-3854.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1340.5" y="-3840.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1378" y="-3826.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [routing decisions, expert assignments]</text>
</g>
<!-- attn_res_0_s0&#45;&gt;moe_gating_0_s0 -->
<g id="edge8" class="edge">
<title>attn_res_0_s0&#45;&gt;moe_gating_0_s0</title>
<path fill="none" stroke="black" d="M1998.02,-3950.45C1950.14,-3940.23 1894.97,-3928.46 1839.76,-3916.67"/>
<polygon fill="black" stroke="black" points="1840.33,-3913.21 1829.82,-3914.55 1838.87,-3920.06 1840.33,-3913.21"/>
</g>
<!-- moe_res_0_s0 -->
<g id="node18" class="node">
<title>moe_res_0_s0</title>
<polygon fill="lightblue" stroke="black" points="2359,-3458.51 1928,-3458.51 1928,-3394.51 2359,-3394.51 2359,-3458.51"/>
<text text-anchor="start" x="2084" y="-3444.31" font-family="Arial" font-weight="bold" font-size="14.00">MoE Residual Add</text>
<text text-anchor="start" x="2099.5" y="-3430.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1936" y="-3416.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096] (x2)</text>
<text text-anchor="start" x="1944" y="-3402.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- attn_res_0_s0&#45;&gt;moe_res_0_s0 -->
<g id="edge26" class="edge">
<title>attn_res_0_s0&#45;&gt;moe_res_0_s0</title>
<path fill="none" stroke="black" d="M2346.5,-3950.45C2558.55,-3908.74 2846.13,-3820.43 2735.5,-3658.51 2653.69,-3538.77 2499.81,-3481.09 2369.44,-3453.31"/>
<polygon fill="black" stroke="black" points="2369.8,-3449.81 2359.3,-3451.2 2368.38,-3456.66 2369.8,-3449.81"/>
</g>
<!-- expert_0_gpu0_s0 -->
<g id="node9" class="node">
<title>expert_0_gpu0_s0</title>
<polygon fill="lightblue" stroke="black" points="325,-3750.51 0,-3750.51 0,-3658.51 325,-3658.51 325,-3750.51"/>
<text text-anchor="start" x="94.5" y="-3736.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 0)</text>
<text text-anchor="start" x="117" y="-3722.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0</text>
<text text-anchor="start" x="103.5" y="-3708.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 0&#45;1</text>
<text text-anchor="start" x="13.5" y="-3694.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="8" y="-3680.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="76" y="-3666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_0_s0&#45;&gt;expert_0_gpu0_s0 -->
<g id="edge9" class="edge">
<title>moe_gating_0_s0&#45;&gt;expert_0_gpu0_s0</title>
<path fill="none" stroke="black" d="M1182.99,-3836.76C945.28,-3824.22 624.65,-3799.7 335.55,-3750.79"/>
<polygon fill="black" stroke="black" points="335.72,-3747.27 325.28,-3749.04 334.55,-3754.17 335.72,-3747.27"/>
</g>
<!-- expert_0_gpu1_s0 -->
<g id="node10" class="node">
<title>expert_0_gpu1_s0</title>
<polygon fill="lightblue" stroke="black" points="668,-3750.51 343,-3750.51 343,-3658.51 668,-3658.51 668,-3750.51"/>
<text text-anchor="start" x="437.5" y="-3736.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 0)</text>
<text text-anchor="start" x="460" y="-3722.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 1</text>
<text text-anchor="start" x="446.5" y="-3708.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 2&#45;3</text>
<text text-anchor="start" x="356.5" y="-3694.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="351" y="-3680.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="419" y="-3666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_0_s0&#45;&gt;expert_0_gpu1_s0 -->
<g id="edge11" class="edge">
<title>moe_gating_0_s0&#45;&gt;expert_0_gpu1_s0</title>
<path fill="none" stroke="black" d="M1157.4,-3817.72C1010.14,-3802.32 840.02,-3780.85 678.44,-3750.82"/>
<polygon fill="black" stroke="black" points="678.77,-3747.32 668.3,-3748.92 677.48,-3754.2 678.77,-3747.32"/>
</g>
<!-- expert_0_gpu2_s0 -->
<g id="node11" class="node">
<title>expert_0_gpu2_s0</title>
<polygon fill="lightblue" stroke="black" points="1011,-3750.51 686,-3750.51 686,-3658.51 1011,-3658.51 1011,-3750.51"/>
<text text-anchor="start" x="780.5" y="-3736.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 0)</text>
<text text-anchor="start" x="803" y="-3722.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 2</text>
<text text-anchor="start" x="789.5" y="-3708.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 4&#45;5</text>
<text text-anchor="start" x="699.5" y="-3694.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="694" y="-3680.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="762" y="-3666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_0_s0&#45;&gt;expert_0_gpu2_s0 -->
<g id="edge13" class="edge">
<title>moe_gating_0_s0&#45;&gt;expert_0_gpu2_s0</title>
<path fill="none" stroke="black" d="M1189.28,-3786.48C1135.42,-3775.74 1080.35,-3764.24 1021.26,-3750.88"/>
<polygon fill="black" stroke="black" points="1021.88,-3747.44 1011.36,-3748.64 1020.33,-3754.26 1021.88,-3747.44"/>
</g>
<!-- expert_0_gpu3_s0 -->
<g id="node12" class="node">
<title>expert_0_gpu3_s0</title>
<polygon fill="lightblue" stroke="black" points="1354,-3750.51 1029,-3750.51 1029,-3658.51 1354,-3658.51 1354,-3750.51"/>
<text text-anchor="start" x="1123.5" y="-3736.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 0)</text>
<text text-anchor="start" x="1146" y="-3722.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 3</text>
<text text-anchor="start" x="1132.5" y="-3708.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 6&#45;7</text>
<text text-anchor="start" x="1042.5" y="-3694.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1037" y="-3680.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1105" y="-3666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_0_s0&#45;&gt;expert_0_gpu3_s0 -->
<g id="edge15" class="edge">
<title>moe_gating_0_s0&#45;&gt;expert_0_gpu3_s0</title>
<path fill="none" stroke="black" d="M1384.06,-3786.35C1358.6,-3775.66 1332.51,-3764.71 1308.09,-3754.46"/>
<polygon fill="black" stroke="black" points="1309.39,-3751.21 1298.81,-3750.56 1306.68,-3757.66 1309.39,-3751.21"/>
</g>
<!-- expert_0_gpu4_s0 -->
<g id="node13" class="node">
<title>expert_0_gpu4_s0</title>
<polygon fill="lightblue" stroke="black" points="1697,-3750.51 1372,-3750.51 1372,-3658.51 1697,-3658.51 1697,-3750.51"/>
<text text-anchor="start" x="1466.5" y="-3736.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 0)</text>
<text text-anchor="start" x="1489" y="-3722.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 4</text>
<text text-anchor="start" x="1475.5" y="-3708.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 8&#45;9</text>
<text text-anchor="start" x="1385.5" y="-3694.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1380" y="-3680.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1448" y="-3666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_0_s0&#45;&gt;expert_0_gpu4_s0 -->
<g id="edge17" class="edge">
<title>moe_gating_0_s0&#45;&gt;expert_0_gpu4_s0</title>
<path fill="none" stroke="black" d="M1534.5,-3786.35C1534.5,-3777.95 1534.5,-3769.4 1534.5,-3761.14"/>
<polygon fill="black" stroke="black" points="1538,-3760.88 1534.5,-3750.88 1531,-3760.88 1538,-3760.88"/>
</g>
<!-- expert_0_gpu5_s0 -->
<g id="node14" class="node">
<title>expert_0_gpu5_s0</title>
<polygon fill="lightblue" stroke="black" points="2040,-3750.51 1715,-3750.51 1715,-3658.51 2040,-3658.51 2040,-3750.51"/>
<text text-anchor="start" x="1809.5" y="-3736.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 0)</text>
<text text-anchor="start" x="1832" y="-3722.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 5</text>
<text text-anchor="start" x="1811" y="-3708.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 10&#45;11</text>
<text text-anchor="start" x="1728.5" y="-3694.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1723" y="-3680.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1791" y="-3666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_0_s0&#45;&gt;expert_0_gpu5_s0 -->
<g id="edge19" class="edge">
<title>moe_gating_0_s0&#45;&gt;expert_0_gpu5_s0</title>
<path fill="none" stroke="black" d="M1684.94,-3786.35C1710.4,-3775.66 1736.49,-3764.71 1760.91,-3754.46"/>
<polygon fill="black" stroke="black" points="1762.32,-3757.66 1770.19,-3750.56 1759.61,-3751.21 1762.32,-3757.66"/>
</g>
<!-- expert_0_gpu6_s0 -->
<g id="node15" class="node">
<title>expert_0_gpu6_s0</title>
<polygon fill="lightblue" stroke="black" points="2383,-3750.51 2058,-3750.51 2058,-3658.51 2383,-3658.51 2383,-3750.51"/>
<text text-anchor="start" x="2152.5" y="-3736.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 0)</text>
<text text-anchor="start" x="2175" y="-3722.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 6</text>
<text text-anchor="start" x="2154" y="-3708.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 12&#45;13</text>
<text text-anchor="start" x="2071.5" y="-3694.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2066" y="-3680.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2134" y="-3666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_0_s0&#45;&gt;expert_0_gpu6_s0 -->
<g id="edge21" class="edge">
<title>moe_gating_0_s0&#45;&gt;expert_0_gpu6_s0</title>
<path fill="none" stroke="black" d="M1801.97,-3801.44C1878.58,-3786.78 1962.28,-3769.91 2047.72,-3750.65"/>
<polygon fill="black" stroke="black" points="2048.62,-3754.04 2057.61,-3748.42 2047.08,-3747.21 2048.62,-3754.04"/>
</g>
<!-- expert_0_gpu7_s0 -->
<g id="node16" class="node">
<title>expert_0_gpu7_s0</title>
<polygon fill="lightblue" stroke="black" points="2726,-3750.51 2401,-3750.51 2401,-3658.51 2726,-3658.51 2726,-3750.51"/>
<text text-anchor="start" x="2495.5" y="-3736.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 0)</text>
<text text-anchor="start" x="2518" y="-3722.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 7</text>
<text text-anchor="start" x="2497" y="-3708.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 14&#45;15</text>
<text text-anchor="start" x="2414.5" y="-3694.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2409" y="-3680.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2477" y="-3666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_0_s0&#45;&gt;expert_0_gpu7_s0 -->
<g id="edge23" class="edge">
<title>moe_gating_0_s0&#45;&gt;expert_0_gpu7_s0</title>
<path fill="none" stroke="black" d="M1834.01,-3825.34C1996.45,-3809.67 2200.57,-3785.83 2390.76,-3750.58"/>
<polygon fill="black" stroke="black" points="2391.48,-3754.01 2400.67,-3748.73 2390.2,-3747.13 2391.48,-3754.01"/>
</g>
<!-- expert_agg_0_s0 -->
<g id="node17" class="node">
<title>expert_agg_0_s0</title>
<polygon fill="lightgreen" stroke="black" points="1964.51,-3622.51 1280.46,-3622.51 1104.49,-3494.51 1788.54,-3494.51 1964.51,-3622.51"/>
<text text-anchor="start" x="1447.5" y="-3576.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="start" x="1490.5" y="-3562.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1405" y="-3548.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [expert outputs from 16 experts]</text>
<text text-anchor="start" x="1335" y="-3534.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert_0_gpu0_s0&#45;&gt;expert_agg_0_s0 -->
<g id="edge10" class="edge">
<title>expert_0_gpu0_s0&#45;&gt;expert_agg_0_s0</title>
<path fill="none" stroke="black" d="M325.28,-3659.98C328.03,-3659.47 330.78,-3658.98 333.5,-3658.51 623.45,-3608.8 957.22,-3583.83 1199.19,-3571.42"/>
<polygon fill="black" stroke="black" points="1199.39,-3574.92 1209.2,-3570.91 1199.04,-3567.92 1199.39,-3574.92"/>
</g>
<!-- expert_0_gpu1_s0&#45;&gt;expert_agg_0_s0 -->
<g id="edge12" class="edge">
<title>expert_0_gpu1_s0&#45;&gt;expert_agg_0_s0</title>
<path fill="none" stroke="black" d="M668.3,-3660.1C671.05,-3659.55 673.78,-3659.02 676.5,-3658.51 854.21,-3625.05 1054.9,-3601.14 1217.48,-3585.22"/>
<polygon fill="black" stroke="black" points="1218.03,-3588.68 1227.64,-3584.23 1217.35,-3581.71 1218.03,-3588.68"/>
</g>
<!-- expert_0_gpu2_s0&#45;&gt;expert_agg_0_s0 -->
<g id="edge14" class="edge">
<title>expert_0_gpu2_s0&#45;&gt;expert_agg_0_s0</title>
<path fill="none" stroke="black" d="M1011.36,-3660.38C1014.09,-3659.75 1016.81,-3659.12 1019.5,-3658.51 1094.27,-3641.51 1175.58,-3624.97 1251.04,-3610.45"/>
<polygon fill="black" stroke="black" points="1252,-3613.82 1261.16,-3608.5 1250.68,-3606.95 1252,-3613.82"/>
</g>
<!-- expert_0_gpu3_s0&#45;&gt;expert_agg_0_s0 -->
<g id="edge16" class="edge">
<title>expert_0_gpu3_s0&#45;&gt;expert_agg_0_s0</title>
<path fill="none" stroke="black" d="M1299.09,-3658.34C1323.15,-3648.24 1349.16,-3637.32 1374.83,-3626.54"/>
<polygon fill="black" stroke="black" points="1376.4,-3629.68 1384.26,-3622.58 1373.69,-3623.23 1376.4,-3629.68"/>
</g>
<!-- expert_0_gpu4_s0&#45;&gt;expert_agg_0_s0 -->
<g id="edge18" class="edge">
<title>expert_0_gpu4_s0&#45;&gt;expert_agg_0_s0</title>
<path fill="none" stroke="black" d="M1534.5,-3658.34C1534.5,-3650.22 1534.5,-3641.57 1534.5,-3632.89"/>
<polygon fill="black" stroke="black" points="1538,-3632.72 1534.5,-3622.72 1531,-3632.72 1538,-3632.72"/>
</g>
<!-- expert_0_gpu5_s0&#45;&gt;expert_agg_0_s0 -->
<g id="edge20" class="edge">
<title>expert_0_gpu5_s0&#45;&gt;expert_agg_0_s0</title>
<path fill="none" stroke="black" d="M1769.91,-3658.34C1745.85,-3648.24 1719.84,-3637.32 1694.17,-3626.54"/>
<polygon fill="black" stroke="black" points="1695.31,-3623.23 1684.74,-3622.58 1692.6,-3629.68 1695.31,-3623.23"/>
</g>
<!-- expert_0_gpu6_s0&#45;&gt;expert_agg_0_s0 -->
<g id="edge22" class="edge">
<title>expert_0_gpu6_s0&#45;&gt;expert_agg_0_s0</title>
<path fill="none" stroke="black" d="M2057.61,-3660.6C2054.55,-3659.89 2051.51,-3659.19 2048.5,-3658.51 1996.98,-3646.82 1942.36,-3635.34 1888.69,-3624.57"/>
<polygon fill="black" stroke="black" points="1889.18,-3621.09 1878.68,-3622.56 1887.8,-3627.96 1889.18,-3621.09"/>
</g>
<!-- expert_0_gpu7_s0&#45;&gt;expert_agg_0_s0 -->
<g id="edge24" class="edge">
<title>expert_0_gpu7_s0&#45;&gt;expert_agg_0_s0</title>
<path fill="none" stroke="black" d="M2400.67,-3660.29C2397.59,-3659.67 2394.53,-3659.08 2391.5,-3658.51 2243.01,-3630.65 2078.49,-3609.38 1933.62,-3593.82"/>
<polygon fill="black" stroke="black" points="1933.98,-3590.34 1923.66,-3592.76 1933.23,-3597.3 1933.98,-3590.34"/>
</g>
<!-- expert_agg_0_s0&#45;&gt;moe_res_0_s0 -->
<g id="edge25" class="edge">
<title>expert_agg_0_s0&#45;&gt;moe_res_0_s0</title>
<path fill="none" stroke="black" d="M1798.07,-3501.25C1862.95,-3487.4 1930.36,-3473.01 1988.21,-3460.66"/>
<polygon fill="black" stroke="black" points="1989.11,-3464.05 1998.16,-3458.54 1987.65,-3457.2 1989.11,-3464.05"/>
</g>
<!-- layernorm_1_s0 -->
<g id="node19" class="node">
<title>layernorm_1_s0</title>
<polygon fill="lightblue" stroke="black" points="2351,-3358.51 1936,-3358.51 1936,-3294.51 2351,-3294.51 2351,-3358.51"/>
<text text-anchor="start" x="2077" y="-3344.31" font-family="Arial" font-weight="bold" font-size="14.00">LayerNorm (Layer 1)</text>
<text text-anchor="start" x="2099.5" y="-3330.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1949.5" y="-3316.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1944" y="-3302.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- moe_res_0_s0&#45;&gt;layernorm_1_s0 -->
<g id="edge27" class="edge">
<title>moe_res_0_s0&#45;&gt;layernorm_1_s0</title>
<path fill="none" stroke="black" d="M2143.5,-3394.5C2143.5,-3386.37 2143.5,-3377.47 2143.5,-3368.89"/>
<polygon fill="black" stroke="black" points="2147,-3368.65 2143.5,-3358.65 2140,-3368.65 2147,-3368.65"/>
</g>
<!-- mha_qkv_1_s0 -->
<g id="node20" class="node">
<title>mha_qkv_1_s0</title>
<polygon fill="lightblue" stroke="black" points="2235,-3258.51 1816,-3258.51 1816,-3194.51 2235,-3194.51 2235,-3258.51"/>
<text text-anchor="start" x="1947.5" y="-3244.31" font-family="Arial" font-weight="bold" font-size="14.00">MHA QKV Linear (TP=8)</text>
<text text-anchor="start" x="1929.5" y="-3230.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7 (column parallel)</text>
<text text-anchor="start" x="1831.5" y="-3216.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1824" y="-3202.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, heads=4, d_k=128]</text>
</g>
<!-- layernorm_1_s0&#45;&gt;mha_qkv_1_s0 -->
<g id="edge28" class="edge">
<title>layernorm_1_s0&#45;&gt;mha_qkv_1_s0</title>
<path fill="none" stroke="black" d="M2106.16,-3294.5C2094.97,-3285.21 2082.57,-3274.91 2070.92,-3265.23"/>
<polygon fill="black" stroke="black" points="2072.93,-3262.35 2063,-3258.65 2068.45,-3267.73 2072.93,-3262.35"/>
</g>
<!-- attn_res_1_s0 -->
<g id="node23" class="node">
<title>attn_res_1_s0</title>
<polygon fill="lightblue" stroke="black" points="2360,-2958.51 1929,-2958.51 1929,-2894.51 2360,-2894.51 2360,-2958.51"/>
<text text-anchor="start" x="2070" y="-2944.31" font-family="Arial" font-weight="bold" font-size="14.00">Attention Residual Add</text>
<text text-anchor="start" x="2100.5" y="-2930.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1937" y="-2916.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096] (x2)</text>
<text text-anchor="start" x="1945" y="-2902.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layernorm_1_s0&#45;&gt;attn_res_1_s0 -->
<g id="edge32" class="edge">
<title>layernorm_1_s0&#45;&gt;attn_res_1_s0</title>
<path fill="none" stroke="black" d="M2209.92,-3294.42C2223.39,-3284.88 2235.78,-3272.98 2243.5,-3258.51 2298.75,-3155 2298.5,-3098.15 2243.5,-2994.51 2237.38,-2982.97 2228.28,-2973.05 2218.04,-2964.66"/>
<polygon fill="black" stroke="black" points="2220.09,-2961.82 2210.01,-2958.54 2215.84,-2967.39 2220.09,-2961.82"/>
</g>
<!-- mha_attn_1_s0 -->
<g id="node21" class="node">
<title>mha_attn_1_s0</title>
<polygon fill="lightblue" stroke="black" points="2230,-3158.51 1823,-3158.51 1823,-3094.51 2230,-3094.51 2230,-3158.51"/>
<text text-anchor="start" x="1956.5" y="-3144.31" font-family="Arial" font-weight="bold" font-size="14.00">MHA Attention (TP=8)</text>
<text text-anchor="start" x="1982.5" y="-3130.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1831" y="-3116.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="start" x="1831" y="-3102.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=512]</text>
</g>
<!-- mha_qkv_1_s0&#45;&gt;mha_attn_1_s0 -->
<g id="edge29" class="edge">
<title>mha_qkv_1_s0&#45;&gt;mha_attn_1_s0</title>
<path fill="none" stroke="black" d="M2025.82,-3194.5C2025.9,-3186.37 2025.99,-3177.47 2026.08,-3168.89"/>
<polygon fill="black" stroke="black" points="2029.58,-3168.69 2026.18,-3158.65 2022.58,-3168.62 2029.58,-3168.69"/>
</g>
<!-- mha_out_1_s0 -->
<g id="node22" class="node">
<title>mha_out_1_s0</title>
<polygon fill="lightblue" stroke="black" points="2235,-3058.51 1820,-3058.51 1820,-2994.51 2235,-2994.51 2235,-3058.51"/>
<text text-anchor="start" x="1942" y="-3044.31" font-family="Arial" font-weight="bold" font-size="14.00">MHA Output Linear (TP=8)</text>
<text text-anchor="start" x="1943" y="-3030.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7 (row parallel)</text>
<text text-anchor="start" x="1837.5" y="-3016.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=512]</text>
<text text-anchor="start" x="1828" y="-3002.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha_attn_1_s0&#45;&gt;mha_out_1_s0 -->
<g id="edge30" class="edge">
<title>mha_attn_1_s0&#45;&gt;mha_out_1_s0</title>
<path fill="none" stroke="black" d="M2026.82,-3094.5C2026.9,-3086.37 2026.99,-3077.47 2027.08,-3068.89"/>
<polygon fill="black" stroke="black" points="2030.58,-3068.69 2027.18,-3058.65 2023.58,-3068.62 2030.58,-3068.69"/>
</g>
<!-- mha_out_1_s0&#45;&gt;attn_res_1_s0 -->
<g id="edge31" class="edge">
<title>mha_out_1_s0&#45;&gt;attn_res_1_s0</title>
<path fill="none" stroke="black" d="M2064.52,-2994.5C2075.62,-2985.21 2087.91,-2974.91 2099.46,-2965.23"/>
<polygon fill="black" stroke="black" points="2101.9,-2967.76 2107.32,-2958.65 2097.41,-2962.39 2101.9,-2967.76"/>
</g>
<!-- moe_gating_1_s0 -->
<g id="node24" class="node">
<title>moe_gating_1_s0</title>
<polygon fill="lightgreen" stroke="black" points="1954.2,-2858.51 1288.14,-2858.51 1116.8,-2730.51 1782.86,-2730.51 1954.2,-2858.51"/>
<text text-anchor="start" x="1468" y="-2812.31" font-family="Arial" font-weight="bold" font-size="14.00">MoE Gating Network</text>
<text text-anchor="start" x="1491.5" y="-2798.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1341.5" y="-2784.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1379" y="-2770.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [routing decisions, expert assignments]</text>
</g>
<!-- attn_res_1_s0&#45;&gt;moe_gating_1_s0 -->
<g id="edge33" class="edge">
<title>attn_res_1_s0&#45;&gt;moe_gating_1_s0</title>
<path fill="none" stroke="black" d="M1999.02,-2894.45C1951.14,-2884.23 1895.97,-2872.46 1840.76,-2860.67"/>
<polygon fill="black" stroke="black" points="1841.33,-2857.21 1830.82,-2858.55 1839.87,-2864.06 1841.33,-2857.21"/>
</g>
<!-- moe_res_1_s0 -->
<g id="node34" class="node">
<title>moe_res_1_s0</title>
<polygon fill="lightblue" stroke="black" points="2360,-2402.51 1929,-2402.51 1929,-2338.51 2360,-2338.51 2360,-2402.51"/>
<text text-anchor="start" x="2085" y="-2388.31" font-family="Arial" font-weight="bold" font-size="14.00">MoE Residual Add</text>
<text text-anchor="start" x="2100.5" y="-2374.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1937" y="-2360.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096] (x2)</text>
<text text-anchor="start" x="1945" y="-2346.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- attn_res_1_s0&#45;&gt;moe_res_1_s0 -->
<g id="edge51" class="edge">
<title>attn_res_1_s0&#45;&gt;moe_res_1_s0</title>
<path fill="none" stroke="black" d="M2347.5,-2894.45C2559.55,-2852.74 2847.13,-2764.43 2736.5,-2602.51 2654.69,-2482.77 2500.81,-2425.09 2370.44,-2397.31"/>
<polygon fill="black" stroke="black" points="2370.8,-2393.81 2360.3,-2395.2 2369.38,-2400.66 2370.8,-2393.81"/>
</g>
<!-- expert_1_gpu0_s0 -->
<g id="node25" class="node">
<title>expert_1_gpu0_s0</title>
<polygon fill="lightblue" stroke="black" points="326,-2694.51 1,-2694.51 1,-2602.51 326,-2602.51 326,-2694.51"/>
<text text-anchor="start" x="95.5" y="-2680.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 1)</text>
<text text-anchor="start" x="118" y="-2666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0</text>
<text text-anchor="start" x="104.5" y="-2652.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 0&#45;1</text>
<text text-anchor="start" x="14.5" y="-2638.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="9" y="-2624.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="77" y="-2610.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_1_s0&#45;&gt;expert_1_gpu0_s0 -->
<g id="edge34" class="edge">
<title>moe_gating_1_s0&#45;&gt;expert_1_gpu0_s0</title>
<path fill="none" stroke="black" d="M1183.99,-2780.76C946.28,-2768.22 625.65,-2743.7 336.55,-2694.79"/>
<polygon fill="black" stroke="black" points="336.72,-2691.27 326.28,-2693.04 335.55,-2698.17 336.72,-2691.27"/>
</g>
<!-- expert_1_gpu1_s0 -->
<g id="node26" class="node">
<title>expert_1_gpu1_s0</title>
<polygon fill="lightblue" stroke="black" points="669,-2694.51 344,-2694.51 344,-2602.51 669,-2602.51 669,-2694.51"/>
<text text-anchor="start" x="438.5" y="-2680.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 1)</text>
<text text-anchor="start" x="461" y="-2666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 1</text>
<text text-anchor="start" x="447.5" y="-2652.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 2&#45;3</text>
<text text-anchor="start" x="357.5" y="-2638.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="352" y="-2624.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="420" y="-2610.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_1_s0&#45;&gt;expert_1_gpu1_s0 -->
<g id="edge36" class="edge">
<title>moe_gating_1_s0&#45;&gt;expert_1_gpu1_s0</title>
<path fill="none" stroke="black" d="M1158.4,-2761.72C1011.14,-2746.32 841.02,-2724.85 679.44,-2694.82"/>
<polygon fill="black" stroke="black" points="679.77,-2691.32 669.3,-2692.92 678.48,-2698.2 679.77,-2691.32"/>
</g>
<!-- expert_1_gpu2_s0 -->
<g id="node27" class="node">
<title>expert_1_gpu2_s0</title>
<polygon fill="lightblue" stroke="black" points="1012,-2694.51 687,-2694.51 687,-2602.51 1012,-2602.51 1012,-2694.51"/>
<text text-anchor="start" x="781.5" y="-2680.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 1)</text>
<text text-anchor="start" x="804" y="-2666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 2</text>
<text text-anchor="start" x="790.5" y="-2652.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 4&#45;5</text>
<text text-anchor="start" x="700.5" y="-2638.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="695" y="-2624.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="763" y="-2610.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_1_s0&#45;&gt;expert_1_gpu2_s0 -->
<g id="edge38" class="edge">
<title>moe_gating_1_s0&#45;&gt;expert_1_gpu2_s0</title>
<path fill="none" stroke="black" d="M1190.28,-2730.48C1136.42,-2719.74 1081.35,-2708.24 1022.26,-2694.88"/>
<polygon fill="black" stroke="black" points="1022.88,-2691.44 1012.36,-2692.64 1021.33,-2698.26 1022.88,-2691.44"/>
</g>
<!-- expert_1_gpu3_s0 -->
<g id="node28" class="node">
<title>expert_1_gpu3_s0</title>
<polygon fill="lightblue" stroke="black" points="1355,-2694.51 1030,-2694.51 1030,-2602.51 1355,-2602.51 1355,-2694.51"/>
<text text-anchor="start" x="1124.5" y="-2680.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 1)</text>
<text text-anchor="start" x="1147" y="-2666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 3</text>
<text text-anchor="start" x="1133.5" y="-2652.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 6&#45;7</text>
<text text-anchor="start" x="1043.5" y="-2638.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1038" y="-2624.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1106" y="-2610.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_1_s0&#45;&gt;expert_1_gpu3_s0 -->
<g id="edge40" class="edge">
<title>moe_gating_1_s0&#45;&gt;expert_1_gpu3_s0</title>
<path fill="none" stroke="black" d="M1385.06,-2730.35C1359.6,-2719.66 1333.51,-2708.71 1309.09,-2698.46"/>
<polygon fill="black" stroke="black" points="1310.39,-2695.21 1299.81,-2694.56 1307.68,-2701.66 1310.39,-2695.21"/>
</g>
<!-- expert_1_gpu4_s0 -->
<g id="node29" class="node">
<title>expert_1_gpu4_s0</title>
<polygon fill="lightblue" stroke="black" points="1698,-2694.51 1373,-2694.51 1373,-2602.51 1698,-2602.51 1698,-2694.51"/>
<text text-anchor="start" x="1467.5" y="-2680.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 1)</text>
<text text-anchor="start" x="1490" y="-2666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 4</text>
<text text-anchor="start" x="1476.5" y="-2652.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 8&#45;9</text>
<text text-anchor="start" x="1386.5" y="-2638.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1381" y="-2624.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1449" y="-2610.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_1_s0&#45;&gt;expert_1_gpu4_s0 -->
<g id="edge42" class="edge">
<title>moe_gating_1_s0&#45;&gt;expert_1_gpu4_s0</title>
<path fill="none" stroke="black" d="M1535.5,-2730.35C1535.5,-2721.95 1535.5,-2713.4 1535.5,-2705.14"/>
<polygon fill="black" stroke="black" points="1539,-2704.88 1535.5,-2694.88 1532,-2704.88 1539,-2704.88"/>
</g>
<!-- expert_1_gpu5_s0 -->
<g id="node30" class="node">
<title>expert_1_gpu5_s0</title>
<polygon fill="lightblue" stroke="black" points="2041,-2694.51 1716,-2694.51 1716,-2602.51 2041,-2602.51 2041,-2694.51"/>
<text text-anchor="start" x="1810.5" y="-2680.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 1)</text>
<text text-anchor="start" x="1833" y="-2666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 5</text>
<text text-anchor="start" x="1812" y="-2652.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 10&#45;11</text>
<text text-anchor="start" x="1729.5" y="-2638.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1724" y="-2624.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1792" y="-2610.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_1_s0&#45;&gt;expert_1_gpu5_s0 -->
<g id="edge44" class="edge">
<title>moe_gating_1_s0&#45;&gt;expert_1_gpu5_s0</title>
<path fill="none" stroke="black" d="M1685.94,-2730.35C1711.4,-2719.66 1737.49,-2708.71 1761.91,-2698.46"/>
<polygon fill="black" stroke="black" points="1763.32,-2701.66 1771.19,-2694.56 1760.61,-2695.21 1763.32,-2701.66"/>
</g>
<!-- expert_1_gpu6_s0 -->
<g id="node31" class="node">
<title>expert_1_gpu6_s0</title>
<polygon fill="lightblue" stroke="black" points="2384,-2694.51 2059,-2694.51 2059,-2602.51 2384,-2602.51 2384,-2694.51"/>
<text text-anchor="start" x="2153.5" y="-2680.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 1)</text>
<text text-anchor="start" x="2176" y="-2666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 6</text>
<text text-anchor="start" x="2155" y="-2652.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 12&#45;13</text>
<text text-anchor="start" x="2072.5" y="-2638.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2067" y="-2624.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2135" y="-2610.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_1_s0&#45;&gt;expert_1_gpu6_s0 -->
<g id="edge46" class="edge">
<title>moe_gating_1_s0&#45;&gt;expert_1_gpu6_s0</title>
<path fill="none" stroke="black" d="M1802.97,-2745.44C1879.58,-2730.78 1963.28,-2713.91 2048.72,-2694.65"/>
<polygon fill="black" stroke="black" points="2049.62,-2698.04 2058.61,-2692.42 2048.08,-2691.21 2049.62,-2698.04"/>
</g>
<!-- expert_1_gpu7_s0 -->
<g id="node32" class="node">
<title>expert_1_gpu7_s0</title>
<polygon fill="lightblue" stroke="black" points="2727,-2694.51 2402,-2694.51 2402,-2602.51 2727,-2602.51 2727,-2694.51"/>
<text text-anchor="start" x="2496.5" y="-2680.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 1)</text>
<text text-anchor="start" x="2519" y="-2666.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 7</text>
<text text-anchor="start" x="2498" y="-2652.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 14&#45;15</text>
<text text-anchor="start" x="2415.5" y="-2638.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2410" y="-2624.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2478" y="-2610.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_1_s0&#45;&gt;expert_1_gpu7_s0 -->
<g id="edge48" class="edge">
<title>moe_gating_1_s0&#45;&gt;expert_1_gpu7_s0</title>
<path fill="none" stroke="black" d="M1835.01,-2769.34C1997.45,-2753.67 2201.57,-2729.83 2391.76,-2694.58"/>
<polygon fill="black" stroke="black" points="2392.48,-2698.01 2401.67,-2692.73 2391.2,-2691.13 2392.48,-2698.01"/>
</g>
<!-- expert_agg_1_s0 -->
<g id="node33" class="node">
<title>expert_agg_1_s0</title>
<polygon fill="lightgreen" stroke="black" points="1965.51,-2566.51 1281.46,-2566.51 1105.49,-2438.51 1789.54,-2438.51 1965.51,-2566.51"/>
<text text-anchor="start" x="1448.5" y="-2520.31" font-family="Arial" font-weight="bold" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="start" x="1491.5" y="-2506.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 0&#45;7</text>
<text text-anchor="start" x="1406" y="-2492.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [expert outputs from 16 experts]</text>
<text text-anchor="start" x="1336" y="-2478.31" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert_1_gpu0_s0&#45;&gt;expert_agg_1_s0 -->
<g id="edge35" class="edge">
<title>expert_1_gpu0_s0&#45;&gt;expert_agg_1_s0</title>
<path fill="none" stroke="black" d="M326.28,-2603.98C329.03,-2603.47 331.78,-2602.98 334.5,-2602.51 624.45,-2552.8 958.22,-2527.83 1200.19,-2515.42"/>
<polygon fill="black" stroke="black" points="1200.39,-2518.92 1210.2,-2514.91 1200.04,-2511.92 1200.39,-2518.92"/>
</g>
<!-- expert_1_gpu1_s0&#45;&gt;expert_agg_1_s0 -->
<g id="edge37" class="edge">
<title>expert_1_gpu1_s0&#45;&gt;expert_agg_1_s0</title>
<path fill="none" stroke="black" d="M669.3,-2604.1C672.05,-2603.55 674.78,-2603.02 677.5,-2602.51 855.21,-2569.05 1055.9,-2545.14 1218.48,-2529.22"/>
<polygon fill="black" stroke="black" points="1219.03,-2532.68 1228.64,-2528.23 1218.35,-2525.71 1219.03,-2532.68"/>
</g>
<!-- expert_1_gpu2_s0&#45;&gt;expert_agg_1_s0 -->
<g id="edge39" class="edge">
<title>expert_1_gpu2_s0&#45;&gt;expert_agg_1_s0</title>
<path fill="none" stroke="black" d="M1012.36,-2604.38C1015.09,-2603.75 1017.81,-2603.12 1020.5,-2602.51 1095.27,-2585.51 1176.58,-2568.97 1252.04,-2554.45"/>
<polygon fill="black" stroke="black" points="1253,-2557.82 1262.16,-2552.5 1251.68,-2550.95 1253,-2557.82"/>
</g>
<!-- expert_1_gpu3_s0&#45;&gt;expert_agg_1_s0 -->
<g id="edge41" class="edge">
<title>expert_1_gpu3_s0&#45;&gt;expert_agg_1_s0</title>
<path fill="none" stroke="black" d="M1300.09,-2602.34C1324.15,-2592.24 1350.16,-2581.32 1375.83,-2570.54"/>
<polygon fill="black" stroke="black" points="1377.4,-2573.68 1385.26,-2566.58 1374.69,-2567.23 1377.4,-2573.68"/>
</g>
<!-- expert_1_gpu4_s0&#45;&gt;expert_agg_1_s0 -->
<g id="edge43" class="edge">
<title>expert_1_gpu4_s0&#45;&gt;expert_agg_1_s0</title>
<path fill="none" stroke="black" d="M1535.5,-2602.34C1535.5,-2594.22 1535.5,-2585.57 1535.5,-2576.89"/>
<polygon fill="black" stroke="black" points="1539,-2576.72 1535.5,-2566.72 1532,-2576.72 1539,-2576.72"/>
</g>
<!-- expert_1_gpu5_s0&#45;&gt;expert_agg_1_s0 -->
<g id="edge45" class="edge">
<title>expert_1_gpu5_s0&#45;&gt;expert_agg_1_s0</title>
<path fill="none" stroke="black" d="M1770.91,-2602.34C1746.85,-2592.24 1720.84,-2581.32 1695.17,-2570.54"/>
<polygon fill="black" stroke="black" points="1696.31,-2567.23 1685.74,-2566.58 1693.6,-2573.68 1696.31,-2567.23"/>
</g>
<!-- expert_1_gpu6_s0&#45;&gt;expert_agg_1_s0 -->
<g id="edge47" class="edge">
<title>expert_1_gpu6_s0&#45;&gt;expert_agg_1_s0</title>
<path fill="none" stroke="black" d="M2058.61,-2604.6C2055.55,-2603.89 2052.51,-2603.19 2049.5,-2602.51 1997.98,-2590.82 1943.36,-2579.34 1889.69,-2568.57"/>
<polygon fill="black" stroke="black" points="1890.18,-2565.09 1879.68,-2566.56 1888.8,-2571.96 1890.18,-2565.09"/>
</g>
<!-- expert_1_gpu7_s0&#45;&gt;expert_agg_1_s0 -->
<g id="edge49" class="edge">
<title>expert_1_gpu7_s0&#45;&gt;expert_agg_1_s0</title>
<path fill="none" stroke="black" d="M2401.67,-2604.29C2398.59,-2603.67 2395.53,-2603.08 2392.5,-2602.51 2244.01,-2574.65 2079.49,-2553.38 1934.62,-2537.82"/>
<polygon fill="black" stroke="black" points="1934.98,-2534.34 1924.66,-2536.76 1934.23,-2541.3 1934.98,-2534.34"/>
</g>
<!-- expert_agg_1_s0&#45;&gt;moe_res_1_s0 -->
<g id="edge50" class="edge">
<title>expert_agg_1_s0&#45;&gt;moe_res_1_s0</title>
<path fill="none" stroke="black" d="M1799.07,-2445.25C1863.95,-2431.4 1931.36,-2417.01 1989.21,-2404.66"/>
<polygon fill="black" stroke="black" points="1990.11,-2408.05 1999.16,-2402.54 1988.65,-2401.2 1990.11,-2408.05"/>
</g>
<!-- pipeline_comm -->
<g id="node35" class="node">
<title>pipeline_comm</title>
<ellipse fill="lightyellow" stroke="black" cx="2144.5" cy="-2257.25" rx="125.73" ry="45.01"/>
<text text-anchor="start" x="2064.5" y="-2275.05" font-family="Arial" font-weight="bold" font-size="14.00">Pipeline Communication</text>
<text text-anchor="start" x="2079.5" y="-2261.05" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Stage 0  Stage 1</text>
<text text-anchor="start" x="2063.5" y="-2247.05" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Transfer: 4 layers output</text>
<text text-anchor="start" x="2070.5" y="-2233.05" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Async communication</text>
</g>
<!-- moe_res_1_s0&#45;&gt;pipeline_comm -->
<g id="edge52" class="edge">
<title>moe_res_1_s0&#45;&gt;pipeline_comm</title>
<path fill="none" stroke="black" d="M2144.5,-2338.22C2144.5,-2330.28 2144.5,-2321.51 2144.5,-2312.77"/>
<polygon fill="black" stroke="black" points="2148,-2312.59 2144.5,-2302.59 2141,-2312.59 2148,-2312.59"/>
</g>
<!-- layernorm_2_s1 -->
<g id="node36" class="node">
<title>layernorm_2_s1</title>
<polygon fill="lightblue" stroke="black" points="2352,-2176 1937,-2176 1937,-2112 2352,-2112 2352,-2176"/>
<text text-anchor="start" x="2078" y="-2161.8" font-family="Arial" font-weight="bold" font-size="14.00">LayerNorm (Layer 2)</text>
<text text-anchor="start" x="2097" y="-2147.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1950.5" y="-2133.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1945" y="-2119.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- pipeline_comm&#45;&gt;layernorm_2_s1 -->
<g id="edge53" class="edge">
<title>pipeline_comm&#45;&gt;layernorm_2_s1</title>
<path fill="none" stroke="black" d="M2137.88,-2211.96C2137.69,-2203.53 2137.71,-2194.73 2137.95,-2186.39"/>
<polygon fill="black" stroke="black" points="2141.46,-2186.26 2138.37,-2176.13 2134.46,-2185.98 2141.46,-2186.26"/>
</g>
<!-- pipeline_comm&#45;&gt;layernorm_2_s1 -->
<g id="edge54" class="edge">
<title>pipeline_comm&#45;&gt;layernorm_2_s1</title>
<path fill="none" stroke="black" d="M2151.12,-2211.96C2151.31,-2203.53 2151.29,-2194.73 2151.05,-2186.39"/>
<polygon fill="black" stroke="black" points="2154.54,-2185.98 2150.63,-2176.13 2147.54,-2186.26 2154.54,-2185.98"/>
</g>
<!-- mha_qkv_2_s1 -->
<g id="node37" class="node">
<title>mha_qkv_2_s1</title>
<polygon fill="lightblue" stroke="black" points="2236,-2076 1817,-2076 1817,-2012 2236,-2012 2236,-2076"/>
<text text-anchor="start" x="1948.5" y="-2061.8" font-family="Arial" font-weight="bold" font-size="14.00">MHA QKV Linear (TP=8)</text>
<text text-anchor="start" x="1927" y="-2047.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15 (column parallel)</text>
<text text-anchor="start" x="1832.5" y="-2033.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1825" y="-2019.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, heads=4, d_k=128]</text>
</g>
<!-- layernorm_2_s1&#45;&gt;mha_qkv_2_s1 -->
<g id="edge55" class="edge">
<title>layernorm_2_s1&#45;&gt;mha_qkv_2_s1</title>
<path fill="none" stroke="black" d="M2107.16,-2111.99C2095.97,-2102.7 2083.57,-2092.4 2071.92,-2082.72"/>
<polygon fill="black" stroke="black" points="2073.93,-2079.84 2064,-2076.14 2069.45,-2085.22 2073.93,-2079.84"/>
</g>
<!-- attn_res_2_s1 -->
<g id="node40" class="node">
<title>attn_res_2_s1</title>
<polygon fill="lightblue" stroke="black" points="2361,-1776 1930,-1776 1930,-1712 2361,-1712 2361,-1776"/>
<text text-anchor="start" x="2071" y="-1761.8" font-family="Arial" font-weight="bold" font-size="14.00">Attention Residual Add</text>
<text text-anchor="start" x="2098" y="-1747.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1938" y="-1733.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096] (x2)</text>
<text text-anchor="start" x="1946" y="-1719.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layernorm_2_s1&#45;&gt;attn_res_2_s1 -->
<g id="edge59" class="edge">
<title>layernorm_2_s1&#45;&gt;attn_res_2_s1</title>
<path fill="none" stroke="black" d="M2210.92,-2111.91C2224.39,-2102.37 2236.78,-2090.47 2244.5,-2076 2299.75,-1972.49 2299.5,-1915.64 2244.5,-1812 2238.38,-1800.46 2229.28,-1790.54 2219.04,-1782.15"/>
<polygon fill="black" stroke="black" points="2221.09,-1779.31 2211.01,-1776.03 2216.84,-1784.88 2221.09,-1779.31"/>
</g>
<!-- mha_attn_2_s1 -->
<g id="node38" class="node">
<title>mha_attn_2_s1</title>
<polygon fill="lightblue" stroke="black" points="2231,-1976 1824,-1976 1824,-1912 2231,-1912 2231,-1976"/>
<text text-anchor="start" x="1957.5" y="-1961.8" font-family="Arial" font-weight="bold" font-size="14.00">MHA Attention (TP=8)</text>
<text text-anchor="start" x="1980" y="-1947.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1832" y="-1933.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="start" x="1832" y="-1919.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=512]</text>
</g>
<!-- mha_qkv_2_s1&#45;&gt;mha_attn_2_s1 -->
<g id="edge56" class="edge">
<title>mha_qkv_2_s1&#45;&gt;mha_attn_2_s1</title>
<path fill="none" stroke="black" d="M2026.82,-2011.99C2026.9,-2003.86 2026.99,-1994.96 2027.08,-1986.38"/>
<polygon fill="black" stroke="black" points="2030.58,-1986.18 2027.18,-1976.14 2023.58,-1986.11 2030.58,-1986.18"/>
</g>
<!-- mha_out_2_s1 -->
<g id="node39" class="node">
<title>mha_out_2_s1</title>
<polygon fill="lightblue" stroke="black" points="2236,-1876 1821,-1876 1821,-1812 2236,-1812 2236,-1876"/>
<text text-anchor="start" x="1943" y="-1861.8" font-family="Arial" font-weight="bold" font-size="14.00">MHA Output Linear (TP=8)</text>
<text text-anchor="start" x="1940" y="-1847.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15 (row parallel)</text>
<text text-anchor="start" x="1838.5" y="-1833.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=512]</text>
<text text-anchor="start" x="1829" y="-1819.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha_attn_2_s1&#45;&gt;mha_out_2_s1 -->
<g id="edge57" class="edge">
<title>mha_attn_2_s1&#45;&gt;mha_out_2_s1</title>
<path fill="none" stroke="black" d="M2027.82,-1911.99C2027.9,-1903.86 2027.99,-1894.96 2028.08,-1886.38"/>
<polygon fill="black" stroke="black" points="2031.58,-1886.18 2028.18,-1876.14 2024.58,-1886.11 2031.58,-1886.18"/>
</g>
<!-- mha_out_2_s1&#45;&gt;attn_res_2_s1 -->
<g id="edge58" class="edge">
<title>mha_out_2_s1&#45;&gt;attn_res_2_s1</title>
<path fill="none" stroke="black" d="M2065.52,-1811.99C2076.62,-1802.7 2088.91,-1792.4 2100.46,-1782.72"/>
<polygon fill="black" stroke="black" points="2102.9,-1785.25 2108.32,-1776.14 2098.41,-1779.88 2102.9,-1785.25"/>
</g>
<!-- moe_gating_2_s1 -->
<g id="node41" class="node">
<title>moe_gating_2_s1</title>
<polygon fill="lightgreen" stroke="black" points="1955.2,-1676 1289.14,-1676 1117.8,-1548 1783.86,-1548 1955.2,-1676"/>
<text text-anchor="start" x="1469" y="-1629.8" font-family="Arial" font-weight="bold" font-size="14.00">MoE Gating Network</text>
<text text-anchor="start" x="1489" y="-1615.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1342.5" y="-1601.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1380" y="-1587.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [routing decisions, expert assignments]</text>
</g>
<!-- attn_res_2_s1&#45;&gt;moe_gating_2_s1 -->
<g id="edge60" class="edge">
<title>attn_res_2_s1&#45;&gt;moe_gating_2_s1</title>
<path fill="none" stroke="black" d="M2000.02,-1711.94C1952.14,-1701.72 1896.97,-1689.95 1841.76,-1678.16"/>
<polygon fill="black" stroke="black" points="1842.33,-1674.7 1831.82,-1676.04 1840.87,-1681.55 1842.33,-1674.7"/>
</g>
<!-- moe_res_2_s1 -->
<g id="node51" class="node">
<title>moe_res_2_s1</title>
<polygon fill="lightblue" stroke="black" points="2361,-1220 1930,-1220 1930,-1156 2361,-1156 2361,-1220"/>
<text text-anchor="start" x="2086" y="-1205.8" font-family="Arial" font-weight="bold" font-size="14.00">MoE Residual Add</text>
<text text-anchor="start" x="2098" y="-1191.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1938" y="-1177.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096] (x2)</text>
<text text-anchor="start" x="1946" y="-1163.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- attn_res_2_s1&#45;&gt;moe_res_2_s1 -->
<g id="edge78" class="edge">
<title>attn_res_2_s1&#45;&gt;moe_res_2_s1</title>
<path fill="none" stroke="black" d="M2348.5,-1711.94C2560.55,-1670.23 2848.13,-1581.92 2737.5,-1420 2655.69,-1300.26 2501.81,-1242.58 2371.44,-1214.8"/>
<polygon fill="black" stroke="black" points="2371.8,-1211.3 2361.3,-1212.69 2370.38,-1218.15 2371.8,-1211.3"/>
</g>
<!-- expert_2_gpu8_s1 -->
<g id="node42" class="node">
<title>expert_2_gpu8_s1</title>
<polygon fill="lightblue" stroke="black" points="327,-1512 2,-1512 2,-1420 327,-1420 327,-1512"/>
<text text-anchor="start" x="96.5" y="-1497.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 2)</text>
<text text-anchor="start" x="119" y="-1483.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8</text>
<text text-anchor="start" x="105.5" y="-1469.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 0&#45;1</text>
<text text-anchor="start" x="15.5" y="-1455.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="10" y="-1441.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="78" y="-1427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_2_s1&#45;&gt;expert_2_gpu8_s1 -->
<g id="edge61" class="edge">
<title>moe_gating_2_s1&#45;&gt;expert_2_gpu8_s1</title>
<path fill="none" stroke="black" d="M1184.99,-1598.25C947.28,-1585.71 626.65,-1561.19 337.55,-1512.28"/>
<polygon fill="black" stroke="black" points="337.72,-1508.76 327.28,-1510.53 336.55,-1515.66 337.72,-1508.76"/>
</g>
<!-- expert_2_gpu9_s1 -->
<g id="node43" class="node">
<title>expert_2_gpu9_s1</title>
<polygon fill="lightblue" stroke="black" points="670,-1512 345,-1512 345,-1420 670,-1420 670,-1512"/>
<text text-anchor="start" x="439.5" y="-1497.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 2)</text>
<text text-anchor="start" x="462" y="-1483.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 9</text>
<text text-anchor="start" x="448.5" y="-1469.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 2&#45;3</text>
<text text-anchor="start" x="358.5" y="-1455.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="353" y="-1441.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="421" y="-1427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_2_s1&#45;&gt;expert_2_gpu9_s1 -->
<g id="edge63" class="edge">
<title>moe_gating_2_s1&#45;&gt;expert_2_gpu9_s1</title>
<path fill="none" stroke="black" d="M1159.4,-1579.21C1012.14,-1563.81 842.02,-1542.35 680.44,-1512.31"/>
<polygon fill="black" stroke="black" points="680.77,-1508.81 670.3,-1510.41 679.48,-1515.69 680.77,-1508.81"/>
</g>
<!-- expert_2_gpu10_s1 -->
<g id="node44" class="node">
<title>expert_2_gpu10_s1</title>
<polygon fill="lightblue" stroke="black" points="1013,-1512 688,-1512 688,-1420 1013,-1420 1013,-1512"/>
<text text-anchor="start" x="782.5" y="-1497.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 2)</text>
<text text-anchor="start" x="801.5" y="-1483.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 10</text>
<text text-anchor="start" x="791.5" y="-1469.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 4&#45;5</text>
<text text-anchor="start" x="701.5" y="-1455.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="696" y="-1441.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="764" y="-1427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_2_s1&#45;&gt;expert_2_gpu10_s1 -->
<g id="edge65" class="edge">
<title>moe_gating_2_s1&#45;&gt;expert_2_gpu10_s1</title>
<path fill="none" stroke="black" d="M1191.28,-1547.97C1137.42,-1537.23 1082.35,-1525.73 1023.26,-1512.37"/>
<polygon fill="black" stroke="black" points="1023.88,-1508.93 1013.36,-1510.13 1022.33,-1515.75 1023.88,-1508.93"/>
</g>
<!-- expert_2_gpu11_s1 -->
<g id="node45" class="node">
<title>expert_2_gpu11_s1</title>
<polygon fill="lightblue" stroke="black" points="1356,-1512 1031,-1512 1031,-1420 1356,-1420 1356,-1512"/>
<text text-anchor="start" x="1125.5" y="-1497.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 2)</text>
<text text-anchor="start" x="1144.5" y="-1483.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 11</text>
<text text-anchor="start" x="1134.5" y="-1469.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 6&#45;7</text>
<text text-anchor="start" x="1044.5" y="-1455.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1039" y="-1441.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1107" y="-1427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_2_s1&#45;&gt;expert_2_gpu11_s1 -->
<g id="edge67" class="edge">
<title>moe_gating_2_s1&#45;&gt;expert_2_gpu11_s1</title>
<path fill="none" stroke="black" d="M1386.06,-1547.84C1360.6,-1537.15 1334.51,-1526.2 1310.09,-1515.95"/>
<polygon fill="black" stroke="black" points="1311.39,-1512.7 1300.81,-1512.05 1308.68,-1519.15 1311.39,-1512.7"/>
</g>
<!-- expert_2_gpu12_s1 -->
<g id="node46" class="node">
<title>expert_2_gpu12_s1</title>
<polygon fill="lightblue" stroke="black" points="1699,-1512 1374,-1512 1374,-1420 1699,-1420 1699,-1512"/>
<text text-anchor="start" x="1468.5" y="-1497.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 2)</text>
<text text-anchor="start" x="1487.5" y="-1483.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 12</text>
<text text-anchor="start" x="1477.5" y="-1469.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 8&#45;9</text>
<text text-anchor="start" x="1387.5" y="-1455.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1382" y="-1441.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1450" y="-1427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_2_s1&#45;&gt;expert_2_gpu12_s1 -->
<g id="edge69" class="edge">
<title>moe_gating_2_s1&#45;&gt;expert_2_gpu12_s1</title>
<path fill="none" stroke="black" d="M1536.5,-1547.84C1536.5,-1539.44 1536.5,-1530.89 1536.5,-1522.63"/>
<polygon fill="black" stroke="black" points="1540,-1522.37 1536.5,-1512.37 1533,-1522.37 1540,-1522.37"/>
</g>
<!-- expert_2_gpu13_s1 -->
<g id="node47" class="node">
<title>expert_2_gpu13_s1</title>
<polygon fill="lightblue" stroke="black" points="2042,-1512 1717,-1512 1717,-1420 2042,-1420 2042,-1512"/>
<text text-anchor="start" x="1811.5" y="-1497.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 2)</text>
<text text-anchor="start" x="1830.5" y="-1483.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 13</text>
<text text-anchor="start" x="1813" y="-1469.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 10&#45;11</text>
<text text-anchor="start" x="1730.5" y="-1455.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1725" y="-1441.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1793" y="-1427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_2_s1&#45;&gt;expert_2_gpu13_s1 -->
<g id="edge71" class="edge">
<title>moe_gating_2_s1&#45;&gt;expert_2_gpu13_s1</title>
<path fill="none" stroke="black" d="M1686.94,-1547.84C1712.4,-1537.15 1738.49,-1526.2 1762.91,-1515.95"/>
<polygon fill="black" stroke="black" points="1764.32,-1519.15 1772.19,-1512.05 1761.61,-1512.7 1764.32,-1519.15"/>
</g>
<!-- expert_2_gpu14_s1 -->
<g id="node48" class="node">
<title>expert_2_gpu14_s1</title>
<polygon fill="lightblue" stroke="black" points="2385,-1512 2060,-1512 2060,-1420 2385,-1420 2385,-1512"/>
<text text-anchor="start" x="2154.5" y="-1497.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 2)</text>
<text text-anchor="start" x="2173.5" y="-1483.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 14</text>
<text text-anchor="start" x="2156" y="-1469.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 12&#45;13</text>
<text text-anchor="start" x="2073.5" y="-1455.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2068" y="-1441.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2136" y="-1427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_2_s1&#45;&gt;expert_2_gpu14_s1 -->
<g id="edge73" class="edge">
<title>moe_gating_2_s1&#45;&gt;expert_2_gpu14_s1</title>
<path fill="none" stroke="black" d="M1803.97,-1562.93C1880.58,-1548.27 1964.28,-1531.4 2049.72,-1512.14"/>
<polygon fill="black" stroke="black" points="2050.62,-1515.53 2059.61,-1509.91 2049.08,-1508.7 2050.62,-1515.53"/>
</g>
<!-- expert_2_gpu15_s1 -->
<g id="node49" class="node">
<title>expert_2_gpu15_s1</title>
<polygon fill="lightblue" stroke="black" points="2728,-1512 2403,-1512 2403,-1420 2728,-1420 2728,-1512"/>
<text text-anchor="start" x="2497.5" y="-1497.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 2)</text>
<text text-anchor="start" x="2516.5" y="-1483.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 15</text>
<text text-anchor="start" x="2499" y="-1469.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 14&#45;15</text>
<text text-anchor="start" x="2416.5" y="-1455.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2411" y="-1441.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2479" y="-1427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_2_s1&#45;&gt;expert_2_gpu15_s1 -->
<g id="edge75" class="edge">
<title>moe_gating_2_s1&#45;&gt;expert_2_gpu15_s1</title>
<path fill="none" stroke="black" d="M1836.01,-1586.83C1998.45,-1571.16 2202.57,-1547.32 2392.76,-1512.07"/>
<polygon fill="black" stroke="black" points="2393.48,-1515.5 2402.67,-1510.22 2392.2,-1508.62 2393.48,-1515.5"/>
</g>
<!-- expert_agg_2_s1 -->
<g id="node50" class="node">
<title>expert_agg_2_s1</title>
<polygon fill="lightgreen" stroke="black" points="1966.51,-1384 1282.46,-1384 1106.49,-1256 1790.54,-1256 1966.51,-1384"/>
<text text-anchor="start" x="1449.5" y="-1337.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="start" x="1489" y="-1323.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1407" y="-1309.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [expert outputs from 16 experts]</text>
<text text-anchor="start" x="1337" y="-1295.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert_2_gpu8_s1&#45;&gt;expert_agg_2_s1 -->
<g id="edge62" class="edge">
<title>expert_2_gpu8_s1&#45;&gt;expert_agg_2_s1</title>
<path fill="none" stroke="black" d="M327.28,-1421.47C330.03,-1420.96 332.78,-1420.47 335.5,-1420 625.45,-1370.29 959.22,-1345.32 1201.19,-1332.91"/>
<polygon fill="black" stroke="black" points="1201.39,-1336.41 1211.2,-1332.4 1201.04,-1329.41 1201.39,-1336.41"/>
</g>
<!-- expert_2_gpu9_s1&#45;&gt;expert_agg_2_s1 -->
<g id="edge64" class="edge">
<title>expert_2_gpu9_s1&#45;&gt;expert_agg_2_s1</title>
<path fill="none" stroke="black" d="M670.3,-1421.59C673.05,-1421.04 675.78,-1420.51 678.5,-1420 856.21,-1386.54 1056.9,-1362.63 1219.48,-1346.71"/>
<polygon fill="black" stroke="black" points="1220.03,-1350.17 1229.64,-1345.72 1219.35,-1343.2 1220.03,-1350.17"/>
</g>
<!-- expert_2_gpu10_s1&#45;&gt;expert_agg_2_s1 -->
<g id="edge66" class="edge">
<title>expert_2_gpu10_s1&#45;&gt;expert_agg_2_s1</title>
<path fill="none" stroke="black" d="M1013.36,-1421.87C1016.09,-1421.24 1018.81,-1420.61 1021.5,-1420 1096.27,-1403 1177.58,-1386.47 1253.04,-1371.94"/>
<polygon fill="black" stroke="black" points="1254,-1375.32 1263.16,-1369.99 1252.68,-1368.44 1254,-1375.32"/>
</g>
<!-- expert_2_gpu11_s1&#45;&gt;expert_agg_2_s1 -->
<g id="edge68" class="edge">
<title>expert_2_gpu11_s1&#45;&gt;expert_agg_2_s1</title>
<path fill="none" stroke="black" d="M1301.09,-1419.83C1325.15,-1409.73 1351.16,-1398.81 1376.83,-1388.03"/>
<polygon fill="black" stroke="black" points="1378.4,-1391.17 1386.26,-1384.07 1375.69,-1384.72 1378.4,-1391.17"/>
</g>
<!-- expert_2_gpu12_s1&#45;&gt;expert_agg_2_s1 -->
<g id="edge70" class="edge">
<title>expert_2_gpu12_s1&#45;&gt;expert_agg_2_s1</title>
<path fill="none" stroke="black" d="M1536.5,-1419.83C1536.5,-1411.71 1536.5,-1403.06 1536.5,-1394.38"/>
<polygon fill="black" stroke="black" points="1540,-1394.21 1536.5,-1384.21 1533,-1394.21 1540,-1394.21"/>
</g>
<!-- expert_2_gpu13_s1&#45;&gt;expert_agg_2_s1 -->
<g id="edge72" class="edge">
<title>expert_2_gpu13_s1&#45;&gt;expert_agg_2_s1</title>
<path fill="none" stroke="black" d="M1771.91,-1419.83C1747.85,-1409.73 1721.84,-1398.81 1696.17,-1388.03"/>
<polygon fill="black" stroke="black" points="1697.31,-1384.72 1686.74,-1384.07 1694.6,-1391.17 1697.31,-1384.72"/>
</g>
<!-- expert_2_gpu14_s1&#45;&gt;expert_agg_2_s1 -->
<g id="edge74" class="edge">
<title>expert_2_gpu14_s1&#45;&gt;expert_agg_2_s1</title>
<path fill="none" stroke="black" d="M2059.61,-1422.09C2056.55,-1421.38 2053.51,-1420.68 2050.5,-1420 1998.98,-1408.31 1944.36,-1396.83 1890.69,-1386.06"/>
<polygon fill="black" stroke="black" points="1891.18,-1382.58 1880.68,-1384.05 1889.8,-1389.45 1891.18,-1382.58"/>
</g>
<!-- expert_2_gpu15_s1&#45;&gt;expert_agg_2_s1 -->
<g id="edge76" class="edge">
<title>expert_2_gpu15_s1&#45;&gt;expert_agg_2_s1</title>
<path fill="none" stroke="black" d="M2402.67,-1421.78C2399.59,-1421.16 2396.53,-1420.57 2393.5,-1420 2245.01,-1392.14 2080.49,-1370.87 1935.62,-1355.31"/>
<polygon fill="black" stroke="black" points="1935.98,-1351.83 1925.66,-1354.25 1935.23,-1358.79 1935.98,-1351.83"/>
</g>
<!-- expert_agg_2_s1&#45;&gt;moe_res_2_s1 -->
<g id="edge77" class="edge">
<title>expert_agg_2_s1&#45;&gt;moe_res_2_s1</title>
<path fill="none" stroke="black" d="M1800.07,-1262.74C1864.95,-1248.89 1932.36,-1234.5 1990.21,-1222.15"/>
<polygon fill="black" stroke="black" points="1991.11,-1225.54 2000.16,-1220.03 1989.65,-1218.69 1991.11,-1225.54"/>
</g>
<!-- layernorm_3_s1 -->
<g id="node52" class="node">
<title>layernorm_3_s1</title>
<polygon fill="lightblue" stroke="black" points="2353,-1120 1938,-1120 1938,-1056 2353,-1056 2353,-1120"/>
<text text-anchor="start" x="2079" y="-1105.8" font-family="Arial" font-weight="bold" font-size="14.00">LayerNorm (Layer 3)</text>
<text text-anchor="start" x="2098" y="-1091.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1951.5" y="-1077.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1946" y="-1063.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- moe_res_2_s1&#45;&gt;layernorm_3_s1 -->
<g id="edge79" class="edge">
<title>moe_res_2_s1&#45;&gt;layernorm_3_s1</title>
<path fill="none" stroke="black" d="M2145.5,-1155.99C2145.5,-1147.86 2145.5,-1138.96 2145.5,-1130.38"/>
<polygon fill="black" stroke="black" points="2149,-1130.14 2145.5,-1120.14 2142,-1130.14 2149,-1130.14"/>
</g>
<!-- mha_qkv_3_s1 -->
<g id="node53" class="node">
<title>mha_qkv_3_s1</title>
<polygon fill="lightblue" stroke="black" points="2237,-1020 1818,-1020 1818,-956 2237,-956 2237,-1020"/>
<text text-anchor="start" x="1949.5" y="-1005.8" font-family="Arial" font-weight="bold" font-size="14.00">MHA QKV Linear (TP=8)</text>
<text text-anchor="start" x="1928" y="-991.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15 (column parallel)</text>
<text text-anchor="start" x="1833.5" y="-977.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1826" y="-963.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, heads=4, d_k=128]</text>
</g>
<!-- layernorm_3_s1&#45;&gt;mha_qkv_3_s1 -->
<g id="edge80" class="edge">
<title>layernorm_3_s1&#45;&gt;mha_qkv_3_s1</title>
<path fill="none" stroke="black" d="M2108.16,-1055.99C2096.97,-1046.7 2084.57,-1036.4 2072.92,-1026.72"/>
<polygon fill="black" stroke="black" points="2074.93,-1023.84 2065,-1020.14 2070.45,-1029.22 2074.93,-1023.84"/>
</g>
<!-- attn_res_3_s1 -->
<g id="node56" class="node">
<title>attn_res_3_s1</title>
<polygon fill="lightblue" stroke="black" points="2362,-720 1931,-720 1931,-656 2362,-656 2362,-720"/>
<text text-anchor="start" x="2072" y="-705.8" font-family="Arial" font-weight="bold" font-size="14.00">Attention Residual Add</text>
<text text-anchor="start" x="2099" y="-691.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1939" y="-677.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096] (x2)</text>
<text text-anchor="start" x="1947" y="-663.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layernorm_3_s1&#45;&gt;attn_res_3_s1 -->
<g id="edge84" class="edge">
<title>layernorm_3_s1&#45;&gt;attn_res_3_s1</title>
<path fill="none" stroke="black" d="M2211.92,-1055.91C2225.39,-1046.37 2237.78,-1034.47 2245.5,-1020 2300.75,-916.49 2300.5,-859.64 2245.5,-756 2239.38,-744.46 2230.28,-734.54 2220.04,-726.15"/>
<polygon fill="black" stroke="black" points="2222.09,-723.31 2212.01,-720.03 2217.84,-728.88 2222.09,-723.31"/>
</g>
<!-- mha_attn_3_s1 -->
<g id="node54" class="node">
<title>mha_attn_3_s1</title>
<polygon fill="lightblue" stroke="black" points="2232,-920 1825,-920 1825,-856 2232,-856 2232,-920"/>
<text text-anchor="start" x="1958.5" y="-905.8" font-family="Arial" font-weight="bold" font-size="14.00">MHA Attention (TP=8)</text>
<text text-anchor="start" x="1981" y="-891.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1833" y="-877.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="start" x="1833" y="-863.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=512]</text>
</g>
<!-- mha_qkv_3_s1&#45;&gt;mha_attn_3_s1 -->
<g id="edge81" class="edge">
<title>mha_qkv_3_s1&#45;&gt;mha_attn_3_s1</title>
<path fill="none" stroke="black" d="M2027.82,-955.99C2027.9,-947.86 2027.99,-938.96 2028.08,-930.38"/>
<polygon fill="black" stroke="black" points="2031.58,-930.18 2028.18,-920.14 2024.58,-930.11 2031.58,-930.18"/>
</g>
<!-- mha_out_3_s1 -->
<g id="node55" class="node">
<title>mha_out_3_s1</title>
<polygon fill="lightblue" stroke="black" points="2237,-820 1822,-820 1822,-756 2237,-756 2237,-820"/>
<text text-anchor="start" x="1944" y="-805.8" font-family="Arial" font-weight="bold" font-size="14.00">MHA Output Linear (TP=8)</text>
<text text-anchor="start" x="1941" y="-791.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15 (row parallel)</text>
<text text-anchor="start" x="1839.5" y="-777.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=512]</text>
<text text-anchor="start" x="1830" y="-763.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha_attn_3_s1&#45;&gt;mha_out_3_s1 -->
<g id="edge82" class="edge">
<title>mha_attn_3_s1&#45;&gt;mha_out_3_s1</title>
<path fill="none" stroke="black" d="M2028.82,-855.99C2028.9,-847.86 2028.99,-838.96 2029.08,-830.38"/>
<polygon fill="black" stroke="black" points="2032.58,-830.18 2029.18,-820.14 2025.58,-830.11 2032.58,-830.18"/>
</g>
<!-- mha_out_3_s1&#45;&gt;attn_res_3_s1 -->
<g id="edge83" class="edge">
<title>mha_out_3_s1&#45;&gt;attn_res_3_s1</title>
<path fill="none" stroke="black" d="M2066.52,-755.99C2077.62,-746.7 2089.91,-736.4 2101.46,-726.72"/>
<polygon fill="black" stroke="black" points="2103.9,-729.25 2109.32,-720.14 2099.41,-723.88 2103.9,-729.25"/>
</g>
<!-- moe_gating_3_s1 -->
<g id="node57" class="node">
<title>moe_gating_3_s1</title>
<polygon fill="lightgreen" stroke="black" points="1956.2,-620 1290.14,-620 1118.8,-492 1784.86,-492 1956.2,-620"/>
<text text-anchor="start" x="1470" y="-573.8" font-family="Arial" font-weight="bold" font-size="14.00">MoE Gating Network</text>
<text text-anchor="start" x="1490" y="-559.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1343.5" y="-545.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="start" x="1381" y="-531.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [routing decisions, expert assignments]</text>
</g>
<!-- attn_res_3_s1&#45;&gt;moe_gating_3_s1 -->
<g id="edge85" class="edge">
<title>attn_res_3_s1&#45;&gt;moe_gating_3_s1</title>
<path fill="none" stroke="black" d="M2001.02,-655.94C1953.14,-645.72 1897.97,-633.95 1842.76,-622.16"/>
<polygon fill="black" stroke="black" points="1843.33,-618.7 1832.82,-620.04 1841.87,-625.55 1843.33,-618.7"/>
</g>
<!-- moe_res_3_s1 -->
<g id="node67" class="node">
<title>moe_res_3_s1</title>
<polygon fill="lightblue" stroke="black" points="2362,-164 1931,-164 1931,-100 2362,-100 2362,-164"/>
<text text-anchor="start" x="2087" y="-149.8" font-family="Arial" font-weight="bold" font-size="14.00">MoE Residual Add</text>
<text text-anchor="start" x="2099" y="-135.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1939" y="-121.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [batch_size=128, seq_len=10000, hidden_dim=4096] (x2)</text>
<text text-anchor="start" x="1947" y="-107.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- attn_res_3_s1&#45;&gt;moe_res_3_s1 -->
<g id="edge103" class="edge">
<title>attn_res_3_s1&#45;&gt;moe_res_3_s1</title>
<path fill="none" stroke="black" d="M2362.3,-663.31C2494.74,-636.38 2654.56,-578.86 2738.5,-456 2847.4,-296.61 2570.44,-208.54 2359.49,-166.05"/>
<polygon fill="black" stroke="black" points="2359.99,-162.58 2349.5,-164.06 2358.62,-169.45 2359.99,-162.58"/>
</g>
<!-- expert_3_gpu8_s1 -->
<g id="node58" class="node">
<title>expert_3_gpu8_s1</title>
<polygon fill="lightblue" stroke="black" points="328,-456 3,-456 3,-364 328,-364 328,-456"/>
<text text-anchor="start" x="97.5" y="-441.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 3)</text>
<text text-anchor="start" x="120" y="-427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8</text>
<text text-anchor="start" x="106.5" y="-413.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 0&#45;1</text>
<text text-anchor="start" x="16.5" y="-399.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="11" y="-385.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="79" y="-371.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_3_s1&#45;&gt;expert_3_gpu8_s1 -->
<g id="edge86" class="edge">
<title>moe_gating_3_s1&#45;&gt;expert_3_gpu8_s1</title>
<path fill="none" stroke="black" d="M1185.99,-542.25C948.28,-529.71 627.65,-505.19 338.55,-456.28"/>
<polygon fill="black" stroke="black" points="338.72,-452.76 328.28,-454.53 337.55,-459.66 338.72,-452.76"/>
</g>
<!-- expert_3_gpu9_s1 -->
<g id="node59" class="node">
<title>expert_3_gpu9_s1</title>
<polygon fill="lightblue" stroke="black" points="671,-456 346,-456 346,-364 671,-364 671,-456"/>
<text text-anchor="start" x="440.5" y="-441.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 3)</text>
<text text-anchor="start" x="463" y="-427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 9</text>
<text text-anchor="start" x="449.5" y="-413.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 2&#45;3</text>
<text text-anchor="start" x="359.5" y="-399.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="354" y="-385.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="422" y="-371.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_3_s1&#45;&gt;expert_3_gpu9_s1 -->
<g id="edge88" class="edge">
<title>moe_gating_3_s1&#45;&gt;expert_3_gpu9_s1</title>
<path fill="none" stroke="black" d="M1160.4,-523.21C1013.14,-507.81 843.02,-486.35 681.44,-456.31"/>
<polygon fill="black" stroke="black" points="681.77,-452.81 671.3,-454.41 680.48,-459.69 681.77,-452.81"/>
</g>
<!-- expert_3_gpu10_s1 -->
<g id="node60" class="node">
<title>expert_3_gpu10_s1</title>
<polygon fill="lightblue" stroke="black" points="1014,-456 689,-456 689,-364 1014,-364 1014,-456"/>
<text text-anchor="start" x="783.5" y="-441.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 3)</text>
<text text-anchor="start" x="802.5" y="-427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 10</text>
<text text-anchor="start" x="792.5" y="-413.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 4&#45;5</text>
<text text-anchor="start" x="702.5" y="-399.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="697" y="-385.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="765" y="-371.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_3_s1&#45;&gt;expert_3_gpu10_s1 -->
<g id="edge90" class="edge">
<title>moe_gating_3_s1&#45;&gt;expert_3_gpu10_s1</title>
<path fill="none" stroke="black" d="M1192.28,-491.97C1138.42,-481.23 1083.35,-469.73 1024.26,-456.37"/>
<polygon fill="black" stroke="black" points="1024.88,-452.93 1014.36,-454.13 1023.33,-459.75 1024.88,-452.93"/>
</g>
<!-- expert_3_gpu11_s1 -->
<g id="node61" class="node">
<title>expert_3_gpu11_s1</title>
<polygon fill="lightblue" stroke="black" points="1357,-456 1032,-456 1032,-364 1357,-364 1357,-456"/>
<text text-anchor="start" x="1126.5" y="-441.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 3)</text>
<text text-anchor="start" x="1145.5" y="-427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 11</text>
<text text-anchor="start" x="1135.5" y="-413.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 6&#45;7</text>
<text text-anchor="start" x="1045.5" y="-399.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1040" y="-385.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1108" y="-371.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_3_s1&#45;&gt;expert_3_gpu11_s1 -->
<g id="edge92" class="edge">
<title>moe_gating_3_s1&#45;&gt;expert_3_gpu11_s1</title>
<path fill="none" stroke="black" d="M1387.06,-491.84C1361.6,-481.15 1335.51,-470.2 1311.09,-459.95"/>
<polygon fill="black" stroke="black" points="1312.39,-456.7 1301.81,-456.05 1309.68,-463.15 1312.39,-456.7"/>
</g>
<!-- expert_3_gpu12_s1 -->
<g id="node62" class="node">
<title>expert_3_gpu12_s1</title>
<polygon fill="lightblue" stroke="black" points="1700,-456 1375,-456 1375,-364 1700,-364 1700,-456"/>
<text text-anchor="start" x="1469.5" y="-441.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 3)</text>
<text text-anchor="start" x="1488.5" y="-427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 12</text>
<text text-anchor="start" x="1478.5" y="-413.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 8&#45;9</text>
<text text-anchor="start" x="1388.5" y="-399.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1383" y="-385.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1451" y="-371.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_3_s1&#45;&gt;expert_3_gpu12_s1 -->
<g id="edge94" class="edge">
<title>moe_gating_3_s1&#45;&gt;expert_3_gpu12_s1</title>
<path fill="none" stroke="black" d="M1537.5,-491.84C1537.5,-483.44 1537.5,-474.89 1537.5,-466.63"/>
<polygon fill="black" stroke="black" points="1541,-466.37 1537.5,-456.37 1534,-466.37 1541,-466.37"/>
</g>
<!-- expert_3_gpu13_s1 -->
<g id="node63" class="node">
<title>expert_3_gpu13_s1</title>
<polygon fill="lightblue" stroke="black" points="2043,-456 1718,-456 1718,-364 2043,-364 2043,-456"/>
<text text-anchor="start" x="1812.5" y="-441.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 3)</text>
<text text-anchor="start" x="1831.5" y="-427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 13</text>
<text text-anchor="start" x="1814" y="-413.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 10&#45;11</text>
<text text-anchor="start" x="1731.5" y="-399.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1726" y="-385.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="1794" y="-371.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_3_s1&#45;&gt;expert_3_gpu13_s1 -->
<g id="edge96" class="edge">
<title>moe_gating_3_s1&#45;&gt;expert_3_gpu13_s1</title>
<path fill="none" stroke="black" d="M1687.94,-491.84C1713.4,-481.15 1739.49,-470.2 1763.91,-459.95"/>
<polygon fill="black" stroke="black" points="1765.32,-463.15 1773.19,-456.05 1762.61,-456.7 1765.32,-463.15"/>
</g>
<!-- expert_3_gpu14_s1 -->
<g id="node64" class="node">
<title>expert_3_gpu14_s1</title>
<polygon fill="lightblue" stroke="black" points="2386,-456 2061,-456 2061,-364 2386,-364 2386,-456"/>
<text text-anchor="start" x="2155.5" y="-441.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 3)</text>
<text text-anchor="start" x="2174.5" y="-427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 14</text>
<text text-anchor="start" x="2157" y="-413.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 12&#45;13</text>
<text text-anchor="start" x="2074.5" y="-399.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2069" y="-385.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2137" y="-371.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_3_s1&#45;&gt;expert_3_gpu14_s1 -->
<g id="edge98" class="edge">
<title>moe_gating_3_s1&#45;&gt;expert_3_gpu14_s1</title>
<path fill="none" stroke="black" d="M1804.97,-506.93C1881.58,-492.27 1965.28,-475.4 2050.72,-456.14"/>
<polygon fill="black" stroke="black" points="2051.62,-459.53 2060.61,-453.91 2050.08,-452.7 2051.62,-459.53"/>
</g>
<!-- expert_3_gpu15_s1 -->
<g id="node65" class="node">
<title>expert_3_gpu15_s1</title>
<polygon fill="lightblue" stroke="black" points="2729,-456 2404,-456 2404,-364 2729,-364 2729,-456"/>
<text text-anchor="start" x="2498.5" y="-441.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert MLP (Layer 3)</text>
<text text-anchor="start" x="2517.5" y="-427.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 15</text>
<text text-anchor="start" x="2500" y="-413.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Experts: 14&#45;15</text>
<text text-anchor="start" x="2417.5" y="-399.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2412" y="-385.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [variable tokens, hidden_dim=4096]</text>
<text text-anchor="start" x="2480" y="-371.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Params: 512MB total</text>
</g>
<!-- moe_gating_3_s1&#45;&gt;expert_3_gpu15_s1 -->
<g id="edge100" class="edge">
<title>moe_gating_3_s1&#45;&gt;expert_3_gpu15_s1</title>
<path fill="none" stroke="black" d="M1837.01,-530.83C1999.45,-515.16 2203.57,-491.32 2393.76,-456.07"/>
<polygon fill="black" stroke="black" points="2394.48,-459.5 2403.67,-454.22 2393.2,-452.62 2394.48,-459.5"/>
</g>
<!-- expert_agg_3_s1 -->
<g id="node66" class="node">
<title>expert_agg_3_s1</title>
<polygon fill="lightgreen" stroke="black" points="1967.51,-328 1283.46,-328 1107.49,-200 1791.54,-200 1967.51,-328"/>
<text text-anchor="start" x="1450.5" y="-281.8" font-family="Arial" font-weight="bold" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="start" x="1490" y="-267.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;GPU: 8&#45;15</text>
<text text-anchor="start" x="1408" y="-253.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Input: [expert outputs from 16 experts]</text>
<text text-anchor="start" x="1338" y="-239.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert_3_gpu8_s1&#45;&gt;expert_agg_3_s1 -->
<g id="edge87" class="edge">
<title>expert_3_gpu8_s1&#45;&gt;expert_agg_3_s1</title>
<path fill="none" stroke="black" d="M328.28,-365.47C331.03,-364.96 333.78,-364.47 336.5,-364 626.45,-314.29 960.22,-289.32 1202.19,-276.91"/>
<polygon fill="black" stroke="black" points="1202.39,-280.41 1212.2,-276.4 1202.04,-273.41 1202.39,-280.41"/>
</g>
<!-- expert_3_gpu9_s1&#45;&gt;expert_agg_3_s1 -->
<g id="edge89" class="edge">
<title>expert_3_gpu9_s1&#45;&gt;expert_agg_3_s1</title>
<path fill="none" stroke="black" d="M671.3,-365.59C674.05,-365.04 676.78,-364.51 679.5,-364 857.21,-330.54 1057.9,-306.63 1220.48,-290.71"/>
<polygon fill="black" stroke="black" points="1221.03,-294.17 1230.64,-289.72 1220.35,-287.2 1221.03,-294.17"/>
</g>
<!-- expert_3_gpu10_s1&#45;&gt;expert_agg_3_s1 -->
<g id="edge91" class="edge">
<title>expert_3_gpu10_s1&#45;&gt;expert_agg_3_s1</title>
<path fill="none" stroke="black" d="M1014.36,-365.87C1017.09,-365.24 1019.81,-364.61 1022.5,-364 1097.27,-347 1178.58,-330.47 1254.04,-315.94"/>
<polygon fill="black" stroke="black" points="1255,-319.32 1264.16,-313.99 1253.68,-312.44 1255,-319.32"/>
</g>
<!-- expert_3_gpu11_s1&#45;&gt;expert_agg_3_s1 -->
<g id="edge93" class="edge">
<title>expert_3_gpu11_s1&#45;&gt;expert_agg_3_s1</title>
<path fill="none" stroke="black" d="M1302.09,-363.83C1326.15,-353.73 1352.16,-342.81 1377.83,-332.03"/>
<polygon fill="black" stroke="black" points="1379.4,-335.17 1387.26,-328.07 1376.69,-328.72 1379.4,-335.17"/>
</g>
<!-- expert_3_gpu12_s1&#45;&gt;expert_agg_3_s1 -->
<g id="edge95" class="edge">
<title>expert_3_gpu12_s1&#45;&gt;expert_agg_3_s1</title>
<path fill="none" stroke="black" d="M1537.5,-363.83C1537.5,-355.71 1537.5,-347.06 1537.5,-338.38"/>
<polygon fill="black" stroke="black" points="1541,-338.21 1537.5,-328.21 1534,-338.21 1541,-338.21"/>
</g>
<!-- expert_3_gpu13_s1&#45;&gt;expert_agg_3_s1 -->
<g id="edge97" class="edge">
<title>expert_3_gpu13_s1&#45;&gt;expert_agg_3_s1</title>
<path fill="none" stroke="black" d="M1772.91,-363.83C1748.85,-353.73 1722.84,-342.81 1697.17,-332.03"/>
<polygon fill="black" stroke="black" points="1698.31,-328.72 1687.74,-328.07 1695.6,-335.17 1698.31,-328.72"/>
</g>
<!-- expert_3_gpu14_s1&#45;&gt;expert_agg_3_s1 -->
<g id="edge99" class="edge">
<title>expert_3_gpu14_s1&#45;&gt;expert_agg_3_s1</title>
<path fill="none" stroke="black" d="M2060.61,-366.09C2057.55,-365.38 2054.51,-364.68 2051.5,-364 1999.98,-352.31 1945.36,-340.83 1891.69,-330.06"/>
<polygon fill="black" stroke="black" points="1892.18,-326.58 1881.68,-328.05 1890.8,-333.45 1892.18,-326.58"/>
</g>
<!-- expert_3_gpu15_s1&#45;&gt;expert_agg_3_s1 -->
<g id="edge101" class="edge">
<title>expert_3_gpu15_s1&#45;&gt;expert_agg_3_s1</title>
<path fill="none" stroke="black" d="M2403.67,-365.78C2400.59,-365.16 2397.53,-364.57 2394.5,-364 2246.01,-336.14 2081.49,-314.87 1936.62,-299.31"/>
<polygon fill="black" stroke="black" points="1936.98,-295.83 1926.66,-298.25 1936.23,-302.79 1936.98,-295.83"/>
</g>
<!-- expert_agg_3_s1&#45;&gt;moe_res_3_s1 -->
<g id="edge102" class="edge">
<title>expert_agg_3_s1&#45;&gt;moe_res_3_s1</title>
<path fill="none" stroke="black" d="M1801.07,-206.74C1865.95,-192.89 1933.36,-178.5 1991.21,-166.15"/>
<polygon fill="black" stroke="black" points="1992.11,-169.54 2001.16,-164.03 1990.65,-162.69 1992.11,-169.54"/>
</g>
<!-- output -->
<g id="node68" class="node">
<title>output</title>
<text text-anchor="start" x="2102" y="-49.8" font-family="Arial" font-weight="bold" font-size="14.00">Model Output</text>
<text text-anchor="start" x="2091.5" y="-35.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Batch Size: 128</text>
<text text-anchor="start" x="2063.5" y="-21.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Sequence Length: 10000</text>
<text text-anchor="start" x="2084.5" y="-7.8" font-family="Arial" font-size="14.00"> &#160;&#160;&#160;Hidden Dim: 4096</text>
</g>
<!-- moe_res_3_s1&#45;&gt;output -->
<g id="edge104" class="edge">
<title>moe_res_3_s1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2146.5,-99.99C2146.5,-91.86 2146.5,-82.96 2146.5,-74.38"/>
<polygon fill="black" stroke="black" points="2150,-74.14 2146.5,-64.14 2143,-74.14 2150,-74.14"/>
</g>
</g>
</svg>
