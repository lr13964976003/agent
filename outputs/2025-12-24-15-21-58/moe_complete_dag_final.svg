<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Complete_DAG Pages: 1 -->
<svg width="3707pt" height="3551pt"
 viewBox="0.00 0.00 3707.00 3550.76" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3546.76)">
<title>MoE_Complete_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3546.76 3703,-3546.76 3703,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline0</title>
<polygon fill="lightgrey" stroke="black" points="8,-1757.86 8,-3171.78 1397,-3171.78 1397,-1757.86 8,-1757.86"/>
<text text-anchor="middle" x="702.5" y="-3158.18" font-family="Arial" font-size="12.00">Prefill: Pipeline Stage 0 (Layers 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu0_prefill</title>
<polygon fill="lightcyan" stroke="black" points="647,-2039.85 647,-3142.78 1389,-3142.78 1389,-2039.85 647,-2039.85"/>
<text text-anchor="middle" x="1018" y="-3129.18" font-family="Arial" font-size="12.00">GPU 0 (TP0, PP0, EP0)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu1_prefill</title>
<polygon fill="lightcyan" stroke="black" points="16,-1765.86 16,-3142.78 639,-3142.78 639,-1765.86 16,-1765.86"/>
<text text-anchor="middle" x="327.5" y="-3129.18" font-family="Arial" font-size="12.00">GPU 1 (TP1, PP0, EP1)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_pipeline1</title>
<polygon fill="lightgrey" stroke="black" points="8,-199.47 8,-1740.86 1397,-1740.86 1397,-199.47 8,-199.47"/>
<text text-anchor="middle" x="702.5" y="-1727.26" font-family="Arial" font-size="12.00">Prefill: Pipeline Stage 1 (Layers 8&#45;15)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu2_prefill</title>
<polygon fill="lightcyan" stroke="black" points="647,-445.47 647,-1711.86 1389,-1711.86 1389,-445.47 647,-445.47"/>
<text text-anchor="middle" x="1018" y="-1698.26" font-family="Arial" font-size="12.00">GPU 2 (TP0, PP1, EP0)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu3_prefill</title>
<polygon fill="lightcyan" stroke="black" points="16,-207.47 16,-1711.86 639,-1711.86 639,-207.47 16,-207.47"/>
<text text-anchor="middle" x="327.5" y="-1698.26" font-family="Arial" font-size="12.00">GPU 3 (TP1, PP1, EP1)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_decode_pipeline0</title>
<polygon fill="lightgrey" stroke="black" points="1405,-1912.85 1405,-3338.78 3691,-3338.78 3691,-1912.85 1405,-1912.85"/>
<text text-anchor="middle" x="2548" y="-3325.18" font-family="Arial" font-size="12.00">Decode: Pipeline Stage 0 (Layers 0&#45;7)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_dec_gpu0</title>
<polygon fill="lightcyan" stroke="black" points="2204,-2453.83 2204,-3309.78 3683,-3309.78 3683,-2453.83 2204,-2453.83"/>
<text text-anchor="middle" x="2943.5" y="-3296.18" font-family="Arial" font-size="12.00">Decode GPU 0 (TP0, PP0, EP0)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_dec_gpu1</title>
<polygon fill="lightcyan" stroke="black" points="1413,-1920.85 1413,-3290.28 2196,-3290.28 2196,-1920.85 1413,-1920.85"/>
<text text-anchor="middle" x="1804.5" y="-3276.68" font-family="Arial" font-size="12.00">Decode GPU 1 (TP1, PP0, EP1)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_decode_pipeline1</title>
<polygon fill="lightgrey" stroke="black" points="1405,-179.97 1405,-1889.84 3166,-1889.84 3166,-179.97 1405,-179.97"/>
<text text-anchor="middle" x="2285.5" y="-1876.24" font-family="Arial" font-size="12.00">Decode: Pipeline Stage 1 (Layers 8&#45;15)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_dec_gpu2</title>
<polygon fill="lightcyan" stroke="black" points="2204,-326.47 2204,-1597.88 3158,-1597.88 3158,-326.47 2204,-326.47"/>
<text text-anchor="middle" x="2681" y="-1584.28" font-family="Arial" font-size="12.00">Decode GPU 2 (TP0, PP1, EP0)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_dec_gpu3</title>
<polygon fill="lightcyan" stroke="black" points="1413,-187.97 1413,-1860.84 2196,-1860.84 2196,-187.97 1413,-187.97"/>
<text text-anchor="middle" x="1804.5" y="-1847.24" font-family="Arial" font-size="12.00">Decode GPU 3 (TP1, PP1, EP1)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="695" cy="-3406.78" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="695" y="-3415.28" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="695" y="-3404.28" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="695" y="-3393.28" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- input_split -->
<g id="node2" class="node">
<title>input_split</title>
<polygon fill="yellow" stroke="black" points="959.24,-3280.78 538.89,-3280.78 430.76,-3198.78 851.11,-3198.78 959.24,-3280.78"/>
<text text-anchor="middle" x="695" y="-3248.28" font-family="Arial" font-size="10.00">Input Split (TP)</text>
<text text-anchor="middle" x="695" y="-3237.28" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="695" y="-3226.28" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=256]</text>
</g>
<!-- input&#45;&gt;input_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;input_split</title>
<path fill="none" stroke="black" d="M695,-3377.41C695,-3353.7 695,-3319.29 695,-3290.94"/>
<polygon fill="black" stroke="black" points="698.5,-3290.8 695,-3280.8 691.5,-3290.8 698.5,-3290.8"/>
</g>
<!-- gpu0_l0_ln1 -->
<g id="node5" class="node">
<title>gpu0_l0_ln1</title>
<polygon fill="lightblue" stroke="black" points="897,-3113.78 769,-3113.78 769,-3070.78 897,-3070.78 897,-3113.78"/>
<text text-anchor="middle" x="833" y="-3100.78" font-family="Arial" font-size="10.00">LayerNorm1 L0</text>
<text text-anchor="middle" x="833" y="-3089.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="833" y="-3078.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- input_split&#45;&gt;gpu0_l0_ln1 -->
<g id="edge2" class="edge">
<title>input_split&#45;&gt;gpu0_l0_ln1</title>
<path fill="none" stroke="black" d="M733.07,-3198.63C756.34,-3174.1 785.52,-3143.34 806.33,-3121.4"/>
<polygon fill="black" stroke="black" points="808.97,-3123.69 813.32,-3114.03 803.9,-3118.88 808.97,-3123.69"/>
</g>
<!-- gpu1_l0_ln1 -->
<g id="node21" class="node">
<title>gpu1_l0_ln1</title>
<polygon fill="lightblue" stroke="black" points="631,-3113.78 503,-3113.78 503,-3070.78 631,-3070.78 631,-3113.78"/>
<text text-anchor="middle" x="567" y="-3100.78" font-family="Arial" font-size="10.00">LayerNorm1 L0</text>
<text text-anchor="middle" x="567" y="-3089.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="567" y="-3078.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- input_split&#45;&gt;gpu1_l0_ln1 -->
<g id="edge23" class="edge">
<title>input_split&#45;&gt;gpu1_l0_ln1</title>
<path fill="none" stroke="black" d="M659.68,-3198.63C638.2,-3174.21 611.28,-3143.61 591.99,-3121.69"/>
<polygon fill="black" stroke="black" points="594.49,-3119.23 585.26,-3114.03 589.23,-3123.85 594.49,-3119.23"/>
</g>
<!-- decode_input -->
<g id="node3" class="node">
<title>decode_input</title>
<ellipse fill="lightgreen" stroke="black" cx="2791" cy="-3513.77" rx="165.43" ry="28.98"/>
<text text-anchor="middle" x="2791" y="-3522.27" font-family="Arial" font-size="10.00">Decode Input</text>
<text text-anchor="middle" x="2791" y="-3511.27" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1, hidden=512]</text>
<text text-anchor="middle" x="2791" y="-3500.27" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1, hidden=512]</text>
</g>
<!-- decode_input_split -->
<g id="node4" class="node">
<title>decode_input_split</title>
<polygon fill="yellow" stroke="black" points="3033.7,-3447.78 2647.62,-3447.78 2548.3,-3365.78 2934.38,-3365.78 3033.7,-3447.78"/>
<text text-anchor="middle" x="2791" y="-3415.28" font-family="Arial" font-size="10.00">Decode Input Split (TP)</text>
<text text-anchor="middle" x="2791" y="-3404.28" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1, hidden=512]</text>
<text text-anchor="middle" x="2791" y="-3393.28" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1, hidden=256]</text>
</g>
<!-- decode_input&#45;&gt;decode_input_split -->
<g id="edge98" class="edge">
<title>decode_input&#45;&gt;decode_input_split</title>
<path fill="none" stroke="black" d="M2791,-3484.63C2791,-3476.42 2791,-3467.19 2791,-3458.05"/>
<polygon fill="black" stroke="black" points="2794.5,-3457.83 2791,-3447.83 2787.5,-3457.83 2794.5,-3457.83"/>
</g>
<!-- dec_gpu0_l0_ln1 -->
<g id="node75" class="node">
<title>dec_gpu0_l0_ln1</title>
<polygon fill="lightblue" stroke="black" points="3674.5,-3261.28 3493.5,-3261.28 3493.5,-3218.28 3674.5,-3218.28 3674.5,-3261.28"/>
<text text-anchor="middle" x="3584" y="-3248.28" font-family="Arial" font-size="10.00">Decode LayerNorm1 L0</text>
<text text-anchor="middle" x="3584" y="-3237.28" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3584" y="-3226.28" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- decode_input_split&#45;&gt;dec_gpu0_l0_ln1 -->
<g id="edge99" class="edge">
<title>decode_input_split&#45;&gt;dec_gpu0_l0_ln1</title>
<path fill="none" stroke="black" d="M2978.11,-3401.75C3152.41,-3395.49 3398.07,-3379.52 3485,-3338.78 3517.77,-3323.42 3546.05,-3292.54 3563.9,-3269.52"/>
<polygon fill="black" stroke="black" points="3566.76,-3271.53 3569.99,-3261.44 3561.17,-3267.32 3566.76,-3271.53"/>
</g>
<!-- dec_gpu1_l0_ln1 -->
<g id="node91" class="node">
<title>dec_gpu1_l0_ln1</title>
<polygon fill="lightblue" stroke="black" points="2088.5,-3261.28 1907.5,-3261.28 1907.5,-3218.28 2088.5,-3218.28 2088.5,-3261.28"/>
<text text-anchor="middle" x="1998" y="-3248.28" font-family="Arial" font-size="10.00">Decode LayerNorm1 L0</text>
<text text-anchor="middle" x="1998" y="-3237.28" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1998" y="-3226.28" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- decode_input_split&#45;&gt;dec_gpu1_l0_ln1 -->
<g id="edge111" class="edge">
<title>decode_input_split&#45;&gt;dec_gpu1_l0_ln1</title>
<path fill="none" stroke="black" d="M2589.35,-3399.8C2473.54,-3392.21 2326.45,-3375.45 2200,-3338.78 2141.83,-3321.9 2079.85,-3289.4 2040.12,-3266.47"/>
<polygon fill="black" stroke="black" points="2041.65,-3263.31 2031.25,-3261.29 2038.12,-3269.36 2041.65,-3263.31"/>
</g>
<!-- gpu0_l0_attn_q -->
<g id="node6" class="node">
<title>gpu0_l0_attn_q</title>
<polygon fill="lightblue" stroke="black" points="818,-2991.78 690,-2991.78 690,-2948.78 818,-2948.78 818,-2991.78"/>
<text text-anchor="middle" x="754" y="-2978.78" font-family="Arial" font-size="10.00">Attention Q Proj L0</text>
<text text-anchor="middle" x="754" y="-2967.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="754" y="-2956.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_q -->
<g id="edge3" class="edge">
<title>gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_q</title>
<path fill="none" stroke="black" d="M819.42,-3070.65C806.7,-3051.33 787.57,-3022.26 773.27,-3000.55"/>
<polygon fill="black" stroke="black" points="776.09,-2998.46 767.67,-2992.04 770.24,-3002.31 776.09,-2998.46"/>
</g>
<!-- gpu0_l0_attn_k -->
<g id="node7" class="node">
<title>gpu0_l0_attn_k</title>
<polygon fill="lightblue" stroke="black" points="964,-2991.78 836,-2991.78 836,-2948.78 964,-2948.78 964,-2991.78"/>
<text text-anchor="middle" x="900" y="-2978.78" font-family="Arial" font-size="10.00">Attention K Proj L0</text>
<text text-anchor="middle" x="900" y="-2967.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="900" y="-2956.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_k -->
<g id="edge4" class="edge">
<title>gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_k</title>
<path fill="none" stroke="black" d="M844.52,-3070.65C855.26,-3051.41 871.39,-3022.52 883.49,-3000.84"/>
<polygon fill="black" stroke="black" points="886.59,-3002.47 888.41,-2992.04 880.48,-2999.06 886.59,-3002.47"/>
</g>
<!-- gpu0_l0_attn_v -->
<g id="node8" class="node">
<title>gpu0_l0_attn_v</title>
<polygon fill="lightblue" stroke="black" points="1047,-2930.78 919,-2930.78 919,-2887.78 1047,-2887.78 1047,-2930.78"/>
<text text-anchor="middle" x="983" y="-2917.78" font-family="Arial" font-size="10.00">Attention V Proj L0</text>
<text text-anchor="middle" x="983" y="-2906.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="983" y="-2895.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_v -->
<g id="edge5" class="edge">
<title>gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_v</title>
<path fill="none" stroke="black" d="M879.68,-3070.77C911.47,-3054.22 951.55,-3027.76 973,-2991.78 982.04,-2976.61 984.67,-2957.04 984.98,-2940.88"/>
<polygon fill="black" stroke="black" points="988.48,-2940.8 984.9,-2930.83 981.48,-2940.86 988.48,-2940.8"/>
</g>
<!-- gpu0_l0_attn_score -->
<g id="node9" class="node">
<title>gpu0_l0_attn_score</title>
<polygon fill="lightblue" stroke="black" points="964,-2869.78 836,-2869.78 836,-2826.78 964,-2826.78 964,-2869.78"/>
<text text-anchor="middle" x="900" y="-2856.78" font-family="Arial" font-size="10.00">Attention Score L0</text>
<text text-anchor="middle" x="900" y="-2845.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="900" y="-2834.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_l0_attn_q&#45;&gt;gpu0_l0_attn_score -->
<g id="edge6" class="edge">
<title>gpu0_l0_attn_q&#45;&gt;gpu0_l0_attn_score</title>
<path fill="none" stroke="black" d="M779.1,-2948.65C803.33,-2928.73 840.18,-2898.44 866.82,-2876.54"/>
<polygon fill="black" stroke="black" points="869.24,-2879.09 874.74,-2870.04 864.79,-2873.68 869.24,-2879.09"/>
</g>
<!-- gpu0_l0_attn_k&#45;&gt;gpu0_l0_attn_score -->
<g id="edge7" class="edge">
<title>gpu0_l0_attn_k&#45;&gt;gpu0_l0_attn_score</title>
<path fill="none" stroke="black" d="M900,-2948.65C900,-2929.84 900,-2901.81 900,-2880.3"/>
<polygon fill="black" stroke="black" points="903.5,-2880.04 900,-2870.04 896.5,-2880.04 903.5,-2880.04"/>
</g>
<!-- gpu0_l0_attn_softmax -->
<g id="node10" class="node">
<title>gpu0_l0_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="1047,-2789.78 919,-2789.78 919,-2746.78 1047,-2746.78 1047,-2789.78"/>
<text text-anchor="middle" x="983" y="-2776.78" font-family="Arial" font-size="10.00">Attention Softmax L0</text>
<text text-anchor="middle" x="983" y="-2765.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="983" y="-2754.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_l0_attn_v&#45;&gt;gpu0_l0_attn_softmax -->
<g id="edge8" class="edge">
<title>gpu0_l0_attn_v&#45;&gt;gpu0_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M983,-2887.77C983,-2864.67 983,-2826.88 983,-2800.2"/>
<polygon fill="black" stroke="black" points="986.5,-2799.87 983,-2789.87 979.5,-2799.87 986.5,-2799.87"/>
</g>
<!-- gpu0_l0_attn_score&#45;&gt;gpu0_l0_attn_softmax -->
<g id="edge9" class="edge">
<title>gpu0_l0_attn_score&#45;&gt;gpu0_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M922.24,-2826.37C931.9,-2817.3 943.35,-2806.54 953.69,-2796.82"/>
<polygon fill="black" stroke="black" points="956.09,-2799.36 960.98,-2789.97 951.3,-2794.26 956.09,-2799.36"/>
</g>
<!-- gpu0_l0_attn_out -->
<g id="node11" class="node">
<title>gpu0_l0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1051,-2702.28 923,-2702.28 923,-2659.28 1051,-2659.28 1051,-2702.28"/>
<text text-anchor="middle" x="987" y="-2689.28" font-family="Arial" font-size="10.00">Attention Out Proj L0</text>
<text text-anchor="middle" x="987" y="-2678.28" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="987" y="-2667.28" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_l0_attn_softmax&#45;&gt;gpu0_l0_attn_out -->
<g id="edge10" class="edge">
<title>gpu0_l0_attn_softmax&#45;&gt;gpu0_l0_attn_out</title>
<path fill="none" stroke="black" d="M983.97,-2746.58C984.44,-2736.39 985.03,-2723.91 985.56,-2712.62"/>
<polygon fill="black" stroke="black" points="989.07,-2712.44 986.04,-2702.29 982.08,-2712.11 989.07,-2712.44"/>
</g>
<!-- gpu0_l0_attn_ar -->
<g id="node12" class="node">
<title>gpu0_l0_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="997" cy="-2585.8" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="997" y="-2594.3" font-family="Arial" font-size="10.00">TP All&#45;Reduce L0</text>
<text text-anchor="middle" x="997" y="-2583.3" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="997" y="-2572.3" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_l0_attn_out&#45;&gt;gpu0_l0_attn_ar -->
<g id="edge11" class="edge">
<title>gpu0_l0_attn_out&#45;&gt;gpu0_l0_attn_ar</title>
<path fill="none" stroke="black" d="M989.22,-2659.15C990.31,-2649.05 991.65,-2636.57 992.91,-2624.83"/>
<polygon fill="black" stroke="black" points="996.4,-2625.1 993.99,-2614.79 989.44,-2624.35 996.4,-2625.1"/>
</g>
<!-- gpu0_l0_ln2 -->
<g id="node13" class="node">
<title>gpu0_l0_ln2</title>
<polygon fill="lightblue" stroke="black" points="1079,-2512.32 951,-2512.32 951,-2469.32 1079,-2469.32 1079,-2512.32"/>
<text text-anchor="middle" x="1015" y="-2499.32" font-family="Arial" font-size="10.00">LayerNorm2 L0</text>
<text text-anchor="middle" x="1015" y="-2488.32" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1015" y="-2477.32" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_l0_attn_ar&#45;&gt;gpu0_l0_ln2 -->
<g id="edge12" class="edge">
<title>gpu0_l0_attn_ar&#45;&gt;gpu0_l0_ln2</title>
<path fill="none" stroke="black" d="M1002.45,-2556.65C1004.54,-2545.88 1006.92,-2533.54 1009.05,-2522.53"/>
<polygon fill="black" stroke="black" points="1012.53,-2522.97 1011,-2512.49 1005.66,-2521.64 1012.53,-2522.97"/>
</g>
<!-- gpu0_l0_gate -->
<g id="node14" class="node">
<title>gpu0_l0_gate</title>
<polygon fill="lightblue" stroke="black" points="1078,-2375.34 958,-2375.34 958,-2332.34 1078,-2332.34 1078,-2375.34"/>
<text text-anchor="middle" x="1018" y="-2362.34" font-family="Arial" font-size="10.00">Gate Router L0</text>
<text text-anchor="middle" x="1018" y="-2351.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1018" y="-2340.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 8]</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu0_l0_gate -->
<g id="edge13" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu0_l0_gate</title>
<path fill="none" stroke="black" d="M1015.46,-2469.32C1015.95,-2447.12 1016.74,-2411.45 1017.31,-2385.83"/>
<polygon fill="black" stroke="black" points="1020.82,-2385.61 1017.54,-2375.53 1013.82,-2385.45 1020.82,-2385.61"/>
</g>
<!-- gpu0_l0_expert0 -->
<g id="node15" class="node">
<title>gpu0_l0_expert0</title>
<polygon fill="lightblue" stroke="black" points="1229.5,-2375.34 1096.5,-2375.34 1096.5,-2332.34 1229.5,-2332.34 1229.5,-2375.34"/>
<text text-anchor="middle" x="1163" y="-2362.34" font-family="Arial" font-size="10.00">Expert 0 FC L0</text>
<text text-anchor="middle" x="1163" y="-2351.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1163" y="-2340.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu0_l0_expert0 -->
<g id="edge14" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu0_l0_expert0</title>
<path fill="none" stroke="black" d="M1037.48,-2469.32C1062.9,-2446.13 1104.44,-2408.24 1132.71,-2382.46"/>
<polygon fill="black" stroke="black" points="1135.28,-2384.85 1140.31,-2375.53 1130.56,-2379.68 1135.28,-2384.85"/>
</g>
<!-- gpu0_l0_expert1 -->
<g id="node16" class="node">
<title>gpu0_l0_expert1</title>
<polygon fill="lightblue" stroke="black" points="1380.5,-2375.34 1247.5,-2375.34 1247.5,-2332.34 1380.5,-2332.34 1380.5,-2375.34"/>
<text text-anchor="middle" x="1314" y="-2362.34" font-family="Arial" font-size="10.00">Expert 1 FC L0</text>
<text text-anchor="middle" x="1314" y="-2351.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1314" y="-2340.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu0_l0_expert1 -->
<g id="edge15" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu0_l0_expert1</title>
<path fill="none" stroke="black" d="M1060.41,-2469.32C1113.65,-2445.29 1201.84,-2405.47 1258.93,-2379.7"/>
<polygon fill="black" stroke="black" points="1260.49,-2382.83 1268.16,-2375.53 1257.61,-2376.45 1260.49,-2382.83"/>
</g>
<!-- gpu0_l0_expert2 -->
<g id="node17" class="node">
<title>gpu0_l0_expert2</title>
<polygon fill="lightblue" stroke="black" points="788.5,-2375.34 655.5,-2375.34 655.5,-2332.34 788.5,-2332.34 788.5,-2375.34"/>
<text text-anchor="middle" x="722" y="-2362.34" font-family="Arial" font-size="10.00">Expert 2 FC L0</text>
<text text-anchor="middle" x="722" y="-2351.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="722" y="-2340.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu0_l0_expert2 -->
<g id="edge16" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu0_l0_expert2</title>
<path fill="none" stroke="black" d="M970.5,-2469.32C918.44,-2445.33 832.27,-2405.64 776.31,-2379.86"/>
<polygon fill="black" stroke="black" points="777.47,-2376.54 766.92,-2375.53 774.54,-2382.89 777.47,-2376.54"/>
</g>
<!-- gpu0_l0_expert3 -->
<g id="node18" class="node">
<title>gpu0_l0_expert3</title>
<polygon fill="lightblue" stroke="black" points="939.5,-2375.34 806.5,-2375.34 806.5,-2332.34 939.5,-2332.34 939.5,-2375.34"/>
<text text-anchor="middle" x="873" y="-2362.34" font-family="Arial" font-size="10.00">Expert 3 FC L0</text>
<text text-anchor="middle" x="873" y="-2351.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="873" y="-2340.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu0_l0_expert3 -->
<g id="edge17" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu0_l0_expert3</title>
<path fill="none" stroke="black" d="M993.43,-2469.32C969.04,-2446.13 929.18,-2408.24 902.06,-2382.46"/>
<polygon fill="black" stroke="black" points="904.43,-2379.88 894.77,-2375.53 899.61,-2384.96 904.43,-2379.88"/>
</g>
<!-- gpu0_l0_expert_agg -->
<g id="node19" class="node">
<title>gpu0_l0_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1150.91,-2245.84 939.48,-2245.84 885.09,-2163.84 1096.52,-2163.84 1150.91,-2245.84"/>
<text text-anchor="middle" x="1018" y="-2213.34" font-family="Arial" font-size="10.00">Expert Aggregation L0</text>
<text text-anchor="middle" x="1018" y="-2202.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="1018" y="-2191.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_l0_gate&#45;&gt;gpu0_l0_expert_agg -->
<g id="edge22" class="edge">
<title>gpu0_l0_gate&#45;&gt;gpu0_l0_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1018,-2332.09C1018,-2312.39 1018,-2282 1018,-2255.97"/>
<polygon fill="black" stroke="black" points="1021.5,-2255.87 1018,-2245.87 1014.5,-2255.87 1021.5,-2255.87"/>
<text text-anchor="middle" x="1032.5" y="-2283.14" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- gpu0_l0_expert0&#45;&gt;gpu0_l0_expert_agg -->
<g id="edge18" class="edge">
<title>gpu0_l0_expert0&#45;&gt;gpu0_l0_expert_agg</title>
<path fill="none" stroke="black" d="M1142.53,-2332.09C1122.41,-2311.69 1090.98,-2279.83 1064.74,-2253.22"/>
<polygon fill="black" stroke="black" points="1067,-2250.53 1057.49,-2245.87 1062.02,-2255.45 1067,-2250.53"/>
</g>
<!-- gpu0_l0_expert1&#45;&gt;gpu0_l0_expert_agg -->
<g id="edge19" class="edge">
<title>gpu0_l0_expert1&#45;&gt;gpu0_l0_expert_agg</title>
<path fill="none" stroke="black" d="M1272.53,-2332.24C1230.03,-2311.14 1162.59,-2277.65 1107.81,-2250.44"/>
<polygon fill="black" stroke="black" points="1109.29,-2247.27 1098.78,-2245.96 1106.18,-2253.54 1109.29,-2247.27"/>
</g>
<!-- gpu0_l0_expert2&#45;&gt;gpu0_l0_expert_agg -->
<g id="edge20" class="edge">
<title>gpu0_l0_expert2&#45;&gt;gpu0_l0_expert_agg</title>
<path fill="none" stroke="black" d="M763.47,-2332.24C806.35,-2310.95 874.61,-2277.05 929.65,-2249.72"/>
<polygon fill="black" stroke="black" points="931.31,-2252.8 938.71,-2245.22 928.2,-2246.53 931.31,-2252.8"/>
</g>
<!-- gpu0_l0_expert3&#45;&gt;gpu0_l0_expert_agg -->
<g id="edge21" class="edge">
<title>gpu0_l0_expert3&#45;&gt;gpu0_l0_expert_agg</title>
<path fill="none" stroke="black" d="M893.47,-2332.09C913.59,-2311.69 945.02,-2279.83 971.26,-2253.22"/>
<polygon fill="black" stroke="black" points="973.98,-2255.45 978.51,-2245.87 969,-2250.53 973.98,-2255.45"/>
</g>
<!-- gpu0_send -->
<g id="node20" class="node">
<title>gpu0_send</title>
<ellipse fill="purple" stroke="black" cx="1018" cy="-2076.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1018" y="-2085.34" font-family="Arial" font-size="10.00">Send to PP1</text>
<text text-anchor="middle" x="1018" y="-2074.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1018" y="-2063.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_l0_expert_agg&#45;&gt;gpu0_send -->
<g id="edge46" class="edge">
<title>gpu0_l0_expert_agg&#45;&gt;gpu0_send</title>
<path fill="none" stroke="black" d="M1018,-2163.63C1018,-2148.56 1018,-2131.48 1018,-2116.56"/>
<polygon fill="black" stroke="black" points="1021.5,-2116.12 1018,-2106.12 1014.5,-2116.12 1021.5,-2116.12"/>
</g>
<!-- gpu2_recv -->
<g id="node39" class="node">
<title>gpu2_recv</title>
<ellipse fill="purple" stroke="black" cx="1018" cy="-1653.87" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1018" y="-1662.37" font-family="Arial" font-size="10.00">Recv from PP0</text>
<text text-anchor="middle" x="1018" y="-1651.37" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1018" y="-1640.37" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu0_send&#45;&gt;gpu2_recv -->
<g id="edge48" class="edge">
<title>gpu0_send&#45;&gt;gpu2_recv</title>
<path fill="none" stroke="black" d="M1018,-2047.57C1018,-1974.03 1018,-1776.68 1018,-1693.1"/>
<polygon fill="black" stroke="black" points="1021.5,-1693.02 1018,-1683.02 1014.5,-1693.02 1021.5,-1693.02"/>
</g>
<!-- gpu1_l0_attn_q -->
<g id="node22" class="node">
<title>gpu1_l0_attn_q</title>
<polygon fill="lightblue" stroke="black" points="424,-2991.78 296,-2991.78 296,-2948.78 424,-2948.78 424,-2991.78"/>
<text text-anchor="middle" x="360" y="-2978.78" font-family="Arial" font-size="10.00">Attention Q Proj L0</text>
<text text-anchor="middle" x="360" y="-2967.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="360" y="-2956.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_q -->
<g id="edge24" class="edge">
<title>gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_q</title>
<path fill="none" stroke="black" d="M531.42,-3070.65C496.21,-3050.24 442.23,-3018.94 404.27,-2996.94"/>
<polygon fill="black" stroke="black" points="405.87,-2993.82 395.47,-2991.84 402.36,-2999.88 405.87,-2993.82"/>
</g>
<!-- gpu1_l0_attn_k -->
<g id="node23" class="node">
<title>gpu1_l0_attn_k</title>
<polygon fill="lightblue" stroke="black" points="570,-2991.78 442,-2991.78 442,-2948.78 570,-2948.78 570,-2991.78"/>
<text text-anchor="middle" x="506" y="-2978.78" font-family="Arial" font-size="10.00">Attention K Proj L0</text>
<text text-anchor="middle" x="506" y="-2967.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="506" y="-2956.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_k -->
<g id="edge25" class="edge">
<title>gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_k</title>
<path fill="none" stroke="black" d="M556.51,-3070.65C546.78,-3051.5 532.18,-3022.78 521.18,-3001.13"/>
<polygon fill="black" stroke="black" points="524.21,-2999.37 516.55,-2992.04 517.97,-3002.54 524.21,-2999.37"/>
</g>
<!-- gpu1_l0_attn_v -->
<g id="node24" class="node">
<title>gpu1_l0_attn_v</title>
<polygon fill="lightblue" stroke="black" points="631,-2930.78 503,-2930.78 503,-2887.78 631,-2887.78 631,-2930.78"/>
<text text-anchor="middle" x="567" y="-2917.78" font-family="Arial" font-size="10.00">Attention V Proj L0</text>
<text text-anchor="middle" x="567" y="-2906.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="567" y="-2895.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_v -->
<g id="edge26" class="edge">
<title>gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_v</title>
<path fill="none" stroke="black" d="M571.81,-3070.41C577.53,-3042.55 585.54,-2991.73 579,-2948.78 578.59,-2946.08 578.03,-2943.31 577.37,-2940.56"/>
<polygon fill="black" stroke="black" points="580.7,-2939.48 574.65,-2930.79 573.96,-2941.36 580.7,-2939.48"/>
</g>
<!-- gpu1_l0_attn_score -->
<g id="node25" class="node">
<title>gpu1_l0_attn_score</title>
<polygon fill="lightblue" stroke="black" points="548,-2869.78 420,-2869.78 420,-2826.78 548,-2826.78 548,-2869.78"/>
<text text-anchor="middle" x="484" y="-2856.78" font-family="Arial" font-size="10.00">Attention Score L0</text>
<text text-anchor="middle" x="484" y="-2845.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="484" y="-2834.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_attn_q&#45;&gt;gpu1_l0_attn_score -->
<g id="edge27" class="edge">
<title>gpu1_l0_attn_q&#45;&gt;gpu1_l0_attn_score</title>
<path fill="none" stroke="black" d="M381.32,-2948.65C401.72,-2928.9 432.65,-2898.97 455.24,-2877.11"/>
<polygon fill="black" stroke="black" points="457.79,-2879.51 462.55,-2870.04 452.93,-2874.48 457.79,-2879.51"/>
</g>
<!-- gpu1_l0_attn_k&#45;&gt;gpu1_l0_attn_score -->
<g id="edge28" class="edge">
<title>gpu1_l0_attn_k&#45;&gt;gpu1_l0_attn_score</title>
<path fill="none" stroke="black" d="M498.83,-2948.68C497.04,-2942.94 495.27,-2936.66 494,-2930.78 490.42,-2914.13 488,-2895.28 486.44,-2879.9"/>
<polygon fill="black" stroke="black" points="489.92,-2879.5 485.5,-2869.88 482.95,-2880.16 489.92,-2879.5"/>
</g>
<!-- gpu1_l0_attn_softmax -->
<g id="node26" class="node">
<title>gpu1_l0_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="590,-2789.78 462,-2789.78 462,-2746.78 590,-2746.78 590,-2789.78"/>
<text text-anchor="middle" x="526" y="-2776.78" font-family="Arial" font-size="10.00">Attention Softmax L0</text>
<text text-anchor="middle" x="526" y="-2765.78" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="526" y="-2754.78" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_attn_v&#45;&gt;gpu1_l0_attn_softmax -->
<g id="edge29" class="edge">
<title>gpu1_l0_attn_v&#45;&gt;gpu1_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M566.58,-2887.73C565.74,-2870.98 563.4,-2846.88 557,-2826.78 553.99,-2817.33 549.43,-2807.64 544.72,-2798.96"/>
<polygon fill="black" stroke="black" points="547.61,-2796.96 539.61,-2790 541.52,-2800.43 547.61,-2796.96"/>
</g>
<!-- gpu1_l0_attn_score&#45;&gt;gpu1_l0_attn_softmax -->
<g id="edge30" class="edge">
<title>gpu1_l0_attn_score&#45;&gt;gpu1_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M495.26,-2826.37C499.81,-2817.91 505.15,-2807.99 510.1,-2798.81"/>
<polygon fill="black" stroke="black" points="513.2,-2800.43 514.86,-2789.97 507.04,-2797.11 513.2,-2800.43"/>
</g>
<!-- gpu1_l0_attn_out -->
<g id="node27" class="node">
<title>gpu1_l0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="590,-2702.28 462,-2702.28 462,-2659.28 590,-2659.28 590,-2702.28"/>
<text text-anchor="middle" x="526" y="-2689.28" font-family="Arial" font-size="10.00">Attention Out Proj L0</text>
<text text-anchor="middle" x="526" y="-2678.28" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="526" y="-2667.28" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_attn_softmax&#45;&gt;gpu1_l0_attn_out -->
<g id="edge31" class="edge">
<title>gpu1_l0_attn_softmax&#45;&gt;gpu1_l0_attn_out</title>
<path fill="none" stroke="black" d="M526,-2746.58C526,-2736.39 526,-2723.91 526,-2712.62"/>
<polygon fill="black" stroke="black" points="529.5,-2712.29 526,-2702.29 522.5,-2712.29 529.5,-2712.29"/>
</g>
<!-- gpu1_l0_attn_ar -->
<g id="node28" class="node">
<title>gpu1_l0_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="526" cy="-2585.8" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="526" y="-2594.3" font-family="Arial" font-size="10.00">TP All&#45;Reduce L0</text>
<text text-anchor="middle" x="526" y="-2583.3" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="526" y="-2572.3" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_attn_out&#45;&gt;gpu1_l0_attn_ar -->
<g id="edge32" class="edge">
<title>gpu1_l0_attn_out&#45;&gt;gpu1_l0_attn_ar</title>
<path fill="none" stroke="black" d="M526,-2659.15C526,-2649.24 526,-2637.02 526,-2625.47"/>
<polygon fill="black" stroke="black" points="529.5,-2625.14 526,-2615.14 522.5,-2625.14 529.5,-2625.14"/>
</g>
<!-- gpu1_l0_ln2 -->
<g id="node29" class="node">
<title>gpu1_l0_ln2</title>
<polygon fill="lightblue" stroke="black" points="590,-2512.32 462,-2512.32 462,-2469.32 590,-2469.32 590,-2512.32"/>
<text text-anchor="middle" x="526" y="-2499.32" font-family="Arial" font-size="10.00">LayerNorm2 L0</text>
<text text-anchor="middle" x="526" y="-2488.32" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="526" y="-2477.32" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_attn_ar&#45;&gt;gpu1_l0_ln2 -->
<g id="edge33" class="edge">
<title>gpu1_l0_attn_ar&#45;&gt;gpu1_l0_ln2</title>
<path fill="none" stroke="black" d="M526,-2556.65C526,-2545.88 526,-2533.54 526,-2522.53"/>
<polygon fill="black" stroke="black" points="529.5,-2522.49 526,-2512.49 522.5,-2522.49 529.5,-2522.49"/>
</g>
<!-- gpu1_l0_gate -->
<g id="node30" class="node">
<title>gpu1_l0_gate</title>
<polygon fill="lightblue" stroke="black" points="614,-2306.84 494,-2306.84 494,-2263.84 614,-2263.84 614,-2306.84"/>
<text text-anchor="middle" x="554" y="-2293.84" font-family="Arial" font-size="10.00">Gate Router L0</text>
<text text-anchor="middle" x="554" y="-2282.84" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="554" y="-2271.84" font-family="Arial" font-size="10.00">Output: [128, 10240, 8]</text>
</g>
<!-- gpu1_l0_ln2&#45;&gt;gpu1_l0_gate -->
<g id="edge34" class="edge">
<title>gpu1_l0_ln2&#45;&gt;gpu1_l0_gate</title>
<path fill="none" stroke="black" d="M528.84,-2469.19C533.79,-2433.24 544.01,-2358.94 549.79,-2316.96"/>
<polygon fill="black" stroke="black" points="553.26,-2317.41 551.15,-2307.03 546.32,-2316.46 553.26,-2317.41"/>
</g>
<!-- gpu1_ep_a2a_send -->
<g id="node36" class="node">
<title>gpu1_ep_a2a_send</title>
<ellipse fill="red" stroke="black" cx="406" cy="-2353.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="406" y="-2362.34" font-family="Arial" font-size="10.00">EP All&#45;to&#45;All Send L0</text>
<text text-anchor="middle" x="406" y="-2351.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="406" y="-2340.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_ln2&#45;&gt;gpu1_ep_a2a_send -->
<g id="edge35" class="edge">
<title>gpu1_l0_ln2&#45;&gt;gpu1_ep_a2a_send</title>
<path fill="none" stroke="black" d="M507.77,-2469.32C489,-2448.2 459.39,-2414.89 436.93,-2389.63"/>
<polygon fill="black" stroke="black" points="439.48,-2387.22 430.22,-2382.08 434.24,-2391.87 439.48,-2387.22"/>
</g>
<!-- gpu1_l0_expert_agg -->
<g id="node35" class="node">
<title>gpu1_l0_expert_agg</title>
<polygon fill="yellow" stroke="black" points="525.91,-1998.84 314.48,-1998.84 260.09,-1916.84 471.52,-1916.84 525.91,-1998.84"/>
<text text-anchor="middle" x="393" y="-1966.34" font-family="Arial" font-size="10.00">Expert Aggregation L0</text>
<text text-anchor="middle" x="393" y="-1955.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="393" y="-1944.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_gate&#45;&gt;gpu1_l0_expert_agg -->
<g id="edge45" class="edge">
<title>gpu1_l0_gate&#45;&gt;gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562.41,-2263.74C579.86,-2220.87 618.56,-2125.4 620,-2117.84 626.84,-2082.05 641.23,-2065.47 620,-2035.84 595.81,-2002.1 556,-1982.96 516.41,-1972.17"/>
<polygon fill="black" stroke="black" points="517.19,-1968.76 506.63,-1969.67 515.45,-1975.54 517.19,-1968.76"/>
<text text-anchor="middle" x="627.5" y="-2138.64" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- gpu1_l0_expert8 -->
<g id="node31" class="node">
<title>gpu1_l0_expert8</title>
<polygon fill="lightblue" stroke="black" points="157.5,-2098.34 24.5,-2098.34 24.5,-2055.34 157.5,-2055.34 157.5,-2098.34"/>
<text text-anchor="middle" x="91" y="-2085.34" font-family="Arial" font-size="10.00">Expert 8 FC L0</text>
<text text-anchor="middle" x="91" y="-2074.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="91" y="-2063.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu1_l0_expert8&#45;&gt;gpu1_l0_expert_agg -->
<g id="edge41" class="edge">
<title>gpu1_l0_expert8&#45;&gt;gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M127.16,-2055.34C139.59,-2048.69 153.72,-2041.56 167,-2035.84 208.33,-2018.06 255.24,-2001.51 295.57,-1988.35"/>
<polygon fill="black" stroke="black" points="296.7,-1991.66 305.14,-1985.25 294.55,-1985 296.7,-1991.66"/>
</g>
<!-- gpu1_l0_expert9 -->
<g id="node32" class="node">
<title>gpu1_l0_expert9</title>
<polygon fill="lightblue" stroke="black" points="308.5,-2098.34 175.5,-2098.34 175.5,-2055.34 308.5,-2055.34 308.5,-2098.34"/>
<text text-anchor="middle" x="242" y="-2085.34" font-family="Arial" font-size="10.00">Expert 9 FC L0</text>
<text text-anchor="middle" x="242" y="-2074.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="242" y="-2063.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu1_l0_expert9&#45;&gt;gpu1_l0_expert_agg -->
<g id="edge42" class="edge">
<title>gpu1_l0_expert9&#45;&gt;gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M268.65,-2055.2C286.52,-2041.35 310.79,-2022.54 333.15,-2005.22"/>
<polygon fill="black" stroke="black" points="335.52,-2007.81 341.28,-1998.92 331.23,-2002.28 335.52,-2007.81"/>
</g>
<!-- gpu1_l0_expert10 -->
<g id="node33" class="node">
<title>gpu1_l0_expert10</title>
<polygon fill="lightblue" stroke="black" points="459.5,-2098.34 326.5,-2098.34 326.5,-2055.34 459.5,-2055.34 459.5,-2098.34"/>
<text text-anchor="middle" x="393" y="-2085.34" font-family="Arial" font-size="10.00">Expert 10 FC L0</text>
<text text-anchor="middle" x="393" y="-2074.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="393" y="-2063.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu1_l0_expert10&#45;&gt;gpu1_l0_expert_agg -->
<g id="edge43" class="edge">
<title>gpu1_l0_expert10&#45;&gt;gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M393,-2055.2C393,-2042.5 393,-2025.63 393,-2009.55"/>
<polygon fill="black" stroke="black" points="396.5,-2009.16 393,-1999.16 389.5,-2009.16 396.5,-2009.16"/>
</g>
<!-- gpu1_l0_expert11 -->
<g id="node34" class="node">
<title>gpu1_l0_expert11</title>
<polygon fill="lightblue" stroke="black" points="610.5,-2098.34 477.5,-2098.34 477.5,-2055.34 610.5,-2055.34 610.5,-2098.34"/>
<text text-anchor="middle" x="544" y="-2085.34" font-family="Arial" font-size="10.00">Expert 11 FC L0</text>
<text text-anchor="middle" x="544" y="-2074.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="544" y="-2063.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu1_l0_expert11&#45;&gt;gpu1_l0_expert_agg -->
<g id="edge44" class="edge">
<title>gpu1_l0_expert11&#45;&gt;gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M517.35,-2055.2C499.48,-2041.35 475.21,-2022.54 452.85,-2005.22"/>
<polygon fill="black" stroke="black" points="454.77,-2002.28 444.72,-1998.92 450.48,-2007.81 454.77,-2002.28"/>
</g>
<!-- gpu1_send -->
<g id="node38" class="node">
<title>gpu1_send</title>
<ellipse fill="purple" stroke="black" cx="393" cy="-1802.85" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="393" y="-1811.35" font-family="Arial" font-size="10.00">Send to PP1</text>
<text text-anchor="middle" x="393" y="-1800.35" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="393" y="-1789.35" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_l0_expert_agg&#45;&gt;gpu1_send -->
<g id="edge47" class="edge">
<title>gpu1_l0_expert_agg&#45;&gt;gpu1_send</title>
<path fill="none" stroke="black" d="M393,-1916.65C393,-1893.72 393,-1865.13 393,-1842.47"/>
<polygon fill="black" stroke="black" points="396.5,-1842.19 393,-1832.19 389.5,-1842.19 396.5,-1842.19"/>
</g>
<!-- gpu1_ep_a2a_recv -->
<g id="node37" class="node">
<title>gpu1_ep_a2a_recv</title>
<ellipse fill="red" stroke="black" cx="393" cy="-2204.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="393" y="-2213.34" font-family="Arial" font-size="10.00">EP All&#45;to&#45;All Recv L0</text>
<text text-anchor="middle" x="393" y="-2202.34" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="393" y="-2191.34" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_ep_a2a_send&#45;&gt;gpu1_ep_a2a_recv -->
<g id="edge36" class="edge">
<title>gpu1_ep_a2a_send&#45;&gt;gpu1_ep_a2a_recv</title>
<path fill="none" stroke="black" d="M403.52,-2324.84C401.5,-2302 398.63,-2269.49 396.39,-2244.22"/>
<polygon fill="black" stroke="black" points="399.88,-2243.89 395.51,-2234.24 392.91,-2244.5 399.88,-2243.89"/>
</g>
<!-- gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert8 -->
<g id="edge37" class="edge">
<title>gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert8</title>
<path fill="none" stroke="black" d="M332.72,-2183.15C286.72,-2166.82 222.1,-2142.72 167,-2117.84 157.22,-2113.43 146.93,-2108.33 137.19,-2103.29"/>
<polygon fill="black" stroke="black" points="138.53,-2100.04 128.05,-2098.49 135.28,-2106.24 138.53,-2100.04"/>
</g>
<!-- gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert9 -->
<g id="edge38" class="edge">
<title>gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert9</title>
<path fill="none" stroke="black" d="M361.35,-2177.43C335.91,-2156.2 300.3,-2126.5 274.61,-2105.06"/>
<polygon fill="black" stroke="black" points="276.57,-2102.13 266.65,-2098.41 272.08,-2107.5 276.57,-2102.13"/>
</g>
<!-- gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert10 -->
<g id="edge39" class="edge">
<title>gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert10</title>
<path fill="none" stroke="black" d="M393,-2175.57C393,-2155.67 393,-2129.06 393,-2108.63"/>
<polygon fill="black" stroke="black" points="396.5,-2108.58 393,-2098.58 389.5,-2108.58 396.5,-2108.58"/>
</g>
<!-- gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert11 -->
<g id="edge40" class="edge">
<title>gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert11</title>
<path fill="none" stroke="black" d="M424.65,-2177.43C450.09,-2156.2 485.7,-2126.5 511.39,-2105.06"/>
<polygon fill="black" stroke="black" points="513.92,-2107.5 519.35,-2098.41 509.43,-2102.13 513.92,-2107.5"/>
</g>
<!-- gpu3_recv -->
<g id="node56" class="node">
<title>gpu3_recv</title>
<ellipse fill="purple" stroke="black" cx="393" cy="-1653.87" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="393" y="-1662.37" font-family="Arial" font-size="10.00">Recv from PP0</text>
<text text-anchor="middle" x="393" y="-1651.37" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="393" y="-1640.37" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu1_send&#45;&gt;gpu3_recv -->
<g id="edge49" class="edge">
<title>gpu1_send&#45;&gt;gpu3_recv</title>
<path fill="none" stroke="black" d="M393,-1773.86C393,-1751.12 393,-1718.8 393,-1693.58"/>
<polygon fill="black" stroke="black" points="396.5,-1693.26 393,-1683.26 389.5,-1693.26 396.5,-1693.26"/>
</g>
<!-- gpu2_l8_ln1 -->
<g id="node40" class="node">
<title>gpu2_l8_ln1</title>
<polygon fill="lightblue" stroke="black" points="1082,-1561.39 954,-1561.39 954,-1518.39 1082,-1518.39 1082,-1561.39"/>
<text text-anchor="middle" x="1018" y="-1548.39" font-family="Arial" font-size="10.00">LayerNorm1 L8</text>
<text text-anchor="middle" x="1018" y="-1537.39" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1018" y="-1526.39" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu2_recv&#45;&gt;gpu2_l8_ln1 -->
<g id="edge50" class="edge">
<title>gpu2_recv&#45;&gt;gpu2_l8_ln1</title>
<path fill="none" stroke="black" d="M1018,-1624.61C1018,-1608.56 1018,-1588.44 1018,-1571.95"/>
<polygon fill="black" stroke="black" points="1021.5,-1571.71 1018,-1561.71 1014.5,-1571.71 1021.5,-1571.71"/>
</g>
<!-- gpu2_l8_attn_q -->
<g id="node41" class="node">
<title>gpu2_l8_attn_q</title>
<polygon fill="lightblue" stroke="black" points="1082,-1431.9 954,-1431.9 954,-1388.9 1082,-1388.9 1082,-1431.9"/>
<text text-anchor="middle" x="1018" y="-1418.9" font-family="Arial" font-size="10.00">Attention Q Proj L8</text>
<text text-anchor="middle" x="1018" y="-1407.9" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1018" y="-1396.9" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_q -->
<g id="edge51" class="edge">
<title>gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_q</title>
<path fill="none" stroke="black" d="M1018,-1518.12C1018,-1497.56 1018,-1465.84 1018,-1442.32"/>
<polygon fill="black" stroke="black" points="1021.5,-1442.16 1018,-1432.16 1014.5,-1442.16 1021.5,-1442.16"/>
</g>
<!-- gpu2_l8_attn_k -->
<g id="node42" class="node">
<title>gpu2_l8_attn_k</title>
<polygon fill="lightblue" stroke="black" points="936,-1431.9 808,-1431.9 808,-1388.9 936,-1388.9 936,-1431.9"/>
<text text-anchor="middle" x="872" y="-1418.9" font-family="Arial" font-size="10.00">Attention K Proj L8</text>
<text text-anchor="middle" x="872" y="-1407.9" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="872" y="-1396.9" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_k -->
<g id="edge52" class="edge">
<title>gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_k</title>
<path fill="none" stroke="black" d="M994.22,-1518.12C969.51,-1496.54 930.71,-1462.67 903.48,-1438.88"/>
<polygon fill="black" stroke="black" points="905.61,-1436.1 895.77,-1432.16 901,-1441.37 905.61,-1436.1"/>
</g>
<!-- gpu2_l8_attn_v -->
<g id="node43" class="node">
<title>gpu2_l8_attn_v</title>
<polygon fill="lightblue" stroke="black" points="1165,-1370.9 1037,-1370.9 1037,-1327.9 1165,-1327.9 1165,-1370.9"/>
<text text-anchor="middle" x="1101" y="-1357.9" font-family="Arial" font-size="10.00">Attention V Proj L8</text>
<text text-anchor="middle" x="1101" y="-1346.9" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1101" y="-1335.9" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_v -->
<g id="edge53" class="edge">
<title>gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_v</title>
<path fill="none" stroke="black" d="M1036.72,-1518.08C1053.91,-1497.69 1078.55,-1464.93 1091,-1431.9 1097.05,-1415.86 1099.62,-1396.9 1100.65,-1381.31"/>
<polygon fill="black" stroke="black" points="1104.15,-1381.29 1101.14,-1371.13 1097.16,-1380.95 1104.15,-1381.29"/>
</g>
<!-- gpu2_l8_attn_score -->
<g id="node44" class="node">
<title>gpu2_l8_attn_score</title>
<polygon fill="lightblue" stroke="black" points="1082,-1309.9 954,-1309.9 954,-1266.9 1082,-1266.9 1082,-1309.9"/>
<text text-anchor="middle" x="1018" y="-1296.9" font-family="Arial" font-size="10.00">Attention Score L8</text>
<text text-anchor="middle" x="1018" y="-1285.9" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1018" y="-1274.9" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu2_l8_attn_q&#45;&gt;gpu2_l8_attn_score -->
<g id="edge54" class="edge">
<title>gpu2_l8_attn_q&#45;&gt;gpu2_l8_attn_score</title>
<path fill="none" stroke="black" d="M1018,-1388.77C1018,-1369.96 1018,-1341.93 1018,-1320.42"/>
<polygon fill="black" stroke="black" points="1021.5,-1320.16 1018,-1310.16 1014.5,-1320.16 1021.5,-1320.16"/>
</g>
<!-- gpu2_l8_attn_k&#45;&gt;gpu2_l8_attn_score -->
<g id="edge55" class="edge">
<title>gpu2_l8_attn_k&#45;&gt;gpu2_l8_attn_score</title>
<path fill="none" stroke="black" d="M897.1,-1388.77C921.33,-1368.85 958.18,-1338.56 984.82,-1316.66"/>
<polygon fill="black" stroke="black" points="987.24,-1319.21 992.74,-1310.16 982.79,-1313.8 987.24,-1319.21"/>
</g>
<!-- gpu2_l8_attn_softmax -->
<g id="node45" class="node">
<title>gpu2_l8_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="1088,-1187.9 960,-1187.9 960,-1144.9 1088,-1144.9 1088,-1187.9"/>
<text text-anchor="middle" x="1024" y="-1174.9" font-family="Arial" font-size="10.00">Attention Softmax L8</text>
<text text-anchor="middle" x="1024" y="-1163.9" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1024" y="-1152.9" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu2_l8_attn_v&#45;&gt;gpu2_l8_attn_softmax -->
<g id="edge56" class="edge">
<title>gpu2_l8_attn_v&#45;&gt;gpu2_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M1101.1,-1327.67C1100.57,-1310.81 1098.38,-1286.66 1091,-1266.9 1081.29,-1240.89 1063.53,-1215 1048.74,-1196.14"/>
<polygon fill="black" stroke="black" points="1051.39,-1193.86 1042.4,-1188.26 1045.94,-1198.25 1051.39,-1193.86"/>
</g>
<!-- gpu2_l8_attn_score&#45;&gt;gpu2_l8_attn_softmax -->
<g id="edge57" class="edge">
<title>gpu2_l8_attn_score&#45;&gt;gpu2_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M1019.03,-1266.77C1019.97,-1247.96 1021.37,-1219.93 1022.45,-1198.42"/>
<polygon fill="black" stroke="black" points="1025.96,-1198.32 1022.96,-1188.16 1018.97,-1197.97 1025.96,-1198.32"/>
</g>
<!-- gpu2_l8_attn_out -->
<g id="node46" class="node">
<title>gpu2_l8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1088,-1100.41 960,-1100.41 960,-1057.41 1088,-1057.41 1088,-1100.41"/>
<text text-anchor="middle" x="1024" y="-1087.41" font-family="Arial" font-size="10.00">Attention Out Proj L8</text>
<text text-anchor="middle" x="1024" y="-1076.41" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1024" y="-1065.41" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu2_l8_attn_softmax&#45;&gt;gpu2_l8_attn_out -->
<g id="edge58" class="edge">
<title>gpu2_l8_attn_softmax&#45;&gt;gpu2_l8_attn_out</title>
<path fill="none" stroke="black" d="M1024,-1144.7C1024,-1134.52 1024,-1122.03 1024,-1110.75"/>
<polygon fill="black" stroke="black" points="1027.5,-1110.41 1024,-1100.41 1020.5,-1110.41 1027.5,-1110.41"/>
</g>
<!-- gpu2_l8_attn_ar -->
<g id="node47" class="node">
<title>gpu2_l8_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="1024" cy="-983.92" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1024" y="-992.42" font-family="Arial" font-size="10.00">TP All&#45;Reduce L8</text>
<text text-anchor="middle" x="1024" y="-981.42" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1024" y="-970.42" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu2_l8_attn_out&#45;&gt;gpu2_l8_attn_ar -->
<g id="edge59" class="edge">
<title>gpu2_l8_attn_out&#45;&gt;gpu2_l8_attn_ar</title>
<path fill="none" stroke="black" d="M1024,-1057.27C1024,-1047.36 1024,-1035.14 1024,-1023.59"/>
<polygon fill="black" stroke="black" points="1027.5,-1023.26 1024,-1013.26 1020.5,-1023.26 1027.5,-1023.26"/>
</g>
<!-- gpu2_l8_ln2 -->
<g id="node48" class="node">
<title>gpu2_l8_ln2</title>
<polygon fill="lightblue" stroke="black" points="1088,-910.44 960,-910.44 960,-867.44 1088,-867.44 1088,-910.44"/>
<text text-anchor="middle" x="1024" y="-897.44" font-family="Arial" font-size="10.00">LayerNorm2 L8</text>
<text text-anchor="middle" x="1024" y="-886.44" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1024" y="-875.44" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu2_l8_attn_ar&#45;&gt;gpu2_l8_ln2 -->
<g id="edge60" class="edge">
<title>gpu2_l8_attn_ar&#45;&gt;gpu2_l8_ln2</title>
<path fill="none" stroke="black" d="M1024,-954.77C1024,-944 1024,-931.66 1024,-920.66"/>
<polygon fill="black" stroke="black" points="1027.5,-920.61 1024,-910.61 1020.5,-920.61 1027.5,-920.61"/>
</g>
<!-- gpu2_l8_gate -->
<g id="node49" class="node">
<title>gpu2_l8_gate</title>
<polygon fill="lightblue" stroke="black" points="1229,-773.46 1109,-773.46 1109,-730.46 1229,-730.46 1229,-773.46"/>
<text text-anchor="middle" x="1169" y="-760.46" font-family="Arial" font-size="10.00">Gate Router L8</text>
<text text-anchor="middle" x="1169" y="-749.46" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1169" y="-738.46" font-family="Arial" font-size="10.00">Output: [128, 10240, 8]</text>
</g>
<!-- gpu2_l8_ln2&#45;&gt;gpu2_l8_gate -->
<g id="edge61" class="edge">
<title>gpu2_l8_ln2&#45;&gt;gpu2_l8_gate</title>
<path fill="none" stroke="black" d="M1046.02,-867.44C1070.93,-844.25 1111.63,-806.36 1139.33,-780.58"/>
<polygon fill="black" stroke="black" points="1141.84,-783.03 1146.77,-773.65 1137.07,-777.9 1141.84,-783.03"/>
</g>
<!-- gpu2_l8_expert0 -->
<g id="node50" class="node">
<title>gpu2_l8_expert0</title>
<polygon fill="lightblue" stroke="black" points="1380.5,-773.46 1247.5,-773.46 1247.5,-730.46 1380.5,-730.46 1380.5,-773.46"/>
<text text-anchor="middle" x="1314" y="-760.46" font-family="Arial" font-size="10.00">Expert 0 FC L8</text>
<text text-anchor="middle" x="1314" y="-749.46" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1314" y="-738.46" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu2_l8_ln2&#45;&gt;gpu2_l8_expert0 -->
<g id="edge62" class="edge">
<title>gpu2_l8_ln2&#45;&gt;gpu2_l8_expert0</title>
<path fill="none" stroke="black" d="M1068.04,-867.44C1119.57,-843.46 1204.86,-803.76 1260.24,-777.98"/>
<polygon fill="black" stroke="black" points="1261.95,-781.04 1269.54,-773.65 1259,-774.7 1261.95,-781.04"/>
</g>
<!-- gpu2_l8_expert1 -->
<g id="node51" class="node">
<title>gpu2_l8_expert1</title>
<polygon fill="lightblue" stroke="black" points="788.5,-773.46 655.5,-773.46 655.5,-730.46 788.5,-730.46 788.5,-773.46"/>
<text text-anchor="middle" x="722" y="-760.46" font-family="Arial" font-size="10.00">Expert 1 FC L8</text>
<text text-anchor="middle" x="722" y="-749.46" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="722" y="-738.46" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu2_l8_ln2&#45;&gt;gpu2_l8_expert1 -->
<g id="edge63" class="edge">
<title>gpu2_l8_ln2&#45;&gt;gpu2_l8_expert1</title>
<path fill="none" stroke="black" d="M978.13,-867.44C924.36,-843.41 835.29,-803.59 777.63,-777.82"/>
<polygon fill="black" stroke="black" points="778.86,-774.54 768.3,-773.65 776,-780.93 778.86,-774.54"/>
</g>
<!-- gpu2_l8_expert2 -->
<g id="node52" class="node">
<title>gpu2_l8_expert2</title>
<polygon fill="lightblue" stroke="black" points="939.5,-773.46 806.5,-773.46 806.5,-730.46 939.5,-730.46 939.5,-773.46"/>
<text text-anchor="middle" x="873" y="-760.46" font-family="Arial" font-size="10.00">Expert 2 FC L8</text>
<text text-anchor="middle" x="873" y="-749.46" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="873" y="-738.46" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu2_l8_ln2&#45;&gt;gpu2_l8_expert2 -->
<g id="edge64" class="edge">
<title>gpu2_l8_ln2&#45;&gt;gpu2_l8_expert2</title>
<path fill="none" stroke="black" d="M1001.07,-867.44C975.12,-844.25 932.74,-806.36 903.9,-780.58"/>
<polygon fill="black" stroke="black" points="905.94,-777.71 896.15,-773.65 901.27,-782.92 905.94,-777.71"/>
</g>
<!-- gpu2_l8_expert3 -->
<g id="node53" class="node">
<title>gpu2_l8_expert3</title>
<polygon fill="lightblue" stroke="black" points="1090.5,-773.46 957.5,-773.46 957.5,-730.46 1090.5,-730.46 1090.5,-773.46"/>
<text text-anchor="middle" x="1024" y="-760.46" font-family="Arial" font-size="10.00">Expert 3 FC L8</text>
<text text-anchor="middle" x="1024" y="-749.46" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1024" y="-738.46" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu2_l8_ln2&#45;&gt;gpu2_l8_expert3 -->
<g id="edge65" class="edge">
<title>gpu2_l8_ln2&#45;&gt;gpu2_l8_expert3</title>
<path fill="none" stroke="black" d="M1024,-867.44C1024,-845.24 1024,-809.57 1024,-783.95"/>
<polygon fill="black" stroke="black" points="1027.5,-783.65 1024,-773.65 1020.5,-783.65 1027.5,-783.65"/>
</g>
<!-- gpu2_l8_expert_agg -->
<g id="node54" class="node">
<title>gpu2_l8_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1156.91,-643.97 945.48,-643.97 891.09,-561.97 1102.52,-561.97 1156.91,-643.97"/>
<text text-anchor="middle" x="1024" y="-611.47" font-family="Arial" font-size="10.00">Expert Aggregation L8</text>
<text text-anchor="middle" x="1024" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="1024" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu2_l8_gate&#45;&gt;gpu2_l8_expert_agg -->
<g id="edge70" class="edge">
<title>gpu2_l8_gate&#45;&gt;gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1148.53,-730.21C1128.41,-709.81 1096.98,-677.95 1070.74,-651.35"/>
<polygon fill="black" stroke="black" points="1073,-648.65 1063.49,-643.99 1068.02,-653.57 1073,-648.65"/>
<text text-anchor="middle" x="1136.5" y="-681.27" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- gpu2_l8_expert0&#45;&gt;gpu2_l8_expert_agg -->
<g id="edge66" class="edge">
<title>gpu2_l8_expert0&#45;&gt;gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M1279.45,-730.39C1247.58,-711.71 1198.72,-683.82 1155,-661.97 1145.9,-657.41 1136.35,-652.84 1126.75,-648.36"/>
<polygon fill="black" stroke="black" points="1128.08,-645.12 1117.53,-644.1 1125.14,-651.47 1128.08,-645.12"/>
</g>
<!-- gpu2_l8_expert1&#45;&gt;gpu2_l8_expert_agg -->
<g id="edge67" class="edge">
<title>gpu2_l8_expert1&#45;&gt;gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M764.31,-730.36C808.37,-708.92 878.68,-674.7 935.04,-647.27"/>
<polygon fill="black" stroke="black" points="936.86,-650.27 944.31,-642.75 933.79,-643.98 936.86,-650.27"/>
</g>
<!-- gpu2_l8_expert2&#45;&gt;gpu2_l8_expert_agg -->
<g id="edge68" class="edge">
<title>gpu2_l8_expert2&#45;&gt;gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M894.31,-730.21C915.36,-709.72 948.28,-677.68 975.68,-651"/>
<polygon fill="black" stroke="black" points="978.16,-653.48 982.88,-643.99 973.27,-648.46 978.16,-653.48"/>
</g>
<!-- gpu2_l8_expert3&#45;&gt;gpu2_l8_expert_agg -->
<g id="edge69" class="edge">
<title>gpu2_l8_expert3&#45;&gt;gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M1024,-730.21C1024,-710.51 1024,-680.12 1024,-654.09"/>
<polygon fill="black" stroke="black" points="1027.5,-653.99 1024,-643.99 1020.5,-653.99 1027.5,-653.99"/>
</g>
<!-- gpu2_output_proj -->
<g id="node55" class="node">
<title>gpu2_output_proj</title>
<polygon fill="lightblue" stroke="black" points="1088,-496.47 960,-496.47 960,-453.47 1088,-453.47 1088,-496.47"/>
<text text-anchor="middle" x="1024" y="-483.47" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="1024" y="-472.47" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="1024" y="-461.47" font-family="Arial" font-size="10.00">Output: [128, 10240, 512]</text>
</g>
<!-- gpu2_l8_expert_agg&#45;&gt;gpu2_output_proj -->
<g id="edge71" class="edge">
<title>gpu2_l8_expert_agg&#45;&gt;gpu2_output_proj</title>
<path fill="none" stroke="black" d="M1024,-561.75C1024,-544.03 1024,-523.52 1024,-507.01"/>
<polygon fill="black" stroke="black" points="1027.5,-506.8 1024,-496.8 1020.5,-506.8 1027.5,-506.8"/>
</g>
<!-- prefill_output -->
<g id="node146" class="node">
<title>prefill_output</title>
<ellipse fill="lightgreen" stroke="black" cx="1024" cy="-123.97" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1024" y="-132.47" font-family="Arial" font-size="10.00">Prefill Output</text>
<text text-anchor="middle" x="1024" y="-121.47" font-family="Arial" font-size="10.00">Input: [128, 10240, 512]</text>
<text text-anchor="middle" x="1024" y="-110.47" font-family="Arial" font-size="10.00">Output: [128, 10240, 512]</text>
</g>
<!-- gpu2_output_proj&#45;&gt;prefill_output -->
<g id="edge96" class="edge">
<title>gpu2_output_proj&#45;&gt;prefill_output</title>
<path fill="none" stroke="black" d="M1024,-453.44C1024,-396.69 1024,-237.02 1024,-163.24"/>
<polygon fill="black" stroke="black" points="1027.5,-163 1024,-153 1020.5,-163 1027.5,-163"/>
</g>
<!-- gpu3_l8_ln1 -->
<g id="node57" class="node">
<title>gpu3_l8_ln1</title>
<polygon fill="lightblue" stroke="black" points="457,-1561.39 329,-1561.39 329,-1518.39 457,-1518.39 457,-1561.39"/>
<text text-anchor="middle" x="393" y="-1548.39" font-family="Arial" font-size="10.00">LayerNorm1 L8</text>
<text text-anchor="middle" x="393" y="-1537.39" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="393" y="-1526.39" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_recv&#45;&gt;gpu3_l8_ln1 -->
<g id="edge72" class="edge">
<title>gpu3_recv&#45;&gt;gpu3_l8_ln1</title>
<path fill="none" stroke="black" d="M393,-1624.61C393,-1608.56 393,-1588.44 393,-1571.95"/>
<polygon fill="black" stroke="black" points="396.5,-1571.71 393,-1561.71 389.5,-1571.71 396.5,-1571.71"/>
</g>
<!-- gpu3_l8_attn_q -->
<g id="node58" class="node">
<title>gpu3_l8_attn_q</title>
<polygon fill="lightblue" stroke="black" points="457,-1431.9 329,-1431.9 329,-1388.9 457,-1388.9 457,-1431.9"/>
<text text-anchor="middle" x="393" y="-1418.9" font-family="Arial" font-size="10.00">Attention Q Proj L8</text>
<text text-anchor="middle" x="393" y="-1407.9" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="393" y="-1396.9" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_q -->
<g id="edge73" class="edge">
<title>gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_q</title>
<path fill="none" stroke="black" d="M393,-1518.12C393,-1497.56 393,-1465.84 393,-1442.32"/>
<polygon fill="black" stroke="black" points="396.5,-1442.16 393,-1432.16 389.5,-1442.16 396.5,-1442.16"/>
</g>
<!-- gpu3_l8_attn_k -->
<g id="node59" class="node">
<title>gpu3_l8_attn_k</title>
<polygon fill="lightblue" stroke="black" points="311,-1431.9 183,-1431.9 183,-1388.9 311,-1388.9 311,-1431.9"/>
<text text-anchor="middle" x="247" y="-1418.9" font-family="Arial" font-size="10.00">Attention K Proj L8</text>
<text text-anchor="middle" x="247" y="-1407.9" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="247" y="-1396.9" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_k -->
<g id="edge74" class="edge">
<title>gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_k</title>
<path fill="none" stroke="black" d="M369.22,-1518.12C344.51,-1496.54 305.71,-1462.67 278.48,-1438.88"/>
<polygon fill="black" stroke="black" points="280.61,-1436.1 270.77,-1432.16 276,-1441.37 280.61,-1436.1"/>
</g>
<!-- gpu3_l8_attn_v -->
<g id="node60" class="node">
<title>gpu3_l8_attn_v</title>
<polygon fill="lightblue" stroke="black" points="540,-1370.9 412,-1370.9 412,-1327.9 540,-1327.9 540,-1370.9"/>
<text text-anchor="middle" x="476" y="-1357.9" font-family="Arial" font-size="10.00">Attention V Proj L8</text>
<text text-anchor="middle" x="476" y="-1346.9" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="476" y="-1335.9" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_v -->
<g id="edge75" class="edge">
<title>gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_v</title>
<path fill="none" stroke="black" d="M411.72,-1518.08C428.91,-1497.69 453.55,-1464.93 466,-1431.9 472.05,-1415.86 474.62,-1396.9 475.65,-1381.31"/>
<polygon fill="black" stroke="black" points="479.15,-1381.29 476.14,-1371.13 472.16,-1380.95 479.15,-1381.29"/>
</g>
<!-- gpu3_l8_attn_score -->
<g id="node61" class="node">
<title>gpu3_l8_attn_score</title>
<polygon fill="lightblue" stroke="black" points="457,-1309.9 329,-1309.9 329,-1266.9 457,-1266.9 457,-1309.9"/>
<text text-anchor="middle" x="393" y="-1296.9" font-family="Arial" font-size="10.00">Attention Score L8</text>
<text text-anchor="middle" x="393" y="-1285.9" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="393" y="-1274.9" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_l8_attn_q&#45;&gt;gpu3_l8_attn_score -->
<g id="edge76" class="edge">
<title>gpu3_l8_attn_q&#45;&gt;gpu3_l8_attn_score</title>
<path fill="none" stroke="black" d="M393,-1388.77C393,-1369.96 393,-1341.93 393,-1320.42"/>
<polygon fill="black" stroke="black" points="396.5,-1320.16 393,-1310.16 389.5,-1320.16 396.5,-1320.16"/>
</g>
<!-- gpu3_l8_attn_k&#45;&gt;gpu3_l8_attn_score -->
<g id="edge77" class="edge">
<title>gpu3_l8_attn_k&#45;&gt;gpu3_l8_attn_score</title>
<path fill="none" stroke="black" d="M272.1,-1388.77C296.33,-1368.85 333.18,-1338.56 359.82,-1316.66"/>
<polygon fill="black" stroke="black" points="362.24,-1319.21 367.74,-1310.16 357.79,-1313.8 362.24,-1319.21"/>
</g>
<!-- gpu3_l8_attn_softmax -->
<g id="node62" class="node">
<title>gpu3_l8_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="499,-1187.9 371,-1187.9 371,-1144.9 499,-1144.9 499,-1187.9"/>
<text text-anchor="middle" x="435" y="-1174.9" font-family="Arial" font-size="10.00">Attention Softmax L8</text>
<text text-anchor="middle" x="435" y="-1163.9" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="435" y="-1152.9" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_l8_attn_v&#45;&gt;gpu3_l8_attn_softmax -->
<g id="edge78" class="edge">
<title>gpu3_l8_attn_v&#45;&gt;gpu3_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M474.5,-1327.79C473.05,-1311.21 470.41,-1287.38 466,-1266.9 460.91,-1243.25 452.68,-1217.16 445.98,-1197.64"/>
<polygon fill="black" stroke="black" points="449.24,-1196.36 442.64,-1188.07 442.63,-1198.66 449.24,-1196.36"/>
</g>
<!-- gpu3_l8_attn_score&#45;&gt;gpu3_l8_attn_softmax -->
<g id="edge79" class="edge">
<title>gpu3_l8_attn_score&#45;&gt;gpu3_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M400.22,-1266.77C406.86,-1247.79 416.79,-1219.41 424.35,-1197.83"/>
<polygon fill="black" stroke="black" points="427.73,-1198.75 427.73,-1188.16 421.13,-1196.44 427.73,-1198.75"/>
</g>
<!-- gpu3_l8_attn_out -->
<g id="node63" class="node">
<title>gpu3_l8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="499,-1100.41 371,-1100.41 371,-1057.41 499,-1057.41 499,-1100.41"/>
<text text-anchor="middle" x="435" y="-1087.41" font-family="Arial" font-size="10.00">Attention Out Proj L8</text>
<text text-anchor="middle" x="435" y="-1076.41" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="435" y="-1065.41" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_l8_attn_softmax&#45;&gt;gpu3_l8_attn_out -->
<g id="edge80" class="edge">
<title>gpu3_l8_attn_softmax&#45;&gt;gpu3_l8_attn_out</title>
<path fill="none" stroke="black" d="M435,-1144.7C435,-1134.52 435,-1122.03 435,-1110.75"/>
<polygon fill="black" stroke="black" points="438.5,-1110.41 435,-1100.41 431.5,-1110.41 438.5,-1110.41"/>
</g>
<!-- gpu3_l8_attn_ar -->
<g id="node64" class="node">
<title>gpu3_l8_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="435" cy="-983.92" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="435" y="-992.42" font-family="Arial" font-size="10.00">TP All&#45;Reduce L8</text>
<text text-anchor="middle" x="435" y="-981.42" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="435" y="-970.42" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_l8_attn_out&#45;&gt;gpu3_l8_attn_ar -->
<g id="edge81" class="edge">
<title>gpu3_l8_attn_out&#45;&gt;gpu3_l8_attn_ar</title>
<path fill="none" stroke="black" d="M435,-1057.27C435,-1047.36 435,-1035.14 435,-1023.59"/>
<polygon fill="black" stroke="black" points="438.5,-1023.26 435,-1013.26 431.5,-1023.26 438.5,-1023.26"/>
</g>
<!-- gpu3_l8_ln2 -->
<g id="node65" class="node">
<title>gpu3_l8_ln2</title>
<polygon fill="lightblue" stroke="black" points="499,-910.44 371,-910.44 371,-867.44 499,-867.44 499,-910.44"/>
<text text-anchor="middle" x="435" y="-897.44" font-family="Arial" font-size="10.00">LayerNorm2 L8</text>
<text text-anchor="middle" x="435" y="-886.44" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="435" y="-875.44" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_l8_attn_ar&#45;&gt;gpu3_l8_ln2 -->
<g id="edge82" class="edge">
<title>gpu3_l8_attn_ar&#45;&gt;gpu3_l8_ln2</title>
<path fill="none" stroke="black" d="M435,-954.77C435,-944 435,-931.66 435,-920.66"/>
<polygon fill="black" stroke="black" points="438.5,-920.61 435,-910.61 431.5,-920.61 438.5,-920.61"/>
</g>
<!-- gpu3_l8_gate -->
<g id="node66" class="node">
<title>gpu3_l8_gate</title>
<polygon fill="lightblue" stroke="black" points="608,-704.97 488,-704.97 488,-661.97 608,-661.97 608,-704.97"/>
<text text-anchor="middle" x="548" y="-691.97" font-family="Arial" font-size="10.00">Gate Router L8</text>
<text text-anchor="middle" x="548" y="-680.97" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="548" y="-669.97" font-family="Arial" font-size="10.00">Output: [128, 10240, 8]</text>
</g>
<!-- gpu3_l8_ln2&#45;&gt;gpu3_l8_gate -->
<g id="edge83" class="edge">
<title>gpu3_l8_ln2&#45;&gt;gpu3_l8_gate</title>
<path fill="none" stroke="black" d="M454.31,-867.31C472.63,-846.78 499.85,-813.71 517,-780.95 527.93,-760.07 535.91,-734.63 541.03,-715.12"/>
<polygon fill="black" stroke="black" points="544.47,-715.78 543.52,-705.23 537.69,-714.08 544.47,-715.78"/>
</g>
<!-- gpu3_ep_a2a_send -->
<g id="node72" class="node">
<title>gpu3_ep_a2a_send</title>
<ellipse fill="red" stroke="black" cx="417" cy="-751.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="417" y="-760.46" font-family="Arial" font-size="10.00">EP All&#45;to&#45;All Send L8</text>
<text text-anchor="middle" x="417" y="-749.46" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="417" y="-738.46" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_l8_ln2&#45;&gt;gpu3_ep_a2a_send -->
<g id="edge84" class="edge">
<title>gpu3_l8_ln2&#45;&gt;gpu3_ep_a2a_send</title>
<path fill="none" stroke="black" d="M432.27,-867.44C429.58,-847.3 425.42,-816.09 422.12,-791.34"/>
<polygon fill="black" stroke="black" points="425.55,-790.63 420.76,-781.18 418.62,-791.56 425.55,-790.63"/>
</g>
<!-- gpu3_l8_expert_agg -->
<g id="node71" class="node">
<title>gpu3_l8_expert_agg</title>
<polygon fill="yellow" stroke="black" points="558.91,-396.97 347.48,-396.97 293.09,-314.97 504.52,-314.97 558.91,-396.97"/>
<text text-anchor="middle" x="426" y="-364.47" font-family="Arial" font-size="10.00">Expert Aggregation L8</text>
<text text-anchor="middle" x="426" y="-353.47" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="426" y="-342.47" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_l8_gate&#45;&gt;gpu3_l8_expert_agg -->
<g id="edge94" class="edge">
<title>gpu3_l8_gate&#45;&gt;gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M557.5,-661.8C576.33,-620.65 616.87,-531.08 620,-515.97 627.39,-480.28 640.47,-464.12 620,-433.97 604.88,-411.7 582.21,-395.88 557.64,-384.63"/>
<polygon fill="black" stroke="black" points="558.71,-381.28 548.14,-380.53 555.94,-387.7 558.71,-381.28"/>
<text text-anchor="middle" x="627.5" y="-536.77" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- gpu3_l8_expert8 -->
<g id="node67" class="node">
<title>gpu3_l8_expert8</title>
<polygon fill="lightblue" stroke="black" points="157.5,-496.47 24.5,-496.47 24.5,-453.47 157.5,-453.47 157.5,-496.47"/>
<text text-anchor="middle" x="91" y="-483.47" font-family="Arial" font-size="10.00">Expert 8 FC L8</text>
<text text-anchor="middle" x="91" y="-472.47" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="91" y="-461.47" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu3_l8_expert8&#45;&gt;gpu3_l8_expert_agg -->
<g id="edge90" class="edge">
<title>gpu3_l8_expert8&#45;&gt;gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M126.65,-453.36C139.16,-446.63 153.47,-439.48 167,-433.97 218.11,-413.15 276.94,-395.21 325.61,-381.89"/>
<polygon fill="black" stroke="black" points="326.78,-385.2 335.51,-379.2 324.95,-378.44 326.78,-385.2"/>
</g>
<!-- gpu3_l8_expert9 -->
<g id="node68" class="node">
<title>gpu3_l8_expert9</title>
<polygon fill="lightblue" stroke="black" points="308.5,-496.47 175.5,-496.47 175.5,-453.47 308.5,-453.47 308.5,-496.47"/>
<text text-anchor="middle" x="242" y="-483.47" font-family="Arial" font-size="10.00">Expert 9 FC L8</text>
<text text-anchor="middle" x="242" y="-472.47" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="242" y="-461.47" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu3_l8_expert9&#45;&gt;gpu3_l8_expert_agg -->
<g id="edge91" class="edge">
<title>gpu3_l8_expert9&#45;&gt;gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M274.47,-453.32C296.63,-439.23 326.86,-420 354.5,-402.43"/>
<polygon fill="black" stroke="black" points="356.42,-405.36 362.98,-397.04 352.66,-399.45 356.42,-405.36"/>
</g>
<!-- gpu3_l8_expert10 -->
<g id="node69" class="node">
<title>gpu3_l8_expert10</title>
<polygon fill="lightblue" stroke="black" points="459.5,-496.47 326.5,-496.47 326.5,-453.47 459.5,-453.47 459.5,-496.47"/>
<text text-anchor="middle" x="393" y="-483.47" font-family="Arial" font-size="10.00">Expert 10 FC L8</text>
<text text-anchor="middle" x="393" y="-472.47" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="393" y="-461.47" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu3_l8_expert10&#45;&gt;gpu3_l8_expert_agg -->
<g id="edge92" class="edge">
<title>gpu3_l8_expert10&#45;&gt;gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M398.82,-453.32C402.44,-440.5 407.26,-423.42 411.83,-407.21"/>
<polygon fill="black" stroke="black" points="415.28,-407.85 414.63,-397.28 408.55,-405.95 415.28,-407.85"/>
</g>
<!-- gpu3_l8_expert11 -->
<g id="node70" class="node">
<title>gpu3_l8_expert11</title>
<polygon fill="lightblue" stroke="black" points="610.5,-496.47 477.5,-496.47 477.5,-453.47 610.5,-453.47 610.5,-496.47"/>
<text text-anchor="middle" x="544" y="-483.47" font-family="Arial" font-size="10.00">Expert 11 FC L8</text>
<text text-anchor="middle" x="544" y="-472.47" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="544" y="-461.47" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- gpu3_l8_expert11&#45;&gt;gpu3_l8_expert_agg -->
<g id="edge93" class="edge">
<title>gpu3_l8_expert11&#45;&gt;gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M523.18,-453.32C509.51,-439.77 491.06,-421.48 473.91,-404.47"/>
<polygon fill="black" stroke="black" points="476.22,-401.83 466.66,-397.28 471.29,-406.81 476.22,-401.83"/>
</g>
<!-- gpu3_output_proj -->
<g id="node74" class="node">
<title>gpu3_output_proj</title>
<polygon fill="lightblue" stroke="black" points="544,-258.47 416,-258.47 416,-215.47 544,-215.47 544,-258.47"/>
<text text-anchor="middle" x="480" y="-245.47" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="480" y="-234.47" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="480" y="-223.47" font-family="Arial" font-size="10.00">Output: [128, 10240, 512]</text>
</g>
<!-- gpu3_l8_expert_agg&#45;&gt;gpu3_output_proj -->
<g id="edge95" class="edge">
<title>gpu3_l8_expert_agg&#45;&gt;gpu3_output_proj</title>
<path fill="none" stroke="black" d="M444.58,-314.7C451.67,-299.34 459.62,-282.12 466.19,-267.88"/>
<polygon fill="black" stroke="black" points="469.48,-269.12 470.49,-258.57 463.12,-266.18 469.48,-269.12"/>
</g>
<!-- gpu3_ep_a2a_recv -->
<g id="node73" class="node">
<title>gpu3_ep_a2a_recv</title>
<ellipse fill="red" stroke="black" cx="393" cy="-602.97" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="393" y="-611.47" font-family="Arial" font-size="10.00">EP All&#45;to&#45;All Recv L8</text>
<text text-anchor="middle" x="393" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, 10240, 256]</text>
<text text-anchor="middle" x="393" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, 10240, 256]</text>
</g>
<!-- gpu3_ep_a2a_send&#45;&gt;gpu3_ep_a2a_recv -->
<g id="edge85" class="edge">
<title>gpu3_ep_a2a_send&#45;&gt;gpu3_ep_a2a_recv</title>
<path fill="none" stroke="black" d="M412.43,-722.96C408.7,-700.12 403.39,-667.61 399.27,-642.34"/>
<polygon fill="black" stroke="black" points="402.7,-641.66 397.64,-632.36 395.79,-642.79 402.7,-641.66"/>
</g>
<!-- gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert8 -->
<g id="edge86" class="edge">
<title>gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert8</title>
<path fill="none" stroke="black" d="M332.72,-581.27C286.72,-564.94 222.1,-540.84 167,-515.97 157.22,-511.55 146.93,-506.45 137.19,-501.41"/>
<polygon fill="black" stroke="black" points="138.53,-498.16 128.05,-496.61 135.28,-504.36 138.53,-498.16"/>
</g>
<!-- gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert9 -->
<g id="edge87" class="edge">
<title>gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert9</title>
<path fill="none" stroke="black" d="M361.35,-575.55C335.91,-554.32 300.3,-524.62 274.61,-503.18"/>
<polygon fill="black" stroke="black" points="276.57,-500.25 266.65,-496.53 272.08,-505.62 276.57,-500.25"/>
</g>
<!-- gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert10 -->
<g id="edge88" class="edge">
<title>gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert10</title>
<path fill="none" stroke="black" d="M393,-573.69C393,-553.79 393,-527.18 393,-506.75"/>
<polygon fill="black" stroke="black" points="396.5,-506.7 393,-496.7 389.5,-506.7 396.5,-506.7"/>
</g>
<!-- gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert11 -->
<g id="edge89" class="edge">
<title>gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert11</title>
<path fill="none" stroke="black" d="M424.65,-575.55C450.09,-554.32 485.7,-524.62 511.39,-503.18"/>
<polygon fill="black" stroke="black" points="513.92,-505.62 519.35,-496.53 509.43,-500.25 513.92,-505.62"/>
</g>
<!-- gpu3_output_proj&#45;&gt;prefill_output -->
<g id="edge97" class="edge">
<title>gpu3_output_proj&#45;&gt;prefill_output</title>
<path fill="none" stroke="black" d="M544,-222.91C642.05,-202.9 829.55,-164.65 938.93,-142.33"/>
<polygon fill="black" stroke="black" points="939.84,-145.72 948.94,-140.29 938.44,-138.86 939.84,-145.72"/>
</g>
<!-- dec_gpu0_l0_attn_q -->
<g id="node76" class="node">
<title>dec_gpu0_l0_attn_q</title>
<polygon fill="lightblue" stroke="black" points="3475.5,-3113.78 3294.5,-3113.78 3294.5,-3070.78 3475.5,-3070.78 3475.5,-3113.78"/>
<text text-anchor="middle" x="3385" y="-3100.78" font-family="Arial" font-size="10.00">Decode Attn Q Proj L0</text>
<text text-anchor="middle" x="3385" y="-3089.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3385" y="-3078.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu0_l0_ln1&#45;&gt;dec_gpu0_l0_attn_q -->
<g id="edge100" class="edge">
<title>dec_gpu0_l0_ln1&#45;&gt;dec_gpu0_l0_attn_q</title>
<path fill="none" stroke="black" d="M3552.4,-3218.21C3532.76,-3205.23 3507.13,-3187.92 3485,-3171.78 3462.22,-3155.16 3437.27,-3135.58 3418,-3120.13"/>
<polygon fill="black" stroke="black" points="3420.09,-3117.32 3410.1,-3113.78 3415.7,-3122.78 3420.09,-3117.32"/>
</g>
<!-- dec_gpu0_l0_attn_k -->
<g id="node77" class="node">
<title>dec_gpu0_l0_attn_k</title>
<polygon fill="lightblue" stroke="black" points="3674.5,-3113.78 3493.5,-3113.78 3493.5,-3070.78 3674.5,-3070.78 3674.5,-3113.78"/>
<text text-anchor="middle" x="3584" y="-3100.78" font-family="Arial" font-size="10.00">Decode Attn K Proj L0</text>
<text text-anchor="middle" x="3584" y="-3089.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3584" y="-3078.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu0_l0_ln1&#45;&gt;dec_gpu0_l0_attn_k -->
<g id="edge101" class="edge">
<title>dec_gpu0_l0_ln1&#45;&gt;dec_gpu0_l0_attn_k</title>
<path fill="none" stroke="black" d="M3584,-3218.24C3584,-3193.79 3584,-3152.71 3584,-3124.36"/>
<polygon fill="black" stroke="black" points="3587.5,-3124.18 3584,-3114.18 3580.5,-3124.18 3587.5,-3124.18"/>
</g>
<!-- dec_gpu0_l0_attn_v -->
<g id="node78" class="node">
<title>dec_gpu0_l0_attn_v</title>
<polygon fill="lightblue" stroke="black" points="3365.5,-3052.78 3184.5,-3052.78 3184.5,-3009.78 3365.5,-3009.78 3365.5,-3052.78"/>
<text text-anchor="middle" x="3275" y="-3039.78" font-family="Arial" font-size="10.00">Decode Attn V Proj L0</text>
<text text-anchor="middle" x="3275" y="-3028.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3275" y="-3017.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu0_l0_ln1&#45;&gt;dec_gpu0_l0_attn_v -->
<g id="edge102" class="edge">
<title>dec_gpu0_l0_ln1&#45;&gt;dec_gpu0_l0_attn_v</title>
<path fill="none" stroke="black" d="M3539.96,-3218.24C3523.09,-3211.11 3503.45,-3203.67 3485,-3198.78 3441.87,-3187.33 3316.66,-3204.21 3286,-3171.78 3258.86,-3143.07 3261.76,-3094.54 3267.49,-3062.96"/>
<polygon fill="black" stroke="black" points="3270.96,-3063.45 3269.5,-3052.95 3264.1,-3062.07 3270.96,-3063.45"/>
</g>
<!-- dec_gpu0_l0_attn_score -->
<g id="node79" class="node">
<title>dec_gpu0_l0_attn_score</title>
<polygon fill="lightblue" stroke="black" points="3475.5,-2991.78 3294.5,-2991.78 3294.5,-2948.78 3475.5,-2948.78 3475.5,-2991.78"/>
<text text-anchor="middle" x="3385" y="-2978.78" font-family="Arial" font-size="10.00">Decode Attn Score L0</text>
<text text-anchor="middle" x="3385" y="-2967.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3385" y="-2956.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu0_l0_attn_q&#45;&gt;dec_gpu0_l0_attn_score -->
<g id="edge103" class="edge">
<title>dec_gpu0_l0_attn_q&#45;&gt;dec_gpu0_l0_attn_score</title>
<path fill="none" stroke="black" d="M3385,-3070.65C3385,-3051.84 3385,-3023.81 3385,-3002.3"/>
<polygon fill="black" stroke="black" points="3388.5,-3002.04 3385,-2992.04 3381.5,-3002.04 3388.5,-3002.04"/>
</g>
<!-- dec_gpu0_l0_attn_k&#45;&gt;dec_gpu0_l0_attn_score -->
<g id="edge104" class="edge">
<title>dec_gpu0_l0_attn_k&#45;&gt;dec_gpu0_l0_attn_score</title>
<path fill="none" stroke="black" d="M3549.79,-3070.65C3516.09,-3050.32 3464.49,-3019.21 3428.02,-2997.22"/>
<polygon fill="black" stroke="black" points="3429.47,-2994 3419.1,-2991.84 3425.85,-3000 3429.47,-2994"/>
</g>
<!-- dec_gpu0_l0_attn_softmax -->
<g id="node80" class="node">
<title>dec_gpu0_l0_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="3365.5,-2869.78 3184.5,-2869.78 3184.5,-2826.78 3365.5,-2826.78 3365.5,-2869.78"/>
<text text-anchor="middle" x="3275" y="-2856.78" font-family="Arial" font-size="10.00">Decode Attn Softmax L0</text>
<text text-anchor="middle" x="3275" y="-2845.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3275" y="-2834.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu0_l0_attn_v&#45;&gt;dec_gpu0_l0_attn_softmax -->
<g id="edge105" class="edge">
<title>dec_gpu0_l0_attn_v&#45;&gt;dec_gpu0_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M3275,-3009.51C3275,-2977.74 3275,-2916.85 3275,-2879.97"/>
<polygon fill="black" stroke="black" points="3278.5,-2879.8 3275,-2869.8 3271.5,-2879.8 3278.5,-2879.8"/>
</g>
<!-- dec_gpu0_l0_attn_score&#45;&gt;dec_gpu0_l0_attn_softmax -->
<g id="edge106" class="edge">
<title>dec_gpu0_l0_attn_score&#45;&gt;dec_gpu0_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M3366.09,-2948.65C3348.15,-2929.07 3321.03,-2899.48 3301.04,-2877.68"/>
<polygon fill="black" stroke="black" points="3303.37,-2875.04 3294.03,-2870.04 3298.21,-2879.77 3303.37,-2875.04"/>
</g>
<!-- dec_gpu0_l0_attn_out -->
<g id="node81" class="node">
<title>dec_gpu0_l0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3363.5,-2789.78 3182.5,-2789.78 3182.5,-2746.78 3363.5,-2746.78 3363.5,-2789.78"/>
<text text-anchor="middle" x="3273" y="-2776.78" font-family="Arial" font-size="10.00">Decode Attn Out Proj L0</text>
<text text-anchor="middle" x="3273" y="-2765.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3273" y="-2754.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu0_l0_attn_softmax&#45;&gt;dec_gpu0_l0_attn_out -->
<g id="edge107" class="edge">
<title>dec_gpu0_l0_attn_softmax&#45;&gt;dec_gpu0_l0_attn_out</title>
<path fill="none" stroke="black" d="M3274.46,-2826.37C3274.26,-2818.26 3274.01,-2808.81 3273.79,-2799.96"/>
<polygon fill="black" stroke="black" points="3277.29,-2799.87 3273.53,-2789.97 3270.29,-2800.05 3277.29,-2799.87"/>
</g>
<!-- dec_gpu0_l0_attn_ar -->
<g id="node82" class="node">
<title>dec_gpu0_l0_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="3207" cy="-2680.78" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="3207" y="-2689.28" font-family="Arial" font-size="10.00">Decode TP All&#45;Reduce L0</text>
<text text-anchor="middle" x="3207" y="-2678.28" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3207" y="-2667.28" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu0_l0_attn_out&#45;&gt;dec_gpu0_l0_attn_ar -->
<g id="edge108" class="edge">
<title>dec_gpu0_l0_attn_out&#45;&gt;dec_gpu0_l0_attn_ar</title>
<path fill="none" stroke="black" d="M3257.02,-2746.58C3250.29,-2737.86 3242.25,-2727.44 3234.61,-2717.54"/>
<polygon fill="black" stroke="black" points="3237.2,-2715.17 3228.32,-2709.4 3231.66,-2719.45 3237.2,-2715.17"/>
</g>
<!-- dec_gpu0_l0_ln2 -->
<g id="node83" class="node">
<title>dec_gpu0_l0_ln2</title>
<polygon fill="lightblue" stroke="black" points="3262.5,-2607.3 3081.5,-2607.3 3081.5,-2564.3 3262.5,-2564.3 3262.5,-2607.3"/>
<text text-anchor="middle" x="3172" y="-2594.3" font-family="Arial" font-size="10.00">Decode LayerNorm2 L0</text>
<text text-anchor="middle" x="3172" y="-2583.3" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3172" y="-2572.3" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu0_l0_attn_ar&#45;&gt;dec_gpu0_l0_ln2 -->
<g id="edge109" class="edge">
<title>dec_gpu0_l0_attn_ar&#45;&gt;dec_gpu0_l0_ln2</title>
<path fill="none" stroke="black" d="M3196.5,-2651.89C3192.36,-2640.88 3187.59,-2628.21 3183.36,-2616.99"/>
<polygon fill="black" stroke="black" points="3186.62,-2615.71 3179.82,-2607.58 3180.07,-2618.18 3186.62,-2615.71"/>
</g>
<!-- dec_gpu0_send -->
<g id="node90" class="node">
<title>dec_gpu0_send</title>
<ellipse fill="purple" stroke="black" cx="3150" cy="-2490.82" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="3150" y="-2499.32" font-family="Arial" font-size="10.00">Decode Send to PP1</text>
<text text-anchor="middle" x="3150" y="-2488.32" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3150" y="-2477.32" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu0_l0_ln2&#45;&gt;dec_gpu0_send -->
<g id="edge110" class="edge">
<title>dec_gpu0_l0_ln2&#45;&gt;dec_gpu0_send</title>
<path fill="none" stroke="black" d="M3167.12,-2564.17C3164.73,-2554.07 3161.78,-2541.59 3159,-2529.85"/>
<polygon fill="black" stroke="black" points="3162.33,-2528.73 3156.62,-2519.8 3155.52,-2530.34 3162.33,-2528.73"/>
</g>
<!-- dec_gpu0_l0_gate -->
<g id="node84" class="node">
<title>dec_gpu0_l0_gate</title>
<polygon fill="lightblue" stroke="black" points="3475.5,-3261.28 3302.5,-3261.28 3302.5,-3218.28 3475.5,-3218.28 3475.5,-3261.28"/>
<text text-anchor="middle" x="3389" y="-3248.28" font-family="Arial" font-size="10.00">Decode Gate Router L0</text>
<text text-anchor="middle" x="3389" y="-3237.28" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3389" y="-3226.28" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 8]</text>
</g>
<!-- dec_gpu0_l0_expert0 -->
<g id="node85" class="node">
<title>dec_gpu0_l0_expert0</title>
<polygon fill="lightblue" stroke="black" points="3284.5,-3261.28 3111.5,-3261.28 3111.5,-3218.28 3284.5,-3218.28 3284.5,-3261.28"/>
<text text-anchor="middle" x="3198" y="-3248.28" font-family="Arial" font-size="10.00">Decode Expert 0 FC L0</text>
<text text-anchor="middle" x="3198" y="-3237.28" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3198" y="-3226.28" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu0_l0_expert1 -->
<g id="node86" class="node">
<title>dec_gpu0_l0_expert1</title>
<polygon fill="lightblue" stroke="black" points="3093.5,-3261.28 2920.5,-3261.28 2920.5,-3218.28 3093.5,-3218.28 3093.5,-3261.28"/>
<text text-anchor="middle" x="3007" y="-3248.28" font-family="Arial" font-size="10.00">Decode Expert 1 FC L0</text>
<text text-anchor="middle" x="3007" y="-3237.28" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3007" y="-3226.28" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu0_l0_expert2 -->
<g id="node87" class="node">
<title>dec_gpu0_l0_expert2</title>
<polygon fill="lightblue" stroke="black" points="2902.5,-3261.28 2729.5,-3261.28 2729.5,-3218.28 2902.5,-3218.28 2902.5,-3261.28"/>
<text text-anchor="middle" x="2816" y="-3248.28" font-family="Arial" font-size="10.00">Decode Expert 2 FC L0</text>
<text text-anchor="middle" x="2816" y="-3237.28" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2816" y="-3226.28" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu0_l0_expert3 -->
<g id="node88" class="node">
<title>dec_gpu0_l0_expert3</title>
<polygon fill="lightblue" stroke="black" points="2711.5,-3261.28 2538.5,-3261.28 2538.5,-3218.28 2711.5,-3218.28 2711.5,-3261.28"/>
<text text-anchor="middle" x="2625" y="-3248.28" font-family="Arial" font-size="10.00">Decode Expert 3 FC L0</text>
<text text-anchor="middle" x="2625" y="-3237.28" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2625" y="-3226.28" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu0_l0_expert_agg -->
<g id="node89" class="node">
<title>dec_gpu0_l0_expert_agg</title>
<polygon fill="yellow" stroke="black" points="2520.45,-3280.78 2274.75,-3280.78 2211.55,-3198.78 2457.25,-3198.78 2520.45,-3280.78"/>
<text text-anchor="middle" x="2366" y="-3248.28" font-family="Arial" font-size="10.00">Decode Expert Aggregation L0</text>
<text text-anchor="middle" x="2366" y="-3237.28" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, 1024]</text>
<text text-anchor="middle" x="2366" y="-3226.28" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 256]</text>
</g>
<!-- dec_gpu2_recv -->
<g id="node109" class="node">
<title>dec_gpu2_recv</title>
<ellipse fill="purple" stroke="black" cx="3021" cy="-1539.89" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="3021" y="-1548.39" font-family="Arial" font-size="10.00">Decode Recv from PP0</text>
<text text-anchor="middle" x="3021" y="-1537.39" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3021" y="-1526.39" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu0_send&#45;&gt;dec_gpu2_recv -->
<g id="edge135" class="edge">
<title>dec_gpu0_send&#45;&gt;dec_gpu2_recv</title>
<path fill="none" stroke="black" d="M3100.86,-2463.87C3064.41,-2440.68 3021,-2402.97 3021,-2354.84 3021,-2354.84 3021,-2354.84 3021,-1652.87 3021,-1628.31 3021,-1600.72 3021,-1579.07"/>
<polygon fill="black" stroke="black" points="3024.5,-1578.96 3021,-1568.96 3017.5,-1578.96 3024.5,-1578.96"/>
</g>
<!-- dec_gpu1_l0_attn_q -->
<g id="node92" class="node">
<title>dec_gpu1_l0_attn_q</title>
<polygon fill="lightblue" stroke="black" points="1988.5,-3113.78 1807.5,-3113.78 1807.5,-3070.78 1988.5,-3070.78 1988.5,-3113.78"/>
<text text-anchor="middle" x="1898" y="-3100.78" font-family="Arial" font-size="10.00">Decode Attn Q Proj L0</text>
<text text-anchor="middle" x="1898" y="-3089.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1898" y="-3078.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu1_l0_ln1&#45;&gt;dec_gpu1_l0_attn_q -->
<g id="edge112" class="edge">
<title>dec_gpu1_l0_ln1&#45;&gt;dec_gpu1_l0_attn_q</title>
<path fill="none" stroke="black" d="M1983.88,-3218.24C1966.71,-3193.25 1937.6,-3150.89 1918.09,-3122.51"/>
<polygon fill="black" stroke="black" points="1920.92,-3120.44 1912.37,-3114.18 1915.15,-3124.4 1920.92,-3120.44"/>
</g>
<!-- dec_gpu1_l0_attn_k -->
<g id="node93" class="node">
<title>dec_gpu1_l0_attn_k</title>
<polygon fill="lightblue" stroke="black" points="2187.5,-3113.78 2006.5,-3113.78 2006.5,-3070.78 2187.5,-3070.78 2187.5,-3113.78"/>
<text text-anchor="middle" x="2097" y="-3100.78" font-family="Arial" font-size="10.00">Decode Attn K Proj L0</text>
<text text-anchor="middle" x="2097" y="-3089.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2097" y="-3078.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu1_l0_ln1&#45;&gt;dec_gpu1_l0_attn_k -->
<g id="edge113" class="edge">
<title>dec_gpu1_l0_ln1&#45;&gt;dec_gpu1_l0_attn_k</title>
<path fill="none" stroke="black" d="M2011.97,-3218.24C2028.98,-3193.25 2057.8,-3150.89 2077.11,-3122.51"/>
<polygon fill="black" stroke="black" points="2080.04,-3124.42 2082.78,-3114.18 2074.26,-3120.48 2080.04,-3124.42"/>
</g>
<!-- dec_gpu1_l0_attn_v -->
<g id="node94" class="node">
<title>dec_gpu1_l0_attn_v</title>
<polygon fill="lightblue" stroke="black" points="1878.5,-3052.78 1697.5,-3052.78 1697.5,-3009.78 1878.5,-3009.78 1878.5,-3052.78"/>
<text text-anchor="middle" x="1788" y="-3039.78" font-family="Arial" font-size="10.00">Decode Attn V Proj L0</text>
<text text-anchor="middle" x="1788" y="-3028.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1788" y="-3017.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu1_l0_ln1&#45;&gt;dec_gpu1_l0_attn_v -->
<g id="edge114" class="edge">
<title>dec_gpu1_l0_ln1&#45;&gt;dec_gpu1_l0_attn_v</title>
<path fill="none" stroke="black" d="M1907.37,-3230.39C1867.93,-3221.86 1824.89,-3204.98 1799,-3171.78 1775.01,-3141.02 1776.79,-3093.96 1781.45,-3063.16"/>
<polygon fill="black" stroke="black" points="1784.95,-3063.44 1783.18,-3052.99 1778.05,-3062.26 1784.95,-3063.44"/>
</g>
<!-- dec_gpu1_l0_attn_score -->
<g id="node95" class="node">
<title>dec_gpu1_l0_attn_score</title>
<polygon fill="lightblue" stroke="black" points="1988.5,-2991.78 1807.5,-2991.78 1807.5,-2948.78 1988.5,-2948.78 1988.5,-2991.78"/>
<text text-anchor="middle" x="1898" y="-2978.78" font-family="Arial" font-size="10.00">Decode Attn Score L0</text>
<text text-anchor="middle" x="1898" y="-2967.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1898" y="-2956.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu1_l0_attn_q&#45;&gt;dec_gpu1_l0_attn_score -->
<g id="edge115" class="edge">
<title>dec_gpu1_l0_attn_q&#45;&gt;dec_gpu1_l0_attn_score</title>
<path fill="none" stroke="black" d="M1898,-3070.65C1898,-3051.84 1898,-3023.81 1898,-3002.3"/>
<polygon fill="black" stroke="black" points="1901.5,-3002.04 1898,-2992.04 1894.5,-3002.04 1901.5,-3002.04"/>
</g>
<!-- dec_gpu1_l0_attn_k&#45;&gt;dec_gpu1_l0_attn_score -->
<g id="edge116" class="edge">
<title>dec_gpu1_l0_attn_k&#45;&gt;dec_gpu1_l0_attn_score</title>
<path fill="none" stroke="black" d="M2062.79,-3070.65C2029.09,-3050.32 1977.49,-3019.21 1941.02,-2997.22"/>
<polygon fill="black" stroke="black" points="1942.47,-2994 1932.1,-2991.84 1938.85,-3000 1942.47,-2994"/>
</g>
<!-- dec_gpu1_l0_attn_softmax -->
<g id="node96" class="node">
<title>dec_gpu1_l0_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="1983.5,-2869.78 1802.5,-2869.78 1802.5,-2826.78 1983.5,-2826.78 1983.5,-2869.78"/>
<text text-anchor="middle" x="1893" y="-2856.78" font-family="Arial" font-size="10.00">Decode Attn Softmax L0</text>
<text text-anchor="middle" x="1893" y="-2845.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1893" y="-2834.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu1_l0_attn_v&#45;&gt;dec_gpu1_l0_attn_softmax -->
<g id="edge117" class="edge">
<title>dec_gpu1_l0_attn_v&#45;&gt;dec_gpu1_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M1787.35,-3009.52C1787.61,-2992.43 1789.83,-2967.97 1799,-2948.78 1812.62,-2920.25 1837.46,-2894.51 1858.19,-2876.36"/>
<polygon fill="black" stroke="black" points="1860.56,-2878.93 1865.9,-2869.78 1856.02,-2873.61 1860.56,-2878.93"/>
</g>
<!-- dec_gpu1_l0_attn_score&#45;&gt;dec_gpu1_l0_attn_softmax -->
<g id="edge118" class="edge">
<title>dec_gpu1_l0_attn_score&#45;&gt;dec_gpu1_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M1897.14,-2948.65C1896.36,-2929.84 1895.19,-2901.81 1894.29,-2880.3"/>
<polygon fill="black" stroke="black" points="1897.78,-2879.88 1893.87,-2870.04 1890.78,-2880.17 1897.78,-2879.88"/>
</g>
<!-- dec_gpu1_l0_attn_out -->
<g id="node97" class="node">
<title>dec_gpu1_l0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1983.5,-2789.78 1802.5,-2789.78 1802.5,-2746.78 1983.5,-2746.78 1983.5,-2789.78"/>
<text text-anchor="middle" x="1893" y="-2776.78" font-family="Arial" font-size="10.00">Decode Attn Out Proj L0</text>
<text text-anchor="middle" x="1893" y="-2765.78" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1893" y="-2754.78" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu1_l0_attn_softmax&#45;&gt;dec_gpu1_l0_attn_out -->
<g id="edge119" class="edge">
<title>dec_gpu1_l0_attn_softmax&#45;&gt;dec_gpu1_l0_attn_out</title>
<path fill="none" stroke="black" d="M1893,-2826.37C1893,-2818.35 1893,-2809.02 1893,-2800.25"/>
<polygon fill="black" stroke="black" points="1896.5,-2799.97 1893,-2789.97 1889.5,-2799.97 1896.5,-2799.97"/>
</g>
<!-- dec_gpu1_l0_attn_ar -->
<g id="node98" class="node">
<title>dec_gpu1_l0_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="1893" cy="-2680.78" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="1893" y="-2689.28" font-family="Arial" font-size="10.00">Decode TP All&#45;Reduce L0</text>
<text text-anchor="middle" x="1893" y="-2678.28" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1893" y="-2667.28" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu1_l0_attn_out&#45;&gt;dec_gpu1_l0_attn_ar -->
<g id="edge120" class="edge">
<title>dec_gpu1_l0_attn_out&#45;&gt;dec_gpu1_l0_attn_ar</title>
<path fill="none" stroke="black" d="M1893,-2746.58C1893,-2738.61 1893,-2729.23 1893,-2720.12"/>
<polygon fill="black" stroke="black" points="1896.5,-2720.04 1893,-2710.04 1889.5,-2720.04 1896.5,-2720.04"/>
</g>
<!-- dec_gpu1_l0_ln2 -->
<g id="node99" class="node">
<title>dec_gpu1_l0_ln2</title>
<polygon fill="lightblue" stroke="black" points="1983.5,-2607.3 1802.5,-2607.3 1802.5,-2564.3 1983.5,-2564.3 1983.5,-2607.3"/>
<text text-anchor="middle" x="1893" y="-2594.3" font-family="Arial" font-size="10.00">Decode LayerNorm2 L0</text>
<text text-anchor="middle" x="1893" y="-2583.3" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1893" y="-2572.3" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu1_l0_attn_ar&#45;&gt;dec_gpu1_l0_ln2 -->
<g id="edge121" class="edge">
<title>dec_gpu1_l0_attn_ar&#45;&gt;dec_gpu1_l0_ln2</title>
<path fill="none" stroke="black" d="M1893,-2651.63C1893,-2640.86 1893,-2628.52 1893,-2617.52"/>
<polygon fill="black" stroke="black" points="1896.5,-2617.47 1893,-2607.47 1889.5,-2617.47 1896.5,-2617.47"/>
</g>
<!-- dec_gpu1_l0_gate -->
<g id="node100" class="node">
<title>dec_gpu1_l0_gate</title>
<polygon fill="lightblue" stroke="black" points="2166.5,-2443.83 1993.5,-2443.83 1993.5,-2400.83 2166.5,-2400.83 2166.5,-2443.83"/>
<text text-anchor="middle" x="2080" y="-2430.83" font-family="Arial" font-size="10.00">Decode Gate Router L0</text>
<text text-anchor="middle" x="2080" y="-2419.83" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2080" y="-2408.83" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 8]</text>
</g>
<!-- dec_gpu1_l0_ln2&#45;&gt;dec_gpu1_l0_gate -->
<g id="edge122" class="edge">
<title>dec_gpu1_l0_ln2&#45;&gt;dec_gpu1_l0_gate</title>
<path fill="none" stroke="black" d="M1937.04,-2564.29C1958.8,-2552.95 1984.68,-2537.56 2005,-2519.81 2027.41,-2500.24 2047.78,-2473.15 2061.61,-2452.66"/>
<polygon fill="black" stroke="black" points="2064.71,-2454.32 2067.31,-2444.04 2058.87,-2450.45 2064.71,-2454.32"/>
</g>
<!-- dec_gpu1_ep_a2a_send -->
<g id="node106" class="node">
<title>dec_gpu1_ep_a2a_send</title>
<ellipse fill="red" stroke="black" cx="1893" cy="-2490.82" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="1893" y="-2499.32" font-family="Arial" font-size="10.00">Decode EP All&#45;to&#45;All Send L0</text>
<text text-anchor="middle" x="1893" y="-2488.32" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, 256]</text>
<text text-anchor="middle" x="1893" y="-2477.32" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 256]</text>
</g>
<!-- dec_gpu1_l0_ln2&#45;&gt;dec_gpu1_ep_a2a_send -->
<g id="edge123" class="edge">
<title>dec_gpu1_l0_ln2&#45;&gt;dec_gpu1_ep_a2a_send</title>
<path fill="none" stroke="black" d="M1893,-2564.17C1893,-2554.25 1893,-2542.04 1893,-2530.49"/>
<polygon fill="black" stroke="black" points="1896.5,-2530.15 1893,-2520.15 1889.5,-2530.15 1896.5,-2530.15"/>
</g>
<!-- dec_gpu1_l0_expert_agg -->
<g id="node105" class="node">
<title>dec_gpu1_l0_expert_agg</title>
<polygon fill="yellow" stroke="black" points="2044.45,-2117.84 1798.75,-2117.84 1735.55,-2035.84 1981.25,-2035.84 2044.45,-2117.84"/>
<text text-anchor="middle" x="1890" y="-2085.34" font-family="Arial" font-size="10.00">Decode Expert Aggregation L0</text>
<text text-anchor="middle" x="1890" y="-2074.34" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, 1024]</text>
<text text-anchor="middle" x="1890" y="-2063.34" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 256]</text>
</g>
<!-- dec_gpu1_l0_gate&#45;&gt;dec_gpu1_l0_expert_agg -->
<g id="edge133" class="edge">
<title>dec_gpu1_l0_gate&#45;&gt;dec_gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2100.08,-2400.76C2142.75,-2354.53 2234.04,-2240.48 2177,-2163.84 2159.64,-2140.52 2102.73,-2121.17 2044.11,-2106.77"/>
<polygon fill="black" stroke="black" points="2044.85,-2103.35 2034.31,-2104.41 2043.21,-2110.16 2044.85,-2103.35"/>
<text text-anchor="middle" x="2201.5" y="-2283.14" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- dec_gpu1_l0_expert8 -->
<g id="node101" class="node">
<title>dec_gpu1_l0_expert8</title>
<polygon fill="lightblue" stroke="black" points="1594.5,-2226.34 1421.5,-2226.34 1421.5,-2183.34 1594.5,-2183.34 1594.5,-2226.34"/>
<text text-anchor="middle" x="1508" y="-2213.34" font-family="Arial" font-size="10.00">Decode Expert 8 FC L0</text>
<text text-anchor="middle" x="1508" y="-2202.34" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1508" y="-2191.34" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu1_l0_expert8&#45;&gt;dec_gpu1_l0_expert_agg -->
<g id="edge129" class="edge">
<title>dec_gpu1_l0_expert8&#45;&gt;dec_gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M1554.5,-2183.34C1570.1,-2176.77 1587.68,-2169.68 1604,-2163.84 1661.11,-2143.42 1725.73,-2123.71 1779.09,-2108.32"/>
<polygon fill="black" stroke="black" points="1780.27,-2111.62 1788.92,-2105.5 1778.34,-2104.89 1780.27,-2111.62"/>
</g>
<!-- dec_gpu1_l0_expert9 -->
<g id="node102" class="node">
<title>dec_gpu1_l0_expert9</title>
<polygon fill="lightblue" stroke="black" points="1785.5,-2226.34 1612.5,-2226.34 1612.5,-2183.34 1785.5,-2183.34 1785.5,-2226.34"/>
<text text-anchor="middle" x="1699" y="-2213.34" font-family="Arial" font-size="10.00">Decode Expert 9 FC L0</text>
<text text-anchor="middle" x="1699" y="-2202.34" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1699" y="-2191.34" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu1_l0_expert9&#45;&gt;dec_gpu1_l0_expert_agg -->
<g id="edge130" class="edge">
<title>dec_gpu1_l0_expert9&#45;&gt;dec_gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M1730.11,-2183.32C1754.56,-2167.19 1789.54,-2144.12 1820.55,-2123.66"/>
<polygon fill="black" stroke="black" points="1822.76,-2126.39 1829.18,-2117.97 1818.91,-2120.55 1822.76,-2126.39"/>
</g>
<!-- dec_gpu1_l0_expert10 -->
<g id="node103" class="node">
<title>dec_gpu1_l0_expert10</title>
<polygon fill="lightblue" stroke="black" points="1976.5,-2226.34 1803.5,-2226.34 1803.5,-2183.34 1976.5,-2183.34 1976.5,-2226.34"/>
<text text-anchor="middle" x="1890" y="-2213.34" font-family="Arial" font-size="10.00">Decode Expert 10 FC L0</text>
<text text-anchor="middle" x="1890" y="-2202.34" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-2191.34" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu1_l0_expert10&#45;&gt;dec_gpu1_l0_expert_agg -->
<g id="edge131" class="edge">
<title>dec_gpu1_l0_expert10&#45;&gt;dec_gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M1890,-2183.32C1890,-2168.37 1890,-2147.43 1890,-2128.16"/>
<polygon fill="black" stroke="black" points="1893.5,-2127.97 1890,-2117.97 1886.5,-2127.97 1893.5,-2127.97"/>
</g>
<!-- dec_gpu1_l0_expert11 -->
<g id="node104" class="node">
<title>dec_gpu1_l0_expert11</title>
<polygon fill="lightblue" stroke="black" points="2167.5,-2226.34 1994.5,-2226.34 1994.5,-2183.34 2167.5,-2183.34 2167.5,-2226.34"/>
<text text-anchor="middle" x="2081" y="-2213.34" font-family="Arial" font-size="10.00">Decode Expert 11 FC L0</text>
<text text-anchor="middle" x="2081" y="-2202.34" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2081" y="-2191.34" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu1_l0_expert11&#45;&gt;dec_gpu1_l0_expert_agg -->
<g id="edge132" class="edge">
<title>dec_gpu1_l0_expert11&#45;&gt;dec_gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M2049.89,-2183.32C2025.44,-2167.19 1990.46,-2144.12 1959.45,-2123.66"/>
<polygon fill="black" stroke="black" points="1961.09,-2120.55 1950.82,-2117.97 1957.24,-2126.39 1961.09,-2120.55"/>
</g>
<!-- dec_gpu1_send -->
<g id="node108" class="node">
<title>dec_gpu1_send</title>
<ellipse fill="purple" stroke="black" cx="1890" cy="-1957.84" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="1890" y="-1966.34" font-family="Arial" font-size="10.00">Decode Send to PP1</text>
<text text-anchor="middle" x="1890" y="-1955.34" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-1944.34" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu1_l0_expert_agg&#45;&gt;dec_gpu1_send -->
<g id="edge134" class="edge">
<title>dec_gpu1_l0_expert_agg&#45;&gt;dec_gpu1_send</title>
<path fill="none" stroke="black" d="M1890,-2035.58C1890,-2023.21 1890,-2009.63 1890,-1997.37"/>
<polygon fill="black" stroke="black" points="1893.5,-1997.01 1890,-1987.01 1886.5,-1997.01 1893.5,-1997.01"/>
</g>
<!-- dec_gpu1_ep_a2a_recv -->
<g id="node107" class="node">
<title>dec_gpu1_ep_a2a_recv</title>
<ellipse fill="red" stroke="black" cx="1890" cy="-2353.84" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="1890" y="-2362.34" font-family="Arial" font-size="10.00">Decode EP All&#45;to&#45;All Recv L0</text>
<text text-anchor="middle" x="1890" y="-2351.34" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, 256]</text>
<text text-anchor="middle" x="1890" y="-2340.34" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 256]</text>
</g>
<!-- dec_gpu1_ep_a2a_send&#45;&gt;dec_gpu1_ep_a2a_recv -->
<g id="edge124" class="edge">
<title>dec_gpu1_ep_a2a_send&#45;&gt;dec_gpu1_ep_a2a_recv</title>
<path fill="none" stroke="black" d="M1892.37,-2461.52C1891.93,-2441.72 1891.34,-2415.04 1890.86,-2393.31"/>
<polygon fill="black" stroke="black" points="1894.35,-2393.02 1890.63,-2383.1 1887.35,-2393.17 1894.35,-2393.02"/>
</g>
<!-- dec_gpu1_ep_a2a_recv&#45;&gt;dec_gpu1_l0_expert8 -->
<g id="edge125" class="edge">
<title>dec_gpu1_ep_a2a_recv&#45;&gt;dec_gpu1_l0_expert8</title>
<path fill="none" stroke="black" d="M1828.38,-2330.53C1770.29,-2309.32 1680.91,-2276.24 1604,-2245.84 1591.69,-2240.98 1578.56,-2235.62 1566.08,-2230.45"/>
<polygon fill="black" stroke="black" points="1567.27,-2227.15 1556.7,-2226.54 1564.58,-2233.62 1567.27,-2227.15"/>
</g>
<!-- dec_gpu1_ep_a2a_recv&#45;&gt;dec_gpu1_l0_expert9 -->
<g id="edge126" class="edge">
<title>dec_gpu1_ep_a2a_recv&#45;&gt;dec_gpu1_l0_expert9</title>
<path fill="none" stroke="black" d="M1855.41,-2326.22C1820.88,-2299.64 1768.1,-2259.03 1733.57,-2232.45"/>
<polygon fill="black" stroke="black" points="1735.7,-2229.67 1725.64,-2226.35 1731.43,-2235.22 1735.7,-2229.67"/>
</g>
<!-- dec_gpu1_ep_a2a_recv&#45;&gt;dec_gpu1_l0_expert10 -->
<g id="edge127" class="edge">
<title>dec_gpu1_ep_a2a_recv&#45;&gt;dec_gpu1_l0_expert10</title>
<path fill="none" stroke="black" d="M1890,-2324.84C1890,-2299.66 1890,-2262.72 1890,-2236.69"/>
<polygon fill="black" stroke="black" points="1893.5,-2236.62 1890,-2226.62 1886.5,-2236.62 1893.5,-2236.62"/>
</g>
<!-- dec_gpu1_ep_a2a_recv&#45;&gt;dec_gpu1_l0_expert11 -->
<g id="edge128" class="edge">
<title>dec_gpu1_ep_a2a_recv&#45;&gt;dec_gpu1_l0_expert11</title>
<path fill="none" stroke="black" d="M1924.59,-2326.22C1959.12,-2299.64 2011.9,-2259.03 2046.43,-2232.45"/>
<polygon fill="black" stroke="black" points="2048.57,-2235.22 2054.36,-2226.35 2044.3,-2229.67 2048.57,-2235.22"/>
</g>
<!-- dec_gpu3_recv -->
<g id="node126" class="node">
<title>dec_gpu3_recv</title>
<ellipse fill="purple" stroke="black" cx="1890" cy="-1802.85" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="1890" y="-1811.35" font-family="Arial" font-size="10.00">Decode Recv from PP0</text>
<text text-anchor="middle" x="1890" y="-1800.35" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-1789.35" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu1_send&#45;&gt;dec_gpu3_recv -->
<g id="edge136" class="edge">
<title>dec_gpu1_send&#45;&gt;dec_gpu3_recv</title>
<path fill="none" stroke="black" d="M1890,-1928.78C1890,-1904.49 1890,-1869.13 1890,-1842.22"/>
<polygon fill="black" stroke="black" points="1893.5,-1842 1890,-1832 1886.5,-1842 1893.5,-1842"/>
</g>
<!-- dec_gpu2_l8_ln1 -->
<g id="node110" class="node">
<title>dec_gpu2_l8_ln1</title>
<polygon fill="lightblue" stroke="black" points="2947.5,-1431.9 2766.5,-1431.9 2766.5,-1388.9 2947.5,-1388.9 2947.5,-1431.9"/>
<text text-anchor="middle" x="2857" y="-1418.9" font-family="Arial" font-size="10.00">Decode LayerNorm1 L8</text>
<text text-anchor="middle" x="2857" y="-1407.9" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2857" y="-1396.9" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu2_recv&#45;&gt;dec_gpu2_l8_ln1 -->
<g id="edge137" class="edge">
<title>dec_gpu2_recv&#45;&gt;dec_gpu2_l8_ln1</title>
<path fill="none" stroke="black" d="M2986.22,-1511.85C2958.24,-1490.1 2919.12,-1459.69 2891.27,-1438.04"/>
<polygon fill="black" stroke="black" points="2893.42,-1435.28 2883.38,-1431.9 2889.12,-1440.8 2893.42,-1435.28"/>
</g>
<!-- dec_gpu2_l8_attn_q -->
<g id="node111" class="node">
<title>dec_gpu2_l8_attn_q</title>
<polygon fill="lightblue" stroke="black" points="2947.5,-1309.9 2766.5,-1309.9 2766.5,-1266.9 2947.5,-1266.9 2947.5,-1309.9"/>
<text text-anchor="middle" x="2857" y="-1296.9" font-family="Arial" font-size="10.00">Decode Attn Q Proj L8</text>
<text text-anchor="middle" x="2857" y="-1285.9" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2857" y="-1274.9" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu2_l8_ln1&#45;&gt;dec_gpu2_l8_attn_q -->
<g id="edge138" class="edge">
<title>dec_gpu2_l8_ln1&#45;&gt;dec_gpu2_l8_attn_q</title>
<path fill="none" stroke="black" d="M2857,-1388.77C2857,-1369.96 2857,-1341.93 2857,-1320.42"/>
<polygon fill="black" stroke="black" points="2860.5,-1320.16 2857,-1310.16 2853.5,-1320.16 2860.5,-1320.16"/>
</g>
<!-- dec_gpu2_l8_attn_k -->
<g id="node112" class="node">
<title>dec_gpu2_l8_attn_k</title>
<polygon fill="lightblue" stroke="black" points="2748.5,-1309.9 2567.5,-1309.9 2567.5,-1266.9 2748.5,-1266.9 2748.5,-1309.9"/>
<text text-anchor="middle" x="2658" y="-1296.9" font-family="Arial" font-size="10.00">Decode Attn K Proj L8</text>
<text text-anchor="middle" x="2658" y="-1285.9" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2658" y="-1274.9" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu2_l8_ln1&#45;&gt;dec_gpu2_l8_attn_k -->
<g id="edge139" class="edge">
<title>dec_gpu2_l8_ln1&#45;&gt;dec_gpu2_l8_attn_k</title>
<path fill="none" stroke="black" d="M2822.79,-1388.77C2789.09,-1368.44 2737.49,-1337.33 2701.02,-1315.34"/>
<polygon fill="black" stroke="black" points="2702.47,-1312.12 2692.1,-1309.96 2698.85,-1318.12 2702.47,-1312.12"/>
</g>
<!-- dec_gpu2_l8_attn_v -->
<g id="node113" class="node">
<title>dec_gpu2_l8_attn_v</title>
<polygon fill="lightblue" stroke="black" points="3037.5,-1248.9 2856.5,-1248.9 2856.5,-1205.9 3037.5,-1205.9 3037.5,-1248.9"/>
<text text-anchor="middle" x="2947" y="-1235.9" font-family="Arial" font-size="10.00">Decode Attn V Proj L8</text>
<text text-anchor="middle" x="2947" y="-1224.9" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2947" y="-1213.9" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu2_l8_ln1&#45;&gt;dec_gpu2_l8_attn_v -->
<g id="edge140" class="edge">
<title>dec_gpu2_l8_ln1&#45;&gt;dec_gpu2_l8_attn_v</title>
<path fill="none" stroke="black" d="M2888.43,-1388.72C2912.26,-1371.01 2943.18,-1343.14 2957,-1309.9 2963.69,-1293.81 2961.71,-1274.5 2957.82,-1258.72"/>
<polygon fill="black" stroke="black" points="2961.14,-1257.6 2955.05,-1248.93 2954.4,-1259.5 2961.14,-1257.6"/>
</g>
<!-- dec_gpu2_l8_attn_score -->
<g id="node114" class="node">
<title>dec_gpu2_l8_attn_score</title>
<polygon fill="lightblue" stroke="black" points="2844.5,-1187.9 2663.5,-1187.9 2663.5,-1144.9 2844.5,-1144.9 2844.5,-1187.9"/>
<text text-anchor="middle" x="2754" y="-1174.9" font-family="Arial" font-size="10.00">Decode Attn Score L8</text>
<text text-anchor="middle" x="2754" y="-1163.9" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2754" y="-1152.9" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu2_l8_attn_q&#45;&gt;dec_gpu2_l8_attn_score -->
<g id="edge141" class="edge">
<title>dec_gpu2_l8_attn_q&#45;&gt;dec_gpu2_l8_attn_score</title>
<path fill="none" stroke="black" d="M2839.29,-1266.77C2822.49,-1247.19 2797.1,-1217.61 2778.38,-1195.8"/>
<polygon fill="black" stroke="black" points="2780.99,-1193.47 2771.82,-1188.16 2775.68,-1198.03 2780.99,-1193.47"/>
</g>
<!-- dec_gpu2_l8_attn_k&#45;&gt;dec_gpu2_l8_attn_score -->
<g id="edge142" class="edge">
<title>dec_gpu2_l8_attn_k&#45;&gt;dec_gpu2_l8_attn_score</title>
<path fill="none" stroke="black" d="M2674.5,-1266.77C2690.09,-1247.28 2713.63,-1217.87 2731.04,-1196.09"/>
<polygon fill="black" stroke="black" points="2733.88,-1198.15 2737.39,-1188.16 2728.41,-1193.78 2733.88,-1198.15"/>
</g>
<!-- dec_gpu2_l8_attn_softmax -->
<g id="node115" class="node">
<title>dec_gpu2_l8_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="2844.5,-1100.41 2663.5,-1100.41 2663.5,-1057.41 2844.5,-1057.41 2844.5,-1100.41"/>
<text text-anchor="middle" x="2754" y="-1087.41" font-family="Arial" font-size="10.00">Decode Attn Softmax L8</text>
<text text-anchor="middle" x="2754" y="-1076.41" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2754" y="-1065.41" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu2_l8_attn_v&#45;&gt;dec_gpu2_l8_attn_softmax -->
<g id="edge143" class="edge">
<title>dec_gpu2_l8_attn_v&#45;&gt;dec_gpu2_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M2925.21,-1205.7C2906.82,-1188.64 2879.5,-1164.2 2854,-1144.9 2835.98,-1131.26 2815.15,-1117.44 2797.18,-1106.06"/>
<polygon fill="black" stroke="black" points="2798.95,-1103.04 2788.61,-1100.69 2795.23,-1108.97 2798.95,-1103.04"/>
</g>
<!-- dec_gpu2_l8_attn_score&#45;&gt;dec_gpu2_l8_attn_softmax -->
<g id="edge144" class="edge">
<title>dec_gpu2_l8_attn_score&#45;&gt;dec_gpu2_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M2754,-1144.7C2754,-1134.52 2754,-1122.03 2754,-1110.75"/>
<polygon fill="black" stroke="black" points="2757.5,-1110.41 2754,-1100.41 2750.5,-1110.41 2757.5,-1110.41"/>
</g>
<!-- dec_gpu2_l8_attn_out -->
<g id="node116" class="node">
<title>dec_gpu2_l8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2802.5,-1005.42 2621.5,-1005.42 2621.5,-962.42 2802.5,-962.42 2802.5,-1005.42"/>
<text text-anchor="middle" x="2712" y="-992.42" font-family="Arial" font-size="10.00">Decode Attn Out Proj L8</text>
<text text-anchor="middle" x="2712" y="-981.42" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2712" y="-970.42" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu2_l8_attn_softmax&#45;&gt;dec_gpu2_l8_attn_out -->
<g id="edge145" class="edge">
<title>dec_gpu2_l8_attn_softmax&#45;&gt;dec_gpu2_l8_attn_out</title>
<path fill="none" stroke="black" d="M2744.68,-1057.27C2739.02,-1044.75 2731.71,-1028.56 2725.44,-1014.67"/>
<polygon fill="black" stroke="black" points="2728.6,-1013.17 2721.3,-1005.5 2722.22,-1016.05 2728.6,-1013.17"/>
</g>
<!-- dec_gpu2_l8_attn_ar -->
<g id="node117" class="node">
<title>dec_gpu2_l8_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="2691" cy="-888.94" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2691" y="-897.44" font-family="Arial" font-size="10.00">Decode TP All&#45;Reduce L8</text>
<text text-anchor="middle" x="2691" y="-886.44" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2691" y="-875.44" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu2_l8_attn_out&#45;&gt;dec_gpu2_l8_attn_ar -->
<g id="edge146" class="edge">
<title>dec_gpu2_l8_attn_out&#45;&gt;dec_gpu2_l8_attn_ar</title>
<path fill="none" stroke="black" d="M2707.34,-962.29C2705.06,-952.19 2702.24,-939.71 2699.59,-927.97"/>
<polygon fill="black" stroke="black" points="2702.94,-926.91 2697.32,-917.92 2696.11,-928.45 2702.94,-926.91"/>
</g>
<!-- dec_gpu2_l8_ln2 -->
<g id="node118" class="node">
<title>dec_gpu2_l8_ln2</title>
<polygon fill="lightblue" stroke="black" points="2775.5,-773.46 2594.5,-773.46 2594.5,-730.46 2775.5,-730.46 2775.5,-773.46"/>
<text text-anchor="middle" x="2685" y="-760.46" font-family="Arial" font-size="10.00">Decode LayerNorm2 L8</text>
<text text-anchor="middle" x="2685" y="-749.46" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2685" y="-738.46" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu2_l8_attn_ar&#45;&gt;dec_gpu2_l8_ln2 -->
<g id="edge147" class="edge">
<title>dec_gpu2_l8_attn_ar&#45;&gt;dec_gpu2_l8_ln2</title>
<path fill="none" stroke="black" d="M2689.74,-859.64C2688.76,-837.49 2687.39,-806.7 2686.38,-783.9"/>
<polygon fill="black" stroke="black" points="2689.86,-783.56 2685.92,-773.73 2682.87,-783.87 2689.86,-783.56"/>
</g>
<!-- dec_gpu2_l8_gate -->
<g id="node119" class="node">
<title>dec_gpu2_l8_gate</title>
<polygon fill="lightblue" stroke="black" points="2767.5,-624.47 2594.5,-624.47 2594.5,-581.47 2767.5,-581.47 2767.5,-624.47"/>
<text text-anchor="middle" x="2681" y="-611.47" font-family="Arial" font-size="10.00">Decode Gate Router L8</text>
<text text-anchor="middle" x="2681" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2681" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 8]</text>
</g>
<!-- dec_gpu2_l8_ln2&#45;&gt;dec_gpu2_l8_gate -->
<g id="edge148" class="edge">
<title>dec_gpu2_l8_ln2&#45;&gt;dec_gpu2_l8_gate</title>
<path fill="none" stroke="black" d="M2684.44,-730.21C2683.76,-705.37 2682.62,-663.53 2681.84,-634.88"/>
<polygon fill="black" stroke="black" points="2685.33,-634.51 2681.56,-624.61 2678.34,-634.7 2685.33,-634.51"/>
</g>
<!-- dec_gpu2_l8_expert0 -->
<g id="node120" class="node">
<title>dec_gpu2_l8_expert0</title>
<polygon fill="lightblue" stroke="black" points="2958.5,-624.47 2785.5,-624.47 2785.5,-581.47 2958.5,-581.47 2958.5,-624.47"/>
<text text-anchor="middle" x="2872" y="-611.47" font-family="Arial" font-size="10.00">Decode Expert 0 FC L8</text>
<text text-anchor="middle" x="2872" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2872" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu2_l8_ln2&#45;&gt;dec_gpu2_l8_expert0 -->
<g id="edge149" class="edge">
<title>dec_gpu2_l8_ln2&#45;&gt;dec_gpu2_l8_expert0</title>
<path fill="none" stroke="black" d="M2711.4,-730.21C2744.53,-704.16 2801.43,-659.44 2837.85,-630.81"/>
<polygon fill="black" stroke="black" points="2840.04,-633.54 2845.74,-624.61 2835.71,-628.04 2840.04,-633.54"/>
</g>
<!-- dec_gpu2_l8_expert1 -->
<g id="node121" class="node">
<title>dec_gpu2_l8_expert1</title>
<polygon fill="lightblue" stroke="black" points="3149.5,-624.47 2976.5,-624.47 2976.5,-581.47 3149.5,-581.47 3149.5,-624.47"/>
<text text-anchor="middle" x="3063" y="-611.47" font-family="Arial" font-size="10.00">Decode Expert 1 FC L8</text>
<text text-anchor="middle" x="3063" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="3063" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu2_l8_ln2&#45;&gt;dec_gpu2_l8_expert1 -->
<g id="edge150" class="edge">
<title>dec_gpu2_l8_ln2&#45;&gt;dec_gpu2_l8_expert1</title>
<path fill="none" stroke="black" d="M2741.08,-730.45C2798.35,-709.35 2889.71,-675.23 2968,-643.97 2980.18,-639.1 2993.18,-633.74 3005.52,-628.57"/>
<polygon fill="black" stroke="black" points="3006.95,-631.77 3014.81,-624.66 3004.24,-625.31 3006.95,-631.77"/>
</g>
<!-- dec_gpu2_l8_expert2 -->
<g id="node122" class="node">
<title>dec_gpu2_l8_expert2</title>
<polygon fill="lightblue" stroke="black" points="2385.5,-624.47 2212.5,-624.47 2212.5,-581.47 2385.5,-581.47 2385.5,-624.47"/>
<text text-anchor="middle" x="2299" y="-611.47" font-family="Arial" font-size="10.00">Decode Expert 2 FC L8</text>
<text text-anchor="middle" x="2299" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2299" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu2_l8_ln2&#45;&gt;dec_gpu2_l8_expert2 -->
<g id="edge151" class="edge">
<title>dec_gpu2_l8_ln2&#45;&gt;dec_gpu2_l8_expert2</title>
<path fill="none" stroke="black" d="M2627.24,-730.44C2568.52,-709.4 2475.05,-675.39 2395,-643.97 2382.54,-639.08 2369.26,-633.66 2356.66,-628.44"/>
<polygon fill="black" stroke="black" points="2357.76,-625.11 2347.19,-624.5 2355.07,-631.58 2357.76,-625.11"/>
</g>
<!-- dec_gpu2_l8_expert3 -->
<g id="node123" class="node">
<title>dec_gpu2_l8_expert3</title>
<polygon fill="lightblue" stroke="black" points="2576.5,-624.47 2403.5,-624.47 2403.5,-581.47 2576.5,-581.47 2576.5,-624.47"/>
<text text-anchor="middle" x="2490" y="-611.47" font-family="Arial" font-size="10.00">Decode Expert 3 FC L8</text>
<text text-anchor="middle" x="2490" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2490" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu2_l8_ln2&#45;&gt;dec_gpu2_l8_expert3 -->
<g id="edge152" class="edge">
<title>dec_gpu2_l8_ln2&#45;&gt;dec_gpu2_l8_expert3</title>
<path fill="none" stroke="black" d="M2657.47,-730.21C2622.92,-704.16 2563.59,-659.44 2525.62,-630.81"/>
<polygon fill="black" stroke="black" points="2527.48,-627.83 2517.39,-624.61 2523.26,-633.42 2527.48,-627.83"/>
</g>
<!-- dec_gpu2_l8_expert_agg -->
<g id="node124" class="node">
<title>dec_gpu2_l8_expert_agg</title>
<polygon fill="yellow" stroke="black" points="2739.45,-515.97 2493.75,-515.97 2430.55,-433.97 2676.25,-433.97 2739.45,-515.97"/>
<text text-anchor="middle" x="2585" y="-483.47" font-family="Arial" font-size="10.00">Decode Expert Aggregation L8</text>
<text text-anchor="middle" x="2585" y="-472.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, 1024]</text>
<text text-anchor="middle" x="2585" y="-461.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 256]</text>
</g>
<!-- dec_gpu2_l8_gate&#45;&gt;dec_gpu2_l8_expert_agg -->
<g id="edge157" class="edge">
<title>dec_gpu2_l8_gate&#45;&gt;dec_gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2665.36,-581.44C2653.55,-565.93 2636.84,-544 2621.71,-524.15"/>
<polygon fill="black" stroke="black" points="2624.41,-521.92 2615.57,-516.09 2618.84,-526.16 2624.41,-521.92"/>
<text text-anchor="middle" x="2649.5" y="-536.77" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- dec_gpu2_l8_expert0&#45;&gt;dec_gpu2_l8_expert_agg -->
<g id="edge153" class="edge">
<title>dec_gpu2_l8_expert0&#45;&gt;dec_gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M2825.25,-581.44C2787.58,-564.9 2733.25,-541.05 2685.78,-520.21"/>
<polygon fill="black" stroke="black" points="2686.95,-516.9 2676.39,-516.09 2684.14,-523.31 2686.95,-516.9"/>
</g>
<!-- dec_gpu2_l8_expert1&#45;&gt;dec_gpu2_l8_expert_agg -->
<g id="edge154" class="edge">
<title>dec_gpu2_l8_expert1&#45;&gt;dec_gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M3018.67,-581.38C3002.9,-574.57 2984.87,-567.37 2968,-561.97 2893.77,-538.21 2809.42,-518.52 2738.81,-504"/>
<polygon fill="black" stroke="black" points="2739.44,-500.55 2728.94,-501.98 2738.04,-507.41 2739.44,-500.55"/>
</g>
<!-- dec_gpu2_l8_expert2&#45;&gt;dec_gpu2_l8_expert_agg -->
<g id="edge155" class="edge">
<title>dec_gpu2_l8_expert2&#45;&gt;dec_gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M2345.59,-581.44C2383.13,-564.9 2437.27,-541.05 2484.57,-520.21"/>
<polygon fill="black" stroke="black" points="2486.19,-523.32 2493.93,-516.09 2483.37,-516.92 2486.19,-523.32"/>
</g>
<!-- dec_gpu2_l8_expert3&#45;&gt;dec_gpu2_l8_expert_agg -->
<g id="edge156" class="edge">
<title>dec_gpu2_l8_expert3&#45;&gt;dec_gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M2505.47,-581.44C2517.17,-565.93 2533.7,-544 2548.67,-524.15"/>
<polygon fill="black" stroke="black" points="2551.52,-526.18 2554.75,-516.09 2545.94,-521.96 2551.52,-526.18"/>
</g>
<!-- dec_gpu2_output -->
<g id="node125" class="node">
<title>dec_gpu2_output</title>
<polygon fill="lightblue" stroke="black" points="2486.5,-377.47 2305.5,-377.47 2305.5,-334.47 2486.5,-334.47 2486.5,-377.47"/>
<text text-anchor="middle" x="2396" y="-364.47" font-family="Arial" font-size="10.00">Decode Output Projection</text>
<text text-anchor="middle" x="2396" y="-353.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2396" y="-342.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=512]</text>
</g>
<!-- dec_gpu2_l8_expert_agg&#45;&gt;dec_gpu2_output -->
<g id="edge158" class="edge">
<title>dec_gpu2_l8_expert_agg&#45;&gt;dec_gpu2_output</title>
<path fill="none" stroke="black" d="M2520.22,-433.86C2492.91,-416.96 2461.9,-397.76 2437.7,-382.78"/>
<polygon fill="black" stroke="black" points="2439.46,-379.75 2429.12,-377.47 2435.78,-385.71 2439.46,-379.75"/>
</g>
<!-- decode_output_agg -->
<g id="node145" class="node">
<title>decode_output_agg</title>
<polygon fill="yellow" stroke="black" points="2041.23,-277.97 1800.66,-277.97 1738.77,-195.97 1979.34,-195.97 2041.23,-277.97"/>
<text text-anchor="middle" x="1890" y="-245.47" font-family="Arial" font-size="10.00">Decode Output Aggregation</text>
<text text-anchor="middle" x="1890" y="-234.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, 512]</text>
<text text-anchor="middle" x="1890" y="-223.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 512]</text>
</g>
<!-- dec_gpu2_output&#45;&gt;decode_output_agg -->
<g id="edge183" class="edge">
<title>dec_gpu2_output&#45;&gt;decode_output_agg</title>
<path fill="none" stroke="black" d="M2307.28,-334.45C2235.37,-317.82 2132.26,-293.98 2046.53,-274.16"/>
<polygon fill="black" stroke="black" points="2047.23,-270.73 2036.7,-271.89 2045.65,-277.55 2047.23,-270.73"/>
</g>
<!-- dec_gpu3_l8_ln1 -->
<g id="node127" class="node">
<title>dec_gpu3_l8_ln1</title>
<polygon fill="lightblue" stroke="black" points="1980.5,-1675.37 1799.5,-1675.37 1799.5,-1632.37 1980.5,-1632.37 1980.5,-1675.37"/>
<text text-anchor="middle" x="1890" y="-1662.37" font-family="Arial" font-size="10.00">Decode LayerNorm1 L8</text>
<text text-anchor="middle" x="1890" y="-1651.37" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-1640.37" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu3_recv&#45;&gt;dec_gpu3_l8_ln1 -->
<g id="edge159" class="edge">
<title>dec_gpu3_recv&#45;&gt;dec_gpu3_l8_ln1</title>
<path fill="none" stroke="black" d="M1890,-1773.86C1890,-1748.68 1890,-1711.74 1890,-1685.72"/>
<polygon fill="black" stroke="black" points="1893.5,-1685.64 1890,-1675.64 1886.5,-1685.64 1893.5,-1685.64"/>
</g>
<!-- dec_gpu3_l8_attn_q -->
<g id="node128" class="node">
<title>dec_gpu3_l8_attn_q</title>
<polygon fill="lightblue" stroke="black" points="1980.5,-1561.39 1799.5,-1561.39 1799.5,-1518.39 1980.5,-1518.39 1980.5,-1561.39"/>
<text text-anchor="middle" x="1890" y="-1548.39" font-family="Arial" font-size="10.00">Decode Attn Q Proj L8</text>
<text text-anchor="middle" x="1890" y="-1537.39" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-1526.39" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu3_l8_ln1&#45;&gt;dec_gpu3_l8_attn_q -->
<g id="edge160" class="edge">
<title>dec_gpu3_l8_ln1&#45;&gt;dec_gpu3_l8_attn_q</title>
<path fill="none" stroke="black" d="M1890,-1632.33C1890,-1615.39 1890,-1591.09 1890,-1571.8"/>
<polygon fill="black" stroke="black" points="1893.5,-1571.68 1890,-1561.68 1886.5,-1571.68 1893.5,-1571.68"/>
</g>
<!-- dec_gpu3_l8_attn_k -->
<g id="node129" class="node">
<title>dec_gpu3_l8_attn_k</title>
<polygon fill="lightblue" stroke="black" points="2179.5,-1561.39 1998.5,-1561.39 1998.5,-1518.39 2179.5,-1518.39 2179.5,-1561.39"/>
<text text-anchor="middle" x="2089" y="-1548.39" font-family="Arial" font-size="10.00">Decode Attn K Proj L8</text>
<text text-anchor="middle" x="2089" y="-1537.39" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2089" y="-1526.39" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu3_l8_ln1&#45;&gt;dec_gpu3_l8_attn_k -->
<g id="edge161" class="edge">
<title>dec_gpu3_l8_ln1&#45;&gt;dec_gpu3_l8_attn_k</title>
<path fill="none" stroke="black" d="M1928.09,-1632.15C1946.79,-1621.92 1969.63,-1609.34 1990,-1597.88 2007.79,-1587.87 2027.28,-1576.69 2044.23,-1566.91"/>
<polygon fill="black" stroke="black" points="2046.45,-1569.67 2053.35,-1561.63 2042.94,-1563.61 2046.45,-1569.67"/>
</g>
<!-- dec_gpu3_l8_attn_v -->
<g id="node130" class="node">
<title>dec_gpu3_l8_attn_v</title>
<polygon fill="lightblue" stroke="black" points="1870.5,-1492.9 1689.5,-1492.9 1689.5,-1449.9 1870.5,-1449.9 1870.5,-1492.9"/>
<text text-anchor="middle" x="1780" y="-1479.9" font-family="Arial" font-size="10.00">Decode Attn V Proj L8</text>
<text text-anchor="middle" x="1780" y="-1468.9" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1780" y="-1457.9" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu3_l8_ln1&#45;&gt;dec_gpu3_l8_attn_v -->
<g id="edge162" class="edge">
<title>dec_gpu3_l8_ln1&#45;&gt;dec_gpu3_l8_attn_v</title>
<path fill="none" stroke="black" d="M1831.51,-1632.35C1815.9,-1624.05 1800.69,-1612.81 1791,-1597.88 1772.71,-1569.7 1772.41,-1530.16 1775.1,-1503.04"/>
<polygon fill="black" stroke="black" points="1778.59,-1503.29 1776.29,-1492.95 1771.64,-1502.47 1778.59,-1503.29"/>
</g>
<!-- dec_gpu3_l8_attn_score -->
<g id="node131" class="node">
<title>dec_gpu3_l8_attn_score</title>
<polygon fill="lightblue" stroke="black" points="1980.5,-1431.9 1799.5,-1431.9 1799.5,-1388.9 1980.5,-1388.9 1980.5,-1431.9"/>
<text text-anchor="middle" x="1890" y="-1418.9" font-family="Arial" font-size="10.00">Decode Attn Score L8</text>
<text text-anchor="middle" x="1890" y="-1407.9" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-1396.9" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu3_l8_attn_q&#45;&gt;dec_gpu3_l8_attn_score -->
<g id="edge163" class="edge">
<title>dec_gpu3_l8_attn_q&#45;&gt;dec_gpu3_l8_attn_score</title>
<path fill="none" stroke="black" d="M1890,-1518.12C1890,-1497.56 1890,-1465.84 1890,-1442.32"/>
<polygon fill="black" stroke="black" points="1893.5,-1442.16 1890,-1432.16 1886.5,-1442.16 1893.5,-1442.16"/>
</g>
<!-- dec_gpu3_l8_attn_k&#45;&gt;dec_gpu3_l8_attn_score -->
<g id="edge164" class="edge">
<title>dec_gpu3_l8_attn_k&#45;&gt;dec_gpu3_l8_attn_score</title>
<path fill="none" stroke="black" d="M2056.58,-1518.12C2022.22,-1496.11 1967.88,-1461.29 1930.67,-1437.45"/>
<polygon fill="black" stroke="black" points="1932.38,-1434.39 1922.07,-1431.94 1928.6,-1440.29 1932.38,-1434.39"/>
</g>
<!-- dec_gpu3_l8_attn_softmax -->
<g id="node132" class="node">
<title>dec_gpu3_l8_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="1980.5,-1309.9 1799.5,-1309.9 1799.5,-1266.9 1980.5,-1266.9 1980.5,-1309.9"/>
<text text-anchor="middle" x="1890" y="-1296.9" font-family="Arial" font-size="10.00">Decode Attn Softmax L8</text>
<text text-anchor="middle" x="1890" y="-1285.9" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-1274.9" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu3_l8_attn_v&#45;&gt;dec_gpu3_l8_attn_softmax -->
<g id="edge165" class="edge">
<title>dec_gpu3_l8_attn_v&#45;&gt;dec_gpu3_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M1779.22,-1449.58C1779.4,-1432.45 1781.58,-1407.97 1791,-1388.9 1805.31,-1359.9 1831.39,-1334.23 1853.19,-1316.23"/>
<polygon fill="black" stroke="black" points="1855.39,-1318.94 1861,-1309.95 1851.01,-1313.49 1855.39,-1318.94"/>
</g>
<!-- dec_gpu3_l8_attn_score&#45;&gt;dec_gpu3_l8_attn_softmax -->
<g id="edge166" class="edge">
<title>dec_gpu3_l8_attn_score&#45;&gt;dec_gpu3_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M1890,-1388.77C1890,-1369.96 1890,-1341.93 1890,-1320.42"/>
<polygon fill="black" stroke="black" points="1893.5,-1320.16 1890,-1310.16 1886.5,-1320.16 1893.5,-1320.16"/>
</g>
<!-- dec_gpu3_l8_attn_out -->
<g id="node133" class="node">
<title>dec_gpu3_l8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1980.5,-1187.9 1799.5,-1187.9 1799.5,-1144.9 1980.5,-1144.9 1980.5,-1187.9"/>
<text text-anchor="middle" x="1890" y="-1174.9" font-family="Arial" font-size="10.00">Decode Attn Out Proj L8</text>
<text text-anchor="middle" x="1890" y="-1163.9" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-1152.9" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu3_l8_attn_softmax&#45;&gt;dec_gpu3_l8_attn_out -->
<g id="edge167" class="edge">
<title>dec_gpu3_l8_attn_softmax&#45;&gt;dec_gpu3_l8_attn_out</title>
<path fill="none" stroke="black" d="M1890,-1266.77C1890,-1247.96 1890,-1219.93 1890,-1198.42"/>
<polygon fill="black" stroke="black" points="1893.5,-1198.16 1890,-1188.16 1886.5,-1198.16 1893.5,-1198.16"/>
</g>
<!-- dec_gpu3_l8_attn_ar -->
<g id="node134" class="node">
<title>dec_gpu3_l8_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="1890" cy="-1078.91" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="1890" y="-1087.41" font-family="Arial" font-size="10.00">Decode TP All&#45;Reduce L8</text>
<text text-anchor="middle" x="1890" y="-1076.41" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-1065.41" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu3_l8_attn_out&#45;&gt;dec_gpu3_l8_attn_ar -->
<g id="edge168" class="edge">
<title>dec_gpu3_l8_attn_out&#45;&gt;dec_gpu3_l8_attn_ar</title>
<path fill="none" stroke="black" d="M1890,-1144.7C1890,-1136.73 1890,-1127.35 1890,-1118.24"/>
<polygon fill="black" stroke="black" points="1893.5,-1118.16 1890,-1108.16 1886.5,-1118.16 1893.5,-1118.16"/>
</g>
<!-- dec_gpu3_l8_ln2 -->
<g id="node135" class="node">
<title>dec_gpu3_l8_ln2</title>
<polygon fill="lightblue" stroke="black" points="1980.5,-1005.42 1799.5,-1005.42 1799.5,-962.42 1980.5,-962.42 1980.5,-1005.42"/>
<text text-anchor="middle" x="1890" y="-992.42" font-family="Arial" font-size="10.00">Decode LayerNorm2 L8</text>
<text text-anchor="middle" x="1890" y="-981.42" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-970.42" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=256]</text>
</g>
<!-- dec_gpu3_l8_attn_ar&#45;&gt;dec_gpu3_l8_ln2 -->
<g id="edge169" class="edge">
<title>dec_gpu3_l8_attn_ar&#45;&gt;dec_gpu3_l8_ln2</title>
<path fill="none" stroke="black" d="M1890,-1049.75C1890,-1038.98 1890,-1026.64 1890,-1015.64"/>
<polygon fill="black" stroke="black" points="1893.5,-1015.59 1890,-1005.59 1886.5,-1015.59 1893.5,-1015.59"/>
</g>
<!-- dec_gpu3_l8_gate -->
<g id="node136" class="node">
<title>dec_gpu3_l8_gate</title>
<polygon fill="lightblue" stroke="black" points="2164.5,-841.95 1991.5,-841.95 1991.5,-798.95 2164.5,-798.95 2164.5,-841.95"/>
<text text-anchor="middle" x="2078" y="-828.95" font-family="Arial" font-size="10.00">Decode Gate Router L8</text>
<text text-anchor="middle" x="2078" y="-817.95" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2078" y="-806.95" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 8]</text>
</g>
<!-- dec_gpu3_l8_ln2&#45;&gt;dec_gpu3_l8_gate -->
<g id="edge170" class="edge">
<title>dec_gpu3_l8_ln2&#45;&gt;dec_gpu3_l8_gate</title>
<path fill="none" stroke="black" d="M1933.99,-962.35C1955.74,-951 1981.62,-935.61 2002,-917.93 2024.69,-898.24 2045.42,-871.01 2059.48,-850.49"/>
<polygon fill="black" stroke="black" points="2062.41,-852.4 2065.08,-842.15 2056.6,-848.5 2062.41,-852.4"/>
</g>
<!-- dec_gpu3_ep_a2a_send -->
<g id="node143" class="node">
<title>dec_gpu3_ep_a2a_send</title>
<ellipse fill="red" stroke="black" cx="1890" cy="-888.94" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="1890" y="-897.44" font-family="Arial" font-size="10.00">Decode EP All&#45;to&#45;All Send L8</text>
<text text-anchor="middle" x="1890" y="-886.44" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, 256]</text>
<text text-anchor="middle" x="1890" y="-875.44" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 256]</text>
</g>
<!-- dec_gpu3_l8_ln2&#45;&gt;dec_gpu3_ep_a2a_send -->
<g id="edge171" class="edge">
<title>dec_gpu3_l8_ln2&#45;&gt;dec_gpu3_ep_a2a_send</title>
<path fill="none" stroke="black" d="M1890,-962.29C1890,-952.37 1890,-940.16 1890,-928.61"/>
<polygon fill="black" stroke="black" points="1893.5,-928.28 1890,-918.28 1886.5,-928.28 1893.5,-928.28"/>
</g>
<!-- dec_gpu3_l8_expert_agg -->
<g id="node141" class="node">
<title>dec_gpu3_l8_expert_agg</title>
<polygon fill="yellow" stroke="black" points="2044.45,-515.97 1798.75,-515.97 1735.55,-433.97 1981.25,-433.97 2044.45,-515.97"/>
<text text-anchor="middle" x="1890" y="-483.47" font-family="Arial" font-size="10.00">Decode Expert Aggregation L8</text>
<text text-anchor="middle" x="1890" y="-472.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, 1024]</text>
<text text-anchor="middle" x="1890" y="-461.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 256]</text>
</g>
<!-- dec_gpu3_l8_gate&#45;&gt;dec_gpu3_l8_expert_agg -->
<g id="edge181" class="edge">
<title>dec_gpu3_l8_gate&#45;&gt;dec_gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2091.48,-798.73C2116.51,-759.77 2168.43,-676.61 2177,-643.97 2186.26,-608.72 2198.76,-591.2 2177,-561.97 2159.64,-538.65 2102.73,-519.29 2044.11,-504.89"/>
<polygon fill="black" stroke="black" points="2044.85,-501.47 2034.31,-502.53 2043.21,-508.28 2044.85,-501.47"/>
<text text-anchor="middle" x="2184.5" y="-681.27" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- dec_gpu3_l8_expert8 -->
<g id="node137" class="node">
<title>dec_gpu3_l8_expert8</title>
<polygon fill="lightblue" stroke="black" points="1785.5,-624.47 1612.5,-624.47 1612.5,-581.47 1785.5,-581.47 1785.5,-624.47"/>
<text text-anchor="middle" x="1699" y="-611.47" font-family="Arial" font-size="10.00">Decode Expert 8 FC L8</text>
<text text-anchor="middle" x="1699" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1699" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu3_l8_expert8&#45;&gt;dec_gpu3_l8_expert_agg -->
<g id="edge177" class="edge">
<title>dec_gpu3_l8_expert8&#45;&gt;dec_gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M1730.11,-581.44C1754.56,-565.31 1789.54,-542.24 1820.55,-521.78"/>
<polygon fill="black" stroke="black" points="1822.76,-524.51 1829.18,-516.09 1818.91,-518.67 1822.76,-524.51"/>
</g>
<!-- dec_gpu3_l8_expert9 -->
<g id="node138" class="node">
<title>dec_gpu3_l8_expert9</title>
<polygon fill="lightblue" stroke="black" points="1976.5,-624.47 1803.5,-624.47 1803.5,-581.47 1976.5,-581.47 1976.5,-624.47"/>
<text text-anchor="middle" x="1890" y="-611.47" font-family="Arial" font-size="10.00">Decode Expert 9 FC L8</text>
<text text-anchor="middle" x="1890" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu3_l8_expert9&#45;&gt;dec_gpu3_l8_expert_agg -->
<g id="edge178" class="edge">
<title>dec_gpu3_l8_expert9&#45;&gt;dec_gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M1890,-581.44C1890,-566.49 1890,-545.55 1890,-526.28"/>
<polygon fill="black" stroke="black" points="1893.5,-526.09 1890,-516.09 1886.5,-526.09 1893.5,-526.09"/>
</g>
<!-- dec_gpu3_l8_expert10 -->
<g id="node139" class="node">
<title>dec_gpu3_l8_expert10</title>
<polygon fill="lightblue" stroke="black" points="2167.5,-624.47 1994.5,-624.47 1994.5,-581.47 2167.5,-581.47 2167.5,-624.47"/>
<text text-anchor="middle" x="2081" y="-611.47" font-family="Arial" font-size="10.00">Decode Expert 10 FC L8</text>
<text text-anchor="middle" x="2081" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="2081" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu3_l8_expert10&#45;&gt;dec_gpu3_l8_expert_agg -->
<g id="edge179" class="edge">
<title>dec_gpu3_l8_expert10&#45;&gt;dec_gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M2049.89,-581.44C2025.44,-565.31 1990.46,-542.24 1959.45,-521.78"/>
<polygon fill="black" stroke="black" points="1961.09,-518.67 1950.82,-516.09 1957.24,-524.51 1961.09,-518.67"/>
</g>
<!-- dec_gpu3_l8_expert11 -->
<g id="node140" class="node">
<title>dec_gpu3_l8_expert11</title>
<polygon fill="lightblue" stroke="black" points="1594.5,-624.47 1421.5,-624.47 1421.5,-581.47 1594.5,-581.47 1594.5,-624.47"/>
<text text-anchor="middle" x="1508" y="-611.47" font-family="Arial" font-size="10.00">Decode Expert 11 FC L8</text>
<text text-anchor="middle" x="1508" y="-600.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1508" y="-589.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 1024]</text>
</g>
<!-- dec_gpu3_l8_expert11&#45;&gt;dec_gpu3_l8_expert_agg -->
<g id="edge180" class="edge">
<title>dec_gpu3_l8_expert11&#45;&gt;dec_gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M1554.5,-581.46C1570.1,-574.89 1587.68,-567.8 1604,-561.97 1661.11,-541.54 1725.73,-521.83 1779.09,-506.44"/>
<polygon fill="black" stroke="black" points="1780.27,-509.74 1788.92,-503.62 1778.34,-503.01 1780.27,-509.74"/>
</g>
<!-- dec_gpu3_output -->
<g id="node142" class="node">
<title>dec_gpu3_output</title>
<polygon fill="lightblue" stroke="black" points="1980.5,-377.47 1799.5,-377.47 1799.5,-334.47 1980.5,-334.47 1980.5,-377.47"/>
<text text-anchor="middle" x="1890" y="-364.47" font-family="Arial" font-size="10.00">Decode Output Projection</text>
<text text-anchor="middle" x="1890" y="-353.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, hidden=256]</text>
<text text-anchor="middle" x="1890" y="-342.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, hidden=512]</text>
</g>
<!-- dec_gpu3_l8_expert_agg&#45;&gt;dec_gpu3_output -->
<g id="edge182" class="edge">
<title>dec_gpu3_l8_expert_agg&#45;&gt;dec_gpu3_output</title>
<path fill="none" stroke="black" d="M1890,-433.7C1890,-418.64 1890,-401.78 1890,-387.71"/>
<polygon fill="black" stroke="black" points="1893.5,-387.57 1890,-377.57 1886.5,-387.57 1893.5,-387.57"/>
</g>
<!-- dec_gpu3_output&#45;&gt;decode_output_agg -->
<g id="edge184" class="edge">
<title>dec_gpu3_output&#45;&gt;decode_output_agg</title>
<path fill="none" stroke="black" d="M1890,-334.32C1890,-321.62 1890,-304.75 1890,-288.67"/>
<polygon fill="black" stroke="black" points="1893.5,-288.28 1890,-278.28 1886.5,-288.28 1893.5,-288.28"/>
</g>
<!-- dec_gpu3_ep_a2a_recv -->
<g id="node144" class="node">
<title>dec_gpu3_ep_a2a_recv</title>
<ellipse fill="red" stroke="black" cx="1890" cy="-751.96" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="1890" y="-760.46" font-family="Arial" font-size="10.00">Decode EP All&#45;to&#45;All Recv L8</text>
<text text-anchor="middle" x="1890" y="-749.46" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, 256]</text>
<text text-anchor="middle" x="1890" y="-738.46" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 256]</text>
</g>
<!-- dec_gpu3_ep_a2a_send&#45;&gt;dec_gpu3_ep_a2a_recv -->
<g id="edge172" class="edge">
<title>dec_gpu3_ep_a2a_send&#45;&gt;dec_gpu3_ep_a2a_recv</title>
<path fill="none" stroke="black" d="M1890,-859.64C1890,-839.84 1890,-813.16 1890,-791.43"/>
<polygon fill="black" stroke="black" points="1893.5,-791.22 1890,-781.22 1886.5,-791.22 1893.5,-791.22"/>
</g>
<!-- dec_gpu3_ep_a2a_recv&#45;&gt;dec_gpu3_l8_expert8 -->
<g id="edge173" class="edge">
<title>dec_gpu3_ep_a2a_recv&#45;&gt;dec_gpu3_l8_expert8</title>
<path fill="none" stroke="black" d="M1855.41,-724.34C1820.88,-697.76 1768.1,-657.15 1733.57,-630.57"/>
<polygon fill="black" stroke="black" points="1735.7,-627.79 1725.64,-624.47 1731.43,-633.34 1735.7,-627.79"/>
</g>
<!-- dec_gpu3_ep_a2a_recv&#45;&gt;dec_gpu3_l8_expert9 -->
<g id="edge174" class="edge">
<title>dec_gpu3_ep_a2a_recv&#45;&gt;dec_gpu3_l8_expert9</title>
<path fill="none" stroke="black" d="M1890,-722.96C1890,-697.78 1890,-660.84 1890,-634.82"/>
<polygon fill="black" stroke="black" points="1893.5,-634.74 1890,-624.74 1886.5,-634.74 1893.5,-634.74"/>
</g>
<!-- dec_gpu3_ep_a2a_recv&#45;&gt;dec_gpu3_l8_expert10 -->
<g id="edge175" class="edge">
<title>dec_gpu3_ep_a2a_recv&#45;&gt;dec_gpu3_l8_expert10</title>
<path fill="none" stroke="black" d="M1924.59,-724.34C1959.12,-697.76 2011.9,-657.15 2046.43,-630.57"/>
<polygon fill="black" stroke="black" points="2048.57,-633.34 2054.36,-624.47 2044.3,-627.79 2048.57,-633.34"/>
</g>
<!-- dec_gpu3_ep_a2a_recv&#45;&gt;dec_gpu3_l8_expert11 -->
<g id="edge176" class="edge">
<title>dec_gpu3_ep_a2a_recv&#45;&gt;dec_gpu3_l8_expert11</title>
<path fill="none" stroke="black" d="M1828.38,-728.65C1770.29,-707.44 1680.91,-674.36 1604,-643.97 1591.69,-639.1 1578.56,-633.74 1566.08,-628.57"/>
<polygon fill="black" stroke="black" points="1567.27,-625.27 1556.7,-624.66 1564.58,-631.74 1567.27,-625.27"/>
</g>
<!-- decode_output -->
<g id="node147" class="node">
<title>decode_output</title>
<ellipse fill="lightgreen" stroke="black" cx="1563" cy="-123.97" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="1563" y="-132.47" font-family="Arial" font-size="10.00">Decode Output</text>
<text text-anchor="middle" x="1563" y="-121.47" font-family="Arial" font-size="10.00">Input: [128, seq_len=1, 512]</text>
<text text-anchor="middle" x="1563" y="-110.47" font-family="Arial" font-size="10.00">Output: [128, seq_len=1, 512]</text>
</g>
<!-- decode_output_agg&#45;&gt;decode_output -->
<g id="edge185" class="edge">
<title>decode_output_agg&#45;&gt;decode_output</title>
<path fill="none" stroke="black" d="M1771.95,-195.9C1726.82,-180.58 1676.68,-163.56 1636.83,-150.03"/>
<polygon fill="black" stroke="black" points="1637.78,-146.66 1627.19,-146.76 1635.53,-153.29 1637.78,-146.66"/>
</g>
<!-- final_output -->
<g id="node148" class="node">
<title>final_output</title>
<ellipse fill="lightgreen" stroke="black" cx="1129" cy="-28.99" rx="128.89" ry="28.98"/>
<text text-anchor="middle" x="1129" y="-37.49" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="1129" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, hidden=512]</text>
<text text-anchor="middle" x="1129" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, vocab_size]</text>
</g>
<!-- prefill_output&#45;&gt;final_output -->
<g id="edge186" class="edge">
<title>prefill_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M1053.81,-96.58C1065.15,-86.54 1078.24,-74.95 1090.28,-64.28"/>
<polygon fill="black" stroke="black" points="1092.85,-66.68 1098.02,-57.43 1088.21,-61.43 1092.85,-66.68"/>
</g>
<!-- decode_output&#45;&gt;final_output -->
<g id="edge187" class="edge">
<title>decode_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M1482.64,-105.76C1411.47,-90.51 1307.23,-68.18 1230.36,-51.71"/>
<polygon fill="black" stroke="black" points="1230.69,-48.2 1220.17,-49.53 1229.22,-55.04 1230.69,-48.2"/>
</g>
</g>
</svg>
