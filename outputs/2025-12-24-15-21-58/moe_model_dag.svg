<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="13714pt" height="2610pt"
 viewBox="0.00 0.00 13713.61 2610.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2606.08)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2606.08 13709.61,-2606.08 13709.61,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_prefill</title>
<path fill="lightgray" stroke="black" d="M20,-184C20,-184 7112,-184 7112,-184 7118,-184 7124,-190 7124,-196 7124,-196 7124,-2582.08 7124,-2582.08 7124,-2588.08 7118,-2594.08 7112,-2594.08 7112,-2594.08 20,-2594.08 20,-2594.08 14,-2594.08 8,-2588.08 8,-2582.08 8,-2582.08 8,-196 8,-196 8,-190 14,-184 20,-184"/>
<text text-anchor="middle" x="76.5" y="-2578.88" font-family="Times,serif" font-size="14.00">PREFILL PHASE</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pp0</title>
<path fill="lightcyan" stroke="black" d="M4022,-576C4022,-576 6526,-576 6526,-576 6532,-576 6538,-582 6538,-588 6538,-588 6538,-2459.08 6538,-2459.08 6538,-2465.08 6532,-2471.08 6526,-2471.08 6526,-2471.08 4022,-2471.08 4022,-2471.08 4016,-2471.08 4010,-2465.08 4010,-2459.08 4010,-2459.08 4010,-588 4010,-588 4010,-582 4016,-576 4022,-576"/>
<text text-anchor="middle" x="4122" y="-2455.88" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;7)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu0</title>
<path fill="lightcoral" stroke="black" d="M6078,-584C6078,-584 6518,-584 6518,-584 6524,-584 6530,-590 6530,-596 6530,-596 6530,-2402.08 6530,-2402.08 6530,-2408.08 6524,-2414.08 6518,-2414.08 6518,-2414.08 6078,-2414.08 6078,-2414.08 6072,-2414.08 6066,-2408.08 6066,-2402.08 6066,-2402.08 6066,-596 6066,-596 6066,-590 6072,-584 6078,-584"/>
<text text-anchor="middle" x="6162" y="-2398.88" font-family="Times,serif" font-size="14.00">GPU 0 (TP&#45;0, PP&#45;0, EP&#45;0)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M4030,-1479.54C4030,-1479.54 6046,-1479.54 6046,-1479.54 6052,-1479.54 6058,-1485.54 6058,-1491.54 6058,-1491.54 6058,-2428.08 6058,-2428.08 6058,-2434.08 6052,-2440.08 6046,-2440.08 6046,-2440.08 4030,-2440.08 4030,-2440.08 4024,-2440.08 4018,-2434.08 4018,-2428.08 4018,-2428.08 4018,-1491.54 4018,-1491.54 4018,-1485.54 4024,-1479.54 4030,-1479.54"/>
<text text-anchor="middle" x="4114" y="-2424.88" font-family="Times,serif" font-size="14.00">GPU 1 (TP&#45;1, PP&#45;0, EP&#45;1)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_pp1</title>
<path fill="lightcyan" stroke="black" d="M28,-192C28,-192 7104,-192 7104,-192 7110,-192 7116,-198 7116,-204 7116,-204 7116,-544 7116,-544 7116,-550 7110,-556 7104,-556 7104,-556 28,-556 28,-556 22,-556 16,-550 16,-544 16,-544 16,-204 16,-204 16,-198 22,-192 28,-192"/>
<text text-anchor="middle" x="132.5" y="-540.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 8&#45;15)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu3</title>
<path fill="lightsalmon" stroke="black" d="M36,-200C36,-200 3544,-200 3544,-200 3550,-200 3556,-206 3556,-212 3556,-212 3556,-513 3556,-513 3556,-519 3550,-525 3544,-525 3544,-525 36,-525 36,-525 30,-525 24,-519 24,-513 24,-513 24,-212 24,-212 24,-206 30,-200 36,-200"/>
<text text-anchor="middle" x="120" y="-509.8" font-family="Times,serif" font-size="14.00">GPU 3 (TP&#45;1, PP&#45;1, EP&#45;1)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu2</title>
<path fill="lightseagreen" stroke="black" d="M3588,-382C3588,-382 7096,-382 7096,-382 7102,-382 7108,-388 7108,-394 7108,-394 7108,-513 7108,-513 7108,-519 7102,-525 7096,-525 7096,-525 3588,-525 3588,-525 3582,-525 3576,-519 3576,-513 3576,-513 3576,-394 3576,-394 3576,-388 3582,-382 3588,-382"/>
<text text-anchor="middle" x="3672" y="-509.8" font-family="Times,serif" font-size="14.00">GPU 2 (TP&#45;0, PP&#45;1, EP&#45;0)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_decode</title>
<path fill="lightgray" stroke="black" d="M7144,-8C7144,-8 13264,-8 13264,-8 13270,-8 13276,-14 13276,-20 13276,-20 13276,-2582.08 13276,-2582.08 13276,-2588.08 13270,-2594.08 13264,-2594.08 13264,-2594.08 7144,-2594.08 7144,-2594.08 7138,-2594.08 7132,-2588.08 7132,-2582.08 7132,-2582.08 7132,-20 7132,-20 7132,-14 7138,-8 7144,-8"/>
<text text-anchor="middle" x="7201" y="-2578.88" font-family="Times,serif" font-size="14.00">DECODE PHASE</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_decode_pp0</title>
<path fill="lightcyan" stroke="black" d="M9652,-400C9652,-400 13256,-400 13256,-400 13262,-400 13268,-406 13268,-412 13268,-412 13268,-2459.08 13268,-2459.08 13268,-2465.08 13262,-2471.08 13256,-2471.08 13256,-2471.08 9652,-2471.08 9652,-2471.08 9646,-2471.08 9640,-2465.08 9640,-2459.08 9640,-2459.08 9640,-412 9640,-412 9640,-406 9646,-400 9652,-400"/>
<text text-anchor="middle" x="9780.5" y="-2455.88" font-family="Times,serif" font-size="14.00">Decode Pipeline Stage 0 (Layers 0&#45;7)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_decode_gpu0</title>
<path fill="lightcoral" stroke="black" d="M9660,-408C9660,-408 10026,-408 10026,-408 10032,-408 10038,-414 10038,-420 10038,-420 10038,-2402.08 10038,-2402.08 10038,-2408.08 10032,-2414.08 10026,-2414.08 10026,-2414.08 9660,-2414.08 9660,-2414.08 9654,-2414.08 9648,-2408.08 9648,-2402.08 9648,-2402.08 9648,-420 9648,-420 9648,-414 9654,-408 9660,-408"/>
<text text-anchor="middle" x="9772.5" y="-2398.88" font-family="Times,serif" font-size="14.00">GPU 0 Decode (TP&#45;0, PP&#45;0, EP&#45;0)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_decode_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M10058,-2297.08C10058,-2297.08 13248,-2297.08 13248,-2297.08 13254,-2297.08 13260,-2303.08 13260,-2309.08 13260,-2309.08 13260,-2428.08 13260,-2428.08 13260,-2434.08 13254,-2440.08 13248,-2440.08 13248,-2440.08 10058,-2440.08 10058,-2440.08 10052,-2440.08 10046,-2434.08 10046,-2428.08 10046,-2428.08 10046,-2309.08 10046,-2309.08 10046,-2303.08 10052,-2297.08 10058,-2297.08"/>
<text text-anchor="middle" x="10170.5" y="-2424.88" font-family="Times,serif" font-size="14.00">GPU 1 Decode (TP&#45;1, PP&#45;0, EP&#45;1)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_decode_pp1</title>
<path fill="lightcyan" stroke="black" d="M7152,-16C7152,-16 13256,-16 13256,-16 13262,-16 13268,-22 13268,-28 13268,-28 13268,-362 13268,-362 13268,-368 13262,-374 13256,-374 13256,-374 7152,-374 7152,-374 7146,-374 7140,-368 7140,-362 7140,-362 7140,-28 7140,-28 7140,-22 7146,-16 7152,-16"/>
<text text-anchor="middle" x="7285" y="-358.8" font-family="Times,serif" font-size="14.00">Decode Pipeline Stage 1 (Layers 8&#45;15)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_decode_gpu2</title>
<path fill="lightseagreen" stroke="black" d="M10226,-200C10226,-200 13248,-200 13248,-200 13254,-200 13260,-206 13260,-212 13260,-212 13260,-331 13260,-331 13260,-337 13254,-343 13248,-343 13248,-343 10226,-343 10226,-343 10220,-343 10214,-337 10214,-331 10214,-331 10214,-212 10214,-212 10214,-206 10220,-200 10226,-200"/>
<text text-anchor="middle" x="10338.5" y="-327.8" font-family="Times,serif" font-size="14.00">GPU 2 Decode (TP&#45;0, PP&#45;1, EP&#45;0)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_decode_gpu3</title>
<path fill="lightsalmon" stroke="black" d="M7160,-24C7160,-24 10182,-24 10182,-24 10188,-24 10194,-30 10194,-36 10194,-36 10194,-331 10194,-331 10194,-337 10188,-343 10182,-343 10182,-343 7160,-343 7160,-343 7154,-343 7148,-337 7148,-331 7148,-331 7148,-36 7148,-36 7148,-30 7154,-24 7160,-24"/>
<text text-anchor="middle" x="7272.5" y="-327.8" font-family="Times,serif" font-size="14.00">GPU 3 Decode (TP&#45;1, PP&#45;1, EP&#45;1)</text>
</g>
<!-- input_split -->
<g id="node1" class="node">
<title>input_split</title>
<polygon fill="lightyellow" stroke="black" points="6683.71,-2563.08 6062.18,-2563.08 5902.29,-2481.08 6523.82,-2481.08 6683.71,-2563.08"/>
<text text-anchor="middle" x="6293" y="-2530.58" font-family="Times,serif" font-size="10.00">Input Split</text>
<text text-anchor="middle" x="6293" y="-2519.58" font-family="Times,serif" font-size="10.00">[batch=128, seq=10240, dim=512]→[batch=128, seq=10240, dim=256]</text>
<text text-anchor="middle" x="6293" y="-2508.58" font-family="Times,serif" font-size="10.00">GPU: ALL</text>
</g>
<!-- gpu0_l0_attn_q -->
<g id="node2" class="node">
<title>gpu0_l0_attn_q</title>
<polygon fill="lightgreen" stroke="black" points="6458.5,-2383.08 6311.5,-2383.08 6311.5,-2331.08 6458.5,-2331.08 6458.5,-2383.08"/>
<text text-anchor="middle" x="6385" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention Q Projection</text>
<text text-anchor="middle" x="6385" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="6385" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="6385" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- input_split&#45;&gt;gpu0_l0_attn_q -->
<g id="edge1" class="edge">
<title>input_split&#45;&gt;gpu0_l0_attn_q</title>
<path fill="none" stroke="black" d="M6385,-2480.87C6385,-2480.87 6385,-2393.36 6385,-2393.36"/>
<polygon fill="black" stroke="black" points="6388.5,-2393.36 6385,-2383.36 6381.5,-2393.36 6388.5,-2393.36"/>
</g>
<!-- gpu0_l0_attn_k -->
<g id="node3" class="node">
<title>gpu0_l0_attn_k</title>
<polygon fill="lightgreen" stroke="black" points="6275.5,-2383.08 6128.5,-2383.08 6128.5,-2331.08 6275.5,-2331.08 6275.5,-2383.08"/>
<text text-anchor="middle" x="6202" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention K Projection</text>
<text text-anchor="middle" x="6202" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="6202" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="6202" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- input_split&#45;&gt;gpu0_l0_attn_k -->
<g id="edge2" class="edge">
<title>input_split&#45;&gt;gpu0_l0_attn_k</title>
<path fill="none" stroke="black" d="M6202,-2480.87C6202,-2480.87 6202,-2393.36 6202,-2393.36"/>
<polygon fill="black" stroke="black" points="6205.5,-2393.36 6202,-2383.36 6198.5,-2393.36 6205.5,-2393.36"/>
</g>
<!-- gpu0_l0_attn_v -->
<g id="node4" class="node">
<title>gpu0_l0_attn_v</title>
<polygon fill="lightgreen" stroke="black" points="6521.5,-2109.08 6374.5,-2109.08 6374.5,-2057.08 6521.5,-2057.08 6521.5,-2109.08"/>
<text text-anchor="middle" x="6448" y="-2097.08" font-family="Times,serif" font-size="10.00">Attention V Projection</text>
<text text-anchor="middle" x="6448" y="-2086.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="6448" y="-2075.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="6448" y="-2064.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- input_split&#45;&gt;gpu0_l0_attn_v -->
<g id="edge3" class="edge">
<title>input_split&#45;&gt;gpu0_l0_attn_v</title>
<path fill="none" stroke="black" d="M6490,-2480.78C6490,-2480.78 6490,-2119.09 6490,-2119.09"/>
<polygon fill="black" stroke="black" points="6493.5,-2119.09 6490,-2109.09 6486.5,-2119.09 6493.5,-2119.09"/>
</g>
<!-- gpu1_l0_attn_q -->
<g id="node21" class="node">
<title>gpu1_l0_attn_q</title>
<polygon fill="lightgreen" stroke="black" points="5866.5,-2383.08 5719.5,-2383.08 5719.5,-2331.08 5866.5,-2331.08 5866.5,-2383.08"/>
<text text-anchor="middle" x="5793" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention Q Projection</text>
<text text-anchor="middle" x="5793" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="5793" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="5793" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- input_split&#45;&gt;gpu1_l0_attn_q -->
<g id="edge4" class="edge">
<title>input_split&#45;&gt;gpu1_l0_attn_q</title>
<path fill="none" stroke="black" d="M5982.03,-2522C5880.35,-2522 5793,-2522 5793,-2522 5793,-2522 5793,-2393.21 5793,-2393.21"/>
<polygon fill="black" stroke="black" points="5796.5,-2393.21 5793,-2383.21 5789.5,-2393.21 5796.5,-2393.21"/>
</g>
<!-- gpu1_l0_attn_k -->
<g id="node22" class="node">
<title>gpu1_l0_attn_k</title>
<polygon fill="lightgreen" stroke="black" points="6049.5,-2383.08 5902.5,-2383.08 5902.5,-2331.08 6049.5,-2331.08 6049.5,-2383.08"/>
<text text-anchor="middle" x="5976" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention K Projection</text>
<text text-anchor="middle" x="5976" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="5976" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="5976" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- input_split&#45;&gt;gpu1_l0_attn_k -->
<g id="edge5" class="edge">
<title>input_split&#45;&gt;gpu1_l0_attn_k</title>
<path fill="none" stroke="black" d="M5976,-2480.87C5976,-2480.87 5976,-2393.36 5976,-2393.36"/>
<polygon fill="black" stroke="black" points="5979.5,-2393.36 5976,-2383.36 5972.5,-2393.36 5979.5,-2393.36"/>
</g>
<!-- gpu1_l0_attn_v -->
<g id="node23" class="node">
<title>gpu1_l0_attn_v</title>
<polygon fill="lightgreen" stroke="black" points="6049.5,-2109.08 5902.5,-2109.08 5902.5,-2057.08 6049.5,-2057.08 6049.5,-2109.08"/>
<text text-anchor="middle" x="5976" y="-2097.08" font-family="Times,serif" font-size="10.00">Attention V Projection</text>
<text text-anchor="middle" x="5976" y="-2086.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="5976" y="-2075.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="5976" y="-2064.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- input_split&#45;&gt;gpu1_l0_attn_v -->
<g id="edge6" class="edge">
<title>input_split&#45;&gt;gpu1_l0_attn_v</title>
<path fill="none" stroke="black" d="M6061.82,-2480.77C6061.82,-2371.47 6061.82,-2083 6061.82,-2083 6061.82,-2083 6059.53,-2083 6059.53,-2083"/>
<polygon fill="black" stroke="black" points="6059.53,-2079.5 6049.53,-2083 6059.53,-2086.5 6059.53,-2079.5"/>
</g>
<!-- gpu0_l0_attn_score -->
<g id="node5" class="node">
<title>gpu0_l0_attn_score</title>
<polygon fill="lightgreen" stroke="black" points="6383,-2233.08 6147,-2233.08 6147,-2181.08 6383,-2181.08 6383,-2233.08"/>
<text text-anchor="middle" x="6265" y="-2221.08" font-family="Times,serif" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="6265" y="-2210.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]×[128,10240,16,16]</text>
<text text-anchor="middle" x="6265" y="-2199.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="6265" y="-2188.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_attn_q&#45;&gt;gpu0_l0_attn_score -->
<g id="edge7" class="edge">
<title>gpu0_l0_attn_q&#45;&gt;gpu0_l0_attn_score</title>
<path fill="none" stroke="black" d="M6347.25,-2330.95C6347.25,-2330.95 6347.25,-2243.16 6347.25,-2243.16"/>
<polygon fill="black" stroke="black" points="6350.75,-2243.16 6347.25,-2233.16 6343.75,-2243.16 6350.75,-2243.16"/>
</g>
<!-- gpu0_l0_attn_k&#45;&gt;gpu0_l0_attn_score -->
<g id="edge8" class="edge">
<title>gpu0_l0_attn_k&#45;&gt;gpu0_l0_attn_score</title>
<path fill="none" stroke="black" d="M6211.25,-2330.95C6211.25,-2330.95 6211.25,-2243.16 6211.25,-2243.16"/>
<polygon fill="black" stroke="black" points="6214.75,-2243.16 6211.25,-2233.16 6207.75,-2243.16 6214.75,-2243.16"/>
</g>
<!-- gpu0_l0_attn_out -->
<g id="node7" class="node">
<title>gpu0_l0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="6452,-1985.08 6216,-1985.08 6216,-1933.08 6452,-1933.08 6452,-1985.08"/>
<text text-anchor="middle" x="6334" y="-1973.08" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="6334" y="-1962.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]×[128,10240,16,16]</text>
<text text-anchor="middle" x="6334" y="-1951.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,32]</text>
<text text-anchor="middle" x="6334" y="-1940.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_attn_v&#45;&gt;gpu0_l0_attn_out -->
<g id="edge9" class="edge">
<title>gpu0_l0_attn_v&#45;&gt;gpu0_l0_attn_out</title>
<path fill="none" stroke="black" d="M6413.25,-2056.78C6413.25,-2056.78 6413.25,-1995.34 6413.25,-1995.34"/>
<polygon fill="black" stroke="black" points="6416.75,-1995.34 6413.25,-1985.34 6409.75,-1995.34 6416.75,-1995.34"/>
</g>
<!-- gpu0_l0_attn_softmax -->
<g id="node6" class="node">
<title>gpu0_l0_attn_softmax</title>
<polygon fill="lightgreen" stroke="black" points="6338.5,-2109.08 6191.5,-2109.08 6191.5,-2057.08 6338.5,-2057.08 6338.5,-2109.08"/>
<text text-anchor="middle" x="6265" y="-2097.08" font-family="Times,serif" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="6265" y="-2086.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]</text>
<text text-anchor="middle" x="6265" y="-2075.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="6265" y="-2064.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_attn_score&#45;&gt;gpu0_l0_attn_softmax -->
<g id="edge10" class="edge">
<title>gpu0_l0_attn_score&#45;&gt;gpu0_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M6265,-2180.78C6265,-2180.78 6265,-2119.34 6265,-2119.34"/>
<polygon fill="black" stroke="black" points="6268.5,-2119.34 6265,-2109.34 6261.5,-2119.34 6268.5,-2119.34"/>
</g>
<!-- gpu0_l0_attn_softmax&#45;&gt;gpu0_l0_attn_out -->
<g id="edge11" class="edge">
<title>gpu0_l0_attn_softmax&#45;&gt;gpu0_l0_attn_out</title>
<path fill="none" stroke="black" d="M6277.25,-2056.78C6277.25,-2056.78 6277.25,-1995.34 6277.25,-1995.34"/>
<polygon fill="black" stroke="black" points="6280.75,-1995.34 6277.25,-1985.34 6273.75,-1995.34 6280.75,-1995.34"/>
</g>
<!-- gpu0_l0_attn_proj -->
<g id="node8" class="node">
<title>gpu0_l0_attn_proj</title>
<polygon fill="lightgreen" stroke="black" points="6403.5,-1861.08 6264.5,-1861.08 6264.5,-1809.08 6403.5,-1809.08 6403.5,-1861.08"/>
<text text-anchor="middle" x="6334" y="-1849.08" font-family="Times,serif" font-size="10.00">Attention Projection</text>
<text text-anchor="middle" x="6334" y="-1838.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="6334" y="-1827.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="6334" y="-1816.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_attn_out&#45;&gt;gpu0_l0_attn_proj -->
<g id="edge12" class="edge">
<title>gpu0_l0_attn_out&#45;&gt;gpu0_l0_attn_proj</title>
<path fill="none" stroke="black" d="M6334,-1932.78C6334,-1932.78 6334,-1871.34 6334,-1871.34"/>
<polygon fill="black" stroke="black" points="6337.5,-1871.34 6334,-1861.34 6330.5,-1871.34 6337.5,-1871.34"/>
</g>
<!-- gpu0_l0_attn_ar -->
<g id="node9" class="node">
<title>gpu0_l0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="6334" cy="-1700.31" rx="97.66" ry="36.54"/>
<text text-anchor="middle" x="6334" y="-1714.31" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6334" y="-1703.31" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="6334" y="-1692.31" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="6334" y="-1681.31" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
</g>
<!-- gpu0_l0_attn_proj&#45;&gt;gpu0_l0_attn_ar -->
<g id="edge13" class="edge">
<title>gpu0_l0_attn_proj&#45;&gt;gpu0_l0_attn_ar</title>
<path fill="none" stroke="black" d="M6334,-1808.77C6334,-1808.77 6334,-1747.25 6334,-1747.25"/>
<polygon fill="black" stroke="black" points="6337.5,-1747.25 6334,-1737.25 6330.5,-1747.25 6337.5,-1747.25"/>
</g>
<!-- gpu0_l0_gate -->
<g id="node10" class="node">
<title>gpu0_l0_gate</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="6347.7,-1591.54 6130.24,-1591.54 6074.3,-1487.54 6291.76,-1487.54 6347.7,-1591.54"/>
<text text-anchor="middle" x="6211" y="-1553.54" font-family="Times,serif" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="6211" y="-1542.54" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="6211" y="-1531.54" font-family="Times,serif" font-size="10.00">Output: [128,10240,16]</text>
<text text-anchor="middle" x="6211" y="-1520.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_attn_ar&#45;&gt;gpu0_l0_gate -->
<g id="edge21" class="edge">
<title>gpu0_l0_attn_ar&#45;&gt;gpu0_l0_gate</title>
<path fill="none" stroke="black" d="M6292.14,-1667C6292.14,-1667 6292.14,-1601.8 6292.14,-1601.8"/>
<polygon fill="black" stroke="black" points="6295.64,-1601.8 6292.14,-1591.8 6288.64,-1601.8 6295.64,-1601.8"/>
</g>
<!-- gpu0_l0_ln1 -->
<g id="node19" class="node">
<title>gpu0_l0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="6522,-1565.54 6384,-1565.54 6384,-1513.54 6522,-1513.54 6522,-1565.54"/>
<text text-anchor="middle" x="6453" y="-1553.54" font-family="Times,serif" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="6453" y="-1542.54" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="6453" y="-1531.54" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="6453" y="-1520.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_attn_ar&#45;&gt;gpu0_l0_ln1 -->
<g id="edge22" class="edge">
<title>gpu0_l0_attn_ar&#45;&gt;gpu0_l0_ln1</title>
<path fill="none" stroke="black" d="M6407.79,-1676.24C6407.79,-1676.24 6407.79,-1575.64 6407.79,-1575.64"/>
<polygon fill="black" stroke="black" points="6411.29,-1575.64 6407.79,-1565.64 6404.29,-1575.64 6411.29,-1575.64"/>
</g>
<!-- gpu0_l0_exp0_fc1 -->
<g id="node11" class="node">
<title>gpu0_l0_exp0_fc1</title>
<polygon fill="lightgreen" stroke="black" points="6274.5,-1389.54 6147.5,-1389.54 6147.5,-1337.54 6274.5,-1337.54 6274.5,-1389.54"/>
<text text-anchor="middle" x="6211" y="-1377.54" font-family="Times,serif" font-size="10.00">Expert 0 FC1</text>
<text text-anchor="middle" x="6211" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="6211" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="6211" y="-1344.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_gate&#45;&gt;gpu0_l0_exp0_fc1 -->
<g id="edge25" class="edge">
<title>gpu0_l0_gate&#45;&gt;gpu0_l0_exp0_fc1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6211,-1487.21C6211,-1487.21 6211,-1399.96 6211,-1399.96"/>
<polygon fill="black" stroke="black" points="6214.5,-1399.96 6211,-1389.96 6207.5,-1399.96 6214.5,-1399.96"/>
</g>
<!-- gpu0_l0_exp1_fc1 -->
<g id="node14" class="node">
<title>gpu0_l0_exp1_fc1</title>
<polygon fill="lightgreen" stroke="black" points="6437.5,-1389.54 6310.5,-1389.54 6310.5,-1337.54 6437.5,-1337.54 6437.5,-1389.54"/>
<text text-anchor="middle" x="6374" y="-1377.54" font-family="Times,serif" font-size="10.00">Expert 1 FC1</text>
<text text-anchor="middle" x="6374" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="6374" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="6374" y="-1344.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_gate&#45;&gt;gpu0_l0_exp1_fc1 -->
<g id="edge26" class="edge">
<title>gpu0_l0_gate&#45;&gt;gpu0_l0_exp1_fc1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6329.18,-1539.41C6329.18,-1539.41 6329.18,-1399.89 6329.18,-1399.89"/>
<polygon fill="black" stroke="black" points="6332.68,-1399.89 6329.18,-1389.89 6325.68,-1399.89 6332.68,-1399.89"/>
</g>
<!-- gpu0_l0_exp0_act -->
<g id="node12" class="node">
<title>gpu0_l0_exp0_act</title>
<polygon fill="lightgreen" stroke="black" points="6274.5,-1239.54 6147.5,-1239.54 6147.5,-1187.54 6274.5,-1187.54 6274.5,-1239.54"/>
<text text-anchor="middle" x="6211" y="-1227.54" font-family="Times,serif" font-size="10.00">Expert 0 Activation</text>
<text text-anchor="middle" x="6211" y="-1216.54" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="6211" y="-1205.54" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="6211" y="-1194.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_exp0_fc1&#45;&gt;gpu0_l0_exp0_act -->
<g id="edge27" class="edge">
<title>gpu0_l0_exp0_fc1&#45;&gt;gpu0_l0_exp0_act</title>
<path fill="none" stroke="black" d="M6211,-1337.41C6211,-1337.41 6211,-1249.62 6211,-1249.62"/>
<polygon fill="black" stroke="black" points="6214.5,-1249.62 6211,-1239.62 6207.5,-1249.62 6214.5,-1249.62"/>
</g>
<!-- gpu0_l0_exp0_fc2 -->
<g id="node13" class="node">
<title>gpu0_l0_exp0_fc2</title>
<polygon fill="lightgreen" stroke="black" points="6274.5,-1115.54 6153.5,-1115.54 6153.5,-1063.54 6274.5,-1063.54 6274.5,-1115.54"/>
<text text-anchor="middle" x="6214" y="-1103.54" font-family="Times,serif" font-size="10.00">Expert 0 FC2</text>
<text text-anchor="middle" x="6214" y="-1092.54" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="6214" y="-1081.54" font-family="Times,serif" font-size="10.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="6214" y="-1070.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_exp0_act&#45;&gt;gpu0_l0_exp0_fc2 -->
<g id="edge28" class="edge">
<title>gpu0_l0_exp0_act&#45;&gt;gpu0_l0_exp0_fc2</title>
<path fill="none" stroke="black" d="M6214,-1187.24C6214,-1187.24 6214,-1125.8 6214,-1125.8"/>
<polygon fill="black" stroke="black" points="6217.5,-1125.8 6214,-1115.8 6210.5,-1125.8 6217.5,-1125.8"/>
</g>
<!-- gpu0_l0_ep_a2a -->
<g id="node17" class="node">
<title>gpu0_l0_ep_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="6374" cy="-954.77" rx="97.66" ry="36.54"/>
<text text-anchor="middle" x="6374" y="-968.77" font-family="Times,serif" font-size="10.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="6374" y="-957.77" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="6374" y="-946.77" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="6374" y="-935.77" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
</g>
<!-- gpu0_l0_exp0_fc2&#45;&gt;gpu0_l0_ep_a2a -->
<g id="edge31" class="edge">
<title>gpu0_l0_exp0_fc2&#45;&gt;gpu0_l0_ep_a2a</title>
<path fill="none" stroke="black" d="M6274.63,-1089C6285.5,-1089 6293.46,-1089 6293.46,-1089 6293.46,-1089 6293.46,-985.74 6293.46,-985.74"/>
<polygon fill="black" stroke="black" points="6296.96,-985.74 6293.46,-975.74 6289.96,-985.74 6296.96,-985.74"/>
</g>
<!-- gpu0_l0_exp1_act -->
<g id="node15" class="node">
<title>gpu0_l0_exp1_act</title>
<polygon fill="lightgreen" stroke="black" points="6437.5,-1239.54 6310.5,-1239.54 6310.5,-1187.54 6437.5,-1187.54 6437.5,-1239.54"/>
<text text-anchor="middle" x="6374" y="-1227.54" font-family="Times,serif" font-size="10.00">Expert 1 Activation</text>
<text text-anchor="middle" x="6374" y="-1216.54" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="6374" y="-1205.54" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="6374" y="-1194.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_exp1_fc1&#45;&gt;gpu0_l0_exp1_act -->
<g id="edge29" class="edge">
<title>gpu0_l0_exp1_fc1&#45;&gt;gpu0_l0_exp1_act</title>
<path fill="none" stroke="black" d="M6374,-1337.41C6374,-1337.41 6374,-1249.62 6374,-1249.62"/>
<polygon fill="black" stroke="black" points="6377.5,-1249.62 6374,-1239.62 6370.5,-1249.62 6377.5,-1249.62"/>
</g>
<!-- gpu0_l0_exp1_fc2 -->
<g id="node16" class="node">
<title>gpu0_l0_exp1_fc2</title>
<polygon fill="lightgreen" stroke="black" points="6434.5,-1115.54 6313.5,-1115.54 6313.5,-1063.54 6434.5,-1063.54 6434.5,-1115.54"/>
<text text-anchor="middle" x="6374" y="-1103.54" font-family="Times,serif" font-size="10.00">Expert 1 FC2</text>
<text text-anchor="middle" x="6374" y="-1092.54" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="6374" y="-1081.54" font-family="Times,serif" font-size="10.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="6374" y="-1070.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_exp1_act&#45;&gt;gpu0_l0_exp1_fc2 -->
<g id="edge30" class="edge">
<title>gpu0_l0_exp1_act&#45;&gt;gpu0_l0_exp1_fc2</title>
<path fill="none" stroke="black" d="M6374,-1187.24C6374,-1187.24 6374,-1125.8 6374,-1125.8"/>
<polygon fill="black" stroke="black" points="6377.5,-1125.8 6374,-1115.8 6370.5,-1125.8 6377.5,-1125.8"/>
</g>
<!-- gpu0_l0_exp1_fc2&#45;&gt;gpu0_l0_ep_a2a -->
<g id="edge32" class="edge">
<title>gpu0_l0_exp1_fc2&#45;&gt;gpu0_l0_ep_a2a</title>
<path fill="none" stroke="black" d="M6374,-1063.23C6374,-1063.23 6374,-1001.71 6374,-1001.71"/>
<polygon fill="black" stroke="black" points="6377.5,-1001.71 6374,-991.71 6370.5,-1001.71 6377.5,-1001.71"/>
</g>
<!-- gpu0_l0_exp_agg -->
<g id="node18" class="node">
<title>gpu0_l0_exp_agg</title>
<polygon fill="lightyellow" stroke="black" points="6520.14,-846 6292.43,-846 6233.86,-742 6461.57,-742 6520.14,-846"/>
<text text-anchor="middle" x="6377" y="-808" font-family="Times,serif" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="6377" y="-797" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="6377" y="-786" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="6377" y="-775" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_ep_a2a&#45;&gt;gpu0_l0_exp_agg -->
<g id="edge33" class="edge">
<title>gpu0_l0_ep_a2a&#45;&gt;gpu0_l0_exp_agg</title>
<path fill="none" stroke="black" d="M6374,-917.89C6374,-917.89 6374,-856.25 6374,-856.25"/>
<polygon fill="black" stroke="black" points="6377.5,-856.25 6374,-846.25 6370.5,-856.25 6377.5,-856.25"/>
</g>
<!-- gpu0_l0_ln2 -->
<g id="node20" class="node">
<title>gpu0_l0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="6522,-644 6384,-644 6384,-592 6522,-592 6522,-644"/>
<text text-anchor="middle" x="6453" y="-632" font-family="Times,serif" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="6453" y="-621" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="6453" y="-610" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="6453" y="-599" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- gpu0_l0_exp_agg&#45;&gt;gpu0_l0_ln2 -->
<g id="edge34" class="edge">
<title>gpu0_l0_exp_agg&#45;&gt;gpu0_l0_ln2</title>
<path fill="none" stroke="black" d="M6452.04,-741.67C6452.04,-741.67 6452.04,-654.42 6452.04,-654.42"/>
<polygon fill="black" stroke="black" points="6455.54,-654.42 6452.04,-644.42 6448.54,-654.42 6455.54,-654.42"/>
</g>
<!-- gpu2_l8_attn_q -->
<g id="node40" class="node">
<title>gpu2_l8_attn_q</title>
<polygon fill="lightgreen" stroke="black" points="6916.5,-468 6769.5,-468 6769.5,-416 6916.5,-416 6916.5,-468"/>
<text text-anchor="middle" x="6843" y="-456" font-family="Times,serif" font-size="10.00">Attention Q Projection</text>
<text text-anchor="middle" x="6843" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="6843" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="6843" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu2_l8_attn_q -->
<g id="edge35" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu2_l8_attn_q</title>
<path fill="none" stroke="black" d="M6522.27,-618C6634.35,-618 6843,-618 6843,-618 6843,-618 6843,-478.35 6843,-478.35"/>
<polygon fill="black" stroke="black" points="6846.5,-478.35 6843,-468.35 6839.5,-478.35 6846.5,-478.35"/>
</g>
<!-- gpu2_l8_attn_k -->
<g id="node41" class="node">
<title>gpu2_l8_attn_k</title>
<polygon fill="lightgreen" stroke="black" points="6733.5,-468 6586.5,-468 6586.5,-416 6733.5,-416 6733.5,-468"/>
<text text-anchor="middle" x="6660" y="-456" font-family="Times,serif" font-size="10.00">Attention K Projection</text>
<text text-anchor="middle" x="6660" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="6660" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="6660" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu2_l8_attn_k -->
<g id="edge36" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu2_l8_attn_k</title>
<path fill="none" stroke="black" d="M6522.13,-605C6573.67,-605 6635.18,-605 6635.18,-605 6635.18,-605 6635.18,-478.19 6635.18,-478.19"/>
<polygon fill="black" stroke="black" points="6638.68,-478.19 6635.18,-468.19 6631.68,-478.19 6638.68,-478.19"/>
</g>
<!-- gpu2_l8_attn_v -->
<g id="node42" class="node">
<title>gpu2_l8_attn_v</title>
<polygon fill="lightgreen" stroke="black" points="7099.5,-468 6952.5,-468 6952.5,-416 7099.5,-416 7099.5,-468"/>
<text text-anchor="middle" x="7026" y="-456" font-family="Times,serif" font-size="10.00">Attention V Projection</text>
<text text-anchor="middle" x="7026" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="7026" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="7026" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu2_l8_attn_v -->
<g id="edge37" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu2_l8_attn_v</title>
<path fill="none" stroke="black" d="M6522.12,-631C6674.52,-631 7026,-631 7026,-631 7026,-631 7026,-478.28 7026,-478.28"/>
<polygon fill="black" stroke="black" points="7029.5,-478.28 7026,-468.28 7022.5,-478.28 7029.5,-478.28"/>
</g>
<!-- gpu1_l0_attn_score -->
<g id="node24" class="node">
<title>gpu1_l0_attn_score</title>
<polygon fill="lightgreen" stroke="black" points="5911,-2233.08 5675,-2233.08 5675,-2181.08 5911,-2181.08 5911,-2233.08"/>
<text text-anchor="middle" x="5793" y="-2221.08" font-family="Times,serif" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="5793" y="-2210.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]×[128,10240,16,16]</text>
<text text-anchor="middle" x="5793" y="-2199.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="5793" y="-2188.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_attn_q&#45;&gt;gpu1_l0_attn_score -->
<g id="edge14" class="edge">
<title>gpu1_l0_attn_q&#45;&gt;gpu1_l0_attn_score</title>
<path fill="none" stroke="black" d="M5793,-2330.95C5793,-2330.95 5793,-2243.16 5793,-2243.16"/>
<polygon fill="black" stroke="black" points="5796.5,-2243.16 5793,-2233.16 5789.5,-2243.16 5796.5,-2243.16"/>
</g>
<!-- gpu1_l0_attn_k&#45;&gt;gpu1_l0_attn_score -->
<g id="edge15" class="edge">
<title>gpu1_l0_attn_k&#45;&gt;gpu1_l0_attn_score</title>
<path fill="none" stroke="black" d="M5906.75,-2330.95C5906.75,-2330.95 5906.75,-2243.16 5906.75,-2243.16"/>
<polygon fill="black" stroke="black" points="5910.25,-2243.16 5906.75,-2233.16 5903.25,-2243.16 5910.25,-2243.16"/>
</g>
<!-- gpu1_l0_attn_out -->
<g id="node26" class="node">
<title>gpu1_l0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="5980,-1985.08 5744,-1985.08 5744,-1933.08 5980,-1933.08 5980,-1985.08"/>
<text text-anchor="middle" x="5862" y="-1973.08" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="5862" y="-1962.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]×[128,10240,16,16]</text>
<text text-anchor="middle" x="5862" y="-1951.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,32]</text>
<text text-anchor="middle" x="5862" y="-1940.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_attn_v&#45;&gt;gpu1_l0_attn_out -->
<g id="edge16" class="edge">
<title>gpu1_l0_attn_v&#45;&gt;gpu1_l0_attn_out</title>
<path fill="none" stroke="black" d="M5941.25,-2056.78C5941.25,-2056.78 5941.25,-1995.34 5941.25,-1995.34"/>
<polygon fill="black" stroke="black" points="5944.75,-1995.34 5941.25,-1985.34 5937.75,-1995.34 5944.75,-1995.34"/>
</g>
<!-- gpu1_l0_attn_softmax -->
<g id="node25" class="node">
<title>gpu1_l0_attn_softmax</title>
<polygon fill="lightgreen" stroke="black" points="5866.5,-2109.08 5719.5,-2109.08 5719.5,-2057.08 5866.5,-2057.08 5866.5,-2109.08"/>
<text text-anchor="middle" x="5793" y="-2097.08" font-family="Times,serif" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="5793" y="-2086.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]</text>
<text text-anchor="middle" x="5793" y="-2075.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="5793" y="-2064.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_attn_score&#45;&gt;gpu1_l0_attn_softmax -->
<g id="edge17" class="edge">
<title>gpu1_l0_attn_score&#45;&gt;gpu1_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M5793,-2180.78C5793,-2180.78 5793,-2119.34 5793,-2119.34"/>
<polygon fill="black" stroke="black" points="5796.5,-2119.34 5793,-2109.34 5789.5,-2119.34 5796.5,-2119.34"/>
</g>
<!-- gpu1_l0_attn_softmax&#45;&gt;gpu1_l0_attn_out -->
<g id="edge18" class="edge">
<title>gpu1_l0_attn_softmax&#45;&gt;gpu1_l0_attn_out</title>
<path fill="none" stroke="black" d="M5805.25,-2056.78C5805.25,-2056.78 5805.25,-1995.34 5805.25,-1995.34"/>
<polygon fill="black" stroke="black" points="5808.75,-1995.34 5805.25,-1985.34 5801.75,-1995.34 5808.75,-1995.34"/>
</g>
<!-- gpu1_l0_attn_proj -->
<g id="node27" class="node">
<title>gpu1_l0_attn_proj</title>
<polygon fill="lightgreen" stroke="black" points="5931.5,-1861.08 5792.5,-1861.08 5792.5,-1809.08 5931.5,-1809.08 5931.5,-1861.08"/>
<text text-anchor="middle" x="5862" y="-1849.08" font-family="Times,serif" font-size="10.00">Attention Projection</text>
<text text-anchor="middle" x="5862" y="-1838.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="5862" y="-1827.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="5862" y="-1816.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_attn_out&#45;&gt;gpu1_l0_attn_proj -->
<g id="edge19" class="edge">
<title>gpu1_l0_attn_out&#45;&gt;gpu1_l0_attn_proj</title>
<path fill="none" stroke="black" d="M5862,-1932.78C5862,-1932.78 5862,-1871.34 5862,-1871.34"/>
<polygon fill="black" stroke="black" points="5865.5,-1871.34 5862,-1861.34 5858.5,-1871.34 5865.5,-1871.34"/>
</g>
<!-- gpu1_l0_attn_ar -->
<g id="node28" class="node">
<title>gpu1_l0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="5862" cy="-1700.31" rx="97.66" ry="36.54"/>
<text text-anchor="middle" x="5862" y="-1714.31" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5862" y="-1703.31" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="5862" y="-1692.31" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="5862" y="-1681.31" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
</g>
<!-- gpu1_l0_attn_proj&#45;&gt;gpu1_l0_attn_ar -->
<g id="edge20" class="edge">
<title>gpu1_l0_attn_proj&#45;&gt;gpu1_l0_attn_ar</title>
<path fill="none" stroke="black" d="M5862,-1808.77C5862,-1808.77 5862,-1747.25 5862,-1747.25"/>
<polygon fill="black" stroke="black" points="5865.5,-1747.25 5862,-1737.25 5858.5,-1747.25 5865.5,-1747.25"/>
</g>
<!-- gpu1_l0_gate -->
<g id="node29" class="node">
<title>gpu1_l0_gate</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="5809.7,-1591.54 5592.24,-1591.54 5536.3,-1487.54 5753.76,-1487.54 5809.7,-1591.54"/>
<text text-anchor="middle" x="5673" y="-1553.54" font-family="Times,serif" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="5673" y="-1542.54" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="5673" y="-1531.54" font-family="Times,serif" font-size="10.00">Output: [128,10240,16]</text>
<text text-anchor="middle" x="5673" y="-1520.54" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_attn_ar&#45;&gt;gpu1_l0_gate -->
<g id="edge23" class="edge">
<title>gpu1_l0_attn_ar&#45;&gt;gpu1_l0_gate</title>
<path fill="none" stroke="black" d="M5787.14,-1676.59C5787.14,-1676.59 5787.14,-1601.63 5787.14,-1601.63"/>
<polygon fill="black" stroke="black" points="5790.64,-1601.63 5787.14,-1591.63 5783.64,-1601.63 5790.64,-1601.63"/>
</g>
<!-- gpu1_l0_ln1 -->
<g id="node38" class="node">
<title>gpu1_l0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="5984,-1565.54 5846,-1565.54 5846,-1513.54 5984,-1513.54 5984,-1565.54"/>
<text text-anchor="middle" x="5915" y="-1553.54" font-family="Times,serif" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="5915" y="-1542.54" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="5915" y="-1531.54" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="5915" y="-1520.54" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_attn_ar&#45;&gt;gpu1_l0_ln1 -->
<g id="edge24" class="edge">
<title>gpu1_l0_attn_ar&#45;&gt;gpu1_l0_ln1</title>
<path fill="none" stroke="black" d="M5902.79,-1666.61C5902.79,-1666.61 5902.79,-1575.78 5902.79,-1575.78"/>
<polygon fill="black" stroke="black" points="5906.29,-1575.78 5902.79,-1565.78 5899.29,-1575.78 5906.29,-1575.78"/>
</g>
<!-- gpu1_l0_exp8_fc1 -->
<g id="node30" class="node">
<title>gpu1_l0_exp8_fc1</title>
<polygon fill="lightgreen" stroke="black" points="5683.5,-2383.08 5556.5,-2383.08 5556.5,-2331.08 5683.5,-2331.08 5683.5,-2383.08"/>
<text text-anchor="middle" x="5620" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert 8 FC1</text>
<text text-anchor="middle" x="5620" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="5620" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="5620" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_exp8_act -->
<g id="node31" class="node">
<title>gpu1_l0_exp8_act</title>
<polygon fill="lightgreen" stroke="black" points="5520.5,-2383.08 5393.5,-2383.08 5393.5,-2331.08 5520.5,-2331.08 5520.5,-2383.08"/>
<text text-anchor="middle" x="5457" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert 8 Activation</text>
<text text-anchor="middle" x="5457" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="5457" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="5457" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_exp8_fc2 -->
<g id="node32" class="node">
<title>gpu1_l0_exp8_fc2</title>
<polygon fill="lightgreen" stroke="black" points="5357.5,-2383.08 5236.5,-2383.08 5236.5,-2331.08 5357.5,-2331.08 5357.5,-2383.08"/>
<text text-anchor="middle" x="5297" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert 8 FC2</text>
<text text-anchor="middle" x="5297" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="5297" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="5297" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_exp9_fc1 -->
<g id="node33" class="node">
<title>gpu1_l0_exp9_fc1</title>
<polygon fill="lightgreen" stroke="black" points="5200.5,-2383.08 5073.5,-2383.08 5073.5,-2331.08 5200.5,-2331.08 5200.5,-2383.08"/>
<text text-anchor="middle" x="5137" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert 9 FC1</text>
<text text-anchor="middle" x="5137" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="5137" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="5137" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_exp9_act -->
<g id="node34" class="node">
<title>gpu1_l0_exp9_act</title>
<polygon fill="lightgreen" stroke="black" points="5037.5,-2383.08 4910.5,-2383.08 4910.5,-2331.08 5037.5,-2331.08 5037.5,-2383.08"/>
<text text-anchor="middle" x="4974" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert 9 Activation</text>
<text text-anchor="middle" x="4974" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="4974" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="4974" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_exp9_fc2 -->
<g id="node35" class="node">
<title>gpu1_l0_exp9_fc2</title>
<polygon fill="lightgreen" stroke="black" points="4874.5,-2383.08 4753.5,-2383.08 4753.5,-2331.08 4874.5,-2331.08 4874.5,-2383.08"/>
<text text-anchor="middle" x="4814" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert 9 FC2</text>
<text text-anchor="middle" x="4814" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="4814" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="4814" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_ep_a2a -->
<g id="node36" class="node">
<title>gpu1_l0_ep_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="4620" cy="-2357.08" rx="97.66" ry="36.54"/>
<text text-anchor="middle" x="4620" y="-2371.08" font-family="Times,serif" font-size="10.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="4620" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="4620" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="4620" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
</g>
<!-- gpu1_l0_exp_agg -->
<g id="node37" class="node">
<title>gpu1_l0_exp_agg</title>
<polygon fill="lightyellow" stroke="black" points="4486.14,-2409.08 4258.43,-2409.08 4199.86,-2305.08 4427.57,-2305.08 4486.14,-2409.08"/>
<text text-anchor="middle" x="4343" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4343" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="4343" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="4343" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu1_l0_ln2 -->
<g id="node39" class="node">
<title>gpu1_l0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="4164,-2383.08 4026,-2383.08 4026,-2331.08 4164,-2331.08 4164,-2383.08"/>
<text text-anchor="middle" x="4095" y="-2371.08" font-family="Times,serif" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="4095" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="4095" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="4095" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- gpu3_l8_attn_q -->
<g id="node57" class="node">
<title>gpu3_l8_attn_q</title>
<polygon fill="lightgreen" stroke="black" points="3547.5,-468 3400.5,-468 3400.5,-416 3547.5,-416 3547.5,-468"/>
<text text-anchor="middle" x="3474" y="-456" font-family="Times,serif" font-size="10.00">Attention Q Projection</text>
<text text-anchor="middle" x="3474" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="3474" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="3474" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu1_l0_ln2&#45;&gt;gpu3_l8_attn_q -->
<g id="edge38" class="edge">
<title>gpu1_l0_ln2&#45;&gt;gpu3_l8_attn_q</title>
<path fill="none" stroke="black" d="M4025.87,-2344C3864,-2344 3474,-2344 3474,-2344 3474,-2344 3474,-478.16 3474,-478.16"/>
<polygon fill="black" stroke="black" points="3477.5,-478.16 3474,-468.16 3470.5,-478.16 3477.5,-478.16"/>
</g>
<!-- gpu3_l8_attn_k -->
<g id="node58" class="node">
<title>gpu3_l8_attn_k</title>
<polygon fill="lightgreen" stroke="black" points="3181.5,-468 3034.5,-468 3034.5,-416 3181.5,-416 3181.5,-468"/>
<text text-anchor="middle" x="3108" y="-456" font-family="Times,serif" font-size="10.00">Attention K Projection</text>
<text text-anchor="middle" x="3108" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="3108" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="3108" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu1_l0_ln2&#45;&gt;gpu3_l8_attn_k -->
<g id="edge39" class="edge">
<title>gpu1_l0_ln2&#45;&gt;gpu3_l8_attn_k</title>
<path fill="none" stroke="black" d="M4025.99,-2370C3801.74,-2370 3108,-2370 3108,-2370 3108,-2370 3108,-478.16 3108,-478.16"/>
<polygon fill="black" stroke="black" points="3111.5,-478.16 3108,-468.16 3104.5,-478.16 3111.5,-478.16"/>
</g>
<!-- gpu3_l8_attn_v -->
<g id="node59" class="node">
<title>gpu3_l8_attn_v</title>
<polygon fill="lightgreen" stroke="black" points="3364.5,-468 3217.5,-468 3217.5,-416 3364.5,-416 3364.5,-468"/>
<text text-anchor="middle" x="3291" y="-456" font-family="Times,serif" font-size="10.00">Attention V Projection</text>
<text text-anchor="middle" x="3291" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="3291" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="3291" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu1_l0_ln2&#45;&gt;gpu3_l8_attn_v -->
<g id="edge40" class="edge">
<title>gpu1_l0_ln2&#45;&gt;gpu3_l8_attn_v</title>
<path fill="none" stroke="black" d="M4025.76,-2357C3830.73,-2357 3291,-2357 3291,-2357 3291,-2357 3291,-478.34 3291,-478.34"/>
<polygon fill="black" stroke="black" points="3294.5,-478.34 3291,-468.34 3287.5,-478.34 3294.5,-478.34"/>
</g>
<!-- gpu2_l8_attn_score -->
<g id="node43" class="node">
<title>gpu2_l8_attn_score</title>
<polygon fill="lightgreen" stroke="black" points="6550,-468 6314,-468 6314,-416 6550,-416 6550,-468"/>
<text text-anchor="middle" x="6432" y="-456" font-family="Times,serif" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="6432" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]×[128,10240,16,16]</text>
<text text-anchor="middle" x="6432" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="6432" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_l8_attn_softmax -->
<g id="node44" class="node">
<title>gpu2_l8_attn_softmax</title>
<polygon fill="lightgreen" stroke="black" points="6277.5,-468 6130.5,-468 6130.5,-416 6277.5,-416 6277.5,-468"/>
<text text-anchor="middle" x="6204" y="-456" font-family="Times,serif" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="6204" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]</text>
<text text-anchor="middle" x="6204" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="6204" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_l8_attn_out -->
<g id="node45" class="node">
<title>gpu2_l8_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="6094,-468 5858,-468 5858,-416 6094,-416 6094,-468"/>
<text text-anchor="middle" x="5976" y="-456" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="5976" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]×[128,10240,16,16]</text>
<text text-anchor="middle" x="5976" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,32]</text>
<text text-anchor="middle" x="5976" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_l8_attn_proj -->
<g id="node46" class="node">
<title>gpu2_l8_attn_proj</title>
<polygon fill="lightgreen" stroke="black" points="5821.5,-468 5682.5,-468 5682.5,-416 5821.5,-416 5821.5,-468"/>
<text text-anchor="middle" x="5752" y="-456" font-family="Times,serif" font-size="10.00">Attention Projection</text>
<text text-anchor="middle" x="5752" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="5752" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="5752" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_l8_attn_ar -->
<g id="node47" class="node">
<title>gpu2_l8_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="5549" cy="-442" rx="97.66" ry="36.54"/>
<text text-anchor="middle" x="5549" y="-456" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5549" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="5549" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="5549" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
</g>
<!-- gpu2_l8_gate -->
<g id="node48" class="node">
<title>gpu2_l8_gate</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="5415.7,-494 5198.24,-494 5142.3,-390 5359.76,-390 5415.7,-494"/>
<text text-anchor="middle" x="5279" y="-456" font-family="Times,serif" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="5279" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="5279" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16]</text>
<text text-anchor="middle" x="5279" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_l8_exp0_fc1 -->
<g id="node49" class="node">
<title>gpu2_l8_exp0_fc1</title>
<polygon fill="lightgreen" stroke="black" points="5106.5,-468 4979.5,-468 4979.5,-416 5106.5,-416 5106.5,-468"/>
<text text-anchor="middle" x="5043" y="-456" font-family="Times,serif" font-size="10.00">Expert 0 FC1</text>
<text text-anchor="middle" x="5043" y="-445" font-family="Times,serif" font-size="10.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="5043" y="-434" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="5043" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_l8_exp0_act -->
<g id="node50" class="node">
<title>gpu2_l8_exp0_act</title>
<polygon fill="lightgreen" stroke="black" points="4943.5,-468 4816.5,-468 4816.5,-416 4943.5,-416 4943.5,-468"/>
<text text-anchor="middle" x="4880" y="-456" font-family="Times,serif" font-size="10.00">Expert 0 Activation</text>
<text text-anchor="middle" x="4880" y="-445" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="4880" y="-434" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="4880" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_l8_exp0_fc2 -->
<g id="node51" class="node">
<title>gpu2_l8_exp0_fc2</title>
<polygon fill="lightgreen" stroke="black" points="4780.5,-468 4659.5,-468 4659.5,-416 4780.5,-416 4780.5,-468"/>
<text text-anchor="middle" x="4720" y="-456" font-family="Times,serif" font-size="10.00">Expert 0 FC2</text>
<text text-anchor="middle" x="4720" y="-445" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="4720" y="-434" font-family="Times,serif" font-size="10.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="4720" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_l8_ep_a2a -->
<g id="node52" class="node">
<title>gpu2_l8_ep_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="4526" cy="-442" rx="97.66" ry="36.54"/>
<text text-anchor="middle" x="4526" y="-456" font-family="Times,serif" font-size="10.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="4526" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="4526" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="4526" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
</g>
<!-- gpu2_l8_exp_agg -->
<g id="node53" class="node">
<title>gpu2_l8_exp_agg</title>
<polygon fill="lightyellow" stroke="black" points="4392.14,-494 4164.43,-494 4105.86,-390 4333.57,-390 4392.14,-494"/>
<text text-anchor="middle" x="4249" y="-456" font-family="Times,serif" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4249" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="4249" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="4249" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_l8_ln1 -->
<g id="node54" class="node">
<title>gpu2_l8_ln1</title>
<polygon fill="lightgreen" stroke="black" points="4070,-468 3932,-468 3932,-416 4070,-416 4070,-468"/>
<text text-anchor="middle" x="4001" y="-456" font-family="Times,serif" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="4001" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="4001" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="4001" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_l8_ln2 -->
<g id="node55" class="node">
<title>gpu2_l8_ln2</title>
<polygon fill="lightgreen" stroke="black" points="3896,-468 3758,-468 3758,-416 3896,-416 3896,-468"/>
<text text-anchor="middle" x="3827" y="-456" font-family="Times,serif" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="3827" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="3827" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="3827" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- gpu2_output_proj -->
<g id="node56" class="node">
<title>gpu2_output_proj</title>
<polygon fill="lightgreen" stroke="black" points="3722,-468 3584,-468 3584,-416 3722,-416 3722,-468"/>
<text text-anchor="middle" x="3653" y="-456" font-family="Times,serif" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3653" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="3653" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="3653" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- output_agg -->
<g id="node74" class="node">
<title>output_agg</title>
<polygon fill="lightyellow" stroke="black" points="1939.09,-312 1701.92,-312 1640.91,-208 1878.08,-208 1939.09,-312"/>
<text text-anchor="middle" x="1790" y="-274" font-family="Times,serif" font-size="10.00">Output Aggregation</text>
<text text-anchor="middle" x="1790" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]×2</text>
<text text-anchor="middle" x="1790" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="1790" y="-241" font-family="Times,serif" font-size="10.00">GPU: ALL</text>
</g>
<!-- gpu2_output_proj&#45;&gt;output_agg -->
<g id="edge41" class="edge">
<title>gpu2_output_proj&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M3653,-415.77C3653,-374.49 3653,-299 3653,-299 3653,-299 1941.56,-299 1941.56,-299"/>
<polygon fill="black" stroke="black" points="1941.56,-295.5 1931.56,-299 1941.56,-302.5 1941.56,-295.5"/>
</g>
<!-- gpu3_l8_attn_score -->
<g id="node60" class="node">
<title>gpu3_l8_attn_score</title>
<polygon fill="lightgreen" stroke="black" points="2998,-468 2762,-468 2762,-416 2998,-416 2998,-468"/>
<text text-anchor="middle" x="2880" y="-456" font-family="Times,serif" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="2880" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]×[128,10240,16,16]</text>
<text text-anchor="middle" x="2880" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="2880" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_l8_attn_softmax -->
<g id="node61" class="node">
<title>gpu3_l8_attn_softmax</title>
<polygon fill="lightgreen" stroke="black" points="2725.5,-468 2578.5,-468 2578.5,-416 2725.5,-416 2725.5,-468"/>
<text text-anchor="middle" x="2652" y="-456" font-family="Times,serif" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="2652" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]</text>
<text text-anchor="middle" x="2652" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,16]</text>
<text text-anchor="middle" x="2652" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_l8_attn_out -->
<g id="node62" class="node">
<title>gpu3_l8_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="2542,-468 2306,-468 2306,-416 2542,-416 2542,-468"/>
<text text-anchor="middle" x="2424" y="-456" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="2424" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,16]×[128,10240,16,16]</text>
<text text-anchor="middle" x="2424" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16,32]</text>
<text text-anchor="middle" x="2424" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_l8_attn_proj -->
<g id="node63" class="node">
<title>gpu3_l8_attn_proj</title>
<polygon fill="lightgreen" stroke="black" points="2269.5,-468 2130.5,-468 2130.5,-416 2269.5,-416 2269.5,-468"/>
<text text-anchor="middle" x="2200" y="-456" font-family="Times,serif" font-size="10.00">Attention Projection</text>
<text text-anchor="middle" x="2200" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,16,32]</text>
<text text-anchor="middle" x="2200" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="2200" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_l8_attn_ar -->
<g id="node64" class="node">
<title>gpu3_l8_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1997" cy="-442" rx="97.66" ry="36.54"/>
<text text-anchor="middle" x="1997" y="-456" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1997" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="1997" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="1997" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
</g>
<!-- gpu3_l8_gate -->
<g id="node65" class="node">
<title>gpu3_l8_gate</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="1863.7,-494 1646.24,-494 1590.3,-390 1807.76,-390 1863.7,-494"/>
<text text-anchor="middle" x="1727" y="-456" font-family="Times,serif" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="1727" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="1727" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,16]</text>
<text text-anchor="middle" x="1727" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_l8_exp8_fc1 -->
<g id="node66" class="node">
<title>gpu3_l8_exp8_fc1</title>
<polygon fill="lightgreen" stroke="black" points="1554.5,-468 1427.5,-468 1427.5,-416 1554.5,-416 1554.5,-468"/>
<text text-anchor="middle" x="1491" y="-456" font-family="Times,serif" font-size="10.00">Expert 8 FC1</text>
<text text-anchor="middle" x="1491" y="-445" font-family="Times,serif" font-size="10.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="1491" y="-434" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="1491" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_l8_exp8_act -->
<g id="node67" class="node">
<title>gpu3_l8_exp8_act</title>
<polygon fill="lightgreen" stroke="black" points="1391.5,-468 1264.5,-468 1264.5,-416 1391.5,-416 1391.5,-468"/>
<text text-anchor="middle" x="1328" y="-456" font-family="Times,serif" font-size="10.00">Expert 8 Activation</text>
<text text-anchor="middle" x="1328" y="-445" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="1328" y="-434" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="1328" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_l8_exp8_fc2 -->
<g id="node68" class="node">
<title>gpu3_l8_exp8_fc2</title>
<polygon fill="lightgreen" stroke="black" points="1228.5,-468 1107.5,-468 1107.5,-416 1228.5,-416 1228.5,-468"/>
<text text-anchor="middle" x="1168" y="-456" font-family="Times,serif" font-size="10.00">Expert 8 FC2</text>
<text text-anchor="middle" x="1168" y="-445" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="1168" y="-434" font-family="Times,serif" font-size="10.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="1168" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_l8_ep_a2a -->
<g id="node69" class="node">
<title>gpu3_l8_ep_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="974" cy="-442" rx="97.66" ry="36.54"/>
<text text-anchor="middle" x="974" y="-456" font-family="Times,serif" font-size="10.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="974" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="974" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="974" y="-423" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
</g>
<!-- gpu3_l8_exp_agg -->
<g id="node70" class="node">
<title>gpu3_l8_exp_agg</title>
<polygon fill="lightyellow" stroke="black" points="840.14,-494 612.43,-494 553.86,-390 781.57,-390 840.14,-494"/>
<text text-anchor="middle" x="697" y="-456" font-family="Times,serif" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="697" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="697" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="697" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_l8_ln1 -->
<g id="node71" class="node">
<title>gpu3_l8_ln1</title>
<polygon fill="lightgreen" stroke="black" points="518,-468 380,-468 380,-416 518,-416 518,-468"/>
<text text-anchor="middle" x="449" y="-456" font-family="Times,serif" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="449" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="449" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="449" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_l8_ln2 -->
<g id="node72" class="node">
<title>gpu3_l8_ln2</title>
<polygon fill="lightgreen" stroke="black" points="344,-468 206,-468 206,-416 344,-416 344,-468"/>
<text text-anchor="middle" x="275" y="-456" font-family="Times,serif" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="275" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="275" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="275" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_output_proj -->
<g id="node73" class="node">
<title>gpu3_output_proj</title>
<polygon fill="lightgreen" stroke="black" points="170,-468 32,-468 32,-416 170,-416 170,-468"/>
<text text-anchor="middle" x="101" y="-456" font-family="Times,serif" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="101" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,10240,512]</text>
<text text-anchor="middle" x="101" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,10240,512]</text>
<text text-anchor="middle" x="101" y="-423" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- gpu3_output_proj&#45;&gt;output_agg -->
<g id="edge42" class="edge">
<title>gpu3_output_proj&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M101,-415.92C101,-365.6 101,-260 101,-260 101,-260 1661.23,-260 1661.23,-260"/>
<polygon fill="black" stroke="black" points="1661.23,-263.5 1671.23,-260 1661.23,-256.5 1661.23,-263.5"/>
</g>
<!-- decode_input -->
<g id="node75" class="node">
<title>decode_input</title>
<polygon fill="lightyellow" stroke="black" points="11755.18,-2563.08 11212.44,-2563.08 11072.82,-2481.08 11615.56,-2481.08 11755.18,-2563.08"/>
<text text-anchor="middle" x="11414" y="-2530.58" font-family="Times,serif" font-size="10.00">Decode Input</text>
<text text-anchor="middle" x="11414" y="-2519.58" font-family="Times,serif" font-size="10.00">[batch=128, seq=1, dim=512]→[batch=128, seq=1, dim=256]</text>
<text text-anchor="middle" x="11414" y="-2508.58" font-family="Times,serif" font-size="10.00">GPU: ALL</text>
</g>
<!-- dec_gpu0_l0_attn_q -->
<g id="node76" class="node">
<title>dec_gpu0_l0_attn_q</title>
<polygon fill="lightgreen" stroke="black" points="9779.5,-2233.08 9656.5,-2233.08 9656.5,-2181.08 9779.5,-2181.08 9779.5,-2233.08"/>
<text text-anchor="middle" x="9718" y="-2221.08" font-family="Times,serif" font-size="10.00">Attention Q</text>
<text text-anchor="middle" x="9718" y="-2210.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="9718" y="-2199.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,16]</text>
<text text-anchor="middle" x="9718" y="-2188.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- decode_input&#45;&gt;dec_gpu0_l0_attn_q -->
<g id="edge43" class="edge">
<title>decode_input&#45;&gt;dec_gpu0_l0_attn_q</title>
<path fill="none" stroke="black" d="M11176.47,-2542C10704.99,-2542 9696,-2542 9696,-2542 9696,-2542 9696,-2243.08 9696,-2243.08"/>
<polygon fill="black" stroke="black" points="9699.5,-2243.08 9696,-2233.08 9692.5,-2243.08 9699.5,-2243.08"/>
</g>
<!-- dec_gpu0_l0_attn_k -->
<g id="node77" class="node">
<title>dec_gpu0_l0_attn_k</title>
<polygon fill="lightgreen" stroke="black" points="10017.5,-2383.08 9894.5,-2383.08 9894.5,-2331.08 10017.5,-2331.08 10017.5,-2383.08"/>
<text text-anchor="middle" x="9956" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention K</text>
<text text-anchor="middle" x="9956" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="9956" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,16]</text>
<text text-anchor="middle" x="9956" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- decode_input&#45;&gt;dec_gpu0_l0_attn_k -->
<g id="edge44" class="edge">
<title>decode_input&#45;&gt;dec_gpu0_l0_attn_k</title>
<path fill="none" stroke="black" d="M11106.58,-2501C10678.82,-2501 9956,-2501 9956,-2501 9956,-2501 9956,-2393.14 9956,-2393.14"/>
<polygon fill="black" stroke="black" points="9959.5,-2393.14 9956,-2383.14 9952.5,-2393.14 9959.5,-2393.14"/>
</g>
<!-- dec_gpu0_l0_attn_v -->
<g id="node78" class="node">
<title>dec_gpu0_l0_attn_v</title>
<polygon fill="lightgreen" stroke="black" points="9858.5,-2383.08 9735.5,-2383.08 9735.5,-2331.08 9858.5,-2331.08 9858.5,-2383.08"/>
<text text-anchor="middle" x="9797" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention V</text>
<text text-anchor="middle" x="9797" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="9797" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,16]</text>
<text text-anchor="middle" x="9797" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- decode_input&#45;&gt;dec_gpu0_l0_attn_v -->
<g id="edge45" class="edge">
<title>decode_input&#45;&gt;dec_gpu0_l0_attn_v</title>
<path fill="none" stroke="black" d="M11142.44,-2522C10681.86,-2522 9797,-2522 9797,-2522 9797,-2522 9797,-2393.21 9797,-2393.21"/>
<polygon fill="black" stroke="black" points="9800.5,-2393.21 9797,-2383.21 9793.5,-2393.21 9800.5,-2393.21"/>
</g>
<!-- dec_gpu1_l0_attn_q -->
<g id="node93" class="node">
<title>dec_gpu1_l0_attn_q</title>
<polygon fill="lightgreen" stroke="black" points="12933.5,-2383.08 12810.5,-2383.08 12810.5,-2331.08 12933.5,-2331.08 12933.5,-2383.08"/>
<text text-anchor="middle" x="12872" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention Q</text>
<text text-anchor="middle" x="12872" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="12872" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,16]</text>
<text text-anchor="middle" x="12872" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- decode_input&#45;&gt;dec_gpu1_l0_attn_q -->
<g id="edge46" class="edge">
<title>decode_input&#45;&gt;dec_gpu1_l0_attn_q</title>
<path fill="none" stroke="black" d="M11649.87,-2501C12062.52,-2501 12872,-2501 12872,-2501 12872,-2501 12872,-2393.14 12872,-2393.14"/>
<polygon fill="black" stroke="black" points="12875.5,-2393.14 12872,-2383.14 12868.5,-2393.14 12875.5,-2393.14"/>
</g>
<!-- dec_gpu1_l0_attn_k -->
<g id="node94" class="node">
<title>dec_gpu1_l0_attn_k</title>
<polygon fill="lightgreen" stroke="black" points="13251.5,-2383.08 13128.5,-2383.08 13128.5,-2331.08 13251.5,-2331.08 13251.5,-2383.08"/>
<text text-anchor="middle" x="13190" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention K</text>
<text text-anchor="middle" x="13190" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="13190" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,16]</text>
<text text-anchor="middle" x="13190" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- decode_input&#45;&gt;dec_gpu1_l0_attn_k -->
<g id="edge47" class="edge">
<title>decode_input&#45;&gt;dec_gpu1_l0_attn_k</title>
<path fill="none" stroke="black" d="M11719.31,-2542C12227.09,-2542 13190,-2542 13190,-2542 13190,-2542 13190,-2393.18 13190,-2393.18"/>
<polygon fill="black" stroke="black" points="13193.5,-2393.18 13190,-2383.18 13186.5,-2393.18 13193.5,-2393.18"/>
</g>
<!-- dec_gpu1_l0_attn_v -->
<g id="node95" class="node">
<title>dec_gpu1_l0_attn_v</title>
<polygon fill="lightgreen" stroke="black" points="13092.5,-2383.08 12969.5,-2383.08 12969.5,-2331.08 13092.5,-2331.08 13092.5,-2383.08"/>
<text text-anchor="middle" x="13031" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention V</text>
<text text-anchor="middle" x="13031" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="13031" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,16]</text>
<text text-anchor="middle" x="13031" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- decode_input&#45;&gt;dec_gpu1_l0_attn_v -->
<g id="edge48" class="edge">
<title>decode_input&#45;&gt;dec_gpu1_l0_attn_v</title>
<path fill="none" stroke="black" d="M11685.56,-2522C12146.14,-2522 13031,-2522 13031,-2522 13031,-2522 13031,-2393.21 13031,-2393.21"/>
<polygon fill="black" stroke="black" points="13034.5,-2393.21 13031,-2383.21 13027.5,-2393.21 13034.5,-2393.21"/>
</g>
<!-- dec_gpu0_l0_attn_score -->
<g id="node80" class="node">
<title>dec_gpu0_l0_attn_score</title>
<polygon fill="lightgreen" stroke="black" points="9938,-2109.08 9724,-2109.08 9724,-2057.08 9938,-2057.08 9938,-2109.08"/>
<text text-anchor="middle" x="9831" y="-2097.08" font-family="Times,serif" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="9831" y="-2086.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,16]×[128,seq+1,16,16]</text>
<text text-anchor="middle" x="9831" y="-2075.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="9831" y="-2064.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_attn_q&#45;&gt;dec_gpu0_l0_attn_score -->
<g id="edge49" class="edge">
<title>dec_gpu0_l0_attn_q&#45;&gt;dec_gpu0_l0_attn_score</title>
<path fill="none" stroke="black" d="M9751.75,-2180.78C9751.75,-2180.78 9751.75,-2119.34 9751.75,-2119.34"/>
<polygon fill="black" stroke="black" points="9755.25,-2119.34 9751.75,-2109.34 9748.25,-2119.34 9755.25,-2119.34"/>
</g>
<!-- dec_gpu0_l0_kv_cache -->
<g id="node79" class="node">
<title>dec_gpu0_l0_kv_cache</title>
<polygon fill="lightgreen" stroke="black" points="9964.5,-2233.08 9815.5,-2233.08 9815.5,-2181.08 9964.5,-2181.08 9964.5,-2233.08"/>
<text text-anchor="middle" x="9890" y="-2221.08" font-family="Times,serif" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="9890" y="-2210.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,16]</text>
<text text-anchor="middle" x="9890" y="-2199.08" font-family="Times,serif" font-size="10.00">Output: [128,seq+1,16,16]</text>
<text text-anchor="middle" x="9890" y="-2188.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_attn_k&#45;&gt;dec_gpu0_l0_kv_cache -->
<g id="edge50" class="edge">
<title>dec_gpu0_l0_attn_k&#45;&gt;dec_gpu0_l0_kv_cache</title>
<path fill="none" stroke="black" d="M9929.5,-2330.95C9929.5,-2330.95 9929.5,-2243.16 9929.5,-2243.16"/>
<polygon fill="black" stroke="black" points="9933,-2243.16 9929.5,-2233.16 9926,-2243.16 9933,-2243.16"/>
</g>
<!-- dec_gpu0_l0_attn_v&#45;&gt;dec_gpu0_l0_kv_cache -->
<g id="edge51" class="edge">
<title>dec_gpu0_l0_attn_v&#45;&gt;dec_gpu0_l0_kv_cache</title>
<path fill="none" stroke="black" d="M9837,-2330.95C9837,-2330.95 9837,-2243.16 9837,-2243.16"/>
<polygon fill="black" stroke="black" points="9840.5,-2243.16 9837,-2233.16 9833.5,-2243.16 9840.5,-2243.16"/>
</g>
<!-- dec_gpu0_l0_kv_cache&#45;&gt;dec_gpu0_l0_attn_score -->
<g id="edge52" class="edge">
<title>dec_gpu0_l0_kv_cache&#45;&gt;dec_gpu0_l0_attn_score</title>
<path fill="none" stroke="black" d="M9876.75,-2180.78C9876.75,-2180.78 9876.75,-2119.34 9876.75,-2119.34"/>
<polygon fill="black" stroke="black" points="9880.25,-2119.34 9876.75,-2109.34 9873.25,-2119.34 9880.25,-2119.34"/>
</g>
<!-- dec_gpu0_l0_attn_softmax -->
<g id="node81" class="node">
<title>dec_gpu0_l0_attn_softmax</title>
<polygon fill="lightgreen" stroke="black" points="9902.5,-1985.08 9759.5,-1985.08 9759.5,-1933.08 9902.5,-1933.08 9902.5,-1985.08"/>
<text text-anchor="middle" x="9831" y="-1973.08" font-family="Times,serif" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="9831" y="-1962.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="9831" y="-1951.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="9831" y="-1940.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_attn_score&#45;&gt;dec_gpu0_l0_attn_softmax -->
<g id="edge53" class="edge">
<title>dec_gpu0_l0_attn_score&#45;&gt;dec_gpu0_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M9831,-2056.78C9831,-2056.78 9831,-1995.34 9831,-1995.34"/>
<polygon fill="black" stroke="black" points="9834.5,-1995.34 9831,-1985.34 9827.5,-1995.34 9834.5,-1995.34"/>
</g>
<!-- dec_gpu0_l0_attn_out -->
<g id="node82" class="node">
<title>dec_gpu0_l0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="9948,-1861.08 9714,-1861.08 9714,-1809.08 9948,-1809.08 9948,-1861.08"/>
<text text-anchor="middle" x="9831" y="-1849.08" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="9831" y="-1838.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,seq+1]×[128,seq+1,16,16]</text>
<text text-anchor="middle" x="9831" y="-1827.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,32]</text>
<text text-anchor="middle" x="9831" y="-1816.08" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_attn_softmax&#45;&gt;dec_gpu0_l0_attn_out -->
<g id="edge54" class="edge">
<title>dec_gpu0_l0_attn_softmax&#45;&gt;dec_gpu0_l0_attn_out</title>
<path fill="none" stroke="black" d="M9831,-1932.78C9831,-1932.78 9831,-1871.34 9831,-1871.34"/>
<polygon fill="black" stroke="black" points="9834.5,-1871.34 9831,-1861.34 9827.5,-1871.34 9834.5,-1871.34"/>
</g>
<!-- dec_gpu0_l0_attn_proj -->
<g id="node83" class="node">
<title>dec_gpu0_l0_attn_proj</title>
<polygon fill="lightgreen" stroke="black" points="9889.5,-1726.31 9772.5,-1726.31 9772.5,-1674.31 9889.5,-1674.31 9889.5,-1726.31"/>
<text text-anchor="middle" x="9831" y="-1714.31" font-family="Times,serif" font-size="10.00">Attention Projection</text>
<text text-anchor="middle" x="9831" y="-1703.31" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="9831" y="-1692.31" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="9831" y="-1681.31" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_attn_out&#45;&gt;dec_gpu0_l0_attn_proj -->
<g id="edge55" class="edge">
<title>dec_gpu0_l0_attn_out&#45;&gt;dec_gpu0_l0_attn_proj</title>
<path fill="none" stroke="black" d="M9831,-1808.77C9831,-1808.77 9831,-1736.55 9831,-1736.55"/>
<polygon fill="black" stroke="black" points="9834.5,-1736.55 9831,-1726.55 9827.5,-1736.55 9834.5,-1736.55"/>
</g>
<!-- dec_gpu0_l0_attn_ar -->
<g id="node84" class="node">
<title>dec_gpu0_l0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="9831" cy="-1539.54" rx="80.72" ry="36.54"/>
<text text-anchor="middle" x="9831" y="-1553.54" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9831" y="-1542.54" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="9831" y="-1531.54" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="9831" y="-1520.54" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
</g>
<!-- dec_gpu0_l0_attn_proj&#45;&gt;dec_gpu0_l0_attn_ar -->
<g id="edge56" class="edge">
<title>dec_gpu0_l0_attn_proj&#45;&gt;dec_gpu0_l0_attn_ar</title>
<path fill="none" stroke="black" d="M9831,-1674.12C9831,-1674.12 9831,-1586.52 9831,-1586.52"/>
<polygon fill="black" stroke="black" points="9834.5,-1586.52 9831,-1576.52 9827.5,-1586.52 9834.5,-1586.52"/>
</g>
<!-- dec_gpu0_l0_gate -->
<g id="node85" class="node">
<title>dec_gpu0_l0_gate</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="9879.94,-1415.54 9701.87,-1415.54 9656.06,-1311.54 9834.13,-1311.54 9879.94,-1415.54"/>
<text text-anchor="middle" x="9768" y="-1377.54" font-family="Times,serif" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="9768" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="9768" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [128,1,16]</text>
<text text-anchor="middle" x="9768" y="-1344.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_attn_ar&#45;&gt;dec_gpu0_l0_gate -->
<g id="edge57" class="edge">
<title>dec_gpu0_l0_attn_ar&#45;&gt;dec_gpu0_l0_gate</title>
<path fill="none" stroke="black" d="M9815.18,-1503.07C9815.18,-1503.07 9815.18,-1425.65 9815.18,-1425.65"/>
<polygon fill="black" stroke="black" points="9818.68,-1425.65 9815.18,-1415.65 9811.68,-1425.65 9818.68,-1425.65"/>
</g>
<!-- dec_gpu0_l0_ln1 -->
<g id="node91" class="node">
<title>dec_gpu0_l0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="10030,-1389.54 9916,-1389.54 9916,-1337.54 10030,-1337.54 10030,-1389.54"/>
<text text-anchor="middle" x="9973" y="-1377.54" font-family="Times,serif" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="9973" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="9973" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="9973" y="-1344.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_attn_ar&#45;&gt;dec_gpu0_l0_ln1 -->
<g id="edge58" class="edge">
<title>dec_gpu0_l0_attn_ar&#45;&gt;dec_gpu0_l0_ln1</title>
<path fill="none" stroke="black" d="M9892.73,-1515.73C9892.73,-1467.54 9892.73,-1363 9892.73,-1363 9892.73,-1363 9905.95,-1363 9905.95,-1363"/>
<polygon fill="black" stroke="black" points="9905.95,-1366.5 9915.95,-1363 9905.95,-1359.5 9905.95,-1366.5"/>
</g>
<!-- dec_gpu0_l0_exp0_fc1 -->
<g id="node86" class="node">
<title>dec_gpu0_l0_exp0_fc1</title>
<polygon fill="lightgreen" stroke="black" points="9835.5,-1239.54 9708.5,-1239.54 9708.5,-1187.54 9835.5,-1187.54 9835.5,-1239.54"/>
<text text-anchor="middle" x="9772" y="-1227.54" font-family="Times,serif" font-size="10.00">Expert 0 FC1</text>
<text text-anchor="middle" x="9772" y="-1216.54" font-family="Times,serif" font-size="10.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="9772" y="-1205.54" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="9772" y="-1194.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_gate&#45;&gt;dec_gpu0_l0_exp0_fc1 -->
<g id="edge59" class="edge">
<title>dec_gpu0_l0_gate&#45;&gt;dec_gpu0_l0_exp0_fc1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9772,-1311.5C9772,-1311.5 9772,-1249.8 9772,-1249.8"/>
<polygon fill="black" stroke="black" points="9775.5,-1249.8 9772,-1239.8 9768.5,-1249.8 9775.5,-1249.8"/>
</g>
<!-- dec_gpu0_l0_exp0_act -->
<g id="node87" class="node">
<title>dec_gpu0_l0_exp0_act</title>
<polygon fill="lightgreen" stroke="black" points="9905.5,-1115.54 9778.5,-1115.54 9778.5,-1063.54 9905.5,-1063.54 9905.5,-1115.54"/>
<text text-anchor="middle" x="9842" y="-1103.54" font-family="Times,serif" font-size="10.00">Expert 0 Activation</text>
<text text-anchor="middle" x="9842" y="-1092.54" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="9842" y="-1081.54" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="9842" y="-1070.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_exp0_fc1&#45;&gt;dec_gpu0_l0_exp0_act -->
<g id="edge60" class="edge">
<title>dec_gpu0_l0_exp0_fc1&#45;&gt;dec_gpu0_l0_exp0_act</title>
<path fill="none" stroke="black" d="M9807,-1187.24C9807,-1187.24 9807,-1125.8 9807,-1125.8"/>
<polygon fill="black" stroke="black" points="9810.5,-1125.8 9807,-1115.8 9803.5,-1125.8 9810.5,-1125.8"/>
</g>
<!-- dec_gpu0_l0_exp0_fc2 -->
<g id="node88" class="node">
<title>dec_gpu0_l0_exp0_fc2</title>
<polygon fill="lightgreen" stroke="black" points="9911.5,-980.77 9790.5,-980.77 9790.5,-928.77 9911.5,-928.77 9911.5,-980.77"/>
<text text-anchor="middle" x="9851" y="-968.77" font-family="Times,serif" font-size="10.00">Expert 0 FC2</text>
<text text-anchor="middle" x="9851" y="-957.77" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="9851" y="-946.77" font-family="Times,serif" font-size="10.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="9851" y="-935.77" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_exp0_act&#45;&gt;dec_gpu0_l0_exp0_fc2 -->
<g id="edge61" class="edge">
<title>dec_gpu0_l0_exp0_act&#45;&gt;dec_gpu0_l0_exp0_fc2</title>
<path fill="none" stroke="black" d="M9848,-1063.23C9848,-1063.23 9848,-991.01 9848,-991.01"/>
<polygon fill="black" stroke="black" points="9851.5,-991.01 9848,-981.01 9844.5,-991.01 9851.5,-991.01"/>
</g>
<!-- dec_gpu0_l0_ep_a2a -->
<g id="node89" class="node">
<title>dec_gpu0_l0_ep_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="9886" cy="-794" rx="80.72" ry="36.54"/>
<text text-anchor="middle" x="9886" y="-808" font-family="Times,serif" font-size="10.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="9886" y="-797" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="9886" y="-786" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="9886" y="-775" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
</g>
<!-- dec_gpu0_l0_exp0_fc2&#45;&gt;dec_gpu0_l0_ep_a2a -->
<g id="edge62" class="edge">
<title>dec_gpu0_l0_exp0_fc2&#45;&gt;dec_gpu0_l0_ep_a2a</title>
<path fill="none" stroke="black" d="M9858.44,-928.58C9858.44,-928.58 9858.44,-838.6 9858.44,-838.6"/>
<polygon fill="black" stroke="black" points="9861.95,-838.6 9858.44,-828.6 9854.95,-838.6 9861.95,-838.6"/>
</g>
<!-- dec_gpu0_l0_exp_agg -->
<g id="node90" class="node">
<title>dec_gpu0_l0_exp_agg</title>
<polygon fill="lightyellow" stroke="black" points="10013.17,-670 9818.82,-670 9768.83,-566 9963.18,-566 10013.17,-670"/>
<text text-anchor="middle" x="9891" y="-632" font-family="Times,serif" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="9891" y="-621" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="9891" y="-610" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="9891" y="-599" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_ep_a2a&#45;&gt;dec_gpu0_l0_exp_agg -->
<g id="edge63" class="edge">
<title>dec_gpu0_l0_ep_a2a&#45;&gt;dec_gpu0_l0_exp_agg</title>
<path fill="none" stroke="black" d="M9886,-757.1C9886,-757.1 9886,-680.2 9886,-680.2"/>
<polygon fill="black" stroke="black" points="9889.5,-680.2 9886,-670.2 9882.5,-680.2 9889.5,-680.2"/>
</g>
<!-- dec_gpu0_l0_ln2 -->
<g id="node92" class="node">
<title>dec_gpu0_l0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="10030,-468 9916,-468 9916,-416 10030,-416 10030,-468"/>
<text text-anchor="middle" x="9973" y="-456" font-family="Times,serif" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="9973" y="-445" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="9973" y="-434" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="9973" y="-423" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- dec_gpu0_l0_exp_agg&#45;&gt;dec_gpu0_l0_ln2 -->
<g id="edge64" class="edge">
<title>dec_gpu0_l0_exp_agg&#45;&gt;dec_gpu0_l0_ln2</title>
<path fill="none" stroke="black" d="M9964.67,-568.97C9964.67,-568.97 9964.67,-478.44 9964.67,-478.44"/>
<polygon fill="black" stroke="black" points="9968.17,-478.44 9964.67,-468.44 9961.17,-478.44 9968.17,-478.44"/>
</g>
<!-- dec_gpu2_l8_attn_q -->
<g id="node110" class="node">
<title>dec_gpu2_l8_attn_q</title>
<polygon fill="lightgreen" stroke="black" points="13251.5,-286 13128.5,-286 13128.5,-234 13251.5,-234 13251.5,-286"/>
<text text-anchor="middle" x="13190" y="-274" font-family="Times,serif" font-size="10.00">Attention Q</text>
<text text-anchor="middle" x="13190" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="13190" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,16,16]</text>
<text text-anchor="middle" x="13190" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu0_l0_ln2&#45;&gt;dec_gpu2_l8_attn_q -->
<g id="edge65" class="edge">
<title>dec_gpu0_l0_ln2&#45;&gt;dec_gpu2_l8_attn_q</title>
<path fill="none" stroke="black" d="M10030.2,-429C10461.81,-429 13190,-429 13190,-429 13190,-429 13190,-296.04 13190,-296.04"/>
<polygon fill="black" stroke="black" points="13193.5,-296.04 13190,-286.04 13186.5,-296.04 13193.5,-296.04"/>
</g>
<!-- dec_gpu2_l8_attn_k -->
<g id="node143" class="node">
<title>dec_gpu2_l8_attn_k</title>
<polygon fill="lightyellow" stroke="black" points="13478.72,-281.5 13326.45,-281.5 13287.28,-238.5 13439.55,-238.5 13478.72,-281.5"/>
<text text-anchor="middle" x="13383" y="-257.5" font-family="Times,serif" font-size="10.00">dec_gpu2_l8_attn_k</text>
</g>
<!-- dec_gpu0_l0_ln2&#45;&gt;dec_gpu2_l8_attn_k -->
<g id="edge66" class="edge">
<title>dec_gpu0_l0_ln2&#45;&gt;dec_gpu2_l8_attn_k</title>
<path fill="none" stroke="black" d="M10030.02,-442C10475.56,-442 13381.5,-442 13381.5,-442 13381.5,-442 13381.5,-291.59 13381.5,-291.59"/>
<polygon fill="black" stroke="black" points="13385,-291.59 13381.5,-281.59 13378,-291.59 13385,-291.59"/>
</g>
<!-- dec_gpu2_l8_attn_v -->
<g id="node144" class="node">
<title>dec_gpu2_l8_attn_v</title>
<polygon fill="lightyellow" stroke="black" points="13705.72,-281.5 13553.45,-281.5 13514.28,-238.5 13666.55,-238.5 13705.72,-281.5"/>
<text text-anchor="middle" x="13610" y="-257.5" font-family="Times,serif" font-size="10.00">dec_gpu2_l8_attn_v</text>
</g>
<!-- dec_gpu0_l0_ln2&#45;&gt;dec_gpu2_l8_attn_v -->
<g id="edge67" class="edge">
<title>dec_gpu0_l0_ln2&#45;&gt;dec_gpu2_l8_attn_v</title>
<path fill="none" stroke="black" d="M10030.11,-455C10492.62,-455 13608.5,-455 13608.5,-455 13608.5,-455 13608.5,-291.61 13608.5,-291.61"/>
<polygon fill="black" stroke="black" points="13612,-291.61 13608.5,-281.61 13605,-291.61 13612,-291.61"/>
</g>
<!-- dec_gpu1_l0_kv_cache -->
<g id="node96" class="node">
<title>dec_gpu1_l0_kv_cache</title>
<polygon fill="lightgreen" stroke="black" points="12774.5,-2383.08 12625.5,-2383.08 12625.5,-2331.08 12774.5,-2331.08 12774.5,-2383.08"/>
<text text-anchor="middle" x="12700" y="-2371.08" font-family="Times,serif" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="12700" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,16]</text>
<text text-anchor="middle" x="12700" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,seq+1,16,16]</text>
<text text-anchor="middle" x="12700" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_attn_score -->
<g id="node97" class="node">
<title>dec_gpu1_l0_attn_score</title>
<polygon fill="lightgreen" stroke="black" points="12589,-2383.08 12375,-2383.08 12375,-2331.08 12589,-2331.08 12589,-2383.08"/>
<text text-anchor="middle" x="12482" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="12482" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,16]×[128,seq+1,16,16]</text>
<text text-anchor="middle" x="12482" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="12482" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_attn_softmax -->
<g id="node98" class="node">
<title>dec_gpu1_l0_attn_softmax</title>
<polygon fill="lightgreen" stroke="black" points="12338.5,-2383.08 12195.5,-2383.08 12195.5,-2331.08 12338.5,-2331.08 12338.5,-2383.08"/>
<text text-anchor="middle" x="12267" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="12267" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="12267" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="12267" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_attn_out -->
<g id="node99" class="node">
<title>dec_gpu1_l0_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="12159,-2383.08 11925,-2383.08 11925,-2331.08 12159,-2331.08 12159,-2383.08"/>
<text text-anchor="middle" x="12042" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="12042" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,seq+1]×[128,seq+1,16,16]</text>
<text text-anchor="middle" x="12042" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16,32]</text>
<text text-anchor="middle" x="12042" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_attn_proj -->
<g id="node100" class="node">
<title>dec_gpu1_l0_attn_proj</title>
<polygon fill="lightgreen" stroke="black" points="11888.5,-2383.08 11771.5,-2383.08 11771.5,-2331.08 11888.5,-2331.08 11888.5,-2383.08"/>
<text text-anchor="middle" x="11830" y="-2371.08" font-family="Times,serif" font-size="10.00">Attention Projection</text>
<text text-anchor="middle" x="11830" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="11830" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="11830" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_attn_ar -->
<g id="node101" class="node">
<title>dec_gpu1_l0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="11655" cy="-2357.08" rx="80.72" ry="36.54"/>
<text text-anchor="middle" x="11655" y="-2371.08" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="11655" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="11655" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="11655" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
</g>
<!-- dec_gpu1_l0_gate -->
<g id="node102" class="node">
<title>dec_gpu1_l0_gate</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="11537.94,-2409.08 11359.87,-2409.08 11314.06,-2305.08 11492.13,-2305.08 11537.94,-2409.08"/>
<text text-anchor="middle" x="11426" y="-2371.08" font-family="Times,serif" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="11426" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="11426" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,16]</text>
<text text-anchor="middle" x="11426" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_exp8_fc1 -->
<g id="node103" class="node">
<title>dec_gpu1_l0_exp8_fc1</title>
<polygon fill="lightgreen" stroke="black" points="11278.5,-2383.08 11151.5,-2383.08 11151.5,-2331.08 11278.5,-2331.08 11278.5,-2383.08"/>
<text text-anchor="middle" x="11215" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert 8 FC1</text>
<text text-anchor="middle" x="11215" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="11215" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="11215" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_exp8_act -->
<g id="node104" class="node">
<title>dec_gpu1_l0_exp8_act</title>
<polygon fill="lightgreen" stroke="black" points="11115.5,-2383.08 10988.5,-2383.08 10988.5,-2331.08 11115.5,-2331.08 11115.5,-2383.08"/>
<text text-anchor="middle" x="11052" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert 8 Activation</text>
<text text-anchor="middle" x="11052" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="11052" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="11052" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_exp8_fc2 -->
<g id="node105" class="node">
<title>dec_gpu1_l0_exp8_fc2</title>
<polygon fill="lightgreen" stroke="black" points="10952.5,-2383.08 10831.5,-2383.08 10831.5,-2331.08 10952.5,-2331.08 10952.5,-2383.08"/>
<text text-anchor="middle" x="10892" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert 8 FC2</text>
<text text-anchor="middle" x="10892" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="10892" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="10892" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_ep_a2a -->
<g id="node106" class="node">
<title>dec_gpu1_l0_ep_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="10715" cy="-2357.08" rx="80.72" ry="36.54"/>
<text text-anchor="middle" x="10715" y="-2371.08" font-family="Times,serif" font-size="10.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="10715" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="10715" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="10715" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
</g>
<!-- dec_gpu1_l0_exp_agg -->
<g id="node107" class="node">
<title>dec_gpu1_l0_exp_agg</title>
<polygon fill="lightyellow" stroke="black" points="10598.17,-2409.08 10403.82,-2409.08 10353.83,-2305.08 10548.18,-2305.08 10598.17,-2409.08"/>
<text text-anchor="middle" x="10476" y="-2371.08" font-family="Times,serif" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="10476" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="10476" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="10476" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_ln1 -->
<g id="node108" class="node">
<title>dec_gpu1_l0_ln1</title>
<polygon fill="lightgreen" stroke="black" points="10318,-2383.08 10204,-2383.08 10204,-2331.08 10318,-2331.08 10318,-2383.08"/>
<text text-anchor="middle" x="10261" y="-2371.08" font-family="Times,serif" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="10261" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="10261" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="10261" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu1_l0_ln2 -->
<g id="node109" class="node">
<title>dec_gpu1_l0_ln2</title>
<polygon fill="lightgreen" stroke="black" points="10168,-2383.08 10054,-2383.08 10054,-2331.08 10168,-2331.08 10168,-2383.08"/>
<text text-anchor="middle" x="10111" y="-2371.08" font-family="Times,serif" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="10111" y="-2360.08" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="10111" y="-2349.08" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="10111" y="-2338.08" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- dec_gpu3_l8_attn_q -->
<g id="node126" class="node">
<title>dec_gpu3_l8_attn_q</title>
<polygon fill="lightgreen" stroke="black" points="10185.5,-286 10062.5,-286 10062.5,-234 10185.5,-234 10185.5,-286"/>
<text text-anchor="middle" x="10124" y="-274" font-family="Times,serif" font-size="10.00">Attention Q</text>
<text text-anchor="middle" x="10124" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="10124" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,16,16]</text>
<text text-anchor="middle" x="10124" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu1_l0_ln2&#45;&gt;dec_gpu3_l8_attn_q -->
<g id="edge68" class="edge">
<title>dec_gpu1_l0_ln2&#45;&gt;dec_gpu3_l8_attn_q</title>
<path fill="none" stroke="black" d="M10088.88,-2330.94C10088.88,-2330.94 10088.88,-296.3 10088.88,-296.3"/>
<polygon fill="black" stroke="black" points="10092.38,-296.3 10088.88,-286.3 10085.38,-296.3 10092.38,-296.3"/>
</g>
<!-- dec_gpu3_l8_attn_k -->
<g id="node145" class="node">
<title>dec_gpu3_l8_attn_k</title>
<polygon fill="lightyellow" stroke="black" points="13475.72,-2228.58 13323.45,-2228.58 13284.28,-2185.58 13436.55,-2185.58 13475.72,-2228.58"/>
<text text-anchor="middle" x="13380" y="-2204.58" font-family="Times,serif" font-size="10.00">dec_gpu3_l8_attn_k</text>
</g>
<!-- dec_gpu1_l0_ln2&#45;&gt;dec_gpu3_l8_attn_k -->
<g id="edge69" class="edge">
<title>dec_gpu1_l0_ln2&#45;&gt;dec_gpu3_l8_attn_k</title>
<path fill="none" stroke="black" d="M10115.25,-2330.94C10115.25,-2287.94 10115.25,-2207 10115.25,-2207 10115.25,-2207 13293.71,-2207 13293.71,-2207"/>
<polygon fill="black" stroke="black" points="13293.71,-2210.5 13303.71,-2207 13293.71,-2203.5 13293.71,-2210.5"/>
</g>
<!-- dec_gpu3_l8_attn_v -->
<g id="node146" class="node">
<title>dec_gpu3_l8_attn_v</title>
<polygon fill="lightyellow" stroke="black" points="13702.72,-2228.58 13550.45,-2228.58 13511.28,-2185.58 13663.55,-2185.58 13702.72,-2228.58"/>
<text text-anchor="middle" x="13607" y="-2204.58" font-family="Times,serif" font-size="10.00">dec_gpu3_l8_attn_v</text>
</g>
<!-- dec_gpu1_l0_ln2&#45;&gt;dec_gpu3_l8_attn_v -->
<g id="edge70" class="edge">
<title>dec_gpu1_l0_ln2&#45;&gt;dec_gpu3_l8_attn_v</title>
<path fill="none" stroke="black" d="M10141.62,-2330.65C10141.62,-2304.71 10141.62,-2269 10141.62,-2269 10141.62,-2269 13607,-2269 13607,-2269 13607,-2269 13607,-2238.74 13607,-2238.74"/>
<polygon fill="black" stroke="black" points="13610.5,-2238.74 13607,-2228.74 13603.5,-2238.74 13610.5,-2238.74"/>
</g>
<!-- dec_gpu2_l8_kv_cache -->
<g id="node111" class="node">
<title>dec_gpu2_l8_kv_cache</title>
<polygon fill="lightgreen" stroke="black" points="13092.5,-286 12943.5,-286 12943.5,-234 13092.5,-234 13092.5,-286"/>
<text text-anchor="middle" x="13018" y="-274" font-family="Times,serif" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="13018" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,16]</text>
<text text-anchor="middle" x="13018" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,seq+1,16,16]</text>
<text text-anchor="middle" x="13018" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_attn_score -->
<g id="node112" class="node">
<title>dec_gpu2_l8_attn_score</title>
<polygon fill="lightgreen" stroke="black" points="12907,-286 12693,-286 12693,-234 12907,-234 12907,-286"/>
<text text-anchor="middle" x="12800" y="-274" font-family="Times,serif" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="12800" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,16]×[128,seq+1,16,16]</text>
<text text-anchor="middle" x="12800" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="12800" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_attn_softmax -->
<g id="node113" class="node">
<title>dec_gpu2_l8_attn_softmax</title>
<polygon fill="lightgreen" stroke="black" points="12656.5,-286 12513.5,-286 12513.5,-234 12656.5,-234 12656.5,-286"/>
<text text-anchor="middle" x="12585" y="-274" font-family="Times,serif" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="12585" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="12585" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="12585" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_attn_out -->
<g id="node114" class="node">
<title>dec_gpu2_l8_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="12477,-286 12243,-286 12243,-234 12477,-234 12477,-286"/>
<text text-anchor="middle" x="12360" y="-274" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="12360" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,seq+1]×[128,seq+1,16,16]</text>
<text text-anchor="middle" x="12360" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,16,32]</text>
<text text-anchor="middle" x="12360" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_attn_proj -->
<g id="node115" class="node">
<title>dec_gpu2_l8_attn_proj</title>
<polygon fill="lightgreen" stroke="black" points="12206.5,-286 12089.5,-286 12089.5,-234 12206.5,-234 12206.5,-286"/>
<text text-anchor="middle" x="12148" y="-274" font-family="Times,serif" font-size="10.00">Attention Projection</text>
<text text-anchor="middle" x="12148" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="12148" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="12148" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_attn_ar -->
<g id="node116" class="node">
<title>dec_gpu2_l8_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="11973" cy="-260" rx="80.72" ry="36.54"/>
<text text-anchor="middle" x="11973" y="-274" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="11973" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="11973" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="11973" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
</g>
<!-- dec_gpu2_l8_gate -->
<g id="node117" class="node">
<title>dec_gpu2_l8_gate</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="11855.94,-312 11677.87,-312 11632.06,-208 11810.13,-208 11855.94,-312"/>
<text text-anchor="middle" x="11744" y="-274" font-family="Times,serif" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="11744" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="11744" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,16]</text>
<text text-anchor="middle" x="11744" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_exp0_fc1 -->
<g id="node118" class="node">
<title>dec_gpu2_l8_exp0_fc1</title>
<polygon fill="lightgreen" stroke="black" points="11596.5,-286 11469.5,-286 11469.5,-234 11596.5,-234 11596.5,-286"/>
<text text-anchor="middle" x="11533" y="-274" font-family="Times,serif" font-size="10.00">Expert 0 FC1</text>
<text text-anchor="middle" x="11533" y="-263" font-family="Times,serif" font-size="10.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="11533" y="-252" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="11533" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_exp0_act -->
<g id="node119" class="node">
<title>dec_gpu2_l8_exp0_act</title>
<polygon fill="lightgreen" stroke="black" points="11433.5,-286 11306.5,-286 11306.5,-234 11433.5,-234 11433.5,-286"/>
<text text-anchor="middle" x="11370" y="-274" font-family="Times,serif" font-size="10.00">Expert 0 Activation</text>
<text text-anchor="middle" x="11370" y="-263" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="11370" y="-252" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="11370" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_exp0_fc2 -->
<g id="node120" class="node">
<title>dec_gpu2_l8_exp0_fc2</title>
<polygon fill="lightgreen" stroke="black" points="11270.5,-286 11149.5,-286 11149.5,-234 11270.5,-234 11270.5,-286"/>
<text text-anchor="middle" x="11210" y="-274" font-family="Times,serif" font-size="10.00">Expert 0 FC2</text>
<text text-anchor="middle" x="11210" y="-263" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="11210" y="-252" font-family="Times,serif" font-size="10.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="11210" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_ep_a2a -->
<g id="node121" class="node">
<title>dec_gpu2_l8_ep_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="11033" cy="-260" rx="80.72" ry="36.54"/>
<text text-anchor="middle" x="11033" y="-274" font-family="Times,serif" font-size="10.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="11033" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="11033" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="11033" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
</g>
<!-- dec_gpu2_l8_exp_agg -->
<g id="node122" class="node">
<title>dec_gpu2_l8_exp_agg</title>
<polygon fill="lightyellow" stroke="black" points="10916.17,-312 10721.82,-312 10671.83,-208 10866.18,-208 10916.17,-312"/>
<text text-anchor="middle" x="10794" y="-274" font-family="Times,serif" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="10794" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="10794" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="10794" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_ln1 -->
<g id="node123" class="node">
<title>dec_gpu2_l8_ln1</title>
<polygon fill="lightgreen" stroke="black" points="10636,-286 10522,-286 10522,-234 10636,-234 10636,-286"/>
<text text-anchor="middle" x="10579" y="-274" font-family="Times,serif" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="10579" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="10579" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="10579" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_l8_ln2 -->
<g id="node124" class="node">
<title>dec_gpu2_l8_ln2</title>
<polygon fill="lightgreen" stroke="black" points="10486,-286 10372,-286 10372,-234 10486,-234 10486,-286"/>
<text text-anchor="middle" x="10429" y="-274" font-family="Times,serif" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="10429" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="10429" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="10429" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- dec_gpu2_output -->
<g id="node125" class="node">
<title>dec_gpu2_output</title>
<polygon fill="lightgreen" stroke="black" points="10336,-286 10222,-286 10222,-234 10336,-234 10336,-286"/>
<text text-anchor="middle" x="10279" y="-274" font-family="Times,serif" font-size="10.00">Decode Output</text>
<text text-anchor="middle" x="10279" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="10279" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="10279" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2</text>
</g>
<!-- decode_output_agg -->
<g id="node142" class="node">
<title>decode_output_agg</title>
<polygon fill="lightyellow" stroke="black" points="8795.32,-136 8597.55,-136 8546.68,-32 8744.45,-32 8795.32,-136"/>
<text text-anchor="middle" x="8671" y="-98" font-family="Times,serif" font-size="10.00">Decode Output Agg</text>
<text text-anchor="middle" x="8671" y="-87" font-family="Times,serif" font-size="10.00">Input: [128,1,512]×2</text>
<text text-anchor="middle" x="8671" y="-76" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="8671" y="-65" font-family="Times,serif" font-size="10.00">GPU: ALL</text>
</g>
<!-- dec_gpu2_output&#45;&gt;decode_output_agg -->
<g id="edge71" class="edge">
<title>dec_gpu2_output&#45;&gt;decode_output_agg</title>
<path fill="none" stroke="black" d="M10279,-233.65C10279,-184.55 10279,-84 10279,-84 10279,-84 8780.07,-84 8780.07,-84"/>
<polygon fill="black" stroke="black" points="8780.07,-80.5 8770.07,-84 8780.07,-87.5 8780.07,-80.5"/>
</g>
<!-- dec_gpu3_l8_kv_cache -->
<g id="node127" class="node">
<title>dec_gpu3_l8_kv_cache</title>
<polygon fill="lightgreen" stroke="black" points="10026.5,-286 9877.5,-286 9877.5,-234 10026.5,-234 10026.5,-286"/>
<text text-anchor="middle" x="9952" y="-274" font-family="Times,serif" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="9952" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,16]</text>
<text text-anchor="middle" x="9952" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,seq+1,16,16]</text>
<text text-anchor="middle" x="9952" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_attn_score -->
<g id="node128" class="node">
<title>dec_gpu3_l8_attn_score</title>
<polygon fill="lightgreen" stroke="black" points="9841,-286 9627,-286 9627,-234 9841,-234 9841,-286"/>
<text text-anchor="middle" x="9734" y="-274" font-family="Times,serif" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="9734" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,16]×[128,seq+1,16,16]</text>
<text text-anchor="middle" x="9734" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="9734" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_attn_softmax -->
<g id="node129" class="node">
<title>dec_gpu3_l8_attn_softmax</title>
<polygon fill="lightgreen" stroke="black" points="9590.5,-286 9447.5,-286 9447.5,-234 9590.5,-234 9590.5,-286"/>
<text text-anchor="middle" x="9519" y="-274" font-family="Times,serif" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="9519" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="9519" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,16,seq+1]</text>
<text text-anchor="middle" x="9519" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_attn_out -->
<g id="node130" class="node">
<title>dec_gpu3_l8_attn_out</title>
<polygon fill="lightgreen" stroke="black" points="9411,-286 9177,-286 9177,-234 9411,-234 9411,-286"/>
<text text-anchor="middle" x="9294" y="-274" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="9294" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,seq+1]×[128,seq+1,16,16]</text>
<text text-anchor="middle" x="9294" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,16,32]</text>
<text text-anchor="middle" x="9294" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_attn_proj -->
<g id="node131" class="node">
<title>dec_gpu3_l8_attn_proj</title>
<polygon fill="lightgreen" stroke="black" points="9140.5,-286 9023.5,-286 9023.5,-234 9140.5,-234 9140.5,-286"/>
<text text-anchor="middle" x="9082" y="-274" font-family="Times,serif" font-size="10.00">Attention Projection</text>
<text text-anchor="middle" x="9082" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,16,32]</text>
<text text-anchor="middle" x="9082" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="9082" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_attn_ar -->
<g id="node132" class="node">
<title>dec_gpu3_l8_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="8907" cy="-260" rx="80.72" ry="36.54"/>
<text text-anchor="middle" x="8907" y="-274" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8907" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="8907" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="8907" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
</g>
<!-- dec_gpu3_l8_gate -->
<g id="node133" class="node">
<title>dec_gpu3_l8_gate</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="8789.94,-312 8611.87,-312 8566.06,-208 8744.13,-208 8789.94,-312"/>
<text text-anchor="middle" x="8678" y="-274" font-family="Times,serif" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="8678" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="8678" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,16]</text>
<text text-anchor="middle" x="8678" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_exp8_fc1 -->
<g id="node134" class="node">
<title>dec_gpu3_l8_exp8_fc1</title>
<polygon fill="lightgreen" stroke="black" points="8530.5,-286 8403.5,-286 8403.5,-234 8530.5,-234 8530.5,-286"/>
<text text-anchor="middle" x="8467" y="-274" font-family="Times,serif" font-size="10.00">Expert 8 FC1</text>
<text text-anchor="middle" x="8467" y="-263" font-family="Times,serif" font-size="10.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="8467" y="-252" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="8467" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_exp8_act -->
<g id="node135" class="node">
<title>dec_gpu3_l8_exp8_act</title>
<polygon fill="lightgreen" stroke="black" points="8367.5,-286 8240.5,-286 8240.5,-234 8367.5,-234 8367.5,-286"/>
<text text-anchor="middle" x="8304" y="-274" font-family="Times,serif" font-size="10.00">Expert 8 Activation</text>
<text text-anchor="middle" x="8304" y="-263" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="8304" y="-252" font-family="Times,serif" font-size="10.00">Output: [tokens,1024]</text>
<text text-anchor="middle" x="8304" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_exp8_fc2 -->
<g id="node136" class="node">
<title>dec_gpu3_l8_exp8_fc2</title>
<polygon fill="lightgreen" stroke="black" points="8204.5,-286 8083.5,-286 8083.5,-234 8204.5,-234 8204.5,-286"/>
<text text-anchor="middle" x="8144" y="-274" font-family="Times,serif" font-size="10.00">Expert 8 FC2</text>
<text text-anchor="middle" x="8144" y="-263" font-family="Times,serif" font-size="10.00">Input: [tokens,1024]</text>
<text text-anchor="middle" x="8144" y="-252" font-family="Times,serif" font-size="10.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="8144" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_ep_a2a -->
<g id="node137" class="node">
<title>dec_gpu3_l8_ep_a2a</title>
<ellipse fill="lightblue" stroke="black" cx="7967" cy="-260" rx="80.72" ry="36.54"/>
<text text-anchor="middle" x="7967" y="-274" font-family="Times,serif" font-size="10.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="7967" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="7967" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="7967" y="-241" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
</g>
<!-- dec_gpu3_l8_exp_agg -->
<g id="node138" class="node">
<title>dec_gpu3_l8_exp_agg</title>
<polygon fill="lightyellow" stroke="black" points="7850.17,-312 7655.82,-312 7605.83,-208 7800.18,-208 7850.17,-312"/>
<text text-anchor="middle" x="7728" y="-274" font-family="Times,serif" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="7728" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="7728" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="7728" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_ln1 -->
<g id="node139" class="node">
<title>dec_gpu3_l8_ln1</title>
<polygon fill="lightgreen" stroke="black" points="7570,-286 7456,-286 7456,-234 7570,-234 7570,-286"/>
<text text-anchor="middle" x="7513" y="-274" font-family="Times,serif" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="7513" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="7513" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="7513" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_l8_ln2 -->
<g id="node140" class="node">
<title>dec_gpu3_l8_ln2</title>
<polygon fill="lightgreen" stroke="black" points="7420,-286 7306,-286 7306,-234 7420,-234 7420,-286"/>
<text text-anchor="middle" x="7363" y="-274" font-family="Times,serif" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="7363" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="7363" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="7363" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_output -->
<g id="node141" class="node">
<title>dec_gpu3_output</title>
<polygon fill="lightgreen" stroke="black" points="7270,-286 7156,-286 7156,-234 7270,-234 7270,-286"/>
<text text-anchor="middle" x="7213" y="-274" font-family="Times,serif" font-size="10.00">Decode Output</text>
<text text-anchor="middle" x="7213" y="-263" font-family="Times,serif" font-size="10.00">Input: [128,1,512]</text>
<text text-anchor="middle" x="7213" y="-252" font-family="Times,serif" font-size="10.00">Output: [128,1,512]</text>
<text text-anchor="middle" x="7213" y="-241" font-family="Times,serif" font-size="10.00">GPU: 3</text>
</g>
<!-- dec_gpu3_output&#45;&gt;decode_output_agg -->
<g id="edge72" class="edge">
<title>dec_gpu3_output&#45;&gt;decode_output_agg</title>
<path fill="none" stroke="black" d="M7213,-233.65C7213,-184.55 7213,-84 7213,-84 7213,-84 8561.93,-84 8561.93,-84"/>
<polygon fill="black" stroke="black" points="8561.93,-87.5 8571.93,-84 8561.93,-80.5 8561.93,-87.5"/>
</g>
</g>
</svg>
