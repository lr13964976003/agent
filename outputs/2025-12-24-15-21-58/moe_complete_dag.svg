<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Model_DAG Pages: 1 -->
<svg width="1849pt" height="3038pt"
 viewBox="0.00 0.00 1849.46 3037.79" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3033.79)">
<title>MoE_Model_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3033.79 1845.46,-3033.79 1845.46,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline0</title>
<polygon fill="lightgrey" stroke="black" points="8,-1513.93 8,-2825.81 1108,-2825.81 1108,-1513.93 8,-1513.93"/>
<text text-anchor="middle" x="558" y="-2812.21" font-family="Arial" font-size="12.00">Pipeline Stage 0 (Layers 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu0</title>
<polygon fill="lightcyan" stroke="black" points="519,-1747.92 519,-2796.81 1100,-2796.81 1100,-1747.92 519,-1747.92"/>
<text text-anchor="middle" x="809.5" y="-2783.21" font-family="Arial" font-size="12.00">GPU 0 (TP0, PP0, EP0)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu1</title>
<polygon fill="lightcyan" stroke="black" points="16,-1521.93 16,-2796.81 511,-2796.81 511,-1521.93 16,-1521.93"/>
<text text-anchor="middle" x="263.5" y="-2783.21" font-family="Arial" font-size="12.00">GPU 1 (TP1, PP0, EP1)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_pipeline1</title>
<polygon fill="lightgrey" stroke="black" points="381,-203.98 381,-1496.93 1482,-1496.93 1482,-203.98 381,-203.98"/>
<text text-anchor="middle" x="931.5" y="-1483.33" font-family="Arial" font-size="12.00">Pipeline Stage 1 (Layers 8&#45;15)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu2</title>
<polygon fill="lightcyan" stroke="black" points="892,-410.98 892,-1467.93 1474,-1467.93 1474,-410.98 892,-410.98"/>
<text text-anchor="middle" x="1183" y="-1454.33" font-family="Arial" font-size="12.00">GPU 2 (TP0, PP1, EP0)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu3</title>
<polygon fill="lightcyan" stroke="black" points="389,-211.98 389,-1467.93 884,-1467.93 884,-211.98 389,-211.98"/>
<text text-anchor="middle" x="636.5" y="-1454.33" font-family="Arial" font-size="12.00">GPU 3 (TP1, PP1, EP1)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_decode</title>
<polygon fill="lightgrey" stroke="black" points="1210,-1735.91 1210,-2944.31 1693,-2944.31 1693,-1735.91 1210,-1735.91"/>
<text text-anchor="middle" x="1451.5" y="-2930.71" font-family="Arial" font-size="12.00">Decode Phase</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="937" cy="-3000.8" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="937" y="-3009.3" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="937" y="-2998.3" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="937" y="-2987.3" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- input_split -->
<g id="node2" class="node">
<title>input_split</title>
<polygon fill="yellow" stroke="black" points="1201.24,-2934.81 780.89,-2934.81 672.76,-2852.81 1093.11,-2852.81 1201.24,-2934.81"/>
<text text-anchor="middle" x="937" y="-2902.31" font-family="Arial" font-size="10.00">Input Split (TP)</text>
<text text-anchor="middle" x="937" y="-2891.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="937" y="-2880.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=256]</text>
</g>
<!-- input&#45;&gt;input_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;input_split</title>
<path fill="none" stroke="black" d="M937,-2971.67C937,-2963.46 937,-2954.23 937,-2945.09"/>
<polygon fill="black" stroke="black" points="940.5,-2944.87 937,-2934.87 933.5,-2944.87 940.5,-2944.87"/>
</g>
<!-- gpu0_l0_ln1 -->
<g id="node4" class="node">
<title>gpu0_l0_ln1</title>
<polygon fill="lightblue" stroke="black" points="968.5,-2767.81 873.5,-2767.81 873.5,-2724.81 968.5,-2724.81 968.5,-2767.81"/>
<text text-anchor="middle" x="921" y="-2754.81" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="921" y="-2743.81" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="921" y="-2732.81" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- input_split&#45;&gt;gpu0_l0_ln1 -->
<g id="edge2" class="edge">
<title>input_split&#45;&gt;gpu0_l0_ln1</title>
<path fill="none" stroke="black" d="M932.59,-2852.67C929.99,-2829.1 926.77,-2799.78 924.38,-2778.06"/>
<polygon fill="black" stroke="black" points="927.85,-2777.62 923.28,-2768.06 920.9,-2778.39 927.85,-2777.62"/>
</g>
<!-- gpu1_l0_ln1 -->
<g id="node20" class="node">
<title>gpu1_l0_ln1</title>
<polygon fill="lightblue" stroke="black" points="472.5,-2767.81 377.5,-2767.81 377.5,-2724.81 472.5,-2724.81 472.5,-2767.81"/>
<text text-anchor="middle" x="425" y="-2754.81" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="425" y="-2743.81" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="425" y="-2732.81" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- input_split&#45;&gt;gpu1_l0_ln1 -->
<g id="edge3" class="edge">
<title>input_split&#45;&gt;gpu1_l0_ln1</title>
<path fill="none" stroke="black" d="M708.63,-2880.13C643.84,-2870.34 574.72,-2853.73 515,-2825.81 489.75,-2814.01 466.21,-2792.96 449.54,-2775.62"/>
<polygon fill="black" stroke="black" points="451.76,-2772.88 442.38,-2767.97 446.65,-2777.66 451.76,-2772.88"/>
</g>
<!-- gpu2_recv -->
<g id="node38" class="node">
<title>gpu2_recv</title>
<ellipse fill="purple" stroke="black" cx="1139" cy="-1409.94" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="1139" y="-1418.44" font-family="Arial" font-size="10.00">Recv from PP0</text>
<text text-anchor="middle" x="1139" y="-1407.44" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1139" y="-1396.44" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- input_split&#45;&gt;gpu2_recv -->
<g id="edge4" class="edge">
<title>input_split&#45;&gt;gpu2_recv</title>
<path fill="none" stroke="black" d="M1093.25,-2852.65C1106.33,-2845.17 1118.53,-2836.31 1129,-2825.81 1155.96,-2798.75 1164,-2785.51 1164,-2747.31 1164,-2747.31 1164,-2747.31 1164,-1557.92 1164,-1520.41 1155.99,-1478.27 1149.04,-1448.76"/>
<polygon fill="black" stroke="black" points="1152.4,-1447.77 1146.64,-1438.88 1145.6,-1449.42 1152.4,-1447.77"/>
</g>
<!-- gpu3_recv -->
<g id="node55" class="node">
<title>gpu3_recv</title>
<ellipse fill="purple" stroke="black" cx="736" cy="-1409.94" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="736" y="-1418.44" font-family="Arial" font-size="10.00">Recv from PP0</text>
<text text-anchor="middle" x="736" y="-1407.44" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="736" y="-1396.44" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- input_split&#45;&gt;gpu3_recv -->
<g id="edge5" class="edge">
<title>input_split&#45;&gt;gpu3_recv</title>
<path fill="none" stroke="black" d="M1071.2,-2852.62C1083.36,-2845.13 1094.61,-2836.27 1104,-2825.81 1128.2,-2798.84 1126,-2783.54 1126,-2747.31 1126,-2747.31 1126,-2747.31 1126,-1605.91 1126,-1489.57 991.61,-1549.84 888,-1496.93 852.39,-1478.75 813.14,-1456.48 783.45,-1439.17"/>
<polygon fill="black" stroke="black" points="784.95,-1435.99 774.55,-1433.96 781.41,-1442.03 784.95,-1435.99"/>
</g>
<!-- decode_input -->
<g id="node3" class="node">
<title>decode_input</title>
<ellipse fill="lightgreen" stroke="black" cx="1676" cy="-3000.8" rx="165.43" ry="28.98"/>
<text text-anchor="middle" x="1676" y="-3009.3" font-family="Arial" font-size="10.00">Decode Input</text>
<text text-anchor="middle" x="1676" y="-2998.3" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1, hidden=512]</text>
<text text-anchor="middle" x="1676" y="-2987.3" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1, hidden=512]</text>
</g>
<!-- dec_gpu0_l0_ln1 -->
<g id="node76" class="node">
<title>dec_gpu0_l0_ln1</title>
<polygon fill="lightblue" stroke="black" points="1538.5,-2915.31 1431.5,-2915.31 1431.5,-2872.31 1538.5,-2872.31 1538.5,-2915.31"/>
<text text-anchor="middle" x="1485" y="-2902.31" font-family="Arial" font-size="10.00">Decode LayerNorm1</text>
<text text-anchor="middle" x="1485" y="-2891.31" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1485" y="-2880.31" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- decode_input&#45;&gt;dec_gpu0_l0_ln1 -->
<g id="edge101" class="edge">
<title>decode_input&#45;&gt;dec_gpu0_l0_ln1</title>
<path fill="none" stroke="black" d="M1627.31,-2973.04C1597.89,-2956.86 1560.59,-2936.36 1531.56,-2920.41"/>
<polygon fill="black" stroke="black" points="1532.9,-2917.15 1522.45,-2915.4 1529.53,-2923.28 1532.9,-2917.15"/>
</g>
<!-- dec_gpu1_l0_ln1 -->
<g id="node81" class="node">
<title>dec_gpu1_l0_ln1</title>
<polygon fill="lightblue" stroke="black" points="1658.5,-2767.81 1551.5,-2767.81 1551.5,-2724.81 1658.5,-2724.81 1658.5,-2767.81"/>
<text text-anchor="middle" x="1605" y="-2754.81" font-family="Arial" font-size="10.00">Decode LayerNorm1</text>
<text text-anchor="middle" x="1605" y="-2743.81" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1605" y="-2732.81" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- decode_input&#45;&gt;dec_gpu1_l0_ln1 -->
<g id="edge102" class="edge">
<title>decode_input&#45;&gt;dec_gpu1_l0_ln1</title>
<path fill="none" stroke="black" d="M1668.13,-2971.82C1654.71,-2924.11 1627.52,-2827.4 1613.61,-2777.95"/>
<polygon fill="black" stroke="black" points="1616.93,-2776.82 1610.86,-2768.14 1610.2,-2778.72 1616.93,-2776.82"/>
</g>
<!-- dec_gpu2_recv -->
<g id="node86" class="node">
<title>dec_gpu2_recv</title>
<ellipse fill="purple" stroke="black" cx="1410" cy="-2331.87" rx="85.62" ry="28.98"/>
<text text-anchor="middle" x="1410" y="-2340.37" font-family="Arial" font-size="10.00">Decode Recv from PP0</text>
<text text-anchor="middle" x="1410" y="-2329.37" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1410" y="-2318.37" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- decode_input&#45;&gt;dec_gpu2_recv -->
<g id="edge103" class="edge">
<title>decode_input&#45;&gt;dec_gpu2_recv</title>
<path fill="none" stroke="black" d="M1691.69,-2971.77C1701.78,-2951.14 1713,-2922.06 1713,-2894.81 1713,-2894.81 1713,-2894.81 1713,-2425.85 1713,-2347.95 1688.76,-2406.95 1504,-2360.86 1496.57,-2359.01 1488.84,-2356.94 1481.16,-2354.79"/>
<polygon fill="black" stroke="black" points="1482.05,-2351.41 1471.47,-2352.04 1480.13,-2358.14 1482.05,-2351.41"/>
</g>
<!-- dec_gpu3_recv -->
<g id="node91" class="node">
<title>dec_gpu3_recv</title>
<ellipse fill="purple" stroke="black" cx="1599" cy="-2331.87" rx="85.62" ry="28.98"/>
<text text-anchor="middle" x="1599" y="-2340.37" font-family="Arial" font-size="10.00">Decode Recv from PP0</text>
<text text-anchor="middle" x="1599" y="-2329.37" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1599" y="-2318.37" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- decode_input&#45;&gt;dec_gpu3_recv -->
<g id="edge104" class="edge">
<title>decode_input&#45;&gt;dec_gpu3_recv</title>
<path fill="none" stroke="black" d="M1710.85,-2972.31C1716.73,-2966.62 1722.41,-2960.35 1727,-2953.81 1743.26,-2930.63 1751,-2923.12 1751,-2894.81 1751,-2894.81 1751,-2894.81 1751,-2425.85 1751,-2387.94 1716.17,-2365.02 1679.85,-2351.42"/>
<polygon fill="black" stroke="black" points="1680.7,-2348.01 1670.1,-2348 1678.38,-2354.62 1680.7,-2348.01"/>
</g>
<!-- gpu0_l0_attn_q -->
<g id="node5" class="node">
<title>gpu0_l0_attn_q</title>
<polygon fill="lightblue" stroke="black" points="806.5,-2680.32 711.5,-2680.32 711.5,-2637.32 806.5,-2637.32 806.5,-2680.32"/>
<text text-anchor="middle" x="759" y="-2667.32" font-family="Arial" font-size="10.00">Attention Q Proj</text>
<text text-anchor="middle" x="759" y="-2656.32" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="759" y="-2645.32" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_q -->
<g id="edge6" class="edge">
<title>gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_q</title>
<path fill="none" stroke="black" d="M881.78,-2724.62C859.2,-2712.7 830.65,-2697.63 806.76,-2685.02"/>
<polygon fill="black" stroke="black" points="808.33,-2681.9 797.85,-2680.32 805.07,-2688.09 808.33,-2681.9"/>
</g>
<!-- gpu0_l0_attn_k -->
<g id="node6" class="node">
<title>gpu0_l0_attn_k</title>
<polygon fill="lightblue" stroke="black" points="919.5,-2680.32 824.5,-2680.32 824.5,-2637.32 919.5,-2637.32 919.5,-2680.32"/>
<text text-anchor="middle" x="872" y="-2667.32" font-family="Arial" font-size="10.00">Attention K Proj</text>
<text text-anchor="middle" x="872" y="-2656.32" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="872" y="-2645.32" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_k -->
<g id="edge7" class="edge">
<title>gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_k</title>
<path fill="none" stroke="black" d="M909.14,-2724.62C903.06,-2714.01 895.55,-2700.91 888.88,-2689.27"/>
<polygon fill="black" stroke="black" points="891.76,-2687.26 883.75,-2680.32 885.69,-2690.74 891.76,-2687.26"/>
</g>
<!-- gpu0_l0_attn_v -->
<g id="node7" class="node">
<title>gpu0_l0_attn_v</title>
<polygon fill="lightblue" stroke="black" points="960.5,-2611.83 865.5,-2611.83 865.5,-2568.83 960.5,-2568.83 960.5,-2611.83"/>
<text text-anchor="middle" x="913" y="-2598.83" font-family="Arial" font-size="10.00">Attention V Proj</text>
<text text-anchor="middle" x="913" y="-2587.83" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="913" y="-2576.83" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_v -->
<g id="edge8" class="edge">
<title>gpu0_l0_ln1&#45;&gt;gpu0_l0_attn_v</title>
<path fill="none" stroke="black" d="M925.69,-2724.66C930.23,-2701.39 935.53,-2662.54 929,-2629.83 928.46,-2627.13 927.73,-2624.38 926.87,-2621.65"/>
<polygon fill="black" stroke="black" points="930.08,-2620.22 923.35,-2612.04 923.5,-2622.63 930.08,-2620.22"/>
</g>
<!-- gpu0_l0_attn_score -->
<g id="node8" class="node">
<title>gpu0_l0_attn_score</title>
<polygon fill="lightblue" stroke="black" points="882.5,-2543.34 787.5,-2543.34 787.5,-2500.34 882.5,-2500.34 882.5,-2543.34"/>
<text text-anchor="middle" x="835" y="-2530.34" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="835" y="-2519.34" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="835" y="-2508.34" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu0_l0_attn_q&#45;&gt;gpu0_l0_attn_score -->
<g id="edge9" class="edge">
<title>gpu0_l0_attn_q&#45;&gt;gpu0_l0_attn_score</title>
<path fill="none" stroke="black" d="M770.54,-2637.32C783.26,-2614.72 803.84,-2578.18 818.32,-2552.47"/>
<polygon fill="black" stroke="black" points="821.49,-2553.96 823.35,-2543.53 815.39,-2550.53 821.49,-2553.96"/>
</g>
<!-- gpu0_l0_attn_k&#45;&gt;gpu0_l0_attn_score -->
<g id="edge10" class="edge">
<title>gpu0_l0_attn_k&#45;&gt;gpu0_l0_attn_score</title>
<path fill="none" stroke="black" d="M865.54,-2637.27C863.1,-2629.34 860.35,-2620.18 858,-2611.83 852.56,-2592.49 846.91,-2570.66 842.57,-2553.45"/>
<polygon fill="black" stroke="black" points="845.88,-2552.25 840.05,-2543.4 839.09,-2553.95 845.88,-2552.25"/>
</g>
<!-- gpu0_l0_attn_softmax -->
<g id="node9" class="node">
<title>gpu0_l0_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="882.5,-2448.35 787.5,-2448.35 787.5,-2405.35 882.5,-2405.35 882.5,-2448.35"/>
<text text-anchor="middle" x="835" y="-2435.35" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="835" y="-2424.35" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="835" y="-2413.35" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu0_l0_attn_v&#45;&gt;gpu0_l0_attn_softmax -->
<g id="edge11" class="edge">
<title>gpu0_l0_attn_v&#45;&gt;gpu0_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M911.53,-2568.75C909.4,-2548.51 904.27,-2517.18 892,-2492.84 885.26,-2479.47 875.11,-2466.65 865.24,-2455.98"/>
<polygon fill="black" stroke="black" points="867.61,-2453.4 858.15,-2448.62 862.56,-2458.25 867.61,-2453.4"/>
</g>
<!-- gpu0_l0_attn_score&#45;&gt;gpu0_l0_attn_softmax -->
<g id="edge12" class="edge">
<title>gpu0_l0_attn_score&#45;&gt;gpu0_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M835,-2500.2C835,-2488.04 835,-2472.42 835,-2458.81"/>
<polygon fill="black" stroke="black" points="838.5,-2458.43 835,-2448.43 831.5,-2458.43 838.5,-2458.43"/>
</g>
<!-- gpu0_l0_attn_out -->
<g id="node10" class="node">
<title>gpu0_l0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="879.5,-2353.37 784.5,-2353.37 784.5,-2310.37 879.5,-2310.37 879.5,-2353.37"/>
<text text-anchor="middle" x="832" y="-2340.37" font-family="Arial" font-size="10.00">Attention Out Proj</text>
<text text-anchor="middle" x="832" y="-2329.37" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="832" y="-2318.37" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu0_l0_attn_softmax&#45;&gt;gpu0_l0_attn_out -->
<g id="edge13" class="edge">
<title>gpu0_l0_attn_softmax&#45;&gt;gpu0_l0_attn_out</title>
<path fill="none" stroke="black" d="M834.33,-2405.22C833.94,-2393.06 833.44,-2377.44 833,-2363.83"/>
<polygon fill="black" stroke="black" points="836.48,-2363.33 832.66,-2353.45 829.49,-2363.56 836.48,-2363.33"/>
</g>
<!-- gpu0_l0_attn_ar -->
<g id="node11" class="node">
<title>gpu0_l0_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="827" cy="-2236.89" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="827" y="-2245.39" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="827" y="-2234.39" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="827" y="-2223.39" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu0_l0_attn_out&#45;&gt;gpu0_l0_attn_ar -->
<g id="edge14" class="edge">
<title>gpu0_l0_attn_out&#45;&gt;gpu0_l0_attn_ar</title>
<path fill="none" stroke="black" d="M830.89,-2310.23C830.35,-2300.14 829.68,-2287.66 829.04,-2275.92"/>
<polygon fill="black" stroke="black" points="832.54,-2275.67 828.5,-2265.87 825.55,-2276.05 832.54,-2275.67"/>
</g>
<!-- gpu0_l0_ln2 -->
<g id="node12" class="node">
<title>gpu0_l0_ln2</title>
<polygon fill="lightblue" stroke="black" points="872.5,-2170.9 777.5,-2170.9 777.5,-2127.9 872.5,-2127.9 872.5,-2170.9"/>
<text text-anchor="middle" x="825" y="-2157.9" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="825" y="-2146.9" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="825" y="-2135.9" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu0_l0_attn_ar&#45;&gt;gpu0_l0_ln2 -->
<g id="edge15" class="edge">
<title>gpu0_l0_attn_ar&#45;&gt;gpu0_l0_ln2</title>
<path fill="none" stroke="black" d="M826.35,-2207.89C826.15,-2199.38 825.93,-2189.97 825.72,-2181.28"/>
<polygon fill="black" stroke="black" points="829.22,-2181.04 825.49,-2171.13 822.22,-2181.21 829.22,-2181.04"/>
</g>
<!-- gpu0_l0_gate -->
<g id="node13" class="node">
<title>gpu0_l0_gate</title>
<polygon fill="lightblue" stroke="black" points="1092,-2083.41 1004,-2083.41 1004,-2040.41 1092,-2040.41 1092,-2083.41"/>
<text text-anchor="middle" x="1048" y="-2070.41" font-family="Arial" font-size="10.00">Gate Router</text>
<text text-anchor="middle" x="1048" y="-2059.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1048" y="-2048.41" font-family="Arial" font-size="10.00">Output: [128, 8]</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu0_l0_gate -->
<g id="edge26" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu0_l0_gate</title>
<path fill="none" stroke="black" d="M872.66,-2134.52C907.17,-2123.93 954.64,-2108.25 995,-2090.9 997.1,-2089.99 999.22,-2089.04 1001.36,-2088.05"/>
<polygon fill="black" stroke="black" points="1003.23,-2091.04 1010.72,-2083.54 1000.19,-2084.73 1003.23,-2091.04"/>
</g>
<!-- gpu0_l0_expert0 -->
<g id="node14" class="node">
<title>gpu0_l0_expert0</title>
<polygon fill="lightblue" stroke="black" points="628.5,-2083.41 527.5,-2083.41 527.5,-2040.41 628.5,-2040.41 628.5,-2083.41"/>
<text text-anchor="middle" x="578" y="-2070.41" font-family="Arial" font-size="10.00">Expert 0 FC</text>
<text text-anchor="middle" x="578" y="-2059.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="578" y="-2048.41" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu0_l0_expert0 -->
<g id="edge27" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu0_l0_expert0</title>
<path fill="none" stroke="black" d="M777.12,-2135.65C738.97,-2125.02 684.44,-2108.77 638,-2090.9 635.28,-2089.85 632.52,-2088.74 629.74,-2087.58"/>
<polygon fill="black" stroke="black" points="630.87,-2084.26 620.3,-2083.52 628.1,-2090.69 630.87,-2084.26"/>
</g>
<!-- gpu0_l0_expert1 -->
<g id="node15" class="node">
<title>gpu0_l0_expert1</title>
<polygon fill="lightblue" stroke="black" points="747.5,-2083.41 646.5,-2083.41 646.5,-2040.41 747.5,-2040.41 747.5,-2083.41"/>
<text text-anchor="middle" x="697" y="-2070.41" font-family="Arial" font-size="10.00">Expert 1 FC</text>
<text text-anchor="middle" x="697" y="-2059.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="697" y="-2048.41" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu0_l0_expert1 -->
<g id="edge28" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu0_l0_expert1</title>
<path fill="none" stroke="black" d="M794.01,-2127.7C776.64,-2116.1 754.8,-2101.51 736.24,-2089.11"/>
<polygon fill="black" stroke="black" points="737.96,-2086.05 727.7,-2083.41 734.07,-2091.87 737.96,-2086.05"/>
</g>
<!-- gpu0_l0_expert2 -->
<g id="node16" class="node">
<title>gpu0_l0_expert2</title>
<polygon fill="lightblue" stroke="black" points="866.5,-2083.41 765.5,-2083.41 765.5,-2040.41 866.5,-2040.41 866.5,-2083.41"/>
<text text-anchor="middle" x="816" y="-2070.41" font-family="Arial" font-size="10.00">Expert 2 FC</text>
<text text-anchor="middle" x="816" y="-2059.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="816" y="-2048.41" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu0_l0_expert2 -->
<g id="edge29" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu0_l0_expert2</title>
<path fill="none" stroke="black" d="M822.82,-2127.7C821.74,-2117.41 820.41,-2104.77 819.21,-2093.4"/>
<polygon fill="black" stroke="black" points="822.69,-2092.99 818.16,-2083.41 815.72,-2093.72 822.69,-2092.99"/>
</g>
<!-- gpu0_l0_expert3 -->
<g id="node17" class="node">
<title>gpu0_l0_expert3</title>
<polygon fill="lightblue" stroke="black" points="985.5,-2083.41 884.5,-2083.41 884.5,-2040.41 985.5,-2040.41 985.5,-2083.41"/>
<text text-anchor="middle" x="935" y="-2070.41" font-family="Arial" font-size="10.00">Expert 3 FC</text>
<text text-anchor="middle" x="935" y="-2059.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="935" y="-2048.41" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu0_l0_ln2&#45;&gt;gpu0_l0_expert3 -->
<g id="edge30" class="edge">
<title>gpu0_l0_ln2&#45;&gt;gpu0_l0_expert3</title>
<path fill="none" stroke="black" d="M851.63,-2127.7C866.36,-2116.26 884.82,-2101.9 900.63,-2089.62"/>
<polygon fill="black" stroke="black" points="902.87,-2092.31 908.62,-2083.41 898.57,-2086.78 902.87,-2092.31"/>
</g>
<!-- gpu0_l0_expert_agg -->
<g id="node18" class="node">
<title>gpu0_l0_expert_agg</title>
<polygon fill="yellow" stroke="black" points="953.48,-1953.91 796.82,-1953.91 756.52,-1871.91 913.18,-1871.91 953.48,-1953.91"/>
<text text-anchor="middle" x="855" y="-1921.41" font-family="Arial" font-size="10.00">Expert Agg</text>
<text text-anchor="middle" x="855" y="-1910.41" font-family="Arial" font-size="10.00">Input: [128, 1024]</text>
<text text-anchor="middle" x="855" y="-1899.41" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu0_l0_gate&#45;&gt;gpu0_l0_expert_agg -->
<g id="edge35" class="edge">
<title>gpu0_l0_gate&#45;&gt;gpu0_l0_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1020.76,-2040.16C993.63,-2019.5 951.07,-1987.08 915.87,-1960.27"/>
<polygon fill="black" stroke="black" points="917.63,-1957.22 907.56,-1953.94 913.39,-1962.79 917.63,-1957.22"/>
<text text-anchor="middle" x="999.5" y="-1991.21" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- gpu0_l0_expert0&#45;&gt;gpu0_l0_expert_agg -->
<g id="edge31" class="edge">
<title>gpu0_l0_expert0&#45;&gt;gpu0_l0_expert_agg</title>
<path fill="none" stroke="black" d="M616.18,-2040.29C649.79,-2022.18 700.07,-1995.17 744,-1971.91 756.88,-1965.1 770.63,-1957.87 783.9,-1950.92"/>
<polygon fill="black" stroke="black" points="785.76,-1953.9 793,-1946.16 782.52,-1947.7 785.76,-1953.9"/>
</g>
<!-- gpu0_l0_expert1&#45;&gt;gpu0_l0_expert_agg -->
<g id="edge32" class="edge">
<title>gpu0_l0_expert1&#45;&gt;gpu0_l0_expert_agg</title>
<path fill="none" stroke="black" d="M719.3,-2040.16C741.32,-2019.67 775.76,-1987.63 804.44,-1960.95"/>
<polygon fill="black" stroke="black" points="807.04,-1963.32 811.97,-1953.94 802.27,-1958.19 807.04,-1963.32"/>
</g>
<!-- gpu0_l0_expert2&#45;&gt;gpu0_l0_expert_agg -->
<g id="edge33" class="edge">
<title>gpu0_l0_expert2&#45;&gt;gpu0_l0_expert_agg</title>
<path fill="none" stroke="black" d="M821.51,-2040.16C826.76,-2020.37 834.87,-1989.8 841.79,-1963.69"/>
<polygon fill="black" stroke="black" points="845.2,-1964.5 844.38,-1953.94 838.43,-1962.71 845.2,-1964.5"/>
</g>
<!-- gpu0_l0_expert3&#45;&gt;gpu0_l0_expert_agg -->
<g id="edge34" class="edge">
<title>gpu0_l0_expert3&#45;&gt;gpu0_l0_expert_agg</title>
<path fill="none" stroke="black" d="M923.71,-2040.16C912.84,-2020.19 896.01,-1989.26 881.72,-1963.01"/>
<polygon fill="black" stroke="black" points="884.64,-1961.05 876.79,-1953.94 878.49,-1964.4 884.64,-1961.05"/>
</g>
<!-- gpu0_send -->
<g id="node19" class="node">
<title>gpu0_send</title>
<ellipse fill="purple" stroke="black" cx="1011" cy="-1784.91" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="1011" y="-1793.41" font-family="Arial" font-size="10.00">Send to PP1</text>
<text text-anchor="middle" x="1011" y="-1782.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1011" y="-1771.41" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu0_l0_expert_agg&#45;&gt;gpu0_send -->
<g id="edge48" class="edge">
<title>gpu0_l0_expert_agg&#45;&gt;gpu0_send</title>
<path fill="none" stroke="black" d="M904.79,-1871.7C926.67,-1854.02 951.98,-1833.58 972.4,-1817.09"/>
<polygon fill="black" stroke="black" points="974.68,-1819.75 980.26,-1810.75 970.28,-1814.31 974.68,-1819.75"/>
</g>
<!-- gpu0_send&#45;&gt;gpu2_recv -->
<g id="edge50" class="edge">
<title>gpu0_send&#45;&gt;gpu2_recv</title>
<path fill="none" stroke="black" d="M1020.52,-1756.18C1043.19,-1690.1 1100.45,-1523.28 1126.16,-1448.37"/>
<polygon fill="black" stroke="black" points="1129.49,-1449.45 1129.42,-1438.85 1122.86,-1447.17 1129.49,-1449.45"/>
</g>
<!-- gpu1_l0_attn_q -->
<g id="node21" class="node">
<title>gpu1_l0_attn_q</title>
<polygon fill="lightblue" stroke="black" points="310.5,-2680.32 215.5,-2680.32 215.5,-2637.32 310.5,-2637.32 310.5,-2680.32"/>
<text text-anchor="middle" x="263" y="-2667.32" font-family="Arial" font-size="10.00">Attention Q Proj</text>
<text text-anchor="middle" x="263" y="-2656.32" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="263" y="-2645.32" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_q -->
<g id="edge16" class="edge">
<title>gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_q</title>
<path fill="none" stroke="black" d="M385.78,-2724.62C363.2,-2712.7 334.65,-2697.63 310.76,-2685.02"/>
<polygon fill="black" stroke="black" points="312.33,-2681.9 301.85,-2680.32 309.07,-2688.09 312.33,-2681.9"/>
</g>
<!-- gpu1_l0_attn_k -->
<g id="node22" class="node">
<title>gpu1_l0_attn_k</title>
<polygon fill="lightblue" stroke="black" points="423.5,-2680.32 328.5,-2680.32 328.5,-2637.32 423.5,-2637.32 423.5,-2680.32"/>
<text text-anchor="middle" x="376" y="-2667.32" font-family="Arial" font-size="10.00">Attention K Proj</text>
<text text-anchor="middle" x="376" y="-2656.32" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="376" y="-2645.32" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_k -->
<g id="edge17" class="edge">
<title>gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_k</title>
<path fill="none" stroke="black" d="M413.14,-2724.62C407.06,-2714.01 399.55,-2700.91 392.88,-2689.27"/>
<polygon fill="black" stroke="black" points="395.76,-2687.26 387.75,-2680.32 389.69,-2690.74 395.76,-2687.26"/>
</g>
<!-- gpu1_l0_attn_v -->
<g id="node23" class="node">
<title>gpu1_l0_attn_v</title>
<polygon fill="lightblue" stroke="black" points="476.5,-2611.83 381.5,-2611.83 381.5,-2568.83 476.5,-2568.83 476.5,-2611.83"/>
<text text-anchor="middle" x="429" y="-2598.83" font-family="Arial" font-size="10.00">Attention V Proj</text>
<text text-anchor="middle" x="429" y="-2587.83" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="429" y="-2576.83" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_v -->
<g id="edge18" class="edge">
<title>gpu1_l0_ln1&#45;&gt;gpu1_l0_attn_v</title>
<path fill="none" stroke="black" d="M428.58,-2724.62C430.29,-2713.71 432.15,-2700.08 433,-2687.81 434.78,-2662.1 434.33,-2655.56 433,-2629.83 432.87,-2627.3 432.69,-2624.69 432.48,-2622.07"/>
<polygon fill="black" stroke="black" points="435.96,-2621.71 431.55,-2612.08 428.99,-2622.36 435.96,-2621.71"/>
</g>
<!-- gpu1_l0_attn_score -->
<g id="node24" class="node">
<title>gpu1_l0_attn_score</title>
<polygon fill="lightblue" stroke="black" points="367.5,-2543.34 272.5,-2543.34 272.5,-2500.34 367.5,-2500.34 367.5,-2543.34"/>
<text text-anchor="middle" x="320" y="-2530.34" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="320" y="-2519.34" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="320" y="-2508.34" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_attn_q&#45;&gt;gpu1_l0_attn_score -->
<g id="edge19" class="edge">
<title>gpu1_l0_attn_q&#45;&gt;gpu1_l0_attn_score</title>
<path fill="none" stroke="black" d="M271.66,-2637.32C281.16,-2614.82 296.5,-2578.5 307.34,-2552.8"/>
<polygon fill="black" stroke="black" points="310.6,-2554.1 311.26,-2543.53 304.15,-2551.38 310.6,-2554.1"/>
</g>
<!-- gpu1_l0_attn_k&#45;&gt;gpu1_l0_attn_score -->
<g id="edge20" class="edge">
<title>gpu1_l0_attn_k&#45;&gt;gpu1_l0_attn_score</title>
<path fill="none" stroke="black" d="M367.49,-2637.32C358.16,-2614.82 343.09,-2578.5 332.43,-2552.8"/>
<polygon fill="black" stroke="black" points="335.65,-2551.43 328.59,-2543.53 329.18,-2554.11 335.65,-2551.43"/>
</g>
<!-- gpu1_l0_attn_softmax -->
<g id="node25" class="node">
<title>gpu1_l0_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="367.5,-2448.35 272.5,-2448.35 272.5,-2405.35 367.5,-2405.35 367.5,-2448.35"/>
<text text-anchor="middle" x="320" y="-2435.35" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="320" y="-2424.35" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="320" y="-2413.35" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_attn_v&#45;&gt;gpu1_l0_attn_softmax -->
<g id="edge21" class="edge">
<title>gpu1_l0_attn_v&#45;&gt;gpu1_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M419.51,-2568.59C409.94,-2548.5 394.15,-2517.54 377,-2492.84 368.18,-2480.15 357.23,-2467.15 347.29,-2456.14"/>
<polygon fill="black" stroke="black" points="349.62,-2453.51 340.28,-2448.52 344.47,-2458.25 349.62,-2453.51"/>
</g>
<!-- gpu1_l0_attn_score&#45;&gt;gpu1_l0_attn_softmax -->
<g id="edge22" class="edge">
<title>gpu1_l0_attn_score&#45;&gt;gpu1_l0_attn_softmax</title>
<path fill="none" stroke="black" d="M320,-2500.2C320,-2488.04 320,-2472.42 320,-2458.81"/>
<polygon fill="black" stroke="black" points="323.5,-2458.43 320,-2448.43 316.5,-2458.43 323.5,-2458.43"/>
</g>
<!-- gpu1_l0_attn_out -->
<g id="node26" class="node">
<title>gpu1_l0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="340.5,-2353.37 245.5,-2353.37 245.5,-2310.37 340.5,-2310.37 340.5,-2353.37"/>
<text text-anchor="middle" x="293" y="-2340.37" font-family="Arial" font-size="10.00">Attention Out Proj</text>
<text text-anchor="middle" x="293" y="-2329.37" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="293" y="-2318.37" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_attn_softmax&#45;&gt;gpu1_l0_attn_out -->
<g id="edge23" class="edge">
<title>gpu1_l0_attn_softmax&#45;&gt;gpu1_l0_attn_out</title>
<path fill="none" stroke="black" d="M314.01,-2405.22C310.44,-2392.94 305.85,-2377.13 301.87,-2363.43"/>
<polygon fill="black" stroke="black" points="305.13,-2362.08 298.98,-2353.45 298.4,-2364.03 305.13,-2362.08"/>
</g>
<!-- gpu1_l0_attn_ar -->
<g id="node27" class="node">
<title>gpu1_l0_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="252" cy="-2236.89" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="252" y="-2245.39" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="252" y="-2234.39" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="252" y="-2223.39" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_attn_out&#45;&gt;gpu1_l0_attn_ar -->
<g id="edge24" class="edge">
<title>gpu1_l0_attn_out&#45;&gt;gpu1_l0_attn_ar</title>
<path fill="none" stroke="black" d="M283.9,-2310.23C279.32,-2299.85 273.63,-2286.94 268.33,-2274.91"/>
<polygon fill="black" stroke="black" points="271.42,-2273.26 264.19,-2265.52 265.02,-2276.08 271.42,-2273.26"/>
</g>
<!-- gpu1_l0_ln2 -->
<g id="node28" class="node">
<title>gpu1_l0_ln2</title>
<polygon fill="lightblue" stroke="black" points="291.5,-2170.9 196.5,-2170.9 196.5,-2127.9 291.5,-2127.9 291.5,-2170.9"/>
<text text-anchor="middle" x="244" y="-2157.9" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="244" y="-2146.9" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="244" y="-2135.9" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_attn_ar&#45;&gt;gpu1_l0_ln2 -->
<g id="edge25" class="edge">
<title>gpu1_l0_attn_ar&#45;&gt;gpu1_l0_ln2</title>
<path fill="none" stroke="black" d="M249.38,-2207.89C248.58,-2199.38 247.7,-2189.97 246.89,-2181.28"/>
<polygon fill="black" stroke="black" points="250.36,-2180.76 245.94,-2171.13 243.39,-2181.41 250.36,-2180.76"/>
</g>
<!-- gpu1_l0_gate -->
<g id="node29" class="node">
<title>gpu1_l0_gate</title>
<polygon fill="lightblue" stroke="black" points="127,-2014.91 39,-2014.91 39,-1971.91 127,-1971.91 127,-2014.91"/>
<text text-anchor="middle" x="83" y="-2001.91" font-family="Arial" font-size="10.00">Gate Router</text>
<text text-anchor="middle" x="83" y="-1990.91" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="83" y="-1979.91" font-family="Arial" font-size="10.00">Output: [128, 8]</text>
</g>
<!-- gpu1_l0_ln2&#45;&gt;gpu1_l0_gate -->
<g id="edge36" class="edge">
<title>gpu1_l0_ln2&#45;&gt;gpu1_l0_gate</title>
<path fill="none" stroke="black" d="M214.03,-2127.86C199.57,-2117.43 182.31,-2104.18 168,-2090.9 145.13,-2069.67 121.9,-2042.87 105.52,-2022.9"/>
<polygon fill="black" stroke="black" points="108.18,-2020.63 99.16,-2015.07 102.75,-2025.04 108.18,-2020.63"/>
</g>
<!-- gpu1_ep_a2a_send -->
<g id="node35" class="node">
<title>gpu1_ep_a2a_send</title>
<ellipse fill="red" stroke="black" cx="244" cy="-2061.91" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="244" y="-2070.41" font-family="Arial" font-size="10.00">EP All&#45;to&#45;All Send</text>
<text text-anchor="middle" x="244" y="-2059.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="244" y="-2048.41" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_ln2&#45;&gt;gpu1_ep_a2a_send -->
<g id="edge37" class="edge">
<title>gpu1_l0_ln2&#45;&gt;gpu1_ep_a2a_send</title>
<path fill="none" stroke="black" d="M244,-2127.7C244,-2119.73 244,-2110.35 244,-2101.24"/>
<polygon fill="black" stroke="black" points="247.5,-2101.16 244,-2091.16 240.5,-2101.16 247.5,-2101.16"/>
</g>
<!-- gpu1_l0_expert_agg -->
<g id="node34" class="node">
<title>gpu1_l0_expert_agg</title>
<polygon fill="yellow" stroke="black" points="371.48,-1706.91 214.82,-1706.91 174.52,-1624.91 331.18,-1624.91 371.48,-1706.91"/>
<text text-anchor="middle" x="273" y="-1674.41" font-family="Arial" font-size="10.00">Expert Agg</text>
<text text-anchor="middle" x="273" y="-1663.41" font-family="Arial" font-size="10.00">Input: [128, 1024]</text>
<text text-anchor="middle" x="273" y="-1652.41" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_gate&#45;&gt;gpu1_l0_expert_agg -->
<g id="edge47" class="edge">
<title>gpu1_l0_gate&#45;&gt;gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M69.52,-1971.71C40.79,-1924.74 -19.56,-1808.54 35,-1735.91 53.97,-1710.66 129.47,-1691.68 190.41,-1680.08"/>
<polygon fill="black" stroke="black" points="191.26,-1683.48 200.45,-1678.21 189.97,-1676.6 191.26,-1683.48"/>
<text text-anchor="middle" x="32.5" y="-1846.71" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- gpu1_l0_expert8 -->
<g id="node30" class="node">
<title>gpu1_l0_expert8</title>
<polygon fill="lightblue" stroke="black" points="383.5,-1806.41 282.5,-1806.41 282.5,-1763.41 383.5,-1763.41 383.5,-1806.41"/>
<text text-anchor="middle" x="333" y="-1793.41" font-family="Arial" font-size="10.00">Expert 8 FC</text>
<text text-anchor="middle" x="333" y="-1782.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="333" y="-1771.41" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu1_l0_expert8&#45;&gt;gpu1_l0_expert_agg -->
<g id="edge43" class="edge">
<title>gpu1_l0_expert8&#45;&gt;gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M322.41,-1763.27C315.71,-1750.2 306.75,-1732.73 298.3,-1716.25"/>
<polygon fill="black" stroke="black" points="301.35,-1714.53 293.67,-1707.23 295.12,-1717.72 301.35,-1714.53"/>
</g>
<!-- gpu1_l0_expert9 -->
<g id="node31" class="node">
<title>gpu1_l0_expert9</title>
<polygon fill="lightblue" stroke="black" points="502.5,-1806.41 401.5,-1806.41 401.5,-1763.41 502.5,-1763.41 502.5,-1806.41"/>
<text text-anchor="middle" x="452" y="-1793.41" font-family="Arial" font-size="10.00">Expert 9 FC</text>
<text text-anchor="middle" x="452" y="-1782.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="452" y="-1771.41" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu1_l0_expert9&#45;&gt;gpu1_l0_expert_agg -->
<g id="edge44" class="edge">
<title>gpu1_l0_expert9&#45;&gt;gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M428.56,-1763.39C418,-1754.53 405.19,-1744.29 393,-1735.91 381.26,-1727.84 368.51,-1719.8 355.86,-1712.22"/>
<polygon fill="black" stroke="black" points="357.52,-1709.13 347.13,-1707.04 353.95,-1715.15 357.52,-1709.13"/>
</g>
<!-- gpu1_l0_expert10 -->
<g id="node32" class="node">
<title>gpu1_l0_expert10</title>
<polygon fill="lightblue" stroke="black" points="145.5,-1806.41 44.5,-1806.41 44.5,-1763.41 145.5,-1763.41 145.5,-1806.41"/>
<text text-anchor="middle" x="95" y="-1793.41" font-family="Arial" font-size="10.00">Expert 10 FC</text>
<text text-anchor="middle" x="95" y="-1782.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="95" y="-1771.41" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu1_l0_expert10&#45;&gt;gpu1_l0_expert_agg -->
<g id="edge45" class="edge">
<title>gpu1_l0_expert10&#45;&gt;gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M119.19,-1763.23C129.89,-1754.44 142.8,-1744.3 155,-1735.91 170.1,-1725.54 186.83,-1715.15 202.82,-1705.69"/>
<polygon fill="black" stroke="black" points="204.76,-1708.61 211.62,-1700.54 201.22,-1702.57 204.76,-1708.61"/>
</g>
<!-- gpu1_l0_expert11 -->
<g id="node33" class="node">
<title>gpu1_l0_expert11</title>
<polygon fill="lightblue" stroke="black" points="264.5,-1806.41 163.5,-1806.41 163.5,-1763.41 264.5,-1763.41 264.5,-1806.41"/>
<text text-anchor="middle" x="214" y="-1793.41" font-family="Arial" font-size="10.00">Expert 11 FC</text>
<text text-anchor="middle" x="214" y="-1782.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="214" y="-1771.41" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu1_l0_expert11&#45;&gt;gpu1_l0_expert_agg -->
<g id="edge46" class="edge">
<title>gpu1_l0_expert11&#45;&gt;gpu1_l0_expert_agg</title>
<path fill="none" stroke="black" d="M224.41,-1763.27C231,-1750.2 239.81,-1732.73 248.12,-1716.25"/>
<polygon fill="black" stroke="black" points="251.29,-1717.73 252.67,-1707.23 245.04,-1714.58 251.29,-1717.73"/>
</g>
<!-- gpu1_send -->
<g id="node37" class="node">
<title>gpu1_send</title>
<ellipse fill="purple" stroke="black" cx="329" cy="-1558.92" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="329" y="-1567.42" font-family="Arial" font-size="10.00">Send to PP1</text>
<text text-anchor="middle" x="329" y="-1556.42" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="329" y="-1545.42" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_l0_expert_agg&#45;&gt;gpu1_send -->
<g id="edge49" class="edge">
<title>gpu1_l0_expert_agg&#45;&gt;gpu1_send</title>
<path fill="none" stroke="black" d="M294.49,-1624.62C299.49,-1615.25 304.78,-1605.34 309.67,-1596.16"/>
<polygon fill="black" stroke="black" points="312.8,-1597.74 314.41,-1587.27 306.62,-1594.44 312.8,-1597.74"/>
</g>
<!-- gpu1_ep_a2a_recv -->
<g id="node36" class="node">
<title>gpu1_ep_a2a_recv</title>
<ellipse fill="red" stroke="black" cx="244" cy="-1912.91" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="244" y="-1921.41" font-family="Arial" font-size="10.00">EP All&#45;to&#45;All Recv</text>
<text text-anchor="middle" x="244" y="-1910.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="244" y="-1899.41" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu1_ep_a2a_send&#45;&gt;gpu1_ep_a2a_recv -->
<g id="edge38" class="edge">
<title>gpu1_ep_a2a_send&#45;&gt;gpu1_ep_a2a_recv</title>
<path fill="none" stroke="black" d="M244,-2032.91C244,-2010.17 244,-1977.85 244,-1952.63"/>
<polygon fill="black" stroke="black" points="247.5,-1952.3 244,-1942.3 240.5,-1952.3 247.5,-1952.3"/>
</g>
<!-- gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert8 -->
<g id="edge39" class="edge">
<title>gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert8</title>
<path fill="none" stroke="black" d="M263.09,-1884.88C277.64,-1864.29 297.63,-1835.99 312.51,-1814.93"/>
<polygon fill="black" stroke="black" points="315.43,-1816.86 318.34,-1806.67 309.71,-1812.82 315.43,-1816.86"/>
</g>
<!-- gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert9 -->
<g id="edge40" class="edge">
<title>gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert9</title>
<path fill="none" stroke="black" d="M284.31,-1889.69C314.55,-1872.76 356.8,-1848.59 393,-1825.91 399.86,-1821.62 407.06,-1816.91 413.99,-1812.27"/>
<polygon fill="black" stroke="black" points="416.24,-1814.98 422.56,-1806.48 412.32,-1809.18 416.24,-1814.98"/>
</g>
<!-- gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert10 -->
<g id="edge41" class="edge">
<title>gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert10</title>
<path fill="none" stroke="black" d="M214.21,-1886.72C188.96,-1865.37 152.85,-1834.83 127,-1812.97"/>
<polygon fill="black" stroke="black" points="129.22,-1810.27 119.33,-1806.49 124.7,-1815.62 129.22,-1810.27"/>
</g>
<!-- gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert11 -->
<g id="edge42" class="edge">
<title>gpu1_ep_a2a_recv&#45;&gt;gpu1_l0_expert11</title>
<path fill="none" stroke="black" d="M237.34,-1883.95C232.59,-1863.98 226.19,-1837.12 221.3,-1816.57"/>
<polygon fill="black" stroke="black" points="224.68,-1815.67 218.96,-1806.75 217.87,-1817.29 224.68,-1815.67"/>
</g>
<!-- gpu1_send&#45;&gt;gpu3_recv -->
<g id="edge51" class="edge">
<title>gpu1_send&#45;&gt;gpu3_recv</title>
<path fill="none" stroke="black" d="M379.72,-1539.6C454.98,-1512.43 595.91,-1461.53 676.12,-1432.56"/>
<polygon fill="black" stroke="black" points="677.38,-1435.83 685.6,-1429.14 675,-1429.25 677.38,-1435.83"/>
</g>
<!-- gpu2_l8_ln1 -->
<g id="node39" class="node">
<title>gpu2_l8_ln1</title>
<polygon fill="lightblue" stroke="black" points="1186.5,-1343.95 1091.5,-1343.95 1091.5,-1300.95 1186.5,-1300.95 1186.5,-1343.95"/>
<text text-anchor="middle" x="1139" y="-1330.95" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1139" y="-1319.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1139" y="-1308.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu2_recv&#45;&gt;gpu2_l8_ln1 -->
<g id="edge52" class="edge">
<title>gpu2_recv&#45;&gt;gpu2_l8_ln1</title>
<path fill="none" stroke="black" d="M1139,-1380.95C1139,-1372.43 1139,-1363.02 1139,-1354.33"/>
<polygon fill="black" stroke="black" points="1142.5,-1354.18 1139,-1344.18 1135.5,-1354.18 1142.5,-1354.18"/>
</g>
<!-- gpu2_l8_attn_q -->
<g id="node40" class="node">
<title>gpu2_l8_attn_q</title>
<polygon fill="lightblue" stroke="black" points="1073.5,-1263.95 978.5,-1263.95 978.5,-1220.95 1073.5,-1220.95 1073.5,-1263.95"/>
<text text-anchor="middle" x="1026" y="-1250.95" font-family="Arial" font-size="10.00">Attention Q Proj</text>
<text text-anchor="middle" x="1026" y="-1239.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1026" y="-1228.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_q -->
<g id="edge53" class="edge">
<title>gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_q</title>
<path fill="none" stroke="black" d="M1109.01,-1300.75C1095.24,-1291.24 1078.75,-1279.86 1064.11,-1269.75"/>
<polygon fill="black" stroke="black" points="1065.95,-1266.77 1055.73,-1263.97 1061.97,-1272.53 1065.95,-1266.77"/>
</g>
<!-- gpu2_l8_attn_k -->
<g id="node41" class="node">
<title>gpu2_l8_attn_k</title>
<polygon fill="lightblue" stroke="black" points="1186.5,-1263.95 1091.5,-1263.95 1091.5,-1220.95 1186.5,-1220.95 1186.5,-1263.95"/>
<text text-anchor="middle" x="1139" y="-1250.95" font-family="Arial" font-size="10.00">Attention K Proj</text>
<text text-anchor="middle" x="1139" y="-1239.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1139" y="-1228.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_k -->
<g id="edge54" class="edge">
<title>gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_k</title>
<path fill="none" stroke="black" d="M1139,-1300.55C1139,-1292.53 1139,-1283.19 1139,-1274.43"/>
<polygon fill="black" stroke="black" points="1142.5,-1274.14 1139,-1264.14 1135.5,-1274.14 1142.5,-1274.14"/>
</g>
<!-- gpu2_l8_attn_v -->
<g id="node42" class="node">
<title>gpu2_l8_attn_v</title>
<polygon fill="lightblue" stroke="black" points="1253.5,-1202.95 1158.5,-1202.95 1158.5,-1159.95 1253.5,-1159.95 1253.5,-1202.95"/>
<text text-anchor="middle" x="1206" y="-1189.95" font-family="Arial" font-size="10.00">Attention V Proj</text>
<text text-anchor="middle" x="1206" y="-1178.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1206" y="-1167.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_v -->
<g id="edge55" class="edge">
<title>gpu2_l8_ln1&#45;&gt;gpu2_l8_attn_v</title>
<path fill="none" stroke="black" d="M1166.29,-1300.78C1177.36,-1290.89 1189.13,-1278.11 1196,-1263.95 1203.53,-1248.42 1206.18,-1229.35 1206.87,-1213.57"/>
<polygon fill="black" stroke="black" points="1210.38,-1213.31 1207.08,-1203.24 1203.38,-1213.17 1210.38,-1213.31"/>
</g>
<!-- gpu2_l8_attn_score -->
<g id="node43" class="node">
<title>gpu2_l8_attn_score</title>
<polygon fill="lightblue" stroke="black" points="1186.5,-1141.95 1091.5,-1141.95 1091.5,-1098.95 1186.5,-1098.95 1186.5,-1141.95"/>
<text text-anchor="middle" x="1139" y="-1128.95" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="1139" y="-1117.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1139" y="-1106.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu2_l8_attn_q&#45;&gt;gpu2_l8_attn_score -->
<g id="edge56" class="edge">
<title>gpu2_l8_attn_q&#45;&gt;gpu2_l8_attn_score</title>
<path fill="none" stroke="black" d="M1045.43,-1220.82C1063.94,-1201.16 1091.96,-1171.4 1112.52,-1149.57"/>
<polygon fill="black" stroke="black" points="1115.14,-1151.89 1119.45,-1142.21 1110.05,-1147.09 1115.14,-1151.89"/>
</g>
<!-- gpu2_l8_attn_k&#45;&gt;gpu2_l8_attn_score -->
<g id="edge57" class="edge">
<title>gpu2_l8_attn_k&#45;&gt;gpu2_l8_attn_score</title>
<path fill="none" stroke="black" d="M1139,-1220.82C1139,-1202.02 1139,-1173.98 1139,-1152.47"/>
<polygon fill="black" stroke="black" points="1142.5,-1152.21 1139,-1142.21 1135.5,-1152.21 1142.5,-1152.21"/>
</g>
<!-- gpu2_l8_attn_softmax -->
<g id="node44" class="node">
<title>gpu2_l8_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="1236.5,-1061.95 1141.5,-1061.95 1141.5,-1018.95 1236.5,-1018.95 1236.5,-1061.95"/>
<text text-anchor="middle" x="1189" y="-1048.95" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="1189" y="-1037.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1189" y="-1026.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu2_l8_attn_v&#45;&gt;gpu2_l8_attn_softmax -->
<g id="edge58" class="edge">
<title>gpu2_l8_attn_v&#45;&gt;gpu2_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M1203.49,-1159.94C1200.65,-1136.74 1196,-1098.72 1192.74,-1072.02"/>
<polygon fill="black" stroke="black" points="1196.21,-1071.54 1191.52,-1062.04 1189.26,-1072.39 1196.21,-1071.54"/>
</g>
<!-- gpu2_l8_attn_score&#45;&gt;gpu2_l8_attn_softmax -->
<g id="edge59" class="edge">
<title>gpu2_l8_attn_score&#45;&gt;gpu2_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M1152.4,-1098.55C1157.88,-1090 1164.32,-1079.96 1170.25,-1070.7"/>
<polygon fill="black" stroke="black" points="1173.29,-1072.45 1175.74,-1062.14 1167.39,-1068.67 1173.29,-1072.45"/>
</g>
<!-- gpu2_l8_attn_out -->
<g id="node45" class="node">
<title>gpu2_l8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1236.5,-981.95 1141.5,-981.95 1141.5,-938.95 1236.5,-938.95 1236.5,-981.95"/>
<text text-anchor="middle" x="1189" y="-968.95" font-family="Arial" font-size="10.00">Attention Out Proj</text>
<text text-anchor="middle" x="1189" y="-957.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1189" y="-946.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu2_l8_attn_softmax&#45;&gt;gpu2_l8_attn_out -->
<g id="edge60" class="edge">
<title>gpu2_l8_attn_softmax&#45;&gt;gpu2_l8_attn_out</title>
<path fill="none" stroke="black" d="M1189,-1018.55C1189,-1010.53 1189,-1001.19 1189,-992.43"/>
<polygon fill="black" stroke="black" points="1192.5,-992.14 1189,-982.14 1185.5,-992.14 1192.5,-992.14"/>
</g>
<!-- gpu2_l8_attn_ar -->
<g id="node46" class="node">
<title>gpu2_l8_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="1189" cy="-872.96" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="1189" y="-881.46" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1189" y="-870.46" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1189" y="-859.46" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu2_l8_attn_out&#45;&gt;gpu2_l8_attn_ar -->
<g id="edge61" class="edge">
<title>gpu2_l8_attn_out&#45;&gt;gpu2_l8_attn_ar</title>
<path fill="none" stroke="black" d="M1189,-938.75C1189,-930.78 1189,-921.4 1189,-912.29"/>
<polygon fill="black" stroke="black" points="1192.5,-912.21 1189,-902.21 1185.5,-912.21 1192.5,-912.21"/>
</g>
<!-- gpu2_l8_ln2 -->
<g id="node47" class="node">
<title>gpu2_l8_ln2</title>
<polygon fill="lightblue" stroke="black" points="1236.5,-806.97 1141.5,-806.97 1141.5,-763.97 1236.5,-763.97 1236.5,-806.97"/>
<text text-anchor="middle" x="1189" y="-793.97" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1189" y="-782.97" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1189" y="-771.97" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu2_l8_attn_ar&#45;&gt;gpu2_l8_ln2 -->
<g id="edge62" class="edge">
<title>gpu2_l8_attn_ar&#45;&gt;gpu2_l8_ln2</title>
<path fill="none" stroke="black" d="M1189,-843.96C1189,-835.45 1189,-826.04 1189,-817.34"/>
<polygon fill="black" stroke="black" points="1192.5,-817.2 1189,-807.2 1185.5,-817.2 1192.5,-817.2"/>
</g>
<!-- gpu2_l8_gate -->
<g id="node48" class="node">
<title>gpu2_l8_gate</title>
<polygon fill="lightblue" stroke="black" points="1346,-719.47 1258,-719.47 1258,-676.47 1346,-676.47 1346,-719.47"/>
<text text-anchor="middle" x="1302" y="-706.47" font-family="Arial" font-size="10.00">Gate Router</text>
<text text-anchor="middle" x="1302" y="-695.47" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1302" y="-684.47" font-family="Arial" font-size="10.00">Output: [128, 8]</text>
</g>
<!-- gpu2_l8_ln2&#45;&gt;gpu2_l8_gate -->
<g id="edge63" class="edge">
<title>gpu2_l8_ln2&#45;&gt;gpu2_l8_gate</title>
<path fill="none" stroke="black" d="M1216.35,-763.77C1231.48,-752.32 1250.45,-737.97 1266.69,-725.69"/>
<polygon fill="black" stroke="black" points="1269.03,-728.3 1274.9,-719.48 1264.81,-722.72 1269.03,-728.3"/>
</g>
<!-- gpu2_l8_expert0 -->
<g id="node49" class="node">
<title>gpu2_l8_expert0</title>
<polygon fill="lightblue" stroke="black" points="1465.5,-719.47 1364.5,-719.47 1364.5,-676.47 1465.5,-676.47 1465.5,-719.47"/>
<text text-anchor="middle" x="1415" y="-706.47" font-family="Arial" font-size="10.00">Expert 0 FC</text>
<text text-anchor="middle" x="1415" y="-695.47" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1415" y="-684.47" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu2_l8_ln2&#45;&gt;gpu2_l8_expert0 -->
<g id="edge64" class="edge">
<title>gpu2_l8_ln2&#45;&gt;gpu2_l8_expert0</title>
<path fill="none" stroke="black" d="M1236.71,-769.39C1270.15,-758.47 1315.71,-742.89 1355,-726.97 1357.65,-725.89 1360.34,-724.77 1363.06,-723.6"/>
<polygon fill="black" stroke="black" points="1364.55,-726.77 1372.3,-719.55 1361.74,-720.36 1364.55,-726.77"/>
</g>
<!-- gpu2_l8_expert1 -->
<g id="node50" class="node">
<title>gpu2_l8_expert1</title>
<polygon fill="lightblue" stroke="black" points="1001.5,-719.47 900.5,-719.47 900.5,-676.47 1001.5,-676.47 1001.5,-719.47"/>
<text text-anchor="middle" x="951" y="-706.47" font-family="Arial" font-size="10.00">Expert 1 FC</text>
<text text-anchor="middle" x="951" y="-695.47" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="951" y="-684.47" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu2_l8_ln2&#45;&gt;gpu2_l8_expert1 -->
<g id="edge65" class="edge">
<title>gpu2_l8_ln2&#45;&gt;gpu2_l8_expert1</title>
<path fill="none" stroke="black" d="M1141.21,-770.79C1105.05,-760.01 1054.37,-744.01 1011,-726.97 1008.29,-725.9 1005.53,-724.77 1002.76,-723.61"/>
<polygon fill="black" stroke="black" points="1003.89,-720.28 993.33,-719.51 1001.11,-726.7 1003.89,-720.28"/>
</g>
<!-- gpu2_l8_expert2 -->
<g id="node51" class="node">
<title>gpu2_l8_expert2</title>
<polygon fill="lightblue" stroke="black" points="1120.5,-719.47 1019.5,-719.47 1019.5,-676.47 1120.5,-676.47 1120.5,-719.47"/>
<text text-anchor="middle" x="1070" y="-706.47" font-family="Arial" font-size="10.00">Expert 2 FC</text>
<text text-anchor="middle" x="1070" y="-695.47" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1070" y="-684.47" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu2_l8_ln2&#45;&gt;gpu2_l8_expert2 -->
<g id="edge66" class="edge">
<title>gpu2_l8_ln2&#45;&gt;gpu2_l8_expert2</title>
<path fill="none" stroke="black" d="M1160.19,-763.77C1144.11,-752.22 1123.92,-737.71 1106.71,-725.35"/>
<polygon fill="black" stroke="black" points="1108.7,-722.47 1098.54,-719.48 1104.62,-728.16 1108.7,-722.47"/>
</g>
<!-- gpu2_l8_expert3 -->
<g id="node52" class="node">
<title>gpu2_l8_expert3</title>
<polygon fill="lightblue" stroke="black" points="1239.5,-719.47 1138.5,-719.47 1138.5,-676.47 1239.5,-676.47 1239.5,-719.47"/>
<text text-anchor="middle" x="1189" y="-706.47" font-family="Arial" font-size="10.00">Expert 3 FC</text>
<text text-anchor="middle" x="1189" y="-695.47" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1189" y="-684.47" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu2_l8_ln2&#45;&gt;gpu2_l8_expert3 -->
<g id="edge67" class="edge">
<title>gpu2_l8_ln2&#45;&gt;gpu2_l8_expert3</title>
<path fill="none" stroke="black" d="M1189,-763.77C1189,-753.58 1189,-741.1 1189,-729.81"/>
<polygon fill="black" stroke="black" points="1192.5,-729.48 1189,-719.48 1185.5,-729.48 1192.5,-729.48"/>
</g>
<!-- gpu2_l8_expert_agg -->
<g id="node53" class="node">
<title>gpu2_l8_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1227.48,-589.98 1070.82,-589.98 1030.52,-507.98 1187.18,-507.98 1227.48,-589.98"/>
<text text-anchor="middle" x="1129" y="-557.48" font-family="Arial" font-size="10.00">Expert Agg</text>
<text text-anchor="middle" x="1129" y="-546.48" font-family="Arial" font-size="10.00">Input: [128, 1024]</text>
<text text-anchor="middle" x="1129" y="-535.48" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu2_l8_gate&#45;&gt;gpu2_l8_expert_agg -->
<g id="edge72" class="edge">
<title>gpu2_l8_gate&#45;&gt;gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1277.58,-676.23C1253.37,-655.65 1215.44,-623.42 1183.96,-596.68"/>
<polygon fill="black" stroke="black" points="1186,-593.82 1176.11,-590.01 1181.46,-599.15 1186,-593.82"/>
<text text-anchor="middle" x="1260.5" y="-627.28" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- gpu2_l8_expert0&#45;&gt;gpu2_l8_expert_agg -->
<g id="edge68" class="edge">
<title>gpu2_l8_expert0&#45;&gt;gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M1387.4,-676.42C1360.63,-657.1 1318.41,-628.21 1279,-607.98 1264.7,-600.65 1249.25,-593.68 1233.89,-587.28"/>
<polygon fill="black" stroke="black" points="1234.93,-583.92 1224.35,-583.37 1232.28,-590.4 1234.93,-583.92"/>
</g>
<!-- gpu2_l8_expert1&#45;&gt;gpu2_l8_expert_agg -->
<g id="edge69" class="edge">
<title>gpu2_l8_expert1&#45;&gt;gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M976.13,-676.23C1001.04,-655.65 1040.07,-623.42 1072.45,-596.68"/>
<polygon fill="black" stroke="black" points="1075.05,-599.08 1080.53,-590.01 1070.59,-593.68 1075.05,-599.08"/>
</g>
<!-- gpu2_l8_expert2&#45;&gt;gpu2_l8_expert_agg -->
<g id="edge70" class="edge">
<title>gpu2_l8_expert2&#45;&gt;gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M1078.33,-676.23C1086.31,-656.35 1098.65,-625.6 1109.16,-599.42"/>
<polygon fill="black" stroke="black" points="1112.46,-600.59 1112.93,-590.01 1105.96,-597.99 1112.46,-600.59"/>
</g>
<!-- gpu2_l8_expert3&#45;&gt;gpu2_l8_expert_agg -->
<g id="edge71" class="edge">
<title>gpu2_l8_expert3&#45;&gt;gpu2_l8_expert_agg</title>
<path fill="none" stroke="black" d="M1180.53,-676.23C1172.42,-656.35 1159.86,-625.6 1149.18,-599.42"/>
<polygon fill="black" stroke="black" points="1152.36,-597.95 1145.34,-590.01 1145.88,-600.59 1152.36,-597.95"/>
</g>
<!-- gpu2_output_proj -->
<g id="node54" class="node">
<title>gpu2_output_proj</title>
<polygon fill="lightblue" stroke="black" points="1056.5,-461.98 961.5,-461.98 961.5,-418.98 1056.5,-418.98 1056.5,-461.98"/>
<text text-anchor="middle" x="1009" y="-448.98" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="1009" y="-437.98" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1009" y="-426.98" font-family="Arial" font-size="10.00">Output: [128, 512]</text>
</g>
<!-- gpu2_l8_expert_agg&#45;&gt;gpu2_output_proj -->
<g id="edge73" class="edge">
<title>gpu2_l8_expert_agg&#45;&gt;gpu2_output_proj</title>
<path fill="none" stroke="black" d="M1083.63,-507.72C1068.99,-494.72 1053.1,-480.62 1039.76,-468.79"/>
<polygon fill="black" stroke="black" points="1042.04,-466.12 1032.23,-462.1 1037.39,-471.36 1042.04,-466.12"/>
</g>
<!-- output_agg -->
<g id="node74" class="node">
<title>output_agg</title>
<polygon fill="yellow" stroke="black" points="969.85,-176.98 804.65,-176.98 762.15,-94.98 927.35,-94.98 969.85,-176.98"/>
<text text-anchor="middle" x="866" y="-144.48" font-family="Arial" font-size="10.00">Output Aggregation</text>
<text text-anchor="middle" x="866" y="-133.48" font-family="Arial" font-size="10.00">Input: [128, 512]</text>
<text text-anchor="middle" x="866" y="-122.48" font-family="Arial" font-size="10.00">Output: [128, 512]</text>
</g>
<!-- gpu2_output_proj&#45;&gt;output_agg -->
<g id="edge98" class="edge">
<title>gpu2_output_proj&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M999.17,-418.69C976.69,-371.14 921.02,-253.38 889.23,-186.13"/>
<polygon fill="black" stroke="black" points="892.35,-184.53 884.91,-176.99 886.02,-187.53 892.35,-184.53"/>
</g>
<!-- gpu3_l8_ln1 -->
<g id="node56" class="node">
<title>gpu3_l8_ln1</title>
<polygon fill="lightblue" stroke="black" points="783.5,-1343.95 688.5,-1343.95 688.5,-1300.95 783.5,-1300.95 783.5,-1343.95"/>
<text text-anchor="middle" x="736" y="-1330.95" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="736" y="-1319.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="736" y="-1308.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_recv&#45;&gt;gpu3_l8_ln1 -->
<g id="edge74" class="edge">
<title>gpu3_recv&#45;&gt;gpu3_l8_ln1</title>
<path fill="none" stroke="black" d="M736,-1380.95C736,-1372.43 736,-1363.02 736,-1354.33"/>
<polygon fill="black" stroke="black" points="739.5,-1354.18 736,-1344.18 732.5,-1354.18 739.5,-1354.18"/>
</g>
<!-- gpu3_l8_attn_q -->
<g id="node57" class="node">
<title>gpu3_l8_attn_q</title>
<polygon fill="lightblue" stroke="black" points="670.5,-1263.95 575.5,-1263.95 575.5,-1220.95 670.5,-1220.95 670.5,-1263.95"/>
<text text-anchor="middle" x="623" y="-1250.95" font-family="Arial" font-size="10.00">Attention Q Proj</text>
<text text-anchor="middle" x="623" y="-1239.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="623" y="-1228.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_q -->
<g id="edge75" class="edge">
<title>gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_q</title>
<path fill="none" stroke="black" d="M706.01,-1300.75C692.24,-1291.24 675.75,-1279.86 661.11,-1269.75"/>
<polygon fill="black" stroke="black" points="662.95,-1266.77 652.73,-1263.97 658.97,-1272.53 662.95,-1266.77"/>
</g>
<!-- gpu3_l8_attn_k -->
<g id="node58" class="node">
<title>gpu3_l8_attn_k</title>
<polygon fill="lightblue" stroke="black" points="783.5,-1263.95 688.5,-1263.95 688.5,-1220.95 783.5,-1220.95 783.5,-1263.95"/>
<text text-anchor="middle" x="736" y="-1250.95" font-family="Arial" font-size="10.00">Attention K Proj</text>
<text text-anchor="middle" x="736" y="-1239.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="736" y="-1228.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_k -->
<g id="edge76" class="edge">
<title>gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_k</title>
<path fill="none" stroke="black" d="M736,-1300.55C736,-1292.53 736,-1283.19 736,-1274.43"/>
<polygon fill="black" stroke="black" points="739.5,-1274.14 736,-1264.14 732.5,-1274.14 739.5,-1274.14"/>
</g>
<!-- gpu3_l8_attn_v -->
<g id="node59" class="node">
<title>gpu3_l8_attn_v</title>
<polygon fill="lightblue" stroke="black" points="850.5,-1202.95 755.5,-1202.95 755.5,-1159.95 850.5,-1159.95 850.5,-1202.95"/>
<text text-anchor="middle" x="803" y="-1189.95" font-family="Arial" font-size="10.00">Attention V Proj</text>
<text text-anchor="middle" x="803" y="-1178.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="803" y="-1167.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_v -->
<g id="edge77" class="edge">
<title>gpu3_l8_ln1&#45;&gt;gpu3_l8_attn_v</title>
<path fill="none" stroke="black" d="M763.29,-1300.78C774.36,-1290.89 786.13,-1278.11 793,-1263.95 800.53,-1248.42 803.18,-1229.35 803.87,-1213.57"/>
<polygon fill="black" stroke="black" points="807.38,-1213.31 804.08,-1203.24 800.38,-1213.17 807.38,-1213.31"/>
</g>
<!-- gpu3_l8_attn_score -->
<g id="node60" class="node">
<title>gpu3_l8_attn_score</title>
<polygon fill="lightblue" stroke="black" points="783.5,-1141.95 688.5,-1141.95 688.5,-1098.95 783.5,-1098.95 783.5,-1141.95"/>
<text text-anchor="middle" x="736" y="-1128.95" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="736" y="-1117.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="736" y="-1106.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_l8_attn_q&#45;&gt;gpu3_l8_attn_score -->
<g id="edge78" class="edge">
<title>gpu3_l8_attn_q&#45;&gt;gpu3_l8_attn_score</title>
<path fill="none" stroke="black" d="M642.43,-1220.82C660.94,-1201.16 688.96,-1171.4 709.52,-1149.57"/>
<polygon fill="black" stroke="black" points="712.14,-1151.89 716.45,-1142.21 707.05,-1147.09 712.14,-1151.89"/>
</g>
<!-- gpu3_l8_attn_k&#45;&gt;gpu3_l8_attn_score -->
<g id="edge79" class="edge">
<title>gpu3_l8_attn_k&#45;&gt;gpu3_l8_attn_score</title>
<path fill="none" stroke="black" d="M736,-1220.82C736,-1202.02 736,-1173.98 736,-1152.47"/>
<polygon fill="black" stroke="black" points="739.5,-1152.21 736,-1142.21 732.5,-1152.21 739.5,-1152.21"/>
</g>
<!-- gpu3_l8_attn_softmax -->
<g id="node61" class="node">
<title>gpu3_l8_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="832.5,-1061.95 737.5,-1061.95 737.5,-1018.95 832.5,-1018.95 832.5,-1061.95"/>
<text text-anchor="middle" x="785" y="-1048.95" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="785" y="-1037.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="785" y="-1026.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_l8_attn_v&#45;&gt;gpu3_l8_attn_softmax -->
<g id="edge80" class="edge">
<title>gpu3_l8_attn_v&#45;&gt;gpu3_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M800.54,-1159.67C798.57,-1143.19 795.7,-1119.59 793,-1098.95 791.87,-1090.28 790.58,-1080.89 789.38,-1072.25"/>
<polygon fill="black" stroke="black" points="792.82,-1071.61 787.97,-1062.2 785.89,-1072.59 792.82,-1071.61"/>
</g>
<!-- gpu3_l8_attn_score&#45;&gt;gpu3_l8_attn_softmax -->
<g id="edge81" class="edge">
<title>gpu3_l8_attn_score&#45;&gt;gpu3_l8_attn_softmax</title>
<path fill="none" stroke="black" d="M749.13,-1098.55C754.5,-1090 760.81,-1079.96 766.62,-1070.7"/>
<polygon fill="black" stroke="black" points="769.65,-1072.47 772,-1062.14 763.72,-1068.74 769.65,-1072.47"/>
</g>
<!-- gpu3_l8_attn_out -->
<g id="node62" class="node">
<title>gpu3_l8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="832.5,-981.95 737.5,-981.95 737.5,-938.95 832.5,-938.95 832.5,-981.95"/>
<text text-anchor="middle" x="785" y="-968.95" font-family="Arial" font-size="10.00">Attention Out Proj</text>
<text text-anchor="middle" x="785" y="-957.95" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="785" y="-946.95" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_l8_attn_softmax&#45;&gt;gpu3_l8_attn_out -->
<g id="edge82" class="edge">
<title>gpu3_l8_attn_softmax&#45;&gt;gpu3_l8_attn_out</title>
<path fill="none" stroke="black" d="M785,-1018.55C785,-1010.53 785,-1001.19 785,-992.43"/>
<polygon fill="black" stroke="black" points="788.5,-992.14 785,-982.14 781.5,-992.14 788.5,-992.14"/>
</g>
<!-- gpu3_l8_attn_ar -->
<g id="node63" class="node">
<title>gpu3_l8_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="785" cy="-872.96" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="785" y="-881.46" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="785" y="-870.46" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="785" y="-859.46" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_l8_attn_out&#45;&gt;gpu3_l8_attn_ar -->
<g id="edge83" class="edge">
<title>gpu3_l8_attn_out&#45;&gt;gpu3_l8_attn_ar</title>
<path fill="none" stroke="black" d="M785,-938.75C785,-930.78 785,-921.4 785,-912.29"/>
<polygon fill="black" stroke="black" points="788.5,-912.21 785,-902.21 781.5,-912.21 788.5,-912.21"/>
</g>
<!-- gpu3_l8_ln2 -->
<g id="node64" class="node">
<title>gpu3_l8_ln2</title>
<polygon fill="lightblue" stroke="black" points="832.5,-806.97 737.5,-806.97 737.5,-763.97 832.5,-763.97 832.5,-806.97"/>
<text text-anchor="middle" x="785" y="-793.97" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="785" y="-782.97" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="785" y="-771.97" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_l8_attn_ar&#45;&gt;gpu3_l8_ln2 -->
<g id="edge84" class="edge">
<title>gpu3_l8_attn_ar&#45;&gt;gpu3_l8_ln2</title>
<path fill="none" stroke="black" d="M785,-843.96C785,-835.45 785,-826.04 785,-817.34"/>
<polygon fill="black" stroke="black" points="788.5,-817.2 785,-807.2 781.5,-817.2 788.5,-817.2"/>
</g>
<!-- gpu3_l8_gate -->
<g id="node65" class="node">
<title>gpu3_l8_gate</title>
<polygon fill="lightblue" stroke="black" points="872,-650.98 784,-650.98 784,-607.98 872,-607.98 872,-650.98"/>
<text text-anchor="middle" x="828" y="-637.98" font-family="Arial" font-size="10.00">Gate Router</text>
<text text-anchor="middle" x="828" y="-626.98" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="828" y="-615.98" font-family="Arial" font-size="10.00">Output: [128, 8]</text>
</g>
<!-- gpu3_l8_ln2&#45;&gt;gpu3_l8_gate -->
<g id="edge85" class="edge">
<title>gpu3_l8_ln2&#45;&gt;gpu3_l8_gate</title>
<path fill="none" stroke="black" d="M790.8,-763.7C798.17,-737.29 810.96,-691.49 819.45,-661.08"/>
<polygon fill="black" stroke="black" points="822.84,-661.99 822.16,-651.41 816.09,-660.1 822.84,-661.99"/>
</g>
<!-- gpu3_ep_a2a_send -->
<g id="node71" class="node">
<title>gpu3_ep_a2a_send</title>
<ellipse fill="red" stroke="black" cx="708" cy="-697.97" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="708" y="-706.47" font-family="Arial" font-size="10.00">EP All&#45;to&#45;All Send</text>
<text text-anchor="middle" x="708" y="-695.47" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="708" y="-684.47" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_l8_ln2&#45;&gt;gpu3_ep_a2a_send -->
<g id="edge86" class="edge">
<title>gpu3_l8_ln2&#45;&gt;gpu3_ep_a2a_send</title>
<path fill="none" stroke="black" d="M766.36,-763.77C757.98,-754.47 747.87,-743.24 738.44,-732.77"/>
<polygon fill="black" stroke="black" points="741.01,-730.4 731.72,-725.31 735.81,-735.08 741.01,-730.4"/>
</g>
<!-- gpu3_l8_expert_agg -->
<g id="node70" class="node">
<title>gpu3_l8_expert_agg</title>
<polygon fill="yellow" stroke="black" points="811.48,-381.98 654.82,-381.98 614.52,-299.98 771.18,-299.98 811.48,-381.98"/>
<text text-anchor="middle" x="713" y="-349.48" font-family="Arial" font-size="10.00">Expert Agg</text>
<text text-anchor="middle" x="713" y="-338.48" font-family="Arial" font-size="10.00">Input: [128, 1024]</text>
<text text-anchor="middle" x="713" y="-327.48" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_l8_gate&#45;&gt;gpu3_l8_expert_agg -->
<g id="edge96" class="edge">
<title>gpu3_l8_gate&#45;&gt;gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M831.56,-607.64C836.68,-578.75 846.85,-524.99 859,-479.98 861.2,-471.84 863.65,-470.31 865,-461.98 868.63,-439.61 877.28,-430.04 865,-410.98 852.42,-391.46 832.82,-377.4 811.83,-367.29"/>
<polygon fill="black" stroke="black" points="812.99,-363.98 802.44,-363.06 810.12,-370.36 812.99,-363.98"/>
<text text-anchor="middle" x="873.5" y="-482.78" font-family="Arial" font-size="9.00">routing</text>
</g>
<!-- gpu3_l8_expert8 -->
<g id="node66" class="node">
<title>gpu3_l8_expert8</title>
<polygon fill="lightblue" stroke="black" points="498.5,-461.98 397.5,-461.98 397.5,-418.98 498.5,-418.98 498.5,-461.98"/>
<text text-anchor="middle" x="448" y="-448.98" font-family="Arial" font-size="10.00">Expert 8 FC</text>
<text text-anchor="middle" x="448" y="-437.98" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="448" y="-426.98" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu3_l8_expert8&#45;&gt;gpu3_l8_expert_agg -->
<g id="edge92" class="edge">
<title>gpu3_l8_expert8&#45;&gt;gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M489.68,-418.91C495.77,-416.13 502.01,-413.4 508,-410.98 549.4,-394.25 596.58,-378.17 635.23,-365.75"/>
<polygon fill="black" stroke="black" points="636.4,-369.05 644.86,-362.68 634.27,-362.39 636.4,-369.05"/>
</g>
<!-- gpu3_l8_expert9 -->
<g id="node67" class="node">
<title>gpu3_l8_expert9</title>
<polygon fill="lightblue" stroke="black" points="617.5,-461.98 516.5,-461.98 516.5,-418.98 617.5,-418.98 617.5,-461.98"/>
<text text-anchor="middle" x="567" y="-448.98" font-family="Arial" font-size="10.00">Expert 9 FC</text>
<text text-anchor="middle" x="567" y="-437.98" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="567" y="-426.98" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu3_l8_expert9&#45;&gt;gpu3_l8_expert_agg -->
<g id="edge93" class="edge">
<title>gpu3_l8_expert9&#45;&gt;gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M597.96,-418.81C611.93,-409.48 629.02,-398.06 645.71,-386.92"/>
<polygon fill="black" stroke="black" points="648.01,-389.59 654.38,-381.13 644.12,-383.77 648.01,-389.59"/>
</g>
<!-- gpu3_l8_expert10 -->
<g id="node68" class="node">
<title>gpu3_l8_expert10</title>
<polygon fill="lightblue" stroke="black" points="736.5,-461.98 635.5,-461.98 635.5,-418.98 736.5,-418.98 736.5,-461.98"/>
<text text-anchor="middle" x="686" y="-448.98" font-family="Arial" font-size="10.00">Expert 10 FC</text>
<text text-anchor="middle" x="686" y="-437.98" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="686" y="-426.98" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu3_l8_expert10&#45;&gt;gpu3_l8_expert_agg -->
<g id="edge94" class="edge">
<title>gpu3_l8_expert10&#45;&gt;gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M691.73,-418.81C693.91,-410.92 696.5,-401.55 699.12,-392.12"/>
<polygon fill="black" stroke="black" points="702.53,-392.89 701.83,-382.32 695.79,-391.02 702.53,-392.89"/>
</g>
<!-- gpu3_l8_expert11 -->
<g id="node69" class="node">
<title>gpu3_l8_expert11</title>
<polygon fill="lightblue" stroke="black" points="855.5,-461.98 754.5,-461.98 754.5,-418.98 855.5,-418.98 855.5,-461.98"/>
<text text-anchor="middle" x="805" y="-448.98" font-family="Arial" font-size="10.00">Expert 11 FC</text>
<text text-anchor="middle" x="805" y="-437.98" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="805" y="-426.98" font-family="Arial" font-size="10.00">Output: [128, 1024]</text>
</g>
<!-- gpu3_l8_expert11&#45;&gt;gpu3_l8_expert_agg -->
<g id="edge95" class="edge">
<title>gpu3_l8_expert11&#45;&gt;gpu3_l8_expert_agg</title>
<path fill="none" stroke="black" d="M785.49,-418.81C777.42,-410.26 767.71,-399.97 758.06,-389.73"/>
<polygon fill="black" stroke="black" points="760.47,-387.19 751.06,-382.32 755.38,-391.99 760.47,-387.19"/>
</g>
<!-- gpu3_output_proj -->
<g id="node73" class="node">
<title>gpu3_output_proj</title>
<polygon fill="lightblue" stroke="black" points="804.5,-262.98 709.5,-262.98 709.5,-219.98 804.5,-219.98 804.5,-262.98"/>
<text text-anchor="middle" x="757" y="-249.98" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="757" y="-238.98" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="757" y="-227.98" font-family="Arial" font-size="10.00">Output: [128, 512]</text>
</g>
<!-- gpu3_l8_expert_agg&#45;&gt;gpu3_output_proj -->
<g id="edge97" class="edge">
<title>gpu3_l8_expert_agg&#45;&gt;gpu3_output_proj</title>
<path fill="none" stroke="black" d="M731.15,-299.76C735.28,-290.62 739.59,-281.06 743.49,-272.42"/>
<polygon fill="black" stroke="black" points="746.75,-273.7 747.68,-263.15 740.37,-270.82 746.75,-273.7"/>
</g>
<!-- gpu3_ep_a2a_recv -->
<g id="node72" class="node">
<title>gpu3_ep_a2a_recv</title>
<ellipse fill="red" stroke="black" cx="686" cy="-548.98" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="686" y="-557.48" font-family="Arial" font-size="10.00">EP All&#45;to&#45;All Recv</text>
<text text-anchor="middle" x="686" y="-546.48" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="686" y="-535.48" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- gpu3_ep_a2a_send&#45;&gt;gpu3_ep_a2a_recv -->
<g id="edge87" class="edge">
<title>gpu3_ep_a2a_send&#45;&gt;gpu3_ep_a2a_recv</title>
<path fill="none" stroke="black" d="M703.81,-668.98C700.39,-646.14 695.53,-613.63 691.74,-588.36"/>
<polygon fill="black" stroke="black" points="695.19,-587.74 690.25,-578.37 688.27,-588.78 695.19,-587.74"/>
</g>
<!-- gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert8 -->
<g id="edge88" class="edge">
<title>gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert8</title>
<path fill="none" stroke="black" d="M640.39,-527.57C601.24,-510.06 544.7,-484.75 503.04,-466.11"/>
<polygon fill="black" stroke="black" points="504.42,-462.89 493.86,-462 501.56,-469.28 504.42,-462.89"/>
</g>
<!-- gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert9 -->
<g id="edge89" class="edge">
<title>gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert9</title>
<path fill="none" stroke="black" d="M657.5,-522.47C639.45,-506.32 616.12,-485.44 597.67,-468.93"/>
<polygon fill="black" stroke="black" points="599.87,-466.21 590.09,-462.15 595.21,-471.42 599.87,-466.21"/>
</g>
<!-- gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert10 -->
<g id="edge90" class="edge">
<title>gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert10</title>
<path fill="none" stroke="black" d="M686,-519.72C686,-505.14 686,-487.33 686,-472.39"/>
<polygon fill="black" stroke="black" points="689.5,-472.1 686,-462.1 682.5,-472.1 689.5,-472.1"/>
</g>
<!-- gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert11 -->
<g id="edge91" class="edge">
<title>gpu3_ep_a2a_recv&#45;&gt;gpu3_l8_expert11</title>
<path fill="none" stroke="black" d="M714.5,-522.47C732.55,-506.32 755.88,-485.44 774.33,-468.93"/>
<polygon fill="black" stroke="black" points="776.79,-471.42 781.91,-462.15 772.13,-466.21 776.79,-471.42"/>
</g>
<!-- gpu3_output_proj&#45;&gt;output_agg -->
<g id="edge99" class="edge">
<title>gpu3_output_proj&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M778.8,-219.79C789.49,-209.63 802.86,-196.94 815.89,-184.56"/>
<polygon fill="black" stroke="black" points="818.66,-186.76 823.5,-177.34 813.84,-181.69 818.66,-186.76"/>
</g>
<!-- final_output -->
<g id="node75" class="node">
<title>final_output</title>
<ellipse fill="lightgreen" stroke="black" cx="866" cy="-28.99" rx="67.35" ry="28.98"/>
<text text-anchor="middle" x="866" y="-37.49" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="866" y="-26.49" font-family="Arial" font-size="10.00">Input: [128, 512]</text>
<text text-anchor="middle" x="866" y="-15.49" font-family="Arial" font-size="10.00">Output: [128, 512]</text>
</g>
<!-- output_agg&#45;&gt;final_output -->
<g id="edge100" class="edge">
<title>output_agg&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M866,-94.69C866,-86.06 866,-76.96 866,-68.4"/>
<polygon fill="black" stroke="black" points="869.5,-68.29 866,-58.29 862.5,-68.29 869.5,-68.29"/>
</g>
<!-- dec_gpu0_l0_attn_q -->
<g id="node77" class="node">
<title>dec_gpu0_l0_attn_q</title>
<polygon fill="lightblue" stroke="black" points="1379.5,-2767.81 1278.5,-2767.81 1278.5,-2724.81 1379.5,-2724.81 1379.5,-2767.81"/>
<text text-anchor="middle" x="1329" y="-2754.81" font-family="Arial" font-size="10.00">Decode Attn Q Proj</text>
<text text-anchor="middle" x="1329" y="-2743.81" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1329" y="-2732.81" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu0_l0_ln1&#45;&gt;dec_gpu0_l0_attn_q -->
<g id="edge105" class="edge">
<title>dec_gpu0_l0_ln1&#45;&gt;dec_gpu0_l0_attn_q</title>
<path fill="none" stroke="black" d="M1462.98,-2872.27C1435.65,-2846.78 1388.94,-2803.21 1358.52,-2774.84"/>
<polygon fill="black" stroke="black" points="1360.86,-2772.24 1351.16,-2767.98 1356.09,-2777.36 1360.86,-2772.24"/>
</g>
<!-- dec_gpu0_l0_attn_ar -->
<g id="node78" class="node">
<title>dec_gpu0_l0_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="1300" cy="-2658.82" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="1300" y="-2667.32" font-family="Arial" font-size="10.00">Decode TP All&#45;Reduce</text>
<text text-anchor="middle" x="1300" y="-2656.32" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1300" y="-2645.32" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu0_l0_attn_q&#45;&gt;dec_gpu0_l0_attn_ar -->
<g id="edge106" class="edge">
<title>dec_gpu0_l0_attn_q&#45;&gt;dec_gpu0_l0_attn_ar</title>
<path fill="none" stroke="black" d="M1321.98,-2724.62C1319.19,-2716.4 1315.9,-2706.69 1312.72,-2697.32"/>
<polygon fill="black" stroke="black" points="1316,-2696.1 1309.48,-2687.75 1309.37,-2698.35 1316,-2696.1"/>
</g>
<!-- dec_gpu0_l0_ln2 -->
<g id="node79" class="node">
<title>dec_gpu0_l0_ln2</title>
<polygon fill="lightblue" stroke="black" points="1415.5,-2543.34 1308.5,-2543.34 1308.5,-2500.34 1415.5,-2500.34 1415.5,-2543.34"/>
<text text-anchor="middle" x="1362" y="-2530.34" font-family="Arial" font-size="10.00">Decode LayerNorm2</text>
<text text-anchor="middle" x="1362" y="-2519.34" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1362" y="-2508.34" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu0_l0_attn_ar&#45;&gt;dec_gpu0_l0_ln2 -->
<g id="edge107" class="edge">
<title>dec_gpu0_l0_attn_ar&#45;&gt;dec_gpu0_l0_ln2</title>
<path fill="none" stroke="black" d="M1312.85,-2629.85C1323.15,-2607.42 1337.59,-2575.99 1348.15,-2553"/>
<polygon fill="black" stroke="black" points="1351.42,-2554.26 1352.41,-2543.71 1345.06,-2551.34 1351.42,-2554.26"/>
</g>
<!-- dec_gpu0_send -->
<g id="node80" class="node">
<title>dec_gpu0_send</title>
<ellipse fill="purple" stroke="black" cx="1380" cy="-2426.85" rx="77.15" ry="28.98"/>
<text text-anchor="middle" x="1380" y="-2435.35" font-family="Arial" font-size="10.00">Decode Send to PP1</text>
<text text-anchor="middle" x="1380" y="-2424.35" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1380" y="-2413.35" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu0_l0_ln2&#45;&gt;dec_gpu0_send -->
<g id="edge108" class="edge">
<title>dec_gpu0_l0_ln2&#45;&gt;dec_gpu0_send</title>
<path fill="none" stroke="black" d="M1365.99,-2500.2C1367.95,-2490.1 1370.37,-2477.62 1372.64,-2465.88"/>
<polygon fill="black" stroke="black" points="1376.12,-2466.32 1374.58,-2455.84 1369.25,-2464.99 1376.12,-2466.32"/>
</g>
<!-- dec_gpu0_send&#45;&gt;dec_gpu2_recv -->
<g id="edge113" class="edge">
<title>dec_gpu0_send&#45;&gt;dec_gpu2_recv</title>
<path fill="none" stroke="black" d="M1389,-2397.96C1391.79,-2389.31 1394.91,-2379.64 1397.87,-2370.46"/>
<polygon fill="black" stroke="black" points="1401.27,-2371.34 1401.01,-2360.75 1394.6,-2369.19 1401.27,-2371.34"/>
</g>
<!-- dec_gpu1_l0_gate -->
<g id="node82" class="node">
<title>dec_gpu1_l0_gate</title>
<polygon fill="lightblue" stroke="black" points="1507.5,-2680.32 1400.5,-2680.32 1400.5,-2637.32 1507.5,-2637.32 1507.5,-2680.32"/>
<text text-anchor="middle" x="1454" y="-2667.32" font-family="Arial" font-size="10.00">Decode Gate Router</text>
<text text-anchor="middle" x="1454" y="-2656.32" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1454" y="-2645.32" font-family="Arial" font-size="10.00">Output: [128, 8]</text>
</g>
<!-- dec_gpu1_l0_ln1&#45;&gt;dec_gpu1_l0_gate -->
<g id="edge109" class="edge">
<title>dec_gpu1_l0_ln1&#45;&gt;dec_gpu1_l0_gate</title>
<path fill="none" stroke="black" d="M1568.45,-2724.62C1547.58,-2712.8 1521.25,-2697.89 1499.11,-2685.36"/>
<polygon fill="black" stroke="black" points="1500.64,-2682.2 1490.22,-2680.32 1497.19,-2688.3 1500.64,-2682.2"/>
</g>
<!-- dec_gpu1_ep_a2a_send -->
<g id="node83" class="node">
<title>dec_gpu1_ep_a2a_send</title>
<ellipse fill="red" stroke="black" cx="1605" cy="-2658.82" rx="79.81" ry="28.98"/>
<text text-anchor="middle" x="1605" y="-2667.32" font-family="Arial" font-size="10.00">Decode EP A2A Send</text>
<text text-anchor="middle" x="1605" y="-2656.32" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1605" y="-2645.32" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu1_l0_ln1&#45;&gt;dec_gpu1_ep_a2a_send -->
<g id="edge110" class="edge">
<title>dec_gpu1_l0_ln1&#45;&gt;dec_gpu1_ep_a2a_send</title>
<path fill="none" stroke="black" d="M1605,-2724.62C1605,-2716.64 1605,-2707.27 1605,-2698.16"/>
<polygon fill="black" stroke="black" points="1608.5,-2698.07 1605,-2688.07 1601.5,-2698.07 1608.5,-2698.07"/>
</g>
<!-- dec_gpu1_ep_a2a_recv -->
<g id="node84" class="node">
<title>dec_gpu1_ep_a2a_recv</title>
<ellipse fill="red" stroke="black" cx="1602" cy="-2521.84" rx="79.81" ry="28.98"/>
<text text-anchor="middle" x="1602" y="-2530.34" font-family="Arial" font-size="10.00">Decode EP A2A Recv</text>
<text text-anchor="middle" x="1602" y="-2519.34" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1602" y="-2508.34" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu1_ep_a2a_send&#45;&gt;dec_gpu1_ep_a2a_recv -->
<g id="edge111" class="edge">
<title>dec_gpu1_ep_a2a_send&#45;&gt;dec_gpu1_ep_a2a_recv</title>
<path fill="none" stroke="black" d="M1604.37,-2629.52C1603.93,-2609.72 1603.34,-2583.04 1602.86,-2561.31"/>
<polygon fill="black" stroke="black" points="1606.35,-2561.02 1602.63,-2551.1 1599.35,-2561.17 1606.35,-2561.02"/>
</g>
<!-- dec_gpu1_send -->
<g id="node85" class="node">
<title>dec_gpu1_send</title>
<ellipse fill="purple" stroke="black" cx="1601" cy="-2426.85" rx="77.15" ry="28.98"/>
<text text-anchor="middle" x="1601" y="-2435.35" font-family="Arial" font-size="10.00">Decode Send to PP1</text>
<text text-anchor="middle" x="1601" y="-2424.35" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1601" y="-2413.35" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu1_ep_a2a_recv&#45;&gt;dec_gpu1_send -->
<g id="edge112" class="edge">
<title>dec_gpu1_ep_a2a_recv&#45;&gt;dec_gpu1_send</title>
<path fill="none" stroke="black" d="M1601.7,-2492.69C1601.61,-2484.31 1601.51,-2474.99 1601.41,-2466.09"/>
<polygon fill="black" stroke="black" points="1604.91,-2465.87 1601.3,-2455.91 1597.91,-2465.95 1604.91,-2465.87"/>
</g>
<!-- dec_gpu1_send&#45;&gt;dec_gpu3_recv -->
<g id="edge114" class="edge">
<title>dec_gpu1_send&#45;&gt;dec_gpu3_recv</title>
<path fill="none" stroke="black" d="M1600.39,-2397.7C1600.21,-2389.33 1600.01,-2380.01 1599.82,-2371.1"/>
<polygon fill="black" stroke="black" points="1603.32,-2370.85 1599.6,-2360.93 1596.32,-2371 1603.32,-2370.85"/>
</g>
<!-- dec_gpu2_l8_ln1 -->
<g id="node87" class="node">
<title>dec_gpu2_l8_ln1</title>
<polygon fill="lightblue" stroke="black" points="1463.5,-2258.39 1356.5,-2258.39 1356.5,-2215.39 1463.5,-2215.39 1463.5,-2258.39"/>
<text text-anchor="middle" x="1410" y="-2245.39" font-family="Arial" font-size="10.00">Decode LayerNorm1</text>
<text text-anchor="middle" x="1410" y="-2234.39" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1410" y="-2223.39" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu2_recv&#45;&gt;dec_gpu2_l8_ln1 -->
<g id="edge115" class="edge">
<title>dec_gpu2_recv&#45;&gt;dec_gpu2_l8_ln1</title>
<path fill="none" stroke="black" d="M1410,-2302.72C1410,-2291.95 1410,-2279.61 1410,-2268.6"/>
<polygon fill="black" stroke="black" points="1413.5,-2268.56 1410,-2258.56 1406.5,-2268.56 1413.5,-2268.56"/>
</g>
<!-- dec_gpu2_l8_attn_q -->
<g id="node88" class="node">
<title>dec_gpu2_l8_attn_q</title>
<polygon fill="lightblue" stroke="black" points="1460.5,-2170.9 1359.5,-2170.9 1359.5,-2127.9 1460.5,-2127.9 1460.5,-2170.9"/>
<text text-anchor="middle" x="1410" y="-2157.9" font-family="Arial" font-size="10.00">Decode Attn Q Proj</text>
<text text-anchor="middle" x="1410" y="-2146.9" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1410" y="-2135.9" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu2_l8_ln1&#45;&gt;dec_gpu2_l8_attn_q -->
<g id="edge116" class="edge">
<title>dec_gpu2_l8_ln1&#45;&gt;dec_gpu2_l8_attn_q</title>
<path fill="none" stroke="black" d="M1410,-2215.19C1410,-2205.01 1410,-2192.52 1410,-2181.24"/>
<polygon fill="black" stroke="black" points="1413.5,-2180.9 1410,-2170.9 1406.5,-2180.9 1413.5,-2180.9"/>
</g>
<!-- dec_gpu2_l8_attn_ar -->
<g id="node89" class="node">
<title>dec_gpu2_l8_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="1413" cy="-2061.91" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="1413" y="-2070.41" font-family="Arial" font-size="10.00">Decode TP All&#45;Reduce</text>
<text text-anchor="middle" x="1413" y="-2059.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1413" y="-2048.41" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu2_l8_attn_q&#45;&gt;dec_gpu2_l8_attn_ar -->
<g id="edge117" class="edge">
<title>dec_gpu2_l8_attn_q&#45;&gt;dec_gpu2_l8_attn_ar</title>
<path fill="none" stroke="black" d="M1410.73,-2127.7C1411.01,-2119.73 1411.34,-2110.35 1411.65,-2101.24"/>
<polygon fill="black" stroke="black" points="1415.16,-2101.28 1412.01,-2091.16 1408.16,-2101.03 1415.16,-2101.28"/>
</g>
<!-- dec_gpu2_output -->
<g id="node90" class="node">
<title>dec_gpu2_output</title>
<polygon fill="lightblue" stroke="black" points="1483.5,-1934.41 1380.5,-1934.41 1380.5,-1891.41 1483.5,-1891.41 1483.5,-1934.41"/>
<text text-anchor="middle" x="1432" y="-1921.41" font-family="Arial" font-size="10.00">Decode Output Proj</text>
<text text-anchor="middle" x="1432" y="-1910.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1432" y="-1899.41" font-family="Arial" font-size="10.00">Output: [128, 512]</text>
</g>
<!-- dec_gpu2_l8_attn_ar&#45;&gt;dec_gpu2_output -->
<g id="edge118" class="edge">
<title>dec_gpu2_l8_attn_ar&#45;&gt;dec_gpu2_output</title>
<path fill="none" stroke="black" d="M1416.62,-2032.91C1419.87,-2007.73 1424.65,-1970.79 1428.01,-1944.76"/>
<polygon fill="black" stroke="black" points="1431.5,-1945.05 1429.31,-1934.69 1424.56,-1944.16 1431.5,-1945.05"/>
</g>
<!-- decode_output_agg -->
<g id="node96" class="node">
<title>decode_output_agg</title>
<polygon fill="yellow" stroke="black" points="1613,-1825.91 1444.38,-1825.91 1401,-1743.91 1569.62,-1743.91 1613,-1825.91"/>
<text text-anchor="middle" x="1507" y="-1793.41" font-family="Arial" font-size="10.00">Decode Output Agg</text>
<text text-anchor="middle" x="1507" y="-1782.41" font-family="Arial" font-size="10.00">Input: [128, 512]</text>
<text text-anchor="middle" x="1507" y="-1771.41" font-family="Arial" font-size="10.00">Output: [128, 512]</text>
</g>
<!-- dec_gpu2_output&#45;&gt;decode_output_agg -->
<g id="edge123" class="edge">
<title>dec_gpu2_output&#45;&gt;decode_output_agg</title>
<path fill="none" stroke="black" d="M1444.22,-1891.39C1453.36,-1876.02 1466.27,-1854.34 1478,-1834.63"/>
<polygon fill="black" stroke="black" points="1481.01,-1836.42 1483.12,-1826.03 1475,-1832.84 1481.01,-1836.42"/>
</g>
<!-- dec_gpu3_l8_ln1 -->
<g id="node92" class="node">
<title>dec_gpu3_l8_ln1</title>
<polygon fill="lightblue" stroke="black" points="1651.5,-2258.39 1544.5,-2258.39 1544.5,-2215.39 1651.5,-2215.39 1651.5,-2258.39"/>
<text text-anchor="middle" x="1598" y="-2245.39" font-family="Arial" font-size="10.00">Decode LayerNorm1</text>
<text text-anchor="middle" x="1598" y="-2234.39" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1598" y="-2223.39" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu3_recv&#45;&gt;dec_gpu3_l8_ln1 -->
<g id="edge119" class="edge">
<title>dec_gpu3_recv&#45;&gt;dec_gpu3_l8_ln1</title>
<path fill="none" stroke="black" d="M1598.7,-2302.72C1598.58,-2291.95 1598.45,-2279.61 1598.33,-2268.6"/>
<polygon fill="black" stroke="black" points="1601.83,-2268.52 1598.22,-2258.56 1594.83,-2268.6 1601.83,-2268.52"/>
</g>
<!-- dec_gpu3_l8_attn_q -->
<g id="node93" class="node">
<title>dec_gpu3_l8_attn_q</title>
<polygon fill="lightblue" stroke="black" points="1646.5,-2170.9 1545.5,-2170.9 1545.5,-2127.9 1646.5,-2127.9 1646.5,-2170.9"/>
<text text-anchor="middle" x="1596" y="-2157.9" font-family="Arial" font-size="10.00">Decode Attn Q Proj</text>
<text text-anchor="middle" x="1596" y="-2146.9" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1596" y="-2135.9" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu3_l8_ln1&#45;&gt;dec_gpu3_l8_attn_q -->
<g id="edge120" class="edge">
<title>dec_gpu3_l8_ln1&#45;&gt;dec_gpu3_l8_attn_q</title>
<path fill="none" stroke="black" d="M1597.52,-2215.19C1597.28,-2205.01 1596.99,-2192.52 1596.72,-2181.24"/>
<polygon fill="black" stroke="black" points="1600.21,-2180.82 1596.48,-2170.9 1593.21,-2180.98 1600.21,-2180.82"/>
</g>
<!-- dec_gpu3_l8_attn_ar -->
<g id="node94" class="node">
<title>dec_gpu3_l8_attn_ar</title>
<ellipse fill="orange" stroke="black" cx="1596" cy="-2061.91" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="1596" y="-2070.41" font-family="Arial" font-size="10.00">Decode TP All&#45;Reduce</text>
<text text-anchor="middle" x="1596" y="-2059.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1596" y="-2048.41" font-family="Arial" font-size="10.00">Output: [128, 256]</text>
</g>
<!-- dec_gpu3_l8_attn_q&#45;&gt;dec_gpu3_l8_attn_ar -->
<g id="edge121" class="edge">
<title>dec_gpu3_l8_attn_q&#45;&gt;dec_gpu3_l8_attn_ar</title>
<path fill="none" stroke="black" d="M1596,-2127.7C1596,-2119.73 1596,-2110.35 1596,-2101.24"/>
<polygon fill="black" stroke="black" points="1599.5,-2101.16 1596,-2091.16 1592.5,-2101.16 1599.5,-2101.16"/>
</g>
<!-- dec_gpu3_output -->
<g id="node95" class="node">
<title>dec_gpu3_output</title>
<polygon fill="lightblue" stroke="black" points="1635.5,-1934.41 1532.5,-1934.41 1532.5,-1891.41 1635.5,-1891.41 1635.5,-1934.41"/>
<text text-anchor="middle" x="1584" y="-1921.41" font-family="Arial" font-size="10.00">Decode Output Proj</text>
<text text-anchor="middle" x="1584" y="-1910.41" font-family="Arial" font-size="10.00">Input: [128, 256]</text>
<text text-anchor="middle" x="1584" y="-1899.41" font-family="Arial" font-size="10.00">Output: [128, 512]</text>
</g>
<!-- dec_gpu3_l8_attn_ar&#45;&gt;dec_gpu3_output -->
<g id="edge122" class="edge">
<title>dec_gpu3_l8_attn_ar&#45;&gt;dec_gpu3_output</title>
<path fill="none" stroke="black" d="M1593.71,-2032.91C1591.66,-2007.73 1588.64,-1970.79 1586.52,-1944.76"/>
<polygon fill="black" stroke="black" points="1590,-1944.37 1585.7,-1934.69 1583.02,-1944.94 1590,-1944.37"/>
</g>
<!-- dec_gpu3_output&#45;&gt;decode_output_agg -->
<g id="edge124" class="edge">
<title>dec_gpu3_output&#45;&gt;decode_output_agg</title>
<path fill="none" stroke="black" d="M1571.46,-1891.39C1562.07,-1876.02 1548.82,-1854.34 1536.77,-1834.63"/>
<polygon fill="black" stroke="black" points="1539.72,-1832.74 1531.52,-1826.03 1533.75,-1836.39 1539.72,-1832.74"/>
</g>
</g>
</svg>
