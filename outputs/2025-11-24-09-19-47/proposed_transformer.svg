<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_transformer Pages: 1 -->
<svg width="9853pt" height="2313pt"
 viewBox="0.00 0.00 9853.00 2313.36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2309.36)">
<title>proposed_transformer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2309.36 9849,-2309.36 9849,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_device_0</title>
<polygon fill="lightcoral" stroke="black" points="8,-238.43 8,-2074.37 597,-2074.37 597,-238.43 8,-238.43"/>
<text text-anchor="middle" x="302.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 0 (6250 tokens)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_device_1</title>
<polygon fill="lightblue" stroke="black" points="624,-238.43 624,-2074.37 1213,-2074.37 1213,-238.43 624,-238.43"/>
<text text-anchor="middle" x="918.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 1 (6250 tokens)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_device_2</title>
<polygon fill="lightgreen" stroke="black" points="1240,-238.43 1240,-2074.37 1829,-2074.37 1829,-238.43 1240,-238.43"/>
<text text-anchor="middle" x="1534.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 2 (6250 tokens)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_device_3</title>
<polygon fill="lightyellow" stroke="black" points="1856,-238.43 1856,-2074.37 2445,-2074.37 2445,-238.43 1856,-238.43"/>
<text text-anchor="middle" x="2150.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 3 (6250 tokens)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_device_4</title>
<polygon fill="lightpink" stroke="black" points="2472,-238.43 2472,-2074.37 3061,-2074.37 3061,-238.43 2472,-238.43"/>
<text text-anchor="middle" x="2766.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 4 (6250 tokens)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_device_5</title>
<polygon fill="lightcyan" stroke="black" points="3088,-238.43 3088,-2074.37 3677,-2074.37 3677,-238.43 3088,-238.43"/>
<text text-anchor="middle" x="3382.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 5 (6250 tokens)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_device_6</title>
<polygon fill="lightgray" stroke="black" points="3704,-238.43 3704,-2074.37 4293,-2074.37 4293,-238.43 3704,-238.43"/>
<text text-anchor="middle" x="3998.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 6 (6250 tokens)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_device_7</title>
<polygon fill="#000000" stroke="black" points="4320,-238.43 4320,-2074.37 4909,-2074.37 4909,-238.43 4320,-238.43"/>
<text text-anchor="middle" x="4614.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 7 (6250 tokens)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_device_8</title>
<polygon fill="lightsteelblue" stroke="black" points="4936,-238.43 4936,-2074.37 5525,-2074.37 5525,-238.43 4936,-238.43"/>
<text text-anchor="middle" x="5230.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 8 (6250 tokens)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_device_9</title>
<polygon fill="lightseagreen" stroke="black" points="5552,-238.43 5552,-2074.37 6141,-2074.37 6141,-238.43 5552,-238.43"/>
<text text-anchor="middle" x="5846.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 9 (6250 tokens)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_device_10</title>
<polygon fill="lightsalmon" stroke="black" points="6168,-238.43 6168,-2074.37 6757,-2074.37 6757,-238.43 6168,-238.43"/>
<text text-anchor="middle" x="6462.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 10 (6250 tokens)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_device_11</title>
<polygon fill="lightseagreen" stroke="black" points="6784,-238.43 6784,-2074.37 7373,-2074.37 7373,-238.43 6784,-238.43"/>
<text text-anchor="middle" x="7078.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 11 (6250 tokens)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_device_12</title>
<polygon fill="lightsteelblue" stroke="black" points="7400,-238.43 7400,-2074.37 7989,-2074.37 7989,-238.43 7400,-238.43"/>
<text text-anchor="middle" x="7694.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 12 (6250 tokens)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_device_13</title>
<polygon fill="lightskyblue" stroke="black" points="8016,-238.43 8016,-2074.37 8605,-2074.37 8605,-238.43 8016,-238.43"/>
<text text-anchor="middle" x="8310.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 13 (6250 tokens)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_device_14</title>
<polygon fill="#eedd82" stroke="black" points="8632,-238.43 8632,-2074.37 9221,-2074.37 9221,-238.43 8632,-238.43"/>
<text text-anchor="middle" x="8926.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 14 (6250 tokens)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_device_15</title>
<polygon fill="lightcoral" stroke="black" points="9248,-238.43 9248,-2074.37 9837,-2074.37 9837,-238.43 9248,-238.43"/>
<text text-anchor="middle" x="9542.5" y="-2059.17" font-family="Times,serif" font-size="14.00">Device 15 (6250 tokens)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightyellow" stroke="black" points="5269.57,-2305.36 4875.74,-2305.36 4774.43,-2245.36 5168.26,-2245.36 5269.57,-2305.36"/>
<text text-anchor="middle" x="5022" y="-2278.36" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="5022" y="-2267.36" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- sequence_split -->
<g id="node2" class="node">
<title>sequence_split</title>
<ellipse fill="white" stroke="black" cx="5022" cy="-2144.37" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="5022" y="-2152.87" font-family="Arial" font-size="10.00">Sequence Split</text>
<text text-anchor="middle" x="5022" y="-2141.87" font-family="Arial" font-size="10.00">Into 16 parts</text>
<text text-anchor="middle" x="5022" y="-2130.87" font-family="Arial" font-size="10.00">[128, 6250, 4096] each</text>
</g>
<!-- input&#45;&gt;sequence_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;sequence_split</title>
<path fill="none" stroke="black" d="M5022,-2245.31C5022,-2245.31 5022,-2183.38 5022,-2183.38"/>
<polygon fill="black" stroke="black" points="5025.5,-2183.38 5022,-2173.38 5018.5,-2183.38 5025.5,-2183.38"/>
</g>
<!-- d0_input -->
<g id="node3" class="node">
<title>d0_input</title>
<ellipse fill="white" stroke="black" cx="524" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="524" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="524" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="524" y="-2000.88" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- sequence_split&#45;&gt;d0_input -->
<g id="edge2" class="edge">
<title>sequence_split&#45;&gt;d0_input</title>
<path fill="none" stroke="black" d="M4967.15,-2166C4454.7,-2166 524,-2166 524,-2166 524,-2166 524,-2053.62 524,-2053.62"/>
<polygon fill="black" stroke="black" points="527.5,-2053.62 524,-2043.62 520.5,-2053.62 527.5,-2053.62"/>
</g>
<!-- d1_input -->
<g id="node25" class="node">
<title>d1_input</title>
<ellipse fill="white" stroke="black" cx="1140" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="1140" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="1140" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1140" y="-2000.88" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- sequence_split&#45;&gt;d1_input -->
<g id="edge31" class="edge">
<title>sequence_split&#45;&gt;d1_input</title>
<path fill="none" stroke="black" d="M4949.2,-2158C4416.45,-2158 1140,-2158 1140,-2158 1140,-2158 1140,-2053.45 1140,-2053.45"/>
<polygon fill="black" stroke="black" points="1143.5,-2053.45 1140,-2043.45 1136.5,-2053.45 1143.5,-2053.45"/>
</g>
<!-- d2_input -->
<g id="node47" class="node">
<title>d2_input</title>
<ellipse fill="white" stroke="black" cx="1756" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="1756" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="1756" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1756" y="-2000.88" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- sequence_split&#45;&gt;d2_input -->
<g id="edge60" class="edge">
<title>sequence_split&#45;&gt;d2_input</title>
<path fill="none" stroke="black" d="M4942.08,-2151C4441.22,-2151 1756,-2151 1756,-2151 1756,-2151 1756,-2053.69 1756,-2053.69"/>
<polygon fill="black" stroke="black" points="1759.5,-2053.69 1756,-2043.69 1752.5,-2053.69 1759.5,-2053.69"/>
</g>
<!-- d3_input -->
<g id="node69" class="node">
<title>d3_input</title>
<ellipse fill="white" stroke="black" cx="2372" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="2372" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="2372" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2372" y="-2000.88" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- sequence_split&#45;&gt;d3_input -->
<g id="edge89" class="edge">
<title>sequence_split&#45;&gt;d3_input</title>
<path fill="none" stroke="black" d="M4939.78,-2144C4492.49,-2144 2372,-2144 2372,-2144 2372,-2144 2372,-2053.47 2372,-2053.47"/>
<polygon fill="black" stroke="black" points="2375.5,-2053.47 2372,-2043.47 2368.5,-2053.47 2375.5,-2053.47"/>
</g>
<!-- d4_input -->
<g id="node91" class="node">
<title>d4_input</title>
<ellipse fill="white" stroke="black" cx="2988" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="2988" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="2988" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2988" y="-2000.88" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- sequence_split&#45;&gt;d4_input -->
<g id="edge118" class="edge">
<title>sequence_split&#45;&gt;d4_input</title>
<path fill="none" stroke="black" d="M4942.58,-2137C4567.08,-2137 2988,-2137 2988,-2137 2988,-2137 2988,-2053.44 2988,-2053.44"/>
<polygon fill="black" stroke="black" points="2991.5,-2053.44 2988,-2043.44 2984.5,-2053.44 2991.5,-2053.44"/>
</g>
<!-- d5_input -->
<g id="node113" class="node">
<title>d5_input</title>
<ellipse fill="white" stroke="black" cx="3604" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="3604" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="3604" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3604" y="-2000.88" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- sequence_split&#45;&gt;d5_input -->
<g id="edge147" class="edge">
<title>sequence_split&#45;&gt;d5_input</title>
<path fill="none" stroke="black" d="M4952.16,-2129C4666.76,-2129 3604,-2129 3604,-2129 3604,-2129 3604,-2053.6 3604,-2053.6"/>
<polygon fill="black" stroke="black" points="3607.5,-2053.6 3604,-2043.6 3600.5,-2053.6 3607.5,-2053.6"/>
</g>
<!-- d6_input -->
<g id="node135" class="node">
<title>d6_input</title>
<ellipse fill="white" stroke="black" cx="4220" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="4220" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="4220" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4220" y="-2000.88" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- sequence_split&#45;&gt;d6_input -->
<g id="edge176" class="edge">
<title>sequence_split&#45;&gt;d6_input</title>
<path fill="none" stroke="black" d="M4969.69,-2122C4791.62,-2122 4220,-2122 4220,-2122 4220,-2122 4220,-2053.51 4220,-2053.51"/>
<polygon fill="black" stroke="black" points="4223.5,-2053.51 4220,-2043.51 4216.5,-2053.51 4223.5,-2053.51"/>
</g>
<!-- d7_input -->
<g id="node157" class="node">
<title>d7_input</title>
<ellipse fill="white" stroke="black" cx="4836" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="4836" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="4836" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4836" y="-2000.88" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- sequence_split&#45;&gt;d7_input -->
<g id="edge205" class="edge">
<title>sequence_split&#45;&gt;d7_input</title>
<path fill="none" stroke="black" d="M4948.94,-2131.02C4948.94,-2100.45 4948.94,-2028 4948.94,-2028 4948.94,-2028 4903.46,-2028 4903.46,-2028"/>
<polygon fill="black" stroke="black" points="4903.46,-2024.5 4893.46,-2028 4903.46,-2031.5 4903.46,-2024.5"/>
</g>
<!-- d8_input -->
<g id="node179" class="node">
<title>d8_input</title>
<ellipse fill="white" stroke="black" cx="5208" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="5208" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="5208" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5208" y="-2000.88" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- sequence_split&#45;&gt;d8_input -->
<g id="edge234" class="edge">
<title>sequence_split&#45;&gt;d8_input</title>
<path fill="none" stroke="black" d="M5097.78,-2133.25C5097.78,-2101.72 5097.78,-2014 5097.78,-2014 5097.78,-2014 5132.93,-2014 5132.93,-2014"/>
<polygon fill="black" stroke="black" points="5132.93,-2017.5 5142.93,-2014 5132.93,-2010.5 5132.93,-2017.5"/>
</g>
<!-- d9_input -->
<g id="node201" class="node">
<title>d9_input</title>
<ellipse fill="white" stroke="black" cx="5824" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="5824" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="5824" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5824" y="-2000.88" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- sequence_split&#45;&gt;d9_input -->
<g id="edge263" class="edge">
<title>sequence_split&#45;&gt;d9_input</title>
<path fill="none" stroke="black" d="M5074.31,-2122C5252.38,-2122 5824,-2122 5824,-2122 5824,-2122 5824,-2053.51 5824,-2053.51"/>
<polygon fill="black" stroke="black" points="5827.5,-2053.51 5824,-2043.51 5820.5,-2053.51 5827.5,-2053.51"/>
</g>
<!-- d10_input -->
<g id="node223" class="node">
<title>d10_input</title>
<ellipse fill="white" stroke="black" cx="6440" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="6440" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="6440" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6440" y="-2000.88" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- sequence_split&#45;&gt;d10_input -->
<g id="edge292" class="edge">
<title>sequence_split&#45;&gt;d10_input</title>
<path fill="none" stroke="black" d="M5091.84,-2129C5377.24,-2129 6440,-2129 6440,-2129 6440,-2129 6440,-2053.6 6440,-2053.6"/>
<polygon fill="black" stroke="black" points="6443.5,-2053.6 6440,-2043.6 6436.5,-2053.6 6443.5,-2053.6"/>
</g>
<!-- d11_input -->
<g id="node245" class="node">
<title>d11_input</title>
<ellipse fill="white" stroke="black" cx="7056" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="7056" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="7056" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7056" y="-2000.88" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- sequence_split&#45;&gt;d11_input -->
<g id="edge321" class="edge">
<title>sequence_split&#45;&gt;d11_input</title>
<path fill="none" stroke="black" d="M5101.42,-2137C5476.92,-2137 7056,-2137 7056,-2137 7056,-2137 7056,-2053.44 7056,-2053.44"/>
<polygon fill="black" stroke="black" points="7059.5,-2053.44 7056,-2043.44 7052.5,-2053.44 7059.5,-2053.44"/>
</g>
<!-- d12_input -->
<g id="node267" class="node">
<title>d12_input</title>
<ellipse fill="white" stroke="black" cx="7672" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="7672" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="7672" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7672" y="-2000.88" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- sequence_split&#45;&gt;d12_input -->
<g id="edge350" class="edge">
<title>sequence_split&#45;&gt;d12_input</title>
<path fill="none" stroke="black" d="M5104.22,-2144C5551.51,-2144 7672,-2144 7672,-2144 7672,-2144 7672,-2053.47 7672,-2053.47"/>
<polygon fill="black" stroke="black" points="7675.5,-2053.47 7672,-2043.47 7668.5,-2053.47 7675.5,-2053.47"/>
</g>
<!-- d13_input -->
<g id="node289" class="node">
<title>d13_input</title>
<ellipse fill="white" stroke="black" cx="8288" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="8288" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="8288" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8288" y="-2000.88" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- sequence_split&#45;&gt;d13_input -->
<g id="edge379" class="edge">
<title>sequence_split&#45;&gt;d13_input</title>
<path fill="none" stroke="black" d="M5101.92,-2151C5602.78,-2151 8288,-2151 8288,-2151 8288,-2151 8288,-2053.69 8288,-2053.69"/>
<polygon fill="black" stroke="black" points="8291.5,-2053.69 8288,-2043.69 8284.5,-2053.69 8291.5,-2053.69"/>
</g>
<!-- d14_input -->
<g id="node311" class="node">
<title>d14_input</title>
<ellipse fill="white" stroke="black" cx="8904" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="8904" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="8904" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8904" y="-2000.88" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- sequence_split&#45;&gt;d14_input -->
<g id="edge408" class="edge">
<title>sequence_split&#45;&gt;d14_input</title>
<path fill="none" stroke="black" d="M5094.8,-2158C5627.55,-2158 8904,-2158 8904,-2158 8904,-2158 8904,-2053.45 8904,-2053.45"/>
<polygon fill="black" stroke="black" points="8907.5,-2053.45 8904,-2043.45 8900.5,-2053.45 8907.5,-2053.45"/>
</g>
<!-- d15_input -->
<g id="node333" class="node">
<title>d15_input</title>
<ellipse fill="white" stroke="black" cx="9520" cy="-2014.38" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="9520" y="-2022.88" font-family="Arial" font-size="10.00">Local Input</text>
<text text-anchor="middle" x="9520" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9520" y="-2000.88" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- sequence_split&#45;&gt;d15_input -->
<g id="edge437" class="edge">
<title>sequence_split&#45;&gt;d15_input</title>
<path fill="none" stroke="black" d="M5076.85,-2166C5589.3,-2166 9520,-2166 9520,-2166 9520,-2166 9520,-2053.62 9520,-2053.62"/>
<polygon fill="black" stroke="black" points="9523.5,-2053.62 9520,-2043.62 9516.5,-2053.62 9523.5,-2053.62"/>
</g>
<!-- d0_ln1 -->
<g id="node4" class="node">
<title>d0_ln1</title>
<polygon fill="white" stroke="black" points="421,-1913.39 329,-1913.39 329,-1872.39 421,-1872.39 421,-1913.39"/>
<text text-anchor="middle" x="375" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="375" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="375" y="-1879.39" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_input&#45;&gt;d0_ln1 -->
<g id="edge3" class="edge">
<title>d0_input&#45;&gt;d0_ln1</title>
<path fill="none" stroke="black" d="M480.47,-1992.6C480.47,-1955.98 480.47,-1886 480.47,-1886 480.47,-1886 431.26,-1886 431.26,-1886"/>
<polygon fill="black" stroke="black" points="431.26,-1882.5 421.26,-1886 431.26,-1889.5 431.26,-1882.5"/>
</g>
<!-- d0_res1 -->
<g id="node15" class="node">
<title>d0_res1</title>
<polygon fill="white" stroke="black" points="574.26,-1314.43 422.72,-1314.43 383.74,-1232.43 535.28,-1232.43 574.26,-1314.43"/>
<text text-anchor="middle" x="479" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="479" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="479" y="-1259.93" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_input&#45;&gt;d0_res1 -->
<g id="edge17" class="edge">
<title>d0_input&#45;&gt;d0_res1</title>
<path fill="none" stroke="black" d="M558.96,-1989.73C558.96,-1989.73 558.96,-1324.83 558.96,-1324.83"/>
<polygon fill="black" stroke="black" points="562.46,-1324.83 558.96,-1314.83 555.46,-1324.83 562.46,-1324.83"/>
</g>
<!-- d0_q -->
<g id="node5" class="node">
<title>d0_q</title>
<polygon fill="lightcoral" stroke="black" points="150,-1800.39 58,-1800.39 58,-1759.39 150,-1759.39 150,-1800.39"/>
<text text-anchor="middle" x="104" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="104" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="104" y="-1766.39" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_ln1&#45;&gt;d0_q -->
<g id="edge4" class="edge">
<title>d0_ln1&#45;&gt;d0_q</title>
<path fill="none" stroke="black" d="M328.81,-1892C251.12,-1892 102.71,-1892 102.71,-1892 102.71,-1892 102.71,-1810.45 102.71,-1810.45"/>
<polygon fill="black" stroke="black" points="106.21,-1810.45 102.71,-1800.45 99.21,-1810.45 106.21,-1810.45"/>
</g>
<!-- d0_k -->
<g id="node6" class="node">
<title>d0_k</title>
<polygon fill="lightcoral" stroke="black" points="340,-1800.39 248,-1800.39 248,-1759.39 340,-1759.39 340,-1800.39"/>
<text text-anchor="middle" x="294" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="294" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="294" y="-1766.39" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_ln1&#45;&gt;d0_k -->
<g id="edge5" class="edge">
<title>d0_ln1&#45;&gt;d0_k</title>
<path fill="none" stroke="black" d="M334.5,-1872.17C334.5,-1872.17 334.5,-1810.49 334.5,-1810.49"/>
<polygon fill="black" stroke="black" points="338,-1810.49 334.5,-1800.49 331,-1810.49 338,-1810.49"/>
</g>
<!-- d0_v -->
<g id="node7" class="node">
<title>d0_v</title>
<polygon fill="lightcoral" stroke="black" points="502,-1800.39 410,-1800.39 410,-1759.39 502,-1759.39 502,-1800.39"/>
<text text-anchor="middle" x="456" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="456" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="456" y="-1766.39" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_ln1&#45;&gt;d0_v -->
<g id="edge6" class="edge">
<title>d0_ln1&#45;&gt;d0_v</title>
<path fill="none" stroke="black" d="M415.5,-1872.17C415.5,-1872.17 415.5,-1810.49 415.5,-1810.49"/>
<polygon fill="black" stroke="black" points="419,-1810.49 415.5,-1800.49 412,-1810.49 419,-1810.49"/>
</g>
<!-- d0_q_heads -->
<g id="node8" class="node">
<title>d0_q_heads</title>
<ellipse fill="white" stroke="black" cx="90" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="90" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="90" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="90" y="-1644.9" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_q&#45;&gt;d0_q_heads -->
<g id="edge7" class="edge">
<title>d0_q&#45;&gt;d0_q_heads</title>
<path fill="none" stroke="black" d="M104,-1759.28C104,-1759.28 104,-1696.87 104,-1696.87"/>
<polygon fill="black" stroke="black" points="107.5,-1696.87 104,-1686.87 100.5,-1696.87 107.5,-1696.87"/>
</g>
<!-- d0_k_heads -->
<g id="node9" class="node">
<title>d0_k_heads</title>
<ellipse fill="white" stroke="black" cx="280" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="280" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="280" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="280" y="-1644.9" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_k&#45;&gt;d0_k_heads -->
<g id="edge8" class="edge">
<title>d0_k&#45;&gt;d0_k_heads</title>
<path fill="none" stroke="black" d="M294,-1759.28C294,-1759.28 294,-1696.87 294,-1696.87"/>
<polygon fill="black" stroke="black" points="297.5,-1696.87 294,-1686.87 290.5,-1696.87 297.5,-1696.87"/>
</g>
<!-- d0_v_heads -->
<g id="node10" class="node">
<title>d0_v_heads</title>
<ellipse fill="white" stroke="black" cx="470" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="470" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="470" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="470" y="-1644.9" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_v&#45;&gt;d0_v_heads -->
<g id="edge9" class="edge">
<title>d0_v&#45;&gt;d0_v_heads</title>
<path fill="none" stroke="black" d="M456,-1759.28C456,-1759.28 456,-1696.87 456,-1696.87"/>
<polygon fill="black" stroke="black" points="459.5,-1696.87 456,-1686.87 452.5,-1696.87 459.5,-1696.87"/>
</g>
<!-- d0_ring_attn -->
<g id="node11" class="node">
<title>d0_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="333,-1557.41 241,-1557.41 241,-1516.41 333,-1516.41 333,-1557.41"/>
<text text-anchor="middle" x="287" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="287" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="287" y="-1523.41" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_q_heads&#45;&gt;d0_ring_attn -->
<g id="edge10" class="edge">
<title>d0_q_heads&#45;&gt;d0_ring_attn</title>
<path fill="none" stroke="black" d="M90,-1629.39C90,-1593.2 90,-1536 90,-1536 90,-1536 230.81,-1536 230.81,-1536"/>
<polygon fill="black" stroke="black" points="230.81,-1539.5 240.81,-1536 230.81,-1532.5 230.81,-1539.5"/>
</g>
<!-- d0_k_heads&#45;&gt;d0_ring_attn -->
<g id="edge11" class="edge">
<title>d0_k_heads&#45;&gt;d0_ring_attn</title>
<path fill="none" stroke="black" d="M287,-1629.3C287,-1629.3 287,-1567.78 287,-1567.78"/>
<polygon fill="black" stroke="black" points="290.5,-1567.78 287,-1557.78 283.5,-1567.78 290.5,-1567.78"/>
</g>
<!-- d0_v_heads&#45;&gt;d0_ring_attn -->
<g id="edge12" class="edge">
<title>d0_v_heads&#45;&gt;d0_ring_attn</title>
<path fill="none" stroke="black" d="M410.73,-1641.12C410.73,-1607.38 410.73,-1536 410.73,-1536 410.73,-1536 343.07,-1536 343.07,-1536"/>
<polygon fill="black" stroke="black" points="343.07,-1532.5 333.07,-1536 343.07,-1539.5 343.07,-1532.5"/>
</g>
<!-- d0_send_kv -->
<g id="node12" class="node">
<title>d0_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="287" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="287" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="287" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="287" y="-1401.92" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_ring_attn&#45;&gt;d0_send_kv -->
<g id="edge13" class="edge">
<title>d0_ring_attn&#45;&gt;d0_send_kv</title>
<path fill="none" stroke="black" d="M287,-1516.3C287,-1516.3 287,-1454.8 287,-1454.8"/>
<polygon fill="black" stroke="black" points="290.5,-1454.8 287,-1444.8 283.5,-1454.8 290.5,-1454.8"/>
</g>
<!-- d0_out_proj -->
<g id="node14" class="node">
<title>d0_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="517,-1435.92 425,-1435.92 425,-1394.92 517,-1394.92 517,-1435.92"/>
<text text-anchor="middle" x="471" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="471" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="471" y="-1401.92" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_ring_attn&#45;&gt;d0_out_proj -->
<g id="edge16" class="edge">
<title>d0_ring_attn&#45;&gt;d0_out_proj</title>
<path fill="none" stroke="black" d="M333.43,-1526C387.94,-1526 471,-1526 471,-1526 471,-1526 471,-1445.96 471,-1445.96"/>
<polygon fill="black" stroke="black" points="474.5,-1445.96 471,-1435.96 467.5,-1445.96 474.5,-1445.96"/>
</g>
<!-- d1_recv_kv -->
<g id="node35" class="node">
<title>d1_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="832" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="832" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="832" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="832" y="-2000.88" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d0_send_kv&#45;&gt;d1_recv_kv -->
<g id="edge14" class="edge">
<title>d0_send_kv&#45;&gt;d1_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M317.89,-1441C430.46,-1441 812.15,-1441 812.15,-1441 812.15,-1441 812.15,-1976.34 812.15,-1976.34"/>
<polygon fill="black" stroke="black" points="808.65,-1976.34 812.15,-1986.34 815.65,-1976.34 808.65,-1976.34"/>
</g>
<!-- d0_send_kv&#45;&gt;d1_recv_kv -->
<g id="edge44" class="edge">
<title>d0_send_kv&#45;&gt;d1_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M328.17,-1438C452.77,-1438 817.31,-1438 817.31,-1438 817.31,-1438 817.31,-1975.8 817.31,-1975.8"/>
<polygon fill="black" stroke="black" points="813.81,-1975.8 817.31,-1985.8 820.81,-1975.8 813.81,-1975.8"/>
</g>
<!-- d0_recv_kv -->
<g id="node13" class="node">
<title>d0_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="216" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="216" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="216" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="216" y="-2000.88" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_out_proj&#45;&gt;d0_res1 -->
<g id="edge18" class="edge">
<title>d0_out_proj&#45;&gt;d0_res1</title>
<path fill="none" stroke="black" d="M471,-1394.77C471,-1394.77 471,-1324.63 471,-1324.63"/>
<polygon fill="black" stroke="black" points="474.5,-1324.63 471,-1314.63 467.5,-1324.63 474.5,-1324.63"/>
</g>
<!-- d0_ln2 -->
<g id="node16" class="node">
<title>d0_ln2</title>
<polygon fill="white" stroke="black" points="479,-1160.43 387,-1160.43 387,-1119.43 479,-1119.43 479,-1160.43"/>
<text text-anchor="middle" x="433" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="433" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="433" y="-1126.43" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_res1&#45;&gt;d0_ln2 -->
<g id="edge19" class="edge">
<title>d0_res1&#45;&gt;d0_ln2</title>
<path fill="none" stroke="black" d="M433,-1232.28C433,-1232.28 433,-1170.62 433,-1170.62"/>
<polygon fill="black" stroke="black" points="436.5,-1170.62 433,-1160.62 429.5,-1170.62 436.5,-1170.62"/>
</g>
<!-- d0_res2 -->
<g id="node20" class="node">
<title>d0_res2</title>
<polygon fill="white" stroke="black" points="589.26,-821.43 437.72,-821.43 398.74,-739.43 550.28,-739.43 589.26,-821.43"/>
<text text-anchor="middle" x="494" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="494" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="494" y="-766.93" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_res1&#45;&gt;d0_res2 -->
<g id="edge25" class="edge">
<title>d0_res1&#45;&gt;d0_res2</title>
<path fill="none" stroke="black" d="M528.19,-1232.24C528.19,-1232.24 528.19,-831.49 528.19,-831.49"/>
<polygon fill="black" stroke="black" points="531.69,-831.49 528.19,-821.49 524.69,-831.49 531.69,-831.49"/>
</g>
<!-- d0_mlp_gate -->
<g id="node17" class="node">
<title>d0_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="341,-1047.43 243,-1047.43 243,-1006.43 341,-1006.43 341,-1047.43"/>
<text text-anchor="middle" x="292" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="292" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="292" y="-1013.43" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_ln2&#45;&gt;d0_mlp_gate -->
<g id="edge20" class="edge">
<title>d0_ln2&#45;&gt;d0_mlp_gate</title>
<path fill="none" stroke="black" d="M386.83,-1139C345.71,-1139 292,-1139 292,-1139 292,-1139 292,-1057.48 292,-1057.48"/>
<polygon fill="black" stroke="black" points="295.5,-1057.48 292,-1047.48 288.5,-1057.48 295.5,-1057.48"/>
</g>
<!-- d0_mlp_up -->
<g id="node18" class="node">
<title>d0_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="482,-1047.43 384,-1047.43 384,-1006.43 482,-1006.43 482,-1047.43"/>
<text text-anchor="middle" x="433" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="433" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="433" y="-1013.43" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_ln2&#45;&gt;d0_mlp_up -->
<g id="edge21" class="edge">
<title>d0_ln2&#45;&gt;d0_mlp_up</title>
<path fill="none" stroke="black" d="M433,-1119.2C433,-1119.2 433,-1057.52 433,-1057.52"/>
<polygon fill="black" stroke="black" points="436.5,-1057.52 433,-1047.52 429.5,-1057.52 436.5,-1057.52"/>
</g>
<!-- d0_mlp_down -->
<g id="node19" class="node">
<title>d0_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="479,-934.43 387,-934.43 387,-893.43 479,-893.43 479,-934.43"/>
<text text-anchor="middle" x="433" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="433" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="433" y="-900.43" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_mlp_gate&#45;&gt;d0_mlp_down -->
<g id="edge22" class="edge">
<title>d0_mlp_gate&#45;&gt;d0_mlp_down</title>
<path fill="none" stroke="black" d="M292,-1006.3C292,-973.46 292,-913 292,-913 292,-913 376.83,-913 376.83,-913"/>
<polygon fill="black" stroke="black" points="376.83,-916.5 386.83,-913 376.83,-909.5 376.83,-916.5"/>
</g>
<!-- d0_mlp_up&#45;&gt;d0_mlp_down -->
<g id="edge23" class="edge">
<title>d0_mlp_up&#45;&gt;d0_mlp_down</title>
<path fill="none" stroke="black" d="M433,-1006.2C433,-1006.2 433,-944.52 433,-944.52"/>
<polygon fill="black" stroke="black" points="436.5,-944.52 433,-934.52 429.5,-944.52 436.5,-944.52"/>
</g>
<!-- d0_mlp_down&#45;&gt;d0_res2 -->
<g id="edge24" class="edge">
<title>d0_mlp_down&#45;&gt;d0_res2</title>
<path fill="none" stroke="black" d="M438.81,-893.36C438.81,-893.36 438.81,-831.48 438.81,-831.48"/>
<polygon fill="black" stroke="black" points="442.31,-831.48 438.81,-821.48 435.31,-831.48 442.31,-831.48"/>
</g>
<!-- d0_layer1 -->
<g id="node21" class="node">
<title>d0_layer1</title>
<polygon fill="lightgray" stroke="black" points="540,-667.43 448,-667.43 448,-626.43 540,-626.43 540,-667.43"/>
<text text-anchor="middle" x="494" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="494" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="494" y="-633.43" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_res2&#45;&gt;d0_layer1 -->
<g id="edge26" class="edge">
<title>d0_res2&#45;&gt;d0_layer1</title>
<path fill="none" stroke="black" d="M494,-739.28C494,-739.28 494,-677.62 494,-677.62"/>
<polygon fill="black" stroke="black" points="497.5,-677.62 494,-667.62 490.5,-677.62 497.5,-677.62"/>
</g>
<!-- d0_layer2 -->
<g id="node22" class="node">
<title>d0_layer2</title>
<polygon fill="lightgray" stroke="black" points="540,-554.43 448,-554.43 448,-513.43 540,-513.43 540,-554.43"/>
<text text-anchor="middle" x="494" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="494" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="494" y="-520.43" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_layer1&#45;&gt;d0_layer2 -->
<g id="edge27" class="edge">
<title>d0_layer1&#45;&gt;d0_layer2</title>
<path fill="none" stroke="black" d="M494,-626.2C494,-626.2 494,-564.52 494,-564.52"/>
<polygon fill="black" stroke="black" points="497.5,-564.52 494,-554.52 490.5,-564.52 497.5,-564.52"/>
</g>
<!-- d0_layer3 -->
<g id="node23" class="node">
<title>d0_layer3</title>
<polygon fill="lightgray" stroke="black" points="540,-441.43 448,-441.43 448,-400.43 540,-400.43 540,-441.43"/>
<text text-anchor="middle" x="494" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="494" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="494" y="-407.43" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_layer2&#45;&gt;d0_layer3 -->
<g id="edge28" class="edge">
<title>d0_layer2&#45;&gt;d0_layer3</title>
<path fill="none" stroke="black" d="M494,-513.2C494,-513.2 494,-451.52 494,-451.52"/>
<polygon fill="black" stroke="black" points="497.5,-451.52 494,-441.52 490.5,-451.52 497.5,-451.52"/>
</g>
<!-- d0_output -->
<g id="node24" class="node">
<title>d0_output</title>
<polygon fill="white" stroke="black" points="589.26,-328.43 437.72,-328.43 398.74,-246.43 550.28,-246.43 589.26,-328.43"/>
<text text-anchor="middle" x="494" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="494" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="494" y="-273.93" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- d0_layer3&#45;&gt;d0_output -->
<g id="edge29" class="edge">
<title>d0_layer3&#45;&gt;d0_output</title>
<path fill="none" stroke="black" d="M494,-400.36C494,-400.36 494,-338.48 494,-338.48"/>
<polygon fill="black" stroke="black" points="497.5,-338.48 494,-328.48 490.5,-338.48 497.5,-338.48"/>
</g>
<!-- sequence_agg -->
<g id="node355" class="node">
<title>sequence_agg</title>
<ellipse fill="white" stroke="black" cx="4934" cy="-153.21" rx="80.72" ry="21.43"/>
<text text-anchor="middle" x="4934" y="-156.21" font-family="Arial" font-size="10.00">Sequence Aggregation</text>
<text text-anchor="middle" x="4934" y="-145.21" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- d0_output&#45;&gt;sequence_agg -->
<g id="edge30" class="edge">
<title>d0_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M494,-246.32C494,-201.78 494,-137 494,-137 494,-137 4871.83,-137 4871.83,-137"/>
<polygon fill="black" stroke="black" points="4871.83,-140.5 4881.83,-137 4871.83,-133.5 4871.83,-140.5"/>
</g>
<!-- d1_ln1 -->
<g id="node26" class="node">
<title>d1_ln1</title>
<polygon fill="white" stroke="black" points="1050,-1913.39 958,-1913.39 958,-1872.39 1050,-1872.39 1050,-1913.39"/>
<text text-anchor="middle" x="1004" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1004" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1004" y="-1879.39" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_input&#45;&gt;d1_ln1 -->
<g id="edge32" class="edge">
<title>d1_input&#45;&gt;d1_ln1</title>
<path fill="none" stroke="black" d="M1096.47,-1992.6C1096.47,-1955.98 1096.47,-1886 1096.47,-1886 1096.47,-1886 1060.24,-1886 1060.24,-1886"/>
<polygon fill="black" stroke="black" points="1060.24,-1882.5 1050.24,-1886 1060.24,-1889.5 1060.24,-1882.5"/>
</g>
<!-- d1_res1 -->
<g id="node37" class="node">
<title>d1_res1</title>
<polygon fill="white" stroke="black" points="1175.26,-1314.43 1023.72,-1314.43 984.74,-1232.43 1136.28,-1232.43 1175.26,-1314.43"/>
<text text-anchor="middle" x="1080" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1080" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1080" y="-1259.93" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_input&#45;&gt;d1_res1 -->
<g id="edge46" class="edge">
<title>d1_input&#45;&gt;d1_res1</title>
<path fill="none" stroke="black" d="M1167.46,-1988.01C1167.46,-1988.01 1167.46,-1324.48 1167.46,-1324.48"/>
<polygon fill="black" stroke="black" points="1170.96,-1324.48 1167.46,-1314.48 1163.96,-1324.48 1170.96,-1324.48"/>
</g>
<!-- d1_q -->
<g id="node27" class="node">
<title>d1_q</title>
<polygon fill="lightcoral" stroke="black" points="807,-1800.39 715,-1800.39 715,-1759.39 807,-1759.39 807,-1800.39"/>
<text text-anchor="middle" x="761" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="761" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="761" y="-1766.39" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_ln1&#45;&gt;d1_q -->
<g id="edge33" class="edge">
<title>d1_ln1&#45;&gt;d1_q</title>
<path fill="none" stroke="black" d="M957.87,-1899C893.67,-1899 785.21,-1899 785.21,-1899 785.21,-1899 785.21,-1810.64 785.21,-1810.64"/>
<polygon fill="black" stroke="black" points="788.71,-1810.64 785.21,-1800.64 781.71,-1810.64 788.71,-1810.64"/>
</g>
<!-- d1_k -->
<g id="node28" class="node">
<title>d1_k</title>
<polygon fill="lightcoral" stroke="black" points="969,-1800.39 877,-1800.39 877,-1759.39 969,-1759.39 969,-1800.39"/>
<text text-anchor="middle" x="923" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="923" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="923" y="-1766.39" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_ln1&#45;&gt;d1_k -->
<g id="edge34" class="edge">
<title>d1_ln1&#45;&gt;d1_k</title>
<path fill="none" stroke="black" d="M963.5,-1872.17C963.5,-1872.17 963.5,-1810.49 963.5,-1810.49"/>
<polygon fill="black" stroke="black" points="967,-1810.49 963.5,-1800.49 960,-1810.49 967,-1810.49"/>
</g>
<!-- d1_v -->
<g id="node29" class="node">
<title>d1_v</title>
<polygon fill="lightcoral" stroke="black" points="1118,-1800.39 1026,-1800.39 1026,-1759.39 1118,-1759.39 1118,-1800.39"/>
<text text-anchor="middle" x="1072" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="1072" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1072" y="-1766.39" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_ln1&#45;&gt;d1_v -->
<g id="edge35" class="edge">
<title>d1_ln1&#45;&gt;d1_v</title>
<path fill="none" stroke="black" d="M1038,-1872.17C1038,-1872.17 1038,-1810.49 1038,-1810.49"/>
<polygon fill="black" stroke="black" points="1041.5,-1810.49 1038,-1800.49 1034.5,-1810.49 1041.5,-1810.49"/>
</g>
<!-- d1_q_heads -->
<g id="node30" class="node">
<title>d1_q_heads</title>
<ellipse fill="white" stroke="black" cx="706" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="706" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="706" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="706" y="-1644.9" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_q&#45;&gt;d1_q_heads -->
<g id="edge36" class="edge">
<title>d1_q&#45;&gt;d1_q_heads</title>
<path fill="none" stroke="black" d="M747.27,-1759.28C747.27,-1759.28 747.27,-1692.46 747.27,-1692.46"/>
<polygon fill="black" stroke="black" points="750.77,-1692.46 747.27,-1682.46 743.77,-1692.46 750.77,-1692.46"/>
</g>
<!-- d1_k_heads -->
<g id="node31" class="node">
<title>d1_k_heads</title>
<ellipse fill="white" stroke="black" cx="896" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="896" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="896" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="896" y="-1644.9" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_k&#45;&gt;d1_k_heads -->
<g id="edge37" class="edge">
<title>d1_k&#45;&gt;d1_k_heads</title>
<path fill="none" stroke="black" d="M923,-1759.28C923,-1759.28 923,-1695.52 923,-1695.52"/>
<polygon fill="black" stroke="black" points="926.5,-1695.52 923,-1685.52 919.5,-1695.52 926.5,-1695.52"/>
</g>
<!-- d1_v_heads -->
<g id="node32" class="node">
<title>d1_v_heads</title>
<ellipse fill="white" stroke="black" cx="1086" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="1086" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="1086" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1086" y="-1644.9" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_v&#45;&gt;d1_v_heads -->
<g id="edge38" class="edge">
<title>d1_v&#45;&gt;d1_v_heads</title>
<path fill="none" stroke="black" d="M1072,-1759.28C1072,-1759.28 1072,-1696.87 1072,-1696.87"/>
<polygon fill="black" stroke="black" points="1075.5,-1696.87 1072,-1686.87 1068.5,-1696.87 1075.5,-1696.87"/>
</g>
<!-- d1_ring_attn -->
<g id="node33" class="node">
<title>d1_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="949,-1557.41 857,-1557.41 857,-1516.41 949,-1516.41 949,-1557.41"/>
<text text-anchor="middle" x="903" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="903" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="903" y="-1523.41" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_q_heads&#45;&gt;d1_ring_attn -->
<g id="edge39" class="edge">
<title>d1_q_heads&#45;&gt;d1_ring_attn</title>
<path fill="none" stroke="black" d="M706,-1629.13C706,-1596.13 706,-1547 706,-1547 706,-1547 846.81,-1547 846.81,-1547"/>
<polygon fill="black" stroke="black" points="846.81,-1550.5 856.81,-1547 846.81,-1543.5 846.81,-1550.5"/>
</g>
<!-- d1_k_heads&#45;&gt;d1_ring_attn -->
<g id="edge40" class="edge">
<title>d1_k_heads&#45;&gt;d1_ring_attn</title>
<path fill="none" stroke="black" d="M903,-1629.3C903,-1629.3 903,-1567.78 903,-1567.78"/>
<polygon fill="black" stroke="black" points="906.5,-1567.78 903,-1557.78 899.5,-1567.78 906.5,-1567.78"/>
</g>
<!-- d1_v_heads&#45;&gt;d1_ring_attn -->
<g id="edge41" class="edge">
<title>d1_v_heads&#45;&gt;d1_ring_attn</title>
<path fill="none" stroke="black" d="M1049.67,-1633.04C1049.67,-1597.19 1049.67,-1536 1049.67,-1536 1049.67,-1536 959,-1536 959,-1536"/>
<polygon fill="black" stroke="black" points="959,-1532.5 949,-1536 959,-1539.5 959,-1532.5"/>
</g>
<!-- d1_send_kv -->
<g id="node34" class="node">
<title>d1_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="903" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="903" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="903" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="903" y="-1401.92" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_ring_attn&#45;&gt;d1_send_kv -->
<g id="edge42" class="edge">
<title>d1_ring_attn&#45;&gt;d1_send_kv</title>
<path fill="none" stroke="black" d="M903,-1516.3C903,-1516.3 903,-1454.8 903,-1454.8"/>
<polygon fill="black" stroke="black" points="906.5,-1454.8 903,-1444.8 899.5,-1454.8 906.5,-1454.8"/>
</g>
<!-- d1_out_proj -->
<g id="node36" class="node">
<title>d1_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="1111,-1435.92 1019,-1435.92 1019,-1394.92 1111,-1394.92 1111,-1435.92"/>
<text text-anchor="middle" x="1065" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="1065" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1065" y="-1401.92" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_ring_attn&#45;&gt;d1_out_proj -->
<g id="edge45" class="edge">
<title>d1_ring_attn&#45;&gt;d1_out_proj</title>
<path fill="none" stroke="black" d="M949.13,-1526C1001.67,-1526 1080.33,-1526 1080.33,-1526 1080.33,-1526 1080.33,-1445.96 1080.33,-1445.96"/>
<polygon fill="black" stroke="black" points="1083.83,-1445.96 1080.33,-1435.96 1076.83,-1445.96 1083.83,-1445.96"/>
</g>
<!-- d2_recv_kv -->
<g id="node57" class="node">
<title>d2_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1448" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="1448" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="1448" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1448" y="-2000.88" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d1_send_kv&#45;&gt;d2_recv_kv -->
<g id="edge43" class="edge">
<title>d1_send_kv&#45;&gt;d2_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M933.82,-1441C1044.34,-1441 1414.15,-1441 1414.15,-1441 1414.15,-1441 1414.15,-1979.01 1414.15,-1979.01"/>
<polygon fill="black" stroke="black" points="1410.65,-1979.01 1414.15,-1989.01 1417.65,-1979.01 1410.65,-1979.01"/>
</g>
<!-- d1_send_kv&#45;&gt;d2_recv_kv -->
<g id="edge73" class="edge">
<title>d1_send_kv&#45;&gt;d2_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M944.06,-1438C1067.43,-1438 1426.31,-1438 1426.31,-1438 1426.31,-1438 1426.31,-1976.58 1426.31,-1976.58"/>
<polygon fill="black" stroke="black" points="1422.81,-1976.58 1426.31,-1986.58 1429.81,-1976.58 1422.81,-1976.58"/>
</g>
<!-- d1_out_proj&#45;&gt;d1_res1 -->
<g id="edge47" class="edge">
<title>d1_out_proj&#45;&gt;d1_res1</title>
<path fill="none" stroke="black" d="M1065,-1394.77C1065,-1394.77 1065,-1324.63 1065,-1324.63"/>
<polygon fill="black" stroke="black" points="1068.5,-1324.63 1065,-1314.63 1061.5,-1324.63 1068.5,-1324.63"/>
</g>
<!-- d1_ln2 -->
<g id="node38" class="node">
<title>d1_ln2</title>
<polygon fill="white" stroke="black" points="1095,-1160.43 1003,-1160.43 1003,-1119.43 1095,-1119.43 1095,-1160.43"/>
<text text-anchor="middle" x="1049" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1049" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1049" y="-1126.43" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_res1&#45;&gt;d1_ln2 -->
<g id="edge48" class="edge">
<title>d1_res1&#45;&gt;d1_ln2</title>
<path fill="none" stroke="black" d="M1049,-1232.28C1049,-1232.28 1049,-1170.62 1049,-1170.62"/>
<polygon fill="black" stroke="black" points="1052.5,-1170.62 1049,-1160.62 1045.5,-1170.62 1052.5,-1170.62"/>
</g>
<!-- d1_res2 -->
<g id="node42" class="node">
<title>d1_res2</title>
<polygon fill="white" stroke="black" points="1205.26,-821.43 1053.72,-821.43 1014.74,-739.43 1166.28,-739.43 1205.26,-821.43"/>
<text text-anchor="middle" x="1110" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1110" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1110" y="-766.93" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_res1&#45;&gt;d1_res2 -->
<g id="edge54" class="edge">
<title>d1_res1&#45;&gt;d1_res2</title>
<path fill="none" stroke="black" d="M1136.69,-1233.08C1136.69,-1233.08 1136.69,-831.68 1136.69,-831.68"/>
<polygon fill="black" stroke="black" points="1140.19,-831.68 1136.69,-821.68 1133.19,-831.68 1140.19,-831.68"/>
</g>
<!-- d1_mlp_gate -->
<g id="node39" class="node">
<title>d1_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="957,-1047.43 859,-1047.43 859,-1006.43 957,-1006.43 957,-1047.43"/>
<text text-anchor="middle" x="908" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="908" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="908" y="-1013.43" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_ln2&#45;&gt;d1_mlp_gate -->
<g id="edge49" class="edge">
<title>d1_ln2&#45;&gt;d1_mlp_gate</title>
<path fill="none" stroke="black" d="M1002.83,-1139C961.71,-1139 908,-1139 908,-1139 908,-1139 908,-1057.48 908,-1057.48"/>
<polygon fill="black" stroke="black" points="911.5,-1057.48 908,-1047.48 904.5,-1057.48 911.5,-1057.48"/>
</g>
<!-- d1_mlp_up -->
<g id="node40" class="node">
<title>d1_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="1098,-1047.43 1000,-1047.43 1000,-1006.43 1098,-1006.43 1098,-1047.43"/>
<text text-anchor="middle" x="1049" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="1049" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="1049" y="-1013.43" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_ln2&#45;&gt;d1_mlp_up -->
<g id="edge50" class="edge">
<title>d1_ln2&#45;&gt;d1_mlp_up</title>
<path fill="none" stroke="black" d="M1049,-1119.2C1049,-1119.2 1049,-1057.52 1049,-1057.52"/>
<polygon fill="black" stroke="black" points="1052.5,-1057.52 1049,-1047.52 1045.5,-1057.52 1052.5,-1057.52"/>
</g>
<!-- d1_mlp_down -->
<g id="node41" class="node">
<title>d1_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="1095,-934.43 1003,-934.43 1003,-893.43 1095,-893.43 1095,-934.43"/>
<text text-anchor="middle" x="1049" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="1049" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1049" y="-900.43" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_mlp_gate&#45;&gt;d1_mlp_down -->
<g id="edge51" class="edge">
<title>d1_mlp_gate&#45;&gt;d1_mlp_down</title>
<path fill="none" stroke="black" d="M908,-1006.3C908,-973.46 908,-913 908,-913 908,-913 992.83,-913 992.83,-913"/>
<polygon fill="black" stroke="black" points="992.83,-916.5 1002.83,-913 992.83,-909.5 992.83,-916.5"/>
</g>
<!-- d1_mlp_up&#45;&gt;d1_mlp_down -->
<g id="edge52" class="edge">
<title>d1_mlp_up&#45;&gt;d1_mlp_down</title>
<path fill="none" stroke="black" d="M1049,-1006.2C1049,-1006.2 1049,-944.52 1049,-944.52"/>
<polygon fill="black" stroke="black" points="1052.5,-944.52 1049,-934.52 1045.5,-944.52 1052.5,-944.52"/>
</g>
<!-- d1_mlp_down&#45;&gt;d1_res2 -->
<g id="edge53" class="edge">
<title>d1_mlp_down&#45;&gt;d1_res2</title>
<path fill="none" stroke="black" d="M1054.81,-893.36C1054.81,-893.36 1054.81,-831.48 1054.81,-831.48"/>
<polygon fill="black" stroke="black" points="1058.31,-831.48 1054.81,-821.48 1051.31,-831.48 1058.31,-831.48"/>
</g>
<!-- d1_layer1 -->
<g id="node43" class="node">
<title>d1_layer1</title>
<polygon fill="lightgray" stroke="black" points="1156,-667.43 1064,-667.43 1064,-626.43 1156,-626.43 1156,-667.43"/>
<text text-anchor="middle" x="1110" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="1110" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1110" y="-633.43" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_res2&#45;&gt;d1_layer1 -->
<g id="edge55" class="edge">
<title>d1_res2&#45;&gt;d1_layer1</title>
<path fill="none" stroke="black" d="M1110,-739.28C1110,-739.28 1110,-677.62 1110,-677.62"/>
<polygon fill="black" stroke="black" points="1113.5,-677.62 1110,-667.62 1106.5,-677.62 1113.5,-677.62"/>
</g>
<!-- d1_layer2 -->
<g id="node44" class="node">
<title>d1_layer2</title>
<polygon fill="lightgray" stroke="black" points="1156,-554.43 1064,-554.43 1064,-513.43 1156,-513.43 1156,-554.43"/>
<text text-anchor="middle" x="1110" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1110" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1110" y="-520.43" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_layer1&#45;&gt;d1_layer2 -->
<g id="edge56" class="edge">
<title>d1_layer1&#45;&gt;d1_layer2</title>
<path fill="none" stroke="black" d="M1110,-626.2C1110,-626.2 1110,-564.52 1110,-564.52"/>
<polygon fill="black" stroke="black" points="1113.5,-564.52 1110,-554.52 1106.5,-564.52 1113.5,-564.52"/>
</g>
<!-- d1_layer3 -->
<g id="node45" class="node">
<title>d1_layer3</title>
<polygon fill="lightgray" stroke="black" points="1156,-441.43 1064,-441.43 1064,-400.43 1156,-400.43 1156,-441.43"/>
<text text-anchor="middle" x="1110" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1110" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1110" y="-407.43" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_layer2&#45;&gt;d1_layer3 -->
<g id="edge57" class="edge">
<title>d1_layer2&#45;&gt;d1_layer3</title>
<path fill="none" stroke="black" d="M1110,-513.2C1110,-513.2 1110,-451.52 1110,-451.52"/>
<polygon fill="black" stroke="black" points="1113.5,-451.52 1110,-441.52 1106.5,-451.52 1113.5,-451.52"/>
</g>
<!-- d1_output -->
<g id="node46" class="node">
<title>d1_output</title>
<polygon fill="white" stroke="black" points="1205.26,-328.43 1053.72,-328.43 1014.74,-246.43 1166.28,-246.43 1205.26,-328.43"/>
<text text-anchor="middle" x="1110" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="1110" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1110" y="-273.93" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- d1_layer3&#45;&gt;d1_output -->
<g id="edge58" class="edge">
<title>d1_layer3&#45;&gt;d1_output</title>
<path fill="none" stroke="black" d="M1110,-400.36C1110,-400.36 1110,-338.48 1110,-338.48"/>
<polygon fill="black" stroke="black" points="1113.5,-338.48 1110,-328.48 1106.5,-338.48 1113.5,-338.48"/>
</g>
<!-- d1_output&#45;&gt;sequence_agg -->
<g id="edge59" class="edge">
<title>d1_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M1110,-246.14C1110,-203.15 1110,-142 1110,-142 1110,-142 4855.19,-142 4855.19,-142"/>
<polygon fill="black" stroke="black" points="4855.19,-145.5 4865.19,-142 4855.19,-138.5 4855.19,-145.5"/>
</g>
<!-- d2_ln1 -->
<g id="node48" class="node">
<title>d2_ln1</title>
<polygon fill="white" stroke="black" points="1653,-1913.39 1561,-1913.39 1561,-1872.39 1653,-1872.39 1653,-1913.39"/>
<text text-anchor="middle" x="1607" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1607" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1607" y="-1879.39" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_input&#45;&gt;d2_ln1 -->
<g id="edge61" class="edge">
<title>d2_input&#45;&gt;d2_ln1</title>
<path fill="none" stroke="black" d="M1712.47,-1992.6C1712.47,-1955.98 1712.47,-1886 1712.47,-1886 1712.47,-1886 1663.26,-1886 1663.26,-1886"/>
<polygon fill="black" stroke="black" points="1663.26,-1882.5 1653.26,-1886 1663.26,-1889.5 1663.26,-1882.5"/>
</g>
<!-- d2_res1 -->
<g id="node59" class="node">
<title>d2_res1</title>
<polygon fill="white" stroke="black" points="1806.26,-1314.43 1654.72,-1314.43 1615.74,-1232.43 1767.28,-1232.43 1806.26,-1314.43"/>
<text text-anchor="middle" x="1711" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1711" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1711" y="-1259.93" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_input&#45;&gt;d2_res1 -->
<g id="edge75" class="edge">
<title>d2_input&#45;&gt;d2_res1</title>
<path fill="none" stroke="black" d="M1790.96,-1989.73C1790.96,-1989.73 1790.96,-1324.83 1790.96,-1324.83"/>
<polygon fill="black" stroke="black" points="1794.46,-1324.83 1790.96,-1314.83 1787.46,-1324.83 1794.46,-1324.83"/>
</g>
<!-- d2_q -->
<g id="node49" class="node">
<title>d2_q</title>
<polygon fill="lightcoral" stroke="black" points="1402,-1800.39 1310,-1800.39 1310,-1759.39 1402,-1759.39 1402,-1800.39"/>
<text text-anchor="middle" x="1356" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="1356" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1356" y="-1766.39" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_ln1&#45;&gt;d2_q -->
<g id="edge62" class="edge">
<title>d2_ln1&#45;&gt;d2_q</title>
<path fill="none" stroke="black" d="M1560.86,-1899C1497.34,-1899 1390.71,-1899 1390.71,-1899 1390.71,-1899 1390.71,-1810.64 1390.71,-1810.64"/>
<polygon fill="black" stroke="black" points="1394.21,-1810.64 1390.71,-1800.64 1387.21,-1810.64 1394.21,-1810.64"/>
</g>
<!-- d2_k -->
<g id="node50" class="node">
<title>d2_k</title>
<polygon fill="lightcoral" stroke="black" points="1572,-1800.39 1480,-1800.39 1480,-1759.39 1572,-1759.39 1572,-1800.39"/>
<text text-anchor="middle" x="1526" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="1526" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1526" y="-1766.39" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_ln1&#45;&gt;d2_k -->
<g id="edge63" class="edge">
<title>d2_ln1&#45;&gt;d2_k</title>
<path fill="none" stroke="black" d="M1566.5,-1872.17C1566.5,-1872.17 1566.5,-1810.49 1566.5,-1810.49"/>
<polygon fill="black" stroke="black" points="1570,-1810.49 1566.5,-1800.49 1563,-1810.49 1570,-1810.49"/>
</g>
<!-- d2_v -->
<g id="node51" class="node">
<title>d2_v</title>
<polygon fill="lightcoral" stroke="black" points="1734,-1800.39 1642,-1800.39 1642,-1759.39 1734,-1759.39 1734,-1800.39"/>
<text text-anchor="middle" x="1688" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="1688" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1688" y="-1766.39" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_ln1&#45;&gt;d2_v -->
<g id="edge64" class="edge">
<title>d2_ln1&#45;&gt;d2_v</title>
<path fill="none" stroke="black" d="M1647.5,-1872.17C1647.5,-1872.17 1647.5,-1810.49 1647.5,-1810.49"/>
<polygon fill="black" stroke="black" points="1651,-1810.49 1647.5,-1800.49 1644,-1810.49 1651,-1810.49"/>
</g>
<!-- d2_q_heads -->
<g id="node52" class="node">
<title>d2_q_heads</title>
<ellipse fill="white" stroke="black" cx="1322" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="1322" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="1322" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1322" y="-1644.9" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_q&#45;&gt;d2_q_heads -->
<g id="edge65" class="edge">
<title>d2_q&#45;&gt;d2_q_heads</title>
<path fill="none" stroke="black" d="M1352.77,-1759.28C1352.77,-1759.28 1352.77,-1695.07 1352.77,-1695.07"/>
<polygon fill="black" stroke="black" points="1356.27,-1695.07 1352.77,-1685.07 1349.27,-1695.07 1356.27,-1695.07"/>
</g>
<!-- d2_k_heads -->
<g id="node53" class="node">
<title>d2_k_heads</title>
<ellipse fill="white" stroke="black" cx="1512" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="1512" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="1512" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1512" y="-1644.9" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_k&#45;&gt;d2_k_heads -->
<g id="edge66" class="edge">
<title>d2_k&#45;&gt;d2_k_heads</title>
<path fill="none" stroke="black" d="M1526,-1759.28C1526,-1759.28 1526,-1696.87 1526,-1696.87"/>
<polygon fill="black" stroke="black" points="1529.5,-1696.87 1526,-1686.87 1522.5,-1696.87 1529.5,-1696.87"/>
</g>
<!-- d2_v_heads -->
<g id="node54" class="node">
<title>d2_v_heads</title>
<ellipse fill="white" stroke="black" cx="1702" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="1702" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="1702" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1702" y="-1644.9" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_v&#45;&gt;d2_v_heads -->
<g id="edge67" class="edge">
<title>d2_v&#45;&gt;d2_v_heads</title>
<path fill="none" stroke="black" d="M1688,-1759.28C1688,-1759.28 1688,-1696.87 1688,-1696.87"/>
<polygon fill="black" stroke="black" points="1691.5,-1696.87 1688,-1686.87 1684.5,-1696.87 1691.5,-1696.87"/>
</g>
<!-- d2_ring_attn -->
<g id="node55" class="node">
<title>d2_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="1565,-1557.41 1473,-1557.41 1473,-1516.41 1565,-1516.41 1565,-1557.41"/>
<text text-anchor="middle" x="1519" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="1519" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1519" y="-1523.41" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_q_heads&#45;&gt;d2_ring_attn -->
<g id="edge68" class="edge">
<title>d2_q_heads&#45;&gt;d2_ring_attn</title>
<path fill="none" stroke="black" d="M1322,-1629.13C1322,-1596.13 1322,-1547 1322,-1547 1322,-1547 1462.81,-1547 1462.81,-1547"/>
<polygon fill="black" stroke="black" points="1462.81,-1550.5 1472.81,-1547 1462.81,-1543.5 1462.81,-1550.5"/>
</g>
<!-- d2_k_heads&#45;&gt;d2_ring_attn -->
<g id="edge69" class="edge">
<title>d2_k_heads&#45;&gt;d2_ring_attn</title>
<path fill="none" stroke="black" d="M1519,-1629.3C1519,-1629.3 1519,-1567.78 1519,-1567.78"/>
<polygon fill="black" stroke="black" points="1522.5,-1567.78 1519,-1557.78 1515.5,-1567.78 1522.5,-1567.78"/>
</g>
<!-- d2_v_heads&#45;&gt;d2_ring_attn -->
<g id="edge70" class="edge">
<title>d2_v_heads&#45;&gt;d2_ring_attn</title>
<path fill="none" stroke="black" d="M1642.73,-1641.12C1642.73,-1607.38 1642.73,-1536 1642.73,-1536 1642.73,-1536 1575.07,-1536 1575.07,-1536"/>
<polygon fill="black" stroke="black" points="1575.07,-1532.5 1565.07,-1536 1575.07,-1539.5 1575.07,-1532.5"/>
</g>
<!-- d2_send_kv -->
<g id="node56" class="node">
<title>d2_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1519" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="1519" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="1519" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1519" y="-1401.92" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_ring_attn&#45;&gt;d2_send_kv -->
<g id="edge71" class="edge">
<title>d2_ring_attn&#45;&gt;d2_send_kv</title>
<path fill="none" stroke="black" d="M1519,-1516.3C1519,-1516.3 1519,-1454.8 1519,-1454.8"/>
<polygon fill="black" stroke="black" points="1522.5,-1454.8 1519,-1444.8 1515.5,-1454.8 1522.5,-1454.8"/>
</g>
<!-- d2_out_proj -->
<g id="node58" class="node">
<title>d2_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="1749,-1435.92 1657,-1435.92 1657,-1394.92 1749,-1394.92 1749,-1435.92"/>
<text text-anchor="middle" x="1703" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="1703" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1703" y="-1401.92" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_ring_attn&#45;&gt;d2_out_proj -->
<g id="edge74" class="edge">
<title>d2_ring_attn&#45;&gt;d2_out_proj</title>
<path fill="none" stroke="black" d="M1565.43,-1526C1619.94,-1526 1703,-1526 1703,-1526 1703,-1526 1703,-1445.96 1703,-1445.96"/>
<polygon fill="black" stroke="black" points="1706.5,-1445.96 1703,-1435.96 1699.5,-1445.96 1706.5,-1445.96"/>
</g>
<!-- d3_recv_kv -->
<g id="node79" class="node">
<title>d3_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2064" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="2064" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="2064" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2064" y="-2000.88" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d2_send_kv&#45;&gt;d3_recv_kv -->
<g id="edge72" class="edge">
<title>d2_send_kv&#45;&gt;d3_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1549.76,-1441C1660.95,-1441 2035.49,-1441 2035.49,-1441 2035.49,-1441 2035.49,-1977.88 2035.49,-1977.88"/>
<polygon fill="black" stroke="black" points="2031.99,-1977.88 2035.49,-1987.88 2038.99,-1977.88 2031.99,-1977.88"/>
</g>
<!-- d2_send_kv&#45;&gt;d3_recv_kv -->
<g id="edge102" class="edge">
<title>d2_send_kv&#45;&gt;d3_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1559.83,-1438C1683.41,-1438 2044.97,-1438 2044.97,-1438 2044.97,-1438 2044.97,-1976.19 2044.97,-1976.19"/>
<polygon fill="black" stroke="black" points="2041.47,-1976.19 2044.97,-1986.19 2048.47,-1976.19 2041.47,-1976.19"/>
</g>
<!-- d2_out_proj&#45;&gt;d2_res1 -->
<g id="edge76" class="edge">
<title>d2_out_proj&#45;&gt;d2_res1</title>
<path fill="none" stroke="black" d="M1703,-1394.77C1703,-1394.77 1703,-1324.63 1703,-1324.63"/>
<polygon fill="black" stroke="black" points="1706.5,-1324.63 1703,-1314.63 1699.5,-1324.63 1706.5,-1324.63"/>
</g>
<!-- d2_ln2 -->
<g id="node60" class="node">
<title>d2_ln2</title>
<polygon fill="white" stroke="black" points="1725,-1160.43 1633,-1160.43 1633,-1119.43 1725,-1119.43 1725,-1160.43"/>
<text text-anchor="middle" x="1679" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1679" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1679" y="-1126.43" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_res1&#45;&gt;d2_ln2 -->
<g id="edge77" class="edge">
<title>d2_res1&#45;&gt;d2_ln2</title>
<path fill="none" stroke="black" d="M1679,-1232.28C1679,-1232.28 1679,-1170.62 1679,-1170.62"/>
<polygon fill="black" stroke="black" points="1682.5,-1170.62 1679,-1160.62 1675.5,-1170.62 1682.5,-1170.62"/>
</g>
<!-- d2_res2 -->
<g id="node64" class="node">
<title>d2_res2</title>
<polygon fill="white" stroke="black" points="1821.26,-821.43 1669.72,-821.43 1630.74,-739.43 1782.28,-739.43 1821.26,-821.43"/>
<text text-anchor="middle" x="1726" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1726" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1726" y="-766.93" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_res1&#45;&gt;d2_res2 -->
<g id="edge83" class="edge">
<title>d2_res1&#45;&gt;d2_res2</title>
<path fill="none" stroke="black" d="M1767.19,-1232.24C1767.19,-1232.24 1767.19,-831.49 1767.19,-831.49"/>
<polygon fill="black" stroke="black" points="1770.69,-831.49 1767.19,-821.49 1763.69,-831.49 1770.69,-831.49"/>
</g>
<!-- d2_mlp_gate -->
<g id="node61" class="node">
<title>d2_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="1587,-1047.43 1489,-1047.43 1489,-1006.43 1587,-1006.43 1587,-1047.43"/>
<text text-anchor="middle" x="1538" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="1538" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="1538" y="-1013.43" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_ln2&#45;&gt;d2_mlp_gate -->
<g id="edge78" class="edge">
<title>d2_ln2&#45;&gt;d2_mlp_gate</title>
<path fill="none" stroke="black" d="M1632.74,-1139C1591.14,-1139 1536.53,-1139 1536.53,-1139 1536.53,-1139 1536.53,-1057.48 1536.53,-1057.48"/>
<polygon fill="black" stroke="black" points="1540.03,-1057.48 1536.53,-1047.48 1533.03,-1057.48 1540.03,-1057.48"/>
</g>
<!-- d2_mlp_up -->
<g id="node62" class="node">
<title>d2_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="1728,-1047.43 1630,-1047.43 1630,-1006.43 1728,-1006.43 1728,-1047.43"/>
<text text-anchor="middle" x="1679" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="1679" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="1679" y="-1013.43" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_ln2&#45;&gt;d2_mlp_up -->
<g id="edge79" class="edge">
<title>d2_ln2&#45;&gt;d2_mlp_up</title>
<path fill="none" stroke="black" d="M1679,-1119.2C1679,-1119.2 1679,-1057.52 1679,-1057.52"/>
<polygon fill="black" stroke="black" points="1682.5,-1057.52 1679,-1047.52 1675.5,-1057.52 1682.5,-1057.52"/>
</g>
<!-- d2_mlp_down -->
<g id="node63" class="node">
<title>d2_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="1725,-934.43 1633,-934.43 1633,-893.43 1725,-893.43 1725,-934.43"/>
<text text-anchor="middle" x="1679" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="1679" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1679" y="-900.43" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_mlp_gate&#45;&gt;d2_mlp_down -->
<g id="edge80" class="edge">
<title>d2_mlp_gate&#45;&gt;d2_mlp_down</title>
<path fill="none" stroke="black" d="M1538,-1006.3C1538,-973.46 1538,-913 1538,-913 1538,-913 1622.83,-913 1622.83,-913"/>
<polygon fill="black" stroke="black" points="1622.83,-916.5 1632.83,-913 1622.83,-909.5 1622.83,-916.5"/>
</g>
<!-- d2_mlp_up&#45;&gt;d2_mlp_down -->
<g id="edge81" class="edge">
<title>d2_mlp_up&#45;&gt;d2_mlp_down</title>
<path fill="none" stroke="black" d="M1679,-1006.2C1679,-1006.2 1679,-944.52 1679,-944.52"/>
<polygon fill="black" stroke="black" points="1682.5,-944.52 1679,-934.52 1675.5,-944.52 1682.5,-944.52"/>
</g>
<!-- d2_mlp_down&#45;&gt;d2_res2 -->
<g id="edge82" class="edge">
<title>d2_mlp_down&#45;&gt;d2_res2</title>
<path fill="none" stroke="black" d="M1679,-893.36C1679,-893.36 1679,-831.48 1679,-831.48"/>
<polygon fill="black" stroke="black" points="1682.5,-831.48 1679,-821.48 1675.5,-831.48 1682.5,-831.48"/>
</g>
<!-- d2_layer1 -->
<g id="node65" class="node">
<title>d2_layer1</title>
<polygon fill="lightgray" stroke="black" points="1772,-667.43 1680,-667.43 1680,-626.43 1772,-626.43 1772,-667.43"/>
<text text-anchor="middle" x="1726" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="1726" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1726" y="-633.43" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_res2&#45;&gt;d2_layer1 -->
<g id="edge84" class="edge">
<title>d2_res2&#45;&gt;d2_layer1</title>
<path fill="none" stroke="black" d="M1726,-739.28C1726,-739.28 1726,-677.62 1726,-677.62"/>
<polygon fill="black" stroke="black" points="1729.5,-677.62 1726,-667.62 1722.5,-677.62 1729.5,-677.62"/>
</g>
<!-- d2_layer2 -->
<g id="node66" class="node">
<title>d2_layer2</title>
<polygon fill="lightgray" stroke="black" points="1772,-554.43 1680,-554.43 1680,-513.43 1772,-513.43 1772,-554.43"/>
<text text-anchor="middle" x="1726" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1726" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1726" y="-520.43" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_layer1&#45;&gt;d2_layer2 -->
<g id="edge85" class="edge">
<title>d2_layer1&#45;&gt;d2_layer2</title>
<path fill="none" stroke="black" d="M1726,-626.2C1726,-626.2 1726,-564.52 1726,-564.52"/>
<polygon fill="black" stroke="black" points="1729.5,-564.52 1726,-554.52 1722.5,-564.52 1729.5,-564.52"/>
</g>
<!-- d2_layer3 -->
<g id="node67" class="node">
<title>d2_layer3</title>
<polygon fill="lightgray" stroke="black" points="1772,-441.43 1680,-441.43 1680,-400.43 1772,-400.43 1772,-441.43"/>
<text text-anchor="middle" x="1726" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1726" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1726" y="-407.43" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_layer2&#45;&gt;d2_layer3 -->
<g id="edge86" class="edge">
<title>d2_layer2&#45;&gt;d2_layer3</title>
<path fill="none" stroke="black" d="M1726,-513.2C1726,-513.2 1726,-451.52 1726,-451.52"/>
<polygon fill="black" stroke="black" points="1729.5,-451.52 1726,-441.52 1722.5,-451.52 1729.5,-451.52"/>
</g>
<!-- d2_output -->
<g id="node68" class="node">
<title>d2_output</title>
<polygon fill="white" stroke="black" points="1821.26,-328.43 1669.72,-328.43 1630.74,-246.43 1782.28,-246.43 1821.26,-328.43"/>
<text text-anchor="middle" x="1726" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="1726" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1726" y="-273.93" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- d2_layer3&#45;&gt;d2_output -->
<g id="edge87" class="edge">
<title>d2_layer3&#45;&gt;d2_output</title>
<path fill="none" stroke="black" d="M1726,-400.36C1726,-400.36 1726,-338.48 1726,-338.48"/>
<polygon fill="black" stroke="black" points="1729.5,-338.48 1726,-328.48 1722.5,-338.48 1729.5,-338.48"/>
</g>
<!-- d2_output&#45;&gt;sequence_agg -->
<g id="edge88" class="edge">
<title>d2_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M1726,-246.05C1726,-204.63 1726,-147 1726,-147 1726,-147 4846.69,-147 4846.69,-147"/>
<polygon fill="black" stroke="black" points="4846.69,-150.5 4856.69,-147 4846.69,-143.5 4846.69,-150.5"/>
</g>
<!-- d3_ln1 -->
<g id="node70" class="node">
<title>d3_ln1</title>
<polygon fill="white" stroke="black" points="2269,-1913.39 2177,-1913.39 2177,-1872.39 2269,-1872.39 2269,-1913.39"/>
<text text-anchor="middle" x="2223" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2223" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2223" y="-1879.39" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_input&#45;&gt;d3_ln1 -->
<g id="edge90" class="edge">
<title>d3_input&#45;&gt;d3_ln1</title>
<path fill="none" stroke="black" d="M2328.47,-1992.6C2328.47,-1955.98 2328.47,-1886 2328.47,-1886 2328.47,-1886 2279.26,-1886 2279.26,-1886"/>
<polygon fill="black" stroke="black" points="2279.26,-1882.5 2269.26,-1886 2279.26,-1889.5 2279.26,-1882.5"/>
</g>
<!-- d3_res1 -->
<g id="node81" class="node">
<title>d3_res1</title>
<polygon fill="white" stroke="black" points="2430.26,-1314.43 2278.72,-1314.43 2239.74,-1232.43 2391.28,-1232.43 2430.26,-1314.43"/>
<text text-anchor="middle" x="2335" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2335" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2335" y="-1259.93" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_input&#45;&gt;d3_res1 -->
<g id="edge104" class="edge">
<title>d3_input&#45;&gt;d3_res1</title>
<path fill="none" stroke="black" d="M2410.96,-1990.98C2410.96,-1990.98 2410.96,-1324.61 2410.96,-1324.61"/>
<polygon fill="black" stroke="black" points="2414.46,-1324.61 2410.96,-1314.61 2407.46,-1324.61 2414.46,-1324.61"/>
</g>
<!-- d3_q -->
<g id="node71" class="node">
<title>d3_q</title>
<polygon fill="lightcoral" stroke="black" points="2026,-1800.39 1934,-1800.39 1934,-1759.39 2026,-1759.39 2026,-1800.39"/>
<text text-anchor="middle" x="1980" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="1980" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="1980" y="-1766.39" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_ln1&#45;&gt;d3_q -->
<g id="edge91" class="edge">
<title>d3_ln1&#45;&gt;d3_q</title>
<path fill="none" stroke="black" d="M2176.94,-1899C2114.5,-1899 2010.71,-1899 2010.71,-1899 2010.71,-1899 2010.71,-1810.64 2010.71,-1810.64"/>
<polygon fill="black" stroke="black" points="2014.21,-1810.64 2010.71,-1800.64 2007.21,-1810.64 2014.21,-1810.64"/>
</g>
<!-- d3_k -->
<g id="node72" class="node">
<title>d3_k</title>
<polygon fill="lightcoral" stroke="black" points="2188,-1800.39 2096,-1800.39 2096,-1759.39 2188,-1759.39 2188,-1800.39"/>
<text text-anchor="middle" x="2142" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="2142" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2142" y="-1766.39" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_ln1&#45;&gt;d3_k -->
<g id="edge92" class="edge">
<title>d3_ln1&#45;&gt;d3_k</title>
<path fill="none" stroke="black" d="M2182.5,-1872.17C2182.5,-1872.17 2182.5,-1810.49 2182.5,-1810.49"/>
<polygon fill="black" stroke="black" points="2186,-1810.49 2182.5,-1800.49 2179,-1810.49 2186,-1810.49"/>
</g>
<!-- d3_v -->
<g id="node73" class="node">
<title>d3_v</title>
<polygon fill="lightcoral" stroke="black" points="2350,-1800.39 2258,-1800.39 2258,-1759.39 2350,-1759.39 2350,-1800.39"/>
<text text-anchor="middle" x="2304" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="2304" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2304" y="-1766.39" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_ln1&#45;&gt;d3_v -->
<g id="edge93" class="edge">
<title>d3_ln1&#45;&gt;d3_v</title>
<path fill="none" stroke="black" d="M2263.5,-1872.17C2263.5,-1872.17 2263.5,-1810.49 2263.5,-1810.49"/>
<polygon fill="black" stroke="black" points="2267,-1810.49 2263.5,-1800.49 2260,-1810.49 2267,-1810.49"/>
</g>
<!-- d3_q_heads -->
<g id="node74" class="node">
<title>d3_q_heads</title>
<ellipse fill="white" stroke="black" cx="1938" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="1938" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="1938" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="1938" y="-1644.9" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_q&#45;&gt;d3_q_heads -->
<g id="edge94" class="edge">
<title>d3_q&#45;&gt;d3_q_heads</title>
<path fill="none" stroke="black" d="M1972.77,-1759.28C1972.77,-1759.28 1972.77,-1694.19 1972.77,-1694.19"/>
<polygon fill="black" stroke="black" points="1976.27,-1694.19 1972.77,-1684.19 1969.27,-1694.19 1976.27,-1694.19"/>
</g>
<!-- d3_k_heads -->
<g id="node75" class="node">
<title>d3_k_heads</title>
<ellipse fill="white" stroke="black" cx="2128" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="2128" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="2128" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2128" y="-1644.9" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_k&#45;&gt;d3_k_heads -->
<g id="edge95" class="edge">
<title>d3_k&#45;&gt;d3_k_heads</title>
<path fill="none" stroke="black" d="M2142,-1759.28C2142,-1759.28 2142,-1696.87 2142,-1696.87"/>
<polygon fill="black" stroke="black" points="2145.5,-1696.87 2142,-1686.87 2138.5,-1696.87 2145.5,-1696.87"/>
</g>
<!-- d3_v_heads -->
<g id="node76" class="node">
<title>d3_v_heads</title>
<ellipse fill="white" stroke="black" cx="2318" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="2318" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="2318" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2318" y="-1644.9" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_v&#45;&gt;d3_v_heads -->
<g id="edge96" class="edge">
<title>d3_v&#45;&gt;d3_v_heads</title>
<path fill="none" stroke="black" d="M2304,-1759.28C2304,-1759.28 2304,-1696.87 2304,-1696.87"/>
<polygon fill="black" stroke="black" points="2307.5,-1696.87 2304,-1686.87 2300.5,-1696.87 2307.5,-1696.87"/>
</g>
<!-- d3_ring_attn -->
<g id="node77" class="node">
<title>d3_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="2182,-1557.41 2090,-1557.41 2090,-1516.41 2182,-1516.41 2182,-1557.41"/>
<text text-anchor="middle" x="2136" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="2136" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2136" y="-1523.41" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_q_heads&#45;&gt;d3_ring_attn -->
<g id="edge97" class="edge">
<title>d3_q_heads&#45;&gt;d3_ring_attn</title>
<path fill="none" stroke="black" d="M1938,-1629.13C1938,-1596.13 1938,-1547 1938,-1547 1938,-1547 2079.83,-1547 2079.83,-1547"/>
<polygon fill="black" stroke="black" points="2079.83,-1550.5 2089.83,-1547 2079.83,-1543.5 2079.83,-1550.5"/>
</g>
<!-- d3_k_heads&#45;&gt;d3_ring_attn -->
<g id="edge98" class="edge">
<title>d3_k_heads&#45;&gt;d3_ring_attn</title>
<path fill="none" stroke="black" d="M2136,-1629.3C2136,-1629.3 2136,-1567.78 2136,-1567.78"/>
<polygon fill="black" stroke="black" points="2139.5,-1567.78 2136,-1557.78 2132.5,-1567.78 2139.5,-1567.78"/>
</g>
<!-- d3_v_heads&#45;&gt;d3_ring_attn -->
<g id="edge99" class="edge">
<title>d3_v_heads&#45;&gt;d3_ring_attn</title>
<path fill="none" stroke="black" d="M2259.23,-1640.86C2259.23,-1607.02 2259.23,-1536 2259.23,-1536 2259.23,-1536 2192.24,-1536 2192.24,-1536"/>
<polygon fill="black" stroke="black" points="2192.24,-1532.5 2182.24,-1536 2192.24,-1539.5 2192.24,-1532.5"/>
</g>
<!-- d3_send_kv -->
<g id="node78" class="node">
<title>d3_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2136" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="2136" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="2136" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2136" y="-1401.92" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_ring_attn&#45;&gt;d3_send_kv -->
<g id="edge100" class="edge">
<title>d3_ring_attn&#45;&gt;d3_send_kv</title>
<path fill="none" stroke="black" d="M2136,-1516.3C2136,-1516.3 2136,-1454.8 2136,-1454.8"/>
<polygon fill="black" stroke="black" points="2139.5,-1454.8 2136,-1444.8 2132.5,-1454.8 2139.5,-1454.8"/>
</g>
<!-- d3_out_proj -->
<g id="node80" class="node">
<title>d3_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="2366,-1435.92 2274,-1435.92 2274,-1394.92 2366,-1394.92 2366,-1435.92"/>
<text text-anchor="middle" x="2320" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="2320" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2320" y="-1401.92" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_ring_attn&#45;&gt;d3_out_proj -->
<g id="edge103" class="edge">
<title>d3_ring_attn&#45;&gt;d3_out_proj</title>
<path fill="none" stroke="black" d="M2182.43,-1526C2236.94,-1526 2320,-1526 2320,-1526 2320,-1526 2320,-1445.96 2320,-1445.96"/>
<polygon fill="black" stroke="black" points="2323.5,-1445.96 2320,-1435.96 2316.5,-1445.96 2323.5,-1445.96"/>
</g>
<!-- d4_recv_kv -->
<g id="node101" class="node">
<title>d4_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2680" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="2680" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="2680" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2680" y="-2000.88" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d3_send_kv&#45;&gt;d4_recv_kv -->
<g id="edge101" class="edge">
<title>d3_send_kv&#45;&gt;d4_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2166.88,-1441C2276.71,-1441 2641.85,-1441 2641.85,-1441 2641.85,-1441 2641.85,-1980.11 2641.85,-1980.11"/>
<polygon fill="black" stroke="black" points="2638.35,-1980.11 2641.85,-1990.11 2645.35,-1980.11 2638.35,-1980.11"/>
</g>
<!-- d3_send_kv&#45;&gt;d4_recv_kv -->
<g id="edge131" class="edge">
<title>d3_send_kv&#45;&gt;d4_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2176.82,-1438C2299.44,-1438 2656.15,-1438 2656.15,-1438 2656.15,-1438 2656.15,-1976.97 2656.15,-1976.97"/>
<polygon fill="black" stroke="black" points="2652.65,-1976.97 2656.15,-1986.97 2659.65,-1976.97 2652.65,-1976.97"/>
</g>
<!-- d3_out_proj&#45;&gt;d3_res1 -->
<g id="edge105" class="edge">
<title>d3_out_proj&#45;&gt;d3_res1</title>
<path fill="none" stroke="black" d="M2320,-1394.77C2320,-1394.77 2320,-1324.63 2320,-1324.63"/>
<polygon fill="black" stroke="black" points="2323.5,-1324.63 2320,-1314.63 2316.5,-1324.63 2323.5,-1324.63"/>
</g>
<!-- d3_ln2 -->
<g id="node82" class="node">
<title>d3_ln2</title>
<polygon fill="white" stroke="black" points="2338,-1160.43 2246,-1160.43 2246,-1119.43 2338,-1119.43 2338,-1160.43"/>
<text text-anchor="middle" x="2292" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2292" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2292" y="-1126.43" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_res1&#45;&gt;d3_ln2 -->
<g id="edge106" class="edge">
<title>d3_res1&#45;&gt;d3_ln2</title>
<path fill="none" stroke="black" d="M2292,-1232.28C2292,-1232.28 2292,-1170.62 2292,-1170.62"/>
<polygon fill="black" stroke="black" points="2295.5,-1170.62 2292,-1160.62 2288.5,-1170.62 2295.5,-1170.62"/>
</g>
<!-- d3_res2 -->
<g id="node86" class="node">
<title>d3_res2</title>
<polygon fill="white" stroke="black" points="2437.26,-821.43 2285.72,-821.43 2246.74,-739.43 2398.28,-739.43 2437.26,-821.43"/>
<text text-anchor="middle" x="2342" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2342" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2342" y="-766.93" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_res1&#45;&gt;d3_res2 -->
<g id="edge112" class="edge">
<title>d3_res1&#45;&gt;d3_res2</title>
<path fill="none" stroke="black" d="M2385.69,-1232.24C2385.69,-1232.24 2385.69,-831.49 2385.69,-831.49"/>
<polygon fill="black" stroke="black" points="2389.19,-831.49 2385.69,-821.49 2382.19,-831.49 2389.19,-831.49"/>
</g>
<!-- d3_mlp_gate -->
<g id="node83" class="node">
<title>d3_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="2200,-1047.43 2102,-1047.43 2102,-1006.43 2200,-1006.43 2200,-1047.43"/>
<text text-anchor="middle" x="2151" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="2151" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="2151" y="-1013.43" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_ln2&#45;&gt;d3_mlp_gate -->
<g id="edge107" class="edge">
<title>d3_ln2&#45;&gt;d3_mlp_gate</title>
<path fill="none" stroke="black" d="M2245.83,-1139C2204.71,-1139 2151,-1139 2151,-1139 2151,-1139 2151,-1057.48 2151,-1057.48"/>
<polygon fill="black" stroke="black" points="2154.5,-1057.48 2151,-1047.48 2147.5,-1057.48 2154.5,-1057.48"/>
</g>
<!-- d3_mlp_up -->
<g id="node84" class="node">
<title>d3_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="2341,-1047.43 2243,-1047.43 2243,-1006.43 2341,-1006.43 2341,-1047.43"/>
<text text-anchor="middle" x="2292" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="2292" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="2292" y="-1013.43" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_ln2&#45;&gt;d3_mlp_up -->
<g id="edge108" class="edge">
<title>d3_ln2&#45;&gt;d3_mlp_up</title>
<path fill="none" stroke="black" d="M2292,-1119.2C2292,-1119.2 2292,-1057.52 2292,-1057.52"/>
<polygon fill="black" stroke="black" points="2295.5,-1057.52 2292,-1047.52 2288.5,-1057.52 2295.5,-1057.52"/>
</g>
<!-- d3_mlp_down -->
<g id="node85" class="node">
<title>d3_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="2338,-934.43 2246,-934.43 2246,-893.43 2338,-893.43 2338,-934.43"/>
<text text-anchor="middle" x="2292" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="2292" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2292" y="-900.43" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_mlp_gate&#45;&gt;d3_mlp_down -->
<g id="edge109" class="edge">
<title>d3_mlp_gate&#45;&gt;d3_mlp_down</title>
<path fill="none" stroke="black" d="M2151,-1006.3C2151,-973.46 2151,-913 2151,-913 2151,-913 2235.83,-913 2235.83,-913"/>
<polygon fill="black" stroke="black" points="2235.83,-916.5 2245.83,-913 2235.83,-909.5 2235.83,-916.5"/>
</g>
<!-- d3_mlp_up&#45;&gt;d3_mlp_down -->
<g id="edge110" class="edge">
<title>d3_mlp_up&#45;&gt;d3_mlp_down</title>
<path fill="none" stroke="black" d="M2292,-1006.2C2292,-1006.2 2292,-944.52 2292,-944.52"/>
<polygon fill="black" stroke="black" points="2295.5,-944.52 2292,-934.52 2288.5,-944.52 2295.5,-944.52"/>
</g>
<!-- d3_mlp_down&#45;&gt;d3_res2 -->
<g id="edge111" class="edge">
<title>d3_mlp_down&#45;&gt;d3_res2</title>
<path fill="none" stroke="black" d="M2292.31,-893.36C2292.31,-893.36 2292.31,-831.48 2292.31,-831.48"/>
<polygon fill="black" stroke="black" points="2295.81,-831.48 2292.31,-821.48 2288.81,-831.48 2295.81,-831.48"/>
</g>
<!-- d3_layer1 -->
<g id="node87" class="node">
<title>d3_layer1</title>
<polygon fill="lightgray" stroke="black" points="2388,-667.43 2296,-667.43 2296,-626.43 2388,-626.43 2388,-667.43"/>
<text text-anchor="middle" x="2342" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="2342" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2342" y="-633.43" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_res2&#45;&gt;d3_layer1 -->
<g id="edge113" class="edge">
<title>d3_res2&#45;&gt;d3_layer1</title>
<path fill="none" stroke="black" d="M2342,-739.28C2342,-739.28 2342,-677.62 2342,-677.62"/>
<polygon fill="black" stroke="black" points="2345.5,-677.62 2342,-667.62 2338.5,-677.62 2345.5,-677.62"/>
</g>
<!-- d3_layer2 -->
<g id="node88" class="node">
<title>d3_layer2</title>
<polygon fill="lightgray" stroke="black" points="2388,-554.43 2296,-554.43 2296,-513.43 2388,-513.43 2388,-554.43"/>
<text text-anchor="middle" x="2342" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="2342" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2342" y="-520.43" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_layer1&#45;&gt;d3_layer2 -->
<g id="edge114" class="edge">
<title>d3_layer1&#45;&gt;d3_layer2</title>
<path fill="none" stroke="black" d="M2342,-626.2C2342,-626.2 2342,-564.52 2342,-564.52"/>
<polygon fill="black" stroke="black" points="2345.5,-564.52 2342,-554.52 2338.5,-564.52 2345.5,-564.52"/>
</g>
<!-- d3_layer3 -->
<g id="node89" class="node">
<title>d3_layer3</title>
<polygon fill="lightgray" stroke="black" points="2388,-441.43 2296,-441.43 2296,-400.43 2388,-400.43 2388,-441.43"/>
<text text-anchor="middle" x="2342" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="2342" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2342" y="-407.43" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_layer2&#45;&gt;d3_layer3 -->
<g id="edge115" class="edge">
<title>d3_layer2&#45;&gt;d3_layer3</title>
<path fill="none" stroke="black" d="M2342,-513.2C2342,-513.2 2342,-451.52 2342,-451.52"/>
<polygon fill="black" stroke="black" points="2345.5,-451.52 2342,-441.52 2338.5,-451.52 2345.5,-451.52"/>
</g>
<!-- d3_output -->
<g id="node90" class="node">
<title>d3_output</title>
<polygon fill="white" stroke="black" points="2437.26,-328.43 2285.72,-328.43 2246.74,-246.43 2398.28,-246.43 2437.26,-328.43"/>
<text text-anchor="middle" x="2342" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="2342" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2342" y="-273.93" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- d3_layer3&#45;&gt;d3_output -->
<g id="edge116" class="edge">
<title>d3_layer3&#45;&gt;d3_output</title>
<path fill="none" stroke="black" d="M2342,-400.36C2342,-400.36 2342,-338.48 2342,-338.48"/>
<polygon fill="black" stroke="black" points="2345.5,-338.48 2342,-328.48 2338.5,-338.48 2345.5,-338.48"/>
</g>
<!-- d3_output&#45;&gt;sequence_agg -->
<g id="edge117" class="edge">
<title>d3_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M2342,-246.36C2342,-206.83 2342,-153 2342,-153 2342,-153 4843.23,-153 4843.23,-153"/>
<polygon fill="black" stroke="black" points="4843.23,-156.5 4853.23,-153 4843.23,-149.5 4843.23,-156.5"/>
</g>
<!-- d4_ln1 -->
<g id="node92" class="node">
<title>d4_ln1</title>
<polygon fill="white" stroke="black" points="2885,-1913.39 2793,-1913.39 2793,-1872.39 2885,-1872.39 2885,-1913.39"/>
<text text-anchor="middle" x="2839" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2839" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2839" y="-1879.39" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_input&#45;&gt;d4_ln1 -->
<g id="edge119" class="edge">
<title>d4_input&#45;&gt;d4_ln1</title>
<path fill="none" stroke="black" d="M2944.47,-1992.6C2944.47,-1955.98 2944.47,-1886 2944.47,-1886 2944.47,-1886 2895.26,-1886 2895.26,-1886"/>
<polygon fill="black" stroke="black" points="2895.26,-1882.5 2885.26,-1886 2895.26,-1889.5 2895.26,-1882.5"/>
</g>
<!-- d4_res1 -->
<g id="node103" class="node">
<title>d4_res1</title>
<polygon fill="white" stroke="black" points="3038.26,-1314.43 2886.72,-1314.43 2847.74,-1232.43 2999.28,-1232.43 3038.26,-1314.43"/>
<text text-anchor="middle" x="2943" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2943" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2943" y="-1259.93" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_input&#45;&gt;d4_res1 -->
<g id="edge133" class="edge">
<title>d4_input&#45;&gt;d4_res1</title>
<path fill="none" stroke="black" d="M3022.96,-1989.73C3022.96,-1989.73 3022.96,-1324.83 3022.96,-1324.83"/>
<polygon fill="black" stroke="black" points="3026.46,-1324.83 3022.96,-1314.83 3019.46,-1324.83 3026.46,-1324.83"/>
</g>
<!-- d4_q -->
<g id="node93" class="node">
<title>d4_q</title>
<polygon fill="lightcoral" stroke="black" points="2614,-1800.39 2522,-1800.39 2522,-1759.39 2614,-1759.39 2614,-1800.39"/>
<text text-anchor="middle" x="2568" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="2568" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2568" y="-1766.39" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_ln1&#45;&gt;d4_q -->
<g id="edge120" class="edge">
<title>d4_ln1&#45;&gt;d4_q</title>
<path fill="none" stroke="black" d="M2792.81,-1899C2715.12,-1899 2566.71,-1899 2566.71,-1899 2566.71,-1899 2566.71,-1810.64 2566.71,-1810.64"/>
<polygon fill="black" stroke="black" points="2570.21,-1810.64 2566.71,-1800.64 2563.21,-1810.64 2570.21,-1810.64"/>
</g>
<!-- d4_k -->
<g id="node94" class="node">
<title>d4_k</title>
<polygon fill="lightcoral" stroke="black" points="2804,-1800.39 2712,-1800.39 2712,-1759.39 2804,-1759.39 2804,-1800.39"/>
<text text-anchor="middle" x="2758" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="2758" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2758" y="-1766.39" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_ln1&#45;&gt;d4_k -->
<g id="edge121" class="edge">
<title>d4_ln1&#45;&gt;d4_k</title>
<path fill="none" stroke="black" d="M2798.5,-1872.17C2798.5,-1872.17 2798.5,-1810.49 2798.5,-1810.49"/>
<polygon fill="black" stroke="black" points="2802,-1810.49 2798.5,-1800.49 2795,-1810.49 2802,-1810.49"/>
</g>
<!-- d4_v -->
<g id="node95" class="node">
<title>d4_v</title>
<polygon fill="lightcoral" stroke="black" points="2966,-1800.39 2874,-1800.39 2874,-1759.39 2966,-1759.39 2966,-1800.39"/>
<text text-anchor="middle" x="2920" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="2920" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2920" y="-1766.39" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_ln1&#45;&gt;d4_v -->
<g id="edge122" class="edge">
<title>d4_ln1&#45;&gt;d4_v</title>
<path fill="none" stroke="black" d="M2879.5,-1872.17C2879.5,-1872.17 2879.5,-1810.49 2879.5,-1810.49"/>
<polygon fill="black" stroke="black" points="2883,-1810.49 2879.5,-1800.49 2876,-1810.49 2883,-1810.49"/>
</g>
<!-- d4_q_heads -->
<g id="node96" class="node">
<title>d4_q_heads</title>
<ellipse fill="white" stroke="black" cx="2554" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="2554" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="2554" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2554" y="-1644.9" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_q&#45;&gt;d4_q_heads -->
<g id="edge123" class="edge">
<title>d4_q&#45;&gt;d4_q_heads</title>
<path fill="none" stroke="black" d="M2568,-1759.28C2568,-1759.28 2568,-1696.87 2568,-1696.87"/>
<polygon fill="black" stroke="black" points="2571.5,-1696.87 2568,-1686.87 2564.5,-1696.87 2571.5,-1696.87"/>
</g>
<!-- d4_k_heads -->
<g id="node97" class="node">
<title>d4_k_heads</title>
<ellipse fill="white" stroke="black" cx="2744" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="2744" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="2744" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2744" y="-1644.9" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_k&#45;&gt;d4_k_heads -->
<g id="edge124" class="edge">
<title>d4_k&#45;&gt;d4_k_heads</title>
<path fill="none" stroke="black" d="M2758,-1759.28C2758,-1759.28 2758,-1696.87 2758,-1696.87"/>
<polygon fill="black" stroke="black" points="2761.5,-1696.87 2758,-1686.87 2754.5,-1696.87 2761.5,-1696.87"/>
</g>
<!-- d4_v_heads -->
<g id="node98" class="node">
<title>d4_v_heads</title>
<ellipse fill="white" stroke="black" cx="2934" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="2934" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="2934" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="2934" y="-1644.9" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_v&#45;&gt;d4_v_heads -->
<g id="edge125" class="edge">
<title>d4_v&#45;&gt;d4_v_heads</title>
<path fill="none" stroke="black" d="M2920,-1759.28C2920,-1759.28 2920,-1696.87 2920,-1696.87"/>
<polygon fill="black" stroke="black" points="2923.5,-1696.87 2920,-1686.87 2916.5,-1696.87 2923.5,-1696.87"/>
</g>
<!-- d4_ring_attn -->
<g id="node99" class="node">
<title>d4_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-1557.41 2705,-1557.41 2705,-1516.41 2797,-1516.41 2797,-1557.41"/>
<text text-anchor="middle" x="2751" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="2751" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2751" y="-1523.41" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_q_heads&#45;&gt;d4_ring_attn -->
<g id="edge126" class="edge">
<title>d4_q_heads&#45;&gt;d4_ring_attn</title>
<path fill="none" stroke="black" d="M2554,-1629.13C2554,-1596.13 2554,-1547 2554,-1547 2554,-1547 2694.81,-1547 2694.81,-1547"/>
<polygon fill="black" stroke="black" points="2694.81,-1550.5 2704.81,-1547 2694.81,-1543.5 2694.81,-1550.5"/>
</g>
<!-- d4_k_heads&#45;&gt;d4_ring_attn -->
<g id="edge127" class="edge">
<title>d4_k_heads&#45;&gt;d4_ring_attn</title>
<path fill="none" stroke="black" d="M2751,-1629.3C2751,-1629.3 2751,-1567.78 2751,-1567.78"/>
<polygon fill="black" stroke="black" points="2754.5,-1567.78 2751,-1557.78 2747.5,-1567.78 2754.5,-1567.78"/>
</g>
<!-- d4_v_heads&#45;&gt;d4_ring_attn -->
<g id="edge128" class="edge">
<title>d4_v_heads&#45;&gt;d4_ring_attn</title>
<path fill="none" stroke="black" d="M2874.73,-1641.12C2874.73,-1607.38 2874.73,-1536 2874.73,-1536 2874.73,-1536 2807.07,-1536 2807.07,-1536"/>
<polygon fill="black" stroke="black" points="2807.07,-1532.5 2797.07,-1536 2807.07,-1539.5 2807.07,-1532.5"/>
</g>
<!-- d4_send_kv -->
<g id="node100" class="node">
<title>d4_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2751" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="2751" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="2751" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2751" y="-1401.92" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_ring_attn&#45;&gt;d4_send_kv -->
<g id="edge129" class="edge">
<title>d4_ring_attn&#45;&gt;d4_send_kv</title>
<path fill="none" stroke="black" d="M2751,-1516.3C2751,-1516.3 2751,-1454.8 2751,-1454.8"/>
<polygon fill="black" stroke="black" points="2754.5,-1454.8 2751,-1444.8 2747.5,-1454.8 2754.5,-1454.8"/>
</g>
<!-- d4_out_proj -->
<g id="node102" class="node">
<title>d4_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="2981,-1435.92 2889,-1435.92 2889,-1394.92 2981,-1394.92 2981,-1435.92"/>
<text text-anchor="middle" x="2935" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="2935" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2935" y="-1401.92" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_ring_attn&#45;&gt;d4_out_proj -->
<g id="edge132" class="edge">
<title>d4_ring_attn&#45;&gt;d4_out_proj</title>
<path fill="none" stroke="black" d="M2797.43,-1526C2851.94,-1526 2935,-1526 2935,-1526 2935,-1526 2935,-1445.96 2935,-1445.96"/>
<polygon fill="black" stroke="black" points="2938.5,-1445.96 2935,-1435.96 2931.5,-1445.96 2938.5,-1445.96"/>
</g>
<!-- d5_recv_kv -->
<g id="node123" class="node">
<title>d5_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3296" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="3296" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="3296" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3296" y="-2000.88" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d4_send_kv&#45;&gt;d5_recv_kv -->
<g id="edge130" class="edge">
<title>d4_send_kv&#45;&gt;d5_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2781.94,-1441C2891.99,-1441 3257.85,-1441 3257.85,-1441 3257.85,-1441 3257.85,-1980.11 3257.85,-1980.11"/>
<polygon fill="black" stroke="black" points="3254.35,-1980.11 3257.85,-1990.11 3261.35,-1980.11 3254.35,-1980.11"/>
</g>
<!-- d4_send_kv&#45;&gt;d5_recv_kv -->
<g id="edge160" class="edge">
<title>d4_send_kv&#45;&gt;d5_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2791.89,-1438C2914.75,-1438 3272.15,-1438 3272.15,-1438 3272.15,-1438 3272.15,-1976.97 3272.15,-1976.97"/>
<polygon fill="black" stroke="black" points="3268.65,-1976.97 3272.15,-1986.97 3275.65,-1976.97 3268.65,-1976.97"/>
</g>
<!-- d4_out_proj&#45;&gt;d4_res1 -->
<g id="edge134" class="edge">
<title>d4_out_proj&#45;&gt;d4_res1</title>
<path fill="none" stroke="black" d="M2935,-1394.77C2935,-1394.77 2935,-1324.63 2935,-1324.63"/>
<polygon fill="black" stroke="black" points="2938.5,-1324.63 2935,-1314.63 2931.5,-1324.63 2938.5,-1324.63"/>
</g>
<!-- d4_ln2 -->
<g id="node104" class="node">
<title>d4_ln2</title>
<polygon fill="white" stroke="black" points="2958,-1160.43 2866,-1160.43 2866,-1119.43 2958,-1119.43 2958,-1160.43"/>
<text text-anchor="middle" x="2912" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2912" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2912" y="-1126.43" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_res1&#45;&gt;d4_ln2 -->
<g id="edge135" class="edge">
<title>d4_res1&#45;&gt;d4_ln2</title>
<path fill="none" stroke="black" d="M2912,-1232.28C2912,-1232.28 2912,-1170.62 2912,-1170.62"/>
<polygon fill="black" stroke="black" points="2915.5,-1170.62 2912,-1160.62 2908.5,-1170.62 2915.5,-1170.62"/>
</g>
<!-- d4_res2 -->
<g id="node108" class="node">
<title>d4_res2</title>
<polygon fill="white" stroke="black" points="3053.26,-821.43 2901.72,-821.43 2862.74,-739.43 3014.28,-739.43 3053.26,-821.43"/>
<text text-anchor="middle" x="2958" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2958" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2958" y="-766.93" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_res1&#45;&gt;d4_res2 -->
<g id="edge141" class="edge">
<title>d4_res1&#45;&gt;d4_res2</title>
<path fill="none" stroke="black" d="M2999.69,-1233.08C2999.69,-1233.08 2999.69,-831.68 2999.69,-831.68"/>
<polygon fill="black" stroke="black" points="3003.19,-831.68 2999.69,-821.68 2996.19,-831.68 3003.19,-831.68"/>
</g>
<!-- d4_mlp_gate -->
<g id="node105" class="node">
<title>d4_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="2820,-1047.43 2722,-1047.43 2722,-1006.43 2820,-1006.43 2820,-1047.43"/>
<text text-anchor="middle" x="2771" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="2771" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="2771" y="-1013.43" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_ln2&#45;&gt;d4_mlp_gate -->
<g id="edge136" class="edge">
<title>d4_ln2&#45;&gt;d4_mlp_gate</title>
<path fill="none" stroke="black" d="M2865.98,-1139C2824.18,-1139 2769.03,-1139 2769.03,-1139 2769.03,-1139 2769.03,-1057.48 2769.03,-1057.48"/>
<polygon fill="black" stroke="black" points="2772.53,-1057.48 2769.03,-1047.48 2765.53,-1057.48 2772.53,-1057.48"/>
</g>
<!-- d4_mlp_up -->
<g id="node106" class="node">
<title>d4_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="2961,-1047.43 2863,-1047.43 2863,-1006.43 2961,-1006.43 2961,-1047.43"/>
<text text-anchor="middle" x="2912" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="2912" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="2912" y="-1013.43" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_ln2&#45;&gt;d4_mlp_up -->
<g id="edge137" class="edge">
<title>d4_ln2&#45;&gt;d4_mlp_up</title>
<path fill="none" stroke="black" d="M2912,-1119.2C2912,-1119.2 2912,-1057.52 2912,-1057.52"/>
<polygon fill="black" stroke="black" points="2915.5,-1057.52 2912,-1047.52 2908.5,-1057.52 2915.5,-1057.52"/>
</g>
<!-- d4_mlp_down -->
<g id="node107" class="node">
<title>d4_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="2958,-934.43 2866,-934.43 2866,-893.43 2958,-893.43 2958,-934.43"/>
<text text-anchor="middle" x="2912" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="2912" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2912" y="-900.43" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_mlp_gate&#45;&gt;d4_mlp_down -->
<g id="edge138" class="edge">
<title>d4_mlp_gate&#45;&gt;d4_mlp_down</title>
<path fill="none" stroke="black" d="M2771,-1006.3C2771,-973.46 2771,-913 2771,-913 2771,-913 2855.83,-913 2855.83,-913"/>
<polygon fill="black" stroke="black" points="2855.83,-916.5 2865.83,-913 2855.83,-909.5 2855.83,-916.5"/>
</g>
<!-- d4_mlp_up&#45;&gt;d4_mlp_down -->
<g id="edge139" class="edge">
<title>d4_mlp_up&#45;&gt;d4_mlp_down</title>
<path fill="none" stroke="black" d="M2912,-1006.2C2912,-1006.2 2912,-944.52 2912,-944.52"/>
<polygon fill="black" stroke="black" points="2915.5,-944.52 2912,-934.52 2908.5,-944.52 2915.5,-944.52"/>
</g>
<!-- d4_mlp_down&#45;&gt;d4_res2 -->
<g id="edge140" class="edge">
<title>d4_mlp_down&#45;&gt;d4_res2</title>
<path fill="none" stroke="black" d="M2912,-893.36C2912,-893.36 2912,-831.48 2912,-831.48"/>
<polygon fill="black" stroke="black" points="2915.5,-831.48 2912,-821.48 2908.5,-831.48 2915.5,-831.48"/>
</g>
<!-- d4_layer1 -->
<g id="node109" class="node">
<title>d4_layer1</title>
<polygon fill="lightgray" stroke="black" points="3004,-667.43 2912,-667.43 2912,-626.43 3004,-626.43 3004,-667.43"/>
<text text-anchor="middle" x="2958" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="2958" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2958" y="-633.43" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_res2&#45;&gt;d4_layer1 -->
<g id="edge142" class="edge">
<title>d4_res2&#45;&gt;d4_layer1</title>
<path fill="none" stroke="black" d="M2958,-739.28C2958,-739.28 2958,-677.62 2958,-677.62"/>
<polygon fill="black" stroke="black" points="2961.5,-677.62 2958,-667.62 2954.5,-677.62 2961.5,-677.62"/>
</g>
<!-- d4_layer2 -->
<g id="node110" class="node">
<title>d4_layer2</title>
<polygon fill="lightgray" stroke="black" points="3004,-554.43 2912,-554.43 2912,-513.43 3004,-513.43 3004,-554.43"/>
<text text-anchor="middle" x="2958" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="2958" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2958" y="-520.43" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_layer1&#45;&gt;d4_layer2 -->
<g id="edge143" class="edge">
<title>d4_layer1&#45;&gt;d4_layer2</title>
<path fill="none" stroke="black" d="M2958,-626.2C2958,-626.2 2958,-564.52 2958,-564.52"/>
<polygon fill="black" stroke="black" points="2961.5,-564.52 2958,-554.52 2954.5,-564.52 2961.5,-564.52"/>
</g>
<!-- d4_layer3 -->
<g id="node111" class="node">
<title>d4_layer3</title>
<polygon fill="lightgray" stroke="black" points="3004,-441.43 2912,-441.43 2912,-400.43 3004,-400.43 3004,-441.43"/>
<text text-anchor="middle" x="2958" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="2958" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2958" y="-407.43" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_layer2&#45;&gt;d4_layer3 -->
<g id="edge144" class="edge">
<title>d4_layer2&#45;&gt;d4_layer3</title>
<path fill="none" stroke="black" d="M2958,-513.2C2958,-513.2 2958,-451.52 2958,-451.52"/>
<polygon fill="black" stroke="black" points="2961.5,-451.52 2958,-441.52 2954.5,-451.52 2961.5,-451.52"/>
</g>
<!-- d4_output -->
<g id="node112" class="node">
<title>d4_output</title>
<polygon fill="white" stroke="black" points="3053.26,-328.43 2901.72,-328.43 2862.74,-246.43 3014.28,-246.43 3053.26,-328.43"/>
<text text-anchor="middle" x="2958" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="2958" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="2958" y="-273.93" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- d4_layer3&#45;&gt;d4_output -->
<g id="edge145" class="edge">
<title>d4_layer3&#45;&gt;d4_output</title>
<path fill="none" stroke="black" d="M2958,-400.36C2958,-400.36 2958,-338.48 2958,-338.48"/>
<polygon fill="black" stroke="black" points="2961.5,-338.48 2958,-328.48 2954.5,-338.48 2961.5,-338.48"/>
</g>
<!-- d4_output&#45;&gt;sequence_agg -->
<g id="edge146" class="edge">
<title>d4_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M2958,-246.12C2958,-208.24 2958,-158 2958,-158 2958,-158 4845.32,-158 4845.32,-158"/>
<polygon fill="black" stroke="black" points="4845.32,-161.5 4855.32,-158 4845.32,-154.5 4845.32,-161.5"/>
</g>
<!-- d5_ln1 -->
<g id="node114" class="node">
<title>d5_ln1</title>
<polygon fill="white" stroke="black" points="3501,-1913.39 3409,-1913.39 3409,-1872.39 3501,-1872.39 3501,-1913.39"/>
<text text-anchor="middle" x="3455" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="3455" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3455" y="-1879.39" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_input&#45;&gt;d5_ln1 -->
<g id="edge148" class="edge">
<title>d5_input&#45;&gt;d5_ln1</title>
<path fill="none" stroke="black" d="M3560.47,-1992.6C3560.47,-1955.98 3560.47,-1886 3560.47,-1886 3560.47,-1886 3511.26,-1886 3511.26,-1886"/>
<polygon fill="black" stroke="black" points="3511.26,-1882.5 3501.26,-1886 3511.26,-1889.5 3511.26,-1882.5"/>
</g>
<!-- d5_res1 -->
<g id="node125" class="node">
<title>d5_res1</title>
<polygon fill="white" stroke="black" points="3639.26,-1314.43 3487.72,-1314.43 3448.74,-1232.43 3600.28,-1232.43 3639.26,-1314.43"/>
<text text-anchor="middle" x="3544" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="3544" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3544" y="-1259.93" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_input&#45;&gt;d5_res1 -->
<g id="edge162" class="edge">
<title>d5_input&#45;&gt;d5_res1</title>
<path fill="none" stroke="black" d="M3631.46,-1988.01C3631.46,-1988.01 3631.46,-1324.48 3631.46,-1324.48"/>
<polygon fill="black" stroke="black" points="3634.96,-1324.48 3631.46,-1314.48 3627.96,-1324.48 3634.96,-1324.48"/>
</g>
<!-- d5_q -->
<g id="node115" class="node">
<title>d5_q</title>
<polygon fill="lightcoral" stroke="black" points="3230,-1800.39 3138,-1800.39 3138,-1759.39 3230,-1759.39 3230,-1800.39"/>
<text text-anchor="middle" x="3184" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="3184" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3184" y="-1766.39" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_ln1&#45;&gt;d5_q -->
<g id="edge149" class="edge">
<title>d5_ln1&#45;&gt;d5_q</title>
<path fill="none" stroke="black" d="M3408.81,-1899C3331.12,-1899 3182.71,-1899 3182.71,-1899 3182.71,-1899 3182.71,-1810.64 3182.71,-1810.64"/>
<polygon fill="black" stroke="black" points="3186.21,-1810.64 3182.71,-1800.64 3179.21,-1810.64 3186.21,-1810.64"/>
</g>
<!-- d5_k -->
<g id="node116" class="node">
<title>d5_k</title>
<polygon fill="lightcoral" stroke="black" points="3420,-1800.39 3328,-1800.39 3328,-1759.39 3420,-1759.39 3420,-1800.39"/>
<text text-anchor="middle" x="3374" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="3374" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3374" y="-1766.39" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_ln1&#45;&gt;d5_k -->
<g id="edge150" class="edge">
<title>d5_ln1&#45;&gt;d5_k</title>
<path fill="none" stroke="black" d="M3414.5,-1872.17C3414.5,-1872.17 3414.5,-1810.49 3414.5,-1810.49"/>
<polygon fill="black" stroke="black" points="3418,-1810.49 3414.5,-1800.49 3411,-1810.49 3418,-1810.49"/>
</g>
<!-- d5_v -->
<g id="node117" class="node">
<title>d5_v</title>
<polygon fill="lightcoral" stroke="black" points="3582,-1800.39 3490,-1800.39 3490,-1759.39 3582,-1759.39 3582,-1800.39"/>
<text text-anchor="middle" x="3536" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="3536" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3536" y="-1766.39" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_ln1&#45;&gt;d5_v -->
<g id="edge151" class="edge">
<title>d5_ln1&#45;&gt;d5_v</title>
<path fill="none" stroke="black" d="M3495.5,-1872.17C3495.5,-1872.17 3495.5,-1810.49 3495.5,-1810.49"/>
<polygon fill="black" stroke="black" points="3499,-1810.49 3495.5,-1800.49 3492,-1810.49 3499,-1810.49"/>
</g>
<!-- d5_q_heads -->
<g id="node118" class="node">
<title>d5_q_heads</title>
<ellipse fill="white" stroke="black" cx="3170" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="3170" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="3170" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="3170" y="-1644.9" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_q&#45;&gt;d5_q_heads -->
<g id="edge152" class="edge">
<title>d5_q&#45;&gt;d5_q_heads</title>
<path fill="none" stroke="black" d="M3184,-1759.28C3184,-1759.28 3184,-1696.87 3184,-1696.87"/>
<polygon fill="black" stroke="black" points="3187.5,-1696.87 3184,-1686.87 3180.5,-1696.87 3187.5,-1696.87"/>
</g>
<!-- d5_k_heads -->
<g id="node119" class="node">
<title>d5_k_heads</title>
<ellipse fill="white" stroke="black" cx="3360" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="3360" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="3360" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="3360" y="-1644.9" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_k&#45;&gt;d5_k_heads -->
<g id="edge153" class="edge">
<title>d5_k&#45;&gt;d5_k_heads</title>
<path fill="none" stroke="black" d="M3374,-1759.28C3374,-1759.28 3374,-1696.87 3374,-1696.87"/>
<polygon fill="black" stroke="black" points="3377.5,-1696.87 3374,-1686.87 3370.5,-1696.87 3377.5,-1696.87"/>
</g>
<!-- d5_v_heads -->
<g id="node120" class="node">
<title>d5_v_heads</title>
<ellipse fill="white" stroke="black" cx="3550" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="3550" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="3550" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="3550" y="-1644.9" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_v&#45;&gt;d5_v_heads -->
<g id="edge154" class="edge">
<title>d5_v&#45;&gt;d5_v_heads</title>
<path fill="none" stroke="black" d="M3536,-1759.28C3536,-1759.28 3536,-1696.87 3536,-1696.87"/>
<polygon fill="black" stroke="black" points="3539.5,-1696.87 3536,-1686.87 3532.5,-1696.87 3539.5,-1696.87"/>
</g>
<!-- d5_ring_attn -->
<g id="node121" class="node">
<title>d5_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="3413,-1557.41 3321,-1557.41 3321,-1516.41 3413,-1516.41 3413,-1557.41"/>
<text text-anchor="middle" x="3367" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="3367" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3367" y="-1523.41" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_q_heads&#45;&gt;d5_ring_attn -->
<g id="edge155" class="edge">
<title>d5_q_heads&#45;&gt;d5_ring_attn</title>
<path fill="none" stroke="black" d="M3170,-1629.13C3170,-1596.13 3170,-1547 3170,-1547 3170,-1547 3310.81,-1547 3310.81,-1547"/>
<polygon fill="black" stroke="black" points="3310.81,-1550.5 3320.81,-1547 3310.81,-1543.5 3310.81,-1550.5"/>
</g>
<!-- d5_k_heads&#45;&gt;d5_ring_attn -->
<g id="edge156" class="edge">
<title>d5_k_heads&#45;&gt;d5_ring_attn</title>
<path fill="none" stroke="black" d="M3367,-1629.3C3367,-1629.3 3367,-1567.78 3367,-1567.78"/>
<polygon fill="black" stroke="black" points="3370.5,-1567.78 3367,-1557.78 3363.5,-1567.78 3370.5,-1567.78"/>
</g>
<!-- d5_v_heads&#45;&gt;d5_ring_attn -->
<g id="edge157" class="edge">
<title>d5_v_heads&#45;&gt;d5_ring_attn</title>
<path fill="none" stroke="black" d="M3513.67,-1633.04C3513.67,-1597.19 3513.67,-1536 3513.67,-1536 3513.67,-1536 3423,-1536 3423,-1536"/>
<polygon fill="black" stroke="black" points="3423,-1532.5 3413,-1536 3423,-1539.5 3423,-1532.5"/>
</g>
<!-- d5_send_kv -->
<g id="node122" class="node">
<title>d5_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3367" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="3367" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="3367" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3367" y="-1401.92" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_ring_attn&#45;&gt;d5_send_kv -->
<g id="edge158" class="edge">
<title>d5_ring_attn&#45;&gt;d5_send_kv</title>
<path fill="none" stroke="black" d="M3367,-1516.3C3367,-1516.3 3367,-1454.8 3367,-1454.8"/>
<polygon fill="black" stroke="black" points="3370.5,-1454.8 3367,-1444.8 3363.5,-1454.8 3370.5,-1454.8"/>
</g>
<!-- d5_out_proj -->
<g id="node124" class="node">
<title>d5_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="3575,-1435.92 3483,-1435.92 3483,-1394.92 3575,-1394.92 3575,-1435.92"/>
<text text-anchor="middle" x="3529" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3529" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3529" y="-1401.92" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_ring_attn&#45;&gt;d5_out_proj -->
<g id="edge161" class="edge">
<title>d5_ring_attn&#45;&gt;d5_out_proj</title>
<path fill="none" stroke="black" d="M3413.13,-1526C3465.67,-1526 3544.33,-1526 3544.33,-1526 3544.33,-1526 3544.33,-1445.96 3544.33,-1445.96"/>
<polygon fill="black" stroke="black" points="3547.83,-1445.96 3544.33,-1435.96 3540.83,-1445.96 3547.83,-1445.96"/>
</g>
<!-- d6_recv_kv -->
<g id="node145" class="node">
<title>d6_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3912" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="3912" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="3912" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3912" y="-2000.88" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d5_send_kv&#45;&gt;d6_recv_kv -->
<g id="edge159" class="edge">
<title>d5_send_kv&#45;&gt;d6_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3397.72,-1441C3508.77,-1441 3882.82,-1441 3882.82,-1441 3882.82,-1441 3882.82,-1977.88 3882.82,-1977.88"/>
<polygon fill="black" stroke="black" points="3879.32,-1977.88 3882.82,-1987.88 3886.32,-1977.88 3879.32,-1977.88"/>
</g>
<!-- d5_send_kv&#45;&gt;d6_recv_kv -->
<g id="edge189" class="edge">
<title>d5_send_kv&#45;&gt;d6_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3407.81,-1438C3531.31,-1438 3892.64,-1438 3892.64,-1438 3892.64,-1438 3892.64,-1976.19 3892.64,-1976.19"/>
<polygon fill="black" stroke="black" points="3889.14,-1976.19 3892.64,-1986.19 3896.14,-1976.19 3889.14,-1976.19"/>
</g>
<!-- d5_out_proj&#45;&gt;d5_res1 -->
<g id="edge163" class="edge">
<title>d5_out_proj&#45;&gt;d5_res1</title>
<path fill="none" stroke="black" d="M3529,-1394.77C3529,-1394.77 3529,-1324.63 3529,-1324.63"/>
<polygon fill="black" stroke="black" points="3532.5,-1324.63 3529,-1314.63 3525.5,-1324.63 3532.5,-1324.63"/>
</g>
<!-- d5_ln2 -->
<g id="node126" class="node">
<title>d5_ln2</title>
<polygon fill="white" stroke="black" points="3558,-1160.43 3466,-1160.43 3466,-1119.43 3558,-1119.43 3558,-1160.43"/>
<text text-anchor="middle" x="3512" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="3512" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3512" y="-1126.43" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_res1&#45;&gt;d5_ln2 -->
<g id="edge164" class="edge">
<title>d5_res1&#45;&gt;d5_ln2</title>
<path fill="none" stroke="black" d="M3512,-1232.28C3512,-1232.28 3512,-1170.62 3512,-1170.62"/>
<polygon fill="black" stroke="black" points="3515.5,-1170.62 3512,-1160.62 3508.5,-1170.62 3515.5,-1170.62"/>
</g>
<!-- d5_res2 -->
<g id="node130" class="node">
<title>d5_res2</title>
<polygon fill="white" stroke="black" points="3669.26,-821.43 3517.72,-821.43 3478.74,-739.43 3630.28,-739.43 3669.26,-821.43"/>
<text text-anchor="middle" x="3574" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="3574" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3574" y="-766.93" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_res1&#45;&gt;d5_res2 -->
<g id="edge170" class="edge">
<title>d5_res1&#45;&gt;d5_res2</title>
<path fill="none" stroke="black" d="M3600.19,-1232.24C3600.19,-1232.24 3600.19,-831.49 3600.19,-831.49"/>
<polygon fill="black" stroke="black" points="3603.69,-831.49 3600.19,-821.49 3596.69,-831.49 3603.69,-831.49"/>
</g>
<!-- d5_mlp_gate -->
<g id="node127" class="node">
<title>d5_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="3420,-1047.43 3322,-1047.43 3322,-1006.43 3420,-1006.43 3420,-1047.43"/>
<text text-anchor="middle" x="3371" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="3371" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="3371" y="-1013.43" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_ln2&#45;&gt;d5_mlp_gate -->
<g id="edge165" class="edge">
<title>d5_ln2&#45;&gt;d5_mlp_gate</title>
<path fill="none" stroke="black" d="M3465.83,-1139C3424.71,-1139 3371,-1139 3371,-1139 3371,-1139 3371,-1057.48 3371,-1057.48"/>
<polygon fill="black" stroke="black" points="3374.5,-1057.48 3371,-1047.48 3367.5,-1057.48 3374.5,-1057.48"/>
</g>
<!-- d5_mlp_up -->
<g id="node128" class="node">
<title>d5_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="3561,-1047.43 3463,-1047.43 3463,-1006.43 3561,-1006.43 3561,-1047.43"/>
<text text-anchor="middle" x="3512" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="3512" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="3512" y="-1013.43" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_ln2&#45;&gt;d5_mlp_up -->
<g id="edge166" class="edge">
<title>d5_ln2&#45;&gt;d5_mlp_up</title>
<path fill="none" stroke="black" d="M3512,-1119.2C3512,-1119.2 3512,-1057.52 3512,-1057.52"/>
<polygon fill="black" stroke="black" points="3515.5,-1057.52 3512,-1047.52 3508.5,-1057.52 3515.5,-1057.52"/>
</g>
<!-- d5_mlp_down -->
<g id="node129" class="node">
<title>d5_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="3558,-934.43 3466,-934.43 3466,-893.43 3558,-893.43 3558,-934.43"/>
<text text-anchor="middle" x="3512" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="3512" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3512" y="-900.43" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_mlp_gate&#45;&gt;d5_mlp_down -->
<g id="edge167" class="edge">
<title>d5_mlp_gate&#45;&gt;d5_mlp_down</title>
<path fill="none" stroke="black" d="M3371,-1006.3C3371,-973.46 3371,-913 3371,-913 3371,-913 3455.83,-913 3455.83,-913"/>
<polygon fill="black" stroke="black" points="3455.83,-916.5 3465.83,-913 3455.83,-909.5 3455.83,-916.5"/>
</g>
<!-- d5_mlp_up&#45;&gt;d5_mlp_down -->
<g id="edge168" class="edge">
<title>d5_mlp_up&#45;&gt;d5_mlp_down</title>
<path fill="none" stroke="black" d="M3512,-1006.2C3512,-1006.2 3512,-944.52 3512,-944.52"/>
<polygon fill="black" stroke="black" points="3515.5,-944.52 3512,-934.52 3508.5,-944.52 3515.5,-944.52"/>
</g>
<!-- d5_mlp_down&#45;&gt;d5_res2 -->
<g id="edge169" class="edge">
<title>d5_mlp_down&#45;&gt;d5_res2</title>
<path fill="none" stroke="black" d="M3518.31,-893.36C3518.31,-893.36 3518.31,-831.48 3518.31,-831.48"/>
<polygon fill="black" stroke="black" points="3521.81,-831.48 3518.31,-821.48 3514.81,-831.48 3521.81,-831.48"/>
</g>
<!-- d5_layer1 -->
<g id="node131" class="node">
<title>d5_layer1</title>
<polygon fill="lightgray" stroke="black" points="3620,-667.43 3528,-667.43 3528,-626.43 3620,-626.43 3620,-667.43"/>
<text text-anchor="middle" x="3574" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="3574" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3574" y="-633.43" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_res2&#45;&gt;d5_layer1 -->
<g id="edge171" class="edge">
<title>d5_res2&#45;&gt;d5_layer1</title>
<path fill="none" stroke="black" d="M3574,-739.28C3574,-739.28 3574,-677.62 3574,-677.62"/>
<polygon fill="black" stroke="black" points="3577.5,-677.62 3574,-667.62 3570.5,-677.62 3577.5,-677.62"/>
</g>
<!-- d5_layer2 -->
<g id="node132" class="node">
<title>d5_layer2</title>
<polygon fill="lightgray" stroke="black" points="3620,-554.43 3528,-554.43 3528,-513.43 3620,-513.43 3620,-554.43"/>
<text text-anchor="middle" x="3574" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="3574" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3574" y="-520.43" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_layer1&#45;&gt;d5_layer2 -->
<g id="edge172" class="edge">
<title>d5_layer1&#45;&gt;d5_layer2</title>
<path fill="none" stroke="black" d="M3574,-626.2C3574,-626.2 3574,-564.52 3574,-564.52"/>
<polygon fill="black" stroke="black" points="3577.5,-564.52 3574,-554.52 3570.5,-564.52 3577.5,-564.52"/>
</g>
<!-- d5_layer3 -->
<g id="node133" class="node">
<title>d5_layer3</title>
<polygon fill="lightgray" stroke="black" points="3620,-441.43 3528,-441.43 3528,-400.43 3620,-400.43 3620,-441.43"/>
<text text-anchor="middle" x="3574" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="3574" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3574" y="-407.43" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_layer2&#45;&gt;d5_layer3 -->
<g id="edge173" class="edge">
<title>d5_layer2&#45;&gt;d5_layer3</title>
<path fill="none" stroke="black" d="M3574,-513.2C3574,-513.2 3574,-451.52 3574,-451.52"/>
<polygon fill="black" stroke="black" points="3577.5,-451.52 3574,-441.52 3570.5,-451.52 3577.5,-451.52"/>
</g>
<!-- d5_output -->
<g id="node134" class="node">
<title>d5_output</title>
<polygon fill="white" stroke="black" points="3669.26,-328.43 3517.72,-328.43 3478.74,-246.43 3630.28,-246.43 3669.26,-328.43"/>
<text text-anchor="middle" x="3574" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="3574" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3574" y="-273.93" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- d5_layer3&#45;&gt;d5_output -->
<g id="edge174" class="edge">
<title>d5_layer3&#45;&gt;d5_output</title>
<path fill="none" stroke="black" d="M3574,-400.36C3574,-400.36 3574,-338.48 3574,-338.48"/>
<polygon fill="black" stroke="black" points="3577.5,-338.48 3574,-328.48 3570.5,-338.48 3577.5,-338.48"/>
</g>
<!-- d5_output&#45;&gt;sequence_agg -->
<g id="edge175" class="edge">
<title>d5_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M3574,-246.34C3574,-210.1 3574,-163 3574,-163 3574,-163 4852.32,-163 4852.32,-163"/>
<polygon fill="black" stroke="black" points="4852.32,-166.5 4862.32,-163 4852.32,-159.5 4852.32,-166.5"/>
</g>
<!-- d6_ln1 -->
<g id="node136" class="node">
<title>d6_ln1</title>
<polygon fill="white" stroke="black" points="4130,-1913.39 4038,-1913.39 4038,-1872.39 4130,-1872.39 4130,-1913.39"/>
<text text-anchor="middle" x="4084" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4084" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4084" y="-1879.39" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_input&#45;&gt;d6_ln1 -->
<g id="edge177" class="edge">
<title>d6_input&#45;&gt;d6_ln1</title>
<path fill="none" stroke="black" d="M4176.47,-1992.6C4176.47,-1955.98 4176.47,-1886 4176.47,-1886 4176.47,-1886 4140.24,-1886 4140.24,-1886"/>
<polygon fill="black" stroke="black" points="4140.24,-1882.5 4130.24,-1886 4140.24,-1889.5 4140.24,-1882.5"/>
</g>
<!-- d6_res1 -->
<g id="node147" class="node">
<title>d6_res1</title>
<polygon fill="white" stroke="black" points="4285.26,-1314.43 4133.72,-1314.43 4094.74,-1232.43 4246.28,-1232.43 4285.26,-1314.43"/>
<text text-anchor="middle" x="4190" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="4190" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4190" y="-1259.93" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_input&#45;&gt;d6_res1 -->
<g id="edge191" class="edge">
<title>d6_input&#45;&gt;d6_res1</title>
<path fill="none" stroke="black" d="M4262.3,-1992.21C4262.3,-1992.21 4262.3,-1324.86 4262.3,-1324.86"/>
<polygon fill="black" stroke="black" points="4265.8,-1324.86 4262.3,-1314.86 4258.8,-1324.86 4265.8,-1324.86"/>
</g>
<!-- d6_q -->
<g id="node137" class="node">
<title>d6_q</title>
<polygon fill="lightcoral" stroke="black" points="3873,-1800.39 3781,-1800.39 3781,-1759.39 3873,-1759.39 3873,-1800.39"/>
<text text-anchor="middle" x="3827" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="3827" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3827" y="-1766.39" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_ln1&#45;&gt;d6_q -->
<g id="edge178" class="edge">
<title>d6_ln1&#45;&gt;d6_q</title>
<path fill="none" stroke="black" d="M4037.76,-1899C3971.7,-1899 3858.21,-1899 3858.21,-1899 3858.21,-1899 3858.21,-1810.64 3858.21,-1810.64"/>
<polygon fill="black" stroke="black" points="3861.71,-1810.64 3858.21,-1800.64 3854.71,-1810.64 3861.71,-1810.64"/>
</g>
<!-- d6_k -->
<g id="node138" class="node">
<title>d6_k</title>
<polygon fill="lightcoral" stroke="black" points="4049,-1800.39 3957,-1800.39 3957,-1759.39 4049,-1759.39 4049,-1800.39"/>
<text text-anchor="middle" x="4003" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="4003" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4003" y="-1766.39" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_ln1&#45;&gt;d6_k -->
<g id="edge179" class="edge">
<title>d6_ln1&#45;&gt;d6_k</title>
<path fill="none" stroke="black" d="M4043.5,-1872.17C4043.5,-1872.17 4043.5,-1810.49 4043.5,-1810.49"/>
<polygon fill="black" stroke="black" points="4047,-1810.49 4043.5,-1800.49 4040,-1810.49 4047,-1810.49"/>
</g>
<!-- d6_v -->
<g id="node139" class="node">
<title>d6_v</title>
<polygon fill="lightcoral" stroke="black" points="4198,-1800.39 4106,-1800.39 4106,-1759.39 4198,-1759.39 4198,-1800.39"/>
<text text-anchor="middle" x="4152" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="4152" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4152" y="-1766.39" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_ln1&#45;&gt;d6_v -->
<g id="edge180" class="edge">
<title>d6_ln1&#45;&gt;d6_v</title>
<path fill="none" stroke="black" d="M4118,-1872.17C4118,-1872.17 4118,-1810.49 4118,-1810.49"/>
<polygon fill="black" stroke="black" points="4121.5,-1810.49 4118,-1800.49 4114.5,-1810.49 4121.5,-1810.49"/>
</g>
<!-- d6_q_heads -->
<g id="node140" class="node">
<title>d6_q_heads</title>
<ellipse fill="white" stroke="black" cx="3786" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="3786" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="3786" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="3786" y="-1644.9" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_q&#45;&gt;d6_q_heads -->
<g id="edge181" class="edge">
<title>d6_q&#45;&gt;d6_q_heads</title>
<path fill="none" stroke="black" d="M3820.27,-1759.28C3820.27,-1759.28 3820.27,-1694.19 3820.27,-1694.19"/>
<polygon fill="black" stroke="black" points="3823.77,-1694.19 3820.27,-1684.19 3816.77,-1694.19 3823.77,-1694.19"/>
</g>
<!-- d6_k_heads -->
<g id="node141" class="node">
<title>d6_k_heads</title>
<ellipse fill="white" stroke="black" cx="3976" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="3976" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="3976" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="3976" y="-1644.9" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_k&#45;&gt;d6_k_heads -->
<g id="edge182" class="edge">
<title>d6_k&#45;&gt;d6_k_heads</title>
<path fill="none" stroke="black" d="M4003,-1759.28C4003,-1759.28 4003,-1695.52 4003,-1695.52"/>
<polygon fill="black" stroke="black" points="4006.5,-1695.52 4003,-1685.52 3999.5,-1695.52 4006.5,-1695.52"/>
</g>
<!-- d6_v_heads -->
<g id="node142" class="node">
<title>d6_v_heads</title>
<ellipse fill="white" stroke="black" cx="4166" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="4166" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="4166" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="4166" y="-1644.9" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_v&#45;&gt;d6_v_heads -->
<g id="edge183" class="edge">
<title>d6_v&#45;&gt;d6_v_heads</title>
<path fill="none" stroke="black" d="M4152,-1759.28C4152,-1759.28 4152,-1696.87 4152,-1696.87"/>
<polygon fill="black" stroke="black" points="4155.5,-1696.87 4152,-1686.87 4148.5,-1696.87 4155.5,-1696.87"/>
</g>
<!-- d6_ring_attn -->
<g id="node143" class="node">
<title>d6_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="4037,-1557.41 3945,-1557.41 3945,-1516.41 4037,-1516.41 4037,-1557.41"/>
<text text-anchor="middle" x="3991" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="3991" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3991" y="-1523.41" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_q_heads&#45;&gt;d6_ring_attn -->
<g id="edge184" class="edge">
<title>d6_q_heads&#45;&gt;d6_ring_attn</title>
<path fill="none" stroke="black" d="M3786,-1629.13C3786,-1596.13 3786,-1547 3786,-1547 3786,-1547 3934.99,-1547 3934.99,-1547"/>
<polygon fill="black" stroke="black" points="3934.99,-1550.5 3944.99,-1547 3934.99,-1543.5 3934.99,-1550.5"/>
</g>
<!-- d6_k_heads&#45;&gt;d6_ring_attn -->
<g id="edge185" class="edge">
<title>d6_k_heads&#45;&gt;d6_ring_attn</title>
<path fill="none" stroke="black" d="M3991,-1629.92C3991,-1629.92 3991,-1567.62 3991,-1567.62"/>
<polygon fill="black" stroke="black" points="3994.5,-1567.62 3991,-1557.62 3987.5,-1567.62 3994.5,-1567.62"/>
</g>
<!-- d6_v_heads&#45;&gt;d6_ring_attn -->
<g id="edge186" class="edge">
<title>d6_v_heads&#45;&gt;d6_ring_attn</title>
<path fill="none" stroke="black" d="M4111.81,-1638.73C4111.81,-1604.13 4111.81,-1536 4111.81,-1536 4111.81,-1536 4047.02,-1536 4047.02,-1536"/>
<polygon fill="black" stroke="black" points="4047.02,-1532.5 4037.02,-1536 4047.02,-1539.5 4047.02,-1532.5"/>
</g>
<!-- d6_send_kv -->
<g id="node144" class="node">
<title>d6_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3991" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="3991" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="3991" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="3991" y="-1401.92" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_ring_attn&#45;&gt;d6_send_kv -->
<g id="edge187" class="edge">
<title>d6_ring_attn&#45;&gt;d6_send_kv</title>
<path fill="none" stroke="black" d="M3991,-1516.3C3991,-1516.3 3991,-1454.8 3991,-1454.8"/>
<polygon fill="black" stroke="black" points="3994.5,-1454.8 3991,-1444.8 3987.5,-1454.8 3994.5,-1454.8"/>
</g>
<!-- d6_out_proj -->
<g id="node146" class="node">
<title>d6_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="4221,-1435.92 4129,-1435.92 4129,-1394.92 4221,-1394.92 4221,-1435.92"/>
<text text-anchor="middle" x="4175" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="4175" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4175" y="-1401.92" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_ring_attn&#45;&gt;d6_out_proj -->
<g id="edge190" class="edge">
<title>d6_ring_attn&#45;&gt;d6_out_proj</title>
<path fill="none" stroke="black" d="M4037.43,-1526C4091.94,-1526 4175,-1526 4175,-1526 4175,-1526 4175,-1445.96 4175,-1445.96"/>
<polygon fill="black" stroke="black" points="4178.5,-1445.96 4175,-1435.96 4171.5,-1445.96 4178.5,-1445.96"/>
</g>
<!-- d7_recv_kv -->
<g id="node167" class="node">
<title>d7_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4528" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="4528" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="4528" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4528" y="-2000.88" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d6_send_kv&#45;&gt;d7_recv_kv -->
<g id="edge188" class="edge">
<title>d6_send_kv&#45;&gt;d7_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4021.83,-1441C4130.59,-1441 4489.85,-1441 4489.85,-1441 4489.85,-1441 4489.85,-1980.11 4489.85,-1980.11"/>
<polygon fill="black" stroke="black" points="4486.35,-1980.11 4489.85,-1990.11 4493.35,-1980.11 4486.35,-1980.11"/>
</g>
<!-- d6_send_kv&#45;&gt;d7_recv_kv -->
<g id="edge218" class="edge">
<title>d6_send_kv&#45;&gt;d7_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4032.13,-1438C4153.9,-1438 4504.15,-1438 4504.15,-1438 4504.15,-1438 4504.15,-1976.97 4504.15,-1976.97"/>
<polygon fill="black" stroke="black" points="4500.65,-1976.97 4504.15,-1986.97 4507.65,-1976.97 4500.65,-1976.97"/>
</g>
<!-- d6_out_proj&#45;&gt;d6_res1 -->
<g id="edge192" class="edge">
<title>d6_out_proj&#45;&gt;d6_res1</title>
<path fill="none" stroke="black" d="M4175,-1394.77C4175,-1394.77 4175,-1324.63 4175,-1324.63"/>
<polygon fill="black" stroke="black" points="4178.5,-1324.63 4175,-1314.63 4171.5,-1324.63 4178.5,-1324.63"/>
</g>
<!-- d6_ln2 -->
<g id="node148" class="node">
<title>d6_ln2</title>
<polygon fill="white" stroke="black" points="4189,-1160.43 4097,-1160.43 4097,-1119.43 4189,-1119.43 4189,-1160.43"/>
<text text-anchor="middle" x="4143" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4143" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4143" y="-1126.43" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_res1&#45;&gt;d6_ln2 -->
<g id="edge193" class="edge">
<title>d6_res1&#45;&gt;d6_ln2</title>
<path fill="none" stroke="black" d="M4143,-1232.28C4143,-1232.28 4143,-1170.62 4143,-1170.62"/>
<polygon fill="black" stroke="black" points="4146.5,-1170.62 4143,-1160.62 4139.5,-1170.62 4146.5,-1170.62"/>
</g>
<!-- d6_res2 -->
<g id="node152" class="node">
<title>d6_res2</title>
<polygon fill="white" stroke="black" points="4285.26,-821.43 4133.72,-821.43 4094.74,-739.43 4246.28,-739.43 4285.26,-821.43"/>
<text text-anchor="middle" x="4190" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="4190" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4190" y="-766.93" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_res1&#45;&gt;d6_res2 -->
<g id="edge199" class="edge">
<title>d6_res1&#45;&gt;d6_res2</title>
<path fill="none" stroke="black" d="M4238.69,-1232.24C4238.69,-1232.24 4238.69,-831.49 4238.69,-831.49"/>
<polygon fill="black" stroke="black" points="4242.19,-831.49 4238.69,-821.49 4235.19,-831.49 4242.19,-831.49"/>
</g>
<!-- d6_mlp_gate -->
<g id="node149" class="node">
<title>d6_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="4051,-1047.43 3953,-1047.43 3953,-1006.43 4051,-1006.43 4051,-1047.43"/>
<text text-anchor="middle" x="4002" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="4002" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="4002" y="-1013.43" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_ln2&#45;&gt;d6_mlp_gate -->
<g id="edge194" class="edge">
<title>d6_ln2&#45;&gt;d6_mlp_gate</title>
<path fill="none" stroke="black" d="M4096.83,-1139C4055.71,-1139 4002,-1139 4002,-1139 4002,-1139 4002,-1057.48 4002,-1057.48"/>
<polygon fill="black" stroke="black" points="4005.5,-1057.48 4002,-1047.48 3998.5,-1057.48 4005.5,-1057.48"/>
</g>
<!-- d6_mlp_up -->
<g id="node150" class="node">
<title>d6_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="4192,-1047.43 4094,-1047.43 4094,-1006.43 4192,-1006.43 4192,-1047.43"/>
<text text-anchor="middle" x="4143" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="4143" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="4143" y="-1013.43" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_ln2&#45;&gt;d6_mlp_up -->
<g id="edge195" class="edge">
<title>d6_ln2&#45;&gt;d6_mlp_up</title>
<path fill="none" stroke="black" d="M4143,-1119.2C4143,-1119.2 4143,-1057.52 4143,-1057.52"/>
<polygon fill="black" stroke="black" points="4146.5,-1057.52 4143,-1047.52 4139.5,-1057.52 4146.5,-1057.52"/>
</g>
<!-- d6_mlp_down -->
<g id="node151" class="node">
<title>d6_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="4189,-934.43 4097,-934.43 4097,-893.43 4189,-893.43 4189,-934.43"/>
<text text-anchor="middle" x="4143" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="4143" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4143" y="-900.43" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_mlp_gate&#45;&gt;d6_mlp_down -->
<g id="edge196" class="edge">
<title>d6_mlp_gate&#45;&gt;d6_mlp_down</title>
<path fill="none" stroke="black" d="M4002,-1006.3C4002,-973.46 4002,-913 4002,-913 4002,-913 4086.83,-913 4086.83,-913"/>
<polygon fill="black" stroke="black" points="4086.83,-916.5 4096.83,-913 4086.83,-909.5 4086.83,-916.5"/>
</g>
<!-- d6_mlp_up&#45;&gt;d6_mlp_down -->
<g id="edge197" class="edge">
<title>d6_mlp_up&#45;&gt;d6_mlp_down</title>
<path fill="none" stroke="black" d="M4143,-1006.2C4143,-1006.2 4143,-944.52 4143,-944.52"/>
<polygon fill="black" stroke="black" points="4146.5,-944.52 4143,-934.52 4139.5,-944.52 4146.5,-944.52"/>
</g>
<!-- d6_mlp_down&#45;&gt;d6_res2 -->
<g id="edge198" class="edge">
<title>d6_mlp_down&#45;&gt;d6_res2</title>
<path fill="none" stroke="black" d="M4143,-893.36C4143,-893.36 4143,-831.48 4143,-831.48"/>
<polygon fill="black" stroke="black" points="4146.5,-831.48 4143,-821.48 4139.5,-831.48 4146.5,-831.48"/>
</g>
<!-- d6_layer1 -->
<g id="node153" class="node">
<title>d6_layer1</title>
<polygon fill="lightgray" stroke="black" points="4236,-667.43 4144,-667.43 4144,-626.43 4236,-626.43 4236,-667.43"/>
<text text-anchor="middle" x="4190" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="4190" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4190" y="-633.43" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_res2&#45;&gt;d6_layer1 -->
<g id="edge200" class="edge">
<title>d6_res2&#45;&gt;d6_layer1</title>
<path fill="none" stroke="black" d="M4190,-739.28C4190,-739.28 4190,-677.62 4190,-677.62"/>
<polygon fill="black" stroke="black" points="4193.5,-677.62 4190,-667.62 4186.5,-677.62 4193.5,-677.62"/>
</g>
<!-- d6_layer2 -->
<g id="node154" class="node">
<title>d6_layer2</title>
<polygon fill="lightgray" stroke="black" points="4236,-554.43 4144,-554.43 4144,-513.43 4236,-513.43 4236,-554.43"/>
<text text-anchor="middle" x="4190" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="4190" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4190" y="-520.43" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_layer1&#45;&gt;d6_layer2 -->
<g id="edge201" class="edge">
<title>d6_layer1&#45;&gt;d6_layer2</title>
<path fill="none" stroke="black" d="M4190,-626.2C4190,-626.2 4190,-564.52 4190,-564.52"/>
<polygon fill="black" stroke="black" points="4193.5,-564.52 4190,-554.52 4186.5,-564.52 4193.5,-564.52"/>
</g>
<!-- d6_layer3 -->
<g id="node155" class="node">
<title>d6_layer3</title>
<polygon fill="lightgray" stroke="black" points="4236,-441.43 4144,-441.43 4144,-400.43 4236,-400.43 4236,-441.43"/>
<text text-anchor="middle" x="4190" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="4190" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4190" y="-407.43" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_layer2&#45;&gt;d6_layer3 -->
<g id="edge202" class="edge">
<title>d6_layer2&#45;&gt;d6_layer3</title>
<path fill="none" stroke="black" d="M4190,-513.2C4190,-513.2 4190,-451.52 4190,-451.52"/>
<polygon fill="black" stroke="black" points="4193.5,-451.52 4190,-441.52 4186.5,-451.52 4193.5,-451.52"/>
</g>
<!-- d6_output -->
<g id="node156" class="node">
<title>d6_output</title>
<polygon fill="white" stroke="black" points="4285.26,-328.43 4133.72,-328.43 4094.74,-246.43 4246.28,-246.43 4285.26,-328.43"/>
<text text-anchor="middle" x="4190" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="4190" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4190" y="-273.93" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- d6_layer3&#45;&gt;d6_output -->
<g id="edge203" class="edge">
<title>d6_layer3&#45;&gt;d6_output</title>
<path fill="none" stroke="black" d="M4190,-400.36C4190,-400.36 4190,-338.48 4190,-338.48"/>
<polygon fill="black" stroke="black" points="4193.5,-338.48 4190,-328.48 4186.5,-338.48 4193.5,-338.48"/>
</g>
<!-- d6_output&#45;&gt;sequence_agg -->
<g id="edge204" class="edge">
<title>d6_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M4190,-246.34C4190,-212.13 4190,-169 4190,-169 4190,-169 4869.89,-169 4869.89,-169"/>
<polygon fill="black" stroke="black" points="4869.89,-172.5 4879.89,-169 4869.89,-165.5 4869.89,-172.5"/>
</g>
<!-- d7_ln1 -->
<g id="node158" class="node">
<title>d7_ln1</title>
<polygon fill="white" stroke="black" points="4733,-1913.39 4641,-1913.39 4641,-1872.39 4733,-1872.39 4733,-1913.39"/>
<text text-anchor="middle" x="4687" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4687" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4687" y="-1879.39" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_input&#45;&gt;d7_ln1 -->
<g id="edge206" class="edge">
<title>d7_input&#45;&gt;d7_ln1</title>
<path fill="none" stroke="black" d="M4792.47,-1992.6C4792.47,-1955.98 4792.47,-1886 4792.47,-1886 4792.47,-1886 4743.26,-1886 4743.26,-1886"/>
<polygon fill="black" stroke="black" points="4743.26,-1882.5 4733.26,-1886 4743.26,-1889.5 4743.26,-1882.5"/>
</g>
<!-- d7_res1 -->
<g id="node169" class="node">
<title>d7_res1</title>
<polygon fill="white" stroke="black" points="4871.26,-1314.43 4719.72,-1314.43 4680.74,-1232.43 4832.28,-1232.43 4871.26,-1314.43"/>
<text text-anchor="middle" x="4776" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="4776" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4776" y="-1259.93" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_input&#45;&gt;d7_res1 -->
<g id="edge220" class="edge">
<title>d7_input&#45;&gt;d7_res1</title>
<path fill="none" stroke="black" d="M4863.46,-1988.01C4863.46,-1988.01 4863.46,-1324.48 4863.46,-1324.48"/>
<polygon fill="black" stroke="black" points="4866.96,-1324.48 4863.46,-1314.48 4859.96,-1324.48 4866.96,-1324.48"/>
</g>
<!-- d7_q -->
<g id="node159" class="node">
<title>d7_q</title>
<polygon fill="lightcoral" stroke="black" points="4462,-1800.39 4370,-1800.39 4370,-1759.39 4462,-1759.39 4462,-1800.39"/>
<text text-anchor="middle" x="4416" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="4416" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4416" y="-1766.39" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_ln1&#45;&gt;d7_q -->
<g id="edge207" class="edge">
<title>d7_ln1&#45;&gt;d7_q</title>
<path fill="none" stroke="black" d="M4640.81,-1899C4563.12,-1899 4414.71,-1899 4414.71,-1899 4414.71,-1899 4414.71,-1810.64 4414.71,-1810.64"/>
<polygon fill="black" stroke="black" points="4418.21,-1810.64 4414.71,-1800.64 4411.21,-1810.64 4418.21,-1810.64"/>
</g>
<!-- d7_k -->
<g id="node160" class="node">
<title>d7_k</title>
<polygon fill="lightcoral" stroke="black" points="4652,-1800.39 4560,-1800.39 4560,-1759.39 4652,-1759.39 4652,-1800.39"/>
<text text-anchor="middle" x="4606" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="4606" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4606" y="-1766.39" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_ln1&#45;&gt;d7_k -->
<g id="edge208" class="edge">
<title>d7_ln1&#45;&gt;d7_k</title>
<path fill="none" stroke="black" d="M4646.5,-1872.17C4646.5,-1872.17 4646.5,-1810.49 4646.5,-1810.49"/>
<polygon fill="black" stroke="black" points="4650,-1810.49 4646.5,-1800.49 4643,-1810.49 4650,-1810.49"/>
</g>
<!-- d7_v -->
<g id="node161" class="node">
<title>d7_v</title>
<polygon fill="lightcoral" stroke="black" points="4814,-1800.39 4722,-1800.39 4722,-1759.39 4814,-1759.39 4814,-1800.39"/>
<text text-anchor="middle" x="4768" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="4768" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4768" y="-1766.39" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_ln1&#45;&gt;d7_v -->
<g id="edge209" class="edge">
<title>d7_ln1&#45;&gt;d7_v</title>
<path fill="none" stroke="black" d="M4727.5,-1872.17C4727.5,-1872.17 4727.5,-1810.49 4727.5,-1810.49"/>
<polygon fill="black" stroke="black" points="4731,-1810.49 4727.5,-1800.49 4724,-1810.49 4731,-1810.49"/>
</g>
<!-- d7_q_heads -->
<g id="node162" class="node">
<title>d7_q_heads</title>
<ellipse fill="white" stroke="black" cx="4402" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="4402" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="4402" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="4402" y="-1644.9" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_q&#45;&gt;d7_q_heads -->
<g id="edge210" class="edge">
<title>d7_q&#45;&gt;d7_q_heads</title>
<path fill="none" stroke="black" d="M4416,-1759.28C4416,-1759.28 4416,-1696.87 4416,-1696.87"/>
<polygon fill="black" stroke="black" points="4419.5,-1696.87 4416,-1686.87 4412.5,-1696.87 4419.5,-1696.87"/>
</g>
<!-- d7_k_heads -->
<g id="node163" class="node">
<title>d7_k_heads</title>
<ellipse fill="white" stroke="black" cx="4592" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="4592" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="4592" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="4592" y="-1644.9" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_k&#45;&gt;d7_k_heads -->
<g id="edge211" class="edge">
<title>d7_k&#45;&gt;d7_k_heads</title>
<path fill="none" stroke="black" d="M4606,-1759.28C4606,-1759.28 4606,-1696.87 4606,-1696.87"/>
<polygon fill="black" stroke="black" points="4609.5,-1696.87 4606,-1686.87 4602.5,-1696.87 4609.5,-1696.87"/>
</g>
<!-- d7_v_heads -->
<g id="node164" class="node">
<title>d7_v_heads</title>
<ellipse fill="white" stroke="black" cx="4782" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="4782" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="4782" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="4782" y="-1644.9" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_v&#45;&gt;d7_v_heads -->
<g id="edge212" class="edge">
<title>d7_v&#45;&gt;d7_v_heads</title>
<path fill="none" stroke="black" d="M4768,-1759.28C4768,-1759.28 4768,-1696.87 4768,-1696.87"/>
<polygon fill="black" stroke="black" points="4771.5,-1696.87 4768,-1686.87 4764.5,-1696.87 4771.5,-1696.87"/>
</g>
<!-- d7_ring_attn -->
<g id="node165" class="node">
<title>d7_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="4645,-1557.41 4553,-1557.41 4553,-1516.41 4645,-1516.41 4645,-1557.41"/>
<text text-anchor="middle" x="4599" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="4599" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4599" y="-1523.41" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_q_heads&#45;&gt;d7_ring_attn -->
<g id="edge213" class="edge">
<title>d7_q_heads&#45;&gt;d7_ring_attn</title>
<path fill="none" stroke="black" d="M4402,-1629.13C4402,-1596.13 4402,-1547 4402,-1547 4402,-1547 4542.81,-1547 4542.81,-1547"/>
<polygon fill="black" stroke="black" points="4542.81,-1550.5 4552.81,-1547 4542.81,-1543.5 4542.81,-1550.5"/>
</g>
<!-- d7_k_heads&#45;&gt;d7_ring_attn -->
<g id="edge214" class="edge">
<title>d7_k_heads&#45;&gt;d7_ring_attn</title>
<path fill="none" stroke="black" d="M4599,-1629.3C4599,-1629.3 4599,-1567.78 4599,-1567.78"/>
<polygon fill="black" stroke="black" points="4602.5,-1567.78 4599,-1557.78 4595.5,-1567.78 4602.5,-1567.78"/>
</g>
<!-- d7_v_heads&#45;&gt;d7_ring_attn -->
<g id="edge215" class="edge">
<title>d7_v_heads&#45;&gt;d7_ring_attn</title>
<path fill="none" stroke="black" d="M4745.67,-1633.04C4745.67,-1597.19 4745.67,-1536 4745.67,-1536 4745.67,-1536 4655,-1536 4655,-1536"/>
<polygon fill="black" stroke="black" points="4655,-1532.5 4645,-1536 4655,-1539.5 4655,-1532.5"/>
</g>
<!-- d7_send_kv -->
<g id="node166" class="node">
<title>d7_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4599" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="4599" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="4599" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4599" y="-1401.92" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_ring_attn&#45;&gt;d7_send_kv -->
<g id="edge216" class="edge">
<title>d7_ring_attn&#45;&gt;d7_send_kv</title>
<path fill="none" stroke="black" d="M4599,-1516.3C4599,-1516.3 4599,-1454.8 4599,-1454.8"/>
<polygon fill="black" stroke="black" points="4602.5,-1454.8 4599,-1444.8 4595.5,-1454.8 4602.5,-1454.8"/>
</g>
<!-- d7_out_proj -->
<g id="node168" class="node">
<title>d7_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="4807,-1435.92 4715,-1435.92 4715,-1394.92 4807,-1394.92 4807,-1435.92"/>
<text text-anchor="middle" x="4761" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="4761" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4761" y="-1401.92" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_ring_attn&#45;&gt;d7_out_proj -->
<g id="edge219" class="edge">
<title>d7_ring_attn&#45;&gt;d7_out_proj</title>
<path fill="none" stroke="black" d="M4645.13,-1526C4697.67,-1526 4776.33,-1526 4776.33,-1526 4776.33,-1526 4776.33,-1445.96 4776.33,-1445.96"/>
<polygon fill="black" stroke="black" points="4779.83,-1445.96 4776.33,-1435.96 4772.83,-1445.96 4779.83,-1445.96"/>
</g>
<!-- d8_recv_kv -->
<g id="node189" class="node">
<title>d8_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5022" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="5022" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="5022" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5022" y="-2000.88" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d7_send_kv&#45;&gt;d8_recv_kv -->
<g id="edge217" class="edge">
<title>d7_send_kv&#45;&gt;d8_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4629.8,-1441C4709.13,-1441 4914.25,-1441 4914.25,-1441 4914.25,-1441 4914.25,-2014 4914.25,-2014 4914.25,-2014 4943.15,-2014 4943.15,-2014"/>
<polygon fill="black" stroke="black" points="4943.15,-2017.5 4953.15,-2014 4943.15,-2010.5 4943.15,-2017.5"/>
</g>
<!-- d7_send_kv&#45;&gt;d8_recv_kv -->
<g id="edge247" class="edge">
<title>d7_send_kv&#45;&gt;d8_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4639.89,-1438C4727.85,-1438 4927.11,-1438 4927.11,-1438 4927.11,-1438 4927.11,-1999 4927.11,-1999 4927.11,-1999 4953.8,-1999 4953.8,-1999"/>
<polygon fill="black" stroke="black" points="4953.8,-2002.5 4963.8,-1999 4953.8,-1995.5 4953.8,-2002.5"/>
</g>
<!-- d7_out_proj&#45;&gt;d7_res1 -->
<g id="edge221" class="edge">
<title>d7_out_proj&#45;&gt;d7_res1</title>
<path fill="none" stroke="black" d="M4761,-1394.77C4761,-1394.77 4761,-1324.63 4761,-1324.63"/>
<polygon fill="black" stroke="black" points="4764.5,-1324.63 4761,-1314.63 4757.5,-1324.63 4764.5,-1324.63"/>
</g>
<!-- d7_ln2 -->
<g id="node170" class="node">
<title>d7_ln2</title>
<polygon fill="white" stroke="black" points="4822,-1160.43 4730,-1160.43 4730,-1119.43 4822,-1119.43 4822,-1160.43"/>
<text text-anchor="middle" x="4776" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4776" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4776" y="-1126.43" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_res1&#45;&gt;d7_ln2 -->
<g id="edge222" class="edge">
<title>d7_res1&#45;&gt;d7_ln2</title>
<path fill="none" stroke="black" d="M4776,-1232.28C4776,-1232.28 4776,-1170.62 4776,-1170.62"/>
<polygon fill="black" stroke="black" points="4779.5,-1170.62 4776,-1160.62 4772.5,-1170.62 4779.5,-1170.62"/>
</g>
<!-- d7_res2 -->
<g id="node174" class="node">
<title>d7_res2</title>
<polygon fill="white" stroke="black" points="4901.26,-821.43 4749.72,-821.43 4710.74,-739.43 4862.28,-739.43 4901.26,-821.43"/>
<text text-anchor="middle" x="4806" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="4806" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4806" y="-766.93" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_res1&#45;&gt;d7_res2 -->
<g id="edge228" class="edge">
<title>d7_res1&#45;&gt;d7_res2</title>
<path fill="none" stroke="black" d="M4848.19,-1265.68C4848.19,-1265.68 4848.19,-831.77 4848.19,-831.77"/>
<polygon fill="black" stroke="black" points="4851.69,-831.77 4848.19,-821.77 4844.69,-831.77 4851.69,-831.77"/>
</g>
<!-- d7_mlp_gate -->
<g id="node171" class="node">
<title>d7_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="4684,-1047.43 4586,-1047.43 4586,-1006.43 4684,-1006.43 4684,-1047.43"/>
<text text-anchor="middle" x="4635" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="4635" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="4635" y="-1013.43" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_ln2&#45;&gt;d7_mlp_gate -->
<g id="edge223" class="edge">
<title>d7_ln2&#45;&gt;d7_mlp_gate</title>
<path fill="none" stroke="black" d="M4729.96,-1139C4702.55,-1139 4673.08,-1139 4673.08,-1139 4673.08,-1139 4673.08,-1057.48 4673.08,-1057.48"/>
<polygon fill="black" stroke="black" points="4676.58,-1057.48 4673.08,-1047.48 4669.58,-1057.48 4676.58,-1057.48"/>
</g>
<!-- d7_mlp_up -->
<g id="node172" class="node">
<title>d7_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="4825,-1047.43 4727,-1047.43 4727,-1006.43 4825,-1006.43 4825,-1047.43"/>
<text text-anchor="middle" x="4776" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="4776" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="4776" y="-1013.43" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_ln2&#45;&gt;d7_mlp_up -->
<g id="edge224" class="edge">
<title>d7_ln2&#45;&gt;d7_mlp_up</title>
<path fill="none" stroke="black" d="M4776,-1119.2C4776,-1119.2 4776,-1057.52 4776,-1057.52"/>
<polygon fill="black" stroke="black" points="4779.5,-1057.52 4776,-1047.52 4772.5,-1057.52 4779.5,-1057.52"/>
</g>
<!-- d7_mlp_down -->
<g id="node173" class="node">
<title>d7_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="4822,-934.43 4730,-934.43 4730,-893.43 4822,-893.43 4822,-934.43"/>
<text text-anchor="middle" x="4776" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="4776" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4776" y="-900.43" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_mlp_gate&#45;&gt;d7_mlp_down -->
<g id="edge225" class="edge">
<title>d7_mlp_gate&#45;&gt;d7_mlp_down</title>
<path fill="none" stroke="black" d="M4635,-1006.3C4635,-973.46 4635,-913 4635,-913 4635,-913 4719.83,-913 4719.83,-913"/>
<polygon fill="black" stroke="black" points="4719.83,-916.5 4729.83,-913 4719.83,-909.5 4719.83,-916.5"/>
</g>
<!-- d7_mlp_up&#45;&gt;d7_mlp_down -->
<g id="edge226" class="edge">
<title>d7_mlp_up&#45;&gt;d7_mlp_down</title>
<path fill="none" stroke="black" d="M4776,-1006.2C4776,-1006.2 4776,-944.52 4776,-944.52"/>
<polygon fill="black" stroke="black" points="4779.5,-944.52 4776,-934.52 4772.5,-944.52 4779.5,-944.52"/>
</g>
<!-- d7_mlp_down&#45;&gt;d7_res2 -->
<g id="edge227" class="edge">
<title>d7_mlp_down&#45;&gt;d7_res2</title>
<path fill="none" stroke="black" d="M4776,-893.36C4776,-893.36 4776,-831.48 4776,-831.48"/>
<polygon fill="black" stroke="black" points="4779.5,-831.48 4776,-821.48 4772.5,-831.48 4779.5,-831.48"/>
</g>
<!-- d7_layer1 -->
<g id="node175" class="node">
<title>d7_layer1</title>
<polygon fill="lightgray" stroke="black" points="4852,-667.43 4760,-667.43 4760,-626.43 4852,-626.43 4852,-667.43"/>
<text text-anchor="middle" x="4806" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="4806" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4806" y="-633.43" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_res2&#45;&gt;d7_layer1 -->
<g id="edge229" class="edge">
<title>d7_res2&#45;&gt;d7_layer1</title>
<path fill="none" stroke="black" d="M4806,-739.28C4806,-739.28 4806,-677.62 4806,-677.62"/>
<polygon fill="black" stroke="black" points="4809.5,-677.62 4806,-667.62 4802.5,-677.62 4809.5,-677.62"/>
</g>
<!-- d7_layer2 -->
<g id="node176" class="node">
<title>d7_layer2</title>
<polygon fill="lightgray" stroke="black" points="4852,-554.43 4760,-554.43 4760,-513.43 4852,-513.43 4852,-554.43"/>
<text text-anchor="middle" x="4806" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="4806" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4806" y="-520.43" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_layer1&#45;&gt;d7_layer2 -->
<g id="edge230" class="edge">
<title>d7_layer1&#45;&gt;d7_layer2</title>
<path fill="none" stroke="black" d="M4806,-626.2C4806,-626.2 4806,-564.52 4806,-564.52"/>
<polygon fill="black" stroke="black" points="4809.5,-564.52 4806,-554.52 4802.5,-564.52 4809.5,-564.52"/>
</g>
<!-- d7_layer3 -->
<g id="node177" class="node">
<title>d7_layer3</title>
<polygon fill="lightgray" stroke="black" points="4852,-441.43 4760,-441.43 4760,-400.43 4852,-400.43 4852,-441.43"/>
<text text-anchor="middle" x="4806" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="4806" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4806" y="-407.43" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_layer2&#45;&gt;d7_layer3 -->
<g id="edge231" class="edge">
<title>d7_layer2&#45;&gt;d7_layer3</title>
<path fill="none" stroke="black" d="M4806,-513.2C4806,-513.2 4806,-451.52 4806,-451.52"/>
<polygon fill="black" stroke="black" points="4809.5,-451.52 4806,-441.52 4802.5,-451.52 4809.5,-451.52"/>
</g>
<!-- d7_output -->
<g id="node178" class="node">
<title>d7_output</title>
<polygon fill="white" stroke="black" points="4901.26,-328.43 4749.72,-328.43 4710.74,-246.43 4862.28,-246.43 4901.26,-328.43"/>
<text text-anchor="middle" x="4806" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="4806" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="4806" y="-273.93" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- d7_layer3&#45;&gt;d7_output -->
<g id="edge232" class="edge">
<title>d7_layer3&#45;&gt;d7_output</title>
<path fill="none" stroke="black" d="M4806,-400.36C4806,-400.36 4806,-338.48 4806,-338.48"/>
<polygon fill="black" stroke="black" points="4809.5,-338.48 4806,-328.48 4802.5,-338.48 4809.5,-338.48"/>
</g>
<!-- d7_output&#45;&gt;sequence_agg -->
<g id="edge233" class="edge">
<title>d7_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M4877.39,-278.2C4877.39,-278.2 4877.39,-178.48 4877.39,-178.48"/>
<polygon fill="black" stroke="black" points="4880.89,-178.48 4877.39,-168.48 4873.89,-178.48 4880.89,-178.48"/>
</g>
<!-- d8_ln1 -->
<g id="node180" class="node">
<title>d8_ln1</title>
<polygon fill="white" stroke="black" points="5254,-1913.39 5162,-1913.39 5162,-1872.39 5254,-1872.39 5254,-1913.39"/>
<text text-anchor="middle" x="5208" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="5208" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5208" y="-1879.39" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_input&#45;&gt;d8_ln1 -->
<g id="edge235" class="edge">
<title>d8_input&#45;&gt;d8_ln1</title>
<path fill="none" stroke="black" d="M5208,-1985.28C5208,-1985.28 5208,-1923.77 5208,-1923.77"/>
<polygon fill="black" stroke="black" points="5211.5,-1923.77 5208,-1913.77 5204.5,-1923.77 5211.5,-1923.77"/>
</g>
<!-- d8_res1 -->
<g id="node191" class="node">
<title>d8_res1</title>
<polygon fill="white" stroke="black" points="5369.26,-1314.43 5217.72,-1314.43 5178.74,-1232.43 5330.28,-1232.43 5369.26,-1314.43"/>
<text text-anchor="middle" x="5274" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="5274" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5274" y="-1259.93" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_input&#45;&gt;d8_res1 -->
<g id="edge249" class="edge">
<title>d8_input&#45;&gt;d8_res1</title>
<path fill="none" stroke="black" d="M5263.27,-1999C5357.28,-1999 5538.23,-1999 5538.23,-1999 5538.23,-1999 5538.23,-1287 5538.23,-1287 5538.23,-1287 5366.52,-1287 5366.52,-1287"/>
<polygon fill="black" stroke="black" points="5366.52,-1283.5 5356.52,-1287 5366.52,-1290.5 5366.52,-1283.5"/>
</g>
<!-- d8_q -->
<g id="node181" class="node">
<title>d8_q</title>
<polygon fill="lightcoral" stroke="black" points="5091,-1800.39 4999,-1800.39 4999,-1759.39 5091,-1759.39 5091,-1800.39"/>
<text text-anchor="middle" x="5045" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="5045" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5045" y="-1766.39" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_ln1&#45;&gt;d8_q -->
<g id="edge236" class="edge">
<title>d8_ln1&#45;&gt;d8_q</title>
<path fill="none" stroke="black" d="M5161.67,-1899C5113.42,-1899 5044.79,-1899 5044.79,-1899 5044.79,-1899 5044.79,-1810.64 5044.79,-1810.64"/>
<polygon fill="black" stroke="black" points="5048.29,-1810.64 5044.79,-1800.64 5041.29,-1810.64 5048.29,-1810.64"/>
</g>
<!-- d8_k -->
<g id="node182" class="node">
<title>d8_k</title>
<polygon fill="lightcoral" stroke="black" points="5254,-1800.39 5162,-1800.39 5162,-1759.39 5254,-1759.39 5254,-1800.39"/>
<text text-anchor="middle" x="5208" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="5208" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5208" y="-1766.39" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_ln1&#45;&gt;d8_k -->
<g id="edge237" class="edge">
<title>d8_ln1&#45;&gt;d8_k</title>
<path fill="none" stroke="black" d="M5208,-1872.17C5208,-1872.17 5208,-1810.49 5208,-1810.49"/>
<polygon fill="black" stroke="black" points="5211.5,-1810.49 5208,-1800.49 5204.5,-1810.49 5211.5,-1810.49"/>
</g>
<!-- d8_v -->
<g id="node183" class="node">
<title>d8_v</title>
<polygon fill="lightcoral" stroke="black" points="5416,-1800.39 5324,-1800.39 5324,-1759.39 5416,-1759.39 5416,-1800.39"/>
<text text-anchor="middle" x="5370" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="5370" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5370" y="-1766.39" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_ln1&#45;&gt;d8_v -->
<g id="edge238" class="edge">
<title>d8_ln1&#45;&gt;d8_v</title>
<path fill="none" stroke="black" d="M5254.42,-1886C5302.29,-1886 5370,-1886 5370,-1886 5370,-1886 5370,-1810.6 5370,-1810.6"/>
<polygon fill="black" stroke="black" points="5373.5,-1810.6 5370,-1800.6 5366.5,-1810.6 5373.5,-1810.6"/>
</g>
<!-- d8_q_heads -->
<g id="node184" class="node">
<title>d8_q_heads</title>
<ellipse fill="white" stroke="black" cx="5018" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="5018" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="5018" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="5018" y="-1644.9" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_q&#45;&gt;d8_q_heads -->
<g id="edge239" class="edge">
<title>d8_q&#45;&gt;d8_q_heads</title>
<path fill="none" stroke="black" d="M5045,-1759.28C5045,-1759.28 5045,-1695.52 5045,-1695.52"/>
<polygon fill="black" stroke="black" points="5048.5,-1695.52 5045,-1685.52 5041.5,-1695.52 5048.5,-1695.52"/>
</g>
<!-- d8_k_heads -->
<g id="node185" class="node">
<title>d8_k_heads</title>
<ellipse fill="white" stroke="black" cx="5208" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="5208" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="5208" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="5208" y="-1644.9" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_k&#45;&gt;d8_k_heads -->
<g id="edge240" class="edge">
<title>d8_k&#45;&gt;d8_k_heads</title>
<path fill="none" stroke="black" d="M5208,-1759.28C5208,-1759.28 5208,-1697.78 5208,-1697.78"/>
<polygon fill="black" stroke="black" points="5211.5,-1697.78 5208,-1687.78 5204.5,-1697.78 5211.5,-1697.78"/>
</g>
<!-- d8_v_heads -->
<g id="node186" class="node">
<title>d8_v_heads</title>
<ellipse fill="white" stroke="black" cx="5398" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="5398" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="5398" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="5398" y="-1644.9" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_v&#45;&gt;d8_v_heads -->
<g id="edge241" class="edge">
<title>d8_v&#45;&gt;d8_v_heads</title>
<path fill="none" stroke="black" d="M5370.23,-1759.28C5370.23,-1759.28 5370.23,-1695.52 5370.23,-1695.52"/>
<polygon fill="black" stroke="black" points="5373.73,-1695.52 5370.23,-1685.52 5366.73,-1695.52 5373.73,-1695.52"/>
</g>
<!-- d8_ring_attn -->
<g id="node187" class="node">
<title>d8_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="5254,-1557.41 5162,-1557.41 5162,-1516.41 5254,-1516.41 5254,-1557.41"/>
<text text-anchor="middle" x="5208" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="5208" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5208" y="-1523.41" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_q_heads&#45;&gt;d8_ring_attn -->
<g id="edge242" class="edge">
<title>d8_q_heads&#45;&gt;d8_ring_attn</title>
<path fill="none" stroke="black" d="M5073.24,-1639.25C5073.24,-1607.4 5073.24,-1547 5073.24,-1547 5073.24,-1547 5151.62,-1547 5151.62,-1547"/>
<polygon fill="black" stroke="black" points="5151.62,-1550.5 5161.62,-1547 5151.62,-1543.5 5151.62,-1550.5"/>
</g>
<!-- d8_k_heads&#45;&gt;d8_ring_attn -->
<g id="edge243" class="edge">
<title>d8_k_heads&#45;&gt;d8_ring_attn</title>
<path fill="none" stroke="black" d="M5208,-1629.3C5208,-1629.3 5208,-1567.78 5208,-1567.78"/>
<polygon fill="black" stroke="black" points="5211.5,-1567.78 5208,-1557.78 5204.5,-1567.78 5211.5,-1567.78"/>
</g>
<!-- d8_v_heads&#45;&gt;d8_ring_attn -->
<g id="edge244" class="edge">
<title>d8_v_heads&#45;&gt;d8_ring_attn</title>
<path fill="none" stroke="black" d="M5346.92,-1637.49C5346.92,-1601.1 5346.92,-1530 5346.92,-1530 5346.92,-1530 5264.26,-1530 5264.26,-1530"/>
<polygon fill="black" stroke="black" points="5264.26,-1526.5 5254.26,-1530 5264.26,-1533.5 5264.26,-1526.5"/>
</g>
<!-- d8_send_kv -->
<g id="node188" class="node">
<title>d8_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5120" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="5120" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="5120" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5120" y="-1401.92" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_ring_attn&#45;&gt;d8_send_kv -->
<g id="edge245" class="edge">
<title>d8_ring_attn&#45;&gt;d8_send_kv</title>
<path fill="none" stroke="black" d="M5173.53,-1516.3C5173.53,-1516.3 5173.53,-1442.21 5173.53,-1442.21"/>
<polygon fill="black" stroke="black" points="5177.03,-1442.21 5173.53,-1432.21 5170.03,-1442.21 5177.03,-1442.21"/>
</g>
<!-- d8_out_proj -->
<g id="node190" class="node">
<title>d8_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="5320,-1435.92 5228,-1435.92 5228,-1394.92 5320,-1394.92 5320,-1435.92"/>
<text text-anchor="middle" x="5274" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="5274" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5274" y="-1401.92" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_ring_attn&#45;&gt;d8_out_proj -->
<g id="edge248" class="edge">
<title>d8_ring_attn&#45;&gt;d8_out_proj</title>
<path fill="none" stroke="black" d="M5241,-1516.3C5241,-1516.3 5241,-1446.13 5241,-1446.13"/>
<polygon fill="black" stroke="black" points="5244.5,-1446.13 5241,-1436.13 5237.5,-1446.13 5244.5,-1446.13"/>
</g>
<!-- d9_recv_kv -->
<g id="node211" class="node">
<title>d9_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5638" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="5638" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="5638" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5638" y="-2000.88" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d8_send_kv&#45;&gt;d9_recv_kv -->
<g id="edge246" class="edge">
<title>d8_send_kv&#45;&gt;d9_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5150.91,-1441C5240.46,-1441 5493.77,-1441 5493.77,-1441 5493.77,-1441 5493.77,-2028 5493.77,-2028 5493.77,-2028 5567.25,-2028 5567.25,-2028"/>
<polygon fill="black" stroke="black" points="5567.25,-2031.5 5577.25,-2028 5567.25,-2024.5 5567.25,-2031.5"/>
</g>
<!-- d8_send_kv&#45;&gt;d9_recv_kv -->
<g id="edge276" class="edge">
<title>d8_send_kv&#45;&gt;d9_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5160.89,-1438C5262.06,-1438 5516,-1438 5516,-1438 5516,-1438 5516,-2014 5516,-2014 5516,-2014 5559.16,-2014 5559.16,-2014"/>
<polygon fill="black" stroke="black" points="5559.16,-2017.5 5569.16,-2014 5559.16,-2010.5 5559.16,-2017.5"/>
</g>
<!-- d8_out_proj&#45;&gt;d8_res1 -->
<g id="edge250" class="edge">
<title>d8_out_proj&#45;&gt;d8_res1</title>
<path fill="none" stroke="black" d="M5274,-1394.77C5274,-1394.77 5274,-1324.63 5274,-1324.63"/>
<polygon fill="black" stroke="black" points="5277.5,-1324.63 5274,-1314.63 5270.5,-1324.63 5277.5,-1324.63"/>
</g>
<!-- d8_ln2 -->
<g id="node192" class="node">
<title>d8_ln2</title>
<polygon fill="white" stroke="black" points="5227,-1160.43 5135,-1160.43 5135,-1119.43 5227,-1119.43 5227,-1160.43"/>
<text text-anchor="middle" x="5181" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="5181" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5181" y="-1126.43" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_res1&#45;&gt;d8_ln2 -->
<g id="edge251" class="edge">
<title>d8_res1&#45;&gt;d8_ln2</title>
<path fill="none" stroke="black" d="M5202.81,-1232.28C5202.81,-1232.28 5202.81,-1170.62 5202.81,-1170.62"/>
<polygon fill="black" stroke="black" points="5206.31,-1170.62 5202.81,-1160.62 5199.31,-1170.62 5206.31,-1170.62"/>
</g>
<!-- d8_res2 -->
<g id="node196" class="node">
<title>d8_res2</title>
<polygon fill="white" stroke="black" points="5182.26,-821.43 5030.72,-821.43 4991.74,-739.43 5143.28,-739.43 5182.26,-821.43"/>
<text text-anchor="middle" x="5087" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="5087" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5087" y="-766.93" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_res1&#45;&gt;d8_res2 -->
<g id="edge257" class="edge">
<title>d8_res1&#45;&gt;d8_res2</title>
<path fill="none" stroke="black" d="M5299.69,-1232.21C5299.69,-1113.62 5299.69,-780 5299.69,-780 5299.69,-780 5172.59,-780 5172.59,-780"/>
<polygon fill="black" stroke="black" points="5172.59,-776.5 5162.59,-780 5172.59,-783.5 5172.59,-776.5"/>
</g>
<!-- d8_mlp_gate -->
<g id="node193" class="node">
<title>d8_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="5089,-1047.43 4991,-1047.43 4991,-1006.43 5089,-1006.43 5089,-1047.43"/>
<text text-anchor="middle" x="5040" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="5040" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="5040" y="-1013.43" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_ln2&#45;&gt;d8_mlp_gate -->
<g id="edge252" class="edge">
<title>d8_ln2&#45;&gt;d8_mlp_gate</title>
<path fill="none" stroke="black" d="M5134.76,-1139C5105.05,-1139 5071.97,-1139 5071.97,-1139 5071.97,-1139 5071.97,-1057.48 5071.97,-1057.48"/>
<polygon fill="black" stroke="black" points="5075.47,-1057.48 5071.97,-1047.48 5068.47,-1057.48 5075.47,-1057.48"/>
</g>
<!-- d8_mlp_up -->
<g id="node194" class="node">
<title>d8_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="5230,-1047.43 5132,-1047.43 5132,-1006.43 5230,-1006.43 5230,-1047.43"/>
<text text-anchor="middle" x="5181" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="5181" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="5181" y="-1013.43" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_ln2&#45;&gt;d8_mlp_up -->
<g id="edge253" class="edge">
<title>d8_ln2&#45;&gt;d8_mlp_up</title>
<path fill="none" stroke="black" d="M5181,-1119.2C5181,-1119.2 5181,-1057.52 5181,-1057.52"/>
<polygon fill="black" stroke="black" points="5184.5,-1057.52 5181,-1047.52 5177.5,-1057.52 5184.5,-1057.52"/>
</g>
<!-- d8_mlp_down -->
<g id="node195" class="node">
<title>d8_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="5133,-934.43 5041,-934.43 5041,-893.43 5133,-893.43 5133,-934.43"/>
<text text-anchor="middle" x="5087" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="5087" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5087" y="-900.43" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_mlp_gate&#45;&gt;d8_mlp_down -->
<g id="edge254" class="edge">
<title>d8_mlp_gate&#45;&gt;d8_mlp_down</title>
<path fill="none" stroke="black" d="M5065,-1006.2C5065,-1006.2 5065,-944.52 5065,-944.52"/>
<polygon fill="black" stroke="black" points="5068.5,-944.52 5065,-934.52 5061.5,-944.52 5068.5,-944.52"/>
</g>
<!-- d8_mlp_up&#45;&gt;d8_mlp_down -->
<g id="edge255" class="edge">
<title>d8_mlp_up&#45;&gt;d8_mlp_down</title>
<path fill="none" stroke="black" d="M5131.65,-1026C5119.8,-1026 5110.5,-1026 5110.5,-1026 5110.5,-1026 5110.5,-944.48 5110.5,-944.48"/>
<polygon fill="black" stroke="black" points="5114,-944.48 5110.5,-934.48 5107,-944.48 5114,-944.48"/>
</g>
<!-- d8_mlp_down&#45;&gt;d8_res2 -->
<g id="edge256" class="edge">
<title>d8_mlp_down&#45;&gt;d8_res2</title>
<path fill="none" stroke="black" d="M5087,-893.36C5087,-893.36 5087,-831.48 5087,-831.48"/>
<polygon fill="black" stroke="black" points="5090.5,-831.48 5087,-821.48 5083.5,-831.48 5090.5,-831.48"/>
</g>
<!-- d8_layer1 -->
<g id="node197" class="node">
<title>d8_layer1</title>
<polygon fill="lightgray" stroke="black" points="5130,-667.43 5038,-667.43 5038,-626.43 5130,-626.43 5130,-667.43"/>
<text text-anchor="middle" x="5084" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="5084" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5084" y="-633.43" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_res2&#45;&gt;d8_layer1 -->
<g id="edge258" class="edge">
<title>d8_res2&#45;&gt;d8_layer1</title>
<path fill="none" stroke="black" d="M5084,-739.28C5084,-739.28 5084,-677.62 5084,-677.62"/>
<polygon fill="black" stroke="black" points="5087.5,-677.62 5084,-667.62 5080.5,-677.62 5087.5,-677.62"/>
</g>
<!-- d8_layer2 -->
<g id="node198" class="node">
<title>d8_layer2</title>
<polygon fill="lightgray" stroke="black" points="5127,-554.43 5035,-554.43 5035,-513.43 5127,-513.43 5127,-554.43"/>
<text text-anchor="middle" x="5081" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="5081" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5081" y="-520.43" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_layer1&#45;&gt;d8_layer2 -->
<g id="edge259" class="edge">
<title>d8_layer1&#45;&gt;d8_layer2</title>
<path fill="none" stroke="black" d="M5082.5,-626.2C5082.5,-626.2 5082.5,-564.52 5082.5,-564.52"/>
<polygon fill="black" stroke="black" points="5086,-564.52 5082.5,-554.52 5079,-564.52 5086,-564.52"/>
</g>
<!-- d8_layer3 -->
<g id="node199" class="node">
<title>d8_layer3</title>
<polygon fill="lightgray" stroke="black" points="5121,-441.43 5029,-441.43 5029,-400.43 5121,-400.43 5121,-441.43"/>
<text text-anchor="middle" x="5075" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="5075" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5075" y="-407.43" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_layer2&#45;&gt;d8_layer3 -->
<g id="edge260" class="edge">
<title>d8_layer2&#45;&gt;d8_layer3</title>
<path fill="none" stroke="black" d="M5078,-513.2C5078,-513.2 5078,-451.52 5078,-451.52"/>
<polygon fill="black" stroke="black" points="5081.5,-451.52 5078,-441.52 5074.5,-451.52 5081.5,-451.52"/>
</g>
<!-- d8_output -->
<g id="node200" class="node">
<title>d8_output</title>
<polygon fill="white" stroke="black" points="5158.26,-328.43 5006.72,-328.43 4967.74,-246.43 5119.28,-246.43 5158.26,-328.43"/>
<text text-anchor="middle" x="5063" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="5063" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5063" y="-273.93" font-family="Arial" font-size="10.00">Device 8</text>
</g>
<!-- d8_layer3&#45;&gt;d8_output -->
<g id="edge261" class="edge">
<title>d8_layer3&#45;&gt;d8_output</title>
<path fill="none" stroke="black" d="M5075,-400.36C5075,-400.36 5075,-338.48 5075,-338.48"/>
<polygon fill="black" stroke="black" points="5078.5,-338.48 5075,-328.48 5071.5,-338.48 5078.5,-338.48"/>
</g>
<!-- d8_output&#45;&gt;sequence_agg -->
<g id="edge262" class="edge">
<title>d8_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M4991.11,-246.06C4991.11,-246.06 4991.11,-178.41 4991.11,-178.41"/>
<polygon fill="black" stroke="black" points="4994.61,-178.41 4991.11,-168.41 4987.61,-178.41 4994.61,-178.41"/>
</g>
<!-- d9_ln1 -->
<g id="node202" class="node">
<title>d9_ln1</title>
<polygon fill="white" stroke="black" points="5870,-1913.39 5778,-1913.39 5778,-1872.39 5870,-1872.39 5870,-1913.39"/>
<text text-anchor="middle" x="5824" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="5824" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5824" y="-1879.39" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_input&#45;&gt;d9_ln1 -->
<g id="edge264" class="edge">
<title>d9_input&#45;&gt;d9_ln1</title>
<path fill="none" stroke="black" d="M5824,-1985.28C5824,-1985.28 5824,-1923.77 5824,-1923.77"/>
<polygon fill="black" stroke="black" points="5827.5,-1923.77 5824,-1913.77 5820.5,-1923.77 5827.5,-1923.77"/>
</g>
<!-- d9_res1 -->
<g id="node213" class="node">
<title>d9_res1</title>
<polygon fill="white" stroke="black" points="6017.26,-1314.43 5865.72,-1314.43 5826.74,-1232.43 5978.28,-1232.43 6017.26,-1314.43"/>
<text text-anchor="middle" x="5922" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="5922" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5922" y="-1259.93" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_input&#45;&gt;d9_res1 -->
<g id="edge278" class="edge">
<title>d9_input&#45;&gt;d9_res1</title>
<path fill="none" stroke="black" d="M5879.42,-1999C5968.1,-1999 6132,-1999 6132,-1999 6132,-1999 6132,-1273 6132,-1273 6132,-1273 6007.81,-1273 6007.81,-1273"/>
<polygon fill="black" stroke="black" points="6007.81,-1269.5 5997.81,-1273 6007.81,-1276.5 6007.81,-1269.5"/>
</g>
<!-- d9_q -->
<g id="node203" class="node">
<title>d9_q</title>
<polygon fill="lightcoral" stroke="black" points="5708,-1800.39 5616,-1800.39 5616,-1759.39 5708,-1759.39 5708,-1800.39"/>
<text text-anchor="middle" x="5662" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="5662" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5662" y="-1766.39" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_ln1&#45;&gt;d9_q -->
<g id="edge265" class="edge">
<title>d9_ln1&#45;&gt;d9_q</title>
<path fill="none" stroke="black" d="M5777.81,-1899C5729.71,-1899 5661.29,-1899 5661.29,-1899 5661.29,-1899 5661.29,-1810.64 5661.29,-1810.64"/>
<polygon fill="black" stroke="black" points="5664.79,-1810.64 5661.29,-1800.64 5657.79,-1810.64 5664.79,-1810.64"/>
</g>
<!-- d9_k -->
<g id="node204" class="node">
<title>d9_k</title>
<polygon fill="lightcoral" stroke="black" points="5870,-1800.39 5778,-1800.39 5778,-1759.39 5870,-1759.39 5870,-1800.39"/>
<text text-anchor="middle" x="5824" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="5824" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5824" y="-1766.39" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_ln1&#45;&gt;d9_k -->
<g id="edge266" class="edge">
<title>d9_ln1&#45;&gt;d9_k</title>
<path fill="none" stroke="black" d="M5824,-1872.17C5824,-1872.17 5824,-1810.49 5824,-1810.49"/>
<polygon fill="black" stroke="black" points="5827.5,-1810.49 5824,-1800.49 5820.5,-1810.49 5827.5,-1810.49"/>
</g>
<!-- d9_v -->
<g id="node205" class="node">
<title>d9_v</title>
<polygon fill="lightcoral" stroke="black" points="6033,-1800.39 5941,-1800.39 5941,-1759.39 6033,-1759.39 6033,-1800.39"/>
<text text-anchor="middle" x="5987" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="5987" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5987" y="-1766.39" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_ln1&#45;&gt;d9_v -->
<g id="edge267" class="edge">
<title>d9_ln1&#45;&gt;d9_v</title>
<path fill="none" stroke="black" d="M5870.27,-1899C5918.46,-1899 5987,-1899 5987,-1899 5987,-1899 5987,-1810.64 5987,-1810.64"/>
<polygon fill="black" stroke="black" points="5990.5,-1810.64 5987,-1800.64 5983.5,-1810.64 5990.5,-1810.64"/>
</g>
<!-- d9_q_heads -->
<g id="node206" class="node">
<title>d9_q_heads</title>
<ellipse fill="white" stroke="black" cx="5634" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="5634" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="5634" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="5634" y="-1644.9" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_q&#45;&gt;d9_q_heads -->
<g id="edge268" class="edge">
<title>d9_q&#45;&gt;d9_q_heads</title>
<path fill="none" stroke="black" d="M5661.77,-1759.28C5661.77,-1759.28 5661.77,-1695.52 5661.77,-1695.52"/>
<polygon fill="black" stroke="black" points="5665.27,-1695.52 5661.77,-1685.52 5658.27,-1695.52 5665.27,-1695.52"/>
</g>
<!-- d9_k_heads -->
<g id="node207" class="node">
<title>d9_k_heads</title>
<ellipse fill="white" stroke="black" cx="5824" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="5824" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="5824" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="5824" y="-1644.9" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_k&#45;&gt;d9_k_heads -->
<g id="edge269" class="edge">
<title>d9_k&#45;&gt;d9_k_heads</title>
<path fill="none" stroke="black" d="M5824,-1759.28C5824,-1759.28 5824,-1697.78 5824,-1697.78"/>
<polygon fill="black" stroke="black" points="5827.5,-1697.78 5824,-1687.78 5820.5,-1697.78 5827.5,-1697.78"/>
</g>
<!-- d9_v_heads -->
<g id="node208" class="node">
<title>d9_v_heads</title>
<ellipse fill="white" stroke="black" cx="6014" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="6014" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="6014" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="6014" y="-1644.9" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_v&#45;&gt;d9_v_heads -->
<g id="edge270" class="edge">
<title>d9_v&#45;&gt;d9_v_heads</title>
<path fill="none" stroke="black" d="M5987,-1759.28C5987,-1759.28 5987,-1695.52 5987,-1695.52"/>
<polygon fill="black" stroke="black" points="5990.5,-1695.52 5987,-1685.52 5983.5,-1695.52 5990.5,-1695.52"/>
</g>
<!-- d9_ring_attn -->
<g id="node209" class="node">
<title>d9_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="5870,-1557.41 5778,-1557.41 5778,-1516.41 5870,-1516.41 5870,-1557.41"/>
<text text-anchor="middle" x="5824" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="5824" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5824" y="-1523.41" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_q_heads&#45;&gt;d9_ring_attn -->
<g id="edge271" class="edge">
<title>d9_q_heads&#45;&gt;d9_ring_attn</title>
<path fill="none" stroke="black" d="M5670.97,-1633.08C5670.97,-1599.11 5670.97,-1543 5670.97,-1543 5670.97,-1543 5767.67,-1543 5767.67,-1543"/>
<polygon fill="black" stroke="black" points="5767.67,-1546.5 5777.67,-1543 5767.67,-1539.5 5767.67,-1546.5"/>
</g>
<!-- d9_k_heads&#45;&gt;d9_ring_attn -->
<g id="edge272" class="edge">
<title>d9_k_heads&#45;&gt;d9_ring_attn</title>
<path fill="none" stroke="black" d="M5824,-1629.3C5824,-1629.3 5824,-1567.78 5824,-1567.78"/>
<polygon fill="black" stroke="black" points="5827.5,-1567.78 5824,-1557.78 5820.5,-1567.78 5827.5,-1567.78"/>
</g>
<!-- d9_v_heads&#45;&gt;d9_ring_attn -->
<g id="edge273" class="edge">
<title>d9_v_heads&#45;&gt;d9_ring_attn</title>
<path fill="none" stroke="black" d="M5954.23,-1641.38C5954.23,-1607.75 5954.23,-1536 5954.23,-1536 5954.23,-1536 5880.28,-1536 5880.28,-1536"/>
<polygon fill="black" stroke="black" points="5880.28,-1532.5 5870.28,-1536 5880.28,-1539.5 5880.28,-1532.5"/>
</g>
<!-- d9_send_kv -->
<g id="node210" class="node">
<title>d9_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5768" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="5768" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="5768" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5768" y="-1401.92" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_ring_attn&#45;&gt;d9_send_kv -->
<g id="edge274" class="edge">
<title>d9_ring_attn&#45;&gt;d9_send_kv</title>
<path fill="none" stroke="black" d="M5805.53,-1516.3C5805.53,-1516.3 5805.53,-1449.47 5805.53,-1449.47"/>
<polygon fill="black" stroke="black" points="5809.03,-1449.47 5805.53,-1439.47 5802.03,-1449.47 5809.03,-1449.47"/>
</g>
<!-- d9_out_proj -->
<g id="node212" class="node">
<title>d9_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="5968,-1435.92 5876,-1435.92 5876,-1394.92 5968,-1394.92 5968,-1435.92"/>
<text text-anchor="middle" x="5922" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="5922" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5922" y="-1401.92" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_ring_attn&#45;&gt;d9_out_proj -->
<g id="edge277" class="edge">
<title>d9_ring_attn&#45;&gt;d9_out_proj</title>
<path fill="none" stroke="black" d="M5870.28,-1526C5879.69,-1526 5886.77,-1526 5886.77,-1526 5886.77,-1526 5886.77,-1445.96 5886.77,-1445.96"/>
<polygon fill="black" stroke="black" points="5890.27,-1445.96 5886.77,-1435.96 5883.27,-1445.96 5890.27,-1445.96"/>
</g>
<!-- d10_recv_kv -->
<g id="node233" class="node">
<title>d10_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6254" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="6254" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="6254" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6254" y="-2000.88" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d9_send_kv&#45;&gt;d10_recv_kv -->
<g id="edge275" class="edge">
<title>d9_send_kv&#45;&gt;d10_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5798.86,-1441C5841.13,-1441 5911.85,-1441 5911.85,-1441 5911.85,-1441 5911.85,-2028 5911.85,-2028 5911.85,-2028 6183.22,-2028 6183.22,-2028"/>
<polygon fill="black" stroke="black" points="6183.22,-2031.5 6193.22,-2028 6183.22,-2024.5 6183.22,-2031.5"/>
</g>
<!-- d9_send_kv&#45;&gt;d10_recv_kv -->
<g id="edge305" class="edge">
<title>d9_send_kv&#45;&gt;d10_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5809.14,-1438C5856,-1438 5926.15,-1438 5926.15,-1438 5926.15,-1438 5926.15,-2014 5926.15,-2014 5926.15,-2014 6175.27,-2014 6175.27,-2014"/>
<polygon fill="black" stroke="black" points="6175.27,-2017.5 6185.27,-2014 6175.27,-2010.5 6175.27,-2017.5"/>
</g>
<!-- d9_out_proj&#45;&gt;d9_res1 -->
<g id="edge279" class="edge">
<title>d9_out_proj&#45;&gt;d9_res1</title>
<path fill="none" stroke="black" d="M5922,-1394.77C5922,-1394.77 5922,-1324.63 5922,-1324.63"/>
<polygon fill="black" stroke="black" points="5925.5,-1324.63 5922,-1314.63 5918.5,-1324.63 5925.5,-1324.63"/>
</g>
<!-- d9_ln2 -->
<g id="node214" class="node">
<title>d9_ln2</title>
<polygon fill="white" stroke="black" points="5875,-1160.43 5783,-1160.43 5783,-1119.43 5875,-1119.43 5875,-1160.43"/>
<text text-anchor="middle" x="5829" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="5829" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5829" y="-1126.43" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_res1&#45;&gt;d9_ln2 -->
<g id="edge280" class="edge">
<title>d9_res1&#45;&gt;d9_ln2</title>
<path fill="none" stroke="black" d="M5850.81,-1232.28C5850.81,-1232.28 5850.81,-1170.62 5850.81,-1170.62"/>
<polygon fill="black" stroke="black" points="5854.31,-1170.62 5850.81,-1160.62 5847.31,-1170.62 5854.31,-1170.62"/>
</g>
<!-- d9_res2 -->
<g id="node218" class="node">
<title>d9_res2</title>
<polygon fill="white" stroke="black" points="5806.26,-821.43 5654.72,-821.43 5615.74,-739.43 5767.28,-739.43 5806.26,-821.43"/>
<text text-anchor="middle" x="5711" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="5711" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5711" y="-766.93" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_res1&#45;&gt;d9_res2 -->
<g id="edge286" class="edge">
<title>d9_res1&#45;&gt;d9_res2</title>
<path fill="none" stroke="black" d="M5838.96,-1259C5802.79,-1259 5768.5,-1259 5768.5,-1259 5768.5,-1259 5768.5,-831.64 5768.5,-831.64"/>
<polygon fill="black" stroke="black" points="5772,-831.64 5768.5,-821.64 5765,-831.64 5772,-831.64"/>
</g>
<!-- d9_mlp_gate -->
<g id="node215" class="node">
<title>d9_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="5737,-1047.43 5639,-1047.43 5639,-1006.43 5737,-1006.43 5737,-1047.43"/>
<text text-anchor="middle" x="5688" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="5688" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="5688" y="-1013.43" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_ln2&#45;&gt;d9_mlp_gate -->
<g id="edge281" class="edge">
<title>d9_ln2&#45;&gt;d9_mlp_gate</title>
<path fill="none" stroke="black" d="M5782.76,-1139C5753.05,-1139 5719.97,-1139 5719.97,-1139 5719.97,-1139 5719.97,-1057.48 5719.97,-1057.48"/>
<polygon fill="black" stroke="black" points="5723.47,-1057.48 5719.97,-1047.48 5716.47,-1057.48 5723.47,-1057.48"/>
</g>
<!-- d9_mlp_up -->
<g id="node216" class="node">
<title>d9_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="5878,-1047.43 5780,-1047.43 5780,-1006.43 5878,-1006.43 5878,-1047.43"/>
<text text-anchor="middle" x="5829" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="5829" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="5829" y="-1013.43" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_ln2&#45;&gt;d9_mlp_up -->
<g id="edge282" class="edge">
<title>d9_ln2&#45;&gt;d9_mlp_up</title>
<path fill="none" stroke="black" d="M5829,-1119.2C5829,-1119.2 5829,-1057.52 5829,-1057.52"/>
<polygon fill="black" stroke="black" points="5832.5,-1057.52 5829,-1047.52 5825.5,-1057.52 5832.5,-1057.52"/>
</g>
<!-- d9_mlp_down -->
<g id="node217" class="node">
<title>d9_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="5757,-934.43 5665,-934.43 5665,-893.43 5757,-893.43 5757,-934.43"/>
<text text-anchor="middle" x="5711" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="5711" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5711" y="-900.43" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_mlp_gate&#45;&gt;d9_mlp_down -->
<g id="edge283" class="edge">
<title>d9_mlp_gate&#45;&gt;d9_mlp_down</title>
<path fill="none" stroke="black" d="M5701,-1006.2C5701,-1006.2 5701,-944.52 5701,-944.52"/>
<polygon fill="black" stroke="black" points="5704.5,-944.52 5701,-934.52 5697.5,-944.52 5704.5,-944.52"/>
</g>
<!-- d9_mlp_up&#45;&gt;d9_mlp_down -->
<g id="edge284" class="edge">
<title>d9_mlp_up&#45;&gt;d9_mlp_down</title>
<path fill="none" stroke="black" d="M5779.88,-1026C5762.42,-1026 5747,-1026 5747,-1026 5747,-1026 5747,-944.48 5747,-944.48"/>
<polygon fill="black" stroke="black" points="5750.5,-944.48 5747,-934.48 5743.5,-944.48 5750.5,-944.48"/>
</g>
<!-- d9_mlp_down&#45;&gt;d9_res2 -->
<g id="edge285" class="edge">
<title>d9_mlp_down&#45;&gt;d9_res2</title>
<path fill="none" stroke="black" d="M5711,-893.36C5711,-893.36 5711,-831.48 5711,-831.48"/>
<polygon fill="black" stroke="black" points="5714.5,-831.48 5711,-821.48 5707.5,-831.48 5714.5,-831.48"/>
</g>
<!-- d9_layer1 -->
<g id="node219" class="node">
<title>d9_layer1</title>
<polygon fill="lightgray" stroke="black" points="5753,-667.43 5661,-667.43 5661,-626.43 5753,-626.43 5753,-667.43"/>
<text text-anchor="middle" x="5707" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="5707" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5707" y="-633.43" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_res2&#45;&gt;d9_layer1 -->
<g id="edge287" class="edge">
<title>d9_res2&#45;&gt;d9_layer1</title>
<path fill="none" stroke="black" d="M5707,-739.28C5707,-739.28 5707,-677.62 5707,-677.62"/>
<polygon fill="black" stroke="black" points="5710.5,-677.62 5707,-667.62 5703.5,-677.62 5710.5,-677.62"/>
</g>
<!-- d9_layer2 -->
<g id="node220" class="node">
<title>d9_layer2</title>
<polygon fill="lightgray" stroke="black" points="5750,-554.43 5658,-554.43 5658,-513.43 5750,-513.43 5750,-554.43"/>
<text text-anchor="middle" x="5704" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="5704" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5704" y="-520.43" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_layer1&#45;&gt;d9_layer2 -->
<g id="edge288" class="edge">
<title>d9_layer1&#45;&gt;d9_layer2</title>
<path fill="none" stroke="black" d="M5705.5,-626.2C5705.5,-626.2 5705.5,-564.52 5705.5,-564.52"/>
<polygon fill="black" stroke="black" points="5709,-564.52 5705.5,-554.52 5702,-564.52 5709,-564.52"/>
</g>
<!-- d9_layer3 -->
<g id="node221" class="node">
<title>d9_layer3</title>
<polygon fill="lightgray" stroke="black" points="5743,-441.43 5651,-441.43 5651,-400.43 5743,-400.43 5743,-441.43"/>
<text text-anchor="middle" x="5697" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="5697" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5697" y="-407.43" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_layer2&#45;&gt;d9_layer3 -->
<g id="edge289" class="edge">
<title>d9_layer2&#45;&gt;d9_layer3</title>
<path fill="none" stroke="black" d="M5700.5,-513.2C5700.5,-513.2 5700.5,-451.52 5700.5,-451.52"/>
<polygon fill="black" stroke="black" points="5704,-451.52 5700.5,-441.52 5697,-451.52 5704,-451.52"/>
</g>
<!-- d9_output -->
<g id="node222" class="node">
<title>d9_output</title>
<polygon fill="white" stroke="black" points="5778.26,-328.43 5626.72,-328.43 5587.74,-246.43 5739.28,-246.43 5778.26,-328.43"/>
<text text-anchor="middle" x="5683" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="5683" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="5683" y="-273.93" font-family="Arial" font-size="10.00">Device 9</text>
</g>
<!-- d9_layer3&#45;&gt;d9_output -->
<g id="edge290" class="edge">
<title>d9_layer3&#45;&gt;d9_output</title>
<path fill="none" stroke="black" d="M5697,-400.36C5697,-400.36 5697,-338.48 5697,-338.48"/>
<polygon fill="black" stroke="black" points="5700.5,-338.48 5697,-328.48 5693.5,-338.48 5700.5,-338.48"/>
</g>
<!-- d9_output&#45;&gt;sequence_agg -->
<g id="edge291" class="edge">
<title>d9_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M5683,-246.34C5683,-212.13 5683,-169 5683,-169 5683,-169 4997.87,-169 4997.87,-169"/>
<polygon fill="black" stroke="black" points="4997.87,-165.5 4987.87,-169 4997.87,-172.5 4997.87,-165.5"/>
</g>
<!-- d10_ln1 -->
<g id="node224" class="node">
<title>d10_ln1</title>
<polygon fill="white" stroke="black" points="6486,-1913.39 6394,-1913.39 6394,-1872.39 6486,-1872.39 6486,-1913.39"/>
<text text-anchor="middle" x="6440" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="6440" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6440" y="-1879.39" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_input&#45;&gt;d10_ln1 -->
<g id="edge293" class="edge">
<title>d10_input&#45;&gt;d10_ln1</title>
<path fill="none" stroke="black" d="M6440,-1985.28C6440,-1985.28 6440,-1923.77 6440,-1923.77"/>
<polygon fill="black" stroke="black" points="6443.5,-1923.77 6440,-1913.77 6436.5,-1923.77 6443.5,-1923.77"/>
</g>
<!-- d10_res1 -->
<g id="node235" class="node">
<title>d10_res1</title>
<polygon fill="white" stroke="black" points="6577.26,-1314.43 6425.72,-1314.43 6386.74,-1232.43 6538.28,-1232.43 6577.26,-1314.43"/>
<text text-anchor="middle" x="6482" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="6482" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6482" y="-1259.93" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_input&#45;&gt;d10_res1 -->
<g id="edge307" class="edge">
<title>d10_input&#45;&gt;d10_res1</title>
<path fill="none" stroke="black" d="M6495.46,-1999C6522.38,-1999 6549,-1999 6549,-1999 6549,-1999 6549,-1324.52 6549,-1324.52"/>
<polygon fill="black" stroke="black" points="6552.5,-1324.52 6549,-1314.52 6545.5,-1324.52 6552.5,-1324.52"/>
</g>
<!-- d10_q -->
<g id="node225" class="node">
<title>d10_q</title>
<polygon fill="lightcoral" stroke="black" points="6324,-1800.39 6232,-1800.39 6232,-1759.39 6324,-1759.39 6324,-1800.39"/>
<text text-anchor="middle" x="6278" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="6278" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6278" y="-1766.39" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_ln1&#45;&gt;d10_q -->
<g id="edge294" class="edge">
<title>d10_ln1&#45;&gt;d10_q</title>
<path fill="none" stroke="black" d="M6393.81,-1886C6345.71,-1886 6277.29,-1886 6277.29,-1886 6277.29,-1886 6277.29,-1810.6 6277.29,-1810.6"/>
<polygon fill="black" stroke="black" points="6280.79,-1810.6 6277.29,-1800.6 6273.79,-1810.6 6280.79,-1810.6"/>
</g>
<!-- d10_k -->
<g id="node226" class="node">
<title>d10_k</title>
<polygon fill="lightcoral" stroke="black" points="6486,-1800.39 6394,-1800.39 6394,-1759.39 6486,-1759.39 6486,-1800.39"/>
<text text-anchor="middle" x="6440" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="6440" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6440" y="-1766.39" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_ln1&#45;&gt;d10_k -->
<g id="edge295" class="edge">
<title>d10_ln1&#45;&gt;d10_k</title>
<path fill="none" stroke="black" d="M6440,-1872.17C6440,-1872.17 6440,-1810.49 6440,-1810.49"/>
<polygon fill="black" stroke="black" points="6443.5,-1810.49 6440,-1800.49 6436.5,-1810.49 6443.5,-1810.49"/>
</g>
<!-- d10_v -->
<g id="node227" class="node">
<title>d10_v</title>
<polygon fill="lightcoral" stroke="black" points="6648,-1800.39 6556,-1800.39 6556,-1759.39 6648,-1759.39 6648,-1800.39"/>
<text text-anchor="middle" x="6602" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="6602" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6602" y="-1766.39" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_ln1&#45;&gt;d10_v -->
<g id="edge296" class="edge">
<title>d10_ln1&#45;&gt;d10_v</title>
<path fill="none" stroke="black" d="M6486.42,-1886C6534.29,-1886 6602,-1886 6602,-1886 6602,-1886 6602,-1810.6 6602,-1810.6"/>
<polygon fill="black" stroke="black" points="6605.5,-1810.6 6602,-1800.6 6598.5,-1810.6 6605.5,-1810.6"/>
</g>
<!-- d10_q_heads -->
<g id="node228" class="node">
<title>d10_q_heads</title>
<ellipse fill="white" stroke="black" cx="6250" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="6250" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="6250" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="6250" y="-1644.9" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_q&#45;&gt;d10_q_heads -->
<g id="edge297" class="edge">
<title>d10_q&#45;&gt;d10_q_heads</title>
<path fill="none" stroke="black" d="M6277.77,-1759.28C6277.77,-1759.28 6277.77,-1695.52 6277.77,-1695.52"/>
<polygon fill="black" stroke="black" points="6281.27,-1695.52 6277.77,-1685.52 6274.27,-1695.52 6281.27,-1695.52"/>
</g>
<!-- d10_k_heads -->
<g id="node229" class="node">
<title>d10_k_heads</title>
<ellipse fill="white" stroke="black" cx="6440" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="6440" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="6440" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="6440" y="-1644.9" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_k&#45;&gt;d10_k_heads -->
<g id="edge298" class="edge">
<title>d10_k&#45;&gt;d10_k_heads</title>
<path fill="none" stroke="black" d="M6440,-1759.28C6440,-1759.28 6440,-1697.78 6440,-1697.78"/>
<polygon fill="black" stroke="black" points="6443.5,-1697.78 6440,-1687.78 6436.5,-1697.78 6443.5,-1697.78"/>
</g>
<!-- d10_v_heads -->
<g id="node230" class="node">
<title>d10_v_heads</title>
<ellipse fill="white" stroke="black" cx="6630" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="6630" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="6630" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="6630" y="-1644.9" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_v&#45;&gt;d10_v_heads -->
<g id="edge299" class="edge">
<title>d10_v&#45;&gt;d10_v_heads</title>
<path fill="none" stroke="black" d="M6602.23,-1759.28C6602.23,-1759.28 6602.23,-1695.52 6602.23,-1695.52"/>
<polygon fill="black" stroke="black" points="6605.73,-1695.52 6602.23,-1685.52 6598.73,-1695.52 6605.73,-1695.52"/>
</g>
<!-- d10_ring_attn -->
<g id="node231" class="node">
<title>d10_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="6486,-1557.41 6394,-1557.41 6394,-1516.41 6486,-1516.41 6486,-1557.41"/>
<text text-anchor="middle" x="6440" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="6440" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6440" y="-1523.41" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_q_heads&#45;&gt;d10_ring_attn -->
<g id="edge300" class="edge">
<title>d10_q_heads&#45;&gt;d10_ring_attn</title>
<path fill="none" stroke="black" d="M6293.24,-1634.78C6293.24,-1602.07 6293.24,-1547 6293.24,-1547 6293.24,-1547 6383.97,-1547 6383.97,-1547"/>
<polygon fill="black" stroke="black" points="6383.97,-1550.5 6393.97,-1547 6383.97,-1543.5 6383.97,-1550.5"/>
</g>
<!-- d10_k_heads&#45;&gt;d10_ring_attn -->
<g id="edge301" class="edge">
<title>d10_k_heads&#45;&gt;d10_ring_attn</title>
<path fill="none" stroke="black" d="M6440,-1629.3C6440,-1629.3 6440,-1567.78 6440,-1567.78"/>
<polygon fill="black" stroke="black" points="6443.5,-1567.78 6440,-1557.78 6436.5,-1567.78 6443.5,-1567.78"/>
</g>
<!-- d10_v_heads&#45;&gt;d10_ring_attn -->
<g id="edge302" class="edge">
<title>d10_v_heads&#45;&gt;d10_ring_attn</title>
<path fill="none" stroke="black" d="M6566.92,-1643.42C6566.92,-1609.55 6566.92,-1530 6566.92,-1530 6566.92,-1530 6496.18,-1530 6496.18,-1530"/>
<polygon fill="black" stroke="black" points="6496.18,-1526.5 6486.18,-1530 6496.18,-1533.5 6496.18,-1526.5"/>
</g>
<!-- d10_send_kv -->
<g id="node232" class="node">
<title>d10_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6328" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="6328" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="6328" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6328" y="-1401.92" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_ring_attn&#45;&gt;d10_send_kv -->
<g id="edge303" class="edge">
<title>d10_ring_attn&#45;&gt;d10_send_kv</title>
<path fill="none" stroke="black" d="M6415,-1516.32C6415,-1488.4 6415,-1442 6415,-1442 6415,-1442 6364.1,-1442 6364.1,-1442"/>
<polygon fill="black" stroke="black" points="6364.1,-1438.5 6354.1,-1442 6364.1,-1445.5 6364.1,-1438.5"/>
</g>
<!-- d10_out_proj -->
<g id="node234" class="node">
<title>d10_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="6528,-1435.92 6436,-1435.92 6436,-1394.92 6528,-1394.92 6528,-1435.92"/>
<text text-anchor="middle" x="6482" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="6482" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6482" y="-1401.92" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_ring_attn&#45;&gt;d10_out_proj -->
<g id="edge306" class="edge">
<title>d10_ring_attn&#45;&gt;d10_out_proj</title>
<path fill="none" stroke="black" d="M6461,-1516.3C6461,-1516.3 6461,-1446.13 6461,-1446.13"/>
<polygon fill="black" stroke="black" points="6464.5,-1446.13 6461,-1436.13 6457.5,-1446.13 6464.5,-1446.13"/>
</g>
<!-- d11_recv_kv -->
<g id="node255" class="node">
<title>d11_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6870" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="6870" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="6870" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6870" y="-2000.88" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d10_send_kv&#45;&gt;d11_recv_kv -->
<g id="edge304" class="edge">
<title>d10_send_kv&#45;&gt;d11_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6362.65,-1440C6421.57,-1440 6535,-1440 6535,-1440 6535,-1440 6535,-2028 6535,-2028 6535,-2028 6799.33,-2028 6799.33,-2028"/>
<polygon fill="black" stroke="black" points="6799.33,-2031.5 6809.33,-2028 6799.33,-2024.5 6799.33,-2031.5"/>
</g>
<!-- d10_send_kv&#45;&gt;d11_recv_kv -->
<g id="edge334" class="edge">
<title>d10_send_kv&#45;&gt;d11_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6369.01,-1438C6431.15,-1438 6542,-1438 6542,-1438 6542,-1438 6542,-2014 6542,-2014 6542,-2014 6791.24,-2014 6791.24,-2014"/>
<polygon fill="black" stroke="black" points="6791.24,-2017.5 6801.24,-2014 6791.24,-2010.5 6791.24,-2017.5"/>
</g>
<!-- d10_out_proj&#45;&gt;d10_res1 -->
<g id="edge308" class="edge">
<title>d10_out_proj&#45;&gt;d10_res1</title>
<path fill="none" stroke="black" d="M6482,-1394.77C6482,-1394.77 6482,-1324.63 6482,-1324.63"/>
<polygon fill="black" stroke="black" points="6485.5,-1324.63 6482,-1314.63 6478.5,-1324.63 6485.5,-1324.63"/>
</g>
<!-- d10_ln2 -->
<g id="node236" class="node">
<title>d10_ln2</title>
<polygon fill="white" stroke="black" points="6435,-1160.43 6343,-1160.43 6343,-1119.43 6435,-1119.43 6435,-1160.43"/>
<text text-anchor="middle" x="6389" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="6389" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6389" y="-1126.43" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_res1&#45;&gt;d10_ln2 -->
<g id="edge309" class="edge">
<title>d10_res1&#45;&gt;d10_ln2</title>
<path fill="none" stroke="black" d="M6410.81,-1232.28C6410.81,-1232.28 6410.81,-1170.62 6410.81,-1170.62"/>
<polygon fill="black" stroke="black" points="6414.31,-1170.62 6410.81,-1160.62 6407.31,-1170.62 6414.31,-1170.62"/>
</g>
<!-- d10_res2 -->
<g id="node240" class="node">
<title>d10_res2</title>
<polygon fill="white" stroke="black" points="6425.26,-821.43 6273.72,-821.43 6234.74,-739.43 6386.28,-739.43 6425.26,-821.43"/>
<text text-anchor="middle" x="6330" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="6330" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6330" y="-766.93" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_res1&#45;&gt;d10_res2 -->
<g id="edge315" class="edge">
<title>d10_res1&#45;&gt;d10_res2</title>
<path fill="none" stroke="black" d="M6507.69,-1232.21C6507.69,-1113.62 6507.69,-780 6507.69,-780 6507.69,-780 6415.61,-780 6415.61,-780"/>
<polygon fill="black" stroke="black" points="6415.61,-776.5 6405.61,-780 6415.61,-783.5 6415.61,-776.5"/>
</g>
<!-- d10_mlp_gate -->
<g id="node237" class="node">
<title>d10_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="6297,-1047.43 6199,-1047.43 6199,-1006.43 6297,-1006.43 6297,-1047.43"/>
<text text-anchor="middle" x="6248" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="6248" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="6248" y="-1013.43" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_ln2&#45;&gt;d10_mlp_gate -->
<g id="edge310" class="edge">
<title>d10_ln2&#45;&gt;d10_mlp_gate</title>
<path fill="none" stroke="black" d="M6342.76,-1139C6313.05,-1139 6279.97,-1139 6279.97,-1139 6279.97,-1139 6279.97,-1057.48 6279.97,-1057.48"/>
<polygon fill="black" stroke="black" points="6283.47,-1057.48 6279.97,-1047.48 6276.47,-1057.48 6283.47,-1057.48"/>
</g>
<!-- d10_mlp_up -->
<g id="node238" class="node">
<title>d10_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="6438,-1047.43 6340,-1047.43 6340,-1006.43 6438,-1006.43 6438,-1047.43"/>
<text text-anchor="middle" x="6389" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="6389" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="6389" y="-1013.43" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_ln2&#45;&gt;d10_mlp_up -->
<g id="edge311" class="edge">
<title>d10_ln2&#45;&gt;d10_mlp_up</title>
<path fill="none" stroke="black" d="M6389,-1119.2C6389,-1119.2 6389,-1057.52 6389,-1057.52"/>
<polygon fill="black" stroke="black" points="6392.5,-1057.52 6389,-1047.52 6385.5,-1057.52 6392.5,-1057.52"/>
</g>
<!-- d10_mlp_down -->
<g id="node239" class="node">
<title>d10_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="6376,-934.43 6284,-934.43 6284,-893.43 6376,-893.43 6376,-934.43"/>
<text text-anchor="middle" x="6330" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="6330" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6330" y="-900.43" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_mlp_gate&#45;&gt;d10_mlp_down -->
<g id="edge312" class="edge">
<title>d10_mlp_gate&#45;&gt;d10_mlp_down</title>
<path fill="none" stroke="black" d="M6290.5,-1006.2C6290.5,-1006.2 6290.5,-944.52 6290.5,-944.52"/>
<polygon fill="black" stroke="black" points="6294,-944.52 6290.5,-934.52 6287,-944.52 6294,-944.52"/>
</g>
<!-- d10_mlp_up&#45;&gt;d10_mlp_down -->
<g id="edge313" class="edge">
<title>d10_mlp_up&#45;&gt;d10_mlp_down</title>
<path fill="none" stroke="black" d="M6358,-1006.2C6358,-1006.2 6358,-944.52 6358,-944.52"/>
<polygon fill="black" stroke="black" points="6361.5,-944.52 6358,-934.52 6354.5,-944.52 6361.5,-944.52"/>
</g>
<!-- d10_mlp_down&#45;&gt;d10_res2 -->
<g id="edge314" class="edge">
<title>d10_mlp_down&#45;&gt;d10_res2</title>
<path fill="none" stroke="black" d="M6330,-893.36C6330,-893.36 6330,-831.48 6330,-831.48"/>
<polygon fill="black" stroke="black" points="6333.5,-831.48 6330,-821.48 6326.5,-831.48 6333.5,-831.48"/>
</g>
<!-- d10_layer1 -->
<g id="node241" class="node">
<title>d10_layer1</title>
<polygon fill="lightgray" stroke="black" points="6372,-667.43 6280,-667.43 6280,-626.43 6372,-626.43 6372,-667.43"/>
<text text-anchor="middle" x="6326" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="6326" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6326" y="-633.43" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_res2&#45;&gt;d10_layer1 -->
<g id="edge316" class="edge">
<title>d10_res2&#45;&gt;d10_layer1</title>
<path fill="none" stroke="black" d="M6326,-739.28C6326,-739.28 6326,-677.62 6326,-677.62"/>
<polygon fill="black" stroke="black" points="6329.5,-677.62 6326,-667.62 6322.5,-677.62 6329.5,-677.62"/>
</g>
<!-- d10_layer2 -->
<g id="node242" class="node">
<title>d10_layer2</title>
<polygon fill="lightgray" stroke="black" points="6368,-554.43 6276,-554.43 6276,-513.43 6368,-513.43 6368,-554.43"/>
<text text-anchor="middle" x="6322" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="6322" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6322" y="-520.43" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_layer1&#45;&gt;d10_layer2 -->
<g id="edge317" class="edge">
<title>d10_layer1&#45;&gt;d10_layer2</title>
<path fill="none" stroke="black" d="M6324,-626.2C6324,-626.2 6324,-564.52 6324,-564.52"/>
<polygon fill="black" stroke="black" points="6327.5,-564.52 6324,-554.52 6320.5,-564.52 6327.5,-564.52"/>
</g>
<!-- d10_layer3 -->
<g id="node243" class="node">
<title>d10_layer3</title>
<polygon fill="lightgray" stroke="black" points="6361,-441.43 6269,-441.43 6269,-400.43 6361,-400.43 6361,-441.43"/>
<text text-anchor="middle" x="6315" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="6315" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6315" y="-407.43" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_layer2&#45;&gt;d10_layer3 -->
<g id="edge318" class="edge">
<title>d10_layer2&#45;&gt;d10_layer3</title>
<path fill="none" stroke="black" d="M6318.5,-513.2C6318.5,-513.2 6318.5,-451.52 6318.5,-451.52"/>
<polygon fill="black" stroke="black" points="6322,-451.52 6318.5,-441.52 6315,-451.52 6322,-451.52"/>
</g>
<!-- d10_output -->
<g id="node244" class="node">
<title>d10_output</title>
<polygon fill="white" stroke="black" points="6395.26,-328.43 6243.72,-328.43 6204.74,-246.43 6356.28,-246.43 6395.26,-328.43"/>
<text text-anchor="middle" x="6300" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="6300" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6300" y="-273.93" font-family="Arial" font-size="10.00">Device 10</text>
</g>
<!-- d10_layer3&#45;&gt;d10_output -->
<g id="edge319" class="edge">
<title>d10_layer3&#45;&gt;d10_output</title>
<path fill="none" stroke="black" d="M6315,-400.36C6315,-400.36 6315,-338.48 6315,-338.48"/>
<polygon fill="black" stroke="black" points="6318.5,-338.48 6315,-328.48 6311.5,-338.48 6318.5,-338.48"/>
</g>
<!-- d10_output&#45;&gt;sequence_agg -->
<g id="edge320" class="edge">
<title>d10_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M6300,-246.34C6300,-210.1 6300,-163 6300,-163 6300,-163 5015.52,-163 5015.52,-163"/>
<polygon fill="black" stroke="black" points="5015.52,-159.5 5005.52,-163 5015.52,-166.5 5015.52,-159.5"/>
</g>
<!-- d11_ln1 -->
<g id="node246" class="node">
<title>d11_ln1</title>
<polygon fill="white" stroke="black" points="7102,-1913.39 7010,-1913.39 7010,-1872.39 7102,-1872.39 7102,-1913.39"/>
<text text-anchor="middle" x="7056" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="7056" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7056" y="-1879.39" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_input&#45;&gt;d11_ln1 -->
<g id="edge322" class="edge">
<title>d11_input&#45;&gt;d11_ln1</title>
<path fill="none" stroke="black" d="M7056,-1985.28C7056,-1985.28 7056,-1923.77 7056,-1923.77"/>
<polygon fill="black" stroke="black" points="7059.5,-1923.77 7056,-1913.77 7052.5,-1923.77 7059.5,-1923.77"/>
</g>
<!-- d11_res1 -->
<g id="node257" class="node">
<title>d11_res1</title>
<polygon fill="white" stroke="black" points="7193.26,-1314.43 7041.72,-1314.43 7002.74,-1232.43 7154.28,-1232.43 7193.26,-1314.43"/>
<text text-anchor="middle" x="7098" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="7098" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7098" y="-1259.93" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_input&#45;&gt;d11_res1 -->
<g id="edge336" class="edge">
<title>d11_input&#45;&gt;d11_res1</title>
<path fill="none" stroke="black" d="M7111.46,-1999C7138.38,-1999 7165,-1999 7165,-1999 7165,-1999 7165,-1324.52 7165,-1324.52"/>
<polygon fill="black" stroke="black" points="7168.5,-1324.52 7165,-1314.52 7161.5,-1324.52 7168.5,-1324.52"/>
</g>
<!-- d11_q -->
<g id="node247" class="node">
<title>d11_q</title>
<polygon fill="lightcoral" stroke="black" points="6940,-1800.39 6848,-1800.39 6848,-1759.39 6940,-1759.39 6940,-1800.39"/>
<text text-anchor="middle" x="6894" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="6894" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6894" y="-1766.39" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_ln1&#45;&gt;d11_q -->
<g id="edge323" class="edge">
<title>d11_ln1&#45;&gt;d11_q</title>
<path fill="none" stroke="black" d="M7009.81,-1899C6961.71,-1899 6893.29,-1899 6893.29,-1899 6893.29,-1899 6893.29,-1810.64 6893.29,-1810.64"/>
<polygon fill="black" stroke="black" points="6896.79,-1810.64 6893.29,-1800.64 6889.79,-1810.64 6896.79,-1810.64"/>
</g>
<!-- d11_k -->
<g id="node248" class="node">
<title>d11_k</title>
<polygon fill="lightcoral" stroke="black" points="7102,-1800.39 7010,-1800.39 7010,-1759.39 7102,-1759.39 7102,-1800.39"/>
<text text-anchor="middle" x="7056" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="7056" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7056" y="-1766.39" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_ln1&#45;&gt;d11_k -->
<g id="edge324" class="edge">
<title>d11_ln1&#45;&gt;d11_k</title>
<path fill="none" stroke="black" d="M7056,-1872.17C7056,-1872.17 7056,-1810.49 7056,-1810.49"/>
<polygon fill="black" stroke="black" points="7059.5,-1810.49 7056,-1800.49 7052.5,-1810.49 7059.5,-1810.49"/>
</g>
<!-- d11_v -->
<g id="node249" class="node">
<title>d11_v</title>
<polygon fill="lightcoral" stroke="black" points="7264,-1800.39 7172,-1800.39 7172,-1759.39 7264,-1759.39 7264,-1800.39"/>
<text text-anchor="middle" x="7218" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="7218" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7218" y="-1766.39" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_ln1&#45;&gt;d11_v -->
<g id="edge325" class="edge">
<title>d11_ln1&#45;&gt;d11_v</title>
<path fill="none" stroke="black" d="M7102.42,-1886C7150.29,-1886 7218,-1886 7218,-1886 7218,-1886 7218,-1810.6 7218,-1810.6"/>
<polygon fill="black" stroke="black" points="7221.5,-1810.6 7218,-1800.6 7214.5,-1810.6 7221.5,-1810.6"/>
</g>
<!-- d11_q_heads -->
<g id="node250" class="node">
<title>d11_q_heads</title>
<ellipse fill="white" stroke="black" cx="6866" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="6866" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="6866" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="6866" y="-1644.9" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_q&#45;&gt;d11_q_heads -->
<g id="edge326" class="edge">
<title>d11_q&#45;&gt;d11_q_heads</title>
<path fill="none" stroke="black" d="M6893.77,-1759.28C6893.77,-1759.28 6893.77,-1695.52 6893.77,-1695.52"/>
<polygon fill="black" stroke="black" points="6897.27,-1695.52 6893.77,-1685.52 6890.27,-1695.52 6897.27,-1695.52"/>
</g>
<!-- d11_k_heads -->
<g id="node251" class="node">
<title>d11_k_heads</title>
<ellipse fill="white" stroke="black" cx="7056" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="7056" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="7056" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="7056" y="-1644.9" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_k&#45;&gt;d11_k_heads -->
<g id="edge327" class="edge">
<title>d11_k&#45;&gt;d11_k_heads</title>
<path fill="none" stroke="black" d="M7056,-1759.28C7056,-1759.28 7056,-1697.78 7056,-1697.78"/>
<polygon fill="black" stroke="black" points="7059.5,-1697.78 7056,-1687.78 7052.5,-1697.78 7059.5,-1697.78"/>
</g>
<!-- d11_v_heads -->
<g id="node252" class="node">
<title>d11_v_heads</title>
<ellipse fill="white" stroke="black" cx="7246" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="7246" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="7246" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="7246" y="-1644.9" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_v&#45;&gt;d11_v_heads -->
<g id="edge328" class="edge">
<title>d11_v&#45;&gt;d11_v_heads</title>
<path fill="none" stroke="black" d="M7218.23,-1759.28C7218.23,-1759.28 7218.23,-1695.52 7218.23,-1695.52"/>
<polygon fill="black" stroke="black" points="7221.73,-1695.52 7218.23,-1685.52 7214.73,-1695.52 7221.73,-1695.52"/>
</g>
<!-- d11_ring_attn -->
<g id="node253" class="node">
<title>d11_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="7102,-1557.41 7010,-1557.41 7010,-1516.41 7102,-1516.41 7102,-1557.41"/>
<text text-anchor="middle" x="7056" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="7056" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7056" y="-1523.41" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_q_heads&#45;&gt;d11_ring_attn -->
<g id="edge329" class="edge">
<title>d11_q_heads&#45;&gt;d11_ring_attn</title>
<path fill="none" stroke="black" d="M6909.24,-1634.77C6909.24,-1601.01 6909.24,-1543 6909.24,-1543 6909.24,-1543 6999.97,-1543 6999.97,-1543"/>
<polygon fill="black" stroke="black" points="6999.97,-1546.5 7009.97,-1543 6999.97,-1539.5 6999.97,-1546.5"/>
</g>
<!-- d11_k_heads&#45;&gt;d11_ring_attn -->
<g id="edge330" class="edge">
<title>d11_k_heads&#45;&gt;d11_ring_attn</title>
<path fill="none" stroke="black" d="M7056,-1629.3C7056,-1629.3 7056,-1567.78 7056,-1567.78"/>
<polygon fill="black" stroke="black" points="7059.5,-1567.78 7056,-1557.78 7052.5,-1567.78 7059.5,-1567.78"/>
</g>
<!-- d11_v_heads&#45;&gt;d11_ring_attn -->
<g id="edge331" class="edge">
<title>d11_v_heads&#45;&gt;d11_ring_attn</title>
<path fill="none" stroke="black" d="M7182.92,-1643.42C7182.92,-1609.55 7182.92,-1530 7182.92,-1530 7182.92,-1530 7112.18,-1530 7112.18,-1530"/>
<polygon fill="black" stroke="black" points="7112.18,-1526.5 7102.18,-1530 7112.18,-1533.5 7112.18,-1526.5"/>
</g>
<!-- d11_send_kv -->
<g id="node254" class="node">
<title>d11_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6944" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="6944" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="6944" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6944" y="-1401.92" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_ring_attn&#45;&gt;d11_send_kv -->
<g id="edge332" class="edge">
<title>d11_ring_attn&#45;&gt;d11_send_kv</title>
<path fill="none" stroke="black" d="M7031,-1516.32C7031,-1488.4 7031,-1442 7031,-1442 7031,-1442 6980.1,-1442 6980.1,-1442"/>
<polygon fill="black" stroke="black" points="6980.1,-1438.5 6970.1,-1442 6980.1,-1445.5 6980.1,-1438.5"/>
</g>
<!-- d11_out_proj -->
<g id="node256" class="node">
<title>d11_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="7144,-1435.92 7052,-1435.92 7052,-1394.92 7144,-1394.92 7144,-1435.92"/>
<text text-anchor="middle" x="7098" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="7098" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7098" y="-1401.92" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_ring_attn&#45;&gt;d11_out_proj -->
<g id="edge335" class="edge">
<title>d11_ring_attn&#45;&gt;d11_out_proj</title>
<path fill="none" stroke="black" d="M7077,-1516.3C7077,-1516.3 7077,-1446.13 7077,-1446.13"/>
<polygon fill="black" stroke="black" points="7080.5,-1446.13 7077,-1436.13 7073.5,-1446.13 7080.5,-1446.13"/>
</g>
<!-- d12_recv_kv -->
<g id="node277" class="node">
<title>d12_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="7486" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="7486" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="7486" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7486" y="-2000.88" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d11_send_kv&#45;&gt;d12_recv_kv -->
<g id="edge333" class="edge">
<title>d11_send_kv&#45;&gt;d12_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6978.65,-1440C7037.57,-1440 7151,-1440 7151,-1440 7151,-1440 7151,-2028 7151,-2028 7151,-2028 7415.33,-2028 7415.33,-2028"/>
<polygon fill="black" stroke="black" points="7415.33,-2031.5 7425.33,-2028 7415.33,-2024.5 7415.33,-2031.5"/>
</g>
<!-- d11_send_kv&#45;&gt;d12_recv_kv -->
<g id="edge363" class="edge">
<title>d11_send_kv&#45;&gt;d12_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6985.01,-1438C7047.15,-1438 7158,-1438 7158,-1438 7158,-1438 7158,-2014 7158,-2014 7158,-2014 7407.24,-2014 7407.24,-2014"/>
<polygon fill="black" stroke="black" points="7407.24,-2017.5 7417.24,-2014 7407.24,-2010.5 7407.24,-2017.5"/>
</g>
<!-- d11_out_proj&#45;&gt;d11_res1 -->
<g id="edge337" class="edge">
<title>d11_out_proj&#45;&gt;d11_res1</title>
<path fill="none" stroke="black" d="M7098,-1394.77C7098,-1394.77 7098,-1324.63 7098,-1324.63"/>
<polygon fill="black" stroke="black" points="7101.5,-1324.63 7098,-1314.63 7094.5,-1324.63 7101.5,-1324.63"/>
</g>
<!-- d11_ln2 -->
<g id="node258" class="node">
<title>d11_ln2</title>
<polygon fill="white" stroke="black" points="7051,-1160.43 6959,-1160.43 6959,-1119.43 7051,-1119.43 7051,-1160.43"/>
<text text-anchor="middle" x="7005" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="7005" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7005" y="-1126.43" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_res1&#45;&gt;d11_ln2 -->
<g id="edge338" class="edge">
<title>d11_res1&#45;&gt;d11_ln2</title>
<path fill="none" stroke="black" d="M7026.81,-1232.28C7026.81,-1232.28 7026.81,-1170.62 7026.81,-1170.62"/>
<polygon fill="black" stroke="black" points="7030.31,-1170.62 7026.81,-1160.62 7023.31,-1170.62 7030.31,-1170.62"/>
</g>
<!-- d11_res2 -->
<g id="node262" class="node">
<title>d11_res2</title>
<polygon fill="white" stroke="black" points="7041.26,-821.43 6889.72,-821.43 6850.74,-739.43 7002.28,-739.43 7041.26,-821.43"/>
<text text-anchor="middle" x="6946" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="6946" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6946" y="-766.93" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_res1&#45;&gt;d11_res2 -->
<g id="edge344" class="edge">
<title>d11_res1&#45;&gt;d11_res2</title>
<path fill="none" stroke="black" d="M7123.69,-1232.21C7123.69,-1113.62 7123.69,-780 7123.69,-780 7123.69,-780 7031.61,-780 7031.61,-780"/>
<polygon fill="black" stroke="black" points="7031.61,-776.5 7021.61,-780 7031.61,-783.5 7031.61,-776.5"/>
</g>
<!-- d11_mlp_gate -->
<g id="node259" class="node">
<title>d11_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="6913,-1047.43 6815,-1047.43 6815,-1006.43 6913,-1006.43 6913,-1047.43"/>
<text text-anchor="middle" x="6864" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="6864" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="6864" y="-1013.43" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_ln2&#45;&gt;d11_mlp_gate -->
<g id="edge339" class="edge">
<title>d11_ln2&#45;&gt;d11_mlp_gate</title>
<path fill="none" stroke="black" d="M6958.76,-1139C6929.05,-1139 6895.97,-1139 6895.97,-1139 6895.97,-1139 6895.97,-1057.48 6895.97,-1057.48"/>
<polygon fill="black" stroke="black" points="6899.47,-1057.48 6895.97,-1047.48 6892.47,-1057.48 6899.47,-1057.48"/>
</g>
<!-- d11_mlp_up -->
<g id="node260" class="node">
<title>d11_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="7054,-1047.43 6956,-1047.43 6956,-1006.43 7054,-1006.43 7054,-1047.43"/>
<text text-anchor="middle" x="7005" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="7005" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="7005" y="-1013.43" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_ln2&#45;&gt;d11_mlp_up -->
<g id="edge340" class="edge">
<title>d11_ln2&#45;&gt;d11_mlp_up</title>
<path fill="none" stroke="black" d="M7005,-1119.2C7005,-1119.2 7005,-1057.52 7005,-1057.52"/>
<polygon fill="black" stroke="black" points="7008.5,-1057.52 7005,-1047.52 7001.5,-1057.52 7008.5,-1057.52"/>
</g>
<!-- d11_mlp_down -->
<g id="node261" class="node">
<title>d11_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="6992,-934.43 6900,-934.43 6900,-893.43 6992,-893.43 6992,-934.43"/>
<text text-anchor="middle" x="6946" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="6946" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6946" y="-900.43" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_mlp_gate&#45;&gt;d11_mlp_down -->
<g id="edge341" class="edge">
<title>d11_mlp_gate&#45;&gt;d11_mlp_down</title>
<path fill="none" stroke="black" d="M6906.5,-1006.2C6906.5,-1006.2 6906.5,-944.52 6906.5,-944.52"/>
<polygon fill="black" stroke="black" points="6910,-944.52 6906.5,-934.52 6903,-944.52 6910,-944.52"/>
</g>
<!-- d11_mlp_up&#45;&gt;d11_mlp_down -->
<g id="edge342" class="edge">
<title>d11_mlp_up&#45;&gt;d11_mlp_down</title>
<path fill="none" stroke="black" d="M6974,-1006.2C6974,-1006.2 6974,-944.52 6974,-944.52"/>
<polygon fill="black" stroke="black" points="6977.5,-944.52 6974,-934.52 6970.5,-944.52 6977.5,-944.52"/>
</g>
<!-- d11_mlp_down&#45;&gt;d11_res2 -->
<g id="edge343" class="edge">
<title>d11_mlp_down&#45;&gt;d11_res2</title>
<path fill="none" stroke="black" d="M6946,-893.36C6946,-893.36 6946,-831.48 6946,-831.48"/>
<polygon fill="black" stroke="black" points="6949.5,-831.48 6946,-821.48 6942.5,-831.48 6949.5,-831.48"/>
</g>
<!-- d11_layer1 -->
<g id="node263" class="node">
<title>d11_layer1</title>
<polygon fill="lightgray" stroke="black" points="6988,-667.43 6896,-667.43 6896,-626.43 6988,-626.43 6988,-667.43"/>
<text text-anchor="middle" x="6942" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="6942" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6942" y="-633.43" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_res2&#45;&gt;d11_layer1 -->
<g id="edge345" class="edge">
<title>d11_res2&#45;&gt;d11_layer1</title>
<path fill="none" stroke="black" d="M6942,-739.28C6942,-739.28 6942,-677.62 6942,-677.62"/>
<polygon fill="black" stroke="black" points="6945.5,-677.62 6942,-667.62 6938.5,-677.62 6945.5,-677.62"/>
</g>
<!-- d11_layer2 -->
<g id="node264" class="node">
<title>d11_layer2</title>
<polygon fill="lightgray" stroke="black" points="6984,-554.43 6892,-554.43 6892,-513.43 6984,-513.43 6984,-554.43"/>
<text text-anchor="middle" x="6938" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="6938" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6938" y="-520.43" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_layer1&#45;&gt;d11_layer2 -->
<g id="edge346" class="edge">
<title>d11_layer1&#45;&gt;d11_layer2</title>
<path fill="none" stroke="black" d="M6940,-626.2C6940,-626.2 6940,-564.52 6940,-564.52"/>
<polygon fill="black" stroke="black" points="6943.5,-564.52 6940,-554.52 6936.5,-564.52 6943.5,-564.52"/>
</g>
<!-- d11_layer3 -->
<g id="node265" class="node">
<title>d11_layer3</title>
<polygon fill="lightgray" stroke="black" points="6977,-441.43 6885,-441.43 6885,-400.43 6977,-400.43 6977,-441.43"/>
<text text-anchor="middle" x="6931" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="6931" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6931" y="-407.43" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_layer2&#45;&gt;d11_layer3 -->
<g id="edge347" class="edge">
<title>d11_layer2&#45;&gt;d11_layer3</title>
<path fill="none" stroke="black" d="M6934.5,-513.2C6934.5,-513.2 6934.5,-451.52 6934.5,-451.52"/>
<polygon fill="black" stroke="black" points="6938,-451.52 6934.5,-441.52 6931,-451.52 6938,-451.52"/>
</g>
<!-- d11_output -->
<g id="node266" class="node">
<title>d11_output</title>
<polygon fill="white" stroke="black" points="7011.26,-328.43 6859.72,-328.43 6820.74,-246.43 6972.28,-246.43 7011.26,-328.43"/>
<text text-anchor="middle" x="6916" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="6916" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="6916" y="-273.93" font-family="Arial" font-size="10.00">Device 11</text>
</g>
<!-- d11_layer3&#45;&gt;d11_output -->
<g id="edge348" class="edge">
<title>d11_layer3&#45;&gt;d11_output</title>
<path fill="none" stroke="black" d="M6931,-400.36C6931,-400.36 6931,-338.48 6931,-338.48"/>
<polygon fill="black" stroke="black" points="6934.5,-338.48 6931,-328.48 6927.5,-338.48 6934.5,-338.48"/>
</g>
<!-- d11_output&#45;&gt;sequence_agg -->
<g id="edge349" class="edge">
<title>d11_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M6916,-246.12C6916,-208.24 6916,-158 6916,-158 6916,-158 5022.61,-158 5022.61,-158"/>
<polygon fill="black" stroke="black" points="5022.61,-154.5 5012.61,-158 5022.61,-161.5 5022.61,-154.5"/>
</g>
<!-- d12_ln1 -->
<g id="node268" class="node">
<title>d12_ln1</title>
<polygon fill="white" stroke="black" points="7718,-1913.39 7626,-1913.39 7626,-1872.39 7718,-1872.39 7718,-1913.39"/>
<text text-anchor="middle" x="7672" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="7672" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7672" y="-1879.39" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_input&#45;&gt;d12_ln1 -->
<g id="edge351" class="edge">
<title>d12_input&#45;&gt;d12_ln1</title>
<path fill="none" stroke="black" d="M7672,-1985.28C7672,-1985.28 7672,-1923.77 7672,-1923.77"/>
<polygon fill="black" stroke="black" points="7675.5,-1923.77 7672,-1913.77 7668.5,-1923.77 7675.5,-1923.77"/>
</g>
<!-- d12_res1 -->
<g id="node279" class="node">
<title>d12_res1</title>
<polygon fill="white" stroke="black" points="7809.26,-1314.43 7657.72,-1314.43 7618.74,-1232.43 7770.28,-1232.43 7809.26,-1314.43"/>
<text text-anchor="middle" x="7714" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="7714" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7714" y="-1259.93" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_input&#45;&gt;d12_res1 -->
<g id="edge365" class="edge">
<title>d12_input&#45;&gt;d12_res1</title>
<path fill="none" stroke="black" d="M7727.46,-1999C7754.38,-1999 7781,-1999 7781,-1999 7781,-1999 7781,-1324.52 7781,-1324.52"/>
<polygon fill="black" stroke="black" points="7784.5,-1324.52 7781,-1314.52 7777.5,-1324.52 7784.5,-1324.52"/>
</g>
<!-- d12_q -->
<g id="node269" class="node">
<title>d12_q</title>
<polygon fill="lightcoral" stroke="black" points="7555,-1800.39 7463,-1800.39 7463,-1759.39 7555,-1759.39 7555,-1800.39"/>
<text text-anchor="middle" x="7509" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="7509" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7509" y="-1766.39" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_ln1&#45;&gt;d12_q -->
<g id="edge352" class="edge">
<title>d12_ln1&#45;&gt;d12_q</title>
<path fill="none" stroke="black" d="M7625.67,-1899C7577.42,-1899 7508.79,-1899 7508.79,-1899 7508.79,-1899 7508.79,-1810.64 7508.79,-1810.64"/>
<polygon fill="black" stroke="black" points="7512.29,-1810.64 7508.79,-1800.64 7505.29,-1810.64 7512.29,-1810.64"/>
</g>
<!-- d12_k -->
<g id="node270" class="node">
<title>d12_k</title>
<polygon fill="lightcoral" stroke="black" points="7718,-1800.39 7626,-1800.39 7626,-1759.39 7718,-1759.39 7718,-1800.39"/>
<text text-anchor="middle" x="7672" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="7672" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7672" y="-1766.39" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_ln1&#45;&gt;d12_k -->
<g id="edge353" class="edge">
<title>d12_ln1&#45;&gt;d12_k</title>
<path fill="none" stroke="black" d="M7672,-1872.17C7672,-1872.17 7672,-1810.49 7672,-1810.49"/>
<polygon fill="black" stroke="black" points="7675.5,-1810.49 7672,-1800.49 7668.5,-1810.49 7675.5,-1810.49"/>
</g>
<!-- d12_v -->
<g id="node271" class="node">
<title>d12_v</title>
<polygon fill="lightcoral" stroke="black" points="7880,-1800.39 7788,-1800.39 7788,-1759.39 7880,-1759.39 7880,-1800.39"/>
<text text-anchor="middle" x="7834" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="7834" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7834" y="-1766.39" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_ln1&#45;&gt;d12_v -->
<g id="edge354" class="edge">
<title>d12_ln1&#45;&gt;d12_v</title>
<path fill="none" stroke="black" d="M7718.42,-1886C7766.29,-1886 7834,-1886 7834,-1886 7834,-1886 7834,-1810.6 7834,-1810.6"/>
<polygon fill="black" stroke="black" points="7837.5,-1810.6 7834,-1800.6 7830.5,-1810.6 7837.5,-1810.6"/>
</g>
<!-- d12_q_heads -->
<g id="node272" class="node">
<title>d12_q_heads</title>
<ellipse fill="white" stroke="black" cx="7482" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="7482" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="7482" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="7482" y="-1644.9" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_q&#45;&gt;d12_q_heads -->
<g id="edge355" class="edge">
<title>d12_q&#45;&gt;d12_q_heads</title>
<path fill="none" stroke="black" d="M7509,-1759.28C7509,-1759.28 7509,-1695.52 7509,-1695.52"/>
<polygon fill="black" stroke="black" points="7512.5,-1695.52 7509,-1685.52 7505.5,-1695.52 7512.5,-1695.52"/>
</g>
<!-- d12_k_heads -->
<g id="node273" class="node">
<title>d12_k_heads</title>
<ellipse fill="white" stroke="black" cx="7672" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="7672" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="7672" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="7672" y="-1644.9" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_k&#45;&gt;d12_k_heads -->
<g id="edge356" class="edge">
<title>d12_k&#45;&gt;d12_k_heads</title>
<path fill="none" stroke="black" d="M7672,-1759.28C7672,-1759.28 7672,-1697.78 7672,-1697.78"/>
<polygon fill="black" stroke="black" points="7675.5,-1697.78 7672,-1687.78 7668.5,-1697.78 7675.5,-1697.78"/>
</g>
<!-- d12_v_heads -->
<g id="node274" class="node">
<title>d12_v_heads</title>
<ellipse fill="white" stroke="black" cx="7862" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="7862" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="7862" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="7862" y="-1644.9" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_v&#45;&gt;d12_v_heads -->
<g id="edge357" class="edge">
<title>d12_v&#45;&gt;d12_v_heads</title>
<path fill="none" stroke="black" d="M7834.23,-1759.28C7834.23,-1759.28 7834.23,-1695.52 7834.23,-1695.52"/>
<polygon fill="black" stroke="black" points="7837.73,-1695.52 7834.23,-1685.52 7830.73,-1695.52 7837.73,-1695.52"/>
</g>
<!-- d12_ring_attn -->
<g id="node275" class="node">
<title>d12_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="7718,-1557.41 7626,-1557.41 7626,-1516.41 7718,-1516.41 7718,-1557.41"/>
<text text-anchor="middle" x="7672" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="7672" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7672" y="-1523.41" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_q_heads&#45;&gt;d12_ring_attn -->
<g id="edge358" class="edge">
<title>d12_q_heads&#45;&gt;d12_ring_attn</title>
<path fill="none" stroke="black" d="M7525.24,-1634.77C7525.24,-1601.01 7525.24,-1543 7525.24,-1543 7525.24,-1543 7615.97,-1543 7615.97,-1543"/>
<polygon fill="black" stroke="black" points="7615.97,-1546.5 7625.97,-1543 7615.97,-1539.5 7615.97,-1546.5"/>
</g>
<!-- d12_k_heads&#45;&gt;d12_ring_attn -->
<g id="edge359" class="edge">
<title>d12_k_heads&#45;&gt;d12_ring_attn</title>
<path fill="none" stroke="black" d="M7672,-1629.3C7672,-1629.3 7672,-1567.78 7672,-1567.78"/>
<polygon fill="black" stroke="black" points="7675.5,-1567.78 7672,-1557.78 7668.5,-1567.78 7675.5,-1567.78"/>
</g>
<!-- d12_v_heads&#45;&gt;d12_ring_attn -->
<g id="edge360" class="edge">
<title>d12_v_heads&#45;&gt;d12_ring_attn</title>
<path fill="none" stroke="black" d="M7798.92,-1643.42C7798.92,-1609.55 7798.92,-1530 7798.92,-1530 7798.92,-1530 7728.18,-1530 7728.18,-1530"/>
<polygon fill="black" stroke="black" points="7728.18,-1526.5 7718.18,-1530 7728.18,-1533.5 7728.18,-1526.5"/>
</g>
<!-- d12_send_kv -->
<g id="node276" class="node">
<title>d12_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="7560" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="7560" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="7560" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7560" y="-1401.92" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_ring_attn&#45;&gt;d12_send_kv -->
<g id="edge361" class="edge">
<title>d12_ring_attn&#45;&gt;d12_send_kv</title>
<path fill="none" stroke="black" d="M7647,-1516.32C7647,-1488.4 7647,-1442 7647,-1442 7647,-1442 7596.1,-1442 7596.1,-1442"/>
<polygon fill="black" stroke="black" points="7596.1,-1438.5 7586.1,-1442 7596.1,-1445.5 7596.1,-1438.5"/>
</g>
<!-- d12_out_proj -->
<g id="node278" class="node">
<title>d12_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="7760,-1435.92 7668,-1435.92 7668,-1394.92 7760,-1394.92 7760,-1435.92"/>
<text text-anchor="middle" x="7714" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="7714" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7714" y="-1401.92" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_ring_attn&#45;&gt;d12_out_proj -->
<g id="edge364" class="edge">
<title>d12_ring_attn&#45;&gt;d12_out_proj</title>
<path fill="none" stroke="black" d="M7693,-1516.3C7693,-1516.3 7693,-1446.13 7693,-1446.13"/>
<polygon fill="black" stroke="black" points="7696.5,-1446.13 7693,-1436.13 7689.5,-1446.13 7696.5,-1446.13"/>
</g>
<!-- d13_recv_kv -->
<g id="node299" class="node">
<title>d13_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8102" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="8102" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="8102" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8102" y="-2000.88" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d12_send_kv&#45;&gt;d13_recv_kv -->
<g id="edge362" class="edge">
<title>d12_send_kv&#45;&gt;d13_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7594.65,-1440C7653.57,-1440 7767,-1440 7767,-1440 7767,-1440 7767,-2028 7767,-2028 7767,-2028 8031.33,-2028 8031.33,-2028"/>
<polygon fill="black" stroke="black" points="8031.33,-2031.5 8041.33,-2028 8031.33,-2024.5 8031.33,-2031.5"/>
</g>
<!-- d12_send_kv&#45;&gt;d13_recv_kv -->
<g id="edge392" class="edge">
<title>d12_send_kv&#45;&gt;d13_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7601.01,-1438C7663.15,-1438 7774,-1438 7774,-1438 7774,-1438 7774,-2014 7774,-2014 7774,-2014 8023.24,-2014 8023.24,-2014"/>
<polygon fill="black" stroke="black" points="8023.24,-2017.5 8033.24,-2014 8023.24,-2010.5 8023.24,-2017.5"/>
</g>
<!-- d12_out_proj&#45;&gt;d12_res1 -->
<g id="edge366" class="edge">
<title>d12_out_proj&#45;&gt;d12_res1</title>
<path fill="none" stroke="black" d="M7714,-1394.77C7714,-1394.77 7714,-1324.63 7714,-1324.63"/>
<polygon fill="black" stroke="black" points="7717.5,-1324.63 7714,-1314.63 7710.5,-1324.63 7717.5,-1324.63"/>
</g>
<!-- d12_ln2 -->
<g id="node280" class="node">
<title>d12_ln2</title>
<polygon fill="white" stroke="black" points="7667,-1160.43 7575,-1160.43 7575,-1119.43 7667,-1119.43 7667,-1160.43"/>
<text text-anchor="middle" x="7621" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="7621" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7621" y="-1126.43" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_res1&#45;&gt;d12_ln2 -->
<g id="edge367" class="edge">
<title>d12_res1&#45;&gt;d12_ln2</title>
<path fill="none" stroke="black" d="M7642.81,-1232.28C7642.81,-1232.28 7642.81,-1170.62 7642.81,-1170.62"/>
<polygon fill="black" stroke="black" points="7646.31,-1170.62 7642.81,-1160.62 7639.31,-1170.62 7646.31,-1170.62"/>
</g>
<!-- d12_res2 -->
<g id="node284" class="node">
<title>d12_res2</title>
<polygon fill="white" stroke="black" points="7657.26,-821.43 7505.72,-821.43 7466.74,-739.43 7618.28,-739.43 7657.26,-821.43"/>
<text text-anchor="middle" x="7562" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="7562" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7562" y="-766.93" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_res1&#45;&gt;d12_res2 -->
<g id="edge373" class="edge">
<title>d12_res1&#45;&gt;d12_res2</title>
<path fill="none" stroke="black" d="M7739.69,-1232.21C7739.69,-1113.62 7739.69,-780 7739.69,-780 7739.69,-780 7647.61,-780 7647.61,-780"/>
<polygon fill="black" stroke="black" points="7647.61,-776.5 7637.61,-780 7647.61,-783.5 7647.61,-776.5"/>
</g>
<!-- d12_mlp_gate -->
<g id="node281" class="node">
<title>d12_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="7529,-1047.43 7431,-1047.43 7431,-1006.43 7529,-1006.43 7529,-1047.43"/>
<text text-anchor="middle" x="7480" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="7480" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="7480" y="-1013.43" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_ln2&#45;&gt;d12_mlp_gate -->
<g id="edge368" class="edge">
<title>d12_ln2&#45;&gt;d12_mlp_gate</title>
<path fill="none" stroke="black" d="M7574.76,-1139C7545.05,-1139 7511.97,-1139 7511.97,-1139 7511.97,-1139 7511.97,-1057.48 7511.97,-1057.48"/>
<polygon fill="black" stroke="black" points="7515.47,-1057.48 7511.97,-1047.48 7508.47,-1057.48 7515.47,-1057.48"/>
</g>
<!-- d12_mlp_up -->
<g id="node282" class="node">
<title>d12_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="7670,-1047.43 7572,-1047.43 7572,-1006.43 7670,-1006.43 7670,-1047.43"/>
<text text-anchor="middle" x="7621" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="7621" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="7621" y="-1013.43" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_ln2&#45;&gt;d12_mlp_up -->
<g id="edge369" class="edge">
<title>d12_ln2&#45;&gt;d12_mlp_up</title>
<path fill="none" stroke="black" d="M7621,-1119.2C7621,-1119.2 7621,-1057.52 7621,-1057.52"/>
<polygon fill="black" stroke="black" points="7624.5,-1057.52 7621,-1047.52 7617.5,-1057.52 7624.5,-1057.52"/>
</g>
<!-- d12_mlp_down -->
<g id="node283" class="node">
<title>d12_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="7608,-934.43 7516,-934.43 7516,-893.43 7608,-893.43 7608,-934.43"/>
<text text-anchor="middle" x="7562" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="7562" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7562" y="-900.43" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_mlp_gate&#45;&gt;d12_mlp_down -->
<g id="edge370" class="edge">
<title>d12_mlp_gate&#45;&gt;d12_mlp_down</title>
<path fill="none" stroke="black" d="M7522.5,-1006.2C7522.5,-1006.2 7522.5,-944.52 7522.5,-944.52"/>
<polygon fill="black" stroke="black" points="7526,-944.52 7522.5,-934.52 7519,-944.52 7526,-944.52"/>
</g>
<!-- d12_mlp_up&#45;&gt;d12_mlp_down -->
<g id="edge371" class="edge">
<title>d12_mlp_up&#45;&gt;d12_mlp_down</title>
<path fill="none" stroke="black" d="M7590,-1006.2C7590,-1006.2 7590,-944.52 7590,-944.52"/>
<polygon fill="black" stroke="black" points="7593.5,-944.52 7590,-934.52 7586.5,-944.52 7593.5,-944.52"/>
</g>
<!-- d12_mlp_down&#45;&gt;d12_res2 -->
<g id="edge372" class="edge">
<title>d12_mlp_down&#45;&gt;d12_res2</title>
<path fill="none" stroke="black" d="M7562,-893.36C7562,-893.36 7562,-831.48 7562,-831.48"/>
<polygon fill="black" stroke="black" points="7565.5,-831.48 7562,-821.48 7558.5,-831.48 7565.5,-831.48"/>
</g>
<!-- d12_layer1 -->
<g id="node285" class="node">
<title>d12_layer1</title>
<polygon fill="lightgray" stroke="black" points="7604,-667.43 7512,-667.43 7512,-626.43 7604,-626.43 7604,-667.43"/>
<text text-anchor="middle" x="7558" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="7558" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7558" y="-633.43" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_res2&#45;&gt;d12_layer1 -->
<g id="edge374" class="edge">
<title>d12_res2&#45;&gt;d12_layer1</title>
<path fill="none" stroke="black" d="M7558,-739.28C7558,-739.28 7558,-677.62 7558,-677.62"/>
<polygon fill="black" stroke="black" points="7561.5,-677.62 7558,-667.62 7554.5,-677.62 7561.5,-677.62"/>
</g>
<!-- d12_layer2 -->
<g id="node286" class="node">
<title>d12_layer2</title>
<polygon fill="lightgray" stroke="black" points="7600,-554.43 7508,-554.43 7508,-513.43 7600,-513.43 7600,-554.43"/>
<text text-anchor="middle" x="7554" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="7554" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7554" y="-520.43" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_layer1&#45;&gt;d12_layer2 -->
<g id="edge375" class="edge">
<title>d12_layer1&#45;&gt;d12_layer2</title>
<path fill="none" stroke="black" d="M7556,-626.2C7556,-626.2 7556,-564.52 7556,-564.52"/>
<polygon fill="black" stroke="black" points="7559.5,-564.52 7556,-554.52 7552.5,-564.52 7559.5,-564.52"/>
</g>
<!-- d12_layer3 -->
<g id="node287" class="node">
<title>d12_layer3</title>
<polygon fill="lightgray" stroke="black" points="7593,-441.43 7501,-441.43 7501,-400.43 7593,-400.43 7593,-441.43"/>
<text text-anchor="middle" x="7547" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="7547" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7547" y="-407.43" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_layer2&#45;&gt;d12_layer3 -->
<g id="edge376" class="edge">
<title>d12_layer2&#45;&gt;d12_layer3</title>
<path fill="none" stroke="black" d="M7550.5,-513.2C7550.5,-513.2 7550.5,-451.52 7550.5,-451.52"/>
<polygon fill="black" stroke="black" points="7554,-451.52 7550.5,-441.52 7547,-451.52 7554,-451.52"/>
</g>
<!-- d12_output -->
<g id="node288" class="node">
<title>d12_output</title>
<polygon fill="white" stroke="black" points="7627.26,-328.43 7475.72,-328.43 7436.74,-246.43 7588.28,-246.43 7627.26,-328.43"/>
<text text-anchor="middle" x="7532" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="7532" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="7532" y="-273.93" font-family="Arial" font-size="10.00">Device 12</text>
</g>
<!-- d12_layer3&#45;&gt;d12_output -->
<g id="edge377" class="edge">
<title>d12_layer3&#45;&gt;d12_output</title>
<path fill="none" stroke="black" d="M7547,-400.36C7547,-400.36 7547,-338.48 7547,-338.48"/>
<polygon fill="black" stroke="black" points="7550.5,-338.48 7547,-328.48 7543.5,-338.48 7550.5,-338.48"/>
</g>
<!-- d12_output&#45;&gt;sequence_agg -->
<g id="edge378" class="edge">
<title>d12_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M7532,-246.36C7532,-206.83 7532,-153 7532,-153 7532,-153 5024.96,-153 5024.96,-153"/>
<polygon fill="black" stroke="black" points="5024.96,-149.5 5014.96,-153 5024.96,-156.5 5024.96,-149.5"/>
</g>
<!-- d13_ln1 -->
<g id="node290" class="node">
<title>d13_ln1</title>
<polygon fill="white" stroke="black" points="8334,-1913.39 8242,-1913.39 8242,-1872.39 8334,-1872.39 8334,-1913.39"/>
<text text-anchor="middle" x="8288" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="8288" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8288" y="-1879.39" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_input&#45;&gt;d13_ln1 -->
<g id="edge380" class="edge">
<title>d13_input&#45;&gt;d13_ln1</title>
<path fill="none" stroke="black" d="M8288,-1985.28C8288,-1985.28 8288,-1923.77 8288,-1923.77"/>
<polygon fill="black" stroke="black" points="8291.5,-1923.77 8288,-1913.77 8284.5,-1923.77 8291.5,-1923.77"/>
</g>
<!-- d13_res1 -->
<g id="node301" class="node">
<title>d13_res1</title>
<polygon fill="white" stroke="black" points="8425.26,-1314.43 8273.72,-1314.43 8234.74,-1232.43 8386.28,-1232.43 8425.26,-1314.43"/>
<text text-anchor="middle" x="8330" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="8330" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8330" y="-1259.93" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_input&#45;&gt;d13_res1 -->
<g id="edge394" class="edge">
<title>d13_input&#45;&gt;d13_res1</title>
<path fill="none" stroke="black" d="M8343.3,-1999C8367.39,-1999 8390.23,-1999 8390.23,-1999 8390.23,-1999 8390.23,-1324.52 8390.23,-1324.52"/>
<polygon fill="black" stroke="black" points="8393.73,-1324.52 8390.23,-1314.52 8386.73,-1324.52 8393.73,-1324.52"/>
</g>
<!-- d13_q -->
<g id="node291" class="node">
<title>d13_q</title>
<polygon fill="lightcoral" stroke="black" points="8171,-1800.39 8079,-1800.39 8079,-1759.39 8171,-1759.39 8171,-1800.39"/>
<text text-anchor="middle" x="8125" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="8125" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8125" y="-1766.39" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_ln1&#45;&gt;d13_q -->
<g id="edge381" class="edge">
<title>d13_ln1&#45;&gt;d13_q</title>
<path fill="none" stroke="black" d="M8241.67,-1899C8193.42,-1899 8124.79,-1899 8124.79,-1899 8124.79,-1899 8124.79,-1810.64 8124.79,-1810.64"/>
<polygon fill="black" stroke="black" points="8128.29,-1810.64 8124.79,-1800.64 8121.29,-1810.64 8128.29,-1810.64"/>
</g>
<!-- d13_k -->
<g id="node292" class="node">
<title>d13_k</title>
<polygon fill="lightcoral" stroke="black" points="8334,-1800.39 8242,-1800.39 8242,-1759.39 8334,-1759.39 8334,-1800.39"/>
<text text-anchor="middle" x="8288" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="8288" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8288" y="-1766.39" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_ln1&#45;&gt;d13_k -->
<g id="edge382" class="edge">
<title>d13_ln1&#45;&gt;d13_k</title>
<path fill="none" stroke="black" d="M8288,-1872.17C8288,-1872.17 8288,-1810.49 8288,-1810.49"/>
<polygon fill="black" stroke="black" points="8291.5,-1810.49 8288,-1800.49 8284.5,-1810.49 8291.5,-1810.49"/>
</g>
<!-- d13_v -->
<g id="node293" class="node">
<title>d13_v</title>
<polygon fill="lightcoral" stroke="black" points="8497,-1800.39 8405,-1800.39 8405,-1759.39 8497,-1759.39 8497,-1800.39"/>
<text text-anchor="middle" x="8451" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="8451" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8451" y="-1766.39" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_ln1&#45;&gt;d13_v -->
<g id="edge383" class="edge">
<title>d13_ln1&#45;&gt;d13_v</title>
<path fill="none" stroke="black" d="M8334.27,-1899C8382.46,-1899 8451,-1899 8451,-1899 8451,-1899 8451,-1810.64 8451,-1810.64"/>
<polygon fill="black" stroke="black" points="8454.5,-1810.64 8451,-1800.64 8447.5,-1810.64 8454.5,-1810.64"/>
</g>
<!-- d13_q_heads -->
<g id="node294" class="node">
<title>d13_q_heads</title>
<ellipse fill="white" stroke="black" cx="8098" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="8098" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="8098" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="8098" y="-1644.9" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_q&#45;&gt;d13_q_heads -->
<g id="edge384" class="edge">
<title>d13_q&#45;&gt;d13_q_heads</title>
<path fill="none" stroke="black" d="M8125,-1759.28C8125,-1759.28 8125,-1695.52 8125,-1695.52"/>
<polygon fill="black" stroke="black" points="8128.5,-1695.52 8125,-1685.52 8121.5,-1695.52 8128.5,-1695.52"/>
</g>
<!-- d13_k_heads -->
<g id="node295" class="node">
<title>d13_k_heads</title>
<ellipse fill="white" stroke="black" cx="8288" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="8288" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="8288" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="8288" y="-1644.9" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_k&#45;&gt;d13_k_heads -->
<g id="edge385" class="edge">
<title>d13_k&#45;&gt;d13_k_heads</title>
<path fill="none" stroke="black" d="M8288,-1759.28C8288,-1759.28 8288,-1697.78 8288,-1697.78"/>
<polygon fill="black" stroke="black" points="8291.5,-1697.78 8288,-1687.78 8284.5,-1697.78 8291.5,-1697.78"/>
</g>
<!-- d13_v_heads -->
<g id="node296" class="node">
<title>d13_v_heads</title>
<ellipse fill="white" stroke="black" cx="8478" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="8478" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="8478" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="8478" y="-1644.9" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_v&#45;&gt;d13_v_heads -->
<g id="edge386" class="edge">
<title>d13_v&#45;&gt;d13_v_heads</title>
<path fill="none" stroke="black" d="M8451,-1759.28C8451,-1759.28 8451,-1695.52 8451,-1695.52"/>
<polygon fill="black" stroke="black" points="8454.5,-1695.52 8451,-1685.52 8447.5,-1695.52 8454.5,-1695.52"/>
</g>
<!-- d13_ring_attn -->
<g id="node297" class="node">
<title>d13_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="8334,-1557.41 8242,-1557.41 8242,-1516.41 8334,-1516.41 8334,-1557.41"/>
<text text-anchor="middle" x="8288" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="8288" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8288" y="-1523.41" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_q_heads&#45;&gt;d13_ring_attn -->
<g id="edge387" class="edge">
<title>d13_q_heads&#45;&gt;d13_ring_attn</title>
<path fill="none" stroke="black" d="M8141.24,-1634.77C8141.24,-1601.01 8141.24,-1543 8141.24,-1543 8141.24,-1543 8231.97,-1543 8231.97,-1543"/>
<polygon fill="black" stroke="black" points="8231.97,-1546.5 8241.97,-1543 8231.97,-1539.5 8231.97,-1546.5"/>
</g>
<!-- d13_k_heads&#45;&gt;d13_ring_attn -->
<g id="edge388" class="edge">
<title>d13_k_heads&#45;&gt;d13_ring_attn</title>
<path fill="none" stroke="black" d="M8288,-1629.3C8288,-1629.3 8288,-1567.78 8288,-1567.78"/>
<polygon fill="black" stroke="black" points="8291.5,-1567.78 8288,-1557.78 8284.5,-1567.78 8291.5,-1567.78"/>
</g>
<!-- d13_v_heads&#45;&gt;d13_ring_attn -->
<g id="edge389" class="edge">
<title>d13_v_heads&#45;&gt;d13_ring_attn</title>
<path fill="none" stroke="black" d="M8414.92,-1643.42C8414.92,-1609.55 8414.92,-1530 8414.92,-1530 8414.92,-1530 8344.18,-1530 8344.18,-1530"/>
<polygon fill="black" stroke="black" points="8344.18,-1526.5 8334.18,-1530 8344.18,-1533.5 8344.18,-1526.5"/>
</g>
<!-- d13_send_kv -->
<g id="node298" class="node">
<title>d13_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8176" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="8176" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="8176" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8176" y="-1401.92" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_ring_attn&#45;&gt;d13_send_kv -->
<g id="edge390" class="edge">
<title>d13_ring_attn&#45;&gt;d13_send_kv</title>
<path fill="none" stroke="black" d="M8263,-1516.32C8263,-1488.4 8263,-1442 8263,-1442 8263,-1442 8212.1,-1442 8212.1,-1442"/>
<polygon fill="black" stroke="black" points="8212.1,-1438.5 8202.1,-1442 8212.1,-1445.5 8212.1,-1438.5"/>
</g>
<!-- d13_out_proj -->
<g id="node300" class="node">
<title>d13_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="8376,-1435.92 8284,-1435.92 8284,-1394.92 8376,-1394.92 8376,-1435.92"/>
<text text-anchor="middle" x="8330" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="8330" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8330" y="-1401.92" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_ring_attn&#45;&gt;d13_out_proj -->
<g id="edge393" class="edge">
<title>d13_ring_attn&#45;&gt;d13_out_proj</title>
<path fill="none" stroke="black" d="M8309,-1516.3C8309,-1516.3 8309,-1446.13 8309,-1446.13"/>
<polygon fill="black" stroke="black" points="8312.5,-1446.13 8309,-1436.13 8305.5,-1446.13 8312.5,-1446.13"/>
</g>
<!-- d14_recv_kv -->
<g id="node321" class="node">
<title>d14_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8718" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="8718" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="8718" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8718" y="-2000.88" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d13_send_kv&#45;&gt;d14_recv_kv -->
<g id="edge391" class="edge">
<title>d13_send_kv&#45;&gt;d14_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8210.91,-1440C8265.87,-1440 8366.36,-1440 8366.36,-1440 8366.36,-1440 8366.36,-2028 8366.36,-2028 8366.36,-2028 8647.15,-2028 8647.15,-2028"/>
<polygon fill="black" stroke="black" points="8647.15,-2031.5 8657.15,-2028 8647.15,-2024.5 8647.15,-2031.5"/>
</g>
<!-- d13_send_kv&#45;&gt;d14_recv_kv -->
<g id="edge421" class="edge">
<title>d13_send_kv&#45;&gt;d14_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8216.92,-1438C8274.15,-1438 8371.18,-1438 8371.18,-1438 8371.18,-1438 8371.18,-2014 8371.18,-2014 8371.18,-2014 8639.06,-2014 8639.06,-2014"/>
<polygon fill="black" stroke="black" points="8639.06,-2017.5 8649.06,-2014 8639.06,-2010.5 8639.06,-2017.5"/>
</g>
<!-- d13_out_proj&#45;&gt;d13_res1 -->
<g id="edge395" class="edge">
<title>d13_out_proj&#45;&gt;d13_res1</title>
<path fill="none" stroke="black" d="M8330,-1394.77C8330,-1394.77 8330,-1324.63 8330,-1324.63"/>
<polygon fill="black" stroke="black" points="8333.5,-1324.63 8330,-1314.63 8326.5,-1324.63 8333.5,-1324.63"/>
</g>
<!-- d13_ln2 -->
<g id="node302" class="node">
<title>d13_ln2</title>
<polygon fill="white" stroke="black" points="8283,-1160.43 8191,-1160.43 8191,-1119.43 8283,-1119.43 8283,-1160.43"/>
<text text-anchor="middle" x="8237" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="8237" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8237" y="-1126.43" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_res1&#45;&gt;d13_ln2 -->
<g id="edge396" class="edge">
<title>d13_res1&#45;&gt;d13_ln2</title>
<path fill="none" stroke="black" d="M8258.81,-1232.28C8258.81,-1232.28 8258.81,-1170.62 8258.81,-1170.62"/>
<polygon fill="black" stroke="black" points="8262.31,-1170.62 8258.81,-1160.62 8255.31,-1170.62 8262.31,-1170.62"/>
</g>
<!-- d13_res2 -->
<g id="node306" class="node">
<title>d13_res2</title>
<polygon fill="white" stroke="black" points="8273.26,-821.43 8121.72,-821.43 8082.74,-739.43 8234.28,-739.43 8273.26,-821.43"/>
<text text-anchor="middle" x="8178" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="8178" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8178" y="-766.93" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_res1&#45;&gt;d13_res2 -->
<g id="edge402" class="edge">
<title>d13_res1&#45;&gt;d13_res2</title>
<path fill="none" stroke="black" d="M8355.69,-1232.21C8355.69,-1113.62 8355.69,-780 8355.69,-780 8355.69,-780 8263.61,-780 8263.61,-780"/>
<polygon fill="black" stroke="black" points="8263.61,-776.5 8253.61,-780 8263.61,-783.5 8263.61,-776.5"/>
</g>
<!-- d13_mlp_gate -->
<g id="node303" class="node">
<title>d13_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="8145,-1047.43 8047,-1047.43 8047,-1006.43 8145,-1006.43 8145,-1047.43"/>
<text text-anchor="middle" x="8096" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="8096" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="8096" y="-1013.43" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_ln2&#45;&gt;d13_mlp_gate -->
<g id="edge397" class="edge">
<title>d13_ln2&#45;&gt;d13_mlp_gate</title>
<path fill="none" stroke="black" d="M8190.76,-1139C8161.05,-1139 8127.97,-1139 8127.97,-1139 8127.97,-1139 8127.97,-1057.48 8127.97,-1057.48"/>
<polygon fill="black" stroke="black" points="8131.47,-1057.48 8127.97,-1047.48 8124.47,-1057.48 8131.47,-1057.48"/>
</g>
<!-- d13_mlp_up -->
<g id="node304" class="node">
<title>d13_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="8286,-1047.43 8188,-1047.43 8188,-1006.43 8286,-1006.43 8286,-1047.43"/>
<text text-anchor="middle" x="8237" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="8237" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="8237" y="-1013.43" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_ln2&#45;&gt;d13_mlp_up -->
<g id="edge398" class="edge">
<title>d13_ln2&#45;&gt;d13_mlp_up</title>
<path fill="none" stroke="black" d="M8237,-1119.2C8237,-1119.2 8237,-1057.52 8237,-1057.52"/>
<polygon fill="black" stroke="black" points="8240.5,-1057.52 8237,-1047.52 8233.5,-1057.52 8240.5,-1057.52"/>
</g>
<!-- d13_mlp_down -->
<g id="node305" class="node">
<title>d13_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="8224,-934.43 8132,-934.43 8132,-893.43 8224,-893.43 8224,-934.43"/>
<text text-anchor="middle" x="8178" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="8178" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8178" y="-900.43" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_mlp_gate&#45;&gt;d13_mlp_down -->
<g id="edge399" class="edge">
<title>d13_mlp_gate&#45;&gt;d13_mlp_down</title>
<path fill="none" stroke="black" d="M8138.5,-1006.2C8138.5,-1006.2 8138.5,-944.52 8138.5,-944.52"/>
<polygon fill="black" stroke="black" points="8142,-944.52 8138.5,-934.52 8135,-944.52 8142,-944.52"/>
</g>
<!-- d13_mlp_up&#45;&gt;d13_mlp_down -->
<g id="edge400" class="edge">
<title>d13_mlp_up&#45;&gt;d13_mlp_down</title>
<path fill="none" stroke="black" d="M8206,-1006.2C8206,-1006.2 8206,-944.52 8206,-944.52"/>
<polygon fill="black" stroke="black" points="8209.5,-944.52 8206,-934.52 8202.5,-944.52 8209.5,-944.52"/>
</g>
<!-- d13_mlp_down&#45;&gt;d13_res2 -->
<g id="edge401" class="edge">
<title>d13_mlp_down&#45;&gt;d13_res2</title>
<path fill="none" stroke="black" d="M8178,-893.36C8178,-893.36 8178,-831.48 8178,-831.48"/>
<polygon fill="black" stroke="black" points="8181.5,-831.48 8178,-821.48 8174.5,-831.48 8181.5,-831.48"/>
</g>
<!-- d13_layer1 -->
<g id="node307" class="node">
<title>d13_layer1</title>
<polygon fill="lightgray" stroke="black" points="8220,-667.43 8128,-667.43 8128,-626.43 8220,-626.43 8220,-667.43"/>
<text text-anchor="middle" x="8174" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="8174" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8174" y="-633.43" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_res2&#45;&gt;d13_layer1 -->
<g id="edge403" class="edge">
<title>d13_res2&#45;&gt;d13_layer1</title>
<path fill="none" stroke="black" d="M8174,-739.28C8174,-739.28 8174,-677.62 8174,-677.62"/>
<polygon fill="black" stroke="black" points="8177.5,-677.62 8174,-667.62 8170.5,-677.62 8177.5,-677.62"/>
</g>
<!-- d13_layer2 -->
<g id="node308" class="node">
<title>d13_layer2</title>
<polygon fill="lightgray" stroke="black" points="8216,-554.43 8124,-554.43 8124,-513.43 8216,-513.43 8216,-554.43"/>
<text text-anchor="middle" x="8170" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="8170" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8170" y="-520.43" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_layer1&#45;&gt;d13_layer2 -->
<g id="edge404" class="edge">
<title>d13_layer1&#45;&gt;d13_layer2</title>
<path fill="none" stroke="black" d="M8172,-626.2C8172,-626.2 8172,-564.52 8172,-564.52"/>
<polygon fill="black" stroke="black" points="8175.5,-564.52 8172,-554.52 8168.5,-564.52 8175.5,-564.52"/>
</g>
<!-- d13_layer3 -->
<g id="node309" class="node">
<title>d13_layer3</title>
<polygon fill="lightgray" stroke="black" points="8209,-441.43 8117,-441.43 8117,-400.43 8209,-400.43 8209,-441.43"/>
<text text-anchor="middle" x="8163" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="8163" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8163" y="-407.43" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_layer2&#45;&gt;d13_layer3 -->
<g id="edge405" class="edge">
<title>d13_layer2&#45;&gt;d13_layer3</title>
<path fill="none" stroke="black" d="M8166.5,-513.2C8166.5,-513.2 8166.5,-451.52 8166.5,-451.52"/>
<polygon fill="black" stroke="black" points="8170,-451.52 8166.5,-441.52 8163,-451.52 8170,-451.52"/>
</g>
<!-- d13_output -->
<g id="node310" class="node">
<title>d13_output</title>
<polygon fill="white" stroke="black" points="8243.26,-328.43 8091.72,-328.43 8052.74,-246.43 8204.28,-246.43 8243.26,-328.43"/>
<text text-anchor="middle" x="8148" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="8148" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8148" y="-273.93" font-family="Arial" font-size="10.00">Device 13</text>
</g>
<!-- d13_layer3&#45;&gt;d13_output -->
<g id="edge406" class="edge">
<title>d13_layer3&#45;&gt;d13_output</title>
<path fill="none" stroke="black" d="M8163,-400.36C8163,-400.36 8163,-338.48 8163,-338.48"/>
<polygon fill="black" stroke="black" points="8166.5,-338.48 8163,-328.48 8159.5,-338.48 8166.5,-338.48"/>
</g>
<!-- d13_output&#45;&gt;sequence_agg -->
<g id="edge407" class="edge">
<title>d13_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M8148,-246.05C8148,-204.63 8148,-147 8148,-147 8148,-147 5021.46,-147 5021.46,-147"/>
<polygon fill="black" stroke="black" points="5021.46,-143.5 5011.46,-147 5021.46,-150.5 5021.46,-143.5"/>
</g>
<!-- d14_ln1 -->
<g id="node312" class="node">
<title>d14_ln1</title>
<polygon fill="white" stroke="black" points="8950,-1913.39 8858,-1913.39 8858,-1872.39 8950,-1872.39 8950,-1913.39"/>
<text text-anchor="middle" x="8904" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="8904" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8904" y="-1879.39" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_input&#45;&gt;d14_ln1 -->
<g id="edge409" class="edge">
<title>d14_input&#45;&gt;d14_ln1</title>
<path fill="none" stroke="black" d="M8904,-1985.28C8904,-1985.28 8904,-1923.77 8904,-1923.77"/>
<polygon fill="black" stroke="black" points="8907.5,-1923.77 8904,-1913.77 8900.5,-1923.77 8907.5,-1923.77"/>
</g>
<!-- d14_res1 -->
<g id="node323" class="node">
<title>d14_res1</title>
<polygon fill="white" stroke="black" points="9041.26,-1314.43 8889.72,-1314.43 8850.74,-1232.43 9002.28,-1232.43 9041.26,-1314.43"/>
<text text-anchor="middle" x="8946" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="8946" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8946" y="-1259.93" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_input&#45;&gt;d14_res1 -->
<g id="edge423" class="edge">
<title>d14_input&#45;&gt;d14_res1</title>
<path fill="none" stroke="black" d="M8959.46,-1999C8986.38,-1999 9013,-1999 9013,-1999 9013,-1999 9013,-1324.52 9013,-1324.52"/>
<polygon fill="black" stroke="black" points="9016.5,-1324.52 9013,-1314.52 9009.5,-1324.52 9016.5,-1324.52"/>
</g>
<!-- d14_q -->
<g id="node313" class="node">
<title>d14_q</title>
<polygon fill="lightcoral" stroke="black" points="8788,-1800.39 8696,-1800.39 8696,-1759.39 8788,-1759.39 8788,-1800.39"/>
<text text-anchor="middle" x="8742" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="8742" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8742" y="-1766.39" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_ln1&#45;&gt;d14_q -->
<g id="edge410" class="edge">
<title>d14_ln1&#45;&gt;d14_q</title>
<path fill="none" stroke="black" d="M8857.81,-1886C8809.71,-1886 8741.29,-1886 8741.29,-1886 8741.29,-1886 8741.29,-1810.6 8741.29,-1810.6"/>
<polygon fill="black" stroke="black" points="8744.79,-1810.6 8741.29,-1800.6 8737.79,-1810.6 8744.79,-1810.6"/>
</g>
<!-- d14_k -->
<g id="node314" class="node">
<title>d14_k</title>
<polygon fill="lightcoral" stroke="black" points="8950,-1800.39 8858,-1800.39 8858,-1759.39 8950,-1759.39 8950,-1800.39"/>
<text text-anchor="middle" x="8904" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="8904" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8904" y="-1766.39" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_ln1&#45;&gt;d14_k -->
<g id="edge411" class="edge">
<title>d14_ln1&#45;&gt;d14_k</title>
<path fill="none" stroke="black" d="M8904,-1872.17C8904,-1872.17 8904,-1810.49 8904,-1810.49"/>
<polygon fill="black" stroke="black" points="8907.5,-1810.49 8904,-1800.49 8900.5,-1810.49 8907.5,-1810.49"/>
</g>
<!-- d14_v -->
<g id="node315" class="node">
<title>d14_v</title>
<polygon fill="lightcoral" stroke="black" points="9112,-1800.39 9020,-1800.39 9020,-1759.39 9112,-1759.39 9112,-1800.39"/>
<text text-anchor="middle" x="9066" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="9066" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9066" y="-1766.39" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_ln1&#45;&gt;d14_v -->
<g id="edge412" class="edge">
<title>d14_ln1&#45;&gt;d14_v</title>
<path fill="none" stroke="black" d="M8950.42,-1886C8998.29,-1886 9066,-1886 9066,-1886 9066,-1886 9066,-1810.6 9066,-1810.6"/>
<polygon fill="black" stroke="black" points="9069.5,-1810.6 9066,-1800.6 9062.5,-1810.6 9069.5,-1810.6"/>
</g>
<!-- d14_q_heads -->
<g id="node316" class="node">
<title>d14_q_heads</title>
<ellipse fill="white" stroke="black" cx="8714" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="8714" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="8714" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="8714" y="-1644.9" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_q&#45;&gt;d14_q_heads -->
<g id="edge413" class="edge">
<title>d14_q&#45;&gt;d14_q_heads</title>
<path fill="none" stroke="black" d="M8741.77,-1759.28C8741.77,-1759.28 8741.77,-1695.52 8741.77,-1695.52"/>
<polygon fill="black" stroke="black" points="8745.27,-1695.52 8741.77,-1685.52 8738.27,-1695.52 8745.27,-1695.52"/>
</g>
<!-- d14_k_heads -->
<g id="node317" class="node">
<title>d14_k_heads</title>
<ellipse fill="white" stroke="black" cx="8904" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="8904" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="8904" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="8904" y="-1644.9" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_k&#45;&gt;d14_k_heads -->
<g id="edge414" class="edge">
<title>d14_k&#45;&gt;d14_k_heads</title>
<path fill="none" stroke="black" d="M8904,-1759.28C8904,-1759.28 8904,-1697.78 8904,-1697.78"/>
<polygon fill="black" stroke="black" points="8907.5,-1697.78 8904,-1687.78 8900.5,-1697.78 8907.5,-1697.78"/>
</g>
<!-- d14_v_heads -->
<g id="node318" class="node">
<title>d14_v_heads</title>
<ellipse fill="white" stroke="black" cx="9094" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="9094" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="9094" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="9094" y="-1644.9" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_v&#45;&gt;d14_v_heads -->
<g id="edge415" class="edge">
<title>d14_v&#45;&gt;d14_v_heads</title>
<path fill="none" stroke="black" d="M9066.23,-1759.28C9066.23,-1759.28 9066.23,-1695.52 9066.23,-1695.52"/>
<polygon fill="black" stroke="black" points="9069.73,-1695.52 9066.23,-1685.52 9062.73,-1695.52 9069.73,-1695.52"/>
</g>
<!-- d14_ring_attn -->
<g id="node319" class="node">
<title>d14_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="8950,-1557.41 8858,-1557.41 8858,-1516.41 8950,-1516.41 8950,-1557.41"/>
<text text-anchor="middle" x="8904" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="8904" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8904" y="-1523.41" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_q_heads&#45;&gt;d14_ring_attn -->
<g id="edge416" class="edge">
<title>d14_q_heads&#45;&gt;d14_ring_attn</title>
<path fill="none" stroke="black" d="M8757.24,-1634.77C8757.24,-1601.01 8757.24,-1543 8757.24,-1543 8757.24,-1543 8847.97,-1543 8847.97,-1543"/>
<polygon fill="black" stroke="black" points="8847.97,-1546.5 8857.97,-1543 8847.97,-1539.5 8847.97,-1546.5"/>
</g>
<!-- d14_k_heads&#45;&gt;d14_ring_attn -->
<g id="edge417" class="edge">
<title>d14_k_heads&#45;&gt;d14_ring_attn</title>
<path fill="none" stroke="black" d="M8904,-1629.3C8904,-1629.3 8904,-1567.78 8904,-1567.78"/>
<polygon fill="black" stroke="black" points="8907.5,-1567.78 8904,-1557.78 8900.5,-1567.78 8907.5,-1567.78"/>
</g>
<!-- d14_v_heads&#45;&gt;d14_ring_attn -->
<g id="edge418" class="edge">
<title>d14_v_heads&#45;&gt;d14_ring_attn</title>
<path fill="none" stroke="black" d="M9030.92,-1643.42C9030.92,-1609.55 9030.92,-1530 9030.92,-1530 9030.92,-1530 8960.18,-1530 8960.18,-1530"/>
<polygon fill="black" stroke="black" points="8960.18,-1526.5 8950.18,-1530 8960.18,-1533.5 8960.18,-1526.5"/>
</g>
<!-- d14_send_kv -->
<g id="node320" class="node">
<title>d14_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8792" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="8792" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="8792" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8792" y="-1401.92" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_ring_attn&#45;&gt;d14_send_kv -->
<g id="edge419" class="edge">
<title>d14_ring_attn&#45;&gt;d14_send_kv</title>
<path fill="none" stroke="black" d="M8879,-1516.32C8879,-1488.4 8879,-1442 8879,-1442 8879,-1442 8828.1,-1442 8828.1,-1442"/>
<polygon fill="black" stroke="black" points="8828.1,-1438.5 8818.1,-1442 8828.1,-1445.5 8828.1,-1438.5"/>
</g>
<!-- d14_out_proj -->
<g id="node322" class="node">
<title>d14_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="8992,-1435.92 8900,-1435.92 8900,-1394.92 8992,-1394.92 8992,-1435.92"/>
<text text-anchor="middle" x="8946" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="8946" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8946" y="-1401.92" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_ring_attn&#45;&gt;d14_out_proj -->
<g id="edge422" class="edge">
<title>d14_ring_attn&#45;&gt;d14_out_proj</title>
<path fill="none" stroke="black" d="M8925,-1516.3C8925,-1516.3 8925,-1446.13 8925,-1446.13"/>
<polygon fill="black" stroke="black" points="8928.5,-1446.13 8925,-1436.13 8921.5,-1446.13 8928.5,-1446.13"/>
</g>
<!-- d15_recv_kv -->
<g id="node343" class="node">
<title>d15_recv_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="9334" cy="-2014.38" rx="68.68" ry="28.98"/>
<text text-anchor="middle" x="9334" y="-2022.88" font-family="Arial" font-size="10.00">Receive KV Block</text>
<text text-anchor="middle" x="9334" y="-2011.88" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9334" y="-2000.88" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d14_send_kv&#45;&gt;d15_recv_kv -->
<g id="edge420" class="edge">
<title>d14_send_kv&#45;&gt;d15_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8826.65,-1440C8885.57,-1440 8999,-1440 8999,-1440 8999,-1440 8999,-2028 8999,-2028 8999,-2028 9263.33,-2028 9263.33,-2028"/>
<polygon fill="black" stroke="black" points="9263.33,-2031.5 9273.33,-2028 9263.33,-2024.5 9263.33,-2031.5"/>
</g>
<!-- d14_send_kv&#45;&gt;d15_recv_kv -->
<g id="edge450" class="edge">
<title>d14_send_kv&#45;&gt;d15_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8833.01,-1438C8895.15,-1438 9006,-1438 9006,-1438 9006,-1438 9006,-2014 9006,-2014 9006,-2014 9255.24,-2014 9255.24,-2014"/>
<polygon fill="black" stroke="black" points="9255.24,-2017.5 9265.24,-2014 9255.24,-2010.5 9255.24,-2017.5"/>
</g>
<!-- d14_out_proj&#45;&gt;d14_res1 -->
<g id="edge424" class="edge">
<title>d14_out_proj&#45;&gt;d14_res1</title>
<path fill="none" stroke="black" d="M8946,-1394.77C8946,-1394.77 8946,-1324.63 8946,-1324.63"/>
<polygon fill="black" stroke="black" points="8949.5,-1324.63 8946,-1314.63 8942.5,-1324.63 8949.5,-1324.63"/>
</g>
<!-- d14_ln2 -->
<g id="node324" class="node">
<title>d14_ln2</title>
<polygon fill="white" stroke="black" points="8899,-1160.43 8807,-1160.43 8807,-1119.43 8899,-1119.43 8899,-1160.43"/>
<text text-anchor="middle" x="8853" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="8853" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8853" y="-1126.43" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_res1&#45;&gt;d14_ln2 -->
<g id="edge425" class="edge">
<title>d14_res1&#45;&gt;d14_ln2</title>
<path fill="none" stroke="black" d="M8874.81,-1232.28C8874.81,-1232.28 8874.81,-1170.62 8874.81,-1170.62"/>
<polygon fill="black" stroke="black" points="8878.31,-1170.62 8874.81,-1160.62 8871.31,-1170.62 8878.31,-1170.62"/>
</g>
<!-- d14_res2 -->
<g id="node328" class="node">
<title>d14_res2</title>
<polygon fill="white" stroke="black" points="8889.26,-821.43 8737.72,-821.43 8698.74,-739.43 8850.28,-739.43 8889.26,-821.43"/>
<text text-anchor="middle" x="8794" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="8794" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8794" y="-766.93" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_res1&#45;&gt;d14_res2 -->
<g id="edge431" class="edge">
<title>d14_res1&#45;&gt;d14_res2</title>
<path fill="none" stroke="black" d="M8971.69,-1232.21C8971.69,-1113.62 8971.69,-780 8971.69,-780 8971.69,-780 8879.61,-780 8879.61,-780"/>
<polygon fill="black" stroke="black" points="8879.61,-776.5 8869.61,-780 8879.61,-783.5 8879.61,-776.5"/>
</g>
<!-- d14_mlp_gate -->
<g id="node325" class="node">
<title>d14_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="8761,-1047.43 8663,-1047.43 8663,-1006.43 8761,-1006.43 8761,-1047.43"/>
<text text-anchor="middle" x="8712" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="8712" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="8712" y="-1013.43" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_ln2&#45;&gt;d14_mlp_gate -->
<g id="edge426" class="edge">
<title>d14_ln2&#45;&gt;d14_mlp_gate</title>
<path fill="none" stroke="black" d="M8806.76,-1139C8777.05,-1139 8743.97,-1139 8743.97,-1139 8743.97,-1139 8743.97,-1057.48 8743.97,-1057.48"/>
<polygon fill="black" stroke="black" points="8747.47,-1057.48 8743.97,-1047.48 8740.47,-1057.48 8747.47,-1057.48"/>
</g>
<!-- d14_mlp_up -->
<g id="node326" class="node">
<title>d14_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="8902,-1047.43 8804,-1047.43 8804,-1006.43 8902,-1006.43 8902,-1047.43"/>
<text text-anchor="middle" x="8853" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="8853" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="8853" y="-1013.43" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_ln2&#45;&gt;d14_mlp_up -->
<g id="edge427" class="edge">
<title>d14_ln2&#45;&gt;d14_mlp_up</title>
<path fill="none" stroke="black" d="M8853,-1119.2C8853,-1119.2 8853,-1057.52 8853,-1057.52"/>
<polygon fill="black" stroke="black" points="8856.5,-1057.52 8853,-1047.52 8849.5,-1057.52 8856.5,-1057.52"/>
</g>
<!-- d14_mlp_down -->
<g id="node327" class="node">
<title>d14_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="8840,-934.43 8748,-934.43 8748,-893.43 8840,-893.43 8840,-934.43"/>
<text text-anchor="middle" x="8794" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="8794" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8794" y="-900.43" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_mlp_gate&#45;&gt;d14_mlp_down -->
<g id="edge428" class="edge">
<title>d14_mlp_gate&#45;&gt;d14_mlp_down</title>
<path fill="none" stroke="black" d="M8754.5,-1006.2C8754.5,-1006.2 8754.5,-944.52 8754.5,-944.52"/>
<polygon fill="black" stroke="black" points="8758,-944.52 8754.5,-934.52 8751,-944.52 8758,-944.52"/>
</g>
<!-- d14_mlp_up&#45;&gt;d14_mlp_down -->
<g id="edge429" class="edge">
<title>d14_mlp_up&#45;&gt;d14_mlp_down</title>
<path fill="none" stroke="black" d="M8822,-1006.2C8822,-1006.2 8822,-944.52 8822,-944.52"/>
<polygon fill="black" stroke="black" points="8825.5,-944.52 8822,-934.52 8818.5,-944.52 8825.5,-944.52"/>
</g>
<!-- d14_mlp_down&#45;&gt;d14_res2 -->
<g id="edge430" class="edge">
<title>d14_mlp_down&#45;&gt;d14_res2</title>
<path fill="none" stroke="black" d="M8794,-893.36C8794,-893.36 8794,-831.48 8794,-831.48"/>
<polygon fill="black" stroke="black" points="8797.5,-831.48 8794,-821.48 8790.5,-831.48 8797.5,-831.48"/>
</g>
<!-- d14_layer1 -->
<g id="node329" class="node">
<title>d14_layer1</title>
<polygon fill="lightgray" stroke="black" points="8836,-667.43 8744,-667.43 8744,-626.43 8836,-626.43 8836,-667.43"/>
<text text-anchor="middle" x="8790" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="8790" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8790" y="-633.43" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_res2&#45;&gt;d14_layer1 -->
<g id="edge432" class="edge">
<title>d14_res2&#45;&gt;d14_layer1</title>
<path fill="none" stroke="black" d="M8790,-739.28C8790,-739.28 8790,-677.62 8790,-677.62"/>
<polygon fill="black" stroke="black" points="8793.5,-677.62 8790,-667.62 8786.5,-677.62 8793.5,-677.62"/>
</g>
<!-- d14_layer2 -->
<g id="node330" class="node">
<title>d14_layer2</title>
<polygon fill="lightgray" stroke="black" points="8832,-554.43 8740,-554.43 8740,-513.43 8832,-513.43 8832,-554.43"/>
<text text-anchor="middle" x="8786" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="8786" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8786" y="-520.43" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_layer1&#45;&gt;d14_layer2 -->
<g id="edge433" class="edge">
<title>d14_layer1&#45;&gt;d14_layer2</title>
<path fill="none" stroke="black" d="M8788,-626.2C8788,-626.2 8788,-564.52 8788,-564.52"/>
<polygon fill="black" stroke="black" points="8791.5,-564.52 8788,-554.52 8784.5,-564.52 8791.5,-564.52"/>
</g>
<!-- d14_layer3 -->
<g id="node331" class="node">
<title>d14_layer3</title>
<polygon fill="lightgray" stroke="black" points="8825,-441.43 8733,-441.43 8733,-400.43 8825,-400.43 8825,-441.43"/>
<text text-anchor="middle" x="8779" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="8779" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8779" y="-407.43" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_layer2&#45;&gt;d14_layer3 -->
<g id="edge434" class="edge">
<title>d14_layer2&#45;&gt;d14_layer3</title>
<path fill="none" stroke="black" d="M8782.5,-513.2C8782.5,-513.2 8782.5,-451.52 8782.5,-451.52"/>
<polygon fill="black" stroke="black" points="8786,-451.52 8782.5,-441.52 8779,-451.52 8786,-451.52"/>
</g>
<!-- d14_output -->
<g id="node332" class="node">
<title>d14_output</title>
<polygon fill="white" stroke="black" points="8859.26,-328.43 8707.72,-328.43 8668.74,-246.43 8820.28,-246.43 8859.26,-328.43"/>
<text text-anchor="middle" x="8764" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="8764" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="8764" y="-273.93" font-family="Arial" font-size="10.00">Device 14</text>
</g>
<!-- d14_layer3&#45;&gt;d14_output -->
<g id="edge435" class="edge">
<title>d14_layer3&#45;&gt;d14_output</title>
<path fill="none" stroke="black" d="M8779,-400.36C8779,-400.36 8779,-338.48 8779,-338.48"/>
<polygon fill="black" stroke="black" points="8782.5,-338.48 8779,-328.48 8775.5,-338.48 8782.5,-338.48"/>
</g>
<!-- d14_output&#45;&gt;sequence_agg -->
<g id="edge436" class="edge">
<title>d14_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M8764,-246.14C8764,-203.15 8764,-142 8764,-142 8764,-142 5012.51,-142 5012.51,-142"/>
<polygon fill="black" stroke="black" points="5012.51,-138.5 5002.51,-142 5012.51,-145.5 5012.51,-138.5"/>
</g>
<!-- d15_ln1 -->
<g id="node334" class="node">
<title>d15_ln1</title>
<polygon fill="white" stroke="black" points="9566,-1913.39 9474,-1913.39 9474,-1872.39 9566,-1872.39 9566,-1913.39"/>
<text text-anchor="middle" x="9520" y="-1901.39" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="9520" y="-1890.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9520" y="-1879.39" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_input&#45;&gt;d15_ln1 -->
<g id="edge438" class="edge">
<title>d15_input&#45;&gt;d15_ln1</title>
<path fill="none" stroke="black" d="M9520,-1985.28C9520,-1985.28 9520,-1923.77 9520,-1923.77"/>
<polygon fill="black" stroke="black" points="9523.5,-1923.77 9520,-1913.77 9516.5,-1923.77 9523.5,-1923.77"/>
</g>
<!-- d15_res1 -->
<g id="node345" class="node">
<title>d15_res1</title>
<polygon fill="white" stroke="black" points="9657.26,-1314.43 9505.72,-1314.43 9466.74,-1232.43 9618.28,-1232.43 9657.26,-1314.43"/>
<text text-anchor="middle" x="9562" y="-1281.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="9562" y="-1270.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9562" y="-1259.93" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_input&#45;&gt;d15_res1 -->
<g id="edge452" class="edge">
<title>d15_input&#45;&gt;d15_res1</title>
<path fill="none" stroke="black" d="M9585.32,-2014C9605.36,-2014 9622.23,-2014 9622.23,-2014 9622.23,-2014 9622.23,-1324.56 9622.23,-1324.56"/>
<polygon fill="black" stroke="black" points="9625.73,-1324.56 9622.23,-1314.56 9618.73,-1324.56 9625.73,-1324.56"/>
</g>
<!-- d15_q -->
<g id="node335" class="node">
<title>d15_q</title>
<polygon fill="lightcoral" stroke="black" points="9404,-1800.39 9312,-1800.39 9312,-1759.39 9404,-1759.39 9404,-1800.39"/>
<text text-anchor="middle" x="9358" y="-1788.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="9358" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9358" y="-1766.39" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_ln1&#45;&gt;d15_q -->
<g id="edge439" class="edge">
<title>d15_ln1&#45;&gt;d15_q</title>
<path fill="none" stroke="black" d="M9473.81,-1899C9425.71,-1899 9357.29,-1899 9357.29,-1899 9357.29,-1899 9357.29,-1810.64 9357.29,-1810.64"/>
<polygon fill="black" stroke="black" points="9360.79,-1810.64 9357.29,-1800.64 9353.79,-1810.64 9360.79,-1810.64"/>
</g>
<!-- d15_k -->
<g id="node336" class="node">
<title>d15_k</title>
<polygon fill="lightcoral" stroke="black" points="9566,-1800.39 9474,-1800.39 9474,-1759.39 9566,-1759.39 9566,-1800.39"/>
<text text-anchor="middle" x="9520" y="-1788.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="9520" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9520" y="-1766.39" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_ln1&#45;&gt;d15_k -->
<g id="edge440" class="edge">
<title>d15_ln1&#45;&gt;d15_k</title>
<path fill="none" stroke="black" d="M9520,-1872.17C9520,-1872.17 9520,-1810.49 9520,-1810.49"/>
<polygon fill="black" stroke="black" points="9523.5,-1810.49 9520,-1800.49 9516.5,-1810.49 9523.5,-1810.49"/>
</g>
<!-- d15_v -->
<g id="node337" class="node">
<title>d15_v</title>
<polygon fill="lightcoral" stroke="black" points="9729,-1800.39 9637,-1800.39 9637,-1759.39 9729,-1759.39 9729,-1800.39"/>
<text text-anchor="middle" x="9683" y="-1788.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="9683" y="-1777.39" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9683" y="-1766.39" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_ln1&#45;&gt;d15_v -->
<g id="edge441" class="edge">
<title>d15_ln1&#45;&gt;d15_v</title>
<path fill="none" stroke="black" d="M9566.27,-1892C9614.46,-1892 9683,-1892 9683,-1892 9683,-1892 9683,-1810.45 9683,-1810.45"/>
<polygon fill="black" stroke="black" points="9686.5,-1810.45 9683,-1800.45 9679.5,-1810.45 9686.5,-1810.45"/>
</g>
<!-- d15_q_heads -->
<g id="node338" class="node">
<title>d15_q_heads</title>
<ellipse fill="white" stroke="black" cx="9330" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="9330" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="9330" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="9330" y="-1644.9" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_q&#45;&gt;d15_q_heads -->
<g id="edge442" class="edge">
<title>d15_q&#45;&gt;d15_q_heads</title>
<path fill="none" stroke="black" d="M9357.77,-1759.28C9357.77,-1759.28 9357.77,-1695.52 9357.77,-1695.52"/>
<polygon fill="black" stroke="black" points="9361.27,-1695.52 9357.77,-1685.52 9354.27,-1695.52 9361.27,-1695.52"/>
</g>
<!-- d15_k_heads -->
<g id="node339" class="node">
<title>d15_k_heads</title>
<ellipse fill="white" stroke="black" cx="9520" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="9520" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="9520" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="9520" y="-1644.9" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_k&#45;&gt;d15_k_heads -->
<g id="edge443" class="edge">
<title>d15_k&#45;&gt;d15_k_heads</title>
<path fill="none" stroke="black" d="M9520,-1759.28C9520,-1759.28 9520,-1697.78 9520,-1697.78"/>
<polygon fill="black" stroke="black" points="9523.5,-1697.78 9520,-1687.78 9516.5,-1697.78 9523.5,-1697.78"/>
</g>
<!-- d15_v_heads -->
<g id="node340" class="node">
<title>d15_v_heads</title>
<ellipse fill="white" stroke="black" cx="9710" cy="-1658.4" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="9710" y="-1666.9" font-family="Arial" font-size="10.00">Split to Heads</text>
<text text-anchor="middle" x="9710" y="-1655.9" font-family="Arial" font-size="10.00">[128, 6250, 32, 128]</text>
<text text-anchor="middle" x="9710" y="-1644.9" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_v&#45;&gt;d15_v_heads -->
<g id="edge444" class="edge">
<title>d15_v&#45;&gt;d15_v_heads</title>
<path fill="none" stroke="black" d="M9683,-1759.28C9683,-1759.28 9683,-1695.52 9683,-1695.52"/>
<polygon fill="black" stroke="black" points="9686.5,-1695.52 9683,-1685.52 9679.5,-1695.52 9686.5,-1695.52"/>
</g>
<!-- d15_ring_attn -->
<g id="node341" class="node">
<title>d15_ring_attn</title>
<polygon fill="lightblue" stroke="black" points="9566,-1557.41 9474,-1557.41 9474,-1516.41 9566,-1516.41 9566,-1557.41"/>
<text text-anchor="middle" x="9520" y="-1545.41" font-family="Arial" font-size="10.00">Ring Attention</text>
<text text-anchor="middle" x="9520" y="-1534.41" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9520" y="-1523.41" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_q_heads&#45;&gt;d15_ring_attn -->
<g id="edge445" class="edge">
<title>d15_q_heads&#45;&gt;d15_ring_attn</title>
<path fill="none" stroke="black" d="M9373.24,-1634.77C9373.24,-1601.01 9373.24,-1543 9373.24,-1543 9373.24,-1543 9463.97,-1543 9463.97,-1543"/>
<polygon fill="black" stroke="black" points="9463.97,-1546.5 9473.97,-1543 9463.97,-1539.5 9463.97,-1546.5"/>
</g>
<!-- d15_k_heads&#45;&gt;d15_ring_attn -->
<g id="edge446" class="edge">
<title>d15_k_heads&#45;&gt;d15_ring_attn</title>
<path fill="none" stroke="black" d="M9520,-1629.3C9520,-1629.3 9520,-1567.78 9520,-1567.78"/>
<polygon fill="black" stroke="black" points="9523.5,-1567.78 9520,-1557.78 9516.5,-1567.78 9523.5,-1567.78"/>
</g>
<!-- d15_v_heads&#45;&gt;d15_ring_attn -->
<g id="edge447" class="edge">
<title>d15_v_heads&#45;&gt;d15_ring_attn</title>
<path fill="none" stroke="black" d="M9646.92,-1643.39C9646.92,-1610.71 9646.92,-1536 9646.92,-1536 9646.92,-1536 9576.18,-1536 9576.18,-1536"/>
<polygon fill="black" stroke="black" points="9576.18,-1532.5 9566.18,-1536 9576.18,-1539.5 9576.18,-1532.5"/>
</g>
<!-- d15_send_kv -->
<g id="node342" class="node">
<title>d15_send_kv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="9408" cy="-1415.42" rx="65.11" ry="28.98"/>
<text text-anchor="middle" x="9408" y="-1423.92" font-family="Arial" font-size="10.00">Send KV Block</text>
<text text-anchor="middle" x="9408" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9408" y="-1401.92" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_ring_attn&#45;&gt;d15_send_kv -->
<g id="edge448" class="edge">
<title>d15_ring_attn&#45;&gt;d15_send_kv</title>
<path fill="none" stroke="black" d="M9495,-1516.36C9495,-1487.91 9495,-1440 9495,-1440 9495,-1440 9452.63,-1440 9452.63,-1440"/>
<polygon fill="black" stroke="black" points="9452.63,-1436.5 9442.63,-1440 9452.63,-1443.5 9452.63,-1436.5"/>
</g>
<!-- d15_out_proj -->
<g id="node344" class="node">
<title>d15_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="9608,-1435.92 9516,-1435.92 9516,-1394.92 9608,-1394.92 9608,-1435.92"/>
<text text-anchor="middle" x="9562" y="-1423.92" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="9562" y="-1412.92" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9562" y="-1401.92" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_ring_attn&#45;&gt;d15_out_proj -->
<g id="edge451" class="edge">
<title>d15_ring_attn&#45;&gt;d15_out_proj</title>
<path fill="none" stroke="black" d="M9541,-1516.3C9541,-1516.3 9541,-1446.13 9541,-1446.13"/>
<polygon fill="black" stroke="black" points="9544.5,-1446.13 9541,-1436.13 9537.5,-1446.13 9544.5,-1446.13"/>
</g>
<!-- d15_send_kv&#45;&gt;d0_recv_kv -->
<g id="edge15" class="edge">
<title>d15_send_kv&#45;&gt;d0_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9418.15,-1444.15C9418.15,-1537.15 9418.15,-1824 9418.15,-1824 9418.15,-1824 260.2,-1824 260.2,-1824 260.2,-1824 260.2,-1982.17 260.2,-1982.17"/>
<polygon fill="black" stroke="black" points="256.7,-1982.17 260.2,-1992.17 263.7,-1982.17 256.7,-1982.17"/>
</g>
<!-- d15_send_kv&#45;&gt;d0_recv_kv -->
<g id="edge449" class="edge">
<title>d15_send_kv&#45;&gt;d0_recv_kv</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9432.31,-1442.48C9432.31,-1537.18 9432.31,-1848 9432.31,-1848 9432.31,-1848 272.39,-1848 272.39,-1848 272.39,-1848 272.39,-1987.82 272.39,-1987.82"/>
<polygon fill="black" stroke="black" points="268.89,-1987.82 272.39,-1997.82 275.89,-1987.82 268.89,-1987.82"/>
</g>
<!-- d15_out_proj&#45;&gt;d15_res1 -->
<g id="edge453" class="edge">
<title>d15_out_proj&#45;&gt;d15_res1</title>
<path fill="none" stroke="black" d="M9562,-1394.77C9562,-1394.77 9562,-1324.63 9562,-1324.63"/>
<polygon fill="black" stroke="black" points="9565.5,-1324.63 9562,-1314.63 9558.5,-1324.63 9565.5,-1324.63"/>
</g>
<!-- d15_ln2 -->
<g id="node346" class="node">
<title>d15_ln2</title>
<polygon fill="white" stroke="black" points="9515,-1160.43 9423,-1160.43 9423,-1119.43 9515,-1119.43 9515,-1160.43"/>
<text text-anchor="middle" x="9469" y="-1148.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="9469" y="-1137.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9469" y="-1126.43" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_res1&#45;&gt;d15_ln2 -->
<g id="edge454" class="edge">
<title>d15_res1&#45;&gt;d15_ln2</title>
<path fill="none" stroke="black" d="M9490.81,-1232.28C9490.81,-1232.28 9490.81,-1170.62 9490.81,-1170.62"/>
<polygon fill="black" stroke="black" points="9494.31,-1170.62 9490.81,-1160.62 9487.31,-1170.62 9494.31,-1170.62"/>
</g>
<!-- d15_res2 -->
<g id="node350" class="node">
<title>d15_res2</title>
<polygon fill="white" stroke="black" points="9505.26,-821.43 9353.72,-821.43 9314.74,-739.43 9466.28,-739.43 9505.26,-821.43"/>
<text text-anchor="middle" x="9410" y="-788.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="9410" y="-777.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9410" y="-766.93" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_res1&#45;&gt;d15_res2 -->
<g id="edge460" class="edge">
<title>d15_res1&#45;&gt;d15_res2</title>
<path fill="none" stroke="black" d="M9587.69,-1232.21C9587.69,-1113.62 9587.69,-780 9587.69,-780 9587.69,-780 9495.61,-780 9495.61,-780"/>
<polygon fill="black" stroke="black" points="9495.61,-776.5 9485.61,-780 9495.61,-783.5 9495.61,-776.5"/>
</g>
<!-- d15_mlp_gate -->
<g id="node347" class="node">
<title>d15_mlp_gate</title>
<polygon fill="lightgreen" stroke="black" points="9377,-1047.43 9279,-1047.43 9279,-1006.43 9377,-1006.43 9377,-1047.43"/>
<text text-anchor="middle" x="9328" y="-1035.43" font-family="Arial" font-size="10.00">MLP Gate</text>
<text text-anchor="middle" x="9328" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="9328" y="-1013.43" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_ln2&#45;&gt;d15_mlp_gate -->
<g id="edge455" class="edge">
<title>d15_ln2&#45;&gt;d15_mlp_gate</title>
<path fill="none" stroke="black" d="M9422.76,-1139C9393.05,-1139 9359.97,-1139 9359.97,-1139 9359.97,-1139 9359.97,-1057.48 9359.97,-1057.48"/>
<polygon fill="black" stroke="black" points="9363.47,-1057.48 9359.97,-1047.48 9356.47,-1057.48 9363.47,-1057.48"/>
</g>
<!-- d15_mlp_up -->
<g id="node348" class="node">
<title>d15_mlp_up</title>
<polygon fill="lightgreen" stroke="black" points="9518,-1047.43 9420,-1047.43 9420,-1006.43 9518,-1006.43 9518,-1047.43"/>
<text text-anchor="middle" x="9469" y="-1035.43" font-family="Arial" font-size="10.00">MLP Up</text>
<text text-anchor="middle" x="9469" y="-1024.43" font-family="Arial" font-size="10.00">[128, 6250, 16384]</text>
<text text-anchor="middle" x="9469" y="-1013.43" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_ln2&#45;&gt;d15_mlp_up -->
<g id="edge456" class="edge">
<title>d15_ln2&#45;&gt;d15_mlp_up</title>
<path fill="none" stroke="black" d="M9469,-1119.2C9469,-1119.2 9469,-1057.52 9469,-1057.52"/>
<polygon fill="black" stroke="black" points="9472.5,-1057.52 9469,-1047.52 9465.5,-1057.52 9472.5,-1057.52"/>
</g>
<!-- d15_mlp_down -->
<g id="node349" class="node">
<title>d15_mlp_down</title>
<polygon fill="lightgreen" stroke="black" points="9456,-934.43 9364,-934.43 9364,-893.43 9456,-893.43 9456,-934.43"/>
<text text-anchor="middle" x="9410" y="-922.43" font-family="Arial" font-size="10.00">MLP Down</text>
<text text-anchor="middle" x="9410" y="-911.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9410" y="-900.43" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_mlp_gate&#45;&gt;d15_mlp_down -->
<g id="edge457" class="edge">
<title>d15_mlp_gate&#45;&gt;d15_mlp_down</title>
<path fill="none" stroke="black" d="M9370.5,-1006.2C9370.5,-1006.2 9370.5,-944.52 9370.5,-944.52"/>
<polygon fill="black" stroke="black" points="9374,-944.52 9370.5,-934.52 9367,-944.52 9374,-944.52"/>
</g>
<!-- d15_mlp_up&#45;&gt;d15_mlp_down -->
<g id="edge458" class="edge">
<title>d15_mlp_up&#45;&gt;d15_mlp_down</title>
<path fill="none" stroke="black" d="M9438,-1006.2C9438,-1006.2 9438,-944.52 9438,-944.52"/>
<polygon fill="black" stroke="black" points="9441.5,-944.52 9438,-934.52 9434.5,-944.52 9441.5,-944.52"/>
</g>
<!-- d15_mlp_down&#45;&gt;d15_res2 -->
<g id="edge459" class="edge">
<title>d15_mlp_down&#45;&gt;d15_res2</title>
<path fill="none" stroke="black" d="M9410,-893.36C9410,-893.36 9410,-831.48 9410,-831.48"/>
<polygon fill="black" stroke="black" points="9413.5,-831.48 9410,-821.48 9406.5,-831.48 9413.5,-831.48"/>
</g>
<!-- d15_layer1 -->
<g id="node351" class="node">
<title>d15_layer1</title>
<polygon fill="lightgray" stroke="black" points="9452,-667.43 9360,-667.43 9360,-626.43 9452,-626.43 9452,-667.43"/>
<text text-anchor="middle" x="9406" y="-655.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="9406" y="-644.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9406" y="-633.43" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_res2&#45;&gt;d15_layer1 -->
<g id="edge461" class="edge">
<title>d15_res2&#45;&gt;d15_layer1</title>
<path fill="none" stroke="black" d="M9406,-739.28C9406,-739.28 9406,-677.62 9406,-677.62"/>
<polygon fill="black" stroke="black" points="9409.5,-677.62 9406,-667.62 9402.5,-677.62 9409.5,-677.62"/>
</g>
<!-- d15_layer2 -->
<g id="node352" class="node">
<title>d15_layer2</title>
<polygon fill="lightgray" stroke="black" points="9448,-554.43 9356,-554.43 9356,-513.43 9448,-513.43 9448,-554.43"/>
<text text-anchor="middle" x="9402" y="-542.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="9402" y="-531.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9402" y="-520.43" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_layer1&#45;&gt;d15_layer2 -->
<g id="edge462" class="edge">
<title>d15_layer1&#45;&gt;d15_layer2</title>
<path fill="none" stroke="black" d="M9404,-626.2C9404,-626.2 9404,-564.52 9404,-564.52"/>
<polygon fill="black" stroke="black" points="9407.5,-564.52 9404,-554.52 9400.5,-564.52 9407.5,-564.52"/>
</g>
<!-- d15_layer3 -->
<g id="node353" class="node">
<title>d15_layer3</title>
<polygon fill="lightgray" stroke="black" points="9441,-441.43 9349,-441.43 9349,-400.43 9441,-400.43 9441,-441.43"/>
<text text-anchor="middle" x="9395" y="-429.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="9395" y="-418.43" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9395" y="-407.43" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_layer2&#45;&gt;d15_layer3 -->
<g id="edge463" class="edge">
<title>d15_layer2&#45;&gt;d15_layer3</title>
<path fill="none" stroke="black" d="M9398.5,-513.2C9398.5,-513.2 9398.5,-451.52 9398.5,-451.52"/>
<polygon fill="black" stroke="black" points="9402,-451.52 9398.5,-441.52 9395,-451.52 9402,-451.52"/>
</g>
<!-- d15_output -->
<g id="node354" class="node">
<title>d15_output</title>
<polygon fill="white" stroke="black" points="9475.26,-328.43 9323.72,-328.43 9284.74,-246.43 9436.28,-246.43 9475.26,-328.43"/>
<text text-anchor="middle" x="9380" y="-295.93" font-family="Arial" font-size="10.00">Local Output</text>
<text text-anchor="middle" x="9380" y="-284.93" font-family="Arial" font-size="10.00">[128, 6250, 4096]</text>
<text text-anchor="middle" x="9380" y="-273.93" font-family="Arial" font-size="10.00">Device 15</text>
</g>
<!-- d15_layer3&#45;&gt;d15_output -->
<g id="edge464" class="edge">
<title>d15_layer3&#45;&gt;d15_output</title>
<path fill="none" stroke="black" d="M9395,-400.36C9395,-400.36 9395,-338.48 9395,-338.48"/>
<polygon fill="black" stroke="black" points="9398.5,-338.48 9395,-328.48 9391.5,-338.48 9398.5,-338.48"/>
</g>
<!-- d15_output&#45;&gt;sequence_agg -->
<g id="edge465" class="edge">
<title>d15_output&#45;&gt;sequence_agg</title>
<path fill="none" stroke="black" d="M9380,-246.32C9380,-201.78 9380,-137 9380,-137 9380,-137 4996.25,-137 4996.25,-137"/>
<polygon fill="black" stroke="black" points="4996.25,-133.5 4986.25,-137 4996.25,-140.5 4996.25,-133.5"/>
</g>
<!-- output -->
<g id="node356" class="node">
<title>output</title>
<polygon fill="lightyellow" stroke="black" points="5181.57,-60 4787.74,-60 4686.43,0 5080.26,0 5181.57,-60"/>
<text text-anchor="middle" x="4934" y="-33" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="4934" y="-22" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- sequence_agg&#45;&gt;output -->
<g id="edge466" class="edge">
<title>sequence_agg&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4934,-131.75C4934,-131.75 4934,-70.45 4934,-70.45"/>
<polygon fill="black" stroke="black" points="4937.5,-70.45 4934,-60.45 4930.5,-70.45 4937.5,-70.45"/>
</g>
</g>
</svg>
