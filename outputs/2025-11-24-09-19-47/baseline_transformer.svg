<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_transformer Pages: 1 -->
<svg width="6287pt" height="2457pt"
 viewBox="0.00 0.00 6286.55 2457.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2453)">
<title>baseline_transformer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2453 6282.55,-2453 6282.55,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="lightblue" stroke="black" points="574.57,-8 574.57,-2441 4155.51,-2441 4155.51,-8 574.57,-8"/>
<text text-anchor="middle" x="2365.04" y="-2425.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="2365.04" y="-2410.8" font-family="Times,serif" font-size="14.00">(Devices 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="lightgreen" stroke="black" points="4324.51,-1791 4324.51,-1905 5703.98,-1905 5703.98,-1791 4324.51,-1791"/>
<text text-anchor="middle" x="5014.24" y="-1889.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="5014.24" y="-1874.8" font-family="Times,serif" font-size="14.00">(Devices 8&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-1830 101.53,-1830 0.22,-1770 394.04,-1770 495.35,-1830"/>
<text text-anchor="middle" x="247.78" y="-1803" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="247.78" y="-1792" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- l0_input -->
<g id="node2" class="node">
<title>l0_input</title>
<ellipse fill="white" stroke="black" cx="655.4" cy="-1800" rx="72.66" ry="21.43"/>
<text text-anchor="middle" x="655.4" y="-1803" font-family="Arial" font-size="10.00">Layer 0 Input</text>
<text text-anchor="middle" x="655.4" y="-1792" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- input&#45;&gt;l0_input -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_input</title>
<path fill="none" stroke="black" d="M444.73,-1800C444.73,-1800 572.5,-1800 572.5,-1800"/>
<polygon fill="black" stroke="black" points="572.5,-1803.5 582.5,-1800 572.5,-1796.5 572.5,-1803.5"/>
</g>
<!-- l0_layernorm1 -->
<g id="node3" class="node">
<title>l0_layernorm1</title>
<polygon fill="white" stroke="black" points="918.23,-1243 815.23,-1243 815.23,-1207 918.23,-1207 918.23,-1243"/>
<text text-anchor="middle" x="866.73" y="-1228" font-family="Arial" font-size="10.00">Pre&#45;Attention LN</text>
<text text-anchor="middle" x="866.73" y="-1217" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- l0_input&#45;&gt;l0_layernorm1 -->
<g id="edge2" class="edge">
<title>l0_input&#45;&gt;l0_layernorm1</title>
<path fill="none" stroke="black" d="M708.14,-1785.36C757.45,-1785.36 823.55,-1785.36 823.55,-1785.36 823.55,-1785.36 823.55,-1253.01 823.55,-1253.01"/>
<polygon fill="black" stroke="black" points="827.05,-1253.01 823.55,-1243.01 820.05,-1253.01 827.05,-1253.01"/>
</g>
<!-- l0_residual1 -->
<g id="node30" class="node">
<title>l0_residual1</title>
<polygon fill="white" stroke="black" points="1828.25,-1824 1658.72,-1824 1615.11,-1742 1784.64,-1742 1828.25,-1824"/>
<text text-anchor="middle" x="1721.68" y="-1791.5" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1721.68" y="-1780.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="1721.68" y="-1769.5" font-family="Arial" font-size="10.00">All Devices 0&#45;7</text>
</g>
<!-- l0_input&#45;&gt;l0_residual1 -->
<g id="edge52" class="edge">
<title>l0_input&#45;&gt;l0_residual1</title>
<path fill="none" stroke="black" d="M722.91,-1791.93C722.91,-1791.93 1631.65,-1791.93 1631.65,-1791.93"/>
<polygon fill="black" stroke="black" points="1631.65,-1795.43 1641.65,-1791.93 1631.65,-1788.43 1631.65,-1795.43"/>
</g>
<!-- l0_q_proj_0 -->
<g id="node4" class="node">
<title>l0_q_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-57.5 1005.23,-57.5 1005.23,-16.5 1103.23,-16.5 1103.23,-57.5"/>
<text text-anchor="middle" x="1054.23" y="-45.5" font-family="Arial" font-size="10.00">Q Proj 0</text>
<text text-anchor="middle" x="1054.23" y="-34.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-23.5" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_q_proj_0 -->
<g id="edge3" class="edge">
<title>l0_layernorm1&#45;&gt;l0_q_proj_0</title>
<path fill="none" stroke="black" d="M823.55,-1206.81C823.55,-1057.35 823.55,-37 823.55,-37 823.55,-37 995.03,-37 995.03,-37"/>
<polygon fill="black" stroke="black" points="995.03,-40.5 1005.03,-37 995.03,-33.5 995.03,-40.5"/>
</g>
<!-- l0_k_proj_0 -->
<g id="node5" class="node">
<title>l0_k_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-156.5 1005.23,-156.5 1005.23,-115.5 1103.23,-115.5 1103.23,-156.5"/>
<text text-anchor="middle" x="1054.23" y="-144.5" font-family="Arial" font-size="10.00">K Proj 0</text>
<text text-anchor="middle" x="1054.23" y="-133.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-122.5" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_k_proj_0 -->
<g id="edge4" class="edge">
<title>l0_layernorm1&#45;&gt;l0_k_proj_0</title>
<path fill="none" stroke="black" d="M831.55,-1206.56C831.55,-1063.45 831.55,-136 831.55,-136 831.55,-136 995.09,-136 995.09,-136"/>
<polygon fill="black" stroke="black" points="995.09,-139.5 1005.09,-136 995.09,-132.5 995.09,-139.5"/>
</g>
<!-- l0_v_proj_0 -->
<g id="node6" class="node">
<title>l0_v_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-255.5 1005.23,-255.5 1005.23,-214.5 1103.23,-214.5 1103.23,-255.5"/>
<text text-anchor="middle" x="1054.23" y="-243.5" font-family="Arial" font-size="10.00">V Proj 0</text>
<text text-anchor="middle" x="1054.23" y="-232.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-221.5" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_v_proj_0 -->
<g id="edge5" class="edge">
<title>l0_layernorm1&#45;&gt;l0_v_proj_0</title>
<path fill="none" stroke="black" d="M839.55,-1206.97C839.55,-1072.79 839.55,-235 839.55,-235 839.55,-235 994.98,-235 994.98,-235"/>
<polygon fill="black" stroke="black" points="994.98,-238.5 1004.98,-235 994.98,-231.5 994.98,-238.5"/>
</g>
<!-- l0_q_proj_1 -->
<g id="node7" class="node">
<title>l0_q_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-354.5 1005.23,-354.5 1005.23,-313.5 1103.23,-313.5 1103.23,-354.5"/>
<text text-anchor="middle" x="1054.23" y="-342.5" font-family="Arial" font-size="10.00">Q Proj 1</text>
<text text-anchor="middle" x="1054.23" y="-331.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-320.5" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_q_proj_1 -->
<g id="edge6" class="edge">
<title>l0_layernorm1&#45;&gt;l0_q_proj_1</title>
<path fill="none" stroke="black" d="M847.55,-1206.8C847.55,-1080.03 847.55,-334 847.55,-334 847.55,-334 994.99,-334 994.99,-334"/>
<polygon fill="black" stroke="black" points="994.99,-337.5 1004.99,-334 994.99,-330.5 994.99,-337.5"/>
</g>
<!-- l0_k_proj_1 -->
<g id="node8" class="node">
<title>l0_k_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-453.5 1005.23,-453.5 1005.23,-412.5 1103.23,-412.5 1103.23,-453.5"/>
<text text-anchor="middle" x="1054.23" y="-441.5" font-family="Arial" font-size="10.00">K Proj 1</text>
<text text-anchor="middle" x="1054.23" y="-430.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-419.5" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_k_proj_1 -->
<g id="edge7" class="edge">
<title>l0_layernorm1&#45;&gt;l0_k_proj_1</title>
<path fill="none" stroke="black" d="M855.55,-1206.97C855.55,-1089.08 855.55,-433 855.55,-433 855.55,-433 995.12,-433 995.12,-433"/>
<polygon fill="black" stroke="black" points="995.12,-436.5 1005.12,-433 995.12,-429.5 995.12,-436.5"/>
</g>
<!-- l0_v_proj_1 -->
<g id="node9" class="node">
<title>l0_v_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-552.5 1005.23,-552.5 1005.23,-511.5 1103.23,-511.5 1103.23,-552.5"/>
<text text-anchor="middle" x="1054.23" y="-540.5" font-family="Arial" font-size="10.00">V Proj 1</text>
<text text-anchor="middle" x="1054.23" y="-529.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-518.5" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_v_proj_1 -->
<g id="edge8" class="edge">
<title>l0_layernorm1&#45;&gt;l0_v_proj_1</title>
<path fill="none" stroke="black" d="M863.55,-1206.82C863.55,-1097.48 863.55,-532 863.55,-532 863.55,-532 995.13,-532 995.13,-532"/>
<polygon fill="black" stroke="black" points="995.13,-535.5 1005.13,-532 995.13,-528.5 995.13,-535.5"/>
</g>
<!-- l0_q_proj_2 -->
<g id="node10" class="node">
<title>l0_q_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-651.5 1005.23,-651.5 1005.23,-610.5 1103.23,-610.5 1103.23,-651.5"/>
<text text-anchor="middle" x="1054.23" y="-639.5" font-family="Arial" font-size="10.00">Q Proj 2</text>
<text text-anchor="middle" x="1054.23" y="-628.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-617.5" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_q_proj_2 -->
<g id="edge9" class="edge">
<title>l0_layernorm1&#45;&gt;l0_q_proj_2</title>
<path fill="none" stroke="black" d="M871.55,-1206.9C871.55,-1107.35 871.55,-631 871.55,-631 871.55,-631 994.79,-631 994.79,-631"/>
<polygon fill="black" stroke="black" points="994.79,-634.5 1004.79,-631 994.79,-627.5 994.79,-634.5"/>
</g>
<!-- l0_k_proj_2 -->
<g id="node11" class="node">
<title>l0_k_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-750.5 1005.23,-750.5 1005.23,-709.5 1103.23,-709.5 1103.23,-750.5"/>
<text text-anchor="middle" x="1054.23" y="-738.5" font-family="Arial" font-size="10.00">K Proj 2</text>
<text text-anchor="middle" x="1054.23" y="-727.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-716.5" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_k_proj_2 -->
<g id="edge10" class="edge">
<title>l0_layernorm1&#45;&gt;l0_k_proj_2</title>
<path fill="none" stroke="black" d="M879.55,-1206.8C879.55,-1117.49 879.55,-730 879.55,-730 879.55,-730 995.11,-730 995.11,-730"/>
<polygon fill="black" stroke="black" points="995.11,-733.5 1005.11,-730 995.11,-726.5 995.11,-733.5"/>
</g>
<!-- l0_v_proj_2 -->
<g id="node12" class="node">
<title>l0_v_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-849.5 1005.23,-849.5 1005.23,-808.5 1103.23,-808.5 1103.23,-849.5"/>
<text text-anchor="middle" x="1054.23" y="-837.5" font-family="Arial" font-size="10.00">V Proj 2</text>
<text text-anchor="middle" x="1054.23" y="-826.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-815.5" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_v_proj_2 -->
<g id="edge11" class="edge">
<title>l0_layernorm1&#45;&gt;l0_v_proj_2</title>
<path fill="none" stroke="black" d="M886.55,-1206.96C886.55,-1129.49 886.55,-829 886.55,-829 886.55,-829 994.83,-829 994.83,-829"/>
<polygon fill="black" stroke="black" points="994.83,-832.5 1004.83,-829 994.83,-825.5 994.83,-832.5"/>
</g>
<!-- l0_q_proj_3 -->
<g id="node13" class="node">
<title>l0_q_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-948.5 1005.23,-948.5 1005.23,-907.5 1103.23,-907.5 1103.23,-948.5"/>
<text text-anchor="middle" x="1054.23" y="-936.5" font-family="Arial" font-size="10.00">Q Proj 3</text>
<text text-anchor="middle" x="1054.23" y="-925.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-914.5" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_q_proj_3 -->
<g id="edge12" class="edge">
<title>l0_layernorm1&#45;&gt;l0_q_proj_3</title>
<path fill="none" stroke="black" d="M894.55,-1206.87C894.55,-1142.39 894.55,-928 894.55,-928 894.55,-928 995.02,-928 995.02,-928"/>
<polygon fill="black" stroke="black" points="995.02,-931.5 1005.02,-928 995.02,-924.5 995.02,-931.5"/>
</g>
<!-- l0_k_proj_3 -->
<g id="node14" class="node">
<title>l0_k_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-1047.5 1005.23,-1047.5 1005.23,-1006.5 1103.23,-1006.5 1103.23,-1047.5"/>
<text text-anchor="middle" x="1054.23" y="-1035.5" font-family="Arial" font-size="10.00">K Proj 3</text>
<text text-anchor="middle" x="1054.23" y="-1024.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-1013.5" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_k_proj_3 -->
<g id="edge13" class="edge">
<title>l0_layernorm1&#45;&gt;l0_k_proj_3</title>
<path fill="none" stroke="black" d="M902.55,-1206.73C902.55,-1157.71 902.55,-1027 902.55,-1027 902.55,-1027 994.98,-1027 994.98,-1027"/>
<polygon fill="black" stroke="black" points="994.98,-1030.5 1004.98,-1027 994.98,-1023.5 994.98,-1030.5"/>
</g>
<!-- l0_v_proj_3 -->
<g id="node15" class="node">
<title>l0_v_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-1146.5 1005.23,-1146.5 1005.23,-1105.5 1103.23,-1105.5 1103.23,-1146.5"/>
<text text-anchor="middle" x="1054.23" y="-1134.5" font-family="Arial" font-size="10.00">V Proj 3</text>
<text text-anchor="middle" x="1054.23" y="-1123.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-1112.5" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_v_proj_3 -->
<g id="edge14" class="edge">
<title>l0_layernorm1&#45;&gt;l0_v_proj_3</title>
<path fill="none" stroke="black" d="M910.55,-1206.84C910.55,-1178.26 910.55,-1126 910.55,-1126 910.55,-1126 995.19,-1126 995.19,-1126"/>
<polygon fill="black" stroke="black" points="995.19,-1129.5 1005.19,-1126 995.19,-1122.5 995.19,-1129.5"/>
</g>
<!-- l0_q_proj_4 -->
<g id="node16" class="node">
<title>l0_q_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-1245.5 1005.23,-1245.5 1005.23,-1204.5 1103.23,-1204.5 1103.23,-1245.5"/>
<text text-anchor="middle" x="1054.23" y="-1233.5" font-family="Arial" font-size="10.00">Q Proj 4</text>
<text text-anchor="middle" x="1054.23" y="-1222.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-1211.5" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_q_proj_4 -->
<g id="edge15" class="edge">
<title>l0_layernorm1&#45;&gt;l0_q_proj_4</title>
<path fill="none" stroke="black" d="M918.46,-1225C918.46,-1225 994.93,-1225 994.93,-1225"/>
<polygon fill="black" stroke="black" points="994.93,-1228.5 1004.93,-1225 994.93,-1221.5 994.93,-1228.5"/>
</g>
<!-- l0_k_proj_4 -->
<g id="node17" class="node">
<title>l0_k_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-1344.5 1005.23,-1344.5 1005.23,-1303.5 1103.23,-1303.5 1103.23,-1344.5"/>
<text text-anchor="middle" x="1054.23" y="-1332.5" font-family="Arial" font-size="10.00">K Proj 4</text>
<text text-anchor="middle" x="1054.23" y="-1321.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-1310.5" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_k_proj_4 -->
<g id="edge16" class="edge">
<title>l0_layernorm1&#45;&gt;l0_k_proj_4</title>
<path fill="none" stroke="black" d="M910.55,-1243.16C910.55,-1271.74 910.55,-1324 910.55,-1324 910.55,-1324 995.19,-1324 995.19,-1324"/>
<polygon fill="black" stroke="black" points="995.19,-1327.5 1005.19,-1324 995.19,-1320.5 995.19,-1327.5"/>
</g>
<!-- l0_v_proj_4 -->
<g id="node18" class="node">
<title>l0_v_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-1443.5 1005.23,-1443.5 1005.23,-1402.5 1103.23,-1402.5 1103.23,-1443.5"/>
<text text-anchor="middle" x="1054.23" y="-1431.5" font-family="Arial" font-size="10.00">V Proj 4</text>
<text text-anchor="middle" x="1054.23" y="-1420.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-1409.5" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_v_proj_4 -->
<g id="edge17" class="edge">
<title>l0_layernorm1&#45;&gt;l0_v_proj_4</title>
<path fill="none" stroke="black" d="M902.55,-1243.27C902.55,-1292.29 902.55,-1423 902.55,-1423 902.55,-1423 994.98,-1423 994.98,-1423"/>
<polygon fill="black" stroke="black" points="994.98,-1426.5 1004.98,-1423 994.98,-1419.5 994.98,-1426.5"/>
</g>
<!-- l0_q_proj_5 -->
<g id="node19" class="node">
<title>l0_q_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-1542.5 1005.23,-1542.5 1005.23,-1501.5 1103.23,-1501.5 1103.23,-1542.5"/>
<text text-anchor="middle" x="1054.23" y="-1530.5" font-family="Arial" font-size="10.00">Q Proj 5</text>
<text text-anchor="middle" x="1054.23" y="-1519.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-1508.5" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_q_proj_5 -->
<g id="edge18" class="edge">
<title>l0_layernorm1&#45;&gt;l0_q_proj_5</title>
<path fill="none" stroke="black" d="M894.55,-1243.13C894.55,-1307.61 894.55,-1522 894.55,-1522 894.55,-1522 995.02,-1522 995.02,-1522"/>
<polygon fill="black" stroke="black" points="995.02,-1525.5 1005.02,-1522 995.02,-1518.5 995.02,-1525.5"/>
</g>
<!-- l0_k_proj_5 -->
<g id="node20" class="node">
<title>l0_k_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-1641.5 1005.23,-1641.5 1005.23,-1600.5 1103.23,-1600.5 1103.23,-1641.5"/>
<text text-anchor="middle" x="1054.23" y="-1629.5" font-family="Arial" font-size="10.00">K Proj 5</text>
<text text-anchor="middle" x="1054.23" y="-1618.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-1607.5" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_k_proj_5 -->
<g id="edge19" class="edge">
<title>l0_layernorm1&#45;&gt;l0_k_proj_5</title>
<path fill="none" stroke="black" d="M886.55,-1243.04C886.55,-1320.51 886.55,-1621 886.55,-1621 886.55,-1621 994.83,-1621 994.83,-1621"/>
<polygon fill="black" stroke="black" points="994.83,-1624.5 1004.83,-1621 994.83,-1617.5 994.83,-1624.5"/>
</g>
<!-- l0_v_proj_5 -->
<g id="node21" class="node">
<title>l0_v_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-1740.5 1005.23,-1740.5 1005.23,-1699.5 1103.23,-1699.5 1103.23,-1740.5"/>
<text text-anchor="middle" x="1054.23" y="-1728.5" font-family="Arial" font-size="10.00">V Proj 5</text>
<text text-anchor="middle" x="1054.23" y="-1717.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-1706.5" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_v_proj_5 -->
<g id="edge20" class="edge">
<title>l0_layernorm1&#45;&gt;l0_v_proj_5</title>
<path fill="none" stroke="black" d="M879.55,-1243.2C879.55,-1332.51 879.55,-1720 879.55,-1720 879.55,-1720 995.11,-1720 995.11,-1720"/>
<polygon fill="black" stroke="black" points="995.11,-1723.5 1005.11,-1720 995.11,-1716.5 995.11,-1723.5"/>
</g>
<!-- l0_q_proj_6 -->
<g id="node22" class="node">
<title>l0_q_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-1839.5 1005.23,-1839.5 1005.23,-1798.5 1103.23,-1798.5 1103.23,-1839.5"/>
<text text-anchor="middle" x="1054.23" y="-1827.5" font-family="Arial" font-size="10.00">Q Proj 6</text>
<text text-anchor="middle" x="1054.23" y="-1816.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-1805.5" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_q_proj_6 -->
<g id="edge21" class="edge">
<title>l0_layernorm1&#45;&gt;l0_q_proj_6</title>
<path fill="none" stroke="black" d="M871.55,-1243.14C871.55,-1341.86 871.55,-1809.86 871.55,-1809.86 871.55,-1809.86 994.79,-1809.86 994.79,-1809.86"/>
<polygon fill="black" stroke="black" points="994.79,-1813.36 1004.79,-1809.86 994.79,-1806.36 994.79,-1813.36"/>
</g>
<!-- l0_k_proj_6 -->
<g id="node23" class="node">
<title>l0_k_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-1938.5 1005.23,-1938.5 1005.23,-1897.5 1103.23,-1897.5 1103.23,-1938.5"/>
<text text-anchor="middle" x="1054.23" y="-1926.5" font-family="Arial" font-size="10.00">K Proj 6</text>
<text text-anchor="middle" x="1054.23" y="-1915.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-1904.5" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_k_proj_6 -->
<g id="edge22" class="edge">
<title>l0_layernorm1&#45;&gt;l0_k_proj_6</title>
<path fill="none" stroke="black" d="M863.55,-1243.18C863.55,-1352.52 863.55,-1918 863.55,-1918 863.55,-1918 995.13,-1918 995.13,-1918"/>
<polygon fill="black" stroke="black" points="995.13,-1921.5 1005.13,-1918 995.13,-1914.5 995.13,-1921.5"/>
</g>
<!-- l0_v_proj_6 -->
<g id="node24" class="node">
<title>l0_v_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-2037.5 1005.23,-2037.5 1005.23,-1996.5 1103.23,-1996.5 1103.23,-2037.5"/>
<text text-anchor="middle" x="1054.23" y="-2025.5" font-family="Arial" font-size="10.00">V Proj 6</text>
<text text-anchor="middle" x="1054.23" y="-2014.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-2003.5" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_v_proj_6 -->
<g id="edge23" class="edge">
<title>l0_layernorm1&#45;&gt;l0_v_proj_6</title>
<path fill="none" stroke="black" d="M855.55,-1243.03C855.55,-1360.92 855.55,-2017 855.55,-2017 855.55,-2017 995.12,-2017 995.12,-2017"/>
<polygon fill="black" stroke="black" points="995.12,-2020.5 1005.12,-2017 995.12,-2013.5 995.12,-2020.5"/>
</g>
<!-- l0_q_proj_7 -->
<g id="node25" class="node">
<title>l0_q_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-2136.5 1005.23,-2136.5 1005.23,-2095.5 1103.23,-2095.5 1103.23,-2136.5"/>
<text text-anchor="middle" x="1054.23" y="-2124.5" font-family="Arial" font-size="10.00">Q Proj 7</text>
<text text-anchor="middle" x="1054.23" y="-2113.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-2102.5" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_q_proj_7 -->
<g id="edge24" class="edge">
<title>l0_layernorm1&#45;&gt;l0_q_proj_7</title>
<path fill="none" stroke="black" d="M847.55,-1243.2C847.55,-1369.97 847.55,-2116 847.55,-2116 847.55,-2116 994.99,-2116 994.99,-2116"/>
<polygon fill="black" stroke="black" points="994.99,-2119.5 1004.99,-2116 994.99,-2112.5 994.99,-2119.5"/>
</g>
<!-- l0_k_proj_7 -->
<g id="node26" class="node">
<title>l0_k_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-2235.5 1005.23,-2235.5 1005.23,-2194.5 1103.23,-2194.5 1103.23,-2235.5"/>
<text text-anchor="middle" x="1054.23" y="-2223.5" font-family="Arial" font-size="10.00">K Proj 7</text>
<text text-anchor="middle" x="1054.23" y="-2212.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-2201.5" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_k_proj_7 -->
<g id="edge25" class="edge">
<title>l0_layernorm1&#45;&gt;l0_k_proj_7</title>
<path fill="none" stroke="black" d="M839.55,-1243.03C839.55,-1377.21 839.55,-2215 839.55,-2215 839.55,-2215 994.98,-2215 994.98,-2215"/>
<polygon fill="black" stroke="black" points="994.98,-2218.5 1004.98,-2215 994.98,-2211.5 994.98,-2218.5"/>
</g>
<!-- l0_v_proj_7 -->
<g id="node27" class="node">
<title>l0_v_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="1103.23,-2334.5 1005.23,-2334.5 1005.23,-2293.5 1103.23,-2293.5 1103.23,-2334.5"/>
<text text-anchor="middle" x="1054.23" y="-2322.5" font-family="Arial" font-size="10.00">V Proj 7</text>
<text text-anchor="middle" x="1054.23" y="-2311.5" font-family="Arial" font-size="10.00">[128, 100000, 512]</text>
<text text-anchor="middle" x="1054.23" y="-2300.5" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- l0_layernorm1&#45;&gt;l0_v_proj_7 -->
<g id="edge26" class="edge">
<title>l0_layernorm1&#45;&gt;l0_v_proj_7</title>
<path fill="none" stroke="black" d="M831.55,-1243.44C831.55,-1386.55 831.55,-2314 831.55,-2314 831.55,-2314 995.09,-2314 995.09,-2314"/>
<polygon fill="black" stroke="black" points="995.09,-2317.5 1005.09,-2314 995.09,-2310.5 995.09,-2317.5"/>
</g>
<!-- l0_attention -->
<g id="node28" class="node">
<title>l0_attention</title>
<polygon fill="lightblue" stroke="black" points="1295.23,-1245.5 1190.23,-1245.5 1190.23,-1204.5 1295.23,-1204.5 1295.23,-1245.5"/>
<text text-anchor="middle" x="1242.73" y="-1233.5" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1242.73" y="-1222.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="1242.73" y="-1211.5" font-family="Arial" font-size="10.00">All Devices 0&#45;7</text>
</g>
<!-- l0_q_proj_0&#45;&gt;l0_attention -->
<g id="edge27" class="edge">
<title>l0_q_proj_0&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.43,-37C1171.88,-37 1287.55,-37 1287.55,-37 1287.55,-37 1287.55,-1194.38 1287.55,-1194.38"/>
<polygon fill="black" stroke="black" points="1284.05,-1194.38 1287.55,-1204.38 1291.05,-1194.38 1284.05,-1194.38"/>
</g>
<!-- l0_k_proj_0&#45;&gt;l0_attention -->
<g id="edge28" class="edge">
<title>l0_k_proj_0&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.4,-136C1169.7,-136 1279.55,-136 1279.55,-136 1279.55,-136 1279.55,-1194.22 1279.55,-1194.22"/>
<polygon fill="black" stroke="black" points="1276.05,-1194.22 1279.55,-1204.22 1283.05,-1194.22 1276.05,-1194.22"/>
</g>
<!-- l0_v_proj_0&#45;&gt;l0_attention -->
<g id="edge29" class="edge">
<title>l0_v_proj_0&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.27,-235C1167.37,-235 1271.55,-235 1271.55,-235 1271.55,-235 1271.55,-1194.32 1271.55,-1194.32"/>
<polygon fill="black" stroke="black" points="1268.05,-1194.32 1271.55,-1204.32 1275.05,-1194.32 1268.05,-1194.32"/>
</g>
<!-- l0_q_proj_1&#45;&gt;l0_attention -->
<g id="edge30" class="edge">
<title>l0_q_proj_1&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.31,-334C1165.17,-334 1263.55,-334 1263.55,-334 1263.55,-334 1263.55,-1194.29 1263.55,-1194.29"/>
<polygon fill="black" stroke="black" points="1260.05,-1194.29 1263.55,-1204.29 1267.05,-1194.29 1260.05,-1194.29"/>
</g>
<!-- l0_k_proj_1&#45;&gt;l0_attention -->
<g id="edge31" class="edge">
<title>l0_k_proj_1&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.48,-443.5C1163.08,-443.5 1255.55,-443.5 1255.55,-443.5 1255.55,-443.5 1255.55,-1194.5 1255.55,-1194.5"/>
<polygon fill="black" stroke="black" points="1252.05,-1194.5 1255.55,-1204.5 1259.05,-1194.5 1252.05,-1194.5"/>
</g>
<!-- l0_v_proj_1&#45;&gt;l0_attention -->
<g id="edge32" class="edge">
<title>l0_v_proj_1&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.26,-542.5C1160.53,-542.5 1247.55,-542.5 1247.55,-542.5 1247.55,-542.5 1247.55,-1194.2 1247.55,-1194.2"/>
<polygon fill="black" stroke="black" points="1244.05,-1194.2 1247.55,-1204.2 1251.05,-1194.2 1244.05,-1194.2"/>
</g>
<!-- l0_q_proj_2&#45;&gt;l0_attention -->
<g id="edge33" class="edge">
<title>l0_q_proj_2&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.41,-641.5C1158.31,-641.5 1239.55,-641.5 1239.55,-641.5 1239.55,-641.5 1239.55,-1194.23 1239.55,-1194.23"/>
<polygon fill="black" stroke="black" points="1236.05,-1194.23 1239.55,-1204.23 1243.05,-1194.23 1236.05,-1194.23"/>
</g>
<!-- l0_k_proj_2&#45;&gt;l0_attention -->
<g id="edge34" class="edge">
<title>l0_k_proj_2&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.62,-740.5C1156.09,-740.5 1231.55,-740.5 1231.55,-740.5 1231.55,-740.5 1231.55,-1194.49 1231.55,-1194.49"/>
<polygon fill="black" stroke="black" points="1228.05,-1194.49 1231.55,-1204.49 1235.05,-1194.49 1228.05,-1194.49"/>
</g>
<!-- l0_v_proj_2&#45;&gt;l0_attention -->
<g id="edge35" class="edge">
<title>l0_v_proj_2&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.37,-839.5C1153.05,-839.5 1222.55,-839.5 1222.55,-839.5 1222.55,-839.5 1222.55,-1194.27 1222.55,-1194.27"/>
<polygon fill="black" stroke="black" points="1219.05,-1194.27 1222.55,-1204.27 1226.05,-1194.27 1219.05,-1194.27"/>
</g>
<!-- l0_q_proj_3&#45;&gt;l0_attention -->
<g id="edge36" class="edge">
<title>l0_q_proj_3&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.64,-938.5C1150.74,-938.5 1214.55,-938.5 1214.55,-938.5 1214.55,-938.5 1214.55,-1194.4 1214.55,-1194.4"/>
<polygon fill="black" stroke="black" points="1211.05,-1194.4 1214.55,-1204.4 1218.05,-1194.4 1211.05,-1194.4"/>
</g>
<!-- l0_k_proj_3&#45;&gt;l0_attention -->
<g id="edge37" class="edge">
<title>l0_k_proj_3&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.26,-1037.5C1147.79,-1037.5 1206.55,-1037.5 1206.55,-1037.5 1206.55,-1037.5 1206.55,-1194.22 1206.55,-1194.22"/>
<polygon fill="black" stroke="black" points="1203.05,-1194.22 1206.55,-1204.22 1210.05,-1194.22 1203.05,-1194.22"/>
</g>
<!-- l0_v_proj_3&#45;&gt;l0_attention -->
<g id="edge38" class="edge">
<title>l0_v_proj_3&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.49,-1136.5C1145.3,-1136.5 1198.55,-1136.5 1198.55,-1136.5 1198.55,-1136.5 1198.55,-1194.47 1198.55,-1194.47"/>
<polygon fill="black" stroke="black" points="1195.05,-1194.47 1198.55,-1204.47 1202.05,-1194.47 1195.05,-1194.47"/>
</g>
<!-- l0_q_proj_4&#45;&gt;l0_attention -->
<g id="edge39" class="edge">
<title>l0_q_proj_4&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.27,-1225C1103.27,-1225 1179.98,-1225 1179.98,-1225"/>
<polygon fill="black" stroke="black" points="1179.98,-1228.5 1189.98,-1225 1179.98,-1221.5 1179.98,-1228.5"/>
</g>
<!-- l0_k_proj_4&#45;&gt;l0_attention -->
<g id="edge40" class="edge">
<title>l0_k_proj_4&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.49,-1314C1145.3,-1314 1198.55,-1314 1198.55,-1314 1198.55,-1314 1198.55,-1255.64 1198.55,-1255.64"/>
<polygon fill="black" stroke="black" points="1202.05,-1255.64 1198.55,-1245.64 1195.05,-1255.64 1202.05,-1255.64"/>
</g>
<!-- l0_v_proj_4&#45;&gt;l0_attention -->
<g id="edge41" class="edge">
<title>l0_v_proj_4&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.26,-1420.75C1147.79,-1420.75 1206.55,-1420.75 1206.55,-1420.75 1206.55,-1420.75 1206.55,-1255.58 1206.55,-1255.58"/>
<polygon fill="black" stroke="black" points="1210.05,-1255.58 1206.55,-1245.58 1203.05,-1255.58 1210.05,-1255.58"/>
</g>
<!-- l0_q_proj_5&#45;&gt;l0_attention -->
<g id="edge42" class="edge">
<title>l0_q_proj_5&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.64,-1512C1150.74,-1512 1214.55,-1512 1214.55,-1512 1214.55,-1512 1214.55,-1255.64 1214.55,-1255.64"/>
<polygon fill="black" stroke="black" points="1218.05,-1255.64 1214.55,-1245.64 1211.05,-1255.64 1218.05,-1255.64"/>
</g>
<!-- l0_k_proj_5&#45;&gt;l0_attention -->
<g id="edge43" class="edge">
<title>l0_k_proj_5&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.37,-1611C1153.05,-1611 1222.55,-1611 1222.55,-1611 1222.55,-1611 1222.55,-1255.75 1222.55,-1255.75"/>
<polygon fill="black" stroke="black" points="1226.05,-1255.75 1222.55,-1245.75 1219.05,-1255.75 1226.05,-1255.75"/>
</g>
<!-- l0_v_proj_5&#45;&gt;l0_attention -->
<g id="edge44" class="edge">
<title>l0_v_proj_5&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.62,-1710C1156.09,-1710 1231.55,-1710 1231.55,-1710 1231.55,-1710 1231.55,-1255.53 1231.55,-1255.53"/>
<polygon fill="black" stroke="black" points="1235.05,-1255.53 1231.55,-1245.53 1228.05,-1255.53 1235.05,-1255.53"/>
</g>
<!-- l0_q_proj_6&#45;&gt;l0_attention -->
<g id="edge45" class="edge">
<title>l0_q_proj_6&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.41,-1811.25C1158.31,-1811.25 1239.55,-1811.25 1239.55,-1811.25 1239.55,-1811.25 1239.55,-1255.52 1239.55,-1255.52"/>
<polygon fill="black" stroke="black" points="1243.05,-1255.52 1239.55,-1245.52 1236.05,-1255.52 1243.05,-1255.52"/>
</g>
<!-- l0_k_proj_6&#45;&gt;l0_attention -->
<g id="edge46" class="edge">
<title>l0_k_proj_6&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.26,-1908C1160.53,-1908 1247.55,-1908 1247.55,-1908 1247.55,-1908 1247.55,-1255.81 1247.55,-1255.81"/>
<polygon fill="black" stroke="black" points="1251.05,-1255.81 1247.55,-1245.81 1244.05,-1255.81 1251.05,-1255.81"/>
</g>
<!-- l0_v_proj_6&#45;&gt;l0_attention -->
<g id="edge47" class="edge">
<title>l0_v_proj_6&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.48,-2017C1163.08,-2017 1255.55,-2017 1255.55,-2017 1255.55,-2017 1255.55,-1255.78 1255.55,-1255.78"/>
<polygon fill="black" stroke="black" points="1259.05,-1255.78 1255.55,-1245.78 1252.05,-1255.78 1259.05,-1255.78"/>
</g>
<!-- l0_q_proj_7&#45;&gt;l0_attention -->
<g id="edge48" class="edge">
<title>l0_q_proj_7&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.31,-2116C1165.17,-2116 1263.55,-2116 1263.55,-2116 1263.55,-2116 1263.55,-1255.71 1263.55,-1255.71"/>
<polygon fill="black" stroke="black" points="1267.05,-1255.71 1263.55,-1245.71 1260.05,-1255.71 1267.05,-1255.71"/>
</g>
<!-- l0_k_proj_7&#45;&gt;l0_attention -->
<g id="edge49" class="edge">
<title>l0_k_proj_7&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.27,-2215C1167.37,-2215 1271.55,-2215 1271.55,-2215 1271.55,-2215 1271.55,-1255.68 1271.55,-1255.68"/>
<polygon fill="black" stroke="black" points="1275.05,-1255.68 1271.55,-1245.68 1268.05,-1255.68 1275.05,-1255.68"/>
</g>
<!-- l0_v_proj_7&#45;&gt;l0_attention -->
<g id="edge50" class="edge">
<title>l0_v_proj_7&#45;&gt;l0_attention</title>
<path fill="none" stroke="black" d="M1103.4,-2314C1169.7,-2314 1279.55,-2314 1279.55,-2314 1279.55,-2314 1279.55,-1255.78 1279.55,-1255.78"/>
<polygon fill="black" stroke="black" points="1283.05,-1255.78 1279.55,-1245.78 1276.05,-1255.78 1283.05,-1255.78"/>
</g>
<!-- l0_attn_allreduce -->
<g id="node29" class="node">
<title>l0_attn_allreduce</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1455.06" cy="-1410" rx="72.66" ry="28.98"/>
<text text-anchor="middle" x="1455.06" y="-1418.5" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1455.06" y="-1407.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="1455.06" y="-1396.5" font-family="Arial" font-size="10.00">All Devices 0&#45;7</text>
</g>
<!-- l0_attention&#45;&gt;l0_attn_allreduce -->
<g id="edge51" class="edge">
<title>l0_attention&#45;&gt;l0_attn_allreduce</title>
<path fill="none" stroke="black" d="M1287.55,-1245.78C1287.55,-1290.48 1287.55,-1391.75 1287.55,-1391.75 1287.55,-1391.75 1388.35,-1391.75 1388.35,-1391.75"/>
<polygon fill="black" stroke="black" points="1388.35,-1395.25 1398.35,-1391.75 1388.35,-1388.25 1388.35,-1395.25"/>
</g>
<!-- l0_attn_allreduce&#45;&gt;l0_residual1 -->
<g id="edge53" class="edge">
<title>l0_attn_allreduce&#45;&gt;l0_residual1</title>
<path fill="none" stroke="black" d="M1455.55,-1439.2C1455.55,-1522.62 1455.55,-1756 1455.55,-1756 1455.55,-1756 1612.2,-1756 1612.2,-1756"/>
<polygon fill="black" stroke="black" points="1612.2,-1759.5 1622.2,-1756 1612.2,-1752.5 1612.2,-1759.5"/>
</g>
<!-- l0_layernorm2 -->
<g id="node31" class="node">
<title>l0_layernorm2</title>
<polygon fill="white" stroke="black" points="2018.47,-1223 1915.47,-1223 1915.47,-1187 2018.47,-1187 2018.47,-1223"/>
<text text-anchor="middle" x="1966.97" y="-1208" font-family="Arial" font-size="10.00">Pre&#45;MLP LN</text>
<text text-anchor="middle" x="1966.97" y="-1197" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- l0_residual1&#45;&gt;l0_layernorm2 -->
<g id="edge54" class="edge">
<title>l0_residual1&#45;&gt;l0_layernorm2</title>
<path fill="none" stroke="black" d="M1797.46,-1765.75C1856.16,-1765.75 1927.55,-1765.75 1927.55,-1765.75 1927.55,-1765.75 1927.55,-1233.02 1927.55,-1233.02"/>
<polygon fill="black" stroke="black" points="1931.05,-1233.02 1927.55,-1223.02 1924.05,-1233.02 1931.05,-1233.02"/>
</g>
<!-- l0_output -->
<g id="node57" class="node">
<title>l0_output</title>
<polygon fill="white" stroke="black" points="2931.49,-1840 2761.96,-1840 2718.35,-1780 2887.88,-1780 2931.49,-1840"/>
<text text-anchor="middle" x="2824.92" y="-1813" font-family="Arial" font-size="10.00">Layer 0 Output</text>
<text text-anchor="middle" x="2824.92" y="-1802" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- l0_residual1&#45;&gt;l0_output -->
<g id="edge95" class="edge">
<title>l0_residual1&#45;&gt;l0_output</title>
<path fill="none" stroke="black" d="M1722.55,-1824.13C1722.55,-1828.7 1722.55,-1831.75 1722.55,-1831.75 1722.55,-1831.75 2745.96,-1831.75 2745.96,-1831.75"/>
<polygon fill="black" stroke="black" points="2745.96,-1835.25 2755.96,-1831.75 2745.96,-1828.25 2745.96,-1835.25"/>
</g>
<!-- l0_mlp_gate_0 -->
<g id="node32" class="node">
<title>l0_mlp_gate_0</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-433.5 2105.47,-433.5 2105.47,-392.5 2208.47,-392.5 2208.47,-433.5"/>
<text text-anchor="middle" x="2156.97" y="-421.5" font-family="Arial" font-size="10.00">MLP Gate 0</text>
<text text-anchor="middle" x="2156.97" y="-410.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-399.5" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_gate_0 -->
<g id="edge55" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_gate_0</title>
<path fill="none" stroke="black" d="M1927.55,-1186.82C1927.55,-1069.41 1927.55,-423 1927.55,-423 1927.55,-423 2095.19,-423 2095.19,-423"/>
<polygon fill="black" stroke="black" points="2095.19,-426.5 2105.19,-423 2095.19,-419.5 2095.19,-426.5"/>
</g>
<!-- l0_mlp_up_0 -->
<g id="node33" class="node">
<title>l0_mlp_up_0</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-532.5 2105.47,-532.5 2105.47,-491.5 2208.47,-491.5 2208.47,-532.5"/>
<text text-anchor="middle" x="2156.97" y="-520.5" font-family="Arial" font-size="10.00">MLP Up 0</text>
<text text-anchor="middle" x="2156.97" y="-509.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-498.5" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_up_0 -->
<g id="edge56" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_up_0</title>
<path fill="none" stroke="black" d="M1938.55,-1186.73C1938.55,-1078.12 1938.55,-522 1938.55,-522 1938.55,-522 2095.2,-522 2095.2,-522"/>
<polygon fill="black" stroke="black" points="2095.2,-525.5 2105.2,-522 2095.2,-518.5 2095.2,-525.5"/>
</g>
<!-- l0_mlp_gate_1 -->
<g id="node35" class="node">
<title>l0_mlp_gate_1</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-631.5 2105.47,-631.5 2105.47,-590.5 2208.47,-590.5 2208.47,-631.5"/>
<text text-anchor="middle" x="2156.97" y="-619.5" font-family="Arial" font-size="10.00">MLP Gate 1</text>
<text text-anchor="middle" x="2156.97" y="-608.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-597.5" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_gate_1 -->
<g id="edge60" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_gate_1</title>
<path fill="none" stroke="black" d="M1950.55,-1186.88C1950.55,-1088.31 1950.55,-621 1950.55,-621 1950.55,-621 2095.41,-621 2095.41,-621"/>
<polygon fill="black" stroke="black" points="2095.41,-624.5 2105.41,-621 2095.41,-617.5 2095.41,-624.5"/>
</g>
<!-- l0_mlp_up_1 -->
<g id="node36" class="node">
<title>l0_mlp_up_1</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-730.5 2105.47,-730.5 2105.47,-689.5 2208.47,-689.5 2208.47,-730.5"/>
<text text-anchor="middle" x="2156.97" y="-718.5" font-family="Arial" font-size="10.00">MLP Up 1</text>
<text text-anchor="middle" x="2156.97" y="-707.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-696.5" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_up_1 -->
<g id="edge61" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_up_1</title>
<path fill="none" stroke="black" d="M1961.55,-1186.87C1961.55,-1098.83 1961.55,-720 1961.55,-720 1961.55,-720 2095.37,-720 2095.37,-720"/>
<polygon fill="black" stroke="black" points="2095.37,-723.5 2105.37,-720 2095.37,-716.5 2095.37,-723.5"/>
</g>
<!-- l0_mlp_gate_2 -->
<g id="node38" class="node">
<title>l0_mlp_gate_2</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-829.5 2105.47,-829.5 2105.47,-788.5 2208.47,-788.5 2208.47,-829.5"/>
<text text-anchor="middle" x="2156.97" y="-817.5" font-family="Arial" font-size="10.00">MLP Gate 2</text>
<text text-anchor="middle" x="2156.97" y="-806.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-795.5" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_gate_2 -->
<g id="edge65" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_gate_2</title>
<path fill="none" stroke="black" d="M1973.55,-1186.9C1973.55,-1110.59 1973.55,-819 1973.55,-819 1973.55,-819 2095.39,-819 2095.39,-819"/>
<polygon fill="black" stroke="black" points="2095.39,-822.5 2105.39,-819 2095.39,-815.5 2095.39,-822.5"/>
</g>
<!-- l0_mlp_up_2 -->
<g id="node39" class="node">
<title>l0_mlp_up_2</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-928.5 2105.47,-928.5 2105.47,-887.5 2208.47,-887.5 2208.47,-928.5"/>
<text text-anchor="middle" x="2156.97" y="-916.5" font-family="Arial" font-size="10.00">MLP Up 2</text>
<text text-anchor="middle" x="2156.97" y="-905.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-894.5" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_up_2 -->
<g id="edge66" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_up_2</title>
<path fill="none" stroke="black" d="M1984.55,-1186.61C1984.55,-1123.27 1984.55,-918 1984.55,-918 1984.55,-918 2095.24,-918 2095.24,-918"/>
<polygon fill="black" stroke="black" points="2095.24,-921.5 2105.24,-918 2095.24,-914.5 2095.24,-921.5"/>
</g>
<!-- l0_mlp_gate_3 -->
<g id="node41" class="node">
<title>l0_mlp_gate_3</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-1027.5 2105.47,-1027.5 2105.47,-986.5 2208.47,-986.5 2208.47,-1027.5"/>
<text text-anchor="middle" x="2156.97" y="-1015.5" font-family="Arial" font-size="10.00">MLP Gate 3</text>
<text text-anchor="middle" x="2156.97" y="-1004.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-993.5" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_gate_3 -->
<g id="edge70" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_gate_3</title>
<path fill="none" stroke="black" d="M1996.55,-1186.97C1996.55,-1139.92 1996.55,-1017 1996.55,-1017 1996.55,-1017 2095.33,-1017 2095.33,-1017"/>
<polygon fill="black" stroke="black" points="2095.33,-1020.5 2105.33,-1017 2095.33,-1013.5 2095.33,-1020.5"/>
</g>
<!-- l0_mlp_up_3 -->
<g id="node42" class="node">
<title>l0_mlp_up_3</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-1126.5 2105.47,-1126.5 2105.47,-1085.5 2208.47,-1085.5 2208.47,-1126.5"/>
<text text-anchor="middle" x="2156.97" y="-1114.5" font-family="Arial" font-size="10.00">MLP Up 3</text>
<text text-anchor="middle" x="2156.97" y="-1103.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-1092.5" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_up_3 -->
<g id="edge71" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_up_3</title>
<path fill="none" stroke="black" d="M2007.55,-1186.99C2007.55,-1160.98 2007.55,-1116 2007.55,-1116 2007.55,-1116 2095.13,-1116 2095.13,-1116"/>
<polygon fill="black" stroke="black" points="2095.13,-1119.5 2105.13,-1116 2095.13,-1112.5 2095.13,-1119.5"/>
</g>
<!-- l0_mlp_gate_4 -->
<g id="node44" class="node">
<title>l0_mlp_gate_4</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-1225.5 2105.47,-1225.5 2105.47,-1184.5 2208.47,-1184.5 2208.47,-1225.5"/>
<text text-anchor="middle" x="2156.97" y="-1213.5" font-family="Arial" font-size="10.00">MLP Gate 4</text>
<text text-anchor="middle" x="2156.97" y="-1202.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-1191.5" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_gate_4 -->
<g id="edge75" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_gate_4</title>
<path fill="none" stroke="black" d="M2018.63,-1205C2018.63,-1205 2095.31,-1205 2095.31,-1205"/>
<polygon fill="black" stroke="black" points="2095.31,-1208.5 2105.31,-1205 2095.31,-1201.5 2095.31,-1208.5"/>
</g>
<!-- l0_mlp_up_4 -->
<g id="node45" class="node">
<title>l0_mlp_up_4</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-1324.5 2105.47,-1324.5 2105.47,-1283.5 2208.47,-1283.5 2208.47,-1324.5"/>
<text text-anchor="middle" x="2156.97" y="-1312.5" font-family="Arial" font-size="10.00">MLP Up 4</text>
<text text-anchor="middle" x="2156.97" y="-1301.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-1290.5" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_up_4 -->
<g id="edge76" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_up_4</title>
<path fill="none" stroke="black" d="M2007.55,-1223.34C2007.55,-1249.26 2007.55,-1293.5 2007.55,-1293.5 2007.55,-1293.5 2095.13,-1293.5 2095.13,-1293.5"/>
<polygon fill="black" stroke="black" points="2095.13,-1297 2105.13,-1293.5 2095.13,-1290 2095.13,-1297"/>
</g>
<!-- l0_mlp_gate_5 -->
<g id="node47" class="node">
<title>l0_mlp_gate_5</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-1423.5 2105.47,-1423.5 2105.47,-1382.5 2208.47,-1382.5 2208.47,-1423.5"/>
<text text-anchor="middle" x="2156.97" y="-1411.5" font-family="Arial" font-size="10.00">MLP Gate 5</text>
<text text-anchor="middle" x="2156.97" y="-1400.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-1389.5" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_gate_5 -->
<g id="edge80" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_gate_5</title>
<path fill="none" stroke="black" d="M1996.55,-1223.27C1996.55,-1272.29 1996.55,-1403 1996.55,-1403 1996.55,-1403 2095.33,-1403 2095.33,-1403"/>
<polygon fill="black" stroke="black" points="2095.33,-1406.5 2105.33,-1403 2095.33,-1399.5 2095.33,-1406.5"/>
</g>
<!-- l0_mlp_up_5 -->
<g id="node48" class="node">
<title>l0_mlp_up_5</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-1522.5 2105.47,-1522.5 2105.47,-1481.5 2208.47,-1481.5 2208.47,-1522.5"/>
<text text-anchor="middle" x="2156.97" y="-1510.5" font-family="Arial" font-size="10.00">MLP Up 5</text>
<text text-anchor="middle" x="2156.97" y="-1499.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-1488.5" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_up_5 -->
<g id="edge81" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_up_5</title>
<path fill="none" stroke="black" d="M1984.55,-1223.36C1984.55,-1286.59 1984.55,-1491.5 1984.55,-1491.5 1984.55,-1491.5 2095.24,-1491.5 2095.24,-1491.5"/>
<polygon fill="black" stroke="black" points="2095.24,-1495 2105.24,-1491.5 2095.24,-1488 2095.24,-1495"/>
</g>
<!-- l0_mlp_gate_6 -->
<g id="node50" class="node">
<title>l0_mlp_gate_6</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-1621.5 2105.47,-1621.5 2105.47,-1580.5 2208.47,-1580.5 2208.47,-1621.5"/>
<text text-anchor="middle" x="2156.97" y="-1609.5" font-family="Arial" font-size="10.00">MLP Gate 6</text>
<text text-anchor="middle" x="2156.97" y="-1598.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-1587.5" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_gate_6 -->
<g id="edge85" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_gate_6</title>
<path fill="none" stroke="black" d="M1973.55,-1223.08C1973.55,-1299.29 1973.55,-1590.5 1973.55,-1590.5 1973.55,-1590.5 2095.39,-1590.5 2095.39,-1590.5"/>
<polygon fill="black" stroke="black" points="2095.39,-1594 2105.39,-1590.5 2095.39,-1587 2095.39,-1594"/>
</g>
<!-- l0_mlp_up_6 -->
<g id="node51" class="node">
<title>l0_mlp_up_6</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-1720.5 2105.47,-1720.5 2105.47,-1679.5 2208.47,-1679.5 2208.47,-1720.5"/>
<text text-anchor="middle" x="2156.97" y="-1708.5" font-family="Arial" font-size="10.00">MLP Up 6</text>
<text text-anchor="middle" x="2156.97" y="-1697.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-1686.5" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_up_6 -->
<g id="edge86" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_up_6</title>
<path fill="none" stroke="black" d="M1961.55,-1223.11C1961.55,-1311.07 1961.55,-1689.5 1961.55,-1689.5 1961.55,-1689.5 2095.37,-1689.5 2095.37,-1689.5"/>
<polygon fill="black" stroke="black" points="2095.37,-1693 2105.37,-1689.5 2095.37,-1686 2095.37,-1693"/>
</g>
<!-- l0_mlp_gate_7 -->
<g id="node53" class="node">
<title>l0_mlp_gate_7</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-1819.5 2105.47,-1819.5 2105.47,-1778.5 2208.47,-1778.5 2208.47,-1819.5"/>
<text text-anchor="middle" x="2156.97" y="-1807.5" font-family="Arial" font-size="10.00">MLP Gate 7</text>
<text text-anchor="middle" x="2156.97" y="-1796.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-1785.5" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_gate_7 -->
<g id="edge90" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_gate_7</title>
<path fill="none" stroke="black" d="M1950.55,-1223.1C1950.55,-1322.65 1950.55,-1799 1950.55,-1799 1950.55,-1799 2095.41,-1799 2095.41,-1799"/>
<polygon fill="black" stroke="black" points="2095.41,-1802.5 2105.41,-1799 2095.41,-1795.5 2095.41,-1802.5"/>
</g>
<!-- l0_mlp_up_7 -->
<g id="node54" class="node">
<title>l0_mlp_up_7</title>
<polygon fill="lightgreen" stroke="black" points="2208.47,-1918.5 2105.47,-1918.5 2105.47,-1877.5 2208.47,-1877.5 2208.47,-1918.5"/>
<text text-anchor="middle" x="2156.97" y="-1906.5" font-family="Arial" font-size="10.00">MLP Up 7</text>
<text text-anchor="middle" x="2156.97" y="-1895.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2156.97" y="-1884.5" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- l0_layernorm2&#45;&gt;l0_mlp_up_7 -->
<g id="edge91" class="edge">
<title>l0_layernorm2&#45;&gt;l0_mlp_up_7</title>
<path fill="none" stroke="black" d="M1938.55,-1223.26C1938.55,-1331.79 1938.55,-1887.5 1938.55,-1887.5 1938.55,-1887.5 2095.2,-1887.5 2095.2,-1887.5"/>
<polygon fill="black" stroke="black" points="2095.2,-1891 2105.2,-1887.5 2095.2,-1884 2095.2,-1891"/>
</g>
<!-- l0_mlp_down_0 -->
<g id="node34" class="node">
<title>l0_mlp_down_0</title>
<polygon fill="lightgreen" stroke="black" points="2398.47,-532.5 2295.47,-532.5 2295.47,-491.5 2398.47,-491.5 2398.47,-532.5"/>
<text text-anchor="middle" x="2346.97" y="-520.5" font-family="Arial" font-size="10.00">MLP Down 0</text>
<text text-anchor="middle" x="2346.97" y="-509.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2346.97" y="-498.5" font-family="Arial" font-size="10.00">Device 0</text>
</g>
<!-- l0_mlp_gate_0&#45;&gt;l0_mlp_down_0 -->
<g id="edge57" class="edge">
<title>l0_mlp_gate_0&#45;&gt;l0_mlp_down_0</title>
<path fill="none" stroke="black" d="M2208.54,-413C2264.98,-413 2347.55,-413 2347.55,-413 2347.55,-413 2347.55,-481.49 2347.55,-481.49"/>
<polygon fill="black" stroke="black" points="2344.05,-481.49 2347.55,-491.49 2351.05,-481.49 2344.05,-481.49"/>
</g>
<!-- l0_mlp_up_0&#45;&gt;l0_mlp_down_0 -->
<g id="edge58" class="edge">
<title>l0_mlp_up_0&#45;&gt;l0_mlp_down_0</title>
<path fill="none" stroke="black" d="M2208.63,-512C2208.63,-512 2285.31,-512 2285.31,-512"/>
<polygon fill="black" stroke="black" points="2285.31,-515.5 2295.31,-512 2285.31,-508.5 2285.31,-515.5"/>
</g>
<!-- l0_mlp_reduce -->
<g id="node56" class="node">
<title>l0_mlp_reduce</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2558.3" cy="-1231" rx="72.66" ry="28.98"/>
<text text-anchor="middle" x="2558.3" y="-1239.5" font-family="Arial" font-size="10.00">MLP Reduce</text>
<text text-anchor="middle" x="2558.3" y="-1228.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2558.3" y="-1217.5" font-family="Arial" font-size="10.00">All Devices 0&#45;7</text>
</g>
<!-- l0_mlp_down_0&#45;&gt;l0_mlp_reduce -->
<g id="edge59" class="edge">
<title>l0_mlp_down_0&#45;&gt;l0_mlp_reduce</title>
<path fill="none" stroke="black" d="M2398.47,-512C2471.28,-512 2595.55,-512 2595.55,-512 2595.55,-512 2595.55,-1195.83 2595.55,-1195.83"/>
<polygon fill="black" stroke="black" points="2592.05,-1195.83 2595.55,-1205.83 2599.05,-1195.83 2592.05,-1195.83"/>
</g>
<!-- l0_mlp_down_1 -->
<g id="node37" class="node">
<title>l0_mlp_down_1</title>
<polygon fill="lightgreen" stroke="black" points="2398.47,-730.5 2295.47,-730.5 2295.47,-689.5 2398.47,-689.5 2398.47,-730.5"/>
<text text-anchor="middle" x="2346.97" y="-718.5" font-family="Arial" font-size="10.00">MLP Down 1</text>
<text text-anchor="middle" x="2346.97" y="-707.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2346.97" y="-696.5" font-family="Arial" font-size="10.00">Device 1</text>
</g>
<!-- l0_mlp_gate_1&#45;&gt;l0_mlp_down_1 -->
<g id="edge62" class="edge">
<title>l0_mlp_gate_1&#45;&gt;l0_mlp_down_1</title>
<path fill="none" stroke="black" d="M2208.54,-611C2264.98,-611 2347.55,-611 2347.55,-611 2347.55,-611 2347.55,-679.49 2347.55,-679.49"/>
<polygon fill="black" stroke="black" points="2344.05,-679.49 2347.55,-689.49 2351.05,-679.49 2344.05,-679.49"/>
</g>
<!-- l0_mlp_up_1&#45;&gt;l0_mlp_down_1 -->
<g id="edge63" class="edge">
<title>l0_mlp_up_1&#45;&gt;l0_mlp_down_1</title>
<path fill="none" stroke="black" d="M2208.63,-710C2208.63,-710 2285.31,-710 2285.31,-710"/>
<polygon fill="black" stroke="black" points="2285.31,-713.5 2295.31,-710 2285.31,-706.5 2285.31,-713.5"/>
</g>
<!-- l0_mlp_down_1&#45;&gt;l0_mlp_reduce -->
<g id="edge64" class="edge">
<title>l0_mlp_down_1&#45;&gt;l0_mlp_reduce</title>
<path fill="none" stroke="black" d="M2398.73,-710C2461.36,-710 2558.55,-710 2558.55,-710 2558.55,-710 2558.55,-1191.87 2558.55,-1191.87"/>
<polygon fill="black" stroke="black" points="2555.05,-1191.87 2558.55,-1201.87 2562.05,-1191.87 2555.05,-1191.87"/>
</g>
<!-- l0_mlp_down_2 -->
<g id="node40" class="node">
<title>l0_mlp_down_2</title>
<polygon fill="lightgreen" stroke="black" points="2398.47,-928.5 2295.47,-928.5 2295.47,-887.5 2398.47,-887.5 2398.47,-928.5"/>
<text text-anchor="middle" x="2346.97" y="-916.5" font-family="Arial" font-size="10.00">MLP Down 2</text>
<text text-anchor="middle" x="2346.97" y="-905.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2346.97" y="-894.5" font-family="Arial" font-size="10.00">Device 2</text>
</g>
<!-- l0_mlp_gate_2&#45;&gt;l0_mlp_down_2 -->
<g id="edge67" class="edge">
<title>l0_mlp_gate_2&#45;&gt;l0_mlp_down_2</title>
<path fill="none" stroke="black" d="M2208.54,-809C2264.98,-809 2347.55,-809 2347.55,-809 2347.55,-809 2347.55,-877.49 2347.55,-877.49"/>
<polygon fill="black" stroke="black" points="2344.05,-877.49 2347.55,-887.49 2351.05,-877.49 2344.05,-877.49"/>
</g>
<!-- l0_mlp_up_2&#45;&gt;l0_mlp_down_2 -->
<g id="edge68" class="edge">
<title>l0_mlp_up_2&#45;&gt;l0_mlp_down_2</title>
<path fill="none" stroke="black" d="M2208.63,-908C2208.63,-908 2285.31,-908 2285.31,-908"/>
<polygon fill="black" stroke="black" points="2285.31,-911.5 2295.31,-908 2285.31,-904.5 2285.31,-911.5"/>
</g>
<!-- l0_mlp_down_2&#45;&gt;l0_mlp_reduce -->
<g id="edge69" class="edge">
<title>l0_mlp_down_2&#45;&gt;l0_mlp_reduce</title>
<path fill="none" stroke="black" d="M2398.7,-908C2450.49,-908 2522.55,-908 2522.55,-908 2522.55,-908 2522.55,-1195.65 2522.55,-1195.65"/>
<polygon fill="black" stroke="black" points="2519.05,-1195.65 2522.55,-1205.65 2526.05,-1195.65 2519.05,-1195.65"/>
</g>
<!-- l0_mlp_down_3 -->
<g id="node43" class="node">
<title>l0_mlp_down_3</title>
<polygon fill="lightgreen" stroke="black" points="2398.47,-1126.5 2295.47,-1126.5 2295.47,-1085.5 2398.47,-1085.5 2398.47,-1126.5"/>
<text text-anchor="middle" x="2346.97" y="-1114.5" font-family="Arial" font-size="10.00">MLP Down 3</text>
<text text-anchor="middle" x="2346.97" y="-1103.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2346.97" y="-1092.5" font-family="Arial" font-size="10.00">Device 3</text>
</g>
<!-- l0_mlp_gate_3&#45;&gt;l0_mlp_down_3 -->
<g id="edge72" class="edge">
<title>l0_mlp_gate_3&#45;&gt;l0_mlp_down_3</title>
<path fill="none" stroke="black" d="M2208.54,-1007C2264.98,-1007 2347.55,-1007 2347.55,-1007 2347.55,-1007 2347.55,-1075.49 2347.55,-1075.49"/>
<polygon fill="black" stroke="black" points="2344.05,-1075.49 2347.55,-1085.49 2351.05,-1075.49 2344.05,-1075.49"/>
</g>
<!-- l0_mlp_up_3&#45;&gt;l0_mlp_down_3 -->
<g id="edge73" class="edge">
<title>l0_mlp_up_3&#45;&gt;l0_mlp_down_3</title>
<path fill="none" stroke="black" d="M2208.63,-1106C2208.63,-1106 2285.31,-1106 2285.31,-1106"/>
<polygon fill="black" stroke="black" points="2285.31,-1109.5 2295.31,-1106 2285.31,-1102.5 2285.31,-1109.5"/>
</g>
<!-- l0_mlp_down_3&#45;&gt;l0_mlp_reduce -->
<g id="edge74" class="edge">
<title>l0_mlp_down_3&#45;&gt;l0_mlp_reduce</title>
<path fill="none" stroke="black" d="M2347.55,-1126.77C2347.55,-1156.14 2347.55,-1206.25 2347.55,-1206.25 2347.55,-1206.25 2510.13,-1206.25 2510.13,-1206.25"/>
<polygon fill="black" stroke="black" points="2510.13,-1209.75 2520.13,-1206.25 2510.13,-1202.75 2510.13,-1209.75"/>
</g>
<!-- l0_mlp_down_4 -->
<g id="node46" class="node">
<title>l0_mlp_down_4</title>
<polygon fill="lightgreen" stroke="black" points="2398.47,-1251.5 2295.47,-1251.5 2295.47,-1210.5 2398.47,-1210.5 2398.47,-1251.5"/>
<text text-anchor="middle" x="2346.97" y="-1239.5" font-family="Arial" font-size="10.00">MLP Down 4</text>
<text text-anchor="middle" x="2346.97" y="-1228.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2346.97" y="-1217.5" font-family="Arial" font-size="10.00">Device 4</text>
</g>
<!-- l0_mlp_gate_4&#45;&gt;l0_mlp_down_4 -->
<g id="edge77" class="edge">
<title>l0_mlp_gate_4&#45;&gt;l0_mlp_down_4</title>
<path fill="none" stroke="black" d="M2208.63,-1218C2208.63,-1218 2285.31,-1218 2285.31,-1218"/>
<polygon fill="black" stroke="black" points="2285.31,-1221.5 2295.31,-1218 2285.31,-1214.5 2285.31,-1221.5"/>
</g>
<!-- l0_mlp_up_4&#45;&gt;l0_mlp_down_4 -->
<g id="edge78" class="edge">
<title>l0_mlp_up_4&#45;&gt;l0_mlp_down_4</title>
<path fill="none" stroke="black" d="M2157.55,-1283.45C2157.55,-1263.27 2157.55,-1235.5 2157.55,-1235.5 2157.55,-1235.5 2285.21,-1235.5 2285.21,-1235.5"/>
<polygon fill="black" stroke="black" points="2285.21,-1239 2295.21,-1235.5 2285.21,-1232 2285.21,-1239"/>
</g>
<!-- l0_mlp_down_4&#45;&gt;l0_mlp_reduce -->
<g id="edge79" class="edge">
<title>l0_mlp_down_4&#45;&gt;l0_mlp_reduce</title>
<path fill="none" stroke="black" d="M2398.66,-1231C2398.66,-1231 2475.19,-1231 2475.19,-1231"/>
<polygon fill="black" stroke="black" points="2475.19,-1234.5 2485.19,-1231 2475.19,-1227.5 2475.19,-1234.5"/>
</g>
<!-- l0_mlp_down_5 -->
<g id="node49" class="node">
<title>l0_mlp_down_5</title>
<polygon fill="lightgreen" stroke="black" points="2398.47,-1423.5 2295.47,-1423.5 2295.47,-1382.5 2398.47,-1382.5 2398.47,-1423.5"/>
<text text-anchor="middle" x="2346.97" y="-1411.5" font-family="Arial" font-size="10.00">MLP Down 5</text>
<text text-anchor="middle" x="2346.97" y="-1400.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2346.97" y="-1389.5" font-family="Arial" font-size="10.00">Device 5</text>
</g>
<!-- l0_mlp_gate_5&#45;&gt;l0_mlp_down_5 -->
<g id="edge82" class="edge">
<title>l0_mlp_gate_5&#45;&gt;l0_mlp_down_5</title>
<path fill="none" stroke="black" d="M2208.63,-1403C2208.63,-1403 2285.31,-1403 2285.31,-1403"/>
<polygon fill="black" stroke="black" points="2285.31,-1406.5 2295.31,-1403 2285.31,-1399.5 2285.31,-1406.5"/>
</g>
<!-- l0_mlp_up_5&#45;&gt;l0_mlp_down_5 -->
<g id="edge83" class="edge">
<title>l0_mlp_up_5&#45;&gt;l0_mlp_down_5</title>
<path fill="none" stroke="black" d="M2208.54,-1502C2264.98,-1502 2347.55,-1502 2347.55,-1502 2347.55,-1502 2347.55,-1433.51 2347.55,-1433.51"/>
<polygon fill="black" stroke="black" points="2351.05,-1433.51 2347.55,-1423.51 2344.05,-1433.51 2351.05,-1433.51"/>
</g>
<!-- l0_mlp_down_5&#45;&gt;l0_mlp_reduce -->
<g id="edge84" class="edge">
<title>l0_mlp_down_5&#45;&gt;l0_mlp_reduce</title>
<path fill="none" stroke="black" d="M2347.55,-1382.21C2347.55,-1341.62 2347.55,-1255.75 2347.55,-1255.75 2347.55,-1255.75 2510.13,-1255.75 2510.13,-1255.75"/>
<polygon fill="black" stroke="black" points="2510.13,-1259.25 2520.13,-1255.75 2510.13,-1252.25 2510.13,-1259.25"/>
</g>
<!-- l0_mlp_down_6 -->
<g id="node52" class="node">
<title>l0_mlp_down_6</title>
<polygon fill="lightgreen" stroke="black" points="2398.47,-1621.5 2295.47,-1621.5 2295.47,-1580.5 2398.47,-1580.5 2398.47,-1621.5"/>
<text text-anchor="middle" x="2346.97" y="-1609.5" font-family="Arial" font-size="10.00">MLP Down 6</text>
<text text-anchor="middle" x="2346.97" y="-1598.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2346.97" y="-1587.5" font-family="Arial" font-size="10.00">Device 6</text>
</g>
<!-- l0_mlp_gate_6&#45;&gt;l0_mlp_down_6 -->
<g id="edge87" class="edge">
<title>l0_mlp_gate_6&#45;&gt;l0_mlp_down_6</title>
<path fill="none" stroke="black" d="M2208.63,-1601C2208.63,-1601 2285.31,-1601 2285.31,-1601"/>
<polygon fill="black" stroke="black" points="2285.31,-1604.5 2295.31,-1601 2285.31,-1597.5 2285.31,-1604.5"/>
</g>
<!-- l0_mlp_up_6&#45;&gt;l0_mlp_down_6 -->
<g id="edge88" class="edge">
<title>l0_mlp_up_6&#45;&gt;l0_mlp_down_6</title>
<path fill="none" stroke="black" d="M2208.54,-1700C2264.98,-1700 2347.55,-1700 2347.55,-1700 2347.55,-1700 2347.55,-1631.51 2347.55,-1631.51"/>
<polygon fill="black" stroke="black" points="2351.05,-1631.51 2347.55,-1621.51 2344.05,-1631.51 2351.05,-1631.51"/>
</g>
<!-- l0_mlp_down_6&#45;&gt;l0_mlp_reduce -->
<g id="edge89" class="edge">
<title>l0_mlp_down_6&#45;&gt;l0_mlp_reduce</title>
<path fill="none" stroke="black" d="M2398.7,-1601C2450.49,-1601 2522.55,-1601 2522.55,-1601 2522.55,-1601 2522.55,-1266.43 2522.55,-1266.43"/>
<polygon fill="black" stroke="black" points="2526.05,-1266.43 2522.55,-1256.43 2519.05,-1266.43 2526.05,-1266.43"/>
</g>
<!-- l0_mlp_down_7 -->
<g id="node55" class="node">
<title>l0_mlp_down_7</title>
<polygon fill="lightgreen" stroke="black" points="2398.47,-1819.5 2295.47,-1819.5 2295.47,-1778.5 2398.47,-1778.5 2398.47,-1819.5"/>
<text text-anchor="middle" x="2346.97" y="-1807.5" font-family="Arial" font-size="10.00">MLP Down 7</text>
<text text-anchor="middle" x="2346.97" y="-1796.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="2346.97" y="-1785.5" font-family="Arial" font-size="10.00">Device 7</text>
</g>
<!-- l0_mlp_gate_7&#45;&gt;l0_mlp_down_7 -->
<g id="edge92" class="edge">
<title>l0_mlp_gate_7&#45;&gt;l0_mlp_down_7</title>
<path fill="none" stroke="black" d="M2208.63,-1799C2208.63,-1799 2285.31,-1799 2285.31,-1799"/>
<polygon fill="black" stroke="black" points="2285.31,-1802.5 2295.31,-1799 2285.31,-1795.5 2285.31,-1802.5"/>
</g>
<!-- l0_mlp_up_7&#45;&gt;l0_mlp_down_7 -->
<g id="edge93" class="edge">
<title>l0_mlp_up_7&#45;&gt;l0_mlp_down_7</title>
<path fill="none" stroke="black" d="M2208.54,-1898C2264.98,-1898 2347.55,-1898 2347.55,-1898 2347.55,-1898 2347.55,-1829.51 2347.55,-1829.51"/>
<polygon fill="black" stroke="black" points="2351.05,-1829.51 2347.55,-1819.51 2344.05,-1829.51 2351.05,-1829.51"/>
</g>
<!-- l0_mlp_down_7&#45;&gt;l0_mlp_reduce -->
<g id="edge94" class="edge">
<title>l0_mlp_down_7&#45;&gt;l0_mlp_reduce</title>
<path fill="none" stroke="black" d="M2398.73,-1806.33C2461.36,-1806.33 2558.55,-1806.33 2558.55,-1806.33 2558.55,-1806.33 2558.55,-1270.32 2558.55,-1270.32"/>
<polygon fill="black" stroke="black" points="2562.05,-1270.32 2558.55,-1260.32 2555.05,-1270.32 2562.05,-1270.32"/>
</g>
<!-- l0_mlp_reduce&#45;&gt;l0_output -->
<g id="edge96" class="edge">
<title>l0_mlp_reduce&#45;&gt;l0_output</title>
<path fill="none" stroke="black" d="M2595.55,-1256.25C2595.55,-1365.64 2595.55,-1793.17 2595.55,-1793.17 2595.55,-1793.17 2717.64,-1793.17 2717.64,-1793.17"/>
<polygon fill="black" stroke="black" points="2717.64,-1796.67 2727.64,-1793.17 2717.64,-1789.67 2717.64,-1796.67"/>
</g>
<!-- l1_input -->
<g id="node58" class="node">
<title>l1_input</title>
<ellipse fill="white" stroke="black" cx="3091.53" cy="-1810" rx="72.66" ry="21.43"/>
<text text-anchor="middle" x="3091.53" y="-1813" font-family="Arial" font-size="10.00">Layer 1 Input</text>
<text text-anchor="middle" x="3091.53" y="-1802" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- l0_output&#45;&gt;l1_input -->
<g id="edge97" class="edge">
<title>l0_output&#45;&gt;l1_input</title>
<path fill="none" stroke="black" d="M2910.01,-1810C2910.01,-1810 3008.45,-1810 3008.45,-1810"/>
<polygon fill="black" stroke="black" points="3008.45,-1813.5 3018.45,-1810 3008.45,-1806.5 3008.45,-1813.5"/>
</g>
<!-- l1_layernorm1 -->
<g id="node59" class="node">
<title>l1_layernorm1</title>
<polygon fill="white" stroke="black" points="3354.37,-1789 3251.37,-1789 3251.37,-1753 3354.37,-1753 3354.37,-1789"/>
<text text-anchor="middle" x="3302.87" y="-1774" font-family="Arial" font-size="10.00">Pre&#45;Attention LN</text>
<text text-anchor="middle" x="3302.87" y="-1763" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- l1_input&#45;&gt;l1_layernorm1 -->
<g id="edge98" class="edge">
<title>l1_input&#45;&gt;l1_layernorm1</title>
<path fill="none" stroke="black" d="M3164.5,-1810.36C3225.82,-1810.36 3303.55,-1810.36 3303.55,-1810.36 3303.55,-1810.36 3303.55,-1799.3 3303.55,-1799.3"/>
<polygon fill="black" stroke="black" points="3307.05,-1799.3 3303.55,-1789.3 3300.05,-1799.3 3307.05,-1799.3"/>
</g>
<!-- l1_residual1 -->
<g id="node61" class="node">
<title>l1_residual1</title>
<polygon fill="white" stroke="black" points="3846.72,-1870 3677.19,-1870 3633.58,-1788 3803.11,-1788 3846.72,-1870"/>
<text text-anchor="middle" x="3740.15" y="-1837.5" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="3740.15" y="-1826.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="3740.15" y="-1815.5" font-family="Arial" font-size="10.00">All Devices 0&#45;7</text>
</g>
<!-- l1_input&#45;&gt;l1_residual1 -->
<g id="edge100" class="edge">
<title>l1_input&#45;&gt;l1_residual1</title>
<path fill="none" stroke="black" d="M3154.32,-1820.78C3154.32,-1820.78 3640.88,-1820.78 3640.88,-1820.78"/>
<polygon fill="black" stroke="black" points="3640.88,-1824.29 3650.88,-1820.78 3640.88,-1817.29 3640.88,-1824.29"/>
</g>
<!-- l1_attention -->
<g id="node60" class="node">
<title>l1_attention</title>
<polygon fill="lightblue" stroke="black" points="3546.37,-1789.5 3441.37,-1789.5 3441.37,-1748.5 3546.37,-1748.5 3546.37,-1789.5"/>
<text text-anchor="middle" x="3493.87" y="-1777.5" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3493.87" y="-1766.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="3493.87" y="-1755.5" font-family="Arial" font-size="10.00">All Devices 0&#45;7</text>
</g>
<!-- l1_layernorm1&#45;&gt;l1_attention -->
<g id="edge99" class="edge">
<title>l1_layernorm1&#45;&gt;l1_attention</title>
<path fill="none" stroke="black" d="M3354.55,-1771C3354.55,-1771 3431.14,-1771 3431.14,-1771"/>
<polygon fill="black" stroke="black" points="3431.14,-1774.5 3441.14,-1771 3431.14,-1767.5 3431.14,-1774.5"/>
</g>
<!-- l1_attention&#45;&gt;l1_residual1 -->
<g id="edge101" class="edge">
<title>l1_attention&#45;&gt;l1_residual1</title>
<path fill="none" stroke="black" d="M3494.55,-1789.8C3494.55,-1795.4 3494.55,-1799.93 3494.55,-1799.93 3494.55,-1799.93 3629.9,-1799.93 3629.9,-1799.93"/>
<polygon fill="black" stroke="black" points="3629.9,-1803.43 3639.9,-1799.93 3629.9,-1796.43 3629.9,-1803.43"/>
</g>
<!-- l1_output -->
<g id="node62" class="node">
<title>l1_output</title>
<polygon fill="white" stroke="black" points="4147.29,-1859 3977.76,-1859 3934.15,-1799 4103.68,-1799 4147.29,-1859"/>
<text text-anchor="middle" x="4040.72" y="-1832" font-family="Arial" font-size="10.00">Layer 1 Output</text>
<text text-anchor="middle" x="4040.72" y="-1821" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- l1_residual1&#45;&gt;l1_output -->
<g id="edge102" class="edge">
<title>l1_residual1&#45;&gt;l1_output</title>
<path fill="none" stroke="black" d="M3825.08,-1829C3825.08,-1829 3945.75,-1829 3945.75,-1829"/>
<polygon fill="black" stroke="black" points="3945.75,-1832.5 3955.75,-1829 3945.75,-1825.5 3945.75,-1832.5"/>
</g>
<!-- l2_input -->
<g id="node63" class="node">
<title>l2_input</title>
<ellipse fill="white" stroke="black" cx="4405.34" cy="-1829" rx="72.66" ry="21.43"/>
<text text-anchor="middle" x="4405.34" y="-1832" font-family="Arial" font-size="10.00">Layer 2 Input</text>
<text text-anchor="middle" x="4405.34" y="-1821" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- l1_output&#45;&gt;l2_input -->
<g id="edge103" class="edge">
<title>l1_output&#45;&gt;l2_input</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4125.75,-1829C4125.75,-1829 4322.5,-1829 4322.5,-1829"/>
<polygon fill="black" stroke="black" points="4322.5,-1832.5 4332.5,-1829 4322.5,-1825.5 4322.5,-1832.5"/>
<text text-anchor="middle" x="4240.01" y="-1832.8" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
</g>
<!-- l2_attention -->
<g id="node64" class="node">
<title>l2_attention</title>
<polygon fill="lightblue" stroke="black" points="4670.17,-1849.5 4565.17,-1849.5 4565.17,-1808.5 4670.17,-1808.5 4670.17,-1849.5"/>
<text text-anchor="middle" x="4617.67" y="-1837.5" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4617.67" y="-1826.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="4617.67" y="-1815.5" font-family="Arial" font-size="10.00">All Devices 8&#45;15</text>
</g>
<!-- l2_input&#45;&gt;l2_attention -->
<g id="edge104" class="edge">
<title>l2_input&#45;&gt;l2_attention</title>
<path fill="none" stroke="black" d="M4478.41,-1829C4478.41,-1829 4554.91,-1829 4554.91,-1829"/>
<polygon fill="black" stroke="black" points="4554.91,-1832.5 4564.91,-1829 4554.91,-1825.5 4554.91,-1832.5"/>
</g>
<!-- l2_output -->
<g id="node65" class="node">
<title>l2_output</title>
<polygon fill="white" stroke="black" points="4970.53,-1859 4801,-1859 4757.39,-1799 4926.92,-1799 4970.53,-1859"/>
<text text-anchor="middle" x="4863.96" y="-1832" font-family="Arial" font-size="10.00">Layer 2 Output</text>
<text text-anchor="middle" x="4863.96" y="-1821" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- l2_attention&#45;&gt;l2_output -->
<g id="edge105" class="edge">
<title>l2_attention&#45;&gt;l2_output</title>
<path fill="none" stroke="black" d="M4670.2,-1829C4670.2,-1829 4769.05,-1829 4769.05,-1829"/>
<polygon fill="black" stroke="black" points="4769.05,-1832.5 4779.05,-1829 4769.05,-1825.5 4769.05,-1832.5"/>
</g>
<!-- l3_input -->
<g id="node66" class="node">
<title>l3_input</title>
<ellipse fill="white" stroke="black" cx="5130.58" cy="-1829" rx="72.66" ry="21.43"/>
<text text-anchor="middle" x="5130.58" y="-1832" font-family="Arial" font-size="10.00">Layer 3 Input</text>
<text text-anchor="middle" x="5130.58" y="-1821" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- l2_output&#45;&gt;l3_input -->
<g id="edge106" class="edge">
<title>l2_output&#45;&gt;l3_input</title>
<path fill="none" stroke="black" d="M4949.05,-1829C4949.05,-1829 5047.49,-1829 5047.49,-1829"/>
<polygon fill="black" stroke="black" points="5047.49,-1832.5 5057.49,-1829 5047.49,-1825.5 5047.49,-1832.5"/>
</g>
<!-- l3_attention -->
<g id="node67" class="node">
<title>l3_attention</title>
<polygon fill="lightblue" stroke="black" points="5395.41,-1849.5 5290.41,-1849.5 5290.41,-1808.5 5395.41,-1808.5 5395.41,-1849.5"/>
<text text-anchor="middle" x="5342.91" y="-1837.5" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5342.91" y="-1826.5" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
<text text-anchor="middle" x="5342.91" y="-1815.5" font-family="Arial" font-size="10.00">All Devices 8&#45;15</text>
</g>
<!-- l3_input&#45;&gt;l3_attention -->
<g id="edge107" class="edge">
<title>l3_input&#45;&gt;l3_attention</title>
<path fill="none" stroke="black" d="M5203.65,-1829C5203.65,-1829 5280.15,-1829 5280.15,-1829"/>
<polygon fill="black" stroke="black" points="5280.15,-1832.5 5290.15,-1829 5280.15,-1825.5 5280.15,-1832.5"/>
</g>
<!-- l3_output -->
<g id="node68" class="node">
<title>l3_output</title>
<polygon fill="white" stroke="black" points="5695.76,-1859 5526.23,-1859 5482.62,-1799 5652.15,-1799 5695.76,-1859"/>
<text text-anchor="middle" x="5589.19" y="-1832" font-family="Arial" font-size="10.00">Layer 3 Output</text>
<text text-anchor="middle" x="5589.19" y="-1821" font-family="Arial" font-size="10.00">[128, 100000, 4096]</text>
</g>
<!-- l3_attention&#45;&gt;l3_output -->
<g id="edge108" class="edge">
<title>l3_attention&#45;&gt;l3_output</title>
<path fill="none" stroke="black" d="M5395.44,-1829C5395.44,-1829 5494.28,-1829 5494.28,-1829"/>
<polygon fill="black" stroke="black" points="5494.28,-1832.5 5504.28,-1829 5494.28,-1825.5 5494.28,-1832.5"/>
</g>
<!-- output -->
<g id="node69" class="node">
<title>output</title>
<polygon fill="lightyellow" stroke="black" points="6278.33,-1859 5884.51,-1859 5783.19,-1799 6177.02,-1799 6278.33,-1859"/>
<text text-anchor="middle" x="6030.76" y="-1832" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="6030.76" y="-1821" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=100000, d_model=4096]</text>
</g>
<!-- l3_output&#45;&gt;output -->
<g id="edge109" class="edge">
<title>l3_output&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5674.07,-1829C5674.07,-1829 5823.6,-1829 5823.6,-1829"/>
<polygon fill="black" stroke="black" points="5823.6,-1832.5 5833.6,-1829 5823.6,-1825.5 5823.6,-1832.5"/>
</g>
</g>
</svg>
