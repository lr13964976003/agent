<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1241pt" height="1030pt"
 viewBox="0.00 0.00 1240.98 1029.65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1025.65)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1025.65 1236.98,-1025.65 1236.98,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="256.68" cy="-968.65" rx="256.86" ry="26.74"/>
<text text-anchor="middle" x="256.68" y="-972.45" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="256.68" y="-957.45" font-family="Times,serif" font-size="14.00">[batch_size=8, seq_len=1024, token_dim=7168]</text>
</g>
<!-- dense_0_ln -->
<g id="node2" class="node">
<title>dense_0_ln</title>
<polygon fill="none" stroke="black" points="315.18,-868.67 198.18,-868.67 198.18,-815.67 315.18,-815.67 315.18,-868.67"/>
<text text-anchor="middle" x="256.68" y="-853.47" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="256.68" y="-838.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="256.68" y="-823.47" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- input&#45;&gt;dense_0_ln -->
<g id="edge19" class="edge">
<title>input&#45;&gt;dense_0_ln</title>
<path fill="none" stroke="black" d="M256.68,-941.51C256.68,-941.51 256.68,-878.82 256.68,-878.82"/>
<polygon fill="black" stroke="black" points="260.18,-878.82 256.68,-868.82 253.18,-878.82 260.18,-878.82"/>
</g>
<!-- dense_0_mha -->
<g id="node3" class="node">
<title>dense_0_mha</title>
<polygon fill="none" stroke="black" points="326.68,-768.69 186.68,-768.69 186.68,-715.69 326.68,-715.69 326.68,-768.69"/>
<text text-anchor="middle" x="256.68" y="-753.49" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="256.68" y="-738.49" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="256.68" y="-723.49" font-family="Times,serif" font-size="14.00">[8,1024,128,128]</text>
</g>
<!-- dense_0_ln&#45;&gt;dense_0_mha -->
<g id="edge1" class="edge">
<title>dense_0_ln&#45;&gt;dense_0_mha</title>
<path fill="none" stroke="black" d="M256.68,-815.64C256.68,-815.64 256.68,-778.85 256.68,-778.85"/>
<polygon fill="black" stroke="black" points="260.18,-778.85 256.68,-768.85 253.18,-778.85 260.18,-778.85"/>
</g>
<!-- dense_0_ffn -->
<g id="node4" class="node">
<title>dense_0_ffn</title>
<polygon fill="none" stroke="black" points="315.18,-653.19 198.18,-653.19 198.18,-600.19 315.18,-600.19 315.18,-653.19"/>
<text text-anchor="middle" x="256.68" y="-637.99" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="256.68" y="-622.99" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="256.68" y="-607.99" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- dense_0_mha&#45;&gt;dense_0_ffn -->
<g id="edge2" class="edge">
<title>dense_0_mha&#45;&gt;dense_0_ffn</title>
<path fill="none" stroke="black" d="M256.68,-715.41C256.68,-715.41 256.68,-663.34 256.68,-663.34"/>
<polygon fill="black" stroke="black" points="260.18,-663.34 256.68,-653.34 253.18,-663.34 260.18,-663.34"/>
</g>
<!-- dense_0_allreduce -->
<g id="node5" class="node">
<title>dense_0_allreduce</title>
<polygon fill="none" stroke="black" points="377.78,-537.69 185.14,-537.69 135.58,-431.69 328.22,-431.69 377.78,-537.69"/>
<text text-anchor="middle" x="256.68" y="-495.99" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="256.68" y="-480.99" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="256.68" y="-465.99" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- dense_0_ffn&#45;&gt;dense_0_allreduce -->
<g id="edge3" class="edge">
<title>dense_0_ffn&#45;&gt;dense_0_allreduce</title>
<path fill="none" stroke="black" d="M256.68,-599.98C256.68,-599.98 256.68,-547.76 256.68,-547.76"/>
<polygon fill="black" stroke="black" points="260.18,-547.76 256.68,-537.76 253.18,-547.76 260.18,-547.76"/>
</g>
<!-- dense_1_ln -->
<g id="node6" class="node">
<title>dense_1_ln</title>
<polygon fill="none" stroke="black" points="648.18,-995.15 531.18,-995.15 531.18,-942.15 648.18,-942.15 648.18,-995.15"/>
<text text-anchor="middle" x="589.68" y="-979.95" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="589.68" y="-964.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="589.68" y="-949.95" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- dense_1_mha -->
<g id="node7" class="node">
<title>dense_1_mha</title>
<polygon fill="none" stroke="black" points="659.68,-868.67 519.68,-868.67 519.68,-815.67 659.68,-815.67 659.68,-868.67"/>
<text text-anchor="middle" x="589.68" y="-853.47" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="589.68" y="-838.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="589.68" y="-823.47" font-family="Times,serif" font-size="14.00">[8,1024,128,128]</text>
</g>
<!-- dense_1_ln&#45;&gt;dense_1_mha -->
<g id="edge4" class="edge">
<title>dense_1_ln&#45;&gt;dense_1_mha</title>
<path fill="none" stroke="black" d="M589.68,-942.13C589.68,-942.13 589.68,-879.08 589.68,-879.08"/>
<polygon fill="black" stroke="black" points="593.18,-879.08 589.68,-869.08 586.18,-879.08 593.18,-879.08"/>
</g>
<!-- dense_1_ffn -->
<g id="node8" class="node">
<title>dense_1_ffn</title>
<polygon fill="none" stroke="black" points="648.18,-768.69 531.18,-768.69 531.18,-715.69 648.18,-715.69 648.18,-768.69"/>
<text text-anchor="middle" x="589.68" y="-753.49" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="589.68" y="-738.49" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="589.68" y="-723.49" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- dense_1_mha&#45;&gt;dense_1_ffn -->
<g id="edge5" class="edge">
<title>dense_1_mha&#45;&gt;dense_1_ffn</title>
<path fill="none" stroke="black" d="M589.68,-815.64C589.68,-815.64 589.68,-778.85 589.68,-778.85"/>
<polygon fill="black" stroke="black" points="593.18,-778.85 589.68,-768.85 586.18,-778.85 593.18,-778.85"/>
</g>
<!-- dense_1_allreduce -->
<g id="node9" class="node">
<title>dense_1_allreduce</title>
<polygon fill="none" stroke="black" points="710.78,-679.69 518.14,-679.69 468.58,-573.69 661.22,-573.69 710.78,-679.69"/>
<text text-anchor="middle" x="589.68" y="-637.99" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="589.68" y="-622.99" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="589.68" y="-607.99" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- dense_1_ffn&#45;&gt;dense_1_allreduce -->
<g id="edge6" class="edge">
<title>dense_1_ffn&#45;&gt;dense_1_allreduce</title>
<path fill="none" stroke="black" d="M589.68,-715.41C589.68,-715.41 589.68,-689.71 589.68,-689.71"/>
<polygon fill="black" stroke="black" points="593.18,-689.71 589.68,-679.71 586.18,-689.71 593.18,-689.71"/>
</g>
<!-- dense_2_ln -->
<g id="node10" class="node">
<title>dense_2_ln</title>
<polygon fill="none" stroke="black" points="909.18,-995.15 792.18,-995.15 792.18,-942.15 909.18,-942.15 909.18,-995.15"/>
<text text-anchor="middle" x="850.68" y="-979.95" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="850.68" y="-964.95" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="850.68" y="-949.95" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- dense_2_mha -->
<g id="node11" class="node">
<title>dense_2_mha</title>
<polygon fill="none" stroke="black" points="920.68,-868.67 780.68,-868.67 780.68,-815.67 920.68,-815.67 920.68,-868.67"/>
<text text-anchor="middle" x="850.68" y="-853.47" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="850.68" y="-838.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="850.68" y="-823.47" font-family="Times,serif" font-size="14.00">[8,1024,128,128]</text>
</g>
<!-- dense_2_ln&#45;&gt;dense_2_mha -->
<g id="edge7" class="edge">
<title>dense_2_ln&#45;&gt;dense_2_mha</title>
<path fill="none" stroke="black" d="M850.68,-942.13C850.68,-942.13 850.68,-879.08 850.68,-879.08"/>
<polygon fill="black" stroke="black" points="854.18,-879.08 850.68,-869.08 847.18,-879.08 854.18,-879.08"/>
</g>
<!-- dense_2_ffn -->
<g id="node12" class="node">
<title>dense_2_ffn</title>
<polygon fill="none" stroke="black" points="909.18,-768.69 792.18,-768.69 792.18,-715.69 909.18,-715.69 909.18,-768.69"/>
<text text-anchor="middle" x="850.68" y="-753.49" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="850.68" y="-738.49" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="850.68" y="-723.49" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- dense_2_mha&#45;&gt;dense_2_ffn -->
<g id="edge8" class="edge">
<title>dense_2_mha&#45;&gt;dense_2_ffn</title>
<path fill="none" stroke="black" d="M850.68,-815.64C850.68,-815.64 850.68,-778.85 850.68,-778.85"/>
<polygon fill="black" stroke="black" points="854.18,-778.85 850.68,-768.85 847.18,-778.85 854.18,-778.85"/>
</g>
<!-- dense_2_allreduce -->
<g id="node13" class="node">
<title>dense_2_allreduce</title>
<polygon fill="none" stroke="black" points="971.78,-679.69 779.14,-679.69 729.58,-573.69 922.22,-573.69 971.78,-679.69"/>
<text text-anchor="middle" x="850.68" y="-637.99" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="850.68" y="-622.99" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="850.68" y="-607.99" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- dense_2_ffn&#45;&gt;dense_2_allreduce -->
<g id="edge9" class="edge">
<title>dense_2_ffn&#45;&gt;dense_2_allreduce</title>
<path fill="none" stroke="black" d="M850.68,-715.41C850.68,-715.41 850.68,-689.71 850.68,-689.71"/>
<polygon fill="black" stroke="black" points="854.18,-689.71 850.68,-679.71 847.18,-689.71 854.18,-689.71"/>
</g>
<!-- moe_30_gate -->
<g id="node14" class="node">
<title>moe_30_gate</title>
<polygon fill="none" stroke="black" points="971.78,-537.69 779.14,-537.69 729.58,-431.69 922.22,-431.69 971.78,-537.69"/>
<text text-anchor="middle" x="850.68" y="-495.99" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="850.68" y="-480.99" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="850.68" y="-465.99" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- dense_2_allreduce&#45;&gt;moe_30_gate -->
<g id="edge20" class="edge">
<title>dense_2_allreduce&#45;&gt;moe_30_gate</title>
<path fill="none" stroke="black" d="M850.68,-573.41C850.68,-573.41 850.68,-547.8 850.68,-547.8"/>
<polygon fill="black" stroke="black" points="854.18,-547.8 850.68,-537.8 847.18,-547.8 854.18,-547.8"/>
</g>
<!-- moe_30_comm -->
<g id="node16" class="node">
<title>moe_30_comm</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="850.68" cy="-358.22" rx="84.29" ry="37.45"/>
<text text-anchor="middle" x="850.68" y="-369.52" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="850.68" y="-354.52" font-family="Times,serif" font-size="14.00">Cross&#45;GPU</text>
<text text-anchor="middle" x="850.68" y="-339.52" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- moe_30_gate&#45;&gt;moe_30_comm -->
<g id="edge10" class="edge">
<title>moe_30_gate&#45;&gt;moe_30_comm</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M850.68,-431.42C850.68,-431.42 850.68,-406.07 850.68,-406.07"/>
<polygon fill="red" stroke="red" points="854.18,-406.07 850.68,-396.07 847.18,-406.07 854.18,-406.07"/>
</g>
<!-- moe_30_experts -->
<g id="node15" class="node">
<title>moe_30_experts</title>
<polygon fill="none" stroke="black" points="928.18,-284.74 773.18,-284.74 773.18,-231.74 928.18,-231.74 928.18,-284.74"/>
<text text-anchor="middle" x="850.68" y="-269.54" font-family="Times,serif" font-size="14.00">Experts (64)</text>
<text text-anchor="middle" x="850.68" y="-254.54" font-family="Times,serif" font-size="14.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="850.68" y="-239.54" font-family="Times,serif" font-size="14.00">[1,1024,7168] each</text>
</g>
<!-- moe_30_agg -->
<g id="node17" class="node">
<title>moe_30_agg</title>
<polygon fill="none" stroke="black" points="971.78,-195.74 779.14,-195.74 729.58,-89.74 922.22,-89.74 971.78,-195.74"/>
<text text-anchor="middle" x="850.68" y="-154.04" font-family="Times,serif" font-size="14.00">Aggregate</text>
<text text-anchor="middle" x="850.68" y="-139.04" font-family="Times,serif" font-size="14.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="850.68" y="-124.04" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- moe_30_experts&#45;&gt;moe_30_agg -->
<g id="edge12" class="edge">
<title>moe_30_experts&#45;&gt;moe_30_agg</title>
<path fill="none" stroke="black" d="M850.68,-231.45C850.68,-231.45 850.68,-205.76 850.68,-205.76"/>
<polygon fill="black" stroke="black" points="854.18,-205.76 850.68,-195.76 847.18,-205.76 854.18,-205.76"/>
</g>
<!-- moe_30_comm&#45;&gt;moe_30_experts -->
<g id="edge11" class="edge">
<title>moe_30_comm&#45;&gt;moe_30_experts</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M850.68,-320.7C850.68,-320.7 850.68,-295.04 850.68,-295.04"/>
<polygon fill="red" stroke="red" points="854.18,-295.04 850.68,-285.04 847.18,-295.04 854.18,-295.04"/>
</g>
<!-- moe_31_gate -->
<g id="node18" class="node">
<title>moe_31_gate</title>
<polygon fill="none" stroke="black" points="1232.78,-1021.65 1040.14,-1021.65 990.58,-915.65 1183.22,-915.65 1232.78,-1021.65"/>
<text text-anchor="middle" x="1111.68" y="-979.95" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1111.68" y="-964.95" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="1111.68" y="-949.95" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- moe_31_comm -->
<g id="node20" class="node">
<title>moe_31_comm</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1111.68" cy="-842.17" rx="84.29" ry="37.45"/>
<text text-anchor="middle" x="1111.68" y="-853.47" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="1111.68" y="-838.47" font-family="Times,serif" font-size="14.00">Cross&#45;GPU</text>
<text text-anchor="middle" x="1111.68" y="-823.47" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- moe_31_gate&#45;&gt;moe_31_comm -->
<g id="edge13" class="edge">
<title>moe_31_gate&#45;&gt;moe_31_comm</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1111.68,-915.38C1111.68,-915.38 1111.68,-890.02 1111.68,-890.02"/>
<polygon fill="red" stroke="red" points="1115.18,-890.02 1111.68,-880.02 1108.18,-890.02 1115.18,-890.02"/>
</g>
<!-- moe_31_experts -->
<g id="node19" class="node">
<title>moe_31_experts</title>
<polygon fill="none" stroke="black" points="1189.18,-768.69 1034.18,-768.69 1034.18,-715.69 1189.18,-715.69 1189.18,-768.69"/>
<text text-anchor="middle" x="1111.68" y="-753.49" font-family="Times,serif" font-size="14.00">Experts (64)</text>
<text text-anchor="middle" x="1111.68" y="-738.49" font-family="Times,serif" font-size="14.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="1111.68" y="-723.49" font-family="Times,serif" font-size="14.00">[1,1024,7168] each</text>
</g>
<!-- moe_31_agg -->
<g id="node21" class="node">
<title>moe_31_agg</title>
<polygon fill="none" stroke="black" points="1232.78,-679.69 1040.14,-679.69 990.58,-573.69 1183.22,-573.69 1232.78,-679.69"/>
<text text-anchor="middle" x="1111.68" y="-637.99" font-family="Times,serif" font-size="14.00">Aggregate</text>
<text text-anchor="middle" x="1111.68" y="-622.99" font-family="Times,serif" font-size="14.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="1111.68" y="-607.99" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- moe_31_experts&#45;&gt;moe_31_agg -->
<g id="edge15" class="edge">
<title>moe_31_experts&#45;&gt;moe_31_agg</title>
<path fill="none" stroke="black" d="M1111.68,-715.41C1111.68,-715.41 1111.68,-689.71 1111.68,-689.71"/>
<polygon fill="black" stroke="black" points="1115.18,-689.71 1111.68,-679.71 1108.18,-689.71 1115.18,-689.71"/>
</g>
<!-- moe_31_comm&#45;&gt;moe_31_experts -->
<g id="edge14" class="edge">
<title>moe_31_comm&#45;&gt;moe_31_experts</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1111.68,-804.66C1111.68,-804.66 1111.68,-778.99 1111.68,-778.99"/>
<polygon fill="red" stroke="red" points="1115.18,-778.99 1111.68,-768.99 1108.18,-778.99 1115.18,-778.99"/>
</g>
<!-- moe_60_gate -->
<g id="node22" class="node">
<title>moe_60_gate</title>
<polygon fill="none" stroke="black" points="1232.78,-537.69 1040.14,-537.69 990.58,-431.69 1183.22,-431.69 1232.78,-537.69"/>
<text text-anchor="middle" x="1111.68" y="-495.99" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1111.68" y="-480.99" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="1111.68" y="-465.99" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- moe_31_agg&#45;&gt;moe_60_gate -->
<g id="edge21" class="edge">
<title>moe_31_agg&#45;&gt;moe_60_gate</title>
<path fill="none" stroke="black" d="M1111.68,-573.41C1111.68,-573.41 1111.68,-547.8 1111.68,-547.8"/>
<polygon fill="black" stroke="black" points="1115.18,-547.8 1111.68,-537.8 1108.18,-547.8 1115.18,-547.8"/>
</g>
<!-- moe_60_comm -->
<g id="node24" class="node">
<title>moe_60_comm</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1111.68" cy="-358.22" rx="84.29" ry="37.45"/>
<text text-anchor="middle" x="1111.68" y="-369.52" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="1111.68" y="-354.52" font-family="Times,serif" font-size="14.00">Cross&#45;GPU</text>
<text text-anchor="middle" x="1111.68" y="-339.52" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- moe_60_gate&#45;&gt;moe_60_comm -->
<g id="edge16" class="edge">
<title>moe_60_gate&#45;&gt;moe_60_comm</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1111.68,-431.42C1111.68,-431.42 1111.68,-406.07 1111.68,-406.07"/>
<polygon fill="red" stroke="red" points="1115.18,-406.07 1111.68,-396.07 1108.18,-406.07 1115.18,-406.07"/>
</g>
<!-- moe_60_experts -->
<g id="node23" class="node">
<title>moe_60_experts</title>
<polygon fill="none" stroke="black" points="1189.18,-284.74 1034.18,-284.74 1034.18,-231.74 1189.18,-231.74 1189.18,-284.74"/>
<text text-anchor="middle" x="1111.68" y="-269.54" font-family="Times,serif" font-size="14.00">Experts (64)</text>
<text text-anchor="middle" x="1111.68" y="-254.54" font-family="Times,serif" font-size="14.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="1111.68" y="-239.54" font-family="Times,serif" font-size="14.00">[1,1024,7168] each</text>
</g>
<!-- moe_60_agg -->
<g id="node25" class="node">
<title>moe_60_agg</title>
<polygon fill="none" stroke="black" points="1232.78,-195.74 1040.14,-195.74 990.58,-89.74 1183.22,-89.74 1232.78,-195.74"/>
<text text-anchor="middle" x="1111.68" y="-154.04" font-family="Times,serif" font-size="14.00">Aggregate</text>
<text text-anchor="middle" x="1111.68" y="-139.04" font-family="Times,serif" font-size="14.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="1111.68" y="-124.04" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- moe_60_experts&#45;&gt;moe_60_agg -->
<g id="edge18" class="edge">
<title>moe_60_experts&#45;&gt;moe_60_agg</title>
<path fill="none" stroke="black" d="M1111.68,-231.45C1111.68,-231.45 1111.68,-205.76 1111.68,-205.76"/>
<polygon fill="black" stroke="black" points="1115.18,-205.76 1111.68,-195.76 1108.18,-205.76 1115.18,-205.76"/>
</g>
<!-- moe_60_comm&#45;&gt;moe_60_experts -->
<g id="edge17" class="edge">
<title>moe_60_comm&#45;&gt;moe_60_experts</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1111.68,-320.7C1111.68,-320.7 1111.68,-295.04 1111.68,-295.04"/>
<polygon fill="red" stroke="red" points="1115.18,-295.04 1111.68,-285.04 1108.18,-295.04 1115.18,-295.04"/>
</g>
<!-- output -->
<g id="node26" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="1111.68" cy="-26.87" rx="82.96" ry="26.74"/>
<text text-anchor="middle" x="1111.68" y="-30.67" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1111.68" y="-15.67" font-family="Times,serif" font-size="14.00">[8,1024,7168]</text>
</g>
<!-- moe_60_agg&#45;&gt;output -->
<g id="edge22" class="edge">
<title>moe_60_agg&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1111.68,-89.55C1111.68,-89.55 1111.68,-63.84 1111.68,-63.84"/>
<polygon fill="black" stroke="black" points="1115.18,-63.84 1111.68,-53.84 1108.18,-63.84 1115.18,-63.84"/>
</g>
</g>
</svg>
