// Detailed MoE Deployment - 3 Representative Layers
digraph {
	compound=true rankdir=TB splines=ortho
	subgraph cluster_layer0 {
		label="Layer 0 (Dense)" style=rounded
		layer0_input [label="Input
GPU: 0-3
[8,1024,7168]" fillcolor=lightgreen shape=ellipse]
		layer0_ln [label="LayerNorm
GPU: 0
[8,1024,7168]" fillcolor=lightyellow shape=rectangle]
		layer0_q_proj_gpu0 [label="Q Proj
GPU: 0
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_k_proj_gpu0 [label="K Proj
GPU: 0
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_v_proj_gpu0 [label="V Proj
GPU: 0
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_attn_gpu0 [label="Attention
GPU: 0
[8,1024,7168]" fillcolor=coral shape=rectangle]
		layer0_ffn1_gpu0 [label="FFN1
GPU: 0
[8,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer0_ffn2_gpu0 [label="FFN2
GPU: 0
[8,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer0_all_reduce_gpu0 [label="AllReduce
GPU: 0
[8,1024,7168]" fillcolor=orange shape=parallelogram]
		layer0_input -> layer0_ln
		layer0_ln -> layer0_q_proj_gpu0
		layer0_ln -> layer0_k_proj_gpu0
		layer0_ln -> layer0_v_proj_gpu0
		layer0_q_proj_gpu0 -> layer0_attn_gpu0
		layer0_k_proj_gpu0 -> layer0_attn_gpu0
		layer0_v_proj_gpu0 -> layer0_attn_gpu0
		layer0_attn_gpu0 -> layer0_ffn1_gpu0
		layer0_ffn1_gpu0 -> layer0_ffn2_gpu0
		layer0_ffn2_gpu0 -> layer0_all_reduce_gpu0
		layer0_q_proj_gpu1 [label="Q Proj
GPU: 1
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_k_proj_gpu1 [label="K Proj
GPU: 1
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_v_proj_gpu1 [label="V Proj
GPU: 1
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_attn_gpu1 [label="Attention
GPU: 1
[8,1024,7168]" fillcolor=coral shape=rectangle]
		layer0_ffn1_gpu1 [label="FFN1
GPU: 1
[8,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer0_ffn2_gpu1 [label="FFN2
GPU: 1
[8,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer0_all_reduce_gpu1 [label="AllReduce
GPU: 1
[8,1024,7168]" fillcolor=orange shape=parallelogram]
		layer0_input -> layer0_ln
		layer0_ln -> layer0_q_proj_gpu1
		layer0_ln -> layer0_k_proj_gpu1
		layer0_ln -> layer0_v_proj_gpu1
		layer0_q_proj_gpu1 -> layer0_attn_gpu1
		layer0_k_proj_gpu1 -> layer0_attn_gpu1
		layer0_v_proj_gpu1 -> layer0_attn_gpu1
		layer0_attn_gpu1 -> layer0_ffn1_gpu1
		layer0_ffn1_gpu1 -> layer0_ffn2_gpu1
		layer0_ffn2_gpu1 -> layer0_all_reduce_gpu1
		layer0_q_proj_gpu2 [label="Q Proj
GPU: 2
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_k_proj_gpu2 [label="K Proj
GPU: 2
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_v_proj_gpu2 [label="V Proj
GPU: 2
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_attn_gpu2 [label="Attention
GPU: 2
[8,1024,7168]" fillcolor=coral shape=rectangle]
		layer0_ffn1_gpu2 [label="FFN1
GPU: 2
[8,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer0_ffn2_gpu2 [label="FFN2
GPU: 2
[8,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer0_all_reduce_gpu2 [label="AllReduce
GPU: 2
[8,1024,7168]" fillcolor=orange shape=parallelogram]
		layer0_input -> layer0_ln
		layer0_ln -> layer0_q_proj_gpu2
		layer0_ln -> layer0_k_proj_gpu2
		layer0_ln -> layer0_v_proj_gpu2
		layer0_q_proj_gpu2 -> layer0_attn_gpu2
		layer0_k_proj_gpu2 -> layer0_attn_gpu2
		layer0_v_proj_gpu2 -> layer0_attn_gpu2
		layer0_attn_gpu2 -> layer0_ffn1_gpu2
		layer0_ffn1_gpu2 -> layer0_ffn2_gpu2
		layer0_ffn2_gpu2 -> layer0_all_reduce_gpu2
		layer0_q_proj_gpu3 [label="Q Proj
GPU: 3
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_k_proj_gpu3 [label="K Proj
GPU: 3
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_v_proj_gpu3 [label="V Proj
GPU: 3
[8,1024,128,128]" fillcolor=coral shape=rectangle]
		layer0_attn_gpu3 [label="Attention
GPU: 3
[8,1024,7168]" fillcolor=coral shape=rectangle]
		layer0_ffn1_gpu3 [label="FFN1
GPU: 3
[8,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer0_ffn2_gpu3 [label="FFN2
GPU: 3
[8,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer0_all_reduce_gpu3 [label="AllReduce
GPU: 3
[8,1024,7168]" fillcolor=orange shape=parallelogram]
		layer0_input -> layer0_ln
		layer0_ln -> layer0_q_proj_gpu3
		layer0_ln -> layer0_k_proj_gpu3
		layer0_ln -> layer0_v_proj_gpu3
		layer0_q_proj_gpu3 -> layer0_attn_gpu3
		layer0_k_proj_gpu3 -> layer0_attn_gpu3
		layer0_v_proj_gpu3 -> layer0_attn_gpu3
		layer0_attn_gpu3 -> layer0_ffn1_gpu3
		layer0_ffn1_gpu3 -> layer0_ffn2_gpu3
		layer0_ffn2_gpu3 -> layer0_all_reduce_gpu3
	}
	subgraph cluster_layer30 {
		label="Layer 30 (MoE)" style=rounded
		layer30_input [label="Input
GPU: 0-63
[8,1024,7168]" fillcolor=lightgreen shape=ellipse]
		layer30_gate [label="Gate
GPU: 0
[8,1024,7168]" fillcolor=yellow shape=parallelogram]
		layer30_comm_0 [label="Token Transfer
From GPU: 0
To GPU: 0
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_0 [label="Expert 0
GPU: 0
Node: 0
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_0_ffn1 [label="Expert FFN1
GPU: 0
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_0_ffn2 [label="Expert FFN2
GPU: 0
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_0 [label="Aggregate
GPU: 0
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_0 [style=dashed]
		layer30_comm_0 -> layer30_expert_0_ffn1 [style=dashed]
		layer30_expert_0_ffn1 -> layer30_expert_0_ffn2
		layer30_expert_0_ffn2 -> layer30_agg_0
		layer30_comm_1 [label="Token Transfer
From GPU: 0
To GPU: 1
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_1 [label="Expert 1
GPU: 1
Node: 0
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_1_ffn1 [label="Expert FFN1
GPU: 1
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_1_ffn2 [label="Expert FFN2
GPU: 1
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_1 [label="Aggregate
GPU: 1
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_1 [style=dashed]
		layer30_comm_1 -> layer30_expert_1_ffn1 [style=dashed]
		layer30_expert_1_ffn1 -> layer30_expert_1_ffn2
		layer30_expert_1_ffn2 -> layer30_agg_1
		layer30_comm_2 [label="Token Transfer
From GPU: 0
To GPU: 2
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_2 [label="Expert 2
GPU: 2
Node: 0
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_2_ffn1 [label="Expert FFN1
GPU: 2
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_2_ffn2 [label="Expert FFN2
GPU: 2
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_2 [label="Aggregate
GPU: 2
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_2 [style=dashed]
		layer30_comm_2 -> layer30_expert_2_ffn1 [style=dashed]
		layer30_expert_2_ffn1 -> layer30_expert_2_ffn2
		layer30_expert_2_ffn2 -> layer30_agg_2
		layer30_comm_3 [label="Token Transfer
From GPU: 0
To GPU: 3
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_3 [label="Expert 3
GPU: 3
Node: 0
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_3_ffn1 [label="Expert FFN1
GPU: 3
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_3_ffn2 [label="Expert FFN2
GPU: 3
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_3 [label="Aggregate
GPU: 3
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_3 [style=dashed]
		layer30_comm_3 -> layer30_expert_3_ffn1 [style=dashed]
		layer30_expert_3_ffn1 -> layer30_expert_3_ffn2
		layer30_expert_3_ffn2 -> layer30_agg_3
		layer30_comm_4 [label="Token Transfer
From GPU: 0
To GPU: 4
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_4 [label="Expert 4
GPU: 4
Node: 0
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_4_ffn1 [label="Expert FFN1
GPU: 4
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_4_ffn2 [label="Expert FFN2
GPU: 4
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_4 [label="Aggregate
GPU: 4
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_4 [style=dashed]
		layer30_comm_4 -> layer30_expert_4_ffn1 [style=dashed]
		layer30_expert_4_ffn1 -> layer30_expert_4_ffn2
		layer30_expert_4_ffn2 -> layer30_agg_4
		layer30_comm_5 [label="Token Transfer
From GPU: 0
To GPU: 5
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_5 [label="Expert 5
GPU: 5
Node: 0
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_5_ffn1 [label="Expert FFN1
GPU: 5
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_5_ffn2 [label="Expert FFN2
GPU: 5
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_5 [label="Aggregate
GPU: 5
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_5 [style=dashed]
		layer30_comm_5 -> layer30_expert_5_ffn1 [style=dashed]
		layer30_expert_5_ffn1 -> layer30_expert_5_ffn2
		layer30_expert_5_ffn2 -> layer30_agg_5
		layer30_comm_6 [label="Token Transfer
From GPU: 0
To GPU: 6
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_6 [label="Expert 6
GPU: 6
Node: 0
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_6_ffn1 [label="Expert FFN1
GPU: 6
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_6_ffn2 [label="Expert FFN2
GPU: 6
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_6 [label="Aggregate
GPU: 6
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_6 [style=dashed]
		layer30_comm_6 -> layer30_expert_6_ffn1 [style=dashed]
		layer30_expert_6_ffn1 -> layer30_expert_6_ffn2
		layer30_expert_6_ffn2 -> layer30_agg_6
		layer30_comm_7 [label="Token Transfer
From GPU: 0
To GPU: 7
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_7 [label="Expert 7
GPU: 7
Node: 0
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_7_ffn1 [label="Expert FFN1
GPU: 7
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_7_ffn2 [label="Expert FFN2
GPU: 7
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_7 [label="Aggregate
GPU: 7
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_7 [style=dashed]
		layer30_comm_7 -> layer30_expert_7_ffn1 [style=dashed]
		layer30_expert_7_ffn1 -> layer30_expert_7_ffn2
		layer30_expert_7_ffn2 -> layer30_agg_7
		layer30_comm_8 [label="Token Transfer
From GPU: 0
To GPU: 8
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_8 [label="Expert 8
GPU: 8
Node: 1
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_8_ffn1 [label="Expert FFN1
GPU: 8
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_8_ffn2 [label="Expert FFN2
GPU: 8
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_8 [label="Aggregate
GPU: 8
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_8 [style=dashed]
		layer30_comm_8 -> layer30_expert_8_ffn1 [style=dashed]
		layer30_expert_8_ffn1 -> layer30_expert_8_ffn2
		layer30_expert_8_ffn2 -> layer30_agg_8
		layer30_comm_9 [label="Token Transfer
From GPU: 0
To GPU: 9
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_9 [label="Expert 9
GPU: 9
Node: 1
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_9_ffn1 [label="Expert FFN1
GPU: 9
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_9_ffn2 [label="Expert FFN2
GPU: 9
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_9 [label="Aggregate
GPU: 9
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_9 [style=dashed]
		layer30_comm_9 -> layer30_expert_9_ffn1 [style=dashed]
		layer30_expert_9_ffn1 -> layer30_expert_9_ffn2
		layer30_expert_9_ffn2 -> layer30_agg_9
		layer30_comm_10 [label="Token Transfer
From GPU: 0
To GPU: 10
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_10 [label="Expert 10
GPU: 10
Node: 1
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_10_ffn1 [label="Expert FFN1
GPU: 10
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_10_ffn2 [label="Expert FFN2
GPU: 10
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_10 [label="Aggregate
GPU: 10
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_10 [style=dashed]
		layer30_comm_10 -> layer30_expert_10_ffn1 [style=dashed]
		layer30_expert_10_ffn1 -> layer30_expert_10_ffn2
		layer30_expert_10_ffn2 -> layer30_agg_10
		layer30_comm_11 [label="Token Transfer
From GPU: 0
To GPU: 11
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_11 [label="Expert 11
GPU: 11
Node: 1
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_11_ffn1 [label="Expert FFN1
GPU: 11
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_11_ffn2 [label="Expert FFN2
GPU: 11
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_11 [label="Aggregate
GPU: 11
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_11 [style=dashed]
		layer30_comm_11 -> layer30_expert_11_ffn1 [style=dashed]
		layer30_expert_11_ffn1 -> layer30_expert_11_ffn2
		layer30_expert_11_ffn2 -> layer30_agg_11
		layer30_comm_12 [label="Token Transfer
From GPU: 0
To GPU: 12
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_12 [label="Expert 12
GPU: 12
Node: 1
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_12_ffn1 [label="Expert FFN1
GPU: 12
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_12_ffn2 [label="Expert FFN2
GPU: 12
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_12 [label="Aggregate
GPU: 12
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_12 [style=dashed]
		layer30_comm_12 -> layer30_expert_12_ffn1 [style=dashed]
		layer30_expert_12_ffn1 -> layer30_expert_12_ffn2
		layer30_expert_12_ffn2 -> layer30_agg_12
		layer30_comm_13 [label="Token Transfer
From GPU: 0
To GPU: 13
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_13 [label="Expert 13
GPU: 13
Node: 1
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_13_ffn1 [label="Expert FFN1
GPU: 13
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_13_ffn2 [label="Expert FFN2
GPU: 13
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_13 [label="Aggregate
GPU: 13
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_13 [style=dashed]
		layer30_comm_13 -> layer30_expert_13_ffn1 [style=dashed]
		layer30_expert_13_ffn1 -> layer30_expert_13_ffn2
		layer30_expert_13_ffn2 -> layer30_agg_13
		layer30_comm_14 [label="Token Transfer
From GPU: 0
To GPU: 14
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_14 [label="Expert 14
GPU: 14
Node: 1
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_14_ffn1 [label="Expert FFN1
GPU: 14
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_14_ffn2 [label="Expert FFN2
GPU: 14
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_14 [label="Aggregate
GPU: 14
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_14 [style=dashed]
		layer30_comm_14 -> layer30_expert_14_ffn1 [style=dashed]
		layer30_expert_14_ffn1 -> layer30_expert_14_ffn2
		layer30_expert_14_ffn2 -> layer30_agg_14
		layer30_comm_15 [label="Token Transfer
From GPU: 0
To GPU: 15
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_15 [label="Expert 15
GPU: 15
Node: 1
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_15_ffn1 [label="Expert FFN1
GPU: 15
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_15_ffn2 [label="Expert FFN2
GPU: 15
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_15 [label="Aggregate
GPU: 15
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_15 [style=dashed]
		layer30_comm_15 -> layer30_expert_15_ffn1 [style=dashed]
		layer30_expert_15_ffn1 -> layer30_expert_15_ffn2
		layer30_expert_15_ffn2 -> layer30_agg_15
		layer30_comm_16 [label="Token Transfer
From GPU: 0
To GPU: 16
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_16 [label="Expert 16
GPU: 16
Node: 2
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_16_ffn1 [label="Expert FFN1
GPU: 16
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_16_ffn2 [label="Expert FFN2
GPU: 16
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_16 [label="Aggregate
GPU: 16
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_16 [style=dashed]
		layer30_comm_16 -> layer30_expert_16_ffn1 [style=dashed]
		layer30_expert_16_ffn1 -> layer30_expert_16_ffn2
		layer30_expert_16_ffn2 -> layer30_agg_16
		layer30_comm_17 [label="Token Transfer
From GPU: 0
To GPU: 17
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_17 [label="Expert 17
GPU: 17
Node: 2
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_17_ffn1 [label="Expert FFN1
GPU: 17
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_17_ffn2 [label="Expert FFN2
GPU: 17
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_17 [label="Aggregate
GPU: 17
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_17 [style=dashed]
		layer30_comm_17 -> layer30_expert_17_ffn1 [style=dashed]
		layer30_expert_17_ffn1 -> layer30_expert_17_ffn2
		layer30_expert_17_ffn2 -> layer30_agg_17
		layer30_comm_18 [label="Token Transfer
From GPU: 0
To GPU: 18
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_18 [label="Expert 18
GPU: 18
Node: 2
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_18_ffn1 [label="Expert FFN1
GPU: 18
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_18_ffn2 [label="Expert FFN2
GPU: 18
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_18 [label="Aggregate
GPU: 18
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_18 [style=dashed]
		layer30_comm_18 -> layer30_expert_18_ffn1 [style=dashed]
		layer30_expert_18_ffn1 -> layer30_expert_18_ffn2
		layer30_expert_18_ffn2 -> layer30_agg_18
		layer30_comm_19 [label="Token Transfer
From GPU: 0
To GPU: 19
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_19 [label="Expert 19
GPU: 19
Node: 2
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_19_ffn1 [label="Expert FFN1
GPU: 19
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_19_ffn2 [label="Expert FFN2
GPU: 19
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_19 [label="Aggregate
GPU: 19
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_19 [style=dashed]
		layer30_comm_19 -> layer30_expert_19_ffn1 [style=dashed]
		layer30_expert_19_ffn1 -> layer30_expert_19_ffn2
		layer30_expert_19_ffn2 -> layer30_agg_19
		layer30_comm_20 [label="Token Transfer
From GPU: 0
To GPU: 20
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_20 [label="Expert 20
GPU: 20
Node: 2
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_20_ffn1 [label="Expert FFN1
GPU: 20
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_20_ffn2 [label="Expert FFN2
GPU: 20
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_20 [label="Aggregate
GPU: 20
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_20 [style=dashed]
		layer30_comm_20 -> layer30_expert_20_ffn1 [style=dashed]
		layer30_expert_20_ffn1 -> layer30_expert_20_ffn2
		layer30_expert_20_ffn2 -> layer30_agg_20
		layer30_comm_21 [label="Token Transfer
From GPU: 0
To GPU: 21
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_21 [label="Expert 21
GPU: 21
Node: 2
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_21_ffn1 [label="Expert FFN1
GPU: 21
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_21_ffn2 [label="Expert FFN2
GPU: 21
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_21 [label="Aggregate
GPU: 21
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_21 [style=dashed]
		layer30_comm_21 -> layer30_expert_21_ffn1 [style=dashed]
		layer30_expert_21_ffn1 -> layer30_expert_21_ffn2
		layer30_expert_21_ffn2 -> layer30_agg_21
		layer30_comm_22 [label="Token Transfer
From GPU: 0
To GPU: 22
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_22 [label="Expert 22
GPU: 22
Node: 2
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_22_ffn1 [label="Expert FFN1
GPU: 22
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_22_ffn2 [label="Expert FFN2
GPU: 22
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_22 [label="Aggregate
GPU: 22
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_22 [style=dashed]
		layer30_comm_22 -> layer30_expert_22_ffn1 [style=dashed]
		layer30_expert_22_ffn1 -> layer30_expert_22_ffn2
		layer30_expert_22_ffn2 -> layer30_agg_22
		layer30_comm_23 [label="Token Transfer
From GPU: 0
To GPU: 23
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_23 [label="Expert 23
GPU: 23
Node: 2
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_23_ffn1 [label="Expert FFN1
GPU: 23
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_23_ffn2 [label="Expert FFN2
GPU: 23
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_23 [label="Aggregate
GPU: 23
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_23 [style=dashed]
		layer30_comm_23 -> layer30_expert_23_ffn1 [style=dashed]
		layer30_expert_23_ffn1 -> layer30_expert_23_ffn2
		layer30_expert_23_ffn2 -> layer30_agg_23
		layer30_comm_24 [label="Token Transfer
From GPU: 0
To GPU: 24
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_24 [label="Expert 24
GPU: 24
Node: 3
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_24_ffn1 [label="Expert FFN1
GPU: 24
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_24_ffn2 [label="Expert FFN2
GPU: 24
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_24 [label="Aggregate
GPU: 24
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_24 [style=dashed]
		layer30_comm_24 -> layer30_expert_24_ffn1 [style=dashed]
		layer30_expert_24_ffn1 -> layer30_expert_24_ffn2
		layer30_expert_24_ffn2 -> layer30_agg_24
		layer30_comm_25 [label="Token Transfer
From GPU: 0
To GPU: 25
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_25 [label="Expert 25
GPU: 25
Node: 3
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_25_ffn1 [label="Expert FFN1
GPU: 25
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_25_ffn2 [label="Expert FFN2
GPU: 25
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_25 [label="Aggregate
GPU: 25
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_25 [style=dashed]
		layer30_comm_25 -> layer30_expert_25_ffn1 [style=dashed]
		layer30_expert_25_ffn1 -> layer30_expert_25_ffn2
		layer30_expert_25_ffn2 -> layer30_agg_25
		layer30_comm_26 [label="Token Transfer
From GPU: 0
To GPU: 26
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_26 [label="Expert 26
GPU: 26
Node: 3
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_26_ffn1 [label="Expert FFN1
GPU: 26
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_26_ffn2 [label="Expert FFN2
GPU: 26
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_26 [label="Aggregate
GPU: 26
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_26 [style=dashed]
		layer30_comm_26 -> layer30_expert_26_ffn1 [style=dashed]
		layer30_expert_26_ffn1 -> layer30_expert_26_ffn2
		layer30_expert_26_ffn2 -> layer30_agg_26
		layer30_comm_27 [label="Token Transfer
From GPU: 0
To GPU: 27
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_27 [label="Expert 27
GPU: 27
Node: 3
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_27_ffn1 [label="Expert FFN1
GPU: 27
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_27_ffn2 [label="Expert FFN2
GPU: 27
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_27 [label="Aggregate
GPU: 27
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_27 [style=dashed]
		layer30_comm_27 -> layer30_expert_27_ffn1 [style=dashed]
		layer30_expert_27_ffn1 -> layer30_expert_27_ffn2
		layer30_expert_27_ffn2 -> layer30_agg_27
		layer30_comm_28 [label="Token Transfer
From GPU: 0
To GPU: 28
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_28 [label="Expert 28
GPU: 28
Node: 3
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_28_ffn1 [label="Expert FFN1
GPU: 28
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_28_ffn2 [label="Expert FFN2
GPU: 28
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_28 [label="Aggregate
GPU: 28
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_28 [style=dashed]
		layer30_comm_28 -> layer30_expert_28_ffn1 [style=dashed]
		layer30_expert_28_ffn1 -> layer30_expert_28_ffn2
		layer30_expert_28_ffn2 -> layer30_agg_28
		layer30_comm_29 [label="Token Transfer
From GPU: 0
To GPU: 29
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_29 [label="Expert 29
GPU: 29
Node: 3
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_29_ffn1 [label="Expert FFN1
GPU: 29
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_29_ffn2 [label="Expert FFN2
GPU: 29
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_29 [label="Aggregate
GPU: 29
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_29 [style=dashed]
		layer30_comm_29 -> layer30_expert_29_ffn1 [style=dashed]
		layer30_expert_29_ffn1 -> layer30_expert_29_ffn2
		layer30_expert_29_ffn2 -> layer30_agg_29
		layer30_comm_30 [label="Token Transfer
From GPU: 0
To GPU: 30
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_30 [label="Expert 30
GPU: 30
Node: 3
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_30_ffn1 [label="Expert FFN1
GPU: 30
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_30_ffn2 [label="Expert FFN2
GPU: 30
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_30 [label="Aggregate
GPU: 30
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_30 [style=dashed]
		layer30_comm_30 -> layer30_expert_30_ffn1 [style=dashed]
		layer30_expert_30_ffn1 -> layer30_expert_30_ffn2
		layer30_expert_30_ffn2 -> layer30_agg_30
		layer30_comm_31 [label="Token Transfer
From GPU: 0
To GPU: 31
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_31 [label="Expert 31
GPU: 31
Node: 3
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_31_ffn1 [label="Expert FFN1
GPU: 31
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_31_ffn2 [label="Expert FFN2
GPU: 31
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_31 [label="Aggregate
GPU: 31
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_31 [style=dashed]
		layer30_comm_31 -> layer30_expert_31_ffn1 [style=dashed]
		layer30_expert_31_ffn1 -> layer30_expert_31_ffn2
		layer30_expert_31_ffn2 -> layer30_agg_31
		layer30_comm_32 [label="Token Transfer
From GPU: 0
To GPU: 32
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_32 [label="Expert 32
GPU: 32
Node: 4
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_32_ffn1 [label="Expert FFN1
GPU: 32
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_32_ffn2 [label="Expert FFN2
GPU: 32
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_32 [label="Aggregate
GPU: 32
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_32 [style=dashed]
		layer30_comm_32 -> layer30_expert_32_ffn1 [style=dashed]
		layer30_expert_32_ffn1 -> layer30_expert_32_ffn2
		layer30_expert_32_ffn2 -> layer30_agg_32
		layer30_comm_33 [label="Token Transfer
From GPU: 0
To GPU: 33
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_33 [label="Expert 33
GPU: 33
Node: 4
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_33_ffn1 [label="Expert FFN1
GPU: 33
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_33_ffn2 [label="Expert FFN2
GPU: 33
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_33 [label="Aggregate
GPU: 33
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_33 [style=dashed]
		layer30_comm_33 -> layer30_expert_33_ffn1 [style=dashed]
		layer30_expert_33_ffn1 -> layer30_expert_33_ffn2
		layer30_expert_33_ffn2 -> layer30_agg_33
		layer30_comm_34 [label="Token Transfer
From GPU: 0
To GPU: 34
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_34 [label="Expert 34
GPU: 34
Node: 4
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_34_ffn1 [label="Expert FFN1
GPU: 34
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_34_ffn2 [label="Expert FFN2
GPU: 34
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_34 [label="Aggregate
GPU: 34
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_34 [style=dashed]
		layer30_comm_34 -> layer30_expert_34_ffn1 [style=dashed]
		layer30_expert_34_ffn1 -> layer30_expert_34_ffn2
		layer30_expert_34_ffn2 -> layer30_agg_34
		layer30_comm_35 [label="Token Transfer
From GPU: 0
To GPU: 35
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_35 [label="Expert 35
GPU: 35
Node: 4
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_35_ffn1 [label="Expert FFN1
GPU: 35
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_35_ffn2 [label="Expert FFN2
GPU: 35
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_35 [label="Aggregate
GPU: 35
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_35 [style=dashed]
		layer30_comm_35 -> layer30_expert_35_ffn1 [style=dashed]
		layer30_expert_35_ffn1 -> layer30_expert_35_ffn2
		layer30_expert_35_ffn2 -> layer30_agg_35
		layer30_comm_36 [label="Token Transfer
From GPU: 0
To GPU: 36
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_36 [label="Expert 36
GPU: 36
Node: 4
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_36_ffn1 [label="Expert FFN1
GPU: 36
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_36_ffn2 [label="Expert FFN2
GPU: 36
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_36 [label="Aggregate
GPU: 36
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_36 [style=dashed]
		layer30_comm_36 -> layer30_expert_36_ffn1 [style=dashed]
		layer30_expert_36_ffn1 -> layer30_expert_36_ffn2
		layer30_expert_36_ffn2 -> layer30_agg_36
		layer30_comm_37 [label="Token Transfer
From GPU: 0
To GPU: 37
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_37 [label="Expert 37
GPU: 37
Node: 4
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_37_ffn1 [label="Expert FFN1
GPU: 37
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_37_ffn2 [label="Expert FFN2
GPU: 37
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_37 [label="Aggregate
GPU: 37
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_37 [style=dashed]
		layer30_comm_37 -> layer30_expert_37_ffn1 [style=dashed]
		layer30_expert_37_ffn1 -> layer30_expert_37_ffn2
		layer30_expert_37_ffn2 -> layer30_agg_37
		layer30_comm_38 [label="Token Transfer
From GPU: 0
To GPU: 38
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_38 [label="Expert 38
GPU: 38
Node: 4
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_38_ffn1 [label="Expert FFN1
GPU: 38
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_38_ffn2 [label="Expert FFN2
GPU: 38
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_38 [label="Aggregate
GPU: 38
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_38 [style=dashed]
		layer30_comm_38 -> layer30_expert_38_ffn1 [style=dashed]
		layer30_expert_38_ffn1 -> layer30_expert_38_ffn2
		layer30_expert_38_ffn2 -> layer30_agg_38
		layer30_comm_39 [label="Token Transfer
From GPU: 0
To GPU: 39
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_39 [label="Expert 39
GPU: 39
Node: 4
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_39_ffn1 [label="Expert FFN1
GPU: 39
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_39_ffn2 [label="Expert FFN2
GPU: 39
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_39 [label="Aggregate
GPU: 39
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_39 [style=dashed]
		layer30_comm_39 -> layer30_expert_39_ffn1 [style=dashed]
		layer30_expert_39_ffn1 -> layer30_expert_39_ffn2
		layer30_expert_39_ffn2 -> layer30_agg_39
		layer30_comm_40 [label="Token Transfer
From GPU: 0
To GPU: 40
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_40 [label="Expert 40
GPU: 40
Node: 5
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_40_ffn1 [label="Expert FFN1
GPU: 40
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_40_ffn2 [label="Expert FFN2
GPU: 40
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_40 [label="Aggregate
GPU: 40
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_40 [style=dashed]
		layer30_comm_40 -> layer30_expert_40_ffn1 [style=dashed]
		layer30_expert_40_ffn1 -> layer30_expert_40_ffn2
		layer30_expert_40_ffn2 -> layer30_agg_40
		layer30_comm_41 [label="Token Transfer
From GPU: 0
To GPU: 41
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_41 [label="Expert 41
GPU: 41
Node: 5
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_41_ffn1 [label="Expert FFN1
GPU: 41
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_41_ffn2 [label="Expert FFN2
GPU: 41
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_41 [label="Aggregate
GPU: 41
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_41 [style=dashed]
		layer30_comm_41 -> layer30_expert_41_ffn1 [style=dashed]
		layer30_expert_41_ffn1 -> layer30_expert_41_ffn2
		layer30_expert_41_ffn2 -> layer30_agg_41
		layer30_comm_42 [label="Token Transfer
From GPU: 0
To GPU: 42
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_42 [label="Expert 42
GPU: 42
Node: 5
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_42_ffn1 [label="Expert FFN1
GPU: 42
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_42_ffn2 [label="Expert FFN2
GPU: 42
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_42 [label="Aggregate
GPU: 42
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_42 [style=dashed]
		layer30_comm_42 -> layer30_expert_42_ffn1 [style=dashed]
		layer30_expert_42_ffn1 -> layer30_expert_42_ffn2
		layer30_expert_42_ffn2 -> layer30_agg_42
		layer30_comm_43 [label="Token Transfer
From GPU: 0
To GPU: 43
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_43 [label="Expert 43
GPU: 43
Node: 5
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_43_ffn1 [label="Expert FFN1
GPU: 43
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_43_ffn2 [label="Expert FFN2
GPU: 43
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_43 [label="Aggregate
GPU: 43
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_43 [style=dashed]
		layer30_comm_43 -> layer30_expert_43_ffn1 [style=dashed]
		layer30_expert_43_ffn1 -> layer30_expert_43_ffn2
		layer30_expert_43_ffn2 -> layer30_agg_43
		layer30_comm_44 [label="Token Transfer
From GPU: 0
To GPU: 44
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_44 [label="Expert 44
GPU: 44
Node: 5
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_44_ffn1 [label="Expert FFN1
GPU: 44
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_44_ffn2 [label="Expert FFN2
GPU: 44
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_44 [label="Aggregate
GPU: 44
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_44 [style=dashed]
		layer30_comm_44 -> layer30_expert_44_ffn1 [style=dashed]
		layer30_expert_44_ffn1 -> layer30_expert_44_ffn2
		layer30_expert_44_ffn2 -> layer30_agg_44
		layer30_comm_45 [label="Token Transfer
From GPU: 0
To GPU: 45
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_45 [label="Expert 45
GPU: 45
Node: 5
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_45_ffn1 [label="Expert FFN1
GPU: 45
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_45_ffn2 [label="Expert FFN2
GPU: 45
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_45 [label="Aggregate
GPU: 45
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_45 [style=dashed]
		layer30_comm_45 -> layer30_expert_45_ffn1 [style=dashed]
		layer30_expert_45_ffn1 -> layer30_expert_45_ffn2
		layer30_expert_45_ffn2 -> layer30_agg_45
		layer30_comm_46 [label="Token Transfer
From GPU: 0
To GPU: 46
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_46 [label="Expert 46
GPU: 46
Node: 5
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_46_ffn1 [label="Expert FFN1
GPU: 46
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_46_ffn2 [label="Expert FFN2
GPU: 46
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_46 [label="Aggregate
GPU: 46
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_46 [style=dashed]
		layer30_comm_46 -> layer30_expert_46_ffn1 [style=dashed]
		layer30_expert_46_ffn1 -> layer30_expert_46_ffn2
		layer30_expert_46_ffn2 -> layer30_agg_46
		layer30_comm_47 [label="Token Transfer
From GPU: 0
To GPU: 47
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_47 [label="Expert 47
GPU: 47
Node: 5
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_47_ffn1 [label="Expert FFN1
GPU: 47
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_47_ffn2 [label="Expert FFN2
GPU: 47
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_47 [label="Aggregate
GPU: 47
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_47 [style=dashed]
		layer30_comm_47 -> layer30_expert_47_ffn1 [style=dashed]
		layer30_expert_47_ffn1 -> layer30_expert_47_ffn2
		layer30_expert_47_ffn2 -> layer30_agg_47
		layer30_comm_48 [label="Token Transfer
From GPU: 0
To GPU: 48
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_48 [label="Expert 48
GPU: 48
Node: 6
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_48_ffn1 [label="Expert FFN1
GPU: 48
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_48_ffn2 [label="Expert FFN2
GPU: 48
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_48 [label="Aggregate
GPU: 48
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_48 [style=dashed]
		layer30_comm_48 -> layer30_expert_48_ffn1 [style=dashed]
		layer30_expert_48_ffn1 -> layer30_expert_48_ffn2
		layer30_expert_48_ffn2 -> layer30_agg_48
		layer30_comm_49 [label="Token Transfer
From GPU: 0
To GPU: 49
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_49 [label="Expert 49
GPU: 49
Node: 6
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_49_ffn1 [label="Expert FFN1
GPU: 49
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_49_ffn2 [label="Expert FFN2
GPU: 49
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_49 [label="Aggregate
GPU: 49
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_49 [style=dashed]
		layer30_comm_49 -> layer30_expert_49_ffn1 [style=dashed]
		layer30_expert_49_ffn1 -> layer30_expert_49_ffn2
		layer30_expert_49_ffn2 -> layer30_agg_49
		layer30_comm_50 [label="Token Transfer
From GPU: 0
To GPU: 50
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_50 [label="Expert 50
GPU: 50
Node: 6
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_50_ffn1 [label="Expert FFN1
GPU: 50
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_50_ffn2 [label="Expert FFN2
GPU: 50
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_50 [label="Aggregate
GPU: 50
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_50 [style=dashed]
		layer30_comm_50 -> layer30_expert_50_ffn1 [style=dashed]
		layer30_expert_50_ffn1 -> layer30_expert_50_ffn2
		layer30_expert_50_ffn2 -> layer30_agg_50
		layer30_comm_51 [label="Token Transfer
From GPU: 0
To GPU: 51
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_51 [label="Expert 51
GPU: 51
Node: 6
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_51_ffn1 [label="Expert FFN1
GPU: 51
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_51_ffn2 [label="Expert FFN2
GPU: 51
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_51 [label="Aggregate
GPU: 51
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_51 [style=dashed]
		layer30_comm_51 -> layer30_expert_51_ffn1 [style=dashed]
		layer30_expert_51_ffn1 -> layer30_expert_51_ffn2
		layer30_expert_51_ffn2 -> layer30_agg_51
		layer30_comm_52 [label="Token Transfer
From GPU: 0
To GPU: 52
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_52 [label="Expert 52
GPU: 52
Node: 6
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_52_ffn1 [label="Expert FFN1
GPU: 52
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_52_ffn2 [label="Expert FFN2
GPU: 52
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_52 [label="Aggregate
GPU: 52
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_52 [style=dashed]
		layer30_comm_52 -> layer30_expert_52_ffn1 [style=dashed]
		layer30_expert_52_ffn1 -> layer30_expert_52_ffn2
		layer30_expert_52_ffn2 -> layer30_agg_52
		layer30_comm_53 [label="Token Transfer
From GPU: 0
To GPU: 53
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_53 [label="Expert 53
GPU: 53
Node: 6
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_53_ffn1 [label="Expert FFN1
GPU: 53
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_53_ffn2 [label="Expert FFN2
GPU: 53
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_53 [label="Aggregate
GPU: 53
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_53 [style=dashed]
		layer30_comm_53 -> layer30_expert_53_ffn1 [style=dashed]
		layer30_expert_53_ffn1 -> layer30_expert_53_ffn2
		layer30_expert_53_ffn2 -> layer30_agg_53
		layer30_comm_54 [label="Token Transfer
From GPU: 0
To GPU: 54
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_54 [label="Expert 54
GPU: 54
Node: 6
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_54_ffn1 [label="Expert FFN1
GPU: 54
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_54_ffn2 [label="Expert FFN2
GPU: 54
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_54 [label="Aggregate
GPU: 54
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_54 [style=dashed]
		layer30_comm_54 -> layer30_expert_54_ffn1 [style=dashed]
		layer30_expert_54_ffn1 -> layer30_expert_54_ffn2
		layer30_expert_54_ffn2 -> layer30_agg_54
		layer30_comm_55 [label="Token Transfer
From GPU: 0
To GPU: 55
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_55 [label="Expert 55
GPU: 55
Node: 6
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_55_ffn1 [label="Expert FFN1
GPU: 55
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_55_ffn2 [label="Expert FFN2
GPU: 55
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_55 [label="Aggregate
GPU: 55
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_55 [style=dashed]
		layer30_comm_55 -> layer30_expert_55_ffn1 [style=dashed]
		layer30_expert_55_ffn1 -> layer30_expert_55_ffn2
		layer30_expert_55_ffn2 -> layer30_agg_55
		layer30_comm_56 [label="Token Transfer
From GPU: 0
To GPU: 56
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_56 [label="Expert 56
GPU: 56
Node: 7
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_56_ffn1 [label="Expert FFN1
GPU: 56
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_56_ffn2 [label="Expert FFN2
GPU: 56
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_56 [label="Aggregate
GPU: 56
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_56 [style=dashed]
		layer30_comm_56 -> layer30_expert_56_ffn1 [style=dashed]
		layer30_expert_56_ffn1 -> layer30_expert_56_ffn2
		layer30_expert_56_ffn2 -> layer30_agg_56
		layer30_comm_57 [label="Token Transfer
From GPU: 0
To GPU: 57
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_57 [label="Expert 57
GPU: 57
Node: 7
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_57_ffn1 [label="Expert FFN1
GPU: 57
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_57_ffn2 [label="Expert FFN2
GPU: 57
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_57 [label="Aggregate
GPU: 57
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_57 [style=dashed]
		layer30_comm_57 -> layer30_expert_57_ffn1 [style=dashed]
		layer30_expert_57_ffn1 -> layer30_expert_57_ffn2
		layer30_expert_57_ffn2 -> layer30_agg_57
		layer30_comm_58 [label="Token Transfer
From GPU: 0
To GPU: 58
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_58 [label="Expert 58
GPU: 58
Node: 7
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_58_ffn1 [label="Expert FFN1
GPU: 58
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_58_ffn2 [label="Expert FFN2
GPU: 58
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_58 [label="Aggregate
GPU: 58
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_58 [style=dashed]
		layer30_comm_58 -> layer30_expert_58_ffn1 [style=dashed]
		layer30_expert_58_ffn1 -> layer30_expert_58_ffn2
		layer30_expert_58_ffn2 -> layer30_agg_58
		layer30_comm_59 [label="Token Transfer
From GPU: 0
To GPU: 59
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_59 [label="Expert 59
GPU: 59
Node: 7
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_59_ffn1 [label="Expert FFN1
GPU: 59
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_59_ffn2 [label="Expert FFN2
GPU: 59
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_59 [label="Aggregate
GPU: 59
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_59 [style=dashed]
		layer30_comm_59 -> layer30_expert_59_ffn1 [style=dashed]
		layer30_expert_59_ffn1 -> layer30_expert_59_ffn2
		layer30_expert_59_ffn2 -> layer30_agg_59
		layer30_comm_60 [label="Token Transfer
From GPU: 0
To GPU: 60
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_60 [label="Expert 60
GPU: 60
Node: 7
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_60_ffn1 [label="Expert FFN1
GPU: 60
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_60_ffn2 [label="Expert FFN2
GPU: 60
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_60 [label="Aggregate
GPU: 60
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_60 [style=dashed]
		layer30_comm_60 -> layer30_expert_60_ffn1 [style=dashed]
		layer30_expert_60_ffn1 -> layer30_expert_60_ffn2
		layer30_expert_60_ffn2 -> layer30_agg_60
		layer30_comm_61 [label="Token Transfer
From GPU: 0
To GPU: 61
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_61 [label="Expert 61
GPU: 61
Node: 7
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_61_ffn1 [label="Expert FFN1
GPU: 61
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_61_ffn2 [label="Expert FFN2
GPU: 61
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_61 [label="Aggregate
GPU: 61
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_61 [style=dashed]
		layer30_comm_61 -> layer30_expert_61_ffn1 [style=dashed]
		layer30_expert_61_ffn1 -> layer30_expert_61_ffn2
		layer30_expert_61_ffn2 -> layer30_agg_61
		layer30_comm_62 [label="Token Transfer
From GPU: 0
To GPU: 62
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_62 [label="Expert 62
GPU: 62
Node: 7
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_62_ffn1 [label="Expert FFN1
GPU: 62
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_62_ffn2 [label="Expert FFN2
GPU: 62
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_62 [label="Aggregate
GPU: 62
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_62 [style=dashed]
		layer30_comm_62 -> layer30_expert_62_ffn1 [style=dashed]
		layer30_expert_62_ffn1 -> layer30_expert_62_ffn2
		layer30_expert_62_ffn2 -> layer30_agg_62
		layer30_comm_63 [label="Token Transfer
From GPU: 0
To GPU: 63
[1,1024,7168]" fillcolor=purple shape=ellipse style=dashed]
		layer30_expert_63 [label="Expert 63
GPU: 63
Node: 7
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_expert_63_ffn1 [label="Expert FFN1
GPU: 63
[1,1024,2048]" fillcolor=lightblue shape=rectangle]
		layer30_expert_63_ffn2 [label="Expert FFN2
GPU: 63
[1,1024,7168]" fillcolor=lightblue shape=rectangle]
		layer30_agg_63 [label="Aggregate
GPU: 63
[1,1024,7168]" fillcolor=orange shape=parallelogram]
		layer30_input -> layer30_gate
		layer30_gate -> layer30_comm_63 [style=dashed]
		layer30_comm_63 -> layer30_expert_63_ffn1 [style=dashed]
		layer30_expert_63_ffn1 -> layer30_expert_63_ffn2
		layer30_expert_63_ffn2 -> layer30_agg_63
	}
	subgraph cluster_layer60 {
		label="Layer 60 (Final MoE)" style=rounded
		layer60_input [label="Input
GPU: 0-63
[8,1024,7168]" fillcolor=lightgreen shape=ellipse]
		layer60_gate [label="Gate
GPU: 0
[8,1024,7168]" fillcolor=yellow shape=parallelogram]
		layer60_final_agg [label="Final Aggregation
GPU: 0
[8,1024,7168]" fillcolor=orange shape=parallelogram]
		output [label="Output
GPU: 0
[8,1024,7168]" fillcolor=lightgreen shape=ellipse]
		layer60_input -> layer60_gate
		layer60_gate -> layer60_final_agg
		layer60_final_agg -> output
	}
	layer0_all_reduce_gpu3 -> layer30_input
	layer30_agg_63 -> layer60_input
}
