<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="3868pt" height="1875pt"
 viewBox="0.00 0.00 3868.12 1875.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1871.48)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1871.48 3864.12,-1871.48 3864.12,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="none" stroke="black" d="M20,-185.48C20,-185.48 902.53,-185.48 902.53,-185.48 908.53,-185.48 914.53,-191.48 914.53,-197.48 914.53,-197.48 914.53,-294.48 914.53,-294.48 914.53,-300.48 908.53,-306.48 902.53,-306.48 902.53,-306.48 20,-306.48 20,-306.48 14,-306.48 8,-300.48 8,-294.48 8,-294.48 8,-197.48 8,-197.48 8,-191.48 14,-185.48 20,-185.48"/>
<text text-anchor="middle" x="461.26" y="-291.28" font-family="Times,serif" font-size="14.00">Input Distribution Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu0</title>
<path fill="none" stroke="black" d="M1087.53,-1716.48C1087.53,-1716.48 2881.44,-1716.48 2881.44,-1716.48 2887.44,-1716.48 2893.44,-1722.48 2893.44,-1728.48 2893.44,-1728.48 2893.44,-1847.48 2893.44,-1847.48 2893.44,-1853.48 2887.44,-1859.48 2881.44,-1859.48 2881.44,-1859.48 1087.53,-1859.48 1087.53,-1859.48 1081.53,-1859.48 1075.53,-1853.48 1075.53,-1847.48 1075.53,-1847.48 1075.53,-1728.48 1075.53,-1728.48 1075.53,-1722.48 1081.53,-1716.48 1087.53,-1716.48"/>
<text text-anchor="middle" x="1984.48" y="-1844.28" font-family="Times,serif" font-size="14.00">GPU 0: Complete Processing Pipeline</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu64</title>
<path fill="none" stroke="black" d="M1087.53,-688.48C1087.53,-688.48 2881.44,-688.48 2881.44,-688.48 2887.44,-688.48 2893.44,-694.48 2893.44,-700.48 2893.44,-700.48 2893.44,-819.48 2893.44,-819.48 2893.44,-825.48 2887.44,-831.48 2881.44,-831.48 2881.44,-831.48 1087.53,-831.48 1087.53,-831.48 1081.53,-831.48 1075.53,-825.48 1075.53,-819.48 1075.53,-819.48 1075.53,-700.48 1075.53,-700.48 1075.53,-694.48 1081.53,-688.48 1087.53,-688.48"/>
<text text-anchor="middle" x="1984.48" y="-816.28" font-family="Times,serif" font-size="14.00">GPU 64: Complete Processing Pipeline</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu128</title>
<path fill="none" stroke="black" d="M1087.53,-537.48C1087.53,-537.48 2881.44,-537.48 2881.44,-537.48 2887.44,-537.48 2893.44,-543.48 2893.44,-549.48 2893.44,-549.48 2893.44,-668.48 2893.44,-668.48 2893.44,-674.48 2887.44,-680.48 2881.44,-680.48 2881.44,-680.48 1087.53,-680.48 1087.53,-680.48 1081.53,-680.48 1075.53,-674.48 1075.53,-668.48 1075.53,-668.48 1075.53,-549.48 1075.53,-549.48 1075.53,-543.48 1081.53,-537.48 1087.53,-537.48"/>
<text text-anchor="middle" x="1984.48" y="-665.28" font-family="Times,serif" font-size="14.00">GPU 128: Complete Processing Pipeline</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu192</title>
<path fill="none" stroke="black" d="M1087.53,-386.48C1087.53,-386.48 2881.44,-386.48 2881.44,-386.48 2887.44,-386.48 2893.44,-392.48 2893.44,-398.48 2893.44,-398.48 2893.44,-517.48 2893.44,-517.48 2893.44,-523.48 2887.44,-529.48 2881.44,-529.48 2881.44,-529.48 1087.53,-529.48 1087.53,-529.48 1081.53,-529.48 1075.53,-523.48 1075.53,-517.48 1075.53,-517.48 1075.53,-398.48 1075.53,-398.48 1075.53,-392.48 1081.53,-386.48 1087.53,-386.48"/>
<text text-anchor="middle" x="1984.48" y="-514.28" font-family="Times,serif" font-size="14.00">GPU 192: Complete Processing Pipeline</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu255</title>
<path fill="none" stroke="black" d="M1087.53,-235.48C1087.53,-235.48 2881.44,-235.48 2881.44,-235.48 2887.44,-235.48 2893.44,-241.48 2893.44,-247.48 2893.44,-247.48 2893.44,-366.48 2893.44,-366.48 2893.44,-372.48 2887.44,-378.48 2881.44,-378.48 2881.44,-378.48 1087.53,-378.48 1087.53,-378.48 1081.53,-378.48 1075.53,-372.48 1075.53,-366.48 1075.53,-366.48 1075.53,-247.48 1075.53,-247.48 1075.53,-241.48 1081.53,-235.48 1087.53,-235.48"/>
<text text-anchor="middle" x="1984.48" y="-363.28" font-family="Times,serif" font-size="14.00">GPU 255: Complete Processing Pipeline</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_communication</title>
<path fill="none" stroke="black" d="M2150.33,-839.48C2150.33,-839.48 2419.31,-839.48 2419.31,-839.48 2425.31,-839.48 2431.31,-845.48 2431.31,-851.48 2431.31,-851.48 2431.31,-1696.48 2431.31,-1696.48 2431.31,-1702.48 2425.31,-1708.48 2419.31,-1708.48 2419.31,-1708.48 2150.33,-1708.48 2150.33,-1708.48 2144.33,-1708.48 2138.33,-1702.48 2138.33,-1696.48 2138.33,-1696.48 2138.33,-851.48 2138.33,-851.48 2138.33,-845.48 2144.33,-839.48 2150.33,-839.48"/>
<text text-anchor="middle" x="2284.82" y="-1693.28" font-family="Times,serif" font-size="14.00">Cross&#45;Node Communication &amp; Routing</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_output</title>
<path fill="none" stroke="black" d="M3028.44,-563.48C3028.44,-563.48 3840.12,-563.48 3840.12,-563.48 3846.12,-563.48 3852.12,-569.48 3852.12,-575.48 3852.12,-575.48 3852.12,-694.48 3852.12,-694.48 3852.12,-700.48 3846.12,-706.48 3840.12,-706.48 3840.12,-706.48 3028.44,-706.48 3028.44,-706.48 3022.44,-706.48 3016.44,-700.48 3016.44,-694.48 3016.44,-694.48 3016.44,-575.48 3016.44,-575.48 3016.44,-569.48 3022.44,-563.48 3028.44,-563.48"/>
<text text-anchor="middle" x="3434.28" y="-691.28" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
</g>
<!-- input_tokens -->
<g id="node1" class="node">
<title>input_tokens</title>
<polygon fill="lightgray" stroke="black" points="124.59,-205.56 130.67,-205.71 136.69,-205.95 142.63,-206.27 148.45,-206.66 154.13,-207.13 159.66,-207.68 165.01,-208.29 170.17,-208.98 175.1,-209.74 179.8,-210.57 184.24,-211.46 188.42,-212.42 192.32,-213.43 195.92,-214.51 199.22,-215.64 202.22,-216.82 204.89,-218.05 207.25,-219.32 209.28,-220.64 210.99,-221.99 212.37,-223.38 213.42,-224.79 214.16,-226.24 214.58,-227.71 214.7,-229.19 214.51,-230.69 214.03,-232.2 213.27,-233.72 212.23,-235.24 210.93,-236.76 209.39,-238.27 207.6,-239.77 205.6,-241.25 203.38,-242.72 200.97,-244.16 198.37,-245.58 195.6,-246.97 192.68,-248.32 189.61,-249.64 186.42,-250.91 183.1,-252.14 179.67,-253.32 176.15,-254.45 172.55,-255.52 168.87,-256.54 165.12,-257.5 161.32,-258.39 157.46,-259.22 153.57,-259.98 149.63,-260.67 145.67,-261.28 141.68,-261.83 137.67,-262.3 133.64,-262.69 129.6,-263.01 125.55,-263.24 121.49,-263.4 117.43,-263.48 113.37,-263.48 109.31,-263.4 105.25,-263.24 101.2,-263.01 97.16,-262.69 93.13,-262.3 89.12,-261.83 85.13,-261.28 81.17,-260.67 77.23,-259.98 73.34,-259.22 69.48,-258.39 65.68,-257.5 61.93,-256.54 58.25,-255.52 54.64,-254.45 51.12,-253.32 47.7,-252.14 44.38,-250.91 41.19,-249.64 38.12,-248.32 35.19,-246.97 32.43,-245.58 29.83,-244.16 27.42,-242.72 25.2,-241.25 23.19,-239.77 21.41,-238.27 19.87,-236.76 18.57,-235.24 17.53,-233.72 16.77,-232.2 16.29,-230.69 16.1,-229.19 16.21,-227.71 16.64,-226.24 17.37,-224.79 18.43,-223.38 19.81,-221.99 21.52,-220.64 23.55,-219.32 25.9,-218.05 28.58,-216.82 31.57,-215.64 34.88,-214.51 38.48,-213.43 42.38,-212.42 46.56,-211.46 51,-210.57 55.7,-209.74 60.63,-208.98 65.78,-208.29 71.13,-207.68 76.66,-207.13 82.35,-206.66 88.17,-206.27 94.11,-205.95 100.13,-205.71 106.21,-205.56 112.33,-205.48 118.47,-205.48 124.59,-205.56"/>
<text text-anchor="middle" x="115.4" y="-242.98" font-family="Arial" font-size="10.00">Input Tokens</text>
<text text-anchor="middle" x="115.4" y="-231.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?]</text>
<text text-anchor="middle" x="115.4" y="-220.98" font-family="Arial" font-size="10.00">GPU: N/A</text>
</g>
<!-- token_split -->
<g id="node2" class="node">
<title>token_split</title>
<polygon fill="lightgreen" stroke="black" points="906.39,-275.48 441.52,-275.48 321.93,-193.48 786.8,-193.48 906.39,-275.48"/>
<text text-anchor="middle" x="614.16" y="-242.98" font-family="Arial" font-size="10.00">Token Split</text>
<text text-anchor="middle" x="614.16" y="-231.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?] → [batch_size=?, seq_len=?/256]</text>
<text text-anchor="middle" x="614.16" y="-220.98" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
</g>
<!-- input_tokens&#45;&gt;token_split -->
<g id="edge1" class="edge">
<title>input_tokens&#45;&gt;token_split</title>
<path fill="none" stroke="black" d="M212.77,-234.48C258.42,-234.48 315.2,-234.48 371.51,-234.48"/>
<polygon fill="black" stroke="black" points="371.65,-237.98 381.65,-234.48 371.65,-230.98 371.65,-237.98"/>
<text text-anchor="middle" x="268.3" y="-238.28" font-family="Times,serif" font-size="14.00">broadcast</text>
</g>
<!-- mla_0 -->
<g id="node3" class="node">
<title>mla_0</title>
<polygon fill="lightblue" stroke="black" points="1307.53,-1789.48 1083.53,-1789.48 1083.53,-1737.48 1307.53,-1737.48 1307.53,-1789.48"/>
<text text-anchor="middle" x="1195.53" y="-1777.48" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="1195.53" y="-1766.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="1195.53" y="-1755.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1195.53" y="-1744.48" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- token_split&#45;&gt;mla_0 -->
<g id="edge2" class="edge">
<title>token_split&#45;&gt;mla_0</title>
<path fill="none" stroke="black" d="M630.81,-275.77C713.99,-495.3 1103.49,-1523.23 1181.07,-1727.96"/>
<polygon fill="black" stroke="black" points="1177.81,-1729.24 1184.63,-1737.35 1184.36,-1726.76 1177.81,-1729.24"/>
<text text-anchor="middle" x="995.03" y="-1397.28" font-family="Times,serif" font-size="14.00">tokens for GPU 0</text>
</g>
<!-- residual_add_0 -->
<g id="node5" class="node">
<title>residual_add_0</title>
<polygon fill="lightgreen" stroke="black" points="2654.56,-1828.48 2065.59,-1828.48 1914.08,-1724.48 2503.05,-1724.48 2654.56,-1828.48"/>
<text text-anchor="middle" x="2284.32" y="-1790.48" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2284.32" y="-1779.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-1768.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-1757.48" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- token_split&#45;&gt;residual_add_0 -->
<g id="edge5" class="edge">
<title>token_split&#45;&gt;residual_add_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M834.46,-225.93C1190.78,-213.16 1859.69,-194.34 1896.2,-231.48 1925.04,-260.82 1887.52,-1681.16 1914.2,-1712.48 1915.4,-1713.88 1916.61,-1715.26 1917.84,-1716.62"/>
<polygon fill="black" stroke="black" points="1915.64,-1719.38 1925.1,-1724.15 1920.68,-1714.52 1915.64,-1719.38"/>
<text text-anchor="middle" x="1354.53" y="-215.28" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mla_64 -->
<g id="node7" class="node">
<title>mla_64</title>
<polygon fill="lightblue" stroke="black" points="1307.53,-761.48 1083.53,-761.48 1083.53,-709.48 1307.53,-709.48 1307.53,-761.48"/>
<text text-anchor="middle" x="1195.53" y="-749.48" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="1195.53" y="-738.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="1195.53" y="-727.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1195.53" y="-716.48" font-family="Arial" font-size="10.00">GPU: 64</text>
</g>
<!-- token_split&#45;&gt;mla_64 -->
<g id="edge7" class="edge">
<title>token_split&#45;&gt;mla_64</title>
<path fill="none" stroke="black" d="M647.53,-275.77C717.27,-362.34 890.46,-564.69 1075.53,-684.48 1087.41,-692.17 1100.65,-699.16 1113.85,-705.34"/>
<polygon fill="black" stroke="black" points="1112.42,-708.53 1122.97,-709.48 1115.31,-702.16 1112.42,-708.53"/>
<text text-anchor="middle" x="995.03" y="-678.28" font-family="Times,serif" font-size="14.00">tokens for GPU 64</text>
</g>
<!-- residual_add_64 -->
<g id="node9" class="node">
<title>residual_add_64</title>
<polygon fill="lightgreen" stroke="black" points="2654.56,-800.48 2065.59,-800.48 1914.08,-696.48 2503.05,-696.48 2654.56,-800.48"/>
<text text-anchor="middle" x="2284.32" y="-762.48" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2284.32" y="-751.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-740.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-729.48" font-family="Arial" font-size="10.00">GPU: 64</text>
</g>
<!-- token_split&#45;&gt;residual_add_64 -->
<g id="edge10" class="edge">
<title>token_split&#45;&gt;residual_add_64</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M810.96,-209.94C848.61,-205.72 887.76,-201.67 924.53,-198.48 1032.09,-189.14 1820.16,-121.84 1896.2,-198.48 1934.26,-236.84 1878.65,-643.79 1914.2,-684.48 1915.56,-686.04 1916.95,-687.57 1918.36,-689.08"/>
<polygon fill="black" stroke="black" points="1916.06,-691.73 1925.59,-696.36 1921.03,-686.8 1916.06,-691.73"/>
<text text-anchor="middle" x="1354.53" y="-173.28" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mla_128 -->
<g id="node11" class="node">
<title>mla_128</title>
<polygon fill="lightblue" stroke="black" points="1307.53,-610.48 1083.53,-610.48 1083.53,-558.48 1307.53,-558.48 1307.53,-610.48"/>
<text text-anchor="middle" x="1195.53" y="-598.48" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="1195.53" y="-587.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="1195.53" y="-576.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1195.53" y="-565.48" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- token_split&#45;&gt;mla_128 -->
<g id="edge12" class="edge">
<title>token_split&#45;&gt;mla_128</title>
<path fill="none" stroke="black" d="M671.37,-275.51C756.24,-336.4 923.36,-452.23 1075.53,-533.48 1089.19,-540.77 1104.12,-547.84 1118.64,-554.26"/>
<polygon fill="black" stroke="black" points="1117.55,-557.6 1128.11,-558.39 1120.34,-551.19 1117.55,-557.6"/>
<text text-anchor="middle" x="995.03" y="-530.28" font-family="Times,serif" font-size="14.00">tokens for GPU 128</text>
</g>
<!-- residual_add_128 -->
<g id="node13" class="node">
<title>residual_add_128</title>
<polygon fill="lightgreen" stroke="black" points="2654.56,-649.48 2065.59,-649.48 1914.08,-545.48 2503.05,-545.48 2654.56,-649.48"/>
<text text-anchor="middle" x="2284.32" y="-611.48" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2284.32" y="-600.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-589.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-578.48" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- token_split&#45;&gt;residual_add_128 -->
<g id="edge15" class="edge">
<title>token_split&#45;&gt;residual_add_128</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M763.22,-193.42C813.98,-180.85 871.39,-168.29 924.53,-160.48 1031.34,-144.77 1819.73,-84.27 1896.2,-160.48 1925.59,-189.77 1886.73,-502.39 1914.2,-533.48 1915.57,-535.03 1916.97,-536.56 1918.39,-538.05"/>
<polygon fill="black" stroke="black" points="1916.1,-540.72 1925.66,-545.3 1921.05,-535.76 1916.1,-540.72"/>
<text text-anchor="middle" x="1354.53" y="-133.28" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mla_192 -->
<g id="node15" class="node">
<title>mla_192</title>
<polygon fill="lightblue" stroke="black" points="1307.53,-459.48 1083.53,-459.48 1083.53,-407.48 1307.53,-407.48 1307.53,-459.48"/>
<text text-anchor="middle" x="1195.53" y="-447.48" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="1195.53" y="-436.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="1195.53" y="-425.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1195.53" y="-414.48" font-family="Arial" font-size="10.00">GPU: 192</text>
</g>
<!-- token_split&#45;&gt;mla_192 -->
<g id="edge17" class="edge">
<title>token_split&#45;&gt;mla_192</title>
<path fill="none" stroke="black" d="M734.86,-275.59C846.45,-313.92 1010.12,-370.14 1109.08,-404.13"/>
<polygon fill="black" stroke="black" points="1108.15,-407.51 1118.75,-407.45 1110.43,-400.89 1108.15,-407.51"/>
<text text-anchor="middle" x="995.03" y="-388.28" font-family="Times,serif" font-size="14.00">tokens for GPU 192</text>
</g>
<!-- residual_add_192 -->
<g id="node17" class="node">
<title>residual_add_192</title>
<polygon fill="lightgreen" stroke="black" points="2654.56,-498.48 2065.59,-498.48 1914.08,-394.48 2503.05,-394.48 2654.56,-498.48"/>
<text text-anchor="middle" x="2284.32" y="-460.48" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2284.32" y="-449.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-438.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-427.48" font-family="Arial" font-size="10.00">GPU: 192</text>
</g>
<!-- token_split&#45;&gt;residual_add_192 -->
<g id="edge20" class="edge">
<title>token_split&#45;&gt;residual_add_192</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M706.54,-193.45C767.09,-168.27 848.99,-137.97 924.53,-122.48 1030.29,-100.78 1818.94,-47.07 1896.2,-122.48 1937.65,-162.93 1875.4,-339.48 1914.2,-382.48 1915.59,-384.02 1917,-385.53 1918.43,-387.01"/>
<polygon fill="black" stroke="black" points="1916.18,-389.71 1925.78,-394.2 1921.08,-384.7 1916.18,-389.71"/>
<text text-anchor="middle" x="1354.53" y="-93.28" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mla_255 -->
<g id="node19" class="node">
<title>mla_255</title>
<polygon fill="lightblue" stroke="black" points="1307.53,-308.48 1083.53,-308.48 1083.53,-256.48 1307.53,-256.48 1307.53,-308.48"/>
<text text-anchor="middle" x="1195.53" y="-296.48" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="1195.53" y="-285.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="1195.53" y="-274.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1195.53" y="-263.48" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- token_split&#45;&gt;mla_255 -->
<g id="edge22" class="edge">
<title>token_split&#45;&gt;mla_255</title>
<path fill="none" stroke="black" d="M878.57,-256.3C946.53,-261.93 1016.43,-267.72 1073.15,-272.42"/>
<polygon fill="black" stroke="black" points="1072.97,-275.92 1083.23,-273.26 1073.55,-268.94 1072.97,-275.92"/>
<text text-anchor="middle" x="995.03" y="-274.28" font-family="Times,serif" font-size="14.00">tokens for GPU 255</text>
</g>
<!-- residual_add_255 -->
<g id="node21" class="node">
<title>residual_add_255</title>
<polygon fill="lightgreen" stroke="black" points="2654.56,-347.48 2065.59,-347.48 1914.08,-243.48 2503.05,-243.48 2654.56,-347.48"/>
<text text-anchor="middle" x="2284.32" y="-309.48" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2284.32" y="-298.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-287.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-276.48" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- token_split&#45;&gt;residual_add_255 -->
<g id="edge25" class="edge">
<title>token_split&#45;&gt;residual_add_255</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M680.4,-193.38C741.07,-157.52 835.27,-107.69 924.53,-84.48 1342.48,24.2 1480.21,31.51 1896.2,-84.48 2010.32,-116.3 2127.96,-186.78 2203.15,-237.53"/>
<polygon fill="black" stroke="black" points="2201.41,-240.58 2211.65,-243.31 2205.34,-234.8 2201.41,-240.58"/>
<text text-anchor="middle" x="1354.53" y="-8.28" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_0 -->
<g id="node4" class="node">
<title>gate_0</title>
<polygon fill="lightgreen" stroke="black" points="1787.04,-1828.48 1480.54,-1828.48 1401.69,-1724.48 1708.19,-1724.48 1787.04,-1828.48"/>
<text text-anchor="middle" x="1594.36" y="-1790.48" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="1594.36" y="-1779.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1594.36" y="-1768.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1594.36" y="-1757.48" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- mla_0&#45;&gt;gate_0 -->
<g id="edge3" class="edge">
<title>mla_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M1307.6,-1767.12C1344.59,-1768.33 1386.64,-1769.71 1426.89,-1771.03"/>
<polygon fill="black" stroke="black" points="1426.97,-1774.53 1437.08,-1771.36 1427.2,-1767.53 1426.97,-1774.53"/>
</g>
<!-- gate_0&#45;&gt;residual_add_0 -->
<g id="edge4" class="edge">
<title>gate_0&#45;&gt;residual_add_0</title>
<path fill="none" stroke="black" d="M1747.62,-1776.48C1815.93,-1776.48 1899.08,-1776.48 1979.28,-1776.48"/>
<polygon fill="black" stroke="black" points="1979.56,-1779.98 1989.56,-1776.48 1979.56,-1772.98 1979.56,-1779.98"/>
</g>
<!-- comm_0_to_64 -->
<g id="node23" class="node">
<title>comm_0_to_64</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-1648.48" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2284.32" y="-1656.98" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2284.32" y="-1645.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-1634.98" font-family="Arial" font-size="10.00">→ GPU: 64</text>
</g>
<!-- gate_0&#45;&gt;comm_0_to_64 -->
<g id="edge27" class="edge">
<title>gate_0&#45;&gt;comm_0_to_64</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1727.07,-1749.23C1784.48,-1737.56 1852.6,-1724 1914.2,-1712.48 1999.99,-1696.43 2097.26,-1679.63 2170.4,-1667.26"/>
<polygon fill="black" stroke="black" points="2171.28,-1670.66 2180.56,-1665.55 2170.12,-1663.76 2171.28,-1670.66"/>
<text text-anchor="middle" x="1850.7" y="-1736.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- comm_0_to_128 -->
<g id="node24" class="node">
<title>comm_0_to_128</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-1572.48" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2284.32" y="-1580.98" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2284.32" y="-1569.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-1558.98" font-family="Arial" font-size="10.00">→ GPU: 128</text>
</g>
<!-- gate_0&#45;&gt;comm_0_to_128 -->
<g id="edge28" class="edge">
<title>gate_0&#45;&gt;comm_0_to_128</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1674.65,-1724.38C1737.06,-1686.1 1827.67,-1636.42 1914.2,-1610.48 1988.89,-1588.08 2075.48,-1578.37 2146.01,-1574.35"/>
<polygon fill="black" stroke="black" points="2146.5,-1577.83 2156.3,-1573.8 2146.12,-1570.84 2146.5,-1577.83"/>
<text text-anchor="middle" x="1850.7" y="-1652.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- comm_0_to_192 -->
<g id="node25" class="node">
<title>comm_0_to_192</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-1496.48" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2284.32" y="-1504.98" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2284.32" y="-1493.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-1482.98" font-family="Arial" font-size="10.00">→ GPU: 192</text>
</g>
<!-- gate_0&#45;&gt;comm_0_to_192 -->
<g id="edge29" class="edge">
<title>gate_0&#45;&gt;comm_0_to_192</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1641.8,-1724.3C1698.92,-1664.56 1802.19,-1570.35 1914.2,-1534.48 1988.47,-1510.7 2075.03,-1500.91 2145.65,-1497.2"/>
<polygon fill="black" stroke="black" points="2146.14,-1500.68 2155.95,-1496.7 2145.79,-1493.69 2146.14,-1500.68"/>
<text text-anchor="middle" x="1850.7" y="-1589.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- comm_0_to_255 -->
<g id="node26" class="node">
<title>comm_0_to_255</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-1420.48" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2284.32" y="-1428.98" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2284.32" y="-1417.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-1406.98" font-family="Arial" font-size="10.00">→ GPU: 255</text>
</g>
<!-- gate_0&#45;&gt;comm_0_to_255 -->
<g id="edge30" class="edge">
<title>gate_0&#45;&gt;comm_0_to_255</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1625.39,-1724.2C1674.03,-1646 1778.43,-1502.98 1914.2,-1458.48 1988.45,-1434.14 2075.19,-1424.34 2145.93,-1420.75"/>
<polygon fill="black" stroke="black" points="2146.42,-1424.24 2156.25,-1420.27 2146.1,-1417.24 2146.42,-1424.24"/>
<text text-anchor="middle" x="1850.7" y="-1519.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- async_0_64 -->
<g id="node31" class="node">
<title>async_0_64</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-1352.48" rx="73.58" ry="21.43"/>
<text text-anchor="middle" x="2284.32" y="-1355.48" font-family="Arial" font-size="10.00">Async Transfer</text>
<text text-anchor="middle" x="2284.32" y="-1344.48" font-family="Arial" font-size="10.00">GPU: 0 ↔ GPU: 64</text>
</g>
<!-- gate_0&#45;&gt;async_0_64 -->
<g id="edge43" class="edge">
<title>gate_0&#45;&gt;async_0_64</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1619.11,-1724.2C1652.73,-1654.53 1719.75,-1530.4 1805.2,-1447.48 1912.61,-1343.24 2099.81,-1337.69 2205.29,-1344.22"/>
<polygon fill="black" stroke="black" points="2205.34,-1347.73 2215.55,-1344.91 2205.81,-1340.74 2205.34,-1347.73"/>
<text text-anchor="middle" x="1850.7" y="-1451.28" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- expert_0 -->
<g id="node6" class="node">
<title>expert_0</title>
<polygon fill="lightblue" stroke="black" points="2885.44,-1776.48 2691.44,-1776.48 2691.44,-1724.48 2885.44,-1724.48 2885.44,-1776.48"/>
<text text-anchor="middle" x="2788.44" y="-1764.48" font-family="Arial" font-size="10.00">Expert MLP 0</text>
<text text-anchor="middle" x="2788.44" y="-1753.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2788.44" y="-1742.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2788.44" y="-1731.48" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual_add_0&#45;&gt;expert_0 -->
<g id="edge6" class="edge">
<title>residual_add_0&#45;&gt;expert_0</title>
<path fill="none" stroke="black" d="M2558.42,-1762.34C2602.05,-1760.08 2644.78,-1757.87 2681.29,-1755.98"/>
<polygon fill="black" stroke="black" points="2681.62,-1759.46 2691.42,-1755.45 2681.26,-1752.47 2681.62,-1759.46"/>
</g>
<!-- collect_res -->
<g id="node35" class="node">
<title>collect_res</title>
<polygon fill="lightgreen" stroke="black" points="3534.56,-675.48 3128.79,-675.48 3024.4,-571.48 3430.18,-571.48 3534.56,-675.48"/>
<text text-anchor="middle" x="3279.48" y="-637.48" font-family="Arial" font-size="10.00">Gather Results</text>
<text text-anchor="middle" x="3279.48" y="-626.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] from all GPUs</text>
<text text-anchor="middle" x="3279.48" y="-615.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="3279.48" y="-604.48" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
</g>
<!-- expert_0&#45;&gt;collect_res -->
<g id="edge51" class="edge">
<title>expert_0&#45;&gt;collect_res</title>
<path fill="none" stroke="black" d="M2800.81,-1724.28C2862.78,-1581.47 3160.38,-895.64 3251.75,-685.09"/>
<polygon fill="black" stroke="black" points="3255.04,-686.29 3255.81,-675.72 3248.62,-683.5 3255.04,-686.29"/>
<text text-anchor="middle" x="2954.94" y="-1481.28" font-family="Times,serif" font-size="14.00">from GPU 0</text>
</g>
<!-- gate_64 -->
<g id="node8" class="node">
<title>gate_64</title>
<polygon fill="lightgreen" stroke="black" points="1787.04,-800.48 1480.54,-800.48 1401.69,-696.48 1708.19,-696.48 1787.04,-800.48"/>
<text text-anchor="middle" x="1594.36" y="-762.48" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="1594.36" y="-751.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1594.36" y="-740.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1594.36" y="-729.48" font-family="Arial" font-size="10.00">GPU: 64</text>
</g>
<!-- mla_64&#45;&gt;gate_64 -->
<g id="edge8" class="edge">
<title>mla_64&#45;&gt;gate_64</title>
<path fill="none" stroke="black" d="M1307.6,-739.12C1344.59,-740.33 1386.64,-741.71 1426.89,-743.03"/>
<polygon fill="black" stroke="black" points="1426.97,-746.53 1437.08,-743.36 1427.2,-739.53 1426.97,-746.53"/>
</g>
<!-- gate_64&#45;&gt;residual_add_64 -->
<g id="edge9" class="edge">
<title>gate_64&#45;&gt;residual_add_64</title>
<path fill="none" stroke="black" d="M1747.62,-748.48C1815.93,-748.48 1899.08,-748.48 1979.28,-748.48"/>
<polygon fill="black" stroke="black" points="1979.56,-751.98 1989.56,-748.48 1979.56,-744.98 1979.56,-751.98"/>
</g>
<!-- comm_64_to_0 -->
<g id="node27" class="node">
<title>comm_64_to_0</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-1284.48" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2284.32" y="-1292.98" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2284.32" y="-1281.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-1270.98" font-family="Arial" font-size="10.00">→ GPU: 0</text>
</g>
<!-- gate_64&#45;&gt;comm_64_to_0 -->
<g id="edge31" class="edge">
<title>gate_64&#45;&gt;comm_64_to_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1609.64,-800.65C1635.86,-888.42 1698.94,-1067.29 1805.2,-1182.48 1892.68,-1277.31 2044.84,-1295.48 2154.03,-1294.6"/>
<polygon fill="black" stroke="black" points="2154.17,-1298.1 2164.13,-1294.47 2154.08,-1291.1 2154.17,-1298.1"/>
<text text-anchor="middle" x="1850.7" y="-1247.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- comm_64_to_128 -->
<g id="node28" class="node">
<title>comm_64_to_128</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-1208.48" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2284.32" y="-1216.98" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2284.32" y="-1205.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-1194.98" font-family="Arial" font-size="10.00">→ GPU: 128</text>
</g>
<!-- gate_64&#45;&gt;comm_64_to_128 -->
<g id="edge32" class="edge">
<title>gate_64&#45;&gt;comm_64_to_128</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1616.26,-800.62C1648.12,-875.1 1714.81,-1013.01 1805.2,-1104.48 1894.64,-1194.99 2043.11,-1215.18 2150.91,-1216.37"/>
<polygon fill="black" stroke="black" points="2151.19,-1219.87 2161.21,-1216.42 2151.23,-1212.87 2151.19,-1219.87"/>
<text text-anchor="middle" x="1850.7" y="-1167.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- comm_64_to_192 -->
<g id="node29" class="node">
<title>comm_64_to_192</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-1132.48" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2284.32" y="-1140.98" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2284.32" y="-1129.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-1118.98" font-family="Arial" font-size="10.00">→ GPU: 192</text>
</g>
<!-- gate_64&#45;&gt;comm_64_to_192 -->
<g id="edge33" class="edge">
<title>gate_64&#45;&gt;comm_64_to_192</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1621.35,-800.77C1666.83,-884.98 1769.95,-1046.11 1914.2,-1094.48 1988.28,-1119.32 2075.02,-1129.15 2145.79,-1132.62"/>
<polygon fill="black" stroke="black" points="2145.97,-1136.13 2156.12,-1133.09 2146.28,-1129.14 2145.97,-1136.13"/>
<text text-anchor="middle" x="1850.7" y="-1089.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- comm_64_to_255 -->
<g id="node30" class="node">
<title>comm_64_to_255</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-1056.48" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2284.32" y="-1064.98" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2284.32" y="-1053.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2284.32" y="-1042.98" font-family="Arial" font-size="10.00">→ GPU: 255</text>
</g>
<!-- gate_64&#45;&gt;comm_64_to_255 -->
<g id="edge34" class="edge">
<title>gate_64&#45;&gt;comm_64_to_255</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1636.87,-800.89C1676.39,-848.3 1739.44,-917.8 1805.2,-965.48 1904.34,-1037.36 2044.46,-1057.02 2147.39,-1060.55"/>
<polygon fill="black" stroke="black" points="2147.44,-1064.05 2157.54,-1060.85 2147.65,-1057.06 2147.44,-1064.05"/>
<text text-anchor="middle" x="1850.7" y="-1013.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_64&#45;&gt;async_0_64 -->
<g id="edge44" class="edge">
<title>gate_64&#45;&gt;async_0_64</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1604.6,-800.53C1624.75,-900.81 1681.16,-1123.2 1805.2,-1262.48 1906.42,-1376.13 2102.02,-1374.38 2208.99,-1363.38"/>
<polygon fill="black" stroke="black" points="2209.5,-1366.84 2219.06,-1362.29 2208.74,-1359.88 2209.5,-1366.84"/>
<text text-anchor="middle" x="1850.7" y="-1326.28" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- async_64_128 -->
<g id="node32" class="node">
<title>async_64_128</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-988.48" rx="80.72" ry="21.43"/>
<text text-anchor="middle" x="2284.32" y="-991.48" font-family="Arial" font-size="10.00">Async Transfer</text>
<text text-anchor="middle" x="2284.32" y="-980.48" font-family="Arial" font-size="10.00">GPU: 64 ↔ GPU: 128</text>
</g>
<!-- gate_64&#45;&gt;async_64_128 -->
<g id="edge45" class="edge">
<title>gate_64&#45;&gt;async_64_128</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1670.12,-800.55C1755.7,-859.71 1887.57,-949.3 1914.2,-958.48 2006.41,-990.25 2118.94,-994.9 2195.34,-993.42"/>
<polygon fill="black" stroke="black" points="2195.49,-996.92 2205.41,-993.18 2195.33,-989.92 2195.49,-996.92"/>
<text text-anchor="middle" x="1850.7" y="-952.28" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- expert_64 -->
<g id="node10" class="node">
<title>expert_64</title>
<polygon fill="lightblue" stroke="black" points="2885.44,-774.48 2691.44,-774.48 2691.44,-722.48 2885.44,-722.48 2885.44,-774.48"/>
<text text-anchor="middle" x="2788.44" y="-762.48" font-family="Arial" font-size="10.00">Expert MLP 64</text>
<text text-anchor="middle" x="2788.44" y="-751.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2788.44" y="-740.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2788.44" y="-729.48" font-family="Arial" font-size="10.00">GPU: 64</text>
</g>
<!-- residual_add_64&#45;&gt;expert_64 -->
<g id="edge11" class="edge">
<title>residual_add_64&#45;&gt;expert_64</title>
<path fill="none" stroke="black" d="M2578.86,-748.48C2615.2,-748.48 2650.33,-748.48 2681.06,-748.48"/>
<polygon fill="black" stroke="black" points="2681.31,-751.98 2691.31,-748.48 2681.31,-744.98 2681.31,-751.98"/>
</g>
<!-- expert_64&#45;&gt;collect_res -->
<g id="edge52" class="edge">
<title>expert_64&#45;&gt;collect_res</title>
<path fill="none" stroke="black" d="M2885.48,-723.93C2948.7,-707.77 3033.25,-686.16 3107.72,-667.13"/>
<polygon fill="black" stroke="black" points="3108.86,-670.45 3117.68,-664.58 3107.13,-663.66 3108.86,-670.45"/>
<text text-anchor="middle" x="2954.94" y="-721.28" font-family="Times,serif" font-size="14.00">from GPU 64</text>
</g>
<!-- gate_128 -->
<g id="node12" class="node">
<title>gate_128</title>
<polygon fill="lightgreen" stroke="black" points="1787.04,-649.48 1480.54,-649.48 1401.69,-545.48 1708.19,-545.48 1787.04,-649.48"/>
<text text-anchor="middle" x="1594.36" y="-611.48" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="1594.36" y="-600.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1594.36" y="-589.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1594.36" y="-578.48" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- mla_128&#45;&gt;gate_128 -->
<g id="edge13" class="edge">
<title>mla_128&#45;&gt;gate_128</title>
<path fill="none" stroke="black" d="M1307.6,-588.12C1344.59,-589.33 1386.64,-590.71 1426.89,-592.03"/>
<polygon fill="black" stroke="black" points="1426.97,-595.53 1437.08,-592.36 1427.2,-588.53 1426.97,-595.53"/>
</g>
<!-- gate_128&#45;&gt;residual_add_128 -->
<g id="edge14" class="edge">
<title>gate_128&#45;&gt;residual_add_128</title>
<path fill="none" stroke="black" d="M1747.62,-597.48C1815.93,-597.48 1899.08,-597.48 1979.28,-597.48"/>
<polygon fill="black" stroke="black" points="1979.56,-600.98 1989.56,-597.48 1979.56,-593.98 1979.56,-600.98"/>
</g>
<!-- gate_128&#45;&gt;async_64_128 -->
<g id="edge46" class="edge">
<title>gate_128&#45;&gt;async_64_128</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1737.96,-649.62C1755.65,-659.59 1772.62,-671.16 1787.2,-684.48 1859.65,-750.65 1861.06,-784.86 1896.2,-876.48 1909.56,-911.32 1886.1,-933.94 1914.2,-958.48 1996.71,-1030.54 2132.91,-1019.97 2214.78,-1004.83"/>
<polygon fill="black" stroke="black" points="2215.57,-1008.25 2224.73,-1002.92 2214.25,-1001.37 2215.57,-1008.25"/>
<text text-anchor="middle" x="1850.7" y="-880.28" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- async_128_192 -->
<g id="node33" class="node">
<title>async_128_192</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-928.48" rx="84.29" ry="21.43"/>
<text text-anchor="middle" x="2284.32" y="-931.48" font-family="Arial" font-size="10.00">Async Transfer</text>
<text text-anchor="middle" x="2284.32" y="-920.48" font-family="Arial" font-size="10.00">GPU: 128 ↔ GPU: 192</text>
</g>
<!-- gate_128&#45;&gt;async_128_192 -->
<g id="edge47" class="edge">
<title>gate_128&#45;&gt;async_128_192</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1752.7,-603.91C1819.84,-608.25 1885.35,-615.3 1896.2,-626.48 1938.39,-669.95 1871.69,-855.32 1914.2,-898.48 1951.62,-936.47 2095.53,-937.82 2192.21,-934.07"/>
<polygon fill="black" stroke="black" points="2192.44,-937.56 2202.29,-933.65 2192.15,-930.57 2192.44,-937.56"/>
<text text-anchor="middle" x="1850.7" y="-630.28" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- expert_128 -->
<g id="node14" class="node">
<title>expert_128</title>
<polygon fill="lightblue" stroke="black" points="2885.44,-649.48 2691.44,-649.48 2691.44,-597.48 2885.44,-597.48 2885.44,-649.48"/>
<text text-anchor="middle" x="2788.44" y="-637.48" font-family="Arial" font-size="10.00">Expert MLP 128</text>
<text text-anchor="middle" x="2788.44" y="-626.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2788.44" y="-615.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2788.44" y="-604.48" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- residual_add_128&#45;&gt;expert_128 -->
<g id="edge16" class="edge">
<title>residual_add_128&#45;&gt;expert_128</title>
<path fill="none" stroke="black" d="M2602.97,-613.93C2630.77,-615.37 2657.39,-616.75 2681.34,-617.99"/>
<polygon fill="black" stroke="black" points="2681.27,-621.49 2691.44,-618.51 2681.64,-614.5 2681.27,-621.49"/>
</g>
<!-- expert_128&#45;&gt;collect_res -->
<g id="edge53" class="edge">
<title>expert_128&#45;&gt;collect_res</title>
<path fill="none" stroke="black" d="M2885.48,-623.48C2937.23,-623.48 3003.26,-623.48 3066.37,-623.48"/>
<polygon fill="black" stroke="black" points="3066.47,-626.98 3076.47,-623.48 3066.47,-619.98 3066.47,-626.98"/>
<text text-anchor="middle" x="2954.94" y="-627.28" font-family="Times,serif" font-size="14.00">from GPU 128</text>
</g>
<!-- gate_192 -->
<g id="node16" class="node">
<title>gate_192</title>
<polygon fill="lightgreen" stroke="black" points="1787.04,-498.48 1480.54,-498.48 1401.69,-394.48 1708.19,-394.48 1787.04,-498.48"/>
<text text-anchor="middle" x="1594.36" y="-460.48" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="1594.36" y="-449.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1594.36" y="-438.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1594.36" y="-427.48" font-family="Arial" font-size="10.00">GPU: 192</text>
</g>
<!-- mla_192&#45;&gt;gate_192 -->
<g id="edge18" class="edge">
<title>mla_192&#45;&gt;gate_192</title>
<path fill="none" stroke="black" d="M1307.6,-437.12C1344.59,-438.33 1386.64,-439.71 1426.89,-441.03"/>
<polygon fill="black" stroke="black" points="1426.97,-444.53 1437.08,-441.36 1427.2,-437.53 1426.97,-444.53"/>
</g>
<!-- gate_192&#45;&gt;residual_add_192 -->
<g id="edge19" class="edge">
<title>gate_192&#45;&gt;residual_add_192</title>
<path fill="none" stroke="black" d="M1747.62,-446.48C1815.93,-446.48 1899.08,-446.48 1979.28,-446.48"/>
<polygon fill="black" stroke="black" points="1979.56,-449.98 1989.56,-446.48 1979.56,-442.98 1979.56,-449.98"/>
</g>
<!-- gate_192&#45;&gt;async_128_192 -->
<g id="edge48" class="edge">
<title>gate_192&#45;&gt;async_128_192</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1777.39,-485.54C1838.06,-499.4 1891.61,-512.93 1896.2,-518.48 1923.16,-551.04 1884.82,-868.09 1914.2,-898.48 1951.32,-936.87 2095.69,-938.07 2192.5,-934.18"/>
<polygon fill="black" stroke="black" points="2192.75,-937.67 2202.59,-933.75 2192.45,-930.68 2192.75,-937.67"/>
<text text-anchor="middle" x="1850.7" y="-522.28" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- async_192_255 -->
<g id="node34" class="node">
<title>async_192_255</title>
<ellipse fill="lightyellow" stroke="black" cx="2284.32" cy="-868.48" rx="84.29" ry="21.43"/>
<text text-anchor="middle" x="2284.32" y="-871.48" font-family="Arial" font-size="10.00">Async Transfer</text>
<text text-anchor="middle" x="2284.32" y="-860.48" font-family="Arial" font-size="10.00">GPU: 192 ↔ GPU: 255</text>
</g>
<!-- gate_192&#45;&gt;async_192_255 -->
<g id="edge49" class="edge">
<title>gate_192&#45;&gt;async_192_255</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1752.78,-452.83C1819.93,-457.16 1885.44,-464.21 1896.2,-475.48 1923.86,-504.44 1886.44,-806.61 1914.2,-835.48 1991.12,-915.48 2131.96,-902.65 2215.66,-885.77"/>
<polygon fill="black" stroke="black" points="2216.51,-889.17 2225.58,-883.7 2215.07,-882.32 2216.51,-889.17"/>
<text text-anchor="middle" x="1850.7" y="-479.28" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- expert_192 -->
<g id="node18" class="node">
<title>expert_192</title>
<polygon fill="lightblue" stroke="black" points="2885.44,-498.48 2691.44,-498.48 2691.44,-446.48 2885.44,-446.48 2885.44,-498.48"/>
<text text-anchor="middle" x="2788.44" y="-486.48" font-family="Arial" font-size="10.00">Expert MLP 192</text>
<text text-anchor="middle" x="2788.44" y="-475.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2788.44" y="-464.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2788.44" y="-453.48" font-family="Arial" font-size="10.00">GPU: 192</text>
</g>
<!-- residual_add_192&#45;&gt;expert_192 -->
<g id="edge21" class="edge">
<title>residual_add_192&#45;&gt;expert_192</title>
<path fill="none" stroke="black" d="M2602.97,-462.93C2630.77,-464.37 2657.39,-465.75 2681.34,-466.99"/>
<polygon fill="black" stroke="black" points="2681.27,-470.49 2691.44,-467.51 2681.64,-463.5 2681.27,-470.49"/>
</g>
<!-- expert_192&#45;&gt;collect_res -->
<g id="edge54" class="edge">
<title>expert_192&#45;&gt;collect_res</title>
<path fill="none" stroke="black" d="M2873.79,-498.52C2935.96,-517.72 3022.79,-544.53 3100.08,-568.4"/>
<polygon fill="black" stroke="black" points="3099.36,-571.83 3109.95,-571.44 3101.42,-565.15 3099.36,-571.83"/>
<text text-anchor="middle" x="2954.94" y="-542.28" font-family="Times,serif" font-size="14.00">from GPU 192</text>
</g>
<!-- gate_255 -->
<g id="node20" class="node">
<title>gate_255</title>
<polygon fill="lightgreen" stroke="black" points="1787.04,-347.48 1480.54,-347.48 1401.69,-243.48 1708.19,-243.48 1787.04,-347.48"/>
<text text-anchor="middle" x="1594.36" y="-309.48" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="1594.36" y="-298.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1594.36" y="-287.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1594.36" y="-276.48" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- mla_255&#45;&gt;gate_255 -->
<g id="edge23" class="edge">
<title>mla_255&#45;&gt;gate_255</title>
<path fill="none" stroke="black" d="M1307.6,-286.12C1344.59,-287.33 1386.64,-288.71 1426.89,-290.03"/>
<polygon fill="black" stroke="black" points="1426.97,-293.53 1437.08,-290.36 1427.2,-286.53 1426.97,-293.53"/>
</g>
<!-- gate_255&#45;&gt;residual_add_255 -->
<g id="edge24" class="edge">
<title>gate_255&#45;&gt;residual_add_255</title>
<path fill="none" stroke="black" d="M1747.62,-295.48C1815.93,-295.48 1899.08,-295.48 1979.28,-295.48"/>
<polygon fill="black" stroke="black" points="1979.56,-298.98 1989.56,-295.48 1979.56,-291.98 1979.56,-298.98"/>
</g>
<!-- gate_255&#45;&gt;async_192_255 -->
<g id="edge50" class="edge">
<title>gate_255&#45;&gt;async_192_255</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1747.77,-295.46C1802.85,-303.75 1860.26,-323.68 1896.2,-367.48 1929.21,-407.71 1878.35,-797.76 1914.2,-835.48 1950.96,-874.16 2095.06,-876.57 2191.96,-873.47"/>
<polygon fill="black" stroke="black" points="2192.19,-876.96 2202.07,-873.12 2191.95,-869.97 2192.19,-876.96"/>
<text text-anchor="middle" x="1850.7" y="-371.28" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- expert_255 -->
<g id="node22" class="node">
<title>expert_255</title>
<polygon fill="lightblue" stroke="black" points="2885.44,-347.48 2691.44,-347.48 2691.44,-295.48 2885.44,-295.48 2885.44,-347.48"/>
<text text-anchor="middle" x="2788.44" y="-335.48" font-family="Arial" font-size="10.00">Expert MLP 255</text>
<text text-anchor="middle" x="2788.44" y="-324.48" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2788.44" y="-313.48" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2788.44" y="-302.48" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- residual_add_255&#45;&gt;expert_255 -->
<g id="edge26" class="edge">
<title>residual_add_255&#45;&gt;expert_255</title>
<path fill="none" stroke="black" d="M2602.97,-311.93C2630.77,-313.37 2657.39,-314.75 2681.34,-315.99"/>
<polygon fill="black" stroke="black" points="2681.27,-319.49 2691.44,-316.51 2681.64,-312.5 2681.27,-319.49"/>
</g>
<!-- expert_255&#45;&gt;collect_res -->
<g id="edge55" class="edge">
<title>expert_255&#45;&gt;collect_res</title>
<path fill="none" stroke="black" d="M2834.66,-347.62C2852.98,-358.31 2874.29,-370.87 2893.44,-382.48 2994.91,-443.97 3110.1,-516.43 3187.84,-565.72"/>
<polygon fill="black" stroke="black" points="3186.34,-568.91 3196.66,-571.31 3190.09,-563 3186.34,-568.91"/>
<text text-anchor="middle" x="2954.94" y="-451.28" font-family="Times,serif" font-size="14.00">from GPU 255</text>
</g>
<!-- comm_0_to_64&#45;&gt;expert_64 -->
<g id="edge35" class="edge">
<title>comm_0_to_64&#45;&gt;expert_64</title>
<path fill="none" stroke="black" d="M2380.18,-1667.74C2463.57,-1678.7 2582.54,-1678.84 2654.44,-1610.48 2775.96,-1494.95 2786.76,-934.23 2787.47,-785.01"/>
<polygon fill="black" stroke="black" points="2790.97,-784.61 2787.5,-774.6 2783.97,-784.59 2790.97,-784.61"/>
</g>
<!-- comm_0_to_128&#45;&gt;expert_128 -->
<g id="edge36" class="edge">
<title>comm_0_to_128&#45;&gt;expert_128</title>
<path fill="none" stroke="black" d="M2377.33,-1592.41C2461.73,-1604.75 2584,-1606.61 2654.44,-1534.48 2720.49,-1466.85 2644.71,-766.65 2691.44,-684.48 2697.98,-672.99 2707.66,-663.34 2718.39,-655.35"/>
<polygon fill="black" stroke="black" points="2720.53,-658.12 2726.77,-649.56 2716.55,-652.36 2720.53,-658.12"/>
</g>
<!-- comm_0_to_192&#45;&gt;expert_192 -->
<g id="edge37" class="edge">
<title>comm_0_to_192&#45;&gt;expert_192</title>
<path fill="none" stroke="black" d="M2376.9,-1516.65C2461.59,-1529.36 2584.6,-1531.64 2654.44,-1458.48 2725.47,-1384.08 2640.54,-622.86 2691.44,-533.48 2697.98,-521.99 2707.67,-512.34 2718.4,-504.35"/>
<polygon fill="black" stroke="black" points="2720.54,-507.13 2726.78,-498.57 2716.57,-501.37 2720.54,-507.13"/>
</g>
<!-- comm_0_to_255&#45;&gt;expert_255 -->
<g id="edge38" class="edge">
<title>comm_0_to_255&#45;&gt;expert_255</title>
<path fill="none" stroke="black" d="M2376.27,-1440.7C2461.12,-1453.63 2584.78,-1456.25 2654.44,-1382.48 2692.61,-1342.06 2663.92,-430.78 2691.44,-382.48 2697.98,-370.99 2707.67,-361.35 2718.41,-353.36"/>
<polygon fill="black" stroke="black" points="2720.55,-356.13 2726.79,-347.57 2716.57,-350.37 2720.55,-356.13"/>
</g>
<!-- comm_64_to_0&#45;&gt;expert_0 -->
<g id="edge39" class="edge">
<title>comm_64_to_0&#45;&gt;expert_0</title>
<path fill="none" stroke="black" d="M2386.35,-1266.94C2467.69,-1258.78 2580.29,-1261.77 2654.44,-1322.48 2775.83,-1421.86 2788.51,-1630.19 2788.42,-1714.21"/>
<polygon fill="black" stroke="black" points="2784.92,-1714.26 2788.34,-1724.29 2791.92,-1714.31 2784.92,-1714.26"/>
</g>
<!-- comm_64_to_128&#45;&gt;expert_128 -->
<g id="edge40" class="edge">
<title>comm_64_to_128&#45;&gt;expert_128</title>
<path fill="none" stroke="black" d="M2381.68,-1227.43C2464.61,-1237.75 2582.02,-1237.1 2654.44,-1170.48 2734.15,-1097.15 2637.08,-778.16 2691.44,-684.48 2698.11,-672.98 2707.92,-663.31 2718.74,-655.3"/>
<polygon fill="black" stroke="black" points="2720.93,-658.04 2727.19,-649.5 2716.96,-652.28 2720.93,-658.04"/>
</g>
<!-- comm_64_to_192&#45;&gt;expert_192 -->
<g id="edge41" class="edge">
<title>comm_64_to_192&#45;&gt;expert_192</title>
<path fill="none" stroke="black" d="M2380.25,-1151.82C2463.69,-1162.83 2582.7,-1163 2654.44,-1094.48 2699.62,-1051.33 2660.23,-587.59 2691.44,-533.48 2698.04,-522.03 2707.76,-512.4 2718.5,-504.41"/>
<polygon fill="black" stroke="black" points="2720.65,-507.19 2726.89,-498.63 2716.67,-501.43 2720.65,-507.19"/>
</g>
<!-- comm_64_to_255&#45;&gt;expert_255 -->
<g id="edge42" class="edge">
<title>comm_64_to_255&#45;&gt;expert_255</title>
<path fill="none" stroke="black" d="M2376.87,-1076.62C2461.54,-1089.3 2584.53,-1091.57 2654.44,-1018.48 2703.37,-967.33 2655.57,-443.5 2691.44,-382.48 2698.18,-371.02 2708.01,-361.36 2718.85,-353.36"/>
<polygon fill="black" stroke="black" points="2721.04,-356.11 2727.3,-347.56 2717.07,-350.34 2721.04,-356.11"/>
</g>
<!-- final_out -->
<g id="node36" class="node">
<title>final_out</title>
<polygon fill="lightgray" stroke="black" points="3720.41,-594.56 3728.75,-594.71 3737,-594.95 3745.14,-595.27 3753.12,-595.66 3760.91,-596.13 3768.49,-596.68 3775.82,-597.29 3782.88,-597.98 3789.64,-598.74 3796.08,-599.57 3802.17,-600.46 3807.9,-601.42 3813.24,-602.43 3818.18,-603.51 3822.71,-604.64 3826.81,-605.82 3830.48,-607.05 3833.71,-608.32 3836.49,-609.64 3838.83,-610.99 3840.72,-612.38 3842.17,-613.79 3843.18,-615.24 3843.76,-616.71 3843.92,-618.19 3843.66,-619.69 3843,-621.2 3841.95,-622.72 3840.53,-624.24 3838.76,-625.76 3836.64,-627.27 3834.19,-628.77 3831.44,-630.25 3828.41,-631.72 3825.1,-633.16 3821.54,-634.58 3817.75,-635.97 3813.74,-637.32 3809.54,-638.64 3805.15,-639.91 3800.61,-641.14 3795.91,-642.32 3791.09,-643.45 3786.15,-644.52 3781.11,-645.54 3775.97,-646.5 3770.76,-647.39 3765.47,-648.22 3760.13,-648.98 3754.74,-649.67 3749.31,-650.28 3743.84,-650.83 3738.34,-651.3 3732.82,-651.69 3727.28,-652.01 3721.73,-652.24 3716.17,-652.4 3710.6,-652.48 3705.04,-652.48 3699.47,-652.4 3693.91,-652.24 3688.36,-652.01 3682.82,-651.69 3677.3,-651.3 3671.8,-650.83 3666.34,-650.28 3660.9,-649.67 3655.51,-648.98 3650.17,-648.22 3644.89,-647.39 3639.67,-646.5 3634.54,-645.54 3629.49,-644.52 3624.55,-643.45 3619.73,-642.32 3615.03,-641.14 3610.49,-639.91 3606.11,-638.64 3601.9,-637.32 3597.9,-635.97 3594.1,-634.58 3590.54,-633.16 3587.24,-631.72 3584.2,-630.25 3581.45,-628.77 3579,-627.27 3576.89,-625.76 3575.11,-624.24 3573.69,-622.72 3572.64,-621.2 3571.98,-619.69 3571.73,-618.19 3571.88,-616.71 3572.46,-615.24 3573.47,-613.79 3574.92,-612.38 3576.81,-610.99 3579.15,-609.64 3581.93,-608.32 3585.16,-607.05 3588.83,-605.82 3592.93,-604.64 3597.46,-603.51 3602.4,-602.43 3607.74,-601.42 3613.47,-600.46 3619.56,-599.57 3626,-598.74 3632.76,-597.98 3639.82,-597.29 3647.15,-596.68 3654.73,-596.13 3662.53,-595.66 3670.51,-595.27 3678.64,-594.95 3686.89,-594.71 3695.23,-594.56 3703.62,-594.48 3712.02,-594.48 3720.41,-594.56"/>
<text text-anchor="middle" x="3707.82" y="-631.98" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="3707.82" y="-620.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="3707.82" y="-609.98" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- collect_res&#45;&gt;final_out -->
<g id="edge56" class="edge">
<title>collect_res&#45;&gt;final_out</title>
<path fill="none" stroke="black" d="M3482.41,-623.48C3509.97,-623.48 3537.77,-623.48 3563.97,-623.48"/>
<polygon fill="black" stroke="black" points="3564.32,-626.98 3574.32,-623.48 3564.32,-619.98 3564.32,-626.98"/>
</g>
</g>
</svg>
