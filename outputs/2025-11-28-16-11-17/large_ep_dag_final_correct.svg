<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="7287pt" height="558pt"
 viewBox="0.00 0.00 7286.95 557.62" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 553.62)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-553.62 7282.95,-553.62 7282.95,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="none" stroke="black" d="M20,-232.62C20,-232.62 902.53,-232.62 902.53,-232.62 908.53,-232.62 914.53,-238.62 914.53,-244.62 914.53,-244.62 914.53,-341.62 914.53,-341.62 914.53,-347.62 908.53,-353.62 902.53,-353.62 902.53,-353.62 20,-353.62 20,-353.62 14,-353.62 8,-347.62 8,-341.62 8,-341.62 8,-244.62 8,-244.62 8,-238.62 14,-232.62 20,-232.62"/>
<text text-anchor="middle" x="461.26" y="-338.42" font-family="Times,serif" font-size="14.00">Input Distribution Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1</title>
<path fill="none" stroke="black" d="M1069.53,-12.62C1069.53,-12.62 3021.44,-12.62 3021.44,-12.62 3027.44,-12.62 3033.44,-18.62 3033.44,-24.62 3033.44,-24.62 3033.44,-143.62 3033.44,-143.62 3033.44,-149.62 3027.44,-155.62 3021.44,-155.62 3021.44,-155.62 1069.53,-155.62 1069.53,-155.62 1063.53,-155.62 1057.53,-149.62 1057.53,-143.62 1057.53,-143.62 1057.53,-24.62 1057.53,-24.62 1057.53,-18.62 1063.53,-12.62 1069.53,-12.62"/>
<text text-anchor="middle" x="2045.48" y="-140.42" font-family="Times,serif" font-size="14.00">Layer 1: GPU 0 Processing</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="black" d="M2145.33,-319.62C2145.33,-319.62 4731.36,-319.62 4731.36,-319.62 4737.36,-319.62 4743.36,-325.62 4743.36,-331.62 4743.36,-331.62 4743.36,-450.62 4743.36,-450.62 4743.36,-456.62 4737.36,-462.62 4731.36,-462.62 4731.36,-462.62 2145.33,-462.62 2145.33,-462.62 2139.33,-462.62 2133.33,-456.62 2133.33,-450.62 2133.33,-450.62 2133.33,-331.62 2133.33,-331.62 2133.33,-325.62 2139.33,-319.62 2145.33,-319.62"/>
<text text-anchor="middle" x="3438.34" y="-447.42" font-family="Times,serif" font-size="14.00">Layer 2: GPU 128 Cross&#45;Node Processing</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="black" d="M3896.25,-108.62C3896.25,-108.62 6300.27,-108.62 6300.27,-108.62 6306.27,-108.62 6312.27,-114.62 6312.27,-120.62 6312.27,-120.62 6312.27,-299.62 6312.27,-299.62 6312.27,-305.62 6306.27,-311.62 6300.27,-311.62 6300.27,-311.62 3896.25,-311.62 3896.25,-311.62 3890.25,-311.62 3884.25,-305.62 3884.25,-299.62 3884.25,-299.62 3884.25,-120.62 3884.25,-120.62 3884.25,-114.62 3890.25,-108.62 3896.25,-108.62"/>
<text text-anchor="middle" x="5098.26" y="-296.42" font-family="Times,serif" font-size="14.00">Layer 3: GPU 255 Final Processing</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_output</title>
<path fill="none" stroke="black" d="M6447.27,-108.62C6447.27,-108.62 7258.95,-108.62 7258.95,-108.62 7264.95,-108.62 7270.95,-114.62 7270.95,-120.62 7270.95,-120.62 7270.95,-239.62 7270.95,-239.62 7270.95,-245.62 7264.95,-251.62 7258.95,-251.62 7258.95,-251.62 6447.27,-251.62 6447.27,-251.62 6441.27,-251.62 6435.27,-245.62 6435.27,-239.62 6435.27,-239.62 6435.27,-120.62 6435.27,-120.62 6435.27,-114.62 6441.27,-108.62 6447.27,-108.62"/>
<text text-anchor="middle" x="6853.11" y="-236.42" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
</g>
<!-- input_tokens -->
<g id="node1" class="node">
<title>input_tokens</title>
<polygon fill="lightgray" stroke="black" points="124.59,-252.7 130.67,-252.86 136.69,-253.1 142.63,-253.41 148.45,-253.81 154.13,-254.27 159.66,-254.82 165.01,-255.44 170.17,-256.13 175.1,-256.89 179.8,-257.71 184.24,-258.61 188.42,-259.56 192.32,-260.58 195.92,-261.65 199.22,-262.78 202.22,-263.96 204.89,-265.19 207.25,-266.46 209.28,-267.78 210.99,-269.13 212.37,-270.52 213.42,-271.94 214.16,-273.38 214.58,-274.85 214.7,-276.34 214.51,-277.84 214.03,-279.35 213.27,-280.86 212.23,-282.38 210.93,-283.9 209.39,-285.41 207.6,-286.91 205.6,-288.4 203.38,-289.86 200.97,-291.31 198.37,-292.73 195.6,-294.11 192.68,-295.47 189.61,-296.78 186.42,-298.06 183.1,-299.28 179.67,-300.47 176.15,-301.59 172.55,-302.67 168.87,-303.68 165.12,-304.64 161.32,-305.53 157.46,-306.36 153.57,-307.12 149.63,-307.81 145.67,-308.43 141.68,-308.97 137.67,-309.44 133.64,-309.83 129.6,-310.15 125.55,-310.39 121.49,-310.55 117.43,-310.63 113.37,-310.63 109.31,-310.55 105.25,-310.39 101.2,-310.15 97.16,-309.83 93.13,-309.44 89.12,-308.97 85.13,-308.43 81.17,-307.81 77.23,-307.12 73.34,-306.36 69.48,-305.53 65.68,-304.64 61.93,-303.68 58.25,-302.67 54.64,-301.59 51.12,-300.47 47.7,-299.28 44.38,-298.06 41.19,-296.78 38.12,-295.47 35.19,-294.11 32.43,-292.73 29.83,-291.31 27.42,-289.86 25.2,-288.4 23.19,-286.91 21.41,-285.41 19.87,-283.9 18.57,-282.38 17.53,-280.86 16.77,-279.35 16.29,-277.84 16.1,-276.34 16.21,-274.85 16.64,-273.38 17.37,-271.94 18.43,-270.52 19.81,-269.13 21.52,-267.78 23.55,-266.46 25.9,-265.19 28.58,-263.96 31.57,-262.78 34.88,-261.65 38.48,-260.58 42.38,-259.56 46.56,-258.61 51,-257.71 55.7,-256.89 60.63,-256.13 65.78,-255.44 71.13,-254.82 76.66,-254.27 82.35,-253.81 88.17,-253.41 94.11,-253.1 100.13,-252.86 106.21,-252.7 112.33,-252.62 118.47,-252.62 124.59,-252.7"/>
<text text-anchor="middle" x="115.4" y="-290.12" font-family="Arial" font-size="10.00">Input Tokens</text>
<text text-anchor="middle" x="115.4" y="-279.12" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?]</text>
<text text-anchor="middle" x="115.4" y="-268.12" font-family="Arial" font-size="10.00">GPU: N/A</text>
</g>
<!-- token_split -->
<g id="node2" class="node">
<title>token_split</title>
<polygon fill="lightgreen" stroke="black" points="906.39,-322.62 441.52,-322.62 321.93,-240.62 786.8,-240.62 906.39,-322.62"/>
<text text-anchor="middle" x="614.16" y="-290.12" font-family="Arial" font-size="10.00">Token Split</text>
<text text-anchor="middle" x="614.16" y="-279.12" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?] → [batch_size=?, seq_len=?/256]</text>
<text text-anchor="middle" x="614.16" y="-268.12" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
</g>
<!-- input_tokens&#45;&gt;token_split -->
<g id="edge1" class="edge">
<title>input_tokens&#45;&gt;token_split</title>
<path fill="none" stroke="black" d="M212.77,-281.62C258.42,-281.62 315.2,-281.62 371.51,-281.62"/>
<polygon fill="black" stroke="black" points="371.65,-285.12 381.65,-281.62 371.65,-278.12 371.65,-285.12"/>
<text text-anchor="middle" x="268.3" y="-285.42" font-family="Times,serif" font-size="14.00">broadcast</text>
</g>
<!-- mla_0 -->
<g id="node3" class="node">
<title>mla_0</title>
<polygon fill="lightblue" stroke="black" points="1289.53,-117.62 1065.53,-117.62 1065.53,-65.62 1289.53,-65.62 1289.53,-117.62"/>
<text text-anchor="middle" x="1177.53" y="-105.62" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="1177.53" y="-94.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="1177.53" y="-83.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1177.53" y="-72.62" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- token_split&#45;&gt;mla_0 -->
<g id="edge2" class="edge">
<title>token_split&#45;&gt;mla_0</title>
<path fill="none" stroke="black" d="M695.41,-240.5C756.82,-210.42 844.31,-170.5 924.53,-144.62 966.48,-131.09 1013.49,-120.12 1055.45,-111.74"/>
<polygon fill="black" stroke="black" points="1056.3,-115.14 1065.44,-109.78 1054.95,-108.27 1056.3,-115.14"/>
<text text-anchor="middle" x="986.03" y="-148.42" font-family="Times,serif" font-size="14.00">tokens for GPU 0</text>
</g>
<!-- residual_add_0 -->
<g id="node5" class="node">
<title>residual_add_0</title>
<polygon fill="lightgreen" stroke="black" points="2639.56,-124.62 2050.59,-124.62 1899.08,-20.62 2488.05,-20.62 2639.56,-124.62"/>
<text text-anchor="middle" x="2269.32" y="-86.62" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2269.32" y="-75.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2269.32" y="-64.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2269.32" y="-53.62" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- token_split&#45;&gt;residual_add_0 -->
<g id="edge5" class="edge">
<title>token_split&#45;&gt;residual_add_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M675.12,-240.41C757.16,-186.61 910.99,-94.81 1057.53,-56.62 1340.57,17.14 1673.6,6 1918.67,-19.55"/>
<polygon fill="black" stroke="black" points="1918.5,-23.05 1928.81,-20.62 1919.23,-16.09 1918.5,-23.05"/>
<text text-anchor="middle" x="1336.53" y="-15.42" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mla_128 -->
<g id="node7" class="node">
<title>mla_128</title>
<polygon fill="lightblue" stroke="black" points="3040.44,-405.62 2816.44,-405.62 2816.44,-353.62 3040.44,-353.62 3040.44,-405.62"/>
<text text-anchor="middle" x="2928.44" y="-393.62" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="2928.44" y="-382.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="2928.44" y="-371.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2928.44" y="-360.62" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- token_split&#45;&gt;mla_128 -->
<g id="edge7" class="edge">
<title>token_split&#45;&gt;mla_128</title>
<path fill="none" stroke="black" d="M723.11,-322.67C834.86,-361.41 1015.34,-413.62 1176.53,-413.62 1176.53,-413.62 1176.53,-413.62 2270.32,-413.62 2505.21,-413.62 2564.18,-410.75 2798.44,-393.62 2801,-393.44 2803.58,-393.24 2806.18,-393.03"/>
<polygon fill="black" stroke="black" points="2806.63,-396.51 2816.31,-392.18 2806.05,-389.53 2806.63,-396.51"/>
<text text-anchor="middle" x="1576.36" y="-417.42" font-family="Times,serif" font-size="14.00">tokens for GPU 128</text>
</g>
<!-- residual_add_128 -->
<g id="node9" class="node">
<title>residual_add_128</title>
<polygon fill="lightgreen" stroke="black" points="4390.48,-431.62 3801.5,-431.62 3649.99,-327.62 4238.96,-327.62 4390.48,-431.62"/>
<text text-anchor="middle" x="4020.23" y="-393.62" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="4020.23" y="-382.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="4020.23" y="-371.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="4020.23" y="-360.62" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- token_split&#45;&gt;residual_add_128 -->
<g id="edge10" class="edge">
<title>token_split&#45;&gt;residual_add_128</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M657.62,-322.67C713.7,-374.19 817.89,-460.86 924.53,-502.62 1029.65,-543.8 1063.63,-534.62 1176.53,-534.62 1176.53,-534.62 1176.53,-534.62 3328.28,-534.62 3516.17,-534.62 3725.98,-479.38 3864.57,-434.85"/>
<polygon fill="black" stroke="black" points="3865.99,-438.07 3874.43,-431.67 3863.84,-431.41 3865.99,-438.07"/>
<text text-anchor="middle" x="2269.32" y="-538.42" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mla_255 -->
<g id="node12" class="node">
<title>mla_255</title>
<polygon fill="lightblue" stroke="black" points="4750.36,-268.62 4526.36,-268.62 4526.36,-216.62 4750.36,-216.62 4750.36,-268.62"/>
<text text-anchor="middle" x="4638.36" y="-256.62" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="4638.36" y="-245.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="4638.36" y="-234.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="4638.36" y="-223.62" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- token_split&#45;&gt;mla_255 -->
<g id="edge14" class="edge">
<title>token_split&#45;&gt;mla_255</title>
<path fill="none" stroke="black" d="M680.12,-322.77C781.82,-383.13 986.7,-488.62 1176.53,-488.62 1176.53,-488.62 1176.53,-488.62 2270.32,-488.62 2409.21,-488.62 3394.38,-525.63 3520.11,-466.62 3540.15,-457.22 3630.21,-325.32 3650.11,-315.62 3724.13,-279.54 4308.42,-288.84 4390.36,-280.62 4431.45,-276.5 4476.13,-270.19 4516.05,-263.89"/>
<polygon fill="black" stroke="black" points="4516.76,-267.32 4526.09,-262.29 4515.66,-260.41 4516.76,-267.32"/>
<text text-anchor="middle" x="2727.94" y="-502.42" font-family="Times,serif" font-size="14.00">tokens for GPU 255</text>
</g>
<!-- residual_add_255 -->
<g id="node14" class="node">
<title>residual_add_255</title>
<polygon fill="lightgreen" stroke="black" points="6073.39,-220.62 5484.42,-220.62 5332.91,-116.62 5921.88,-116.62 6073.39,-220.62"/>
<text text-anchor="middle" x="5703.15" y="-182.62" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="5703.15" y="-171.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="5703.15" y="-160.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="5703.15" y="-149.62" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- token_split&#45;&gt;residual_add_255 -->
<g id="edge17" class="edge">
<title>token_split&#45;&gt;residual_add_255</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M750.74,-240.56C863.58,-210.03 1029.02,-173.62 1176.53,-173.62 1176.53,-173.62 1176.53,-173.62 2728.94,-173.62 3138.55,-173.62 3240.59,-153.17 3650.11,-144.62 4039.49,-136.5 4136.9,-137.62 4526.36,-135.62 4851.09,-133.96 4932.51,-123.61 5257.03,-135.62 5289.98,-136.84 5324.27,-138.57 5358.55,-140.6"/>
<polygon fill="black" stroke="black" points="5358.51,-144.1 5368.7,-141.21 5358.93,-137.12 5358.51,-144.1"/>
<text text-anchor="middle" x="3087.44" y="-171.42" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_0 -->
<g id="node4" class="node">
<title>gate_0</title>
<polygon fill="lightgreen" stroke="black" points="1769.04,-124.62 1462.54,-124.62 1383.69,-20.62 1690.19,-20.62 1769.04,-124.62"/>
<text text-anchor="middle" x="1576.36" y="-86.62" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="1576.36" y="-75.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1576.36" y="-64.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1576.36" y="-53.62" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- mla_0&#45;&gt;gate_0 -->
<g id="edge3" class="edge">
<title>mla_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M1289.6,-86.31C1329.48,-84.4 1375.25,-82.2 1418.3,-80.14"/>
<polygon fill="black" stroke="black" points="1418.49,-83.64 1428.31,-79.66 1418.15,-76.65 1418.49,-83.64"/>
</g>
<!-- gate_0&#45;&gt;residual_add_0 -->
<g id="edge4" class="edge">
<title>gate_0&#45;&gt;residual_add_0</title>
<path fill="none" stroke="black" d="M1729.85,-72.62C1798.93,-72.62 1883.16,-72.62 1964.3,-72.62"/>
<polygon fill="black" stroke="black" points="1964.7,-76.12 1974.7,-72.62 1964.7,-69.12 1964.7,-76.12"/>
</g>
<!-- route_0_to_128 -->
<g id="node11" class="node">
<title>route_0_to_128</title>
<ellipse fill="lightyellow" stroke="black" cx="2269.32" cy="-356.62" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2269.32" y="-365.12" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2269.32" y="-354.12" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2269.32" y="-343.12" font-family="Arial" font-size="10.00">GPU: 0→128</text>
</g>
<!-- gate_0&#45;&gt;route_0_to_128 -->
<g id="edge12" class="edge">
<title>gate_0&#45;&gt;route_0_to_128</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1704.1,-124.71C1848.85,-184.21 2080.65,-279.49 2196.92,-327.28"/>
<polygon fill="black" stroke="black" points="2195.87,-330.63 2206.45,-331.19 2198.53,-324.15 2195.87,-330.63"/>
<text text-anchor="middle" x="1834.2" y="-192.42" font-family="Times,serif" font-size="14.00">select tokens</text>
</g>
<!-- expert_0 -->
<g id="node6" class="node">
<title>expert_0</title>
<polygon fill="lightblue" stroke="black" points="3025.44,-98.62 2831.44,-98.62 2831.44,-46.62 3025.44,-46.62 3025.44,-98.62"/>
<text text-anchor="middle" x="2928.44" y="-86.62" font-family="Arial" font-size="10.00">Expert MLP 0</text>
<text text-anchor="middle" x="2928.44" y="-75.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2928.44" y="-64.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2928.44" y="-53.62" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual_add_0&#45;&gt;expert_0 -->
<g id="edge6" class="edge">
<title>residual_add_0&#45;&gt;expert_0</title>
<path fill="none" stroke="black" d="M2564.28,-72.62C2655.97,-72.62 2751.29,-72.62 2821.26,-72.62"/>
<polygon fill="black" stroke="black" points="2821.39,-76.12 2831.39,-72.62 2821.39,-69.12 2821.39,-76.12"/>
</g>
<!-- collect_results -->
<g id="node18" class="node">
<title>collect_results</title>
<polygon fill="lightgreen" stroke="black" points="6953.39,-220.62 6547.61,-220.62 6443.23,-116.62 6849.01,-116.62 6953.39,-220.62"/>
<text text-anchor="middle" x="6698.31" y="-182.62" font-family="Arial" font-size="10.00">Gather Results</text>
<text text-anchor="middle" x="6698.31" y="-171.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] from all GPUs</text>
<text text-anchor="middle" x="6698.31" y="-160.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="6698.31" y="-149.62" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
</g>
<!-- expert_0&#45;&gt;collect_results -->
<g id="edge23" class="edge">
<title>expert_0&#45;&gt;collect_results</title>
<path fill="none" stroke="black" d="M3025.67,-72.62C3106.03,-72.62 3223.62,-72.62 3326.28,-72.62 3326.28,-72.62 3326.28,-72.62 6208.27,-72.62 6309.18,-72.62 6419.64,-92.55 6510.01,-114.24"/>
<polygon fill="black" stroke="black" points="6509.27,-117.66 6519.81,-116.62 6510.92,-110.86 6509.27,-117.66"/>
<text text-anchor="middle" x="4810.86" y="-76.42" font-family="Times,serif" font-size="14.00">from GPU 0</text>
</g>
<!-- gate_128 -->
<g id="node8" class="node">
<title>gate_128</title>
<polygon fill="lightgreen" stroke="black" points="3519.95,-431.62 3213.45,-431.62 3134.6,-327.62 3441.1,-327.62 3519.95,-431.62"/>
<text text-anchor="middle" x="3327.28" y="-393.62" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="3327.28" y="-382.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="3327.28" y="-371.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="3327.28" y="-360.62" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- mla_128&#45;&gt;gate_128 -->
<g id="edge8" class="edge">
<title>mla_128&#45;&gt;gate_128</title>
<path fill="none" stroke="black" d="M3040.51,-379.62C3078.64,-379.62 3122.14,-379.62 3163.51,-379.62"/>
<polygon fill="black" stroke="black" points="3163.7,-383.12 3173.7,-379.62 3163.7,-376.12 3163.7,-383.12"/>
</g>
<!-- gate_128&#45;&gt;residual_add_128 -->
<g id="edge9" class="edge">
<title>gate_128&#45;&gt;residual_add_128</title>
<path fill="none" stroke="black" d="M3480.77,-379.62C3549.84,-379.62 3634.08,-379.62 3715.22,-379.62"/>
<polygon fill="black" stroke="black" points="3715.61,-383.12 3725.61,-379.62 3715.61,-376.12 3715.61,-383.12"/>
</g>
<!-- route_128_to_255 -->
<g id="node16" class="node">
<title>route_128_to_255</title>
<ellipse fill="lightyellow" stroke="black" cx="4020.23" cy="-242.62" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="4020.23" y="-251.12" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="4020.23" y="-240.12" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="4020.23" y="-229.12" font-family="Arial" font-size="10.00">GPU: 128→255</text>
</g>
<!-- gate_128&#45;&gt;route_128_to_255 -->
<g id="edge19" class="edge">
<title>gate_128&#45;&gt;route_128_to_255</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3449.71,-338.91C3509.47,-320.22 3582.94,-299.24 3650.11,-285.62 3728.31,-269.77 3817.09,-259.2 3887.99,-252.5"/>
<polygon fill="black" stroke="black" points="3888.68,-255.95 3898.32,-251.54 3888.04,-248.98 3888.68,-255.95"/>
<text text-anchor="middle" x="3585.11" y="-314.42" font-family="Times,serif" font-size="14.00">select tokens</text>
</g>
<!-- async_coord -->
<g id="node17" class="node">
<title>async_coord</title>
<ellipse fill="lightyellow" stroke="black" cx="5703.15" cy="-259.62" rx="72.25" ry="21.43"/>
<text text-anchor="middle" x="5703.15" y="-262.62" font-family="Arial" font-size="10.00">Async Coordination</text>
<text text-anchor="middle" x="5703.15" y="-251.62" font-family="Arial" font-size="10.00">GPU: 128↔255</text>
</g>
<!-- gate_128&#45;&gt;async_coord -->
<g id="edge20" class="edge">
<title>gate_128&#45;&gt;async_coord</title>
<path fill="none" stroke="black" d="M3400.44,-327.48C3463.04,-285.52 3557.87,-229.57 3650.11,-204.62 3822.51,-157.99 5088.79,-107.7 5257.03,-167.62 5298.09,-182.25 5292.59,-213.34 5333.03,-229.62 5427.78,-267.77 5547.08,-270.12 5623.98,-266.42"/>
<polygon fill="black" stroke="black" points="5624.27,-269.91 5634.07,-265.88 5623.9,-262.92 5624.27,-269.91"/>
<text text-anchor="middle" x="4638.36" y="-147.42" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- expert_128 -->
<g id="node10" class="node">
<title>expert_128</title>
<polygon fill="lightblue" stroke="black" points="4735.36,-392.62 4541.36,-392.62 4541.36,-340.62 4735.36,-340.62 4735.36,-392.62"/>
<text text-anchor="middle" x="4638.36" y="-380.62" font-family="Arial" font-size="10.00">Expert MLP 128</text>
<text text-anchor="middle" x="4638.36" y="-369.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="4638.36" y="-358.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="4638.36" y="-347.62" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- residual_add_128&#45;&gt;expert_128 -->
<g id="edge11" class="edge">
<title>residual_add_128&#45;&gt;expert_128</title>
<path fill="none" stroke="black" d="M4306.3,-373.61C4386.43,-371.92 4468.64,-370.18 4531.1,-368.87"/>
<polygon fill="black" stroke="black" points="4531.41,-372.36 4541.34,-368.65 4531.27,-365.36 4531.41,-372.36"/>
</g>
<!-- expert_128&#45;&gt;collect_results -->
<g id="edge24" class="edge">
<title>expert_128&#45;&gt;collect_results</title>
<path fill="none" stroke="black" d="M4735.66,-359.13C4821.52,-353.1 4950.66,-345.62 5063.19,-345.62 5063.19,-345.62 5063.19,-345.62 6208.27,-345.62 6351.87,-345.62 6505.78,-277.31 6601.78,-225.57"/>
<polygon fill="black" stroke="black" points="6603.49,-228.62 6610.6,-220.77 6600.14,-222.47 6603.49,-228.62"/>
<text text-anchor="middle" x="5703.15" y="-349.42" font-family="Times,serif" font-size="14.00">from GPU 128</text>
</g>
<!-- route_0_to_128&#45;&gt;mla_128 -->
<g id="edge13" class="edge">
<title>route_0_to_128&#45;&gt;mla_128</title>
<path fill="none" stroke="black" d="M2395.85,-361.02C2513.95,-365.15 2689.59,-371.3 2806.25,-375.38"/>
<polygon fill="black" stroke="black" points="2806.18,-378.88 2816.3,-375.73 2806.43,-371.89 2806.18,-378.88"/>
<text text-anchor="middle" x="2727.94" y="-378.42" font-family="Times,serif" font-size="14.00">routed tokens</text>
</g>
<!-- gate_255 -->
<g id="node13" class="node">
<title>gate_255</title>
<polygon fill="lightgreen" stroke="black" points="5256.86,-280.62 4950.36,-280.62 4871.52,-176.62 5178.02,-176.62 5256.86,-280.62"/>
<text text-anchor="middle" x="5064.19" y="-242.62" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="5064.19" y="-231.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="5064.19" y="-220.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="5064.19" y="-209.62" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- mla_255&#45;&gt;gate_255 -->
<g id="edge15" class="edge">
<title>mla_255&#45;&gt;gate_255</title>
<path fill="none" stroke="black" d="M4750.44,-238.95C4797.46,-237.4 4853.12,-235.56 4904.35,-233.87"/>
<polygon fill="black" stroke="black" points="4904.66,-237.36 4914.54,-233.53 4904.43,-230.37 4904.66,-237.36"/>
</g>
<!-- gate_255&#45;&gt;residual_add_255 -->
<g id="edge16" class="edge">
<title>gate_255&#45;&gt;residual_add_255</title>
<path fill="none" stroke="black" d="M5207.34,-215.23C5274.15,-208.94 5356.07,-201.22 5433.89,-193.89"/>
<polygon fill="black" stroke="black" points="5434.22,-197.38 5443.85,-192.95 5433.57,-190.41 5434.22,-197.38"/>
</g>
<!-- gate_255&#45;&gt;async_coord -->
<g id="edge21" class="edge">
<title>gate_255&#45;&gt;async_coord</title>
<path fill="none" stroke="black" d="M5223.46,-236.33C5349.91,-242.48 5521.93,-250.85 5621.61,-255.7"/>
<polygon fill="black" stroke="black" points="5621.46,-259.2 5631.62,-256.19 5621.8,-252.21 5621.46,-259.2"/>
<text text-anchor="middle" x="5295.03" y="-243.42" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- expert_255 -->
<g id="node15" class="node">
<title>expert_255</title>
<polygon fill="lightblue" stroke="black" points="6304.27,-194.62 6110.27,-194.62 6110.27,-142.62 6304.27,-142.62 6304.27,-194.62"/>
<text text-anchor="middle" x="6207.27" y="-182.62" font-family="Arial" font-size="10.00">Expert MLP 255</text>
<text text-anchor="middle" x="6207.27" y="-171.62" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="6207.27" y="-160.62" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="6207.27" y="-149.62" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- residual_add_255&#45;&gt;expert_255 -->
<g id="edge18" class="edge">
<title>residual_add_255&#45;&gt;expert_255</title>
<path fill="none" stroke="black" d="M5997.69,-168.62C6034.03,-168.62 6069.15,-168.62 6099.89,-168.62"/>
<polygon fill="black" stroke="black" points="6100.14,-172.12 6110.14,-168.62 6100.14,-165.12 6100.14,-172.12"/>
</g>
<!-- expert_255&#45;&gt;collect_results -->
<g id="edge25" class="edge">
<title>expert_255&#45;&gt;collect_results</title>
<path fill="none" stroke="black" d="M6304.3,-168.62C6356.06,-168.62 6422.09,-168.62 6485.19,-168.62"/>
<polygon fill="black" stroke="black" points="6485.29,-172.12 6495.29,-168.62 6485.29,-165.12 6485.29,-172.12"/>
<text text-anchor="middle" x="6373.77" y="-172.42" font-family="Times,serif" font-size="14.00">from GPU 255</text>
</g>
<!-- route_128_to_255&#45;&gt;mla_255 -->
<g id="edge22" class="edge">
<title>route_128_to_255&#45;&gt;mla_255</title>
<path fill="none" stroke="black" d="M4148.52,-242.62C4256.39,-242.62 4410.02,-242.62 4516.13,-242.62"/>
<polygon fill="black" stroke="black" points="4516.25,-246.12 4526.25,-242.62 4516.25,-239.12 4516.25,-246.12"/>
<text text-anchor="middle" x="4458.36" y="-246.42" font-family="Times,serif" font-size="14.00">routed tokens</text>
</g>
<!-- final_output -->
<g id="node19" class="node">
<title>final_output</title>
<polygon fill="lightgray" stroke="black" points="7139.24,-139.7 7147.58,-139.86 7155.83,-140.1 7163.96,-140.41 7171.94,-140.81 7179.74,-141.27 7187.32,-141.82 7194.65,-142.44 7201.71,-143.13 7208.47,-143.89 7214.91,-144.71 7221,-145.61 7226.73,-146.56 7232.07,-147.58 7237.01,-148.65 7241.54,-149.78 7245.64,-150.96 7249.31,-152.19 7252.54,-153.46 7255.32,-154.78 7257.66,-156.13 7259.55,-157.52 7261,-158.94 7262.01,-160.38 7262.59,-161.85 7262.74,-163.34 7262.49,-164.84 7261.83,-166.35 7260.78,-167.86 7259.36,-169.38 7257.58,-170.9 7255.47,-172.41 7253.02,-173.91 7250.27,-175.4 7247.23,-176.86 7243.93,-178.31 7240.37,-179.73 7236.57,-181.11 7232.57,-182.47 7228.36,-183.78 7223.98,-185.06 7219.43,-186.28 7214.74,-187.47 7209.92,-188.59 7204.98,-189.67 7199.93,-190.68 7194.8,-191.64 7189.58,-192.53 7184.3,-193.36 7178.96,-194.12 7173.57,-194.81 7168.13,-195.43 7162.67,-195.97 7157.17,-196.44 7151.65,-196.83 7146.11,-197.15 7140.56,-197.39 7135,-197.55 7129.43,-197.63 7123.86,-197.63 7118.3,-197.55 7112.74,-197.39 7107.19,-197.15 7101.65,-196.83 7096.13,-196.44 7090.63,-195.97 7085.16,-195.43 7079.73,-194.81 7074.34,-194.12 7069,-193.36 7063.71,-192.53 7058.5,-191.64 7053.36,-190.68 7048.32,-189.67 7043.38,-188.59 7038.56,-187.47 7033.86,-186.28 7029.32,-185.06 7024.93,-183.78 7020.73,-182.47 7016.72,-181.11 7012.93,-179.73 7009.37,-178.31 7006.06,-176.86 7003.03,-175.4 7000.28,-173.91 6997.83,-172.41 6995.71,-170.9 6993.94,-169.38 6992.52,-167.86 6991.47,-166.35 6990.81,-164.84 6990.55,-163.34 6990.71,-161.85 6991.29,-160.38 6992.3,-158.94 6993.75,-157.52 6995.64,-156.13 6997.98,-154.78 7000.76,-153.46 7003.99,-152.19 7007.66,-150.96 7011.76,-149.78 7016.29,-148.65 7021.23,-147.58 7026.57,-146.56 7032.3,-145.61 7038.39,-144.71 7044.83,-143.89 7051.59,-143.13 7058.65,-142.44 7065.98,-141.82 7073.56,-141.27 7081.35,-140.81 7089.33,-140.41 7097.47,-140.1 7105.72,-139.86 7114.06,-139.7 7122.45,-139.62 7130.85,-139.62 7139.24,-139.7"/>
<text text-anchor="middle" x="7126.65" y="-177.12" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="7126.65" y="-166.12" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="7126.65" y="-155.12" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- collect_results&#45;&gt;final_output -->
<g id="edge26" class="edge">
<title>collect_results&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M6901.24,-168.62C6928.79,-168.62 6956.59,-168.62 6982.8,-168.62"/>
<polygon fill="black" stroke="black" points="6983.15,-172.12 6993.15,-168.62 6983.15,-165.12 6983.15,-172.12"/>
</g>
</g>
</svg>
