<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="3871pt" height="703pt"
 viewBox="0.00 0.00 3871.12 703.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 699)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-699 3867.12,-699 3867.12,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="none" stroke="black" d="M20,-171C20,-171 902.53,-171 902.53,-171 908.53,-171 914.53,-177 914.53,-183 914.53,-183 914.53,-280 914.53,-280 914.53,-286 908.53,-292 902.53,-292 902.53,-292 20,-292 20,-292 14,-292 8,-286 8,-280 8,-280 8,-183 8,-183 8,-177 14,-171 20,-171"/>
<text text-anchor="middle" x="461.26" y="-276.8" font-family="Times,serif" font-size="14.00">Input Distribution Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1</title>
<path fill="none" stroke="black" d="M1087.53,-257C1087.53,-257 2884.44,-257 2884.44,-257 2890.44,-257 2896.44,-263 2896.44,-269 2896.44,-269 2896.44,-388 2896.44,-388 2896.44,-394 2890.44,-400 2884.44,-400 2884.44,-400 1087.53,-400 1087.53,-400 1081.53,-400 1075.53,-394 1075.53,-388 1075.53,-388 1075.53,-269 1075.53,-269 1075.53,-263 1081.53,-257 1087.53,-257"/>
<text text-anchor="middle" x="1985.98" y="-384.8" font-family="Times,serif" font-size="14.00">Layer 1: GPU 0 &#45; Input Processing</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="black" d="M490.18,-408C490.18,-408 2884.44,-408 2884.44,-408 2890.44,-408 2896.44,-414 2896.44,-420 2896.44,-420 2896.44,-675 2896.44,-675 2896.44,-681 2890.44,-687 2884.44,-687 2884.44,-687 490.18,-687 490.18,-687 484.18,-687 478.18,-681 478.18,-675 478.18,-675 478.18,-420 478.18,-420 478.18,-414 484.18,-408 490.18,-408"/>
<text text-anchor="middle" x="1687.31" y="-671.8" font-family="Times,serif" font-size="14.00">Layer 2: GPU 128 &#45; Cross&#45;Node Expert Processing</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="black" d="M1087.53,-8C1087.53,-8 2884.44,-8 2884.44,-8 2890.44,-8 2896.44,-14 2896.44,-20 2896.44,-20 2896.44,-139 2896.44,-139 2896.44,-145 2890.44,-151 2884.44,-151 2884.44,-151 1087.53,-151 1087.53,-151 1081.53,-151 1075.53,-145 1075.53,-139 1075.53,-139 1075.53,-20 1075.53,-20 1075.53,-14 1081.53,-8 1087.53,-8"/>
<text text-anchor="middle" x="1985.98" y="-135.8" font-family="Times,serif" font-size="14.00">Layer 3: GPU 255 &#45; Final Processing</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_output</title>
<path fill="none" stroke="black" d="M3031.44,-257C3031.44,-257 3843.12,-257 3843.12,-257 3849.12,-257 3855.12,-263 3855.12,-269 3855.12,-269 3855.12,-388 3855.12,-388 3855.12,-394 3849.12,-400 3843.12,-400 3843.12,-400 3031.44,-400 3031.44,-400 3025.44,-400 3019.44,-394 3019.44,-388 3019.44,-388 3019.44,-269 3019.44,-269 3019.44,-263 3025.44,-257 3031.44,-257"/>
<text text-anchor="middle" x="3437.28" y="-384.8" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
</g>
<!-- input_tokens -->
<g id="node1" class="node">
<title>input_tokens</title>
<polygon fill="lightgray" stroke="black" points="124.59,-191.08 130.67,-191.24 136.69,-191.47 142.63,-191.79 148.45,-192.18 154.13,-192.65 159.66,-193.2 165.01,-193.81 170.17,-194.5 175.1,-195.26 179.8,-196.09 184.24,-196.98 188.42,-197.94 192.32,-198.96 195.92,-200.03 199.22,-201.16 202.22,-202.34 204.89,-203.57 207.25,-204.84 209.28,-206.16 210.99,-207.51 212.37,-208.9 213.42,-210.32 214.16,-211.76 214.58,-213.23 214.7,-214.71 214.51,-216.21 214.03,-217.72 213.27,-219.24 212.23,-220.76 210.93,-222.28 209.39,-223.79 207.6,-225.29 205.6,-226.77 203.38,-228.24 200.97,-229.68 198.37,-231.1 195.6,-232.49 192.68,-233.84 189.61,-235.16 186.42,-236.43 183.1,-237.66 179.67,-238.84 176.15,-239.97 172.55,-241.04 168.87,-242.06 165.12,-243.02 161.32,-243.91 157.46,-244.74 153.57,-245.5 149.63,-246.19 145.67,-246.8 141.68,-247.35 137.67,-247.82 133.64,-248.21 129.6,-248.53 125.55,-248.76 121.49,-248.92 117.43,-249 113.37,-249 109.31,-248.92 105.25,-248.76 101.2,-248.53 97.16,-248.21 93.13,-247.82 89.12,-247.35 85.13,-246.8 81.17,-246.19 77.23,-245.5 73.34,-244.74 69.48,-243.91 65.68,-243.02 61.93,-242.06 58.25,-241.04 54.64,-239.97 51.12,-238.84 47.7,-237.66 44.38,-236.43 41.19,-235.16 38.12,-233.84 35.19,-232.49 32.43,-231.1 29.83,-229.68 27.42,-228.24 25.2,-226.77 23.19,-225.29 21.41,-223.79 19.87,-222.28 18.57,-220.76 17.53,-219.24 16.77,-217.72 16.29,-216.21 16.1,-214.71 16.21,-213.23 16.64,-211.76 17.37,-210.32 18.43,-208.9 19.81,-207.51 21.52,-206.16 23.55,-204.84 25.9,-203.57 28.58,-202.34 31.57,-201.16 34.88,-200.03 38.48,-198.96 42.38,-197.94 46.56,-196.98 51,-196.09 55.7,-195.26 60.63,-194.5 65.78,-193.81 71.13,-193.2 76.66,-192.65 82.35,-192.18 88.17,-191.79 94.11,-191.47 100.13,-191.24 106.21,-191.08 112.33,-191 118.47,-191 124.59,-191.08"/>
<text text-anchor="middle" x="115.4" y="-228.5" font-family="Arial" font-size="10.00">Input Tokens</text>
<text text-anchor="middle" x="115.4" y="-217.5" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?]</text>
<text text-anchor="middle" x="115.4" y="-206.5" font-family="Arial" font-size="10.00">GPU: N/A</text>
</g>
<!-- token_split -->
<g id="node2" class="node">
<title>token_split</title>
<polygon fill="lightgreen" stroke="black" points="906.39,-261 441.52,-261 321.93,-179 786.8,-179 906.39,-261"/>
<text text-anchor="middle" x="614.16" y="-228.5" font-family="Arial" font-size="10.00">Token Split</text>
<text text-anchor="middle" x="614.16" y="-217.5" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?] → [batch_size=?, seq_len=?/256]</text>
<text text-anchor="middle" x="614.16" y="-206.5" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
</g>
<!-- input_tokens&#45;&gt;token_split -->
<g id="edge1" class="edge">
<title>input_tokens&#45;&gt;token_split</title>
<path fill="none" stroke="black" d="M212.77,-220C258.42,-220 315.2,-220 371.51,-220"/>
<polygon fill="black" stroke="black" points="371.65,-223.5 381.65,-220 371.65,-216.5 371.65,-223.5"/>
<text text-anchor="middle" x="268.3" y="-223.8" font-family="Times,serif" font-size="14.00">broadcast</text>
</g>
<!-- mla_0 -->
<g id="node3" class="node">
<title>mla_0</title>
<polygon fill="lightblue" stroke="black" points="1307.53,-317 1083.53,-317 1083.53,-265 1307.53,-265 1307.53,-317"/>
<text text-anchor="middle" x="1195.53" y="-305" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="1195.53" y="-294" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="1195.53" y="-283" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1195.53" y="-272" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- token_split&#45;&gt;mla_0 -->
<g id="edge2" class="edge">
<title>token_split&#45;&gt;mla_0</title>
<path fill="none" stroke="black" d="M897.21,-254.56C959.12,-262.15 1021.51,-269.8 1073.03,-276.11"/>
<polygon fill="black" stroke="black" points="1072.83,-279.61 1083.19,-277.36 1073.69,-272.66 1072.83,-279.61"/>
<text text-anchor="middle" x="995.03" y="-276.8" font-family="Times,serif" font-size="14.00">tokens for GPU 0</text>
</g>
<!-- residual_add_0 -->
<g id="node5" class="node">
<title>residual_add_0</title>
<polygon fill="lightgreen" stroke="black" points="2657.56,-369 2068.59,-369 1917.08,-265 2506.05,-265 2657.56,-369"/>
<text text-anchor="middle" x="2287.32" y="-331" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2287.32" y="-320" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2287.32" y="-309" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2287.32" y="-298" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- token_split&#45;&gt;residual_add_0 -->
<g id="edge5" class="edge">
<title>token_split&#45;&gt;residual_add_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M821.27,-202.5C1055.93,-186.05 1450.41,-169 1787.2,-206 1887.66,-217.04 1997.49,-240.21 2088.47,-262.54"/>
<polygon fill="black" stroke="black" points="2087.8,-265.98 2098.34,-264.98 2089.47,-259.19 2087.8,-265.98"/>
<text text-anchor="middle" x="1354.53" y="-187.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mla_128 -->
<g id="node7" class="node">
<title>mla_128</title>
<polygon fill="lightblue" stroke="black" points="1307.53,-560 1083.53,-560 1083.53,-508 1307.53,-508 1307.53,-560"/>
<text text-anchor="middle" x="1195.53" y="-548" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="1195.53" y="-537" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="1195.53" y="-526" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1195.53" y="-515" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- token_split&#45;&gt;mla_128 -->
<g id="edge7" class="edge">
<title>token_split&#45;&gt;mla_128</title>
<path fill="none" stroke="black" d="M711.12,-261.16C775.36,-292.63 858.15,-341.27 914.53,-404 921.44,-411.69 917.16,-417.75 924.53,-425 977.11,-476.76 1006.91,-466.88 1075.53,-494 1084.57,-497.58 1094.08,-501.12 1103.61,-504.54"/>
<polygon fill="black" stroke="black" points="1102.55,-507.87 1113.14,-507.9 1104.88,-501.27 1102.55,-507.87"/>
<text text-anchor="middle" x="995.03" y="-492.8" font-family="Times,serif" font-size="14.00">tokens for GPU 128</text>
</g>
<!-- residual_add_128 -->
<g id="node9" class="node">
<title>residual_add_128</title>
<polygon fill="lightgreen" stroke="black" points="2657.56,-656 2068.59,-656 1917.08,-552 2506.05,-552 2657.56,-656"/>
<text text-anchor="middle" x="2287.32" y="-618" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2287.32" y="-607" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2287.32" y="-596" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2287.32" y="-585" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- token_split&#45;&gt;residual_add_128 -->
<g id="edge10" class="edge">
<title>token_split&#45;&gt;residual_add_128</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M696.78,-261.08C787.01,-304.46 937.83,-371.04 1075.53,-404 1254.33,-446.8 1759.07,-362.98 1899.2,-482 1920.74,-500.3 1896.02,-524.28 1917.2,-543 1918.19,-543.88 1919.19,-544.74 1920.2,-545.6"/>
<polygon fill="black" stroke="black" points="1918.09,-548.4 1928.06,-551.98 1922.5,-542.96 1918.09,-548.4"/>
<text text-anchor="middle" x="1354.53" y="-419.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mla_255 -->
<g id="node14" class="node">
<title>mla_255</title>
<polygon fill="lightblue" stroke="black" points="1307.53,-114 1083.53,-114 1083.53,-62 1307.53,-62 1307.53,-114"/>
<text text-anchor="middle" x="1195.53" y="-102" font-family="Arial" font-size="10.00">MLA</text>
<text text-anchor="middle" x="1195.53" y="-91" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=128, d_k=56]</text>
<text text-anchor="middle" x="1195.53" y="-80" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1195.53" y="-69" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- token_split&#45;&gt;mla_255 -->
<g id="edge18" class="edge">
<title>token_split&#45;&gt;mla_255</title>
<path fill="none" stroke="black" d="M722.86,-178.93C781.66,-158.01 856.22,-133.91 924.53,-119 972.63,-108.5 1026.37,-101.41 1073.17,-96.69"/>
<polygon fill="black" stroke="black" points="1073.74,-100.15 1083.35,-95.69 1073.06,-93.19 1073.74,-100.15"/>
<text text-anchor="middle" x="995.03" y="-122.8" font-family="Times,serif" font-size="14.00">tokens for GPU 255</text>
</g>
<!-- residual_add_255 -->
<g id="node16" class="node">
<title>residual_add_255</title>
<polygon fill="lightgreen" stroke="black" points="2657.56,-120 2068.59,-120 1917.08,-16 2506.05,-16 2657.56,-120"/>
<text text-anchor="middle" x="2287.32" y="-82" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2287.32" y="-71" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] + [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2287.32" y="-60" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2287.32" y="-49" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- token_split&#45;&gt;residual_add_255 -->
<g id="edge21" class="edge">
<title>token_split&#45;&gt;residual_add_255</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M812.23,-196.28C849.5,-192.2 888.19,-188.23 924.53,-185 1307.23,-150.95 1404.65,-164.76 1787.2,-129 1866.39,-121.6 1952.42,-111.74 2030.41,-102.11"/>
<polygon fill="black" stroke="black" points="2030.87,-105.58 2040.37,-100.87 2030.01,-98.63 2030.87,-105.58"/>
<text text-anchor="middle" x="1354.53" y="-161.8" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_0 -->
<g id="node4" class="node">
<title>gate_0</title>
<polygon fill="lightgreen" stroke="black" points="1787.04,-369 1480.54,-369 1401.69,-265 1708.19,-265 1787.04,-369"/>
<text text-anchor="middle" x="1594.36" y="-331" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="1594.36" y="-320" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1594.36" y="-309" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1594.36" y="-298" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- mla_0&#45;&gt;gate_0 -->
<g id="edge3" class="edge">
<title>mla_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M1307.6,-298.28C1343.27,-300.61 1383.66,-303.26 1422.59,-305.81"/>
<polygon fill="black" stroke="black" points="1422.78,-309.33 1432.99,-306.49 1423.24,-302.35 1422.78,-309.33"/>
</g>
<!-- gate_0&#45;&gt;residual_add_0 -->
<g id="edge4" class="edge">
<title>gate_0&#45;&gt;residual_add_0</title>
<path fill="none" stroke="black" d="M1747.85,-317C1816.93,-317 1901.16,-317 1982.3,-317"/>
<polygon fill="black" stroke="black" points="1982.7,-320.5 1992.7,-317 1982.7,-313.5 1982.7,-320.5"/>
</g>
<!-- route_0_to_128 -->
<g id="node11" class="node">
<title>route_0_to_128</title>
<ellipse fill="lightyellow" stroke="black" cx="614.16" cy="-500" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="614.16" y="-508.5" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="614.16" y="-497.5" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="614.16" y="-486.5" font-family="Arial" font-size="10.00">GPU: 0→128</text>
</g>
<!-- gate_0&#45;&gt;route_0_to_128 -->
<g id="edge12" class="edge">
<title>gate_0&#45;&gt;route_0_to_128</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1470.68,-356.47C1445.58,-368.74 1420.93,-384.36 1401.53,-404 1387.54,-418.16 1399.79,-433.53 1383.53,-445 1358.09,-462.94 963.3,-483.87 749.81,-493.96"/>
<polygon fill="black" stroke="black" points="749.61,-490.47 739.78,-494.43 749.93,-497.46 749.61,-490.47"/>
<text text-anchor="middle" x="1195.53" y="-478.8" font-family="Times,serif" font-size="14.00">select tokens</text>
</g>
<!-- async_comm_128 -->
<g id="node13" class="node">
<title>async_comm_128</title>
<ellipse fill="lightyellow" stroke="black" cx="2287.32" cy="-513" rx="58.88" ry="21.43"/>
<text text-anchor="middle" x="2287.32" y="-516" font-family="Arial" font-size="10.00">Async Transfer</text>
<text text-anchor="middle" x="2287.32" y="-505" font-family="Arial" font-size="10.00">GPU: 0↔128</text>
</g>
<!-- gate_0&#45;&gt;async_comm_128 -->
<g id="edge14" class="edge">
<title>gate_0&#45;&gt;async_comm_128</title>
<path fill="none" stroke="black" d="M1754.48,-325.86C1807.05,-336.6 1861.63,-357.46 1899.2,-397 1926.1,-425.31 1887.91,-457.17 1917.2,-483 2003.32,-558.96 2148.95,-543.53 2229.13,-527.26"/>
<polygon fill="black" stroke="black" points="2229.98,-530.66 2239.05,-525.17 2228.54,-523.81 2229.98,-530.66"/>
<text text-anchor="middle" x="1852.2" y="-400.8" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- expert_0 -->
<g id="node6" class="node">
<title>expert_0</title>
<polygon fill="lightblue" stroke="black" points="2888.44,-343 2694.44,-343 2694.44,-291 2888.44,-291 2888.44,-343"/>
<text text-anchor="middle" x="2791.44" y="-331" font-family="Arial" font-size="10.00">Expert MLP 0</text>
<text text-anchor="middle" x="2791.44" y="-320" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2791.44" y="-309" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2791.44" y="-298" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual_add_0&#45;&gt;expert_0 -->
<g id="edge6" class="edge">
<title>residual_add_0&#45;&gt;expert_0</title>
<path fill="none" stroke="black" d="M2581.86,-317C2618.2,-317 2653.33,-317 2684.06,-317"/>
<polygon fill="black" stroke="black" points="2684.31,-320.5 2694.31,-317 2684.31,-313.5 2684.31,-320.5"/>
</g>
<!-- collect_results -->
<g id="node18" class="node">
<title>collect_results</title>
<polygon fill="lightgreen" stroke="black" points="3537.56,-369 3131.79,-369 3027.4,-265 3433.18,-265 3537.56,-369"/>
<text text-anchor="middle" x="3282.48" y="-331" font-family="Arial" font-size="10.00">Gather Results</text>
<text text-anchor="middle" x="3282.48" y="-320" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168] from all GPUs</text>
<text text-anchor="middle" x="3282.48" y="-309" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="3282.48" y="-298" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
</g>
<!-- expert_0&#45;&gt;collect_results -->
<g id="edge23" class="edge">
<title>expert_0&#45;&gt;collect_results</title>
<path fill="none" stroke="black" d="M2888.48,-317C2940.23,-317 3006.26,-317 3069.37,-317"/>
<polygon fill="black" stroke="black" points="3069.47,-320.5 3079.47,-317 3069.47,-313.5 3069.47,-320.5"/>
<text text-anchor="middle" x="2957.94" y="-320.8" font-family="Times,serif" font-size="14.00">from GPU 0</text>
</g>
<!-- gate_128 -->
<g id="node8" class="node">
<title>gate_128</title>
<polygon fill="lightgreen" stroke="black" points="1787.04,-581 1480.54,-581 1401.69,-477 1708.19,-477 1787.04,-581"/>
<text text-anchor="middle" x="1594.36" y="-543" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="1594.36" y="-532" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1594.36" y="-521" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1594.36" y="-510" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- mla_128&#45;&gt;gate_128 -->
<g id="edge8" class="edge">
<title>mla_128&#45;&gt;gate_128</title>
<path fill="none" stroke="black" d="M1307.6,-532.6C1346.23,-532.11 1390.38,-531.56 1432.24,-531.03"/>
<polygon fill="black" stroke="black" points="1432.3,-534.53 1442.26,-530.9 1432.22,-527.53 1432.3,-534.53"/>
</g>
<!-- gate_128&#45;&gt;residual_add_128 -->
<g id="edge9" class="edge">
<title>gate_128&#45;&gt;residual_add_128</title>
<path fill="none" stroke="black" d="M1761.3,-547.01C1811.79,-552.49 1869.35,-558.74 1927.43,-565.04"/>
<polygon fill="black" stroke="black" points="1927.19,-568.54 1937.51,-566.14 1927.95,-561.58 1927.19,-568.54"/>
</g>
<!-- route_128_to_0 -->
<g id="node12" class="node">
<title>route_128_to_0</title>
<ellipse fill="lightyellow" stroke="black" cx="2287.32" cy="-445" rx="127.97" ry="28.98"/>
<text text-anchor="middle" x="2287.32" y="-453.5" font-family="Arial" font-size="10.00">Token Routing</text>
<text text-anchor="middle" x="2287.32" y="-442.5" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2287.32" y="-431.5" font-family="Arial" font-size="10.00">GPU: 128→0</text>
</g>
<!-- gate_128&#45;&gt;route_128_to_0 -->
<g id="edge13" class="edge">
<title>gate_128&#45;&gt;route_128_to_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1732.23,-508.22C1789.35,-499.87 1856.42,-490.47 1917.2,-483 1997.19,-473.17 2087.14,-463.87 2158.23,-456.94"/>
<polygon fill="black" stroke="black" points="2158.96,-460.38 2168.57,-455.93 2158.28,-453.41 2158.96,-460.38"/>
<text text-anchor="middle" x="1852.2" y="-500.8" font-family="Times,serif" font-size="14.00">select tokens</text>
</g>
<!-- gate_128&#45;&gt;async_comm_128 -->
<g id="edge15" class="edge">
<title>gate_128&#45;&gt;async_comm_128</title>
<path fill="none" stroke="black" d="M1745.29,-525.53C1892.17,-522.13 2109.37,-517.1 2218.5,-514.57"/>
<polygon fill="black" stroke="black" points="2218.8,-518.06 2228.72,-514.33 2218.64,-511.07 2218.8,-518.06"/>
<text text-anchor="middle" x="1852.2" y="-526.8" font-family="Times,serif" font-size="14.00">coord</text>
</g>
<!-- expert_128 -->
<g id="node10" class="node">
<title>expert_128</title>
<polygon fill="lightblue" stroke="black" points="2888.44,-549 2694.44,-549 2694.44,-497 2888.44,-497 2888.44,-549"/>
<text text-anchor="middle" x="2791.44" y="-537" font-family="Arial" font-size="10.00">Expert MLP 128</text>
<text text-anchor="middle" x="2791.44" y="-526" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2791.44" y="-515" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2791.44" y="-504" font-family="Arial" font-size="10.00">GPU: 128</text>
</g>
<!-- residual_add_128&#45;&gt;expert_128 -->
<g id="edge11" class="edge">
<title>residual_add_128&#45;&gt;expert_128</title>
<path fill="none" stroke="black" d="M2526.15,-565.63C2581.64,-556.68 2638,-547.59 2684.34,-540.12"/>
<polygon fill="black" stroke="black" points="2685.06,-543.54 2694.38,-538.5 2683.95,-536.63 2685.06,-543.54"/>
</g>
<!-- expert_128&#45;&gt;collect_results -->
<g id="edge24" class="edge">
<title>expert_128&#45;&gt;collect_results</title>
<path fill="none" stroke="black" d="M2854.38,-496.91C2927.88,-465.95 3052.52,-413.45 3148.24,-373.13"/>
<polygon fill="black" stroke="black" points="3149.85,-376.25 3157.7,-369.14 3147.13,-369.8 3149.85,-376.25"/>
<text text-anchor="middle" x="2957.94" y="-476.8" font-family="Times,serif" font-size="14.00">from GPU 128</text>
</g>
<!-- route_0_to_128&#45;&gt;mla_128 -->
<g id="edge16" class="edge">
<title>route_0_to_128&#45;&gt;mla_128</title>
<path fill="none" stroke="black" d="M738.39,-507.23C837.06,-513.02 974.74,-521.1 1072.97,-526.87"/>
<polygon fill="black" stroke="black" points="1073.06,-530.38 1083.25,-527.47 1073.47,-523.39 1073.06,-530.38"/>
<text text-anchor="middle" x="995.03" y="-528.8" font-family="Times,serif" font-size="14.00">routed tokens</text>
</g>
<!-- route_128_to_0&#45;&gt;mla_0 -->
<g id="edge17" class="edge">
<title>route_128_to_0&#45;&gt;mla_0</title>
<path fill="none" stroke="black" d="M2184.5,-462.41C2102.7,-470.31 1989.85,-466.61 1917.2,-404 1893.52,-383.59 1915.89,-362.44 1899.2,-336 1864.36,-280.8 1848.48,-263.49 1787.2,-241 1615.94,-178.15 1398.64,-226.31 1281.17,-261.89"/>
<polygon fill="black" stroke="black" points="1280.04,-258.57 1271.51,-264.85 1282.09,-265.26 1280.04,-258.57"/>
<text text-anchor="middle" x="1594.36" y="-244.8" font-family="Times,serif" font-size="14.00">routed tokens</text>
</g>
<!-- gate_255 -->
<g id="node15" class="node">
<title>gate_255</title>
<polygon fill="lightgreen" stroke="black" points="1787.04,-120 1480.54,-120 1401.69,-16 1708.19,-16 1787.04,-120"/>
<text text-anchor="middle" x="1594.36" y="-82" font-family="Arial" font-size="10.00">Expert Gating</text>
<text text-anchor="middle" x="1594.36" y="-71" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="1594.36" y="-60" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1594.36" y="-49" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- mla_255&#45;&gt;gate_255 -->
<g id="edge19" class="edge">
<title>mla_255&#45;&gt;gate_255</title>
<path fill="none" stroke="black" d="M1307.6,-82.4C1347.59,-80.39 1393.49,-78.07 1436.65,-75.9"/>
<polygon fill="black" stroke="black" points="1436.86,-79.39 1446.68,-75.39 1436.51,-72.4 1436.86,-79.39"/>
</g>
<!-- gate_255&#45;&gt;residual_add_255 -->
<g id="edge20" class="edge">
<title>gate_255&#45;&gt;residual_add_255</title>
<path fill="none" stroke="black" d="M1747.85,-68C1816.93,-68 1901.16,-68 1982.3,-68"/>
<polygon fill="black" stroke="black" points="1982.7,-71.5 1992.7,-68 1982.7,-64.5 1982.7,-71.5"/>
</g>
<!-- expert_255 -->
<g id="node17" class="node">
<title>expert_255</title>
<polygon fill="lightblue" stroke="black" points="2888.44,-107 2694.44,-107 2694.44,-55 2888.44,-55 2888.44,-107"/>
<text text-anchor="middle" x="2791.44" y="-95" font-family="Arial" font-size="10.00">Expert MLP 255</text>
<text text-anchor="middle" x="2791.44" y="-84" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2791.44" y="-73" font-family="Arial" font-size="10.00">→ [batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="2791.44" y="-62" font-family="Arial" font-size="10.00">GPU: 255</text>
</g>
<!-- residual_add_255&#45;&gt;expert_255 -->
<g id="edge22" class="edge">
<title>residual_add_255&#45;&gt;expert_255</title>
<path fill="none" stroke="black" d="M2593.43,-75.9C2625.57,-76.73 2656.47,-77.53 2683.88,-78.24"/>
<polygon fill="black" stroke="black" points="2684.13,-81.75 2694.22,-78.51 2684.31,-74.75 2684.13,-81.75"/>
</g>
<!-- expert_255&#45;&gt;collect_results -->
<g id="edge25" class="edge">
<title>expert_255&#45;&gt;collect_results</title>
<path fill="none" stroke="black" d="M2846.65,-107.16C2922.93,-143.97 3063.88,-211.99 3164.64,-260.61"/>
<polygon fill="black" stroke="black" points="3163.12,-263.77 3173.65,-264.96 3166.16,-257.46 3163.12,-263.77"/>
<text text-anchor="middle" x="2957.94" y="-187.8" font-family="Times,serif" font-size="14.00">from GPU 255</text>
</g>
<!-- final_output -->
<g id="node19" class="node">
<title>final_output</title>
<polygon fill="lightgray" stroke="black" points="3723.41,-288.08 3731.75,-288.24 3740,-288.47 3748.14,-288.79 3756.12,-289.18 3763.91,-289.65 3771.49,-290.2 3778.82,-290.81 3785.88,-291.5 3792.64,-292.26 3799.08,-293.09 3805.17,-293.98 3810.9,-294.94 3816.24,-295.96 3821.18,-297.03 3825.71,-298.16 3829.81,-299.34 3833.48,-300.57 3836.71,-301.84 3839.49,-303.16 3841.83,-304.51 3843.72,-305.9 3845.17,-307.32 3846.18,-308.76 3846.76,-310.23 3846.92,-311.71 3846.66,-313.21 3846,-314.72 3844.95,-316.24 3843.53,-317.76 3841.76,-319.28 3839.64,-320.79 3837.19,-322.29 3834.44,-323.77 3831.41,-325.24 3828.1,-326.68 3824.54,-328.1 3820.75,-329.49 3816.74,-330.84 3812.54,-332.16 3808.15,-333.43 3803.61,-334.66 3798.91,-335.84 3794.09,-336.97 3789.15,-338.04 3784.11,-339.06 3778.97,-340.02 3773.76,-340.91 3768.47,-341.74 3763.13,-342.5 3757.74,-343.19 3752.31,-343.8 3746.84,-344.35 3741.34,-344.82 3735.82,-345.21 3730.28,-345.53 3724.73,-345.76 3719.17,-345.92 3713.6,-346 3708.04,-346 3702.47,-345.92 3696.91,-345.76 3691.36,-345.53 3685.82,-345.21 3680.3,-344.82 3674.8,-344.35 3669.34,-343.8 3663.9,-343.19 3658.51,-342.5 3653.17,-341.74 3647.89,-340.91 3642.67,-340.02 3637.54,-339.06 3632.49,-338.04 3627.55,-336.97 3622.73,-335.84 3618.03,-334.66 3613.49,-333.43 3609.11,-332.16 3604.9,-330.84 3600.9,-329.49 3597.1,-328.1 3593.54,-326.68 3590.24,-325.24 3587.2,-323.77 3584.45,-322.29 3582,-320.79 3579.89,-319.28 3578.11,-317.76 3576.69,-316.24 3575.64,-314.72 3574.98,-313.21 3574.73,-311.71 3574.88,-310.23 3575.46,-308.76 3576.47,-307.32 3577.92,-305.9 3579.81,-304.51 3582.15,-303.16 3584.93,-301.84 3588.16,-300.57 3591.83,-299.34 3595.93,-298.16 3600.46,-297.03 3605.4,-295.96 3610.74,-294.94 3616.47,-293.98 3622.56,-293.09 3629,-292.26 3635.76,-291.5 3642.82,-290.81 3650.15,-290.2 3657.73,-289.65 3665.53,-289.18 3673.51,-288.79 3681.64,-288.47 3689.89,-288.24 3698.23,-288.08 3706.62,-288 3715.02,-288 3723.41,-288.08"/>
<text text-anchor="middle" x="3710.82" y="-325.5" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="3710.82" y="-314.5" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, dim=7168]</text>
<text text-anchor="middle" x="3710.82" y="-303.5" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- collect_results&#45;&gt;final_output -->
<g id="edge26" class="edge">
<title>collect_results&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M3485.41,-317C3512.97,-317 3540.77,-317 3566.97,-317"/>
<polygon fill="black" stroke="black" points="3567.32,-320.5 3577.32,-317 3567.32,-313.5 3567.32,-320.5"/>
</g>
</g>
</svg>
