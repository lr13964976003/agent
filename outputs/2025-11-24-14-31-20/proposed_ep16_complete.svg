<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Proposed_Large_EP16_Complete Pages: 1 -->
<svg width="104646pt" height="1262pt"
 viewBox="0.00 0.00 104646.39 1261.70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1257.7)">
<title>Proposed_Large_EP16_Complete</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1257.7 104642.39,-1257.7 104642.39,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightblue" stroke="black" points="4168.7,-1219.7 3894.7,-1219.7 3894.7,-1183.7 4168.7,-1183.7 4168.7,-1219.7"/>
<text text-anchor="middle" x="4031.7" y="-1204.7" font-family="Arial" font-size="10.00">Model Input</text>
<text text-anchor="middle" x="4031.7" y="-1193.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_mha -->
<g id="node2" class="node">
<title>layer0_mha</title>
<polygon fill="lightcyan" stroke="black" points="4087.2,-1102.93 3806.2,-1102.93 3806.2,-1050.93 4087.2,-1050.93 4087.2,-1102.93"/>
<text text-anchor="middle" x="3946.7" y="-1090.93" font-family="Arial" font-size="10.00">MHA Layer 0</text>
<text text-anchor="middle" x="3946.7" y="-1079.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3946.7" y="-1068.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3946.7" y="-1057.93" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- input&#45;&gt;layer0_mha -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_mha</title>
<path fill="none" stroke="black" d="M3990.95,-1183.55C3990.95,-1183.55 3990.95,-1113.37 3990.95,-1113.37"/>
<polygon fill="black" stroke="black" points="3994.45,-1113.37 3990.95,-1103.37 3987.45,-1113.37 3994.45,-1113.37"/>
</g>
<!-- layer0_add1 -->
<g id="node4" class="node">
<title>layer0_add1</title>
<polygon fill="yellow" stroke="black" points="4171.2,-894.39 3890.2,-894.39 3890.2,-842.39 4171.2,-842.39 4171.2,-894.39"/>
<text text-anchor="middle" x="4030.7" y="-882.39" font-family="Arial" font-size="10.00">MHA Residual Add 0</text>
<text text-anchor="middle" x="4030.7" y="-871.39" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="4030.7" y="-860.39" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="4030.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- input&#45;&gt;layer0_add1 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;layer0_add1</title>
<path fill="none" stroke="black" d="M4127.95,-1183.3C4127.95,-1183.3 4127.95,-904.72 4127.95,-904.72"/>
<polygon fill="black" stroke="black" points="4131.45,-904.72 4127.95,-894.72 4124.45,-904.72 4131.45,-904.72"/>
</g>
<!-- layer0_ln1 -->
<g id="node3" class="node">
<title>layer0_ln1</title>
<polygon fill="none" stroke="black" points="4087.2,-998.66 3806.2,-998.66 3806.2,-946.66 4087.2,-946.66 4087.2,-998.66"/>
<text text-anchor="middle" x="3946.7" y="-986.66" font-family="Arial" font-size="10.00">LayerNorm MHA 0</text>
<text text-anchor="middle" x="3946.7" y="-975.66" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3946.7" y="-964.66" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3946.7" y="-953.66" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer0_mha&#45;&gt;layer0_ln1 -->
<g id="edge2" class="edge">
<title>layer0_mha&#45;&gt;layer0_ln1</title>
<path fill="none" stroke="black" d="M3946.7,-1050.88C3946.7,-1050.88 3946.7,-1008.73 3946.7,-1008.73"/>
<polygon fill="black" stroke="black" points="3950.2,-1008.73 3946.7,-998.73 3943.2,-1008.73 3950.2,-1008.73"/>
</g>
<!-- layer0_ln1&#45;&gt;layer0_add1 -->
<g id="edge3" class="edge">
<title>layer0_ln1&#45;&gt;layer0_add1</title>
<path fill="none" stroke="black" d="M3988.7,-946.61C3988.7,-946.61 3988.7,-904.46 3988.7,-904.46"/>
<polygon fill="black" stroke="black" points="3992.2,-904.46 3988.7,-894.46 3985.2,-904.46 3992.2,-904.46"/>
</g>
<!-- layer0_gate -->
<g id="node5" class="node">
<title>layer0_gate</title>
<polygon fill="lightgreen" stroke="black" points="3807.13,-795.62 3348.3,-795.62 3230.26,-691.62 3689.1,-691.62 3807.13,-795.62"/>
<text text-anchor="middle" x="3518.7" y="-757.62" font-family="Arial" font-size="10.00">Gate Layer 0</text>
<text text-anchor="middle" x="3518.7" y="-746.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3518.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="3518.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer0_add1&#45;&gt;layer0_gate -->
<g id="edge5" class="edge">
<title>layer0_add1&#45;&gt;layer0_gate</title>
<path fill="none" stroke="black" d="M4005.32,-842.07C4005.32,-818.62 4005.32,-788 4005.32,-788 4005.32,-788 3808.6,-788 3808.6,-788"/>
<polygon fill="black" stroke="black" points="3808.6,-784.5 3798.6,-788 3808.6,-791.5 3808.6,-784.5"/>
</g>
<!-- layer0_moe_output -->
<g id="node8" class="node">
<title>layer0_moe_output</title>
<polygon fill="yellow" stroke="black" points="5225.2,-140 4944.2,-140 4944.2,-88 5225.2,-88 5225.2,-140"/>
<text text-anchor="middle" x="5084.7" y="-128" font-family="Arial" font-size="10.00">MoE Residual Add 0</text>
<text text-anchor="middle" x="5084.7" y="-117" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5084.7" y="-106" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5084.7" y="-95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_add1&#45;&gt;layer0_moe_output -->
<g id="edge72" class="edge">
<title>layer0_add1&#45;&gt;layer0_moe_output</title>
<path fill="none" stroke="black" d="M4138.67,-841.98C4138.67,-708.46 4138.67,-114 4138.67,-114 4138.67,-114 4934.09,-114 4934.09,-114"/>
<polygon fill="black" stroke="black" points="4934.09,-117.5 4944.09,-114 4934.09,-110.5 4934.09,-117.5"/>
</g>
<!-- layer0_route_exp0 -->
<g id="node9" class="node">
<title>layer0_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="239.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="239.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="239.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="239.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="239.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp0 -->
<g id="edge6" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp0</title>
<path fill="none" stroke="black" d="M3332.71,-782C2638.67,-782 239.7,-782 239.7,-782 239.7,-782 239.7,-665.87 239.7,-665.87"/>
<polygon fill="black" stroke="black" points="243.2,-665.87 239.7,-655.87 236.2,-665.87 243.2,-665.87"/>
</g>
<!-- layer0_route_exp1 -->
<g id="node12" class="node">
<title>layer0_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="664.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="664.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="664.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="664.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="664.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp1 -->
<g id="edge10" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp1</title>
<path fill="none" stroke="black" d="M3318.01,-769C2668.38,-769 664.7,-769 664.7,-769 664.7,-769 664.7,-665.96 664.7,-665.96"/>
<polygon fill="black" stroke="black" points="668.2,-665.96 664.7,-655.96 661.2,-665.96 668.2,-665.96"/>
</g>
<!-- layer0_route_exp2 -->
<g id="node15" class="node">
<title>layer0_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1079.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="1079.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="1079.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1079.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1079.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp2 -->
<g id="edge14" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp2</title>
<path fill="none" stroke="black" d="M3303.32,-756C2707.28,-756 1079.7,-756 1079.7,-756 1079.7,-756 1079.7,-665.96 1079.7,-665.96"/>
<polygon fill="black" stroke="black" points="1083.2,-665.96 1079.7,-655.96 1076.2,-665.96 1083.2,-665.96"/>
</g>
<!-- layer0_route_exp3 -->
<g id="node18" class="node">
<title>layer0_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1489.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="1489.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="1489.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1489.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1489.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp3 -->
<g id="edge18" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp3</title>
<path fill="none" stroke="black" d="M3288.41,-743C2756.9,-743 1489.7,-743 1489.7,-743 1489.7,-743 1489.7,-665.76 1489.7,-665.76"/>
<polygon fill="black" stroke="black" points="1493.2,-665.76 1489.7,-655.76 1486.2,-665.76 1493.2,-665.76"/>
</g>
<!-- layer0_route_exp4 -->
<g id="node21" class="node">
<title>layer0_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1896.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="1896.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="1896.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1896.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1896.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp4 -->
<g id="edge22" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp4</title>
<path fill="none" stroke="black" d="M3273.67,-730C2820.39,-730 1896.7,-730 1896.7,-730 1896.7,-730 1896.7,-665.86 1896.7,-665.86"/>
<polygon fill="black" stroke="black" points="1900.2,-665.86 1896.7,-655.86 1893.2,-665.86 1900.2,-665.86"/>
</g>
<!-- layer0_route_exp5 -->
<g id="node24" class="node">
<title>layer0_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2302.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="2302.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="2302.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2302.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="2302.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp5 -->
<g id="edge26" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp5</title>
<path fill="none" stroke="black" d="M3258.95,-717C2901.78,-717 2302.7,-717 2302.7,-717 2302.7,-717 2302.7,-665.68 2302.7,-665.68"/>
<polygon fill="black" stroke="black" points="2306.2,-665.68 2302.7,-655.68 2299.2,-665.68 2306.2,-665.68"/>
</g>
<!-- layer0_route_exp6 -->
<g id="node27" class="node">
<title>layer0_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2708.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="2708.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="2708.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2708.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="2708.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp6 -->
<g id="edge30" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp6</title>
<path fill="none" stroke="black" d="M3244.19,-704C3009.24,-704 2708.7,-704 2708.7,-704 2708.7,-704 2708.7,-665.95 2708.7,-665.95"/>
<polygon fill="black" stroke="black" points="2712.2,-665.95 2708.7,-655.95 2705.2,-665.95 2712.2,-665.95"/>
</g>
<!-- layer0_route_exp7 -->
<g id="node30" class="node">
<title>layer0_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3113.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="3113.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="3113.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3113.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3113.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp7 -->
<g id="edge34" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp7</title>
<path fill="none" stroke="black" d="M3268.96,-691.43C3268.96,-691.43 3268.96,-651.03 3268.96,-651.03"/>
<polygon fill="black" stroke="black" points="3272.46,-651.03 3268.96,-641.03 3265.46,-651.03 3272.46,-651.03"/>
</g>
<!-- layer0_route_exp8 -->
<g id="node33" class="node">
<title>layer0_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3518.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="3518.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="3518.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3518.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3518.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp8 -->
<g id="edge38" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp8</title>
<path fill="none" stroke="black" d="M3518.7,-691.43C3518.7,-691.43 3518.7,-665.66 3518.7,-665.66"/>
<polygon fill="black" stroke="black" points="3522.2,-665.66 3518.7,-655.66 3515.2,-665.66 3522.2,-665.66"/>
</g>
<!-- layer0_route_exp9 -->
<g id="node36" class="node">
<title>layer0_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3926.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="3926.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="3926.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3926.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3926.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp9 -->
<g id="edge42" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp9</title>
<path fill="none" stroke="black" d="M3769.93,-743.53C3769.93,-743.53 3769.93,-650.54 3769.93,-650.54"/>
<polygon fill="black" stroke="black" points="3773.43,-650.54 3769.93,-640.54 3766.43,-650.54 3773.43,-650.54"/>
</g>
<!-- layer0_route_exp10 -->
<g id="node39" class="node">
<title>layer0_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4338.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="4338.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="4338.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4338.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="4338.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp10 -->
<g id="edge46" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp10</title>
<path fill="none" stroke="black" d="M3690.88,-693C3880.25,-693 4158.07,-693 4158.07,-693 4158.07,-693 4158.07,-642.45 4158.07,-642.45"/>
<polygon fill="black" stroke="black" points="4161.57,-642.45 4158.07,-632.45 4154.57,-642.45 4161.57,-642.45"/>
</g>
<!-- layer0_route_exp11 -->
<g id="node42" class="node">
<title>layer0_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4752.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="4752.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="4752.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4752.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="4752.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp11 -->
<g id="edge50" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp11</title>
<path fill="none" stroke="black" d="M3693.21,-695C4033.49,-695 4752.7,-695 4752.7,-695 4752.7,-695 4752.7,-666.03 4752.7,-666.03"/>
<polygon fill="black" stroke="black" points="4756.2,-666.03 4752.7,-656.03 4749.2,-666.03 4756.2,-666.03"/>
</g>
<!-- layer0_route_exp12 -->
<g id="node45" class="node">
<title>layer0_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5166.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="5166.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="5166.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5166.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5166.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp12 -->
<g id="edge54" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp12</title>
<path fill="none" stroke="black" d="M3696.53,-698C4092.95,-698 5014.47,-698 5014.47,-698 5014.47,-698 5014.47,-651.74 5014.47,-651.74"/>
<polygon fill="black" stroke="black" points="5017.97,-651.74 5014.47,-641.74 5010.97,-651.74 5017.97,-651.74"/>
</g>
<!-- layer0_route_exp13 -->
<g id="node48" class="node">
<title>layer0_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5581.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="5581.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="5581.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5581.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5581.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp13 -->
<g id="edge58" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp13</title>
<path fill="none" stroke="black" d="M3698.66,-700C4174.84,-700 5431.58,-700 5431.58,-700 5431.58,-700 5431.58,-652.32 5431.58,-652.32"/>
<polygon fill="black" stroke="black" points="5435.08,-652.32 5431.58,-642.32 5428.08,-652.32 5435.08,-652.32"/>
</g>
<!-- layer0_route_exp14 -->
<g id="node51" class="node">
<title>layer0_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5996.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="5996.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="5996.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5996.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5996.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp14 -->
<g id="edge62" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp14</title>
<path fill="none" stroke="black" d="M3701.36,-702C4250.14,-702 5846.58,-702 5846.58,-702 5846.58,-702 5846.58,-652.45 5846.58,-652.45"/>
<polygon fill="black" stroke="black" points="5850.08,-652.45 5846.58,-642.45 5843.08,-652.45 5850.08,-652.45"/>
</g>
<!-- layer0_route_exp15 -->
<g id="node54" class="node">
<title>layer0_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6411.7" cy="-618.85" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="6411.7" y="-632.85" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="6411.7" y="-621.85" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6411.7" y="-610.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6411.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_exp15 -->
<g id="edge66" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_exp15</title>
<path fill="none" stroke="black" d="M3703.32,-704C4315.47,-704 6239.76,-704 6239.76,-704 6239.76,-704 6239.76,-646.08 6239.76,-646.08"/>
<polygon fill="black" stroke="black" points="6243.26,-646.08 6239.76,-636.08 6236.26,-646.08 6243.26,-646.08"/>
</g>
<!-- layer0_moe_agg -->
<g id="node6" class="node">
<title>layer0_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="3518.7" cy="-300.77" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="3518.7" y="-314.77" font-family="Arial" font-size="10.00">MoE Final Aggregation 0</text>
<text text-anchor="middle" x="3518.7" y="-303.77" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3518.7" y="-292.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3518.7" y="-281.77" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer0_ln2 -->
<g id="node7" class="node">
<title>layer0_ln2</title>
<polygon fill="none" stroke="black" points="5141.2,-228 4860.2,-228 4860.2,-176 5141.2,-176 5141.2,-228"/>
<text text-anchor="middle" x="5000.7" y="-216" font-family="Arial" font-size="10.00">LayerNorm MoE 0</text>
<text text-anchor="middle" x="5000.7" y="-205" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5000.7" y="-194" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5000.7" y="-183" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer0_moe_agg&#45;&gt;layer0_ln2 -->
<g id="edge70" class="edge">
<title>layer0_moe_agg&#45;&gt;layer0_ln2</title>
<path fill="none" stroke="black" d="M3646.59,-272C3990.86,-272 4911.3,-272 4911.3,-272 4911.3,-272 4911.3,-238.07 4911.3,-238.07"/>
<polygon fill="black" stroke="black" points="4914.8,-238.07 4911.3,-228.07 4907.8,-238.07 4914.8,-238.07"/>
</g>
<!-- layer0_ln2&#45;&gt;layer0_moe_output -->
<g id="edge71" class="edge">
<title>layer0_ln2&#45;&gt;layer0_moe_output</title>
<path fill="none" stroke="black" d="M5042.7,-175.6C5042.7,-175.6 5042.7,-150.08 5042.7,-150.08"/>
<polygon fill="black" stroke="black" points="5046.2,-150.08 5042.7,-140.08 5039.2,-150.08 5046.2,-150.08"/>
</g>
<!-- layer1_mha -->
<g id="node57" class="node">
<title>layer1_mha</title>
<polygon fill="lightcyan" stroke="black" points="5225.2,-52 4944.2,-52 4944.2,0 5225.2,0 5225.2,-52"/>
<text text-anchor="middle" x="5084.7" y="-40" font-family="Arial" font-size="10.00">MHA Layer 1</text>
<text text-anchor="middle" x="5084.7" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5084.7" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5084.7" y="-7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer0_moe_output&#45;&gt;layer1_mha -->
<g id="edge1078" class="edge">
<title>layer0_moe_output&#45;&gt;layer1_mha</title>
<path fill="none" stroke="black" d="M5084.7,-87.6C5084.7,-87.6 5084.7,-62.08 5084.7,-62.08"/>
<polygon fill="black" stroke="black" points="5088.2,-62.08 5084.7,-52.08 5081.2,-62.08 5088.2,-62.08"/>
</g>
<!-- layer0_expert0 -->
<g id="node10" class="node">
<title>layer0_expert0</title>
<polygon fill="lightcoral" stroke="black" points="349.2,-546.08 128.2,-546.08 128.2,-483.08 349.2,-483.08 349.2,-546.08"/>
<text text-anchor="middle" x="238.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="238.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="238.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="238.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="238.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp0&#45;&gt;layer0_expert0 -->
<g id="edge7" class="edge">
<title>layer0_route_exp0&#45;&gt;layer0_expert0</title>
<path fill="none" stroke="black" d="M238.7,-581.79C238.7,-581.79 238.7,-556.33 238.7,-556.33"/>
<polygon fill="black" stroke="black" points="242.2,-556.33 238.7,-546.33 235.2,-556.33 242.2,-556.33"/>
</g>
<!-- layer0_agg_exp0 -->
<g id="node11" class="node">
<title>layer0_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="198.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="198.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="198.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="198.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="198.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert0&#45;&gt;layer0_agg_exp0 -->
<g id="edge8" class="edge">
<title>layer0_expert0&#45;&gt;layer0_agg_exp0</title>
<path fill="none" stroke="black" d="M238.7,-483.01C238.7,-483.01 238.7,-456.52 238.7,-456.52"/>
<polygon fill="black" stroke="black" points="242.2,-456.52 238.7,-446.52 235.2,-456.52 242.2,-456.52"/>
</g>
<!-- layer0_agg_exp0&#45;&gt;layer0_moe_agg -->
<g id="edge9" class="edge">
<title>layer0_agg_exp0&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M198.7,-373.24C198.7,-332.28 198.7,-272 198.7,-272 198.7,-272 3380.84,-272 3380.84,-272"/>
<polygon fill="black" stroke="black" points="3380.84,-275.5 3390.84,-272 3380.84,-268.5 3380.84,-275.5"/>
</g>
<!-- layer0_expert1 -->
<g id="node13" class="node">
<title>layer0_expert1</title>
<polygon fill="lightcoral" stroke="black" points="749.2,-546.08 528.2,-546.08 528.2,-483.08 749.2,-483.08 749.2,-546.08"/>
<text text-anchor="middle" x="638.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="638.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="638.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="638.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="638.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp1&#45;&gt;layer0_expert1 -->
<g id="edge11" class="edge">
<title>layer0_route_exp1&#45;&gt;layer0_expert1</title>
<path fill="none" stroke="black" d="M638.7,-582.38C638.7,-582.38 638.7,-556.34 638.7,-556.34"/>
<polygon fill="black" stroke="black" points="642.2,-556.34 638.7,-546.34 635.2,-556.34 642.2,-556.34"/>
</g>
<!-- layer0_agg_exp1 -->
<g id="node14" class="node">
<title>layer0_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="613.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="613.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="613.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="613.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="613.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert1&#45;&gt;layer0_agg_exp1 -->
<g id="edge12" class="edge">
<title>layer0_expert1&#45;&gt;layer0_agg_exp1</title>
<path fill="none" stroke="black" d="M638.7,-483.01C638.7,-483.01 638.7,-456.89 638.7,-456.89"/>
<polygon fill="black" stroke="black" points="642.2,-456.89 638.7,-446.89 635.2,-456.89 642.2,-456.89"/>
</g>
<!-- layer0_agg_exp1&#45;&gt;layer0_moe_agg -->
<g id="edge13" class="edge">
<title>layer0_agg_exp1&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M613.7,-373.32C613.7,-334.79 613.7,-280 613.7,-280 613.7,-280 3339.42,-280 3339.42,-280"/>
<polygon fill="black" stroke="black" points="3339.42,-283.5 3349.42,-280 3339.42,-276.5 3339.42,-283.5"/>
</g>
<!-- layer0_expert2 -->
<g id="node16" class="node">
<title>layer0_expert2</title>
<polygon fill="lightcoral" stroke="black" points="1164.2,-546.08 943.2,-546.08 943.2,-483.08 1164.2,-483.08 1164.2,-546.08"/>
<text text-anchor="middle" x="1053.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="1053.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1053.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1053.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1053.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp2&#45;&gt;layer0_expert2 -->
<g id="edge15" class="edge">
<title>layer0_route_exp2&#45;&gt;layer0_expert2</title>
<path fill="none" stroke="black" d="M1053.7,-582.38C1053.7,-582.38 1053.7,-556.34 1053.7,-556.34"/>
<polygon fill="black" stroke="black" points="1057.2,-556.34 1053.7,-546.34 1050.2,-556.34 1057.2,-556.34"/>
</g>
<!-- layer0_agg_exp2 -->
<g id="node17" class="node">
<title>layer0_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="1028.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1028.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="1028.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1028.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1028.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert2&#45;&gt;layer0_agg_exp2 -->
<g id="edge16" class="edge">
<title>layer0_expert2&#45;&gt;layer0_agg_exp2</title>
<path fill="none" stroke="black" d="M1053.7,-483.01C1053.7,-483.01 1053.7,-456.89 1053.7,-456.89"/>
<polygon fill="black" stroke="black" points="1057.2,-456.89 1053.7,-446.89 1050.2,-456.89 1057.2,-456.89"/>
</g>
<!-- layer0_agg_exp2&#45;&gt;layer0_moe_agg -->
<g id="edge17" class="edge">
<title>layer0_agg_exp2&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M1028.7,-373.28C1028.7,-337.28 1028.7,-288 1028.7,-288 1028.7,-288 3316.16,-288 3316.16,-288"/>
<polygon fill="black" stroke="black" points="3316.16,-291.5 3326.16,-288 3316.16,-284.5 3316.16,-291.5"/>
</g>
<!-- layer0_expert3 -->
<g id="node19" class="node">
<title>layer0_expert3</title>
<polygon fill="lightcoral" stroke="black" points="1577.2,-546.08 1356.2,-546.08 1356.2,-483.08 1577.2,-483.08 1577.2,-546.08"/>
<text text-anchor="middle" x="1466.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="1466.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1466.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1466.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1466.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp3&#45;&gt;layer0_expert3 -->
<g id="edge19" class="edge">
<title>layer0_route_exp3&#45;&gt;layer0_expert3</title>
<path fill="none" stroke="black" d="M1466.7,-582.09C1466.7,-582.09 1466.7,-556.17 1466.7,-556.17"/>
<polygon fill="black" stroke="black" points="1470.2,-556.17 1466.7,-546.17 1463.2,-556.17 1470.2,-556.17"/>
</g>
<!-- layer0_agg_exp3 -->
<g id="node20" class="node">
<title>layer0_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="1443.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1443.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="1443.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1443.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1443.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert3&#45;&gt;layer0_agg_exp3 -->
<g id="edge20" class="edge">
<title>layer0_expert3&#45;&gt;layer0_agg_exp3</title>
<path fill="none" stroke="black" d="M1466.7,-483.01C1466.7,-483.01 1466.7,-456.89 1466.7,-456.89"/>
<polygon fill="black" stroke="black" points="1470.2,-456.89 1466.7,-446.89 1463.2,-456.89 1470.2,-456.89"/>
</g>
<!-- layer0_agg_exp3&#45;&gt;layer0_moe_agg -->
<g id="edge21" class="edge">
<title>layer0_agg_exp3&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M1443.7,-373.51C1443.7,-340.1 1443.7,-296 1443.7,-296 1443.7,-296 3305.01,-296 3305.01,-296"/>
<polygon fill="black" stroke="black" points="3305.01,-299.5 3315.01,-296 3305.01,-292.5 3305.01,-299.5"/>
</g>
<!-- layer0_expert4 -->
<g id="node22" class="node">
<title>layer0_expert4</title>
<polygon fill="lightcoral" stroke="black" points="1988.2,-546.08 1767.2,-546.08 1767.2,-483.08 1988.2,-483.08 1988.2,-546.08"/>
<text text-anchor="middle" x="1877.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="1877.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1877.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1877.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1877.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp4&#45;&gt;layer0_expert4 -->
<g id="edge23" class="edge">
<title>layer0_route_exp4&#45;&gt;layer0_expert4</title>
<path fill="none" stroke="black" d="M1877.7,-582.09C1877.7,-582.09 1877.7,-556.17 1877.7,-556.17"/>
<polygon fill="black" stroke="black" points="1881.2,-556.17 1877.7,-546.17 1874.2,-556.17 1881.2,-556.17"/>
</g>
<!-- layer0_agg_exp4 -->
<g id="node23" class="node">
<title>layer0_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="1858.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1858.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="1858.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1858.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1858.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert4&#45;&gt;layer0_agg_exp4 -->
<g id="edge24" class="edge">
<title>layer0_expert4&#45;&gt;layer0_agg_exp4</title>
<path fill="none" stroke="black" d="M1877.7,-483.01C1877.7,-483.01 1877.7,-457.27 1877.7,-457.27"/>
<polygon fill="black" stroke="black" points="1881.2,-457.27 1877.7,-447.27 1874.2,-457.27 1881.2,-457.27"/>
</g>
<!-- layer0_agg_exp4&#45;&gt;layer0_moe_agg -->
<g id="edge25" class="edge">
<title>layer0_agg_exp4&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M1858.7,-373.43C1858.7,-342.72 1858.7,-304 1858.7,-304 1858.7,-304 3304.32,-304 3304.32,-304"/>
<polygon fill="black" stroke="black" points="3304.32,-307.5 3314.32,-304 3304.32,-300.5 3304.32,-307.5"/>
</g>
<!-- layer0_expert5 -->
<g id="node25" class="node">
<title>layer0_expert5</title>
<polygon fill="lightcoral" stroke="black" points="2398.2,-546.08 2177.2,-546.08 2177.2,-483.08 2398.2,-483.08 2398.2,-546.08"/>
<text text-anchor="middle" x="2287.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="2287.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2287.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="2287.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="2287.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp5&#45;&gt;layer0_expert5 -->
<g id="edge27" class="edge">
<title>layer0_route_exp5&#45;&gt;layer0_expert5</title>
<path fill="none" stroke="black" d="M2287.7,-582.09C2287.7,-582.09 2287.7,-556.17 2287.7,-556.17"/>
<polygon fill="black" stroke="black" points="2291.2,-556.17 2287.7,-546.17 2284.2,-556.17 2291.2,-556.17"/>
</g>
<!-- layer0_agg_exp5 -->
<g id="node26" class="node">
<title>layer0_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="2273.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2273.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="2273.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2273.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="2273.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert5&#45;&gt;layer0_agg_exp5 -->
<g id="edge28" class="edge">
<title>layer0_expert5&#45;&gt;layer0_agg_exp5</title>
<path fill="none" stroke="black" d="M2287.7,-483.01C2287.7,-483.01 2287.7,-457.27 2287.7,-457.27"/>
<polygon fill="black" stroke="black" points="2291.2,-457.27 2287.7,-447.27 2284.2,-457.27 2291.2,-457.27"/>
</g>
<!-- layer0_agg_exp5&#45;&gt;layer0_moe_agg -->
<g id="edge29" class="edge">
<title>layer0_agg_exp5&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2273.7,-373.52C2273.7,-345.96 2273.7,-313 2273.7,-313 2273.7,-313 3315.19,-313 3315.19,-313"/>
<polygon fill="black" stroke="black" points="3315.19,-316.5 3325.19,-313 3315.19,-309.5 3315.19,-316.5"/>
</g>
<!-- layer0_expert6 -->
<g id="node28" class="node">
<title>layer0_expert6</title>
<polygon fill="lightcoral" stroke="black" points="2809.2,-546.08 2588.2,-546.08 2588.2,-483.08 2809.2,-483.08 2809.2,-546.08"/>
<text text-anchor="middle" x="2698.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="2698.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2698.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="2698.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="2698.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp6&#45;&gt;layer0_expert6 -->
<g id="edge31" class="edge">
<title>layer0_route_exp6&#45;&gt;layer0_expert6</title>
<path fill="none" stroke="black" d="M2698.7,-582.09C2698.7,-582.09 2698.7,-556.17 2698.7,-556.17"/>
<polygon fill="black" stroke="black" points="2702.2,-556.17 2698.7,-546.17 2695.2,-556.17 2702.2,-556.17"/>
</g>
<!-- layer0_agg_exp6 -->
<g id="node29" class="node">
<title>layer0_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="2688.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2688.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="2688.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2688.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="2688.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert6&#45;&gt;layer0_agg_exp6 -->
<g id="edge32" class="edge">
<title>layer0_expert6&#45;&gt;layer0_agg_exp6</title>
<path fill="none" stroke="black" d="M2698.7,-483.01C2698.7,-483.01 2698.7,-457.27 2698.7,-457.27"/>
<polygon fill="black" stroke="black" points="2702.2,-457.27 2698.7,-447.27 2695.2,-457.27 2702.2,-457.27"/>
</g>
<!-- layer0_agg_exp6&#45;&gt;layer0_moe_agg -->
<g id="edge33" class="edge">
<title>layer0_agg_exp6&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2688.7,-373.47C2688.7,-348.87 2688.7,-321 2688.7,-321 2688.7,-321 3337.22,-321 3337.22,-321"/>
<polygon fill="black" stroke="black" points="3337.22,-324.5 3347.22,-321 3337.22,-317.5 3337.22,-324.5"/>
</g>
<!-- layer0_expert7 -->
<g id="node31" class="node">
<title>layer0_expert7</title>
<polygon fill="lightcoral" stroke="black" points="3219.2,-546.08 2998.2,-546.08 2998.2,-483.08 3219.2,-483.08 3219.2,-546.08"/>
<text text-anchor="middle" x="3108.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="3108.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3108.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3108.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3108.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp7&#45;&gt;layer0_expert7 -->
<g id="edge35" class="edge">
<title>layer0_route_exp7&#45;&gt;layer0_expert7</title>
<path fill="none" stroke="black" d="M3108.7,-582.09C3108.7,-582.09 3108.7,-556.17 3108.7,-556.17"/>
<polygon fill="black" stroke="black" points="3112.2,-556.17 3108.7,-546.17 3105.2,-556.17 3112.2,-556.17"/>
</g>
<!-- layer0_agg_exp7 -->
<g id="node32" class="node">
<title>layer0_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="3103.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3103.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="3103.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3103.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3103.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert7&#45;&gt;layer0_agg_exp7 -->
<g id="edge36" class="edge">
<title>layer0_expert7&#45;&gt;layer0_agg_exp7</title>
<path fill="none" stroke="black" d="M3108.7,-483.01C3108.7,-483.01 3108.7,-457.27 3108.7,-457.27"/>
<polygon fill="black" stroke="black" points="3112.2,-457.27 3108.7,-447.27 3105.2,-457.27 3112.2,-457.27"/>
</g>
<!-- layer0_agg_exp7&#45;&gt;layer0_moe_agg -->
<g id="edge37" class="edge">
<title>layer0_agg_exp7&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M3103.7,-373.46C3103.7,-351.95 3103.7,-329 3103.7,-329 3103.7,-329 3377.1,-329 3377.1,-329"/>
<polygon fill="black" stroke="black" points="3377.1,-332.5 3387.1,-329 3377.1,-325.5 3377.1,-332.5"/>
</g>
<!-- layer0_expert8 -->
<g id="node34" class="node">
<title>layer0_expert8</title>
<polygon fill="lightcoral" stroke="black" points="3629.2,-546.08 3408.2,-546.08 3408.2,-483.08 3629.2,-483.08 3629.2,-546.08"/>
<text text-anchor="middle" x="3518.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="3518.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3518.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3518.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3518.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp8&#45;&gt;layer0_expert8 -->
<g id="edge39" class="edge">
<title>layer0_route_exp8&#45;&gt;layer0_expert8</title>
<path fill="none" stroke="black" d="M3518.7,-581.79C3518.7,-581.79 3518.7,-556.33 3518.7,-556.33"/>
<polygon fill="black" stroke="black" points="3522.2,-556.33 3518.7,-546.33 3515.2,-556.33 3522.2,-556.33"/>
</g>
<!-- layer0_agg_exp8 -->
<g id="node35" class="node">
<title>layer0_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="3518.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3518.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="3518.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3518.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3518.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert8&#45;&gt;layer0_agg_exp8 -->
<g id="edge40" class="edge">
<title>layer0_expert8&#45;&gt;layer0_agg_exp8</title>
<path fill="none" stroke="black" d="M3518.7,-483.01C3518.7,-483.01 3518.7,-457.27 3518.7,-457.27"/>
<polygon fill="black" stroke="black" points="3522.2,-457.27 3518.7,-447.27 3515.2,-457.27 3522.2,-457.27"/>
</g>
<!-- layer0_agg_exp8&#45;&gt;layer0_moe_agg -->
<g id="edge41" class="edge">
<title>layer0_agg_exp8&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M3518.7,-373.53C3518.7,-373.53 3518.7,-347.64 3518.7,-347.64"/>
<polygon fill="black" stroke="black" points="3522.2,-347.64 3518.7,-337.64 3515.2,-347.64 3522.2,-347.64"/>
</g>
<!-- layer0_expert9 -->
<g id="node37" class="node">
<title>layer0_expert9</title>
<polygon fill="lightcoral" stroke="black" points="4039.2,-546.08 3818.2,-546.08 3818.2,-483.08 4039.2,-483.08 4039.2,-546.08"/>
<text text-anchor="middle" x="3928.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="3928.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3928.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3928.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3928.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp9&#45;&gt;layer0_expert9 -->
<g id="edge43" class="edge">
<title>layer0_route_exp9&#45;&gt;layer0_expert9</title>
<path fill="none" stroke="black" d="M3928.7,-581.79C3928.7,-581.79 3928.7,-556.33 3928.7,-556.33"/>
<polygon fill="black" stroke="black" points="3932.2,-556.33 3928.7,-546.33 3925.2,-556.33 3932.2,-556.33"/>
</g>
<!-- layer0_agg_exp9 -->
<g id="node38" class="node">
<title>layer0_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="3933.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3933.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="3933.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3933.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3933.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert9&#45;&gt;layer0_agg_exp9 -->
<g id="edge44" class="edge">
<title>layer0_expert9&#45;&gt;layer0_agg_exp9</title>
<path fill="none" stroke="black" d="M3928.7,-483.01C3928.7,-483.01 3928.7,-457.27 3928.7,-457.27"/>
<polygon fill="black" stroke="black" points="3932.2,-457.27 3928.7,-447.27 3925.2,-457.27 3932.2,-457.27"/>
</g>
<!-- layer0_agg_exp9&#45;&gt;layer0_moe_agg -->
<g id="edge45" class="edge">
<title>layer0_agg_exp9&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M3933.7,-373.46C3933.7,-351.95 3933.7,-329 3933.7,-329 3933.7,-329 3660.29,-329 3660.29,-329"/>
<polygon fill="black" stroke="black" points="3660.29,-325.5 3650.29,-329 3660.29,-332.5 3660.29,-325.5"/>
</g>
<!-- layer0_expert10 -->
<g id="node40" class="node">
<title>layer0_expert10</title>
<polygon fill="lightcoral" stroke="black" points="4454.2,-546.08 4233.2,-546.08 4233.2,-483.08 4454.2,-483.08 4454.2,-546.08"/>
<text text-anchor="middle" x="4343.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="4343.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4343.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="4343.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="4343.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp10&#45;&gt;layer0_expert10 -->
<g id="edge47" class="edge">
<title>layer0_route_exp10&#45;&gt;layer0_expert10</title>
<path fill="none" stroke="black" d="M4343.7,-582.09C4343.7,-582.09 4343.7,-556.17 4343.7,-556.17"/>
<polygon fill="black" stroke="black" points="4347.2,-556.17 4343.7,-546.17 4340.2,-556.17 4347.2,-556.17"/>
</g>
<!-- layer0_agg_exp10 -->
<g id="node41" class="node">
<title>layer0_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="4348.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4348.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="4348.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4348.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="4348.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert10&#45;&gt;layer0_agg_exp10 -->
<g id="edge48" class="edge">
<title>layer0_expert10&#45;&gt;layer0_agg_exp10</title>
<path fill="none" stroke="black" d="M4343.7,-483.01C4343.7,-483.01 4343.7,-457.27 4343.7,-457.27"/>
<polygon fill="black" stroke="black" points="4347.2,-457.27 4343.7,-447.27 4340.2,-457.27 4347.2,-457.27"/>
</g>
<!-- layer0_agg_exp10&#45;&gt;layer0_moe_agg -->
<g id="edge49" class="edge">
<title>layer0_agg_exp10&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M4348.7,-373.47C4348.7,-348.87 4348.7,-321 4348.7,-321 4348.7,-321 3700.17,-321 3700.17,-321"/>
<polygon fill="black" stroke="black" points="3700.17,-317.5 3690.17,-321 3700.17,-324.5 3700.17,-317.5"/>
</g>
<!-- layer0_expert11 -->
<g id="node43" class="node">
<title>layer0_expert11</title>
<polygon fill="lightcoral" stroke="black" points="4868.2,-546.08 4647.2,-546.08 4647.2,-483.08 4868.2,-483.08 4868.2,-546.08"/>
<text text-anchor="middle" x="4757.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="4757.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4757.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="4757.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="4757.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp11&#45;&gt;layer0_expert11 -->
<g id="edge51" class="edge">
<title>layer0_route_exp11&#45;&gt;layer0_expert11</title>
<path fill="none" stroke="black" d="M4757.7,-582.09C4757.7,-582.09 4757.7,-556.17 4757.7,-556.17"/>
<polygon fill="black" stroke="black" points="4761.2,-556.17 4757.7,-546.17 4754.2,-556.17 4761.2,-556.17"/>
</g>
<!-- layer0_agg_exp11 -->
<g id="node44" class="node">
<title>layer0_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="4763.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4763.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="4763.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4763.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="4763.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert11&#45;&gt;layer0_agg_exp11 -->
<g id="edge52" class="edge">
<title>layer0_expert11&#45;&gt;layer0_agg_exp11</title>
<path fill="none" stroke="black" d="M4757.7,-483.01C4757.7,-483.01 4757.7,-457.27 4757.7,-457.27"/>
<polygon fill="black" stroke="black" points="4761.2,-457.27 4757.7,-447.27 4754.2,-457.27 4761.2,-457.27"/>
</g>
<!-- layer0_agg_exp11&#45;&gt;layer0_moe_agg -->
<g id="edge53" class="edge">
<title>layer0_agg_exp11&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M4712.6,-374.63C4712.6,-346.86 4712.6,-313 4712.6,-313 4712.6,-313 3722.18,-313 3722.18,-313"/>
<polygon fill="black" stroke="black" points="3722.18,-309.5 3712.18,-313 3722.18,-316.5 3722.18,-309.5"/>
</g>
<!-- layer0_expert12 -->
<g id="node46" class="node">
<title>layer0_expert12</title>
<polygon fill="lightcoral" stroke="black" points="5283.2,-546.08 5062.2,-546.08 5062.2,-483.08 5283.2,-483.08 5283.2,-546.08"/>
<text text-anchor="middle" x="5172.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="5172.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5172.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5172.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5172.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp12&#45;&gt;layer0_expert12 -->
<g id="edge55" class="edge">
<title>layer0_route_exp12&#45;&gt;layer0_expert12</title>
<path fill="none" stroke="black" d="M5172.7,-582.09C5172.7,-582.09 5172.7,-556.17 5172.7,-556.17"/>
<polygon fill="black" stroke="black" points="5176.2,-556.17 5172.7,-546.17 5169.2,-556.17 5176.2,-556.17"/>
</g>
<!-- layer0_agg_exp12 -->
<g id="node47" class="node">
<title>layer0_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="5178.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5178.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="5178.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5178.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5178.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert12&#45;&gt;layer0_agg_exp12 -->
<g id="edge56" class="edge">
<title>layer0_expert12&#45;&gt;layer0_agg_exp12</title>
<path fill="none" stroke="black" d="M5172.7,-483.01C5172.7,-483.01 5172.7,-457.27 5172.7,-457.27"/>
<polygon fill="black" stroke="black" points="5176.2,-457.27 5172.7,-447.27 5169.2,-457.27 5176.2,-457.27"/>
</g>
<!-- layer0_agg_exp12&#45;&gt;layer0_moe_agg -->
<g id="edge57" class="edge">
<title>layer0_agg_exp12&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M5060.6,-380.7C5060.6,-349.24 5060.6,-304 5060.6,-304 5060.6,-304 3733.05,-304 3733.05,-304"/>
<polygon fill="black" stroke="black" points="3733.05,-300.5 3723.05,-304 3733.05,-307.5 3733.05,-300.5"/>
</g>
<!-- layer0_expert13 -->
<g id="node49" class="node">
<title>layer0_expert13</title>
<polygon fill="lightcoral" stroke="black" points="5698.2,-546.08 5477.2,-546.08 5477.2,-483.08 5698.2,-483.08 5698.2,-546.08"/>
<text text-anchor="middle" x="5587.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="5587.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5587.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5587.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5587.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp13&#45;&gt;layer0_expert13 -->
<g id="edge59" class="edge">
<title>layer0_route_exp13&#45;&gt;layer0_expert13</title>
<path fill="none" stroke="black" d="M5587.7,-582.09C5587.7,-582.09 5587.7,-556.17 5587.7,-556.17"/>
<polygon fill="black" stroke="black" points="5591.2,-556.17 5587.7,-546.17 5584.2,-556.17 5591.2,-556.17"/>
</g>
<!-- layer0_agg_exp13 -->
<g id="node50" class="node">
<title>layer0_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="5593.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5593.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="5593.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5593.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5593.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert13&#45;&gt;layer0_agg_exp13 -->
<g id="edge60" class="edge">
<title>layer0_expert13&#45;&gt;layer0_agg_exp13</title>
<path fill="none" stroke="black" d="M5587.7,-483.01C5587.7,-483.01 5587.7,-457.27 5587.7,-457.27"/>
<polygon fill="black" stroke="black" points="5591.2,-457.27 5587.7,-447.27 5584.2,-457.27 5591.2,-457.27"/>
</g>
<!-- layer0_agg_exp13&#45;&gt;layer0_moe_agg -->
<g id="edge61" class="edge">
<title>layer0_agg_exp13&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M5593.7,-373.51C5593.7,-340.1 5593.7,-296 5593.7,-296 5593.7,-296 3732.38,-296 3732.38,-296"/>
<polygon fill="black" stroke="black" points="3732.38,-292.5 3722.38,-296 3732.38,-299.5 3732.38,-292.5"/>
</g>
<!-- layer0_expert14 -->
<g id="node52" class="node">
<title>layer0_expert14</title>
<polygon fill="lightcoral" stroke="black" points="6113.2,-546.08 5892.2,-546.08 5892.2,-483.08 6113.2,-483.08 6113.2,-546.08"/>
<text text-anchor="middle" x="6002.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="6002.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="6002.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6002.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6002.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp14&#45;&gt;layer0_expert14 -->
<g id="edge63" class="edge">
<title>layer0_route_exp14&#45;&gt;layer0_expert14</title>
<path fill="none" stroke="black" d="M6002.7,-582.09C6002.7,-582.09 6002.7,-556.17 6002.7,-556.17"/>
<polygon fill="black" stroke="black" points="6006.2,-556.17 6002.7,-546.17 5999.2,-556.17 6006.2,-556.17"/>
</g>
<!-- layer0_agg_exp14 -->
<g id="node53" class="node">
<title>layer0_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="6008.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="6008.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="6008.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="6008.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6008.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert14&#45;&gt;layer0_agg_exp14 -->
<g id="edge64" class="edge">
<title>layer0_expert14&#45;&gt;layer0_agg_exp14</title>
<path fill="none" stroke="black" d="M6002.7,-483.01C6002.7,-483.01 6002.7,-457.27 6002.7,-457.27"/>
<polygon fill="black" stroke="black" points="6006.2,-457.27 6002.7,-447.27 5999.2,-457.27 6006.2,-457.27"/>
</g>
<!-- layer0_agg_exp14&#45;&gt;layer0_moe_agg -->
<g id="edge65" class="edge">
<title>layer0_agg_exp14&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M6008.7,-373.28C6008.7,-337.28 6008.7,-288 6008.7,-288 6008.7,-288 3721.24,-288 3721.24,-288"/>
<polygon fill="black" stroke="black" points="3721.24,-284.5 3711.24,-288 3721.24,-291.5 3721.24,-284.5"/>
</g>
<!-- layer0_expert15 -->
<g id="node55" class="node">
<title>layer0_expert15</title>
<polygon fill="lightcoral" stroke="black" points="6528.2,-546.08 6307.2,-546.08 6307.2,-483.08 6528.2,-483.08 6528.2,-546.08"/>
<text text-anchor="middle" x="6417.7" y="-534.08" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="6417.7" y="-523.08" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6417.7" y="-512.08" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6417.7" y="-501.08" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6417.7" y="-490.08" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer0_route_exp15&#45;&gt;layer0_expert15 -->
<g id="edge67" class="edge">
<title>layer0_route_exp15&#45;&gt;layer0_expert15</title>
<path fill="none" stroke="black" d="M6417.7,-582.09C6417.7,-582.09 6417.7,-556.17 6417.7,-556.17"/>
<polygon fill="black" stroke="black" points="6421.2,-556.17 6417.7,-546.17 6414.2,-556.17 6421.2,-556.17"/>
</g>
<!-- layer0_agg_exp15 -->
<g id="node56" class="node">
<title>layer0_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="6423.7" cy="-410.31" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="6423.7" y="-424.31" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="6423.7" y="-413.31" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6423.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6423.7" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer0_expert15&#45;&gt;layer0_agg_exp15 -->
<g id="edge68" class="edge">
<title>layer0_expert15&#45;&gt;layer0_agg_exp15</title>
<path fill="none" stroke="black" d="M6417.7,-483.01C6417.7,-483.01 6417.7,-457.27 6417.7,-457.27"/>
<polygon fill="black" stroke="black" points="6421.2,-457.27 6417.7,-447.27 6414.2,-457.27 6421.2,-457.27"/>
</g>
<!-- layer0_agg_exp15&#45;&gt;layer0_moe_agg -->
<g id="edge69" class="edge">
<title>layer0_agg_exp15&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M6423.7,-373.32C6423.7,-334.79 6423.7,-280 6423.7,-280 6423.7,-280 3697.97,-280 3697.97,-280"/>
<polygon fill="black" stroke="black" points="3697.97,-276.5 3687.97,-280 3697.97,-283.5 3697.97,-276.5"/>
</g>
<!-- layer1_ln1 -->
<g id="node58" class="node">
<title>layer1_ln1</title>
<polygon fill="none" stroke="black" points="6846.2,-1227.7 6565.2,-1227.7 6565.2,-1175.7 6846.2,-1175.7 6846.2,-1227.7"/>
<text text-anchor="middle" x="6705.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 1</text>
<text text-anchor="middle" x="6705.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6705.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6705.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer1_add1 -->
<g id="node59" class="node">
<title>layer1_add1</title>
<polygon fill="yellow" stroke="black" points="8208.2,-644.85 7927.2,-644.85 7927.2,-592.85 8208.2,-592.85 8208.2,-644.85"/>
<text text-anchor="middle" x="8067.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 1</text>
<text text-anchor="middle" x="8067.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8067.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8067.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_moe_output -->
<g id="node63" class="node">
<title>layer1_moe_output</title>
<polygon fill="yellow" stroke="black" points="8357.2,-540.58 8076.2,-540.58 8076.2,-488.58 8357.2,-488.58 8357.2,-540.58"/>
<text text-anchor="middle" x="8216.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 1</text>
<text text-anchor="middle" x="8216.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8216.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8216.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_add1&#45;&gt;layer1_moe_output -->
<g id="edge139" class="edge">
<title>layer1_add1&#45;&gt;layer1_moe_output</title>
<path fill="none" stroke="black" d="M8142.2,-592.81C8142.2,-592.81 8142.2,-550.65 8142.2,-550.65"/>
<polygon fill="black" stroke="black" points="8145.7,-550.65 8142.2,-540.65 8138.7,-550.65 8145.7,-550.65"/>
</g>
<!-- layer1_gate -->
<g id="node60" class="node">
<title>layer1_gate</title>
<polygon fill="lightgreen" stroke="black" points="8658.13,-1253.7 8199.3,-1253.7 8081.26,-1149.7 8540.1,-1149.7 8658.13,-1253.7"/>
<text text-anchor="middle" x="8369.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 1</text>
<text text-anchor="middle" x="8369.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8369.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="8369.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer1_route_exp0 -->
<g id="node64" class="node">
<title>layer1_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5261.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="5261.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="5261.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="5261.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5261.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp0 -->
<g id="edge73" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp0</title>
<path fill="none" stroke="black" d="M8106.39,-1172C7356.22,-1172 5261.7,-1172 5261.7,-1172 5261.7,-1172 5261.7,-1123.96 5261.7,-1123.96"/>
<polygon fill="black" stroke="black" points="5265.2,-1123.96 5261.7,-1113.96 5258.2,-1123.96 5265.2,-1123.96"/>
</g>
<!-- layer1_route_exp1 -->
<g id="node67" class="node">
<title>layer1_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5701.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="5701.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="5701.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="5701.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5701.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp1 -->
<g id="edge77" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp1</title>
<path fill="none" stroke="black" d="M8102.9,-1169C7427.19,-1169 5701.7,-1169 5701.7,-1169 5701.7,-1169 5701.7,-1123.85 5701.7,-1123.85"/>
<polygon fill="black" stroke="black" points="5705.2,-1123.85 5701.7,-1113.85 5698.2,-1123.85 5705.2,-1123.85"/>
</g>
<!-- layer1_route_exp2 -->
<g id="node70" class="node">
<title>layer1_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6123.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="6123.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="6123.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="6123.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6123.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp2 -->
<g id="edge81" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp2</title>
<path fill="none" stroke="black" d="M8098.5,-1165C7500.98,-1165 6123.7,-1165 6123.7,-1165 6123.7,-1165 6123.7,-1123.77 6123.7,-1123.77"/>
<polygon fill="black" stroke="black" points="6127.2,-1123.77 6123.7,-1113.77 6120.2,-1123.77 6127.2,-1123.77"/>
</g>
<!-- layer1_route_exp3 -->
<g id="node73" class="node">
<title>layer1_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6537.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="6537.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="6537.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="6537.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6537.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp3 -->
<g id="edge85" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp3</title>
<path fill="none" stroke="black" d="M8095.04,-1162C7609.04,-1162 6648.32,-1162 6648.32,-1162 6648.32,-1162 6648.32,-1117.16 6648.32,-1117.16"/>
<polygon fill="black" stroke="black" points="6651.82,-1117.16 6648.32,-1107.16 6644.82,-1117.16 6651.82,-1117.16"/>
</g>
<!-- layer1_route_exp4 -->
<g id="node76" class="node">
<title>layer1_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6946.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="6946.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="6946.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="6946.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6946.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp4 -->
<g id="edge89" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp4</title>
<path fill="none" stroke="black" d="M8091.58,-1159C7689.46,-1159 6993.32,-1159 6993.32,-1159 6993.32,-1159 6993.32,-1122.69 6993.32,-1122.69"/>
<polygon fill="black" stroke="black" points="6996.82,-1122.69 6993.32,-1112.69 6989.82,-1122.69 6996.82,-1122.69"/>
</g>
<!-- layer1_route_exp5 -->
<g id="node79" class="node">
<title>layer1_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="7353.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="7353.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="7353.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="7353.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="7353.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp5 -->
<g id="edge93" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp5</title>
<path fill="none" stroke="black" d="M8088.37,-1156C7787.68,-1156 7353.7,-1156 7353.7,-1156 7353.7,-1156 7353.7,-1124.15 7353.7,-1124.15"/>
<polygon fill="black" stroke="black" points="7357.2,-1124.15 7353.7,-1114.15 7350.2,-1124.15 7357.2,-1124.15"/>
</g>
<!-- layer1_route_exp6 -->
<g id="node82" class="node">
<title>layer1_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="7759.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="7759.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="7759.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="7759.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="7759.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp6 -->
<g id="edge97" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp6</title>
<path fill="none" stroke="black" d="M8083.45,-1152C7924.96,-1152 7759.7,-1152 7759.7,-1152 7759.7,-1152 7759.7,-1124.02 7759.7,-1124.02"/>
<polygon fill="black" stroke="black" points="7763.2,-1124.02 7759.7,-1114.02 7756.2,-1124.02 7763.2,-1124.02"/>
</g>
<!-- layer1_route_exp7 -->
<g id="node85" class="node">
<title>layer1_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8165.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="8165.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="8165.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="8165.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8165.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp7 -->
<g id="edge101" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp7</title>
<path fill="none" stroke="black" d="M8220.46,-1149.5C8220.46,-1149.5 8220.46,-1122.25 8220.46,-1122.25"/>
<polygon fill="black" stroke="black" points="8223.96,-1122.25 8220.46,-1112.25 8216.96,-1122.25 8223.96,-1122.25"/>
</g>
<!-- layer1_route_exp8 -->
<g id="node88" class="node">
<title>layer1_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8571.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="8571.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="8571.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="8571.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8571.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp8 -->
<g id="edge105" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp8</title>
<path fill="none" stroke="black" d="M8517.93,-1149.5C8517.93,-1149.5 8517.93,-1122.25 8517.93,-1122.25"/>
<polygon fill="black" stroke="black" points="8521.43,-1122.25 8517.93,-1112.25 8514.43,-1122.25 8521.43,-1122.25"/>
</g>
<!-- layer1_route_exp9 -->
<g id="node91" class="node">
<title>layer1_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8980.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="8980.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="8980.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="8980.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8980.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp9 -->
<g id="edge109" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp9</title>
<path fill="none" stroke="black" d="M8543.97,-1153C8724.56,-1153 8980.7,-1153 8980.7,-1153 8980.7,-1153 8980.7,-1124.07 8980.7,-1124.07"/>
<polygon fill="black" stroke="black" points="8984.2,-1124.07 8980.7,-1114.07 8977.2,-1124.07 8984.2,-1124.07"/>
</g>
<!-- layer1_route_exp10 -->
<g id="node94" class="node">
<title>layer1_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="9391.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="9391.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="9391.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="9391.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="9391.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp10 -->
<g id="edge113" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp10</title>
<path fill="none" stroke="black" d="M8547.42,-1156C8840.16,-1156 9391.7,-1156 9391.7,-1156 9391.7,-1156 9391.7,-1124.15 9391.7,-1124.15"/>
<polygon fill="black" stroke="black" points="9395.2,-1124.15 9391.7,-1114.15 9388.2,-1124.15 9395.2,-1124.15"/>
</g>
<!-- layer1_route_exp11 -->
<g id="node97" class="node">
<title>layer1_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="9803.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="9803.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="9803.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="9803.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="9803.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp11 -->
<g id="edge117" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp11</title>
<path fill="none" stroke="black" d="M8552.04,-1160C8938.27,-1160 9803.7,-1160 9803.7,-1160 9803.7,-1160 9803.7,-1124.09 9803.7,-1124.09"/>
<polygon fill="black" stroke="black" points="9807.2,-1124.09 9803.7,-1114.09 9800.2,-1124.09 9807.2,-1124.09"/>
</g>
<!-- layer1_route_exp12 -->
<g id="node100" class="node">
<title>layer1_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="10213.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="10213.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="10213.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="10213.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10213.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp12 -->
<g id="edge121" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp12</title>
<path fill="none" stroke="black" d="M8555.38,-1163C9023.29,-1163 10213.7,-1163 10213.7,-1163 10213.7,-1163 10213.7,-1123.93 10213.7,-1123.93"/>
<polygon fill="black" stroke="black" points="10217.2,-1123.93 10213.7,-1113.93 10210.2,-1123.93 10217.2,-1123.93"/>
</g>
<!-- layer1_route_exp13 -->
<g id="node103" class="node">
<title>layer1_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="10630.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="10630.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="10630.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="10630.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10630.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp13 -->
<g id="edge125" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp13</title>
<path fill="none" stroke="black" d="M8560.03,-1167C9104.71,-1167 10630.7,-1167 10630.7,-1167 10630.7,-1167 10630.7,-1123.82 10630.7,-1123.82"/>
<polygon fill="black" stroke="black" points="10634.2,-1123.82 10630.7,-1113.82 10627.2,-1123.82 10634.2,-1123.82"/>
</g>
<!-- layer1_route_exp14 -->
<g id="node106" class="node">
<title>layer1_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="11046.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="11046.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="11046.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="11046.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11046.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp14 -->
<g id="edge129" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp14</title>
<path fill="none" stroke="black" d="M8563.3,-1170C9178.22,-1170 11046.7,-1170 11046.7,-1170 11046.7,-1170 11046.7,-1123.71 11046.7,-1123.71"/>
<polygon fill="black" stroke="black" points="11050.2,-1123.71 11046.7,-1113.71 11043.2,-1123.71 11050.2,-1123.71"/>
</g>
<!-- layer1_route_exp15 -->
<g id="node109" class="node">
<title>layer1_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="11460.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="11460.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="11460.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="11460.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11460.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_exp15 -->
<g id="edge133" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_exp15</title>
<path fill="none" stroke="black" d="M8565.58,-1172C9236.98,-1172 11404.07,-1172 11404.07,-1172 11404.07,-1172 11404.07,-1122.33 11404.07,-1122.33"/>
<polygon fill="black" stroke="black" points="11407.57,-1122.33 11404.07,-1112.33 11400.57,-1122.33 11407.57,-1122.33"/>
</g>
<!-- layer1_moe_agg -->
<g id="node61" class="node">
<title>layer1_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="8366.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="8366.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 1</text>
<text text-anchor="middle" x="8366.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8366.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8366.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer1_ln2 -->
<g id="node62" class="node">
<title>layer1_ln2</title>
<polygon fill="none" stroke="black" points="8507.2,-644.85 8226.2,-644.85 8226.2,-592.85 8507.2,-592.85 8507.2,-644.85"/>
<text text-anchor="middle" x="8366.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 1</text>
<text text-anchor="middle" x="8366.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8366.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8366.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer1_moe_agg&#45;&gt;layer1_ln2 -->
<g id="edge137" class="edge">
<title>layer1_moe_agg&#45;&gt;layer1_ln2</title>
<path fill="none" stroke="black" d="M8366.7,-706.52C8366.7,-706.52 8366.7,-654.92 8366.7,-654.92"/>
<polygon fill="black" stroke="black" points="8370.2,-654.92 8366.7,-644.92 8363.2,-654.92 8370.2,-654.92"/>
</g>
<!-- layer1_ln2&#45;&gt;layer1_moe_output -->
<g id="edge138" class="edge">
<title>layer1_ln2&#45;&gt;layer1_moe_output</title>
<path fill="none" stroke="black" d="M8291.7,-592.81C8291.7,-592.81 8291.7,-550.65 8291.7,-550.65"/>
<polygon fill="black" stroke="black" points="8295.2,-550.65 8291.7,-540.65 8288.2,-550.65 8295.2,-550.65"/>
</g>
<!-- layer2_mha -->
<g id="node112" class="node">
<title>layer2_mha</title>
<polygon fill="lightcyan" stroke="black" points="8357.2,-436.31 8076.2,-436.31 8076.2,-384.31 8357.2,-384.31 8357.2,-436.31"/>
<text text-anchor="middle" x="8216.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 2</text>
<text text-anchor="middle" x="8216.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8216.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8216.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer1_moe_output&#45;&gt;layer2_mha -->
<g id="edge1079" class="edge">
<title>layer1_moe_output&#45;&gt;layer2_mha</title>
<path fill="none" stroke="black" d="M8216.7,-488.54C8216.7,-488.54 8216.7,-446.38 8216.7,-446.38"/>
<polygon fill="black" stroke="black" points="8220.2,-446.38 8216.7,-436.38 8213.2,-446.38 8220.2,-446.38"/>
</g>
<!-- layer1_expert0 -->
<g id="node65" class="node">
<title>layer1_expert0</title>
<polygon fill="lightcoral" stroke="black" points="5368.2,-1004.16 5147.2,-1004.16 5147.2,-941.16 5368.2,-941.16 5368.2,-1004.16"/>
<text text-anchor="middle" x="5257.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="5257.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="5257.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5257.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5257.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp0&#45;&gt;layer1_expert0 -->
<g id="edge74" class="edge">
<title>layer1_route_exp0&#45;&gt;layer1_expert0</title>
<path fill="none" stroke="black" d="M5257.7,-1039.87C5257.7,-1039.87 5257.7,-1014.41 5257.7,-1014.41"/>
<polygon fill="black" stroke="black" points="5261.2,-1014.41 5257.7,-1004.41 5254.2,-1014.41 5261.2,-1014.41"/>
</g>
<!-- layer1_agg_exp0 -->
<g id="node66" class="node">
<title>layer1_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="5254.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5254.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="5254.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="5254.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5254.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert0&#45;&gt;layer1_agg_exp0 -->
<g id="edge75" class="edge">
<title>layer1_expert0&#45;&gt;layer1_agg_exp0</title>
<path fill="none" stroke="black" d="M5257.7,-941.09C5257.7,-941.09 5257.7,-915.34 5257.7,-915.34"/>
<polygon fill="black" stroke="black" points="5261.2,-915.34 5257.7,-905.34 5254.2,-915.34 5261.2,-915.34"/>
</g>
<!-- layer1_agg_exp0&#45;&gt;layer1_moe_agg -->
<g id="edge76" class="edge">
<title>layer1_agg_exp0&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M5409.76,-845.24C5409.76,-802.61 5409.76,-716 5409.76,-716 5409.76,-716 8220.99,-716 8220.99,-716"/>
<polygon fill="black" stroke="black" points="8220.99,-719.5 8230.99,-716 8220.99,-712.5 8220.99,-719.5"/>
</g>
<!-- layer1_expert1 -->
<g id="node68" class="node">
<title>layer1_expert1</title>
<polygon fill="lightcoral" stroke="black" points="5795.2,-1004.16 5574.2,-1004.16 5574.2,-941.16 5795.2,-941.16 5795.2,-1004.16"/>
<text text-anchor="middle" x="5684.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="5684.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="5684.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5684.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5684.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp1&#45;&gt;layer1_expert1 -->
<g id="edge78" class="edge">
<title>layer1_route_exp1&#45;&gt;layer1_expert1</title>
<path fill="none" stroke="black" d="M5684.7,-1040.16C5684.7,-1040.16 5684.7,-1014.25 5684.7,-1014.25"/>
<polygon fill="black" stroke="black" points="5688.2,-1014.25 5684.7,-1004.25 5681.2,-1014.25 5688.2,-1014.25"/>
</g>
<!-- layer1_agg_exp1 -->
<g id="node69" class="node">
<title>layer1_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="5669.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5669.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="5669.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="5669.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5669.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert1&#45;&gt;layer1_agg_exp1 -->
<g id="edge79" class="edge">
<title>layer1_expert1&#45;&gt;layer1_agg_exp1</title>
<path fill="none" stroke="black" d="M5684.7,-941.09C5684.7,-941.09 5684.7,-915.34 5684.7,-915.34"/>
<polygon fill="black" stroke="black" points="5688.2,-915.34 5684.7,-905.34 5681.2,-915.34 5688.2,-915.34"/>
</g>
<!-- layer1_agg_exp1&#45;&gt;layer1_moe_agg -->
<g id="edge80" class="edge">
<title>layer1_agg_exp1&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M5824.76,-845.35C5824.76,-804.82 5824.76,-725 5824.76,-725 5824.76,-725 8179.72,-725 8179.72,-725"/>
<polygon fill="black" stroke="black" points="8179.72,-728.5 8189.72,-725 8179.72,-721.5 8179.72,-728.5"/>
</g>
<!-- layer1_expert2 -->
<g id="node71" class="node">
<title>layer1_expert2</title>
<polygon fill="lightcoral" stroke="black" points="6214.2,-1004.16 5993.2,-1004.16 5993.2,-941.16 6214.2,-941.16 6214.2,-1004.16"/>
<text text-anchor="middle" x="6103.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="6103.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="6103.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6103.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6103.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp2&#45;&gt;layer1_expert2 -->
<g id="edge82" class="edge">
<title>layer1_route_exp2&#45;&gt;layer1_expert2</title>
<path fill="none" stroke="black" d="M6103.7,-1040.16C6103.7,-1040.16 6103.7,-1014.25 6103.7,-1014.25"/>
<polygon fill="black" stroke="black" points="6107.2,-1014.25 6103.7,-1004.25 6100.2,-1014.25 6107.2,-1014.25"/>
</g>
<!-- layer1_agg_exp2 -->
<g id="node72" class="node">
<title>layer1_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="6084.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="6084.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="6084.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="6084.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6084.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert2&#45;&gt;layer1_agg_exp2 -->
<g id="edge83" class="edge">
<title>layer1_expert2&#45;&gt;layer1_agg_exp2</title>
<path fill="none" stroke="black" d="M6103.7,-941.09C6103.7,-941.09 6103.7,-915.34 6103.7,-915.34"/>
<polygon fill="black" stroke="black" points="6107.2,-915.34 6103.7,-905.34 6100.2,-915.34 6107.2,-915.34"/>
</g>
<!-- layer1_agg_exp2&#45;&gt;layer1_moe_agg -->
<g id="edge84" class="edge">
<title>layer1_agg_exp2&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M6261.58,-851.37C6261.58,-815.21 6261.58,-734 6261.58,-734 6261.58,-734 8158.65,-734 8158.65,-734"/>
<polygon fill="black" stroke="black" points="8158.65,-737.5 8168.65,-734 8158.65,-730.5 8158.65,-737.5"/>
</g>
<!-- layer1_expert3 -->
<g id="node74" class="node">
<title>layer1_expert3</title>
<polygon fill="lightcoral" stroke="black" points="6628.2,-1004.16 6407.2,-1004.16 6407.2,-941.16 6628.2,-941.16 6628.2,-1004.16"/>
<text text-anchor="middle" x="6517.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="6517.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="6517.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6517.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6517.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp3&#45;&gt;layer1_expert3 -->
<g id="edge86" class="edge">
<title>layer1_route_exp3&#45;&gt;layer1_expert3</title>
<path fill="none" stroke="black" d="M6517.7,-1040.16C6517.7,-1040.16 6517.7,-1014.25 6517.7,-1014.25"/>
<polygon fill="black" stroke="black" points="6521.2,-1014.25 6517.7,-1004.25 6514.2,-1014.25 6521.2,-1014.25"/>
</g>
<!-- layer1_agg_exp3 -->
<g id="node75" class="node">
<title>layer1_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="6499.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="6499.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="6499.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="6499.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6499.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert3&#45;&gt;layer1_agg_exp3 -->
<g id="edge87" class="edge">
<title>layer1_expert3&#45;&gt;layer1_agg_exp3</title>
<path fill="none" stroke="black" d="M6517.7,-941.09C6517.7,-941.09 6517.7,-915.34 6517.7,-915.34"/>
<polygon fill="black" stroke="black" points="6521.2,-915.34 6517.7,-905.34 6514.2,-915.34 6521.2,-915.34"/>
</g>
<!-- layer1_agg_exp3&#45;&gt;layer1_moe_agg -->
<g id="edge88" class="edge">
<title>layer1_agg_exp3&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M6660.39,-846.55C6660.39,-810.62 6660.39,-743 6660.39,-743 6660.39,-743 8151.3,-743 8151.3,-743"/>
<polygon fill="black" stroke="black" points="8151.3,-746.5 8161.3,-743 8151.3,-739.5 8151.3,-746.5"/>
</g>
<!-- layer1_expert4 -->
<g id="node77" class="node">
<title>layer1_expert4</title>
<polygon fill="lightcoral" stroke="black" points="7040.2,-1004.16 6819.2,-1004.16 6819.2,-941.16 7040.2,-941.16 7040.2,-1004.16"/>
<text text-anchor="middle" x="6929.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="6929.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="6929.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6929.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6929.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp4&#45;&gt;layer1_expert4 -->
<g id="edge90" class="edge">
<title>layer1_route_exp4&#45;&gt;layer1_expert4</title>
<path fill="none" stroke="black" d="M6929.7,-1040.16C6929.7,-1040.16 6929.7,-1014.25 6929.7,-1014.25"/>
<polygon fill="black" stroke="black" points="6933.2,-1014.25 6929.7,-1004.25 6926.2,-1014.25 6933.2,-1014.25"/>
</g>
<!-- layer1_agg_exp4 -->
<g id="node78" class="node">
<title>layer1_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="6914.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="6914.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="6914.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="6914.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6914.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert4&#45;&gt;layer1_agg_exp4 -->
<g id="edge91" class="edge">
<title>layer1_expert4&#45;&gt;layer1_agg_exp4</title>
<path fill="none" stroke="black" d="M6929.7,-941.09C6929.7,-941.09 6929.7,-915.34 6929.7,-915.34"/>
<polygon fill="black" stroke="black" points="6933.2,-915.34 6929.7,-905.34 6926.2,-915.34 6933.2,-915.34"/>
</g>
<!-- layer1_agg_exp4&#45;&gt;layer1_moe_agg -->
<g id="edge92" class="edge">
<title>layer1_agg_exp4&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M6914.7,-831.56C6914.7,-797.46 6914.7,-752 6914.7,-752 6914.7,-752 8156.71,-752 8156.71,-752"/>
<polygon fill="black" stroke="black" points="8156.71,-755.5 8166.71,-752 8156.71,-748.5 8156.71,-755.5"/>
</g>
<!-- layer1_expert5 -->
<g id="node80" class="node">
<title>layer1_expert5</title>
<polygon fill="lightcoral" stroke="black" points="7451.2,-1004.16 7230.2,-1004.16 7230.2,-941.16 7451.2,-941.16 7451.2,-1004.16"/>
<text text-anchor="middle" x="7340.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="7340.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="7340.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="7340.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="7340.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp5&#45;&gt;layer1_expert5 -->
<g id="edge94" class="edge">
<title>layer1_route_exp5&#45;&gt;layer1_expert5</title>
<path fill="none" stroke="black" d="M7340.7,-1040.16C7340.7,-1040.16 7340.7,-1014.25 7340.7,-1014.25"/>
<polygon fill="black" stroke="black" points="7344.2,-1014.25 7340.7,-1004.25 7337.2,-1014.25 7344.2,-1014.25"/>
</g>
<!-- layer1_agg_exp5 -->
<g id="node81" class="node">
<title>layer1_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="7329.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="7329.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="7329.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="7329.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="7329.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert5&#45;&gt;layer1_agg_exp5 -->
<g id="edge95" class="edge">
<title>layer1_expert5&#45;&gt;layer1_agg_exp5</title>
<path fill="none" stroke="black" d="M7340.7,-941.09C7340.7,-941.09 7340.7,-915.34 7340.7,-915.34"/>
<polygon fill="black" stroke="black" points="7344.2,-915.34 7340.7,-905.34 7337.2,-915.34 7344.2,-915.34"/>
</g>
<!-- layer1_agg_exp5&#45;&gt;layer1_moe_agg -->
<g id="edge96" class="edge">
<title>layer1_agg_exp5&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M7329.7,-831.48C7329.7,-800.75 7329.7,-762 7329.7,-762 7329.7,-762 8179.02,-762 8179.02,-762"/>
<polygon fill="black" stroke="black" points="8179.02,-765.5 8189.02,-762 8179.02,-758.5 8179.02,-765.5"/>
</g>
<!-- layer1_expert6 -->
<g id="node83" class="node">
<title>layer1_expert6</title>
<polygon fill="lightcoral" stroke="black" points="7862.2,-1004.16 7641.2,-1004.16 7641.2,-941.16 7862.2,-941.16 7862.2,-1004.16"/>
<text text-anchor="middle" x="7751.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="7751.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="7751.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="7751.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="7751.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp6&#45;&gt;layer1_expert6 -->
<g id="edge98" class="edge">
<title>layer1_route_exp6&#45;&gt;layer1_expert6</title>
<path fill="none" stroke="black" d="M7751.7,-1040.16C7751.7,-1040.16 7751.7,-1014.25 7751.7,-1014.25"/>
<polygon fill="black" stroke="black" points="7755.2,-1014.25 7751.7,-1004.25 7748.2,-1014.25 7755.2,-1014.25"/>
</g>
<!-- layer1_agg_exp6 -->
<g id="node84" class="node">
<title>layer1_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="7744.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="7744.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="7744.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="7744.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="7744.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert6&#45;&gt;layer1_agg_exp6 -->
<g id="edge99" class="edge">
<title>layer1_expert6&#45;&gt;layer1_agg_exp6</title>
<path fill="none" stroke="black" d="M7751.7,-941.09C7751.7,-941.09 7751.7,-915.34 7751.7,-915.34"/>
<polygon fill="black" stroke="black" points="7755.2,-915.34 7751.7,-905.34 7748.2,-915.34 7755.2,-915.34"/>
</g>
<!-- layer1_agg_exp6&#45;&gt;layer1_moe_agg -->
<g id="edge100" class="edge">
<title>layer1_agg_exp6&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M7935.3,-857.96C7935.3,-832.84 7935.3,-771 7935.3,-771 7935.3,-771 8219.61,-771 8219.61,-771"/>
<polygon fill="black" stroke="black" points="8219.61,-774.5 8229.61,-771 8219.61,-767.5 8219.61,-774.5"/>
</g>
<!-- layer1_expert7 -->
<g id="node86" class="node">
<title>layer1_expert7</title>
<polygon fill="lightcoral" stroke="black" points="8275.2,-1004.16 8054.2,-1004.16 8054.2,-941.16 8275.2,-941.16 8275.2,-1004.16"/>
<text text-anchor="middle" x="8164.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="8164.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="8164.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8164.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8164.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp7&#45;&gt;layer1_expert7 -->
<g id="edge102" class="edge">
<title>layer1_route_exp7&#45;&gt;layer1_expert7</title>
<path fill="none" stroke="black" d="M8164.7,-1039.87C8164.7,-1039.87 8164.7,-1014.41 8164.7,-1014.41"/>
<polygon fill="black" stroke="black" points="8168.2,-1014.41 8164.7,-1004.41 8161.2,-1014.41 8168.2,-1014.41"/>
</g>
<!-- layer1_agg_exp7 -->
<g id="node87" class="node">
<title>layer1_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="8159.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="8159.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="8159.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="8159.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8159.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert7&#45;&gt;layer1_agg_exp7 -->
<g id="edge103" class="edge">
<title>layer1_expert7&#45;&gt;layer1_agg_exp7</title>
<path fill="none" stroke="black" d="M8164.7,-941.09C8164.7,-941.09 8164.7,-915.34 8164.7,-915.34"/>
<polygon fill="black" stroke="black" points="8168.2,-915.34 8164.7,-905.34 8161.2,-915.34 8168.2,-915.34"/>
</g>
<!-- layer1_agg_exp7&#45;&gt;layer1_moe_agg -->
<g id="edge104" class="edge">
<title>layer1_agg_exp7&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M8260.02,-836.58C8260.02,-836.58 8260.02,-785.37 8260.02,-785.37"/>
<polygon fill="black" stroke="black" points="8263.52,-785.37 8260.02,-775.37 8256.52,-785.37 8263.52,-785.37"/>
</g>
<!-- layer1_expert8 -->
<g id="node89" class="node">
<title>layer1_expert8</title>
<polygon fill="lightcoral" stroke="black" points="8683.2,-1004.16 8462.2,-1004.16 8462.2,-941.16 8683.2,-941.16 8683.2,-1004.16"/>
<text text-anchor="middle" x="8572.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="8572.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="8572.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8572.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8572.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp8&#45;&gt;layer1_expert8 -->
<g id="edge106" class="edge">
<title>layer1_route_exp8&#45;&gt;layer1_expert8</title>
<path fill="none" stroke="black" d="M8572.7,-1039.87C8572.7,-1039.87 8572.7,-1014.41 8572.7,-1014.41"/>
<polygon fill="black" stroke="black" points="8576.2,-1014.41 8572.7,-1004.41 8569.2,-1014.41 8576.2,-1014.41"/>
</g>
<!-- layer1_agg_exp8 -->
<g id="node90" class="node">
<title>layer1_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="8574.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="8574.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="8574.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="8574.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8574.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert8&#45;&gt;layer1_agg_exp8 -->
<g id="edge107" class="edge">
<title>layer1_expert8&#45;&gt;layer1_agg_exp8</title>
<path fill="none" stroke="black" d="M8572.7,-941.09C8572.7,-941.09 8572.7,-915.34 8572.7,-915.34"/>
<polygon fill="black" stroke="black" points="8576.2,-915.34 8572.7,-905.34 8569.2,-915.34 8576.2,-915.34"/>
</g>
<!-- layer1_agg_exp8&#45;&gt;layer1_moe_agg -->
<g id="edge108" class="edge">
<title>layer1_agg_exp8&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M8473.88,-836.58C8473.88,-836.58 8473.88,-785.37 8473.88,-785.37"/>
<polygon fill="black" stroke="black" points="8477.38,-785.37 8473.88,-775.37 8470.38,-785.37 8477.38,-785.37"/>
</g>
<!-- layer1_expert9 -->
<g id="node92" class="node">
<title>layer1_expert9</title>
<polygon fill="lightcoral" stroke="black" points="9094.2,-1004.16 8873.2,-1004.16 8873.2,-941.16 9094.2,-941.16 9094.2,-1004.16"/>
<text text-anchor="middle" x="8983.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="8983.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="8983.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8983.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8983.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp9&#45;&gt;layer1_expert9 -->
<g id="edge110" class="edge">
<title>layer1_route_exp9&#45;&gt;layer1_expert9</title>
<path fill="none" stroke="black" d="M8983.7,-1039.87C8983.7,-1039.87 8983.7,-1014.41 8983.7,-1014.41"/>
<polygon fill="black" stroke="black" points="8987.2,-1014.41 8983.7,-1004.41 8980.2,-1014.41 8987.2,-1014.41"/>
</g>
<!-- layer1_agg_exp9 -->
<g id="node93" class="node">
<title>layer1_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="8989.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="8989.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="8989.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="8989.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8989.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert9&#45;&gt;layer1_agg_exp9 -->
<g id="edge111" class="edge">
<title>layer1_expert9&#45;&gt;layer1_agg_exp9</title>
<path fill="none" stroke="black" d="M8983.7,-941.09C8983.7,-941.09 8983.7,-915.34 8983.7,-915.34"/>
<polygon fill="black" stroke="black" points="8987.2,-915.34 8983.7,-905.34 8980.2,-915.34 8987.2,-915.34"/>
</g>
<!-- layer1_agg_exp9&#45;&gt;layer1_moe_agg -->
<g id="edge112" class="edge">
<title>layer1_agg_exp9&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M8989.7,-831.48C8989.7,-805.37 8989.7,-775 8989.7,-775 8989.7,-775 8483.79,-775 8483.79,-775"/>
<polygon fill="black" stroke="black" points="8483.79,-771.5 8473.79,-775 8483.79,-778.5 8483.79,-771.5"/>
</g>
<!-- layer1_expert10 -->
<g id="node95" class="node">
<title>layer1_expert10</title>
<polygon fill="lightcoral" stroke="black" points="9507.2,-1004.16 9286.2,-1004.16 9286.2,-941.16 9507.2,-941.16 9507.2,-1004.16"/>
<text text-anchor="middle" x="9396.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="9396.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="9396.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="9396.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="9396.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp10&#45;&gt;layer1_expert10 -->
<g id="edge114" class="edge">
<title>layer1_route_exp10&#45;&gt;layer1_expert10</title>
<path fill="none" stroke="black" d="M9396.7,-1040.16C9396.7,-1040.16 9396.7,-1014.25 9396.7,-1014.25"/>
<polygon fill="black" stroke="black" points="9400.2,-1014.25 9396.7,-1004.25 9393.2,-1014.25 9400.2,-1014.25"/>
</g>
<!-- layer1_agg_exp10 -->
<g id="node96" class="node">
<title>layer1_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="9404.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="9404.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="9404.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="9404.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="9404.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert10&#45;&gt;layer1_agg_exp10 -->
<g id="edge115" class="edge">
<title>layer1_expert10&#45;&gt;layer1_agg_exp10</title>
<path fill="none" stroke="black" d="M9396.7,-941.09C9396.7,-941.09 9396.7,-915.34 9396.7,-915.34"/>
<polygon fill="black" stroke="black" points="9400.2,-915.34 9396.7,-905.34 9393.2,-915.34 9400.2,-915.34"/>
</g>
<!-- layer1_agg_exp10&#45;&gt;layer1_moe_agg -->
<g id="edge116" class="edge">
<title>layer1_agg_exp10&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M9404.7,-831.47C9404.7,-803.55 9404.7,-770 9404.7,-770 9404.7,-770 8519.66,-770 8519.66,-770"/>
<polygon fill="black" stroke="black" points="8519.66,-766.5 8509.66,-770 8519.66,-773.5 8519.66,-766.5"/>
</g>
<!-- layer1_expert11 -->
<g id="node98" class="node">
<title>layer1_expert11</title>
<polygon fill="lightcoral" stroke="black" points="9921.2,-1004.16 9700.2,-1004.16 9700.2,-941.16 9921.2,-941.16 9921.2,-1004.16"/>
<text text-anchor="middle" x="9810.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="9810.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="9810.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="9810.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="9810.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp11&#45;&gt;layer1_expert11 -->
<g id="edge118" class="edge">
<title>layer1_route_exp11&#45;&gt;layer1_expert11</title>
<path fill="none" stroke="black" d="M9810.7,-1040.16C9810.7,-1040.16 9810.7,-1014.25 9810.7,-1014.25"/>
<polygon fill="black" stroke="black" points="9814.2,-1014.25 9810.7,-1004.25 9807.2,-1014.25 9814.2,-1014.25"/>
</g>
<!-- layer1_agg_exp11 -->
<g id="node99" class="node">
<title>layer1_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="9819.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="9819.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="9819.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="9819.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="9819.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert11&#45;&gt;layer1_agg_exp11 -->
<g id="edge119" class="edge">
<title>layer1_expert11&#45;&gt;layer1_agg_exp11</title>
<path fill="none" stroke="black" d="M9810.7,-941.09C9810.7,-941.09 9810.7,-915.34 9810.7,-915.34"/>
<polygon fill="black" stroke="black" points="9814.2,-915.34 9810.7,-905.34 9807.2,-915.34 9814.2,-915.34"/>
</g>
<!-- layer1_agg_exp11&#45;&gt;layer1_moe_agg -->
<g id="edge120" class="edge">
<title>layer1_agg_exp11&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M9819.7,-831.35C9819.7,-801.69 9819.7,-765 9819.7,-765 9819.7,-765 8543.73,-765 8543.73,-765"/>
<polygon fill="black" stroke="black" points="8543.73,-761.5 8533.73,-765 8543.73,-768.5 8543.73,-761.5"/>
</g>
<!-- layer1_expert12 -->
<g id="node101" class="node">
<title>layer1_expert12</title>
<polygon fill="lightcoral" stroke="black" points="10334.2,-1004.16 10113.2,-1004.16 10113.2,-941.16 10334.2,-941.16 10334.2,-1004.16"/>
<text text-anchor="middle" x="10223.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="10223.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="10223.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="10223.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="10223.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp12&#45;&gt;layer1_expert12 -->
<g id="edge122" class="edge">
<title>layer1_route_exp12&#45;&gt;layer1_expert12</title>
<path fill="none" stroke="black" d="M10223.7,-1040.16C10223.7,-1040.16 10223.7,-1014.25 10223.7,-1014.25"/>
<polygon fill="black" stroke="black" points="10227.2,-1014.25 10223.7,-1004.25 10220.2,-1014.25 10227.2,-1014.25"/>
</g>
<!-- layer1_agg_exp12 -->
<g id="node102" class="node">
<title>layer1_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="10234.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="10234.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="10234.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="10234.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="10234.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert12&#45;&gt;layer1_agg_exp12 -->
<g id="edge123" class="edge">
<title>layer1_expert12&#45;&gt;layer1_agg_exp12</title>
<path fill="none" stroke="black" d="M10223.7,-941.09C10223.7,-941.09 10223.7,-915.34 10223.7,-915.34"/>
<polygon fill="black" stroke="black" points="10227.2,-915.34 10223.7,-905.34 10220.2,-915.34 10227.2,-915.34"/>
</g>
<!-- layer1_agg_exp12&#45;&gt;layer1_moe_agg -->
<g id="edge124" class="edge">
<title>layer1_agg_exp12&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M10234.7,-831.39C10234.7,-799.99 10234.7,-760 10234.7,-760 10234.7,-760 8560.49,-760 8560.49,-760"/>
<polygon fill="black" stroke="black" points="8560.49,-756.5 8550.49,-760 8560.49,-763.5 8560.49,-756.5"/>
</g>
<!-- layer1_expert13 -->
<g id="node104" class="node">
<title>layer1_expert13</title>
<polygon fill="lightcoral" stroke="black" points="10753.2,-1004.16 10532.2,-1004.16 10532.2,-941.16 10753.2,-941.16 10753.2,-1004.16"/>
<text text-anchor="middle" x="10642.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="10642.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="10642.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="10642.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="10642.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp13&#45;&gt;layer1_expert13 -->
<g id="edge126" class="edge">
<title>layer1_route_exp13&#45;&gt;layer1_expert13</title>
<path fill="none" stroke="black" d="M10642.7,-1040.16C10642.7,-1040.16 10642.7,-1014.25 10642.7,-1014.25"/>
<polygon fill="black" stroke="black" points="10646.2,-1014.25 10642.7,-1004.25 10639.2,-1014.25 10646.2,-1014.25"/>
</g>
<!-- layer1_agg_exp13 -->
<g id="node105" class="node">
<title>layer1_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="10649.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="10649.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="10649.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="10649.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="10649.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert13&#45;&gt;layer1_agg_exp13 -->
<g id="edge127" class="edge">
<title>layer1_expert13&#45;&gt;layer1_agg_exp13</title>
<path fill="none" stroke="black" d="M10642.7,-941.09C10642.7,-941.09 10642.7,-915.34 10642.7,-915.34"/>
<polygon fill="black" stroke="black" points="10646.2,-915.34 10642.7,-905.34 10639.2,-915.34 10646.2,-915.34"/>
</g>
<!-- layer1_agg_exp13&#45;&gt;layer1_moe_agg -->
<g id="edge128" class="edge">
<title>layer1_agg_exp13&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M10649.7,-831.57C10649.7,-798.47 10649.7,-755 10649.7,-755 10649.7,-755 8571.84,-755 8571.84,-755"/>
<polygon fill="black" stroke="black" points="8571.84,-751.5 8561.84,-755 8571.84,-758.5 8571.84,-751.5"/>
</g>
<!-- layer1_expert14 -->
<g id="node107" class="node">
<title>layer1_expert14</title>
<polygon fill="lightcoral" stroke="black" points="11167.2,-1004.16 10946.2,-1004.16 10946.2,-941.16 11167.2,-941.16 11167.2,-1004.16"/>
<text text-anchor="middle" x="11056.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="11056.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="11056.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11056.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11056.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp14&#45;&gt;layer1_expert14 -->
<g id="edge130" class="edge">
<title>layer1_route_exp14&#45;&gt;layer1_expert14</title>
<path fill="none" stroke="black" d="M11056.7,-1040.16C11056.7,-1040.16 11056.7,-1014.25 11056.7,-1014.25"/>
<polygon fill="black" stroke="black" points="11060.2,-1014.25 11056.7,-1004.25 11053.2,-1014.25 11060.2,-1014.25"/>
</g>
<!-- layer1_agg_exp14 -->
<g id="node108" class="node">
<title>layer1_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="11064.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="11064.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="11064.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="11064.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11064.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert14&#45;&gt;layer1_agg_exp14 -->
<g id="edge131" class="edge">
<title>layer1_expert14&#45;&gt;layer1_agg_exp14</title>
<path fill="none" stroke="black" d="M11056.7,-941.09C11056.7,-941.09 11056.7,-915.34 11056.7,-915.34"/>
<polygon fill="black" stroke="black" points="11060.2,-915.34 11056.7,-905.34 11053.2,-915.34 11060.2,-915.34"/>
</g>
<!-- layer1_agg_exp14&#45;&gt;layer1_moe_agg -->
<g id="edge132" class="edge">
<title>layer1_agg_exp14&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M11064.7,-831.58C11064.7,-796.82 11064.7,-750 11064.7,-750 11064.7,-750 8578.66,-750 8578.66,-750"/>
<polygon fill="black" stroke="black" points="8578.66,-746.5 8568.66,-750 8578.66,-753.5 8578.66,-746.5"/>
</g>
<!-- layer1_expert15 -->
<g id="node110" class="node">
<title>layer1_expert15</title>
<polygon fill="lightcoral" stroke="black" points="11580.2,-1004.16 11359.2,-1004.16 11359.2,-941.16 11580.2,-941.16 11580.2,-1004.16"/>
<text text-anchor="middle" x="11469.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="11469.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="11469.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11469.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11469.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer1_route_exp15&#45;&gt;layer1_expert15 -->
<g id="edge134" class="edge">
<title>layer1_route_exp15&#45;&gt;layer1_expert15</title>
<path fill="none" stroke="black" d="M11469.7,-1040.16C11469.7,-1040.16 11469.7,-1014.25 11469.7,-1014.25"/>
<polygon fill="black" stroke="black" points="11473.2,-1014.25 11469.7,-1004.25 11466.2,-1014.25 11473.2,-1014.25"/>
</g>
<!-- layer1_agg_exp15 -->
<g id="node111" class="node">
<title>layer1_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="11479.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="11479.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="11479.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="11479.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11479.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer1_expert15&#45;&gt;layer1_agg_exp15 -->
<g id="edge135" class="edge">
<title>layer1_expert15&#45;&gt;layer1_agg_exp15</title>
<path fill="none" stroke="black" d="M11469.7,-941.09C11469.7,-941.09 11469.7,-915.34 11469.7,-915.34"/>
<polygon fill="black" stroke="black" points="11473.2,-915.34 11469.7,-905.34 11466.2,-915.34 11473.2,-915.34"/>
</g>
<!-- layer1_agg_exp15&#45;&gt;layer1_moe_agg -->
<g id="edge136" class="edge">
<title>layer1_agg_exp15&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M11479.7,-831.33C11479.7,-795.31 11479.7,-746 11479.7,-746 11479.7,-746 8581.55,-746 8581.55,-746"/>
<polygon fill="black" stroke="black" points="8581.55,-742.5 8571.55,-746 8581.55,-749.5 8581.55,-742.5"/>
</g>
<!-- layer2_ln1 -->
<g id="node113" class="node">
<title>layer2_ln1</title>
<polygon fill="none" stroke="black" points="11822.2,-1227.7 11541.2,-1227.7 11541.2,-1175.7 11822.2,-1175.7 11822.2,-1227.7"/>
<text text-anchor="middle" x="11681.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 2</text>
<text text-anchor="middle" x="11681.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11681.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11681.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer2_add1 -->
<g id="node114" class="node">
<title>layer2_add1</title>
<polygon fill="yellow" stroke="black" points="14848.2,-644.85 14567.2,-644.85 14567.2,-592.85 14848.2,-592.85 14848.2,-644.85"/>
<text text-anchor="middle" x="14707.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 2</text>
<text text-anchor="middle" x="14707.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14707.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14707.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_moe_output -->
<g id="node118" class="node">
<title>layer2_moe_output</title>
<polygon fill="yellow" stroke="black" points="14997.2,-540.58 14716.2,-540.58 14716.2,-488.58 14997.2,-488.58 14997.2,-540.58"/>
<text text-anchor="middle" x="14856.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 2</text>
<text text-anchor="middle" x="14856.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14856.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14856.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_add1&#45;&gt;layer2_moe_output -->
<g id="edge206" class="edge">
<title>layer2_add1&#45;&gt;layer2_moe_output</title>
<path fill="none" stroke="black" d="M14782.2,-592.81C14782.2,-592.81 14782.2,-550.65 14782.2,-550.65"/>
<polygon fill="black" stroke="black" points="14785.7,-550.65 14782.2,-540.65 14778.7,-550.65 14785.7,-550.65"/>
</g>
<!-- layer2_gate -->
<g id="node115" class="node">
<title>layer2_gate</title>
<polygon fill="lightgreen" stroke="black" points="15295.13,-1253.7 14836.3,-1253.7 14718.26,-1149.7 15177.1,-1149.7 15295.13,-1253.7"/>
<text text-anchor="middle" x="15006.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 2</text>
<text text-anchor="middle" x="15006.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="15006.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="15006.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer2_route_exp0 -->
<g id="node119" class="node">
<title>layer2_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="11895.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="11895.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="11895.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="11895.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11895.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp0 -->
<g id="edge140" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp0</title>
<path fill="none" stroke="black" d="M14744.6,-1173C14005.13,-1173 11955.82,-1173 11955.82,-1173 11955.82,-1173 11955.82,-1121.88 11955.82,-1121.88"/>
<polygon fill="black" stroke="black" points="11959.32,-1121.88 11955.82,-1111.88 11952.32,-1121.88 11959.32,-1121.88"/>
</g>
<!-- layer2_route_exp1 -->
<g id="node122" class="node">
<title>layer2_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="12337.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="12337.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="12337.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="12337.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="12337.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp1 -->
<g id="edge144" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp1</title>
<path fill="none" stroke="black" d="M14738.87,-1168C14062.26,-1168 12337.7,-1168 12337.7,-1168 12337.7,-1168 12337.7,-1123.71 12337.7,-1123.71"/>
<polygon fill="black" stroke="black" points="12341.2,-1123.71 12337.7,-1113.71 12334.2,-1123.71 12341.2,-1123.71"/>
</g>
<!-- layer2_route_exp2 -->
<g id="node125" class="node">
<title>layer2_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="12761.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="12761.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="12761.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="12761.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="12761.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp2 -->
<g id="edge148" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp2</title>
<path fill="none" stroke="black" d="M14735.62,-1165C14138.37,-1165 12761.7,-1165 12761.7,-1165 12761.7,-1165 12761.7,-1123.77 12761.7,-1123.77"/>
<polygon fill="black" stroke="black" points="12765.2,-1123.77 12761.7,-1113.77 12758.2,-1123.77 12765.2,-1123.77"/>
</g>
<!-- layer2_route_exp3 -->
<g id="node128" class="node">
<title>layer2_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="13175.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="13175.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="13175.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="13175.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="13175.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp3 -->
<g id="edge152" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp3</title>
<path fill="none" stroke="black" d="M14731.09,-1161C14219.76,-1161 13175.7,-1161 13175.7,-1161 13175.7,-1161 13175.7,-1124.05 13175.7,-1124.05"/>
<polygon fill="black" stroke="black" points="13179.2,-1124.05 13175.7,-1114.05 13172.2,-1124.05 13179.2,-1124.05"/>
</g>
<!-- layer2_route_exp4 -->
<g id="node131" class="node">
<title>layer2_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="13585.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="13585.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="13585.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="13585.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="13585.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp4 -->
<g id="edge156" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp4</title>
<path fill="none" stroke="black" d="M14727.65,-1158C14313.82,-1158 13585.7,-1158 13585.7,-1158 13585.7,-1158 13585.7,-1124.14 13585.7,-1124.14"/>
<polygon fill="black" stroke="black" points="13589.2,-1124.14 13585.7,-1114.14 13582.2,-1124.14 13589.2,-1124.14"/>
</g>
<!-- layer2_route_exp5 -->
<g id="node134" class="node">
<title>layer2_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="13992.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="13992.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="13992.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="13992.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="13992.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp5 -->
<g id="edge160" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp5</title>
<path fill="none" stroke="black" d="M14722.89,-1154C14422.92,-1154 13992.7,-1154 13992.7,-1154 13992.7,-1154 13992.7,-1124.11 13992.7,-1124.11"/>
<polygon fill="black" stroke="black" points="13996.2,-1124.11 13992.7,-1114.11 13989.2,-1124.11 13996.2,-1124.11"/>
</g>
<!-- layer2_route_exp6 -->
<g id="node137" class="node">
<title>layer2_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="14398.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="14398.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="14398.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="14398.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14398.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp6 -->
<g id="edge164" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp6</title>
<path fill="none" stroke="black" d="M14719.61,-1151C14562.19,-1151 14398.7,-1151 14398.7,-1151 14398.7,-1151 14398.7,-1123.96 14398.7,-1123.96"/>
<polygon fill="black" stroke="black" points="14402.2,-1123.96 14398.7,-1113.96 14395.2,-1123.96 14402.2,-1123.96"/>
</g>
<!-- layer2_route_exp7 -->
<g id="node140" class="node">
<title>layer2_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="14804.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="14804.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="14804.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="14804.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14804.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp7 -->
<g id="edge168" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp7</title>
<path fill="none" stroke="black" d="M14858.46,-1149.5C14858.46,-1149.5 14858.46,-1122.25 14858.46,-1122.25"/>
<polygon fill="black" stroke="black" points="14861.96,-1122.25 14858.46,-1112.25 14854.96,-1122.25 14861.96,-1122.25"/>
</g>
<!-- layer2_route_exp8 -->
<g id="node143" class="node">
<title>layer2_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="15209.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="15209.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="15209.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="15209.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="15209.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp8 -->
<g id="edge172" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp8</title>
<path fill="none" stroke="black" d="M15155.43,-1149.5C15155.43,-1149.5 15155.43,-1122.25 15155.43,-1122.25"/>
<polygon fill="black" stroke="black" points="15158.93,-1122.25 15155.43,-1112.25 15151.93,-1122.25 15158.93,-1122.25"/>
</g>
<!-- layer2_route_exp9 -->
<g id="node146" class="node">
<title>layer2_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="15618.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="15618.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="15618.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="15618.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="15618.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp9 -->
<g id="edge176" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp9</title>
<path fill="none" stroke="black" d="M15181.25,-1153C15362.14,-1153 15618.7,-1153 15618.7,-1153 15618.7,-1153 15618.7,-1124.07 15618.7,-1124.07"/>
<polygon fill="black" stroke="black" points="15622.2,-1124.07 15618.7,-1114.07 15615.2,-1124.07 15622.2,-1124.07"/>
</g>
<!-- layer2_route_exp10 -->
<g id="node149" class="node">
<title>layer2_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="16030.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="16030.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="16030.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="16030.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="16030.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp10 -->
<g id="edge180" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp10</title>
<path fill="none" stroke="black" d="M15184.48,-1156C15477.71,-1156 16030.7,-1156 16030.7,-1156 16030.7,-1156 16030.7,-1124.15 16030.7,-1124.15"/>
<polygon fill="black" stroke="black" points="16034.2,-1124.15 16030.7,-1114.15 16027.2,-1124.15 16034.2,-1124.15"/>
</g>
<!-- layer2_route_exp11 -->
<g id="node152" class="node">
<title>layer2_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="16440.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="16440.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="16440.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="16440.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="16440.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp11 -->
<g id="edge184" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp11</title>
<path fill="none" stroke="black" d="M15189.04,-1160C15575.27,-1160 16440.7,-1160 16440.7,-1160 16440.7,-1160 16440.7,-1124.09 16440.7,-1124.09"/>
<polygon fill="black" stroke="black" points="16444.2,-1124.09 16440.7,-1114.09 16437.2,-1124.09 16444.2,-1124.09"/>
</g>
<!-- layer2_route_exp12 -->
<g id="node155" class="node">
<title>layer2_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="16856.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="16856.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="16856.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="16856.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="16856.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp12 -->
<g id="edge188" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp12</title>
<path fill="none" stroke="black" d="M15192.55,-1163C15661.69,-1163 16856.7,-1163 16856.7,-1163 16856.7,-1163 16856.7,-1123.93 16856.7,-1123.93"/>
<polygon fill="black" stroke="black" points="16860.2,-1123.93 16856.7,-1113.93 16853.2,-1123.93 16860.2,-1123.93"/>
</g>
<!-- layer2_route_exp13 -->
<g id="node158" class="node">
<title>layer2_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="17269.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="17269.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="17269.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="17269.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="17269.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp13 -->
<g id="edge192" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp13</title>
<path fill="none" stroke="black" d="M15197.2,-1167C15742.36,-1167 17269.7,-1167 17269.7,-1167 17269.7,-1167 17269.7,-1123.82 17269.7,-1123.82"/>
<polygon fill="black" stroke="black" points="17273.2,-1123.82 17269.7,-1113.82 17266.2,-1123.82 17273.2,-1123.82"/>
</g>
<!-- layer2_route_exp14 -->
<g id="node161" class="node">
<title>layer2_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="17685.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="17685.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="17685.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="17685.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="17685.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp14 -->
<g id="edge196" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp14</title>
<path fill="none" stroke="black" d="M15200.17,-1170C15815.27,-1170 17685.7,-1170 17685.7,-1170 17685.7,-1170 17685.7,-1123.71 17685.7,-1123.71"/>
<polygon fill="black" stroke="black" points="17689.2,-1123.71 17685.7,-1113.71 17682.2,-1123.71 17689.2,-1123.71"/>
</g>
<!-- layer2_route_exp15 -->
<g id="node164" class="node">
<title>layer2_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="18100.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="18100.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="18100.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="18100.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18100.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_exp15 -->
<g id="edge200" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_exp15</title>
<path fill="none" stroke="black" d="M15202.48,-1172C15874.21,-1172 18044.07,-1172 18044.07,-1172 18044.07,-1172 18044.07,-1122.33 18044.07,-1122.33"/>
<polygon fill="black" stroke="black" points="18047.57,-1122.33 18044.07,-1112.33 18040.57,-1122.33 18047.57,-1122.33"/>
</g>
<!-- layer2_moe_agg -->
<g id="node116" class="node">
<title>layer2_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="15006.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="15006.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 2</text>
<text text-anchor="middle" x="15006.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="15006.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="15006.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer2_ln2 -->
<g id="node117" class="node">
<title>layer2_ln2</title>
<polygon fill="none" stroke="black" points="15147.2,-644.85 14866.2,-644.85 14866.2,-592.85 15147.2,-592.85 15147.2,-644.85"/>
<text text-anchor="middle" x="15006.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 2</text>
<text text-anchor="middle" x="15006.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="15006.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="15006.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer2_moe_agg&#45;&gt;layer2_ln2 -->
<g id="edge204" class="edge">
<title>layer2_moe_agg&#45;&gt;layer2_ln2</title>
<path fill="none" stroke="black" d="M15006.7,-706.52C15006.7,-706.52 15006.7,-654.92 15006.7,-654.92"/>
<polygon fill="black" stroke="black" points="15010.2,-654.92 15006.7,-644.92 15003.2,-654.92 15010.2,-654.92"/>
</g>
<!-- layer2_ln2&#45;&gt;layer2_moe_output -->
<g id="edge205" class="edge">
<title>layer2_ln2&#45;&gt;layer2_moe_output</title>
<path fill="none" stroke="black" d="M14931.7,-592.81C14931.7,-592.81 14931.7,-550.65 14931.7,-550.65"/>
<polygon fill="black" stroke="black" points="14935.2,-550.65 14931.7,-540.65 14928.2,-550.65 14935.2,-550.65"/>
</g>
<!-- layer3_mha -->
<g id="node167" class="node">
<title>layer3_mha</title>
<polygon fill="lightcyan" stroke="black" points="14997.2,-436.31 14716.2,-436.31 14716.2,-384.31 14997.2,-384.31 14997.2,-436.31"/>
<text text-anchor="middle" x="14856.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 3</text>
<text text-anchor="middle" x="14856.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14856.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14856.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer2_moe_output&#45;&gt;layer3_mha -->
<g id="edge1080" class="edge">
<title>layer2_moe_output&#45;&gt;layer3_mha</title>
<path fill="none" stroke="black" d="M14856.7,-488.54C14856.7,-488.54 14856.7,-446.38 14856.7,-446.38"/>
<polygon fill="black" stroke="black" points="14860.2,-446.38 14856.7,-436.38 14853.2,-446.38 14860.2,-446.38"/>
</g>
<!-- layer2_expert0 -->
<g id="node120" class="node">
<title>layer2_expert0</title>
<polygon fill="lightcoral" stroke="black" points="12005.2,-1004.16 11784.2,-1004.16 11784.2,-941.16 12005.2,-941.16 12005.2,-1004.16"/>
<text text-anchor="middle" x="11894.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="11894.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="11894.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11894.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11894.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp0&#45;&gt;layer2_expert0 -->
<g id="edge141" class="edge">
<title>layer2_route_exp0&#45;&gt;layer2_expert0</title>
<path fill="none" stroke="black" d="M11894.7,-1039.87C11894.7,-1039.87 11894.7,-1014.41 11894.7,-1014.41"/>
<polygon fill="black" stroke="black" points="11898.2,-1014.41 11894.7,-1004.41 11891.2,-1014.41 11898.2,-1014.41"/>
</g>
<!-- layer2_agg_exp0 -->
<g id="node121" class="node">
<title>layer2_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="11894.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="11894.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="11894.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="11894.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11894.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert0&#45;&gt;layer2_agg_exp0 -->
<g id="edge142" class="edge">
<title>layer2_expert0&#45;&gt;layer2_agg_exp0</title>
<path fill="none" stroke="black" d="M11894.7,-941.09C11894.7,-941.09 11894.7,-915.34 11894.7,-915.34"/>
<polygon fill="black" stroke="black" points="11898.2,-915.34 11894.7,-905.34 11891.2,-915.34 11898.2,-915.34"/>
</g>
<!-- layer2_agg_exp0&#45;&gt;layer2_moe_agg -->
<g id="edge143" class="edge">
<title>layer2_agg_exp0&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M11894.7,-831.49C11894.7,-784.97 11894.7,-711 11894.7,-711 11894.7,-711 14901.86,-711 14901.86,-711"/>
<polygon fill="black" stroke="black" points="14901.86,-714.5 14911.86,-711 14901.86,-707.5 14901.86,-714.5"/>
</g>
<!-- layer2_expert1 -->
<g id="node123" class="node">
<title>layer2_expert1</title>
<polygon fill="lightcoral" stroke="black" points="12434.2,-1004.16 12213.2,-1004.16 12213.2,-941.16 12434.2,-941.16 12434.2,-1004.16"/>
<text text-anchor="middle" x="12323.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="12323.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="12323.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="12323.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="12323.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp1&#45;&gt;layer2_expert1 -->
<g id="edge145" class="edge">
<title>layer2_route_exp1&#45;&gt;layer2_expert1</title>
<path fill="none" stroke="black" d="M12323.7,-1040.16C12323.7,-1040.16 12323.7,-1014.25 12323.7,-1014.25"/>
<polygon fill="black" stroke="black" points="12327.2,-1014.25 12323.7,-1004.25 12320.2,-1014.25 12327.2,-1014.25"/>
</g>
<!-- layer2_agg_exp1 -->
<g id="node124" class="node">
<title>layer2_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="12309.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="12309.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="12309.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="12309.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="12309.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert1&#45;&gt;layer2_agg_exp1 -->
<g id="edge146" class="edge">
<title>layer2_expert1&#45;&gt;layer2_agg_exp1</title>
<path fill="none" stroke="black" d="M12323.7,-941.09C12323.7,-941.09 12323.7,-915.34 12323.7,-915.34"/>
<polygon fill="black" stroke="black" points="12327.2,-915.34 12323.7,-905.34 12320.2,-915.34 12327.2,-915.34"/>
</g>
<!-- layer2_agg_exp1&#45;&gt;layer2_moe_agg -->
<g id="edge147" class="edge">
<title>layer2_agg_exp1&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M12309.7,-831.5C12309.7,-786.4 12309.7,-716 12309.7,-716 12309.7,-716 14861.1,-716 14861.1,-716"/>
<polygon fill="black" stroke="black" points="14861.1,-719.5 14871.1,-716 14861.1,-712.5 14861.1,-719.5"/>
</g>
<!-- layer2_expert2 -->
<g id="node126" class="node">
<title>layer2_expert2</title>
<polygon fill="lightcoral" stroke="black" points="12853.2,-1004.16 12632.2,-1004.16 12632.2,-941.16 12853.2,-941.16 12853.2,-1004.16"/>
<text text-anchor="middle" x="12742.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="12742.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="12742.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="12742.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="12742.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp2&#45;&gt;layer2_expert2 -->
<g id="edge149" class="edge">
<title>layer2_route_exp2&#45;&gt;layer2_expert2</title>
<path fill="none" stroke="black" d="M12742.7,-1040.16C12742.7,-1040.16 12742.7,-1014.25 12742.7,-1014.25"/>
<polygon fill="black" stroke="black" points="12746.2,-1014.25 12742.7,-1004.25 12739.2,-1014.25 12746.2,-1014.25"/>
</g>
<!-- layer2_agg_exp2 -->
<g id="node127" class="node">
<title>layer2_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="12724.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="12724.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="12724.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="12724.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="12724.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert2&#45;&gt;layer2_agg_exp2 -->
<g id="edge150" class="edge">
<title>layer2_expert2&#45;&gt;layer2_agg_exp2</title>
<path fill="none" stroke="black" d="M12742.7,-941.09C12742.7,-941.09 12742.7,-915.34 12742.7,-915.34"/>
<polygon fill="black" stroke="black" points="12746.2,-915.34 12742.7,-905.34 12739.2,-915.34 12746.2,-915.34"/>
</g>
<!-- layer2_agg_exp2&#45;&gt;layer2_moe_agg -->
<g id="edge151" class="edge">
<title>layer2_agg_exp2&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M12724.7,-831.58C12724.7,-787.92 12724.7,-721 12724.7,-721 12724.7,-721 14834.87,-721 14834.87,-721"/>
<polygon fill="black" stroke="black" points="14834.87,-724.5 14844.87,-721 14834.87,-717.5 14834.87,-724.5"/>
</g>
<!-- layer2_expert3 -->
<g id="node129" class="node">
<title>layer2_expert3</title>
<polygon fill="lightcoral" stroke="black" points="13268.2,-1004.16 13047.2,-1004.16 13047.2,-941.16 13268.2,-941.16 13268.2,-1004.16"/>
<text text-anchor="middle" x="13157.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="13157.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="13157.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13157.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13157.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp3&#45;&gt;layer2_expert3 -->
<g id="edge153" class="edge">
<title>layer2_route_exp3&#45;&gt;layer2_expert3</title>
<path fill="none" stroke="black" d="M13157.7,-1040.16C13157.7,-1040.16 13157.7,-1014.25 13157.7,-1014.25"/>
<polygon fill="black" stroke="black" points="13161.2,-1014.25 13157.7,-1004.25 13154.2,-1014.25 13161.2,-1014.25"/>
</g>
<!-- layer2_agg_exp3 -->
<g id="node130" class="node">
<title>layer2_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="13139.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="13139.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="13139.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="13139.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13139.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert3&#45;&gt;layer2_agg_exp3 -->
<g id="edge154" class="edge">
<title>layer2_expert3&#45;&gt;layer2_agg_exp3</title>
<path fill="none" stroke="black" d="M13157.7,-941.09C13157.7,-941.09 13157.7,-915.34 13157.7,-915.34"/>
<polygon fill="black" stroke="black" points="13161.2,-915.34 13157.7,-905.34 13154.2,-915.34 13161.2,-915.34"/>
</g>
<!-- layer2_agg_exp3&#45;&gt;layer2_moe_agg -->
<g id="edge155" class="edge">
<title>layer2_agg_exp3&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M13139.7,-831.35C13139.7,-789.16 13139.7,-726 13139.7,-726 13139.7,-726 14816.41,-726 14816.41,-726"/>
<polygon fill="black" stroke="black" points="14816.41,-729.5 14826.41,-726 14816.41,-722.5 14816.41,-729.5"/>
</g>
<!-- layer2_expert4 -->
<g id="node132" class="node">
<title>layer2_expert4</title>
<polygon fill="lightcoral" stroke="black" points="13680.2,-1004.16 13459.2,-1004.16 13459.2,-941.16 13680.2,-941.16 13680.2,-1004.16"/>
<text text-anchor="middle" x="13569.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="13569.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="13569.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13569.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13569.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp4&#45;&gt;layer2_expert4 -->
<g id="edge157" class="edge">
<title>layer2_route_exp4&#45;&gt;layer2_expert4</title>
<path fill="none" stroke="black" d="M13569.7,-1040.16C13569.7,-1040.16 13569.7,-1014.25 13569.7,-1014.25"/>
<polygon fill="black" stroke="black" points="13573.2,-1014.25 13569.7,-1004.25 13566.2,-1014.25 13573.2,-1014.25"/>
</g>
<!-- layer2_agg_exp4 -->
<g id="node133" class="node">
<title>layer2_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="13554.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="13554.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="13554.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="13554.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13554.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert4&#45;&gt;layer2_agg_exp4 -->
<g id="edge158" class="edge">
<title>layer2_expert4&#45;&gt;layer2_agg_exp4</title>
<path fill="none" stroke="black" d="M13569.7,-941.09C13569.7,-941.09 13569.7,-915.34 13569.7,-915.34"/>
<polygon fill="black" stroke="black" points="13573.2,-915.34 13569.7,-905.34 13566.2,-915.34 13573.2,-915.34"/>
</g>
<!-- layer2_agg_exp4&#45;&gt;layer2_moe_agg -->
<g id="edge159" class="edge">
<title>layer2_agg_exp4&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M13554.7,-831.57C13554.7,-790.87 13554.7,-731 13554.7,-731 13554.7,-731 14803.88,-731 14803.88,-731"/>
<polygon fill="black" stroke="black" points="14803.88,-734.5 14813.88,-731 14803.88,-727.5 14803.88,-734.5"/>
</g>
<!-- layer2_expert5 -->
<g id="node135" class="node">
<title>layer2_expert5</title>
<polygon fill="lightcoral" stroke="black" points="14091.2,-1004.16 13870.2,-1004.16 13870.2,-941.16 14091.2,-941.16 14091.2,-1004.16"/>
<text text-anchor="middle" x="13980.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="13980.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="13980.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13980.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13980.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp5&#45;&gt;layer2_expert5 -->
<g id="edge161" class="edge">
<title>layer2_route_exp5&#45;&gt;layer2_expert5</title>
<path fill="none" stroke="black" d="M13980.7,-1040.16C13980.7,-1040.16 13980.7,-1014.25 13980.7,-1014.25"/>
<polygon fill="black" stroke="black" points="13984.2,-1014.25 13980.7,-1004.25 13977.2,-1014.25 13984.2,-1014.25"/>
</g>
<!-- layer2_agg_exp5 -->
<g id="node136" class="node">
<title>layer2_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="13969.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="13969.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="13969.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="13969.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13969.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert5&#45;&gt;layer2_agg_exp5 -->
<g id="edge162" class="edge">
<title>layer2_expert5&#45;&gt;layer2_agg_exp5</title>
<path fill="none" stroke="black" d="M13980.7,-941.09C13980.7,-941.09 13980.7,-915.34 13980.7,-915.34"/>
<polygon fill="black" stroke="black" points="13984.2,-915.34 13980.7,-905.34 13977.2,-915.34 13984.2,-915.34"/>
</g>
<!-- layer2_agg_exp5&#45;&gt;layer2_moe_agg -->
<g id="edge163" class="edge">
<title>layer2_agg_exp5&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M13969.7,-831.51C13969.7,-792.34 13969.7,-736 13969.7,-736 13969.7,-736 14795.83,-736 14795.83,-736"/>
<polygon fill="black" stroke="black" points="14795.83,-739.5 14805.83,-736 14795.83,-732.5 14795.83,-739.5"/>
</g>
<!-- layer2_expert6 -->
<g id="node138" class="node">
<title>layer2_expert6</title>
<polygon fill="lightcoral" stroke="black" points="14502.2,-1004.16 14281.2,-1004.16 14281.2,-941.16 14502.2,-941.16 14502.2,-1004.16"/>
<text text-anchor="middle" x="14391.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="14391.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="14391.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="14391.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="14391.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp6&#45;&gt;layer2_expert6 -->
<g id="edge165" class="edge">
<title>layer2_route_exp6&#45;&gt;layer2_expert6</title>
<path fill="none" stroke="black" d="M14391.7,-1040.16C14391.7,-1040.16 14391.7,-1014.25 14391.7,-1014.25"/>
<polygon fill="black" stroke="black" points="14395.2,-1014.25 14391.7,-1004.25 14388.2,-1014.25 14395.2,-1014.25"/>
</g>
<!-- layer2_agg_exp6 -->
<g id="node139" class="node">
<title>layer2_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="14384.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="14384.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="14384.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="14384.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="14384.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert6&#45;&gt;layer2_agg_exp6 -->
<g id="edge166" class="edge">
<title>layer2_expert6&#45;&gt;layer2_agg_exp6</title>
<path fill="none" stroke="black" d="M14391.7,-941.09C14391.7,-941.09 14391.7,-915.34 14391.7,-915.34"/>
<polygon fill="black" stroke="black" points="14395.2,-915.34 14391.7,-905.34 14388.2,-915.34 14395.2,-915.34"/>
</g>
<!-- layer2_agg_exp6&#45;&gt;layer2_moe_agg -->
<g id="edge167" class="edge">
<title>layer2_agg_exp6&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M14575.3,-857.96C14575.3,-827.54 14575.3,-741 14575.3,-741 14575.3,-741 14792.05,-741 14792.05,-741"/>
<polygon fill="black" stroke="black" points="14792.05,-744.5 14802.05,-741 14792.05,-737.5 14792.05,-744.5"/>
</g>
<!-- layer2_expert7 -->
<g id="node141" class="node">
<title>layer2_expert7</title>
<polygon fill="lightcoral" stroke="black" points="14912.2,-1004.16 14691.2,-1004.16 14691.2,-941.16 14912.2,-941.16 14912.2,-1004.16"/>
<text text-anchor="middle" x="14801.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="14801.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="14801.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="14801.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="14801.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp7&#45;&gt;layer2_expert7 -->
<g id="edge169" class="edge">
<title>layer2_route_exp7&#45;&gt;layer2_expert7</title>
<path fill="none" stroke="black" d="M14801.7,-1039.87C14801.7,-1039.87 14801.7,-1014.41 14801.7,-1014.41"/>
<polygon fill="black" stroke="black" points="14805.2,-1014.41 14801.7,-1004.41 14798.2,-1014.41 14805.2,-1014.41"/>
</g>
<!-- layer2_agg_exp7 -->
<g id="node142" class="node">
<title>layer2_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="14799.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="14799.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="14799.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="14799.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="14799.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert7&#45;&gt;layer2_agg_exp7 -->
<g id="edge170" class="edge">
<title>layer2_expert7&#45;&gt;layer2_agg_exp7</title>
<path fill="none" stroke="black" d="M14801.7,-941.09C14801.7,-941.09 14801.7,-915.34 14801.7,-915.34"/>
<polygon fill="black" stroke="black" points="14805.2,-915.34 14801.7,-905.34 14798.2,-915.34 14805.2,-915.34"/>
</g>
<!-- layer2_agg_exp7&#45;&gt;layer2_moe_agg -->
<g id="edge171" class="edge">
<title>layer2_agg_exp7&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M14900.02,-836.58C14900.02,-836.58 14900.02,-785.37 14900.02,-785.37"/>
<polygon fill="black" stroke="black" points="14903.52,-785.37 14900.02,-775.37 14896.52,-785.37 14903.52,-785.37"/>
</g>
<!-- layer2_expert8 -->
<g id="node144" class="node">
<title>layer2_expert8</title>
<polygon fill="lightcoral" stroke="black" points="15320.2,-1004.16 15099.2,-1004.16 15099.2,-941.16 15320.2,-941.16 15320.2,-1004.16"/>
<text text-anchor="middle" x="15209.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="15209.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="15209.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="15209.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="15209.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp8&#45;&gt;layer2_expert8 -->
<g id="edge173" class="edge">
<title>layer2_route_exp8&#45;&gt;layer2_expert8</title>
<path fill="none" stroke="black" d="M15209.7,-1039.87C15209.7,-1039.87 15209.7,-1014.41 15209.7,-1014.41"/>
<polygon fill="black" stroke="black" points="15213.2,-1014.41 15209.7,-1004.41 15206.2,-1014.41 15213.2,-1014.41"/>
</g>
<!-- layer2_agg_exp8 -->
<g id="node145" class="node">
<title>layer2_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="15214.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="15214.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="15214.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="15214.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="15214.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert8&#45;&gt;layer2_agg_exp8 -->
<g id="edge174" class="edge">
<title>layer2_expert8&#45;&gt;layer2_agg_exp8</title>
<path fill="none" stroke="black" d="M15209.7,-941.09C15209.7,-941.09 15209.7,-915.34 15209.7,-915.34"/>
<polygon fill="black" stroke="black" points="15213.2,-915.34 15209.7,-905.34 15206.2,-915.34 15213.2,-915.34"/>
</g>
<!-- layer2_agg_exp8&#45;&gt;layer2_moe_agg -->
<g id="edge175" class="edge">
<title>layer2_agg_exp8&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M15113.88,-836.58C15113.88,-836.58 15113.88,-785.37 15113.88,-785.37"/>
<polygon fill="black" stroke="black" points="15117.38,-785.37 15113.88,-775.37 15110.38,-785.37 15117.38,-785.37"/>
</g>
<!-- layer2_expert9 -->
<g id="node147" class="node">
<title>layer2_expert9</title>
<polygon fill="lightcoral" stroke="black" points="15733.2,-1004.16 15512.2,-1004.16 15512.2,-941.16 15733.2,-941.16 15733.2,-1004.16"/>
<text text-anchor="middle" x="15622.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="15622.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="15622.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="15622.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="15622.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp9&#45;&gt;layer2_expert9 -->
<g id="edge177" class="edge">
<title>layer2_route_exp9&#45;&gt;layer2_expert9</title>
<path fill="none" stroke="black" d="M15622.7,-1039.87C15622.7,-1039.87 15622.7,-1014.41 15622.7,-1014.41"/>
<polygon fill="black" stroke="black" points="15626.2,-1014.41 15622.7,-1004.41 15619.2,-1014.41 15626.2,-1014.41"/>
</g>
<!-- layer2_agg_exp9 -->
<g id="node148" class="node">
<title>layer2_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="15629.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="15629.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="15629.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="15629.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="15629.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert9&#45;&gt;layer2_agg_exp9 -->
<g id="edge178" class="edge">
<title>layer2_expert9&#45;&gt;layer2_agg_exp9</title>
<path fill="none" stroke="black" d="M15622.7,-941.09C15622.7,-941.09 15622.7,-915.34 15622.7,-915.34"/>
<polygon fill="black" stroke="black" points="15626.2,-915.34 15622.7,-905.34 15619.2,-915.34 15626.2,-915.34"/>
</g>
<!-- layer2_agg_exp9&#45;&gt;layer2_moe_agg -->
<g id="edge179" class="edge">
<title>layer2_agg_exp9&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M15629.7,-831.48C15629.7,-805.37 15629.7,-775 15629.7,-775 15629.7,-775 15123.79,-775 15123.79,-775"/>
<polygon fill="black" stroke="black" points="15123.79,-771.5 15113.79,-775 15123.79,-778.5 15123.79,-771.5"/>
</g>
<!-- layer2_expert10 -->
<g id="node150" class="node">
<title>layer2_expert10</title>
<polygon fill="lightcoral" stroke="black" points="16147.2,-1004.16 15926.2,-1004.16 15926.2,-941.16 16147.2,-941.16 16147.2,-1004.16"/>
<text text-anchor="middle" x="16036.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="16036.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="16036.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16036.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16036.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp10&#45;&gt;layer2_expert10 -->
<g id="edge181" class="edge">
<title>layer2_route_exp10&#45;&gt;layer2_expert10</title>
<path fill="none" stroke="black" d="M16036.7,-1040.16C16036.7,-1040.16 16036.7,-1014.25 16036.7,-1014.25"/>
<polygon fill="black" stroke="black" points="16040.2,-1014.25 16036.7,-1004.25 16033.2,-1014.25 16040.2,-1014.25"/>
</g>
<!-- layer2_agg_exp10 -->
<g id="node151" class="node">
<title>layer2_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="16044.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="16044.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="16044.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="16044.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16044.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert10&#45;&gt;layer2_agg_exp10 -->
<g id="edge182" class="edge">
<title>layer2_expert10&#45;&gt;layer2_agg_exp10</title>
<path fill="none" stroke="black" d="M16036.7,-941.09C16036.7,-941.09 16036.7,-915.34 16036.7,-915.34"/>
<polygon fill="black" stroke="black" points="16040.2,-915.34 16036.7,-905.34 16033.2,-915.34 16040.2,-915.34"/>
</g>
<!-- layer2_agg_exp10&#45;&gt;layer2_moe_agg -->
<g id="edge183" class="edge">
<title>layer2_agg_exp10&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M16044.7,-831.47C16044.7,-803.55 16044.7,-770 16044.7,-770 16044.7,-770 15159.66,-770 15159.66,-770"/>
<polygon fill="black" stroke="black" points="15159.66,-766.5 15149.66,-770 15159.66,-773.5 15159.66,-766.5"/>
</g>
<!-- layer2_expert11 -->
<g id="node153" class="node">
<title>layer2_expert11</title>
<polygon fill="lightcoral" stroke="black" points="16560.2,-1004.16 16339.2,-1004.16 16339.2,-941.16 16560.2,-941.16 16560.2,-1004.16"/>
<text text-anchor="middle" x="16449.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="16449.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="16449.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16449.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16449.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp11&#45;&gt;layer2_expert11 -->
<g id="edge185" class="edge">
<title>layer2_route_exp11&#45;&gt;layer2_expert11</title>
<path fill="none" stroke="black" d="M16449.7,-1040.16C16449.7,-1040.16 16449.7,-1014.25 16449.7,-1014.25"/>
<polygon fill="black" stroke="black" points="16453.2,-1014.25 16449.7,-1004.25 16446.2,-1014.25 16453.2,-1014.25"/>
</g>
<!-- layer2_agg_exp11 -->
<g id="node154" class="node">
<title>layer2_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="16459.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="16459.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="16459.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="16459.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16459.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert11&#45;&gt;layer2_agg_exp11 -->
<g id="edge186" class="edge">
<title>layer2_expert11&#45;&gt;layer2_agg_exp11</title>
<path fill="none" stroke="black" d="M16449.7,-941.09C16449.7,-941.09 16449.7,-915.34 16449.7,-915.34"/>
<polygon fill="black" stroke="black" points="16453.2,-915.34 16449.7,-905.34 16446.2,-915.34 16453.2,-915.34"/>
</g>
<!-- layer2_agg_exp11&#45;&gt;layer2_moe_agg -->
<g id="edge187" class="edge">
<title>layer2_agg_exp11&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M16459.7,-831.35C16459.7,-801.69 16459.7,-765 16459.7,-765 16459.7,-765 15183.73,-765 15183.73,-765"/>
<polygon fill="black" stroke="black" points="15183.73,-761.5 15173.73,-765 15183.73,-768.5 15183.73,-761.5"/>
</g>
<!-- layer2_expert12 -->
<g id="node156" class="node">
<title>layer2_expert12</title>
<polygon fill="lightcoral" stroke="black" points="16978.2,-1004.16 16757.2,-1004.16 16757.2,-941.16 16978.2,-941.16 16978.2,-1004.16"/>
<text text-anchor="middle" x="16867.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="16867.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="16867.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16867.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16867.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp12&#45;&gt;layer2_expert12 -->
<g id="edge189" class="edge">
<title>layer2_route_exp12&#45;&gt;layer2_expert12</title>
<path fill="none" stroke="black" d="M16867.7,-1040.16C16867.7,-1040.16 16867.7,-1014.25 16867.7,-1014.25"/>
<polygon fill="black" stroke="black" points="16871.2,-1014.25 16867.7,-1004.25 16864.2,-1014.25 16871.2,-1014.25"/>
</g>
<!-- layer2_agg_exp12 -->
<g id="node157" class="node">
<title>layer2_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="16874.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="16874.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="16874.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="16874.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16874.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert12&#45;&gt;layer2_agg_exp12 -->
<g id="edge190" class="edge">
<title>layer2_expert12&#45;&gt;layer2_agg_exp12</title>
<path fill="none" stroke="black" d="M16867.7,-941.09C16867.7,-941.09 16867.7,-915.34 16867.7,-915.34"/>
<polygon fill="black" stroke="black" points="16871.2,-915.34 16867.7,-905.34 16864.2,-915.34 16871.2,-915.34"/>
</g>
<!-- layer2_agg_exp12&#45;&gt;layer2_moe_agg -->
<g id="edge191" class="edge">
<title>layer2_agg_exp12&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M16874.7,-831.39C16874.7,-799.99 16874.7,-760 16874.7,-760 16874.7,-760 15200.49,-760 15200.49,-760"/>
<polygon fill="black" stroke="black" points="15200.49,-756.5 15190.49,-760 15200.49,-763.5 15200.49,-756.5"/>
</g>
<!-- layer2_expert13 -->
<g id="node159" class="node">
<title>layer2_expert13</title>
<polygon fill="lightcoral" stroke="black" points="17390.2,-1004.16 17169.2,-1004.16 17169.2,-941.16 17390.2,-941.16 17390.2,-1004.16"/>
<text text-anchor="middle" x="17279.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="17279.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="17279.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="17279.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="17279.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp13&#45;&gt;layer2_expert13 -->
<g id="edge193" class="edge">
<title>layer2_route_exp13&#45;&gt;layer2_expert13</title>
<path fill="none" stroke="black" d="M17279.7,-1040.16C17279.7,-1040.16 17279.7,-1014.25 17279.7,-1014.25"/>
<polygon fill="black" stroke="black" points="17283.2,-1014.25 17279.7,-1004.25 17276.2,-1014.25 17283.2,-1014.25"/>
</g>
<!-- layer2_agg_exp13 -->
<g id="node160" class="node">
<title>layer2_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="17289.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="17289.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="17289.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="17289.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="17289.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert13&#45;&gt;layer2_agg_exp13 -->
<g id="edge194" class="edge">
<title>layer2_expert13&#45;&gt;layer2_agg_exp13</title>
<path fill="none" stroke="black" d="M17279.7,-941.09C17279.7,-941.09 17279.7,-915.34 17279.7,-915.34"/>
<polygon fill="black" stroke="black" points="17283.2,-915.34 17279.7,-905.34 17276.2,-915.34 17283.2,-915.34"/>
</g>
<!-- layer2_agg_exp13&#45;&gt;layer2_moe_agg -->
<g id="edge195" class="edge">
<title>layer2_agg_exp13&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M17289.7,-831.57C17289.7,-798.47 17289.7,-755 17289.7,-755 17289.7,-755 15211.84,-755 15211.84,-755"/>
<polygon fill="black" stroke="black" points="15211.84,-751.5 15201.84,-755 15211.84,-758.5 15211.84,-751.5"/>
</g>
<!-- layer2_expert14 -->
<g id="node162" class="node">
<title>layer2_expert14</title>
<polygon fill="lightcoral" stroke="black" points="17806.2,-1004.16 17585.2,-1004.16 17585.2,-941.16 17806.2,-941.16 17806.2,-1004.16"/>
<text text-anchor="middle" x="17695.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="17695.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="17695.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="17695.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="17695.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp14&#45;&gt;layer2_expert14 -->
<g id="edge197" class="edge">
<title>layer2_route_exp14&#45;&gt;layer2_expert14</title>
<path fill="none" stroke="black" d="M17695.7,-1040.16C17695.7,-1040.16 17695.7,-1014.25 17695.7,-1014.25"/>
<polygon fill="black" stroke="black" points="17699.2,-1014.25 17695.7,-1004.25 17692.2,-1014.25 17699.2,-1014.25"/>
</g>
<!-- layer2_agg_exp14 -->
<g id="node163" class="node">
<title>layer2_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="17704.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="17704.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="17704.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="17704.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="17704.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert14&#45;&gt;layer2_agg_exp14 -->
<g id="edge198" class="edge">
<title>layer2_expert14&#45;&gt;layer2_agg_exp14</title>
<path fill="none" stroke="black" d="M17695.7,-941.09C17695.7,-941.09 17695.7,-915.34 17695.7,-915.34"/>
<polygon fill="black" stroke="black" points="17699.2,-915.34 17695.7,-905.34 17692.2,-915.34 17699.2,-915.34"/>
</g>
<!-- layer2_agg_exp14&#45;&gt;layer2_moe_agg -->
<g id="edge199" class="edge">
<title>layer2_agg_exp14&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M17704.7,-831.58C17704.7,-796.82 17704.7,-750 17704.7,-750 17704.7,-750 15218.66,-750 15218.66,-750"/>
<polygon fill="black" stroke="black" points="15218.66,-746.5 15208.66,-750 15218.66,-753.5 15218.66,-746.5"/>
</g>
<!-- layer2_expert15 -->
<g id="node165" class="node">
<title>layer2_expert15</title>
<polygon fill="lightcoral" stroke="black" points="18221.2,-1004.16 18000.2,-1004.16 18000.2,-941.16 18221.2,-941.16 18221.2,-1004.16"/>
<text text-anchor="middle" x="18110.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="18110.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="18110.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18110.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18110.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer2_route_exp15&#45;&gt;layer2_expert15 -->
<g id="edge201" class="edge">
<title>layer2_route_exp15&#45;&gt;layer2_expert15</title>
<path fill="none" stroke="black" d="M18110.7,-1040.16C18110.7,-1040.16 18110.7,-1014.25 18110.7,-1014.25"/>
<polygon fill="black" stroke="black" points="18114.2,-1014.25 18110.7,-1004.25 18107.2,-1014.25 18114.2,-1014.25"/>
</g>
<!-- layer2_agg_exp15 -->
<g id="node166" class="node">
<title>layer2_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="18119.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="18119.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="18119.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="18119.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18119.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer2_expert15&#45;&gt;layer2_agg_exp15 -->
<g id="edge202" class="edge">
<title>layer2_expert15&#45;&gt;layer2_agg_exp15</title>
<path fill="none" stroke="black" d="M18110.7,-941.09C18110.7,-941.09 18110.7,-915.34 18110.7,-915.34"/>
<polygon fill="black" stroke="black" points="18114.2,-915.34 18110.7,-905.34 18107.2,-915.34 18114.2,-915.34"/>
</g>
<!-- layer2_agg_exp15&#45;&gt;layer2_moe_agg -->
<g id="edge203" class="edge">
<title>layer2_agg_exp15&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M18119.7,-831.33C18119.7,-795.31 18119.7,-746 18119.7,-746 18119.7,-746 15221.55,-746 15221.55,-746"/>
<polygon fill="black" stroke="black" points="15221.55,-742.5 15211.55,-746 15221.55,-749.5 15221.55,-742.5"/>
</g>
<!-- layer3_ln1 -->
<g id="node168" class="node">
<title>layer3_ln1</title>
<polygon fill="none" stroke="black" points="18462.2,-1227.7 18181.2,-1227.7 18181.2,-1175.7 18462.2,-1175.7 18462.2,-1227.7"/>
<text text-anchor="middle" x="18321.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 3</text>
<text text-anchor="middle" x="18321.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18321.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18321.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer3_add1 -->
<g id="node169" class="node">
<title>layer3_add1</title>
<polygon fill="yellow" stroke="black" points="21488.2,-644.85 21207.2,-644.85 21207.2,-592.85 21488.2,-592.85 21488.2,-644.85"/>
<text text-anchor="middle" x="21347.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 3</text>
<text text-anchor="middle" x="21347.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21347.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21347.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_moe_output -->
<g id="node173" class="node">
<title>layer3_moe_output</title>
<polygon fill="yellow" stroke="black" points="21637.2,-540.58 21356.2,-540.58 21356.2,-488.58 21637.2,-488.58 21637.2,-540.58"/>
<text text-anchor="middle" x="21496.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 3</text>
<text text-anchor="middle" x="21496.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21496.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21496.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_add1&#45;&gt;layer3_moe_output -->
<g id="edge273" class="edge">
<title>layer3_add1&#45;&gt;layer3_moe_output</title>
<path fill="none" stroke="black" d="M21422.2,-592.81C21422.2,-592.81 21422.2,-550.65 21422.2,-550.65"/>
<polygon fill="black" stroke="black" points="21425.7,-550.65 21422.2,-540.65 21418.7,-550.65 21425.7,-550.65"/>
</g>
<!-- layer3_gate -->
<g id="node170" class="node">
<title>layer3_gate</title>
<polygon fill="lightgreen" stroke="black" points="21936.13,-1253.7 21477.3,-1253.7 21359.26,-1149.7 21818.1,-1149.7 21936.13,-1253.7"/>
<text text-anchor="middle" x="21647.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 3</text>
<text text-anchor="middle" x="21647.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21647.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="21647.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer3_route_exp0 -->
<g id="node174" class="node">
<title>layer3_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="18538.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="18538.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="18538.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="18538.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18538.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp0 -->
<g id="edge207" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp0</title>
<path fill="none" stroke="black" d="M21385.64,-1173C20646.29,-1173 18597.32,-1173 18597.32,-1173 18597.32,-1173 18597.32,-1122.15 18597.32,-1122.15"/>
<polygon fill="black" stroke="black" points="18600.82,-1122.15 18597.32,-1112.15 18593.82,-1122.15 18600.82,-1122.15"/>
</g>
<!-- layer3_route_exp1 -->
<g id="node177" class="node">
<title>layer3_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="18978.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="18978.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="18978.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="18978.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18978.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp1 -->
<g id="edge211" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp1</title>
<path fill="none" stroke="black" d="M21379.87,-1168C20703.26,-1168 18978.7,-1168 18978.7,-1168 18978.7,-1168 18978.7,-1123.71 18978.7,-1123.71"/>
<polygon fill="black" stroke="black" points="18982.2,-1123.71 18978.7,-1113.71 18975.2,-1123.71 18982.2,-1123.71"/>
</g>
<!-- layer3_route_exp2 -->
<g id="node180" class="node">
<title>layer3_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="19400.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="19400.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="19400.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="19400.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="19400.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp2 -->
<g id="edge215" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp2</title>
<path fill="none" stroke="black" d="M21376.38,-1165C20778.59,-1165 19400.7,-1165 19400.7,-1165 19400.7,-1165 19400.7,-1123.77 19400.7,-1123.77"/>
<polygon fill="black" stroke="black" points="19404.2,-1123.77 19400.7,-1113.77 19397.2,-1123.77 19404.2,-1123.77"/>
</g>
<!-- layer3_route_exp3 -->
<g id="node183" class="node">
<title>layer3_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="19814.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="19814.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="19814.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="19814.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="19814.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp3 -->
<g id="edge219" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp3</title>
<path fill="none" stroke="black" d="M21371.79,-1161C20859.9,-1161 19814.7,-1161 19814.7,-1161 19814.7,-1161 19814.7,-1124.05 19814.7,-1124.05"/>
<polygon fill="black" stroke="black" points="19818.2,-1124.05 19814.7,-1114.05 19811.2,-1124.05 19818.2,-1124.05"/>
</g>
<!-- layer3_route_exp4 -->
<g id="node186" class="node">
<title>layer3_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="20223.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="20223.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="20223.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="20223.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="20223.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp4 -->
<g id="edge223" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp4</title>
<path fill="none" stroke="black" d="M21368.48,-1158C20953.85,-1158 20223.7,-1158 20223.7,-1158 20223.7,-1158 20223.7,-1124.14 20223.7,-1124.14"/>
<polygon fill="black" stroke="black" points="20227.2,-1124.14 20223.7,-1114.14 20220.2,-1124.14 20227.2,-1124.14"/>
</g>
<!-- layer3_route_exp5 -->
<g id="node189" class="node">
<title>layer3_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="20630.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="20630.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="20630.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="20630.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="20630.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp5 -->
<g id="edge227" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp5</title>
<path fill="none" stroke="black" d="M21364.07,-1154C21063.16,-1154 20630.7,-1154 20630.7,-1154 20630.7,-1154 20630.7,-1124.11 20630.7,-1124.11"/>
<polygon fill="black" stroke="black" points="20634.2,-1124.11 20630.7,-1114.11 20627.2,-1124.11 20634.2,-1124.11"/>
</g>
<!-- layer3_route_exp6 -->
<g id="node192" class="node">
<title>layer3_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="21036.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="21036.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="21036.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="21036.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21036.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp6 -->
<g id="edge231" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp6</title>
<path fill="none" stroke="black" d="M21360.54,-1151C21201.92,-1151 21036.7,-1151 21036.7,-1151 21036.7,-1151 21036.7,-1123.96 21036.7,-1123.96"/>
<polygon fill="black" stroke="black" points="21040.2,-1123.96 21036.7,-1113.96 21033.2,-1123.96 21040.2,-1123.96"/>
</g>
<!-- layer3_route_exp7 -->
<g id="node195" class="node">
<title>layer3_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="21442.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="21442.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="21442.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="21442.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21442.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp7 -->
<g id="edge235" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp7</title>
<path fill="none" stroke="black" d="M21497.96,-1149.5C21497.96,-1149.5 21497.96,-1122.25 21497.96,-1122.25"/>
<polygon fill="black" stroke="black" points="21501.46,-1122.25 21497.96,-1112.25 21494.46,-1122.25 21501.46,-1122.25"/>
</g>
<!-- layer3_route_exp8 -->
<g id="node198" class="node">
<title>layer3_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="21852.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="21852.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="21852.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="21852.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21852.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp8 -->
<g id="edge239" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp8</title>
<path fill="none" stroke="black" d="M21797.43,-1149.5C21797.43,-1149.5 21797.43,-1122.25 21797.43,-1122.25"/>
<polygon fill="black" stroke="black" points="21800.93,-1122.25 21797.43,-1112.25 21793.93,-1122.25 21800.93,-1122.25"/>
</g>
<!-- layer3_route_exp9 -->
<g id="node201" class="node">
<title>layer3_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="22260.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="22260.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="22260.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="22260.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="22260.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp9 -->
<g id="edge243" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp9</title>
<path fill="none" stroke="black" d="M21822.13,-1153C22003.34,-1153 22260.7,-1153 22260.7,-1153 22260.7,-1153 22260.7,-1124.07 22260.7,-1124.07"/>
<polygon fill="black" stroke="black" points="22264.2,-1124.07 22260.7,-1114.07 22257.2,-1124.07 22264.2,-1124.07"/>
</g>
<!-- layer3_route_exp10 -->
<g id="node204" class="node">
<title>layer3_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="22671.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="22671.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="22671.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="22671.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="22671.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp10 -->
<g id="edge247" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp10</title>
<path fill="none" stroke="black" d="M21825.48,-1156C22118.71,-1156 22671.7,-1156 22671.7,-1156 22671.7,-1156 22671.7,-1124.15 22671.7,-1124.15"/>
<polygon fill="black" stroke="black" points="22675.2,-1124.15 22671.7,-1114.15 22668.2,-1124.15 22675.2,-1124.15"/>
</g>
<!-- layer3_route_exp11 -->
<g id="node207" class="node">
<title>layer3_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="23083.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="23083.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="23083.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="23083.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="23083.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp11 -->
<g id="edge251" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp11</title>
<path fill="none" stroke="black" d="M21829.93,-1160C22216.52,-1160 23083.7,-1160 23083.7,-1160 23083.7,-1160 23083.7,-1124.09 23083.7,-1124.09"/>
<polygon fill="black" stroke="black" points="23087.2,-1124.09 23083.7,-1114.09 23080.2,-1124.09 23087.2,-1124.09"/>
</g>
<!-- layer3_route_exp12 -->
<g id="node210" class="node">
<title>layer3_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="23497.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="23497.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="23497.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="23497.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="23497.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp12 -->
<g id="edge255" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp12</title>
<path fill="none" stroke="black" d="M21833.55,-1163C22302.69,-1163 23497.7,-1163 23497.7,-1163 23497.7,-1163 23497.7,-1123.93 23497.7,-1123.93"/>
<polygon fill="black" stroke="black" points="23501.2,-1123.93 23497.7,-1113.93 23494.2,-1123.93 23501.2,-1123.93"/>
</g>
<!-- layer3_route_exp13 -->
<g id="node213" class="node">
<title>layer3_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="23911.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="23911.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="23911.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="23911.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="23911.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp13 -->
<g id="edge259" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp13</title>
<path fill="none" stroke="black" d="M21837.8,-1167C22382.78,-1167 23911.7,-1167 23911.7,-1167 23911.7,-1167 23911.7,-1123.82 23911.7,-1123.82"/>
<polygon fill="black" stroke="black" points="23915.2,-1123.82 23911.7,-1113.82 23908.2,-1123.82 23915.2,-1123.82"/>
</g>
<!-- layer3_route_exp14 -->
<g id="node216" class="node">
<title>layer3_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="24325.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="24325.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="24325.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="24325.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="24325.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp14 -->
<g id="edge263" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp14</title>
<path fill="none" stroke="black" d="M21841.37,-1170C22456.52,-1170 24325.7,-1170 24325.7,-1170 24325.7,-1170 24325.7,-1123.71 24325.7,-1123.71"/>
<polygon fill="black" stroke="black" points="24329.2,-1123.71 24325.7,-1113.71 24322.2,-1123.71 24329.2,-1123.71"/>
</g>
<!-- layer3_route_exp15 -->
<g id="node219" class="node">
<title>layer3_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="24740.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="24740.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="24740.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="24740.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="24740.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_exp15 -->
<g id="edge267" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_exp15</title>
<path fill="none" stroke="black" d="M21844.74,-1173C22518.14,-1173 24686.57,-1173 24686.57,-1173 24686.57,-1173 24686.57,-1122.43 24686.57,-1122.43"/>
<polygon fill="black" stroke="black" points="24690.07,-1122.43 24686.57,-1112.43 24683.07,-1122.43 24690.07,-1122.43"/>
</g>
<!-- layer3_moe_agg -->
<g id="node171" class="node">
<title>layer3_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="21646.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="21646.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 3</text>
<text text-anchor="middle" x="21646.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21646.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21646.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer3_ln2 -->
<g id="node172" class="node">
<title>layer3_ln2</title>
<polygon fill="none" stroke="black" points="21787.2,-644.85 21506.2,-644.85 21506.2,-592.85 21787.2,-592.85 21787.2,-644.85"/>
<text text-anchor="middle" x="21646.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 3</text>
<text text-anchor="middle" x="21646.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21646.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21646.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer3_moe_agg&#45;&gt;layer3_ln2 -->
<g id="edge271" class="edge">
<title>layer3_moe_agg&#45;&gt;layer3_ln2</title>
<path fill="none" stroke="black" d="M21646.7,-706.52C21646.7,-706.52 21646.7,-654.92 21646.7,-654.92"/>
<polygon fill="black" stroke="black" points="21650.2,-654.92 21646.7,-644.92 21643.2,-654.92 21650.2,-654.92"/>
</g>
<!-- layer3_ln2&#45;&gt;layer3_moe_output -->
<g id="edge272" class="edge">
<title>layer3_ln2&#45;&gt;layer3_moe_output</title>
<path fill="none" stroke="black" d="M21571.7,-592.81C21571.7,-592.81 21571.7,-550.65 21571.7,-550.65"/>
<polygon fill="black" stroke="black" points="21575.2,-550.65 21571.7,-540.65 21568.2,-550.65 21575.2,-550.65"/>
</g>
<!-- layer4_mha -->
<g id="node222" class="node">
<title>layer4_mha</title>
<polygon fill="lightcyan" stroke="black" points="21637.2,-436.31 21356.2,-436.31 21356.2,-384.31 21637.2,-384.31 21637.2,-436.31"/>
<text text-anchor="middle" x="21496.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 4</text>
<text text-anchor="middle" x="21496.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21496.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21496.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer3_moe_output&#45;&gt;layer4_mha -->
<g id="edge1081" class="edge">
<title>layer3_moe_output&#45;&gt;layer4_mha</title>
<path fill="none" stroke="black" d="M21496.7,-488.54C21496.7,-488.54 21496.7,-446.38 21496.7,-446.38"/>
<polygon fill="black" stroke="black" points="21500.2,-446.38 21496.7,-436.38 21493.2,-446.38 21500.2,-446.38"/>
</g>
<!-- layer3_expert0 -->
<g id="node175" class="node">
<title>layer3_expert0</title>
<polygon fill="lightcoral" stroke="black" points="18649.2,-1004.16 18428.2,-1004.16 18428.2,-941.16 18649.2,-941.16 18649.2,-1004.16"/>
<text text-anchor="middle" x="18538.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="18538.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="18538.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18538.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18538.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp0&#45;&gt;layer3_expert0 -->
<g id="edge208" class="edge">
<title>layer3_route_exp0&#45;&gt;layer3_expert0</title>
<path fill="none" stroke="black" d="M18538.7,-1039.87C18538.7,-1039.87 18538.7,-1014.41 18538.7,-1014.41"/>
<polygon fill="black" stroke="black" points="18542.2,-1014.41 18538.7,-1004.41 18535.2,-1014.41 18542.2,-1014.41"/>
</g>
<!-- layer3_agg_exp0 -->
<g id="node176" class="node">
<title>layer3_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="18534.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="18534.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="18534.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="18534.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18534.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert0&#45;&gt;layer3_agg_exp0 -->
<g id="edge209" class="edge">
<title>layer3_expert0&#45;&gt;layer3_agg_exp0</title>
<path fill="none" stroke="black" d="M18538.7,-941.09C18538.7,-941.09 18538.7,-915.34 18538.7,-915.34"/>
<polygon fill="black" stroke="black" points="18542.2,-915.34 18538.7,-905.34 18535.2,-915.34 18542.2,-915.34"/>
</g>
<!-- layer3_agg_exp0&#45;&gt;layer3_moe_agg -->
<g id="edge210" class="edge">
<title>layer3_agg_exp0&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M18534.7,-831.49C18534.7,-784.97 18534.7,-711 18534.7,-711 18534.7,-711 21541.86,-711 21541.86,-711"/>
<polygon fill="black" stroke="black" points="21541.86,-714.5 21551.86,-711 21541.86,-707.5 21541.86,-714.5"/>
</g>
<!-- layer3_expert1 -->
<g id="node178" class="node">
<title>layer3_expert1</title>
<polygon fill="lightcoral" stroke="black" points="19074.2,-1004.16 18853.2,-1004.16 18853.2,-941.16 19074.2,-941.16 19074.2,-1004.16"/>
<text text-anchor="middle" x="18963.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="18963.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="18963.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18963.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18963.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp1&#45;&gt;layer3_expert1 -->
<g id="edge212" class="edge">
<title>layer3_route_exp1&#45;&gt;layer3_expert1</title>
<path fill="none" stroke="black" d="M18963.7,-1040.16C18963.7,-1040.16 18963.7,-1014.25 18963.7,-1014.25"/>
<polygon fill="black" stroke="black" points="18967.2,-1014.25 18963.7,-1004.25 18960.2,-1014.25 18967.2,-1014.25"/>
</g>
<!-- layer3_agg_exp1 -->
<g id="node179" class="node">
<title>layer3_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="18949.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="18949.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="18949.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="18949.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18949.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert1&#45;&gt;layer3_agg_exp1 -->
<g id="edge213" class="edge">
<title>layer3_expert1&#45;&gt;layer3_agg_exp1</title>
<path fill="none" stroke="black" d="M18963.7,-941.09C18963.7,-941.09 18963.7,-915.34 18963.7,-915.34"/>
<polygon fill="black" stroke="black" points="18967.2,-915.34 18963.7,-905.34 18960.2,-915.34 18967.2,-915.34"/>
</g>
<!-- layer3_agg_exp1&#45;&gt;layer3_moe_agg -->
<g id="edge214" class="edge">
<title>layer3_agg_exp1&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M18949.7,-831.5C18949.7,-786.4 18949.7,-716 18949.7,-716 18949.7,-716 21501.1,-716 21501.1,-716"/>
<polygon fill="black" stroke="black" points="21501.1,-719.5 21511.1,-716 21501.1,-712.5 21501.1,-719.5"/>
</g>
<!-- layer3_expert2 -->
<g id="node181" class="node">
<title>layer3_expert2</title>
<polygon fill="lightcoral" stroke="black" points="19492.2,-1004.16 19271.2,-1004.16 19271.2,-941.16 19492.2,-941.16 19492.2,-1004.16"/>
<text text-anchor="middle" x="19381.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="19381.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="19381.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="19381.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="19381.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp2&#45;&gt;layer3_expert2 -->
<g id="edge216" class="edge">
<title>layer3_route_exp2&#45;&gt;layer3_expert2</title>
<path fill="none" stroke="black" d="M19381.7,-1040.16C19381.7,-1040.16 19381.7,-1014.25 19381.7,-1014.25"/>
<polygon fill="black" stroke="black" points="19385.2,-1014.25 19381.7,-1004.25 19378.2,-1014.25 19385.2,-1014.25"/>
</g>
<!-- layer3_agg_exp2 -->
<g id="node182" class="node">
<title>layer3_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="19364.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="19364.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="19364.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="19364.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="19364.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert2&#45;&gt;layer3_agg_exp2 -->
<g id="edge217" class="edge">
<title>layer3_expert2&#45;&gt;layer3_agg_exp2</title>
<path fill="none" stroke="black" d="M19381.7,-941.09C19381.7,-941.09 19381.7,-915.34 19381.7,-915.34"/>
<polygon fill="black" stroke="black" points="19385.2,-915.34 19381.7,-905.34 19378.2,-915.34 19385.2,-915.34"/>
</g>
<!-- layer3_agg_exp2&#45;&gt;layer3_moe_agg -->
<g id="edge218" class="edge">
<title>layer3_agg_exp2&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M19364.7,-831.58C19364.7,-787.92 19364.7,-721 19364.7,-721 19364.7,-721 21474.87,-721 21474.87,-721"/>
<polygon fill="black" stroke="black" points="21474.87,-724.5 21484.87,-721 21474.87,-717.5 21474.87,-724.5"/>
</g>
<!-- layer3_expert3 -->
<g id="node184" class="node">
<title>layer3_expert3</title>
<polygon fill="lightcoral" stroke="black" points="19907.2,-1004.16 19686.2,-1004.16 19686.2,-941.16 19907.2,-941.16 19907.2,-1004.16"/>
<text text-anchor="middle" x="19796.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="19796.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="19796.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="19796.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="19796.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp3&#45;&gt;layer3_expert3 -->
<g id="edge220" class="edge">
<title>layer3_route_exp3&#45;&gt;layer3_expert3</title>
<path fill="none" stroke="black" d="M19796.7,-1040.16C19796.7,-1040.16 19796.7,-1014.25 19796.7,-1014.25"/>
<polygon fill="black" stroke="black" points="19800.2,-1014.25 19796.7,-1004.25 19793.2,-1014.25 19800.2,-1014.25"/>
</g>
<!-- layer3_agg_exp3 -->
<g id="node185" class="node">
<title>layer3_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="19779.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="19779.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="19779.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="19779.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="19779.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert3&#45;&gt;layer3_agg_exp3 -->
<g id="edge221" class="edge">
<title>layer3_expert3&#45;&gt;layer3_agg_exp3</title>
<path fill="none" stroke="black" d="M19796.7,-941.09C19796.7,-941.09 19796.7,-915.34 19796.7,-915.34"/>
<polygon fill="black" stroke="black" points="19800.2,-915.34 19796.7,-905.34 19793.2,-915.34 19800.2,-915.34"/>
</g>
<!-- layer3_agg_exp3&#45;&gt;layer3_moe_agg -->
<g id="edge222" class="edge">
<title>layer3_agg_exp3&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M19779.7,-831.35C19779.7,-789.16 19779.7,-726 19779.7,-726 19779.7,-726 21456.41,-726 21456.41,-726"/>
<polygon fill="black" stroke="black" points="21456.41,-729.5 21466.41,-726 21456.41,-722.5 21456.41,-729.5"/>
</g>
<!-- layer3_expert4 -->
<g id="node187" class="node">
<title>layer3_expert4</title>
<polygon fill="lightcoral" stroke="black" points="20319.2,-1004.16 20098.2,-1004.16 20098.2,-941.16 20319.2,-941.16 20319.2,-1004.16"/>
<text text-anchor="middle" x="20208.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="20208.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="20208.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="20208.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="20208.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp4&#45;&gt;layer3_expert4 -->
<g id="edge224" class="edge">
<title>layer3_route_exp4&#45;&gt;layer3_expert4</title>
<path fill="none" stroke="black" d="M20208.7,-1040.16C20208.7,-1040.16 20208.7,-1014.25 20208.7,-1014.25"/>
<polygon fill="black" stroke="black" points="20212.2,-1014.25 20208.7,-1004.25 20205.2,-1014.25 20212.2,-1014.25"/>
</g>
<!-- layer3_agg_exp4 -->
<g id="node188" class="node">
<title>layer3_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="20194.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="20194.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="20194.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="20194.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="20194.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert4&#45;&gt;layer3_agg_exp4 -->
<g id="edge225" class="edge">
<title>layer3_expert4&#45;&gt;layer3_agg_exp4</title>
<path fill="none" stroke="black" d="M20208.7,-941.09C20208.7,-941.09 20208.7,-915.34 20208.7,-915.34"/>
<polygon fill="black" stroke="black" points="20212.2,-915.34 20208.7,-905.34 20205.2,-915.34 20212.2,-915.34"/>
</g>
<!-- layer3_agg_exp4&#45;&gt;layer3_moe_agg -->
<g id="edge226" class="edge">
<title>layer3_agg_exp4&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M20194.7,-831.57C20194.7,-790.87 20194.7,-731 20194.7,-731 20194.7,-731 21443.88,-731 21443.88,-731"/>
<polygon fill="black" stroke="black" points="21443.88,-734.5 21453.88,-731 21443.88,-727.5 21443.88,-734.5"/>
</g>
<!-- layer3_expert5 -->
<g id="node190" class="node">
<title>layer3_expert5</title>
<polygon fill="lightcoral" stroke="black" points="20730.2,-1004.16 20509.2,-1004.16 20509.2,-941.16 20730.2,-941.16 20730.2,-1004.16"/>
<text text-anchor="middle" x="20619.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="20619.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="20619.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="20619.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="20619.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp5&#45;&gt;layer3_expert5 -->
<g id="edge228" class="edge">
<title>layer3_route_exp5&#45;&gt;layer3_expert5</title>
<path fill="none" stroke="black" d="M20619.7,-1040.16C20619.7,-1040.16 20619.7,-1014.25 20619.7,-1014.25"/>
<polygon fill="black" stroke="black" points="20623.2,-1014.25 20619.7,-1004.25 20616.2,-1014.25 20623.2,-1014.25"/>
</g>
<!-- layer3_agg_exp5 -->
<g id="node191" class="node">
<title>layer3_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="20609.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="20609.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="20609.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="20609.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="20609.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert5&#45;&gt;layer3_agg_exp5 -->
<g id="edge229" class="edge">
<title>layer3_expert5&#45;&gt;layer3_agg_exp5</title>
<path fill="none" stroke="black" d="M20619.7,-941.09C20619.7,-941.09 20619.7,-915.34 20619.7,-915.34"/>
<polygon fill="black" stroke="black" points="20623.2,-915.34 20619.7,-905.34 20616.2,-915.34 20623.2,-915.34"/>
</g>
<!-- layer3_agg_exp5&#45;&gt;layer3_moe_agg -->
<g id="edge230" class="edge">
<title>layer3_agg_exp5&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M20609.7,-831.51C20609.7,-792.34 20609.7,-736 20609.7,-736 20609.7,-736 21435.83,-736 21435.83,-736"/>
<polygon fill="black" stroke="black" points="21435.83,-739.5 21445.83,-736 21435.83,-732.5 21435.83,-739.5"/>
</g>
<!-- layer3_expert6 -->
<g id="node193" class="node">
<title>layer3_expert6</title>
<polygon fill="lightcoral" stroke="black" points="21140.2,-1004.16 20919.2,-1004.16 20919.2,-941.16 21140.2,-941.16 21140.2,-1004.16"/>
<text text-anchor="middle" x="21029.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="21029.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="21029.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21029.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21029.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp6&#45;&gt;layer3_expert6 -->
<g id="edge232" class="edge">
<title>layer3_route_exp6&#45;&gt;layer3_expert6</title>
<path fill="none" stroke="black" d="M21029.7,-1040.16C21029.7,-1040.16 21029.7,-1014.25 21029.7,-1014.25"/>
<polygon fill="black" stroke="black" points="21033.2,-1014.25 21029.7,-1004.25 21026.2,-1014.25 21033.2,-1014.25"/>
</g>
<!-- layer3_agg_exp6 -->
<g id="node194" class="node">
<title>layer3_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="21024.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="21024.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="21024.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="21024.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21024.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert6&#45;&gt;layer3_agg_exp6 -->
<g id="edge233" class="edge">
<title>layer3_expert6&#45;&gt;layer3_agg_exp6</title>
<path fill="none" stroke="black" d="M21029.7,-941.09C21029.7,-941.09 21029.7,-915.34 21029.7,-915.34"/>
<polygon fill="black" stroke="black" points="21033.2,-915.34 21029.7,-905.34 21026.2,-915.34 21033.2,-915.34"/>
</g>
<!-- layer3_agg_exp6&#45;&gt;layer3_moe_agg -->
<g id="edge234" class="edge">
<title>layer3_agg_exp6&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M21215.3,-857.96C21215.3,-827.54 21215.3,-741 21215.3,-741 21215.3,-741 21432.05,-741 21432.05,-741"/>
<polygon fill="black" stroke="black" points="21432.05,-744.5 21442.05,-741 21432.05,-737.5 21432.05,-744.5"/>
</g>
<!-- layer3_expert7 -->
<g id="node196" class="node">
<title>layer3_expert7</title>
<polygon fill="lightcoral" stroke="black" points="21551.2,-1004.16 21330.2,-1004.16 21330.2,-941.16 21551.2,-941.16 21551.2,-1004.16"/>
<text text-anchor="middle" x="21440.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="21440.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="21440.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21440.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21440.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp7&#45;&gt;layer3_expert7 -->
<g id="edge236" class="edge">
<title>layer3_route_exp7&#45;&gt;layer3_expert7</title>
<path fill="none" stroke="black" d="M21440.7,-1039.87C21440.7,-1039.87 21440.7,-1014.41 21440.7,-1014.41"/>
<polygon fill="black" stroke="black" points="21444.2,-1014.41 21440.7,-1004.41 21437.2,-1014.41 21444.2,-1014.41"/>
</g>
<!-- layer3_agg_exp7 -->
<g id="node197" class="node">
<title>layer3_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="21439.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="21439.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="21439.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="21439.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21439.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert7&#45;&gt;layer3_agg_exp7 -->
<g id="edge237" class="edge">
<title>layer3_expert7&#45;&gt;layer3_agg_exp7</title>
<path fill="none" stroke="black" d="M21440.7,-941.09C21440.7,-941.09 21440.7,-915.34 21440.7,-915.34"/>
<polygon fill="black" stroke="black" points="21444.2,-915.34 21440.7,-905.34 21437.2,-915.34 21444.2,-915.34"/>
</g>
<!-- layer3_agg_exp7&#45;&gt;layer3_moe_agg -->
<g id="edge238" class="edge">
<title>layer3_agg_exp7&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M21540.02,-836.58C21540.02,-836.58 21540.02,-785.37 21540.02,-785.37"/>
<polygon fill="black" stroke="black" points="21543.52,-785.37 21540.02,-775.37 21536.52,-785.37 21543.52,-785.37"/>
</g>
<!-- layer3_expert8 -->
<g id="node199" class="node">
<title>layer3_expert8</title>
<polygon fill="lightcoral" stroke="black" points="21964.2,-1004.16 21743.2,-1004.16 21743.2,-941.16 21964.2,-941.16 21964.2,-1004.16"/>
<text text-anchor="middle" x="21853.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="21853.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="21853.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21853.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21853.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp8&#45;&gt;layer3_expert8 -->
<g id="edge240" class="edge">
<title>layer3_route_exp8&#45;&gt;layer3_expert8</title>
<path fill="none" stroke="black" d="M21853.7,-1039.87C21853.7,-1039.87 21853.7,-1014.41 21853.7,-1014.41"/>
<polygon fill="black" stroke="black" points="21857.2,-1014.41 21853.7,-1004.41 21850.2,-1014.41 21857.2,-1014.41"/>
</g>
<!-- layer3_agg_exp8 -->
<g id="node200" class="node">
<title>layer3_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="21854.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="21854.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="21854.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="21854.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21854.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert8&#45;&gt;layer3_agg_exp8 -->
<g id="edge241" class="edge">
<title>layer3_expert8&#45;&gt;layer3_agg_exp8</title>
<path fill="none" stroke="black" d="M21853.7,-941.09C21853.7,-941.09 21853.7,-915.34 21853.7,-915.34"/>
<polygon fill="black" stroke="black" points="21857.2,-915.34 21853.7,-905.34 21850.2,-915.34 21857.2,-915.34"/>
</g>
<!-- layer3_agg_exp8&#45;&gt;layer3_moe_agg -->
<g id="edge242" class="edge">
<title>layer3_agg_exp8&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M21753.88,-836.58C21753.88,-836.58 21753.88,-785.37 21753.88,-785.37"/>
<polygon fill="black" stroke="black" points="21757.38,-785.37 21753.88,-775.37 21750.38,-785.37 21757.38,-785.37"/>
</g>
<!-- layer3_expert9 -->
<g id="node202" class="node">
<title>layer3_expert9</title>
<polygon fill="lightcoral" stroke="black" points="22373.2,-1004.16 22152.2,-1004.16 22152.2,-941.16 22373.2,-941.16 22373.2,-1004.16"/>
<text text-anchor="middle" x="22262.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="22262.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="22262.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="22262.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="22262.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp9&#45;&gt;layer3_expert9 -->
<g id="edge244" class="edge">
<title>layer3_route_exp9&#45;&gt;layer3_expert9</title>
<path fill="none" stroke="black" d="M22262.7,-1039.87C22262.7,-1039.87 22262.7,-1014.41 22262.7,-1014.41"/>
<polygon fill="black" stroke="black" points="22266.2,-1014.41 22262.7,-1004.41 22259.2,-1014.41 22266.2,-1014.41"/>
</g>
<!-- layer3_agg_exp9 -->
<g id="node203" class="node">
<title>layer3_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="22269.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="22269.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="22269.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="22269.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="22269.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert9&#45;&gt;layer3_agg_exp9 -->
<g id="edge245" class="edge">
<title>layer3_expert9&#45;&gt;layer3_agg_exp9</title>
<path fill="none" stroke="black" d="M22262.7,-941.09C22262.7,-941.09 22262.7,-915.34 22262.7,-915.34"/>
<polygon fill="black" stroke="black" points="22266.2,-915.34 22262.7,-905.34 22259.2,-915.34 22266.2,-915.34"/>
</g>
<!-- layer3_agg_exp9&#45;&gt;layer3_moe_agg -->
<g id="edge246" class="edge">
<title>layer3_agg_exp9&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M22269.7,-831.48C22269.7,-805.37 22269.7,-775 22269.7,-775 22269.7,-775 21763.79,-775 21763.79,-775"/>
<polygon fill="black" stroke="black" points="21763.79,-771.5 21753.79,-775 21763.79,-778.5 21763.79,-771.5"/>
</g>
<!-- layer3_expert10 -->
<g id="node205" class="node">
<title>layer3_expert10</title>
<polygon fill="lightcoral" stroke="black" points="22790.2,-1004.16 22569.2,-1004.16 22569.2,-941.16 22790.2,-941.16 22790.2,-1004.16"/>
<text text-anchor="middle" x="22679.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="22679.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="22679.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="22679.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="22679.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp10&#45;&gt;layer3_expert10 -->
<g id="edge248" class="edge">
<title>layer3_route_exp10&#45;&gt;layer3_expert10</title>
<path fill="none" stroke="black" d="M22679.7,-1040.16C22679.7,-1040.16 22679.7,-1014.25 22679.7,-1014.25"/>
<polygon fill="black" stroke="black" points="22683.2,-1014.25 22679.7,-1004.25 22676.2,-1014.25 22683.2,-1014.25"/>
</g>
<!-- layer3_agg_exp10 -->
<g id="node206" class="node">
<title>layer3_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="22684.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="22684.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="22684.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="22684.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="22684.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert10&#45;&gt;layer3_agg_exp10 -->
<g id="edge249" class="edge">
<title>layer3_expert10&#45;&gt;layer3_agg_exp10</title>
<path fill="none" stroke="black" d="M22679.7,-941.09C22679.7,-941.09 22679.7,-915.34 22679.7,-915.34"/>
<polygon fill="black" stroke="black" points="22683.2,-915.34 22679.7,-905.34 22676.2,-915.34 22683.2,-915.34"/>
</g>
<!-- layer3_agg_exp10&#45;&gt;layer3_moe_agg -->
<g id="edge250" class="edge">
<title>layer3_agg_exp10&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M22684.7,-831.47C22684.7,-803.55 22684.7,-770 22684.7,-770 22684.7,-770 21799.66,-770 21799.66,-770"/>
<polygon fill="black" stroke="black" points="21799.66,-766.5 21789.66,-770 21799.66,-773.5 21799.66,-766.5"/>
</g>
<!-- layer3_expert11 -->
<g id="node208" class="node">
<title>layer3_expert11</title>
<polygon fill="lightcoral" stroke="black" points="23203.2,-1004.16 22982.2,-1004.16 22982.2,-941.16 23203.2,-941.16 23203.2,-1004.16"/>
<text text-anchor="middle" x="23092.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="23092.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="23092.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23092.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23092.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp11&#45;&gt;layer3_expert11 -->
<g id="edge252" class="edge">
<title>layer3_route_exp11&#45;&gt;layer3_expert11</title>
<path fill="none" stroke="black" d="M23092.7,-1040.16C23092.7,-1040.16 23092.7,-1014.25 23092.7,-1014.25"/>
<polygon fill="black" stroke="black" points="23096.2,-1014.25 23092.7,-1004.25 23089.2,-1014.25 23096.2,-1014.25"/>
</g>
<!-- layer3_agg_exp11 -->
<g id="node209" class="node">
<title>layer3_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="23099.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="23099.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="23099.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="23099.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23099.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert11&#45;&gt;layer3_agg_exp11 -->
<g id="edge253" class="edge">
<title>layer3_expert11&#45;&gt;layer3_agg_exp11</title>
<path fill="none" stroke="black" d="M23092.7,-941.09C23092.7,-941.09 23092.7,-915.34 23092.7,-915.34"/>
<polygon fill="black" stroke="black" points="23096.2,-915.34 23092.7,-905.34 23089.2,-915.34 23096.2,-915.34"/>
</g>
<!-- layer3_agg_exp11&#45;&gt;layer3_moe_agg -->
<g id="edge254" class="edge">
<title>layer3_agg_exp11&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M23099.7,-831.35C23099.7,-801.69 23099.7,-765 23099.7,-765 23099.7,-765 21823.73,-765 21823.73,-765"/>
<polygon fill="black" stroke="black" points="21823.73,-761.5 21813.73,-765 21823.73,-768.5 21823.73,-761.5"/>
</g>
<!-- layer3_expert12 -->
<g id="node211" class="node">
<title>layer3_expert12</title>
<polygon fill="lightcoral" stroke="black" points="23616.2,-1004.16 23395.2,-1004.16 23395.2,-941.16 23616.2,-941.16 23616.2,-1004.16"/>
<text text-anchor="middle" x="23505.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="23505.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="23505.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23505.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23505.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp12&#45;&gt;layer3_expert12 -->
<g id="edge256" class="edge">
<title>layer3_route_exp12&#45;&gt;layer3_expert12</title>
<path fill="none" stroke="black" d="M23505.7,-1040.16C23505.7,-1040.16 23505.7,-1014.25 23505.7,-1014.25"/>
<polygon fill="black" stroke="black" points="23509.2,-1014.25 23505.7,-1004.25 23502.2,-1014.25 23509.2,-1014.25"/>
</g>
<!-- layer3_agg_exp12 -->
<g id="node212" class="node">
<title>layer3_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="23514.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="23514.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="23514.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="23514.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23514.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert12&#45;&gt;layer3_agg_exp12 -->
<g id="edge257" class="edge">
<title>layer3_expert12&#45;&gt;layer3_agg_exp12</title>
<path fill="none" stroke="black" d="M23505.7,-941.09C23505.7,-941.09 23505.7,-915.34 23505.7,-915.34"/>
<polygon fill="black" stroke="black" points="23509.2,-915.34 23505.7,-905.34 23502.2,-915.34 23509.2,-915.34"/>
</g>
<!-- layer3_agg_exp12&#45;&gt;layer3_moe_agg -->
<g id="edge258" class="edge">
<title>layer3_agg_exp12&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M23514.7,-831.39C23514.7,-799.99 23514.7,-760 23514.7,-760 23514.7,-760 21840.49,-760 21840.49,-760"/>
<polygon fill="black" stroke="black" points="21840.49,-756.5 21830.49,-760 21840.49,-763.5 21840.49,-756.5"/>
</g>
<!-- layer3_expert13 -->
<g id="node214" class="node">
<title>layer3_expert13</title>
<polygon fill="lightcoral" stroke="black" points="24031.2,-1004.16 23810.2,-1004.16 23810.2,-941.16 24031.2,-941.16 24031.2,-1004.16"/>
<text text-anchor="middle" x="23920.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="23920.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="23920.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23920.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23920.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp13&#45;&gt;layer3_expert13 -->
<g id="edge260" class="edge">
<title>layer3_route_exp13&#45;&gt;layer3_expert13</title>
<path fill="none" stroke="black" d="M23920.7,-1040.16C23920.7,-1040.16 23920.7,-1014.25 23920.7,-1014.25"/>
<polygon fill="black" stroke="black" points="23924.2,-1014.25 23920.7,-1004.25 23917.2,-1014.25 23924.2,-1014.25"/>
</g>
<!-- layer3_agg_exp13 -->
<g id="node215" class="node">
<title>layer3_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="23929.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="23929.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="23929.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="23929.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23929.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert13&#45;&gt;layer3_agg_exp13 -->
<g id="edge261" class="edge">
<title>layer3_expert13&#45;&gt;layer3_agg_exp13</title>
<path fill="none" stroke="black" d="M23920.7,-941.09C23920.7,-941.09 23920.7,-915.34 23920.7,-915.34"/>
<polygon fill="black" stroke="black" points="23924.2,-915.34 23920.7,-905.34 23917.2,-915.34 23924.2,-915.34"/>
</g>
<!-- layer3_agg_exp13&#45;&gt;layer3_moe_agg -->
<g id="edge262" class="edge">
<title>layer3_agg_exp13&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M23929.7,-831.57C23929.7,-798.47 23929.7,-755 23929.7,-755 23929.7,-755 21851.84,-755 21851.84,-755"/>
<polygon fill="black" stroke="black" points="21851.84,-751.5 21841.84,-755 21851.84,-758.5 21851.84,-751.5"/>
</g>
<!-- layer3_expert14 -->
<g id="node217" class="node">
<title>layer3_expert14</title>
<polygon fill="lightcoral" stroke="black" points="24445.2,-1004.16 24224.2,-1004.16 24224.2,-941.16 24445.2,-941.16 24445.2,-1004.16"/>
<text text-anchor="middle" x="24334.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="24334.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="24334.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="24334.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="24334.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp14&#45;&gt;layer3_expert14 -->
<g id="edge264" class="edge">
<title>layer3_route_exp14&#45;&gt;layer3_expert14</title>
<path fill="none" stroke="black" d="M24334.7,-1040.16C24334.7,-1040.16 24334.7,-1014.25 24334.7,-1014.25"/>
<polygon fill="black" stroke="black" points="24338.2,-1014.25 24334.7,-1004.25 24331.2,-1014.25 24338.2,-1014.25"/>
</g>
<!-- layer3_agg_exp14 -->
<g id="node218" class="node">
<title>layer3_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="24344.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="24344.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="24344.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="24344.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="24344.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert14&#45;&gt;layer3_agg_exp14 -->
<g id="edge265" class="edge">
<title>layer3_expert14&#45;&gt;layer3_agg_exp14</title>
<path fill="none" stroke="black" d="M24334.7,-941.09C24334.7,-941.09 24334.7,-915.34 24334.7,-915.34"/>
<polygon fill="black" stroke="black" points="24338.2,-915.34 24334.7,-905.34 24331.2,-915.34 24338.2,-915.34"/>
</g>
<!-- layer3_agg_exp14&#45;&gt;layer3_moe_agg -->
<g id="edge266" class="edge">
<title>layer3_agg_exp14&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M24344.7,-831.58C24344.7,-796.82 24344.7,-750 24344.7,-750 24344.7,-750 21858.66,-750 21858.66,-750"/>
<polygon fill="black" stroke="black" points="21858.66,-746.5 21848.66,-750 21858.66,-753.5 21858.66,-746.5"/>
</g>
<!-- layer3_expert15 -->
<g id="node220" class="node">
<title>layer3_expert15</title>
<polygon fill="lightcoral" stroke="black" points="24860.2,-1004.16 24639.2,-1004.16 24639.2,-941.16 24860.2,-941.16 24860.2,-1004.16"/>
<text text-anchor="middle" x="24749.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="24749.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="24749.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="24749.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="24749.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer3_route_exp15&#45;&gt;layer3_expert15 -->
<g id="edge268" class="edge">
<title>layer3_route_exp15&#45;&gt;layer3_expert15</title>
<path fill="none" stroke="black" d="M24749.7,-1040.16C24749.7,-1040.16 24749.7,-1014.25 24749.7,-1014.25"/>
<polygon fill="black" stroke="black" points="24753.2,-1014.25 24749.7,-1004.25 24746.2,-1014.25 24753.2,-1014.25"/>
</g>
<!-- layer3_agg_exp15 -->
<g id="node221" class="node">
<title>layer3_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="24759.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="24759.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="24759.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="24759.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="24759.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer3_expert15&#45;&gt;layer3_agg_exp15 -->
<g id="edge269" class="edge">
<title>layer3_expert15&#45;&gt;layer3_agg_exp15</title>
<path fill="none" stroke="black" d="M24749.7,-941.09C24749.7,-941.09 24749.7,-915.34 24749.7,-915.34"/>
<polygon fill="black" stroke="black" points="24753.2,-915.34 24749.7,-905.34 24746.2,-915.34 24753.2,-915.34"/>
</g>
<!-- layer3_agg_exp15&#45;&gt;layer3_moe_agg -->
<g id="edge270" class="edge">
<title>layer3_agg_exp15&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M24759.7,-831.33C24759.7,-795.31 24759.7,-746 24759.7,-746 24759.7,-746 21861.55,-746 21861.55,-746"/>
<polygon fill="black" stroke="black" points="21861.55,-742.5 21851.55,-746 21861.55,-749.5 21861.55,-742.5"/>
</g>
<!-- layer4_ln1 -->
<g id="node223" class="node">
<title>layer4_ln1</title>
<polygon fill="none" stroke="black" points="25107.2,-1227.7 24826.2,-1227.7 24826.2,-1175.7 25107.2,-1175.7 25107.2,-1227.7"/>
<text text-anchor="middle" x="24966.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 4</text>
<text text-anchor="middle" x="24966.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="24966.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="24966.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer4_add1 -->
<g id="node224" class="node">
<title>layer4_add1</title>
<polygon fill="yellow" stroke="black" points="28128.2,-644.85 27847.2,-644.85 27847.2,-592.85 28128.2,-592.85 28128.2,-644.85"/>
<text text-anchor="middle" x="27987.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 4</text>
<text text-anchor="middle" x="27987.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="27987.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="27987.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_moe_output -->
<g id="node228" class="node">
<title>layer4_moe_output</title>
<polygon fill="yellow" stroke="black" points="28277.2,-540.58 27996.2,-540.58 27996.2,-488.58 28277.2,-488.58 28277.2,-540.58"/>
<text text-anchor="middle" x="28136.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 4</text>
<text text-anchor="middle" x="28136.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28136.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28136.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_add1&#45;&gt;layer4_moe_output -->
<g id="edge340" class="edge">
<title>layer4_add1&#45;&gt;layer4_moe_output</title>
<path fill="none" stroke="black" d="M28062.2,-592.81C28062.2,-592.81 28062.2,-550.65 28062.2,-550.65"/>
<polygon fill="black" stroke="black" points="28065.7,-550.65 28062.2,-540.65 28058.7,-550.65 28065.7,-550.65"/>
</g>
<!-- layer4_gate -->
<g id="node225" class="node">
<title>layer4_gate</title>
<polygon fill="lightgreen" stroke="black" points="28580.13,-1253.7 28121.3,-1253.7 28003.26,-1149.7 28462.1,-1149.7 28580.13,-1253.7"/>
<text text-anchor="middle" x="28291.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 4</text>
<text text-anchor="middle" x="28291.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28291.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="28291.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer4_route_exp0 -->
<g id="node229" class="node">
<title>layer4_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="25214.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="25214.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="25214.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="25214.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="25214.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp0 -->
<g id="edge274" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp0</title>
<path fill="none" stroke="black" d="M28028.43,-1172C27290.86,-1172 25257.82,-1172 25257.82,-1172 25257.82,-1172 25257.82,-1122.87 25257.82,-1122.87"/>
<polygon fill="black" stroke="black" points="25261.32,-1122.87 25257.82,-1112.87 25254.32,-1122.87 25261.32,-1122.87"/>
</g>
<!-- layer4_route_exp1 -->
<g id="node232" class="node">
<title>layer4_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="25620.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="25620.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="25620.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="25620.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="25620.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp1 -->
<g id="edge278" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp1</title>
<path fill="none" stroke="black" d="M28023.98,-1168C27347.08,-1168 25620.7,-1168 25620.7,-1168 25620.7,-1168 25620.7,-1123.71 25620.7,-1123.71"/>
<polygon fill="black" stroke="black" points="25624.2,-1123.71 25620.7,-1113.71 25617.2,-1123.71 25624.2,-1123.71"/>
</g>
<!-- layer4_route_exp2 -->
<g id="node235" class="node">
<title>layer4_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="26045.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="26045.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="26045.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="26045.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="26045.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp2 -->
<g id="edge282" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp2</title>
<path fill="none" stroke="black" d="M28020.5,-1165C27422.98,-1165 26045.7,-1165 26045.7,-1165 26045.7,-1165 26045.7,-1123.77 26045.7,-1123.77"/>
<polygon fill="black" stroke="black" points="26049.2,-1123.77 26045.7,-1113.77 26042.2,-1123.77 26049.2,-1123.77"/>
</g>
<!-- layer4_route_exp3 -->
<g id="node238" class="node">
<title>layer4_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="26460.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="26460.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="26460.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="26460.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="26460.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp3 -->
<g id="edge286" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp3</title>
<path fill="none" stroke="black" d="M28016.09,-1161C27504.76,-1161 26460.7,-1161 26460.7,-1161 26460.7,-1161 26460.7,-1124.05 26460.7,-1124.05"/>
<polygon fill="black" stroke="black" points="26464.2,-1124.05 26460.7,-1114.05 26457.2,-1124.05 26464.2,-1124.05"/>
</g>
<!-- layer4_route_exp4 -->
<g id="node241" class="node">
<title>layer4_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="26870.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="26870.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="26870.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="26870.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="26870.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp4 -->
<g id="edge290" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp4</title>
<path fill="none" stroke="black" d="M28012.65,-1158C27598.82,-1158 26870.7,-1158 26870.7,-1158 26870.7,-1158 26870.7,-1124.14 26870.7,-1124.14"/>
<polygon fill="black" stroke="black" points="26874.2,-1124.14 26870.7,-1114.14 26867.2,-1124.14 26874.2,-1124.14"/>
</g>
<!-- layer4_route_exp5 -->
<g id="node244" class="node">
<title>layer4_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="27275.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="27275.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="27275.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="27275.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="27275.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp5 -->
<g id="edge294" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp5</title>
<path fill="none" stroke="black" d="M28008.01,-1154C27707.41,-1154 27275.7,-1154 27275.7,-1154 27275.7,-1154 27275.7,-1124.11 27275.7,-1124.11"/>
<polygon fill="black" stroke="black" points="27279.2,-1124.11 27275.7,-1114.11 27272.2,-1124.11 27279.2,-1124.11"/>
</g>
<!-- layer4_route_exp6 -->
<g id="node247" class="node">
<title>layer4_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="27682.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="27682.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="27682.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="27682.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="27682.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp6 -->
<g id="edge298" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp6</title>
<path fill="none" stroke="black" d="M28004.58,-1151C27846.77,-1151 27682.7,-1151 27682.7,-1151 27682.7,-1151 27682.7,-1123.96 27682.7,-1123.96"/>
<polygon fill="black" stroke="black" points="27686.2,-1123.96 27682.7,-1113.96 27679.2,-1123.96 27686.2,-1123.96"/>
</g>
<!-- layer4_route_exp7 -->
<g id="node250" class="node">
<title>layer4_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="28088.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="28088.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="28088.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="28088.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28088.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp7 -->
<g id="edge302" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp7</title>
<path fill="none" stroke="black" d="M28142.96,-1149.5C28142.96,-1149.5 28142.96,-1122.25 28142.96,-1122.25"/>
<polygon fill="black" stroke="black" points="28146.46,-1122.25 28142.96,-1112.25 28139.46,-1122.25 28146.46,-1122.25"/>
</g>
<!-- layer4_route_exp8 -->
<g id="node253" class="node">
<title>layer4_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="28494.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="28494.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="28494.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="28494.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28494.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp8 -->
<g id="edge306" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp8</title>
<path fill="none" stroke="black" d="M28440.43,-1149.5C28440.43,-1149.5 28440.43,-1122.25 28440.43,-1122.25"/>
<polygon fill="black" stroke="black" points="28443.93,-1122.25 28440.43,-1112.25 28436.93,-1122.25 28443.93,-1122.25"/>
</g>
<!-- layer4_route_exp9 -->
<g id="node256" class="node">
<title>layer4_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="28902.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="28902.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="28902.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="28902.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28902.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp9 -->
<g id="edge310" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp9</title>
<path fill="none" stroke="black" d="M28463.93,-1151C28644.63,-1151 28902.7,-1151 28902.7,-1151 28902.7,-1151 28902.7,-1123.96 28902.7,-1123.96"/>
<polygon fill="black" stroke="black" points="28906.2,-1123.96 28902.7,-1113.96 28899.2,-1123.96 28906.2,-1123.96"/>
</g>
<!-- layer4_route_exp10 -->
<g id="node259" class="node">
<title>layer4_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="29312.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="29312.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="29312.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="29312.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="29312.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp10 -->
<g id="edge314" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp10</title>
<path fill="none" stroke="black" d="M28469.54,-1156C28762.06,-1156 29312.7,-1156 29312.7,-1156 29312.7,-1156 29312.7,-1124.15 29312.7,-1124.15"/>
<polygon fill="black" stroke="black" points="29316.2,-1124.15 29312.7,-1114.15 29309.2,-1124.15 29316.2,-1124.15"/>
</g>
<!-- layer4_route_exp11 -->
<g id="node262" class="node">
<title>layer4_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="29724.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="29724.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="29724.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="29724.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="29724.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp11 -->
<g id="edge318" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp11</title>
<path fill="none" stroke="black" d="M28473.91,-1160C28859.88,-1160 29724.7,-1160 29724.7,-1160 29724.7,-1160 29724.7,-1124.09 29724.7,-1124.09"/>
<polygon fill="black" stroke="black" points="29728.2,-1124.09 29724.7,-1114.09 29721.2,-1124.09 29728.2,-1124.09"/>
</g>
<!-- layer4_route_exp12 -->
<g id="node265" class="node">
<title>layer4_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="30139.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="30139.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="30139.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="30139.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="30139.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp12 -->
<g id="edge322" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp12</title>
<path fill="none" stroke="black" d="M28477.35,-1163C28945.98,-1163 30139.7,-1163 30139.7,-1163 30139.7,-1163 30139.7,-1123.93 30139.7,-1123.93"/>
<polygon fill="black" stroke="black" points="30143.2,-1123.93 30139.7,-1113.93 30136.2,-1123.93 30143.2,-1123.93"/>
</g>
<!-- layer4_route_exp13 -->
<g id="node268" class="node">
<title>layer4_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="30553.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="30553.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="30553.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="30553.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="30553.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp13 -->
<g id="edge326" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp13</title>
<path fill="none" stroke="black" d="M28482.12,-1167C29027.04,-1167 30553.7,-1167 30553.7,-1167 30553.7,-1167 30553.7,-1123.82 30553.7,-1123.82"/>
<polygon fill="black" stroke="black" points="30557.2,-1123.82 30553.7,-1113.82 30550.2,-1123.82 30557.2,-1123.82"/>
</g>
<!-- layer4_route_exp14 -->
<g id="node271" class="node">
<title>layer4_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="30967.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="30967.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="30967.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="30967.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="30967.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp14 -->
<g id="edge330" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp14</title>
<path fill="none" stroke="black" d="M28485.22,-1170C29099.91,-1170 30967.7,-1170 30967.7,-1170 30967.7,-1170 30967.7,-1123.71 30967.7,-1123.71"/>
<polygon fill="black" stroke="black" points="30971.2,-1123.71 30967.7,-1113.71 30964.2,-1123.71 30971.2,-1123.71"/>
</g>
<!-- layer4_route_exp15 -->
<g id="node274" class="node">
<title>layer4_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="31381.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="31381.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="31381.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="31381.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="31381.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_route_exp15 -->
<g id="edge334" class="edge">
<title>layer4_gate&#45;&gt;layer4_route_exp15</title>
<path fill="none" stroke="black" d="M28487.64,-1172C29159.26,-1172 31327.07,-1172 31327.07,-1172 31327.07,-1172 31327.07,-1122.33 31327.07,-1122.33"/>
<polygon fill="black" stroke="black" points="31330.57,-1122.33 31327.07,-1112.33 31323.57,-1122.33 31330.57,-1122.33"/>
</g>
<!-- layer4_moe_agg -->
<g id="node226" class="node">
<title>layer4_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="28286.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="28286.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 4</text>
<text text-anchor="middle" x="28286.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28286.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28286.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer4_ln2 -->
<g id="node227" class="node">
<title>layer4_ln2</title>
<polygon fill="none" stroke="black" points="28427.2,-644.85 28146.2,-644.85 28146.2,-592.85 28427.2,-592.85 28427.2,-644.85"/>
<text text-anchor="middle" x="28286.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 4</text>
<text text-anchor="middle" x="28286.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28286.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28286.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer4_moe_agg&#45;&gt;layer4_ln2 -->
<g id="edge338" class="edge">
<title>layer4_moe_agg&#45;&gt;layer4_ln2</title>
<path fill="none" stroke="black" d="M28286.7,-706.52C28286.7,-706.52 28286.7,-654.92 28286.7,-654.92"/>
<polygon fill="black" stroke="black" points="28290.2,-654.92 28286.7,-644.92 28283.2,-654.92 28290.2,-654.92"/>
</g>
<!-- layer4_ln2&#45;&gt;layer4_moe_output -->
<g id="edge339" class="edge">
<title>layer4_ln2&#45;&gt;layer4_moe_output</title>
<path fill="none" stroke="black" d="M28211.7,-592.81C28211.7,-592.81 28211.7,-550.65 28211.7,-550.65"/>
<polygon fill="black" stroke="black" points="28215.2,-550.65 28211.7,-540.65 28208.2,-550.65 28215.2,-550.65"/>
</g>
<!-- layer5_mha -->
<g id="node277" class="node">
<title>layer5_mha</title>
<polygon fill="lightcyan" stroke="black" points="28277.2,-436.31 27996.2,-436.31 27996.2,-384.31 28277.2,-384.31 28277.2,-436.31"/>
<text text-anchor="middle" x="28136.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 5</text>
<text text-anchor="middle" x="28136.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28136.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28136.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer4_moe_output&#45;&gt;layer5_mha -->
<g id="edge1082" class="edge">
<title>layer4_moe_output&#45;&gt;layer5_mha</title>
<path fill="none" stroke="black" d="M28136.7,-488.54C28136.7,-488.54 28136.7,-446.38 28136.7,-446.38"/>
<polygon fill="black" stroke="black" points="28140.2,-446.38 28136.7,-436.38 28133.2,-446.38 28140.2,-446.38"/>
</g>
<!-- layer4_expert0 -->
<g id="node230" class="node">
<title>layer4_expert0</title>
<polygon fill="lightcoral" stroke="black" points="25285.2,-1004.16 25064.2,-1004.16 25064.2,-941.16 25285.2,-941.16 25285.2,-1004.16"/>
<text text-anchor="middle" x="25174.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="25174.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="25174.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="25174.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="25174.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp0&#45;&gt;layer4_expert0 -->
<g id="edge275" class="edge">
<title>layer4_route_exp0&#45;&gt;layer4_expert0</title>
<path fill="none" stroke="black" d="M25174.7,-1040.75C25174.7,-1040.75 25174.7,-1014.25 25174.7,-1014.25"/>
<polygon fill="black" stroke="black" points="25178.2,-1014.25 25174.7,-1004.25 25171.2,-1014.25 25178.2,-1014.25"/>
</g>
<!-- layer4_agg_exp0 -->
<g id="node231" class="node">
<title>layer4_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="25174.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="25174.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="25174.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="25174.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="25174.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert0&#45;&gt;layer4_agg_exp0 -->
<g id="edge276" class="edge">
<title>layer4_expert0&#45;&gt;layer4_agg_exp0</title>
<path fill="none" stroke="black" d="M25174.7,-941.09C25174.7,-941.09 25174.7,-915.34 25174.7,-915.34"/>
<polygon fill="black" stroke="black" points="25178.2,-915.34 25174.7,-905.34 25171.2,-915.34 25178.2,-915.34"/>
</g>
<!-- layer4_agg_exp0&#45;&gt;layer4_moe_agg -->
<g id="edge277" class="edge">
<title>layer4_agg_exp0&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M25174.7,-831.49C25174.7,-784.97 25174.7,-711 25174.7,-711 25174.7,-711 28181.86,-711 28181.86,-711"/>
<polygon fill="black" stroke="black" points="28181.86,-714.5 28191.86,-711 28181.86,-707.5 28181.86,-714.5"/>
</g>
<!-- layer4_expert1 -->
<g id="node233" class="node">
<title>layer4_expert1</title>
<polygon fill="lightcoral" stroke="black" points="25715.2,-1004.16 25494.2,-1004.16 25494.2,-941.16 25715.2,-941.16 25715.2,-1004.16"/>
<text text-anchor="middle" x="25604.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="25604.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="25604.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="25604.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="25604.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp1&#45;&gt;layer4_expert1 -->
<g id="edge279" class="edge">
<title>layer4_route_exp1&#45;&gt;layer4_expert1</title>
<path fill="none" stroke="black" d="M25604.7,-1040.16C25604.7,-1040.16 25604.7,-1014.25 25604.7,-1014.25"/>
<polygon fill="black" stroke="black" points="25608.2,-1014.25 25604.7,-1004.25 25601.2,-1014.25 25608.2,-1014.25"/>
</g>
<!-- layer4_agg_exp1 -->
<g id="node234" class="node">
<title>layer4_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="25589.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="25589.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="25589.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="25589.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="25589.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert1&#45;&gt;layer4_agg_exp1 -->
<g id="edge280" class="edge">
<title>layer4_expert1&#45;&gt;layer4_agg_exp1</title>
<path fill="none" stroke="black" d="M25604.7,-941.09C25604.7,-941.09 25604.7,-915.34 25604.7,-915.34"/>
<polygon fill="black" stroke="black" points="25608.2,-915.34 25604.7,-905.34 25601.2,-915.34 25608.2,-915.34"/>
</g>
<!-- layer4_agg_exp1&#45;&gt;layer4_moe_agg -->
<g id="edge281" class="edge">
<title>layer4_agg_exp1&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M25589.7,-831.5C25589.7,-786.4 25589.7,-716 25589.7,-716 25589.7,-716 28141.1,-716 28141.1,-716"/>
<polygon fill="black" stroke="black" points="28141.1,-719.5 28151.1,-716 28141.1,-712.5 28141.1,-719.5"/>
</g>
<!-- layer4_expert2 -->
<g id="node236" class="node">
<title>layer4_expert2</title>
<polygon fill="lightcoral" stroke="black" points="26135.2,-1004.16 25914.2,-1004.16 25914.2,-941.16 26135.2,-941.16 26135.2,-1004.16"/>
<text text-anchor="middle" x="26024.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="26024.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="26024.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26024.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26024.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp2&#45;&gt;layer4_expert2 -->
<g id="edge283" class="edge">
<title>layer4_route_exp2&#45;&gt;layer4_expert2</title>
<path fill="none" stroke="black" d="M26024.7,-1040.16C26024.7,-1040.16 26024.7,-1014.25 26024.7,-1014.25"/>
<polygon fill="black" stroke="black" points="26028.2,-1014.25 26024.7,-1004.25 26021.2,-1014.25 26028.2,-1014.25"/>
</g>
<!-- layer4_agg_exp2 -->
<g id="node237" class="node">
<title>layer4_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="26004.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="26004.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="26004.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="26004.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26004.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert2&#45;&gt;layer4_agg_exp2 -->
<g id="edge284" class="edge">
<title>layer4_expert2&#45;&gt;layer4_agg_exp2</title>
<path fill="none" stroke="black" d="M26024.7,-941.09C26024.7,-941.09 26024.7,-914.97 26024.7,-914.97"/>
<polygon fill="black" stroke="black" points="26028.2,-914.97 26024.7,-904.97 26021.2,-914.97 26028.2,-914.97"/>
</g>
<!-- layer4_agg_exp2&#45;&gt;layer4_moe_agg -->
<g id="edge285" class="edge">
<title>layer4_agg_exp2&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M26004.7,-831.58C26004.7,-787.92 26004.7,-721 26004.7,-721 26004.7,-721 28114.87,-721 28114.87,-721"/>
<polygon fill="black" stroke="black" points="28114.87,-724.5 28124.87,-721 28114.87,-717.5 28114.87,-724.5"/>
</g>
<!-- layer4_expert3 -->
<g id="node239" class="node">
<title>layer4_expert3</title>
<polygon fill="lightcoral" stroke="black" points="26550.2,-1004.16 26329.2,-1004.16 26329.2,-941.16 26550.2,-941.16 26550.2,-1004.16"/>
<text text-anchor="middle" x="26439.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="26439.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="26439.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26439.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26439.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp3&#45;&gt;layer4_expert3 -->
<g id="edge287" class="edge">
<title>layer4_route_exp3&#45;&gt;layer4_expert3</title>
<path fill="none" stroke="black" d="M26439.7,-1040.16C26439.7,-1040.16 26439.7,-1014.25 26439.7,-1014.25"/>
<polygon fill="black" stroke="black" points="26443.2,-1014.25 26439.7,-1004.25 26436.2,-1014.25 26443.2,-1014.25"/>
</g>
<!-- layer4_agg_exp3 -->
<g id="node240" class="node">
<title>layer4_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="26419.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="26419.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="26419.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="26419.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26419.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert3&#45;&gt;layer4_agg_exp3 -->
<g id="edge288" class="edge">
<title>layer4_expert3&#45;&gt;layer4_agg_exp3</title>
<path fill="none" stroke="black" d="M26439.7,-941.09C26439.7,-941.09 26439.7,-914.97 26439.7,-914.97"/>
<polygon fill="black" stroke="black" points="26443.2,-914.97 26439.7,-904.97 26436.2,-914.97 26443.2,-914.97"/>
</g>
<!-- layer4_agg_exp3&#45;&gt;layer4_moe_agg -->
<g id="edge289" class="edge">
<title>layer4_agg_exp3&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M26419.7,-831.35C26419.7,-789.16 26419.7,-726 26419.7,-726 26419.7,-726 28096.41,-726 28096.41,-726"/>
<polygon fill="black" stroke="black" points="28096.41,-729.5 28106.41,-726 28096.41,-722.5 28096.41,-729.5"/>
</g>
<!-- layer4_expert4 -->
<g id="node242" class="node">
<title>layer4_expert4</title>
<polygon fill="lightcoral" stroke="black" points="26963.2,-1004.16 26742.2,-1004.16 26742.2,-941.16 26963.2,-941.16 26963.2,-1004.16"/>
<text text-anchor="middle" x="26852.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="26852.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="26852.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26852.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26852.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp4&#45;&gt;layer4_expert4 -->
<g id="edge291" class="edge">
<title>layer4_route_exp4&#45;&gt;layer4_expert4</title>
<path fill="none" stroke="black" d="M26852.7,-1040.16C26852.7,-1040.16 26852.7,-1014.25 26852.7,-1014.25"/>
<polygon fill="black" stroke="black" points="26856.2,-1014.25 26852.7,-1004.25 26849.2,-1014.25 26856.2,-1014.25"/>
</g>
<!-- layer4_agg_exp4 -->
<g id="node243" class="node">
<title>layer4_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="26834.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="26834.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="26834.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="26834.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26834.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert4&#45;&gt;layer4_agg_exp4 -->
<g id="edge292" class="edge">
<title>layer4_expert4&#45;&gt;layer4_agg_exp4</title>
<path fill="none" stroke="black" d="M26852.7,-941.09C26852.7,-941.09 26852.7,-915.34 26852.7,-915.34"/>
<polygon fill="black" stroke="black" points="26856.2,-915.34 26852.7,-905.34 26849.2,-915.34 26856.2,-915.34"/>
</g>
<!-- layer4_agg_exp4&#45;&gt;layer4_moe_agg -->
<g id="edge293" class="edge">
<title>layer4_agg_exp4&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M26834.7,-831.57C26834.7,-790.87 26834.7,-731 26834.7,-731 26834.7,-731 28083.88,-731 28083.88,-731"/>
<polygon fill="black" stroke="black" points="28083.88,-734.5 28093.88,-731 28083.88,-727.5 28083.88,-734.5"/>
</g>
<!-- layer4_expert5 -->
<g id="node245" class="node">
<title>layer4_expert5</title>
<polygon fill="lightcoral" stroke="black" points="27373.2,-1004.16 27152.2,-1004.16 27152.2,-941.16 27373.2,-941.16 27373.2,-1004.16"/>
<text text-anchor="middle" x="27262.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="27262.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="27262.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="27262.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="27262.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp5&#45;&gt;layer4_expert5 -->
<g id="edge295" class="edge">
<title>layer4_route_exp5&#45;&gt;layer4_expert5</title>
<path fill="none" stroke="black" d="M27262.7,-1040.16C27262.7,-1040.16 27262.7,-1014.25 27262.7,-1014.25"/>
<polygon fill="black" stroke="black" points="27266.2,-1014.25 27262.7,-1004.25 27259.2,-1014.25 27266.2,-1014.25"/>
</g>
<!-- layer4_agg_exp5 -->
<g id="node246" class="node">
<title>layer4_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="27249.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="27249.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="27249.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="27249.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="27249.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert5&#45;&gt;layer4_agg_exp5 -->
<g id="edge296" class="edge">
<title>layer4_expert5&#45;&gt;layer4_agg_exp5</title>
<path fill="none" stroke="black" d="M27262.7,-941.09C27262.7,-941.09 27262.7,-915.34 27262.7,-915.34"/>
<polygon fill="black" stroke="black" points="27266.2,-915.34 27262.7,-905.34 27259.2,-915.34 27266.2,-915.34"/>
</g>
<!-- layer4_agg_exp5&#45;&gt;layer4_moe_agg -->
<g id="edge297" class="edge">
<title>layer4_agg_exp5&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M27249.7,-831.51C27249.7,-792.34 27249.7,-736 27249.7,-736 27249.7,-736 28075.83,-736 28075.83,-736"/>
<polygon fill="black" stroke="black" points="28075.83,-739.5 28085.83,-736 28075.83,-732.5 28075.83,-739.5"/>
</g>
<!-- layer4_expert6 -->
<g id="node248" class="node">
<title>layer4_expert6</title>
<polygon fill="lightcoral" stroke="black" points="27784.2,-1004.16 27563.2,-1004.16 27563.2,-941.16 27784.2,-941.16 27784.2,-1004.16"/>
<text text-anchor="middle" x="27673.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="27673.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="27673.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="27673.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="27673.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp6&#45;&gt;layer4_expert6 -->
<g id="edge299" class="edge">
<title>layer4_route_exp6&#45;&gt;layer4_expert6</title>
<path fill="none" stroke="black" d="M27673.7,-1040.16C27673.7,-1040.16 27673.7,-1014.25 27673.7,-1014.25"/>
<polygon fill="black" stroke="black" points="27677.2,-1014.25 27673.7,-1004.25 27670.2,-1014.25 27677.2,-1014.25"/>
</g>
<!-- layer4_agg_exp6 -->
<g id="node249" class="node">
<title>layer4_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="27664.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="27664.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="27664.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="27664.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="27664.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert6&#45;&gt;layer4_agg_exp6 -->
<g id="edge300" class="edge">
<title>layer4_expert6&#45;&gt;layer4_agg_exp6</title>
<path fill="none" stroke="black" d="M27673.7,-941.09C27673.7,-941.09 27673.7,-915.34 27673.7,-915.34"/>
<polygon fill="black" stroke="black" points="27677.2,-915.34 27673.7,-905.34 27670.2,-915.34 27677.2,-915.34"/>
</g>
<!-- layer4_agg_exp6&#45;&gt;layer4_moe_agg -->
<g id="edge301" class="edge">
<title>layer4_agg_exp6&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M27855.3,-857.96C27855.3,-827.54 27855.3,-741 27855.3,-741 27855.3,-741 28072.05,-741 28072.05,-741"/>
<polygon fill="black" stroke="black" points="28072.05,-744.5 28082.05,-741 28072.05,-737.5 28072.05,-744.5"/>
</g>
<!-- layer4_expert7 -->
<g id="node251" class="node">
<title>layer4_expert7</title>
<polygon fill="lightcoral" stroke="black" points="28194.2,-1004.16 27973.2,-1004.16 27973.2,-941.16 28194.2,-941.16 28194.2,-1004.16"/>
<text text-anchor="middle" x="28083.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="28083.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="28083.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28083.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28083.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp7&#45;&gt;layer4_expert7 -->
<g id="edge303" class="edge">
<title>layer4_route_exp7&#45;&gt;layer4_expert7</title>
<path fill="none" stroke="black" d="M28083.7,-1040.16C28083.7,-1040.16 28083.7,-1014.25 28083.7,-1014.25"/>
<polygon fill="black" stroke="black" points="28087.2,-1014.25 28083.7,-1004.25 28080.2,-1014.25 28087.2,-1014.25"/>
</g>
<!-- layer4_agg_exp7 -->
<g id="node252" class="node">
<title>layer4_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="28079.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="28079.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="28079.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="28079.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28079.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert7&#45;&gt;layer4_agg_exp7 -->
<g id="edge304" class="edge">
<title>layer4_expert7&#45;&gt;layer4_agg_exp7</title>
<path fill="none" stroke="black" d="M28083.7,-941.09C28083.7,-941.09 28083.7,-915.34 28083.7,-915.34"/>
<polygon fill="black" stroke="black" points="28087.2,-915.34 28083.7,-905.34 28080.2,-915.34 28087.2,-915.34"/>
</g>
<!-- layer4_agg_exp7&#45;&gt;layer4_moe_agg -->
<g id="edge305" class="edge">
<title>layer4_agg_exp7&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M28180.02,-836.58C28180.02,-836.58 28180.02,-785.37 28180.02,-785.37"/>
<polygon fill="black" stroke="black" points="28183.52,-785.37 28180.02,-775.37 28176.52,-785.37 28183.52,-785.37"/>
</g>
<!-- layer4_expert8 -->
<g id="node254" class="node">
<title>layer4_expert8</title>
<polygon fill="lightcoral" stroke="black" points="28605.2,-1004.16 28384.2,-1004.16 28384.2,-941.16 28605.2,-941.16 28605.2,-1004.16"/>
<text text-anchor="middle" x="28494.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="28494.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="28494.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28494.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28494.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp8&#45;&gt;layer4_expert8 -->
<g id="edge307" class="edge">
<title>layer4_route_exp8&#45;&gt;layer4_expert8</title>
<path fill="none" stroke="black" d="M28494.7,-1039.87C28494.7,-1039.87 28494.7,-1014.41 28494.7,-1014.41"/>
<polygon fill="black" stroke="black" points="28498.2,-1014.41 28494.7,-1004.41 28491.2,-1014.41 28498.2,-1014.41"/>
</g>
<!-- layer4_agg_exp8 -->
<g id="node255" class="node">
<title>layer4_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="28494.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="28494.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="28494.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="28494.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28494.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert8&#45;&gt;layer4_agg_exp8 -->
<g id="edge308" class="edge">
<title>layer4_expert8&#45;&gt;layer4_agg_exp8</title>
<path fill="none" stroke="black" d="M28494.7,-941.09C28494.7,-941.09 28494.7,-915.34 28494.7,-915.34"/>
<polygon fill="black" stroke="black" points="28498.2,-915.34 28494.7,-905.34 28491.2,-915.34 28498.2,-915.34"/>
</g>
<!-- layer4_agg_exp8&#45;&gt;layer4_moe_agg -->
<g id="edge309" class="edge">
<title>layer4_agg_exp8&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M28393.88,-836.58C28393.88,-836.58 28393.88,-785.37 28393.88,-785.37"/>
<polygon fill="black" stroke="black" points="28397.38,-785.37 28393.88,-775.37 28390.38,-785.37 28397.38,-785.37"/>
</g>
<!-- layer4_expert9 -->
<g id="node257" class="node">
<title>layer4_expert9</title>
<polygon fill="lightcoral" stroke="black" points="29015.2,-1004.16 28794.2,-1004.16 28794.2,-941.16 29015.2,-941.16 29015.2,-1004.16"/>
<text text-anchor="middle" x="28904.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="28904.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="28904.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28904.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28904.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp9&#45;&gt;layer4_expert9 -->
<g id="edge311" class="edge">
<title>layer4_route_exp9&#45;&gt;layer4_expert9</title>
<path fill="none" stroke="black" d="M28904.7,-1039.87C28904.7,-1039.87 28904.7,-1014.41 28904.7,-1014.41"/>
<polygon fill="black" stroke="black" points="28908.2,-1014.41 28904.7,-1004.41 28901.2,-1014.41 28908.2,-1014.41"/>
</g>
<!-- layer4_agg_exp9 -->
<g id="node258" class="node">
<title>layer4_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="28909.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="28909.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="28909.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="28909.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28909.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert9&#45;&gt;layer4_agg_exp9 -->
<g id="edge312" class="edge">
<title>layer4_expert9&#45;&gt;layer4_agg_exp9</title>
<path fill="none" stroke="black" d="M28904.7,-941.09C28904.7,-941.09 28904.7,-915.34 28904.7,-915.34"/>
<polygon fill="black" stroke="black" points="28908.2,-915.34 28904.7,-905.34 28901.2,-915.34 28908.2,-915.34"/>
</g>
<!-- layer4_agg_exp9&#45;&gt;layer4_moe_agg -->
<g id="edge313" class="edge">
<title>layer4_agg_exp9&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M28909.7,-831.48C28909.7,-805.37 28909.7,-775 28909.7,-775 28909.7,-775 28403.79,-775 28403.79,-775"/>
<polygon fill="black" stroke="black" points="28403.79,-771.5 28393.79,-775 28403.79,-778.5 28403.79,-771.5"/>
</g>
<!-- layer4_expert10 -->
<g id="node260" class="node">
<title>layer4_expert10</title>
<polygon fill="lightcoral" stroke="black" points="29428.2,-1004.16 29207.2,-1004.16 29207.2,-941.16 29428.2,-941.16 29428.2,-1004.16"/>
<text text-anchor="middle" x="29317.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="29317.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="29317.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="29317.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="29317.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp10&#45;&gt;layer4_expert10 -->
<g id="edge315" class="edge">
<title>layer4_route_exp10&#45;&gt;layer4_expert10</title>
<path fill="none" stroke="black" d="M29317.7,-1040.16C29317.7,-1040.16 29317.7,-1014.25 29317.7,-1014.25"/>
<polygon fill="black" stroke="black" points="29321.2,-1014.25 29317.7,-1004.25 29314.2,-1014.25 29321.2,-1014.25"/>
</g>
<!-- layer4_agg_exp10 -->
<g id="node261" class="node">
<title>layer4_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="29324.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="29324.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="29324.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="29324.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="29324.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert10&#45;&gt;layer4_agg_exp10 -->
<g id="edge316" class="edge">
<title>layer4_expert10&#45;&gt;layer4_agg_exp10</title>
<path fill="none" stroke="black" d="M29317.7,-941.09C29317.7,-941.09 29317.7,-915.34 29317.7,-915.34"/>
<polygon fill="black" stroke="black" points="29321.2,-915.34 29317.7,-905.34 29314.2,-915.34 29321.2,-915.34"/>
</g>
<!-- layer4_agg_exp10&#45;&gt;layer4_moe_agg -->
<g id="edge317" class="edge">
<title>layer4_agg_exp10&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M29324.7,-831.47C29324.7,-803.55 29324.7,-770 29324.7,-770 29324.7,-770 28439.66,-770 28439.66,-770"/>
<polygon fill="black" stroke="black" points="28439.66,-766.5 28429.66,-770 28439.66,-773.5 28439.66,-766.5"/>
</g>
<!-- layer4_expert11 -->
<g id="node263" class="node">
<title>layer4_expert11</title>
<polygon fill="lightcoral" stroke="black" points="29842.2,-1004.16 29621.2,-1004.16 29621.2,-941.16 29842.2,-941.16 29842.2,-1004.16"/>
<text text-anchor="middle" x="29731.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="29731.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="29731.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="29731.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="29731.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp11&#45;&gt;layer4_expert11 -->
<g id="edge319" class="edge">
<title>layer4_route_exp11&#45;&gt;layer4_expert11</title>
<path fill="none" stroke="black" d="M29731.7,-1040.16C29731.7,-1040.16 29731.7,-1014.25 29731.7,-1014.25"/>
<polygon fill="black" stroke="black" points="29735.2,-1014.25 29731.7,-1004.25 29728.2,-1014.25 29735.2,-1014.25"/>
</g>
<!-- layer4_agg_exp11 -->
<g id="node264" class="node">
<title>layer4_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="29739.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="29739.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="29739.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="29739.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="29739.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert11&#45;&gt;layer4_agg_exp11 -->
<g id="edge320" class="edge">
<title>layer4_expert11&#45;&gt;layer4_agg_exp11</title>
<path fill="none" stroke="black" d="M29731.7,-941.09C29731.7,-941.09 29731.7,-915.34 29731.7,-915.34"/>
<polygon fill="black" stroke="black" points="29735.2,-915.34 29731.7,-905.34 29728.2,-915.34 29735.2,-915.34"/>
</g>
<!-- layer4_agg_exp11&#45;&gt;layer4_moe_agg -->
<g id="edge321" class="edge">
<title>layer4_agg_exp11&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M29739.7,-831.35C29739.7,-801.69 29739.7,-765 29739.7,-765 29739.7,-765 28463.73,-765 28463.73,-765"/>
<polygon fill="black" stroke="black" points="28463.73,-761.5 28453.73,-765 28463.73,-768.5 28463.73,-761.5"/>
</g>
<!-- layer4_expert12 -->
<g id="node266" class="node">
<title>layer4_expert12</title>
<polygon fill="lightcoral" stroke="black" points="30260.2,-1004.16 30039.2,-1004.16 30039.2,-941.16 30260.2,-941.16 30260.2,-1004.16"/>
<text text-anchor="middle" x="30149.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="30149.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="30149.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30149.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30149.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp12&#45;&gt;layer4_expert12 -->
<g id="edge323" class="edge">
<title>layer4_route_exp12&#45;&gt;layer4_expert12</title>
<path fill="none" stroke="black" d="M30149.7,-1040.16C30149.7,-1040.16 30149.7,-1014.25 30149.7,-1014.25"/>
<polygon fill="black" stroke="black" points="30153.2,-1014.25 30149.7,-1004.25 30146.2,-1014.25 30153.2,-1014.25"/>
</g>
<!-- layer4_agg_exp12 -->
<g id="node267" class="node">
<title>layer4_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="30154.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="30154.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="30154.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="30154.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30154.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert12&#45;&gt;layer4_agg_exp12 -->
<g id="edge324" class="edge">
<title>layer4_expert12&#45;&gt;layer4_agg_exp12</title>
<path fill="none" stroke="black" d="M30149.7,-941.09C30149.7,-941.09 30149.7,-915.34 30149.7,-915.34"/>
<polygon fill="black" stroke="black" points="30153.2,-915.34 30149.7,-905.34 30146.2,-915.34 30153.2,-915.34"/>
</g>
<!-- layer4_agg_exp12&#45;&gt;layer4_moe_agg -->
<g id="edge325" class="edge">
<title>layer4_agg_exp12&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M30154.7,-831.39C30154.7,-799.99 30154.7,-760 30154.7,-760 30154.7,-760 28480.49,-760 28480.49,-760"/>
<polygon fill="black" stroke="black" points="28480.49,-756.5 28470.49,-760 28480.49,-763.5 28480.49,-756.5"/>
</g>
<!-- layer4_expert13 -->
<g id="node269" class="node">
<title>layer4_expert13</title>
<polygon fill="lightcoral" stroke="black" points="30673.2,-1004.16 30452.2,-1004.16 30452.2,-941.16 30673.2,-941.16 30673.2,-1004.16"/>
<text text-anchor="middle" x="30562.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="30562.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="30562.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30562.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30562.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp13&#45;&gt;layer4_expert13 -->
<g id="edge327" class="edge">
<title>layer4_route_exp13&#45;&gt;layer4_expert13</title>
<path fill="none" stroke="black" d="M30562.7,-1040.16C30562.7,-1040.16 30562.7,-1014.25 30562.7,-1014.25"/>
<polygon fill="black" stroke="black" points="30566.2,-1014.25 30562.7,-1004.25 30559.2,-1014.25 30566.2,-1014.25"/>
</g>
<!-- layer4_agg_exp13 -->
<g id="node270" class="node">
<title>layer4_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="30569.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="30569.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="30569.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="30569.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30569.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert13&#45;&gt;layer4_agg_exp13 -->
<g id="edge328" class="edge">
<title>layer4_expert13&#45;&gt;layer4_agg_exp13</title>
<path fill="none" stroke="black" d="M30562.7,-941.09C30562.7,-941.09 30562.7,-915.34 30562.7,-915.34"/>
<polygon fill="black" stroke="black" points="30566.2,-915.34 30562.7,-905.34 30559.2,-915.34 30566.2,-915.34"/>
</g>
<!-- layer4_agg_exp13&#45;&gt;layer4_moe_agg -->
<g id="edge329" class="edge">
<title>layer4_agg_exp13&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M30569.7,-831.57C30569.7,-798.47 30569.7,-755 30569.7,-755 30569.7,-755 28491.84,-755 28491.84,-755"/>
<polygon fill="black" stroke="black" points="28491.84,-751.5 28481.84,-755 28491.84,-758.5 28491.84,-751.5"/>
</g>
<!-- layer4_expert14 -->
<g id="node272" class="node">
<title>layer4_expert14</title>
<polygon fill="lightcoral" stroke="black" points="31087.2,-1004.16 30866.2,-1004.16 30866.2,-941.16 31087.2,-941.16 31087.2,-1004.16"/>
<text text-anchor="middle" x="30976.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="30976.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="30976.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30976.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30976.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp14&#45;&gt;layer4_expert14 -->
<g id="edge331" class="edge">
<title>layer4_route_exp14&#45;&gt;layer4_expert14</title>
<path fill="none" stroke="black" d="M30976.7,-1040.16C30976.7,-1040.16 30976.7,-1014.25 30976.7,-1014.25"/>
<polygon fill="black" stroke="black" points="30980.2,-1014.25 30976.7,-1004.25 30973.2,-1014.25 30980.2,-1014.25"/>
</g>
<!-- layer4_agg_exp14 -->
<g id="node273" class="node">
<title>layer4_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="30984.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="30984.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="30984.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="30984.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30984.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert14&#45;&gt;layer4_agg_exp14 -->
<g id="edge332" class="edge">
<title>layer4_expert14&#45;&gt;layer4_agg_exp14</title>
<path fill="none" stroke="black" d="M30976.7,-941.09C30976.7,-941.09 30976.7,-915.34 30976.7,-915.34"/>
<polygon fill="black" stroke="black" points="30980.2,-915.34 30976.7,-905.34 30973.2,-915.34 30980.2,-915.34"/>
</g>
<!-- layer4_agg_exp14&#45;&gt;layer4_moe_agg -->
<g id="edge333" class="edge">
<title>layer4_agg_exp14&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M30984.7,-831.58C30984.7,-796.82 30984.7,-750 30984.7,-750 30984.7,-750 28498.66,-750 28498.66,-750"/>
<polygon fill="black" stroke="black" points="28498.66,-746.5 28488.66,-750 28498.66,-753.5 28498.66,-746.5"/>
</g>
<!-- layer4_expert15 -->
<g id="node275" class="node">
<title>layer4_expert15</title>
<polygon fill="lightcoral" stroke="black" points="31501.2,-1004.16 31280.2,-1004.16 31280.2,-941.16 31501.2,-941.16 31501.2,-1004.16"/>
<text text-anchor="middle" x="31390.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="31390.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="31390.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="31390.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="31390.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer4_route_exp15&#45;&gt;layer4_expert15 -->
<g id="edge335" class="edge">
<title>layer4_route_exp15&#45;&gt;layer4_expert15</title>
<path fill="none" stroke="black" d="M31390.7,-1040.16C31390.7,-1040.16 31390.7,-1014.25 31390.7,-1014.25"/>
<polygon fill="black" stroke="black" points="31394.2,-1014.25 31390.7,-1004.25 31387.2,-1014.25 31394.2,-1014.25"/>
</g>
<!-- layer4_agg_exp15 -->
<g id="node276" class="node">
<title>layer4_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="31399.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="31399.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="31399.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="31399.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="31399.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer4_expert15&#45;&gt;layer4_agg_exp15 -->
<g id="edge336" class="edge">
<title>layer4_expert15&#45;&gt;layer4_agg_exp15</title>
<path fill="none" stroke="black" d="M31390.7,-941.09C31390.7,-941.09 31390.7,-915.34 31390.7,-915.34"/>
<polygon fill="black" stroke="black" points="31394.2,-915.34 31390.7,-905.34 31387.2,-915.34 31394.2,-915.34"/>
</g>
<!-- layer4_agg_exp15&#45;&gt;layer4_moe_agg -->
<g id="edge337" class="edge">
<title>layer4_agg_exp15&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M31399.7,-831.33C31399.7,-795.31 31399.7,-746 31399.7,-746 31399.7,-746 28501.55,-746 28501.55,-746"/>
<polygon fill="black" stroke="black" points="28501.55,-742.5 28491.55,-746 28501.55,-749.5 28501.55,-742.5"/>
</g>
<!-- layer5_ln1 -->
<g id="node278" class="node">
<title>layer5_ln1</title>
<polygon fill="none" stroke="black" points="31747.2,-1227.7 31466.2,-1227.7 31466.2,-1175.7 31747.2,-1175.7 31747.2,-1227.7"/>
<text text-anchor="middle" x="31606.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 5</text>
<text text-anchor="middle" x="31606.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="31606.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="31606.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer5_add1 -->
<g id="node279" class="node">
<title>layer5_add1</title>
<polygon fill="yellow" stroke="black" points="34768.2,-644.85 34487.2,-644.85 34487.2,-592.85 34768.2,-592.85 34768.2,-644.85"/>
<text text-anchor="middle" x="34627.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 5</text>
<text text-anchor="middle" x="34627.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34627.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34627.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_moe_output -->
<g id="node283" class="node">
<title>layer5_moe_output</title>
<polygon fill="yellow" stroke="black" points="34917.2,-540.58 34636.2,-540.58 34636.2,-488.58 34917.2,-488.58 34917.2,-540.58"/>
<text text-anchor="middle" x="34776.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 5</text>
<text text-anchor="middle" x="34776.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34776.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34776.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_add1&#45;&gt;layer5_moe_output -->
<g id="edge407" class="edge">
<title>layer5_add1&#45;&gt;layer5_moe_output</title>
<path fill="none" stroke="black" d="M34702.2,-592.81C34702.2,-592.81 34702.2,-550.65 34702.2,-550.65"/>
<polygon fill="black" stroke="black" points="34705.7,-550.65 34702.2,-540.65 34698.7,-550.65 34705.7,-550.65"/>
</g>
<!-- layer5_gate -->
<g id="node280" class="node">
<title>layer5_gate</title>
<polygon fill="lightgreen" stroke="black" points="35216.13,-1253.7 34757.3,-1253.7 34639.26,-1149.7 35098.1,-1149.7 35216.13,-1253.7"/>
<text text-anchor="middle" x="34927.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 5</text>
<text text-anchor="middle" x="34927.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34927.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="34927.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer5_route_exp0 -->
<g id="node284" class="node">
<title>layer5_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="31818.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="31818.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="31818.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="31818.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="31818.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp0 -->
<g id="edge341" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp0</title>
<path fill="none" stroke="black" d="M34665.53,-1173C33926.5,-1173 31879.82,-1173 31879.82,-1173 31879.82,-1173 31879.82,-1121.88 31879.82,-1121.88"/>
<polygon fill="black" stroke="black" points="31883.32,-1121.88 31879.82,-1111.88 31876.32,-1121.88 31883.32,-1121.88"/>
</g>
<!-- layer5_route_exp1 -->
<g id="node287" class="node">
<title>layer5_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="32258.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="32258.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="32258.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="32258.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="32258.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp1 -->
<g id="edge345" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp1</title>
<path fill="none" stroke="black" d="M34659.87,-1168C33983.26,-1168 32258.7,-1168 32258.7,-1168 32258.7,-1168 32258.7,-1123.71 32258.7,-1123.71"/>
<polygon fill="black" stroke="black" points="32262.2,-1123.71 32258.7,-1113.71 32255.2,-1123.71 32262.2,-1123.71"/>
</g>
<!-- layer5_route_exp2 -->
<g id="node290" class="node">
<title>layer5_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="32680.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="32680.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="32680.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="32680.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="32680.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp2 -->
<g id="edge349" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp2</title>
<path fill="none" stroke="black" d="M34656.38,-1165C34058.59,-1165 32680.7,-1165 32680.7,-1165 32680.7,-1165 32680.7,-1123.77 32680.7,-1123.77"/>
<polygon fill="black" stroke="black" points="32684.2,-1123.77 32680.7,-1113.77 32677.2,-1123.77 32684.2,-1123.77"/>
</g>
<!-- layer5_route_exp3 -->
<g id="node293" class="node">
<title>layer5_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="33094.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="33094.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="33094.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="33094.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="33094.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp3 -->
<g id="edge353" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp3</title>
<path fill="none" stroke="black" d="M34651.79,-1161C34139.9,-1161 33094.7,-1161 33094.7,-1161 33094.7,-1161 33094.7,-1124.05 33094.7,-1124.05"/>
<polygon fill="black" stroke="black" points="33098.2,-1124.05 33094.7,-1114.05 33091.2,-1124.05 33098.2,-1124.05"/>
</g>
<!-- layer5_route_exp4 -->
<g id="node296" class="node">
<title>layer5_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="33503.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="33503.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="33503.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="33503.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="33503.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp4 -->
<g id="edge357" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp4</title>
<path fill="none" stroke="black" d="M34648.48,-1158C34233.85,-1158 33503.7,-1158 33503.7,-1158 33503.7,-1158 33503.7,-1124.14 33503.7,-1124.14"/>
<polygon fill="black" stroke="black" points="33507.2,-1124.14 33503.7,-1114.14 33500.2,-1124.14 33507.2,-1124.14"/>
</g>
<!-- layer5_route_exp5 -->
<g id="node299" class="node">
<title>layer5_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="33910.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="33910.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="33910.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="33910.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="33910.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp5 -->
<g id="edge361" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp5</title>
<path fill="none" stroke="black" d="M34644.07,-1154C34343.16,-1154 33910.7,-1154 33910.7,-1154 33910.7,-1154 33910.7,-1124.11 33910.7,-1124.11"/>
<polygon fill="black" stroke="black" points="33914.2,-1124.11 33910.7,-1114.11 33907.2,-1124.11 33914.2,-1124.11"/>
</g>
<!-- layer5_route_exp6 -->
<g id="node302" class="node">
<title>layer5_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="34316.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="34316.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="34316.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="34316.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34316.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp6 -->
<g id="edge365" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp6</title>
<path fill="none" stroke="black" d="M34642.77,-1153C34483.48,-1153 34316.7,-1153 34316.7,-1153 34316.7,-1153 34316.7,-1124.07 34316.7,-1124.07"/>
<polygon fill="black" stroke="black" points="34320.2,-1124.07 34316.7,-1114.07 34313.2,-1124.07 34320.2,-1124.07"/>
</g>
<!-- layer5_route_exp7 -->
<g id="node305" class="node">
<title>layer5_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="34722.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="34722.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="34722.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="34722.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34722.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp7 -->
<g id="edge369" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp7</title>
<path fill="none" stroke="black" d="M34777.96,-1149.5C34777.96,-1149.5 34777.96,-1122.25 34777.96,-1122.25"/>
<polygon fill="black" stroke="black" points="34781.46,-1122.25 34777.96,-1112.25 34774.46,-1122.25 34781.46,-1122.25"/>
</g>
<!-- layer5_route_exp8 -->
<g id="node308" class="node">
<title>layer5_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="35132.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="35132.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="35132.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="35132.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="35132.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp8 -->
<g id="edge373" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp8</title>
<path fill="none" stroke="black" d="M35077.43,-1149.5C35077.43,-1149.5 35077.43,-1122.25 35077.43,-1122.25"/>
<polygon fill="black" stroke="black" points="35080.93,-1122.25 35077.43,-1112.25 35073.93,-1122.25 35080.93,-1122.25"/>
</g>
<!-- layer5_route_exp9 -->
<g id="node311" class="node">
<title>layer5_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="35544.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="35544.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="35544.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="35544.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="35544.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp9 -->
<g id="edge377" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp9</title>
<path fill="none" stroke="black" d="M35102.03,-1153C35284.48,-1153 35544.7,-1153 35544.7,-1153 35544.7,-1153 35544.7,-1124.07 35544.7,-1124.07"/>
<polygon fill="black" stroke="black" points="35548.2,-1124.07 35544.7,-1114.07 35541.2,-1124.07 35548.2,-1124.07"/>
</g>
<!-- layer5_route_exp10 -->
<g id="node314" class="node">
<title>layer5_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="35958.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="35958.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="35958.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="35958.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="35958.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp10 -->
<g id="edge381" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp10</title>
<path fill="none" stroke="black" d="M35105.52,-1156C35400.45,-1156 35958.7,-1156 35958.7,-1156 35958.7,-1156 35958.7,-1124.15 35958.7,-1124.15"/>
<polygon fill="black" stroke="black" points="35962.2,-1124.15 35958.7,-1114.15 35955.2,-1124.15 35962.2,-1124.15"/>
</g>
<!-- layer5_route_exp11 -->
<g id="node317" class="node">
<title>layer5_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="36372.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="36372.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="36372.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="36372.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="36372.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp11 -->
<g id="edge385" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp11</title>
<path fill="none" stroke="black" d="M35109.98,-1160C35498.44,-1160 36372.7,-1160 36372.7,-1160 36372.7,-1160 36372.7,-1124.09 36372.7,-1124.09"/>
<polygon fill="black" stroke="black" points="36376.2,-1124.09 36372.7,-1114.09 36369.2,-1124.09 36376.2,-1124.09"/>
</g>
<!-- layer5_route_exp12 -->
<g id="node320" class="node">
<title>layer5_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="36781.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="36781.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="36781.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="36781.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="36781.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp12 -->
<g id="edge389" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp12</title>
<path fill="none" stroke="black" d="M35113.53,-1163C35583.38,-1163 36781.7,-1163 36781.7,-1163 36781.7,-1163 36781.7,-1123.93 36781.7,-1123.93"/>
<polygon fill="black" stroke="black" points="36785.2,-1123.93 36781.7,-1113.93 36778.2,-1123.93 36785.2,-1123.93"/>
</g>
<!-- layer5_route_exp13 -->
<g id="node323" class="node">
<title>layer5_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="37196.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="37196.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="37196.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="37196.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="37196.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp13 -->
<g id="edge393" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp13</title>
<path fill="none" stroke="black" d="M35118.22,-1167C35664.4,-1167 37196.7,-1167 37196.7,-1167 37196.7,-1167 37196.7,-1123.82 37196.7,-1123.82"/>
<polygon fill="black" stroke="black" points="37200.2,-1123.82 37196.7,-1113.82 37193.2,-1123.82 37200.2,-1123.82"/>
</g>
<!-- layer5_route_exp14 -->
<g id="node326" class="node">
<title>layer5_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="37608.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="37608.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="37608.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="37608.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="37608.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp14 -->
<g id="edge397" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp14</title>
<path fill="none" stroke="black" d="M35121.32,-1170C35736.88,-1170 37608.7,-1170 37608.7,-1170 37608.7,-1170 37608.7,-1123.71 37608.7,-1123.71"/>
<polygon fill="black" stroke="black" points="37612.2,-1123.71 37608.7,-1113.71 37605.2,-1123.71 37612.2,-1123.71"/>
</g>
<!-- layer5_route_exp15 -->
<g id="node329" class="node">
<title>layer5_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="38023.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="38023.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="38023.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="38023.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="38023.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_route_exp15 -->
<g id="edge401" class="edge">
<title>layer5_gate&#45;&gt;layer5_route_exp15</title>
<path fill="none" stroke="black" d="M35123.68,-1172C35796.06,-1172 37968.07,-1172 37968.07,-1172 37968.07,-1172 37968.07,-1122.33 37968.07,-1122.33"/>
<polygon fill="black" stroke="black" points="37971.57,-1122.33 37968.07,-1112.33 37964.57,-1122.33 37971.57,-1122.33"/>
</g>
<!-- layer5_moe_agg -->
<g id="node281" class="node">
<title>layer5_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="34926.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="34926.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 5</text>
<text text-anchor="middle" x="34926.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34926.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34926.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer5_ln2 -->
<g id="node282" class="node">
<title>layer5_ln2</title>
<polygon fill="none" stroke="black" points="35067.2,-644.85 34786.2,-644.85 34786.2,-592.85 35067.2,-592.85 35067.2,-644.85"/>
<text text-anchor="middle" x="34926.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 5</text>
<text text-anchor="middle" x="34926.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34926.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34926.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer5_moe_agg&#45;&gt;layer5_ln2 -->
<g id="edge405" class="edge">
<title>layer5_moe_agg&#45;&gt;layer5_ln2</title>
<path fill="none" stroke="black" d="M34926.7,-706.52C34926.7,-706.52 34926.7,-654.92 34926.7,-654.92"/>
<polygon fill="black" stroke="black" points="34930.2,-654.92 34926.7,-644.92 34923.2,-654.92 34930.2,-654.92"/>
</g>
<!-- layer5_ln2&#45;&gt;layer5_moe_output -->
<g id="edge406" class="edge">
<title>layer5_ln2&#45;&gt;layer5_moe_output</title>
<path fill="none" stroke="black" d="M34851.7,-592.81C34851.7,-592.81 34851.7,-550.65 34851.7,-550.65"/>
<polygon fill="black" stroke="black" points="34855.2,-550.65 34851.7,-540.65 34848.2,-550.65 34855.2,-550.65"/>
</g>
<!-- layer6_mha -->
<g id="node332" class="node">
<title>layer6_mha</title>
<polygon fill="lightcyan" stroke="black" points="34917.2,-436.31 34636.2,-436.31 34636.2,-384.31 34917.2,-384.31 34917.2,-436.31"/>
<text text-anchor="middle" x="34776.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 6</text>
<text text-anchor="middle" x="34776.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34776.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="34776.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer5_moe_output&#45;&gt;layer6_mha -->
<g id="edge1083" class="edge">
<title>layer5_moe_output&#45;&gt;layer6_mha</title>
<path fill="none" stroke="black" d="M34776.7,-488.54C34776.7,-488.54 34776.7,-446.38 34776.7,-446.38"/>
<polygon fill="black" stroke="black" points="34780.2,-446.38 34776.7,-436.38 34773.2,-446.38 34780.2,-446.38"/>
</g>
<!-- layer5_expert0 -->
<g id="node285" class="node">
<title>layer5_expert0</title>
<polygon fill="lightcoral" stroke="black" points="31926.2,-1004.16 31705.2,-1004.16 31705.2,-941.16 31926.2,-941.16 31926.2,-1004.16"/>
<text text-anchor="middle" x="31815.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="31815.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="31815.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="31815.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="31815.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp0&#45;&gt;layer5_expert0 -->
<g id="edge342" class="edge">
<title>layer5_route_exp0&#45;&gt;layer5_expert0</title>
<path fill="none" stroke="black" d="M31815.7,-1039.87C31815.7,-1039.87 31815.7,-1014.41 31815.7,-1014.41"/>
<polygon fill="black" stroke="black" points="31819.2,-1014.41 31815.7,-1004.41 31812.2,-1014.41 31819.2,-1014.41"/>
</g>
<!-- layer5_agg_exp0 -->
<g id="node286" class="node">
<title>layer5_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="31814.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="31814.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="31814.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="31814.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="31814.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert0&#45;&gt;layer5_agg_exp0 -->
<g id="edge343" class="edge">
<title>layer5_expert0&#45;&gt;layer5_agg_exp0</title>
<path fill="none" stroke="black" d="M31815.7,-941.09C31815.7,-941.09 31815.7,-915.34 31815.7,-915.34"/>
<polygon fill="black" stroke="black" points="31819.2,-915.34 31815.7,-905.34 31812.2,-915.34 31819.2,-915.34"/>
</g>
<!-- layer5_agg_exp0&#45;&gt;layer5_moe_agg -->
<g id="edge344" class="edge">
<title>layer5_agg_exp0&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M31814.7,-831.49C31814.7,-784.97 31814.7,-711 31814.7,-711 31814.7,-711 34821.86,-711 34821.86,-711"/>
<polygon fill="black" stroke="black" points="34821.86,-714.5 34831.86,-711 34821.86,-707.5 34821.86,-714.5"/>
</g>
<!-- layer5_expert1 -->
<g id="node288" class="node">
<title>layer5_expert1</title>
<polygon fill="lightcoral" stroke="black" points="32354.2,-1004.16 32133.2,-1004.16 32133.2,-941.16 32354.2,-941.16 32354.2,-1004.16"/>
<text text-anchor="middle" x="32243.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="32243.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="32243.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="32243.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="32243.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp1&#45;&gt;layer5_expert1 -->
<g id="edge346" class="edge">
<title>layer5_route_exp1&#45;&gt;layer5_expert1</title>
<path fill="none" stroke="black" d="M32243.7,-1040.16C32243.7,-1040.16 32243.7,-1014.25 32243.7,-1014.25"/>
<polygon fill="black" stroke="black" points="32247.2,-1014.25 32243.7,-1004.25 32240.2,-1014.25 32247.2,-1014.25"/>
</g>
<!-- layer5_agg_exp1 -->
<g id="node289" class="node">
<title>layer5_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="32229.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="32229.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="32229.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="32229.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="32229.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert1&#45;&gt;layer5_agg_exp1 -->
<g id="edge347" class="edge">
<title>layer5_expert1&#45;&gt;layer5_agg_exp1</title>
<path fill="none" stroke="black" d="M32243.7,-941.09C32243.7,-941.09 32243.7,-915.34 32243.7,-915.34"/>
<polygon fill="black" stroke="black" points="32247.2,-915.34 32243.7,-905.34 32240.2,-915.34 32247.2,-915.34"/>
</g>
<!-- layer5_agg_exp1&#45;&gt;layer5_moe_agg -->
<g id="edge348" class="edge">
<title>layer5_agg_exp1&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M32229.7,-831.5C32229.7,-786.4 32229.7,-716 32229.7,-716 32229.7,-716 34781.1,-716 34781.1,-716"/>
<polygon fill="black" stroke="black" points="34781.1,-719.5 34791.1,-716 34781.1,-712.5 34781.1,-719.5"/>
</g>
<!-- layer5_expert2 -->
<g id="node291" class="node">
<title>layer5_expert2</title>
<polygon fill="lightcoral" stroke="black" points="32772.2,-1004.16 32551.2,-1004.16 32551.2,-941.16 32772.2,-941.16 32772.2,-1004.16"/>
<text text-anchor="middle" x="32661.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="32661.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="32661.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="32661.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="32661.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp2&#45;&gt;layer5_expert2 -->
<g id="edge350" class="edge">
<title>layer5_route_exp2&#45;&gt;layer5_expert2</title>
<path fill="none" stroke="black" d="M32661.7,-1040.16C32661.7,-1040.16 32661.7,-1014.25 32661.7,-1014.25"/>
<polygon fill="black" stroke="black" points="32665.2,-1014.25 32661.7,-1004.25 32658.2,-1014.25 32665.2,-1014.25"/>
</g>
<!-- layer5_agg_exp2 -->
<g id="node292" class="node">
<title>layer5_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="32644.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="32644.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="32644.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="32644.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="32644.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert2&#45;&gt;layer5_agg_exp2 -->
<g id="edge351" class="edge">
<title>layer5_expert2&#45;&gt;layer5_agg_exp2</title>
<path fill="none" stroke="black" d="M32661.7,-941.09C32661.7,-941.09 32661.7,-915.34 32661.7,-915.34"/>
<polygon fill="black" stroke="black" points="32665.2,-915.34 32661.7,-905.34 32658.2,-915.34 32665.2,-915.34"/>
</g>
<!-- layer5_agg_exp2&#45;&gt;layer5_moe_agg -->
<g id="edge352" class="edge">
<title>layer5_agg_exp2&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M32644.7,-831.58C32644.7,-787.92 32644.7,-721 32644.7,-721 32644.7,-721 34754.87,-721 34754.87,-721"/>
<polygon fill="black" stroke="black" points="34754.87,-724.5 34764.87,-721 34754.87,-717.5 34754.87,-724.5"/>
</g>
<!-- layer5_expert3 -->
<g id="node294" class="node">
<title>layer5_expert3</title>
<polygon fill="lightcoral" stroke="black" points="33187.2,-1004.16 32966.2,-1004.16 32966.2,-941.16 33187.2,-941.16 33187.2,-1004.16"/>
<text text-anchor="middle" x="33076.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="33076.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="33076.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="33076.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="33076.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp3&#45;&gt;layer5_expert3 -->
<g id="edge354" class="edge">
<title>layer5_route_exp3&#45;&gt;layer5_expert3</title>
<path fill="none" stroke="black" d="M33076.7,-1040.16C33076.7,-1040.16 33076.7,-1014.25 33076.7,-1014.25"/>
<polygon fill="black" stroke="black" points="33080.2,-1014.25 33076.7,-1004.25 33073.2,-1014.25 33080.2,-1014.25"/>
</g>
<!-- layer5_agg_exp3 -->
<g id="node295" class="node">
<title>layer5_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="33059.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="33059.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="33059.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="33059.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="33059.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert3&#45;&gt;layer5_agg_exp3 -->
<g id="edge355" class="edge">
<title>layer5_expert3&#45;&gt;layer5_agg_exp3</title>
<path fill="none" stroke="black" d="M33076.7,-941.09C33076.7,-941.09 33076.7,-915.34 33076.7,-915.34"/>
<polygon fill="black" stroke="black" points="33080.2,-915.34 33076.7,-905.34 33073.2,-915.34 33080.2,-915.34"/>
</g>
<!-- layer5_agg_exp3&#45;&gt;layer5_moe_agg -->
<g id="edge356" class="edge">
<title>layer5_agg_exp3&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M33059.7,-831.35C33059.7,-789.16 33059.7,-726 33059.7,-726 33059.7,-726 34736.41,-726 34736.41,-726"/>
<polygon fill="black" stroke="black" points="34736.41,-729.5 34746.41,-726 34736.41,-722.5 34736.41,-729.5"/>
</g>
<!-- layer5_expert4 -->
<g id="node297" class="node">
<title>layer5_expert4</title>
<polygon fill="lightcoral" stroke="black" points="33599.2,-1004.16 33378.2,-1004.16 33378.2,-941.16 33599.2,-941.16 33599.2,-1004.16"/>
<text text-anchor="middle" x="33488.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="33488.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="33488.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="33488.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="33488.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp4&#45;&gt;layer5_expert4 -->
<g id="edge358" class="edge">
<title>layer5_route_exp4&#45;&gt;layer5_expert4</title>
<path fill="none" stroke="black" d="M33488.7,-1040.16C33488.7,-1040.16 33488.7,-1014.25 33488.7,-1014.25"/>
<polygon fill="black" stroke="black" points="33492.2,-1014.25 33488.7,-1004.25 33485.2,-1014.25 33492.2,-1014.25"/>
</g>
<!-- layer5_agg_exp4 -->
<g id="node298" class="node">
<title>layer5_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="33474.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="33474.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="33474.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="33474.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="33474.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert4&#45;&gt;layer5_agg_exp4 -->
<g id="edge359" class="edge">
<title>layer5_expert4&#45;&gt;layer5_agg_exp4</title>
<path fill="none" stroke="black" d="M33488.7,-941.09C33488.7,-941.09 33488.7,-915.34 33488.7,-915.34"/>
<polygon fill="black" stroke="black" points="33492.2,-915.34 33488.7,-905.34 33485.2,-915.34 33492.2,-915.34"/>
</g>
<!-- layer5_agg_exp4&#45;&gt;layer5_moe_agg -->
<g id="edge360" class="edge">
<title>layer5_agg_exp4&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M33474.7,-831.57C33474.7,-790.87 33474.7,-731 33474.7,-731 33474.7,-731 34723.88,-731 34723.88,-731"/>
<polygon fill="black" stroke="black" points="34723.88,-734.5 34733.88,-731 34723.88,-727.5 34723.88,-734.5"/>
</g>
<!-- layer5_expert5 -->
<g id="node300" class="node">
<title>layer5_expert5</title>
<polygon fill="lightcoral" stroke="black" points="34010.2,-1004.16 33789.2,-1004.16 33789.2,-941.16 34010.2,-941.16 34010.2,-1004.16"/>
<text text-anchor="middle" x="33899.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="33899.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="33899.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="33899.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="33899.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp5&#45;&gt;layer5_expert5 -->
<g id="edge362" class="edge">
<title>layer5_route_exp5&#45;&gt;layer5_expert5</title>
<path fill="none" stroke="black" d="M33899.7,-1040.16C33899.7,-1040.16 33899.7,-1014.25 33899.7,-1014.25"/>
<polygon fill="black" stroke="black" points="33903.2,-1014.25 33899.7,-1004.25 33896.2,-1014.25 33903.2,-1014.25"/>
</g>
<!-- layer5_agg_exp5 -->
<g id="node301" class="node">
<title>layer5_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="33889.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="33889.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="33889.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="33889.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="33889.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert5&#45;&gt;layer5_agg_exp5 -->
<g id="edge363" class="edge">
<title>layer5_expert5&#45;&gt;layer5_agg_exp5</title>
<path fill="none" stroke="black" d="M33899.7,-941.09C33899.7,-941.09 33899.7,-915.34 33899.7,-915.34"/>
<polygon fill="black" stroke="black" points="33903.2,-915.34 33899.7,-905.34 33896.2,-915.34 33903.2,-915.34"/>
</g>
<!-- layer5_agg_exp5&#45;&gt;layer5_moe_agg -->
<g id="edge364" class="edge">
<title>layer5_agg_exp5&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M33889.7,-831.51C33889.7,-792.34 33889.7,-736 33889.7,-736 33889.7,-736 34715.83,-736 34715.83,-736"/>
<polygon fill="black" stroke="black" points="34715.83,-739.5 34725.83,-736 34715.83,-732.5 34715.83,-739.5"/>
</g>
<!-- layer5_expert6 -->
<g id="node303" class="node">
<title>layer5_expert6</title>
<polygon fill="lightcoral" stroke="black" points="34420.2,-1004.16 34199.2,-1004.16 34199.2,-941.16 34420.2,-941.16 34420.2,-1004.16"/>
<text text-anchor="middle" x="34309.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="34309.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="34309.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="34309.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="34309.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp6&#45;&gt;layer5_expert6 -->
<g id="edge366" class="edge">
<title>layer5_route_exp6&#45;&gt;layer5_expert6</title>
<path fill="none" stroke="black" d="M34309.7,-1040.16C34309.7,-1040.16 34309.7,-1014.25 34309.7,-1014.25"/>
<polygon fill="black" stroke="black" points="34313.2,-1014.25 34309.7,-1004.25 34306.2,-1014.25 34313.2,-1014.25"/>
</g>
<!-- layer5_agg_exp6 -->
<g id="node304" class="node">
<title>layer5_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="34304.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="34304.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="34304.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="34304.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="34304.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert6&#45;&gt;layer5_agg_exp6 -->
<g id="edge367" class="edge">
<title>layer5_expert6&#45;&gt;layer5_agg_exp6</title>
<path fill="none" stroke="black" d="M34309.7,-941.09C34309.7,-941.09 34309.7,-915.34 34309.7,-915.34"/>
<polygon fill="black" stroke="black" points="34313.2,-915.34 34309.7,-905.34 34306.2,-915.34 34313.2,-915.34"/>
</g>
<!-- layer5_agg_exp6&#45;&gt;layer5_moe_agg -->
<g id="edge368" class="edge">
<title>layer5_agg_exp6&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M34495.3,-857.96C34495.3,-827.54 34495.3,-741 34495.3,-741 34495.3,-741 34712.05,-741 34712.05,-741"/>
<polygon fill="black" stroke="black" points="34712.05,-744.5 34722.05,-741 34712.05,-737.5 34712.05,-744.5"/>
</g>
<!-- layer5_expert7 -->
<g id="node306" class="node">
<title>layer5_expert7</title>
<polygon fill="lightcoral" stroke="black" points="34831.2,-1004.16 34610.2,-1004.16 34610.2,-941.16 34831.2,-941.16 34831.2,-1004.16"/>
<text text-anchor="middle" x="34720.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="34720.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="34720.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="34720.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="34720.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp7&#45;&gt;layer5_expert7 -->
<g id="edge370" class="edge">
<title>layer5_route_exp7&#45;&gt;layer5_expert7</title>
<path fill="none" stroke="black" d="M34720.7,-1039.87C34720.7,-1039.87 34720.7,-1014.41 34720.7,-1014.41"/>
<polygon fill="black" stroke="black" points="34724.2,-1014.41 34720.7,-1004.41 34717.2,-1014.41 34724.2,-1014.41"/>
</g>
<!-- layer5_agg_exp7 -->
<g id="node307" class="node">
<title>layer5_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="34719.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="34719.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="34719.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="34719.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="34719.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert7&#45;&gt;layer5_agg_exp7 -->
<g id="edge371" class="edge">
<title>layer5_expert7&#45;&gt;layer5_agg_exp7</title>
<path fill="none" stroke="black" d="M34720.7,-941.09C34720.7,-941.09 34720.7,-915.34 34720.7,-915.34"/>
<polygon fill="black" stroke="black" points="34724.2,-915.34 34720.7,-905.34 34717.2,-915.34 34724.2,-915.34"/>
</g>
<!-- layer5_agg_exp7&#45;&gt;layer5_moe_agg -->
<g id="edge372" class="edge">
<title>layer5_agg_exp7&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M34820.02,-836.58C34820.02,-836.58 34820.02,-785.37 34820.02,-785.37"/>
<polygon fill="black" stroke="black" points="34823.52,-785.37 34820.02,-775.37 34816.52,-785.37 34823.52,-785.37"/>
</g>
<!-- layer5_expert8 -->
<g id="node309" class="node">
<title>layer5_expert8</title>
<polygon fill="lightcoral" stroke="black" points="35244.2,-1004.16 35023.2,-1004.16 35023.2,-941.16 35244.2,-941.16 35244.2,-1004.16"/>
<text text-anchor="middle" x="35133.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="35133.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="35133.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="35133.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="35133.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp8&#45;&gt;layer5_expert8 -->
<g id="edge374" class="edge">
<title>layer5_route_exp8&#45;&gt;layer5_expert8</title>
<path fill="none" stroke="black" d="M35133.7,-1039.87C35133.7,-1039.87 35133.7,-1014.41 35133.7,-1014.41"/>
<polygon fill="black" stroke="black" points="35137.2,-1014.41 35133.7,-1004.41 35130.2,-1014.41 35137.2,-1014.41"/>
</g>
<!-- layer5_agg_exp8 -->
<g id="node310" class="node">
<title>layer5_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="35134.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="35134.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="35134.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="35134.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="35134.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert8&#45;&gt;layer5_agg_exp8 -->
<g id="edge375" class="edge">
<title>layer5_expert8&#45;&gt;layer5_agg_exp8</title>
<path fill="none" stroke="black" d="M35133.7,-941.09C35133.7,-941.09 35133.7,-915.34 35133.7,-915.34"/>
<polygon fill="black" stroke="black" points="35137.2,-915.34 35133.7,-905.34 35130.2,-915.34 35137.2,-915.34"/>
</g>
<!-- layer5_agg_exp8&#45;&gt;layer5_moe_agg -->
<g id="edge376" class="edge">
<title>layer5_agg_exp8&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M35033.88,-836.58C35033.88,-836.58 35033.88,-785.37 35033.88,-785.37"/>
<polygon fill="black" stroke="black" points="35037.38,-785.37 35033.88,-775.37 35030.38,-785.37 35037.38,-785.37"/>
</g>
<!-- layer5_expert9 -->
<g id="node312" class="node">
<title>layer5_expert9</title>
<polygon fill="lightcoral" stroke="black" points="35657.2,-1004.16 35436.2,-1004.16 35436.2,-941.16 35657.2,-941.16 35657.2,-1004.16"/>
<text text-anchor="middle" x="35546.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="35546.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="35546.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="35546.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="35546.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp9&#45;&gt;layer5_expert9 -->
<g id="edge378" class="edge">
<title>layer5_route_exp9&#45;&gt;layer5_expert9</title>
<path fill="none" stroke="black" d="M35546.7,-1039.87C35546.7,-1039.87 35546.7,-1014.41 35546.7,-1014.41"/>
<polygon fill="black" stroke="black" points="35550.2,-1014.41 35546.7,-1004.41 35543.2,-1014.41 35550.2,-1014.41"/>
</g>
<!-- layer5_agg_exp9 -->
<g id="node313" class="node">
<title>layer5_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="35549.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="35549.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="35549.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="35549.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="35549.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert9&#45;&gt;layer5_agg_exp9 -->
<g id="edge379" class="edge">
<title>layer5_expert9&#45;&gt;layer5_agg_exp9</title>
<path fill="none" stroke="black" d="M35546.7,-941.09C35546.7,-941.09 35546.7,-915.34 35546.7,-915.34"/>
<polygon fill="black" stroke="black" points="35550.2,-915.34 35546.7,-905.34 35543.2,-915.34 35550.2,-915.34"/>
</g>
<!-- layer5_agg_exp9&#45;&gt;layer5_moe_agg -->
<g id="edge380" class="edge">
<title>layer5_agg_exp9&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M35549.7,-831.48C35549.7,-805.37 35549.7,-775 35549.7,-775 35549.7,-775 35043.79,-775 35043.79,-775"/>
<polygon fill="black" stroke="black" points="35043.79,-771.5 35033.79,-775 35043.79,-778.5 35043.79,-771.5"/>
</g>
<!-- layer5_expert10 -->
<g id="node315" class="node">
<title>layer5_expert10</title>
<polygon fill="lightcoral" stroke="black" points="36072.2,-1004.16 35851.2,-1004.16 35851.2,-941.16 36072.2,-941.16 36072.2,-1004.16"/>
<text text-anchor="middle" x="35961.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="35961.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="35961.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="35961.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="35961.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp10&#45;&gt;layer5_expert10 -->
<g id="edge382" class="edge">
<title>layer5_route_exp10&#45;&gt;layer5_expert10</title>
<path fill="none" stroke="black" d="M35961.7,-1039.87C35961.7,-1039.87 35961.7,-1014.41 35961.7,-1014.41"/>
<polygon fill="black" stroke="black" points="35965.2,-1014.41 35961.7,-1004.41 35958.2,-1014.41 35965.2,-1014.41"/>
</g>
<!-- layer5_agg_exp10 -->
<g id="node316" class="node">
<title>layer5_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="35964.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="35964.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="35964.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="35964.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="35964.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert10&#45;&gt;layer5_agg_exp10 -->
<g id="edge383" class="edge">
<title>layer5_expert10&#45;&gt;layer5_agg_exp10</title>
<path fill="none" stroke="black" d="M35961.7,-941.09C35961.7,-941.09 35961.7,-915.34 35961.7,-915.34"/>
<polygon fill="black" stroke="black" points="35965.2,-915.34 35961.7,-905.34 35958.2,-915.34 35965.2,-915.34"/>
</g>
<!-- layer5_agg_exp10&#45;&gt;layer5_moe_agg -->
<g id="edge384" class="edge">
<title>layer5_agg_exp10&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M35964.7,-831.47C35964.7,-803.55 35964.7,-770 35964.7,-770 35964.7,-770 35079.66,-770 35079.66,-770"/>
<polygon fill="black" stroke="black" points="35079.66,-766.5 35069.66,-770 35079.66,-773.5 35079.66,-766.5"/>
</g>
<!-- layer5_expert11 -->
<g id="node318" class="node">
<title>layer5_expert11</title>
<polygon fill="lightcoral" stroke="black" points="36486.2,-1004.16 36265.2,-1004.16 36265.2,-941.16 36486.2,-941.16 36486.2,-1004.16"/>
<text text-anchor="middle" x="36375.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="36375.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="36375.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="36375.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="36375.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp11&#45;&gt;layer5_expert11 -->
<g id="edge386" class="edge">
<title>layer5_route_exp11&#45;&gt;layer5_expert11</title>
<path fill="none" stroke="black" d="M36375.7,-1039.87C36375.7,-1039.87 36375.7,-1014.41 36375.7,-1014.41"/>
<polygon fill="black" stroke="black" points="36379.2,-1014.41 36375.7,-1004.41 36372.2,-1014.41 36379.2,-1014.41"/>
</g>
<!-- layer5_agg_exp11 -->
<g id="node319" class="node">
<title>layer5_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="36379.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="36379.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="36379.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="36379.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="36379.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert11&#45;&gt;layer5_agg_exp11 -->
<g id="edge387" class="edge">
<title>layer5_expert11&#45;&gt;layer5_agg_exp11</title>
<path fill="none" stroke="black" d="M36375.7,-941.09C36375.7,-941.09 36375.7,-915.34 36375.7,-915.34"/>
<polygon fill="black" stroke="black" points="36379.2,-915.34 36375.7,-905.34 36372.2,-915.34 36379.2,-915.34"/>
</g>
<!-- layer5_agg_exp11&#45;&gt;layer5_moe_agg -->
<g id="edge388" class="edge">
<title>layer5_agg_exp11&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M36379.7,-831.35C36379.7,-801.69 36379.7,-765 36379.7,-765 36379.7,-765 35103.73,-765 35103.73,-765"/>
<polygon fill="black" stroke="black" points="35103.73,-761.5 35093.73,-765 35103.73,-768.5 35103.73,-761.5"/>
</g>
<!-- layer5_expert12 -->
<g id="node321" class="node">
<title>layer5_expert12</title>
<polygon fill="lightcoral" stroke="black" points="36895.2,-1004.16 36674.2,-1004.16 36674.2,-941.16 36895.2,-941.16 36895.2,-1004.16"/>
<text text-anchor="middle" x="36784.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="36784.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="36784.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="36784.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="36784.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp12&#45;&gt;layer5_expert12 -->
<g id="edge390" class="edge">
<title>layer5_route_exp12&#45;&gt;layer5_expert12</title>
<path fill="none" stroke="black" d="M36784.7,-1039.87C36784.7,-1039.87 36784.7,-1014.41 36784.7,-1014.41"/>
<polygon fill="black" stroke="black" points="36788.2,-1014.41 36784.7,-1004.41 36781.2,-1014.41 36788.2,-1014.41"/>
</g>
<!-- layer5_agg_exp12 -->
<g id="node322" class="node">
<title>layer5_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="36794.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="36794.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="36794.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="36794.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="36794.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert12&#45;&gt;layer5_agg_exp12 -->
<g id="edge391" class="edge">
<title>layer5_expert12&#45;&gt;layer5_agg_exp12</title>
<path fill="none" stroke="black" d="M36784.7,-941.09C36784.7,-941.09 36784.7,-915.34 36784.7,-915.34"/>
<polygon fill="black" stroke="black" points="36788.2,-915.34 36784.7,-905.34 36781.2,-915.34 36788.2,-915.34"/>
</g>
<!-- layer5_agg_exp12&#45;&gt;layer5_moe_agg -->
<g id="edge392" class="edge">
<title>layer5_agg_exp12&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M36794.7,-831.39C36794.7,-799.99 36794.7,-760 36794.7,-760 36794.7,-760 35120.49,-760 35120.49,-760"/>
<polygon fill="black" stroke="black" points="35120.49,-756.5 35110.49,-760 35120.49,-763.5 35120.49,-756.5"/>
</g>
<!-- layer5_expert13 -->
<g id="node324" class="node">
<title>layer5_expert13</title>
<polygon fill="lightcoral" stroke="black" points="37313.2,-1004.16 37092.2,-1004.16 37092.2,-941.16 37313.2,-941.16 37313.2,-1004.16"/>
<text text-anchor="middle" x="37202.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="37202.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="37202.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="37202.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="37202.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp13&#45;&gt;layer5_expert13 -->
<g id="edge394" class="edge">
<title>layer5_route_exp13&#45;&gt;layer5_expert13</title>
<path fill="none" stroke="black" d="M37202.7,-1040.16C37202.7,-1040.16 37202.7,-1014.25 37202.7,-1014.25"/>
<polygon fill="black" stroke="black" points="37206.2,-1014.25 37202.7,-1004.25 37199.2,-1014.25 37206.2,-1014.25"/>
</g>
<!-- layer5_agg_exp13 -->
<g id="node325" class="node">
<title>layer5_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="37209.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="37209.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="37209.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="37209.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="37209.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert13&#45;&gt;layer5_agg_exp13 -->
<g id="edge395" class="edge">
<title>layer5_expert13&#45;&gt;layer5_agg_exp13</title>
<path fill="none" stroke="black" d="M37202.7,-941.09C37202.7,-941.09 37202.7,-915.34 37202.7,-915.34"/>
<polygon fill="black" stroke="black" points="37206.2,-915.34 37202.7,-905.34 37199.2,-915.34 37206.2,-915.34"/>
</g>
<!-- layer5_agg_exp13&#45;&gt;layer5_moe_agg -->
<g id="edge396" class="edge">
<title>layer5_agg_exp13&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M37209.7,-831.57C37209.7,-798.47 37209.7,-755 37209.7,-755 37209.7,-755 35131.84,-755 35131.84,-755"/>
<polygon fill="black" stroke="black" points="35131.84,-751.5 35121.84,-755 35131.84,-758.5 35131.84,-751.5"/>
</g>
<!-- layer5_expert14 -->
<g id="node327" class="node">
<title>layer5_expert14</title>
<polygon fill="lightcoral" stroke="black" points="37725.2,-1004.16 37504.2,-1004.16 37504.2,-941.16 37725.2,-941.16 37725.2,-1004.16"/>
<text text-anchor="middle" x="37614.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="37614.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="37614.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="37614.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="37614.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp14&#45;&gt;layer5_expert14 -->
<g id="edge398" class="edge">
<title>layer5_route_exp14&#45;&gt;layer5_expert14</title>
<path fill="none" stroke="black" d="M37614.7,-1040.16C37614.7,-1040.16 37614.7,-1014.25 37614.7,-1014.25"/>
<polygon fill="black" stroke="black" points="37618.2,-1014.25 37614.7,-1004.25 37611.2,-1014.25 37618.2,-1014.25"/>
</g>
<!-- layer5_agg_exp14 -->
<g id="node328" class="node">
<title>layer5_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="37624.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="37624.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="37624.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="37624.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="37624.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert14&#45;&gt;layer5_agg_exp14 -->
<g id="edge399" class="edge">
<title>layer5_expert14&#45;&gt;layer5_agg_exp14</title>
<path fill="none" stroke="black" d="M37614.7,-941.09C37614.7,-941.09 37614.7,-915.34 37614.7,-915.34"/>
<polygon fill="black" stroke="black" points="37618.2,-915.34 37614.7,-905.34 37611.2,-915.34 37618.2,-915.34"/>
</g>
<!-- layer5_agg_exp14&#45;&gt;layer5_moe_agg -->
<g id="edge400" class="edge">
<title>layer5_agg_exp14&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M37624.7,-831.58C37624.7,-796.82 37624.7,-750 37624.7,-750 37624.7,-750 35138.66,-750 35138.66,-750"/>
<polygon fill="black" stroke="black" points="35138.66,-746.5 35128.66,-750 35138.66,-753.5 35138.66,-746.5"/>
</g>
<!-- layer5_expert15 -->
<g id="node330" class="node">
<title>layer5_expert15</title>
<polygon fill="lightcoral" stroke="black" points="38142.2,-1004.16 37921.2,-1004.16 37921.2,-941.16 38142.2,-941.16 38142.2,-1004.16"/>
<text text-anchor="middle" x="38031.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="38031.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="38031.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="38031.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="38031.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer5_route_exp15&#45;&gt;layer5_expert15 -->
<g id="edge402" class="edge">
<title>layer5_route_exp15&#45;&gt;layer5_expert15</title>
<path fill="none" stroke="black" d="M38031.7,-1040.16C38031.7,-1040.16 38031.7,-1014.25 38031.7,-1014.25"/>
<polygon fill="black" stroke="black" points="38035.2,-1014.25 38031.7,-1004.25 38028.2,-1014.25 38035.2,-1014.25"/>
</g>
<!-- layer5_agg_exp15 -->
<g id="node331" class="node">
<title>layer5_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="38039.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="38039.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="38039.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="38039.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="38039.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer5_expert15&#45;&gt;layer5_agg_exp15 -->
<g id="edge403" class="edge">
<title>layer5_expert15&#45;&gt;layer5_agg_exp15</title>
<path fill="none" stroke="black" d="M38031.7,-941.09C38031.7,-941.09 38031.7,-915.34 38031.7,-915.34"/>
<polygon fill="black" stroke="black" points="38035.2,-915.34 38031.7,-905.34 38028.2,-915.34 38035.2,-915.34"/>
</g>
<!-- layer5_agg_exp15&#45;&gt;layer5_moe_agg -->
<g id="edge404" class="edge">
<title>layer5_agg_exp15&#45;&gt;layer5_moe_agg</title>
<path fill="none" stroke="black" d="M38039.7,-831.33C38039.7,-795.31 38039.7,-746 38039.7,-746 38039.7,-746 35141.55,-746 35141.55,-746"/>
<polygon fill="black" stroke="black" points="35141.55,-742.5 35131.55,-746 35141.55,-749.5 35141.55,-742.5"/>
</g>
<!-- layer6_ln1 -->
<g id="node333" class="node">
<title>layer6_ln1</title>
<polygon fill="none" stroke="black" points="38387.2,-1227.7 38106.2,-1227.7 38106.2,-1175.7 38387.2,-1175.7 38387.2,-1227.7"/>
<text text-anchor="middle" x="38246.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 6</text>
<text text-anchor="middle" x="38246.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="38246.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="38246.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer6_add1 -->
<g id="node334" class="node">
<title>layer6_add1</title>
<polygon fill="yellow" stroke="black" points="41408.2,-644.85 41127.2,-644.85 41127.2,-592.85 41408.2,-592.85 41408.2,-644.85"/>
<text text-anchor="middle" x="41267.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 6</text>
<text text-anchor="middle" x="41267.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41267.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41267.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_moe_output -->
<g id="node338" class="node">
<title>layer6_moe_output</title>
<polygon fill="yellow" stroke="black" points="41557.2,-540.58 41276.2,-540.58 41276.2,-488.58 41557.2,-488.58 41557.2,-540.58"/>
<text text-anchor="middle" x="41416.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 6</text>
<text text-anchor="middle" x="41416.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41416.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41416.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_add1&#45;&gt;layer6_moe_output -->
<g id="edge474" class="edge">
<title>layer6_add1&#45;&gt;layer6_moe_output</title>
<path fill="none" stroke="black" d="M41342.2,-592.81C41342.2,-592.81 41342.2,-550.65 41342.2,-550.65"/>
<polygon fill="black" stroke="black" points="41345.7,-550.65 41342.2,-540.65 41338.7,-550.65 41345.7,-550.65"/>
</g>
<!-- layer6_gate -->
<g id="node335" class="node">
<title>layer6_gate</title>
<polygon fill="lightgreen" stroke="black" points="41860.13,-1253.7 41401.3,-1253.7 41283.26,-1149.7 41742.1,-1149.7 41860.13,-1253.7"/>
<text text-anchor="middle" x="41571.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 6</text>
<text text-anchor="middle" x="41571.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41571.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="41571.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer6_route_exp0 -->
<g id="node339" class="node">
<title>layer6_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="38455.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="38455.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="38455.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="38455.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="38455.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp0 -->
<g id="edge408" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp0</title>
<path fill="none" stroke="black" d="M41309.39,-1173C40569.31,-1173 38518.32,-1173 38518.32,-1173 38518.32,-1173 38518.32,-1121.88 38518.32,-1121.88"/>
<polygon fill="black" stroke="black" points="38521.82,-1121.88 38518.32,-1111.88 38514.82,-1121.88 38521.82,-1121.88"/>
</g>
<!-- layer6_route_exp1 -->
<g id="node342" class="node">
<title>layer6_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="38900.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="38900.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="38900.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="38900.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="38900.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp1 -->
<g id="edge412" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp1</title>
<path fill="none" stroke="black" d="M41303.98,-1168C40627.08,-1168 38900.7,-1168 38900.7,-1168 38900.7,-1168 38900.7,-1123.71 38900.7,-1123.71"/>
<polygon fill="black" stroke="black" points="38904.2,-1123.71 38900.7,-1113.71 38897.2,-1123.71 38904.2,-1123.71"/>
</g>
<!-- layer6_route_exp2 -->
<g id="node345" class="node">
<title>layer6_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="39325.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="39325.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="39325.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="39325.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="39325.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp2 -->
<g id="edge416" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp2</title>
<path fill="none" stroke="black" d="M41300.5,-1165C40702.98,-1165 39325.7,-1165 39325.7,-1165 39325.7,-1165 39325.7,-1123.77 39325.7,-1123.77"/>
<polygon fill="black" stroke="black" points="39329.2,-1123.77 39325.7,-1113.77 39322.2,-1123.77 39329.2,-1123.77"/>
</g>
<!-- layer6_route_exp3 -->
<g id="node348" class="node">
<title>layer6_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="39740.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="39740.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="39740.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="39740.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="39740.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp3 -->
<g id="edge420" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp3</title>
<path fill="none" stroke="black" d="M41296.09,-1161C40784.76,-1161 39740.7,-1161 39740.7,-1161 39740.7,-1161 39740.7,-1124.05 39740.7,-1124.05"/>
<polygon fill="black" stroke="black" points="39744.2,-1124.05 39740.7,-1114.05 39737.2,-1124.05 39744.2,-1124.05"/>
</g>
<!-- layer6_route_exp4 -->
<g id="node351" class="node">
<title>layer6_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="40150.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="40150.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="40150.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="40150.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="40150.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp4 -->
<g id="edge424" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp4</title>
<path fill="none" stroke="black" d="M41292.65,-1158C40878.82,-1158 40150.7,-1158 40150.7,-1158 40150.7,-1158 40150.7,-1124.14 40150.7,-1124.14"/>
<polygon fill="black" stroke="black" points="40154.2,-1124.14 40150.7,-1114.14 40147.2,-1124.14 40154.2,-1124.14"/>
</g>
<!-- layer6_route_exp5 -->
<g id="node354" class="node">
<title>layer6_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="40557.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="40557.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="40557.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="40557.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="40557.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp5 -->
<g id="edge428" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp5</title>
<path fill="none" stroke="black" d="M41287.89,-1154C40987.92,-1154 40557.7,-1154 40557.7,-1154 40557.7,-1154 40557.7,-1124.11 40557.7,-1124.11"/>
<polygon fill="black" stroke="black" points="40561.2,-1124.11 40557.7,-1114.11 40554.2,-1124.11 40561.2,-1124.11"/>
</g>
<!-- layer6_route_exp6 -->
<g id="node357" class="node">
<title>layer6_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="40963.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="40963.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="40963.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="40963.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="40963.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp6 -->
<g id="edge432" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp6</title>
<path fill="none" stroke="black" d="M41284.61,-1151C41127.19,-1151 40963.7,-1151 40963.7,-1151 40963.7,-1151 40963.7,-1123.96 40963.7,-1123.96"/>
<polygon fill="black" stroke="black" points="40967.2,-1123.96 40963.7,-1113.96 40960.2,-1123.96 40967.2,-1123.96"/>
</g>
<!-- layer6_route_exp7 -->
<g id="node360" class="node">
<title>layer6_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="41369.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="41369.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="41369.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="41369.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41369.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp7 -->
<g id="edge436" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp7</title>
<path fill="none" stroke="black" d="M41423.46,-1149.5C41423.46,-1149.5 41423.46,-1122.25 41423.46,-1122.25"/>
<polygon fill="black" stroke="black" points="41426.96,-1122.25 41423.46,-1112.25 41419.96,-1122.25 41426.96,-1122.25"/>
</g>
<!-- layer6_route_exp8 -->
<g id="node363" class="node">
<title>layer6_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="41774.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="41774.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="41774.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="41774.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41774.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp8 -->
<g id="edge440" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp8</title>
<path fill="none" stroke="black" d="M41720.43,-1149.5C41720.43,-1149.5 41720.43,-1122.25 41720.43,-1122.25"/>
<polygon fill="black" stroke="black" points="41723.93,-1122.25 41720.43,-1112.25 41716.93,-1122.25 41723.93,-1122.25"/>
</g>
<!-- layer6_route_exp9 -->
<g id="node366" class="node">
<title>layer6_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="42182.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="42182.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="42182.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="42182.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="42182.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp9 -->
<g id="edge444" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp9</title>
<path fill="none" stroke="black" d="M41743.93,-1151C41924.63,-1151 42182.7,-1151 42182.7,-1151 42182.7,-1151 42182.7,-1123.96 42182.7,-1123.96"/>
<polygon fill="black" stroke="black" points="42186.2,-1123.96 42182.7,-1113.96 42179.2,-1123.96 42186.2,-1123.96"/>
</g>
<!-- layer6_route_exp10 -->
<g id="node369" class="node">
<title>layer6_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="42592.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="42592.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="42592.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="42592.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="42592.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp10 -->
<g id="edge448" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp10</title>
<path fill="none" stroke="black" d="M41749.54,-1156C42042.06,-1156 42592.7,-1156 42592.7,-1156 42592.7,-1156 42592.7,-1124.15 42592.7,-1124.15"/>
<polygon fill="black" stroke="black" points="42596.2,-1124.15 42592.7,-1114.15 42589.2,-1124.15 42596.2,-1124.15"/>
</g>
<!-- layer6_route_exp11 -->
<g id="node372" class="node">
<title>layer6_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="43003.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="43003.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="43003.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="43003.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="43003.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp11 -->
<g id="edge452" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp11</title>
<path fill="none" stroke="black" d="M41754.15,-1160C42140.02,-1160 43003.7,-1160 43003.7,-1160 43003.7,-1160 43003.7,-1124.09 43003.7,-1124.09"/>
<polygon fill="black" stroke="black" points="43007.2,-1124.09 43003.7,-1114.09 43000.2,-1124.09 43007.2,-1124.09"/>
</g>
<!-- layer6_route_exp12 -->
<g id="node375" class="node">
<title>layer6_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="43416.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="43416.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="43416.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="43416.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="43416.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp12 -->
<g id="edge456" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp12</title>
<path fill="none" stroke="black" d="M41757.48,-1163C42225.64,-1163 43416.7,-1163 43416.7,-1163 43416.7,-1163 43416.7,-1123.93 43416.7,-1123.93"/>
<polygon fill="black" stroke="black" points="43420.2,-1123.93 43416.7,-1113.93 43413.2,-1123.93 43420.2,-1123.93"/>
</g>
<!-- layer6_route_exp13 -->
<g id="node378" class="node">
<title>layer6_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="43833.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="43833.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="43833.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="43833.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="43833.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp13 -->
<g id="edge460" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp13</title>
<path fill="none" stroke="black" d="M41762.12,-1167C42307.04,-1167 43833.7,-1167 43833.7,-1167 43833.7,-1167 43833.7,-1123.82 43833.7,-1123.82"/>
<polygon fill="black" stroke="black" points="43837.2,-1123.82 43833.7,-1113.82 43830.2,-1123.82 43837.2,-1123.82"/>
</g>
<!-- layer6_route_exp14 -->
<g id="node381" class="node">
<title>layer6_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="44248.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="44248.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="44248.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="44248.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="44248.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp14 -->
<g id="edge464" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp14</title>
<path fill="none" stroke="black" d="M41765.3,-1170C42380.22,-1170 44248.7,-1170 44248.7,-1170 44248.7,-1170 44248.7,-1123.71 44248.7,-1123.71"/>
<polygon fill="black" stroke="black" points="44252.2,-1123.71 44248.7,-1113.71 44245.2,-1123.71 44252.2,-1123.71"/>
</g>
<!-- layer6_route_exp15 -->
<g id="node384" class="node">
<title>layer6_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="44662.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="44662.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="44662.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="44662.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="44662.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_route_exp15 -->
<g id="edge468" class="edge">
<title>layer6_gate&#45;&gt;layer6_route_exp15</title>
<path fill="none" stroke="black" d="M41767.58,-1172C42439.64,-1172 44610.57,-1172 44610.57,-1172 44610.57,-1172 44610.57,-1122.6 44610.57,-1122.6"/>
<polygon fill="black" stroke="black" points="44614.07,-1122.6 44610.57,-1112.6 44607.07,-1122.6 44614.07,-1122.6"/>
</g>
<!-- layer6_moe_agg -->
<g id="node336" class="node">
<title>layer6_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="41566.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="41566.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 6</text>
<text text-anchor="middle" x="41566.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41566.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41566.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer6_ln2 -->
<g id="node337" class="node">
<title>layer6_ln2</title>
<polygon fill="none" stroke="black" points="41707.2,-644.85 41426.2,-644.85 41426.2,-592.85 41707.2,-592.85 41707.2,-644.85"/>
<text text-anchor="middle" x="41566.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 6</text>
<text text-anchor="middle" x="41566.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41566.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41566.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer6_moe_agg&#45;&gt;layer6_ln2 -->
<g id="edge472" class="edge">
<title>layer6_moe_agg&#45;&gt;layer6_ln2</title>
<path fill="none" stroke="black" d="M41566.7,-706.52C41566.7,-706.52 41566.7,-654.92 41566.7,-654.92"/>
<polygon fill="black" stroke="black" points="41570.2,-654.92 41566.7,-644.92 41563.2,-654.92 41570.2,-654.92"/>
</g>
<!-- layer6_ln2&#45;&gt;layer6_moe_output -->
<g id="edge473" class="edge">
<title>layer6_ln2&#45;&gt;layer6_moe_output</title>
<path fill="none" stroke="black" d="M41491.7,-592.81C41491.7,-592.81 41491.7,-550.65 41491.7,-550.65"/>
<polygon fill="black" stroke="black" points="41495.2,-550.65 41491.7,-540.65 41488.2,-550.65 41495.2,-550.65"/>
</g>
<!-- layer7_mha -->
<g id="node387" class="node">
<title>layer7_mha</title>
<polygon fill="lightcyan" stroke="black" points="41557.2,-436.31 41276.2,-436.31 41276.2,-384.31 41557.2,-384.31 41557.2,-436.31"/>
<text text-anchor="middle" x="41416.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 7</text>
<text text-anchor="middle" x="41416.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41416.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="41416.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer6_moe_output&#45;&gt;layer7_mha -->
<g id="edge1084" class="edge">
<title>layer6_moe_output&#45;&gt;layer7_mha</title>
<path fill="none" stroke="black" d="M41416.7,-488.54C41416.7,-488.54 41416.7,-446.38 41416.7,-446.38"/>
<polygon fill="black" stroke="black" points="41420.2,-446.38 41416.7,-436.38 41413.2,-446.38 41420.2,-446.38"/>
</g>
<!-- layer6_expert0 -->
<g id="node340" class="node">
<title>layer6_expert0</title>
<polygon fill="lightcoral" stroke="black" points="38566.2,-1004.16 38345.2,-1004.16 38345.2,-941.16 38566.2,-941.16 38566.2,-1004.16"/>
<text text-anchor="middle" x="38455.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="38455.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="38455.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="38455.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="38455.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp0&#45;&gt;layer6_expert0 -->
<g id="edge409" class="edge">
<title>layer6_route_exp0&#45;&gt;layer6_expert0</title>
<path fill="none" stroke="black" d="M38455.7,-1039.87C38455.7,-1039.87 38455.7,-1014.41 38455.7,-1014.41"/>
<polygon fill="black" stroke="black" points="38459.2,-1014.41 38455.7,-1004.41 38452.2,-1014.41 38459.2,-1014.41"/>
</g>
<!-- layer6_agg_exp0 -->
<g id="node341" class="node">
<title>layer6_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="38454.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="38454.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="38454.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="38454.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="38454.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert0&#45;&gt;layer6_agg_exp0 -->
<g id="edge410" class="edge">
<title>layer6_expert0&#45;&gt;layer6_agg_exp0</title>
<path fill="none" stroke="black" d="M38455.7,-941.09C38455.7,-941.09 38455.7,-915.34 38455.7,-915.34"/>
<polygon fill="black" stroke="black" points="38459.2,-915.34 38455.7,-905.34 38452.2,-915.34 38459.2,-915.34"/>
</g>
<!-- layer6_agg_exp0&#45;&gt;layer6_moe_agg -->
<g id="edge411" class="edge">
<title>layer6_agg_exp0&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M38454.7,-831.49C38454.7,-784.97 38454.7,-711 38454.7,-711 38454.7,-711 41461.86,-711 41461.86,-711"/>
<polygon fill="black" stroke="black" points="41461.86,-714.5 41471.86,-711 41461.86,-707.5 41461.86,-714.5"/>
</g>
<!-- layer6_expert1 -->
<g id="node343" class="node">
<title>layer6_expert1</title>
<polygon fill="lightcoral" stroke="black" points="38995.2,-1004.16 38774.2,-1004.16 38774.2,-941.16 38995.2,-941.16 38995.2,-1004.16"/>
<text text-anchor="middle" x="38884.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="38884.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="38884.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="38884.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="38884.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp1&#45;&gt;layer6_expert1 -->
<g id="edge413" class="edge">
<title>layer6_route_exp1&#45;&gt;layer6_expert1</title>
<path fill="none" stroke="black" d="M38884.7,-1040.16C38884.7,-1040.16 38884.7,-1014.25 38884.7,-1014.25"/>
<polygon fill="black" stroke="black" points="38888.2,-1014.25 38884.7,-1004.25 38881.2,-1014.25 38888.2,-1014.25"/>
</g>
<!-- layer6_agg_exp1 -->
<g id="node344" class="node">
<title>layer6_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="38869.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="38869.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="38869.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="38869.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="38869.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert1&#45;&gt;layer6_agg_exp1 -->
<g id="edge414" class="edge">
<title>layer6_expert1&#45;&gt;layer6_agg_exp1</title>
<path fill="none" stroke="black" d="M38884.7,-941.09C38884.7,-941.09 38884.7,-915.34 38884.7,-915.34"/>
<polygon fill="black" stroke="black" points="38888.2,-915.34 38884.7,-905.34 38881.2,-915.34 38888.2,-915.34"/>
</g>
<!-- layer6_agg_exp1&#45;&gt;layer6_moe_agg -->
<g id="edge415" class="edge">
<title>layer6_agg_exp1&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M38869.7,-831.5C38869.7,-786.4 38869.7,-716 38869.7,-716 38869.7,-716 41421.1,-716 41421.1,-716"/>
<polygon fill="black" stroke="black" points="41421.1,-719.5 41431.1,-716 41421.1,-712.5 41421.1,-719.5"/>
</g>
<!-- layer6_expert2 -->
<g id="node346" class="node">
<title>layer6_expert2</title>
<polygon fill="lightcoral" stroke="black" points="39415.2,-1004.16 39194.2,-1004.16 39194.2,-941.16 39415.2,-941.16 39415.2,-1004.16"/>
<text text-anchor="middle" x="39304.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="39304.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="39304.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="39304.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="39304.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp2&#45;&gt;layer6_expert2 -->
<g id="edge417" class="edge">
<title>layer6_route_exp2&#45;&gt;layer6_expert2</title>
<path fill="none" stroke="black" d="M39304.7,-1040.16C39304.7,-1040.16 39304.7,-1014.25 39304.7,-1014.25"/>
<polygon fill="black" stroke="black" points="39308.2,-1014.25 39304.7,-1004.25 39301.2,-1014.25 39308.2,-1014.25"/>
</g>
<!-- layer6_agg_exp2 -->
<g id="node347" class="node">
<title>layer6_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="39284.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="39284.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="39284.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="39284.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="39284.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert2&#45;&gt;layer6_agg_exp2 -->
<g id="edge418" class="edge">
<title>layer6_expert2&#45;&gt;layer6_agg_exp2</title>
<path fill="none" stroke="black" d="M39304.7,-941.09C39304.7,-941.09 39304.7,-914.97 39304.7,-914.97"/>
<polygon fill="black" stroke="black" points="39308.2,-914.97 39304.7,-904.97 39301.2,-914.97 39308.2,-914.97"/>
</g>
<!-- layer6_agg_exp2&#45;&gt;layer6_moe_agg -->
<g id="edge419" class="edge">
<title>layer6_agg_exp2&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M39284.7,-831.58C39284.7,-787.92 39284.7,-721 39284.7,-721 39284.7,-721 41394.87,-721 41394.87,-721"/>
<polygon fill="black" stroke="black" points="41394.87,-724.5 41404.87,-721 41394.87,-717.5 41394.87,-724.5"/>
</g>
<!-- layer6_expert3 -->
<g id="node349" class="node">
<title>layer6_expert3</title>
<polygon fill="lightcoral" stroke="black" points="39830.2,-1004.16 39609.2,-1004.16 39609.2,-941.16 39830.2,-941.16 39830.2,-1004.16"/>
<text text-anchor="middle" x="39719.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="39719.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="39719.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="39719.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="39719.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp3&#45;&gt;layer6_expert3 -->
<g id="edge421" class="edge">
<title>layer6_route_exp3&#45;&gt;layer6_expert3</title>
<path fill="none" stroke="black" d="M39719.7,-1040.16C39719.7,-1040.16 39719.7,-1014.25 39719.7,-1014.25"/>
<polygon fill="black" stroke="black" points="39723.2,-1014.25 39719.7,-1004.25 39716.2,-1014.25 39723.2,-1014.25"/>
</g>
<!-- layer6_agg_exp3 -->
<g id="node350" class="node">
<title>layer6_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="39699.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="39699.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="39699.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="39699.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="39699.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert3&#45;&gt;layer6_agg_exp3 -->
<g id="edge422" class="edge">
<title>layer6_expert3&#45;&gt;layer6_agg_exp3</title>
<path fill="none" stroke="black" d="M39719.7,-941.09C39719.7,-941.09 39719.7,-914.97 39719.7,-914.97"/>
<polygon fill="black" stroke="black" points="39723.2,-914.97 39719.7,-904.97 39716.2,-914.97 39723.2,-914.97"/>
</g>
<!-- layer6_agg_exp3&#45;&gt;layer6_moe_agg -->
<g id="edge423" class="edge">
<title>layer6_agg_exp3&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M39699.7,-831.35C39699.7,-789.16 39699.7,-726 39699.7,-726 39699.7,-726 41376.41,-726 41376.41,-726"/>
<polygon fill="black" stroke="black" points="41376.41,-729.5 41386.41,-726 41376.41,-722.5 41376.41,-729.5"/>
</g>
<!-- layer6_expert4 -->
<g id="node352" class="node">
<title>layer6_expert4</title>
<polygon fill="lightcoral" stroke="black" points="40243.2,-1004.16 40022.2,-1004.16 40022.2,-941.16 40243.2,-941.16 40243.2,-1004.16"/>
<text text-anchor="middle" x="40132.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="40132.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="40132.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="40132.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="40132.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp4&#45;&gt;layer6_expert4 -->
<g id="edge425" class="edge">
<title>layer6_route_exp4&#45;&gt;layer6_expert4</title>
<path fill="none" stroke="black" d="M40132.7,-1040.16C40132.7,-1040.16 40132.7,-1014.25 40132.7,-1014.25"/>
<polygon fill="black" stroke="black" points="40136.2,-1014.25 40132.7,-1004.25 40129.2,-1014.25 40136.2,-1014.25"/>
</g>
<!-- layer6_agg_exp4 -->
<g id="node353" class="node">
<title>layer6_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="40114.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="40114.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="40114.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="40114.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="40114.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert4&#45;&gt;layer6_agg_exp4 -->
<g id="edge426" class="edge">
<title>layer6_expert4&#45;&gt;layer6_agg_exp4</title>
<path fill="none" stroke="black" d="M40132.7,-941.09C40132.7,-941.09 40132.7,-915.34 40132.7,-915.34"/>
<polygon fill="black" stroke="black" points="40136.2,-915.34 40132.7,-905.34 40129.2,-915.34 40136.2,-915.34"/>
</g>
<!-- layer6_agg_exp4&#45;&gt;layer6_moe_agg -->
<g id="edge427" class="edge">
<title>layer6_agg_exp4&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M40114.7,-831.57C40114.7,-790.87 40114.7,-731 40114.7,-731 40114.7,-731 41363.88,-731 41363.88,-731"/>
<polygon fill="black" stroke="black" points="41363.88,-734.5 41373.88,-731 41363.88,-727.5 41363.88,-734.5"/>
</g>
<!-- layer6_expert5 -->
<g id="node355" class="node">
<title>layer6_expert5</title>
<polygon fill="lightcoral" stroke="black" points="40654.2,-1004.16 40433.2,-1004.16 40433.2,-941.16 40654.2,-941.16 40654.2,-1004.16"/>
<text text-anchor="middle" x="40543.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="40543.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="40543.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="40543.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="40543.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp5&#45;&gt;layer6_expert5 -->
<g id="edge429" class="edge">
<title>layer6_route_exp5&#45;&gt;layer6_expert5</title>
<path fill="none" stroke="black" d="M40543.7,-1040.16C40543.7,-1040.16 40543.7,-1014.25 40543.7,-1014.25"/>
<polygon fill="black" stroke="black" points="40547.2,-1014.25 40543.7,-1004.25 40540.2,-1014.25 40547.2,-1014.25"/>
</g>
<!-- layer6_agg_exp5 -->
<g id="node356" class="node">
<title>layer6_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="40529.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="40529.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="40529.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="40529.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="40529.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert5&#45;&gt;layer6_agg_exp5 -->
<g id="edge430" class="edge">
<title>layer6_expert5&#45;&gt;layer6_agg_exp5</title>
<path fill="none" stroke="black" d="M40543.7,-941.09C40543.7,-941.09 40543.7,-915.34 40543.7,-915.34"/>
<polygon fill="black" stroke="black" points="40547.2,-915.34 40543.7,-905.34 40540.2,-915.34 40547.2,-915.34"/>
</g>
<!-- layer6_agg_exp5&#45;&gt;layer6_moe_agg -->
<g id="edge431" class="edge">
<title>layer6_agg_exp5&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M40529.7,-831.51C40529.7,-792.34 40529.7,-736 40529.7,-736 40529.7,-736 41355.83,-736 41355.83,-736"/>
<polygon fill="black" stroke="black" points="41355.83,-739.5 41365.83,-736 41355.83,-732.5 41355.83,-739.5"/>
</g>
<!-- layer6_expert6 -->
<g id="node358" class="node">
<title>layer6_expert6</title>
<polygon fill="lightcoral" stroke="black" points="41064.2,-1004.16 40843.2,-1004.16 40843.2,-941.16 41064.2,-941.16 41064.2,-1004.16"/>
<text text-anchor="middle" x="40953.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="40953.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="40953.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="40953.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="40953.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp6&#45;&gt;layer6_expert6 -->
<g id="edge433" class="edge">
<title>layer6_route_exp6&#45;&gt;layer6_expert6</title>
<path fill="none" stroke="black" d="M40953.7,-1040.16C40953.7,-1040.16 40953.7,-1014.25 40953.7,-1014.25"/>
<polygon fill="black" stroke="black" points="40957.2,-1014.25 40953.7,-1004.25 40950.2,-1014.25 40957.2,-1014.25"/>
</g>
<!-- layer6_agg_exp6 -->
<g id="node359" class="node">
<title>layer6_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="40944.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="40944.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="40944.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="40944.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="40944.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert6&#45;&gt;layer6_agg_exp6 -->
<g id="edge434" class="edge">
<title>layer6_expert6&#45;&gt;layer6_agg_exp6</title>
<path fill="none" stroke="black" d="M40953.7,-941.09C40953.7,-941.09 40953.7,-915.34 40953.7,-915.34"/>
<polygon fill="black" stroke="black" points="40957.2,-915.34 40953.7,-905.34 40950.2,-915.34 40957.2,-915.34"/>
</g>
<!-- layer6_agg_exp6&#45;&gt;layer6_moe_agg -->
<g id="edge435" class="edge">
<title>layer6_agg_exp6&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M41135.3,-857.96C41135.3,-827.54 41135.3,-741 41135.3,-741 41135.3,-741 41352.05,-741 41352.05,-741"/>
<polygon fill="black" stroke="black" points="41352.05,-744.5 41362.05,-741 41352.05,-737.5 41352.05,-744.5"/>
</g>
<!-- layer6_expert7 -->
<g id="node361" class="node">
<title>layer6_expert7</title>
<polygon fill="lightcoral" stroke="black" points="41475.2,-1004.16 41254.2,-1004.16 41254.2,-941.16 41475.2,-941.16 41475.2,-1004.16"/>
<text text-anchor="middle" x="41364.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="41364.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="41364.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="41364.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="41364.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp7&#45;&gt;layer6_expert7 -->
<g id="edge437" class="edge">
<title>layer6_route_exp7&#45;&gt;layer6_expert7</title>
<path fill="none" stroke="black" d="M41364.7,-1040.16C41364.7,-1040.16 41364.7,-1014.25 41364.7,-1014.25"/>
<polygon fill="black" stroke="black" points="41368.2,-1014.25 41364.7,-1004.25 41361.2,-1014.25 41368.2,-1014.25"/>
</g>
<!-- layer6_agg_exp7 -->
<g id="node362" class="node">
<title>layer6_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="41359.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="41359.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="41359.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="41359.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="41359.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert7&#45;&gt;layer6_agg_exp7 -->
<g id="edge438" class="edge">
<title>layer6_expert7&#45;&gt;layer6_agg_exp7</title>
<path fill="none" stroke="black" d="M41364.7,-941.09C41364.7,-941.09 41364.7,-915.34 41364.7,-915.34"/>
<polygon fill="black" stroke="black" points="41368.2,-915.34 41364.7,-905.34 41361.2,-915.34 41368.2,-915.34"/>
</g>
<!-- layer6_agg_exp7&#45;&gt;layer6_moe_agg -->
<g id="edge439" class="edge">
<title>layer6_agg_exp7&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M41460.02,-836.58C41460.02,-836.58 41460.02,-785.37 41460.02,-785.37"/>
<polygon fill="black" stroke="black" points="41463.52,-785.37 41460.02,-775.37 41456.52,-785.37 41463.52,-785.37"/>
</g>
<!-- layer6_expert8 -->
<g id="node364" class="node">
<title>layer6_expert8</title>
<polygon fill="lightcoral" stroke="black" points="41885.2,-1004.16 41664.2,-1004.16 41664.2,-941.16 41885.2,-941.16 41885.2,-1004.16"/>
<text text-anchor="middle" x="41774.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="41774.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="41774.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="41774.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="41774.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp8&#45;&gt;layer6_expert8 -->
<g id="edge441" class="edge">
<title>layer6_route_exp8&#45;&gt;layer6_expert8</title>
<path fill="none" stroke="black" d="M41774.7,-1039.87C41774.7,-1039.87 41774.7,-1014.41 41774.7,-1014.41"/>
<polygon fill="black" stroke="black" points="41778.2,-1014.41 41774.7,-1004.41 41771.2,-1014.41 41778.2,-1014.41"/>
</g>
<!-- layer6_agg_exp8 -->
<g id="node365" class="node">
<title>layer6_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="41774.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="41774.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="41774.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="41774.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="41774.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert8&#45;&gt;layer6_agg_exp8 -->
<g id="edge442" class="edge">
<title>layer6_expert8&#45;&gt;layer6_agg_exp8</title>
<path fill="none" stroke="black" d="M41774.7,-941.09C41774.7,-941.09 41774.7,-915.34 41774.7,-915.34"/>
<polygon fill="black" stroke="black" points="41778.2,-915.34 41774.7,-905.34 41771.2,-915.34 41778.2,-915.34"/>
</g>
<!-- layer6_agg_exp8&#45;&gt;layer6_moe_agg -->
<g id="edge443" class="edge">
<title>layer6_agg_exp8&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M41673.88,-836.58C41673.88,-836.58 41673.88,-785.37 41673.88,-785.37"/>
<polygon fill="black" stroke="black" points="41677.38,-785.37 41673.88,-775.37 41670.38,-785.37 41677.38,-785.37"/>
</g>
<!-- layer6_expert9 -->
<g id="node367" class="node">
<title>layer6_expert9</title>
<polygon fill="lightcoral" stroke="black" points="42295.2,-1004.16 42074.2,-1004.16 42074.2,-941.16 42295.2,-941.16 42295.2,-1004.16"/>
<text text-anchor="middle" x="42184.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="42184.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="42184.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="42184.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="42184.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp9&#45;&gt;layer6_expert9 -->
<g id="edge445" class="edge">
<title>layer6_route_exp9&#45;&gt;layer6_expert9</title>
<path fill="none" stroke="black" d="M42184.7,-1039.87C42184.7,-1039.87 42184.7,-1014.41 42184.7,-1014.41"/>
<polygon fill="black" stroke="black" points="42188.2,-1014.41 42184.7,-1004.41 42181.2,-1014.41 42188.2,-1014.41"/>
</g>
<!-- layer6_agg_exp9 -->
<g id="node368" class="node">
<title>layer6_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="42189.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="42189.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="42189.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="42189.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="42189.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert9&#45;&gt;layer6_agg_exp9 -->
<g id="edge446" class="edge">
<title>layer6_expert9&#45;&gt;layer6_agg_exp9</title>
<path fill="none" stroke="black" d="M42184.7,-941.09C42184.7,-941.09 42184.7,-915.34 42184.7,-915.34"/>
<polygon fill="black" stroke="black" points="42188.2,-915.34 42184.7,-905.34 42181.2,-915.34 42188.2,-915.34"/>
</g>
<!-- layer6_agg_exp9&#45;&gt;layer6_moe_agg -->
<g id="edge447" class="edge">
<title>layer6_agg_exp9&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M42189.7,-831.54C42189.7,-793.92 42189.7,-741 42189.7,-741 42189.7,-741 41781.55,-741 41781.55,-741"/>
<polygon fill="black" stroke="black" points="41781.55,-737.5 41771.55,-741 41781.55,-744.5 41781.55,-737.5"/>
</g>
<!-- layer6_expert10 -->
<g id="node370" class="node">
<title>layer6_expert10</title>
<polygon fill="lightcoral" stroke="black" points="42709.2,-1004.16 42488.2,-1004.16 42488.2,-941.16 42709.2,-941.16 42709.2,-1004.16"/>
<text text-anchor="middle" x="42598.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="42598.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="42598.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="42598.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="42598.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp10&#45;&gt;layer6_expert10 -->
<g id="edge449" class="edge">
<title>layer6_route_exp10&#45;&gt;layer6_expert10</title>
<path fill="none" stroke="black" d="M42598.7,-1040.16C42598.7,-1040.16 42598.7,-1014.25 42598.7,-1014.25"/>
<polygon fill="black" stroke="black" points="42602.2,-1014.25 42598.7,-1004.25 42595.2,-1014.25 42602.2,-1014.25"/>
</g>
<!-- layer6_agg_exp10 -->
<g id="node371" class="node">
<title>layer6_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="42604.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="42604.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="42604.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="42604.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="42604.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert10&#45;&gt;layer6_agg_exp10 -->
<g id="edge450" class="edge">
<title>layer6_expert10&#45;&gt;layer6_agg_exp10</title>
<path fill="none" stroke="black" d="M42598.7,-941.09C42598.7,-941.09 42598.7,-915.34 42598.7,-915.34"/>
<polygon fill="black" stroke="black" points="42602.2,-915.34 42598.7,-905.34 42595.2,-915.34 42602.2,-915.34"/>
</g>
<!-- layer6_agg_exp10&#45;&gt;layer6_moe_agg -->
<g id="edge451" class="edge">
<title>layer6_agg_exp10&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M42604.7,-831.51C42604.7,-792.34 42604.7,-736 42604.7,-736 42604.7,-736 41777.45,-736 41777.45,-736"/>
<polygon fill="black" stroke="black" points="41777.45,-732.5 41767.45,-736 41777.45,-739.5 41777.45,-732.5"/>
</g>
<!-- layer6_expert11 -->
<g id="node373" class="node">
<title>layer6_expert11</title>
<polygon fill="lightcoral" stroke="black" points="43120.2,-1004.16 42899.2,-1004.16 42899.2,-941.16 43120.2,-941.16 43120.2,-1004.16"/>
<text text-anchor="middle" x="43009.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="43009.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="43009.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="43009.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="43009.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp11&#45;&gt;layer6_expert11 -->
<g id="edge453" class="edge">
<title>layer6_route_exp11&#45;&gt;layer6_expert11</title>
<path fill="none" stroke="black" d="M43009.7,-1040.16C43009.7,-1040.16 43009.7,-1014.25 43009.7,-1014.25"/>
<polygon fill="black" stroke="black" points="43013.2,-1014.25 43009.7,-1004.25 43006.2,-1014.25 43013.2,-1014.25"/>
</g>
<!-- layer6_agg_exp11 -->
<g id="node374" class="node">
<title>layer6_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="43019.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="43019.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="43019.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="43019.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="43019.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert11&#45;&gt;layer6_agg_exp11 -->
<g id="edge454" class="edge">
<title>layer6_expert11&#45;&gt;layer6_agg_exp11</title>
<path fill="none" stroke="black" d="M43009.7,-941.09C43009.7,-941.09 43009.7,-915.34 43009.7,-915.34"/>
<polygon fill="black" stroke="black" points="43013.2,-915.34 43009.7,-905.34 43006.2,-915.34 43013.2,-915.34"/>
</g>
<!-- layer6_agg_exp11&#45;&gt;layer6_moe_agg -->
<g id="edge455" class="edge">
<title>layer6_agg_exp11&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M43019.7,-831.57C43019.7,-790.87 43019.7,-731 43019.7,-731 43019.7,-731 41769.64,-731 41769.64,-731"/>
<polygon fill="black" stroke="black" points="41769.64,-727.5 41759.64,-731 41769.64,-734.5 41769.64,-727.5"/>
</g>
<!-- layer6_expert12 -->
<g id="node376" class="node">
<title>layer6_expert12</title>
<polygon fill="lightcoral" stroke="black" points="43535.2,-1004.16 43314.2,-1004.16 43314.2,-941.16 43535.2,-941.16 43535.2,-1004.16"/>
<text text-anchor="middle" x="43424.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="43424.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="43424.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="43424.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="43424.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp12&#45;&gt;layer6_expert12 -->
<g id="edge457" class="edge">
<title>layer6_route_exp12&#45;&gt;layer6_expert12</title>
<path fill="none" stroke="black" d="M43424.7,-1040.16C43424.7,-1040.16 43424.7,-1014.25 43424.7,-1014.25"/>
<polygon fill="black" stroke="black" points="43428.2,-1014.25 43424.7,-1004.25 43421.2,-1014.25 43428.2,-1014.25"/>
</g>
<!-- layer6_agg_exp12 -->
<g id="node377" class="node">
<title>layer6_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="43434.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="43434.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="43434.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="43434.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="43434.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert12&#45;&gt;layer6_agg_exp12 -->
<g id="edge458" class="edge">
<title>layer6_expert12&#45;&gt;layer6_agg_exp12</title>
<path fill="none" stroke="black" d="M43424.7,-941.09C43424.7,-941.09 43424.7,-915.34 43424.7,-915.34"/>
<polygon fill="black" stroke="black" points="43428.2,-915.34 43424.7,-905.34 43421.2,-915.34 43428.2,-915.34"/>
</g>
<!-- layer6_agg_exp12&#45;&gt;layer6_moe_agg -->
<g id="edge459" class="edge">
<title>layer6_agg_exp12&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M43434.7,-831.35C43434.7,-789.16 43434.7,-726 43434.7,-726 43434.7,-726 41757.08,-726 41757.08,-726"/>
<polygon fill="black" stroke="black" points="41757.08,-722.5 41747.08,-726 41757.08,-729.5 41757.08,-722.5"/>
</g>
<!-- layer6_expert13 -->
<g id="node379" class="node">
<title>layer6_expert13</title>
<polygon fill="lightcoral" stroke="black" points="43949.2,-1004.16 43728.2,-1004.16 43728.2,-941.16 43949.2,-941.16 43949.2,-1004.16"/>
<text text-anchor="middle" x="43838.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="43838.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="43838.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="43838.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="43838.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp13&#45;&gt;layer6_expert13 -->
<g id="edge461" class="edge">
<title>layer6_route_exp13&#45;&gt;layer6_expert13</title>
<path fill="none" stroke="black" d="M43838.7,-1040.16C43838.7,-1040.16 43838.7,-1014.25 43838.7,-1014.25"/>
<polygon fill="black" stroke="black" points="43842.2,-1014.25 43838.7,-1004.25 43835.2,-1014.25 43842.2,-1014.25"/>
</g>
<!-- layer6_agg_exp13 -->
<g id="node380" class="node">
<title>layer6_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="43849.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="43849.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="43849.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="43849.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="43849.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert13&#45;&gt;layer6_agg_exp13 -->
<g id="edge462" class="edge">
<title>layer6_expert13&#45;&gt;layer6_agg_exp13</title>
<path fill="none" stroke="black" d="M43838.7,-941.09C43838.7,-941.09 43838.7,-915.34 43838.7,-915.34"/>
<polygon fill="black" stroke="black" points="43842.2,-915.34 43838.7,-905.34 43835.2,-915.34 43842.2,-915.34"/>
</g>
<!-- layer6_agg_exp13&#45;&gt;layer6_moe_agg -->
<g id="edge463" class="edge">
<title>layer6_agg_exp13&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M43849.7,-831.58C43849.7,-787.92 43849.7,-721 43849.7,-721 43849.7,-721 41738.6,-721 41738.6,-721"/>
<polygon fill="black" stroke="black" points="41738.6,-717.5 41728.6,-721 41738.6,-724.5 41738.6,-717.5"/>
</g>
<!-- layer6_expert14 -->
<g id="node382" class="node">
<title>layer6_expert14</title>
<polygon fill="lightcoral" stroke="black" points="44366.2,-1004.16 44145.2,-1004.16 44145.2,-941.16 44366.2,-941.16 44366.2,-1004.16"/>
<text text-anchor="middle" x="44255.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="44255.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="44255.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="44255.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="44255.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp14&#45;&gt;layer6_expert14 -->
<g id="edge465" class="edge">
<title>layer6_route_exp14&#45;&gt;layer6_expert14</title>
<path fill="none" stroke="black" d="M44255.7,-1040.16C44255.7,-1040.16 44255.7,-1014.25 44255.7,-1014.25"/>
<polygon fill="black" stroke="black" points="44259.2,-1014.25 44255.7,-1004.25 44252.2,-1014.25 44259.2,-1014.25"/>
</g>
<!-- layer6_agg_exp14 -->
<g id="node383" class="node">
<title>layer6_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="44264.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="44264.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="44264.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="44264.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="44264.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert14&#45;&gt;layer6_agg_exp14 -->
<g id="edge466" class="edge">
<title>layer6_expert14&#45;&gt;layer6_agg_exp14</title>
<path fill="none" stroke="black" d="M44255.7,-941.09C44255.7,-941.09 44255.7,-915.34 44255.7,-915.34"/>
<polygon fill="black" stroke="black" points="44259.2,-915.34 44255.7,-905.34 44252.2,-915.34 44259.2,-915.34"/>
</g>
<!-- layer6_agg_exp14&#45;&gt;layer6_moe_agg -->
<g id="edge467" class="edge">
<title>layer6_agg_exp14&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M44264.7,-831.5C44264.7,-786.4 44264.7,-716 44264.7,-716 44264.7,-716 41712.34,-716 41712.34,-716"/>
<polygon fill="black" stroke="black" points="41712.34,-712.5 41702.34,-716 41712.34,-719.5 41712.34,-712.5"/>
</g>
<!-- layer6_expert15 -->
<g id="node385" class="node">
<title>layer6_expert15</title>
<polygon fill="lightcoral" stroke="black" points="44782.2,-1004.16 44561.2,-1004.16 44561.2,-941.16 44782.2,-941.16 44782.2,-1004.16"/>
<text text-anchor="middle" x="44671.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="44671.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="44671.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="44671.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="44671.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer6_route_exp15&#45;&gt;layer6_expert15 -->
<g id="edge469" class="edge">
<title>layer6_route_exp15&#45;&gt;layer6_expert15</title>
<path fill="none" stroke="black" d="M44671.7,-1040.16C44671.7,-1040.16 44671.7,-1014.25 44671.7,-1014.25"/>
<polygon fill="black" stroke="black" points="44675.2,-1014.25 44671.7,-1004.25 44668.2,-1014.25 44675.2,-1014.25"/>
</g>
<!-- layer6_agg_exp15 -->
<g id="node386" class="node">
<title>layer6_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="44679.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="44679.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="44679.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="44679.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="44679.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer6_expert15&#45;&gt;layer6_agg_exp15 -->
<g id="edge470" class="edge">
<title>layer6_expert15&#45;&gt;layer6_agg_exp15</title>
<path fill="none" stroke="black" d="M44671.7,-941.09C44671.7,-941.09 44671.7,-915.34 44671.7,-915.34"/>
<polygon fill="black" stroke="black" points="44675.2,-915.34 44671.7,-905.34 44668.2,-915.34 44675.2,-915.34"/>
</g>
<!-- layer6_agg_exp15&#45;&gt;layer6_moe_agg -->
<g id="edge471" class="edge">
<title>layer6_agg_exp15&#45;&gt;layer6_moe_agg</title>
<path fill="none" stroke="black" d="M44679.7,-831.49C44679.7,-784.97 44679.7,-711 44679.7,-711 44679.7,-711 41671.56,-711 41671.56,-711"/>
<polygon fill="black" stroke="black" points="41671.56,-707.5 41661.56,-711 41671.56,-714.5 41671.56,-707.5"/>
</g>
<!-- layer7_ln1 -->
<g id="node388" class="node">
<title>layer7_ln1</title>
<polygon fill="none" stroke="black" points="45033.2,-1227.7 44752.2,-1227.7 44752.2,-1175.7 45033.2,-1175.7 45033.2,-1227.7"/>
<text text-anchor="middle" x="44892.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 7</text>
<text text-anchor="middle" x="44892.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="44892.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="44892.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer7_add1 -->
<g id="node389" class="node">
<title>layer7_add1</title>
<polygon fill="yellow" stroke="black" points="48049.2,-644.85 47768.2,-644.85 47768.2,-592.85 48049.2,-592.85 48049.2,-644.85"/>
<text text-anchor="middle" x="47908.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 7</text>
<text text-anchor="middle" x="47908.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="47908.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="47908.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_moe_output -->
<g id="node393" class="node">
<title>layer7_moe_output</title>
<polygon fill="yellow" stroke="black" points="48199.2,-540.58 47918.2,-540.58 47918.2,-488.58 48199.2,-488.58 48199.2,-540.58"/>
<text text-anchor="middle" x="48058.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 7</text>
<text text-anchor="middle" x="48058.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48058.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48058.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_add1&#45;&gt;layer7_moe_output -->
<g id="edge541" class="edge">
<title>layer7_add1&#45;&gt;layer7_moe_output</title>
<path fill="none" stroke="black" d="M47983.7,-592.81C47983.7,-592.81 47983.7,-550.65 47983.7,-550.65"/>
<polygon fill="black" stroke="black" points="47987.2,-550.65 47983.7,-540.65 47980.2,-550.65 47987.2,-550.65"/>
</g>
<!-- layer7_gate -->
<g id="node390" class="node">
<title>layer7_gate</title>
<polygon fill="lightgreen" stroke="black" points="48496.13,-1253.7 48037.3,-1253.7 47919.26,-1149.7 48378.1,-1149.7 48496.13,-1253.7"/>
<text text-anchor="middle" x="48207.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 7</text>
<text text-anchor="middle" x="48207.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48207.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="48207.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer7_route_exp0 -->
<g id="node394" class="node">
<title>layer7_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="45098.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="45098.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="45098.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="45098.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="45098.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp0 -->
<g id="edge475" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp0</title>
<path fill="none" stroke="black" d="M47945.46,-1173C47206.88,-1173 45162.82,-1173 45162.82,-1173 45162.82,-1173 45162.82,-1121.88 45162.82,-1121.88"/>
<polygon fill="black" stroke="black" points="45166.32,-1121.88 45162.82,-1111.88 45159.32,-1121.88 45166.32,-1121.88"/>
</g>
<!-- layer7_route_exp1 -->
<g id="node397" class="node">
<title>layer7_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="45538.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="45538.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="45538.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="45538.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="45538.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp1 -->
<g id="edge479" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp1</title>
<path fill="none" stroke="black" d="M47939.87,-1168C47263.26,-1168 45538.7,-1168 45538.7,-1168 45538.7,-1168 45538.7,-1123.71 45538.7,-1123.71"/>
<polygon fill="black" stroke="black" points="45542.2,-1123.71 45538.7,-1113.71 45535.2,-1123.71 45542.2,-1123.71"/>
</g>
<!-- layer7_route_exp2 -->
<g id="node400" class="node">
<title>layer7_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="45960.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="45960.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="45960.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="45960.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="45960.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp2 -->
<g id="edge483" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp2</title>
<path fill="none" stroke="black" d="M47936.38,-1165C47338.59,-1165 45960.7,-1165 45960.7,-1165 45960.7,-1165 45960.7,-1123.77 45960.7,-1123.77"/>
<polygon fill="black" stroke="black" points="45964.2,-1123.77 45960.7,-1113.77 45957.2,-1123.77 45964.2,-1123.77"/>
</g>
<!-- layer7_route_exp3 -->
<g id="node403" class="node">
<title>layer7_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="46374.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="46374.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="46374.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="46374.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="46374.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp3 -->
<g id="edge487" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp3</title>
<path fill="none" stroke="black" d="M47931.79,-1161C47419.9,-1161 46374.7,-1161 46374.7,-1161 46374.7,-1161 46374.7,-1124.05 46374.7,-1124.05"/>
<polygon fill="black" stroke="black" points="46378.2,-1124.05 46374.7,-1114.05 46371.2,-1124.05 46378.2,-1124.05"/>
</g>
<!-- layer7_route_exp4 -->
<g id="node406" class="node">
<title>layer7_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="46783.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="46783.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="46783.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="46783.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="46783.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp4 -->
<g id="edge491" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp4</title>
<path fill="none" stroke="black" d="M47928.48,-1158C47513.85,-1158 46783.7,-1158 46783.7,-1158 46783.7,-1158 46783.7,-1124.14 46783.7,-1124.14"/>
<polygon fill="black" stroke="black" points="46787.2,-1124.14 46783.7,-1114.14 46780.2,-1124.14 46787.2,-1124.14"/>
</g>
<!-- layer7_route_exp5 -->
<g id="node409" class="node">
<title>layer7_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="47190.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="47190.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="47190.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="47190.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="47190.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp5 -->
<g id="edge495" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp5</title>
<path fill="none" stroke="black" d="M47924.07,-1154C47623.16,-1154 47190.7,-1154 47190.7,-1154 47190.7,-1154 47190.7,-1124.11 47190.7,-1124.11"/>
<polygon fill="black" stroke="black" points="47194.2,-1124.11 47190.7,-1114.11 47187.2,-1124.11 47194.2,-1124.11"/>
</g>
<!-- layer7_route_exp6 -->
<g id="node412" class="node">
<title>layer7_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="47596.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="47596.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="47596.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="47596.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="47596.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp6 -->
<g id="edge499" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp6</title>
<path fill="none" stroke="black" d="M47922.77,-1153C47763.48,-1153 47596.7,-1153 47596.7,-1153 47596.7,-1153 47596.7,-1124.07 47596.7,-1124.07"/>
<polygon fill="black" stroke="black" points="47600.2,-1124.07 47596.7,-1114.07 47593.2,-1124.07 47600.2,-1124.07"/>
</g>
<!-- layer7_route_exp7 -->
<g id="node415" class="node">
<title>layer7_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="48002.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="48002.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="48002.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="48002.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48002.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp7 -->
<g id="edge503" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp7</title>
<path fill="none" stroke="black" d="M48057.96,-1149.5C48057.96,-1149.5 48057.96,-1122.25 48057.96,-1122.25"/>
<polygon fill="black" stroke="black" points="48061.46,-1122.25 48057.96,-1112.25 48054.46,-1122.25 48061.46,-1122.25"/>
</g>
<!-- layer7_route_exp8 -->
<g id="node418" class="node">
<title>layer7_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="48412.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="48412.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="48412.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="48412.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48412.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp8 -->
<g id="edge507" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp8</title>
<path fill="none" stroke="black" d="M48357.43,-1149.5C48357.43,-1149.5 48357.43,-1122.25 48357.43,-1122.25"/>
<polygon fill="black" stroke="black" points="48360.93,-1122.25 48357.43,-1112.25 48353.93,-1122.25 48360.93,-1122.25"/>
</g>
<!-- layer7_route_exp9 -->
<g id="node421" class="node">
<title>layer7_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="48824.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="48824.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="48824.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="48824.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48824.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp9 -->
<g id="edge511" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp9</title>
<path fill="none" stroke="black" d="M48382.03,-1153C48564.48,-1153 48824.7,-1153 48824.7,-1153 48824.7,-1153 48824.7,-1124.07 48824.7,-1124.07"/>
<polygon fill="black" stroke="black" points="48828.2,-1124.07 48824.7,-1114.07 48821.2,-1124.07 48828.2,-1124.07"/>
</g>
<!-- layer7_route_exp10 -->
<g id="node424" class="node">
<title>layer7_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="49238.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="49238.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="49238.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="49238.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="49238.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp10 -->
<g id="edge515" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp10</title>
<path fill="none" stroke="black" d="M48385.52,-1156C48680.45,-1156 49238.7,-1156 49238.7,-1156 49238.7,-1156 49238.7,-1124.15 49238.7,-1124.15"/>
<polygon fill="black" stroke="black" points="49242.2,-1124.15 49238.7,-1114.15 49235.2,-1124.15 49242.2,-1124.15"/>
</g>
<!-- layer7_route_exp11 -->
<g id="node427" class="node">
<title>layer7_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="49652.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="49652.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="49652.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="49652.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="49652.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp11 -->
<g id="edge519" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp11</title>
<path fill="none" stroke="black" d="M48389.98,-1160C48778.44,-1160 49652.7,-1160 49652.7,-1160 49652.7,-1160 49652.7,-1124.09 49652.7,-1124.09"/>
<polygon fill="black" stroke="black" points="49656.2,-1124.09 49652.7,-1114.09 49649.2,-1124.09 49656.2,-1124.09"/>
</g>
<!-- layer7_route_exp12 -->
<g id="node430" class="node">
<title>layer7_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="50067.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="50067.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="50067.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="50067.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="50067.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp12 -->
<g id="edge523" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp12</title>
<path fill="none" stroke="black" d="M48393.27,-1163C48864.04,-1163 50067.7,-1163 50067.7,-1163 50067.7,-1163 50067.7,-1123.93 50067.7,-1123.93"/>
<polygon fill="black" stroke="black" points="50071.2,-1123.93 50067.7,-1113.93 50064.2,-1123.93 50071.2,-1123.93"/>
</g>
<!-- layer7_route_exp13 -->
<g id="node433" class="node">
<title>layer7_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="50482.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="50482.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="50482.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="50482.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="50482.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp13 -->
<g id="edge527" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp13</title>
<path fill="none" stroke="black" d="M48395.81,-1165C48940.87,-1165 50482.7,-1165 50482.7,-1165 50482.7,-1165 50482.7,-1123.77 50482.7,-1123.77"/>
<polygon fill="black" stroke="black" points="50486.2,-1123.77 50482.7,-1113.77 50479.2,-1123.77 50486.2,-1123.77"/>
</g>
<!-- layer7_route_exp14 -->
<g id="node436" class="node">
<title>layer7_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="50897.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="50897.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="50897.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="50897.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="50897.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp14 -->
<g id="edge531" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp14</title>
<path fill="none" stroke="black" d="M48401.16,-1170C49017.95,-1170 50897.7,-1170 50897.7,-1170 50897.7,-1170 50897.7,-1123.71 50897.7,-1123.71"/>
<polygon fill="black" stroke="black" points="50901.2,-1123.71 50897.7,-1113.71 50894.2,-1123.71 50901.2,-1123.71"/>
</g>
<!-- layer7_route_exp15 -->
<g id="node439" class="node">
<title>layer7_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="51306.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="51306.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="51306.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="51306.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="51306.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_route_exp15 -->
<g id="edge535" class="edge">
<title>layer7_gate&#45;&gt;layer7_route_exp15</title>
<path fill="none" stroke="black" d="M48403.51,-1172C49076.01,-1172 51250.07,-1172 51250.07,-1172 51250.07,-1172 51250.07,-1122.33 51250.07,-1122.33"/>
<polygon fill="black" stroke="black" points="51253.57,-1122.33 51250.07,-1112.33 51246.57,-1122.33 51253.57,-1122.33"/>
</g>
<!-- layer7_moe_agg -->
<g id="node391" class="node">
<title>layer7_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="48207.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="48207.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 7</text>
<text text-anchor="middle" x="48207.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48207.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48207.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer7_ln2 -->
<g id="node392" class="node">
<title>layer7_ln2</title>
<polygon fill="none" stroke="black" points="48348.2,-644.85 48067.2,-644.85 48067.2,-592.85 48348.2,-592.85 48348.2,-644.85"/>
<text text-anchor="middle" x="48207.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 7</text>
<text text-anchor="middle" x="48207.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48207.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48207.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer7_moe_agg&#45;&gt;layer7_ln2 -->
<g id="edge539" class="edge">
<title>layer7_moe_agg&#45;&gt;layer7_ln2</title>
<path fill="none" stroke="black" d="M48207.7,-706.52C48207.7,-706.52 48207.7,-654.92 48207.7,-654.92"/>
<polygon fill="black" stroke="black" points="48211.2,-654.92 48207.7,-644.92 48204.2,-654.92 48211.2,-654.92"/>
</g>
<!-- layer7_ln2&#45;&gt;layer7_moe_output -->
<g id="edge540" class="edge">
<title>layer7_ln2&#45;&gt;layer7_moe_output</title>
<path fill="none" stroke="black" d="M48133.2,-592.81C48133.2,-592.81 48133.2,-550.65 48133.2,-550.65"/>
<polygon fill="black" stroke="black" points="48136.7,-550.65 48133.2,-540.65 48129.7,-550.65 48136.7,-550.65"/>
</g>
<!-- layer8_mha -->
<g id="node442" class="node">
<title>layer8_mha</title>
<polygon fill="lightcyan" stroke="black" points="48199.2,-436.31 47918.2,-436.31 47918.2,-384.31 48199.2,-384.31 48199.2,-436.31"/>
<text text-anchor="middle" x="48058.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 8</text>
<text text-anchor="middle" x="48058.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48058.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="48058.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer7_moe_output&#45;&gt;layer8_mha -->
<g id="edge1085" class="edge">
<title>layer7_moe_output&#45;&gt;layer8_mha</title>
<path fill="none" stroke="black" d="M48058.7,-488.54C48058.7,-488.54 48058.7,-446.38 48058.7,-446.38"/>
<polygon fill="black" stroke="black" points="48062.2,-446.38 48058.7,-436.38 48055.2,-446.38 48062.2,-446.38"/>
</g>
<!-- layer7_expert0 -->
<g id="node395" class="node">
<title>layer7_expert0</title>
<polygon fill="lightcoral" stroke="black" points="45206.2,-1004.16 44985.2,-1004.16 44985.2,-941.16 45206.2,-941.16 45206.2,-1004.16"/>
<text text-anchor="middle" x="45095.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="45095.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="45095.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="45095.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="45095.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp0&#45;&gt;layer7_expert0 -->
<g id="edge476" class="edge">
<title>layer7_route_exp0&#45;&gt;layer7_expert0</title>
<path fill="none" stroke="black" d="M45095.7,-1039.87C45095.7,-1039.87 45095.7,-1014.41 45095.7,-1014.41"/>
<polygon fill="black" stroke="black" points="45099.2,-1014.41 45095.7,-1004.41 45092.2,-1014.41 45099.2,-1014.41"/>
</g>
<!-- layer7_agg_exp0 -->
<g id="node396" class="node">
<title>layer7_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="45094.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="45094.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="45094.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="45094.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="45094.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert0&#45;&gt;layer7_agg_exp0 -->
<g id="edge477" class="edge">
<title>layer7_expert0&#45;&gt;layer7_agg_exp0</title>
<path fill="none" stroke="black" d="M45095.7,-941.09C45095.7,-941.09 45095.7,-915.34 45095.7,-915.34"/>
<polygon fill="black" stroke="black" points="45099.2,-915.34 45095.7,-905.34 45092.2,-915.34 45099.2,-915.34"/>
</g>
<!-- layer7_agg_exp0&#45;&gt;layer7_moe_agg -->
<g id="edge478" class="edge">
<title>layer7_agg_exp0&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M45094.7,-831.33C45094.7,-795.31 45094.7,-746 45094.7,-746 45094.7,-746 47992.84,-746 47992.84,-746"/>
<polygon fill="black" stroke="black" points="47992.84,-749.5 48002.84,-746 47992.84,-742.5 47992.84,-749.5"/>
</g>
<!-- layer7_expert1 -->
<g id="node398" class="node">
<title>layer7_expert1</title>
<polygon fill="lightcoral" stroke="black" points="45634.2,-1004.16 45413.2,-1004.16 45413.2,-941.16 45634.2,-941.16 45634.2,-1004.16"/>
<text text-anchor="middle" x="45523.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="45523.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="45523.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="45523.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="45523.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp1&#45;&gt;layer7_expert1 -->
<g id="edge480" class="edge">
<title>layer7_route_exp1&#45;&gt;layer7_expert1</title>
<path fill="none" stroke="black" d="M45523.7,-1040.16C45523.7,-1040.16 45523.7,-1014.25 45523.7,-1014.25"/>
<polygon fill="black" stroke="black" points="45527.2,-1014.25 45523.7,-1004.25 45520.2,-1014.25 45527.2,-1014.25"/>
</g>
<!-- layer7_agg_exp1 -->
<g id="node399" class="node">
<title>layer7_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="45509.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="45509.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="45509.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="45509.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="45509.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert1&#45;&gt;layer7_agg_exp1 -->
<g id="edge481" class="edge">
<title>layer7_expert1&#45;&gt;layer7_agg_exp1</title>
<path fill="none" stroke="black" d="M45523.7,-941.09C45523.7,-941.09 45523.7,-915.34 45523.7,-915.34"/>
<polygon fill="black" stroke="black" points="45527.2,-915.34 45523.7,-905.34 45520.2,-915.34 45527.2,-915.34"/>
</g>
<!-- layer7_agg_exp1&#45;&gt;layer7_moe_agg -->
<g id="edge482" class="edge">
<title>layer7_agg_exp1&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M45509.7,-831.58C45509.7,-796.82 45509.7,-750 45509.7,-750 45509.7,-750 47995.74,-750 47995.74,-750"/>
<polygon fill="black" stroke="black" points="47995.74,-753.5 48005.74,-750 47995.74,-746.5 47995.74,-753.5"/>
</g>
<!-- layer7_expert2 -->
<g id="node401" class="node">
<title>layer7_expert2</title>
<polygon fill="lightcoral" stroke="black" points="46052.2,-1004.16 45831.2,-1004.16 45831.2,-941.16 46052.2,-941.16 46052.2,-1004.16"/>
<text text-anchor="middle" x="45941.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="45941.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="45941.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="45941.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="45941.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp2&#45;&gt;layer7_expert2 -->
<g id="edge484" class="edge">
<title>layer7_route_exp2&#45;&gt;layer7_expert2</title>
<path fill="none" stroke="black" d="M45941.7,-1040.16C45941.7,-1040.16 45941.7,-1014.25 45941.7,-1014.25"/>
<polygon fill="black" stroke="black" points="45945.2,-1014.25 45941.7,-1004.25 45938.2,-1014.25 45945.2,-1014.25"/>
</g>
<!-- layer7_agg_exp2 -->
<g id="node402" class="node">
<title>layer7_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="45924.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="45924.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="45924.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="45924.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="45924.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert2&#45;&gt;layer7_agg_exp2 -->
<g id="edge485" class="edge">
<title>layer7_expert2&#45;&gt;layer7_agg_exp2</title>
<path fill="none" stroke="black" d="M45941.7,-941.09C45941.7,-941.09 45941.7,-915.34 45941.7,-915.34"/>
<polygon fill="black" stroke="black" points="45945.2,-915.34 45941.7,-905.34 45938.2,-915.34 45945.2,-915.34"/>
</g>
<!-- layer7_agg_exp2&#45;&gt;layer7_moe_agg -->
<g id="edge486" class="edge">
<title>layer7_agg_exp2&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M45924.7,-831.57C45924.7,-798.47 45924.7,-755 45924.7,-755 45924.7,-755 48002.56,-755 48002.56,-755"/>
<polygon fill="black" stroke="black" points="48002.56,-758.5 48012.56,-755 48002.56,-751.5 48002.56,-758.5"/>
</g>
<!-- layer7_expert3 -->
<g id="node404" class="node">
<title>layer7_expert3</title>
<polygon fill="lightcoral" stroke="black" points="46467.2,-1004.16 46246.2,-1004.16 46246.2,-941.16 46467.2,-941.16 46467.2,-1004.16"/>
<text text-anchor="middle" x="46356.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="46356.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="46356.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="46356.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="46356.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp3&#45;&gt;layer7_expert3 -->
<g id="edge488" class="edge">
<title>layer7_route_exp3&#45;&gt;layer7_expert3</title>
<path fill="none" stroke="black" d="M46356.7,-1040.16C46356.7,-1040.16 46356.7,-1014.25 46356.7,-1014.25"/>
<polygon fill="black" stroke="black" points="46360.2,-1014.25 46356.7,-1004.25 46353.2,-1014.25 46360.2,-1014.25"/>
</g>
<!-- layer7_agg_exp3 -->
<g id="node405" class="node">
<title>layer7_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="46339.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="46339.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="46339.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="46339.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="46339.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert3&#45;&gt;layer7_agg_exp3 -->
<g id="edge489" class="edge">
<title>layer7_expert3&#45;&gt;layer7_agg_exp3</title>
<path fill="none" stroke="black" d="M46356.7,-941.09C46356.7,-941.09 46356.7,-915.34 46356.7,-915.34"/>
<polygon fill="black" stroke="black" points="46360.2,-915.34 46356.7,-905.34 46353.2,-915.34 46360.2,-915.34"/>
</g>
<!-- layer7_agg_exp3&#45;&gt;layer7_moe_agg -->
<g id="edge490" class="edge">
<title>layer7_agg_exp3&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M46339.7,-831.39C46339.7,-799.99 46339.7,-760 46339.7,-760 46339.7,-760 48013.9,-760 48013.9,-760"/>
<polygon fill="black" stroke="black" points="48013.9,-763.5 48023.9,-760 48013.9,-756.5 48013.9,-763.5"/>
</g>
<!-- layer7_expert4 -->
<g id="node407" class="node">
<title>layer7_expert4</title>
<polygon fill="lightcoral" stroke="black" points="46879.2,-1004.16 46658.2,-1004.16 46658.2,-941.16 46879.2,-941.16 46879.2,-1004.16"/>
<text text-anchor="middle" x="46768.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="46768.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="46768.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="46768.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="46768.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp4&#45;&gt;layer7_expert4 -->
<g id="edge492" class="edge">
<title>layer7_route_exp4&#45;&gt;layer7_expert4</title>
<path fill="none" stroke="black" d="M46768.7,-1040.16C46768.7,-1040.16 46768.7,-1014.25 46768.7,-1014.25"/>
<polygon fill="black" stroke="black" points="46772.2,-1014.25 46768.7,-1004.25 46765.2,-1014.25 46772.2,-1014.25"/>
</g>
<!-- layer7_agg_exp4 -->
<g id="node408" class="node">
<title>layer7_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="46754.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="46754.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="46754.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="46754.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="46754.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert4&#45;&gt;layer7_agg_exp4 -->
<g id="edge493" class="edge">
<title>layer7_expert4&#45;&gt;layer7_agg_exp4</title>
<path fill="none" stroke="black" d="M46768.7,-941.09C46768.7,-941.09 46768.7,-915.34 46768.7,-915.34"/>
<polygon fill="black" stroke="black" points="46772.2,-915.34 46768.7,-905.34 46765.2,-915.34 46772.2,-915.34"/>
</g>
<!-- layer7_agg_exp4&#45;&gt;layer7_moe_agg -->
<g id="edge494" class="edge">
<title>layer7_agg_exp4&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M46754.7,-831.35C46754.7,-801.69 46754.7,-765 46754.7,-765 46754.7,-765 48030.67,-765 48030.67,-765"/>
<polygon fill="black" stroke="black" points="48030.67,-768.5 48040.67,-765 48030.66,-761.5 48030.67,-768.5"/>
</g>
<!-- layer7_expert5 -->
<g id="node410" class="node">
<title>layer7_expert5</title>
<polygon fill="lightcoral" stroke="black" points="47290.2,-1004.16 47069.2,-1004.16 47069.2,-941.16 47290.2,-941.16 47290.2,-1004.16"/>
<text text-anchor="middle" x="47179.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="47179.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="47179.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="47179.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="47179.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp5&#45;&gt;layer7_expert5 -->
<g id="edge496" class="edge">
<title>layer7_route_exp5&#45;&gt;layer7_expert5</title>
<path fill="none" stroke="black" d="M47179.7,-1040.16C47179.7,-1040.16 47179.7,-1014.25 47179.7,-1014.25"/>
<polygon fill="black" stroke="black" points="47183.2,-1014.25 47179.7,-1004.25 47176.2,-1014.25 47183.2,-1014.25"/>
</g>
<!-- layer7_agg_exp5 -->
<g id="node411" class="node">
<title>layer7_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="47169.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="47169.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="47169.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="47169.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="47169.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert5&#45;&gt;layer7_agg_exp5 -->
<g id="edge497" class="edge">
<title>layer7_expert5&#45;&gt;layer7_agg_exp5</title>
<path fill="none" stroke="black" d="M47179.7,-941.09C47179.7,-941.09 47179.7,-915.34 47179.7,-915.34"/>
<polygon fill="black" stroke="black" points="47183.2,-915.34 47179.7,-905.34 47176.2,-915.34 47183.2,-915.34"/>
</g>
<!-- layer7_agg_exp5&#45;&gt;layer7_moe_agg -->
<g id="edge498" class="edge">
<title>layer7_agg_exp5&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M47169.7,-831.47C47169.7,-803.55 47169.7,-770 47169.7,-770 47169.7,-770 48054.73,-770 48054.73,-770"/>
<polygon fill="black" stroke="black" points="48054.73,-773.5 48064.73,-770 48054.73,-766.5 48054.73,-773.5"/>
</g>
<!-- layer7_expert6 -->
<g id="node413" class="node">
<title>layer7_expert6</title>
<polygon fill="lightcoral" stroke="black" points="47703.2,-1004.16 47482.2,-1004.16 47482.2,-941.16 47703.2,-941.16 47703.2,-1004.16"/>
<text text-anchor="middle" x="47592.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="47592.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="47592.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="47592.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="47592.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp6&#45;&gt;layer7_expert6 -->
<g id="edge500" class="edge">
<title>layer7_route_exp6&#45;&gt;layer7_expert6</title>
<path fill="none" stroke="black" d="M47592.7,-1039.87C47592.7,-1039.87 47592.7,-1014.41 47592.7,-1014.41"/>
<polygon fill="black" stroke="black" points="47596.2,-1014.41 47592.7,-1004.41 47589.2,-1014.41 47596.2,-1014.41"/>
</g>
<!-- layer7_agg_exp6 -->
<g id="node414" class="node">
<title>layer7_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="47584.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="47584.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="47584.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="47584.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="47584.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert6&#45;&gt;layer7_agg_exp6 -->
<g id="edge501" class="edge">
<title>layer7_expert6&#45;&gt;layer7_agg_exp6</title>
<path fill="none" stroke="black" d="M47592.7,-941.09C47592.7,-941.09 47592.7,-915.34 47592.7,-915.34"/>
<polygon fill="black" stroke="black" points="47596.2,-915.34 47592.7,-905.34 47589.2,-915.34 47596.2,-915.34"/>
</g>
<!-- layer7_agg_exp6&#45;&gt;layer7_moe_agg -->
<g id="edge502" class="edge">
<title>layer7_agg_exp6&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M47775.8,-858.04C47775.8,-833.72 47775.8,-775 47775.8,-775 47775.8,-775 48090.66,-775 48090.66,-775"/>
<polygon fill="black" stroke="black" points="48090.66,-778.5 48100.66,-775 48090.66,-771.5 48090.66,-778.5"/>
</g>
<!-- layer7_expert7 -->
<g id="node416" class="node">
<title>layer7_expert7</title>
<polygon fill="lightcoral" stroke="black" points="48111.2,-1004.16 47890.2,-1004.16 47890.2,-941.16 48111.2,-941.16 48111.2,-1004.16"/>
<text text-anchor="middle" x="48000.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="48000.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="48000.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="48000.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="48000.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp7&#45;&gt;layer7_expert7 -->
<g id="edge504" class="edge">
<title>layer7_route_exp7&#45;&gt;layer7_expert7</title>
<path fill="none" stroke="black" d="M48000.7,-1039.87C48000.7,-1039.87 48000.7,-1014.41 48000.7,-1014.41"/>
<polygon fill="black" stroke="black" points="48004.2,-1014.41 48000.7,-1004.41 47997.2,-1014.41 48004.2,-1014.41"/>
</g>
<!-- layer7_agg_exp7 -->
<g id="node417" class="node">
<title>layer7_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="47999.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="47999.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="47999.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="47999.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="47999.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert7&#45;&gt;layer7_agg_exp7 -->
<g id="edge505" class="edge">
<title>layer7_expert7&#45;&gt;layer7_agg_exp7</title>
<path fill="none" stroke="black" d="M48000.7,-941.09C48000.7,-941.09 48000.7,-915.34 48000.7,-915.34"/>
<polygon fill="black" stroke="black" points="48004.2,-915.34 48000.7,-905.34 47997.2,-915.34 48004.2,-915.34"/>
</g>
<!-- layer7_agg_exp7&#45;&gt;layer7_moe_agg -->
<g id="edge506" class="edge">
<title>layer7_agg_exp7&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M48100.52,-836.58C48100.52,-836.58 48100.52,-785.37 48100.52,-785.37"/>
<polygon fill="black" stroke="black" points="48104.02,-785.37 48100.52,-775.37 48097.02,-785.37 48104.02,-785.37"/>
</g>
<!-- layer7_expert8 -->
<g id="node419" class="node">
<title>layer7_expert8</title>
<polygon fill="lightcoral" stroke="black" points="48524.2,-1004.16 48303.2,-1004.16 48303.2,-941.16 48524.2,-941.16 48524.2,-1004.16"/>
<text text-anchor="middle" x="48413.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="48413.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="48413.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="48413.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="48413.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp8&#45;&gt;layer7_expert8 -->
<g id="edge508" class="edge">
<title>layer7_route_exp8&#45;&gt;layer7_expert8</title>
<path fill="none" stroke="black" d="M48413.7,-1039.87C48413.7,-1039.87 48413.7,-1014.41 48413.7,-1014.41"/>
<polygon fill="black" stroke="black" points="48417.2,-1014.41 48413.7,-1004.41 48410.2,-1014.41 48417.2,-1014.41"/>
</g>
<!-- layer7_agg_exp8 -->
<g id="node420" class="node">
<title>layer7_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="48414.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="48414.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="48414.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="48414.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="48414.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert8&#45;&gt;layer7_agg_exp8 -->
<g id="edge509" class="edge">
<title>layer7_expert8&#45;&gt;layer7_agg_exp8</title>
<path fill="none" stroke="black" d="M48413.7,-941.09C48413.7,-941.09 48413.7,-915.34 48413.7,-915.34"/>
<polygon fill="black" stroke="black" points="48417.2,-915.34 48413.7,-905.34 48410.2,-915.34 48417.2,-915.34"/>
</g>
<!-- layer7_agg_exp8&#45;&gt;layer7_moe_agg -->
<g id="edge510" class="edge">
<title>layer7_agg_exp8&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M48314.38,-836.58C48314.38,-836.58 48314.38,-785.37 48314.38,-785.37"/>
<polygon fill="black" stroke="black" points="48317.88,-785.37 48314.38,-775.37 48310.88,-785.37 48317.88,-785.37"/>
</g>
<!-- layer7_expert9 -->
<g id="node422" class="node">
<title>layer7_expert9</title>
<polygon fill="lightcoral" stroke="black" points="48937.2,-1004.16 48716.2,-1004.16 48716.2,-941.16 48937.2,-941.16 48937.2,-1004.16"/>
<text text-anchor="middle" x="48826.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="48826.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="48826.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="48826.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="48826.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp9&#45;&gt;layer7_expert9 -->
<g id="edge512" class="edge">
<title>layer7_route_exp9&#45;&gt;layer7_expert9</title>
<path fill="none" stroke="black" d="M48826.7,-1039.87C48826.7,-1039.87 48826.7,-1014.41 48826.7,-1014.41"/>
<polygon fill="black" stroke="black" points="48830.2,-1014.41 48826.7,-1004.41 48823.2,-1014.41 48830.2,-1014.41"/>
</g>
<!-- layer7_agg_exp9 -->
<g id="node423" class="node">
<title>layer7_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="48829.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="48829.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="48829.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="48829.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="48829.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert9&#45;&gt;layer7_agg_exp9 -->
<g id="edge513" class="edge">
<title>layer7_expert9&#45;&gt;layer7_agg_exp9</title>
<path fill="none" stroke="black" d="M48826.7,-941.09C48826.7,-941.09 48826.7,-915.34 48826.7,-915.34"/>
<polygon fill="black" stroke="black" points="48830.2,-915.34 48826.7,-905.34 48823.2,-915.34 48830.2,-915.34"/>
</g>
<!-- layer7_agg_exp9&#45;&gt;layer7_moe_agg -->
<g id="edge514" class="edge">
<title>layer7_agg_exp9&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M48829.7,-831.54C48829.7,-793.92 48829.7,-741 48829.7,-741 48829.7,-741 48422.66,-741 48422.66,-741"/>
<polygon fill="black" stroke="black" points="48422.66,-737.5 48412.66,-741 48422.66,-744.5 48422.66,-737.5"/>
</g>
<!-- layer7_expert10 -->
<g id="node425" class="node">
<title>layer7_expert10</title>
<polygon fill="lightcoral" stroke="black" points="49352.2,-1004.16 49131.2,-1004.16 49131.2,-941.16 49352.2,-941.16 49352.2,-1004.16"/>
<text text-anchor="middle" x="49241.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="49241.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="49241.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="49241.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="49241.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp10&#45;&gt;layer7_expert10 -->
<g id="edge516" class="edge">
<title>layer7_route_exp10&#45;&gt;layer7_expert10</title>
<path fill="none" stroke="black" d="M49241.7,-1039.87C49241.7,-1039.87 49241.7,-1014.41 49241.7,-1014.41"/>
<polygon fill="black" stroke="black" points="49245.2,-1014.41 49241.7,-1004.41 49238.2,-1014.41 49245.2,-1014.41"/>
</g>
<!-- layer7_agg_exp10 -->
<g id="node426" class="node">
<title>layer7_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="49244.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="49244.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="49244.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="49244.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="49244.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert10&#45;&gt;layer7_agg_exp10 -->
<g id="edge517" class="edge">
<title>layer7_expert10&#45;&gt;layer7_agg_exp10</title>
<path fill="none" stroke="black" d="M49241.7,-941.09C49241.7,-941.09 49241.7,-915.34 49241.7,-915.34"/>
<polygon fill="black" stroke="black" points="49245.2,-915.34 49241.7,-905.34 49238.2,-915.34 49245.2,-915.34"/>
</g>
<!-- layer7_agg_exp10&#45;&gt;layer7_moe_agg -->
<g id="edge518" class="edge">
<title>layer7_agg_exp10&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M49244.7,-831.51C49244.7,-792.34 49244.7,-736 49244.7,-736 49244.7,-736 48418.56,-736 48418.56,-736"/>
<polygon fill="black" stroke="black" points="48418.56,-732.5 48408.56,-736 48418.56,-739.5 48418.56,-732.5"/>
</g>
<!-- layer7_expert11 -->
<g id="node428" class="node">
<title>layer7_expert11</title>
<polygon fill="lightcoral" stroke="black" points="49766.2,-1004.16 49545.2,-1004.16 49545.2,-941.16 49766.2,-941.16 49766.2,-1004.16"/>
<text text-anchor="middle" x="49655.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="49655.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="49655.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="49655.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="49655.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp11&#45;&gt;layer7_expert11 -->
<g id="edge520" class="edge">
<title>layer7_route_exp11&#45;&gt;layer7_expert11</title>
<path fill="none" stroke="black" d="M49655.7,-1039.87C49655.7,-1039.87 49655.7,-1014.41 49655.7,-1014.41"/>
<polygon fill="black" stroke="black" points="49659.2,-1014.41 49655.7,-1004.41 49652.2,-1014.41 49659.2,-1014.41"/>
</g>
<!-- layer7_agg_exp11 -->
<g id="node429" class="node">
<title>layer7_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="49659.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="49659.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="49659.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="49659.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="49659.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert11&#45;&gt;layer7_agg_exp11 -->
<g id="edge521" class="edge">
<title>layer7_expert11&#45;&gt;layer7_agg_exp11</title>
<path fill="none" stroke="black" d="M49655.7,-941.09C49655.7,-941.09 49655.7,-915.34 49655.7,-915.34"/>
<polygon fill="black" stroke="black" points="49659.2,-915.34 49655.7,-905.34 49652.2,-915.34 49659.2,-915.34"/>
</g>
<!-- layer7_agg_exp11&#45;&gt;layer7_moe_agg -->
<g id="edge522" class="edge">
<title>layer7_agg_exp11&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M49659.7,-831.57C49659.7,-790.87 49659.7,-731 49659.7,-731 49659.7,-731 48410.51,-731 48410.51,-731"/>
<polygon fill="black" stroke="black" points="48410.51,-727.5 48400.51,-731 48410.51,-734.5 48410.51,-727.5"/>
</g>
<!-- layer7_expert12 -->
<g id="node431" class="node">
<title>layer7_expert12</title>
<polygon fill="lightcoral" stroke="black" points="50181.2,-1004.16 49960.2,-1004.16 49960.2,-941.16 50181.2,-941.16 50181.2,-1004.16"/>
<text text-anchor="middle" x="50070.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="50070.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="50070.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="50070.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="50070.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp12&#45;&gt;layer7_expert12 -->
<g id="edge524" class="edge">
<title>layer7_route_exp12&#45;&gt;layer7_expert12</title>
<path fill="none" stroke="black" d="M50070.7,-1039.87C50070.7,-1039.87 50070.7,-1014.41 50070.7,-1014.41"/>
<polygon fill="black" stroke="black" points="50074.2,-1014.41 50070.7,-1004.41 50067.2,-1014.41 50074.2,-1014.41"/>
</g>
<!-- layer7_agg_exp12 -->
<g id="node432" class="node">
<title>layer7_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="50074.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="50074.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="50074.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="50074.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="50074.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert12&#45;&gt;layer7_agg_exp12 -->
<g id="edge525" class="edge">
<title>layer7_expert12&#45;&gt;layer7_agg_exp12</title>
<path fill="none" stroke="black" d="M50070.7,-941.09C50070.7,-941.09 50070.7,-915.34 50070.7,-915.34"/>
<polygon fill="black" stroke="black" points="50074.2,-915.34 50070.7,-905.34 50067.2,-915.34 50074.2,-915.34"/>
</g>
<!-- layer7_agg_exp12&#45;&gt;layer7_moe_agg -->
<g id="edge526" class="edge">
<title>layer7_agg_exp12&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M50074.7,-831.35C50074.7,-789.16 50074.7,-726 50074.7,-726 50074.7,-726 48397.98,-726 48397.98,-726"/>
<polygon fill="black" stroke="black" points="48397.98,-722.5 48387.98,-726 48397.98,-729.5 48397.98,-722.5"/>
</g>
<!-- layer7_expert13 -->
<g id="node434" class="node">
<title>layer7_expert13</title>
<polygon fill="lightcoral" stroke="black" points="50597.2,-1004.16 50376.2,-1004.16 50376.2,-941.16 50597.2,-941.16 50597.2,-1004.16"/>
<text text-anchor="middle" x="50486.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="50486.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="50486.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="50486.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="50486.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp13&#45;&gt;layer7_expert13 -->
<g id="edge528" class="edge">
<title>layer7_route_exp13&#45;&gt;layer7_expert13</title>
<path fill="none" stroke="black" d="M50486.7,-1039.87C50486.7,-1039.87 50486.7,-1014.41 50486.7,-1014.41"/>
<polygon fill="black" stroke="black" points="50490.2,-1014.41 50486.7,-1004.41 50483.2,-1014.41 50490.2,-1014.41"/>
</g>
<!-- layer7_agg_exp13 -->
<g id="node435" class="node">
<title>layer7_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="50489.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="50489.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="50489.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="50489.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="50489.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert13&#45;&gt;layer7_agg_exp13 -->
<g id="edge529" class="edge">
<title>layer7_expert13&#45;&gt;layer7_agg_exp13</title>
<path fill="none" stroke="black" d="M50486.7,-941.09C50486.7,-941.09 50486.7,-915.34 50486.7,-915.34"/>
<polygon fill="black" stroke="black" points="50490.2,-915.34 50486.7,-905.34 50483.2,-915.34 50490.2,-915.34"/>
</g>
<!-- layer7_agg_exp13&#45;&gt;layer7_moe_agg -->
<g id="edge530" class="edge">
<title>layer7_agg_exp13&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M50489.7,-831.58C50489.7,-787.92 50489.7,-721 50489.7,-721 50489.7,-721 48379.53,-721 48379.53,-721"/>
<polygon fill="black" stroke="black" points="48379.53,-717.5 48369.53,-721 48379.53,-724.5 48379.53,-717.5"/>
</g>
<!-- layer7_expert14 -->
<g id="node437" class="node">
<title>layer7_expert14</title>
<polygon fill="lightcoral" stroke="black" points="51011.2,-1004.16 50790.2,-1004.16 50790.2,-941.16 51011.2,-941.16 51011.2,-1004.16"/>
<text text-anchor="middle" x="50900.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="50900.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="50900.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="50900.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="50900.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp14&#45;&gt;layer7_expert14 -->
<g id="edge532" class="edge">
<title>layer7_route_exp14&#45;&gt;layer7_expert14</title>
<path fill="none" stroke="black" d="M50900.7,-1039.87C50900.7,-1039.87 50900.7,-1014.41 50900.7,-1014.41"/>
<polygon fill="black" stroke="black" points="50904.2,-1014.41 50900.7,-1004.41 50897.2,-1014.41 50904.2,-1014.41"/>
</g>
<!-- layer7_agg_exp14 -->
<g id="node438" class="node">
<title>layer7_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="50904.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="50904.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="50904.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="50904.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="50904.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert14&#45;&gt;layer7_agg_exp14 -->
<g id="edge533" class="edge">
<title>layer7_expert14&#45;&gt;layer7_agg_exp14</title>
<path fill="none" stroke="black" d="M50900.7,-941.09C50900.7,-941.09 50900.7,-915.34 50900.7,-915.34"/>
<polygon fill="black" stroke="black" points="50904.2,-915.34 50900.7,-905.34 50897.2,-915.34 50904.2,-915.34"/>
</g>
<!-- layer7_agg_exp14&#45;&gt;layer7_moe_agg -->
<g id="edge534" class="edge">
<title>layer7_agg_exp14&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M50904.7,-831.5C50904.7,-786.4 50904.7,-716 50904.7,-716 50904.7,-716 48353.29,-716 48353.29,-716"/>
<polygon fill="black" stroke="black" points="48353.29,-712.5 48343.29,-716 48353.29,-719.5 48353.29,-712.5"/>
</g>
<!-- layer7_expert15 -->
<g id="node440" class="node">
<title>layer7_expert15</title>
<polygon fill="lightcoral" stroke="black" points="51420.2,-1004.16 51199.2,-1004.16 51199.2,-941.16 51420.2,-941.16 51420.2,-1004.16"/>
<text text-anchor="middle" x="51309.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="51309.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="51309.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="51309.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="51309.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer7_route_exp15&#45;&gt;layer7_expert15 -->
<g id="edge536" class="edge">
<title>layer7_route_exp15&#45;&gt;layer7_expert15</title>
<path fill="none" stroke="black" d="M51309.7,-1039.87C51309.7,-1039.87 51309.7,-1014.41 51309.7,-1014.41"/>
<polygon fill="black" stroke="black" points="51313.2,-1014.41 51309.7,-1004.41 51306.2,-1014.41 51313.2,-1014.41"/>
</g>
<!-- layer7_agg_exp15 -->
<g id="node441" class="node">
<title>layer7_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="51319.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="51319.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="51319.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="51319.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="51319.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer7_expert15&#45;&gt;layer7_agg_exp15 -->
<g id="edge537" class="edge">
<title>layer7_expert15&#45;&gt;layer7_agg_exp15</title>
<path fill="none" stroke="black" d="M51309.7,-941.09C51309.7,-941.09 51309.7,-915.34 51309.7,-915.34"/>
<polygon fill="black" stroke="black" points="51313.2,-915.34 51309.7,-905.34 51306.2,-915.34 51313.2,-915.34"/>
</g>
<!-- layer7_agg_exp15&#45;&gt;layer7_moe_agg -->
<g id="edge538" class="edge">
<title>layer7_agg_exp15&#45;&gt;layer7_moe_agg</title>
<path fill="none" stroke="black" d="M51319.7,-831.49C51319.7,-784.97 51319.7,-711 51319.7,-711 51319.7,-711 48312.53,-711 48312.53,-711"/>
<polygon fill="black" stroke="black" points="48312.53,-707.5 48302.53,-711 48312.53,-714.5 48312.53,-707.5"/>
</g>
<!-- layer8_ln1 -->
<g id="node443" class="node">
<title>layer8_ln1</title>
<polygon fill="none" stroke="black" points="51668.2,-1227.7 51387.2,-1227.7 51387.2,-1175.7 51668.2,-1175.7 51668.2,-1227.7"/>
<text text-anchor="middle" x="51527.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 8</text>
<text text-anchor="middle" x="51527.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="51527.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="51527.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer8_add1 -->
<g id="node444" class="node">
<title>layer8_add1</title>
<polygon fill="yellow" stroke="black" points="54688.2,-644.85 54407.2,-644.85 54407.2,-592.85 54688.2,-592.85 54688.2,-644.85"/>
<text text-anchor="middle" x="54547.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 8</text>
<text text-anchor="middle" x="54547.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54547.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54547.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_moe_output -->
<g id="node448" class="node">
<title>layer8_moe_output</title>
<polygon fill="yellow" stroke="black" points="54837.2,-540.58 54556.2,-540.58 54556.2,-488.58 54837.2,-488.58 54837.2,-540.58"/>
<text text-anchor="middle" x="54696.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 8</text>
<text text-anchor="middle" x="54696.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54696.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54696.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_add1&#45;&gt;layer8_moe_output -->
<g id="edge608" class="edge">
<title>layer8_add1&#45;&gt;layer8_moe_output</title>
<path fill="none" stroke="black" d="M54622.2,-592.81C54622.2,-592.81 54622.2,-550.65 54622.2,-550.65"/>
<polygon fill="black" stroke="black" points="54625.7,-550.65 54622.2,-540.65 54618.7,-550.65 54625.7,-550.65"/>
</g>
<!-- layer8_gate -->
<g id="node445" class="node">
<title>layer8_gate</title>
<polygon fill="lightgreen" stroke="black" points="55136.13,-1253.7 54677.3,-1253.7 54559.26,-1149.7 55018.1,-1149.7 55136.13,-1253.7"/>
<text text-anchor="middle" x="54847.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 8</text>
<text text-anchor="middle" x="54847.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54847.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="54847.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer8_route_exp0 -->
<g id="node449" class="node">
<title>layer8_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="51739.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="51739.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="51739.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="51739.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="51739.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp0 -->
<g id="edge542" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp0</title>
<path fill="none" stroke="black" d="M54585.62,-1173C53846.83,-1173 51800.82,-1173 51800.82,-1173 51800.82,-1173 51800.82,-1121.88 51800.82,-1121.88"/>
<polygon fill="black" stroke="black" points="51804.32,-1121.88 51800.82,-1111.88 51797.32,-1121.88 51804.32,-1121.88"/>
</g>
<!-- layer8_route_exp1 -->
<g id="node452" class="node">
<title>layer8_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="52158.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="52158.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="52158.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="52158.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="52158.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp1 -->
<g id="edge546" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp1</title>
<path fill="none" stroke="black" d="M54580.03,-1168C53899.88,-1168 52158.7,-1168 52158.7,-1168 52158.7,-1168 52158.7,-1123.71 52158.7,-1123.71"/>
<polygon fill="black" stroke="black" points="52162.2,-1123.71 52158.7,-1113.71 52155.2,-1123.71 52162.2,-1123.71"/>
</g>
<!-- layer8_route_exp2 -->
<g id="node455" class="node">
<title>layer8_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="52570.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="52570.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="52570.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="52570.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="52570.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp2 -->
<g id="edge550" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp2</title>
<path fill="none" stroke="black" d="M54578.68,-1167C53976.15,-1167 52570.7,-1167 52570.7,-1167 52570.7,-1167 52570.7,-1123.82 52570.7,-1123.82"/>
<polygon fill="black" stroke="black" points="52574.2,-1123.82 52570.7,-1113.82 52567.2,-1123.82 52574.2,-1123.82"/>
</g>
<!-- layer8_route_exp3 -->
<g id="node458" class="node">
<title>layer8_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="53000.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="53000.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="53000.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="53000.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="53000.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp3 -->
<g id="edge554" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp3</title>
<path fill="none" stroke="black" d="M54571.68,-1161C54056.61,-1161 53000.7,-1161 53000.7,-1161 53000.7,-1161 53000.7,-1124.05 53000.7,-1124.05"/>
<polygon fill="black" stroke="black" points="53004.2,-1124.05 53000.7,-1114.05 52997.2,-1124.05 53004.2,-1124.05"/>
</g>
<!-- layer8_route_exp4 -->
<g id="node461" class="node">
<title>layer8_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="53417.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="53417.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="53417.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="53417.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="53417.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp4 -->
<g id="edge558" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp4</title>
<path fill="none" stroke="black" d="M54568.58,-1158C54152.43,-1158 53417.7,-1158 53417.7,-1158 53417.7,-1158 53417.7,-1124.14 53417.7,-1124.14"/>
<polygon fill="black" stroke="black" points="53421.2,-1124.14 53417.7,-1114.14 53414.2,-1124.14 53421.2,-1124.14"/>
</g>
<!-- layer8_route_exp5 -->
<g id="node464" class="node">
<title>layer8_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="53825.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="53825.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="53825.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="53825.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="53825.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp5 -->
<g id="edge562" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp5</title>
<path fill="none" stroke="black" d="M54564.03,-1154C54261.59,-1154 53825.7,-1154 53825.7,-1154 53825.7,-1154 53825.7,-1124.11 53825.7,-1124.11"/>
<polygon fill="black" stroke="black" points="53829.2,-1124.11 53825.7,-1114.11 53822.2,-1124.11 53829.2,-1124.11"/>
</g>
<!-- layer8_route_exp6 -->
<g id="node467" class="node">
<title>layer8_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="54232.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="54232.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="54232.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="54232.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54232.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp6 -->
<g id="edge566" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp6</title>
<path fill="none" stroke="black" d="M54560.45,-1151C54400.26,-1151 54232.7,-1151 54232.7,-1151 54232.7,-1151 54232.7,-1123.96 54232.7,-1123.96"/>
<polygon fill="black" stroke="black" points="54236.2,-1123.96 54232.7,-1113.96 54229.2,-1123.96 54236.2,-1123.96"/>
</g>
<!-- layer8_route_exp7 -->
<g id="node470" class="node">
<title>layer8_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="54642.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="54642.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="54642.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="54642.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54642.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp7 -->
<g id="edge570" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp7</title>
<path fill="none" stroke="black" d="M54697.96,-1149.5C54697.96,-1149.5 54697.96,-1122.25 54697.96,-1122.25"/>
<polygon fill="black" stroke="black" points="54701.46,-1122.25 54697.96,-1112.25 54694.46,-1122.25 54701.46,-1122.25"/>
</g>
<!-- layer8_route_exp8 -->
<g id="node473" class="node">
<title>layer8_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="55052.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="55052.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="55052.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="55052.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="55052.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp8 -->
<g id="edge574" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp8</title>
<path fill="none" stroke="black" d="M54997.43,-1149.5C54997.43,-1149.5 54997.43,-1122.25 54997.43,-1122.25"/>
<polygon fill="black" stroke="black" points="55000.93,-1122.25 54997.43,-1112.25 54993.93,-1122.25 55000.93,-1122.25"/>
</g>
<!-- layer8_route_exp9 -->
<g id="node476" class="node">
<title>layer8_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="55464.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="55464.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="55464.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="55464.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="55464.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp9 -->
<g id="edge578" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp9</title>
<path fill="none" stroke="black" d="M55022.03,-1153C55204.48,-1153 55464.7,-1153 55464.7,-1153 55464.7,-1153 55464.7,-1124.07 55464.7,-1124.07"/>
<polygon fill="black" stroke="black" points="55468.2,-1124.07 55464.7,-1114.07 55461.2,-1124.07 55468.2,-1124.07"/>
</g>
<!-- layer8_route_exp10 -->
<g id="node479" class="node">
<title>layer8_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="55872.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="55872.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="55872.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="55872.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="55872.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp10 -->
<g id="edge582" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp10</title>
<path fill="none" stroke="black" d="M55025.36,-1156C55318.8,-1156 55872.7,-1156 55872.7,-1156 55872.7,-1156 55872.7,-1124.15 55872.7,-1124.15"/>
<polygon fill="black" stroke="black" points="55876.2,-1124.15 55872.7,-1114.15 55869.2,-1124.15 55876.2,-1124.15"/>
</g>
<!-- layer8_route_exp11 -->
<g id="node482" class="node">
<title>layer8_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="56284.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="56284.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="56284.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="56284.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="56284.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp11 -->
<g id="edge586" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp11</title>
<path fill="none" stroke="black" d="M55030.06,-1160C55416.92,-1160 56284.7,-1160 56284.7,-1160 56284.7,-1160 56284.7,-1124.09 56284.7,-1124.09"/>
<polygon fill="black" stroke="black" points="56288.2,-1124.09 56284.7,-1114.09 56281.2,-1124.09 56288.2,-1124.09"/>
</g>
<!-- layer8_route_exp12 -->
<g id="node485" class="node">
<title>layer8_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="56697.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="56697.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="56697.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="56697.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="56697.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp12 -->
<g id="edge590" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp12</title>
<path fill="none" stroke="black" d="M55033.55,-1163C55502.69,-1163 56697.7,-1163 56697.7,-1163 56697.7,-1163 56697.7,-1123.93 56697.7,-1123.93"/>
<polygon fill="black" stroke="black" points="56701.2,-1123.93 56697.7,-1113.93 56694.2,-1123.93 56701.2,-1123.93"/>
</g>
<!-- layer8_route_exp13 -->
<g id="node488" class="node">
<title>layer8_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="57111.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="57111.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="57111.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="57111.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="57111.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp13 -->
<g id="edge594" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp13</title>
<path fill="none" stroke="black" d="M55037.8,-1167C55582.78,-1167 57111.7,-1167 57111.7,-1167 57111.7,-1167 57111.7,-1123.82 57111.7,-1123.82"/>
<polygon fill="black" stroke="black" points="57115.2,-1123.82 57111.7,-1113.82 57108.2,-1123.82 57115.2,-1123.82"/>
</g>
<!-- layer8_route_exp14 -->
<g id="node491" class="node">
<title>layer8_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="57526.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="57526.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="57526.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="57526.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="57526.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp14 -->
<g id="edge598" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp14</title>
<path fill="none" stroke="black" d="M55041.17,-1170C55656.27,-1170 57526.7,-1170 57526.7,-1170 57526.7,-1170 57526.7,-1123.71 57526.7,-1123.71"/>
<polygon fill="black" stroke="black" points="57530.2,-1123.71 57526.7,-1113.71 57523.2,-1123.71 57530.2,-1123.71"/>
</g>
<!-- layer8_route_exp15 -->
<g id="node494" class="node">
<title>layer8_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="57941.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="57941.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="57941.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="57941.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="57941.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_route_exp15 -->
<g id="edge602" class="edge">
<title>layer8_gate&#45;&gt;layer8_route_exp15</title>
<path fill="none" stroke="black" d="M55043.64,-1172C55715.92,-1172 57887.57,-1172 57887.57,-1172 57887.57,-1172 57887.57,-1122.33 57887.57,-1122.33"/>
<polygon fill="black" stroke="black" points="57891.07,-1122.33 57887.57,-1112.33 57884.07,-1122.33 57891.07,-1122.33"/>
</g>
<!-- layer8_moe_agg -->
<g id="node446" class="node">
<title>layer8_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="54846.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="54846.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 8</text>
<text text-anchor="middle" x="54846.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54846.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54846.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer8_ln2 -->
<g id="node447" class="node">
<title>layer8_ln2</title>
<polygon fill="none" stroke="black" points="54987.2,-644.85 54706.2,-644.85 54706.2,-592.85 54987.2,-592.85 54987.2,-644.85"/>
<text text-anchor="middle" x="54846.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 8</text>
<text text-anchor="middle" x="54846.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54846.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54846.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer8_moe_agg&#45;&gt;layer8_ln2 -->
<g id="edge606" class="edge">
<title>layer8_moe_agg&#45;&gt;layer8_ln2</title>
<path fill="none" stroke="black" d="M54846.7,-706.52C54846.7,-706.52 54846.7,-654.92 54846.7,-654.92"/>
<polygon fill="black" stroke="black" points="54850.2,-654.92 54846.7,-644.92 54843.2,-654.92 54850.2,-654.92"/>
</g>
<!-- layer8_ln2&#45;&gt;layer8_moe_output -->
<g id="edge607" class="edge">
<title>layer8_ln2&#45;&gt;layer8_moe_output</title>
<path fill="none" stroke="black" d="M54771.7,-592.81C54771.7,-592.81 54771.7,-550.65 54771.7,-550.65"/>
<polygon fill="black" stroke="black" points="54775.2,-550.65 54771.7,-540.65 54768.2,-550.65 54775.2,-550.65"/>
</g>
<!-- layer9_mha -->
<g id="node497" class="node">
<title>layer9_mha</title>
<polygon fill="lightcyan" stroke="black" points="54837.2,-436.31 54556.2,-436.31 54556.2,-384.31 54837.2,-384.31 54837.2,-436.31"/>
<text text-anchor="middle" x="54696.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 9</text>
<text text-anchor="middle" x="54696.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54696.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="54696.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer8_moe_output&#45;&gt;layer9_mha -->
<g id="edge1086" class="edge">
<title>layer8_moe_output&#45;&gt;layer9_mha</title>
<path fill="none" stroke="black" d="M54696.7,-488.54C54696.7,-488.54 54696.7,-446.38 54696.7,-446.38"/>
<polygon fill="black" stroke="black" points="54700.2,-446.38 54696.7,-436.38 54693.2,-446.38 54700.2,-446.38"/>
</g>
<!-- layer8_expert0 -->
<g id="node450" class="node">
<title>layer8_expert0</title>
<polygon fill="lightcoral" stroke="black" points="51847.2,-1004.16 51626.2,-1004.16 51626.2,-941.16 51847.2,-941.16 51847.2,-1004.16"/>
<text text-anchor="middle" x="51736.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="51736.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="51736.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="51736.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="51736.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp0&#45;&gt;layer8_expert0 -->
<g id="edge543" class="edge">
<title>layer8_route_exp0&#45;&gt;layer8_expert0</title>
<path fill="none" stroke="black" d="M51736.7,-1039.87C51736.7,-1039.87 51736.7,-1014.41 51736.7,-1014.41"/>
<polygon fill="black" stroke="black" points="51740.2,-1014.41 51736.7,-1004.41 51733.2,-1014.41 51740.2,-1014.41"/>
</g>
<!-- layer8_agg_exp0 -->
<g id="node451" class="node">
<title>layer8_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="51734.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="51734.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="51734.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="51734.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="51734.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert0&#45;&gt;layer8_agg_exp0 -->
<g id="edge544" class="edge">
<title>layer8_expert0&#45;&gt;layer8_agg_exp0</title>
<path fill="none" stroke="black" d="M51736.7,-941.09C51736.7,-941.09 51736.7,-915.34 51736.7,-915.34"/>
<polygon fill="black" stroke="black" points="51740.2,-915.34 51736.7,-905.34 51733.2,-915.34 51740.2,-915.34"/>
</g>
<!-- layer8_agg_exp0&#45;&gt;layer8_moe_agg -->
<g id="edge545" class="edge">
<title>layer8_agg_exp0&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M51734.7,-831.33C51734.7,-795.31 51734.7,-746 51734.7,-746 51734.7,-746 54631.91,-746 54631.91,-746"/>
<polygon fill="black" stroke="black" points="54631.91,-749.5 54641.91,-746 54631.91,-742.5 54631.91,-749.5"/>
</g>
<!-- layer8_expert1 -->
<g id="node453" class="node">
<title>layer8_expert1</title>
<polygon fill="lightcoral" stroke="black" points="52264.2,-1004.16 52043.2,-1004.16 52043.2,-941.16 52264.2,-941.16 52264.2,-1004.16"/>
<text text-anchor="middle" x="52153.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="52153.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="52153.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="52153.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="52153.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp1&#45;&gt;layer8_expert1 -->
<g id="edge547" class="edge">
<title>layer8_route_exp1&#45;&gt;layer8_expert1</title>
<path fill="none" stroke="black" d="M52153.7,-1040.16C52153.7,-1040.16 52153.7,-1014.25 52153.7,-1014.25"/>
<polygon fill="black" stroke="black" points="52157.2,-1014.25 52153.7,-1004.25 52150.2,-1014.25 52157.2,-1014.25"/>
</g>
<!-- layer8_agg_exp1 -->
<g id="node454" class="node">
<title>layer8_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="52149.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="52149.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="52149.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="52149.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="52149.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert1&#45;&gt;layer8_agg_exp1 -->
<g id="edge548" class="edge">
<title>layer8_expert1&#45;&gt;layer8_agg_exp1</title>
<path fill="none" stroke="black" d="M52153.7,-941.09C52153.7,-941.09 52153.7,-915.34 52153.7,-915.34"/>
<polygon fill="black" stroke="black" points="52157.2,-915.34 52153.7,-905.34 52150.2,-915.34 52157.2,-915.34"/>
</g>
<!-- layer8_agg_exp1&#45;&gt;layer8_moe_agg -->
<g id="edge549" class="edge">
<title>layer8_agg_exp1&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M52149.7,-831.58C52149.7,-796.82 52149.7,-750 52149.7,-750 52149.7,-750 54634.54,-750 54634.54,-750"/>
<polygon fill="black" stroke="black" points="54634.54,-753.5 54644.54,-750 54634.54,-746.5 54634.54,-753.5"/>
</g>
<!-- layer8_expert2 -->
<g id="node456" class="node">
<title>layer8_expert2</title>
<polygon fill="lightcoral" stroke="black" points="52677.2,-1004.16 52456.2,-1004.16 52456.2,-941.16 52677.2,-941.16 52677.2,-1004.16"/>
<text text-anchor="middle" x="52566.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="52566.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="52566.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="52566.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="52566.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp2&#45;&gt;layer8_expert2 -->
<g id="edge551" class="edge">
<title>layer8_route_exp2&#45;&gt;layer8_expert2</title>
<path fill="none" stroke="black" d="M52566.7,-1039.87C52566.7,-1039.87 52566.7,-1014.41 52566.7,-1014.41"/>
<polygon fill="black" stroke="black" points="52570.2,-1014.41 52566.7,-1004.41 52563.2,-1014.41 52570.2,-1014.41"/>
</g>
<!-- layer8_agg_exp2 -->
<g id="node457" class="node">
<title>layer8_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="52564.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="52564.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="52564.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="52564.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="52564.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert2&#45;&gt;layer8_agg_exp2 -->
<g id="edge552" class="edge">
<title>layer8_expert2&#45;&gt;layer8_agg_exp2</title>
<path fill="none" stroke="black" d="M52566.7,-941.09C52566.7,-941.09 52566.7,-915.34 52566.7,-915.34"/>
<polygon fill="black" stroke="black" points="52570.2,-915.34 52566.7,-905.34 52563.2,-915.34 52570.2,-915.34"/>
</g>
<!-- layer8_agg_exp2&#45;&gt;layer8_moe_agg -->
<g id="edge553" class="edge">
<title>layer8_agg_exp2&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M52564.7,-831.57C52564.7,-798.47 52564.7,-755 52564.7,-755 52564.7,-755 54641.64,-755 54641.64,-755"/>
<polygon fill="black" stroke="black" points="54641.64,-758.5 54651.64,-755 54641.64,-751.5 54641.64,-758.5"/>
</g>
<!-- layer8_expert3 -->
<g id="node459" class="node">
<title>layer8_expert3</title>
<polygon fill="lightcoral" stroke="black" points="53100.2,-1004.16 52879.2,-1004.16 52879.2,-941.16 53100.2,-941.16 53100.2,-1004.16"/>
<text text-anchor="middle" x="52989.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="52989.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="52989.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="52989.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="52989.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp3&#45;&gt;layer8_expert3 -->
<g id="edge555" class="edge">
<title>layer8_route_exp3&#45;&gt;layer8_expert3</title>
<path fill="none" stroke="black" d="M52989.7,-1040.16C52989.7,-1040.16 52989.7,-1014.25 52989.7,-1014.25"/>
<polygon fill="black" stroke="black" points="52993.2,-1014.25 52989.7,-1004.25 52986.2,-1014.25 52993.2,-1014.25"/>
</g>
<!-- layer8_agg_exp3 -->
<g id="node460" class="node">
<title>layer8_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="52979.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="52979.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="52979.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="52979.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="52979.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert3&#45;&gt;layer8_agg_exp3 -->
<g id="edge556" class="edge">
<title>layer8_expert3&#45;&gt;layer8_agg_exp3</title>
<path fill="none" stroke="black" d="M52989.7,-941.09C52989.7,-941.09 52989.7,-915.34 52989.7,-915.34"/>
<polygon fill="black" stroke="black" points="52993.2,-915.34 52989.7,-905.34 52986.2,-915.34 52993.2,-915.34"/>
</g>
<!-- layer8_agg_exp3&#45;&gt;layer8_moe_agg -->
<g id="edge557" class="edge">
<title>layer8_agg_exp3&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M52979.7,-831.39C52979.7,-799.99 52979.7,-760 52979.7,-760 52979.7,-760 54653,-760 54653,-760"/>
<polygon fill="black" stroke="black" points="54653,-763.5 54663,-760 54653,-756.5 54653,-763.5"/>
</g>
<!-- layer8_expert4 -->
<g id="node462" class="node">
<title>layer8_expert4</title>
<polygon fill="lightcoral" stroke="black" points="53516.2,-1004.16 53295.2,-1004.16 53295.2,-941.16 53516.2,-941.16 53516.2,-1004.16"/>
<text text-anchor="middle" x="53405.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="53405.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="53405.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="53405.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="53405.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp4&#45;&gt;layer8_expert4 -->
<g id="edge559" class="edge">
<title>layer8_route_exp4&#45;&gt;layer8_expert4</title>
<path fill="none" stroke="black" d="M53405.7,-1040.16C53405.7,-1040.16 53405.7,-1014.25 53405.7,-1014.25"/>
<polygon fill="black" stroke="black" points="53409.2,-1014.25 53405.7,-1004.25 53402.2,-1014.25 53409.2,-1014.25"/>
</g>
<!-- layer8_agg_exp4 -->
<g id="node463" class="node">
<title>layer8_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="53394.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="53394.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="53394.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="53394.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="53394.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert4&#45;&gt;layer8_agg_exp4 -->
<g id="edge560" class="edge">
<title>layer8_expert4&#45;&gt;layer8_agg_exp4</title>
<path fill="none" stroke="black" d="M53405.7,-941.09C53405.7,-941.09 53405.7,-915.34 53405.7,-915.34"/>
<polygon fill="black" stroke="black" points="53409.2,-915.34 53405.7,-905.34 53402.2,-915.34 53409.2,-915.34"/>
</g>
<!-- layer8_agg_exp4&#45;&gt;layer8_moe_agg -->
<g id="edge561" class="edge">
<title>layer8_agg_exp4&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M53394.7,-831.35C53394.7,-801.69 53394.7,-765 53394.7,-765 53394.7,-765 54669.78,-765 54669.78,-765"/>
<polygon fill="black" stroke="black" points="54669.78,-768.5 54679.78,-765 54669.78,-761.5 54669.78,-768.5"/>
</g>
<!-- layer8_expert5 -->
<g id="node465" class="node">
<title>layer8_expert5</title>
<polygon fill="lightcoral" stroke="black" points="53927.2,-1004.16 53706.2,-1004.16 53706.2,-941.16 53927.2,-941.16 53927.2,-1004.16"/>
<text text-anchor="middle" x="53816.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="53816.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="53816.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="53816.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="53816.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp5&#45;&gt;layer8_expert5 -->
<g id="edge563" class="edge">
<title>layer8_route_exp5&#45;&gt;layer8_expert5</title>
<path fill="none" stroke="black" d="M53816.7,-1040.16C53816.7,-1040.16 53816.7,-1014.25 53816.7,-1014.25"/>
<polygon fill="black" stroke="black" points="53820.2,-1014.25 53816.7,-1004.25 53813.2,-1014.25 53820.2,-1014.25"/>
</g>
<!-- layer8_agg_exp5 -->
<g id="node466" class="node">
<title>layer8_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="53809.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="53809.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="53809.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="53809.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="53809.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert5&#45;&gt;layer8_agg_exp5 -->
<g id="edge564" class="edge">
<title>layer8_expert5&#45;&gt;layer8_agg_exp5</title>
<path fill="none" stroke="black" d="M53816.7,-941.09C53816.7,-941.09 53816.7,-915.34 53816.7,-915.34"/>
<polygon fill="black" stroke="black" points="53820.2,-915.34 53816.7,-905.34 53813.2,-915.34 53820.2,-915.34"/>
</g>
<!-- layer8_agg_exp5&#45;&gt;layer8_moe_agg -->
<g id="edge565" class="edge">
<title>layer8_agg_exp5&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M53809.7,-831.47C53809.7,-803.55 53809.7,-770 53809.7,-770 53809.7,-770 54693.6,-770 54693.6,-770"/>
<polygon fill="black" stroke="black" points="54693.6,-773.5 54703.6,-770 54693.6,-766.5 54693.6,-773.5"/>
</g>
<!-- layer8_expert6 -->
<g id="node468" class="node">
<title>layer8_expert6</title>
<polygon fill="lightcoral" stroke="black" points="54341.2,-1004.16 54120.2,-1004.16 54120.2,-941.16 54341.2,-941.16 54341.2,-1004.16"/>
<text text-anchor="middle" x="54230.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="54230.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="54230.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="54230.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="54230.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp6&#45;&gt;layer8_expert6 -->
<g id="edge567" class="edge">
<title>layer8_route_exp6&#45;&gt;layer8_expert6</title>
<path fill="none" stroke="black" d="M54230.7,-1039.87C54230.7,-1039.87 54230.7,-1014.41 54230.7,-1014.41"/>
<polygon fill="black" stroke="black" points="54234.2,-1014.41 54230.7,-1004.41 54227.2,-1014.41 54234.2,-1014.41"/>
</g>
<!-- layer8_agg_exp6 -->
<g id="node469" class="node">
<title>layer8_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="54224.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="54224.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="54224.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="54224.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="54224.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert6&#45;&gt;layer8_agg_exp6 -->
<g id="edge568" class="edge">
<title>layer8_expert6&#45;&gt;layer8_agg_exp6</title>
<path fill="none" stroke="black" d="M54230.7,-941.09C54230.7,-941.09 54230.7,-915.34 54230.7,-915.34"/>
<polygon fill="black" stroke="black" points="54234.2,-915.34 54230.7,-905.34 54227.2,-915.34 54234.2,-915.34"/>
</g>
<!-- layer8_agg_exp6&#45;&gt;layer8_moe_agg -->
<g id="edge569" class="edge">
<title>layer8_agg_exp6&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M54415.3,-857.67C54415.3,-833.14 54415.3,-775 54415.3,-775 54415.3,-775 54729.78,-775 54729.78,-775"/>
<polygon fill="black" stroke="black" points="54729.78,-778.5 54739.78,-775 54729.78,-771.5 54729.78,-778.5"/>
</g>
<!-- layer8_expert7 -->
<g id="node471" class="node">
<title>layer8_expert7</title>
<polygon fill="lightcoral" stroke="black" points="54751.2,-1004.16 54530.2,-1004.16 54530.2,-941.16 54751.2,-941.16 54751.2,-1004.16"/>
<text text-anchor="middle" x="54640.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="54640.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="54640.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="54640.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="54640.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp7&#45;&gt;layer8_expert7 -->
<g id="edge571" class="edge">
<title>layer8_route_exp7&#45;&gt;layer8_expert7</title>
<path fill="none" stroke="black" d="M54640.7,-1039.87C54640.7,-1039.87 54640.7,-1014.41 54640.7,-1014.41"/>
<polygon fill="black" stroke="black" points="54644.2,-1014.41 54640.7,-1004.41 54637.2,-1014.41 54644.2,-1014.41"/>
</g>
<!-- layer8_agg_exp7 -->
<g id="node472" class="node">
<title>layer8_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="54639.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="54639.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="54639.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="54639.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="54639.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert7&#45;&gt;layer8_agg_exp7 -->
<g id="edge572" class="edge">
<title>layer8_expert7&#45;&gt;layer8_agg_exp7</title>
<path fill="none" stroke="black" d="M54640.7,-941.09C54640.7,-941.09 54640.7,-915.34 54640.7,-915.34"/>
<polygon fill="black" stroke="black" points="54644.2,-915.34 54640.7,-905.34 54637.2,-915.34 54644.2,-915.34"/>
</g>
<!-- layer8_agg_exp7&#45;&gt;layer8_moe_agg -->
<g id="edge573" class="edge">
<title>layer8_agg_exp7&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M54740.02,-836.58C54740.02,-836.58 54740.02,-785.37 54740.02,-785.37"/>
<polygon fill="black" stroke="black" points="54743.52,-785.37 54740.02,-775.37 54736.52,-785.37 54743.52,-785.37"/>
</g>
<!-- layer8_expert8 -->
<g id="node474" class="node">
<title>layer8_expert8</title>
<polygon fill="lightcoral" stroke="black" points="55164.2,-1004.16 54943.2,-1004.16 54943.2,-941.16 55164.2,-941.16 55164.2,-1004.16"/>
<text text-anchor="middle" x="55053.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="55053.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="55053.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="55053.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="55053.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp8&#45;&gt;layer8_expert8 -->
<g id="edge575" class="edge">
<title>layer8_route_exp8&#45;&gt;layer8_expert8</title>
<path fill="none" stroke="black" d="M55053.7,-1039.87C55053.7,-1039.87 55053.7,-1014.41 55053.7,-1014.41"/>
<polygon fill="black" stroke="black" points="55057.2,-1014.41 55053.7,-1004.41 55050.2,-1014.41 55057.2,-1014.41"/>
</g>
<!-- layer8_agg_exp8 -->
<g id="node475" class="node">
<title>layer8_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="55054.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="55054.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="55054.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="55054.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="55054.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert8&#45;&gt;layer8_agg_exp8 -->
<g id="edge576" class="edge">
<title>layer8_expert8&#45;&gt;layer8_agg_exp8</title>
<path fill="none" stroke="black" d="M55053.7,-941.09C55053.7,-941.09 55053.7,-915.34 55053.7,-915.34"/>
<polygon fill="black" stroke="black" points="55057.2,-915.34 55053.7,-905.34 55050.2,-915.34 55057.2,-915.34"/>
</g>
<!-- layer8_agg_exp8&#45;&gt;layer8_moe_agg -->
<g id="edge577" class="edge">
<title>layer8_agg_exp8&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M54953.88,-836.58C54953.88,-836.58 54953.88,-785.37 54953.88,-785.37"/>
<polygon fill="black" stroke="black" points="54957.38,-785.37 54953.88,-775.37 54950.38,-785.37 54957.38,-785.37"/>
</g>
<!-- layer8_expert9 -->
<g id="node477" class="node">
<title>layer8_expert9</title>
<polygon fill="lightcoral" stroke="black" points="55577.2,-1004.16 55356.2,-1004.16 55356.2,-941.16 55577.2,-941.16 55577.2,-1004.16"/>
<text text-anchor="middle" x="55466.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="55466.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="55466.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="55466.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="55466.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp9&#45;&gt;layer8_expert9 -->
<g id="edge579" class="edge">
<title>layer8_route_exp9&#45;&gt;layer8_expert9</title>
<path fill="none" stroke="black" d="M55466.7,-1039.87C55466.7,-1039.87 55466.7,-1014.41 55466.7,-1014.41"/>
<polygon fill="black" stroke="black" points="55470.2,-1014.41 55466.7,-1004.41 55463.2,-1014.41 55470.2,-1014.41"/>
</g>
<!-- layer8_agg_exp9 -->
<g id="node478" class="node">
<title>layer8_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="55469.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="55469.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="55469.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="55469.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="55469.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert9&#45;&gt;layer8_agg_exp9 -->
<g id="edge580" class="edge">
<title>layer8_expert9&#45;&gt;layer8_agg_exp9</title>
<path fill="none" stroke="black" d="M55466.7,-941.09C55466.7,-941.09 55466.7,-915.34 55466.7,-915.34"/>
<polygon fill="black" stroke="black" points="55470.2,-915.34 55466.7,-905.34 55463.2,-915.34 55470.2,-915.34"/>
</g>
<!-- layer8_agg_exp9&#45;&gt;layer8_moe_agg -->
<g id="edge581" class="edge">
<title>layer8_agg_exp9&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M55469.7,-831.48C55469.7,-805.37 55469.7,-775 55469.7,-775 55469.7,-775 54963.79,-775 54963.79,-775"/>
<polygon fill="black" stroke="black" points="54963.79,-771.5 54953.79,-775 54963.79,-778.5 54963.79,-771.5"/>
</g>
<!-- layer8_expert10 -->
<g id="node480" class="node">
<title>layer8_expert10</title>
<polygon fill="lightcoral" stroke="black" points="55986.2,-1004.16 55765.2,-1004.16 55765.2,-941.16 55986.2,-941.16 55986.2,-1004.16"/>
<text text-anchor="middle" x="55875.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="55875.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="55875.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="55875.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="55875.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp10&#45;&gt;layer8_expert10 -->
<g id="edge583" class="edge">
<title>layer8_route_exp10&#45;&gt;layer8_expert10</title>
<path fill="none" stroke="black" d="M55875.7,-1039.87C55875.7,-1039.87 55875.7,-1014.41 55875.7,-1014.41"/>
<polygon fill="black" stroke="black" points="55879.2,-1014.41 55875.7,-1004.41 55872.2,-1014.41 55879.2,-1014.41"/>
</g>
<!-- layer8_agg_exp10 -->
<g id="node481" class="node">
<title>layer8_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="55884.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="55884.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="55884.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="55884.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="55884.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert10&#45;&gt;layer8_agg_exp10 -->
<g id="edge584" class="edge">
<title>layer8_expert10&#45;&gt;layer8_agg_exp10</title>
<path fill="none" stroke="black" d="M55875.7,-941.09C55875.7,-941.09 55875.7,-915.34 55875.7,-915.34"/>
<polygon fill="black" stroke="black" points="55879.2,-915.34 55875.7,-905.34 55872.2,-915.34 55879.2,-915.34"/>
</g>
<!-- layer8_agg_exp10&#45;&gt;layer8_moe_agg -->
<g id="edge585" class="edge">
<title>layer8_agg_exp10&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M55884.7,-831.47C55884.7,-803.55 55884.7,-770 55884.7,-770 55884.7,-770 54999.66,-770 54999.66,-770"/>
<polygon fill="black" stroke="black" points="54999.66,-766.5 54989.66,-770 54999.66,-773.5 54999.66,-766.5"/>
</g>
<!-- layer8_expert11 -->
<g id="node483" class="node">
<title>layer8_expert11</title>
<polygon fill="lightcoral" stroke="black" points="56401.2,-1004.16 56180.2,-1004.16 56180.2,-941.16 56401.2,-941.16 56401.2,-1004.16"/>
<text text-anchor="middle" x="56290.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="56290.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="56290.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="56290.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="56290.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp11&#45;&gt;layer8_expert11 -->
<g id="edge587" class="edge">
<title>layer8_route_exp11&#45;&gt;layer8_expert11</title>
<path fill="none" stroke="black" d="M56290.7,-1040.16C56290.7,-1040.16 56290.7,-1014.25 56290.7,-1014.25"/>
<polygon fill="black" stroke="black" points="56294.2,-1014.25 56290.7,-1004.25 56287.2,-1014.25 56294.2,-1014.25"/>
</g>
<!-- layer8_agg_exp11 -->
<g id="node484" class="node">
<title>layer8_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="56299.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="56299.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="56299.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="56299.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="56299.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert11&#45;&gt;layer8_agg_exp11 -->
<g id="edge588" class="edge">
<title>layer8_expert11&#45;&gt;layer8_agg_exp11</title>
<path fill="none" stroke="black" d="M56290.7,-941.09C56290.7,-941.09 56290.7,-915.34 56290.7,-915.34"/>
<polygon fill="black" stroke="black" points="56294.2,-915.34 56290.7,-905.34 56287.2,-915.34 56294.2,-915.34"/>
</g>
<!-- layer8_agg_exp11&#45;&gt;layer8_moe_agg -->
<g id="edge589" class="edge">
<title>layer8_agg_exp11&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M56299.7,-831.35C56299.7,-801.69 56299.7,-765 56299.7,-765 56299.7,-765 55023.73,-765 55023.73,-765"/>
<polygon fill="black" stroke="black" points="55023.73,-761.5 55013.73,-765 55023.73,-768.5 55023.73,-761.5"/>
</g>
<!-- layer8_expert12 -->
<g id="node486" class="node">
<title>layer8_expert12</title>
<polygon fill="lightcoral" stroke="black" points="56816.2,-1004.16 56595.2,-1004.16 56595.2,-941.16 56816.2,-941.16 56816.2,-1004.16"/>
<text text-anchor="middle" x="56705.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="56705.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="56705.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="56705.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="56705.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp12&#45;&gt;layer8_expert12 -->
<g id="edge591" class="edge">
<title>layer8_route_exp12&#45;&gt;layer8_expert12</title>
<path fill="none" stroke="black" d="M56705.7,-1040.16C56705.7,-1040.16 56705.7,-1014.25 56705.7,-1014.25"/>
<polygon fill="black" stroke="black" points="56709.2,-1014.25 56705.7,-1004.25 56702.2,-1014.25 56709.2,-1014.25"/>
</g>
<!-- layer8_agg_exp12 -->
<g id="node487" class="node">
<title>layer8_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="56714.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="56714.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="56714.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="56714.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="56714.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert12&#45;&gt;layer8_agg_exp12 -->
<g id="edge592" class="edge">
<title>layer8_expert12&#45;&gt;layer8_agg_exp12</title>
<path fill="none" stroke="black" d="M56705.7,-941.09C56705.7,-941.09 56705.7,-915.34 56705.7,-915.34"/>
<polygon fill="black" stroke="black" points="56709.2,-915.34 56705.7,-905.34 56702.2,-915.34 56709.2,-915.34"/>
</g>
<!-- layer8_agg_exp12&#45;&gt;layer8_moe_agg -->
<g id="edge593" class="edge">
<title>layer8_agg_exp12&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M56714.7,-831.39C56714.7,-799.99 56714.7,-760 56714.7,-760 56714.7,-760 55040.49,-760 55040.49,-760"/>
<polygon fill="black" stroke="black" points="55040.49,-756.5 55030.49,-760 55040.49,-763.5 55040.49,-756.5"/>
</g>
<!-- layer8_expert13 -->
<g id="node489" class="node">
<title>layer8_expert13</title>
<polygon fill="lightcoral" stroke="black" points="57231.2,-1004.16 57010.2,-1004.16 57010.2,-941.16 57231.2,-941.16 57231.2,-1004.16"/>
<text text-anchor="middle" x="57120.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="57120.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="57120.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="57120.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="57120.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp13&#45;&gt;layer8_expert13 -->
<g id="edge595" class="edge">
<title>layer8_route_exp13&#45;&gt;layer8_expert13</title>
<path fill="none" stroke="black" d="M57120.7,-1040.16C57120.7,-1040.16 57120.7,-1014.25 57120.7,-1014.25"/>
<polygon fill="black" stroke="black" points="57124.2,-1014.25 57120.7,-1004.25 57117.2,-1014.25 57124.2,-1014.25"/>
</g>
<!-- layer8_agg_exp13 -->
<g id="node490" class="node">
<title>layer8_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="57129.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="57129.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="57129.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="57129.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="57129.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert13&#45;&gt;layer8_agg_exp13 -->
<g id="edge596" class="edge">
<title>layer8_expert13&#45;&gt;layer8_agg_exp13</title>
<path fill="none" stroke="black" d="M57120.7,-941.09C57120.7,-941.09 57120.7,-915.34 57120.7,-915.34"/>
<polygon fill="black" stroke="black" points="57124.2,-915.34 57120.7,-905.34 57117.2,-915.34 57124.2,-915.34"/>
</g>
<!-- layer8_agg_exp13&#45;&gt;layer8_moe_agg -->
<g id="edge597" class="edge">
<title>layer8_agg_exp13&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M57129.7,-831.57C57129.7,-798.47 57129.7,-755 57129.7,-755 57129.7,-755 55051.84,-755 55051.84,-755"/>
<polygon fill="black" stroke="black" points="55051.84,-751.5 55041.84,-755 55051.84,-758.5 55051.84,-751.5"/>
</g>
<!-- layer8_expert14 -->
<g id="node492" class="node">
<title>layer8_expert14</title>
<polygon fill="lightcoral" stroke="black" points="57646.2,-1004.16 57425.2,-1004.16 57425.2,-941.16 57646.2,-941.16 57646.2,-1004.16"/>
<text text-anchor="middle" x="57535.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="57535.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="57535.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="57535.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="57535.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp14&#45;&gt;layer8_expert14 -->
<g id="edge599" class="edge">
<title>layer8_route_exp14&#45;&gt;layer8_expert14</title>
<path fill="none" stroke="black" d="M57535.7,-1040.16C57535.7,-1040.16 57535.7,-1014.25 57535.7,-1014.25"/>
<polygon fill="black" stroke="black" points="57539.2,-1014.25 57535.7,-1004.25 57532.2,-1014.25 57539.2,-1014.25"/>
</g>
<!-- layer8_agg_exp14 -->
<g id="node493" class="node">
<title>layer8_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="57544.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="57544.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="57544.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="57544.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="57544.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert14&#45;&gt;layer8_agg_exp14 -->
<g id="edge600" class="edge">
<title>layer8_expert14&#45;&gt;layer8_agg_exp14</title>
<path fill="none" stroke="black" d="M57535.7,-941.09C57535.7,-941.09 57535.7,-915.34 57535.7,-915.34"/>
<polygon fill="black" stroke="black" points="57539.2,-915.34 57535.7,-905.34 57532.2,-915.34 57539.2,-915.34"/>
</g>
<!-- layer8_agg_exp14&#45;&gt;layer8_moe_agg -->
<g id="edge601" class="edge">
<title>layer8_agg_exp14&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M57544.7,-831.58C57544.7,-796.82 57544.7,-750 57544.7,-750 57544.7,-750 55058.66,-750 55058.66,-750"/>
<polygon fill="black" stroke="black" points="55058.66,-746.5 55048.66,-750 55058.66,-753.5 55058.66,-746.5"/>
</g>
<!-- layer8_expert15 -->
<g id="node495" class="node">
<title>layer8_expert15</title>
<polygon fill="lightcoral" stroke="black" points="58061.2,-1004.16 57840.2,-1004.16 57840.2,-941.16 58061.2,-941.16 58061.2,-1004.16"/>
<text text-anchor="middle" x="57950.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="57950.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="57950.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="57950.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="57950.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer8_route_exp15&#45;&gt;layer8_expert15 -->
<g id="edge603" class="edge">
<title>layer8_route_exp15&#45;&gt;layer8_expert15</title>
<path fill="none" stroke="black" d="M57950.7,-1040.16C57950.7,-1040.16 57950.7,-1014.25 57950.7,-1014.25"/>
<polygon fill="black" stroke="black" points="57954.2,-1014.25 57950.7,-1004.25 57947.2,-1014.25 57954.2,-1014.25"/>
</g>
<!-- layer8_agg_exp15 -->
<g id="node496" class="node">
<title>layer8_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="57959.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="57959.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="57959.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="57959.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="57959.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer8_expert15&#45;&gt;layer8_agg_exp15 -->
<g id="edge604" class="edge">
<title>layer8_expert15&#45;&gt;layer8_agg_exp15</title>
<path fill="none" stroke="black" d="M57950.7,-941.09C57950.7,-941.09 57950.7,-915.34 57950.7,-915.34"/>
<polygon fill="black" stroke="black" points="57954.2,-915.34 57950.7,-905.34 57947.2,-915.34 57954.2,-915.34"/>
</g>
<!-- layer8_agg_exp15&#45;&gt;layer8_moe_agg -->
<g id="edge605" class="edge">
<title>layer8_agg_exp15&#45;&gt;layer8_moe_agg</title>
<path fill="none" stroke="black" d="M57959.7,-831.33C57959.7,-795.31 57959.7,-746 57959.7,-746 57959.7,-746 55061.55,-746 55061.55,-746"/>
<polygon fill="black" stroke="black" points="55061.55,-742.5 55051.55,-746 55061.55,-749.5 55061.55,-742.5"/>
</g>
<!-- layer9_ln1 -->
<g id="node498" class="node">
<title>layer9_ln1</title>
<polygon fill="none" stroke="black" points="58308.2,-1227.7 58027.2,-1227.7 58027.2,-1175.7 58308.2,-1175.7 58308.2,-1227.7"/>
<text text-anchor="middle" x="58167.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 9</text>
<text text-anchor="middle" x="58167.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="58167.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="58167.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer9_add1 -->
<g id="node499" class="node">
<title>layer9_add1</title>
<polygon fill="yellow" stroke="black" points="61328.2,-644.85 61047.2,-644.85 61047.2,-592.85 61328.2,-592.85 61328.2,-644.85"/>
<text text-anchor="middle" x="61187.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 9</text>
<text text-anchor="middle" x="61187.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61187.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61187.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_moe_output -->
<g id="node503" class="node">
<title>layer9_moe_output</title>
<polygon fill="yellow" stroke="black" points="61477.2,-540.58 61196.2,-540.58 61196.2,-488.58 61477.2,-488.58 61477.2,-540.58"/>
<text text-anchor="middle" x="61336.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 9</text>
<text text-anchor="middle" x="61336.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61336.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61336.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_add1&#45;&gt;layer9_moe_output -->
<g id="edge675" class="edge">
<title>layer9_add1&#45;&gt;layer9_moe_output</title>
<path fill="none" stroke="black" d="M61262.2,-592.81C61262.2,-592.81 61262.2,-550.65 61262.2,-550.65"/>
<polygon fill="black" stroke="black" points="61265.7,-550.65 61262.2,-540.65 61258.7,-550.65 61265.7,-550.65"/>
</g>
<!-- layer9_gate -->
<g id="node500" class="node">
<title>layer9_gate</title>
<polygon fill="lightgreen" stroke="black" points="61776.13,-1253.7 61317.3,-1253.7 61199.26,-1149.7 61658.1,-1149.7 61776.13,-1253.7"/>
<text text-anchor="middle" x="61487.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 9</text>
<text text-anchor="middle" x="61487.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61487.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="61487.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer9_route_exp0 -->
<g id="node504" class="node">
<title>layer9_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="58378.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="58378.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="58378.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="58378.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="58378.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp0 -->
<g id="edge609" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp0</title>
<path fill="none" stroke="black" d="M61225.57,-1173C60486.67,-1173 58440.32,-1173 58440.32,-1173 58440.32,-1173 58440.32,-1121.88 58440.32,-1121.88"/>
<polygon fill="black" stroke="black" points="58443.82,-1121.88 58440.32,-1111.88 58436.82,-1121.88 58443.82,-1121.88"/>
</g>
<!-- layer9_route_exp1 -->
<g id="node507" class="node">
<title>layer9_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="58818.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="58818.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="58818.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="58818.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="58818.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp1 -->
<g id="edge613" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp1</title>
<path fill="none" stroke="black" d="M61219.87,-1168C60543.26,-1168 58818.7,-1168 58818.7,-1168 58818.7,-1168 58818.7,-1123.71 58818.7,-1123.71"/>
<polygon fill="black" stroke="black" points="58822.2,-1123.71 58818.7,-1113.71 58815.2,-1123.71 58822.2,-1123.71"/>
</g>
<!-- layer9_route_exp2 -->
<g id="node510" class="node">
<title>layer9_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="59240.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="59240.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="59240.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="59240.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="59240.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp2 -->
<g id="edge617" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp2</title>
<path fill="none" stroke="black" d="M61216.38,-1165C60618.59,-1165 59240.7,-1165 59240.7,-1165 59240.7,-1165 59240.7,-1123.77 59240.7,-1123.77"/>
<polygon fill="black" stroke="black" points="59244.2,-1123.77 59240.7,-1113.77 59237.2,-1123.77 59244.2,-1123.77"/>
</g>
<!-- layer9_route_exp3 -->
<g id="node513" class="node">
<title>layer9_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="59654.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="59654.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="59654.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="59654.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="59654.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp3 -->
<g id="edge621" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp3</title>
<path fill="none" stroke="black" d="M61211.79,-1161C60699.9,-1161 59654.7,-1161 59654.7,-1161 59654.7,-1161 59654.7,-1124.05 59654.7,-1124.05"/>
<polygon fill="black" stroke="black" points="59658.2,-1124.05 59654.7,-1114.05 59651.2,-1124.05 59658.2,-1124.05"/>
</g>
<!-- layer9_route_exp4 -->
<g id="node516" class="node">
<title>layer9_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="60063.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="60063.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="60063.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="60063.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="60063.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp4 -->
<g id="edge625" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp4</title>
<path fill="none" stroke="black" d="M61208.48,-1158C60793.85,-1158 60063.7,-1158 60063.7,-1158 60063.7,-1158 60063.7,-1124.14 60063.7,-1124.14"/>
<polygon fill="black" stroke="black" points="60067.2,-1124.14 60063.7,-1114.14 60060.2,-1124.14 60067.2,-1124.14"/>
</g>
<!-- layer9_route_exp5 -->
<g id="node519" class="node">
<title>layer9_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="60470.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="60470.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="60470.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="60470.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="60470.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp5 -->
<g id="edge629" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp5</title>
<path fill="none" stroke="black" d="M61204.07,-1154C60903.16,-1154 60470.7,-1154 60470.7,-1154 60470.7,-1154 60470.7,-1124.11 60470.7,-1124.11"/>
<polygon fill="black" stroke="black" points="60474.2,-1124.11 60470.7,-1114.11 60467.2,-1124.11 60474.2,-1124.11"/>
</g>
<!-- layer9_route_exp6 -->
<g id="node522" class="node">
<title>layer9_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="60876.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="60876.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="60876.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="60876.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="60876.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp6 -->
<g id="edge633" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp6</title>
<path fill="none" stroke="black" d="M61200.54,-1151C61041.92,-1151 60876.7,-1151 60876.7,-1151 60876.7,-1151 60876.7,-1123.96 60876.7,-1123.96"/>
<polygon fill="black" stroke="black" points="60880.2,-1123.96 60876.7,-1113.96 60873.2,-1123.96 60880.2,-1123.96"/>
</g>
<!-- layer9_route_exp7 -->
<g id="node525" class="node">
<title>layer9_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="61282.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="61282.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="61282.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="61282.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61282.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp7 -->
<g id="edge637" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp7</title>
<path fill="none" stroke="black" d="M61337.96,-1149.5C61337.96,-1149.5 61337.96,-1122.25 61337.96,-1122.25"/>
<polygon fill="black" stroke="black" points="61341.46,-1122.25 61337.96,-1112.25 61334.46,-1122.25 61341.46,-1122.25"/>
</g>
<!-- layer9_route_exp8 -->
<g id="node528" class="node">
<title>layer9_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="61692.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="61692.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="61692.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="61692.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61692.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp8 -->
<g id="edge641" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp8</title>
<path fill="none" stroke="black" d="M61637.43,-1149.5C61637.43,-1149.5 61637.43,-1122.25 61637.43,-1122.25"/>
<polygon fill="black" stroke="black" points="61640.93,-1122.25 61637.43,-1112.25 61633.93,-1122.25 61640.93,-1122.25"/>
</g>
<!-- layer9_route_exp9 -->
<g id="node531" class="node">
<title>layer9_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="62104.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="62104.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="62104.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="62104.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="62104.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp9 -->
<g id="edge645" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp9</title>
<path fill="none" stroke="black" d="M61662.03,-1153C61844.48,-1153 62104.7,-1153 62104.7,-1153 62104.7,-1153 62104.7,-1124.07 62104.7,-1124.07"/>
<polygon fill="black" stroke="black" points="62108.2,-1124.07 62104.7,-1114.07 62101.2,-1124.07 62108.2,-1124.07"/>
</g>
<!-- layer9_route_exp10 -->
<g id="node534" class="node">
<title>layer9_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="62518.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="62518.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="62518.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="62518.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="62518.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp10 -->
<g id="edge649" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp10</title>
<path fill="none" stroke="black" d="M61665.52,-1156C61960.45,-1156 62518.7,-1156 62518.7,-1156 62518.7,-1156 62518.7,-1124.15 62518.7,-1124.15"/>
<polygon fill="black" stroke="black" points="62522.2,-1124.15 62518.7,-1114.15 62515.2,-1124.15 62522.2,-1124.15"/>
</g>
<!-- layer9_route_exp11 -->
<g id="node537" class="node">
<title>layer9_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="62932.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="62932.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="62932.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="62932.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="62932.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp11 -->
<g id="edge653" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp11</title>
<path fill="none" stroke="black" d="M61669.98,-1160C62058.44,-1160 62932.7,-1160 62932.7,-1160 62932.7,-1160 62932.7,-1124.09 62932.7,-1124.09"/>
<polygon fill="black" stroke="black" points="62936.2,-1124.09 62932.7,-1114.09 62929.2,-1124.09 62936.2,-1124.09"/>
</g>
<!-- layer9_route_exp12 -->
<g id="node540" class="node">
<title>layer9_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="63341.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="63341.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="63341.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="63341.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="63341.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp12 -->
<g id="edge657" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp12</title>
<path fill="none" stroke="black" d="M61673.53,-1163C62143.38,-1163 63341.7,-1163 63341.7,-1163 63341.7,-1163 63341.7,-1123.93 63341.7,-1123.93"/>
<polygon fill="black" stroke="black" points="63345.2,-1123.93 63341.7,-1113.93 63338.2,-1123.93 63345.2,-1123.93"/>
</g>
<!-- layer9_route_exp13 -->
<g id="node543" class="node">
<title>layer9_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="63753.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="63753.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="63753.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="63753.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="63753.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp13 -->
<g id="edge661" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp13</title>
<path fill="none" stroke="black" d="M61677.97,-1167C62223.43,-1167 63753.7,-1167 63753.7,-1167 63753.7,-1167 63753.7,-1123.82 63753.7,-1123.82"/>
<polygon fill="black" stroke="black" points="63757.2,-1123.82 63753.7,-1113.82 63750.2,-1123.82 63757.2,-1123.82"/>
</g>
<!-- layer9_route_exp14 -->
<g id="node546" class="node">
<title>layer9_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="64166.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="64166.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="64166.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="64166.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="64166.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp14 -->
<g id="edge665" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp14</title>
<path fill="none" stroke="black" d="M61681.17,-1170C62296.27,-1170 64166.7,-1170 64166.7,-1170 64166.7,-1170 64166.7,-1123.71 64166.7,-1123.71"/>
<polygon fill="black" stroke="black" points="64170.2,-1123.71 64166.7,-1113.71 64163.2,-1123.71 64170.2,-1123.71"/>
</g>
<!-- layer9_route_exp15 -->
<g id="node549" class="node">
<title>layer9_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="64580.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="64580.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="64580.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="64580.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="64580.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_route_exp15 -->
<g id="edge669" class="edge">
<title>layer9_gate&#45;&gt;layer9_route_exp15</title>
<path fill="none" stroke="black" d="M61683.62,-1172C62340.85,-1172 64426.07,-1172 64426.07,-1172 64426.07,-1172 64426.07,-1109.46 64426.07,-1109.46"/>
<polygon fill="black" stroke="black" points="64429.57,-1109.46 64426.07,-1099.46 64422.57,-1109.46 64429.57,-1109.46"/>
</g>
<!-- layer9_moe_agg -->
<g id="node501" class="node">
<title>layer9_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="61486.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="61486.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 9</text>
<text text-anchor="middle" x="61486.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61486.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61486.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer9_ln2 -->
<g id="node502" class="node">
<title>layer9_ln2</title>
<polygon fill="none" stroke="black" points="61627.2,-644.85 61346.2,-644.85 61346.2,-592.85 61627.2,-592.85 61627.2,-644.85"/>
<text text-anchor="middle" x="61486.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 9</text>
<text text-anchor="middle" x="61486.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61486.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61486.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer9_moe_agg&#45;&gt;layer9_ln2 -->
<g id="edge673" class="edge">
<title>layer9_moe_agg&#45;&gt;layer9_ln2</title>
<path fill="none" stroke="black" d="M61486.7,-706.52C61486.7,-706.52 61486.7,-654.92 61486.7,-654.92"/>
<polygon fill="black" stroke="black" points="61490.2,-654.92 61486.7,-644.92 61483.2,-654.92 61490.2,-654.92"/>
</g>
<!-- layer9_ln2&#45;&gt;layer9_moe_output -->
<g id="edge674" class="edge">
<title>layer9_ln2&#45;&gt;layer9_moe_output</title>
<path fill="none" stroke="black" d="M61411.7,-592.81C61411.7,-592.81 61411.7,-550.65 61411.7,-550.65"/>
<polygon fill="black" stroke="black" points="61415.2,-550.65 61411.7,-540.65 61408.2,-550.65 61415.2,-550.65"/>
</g>
<!-- layer10_mha -->
<g id="node552" class="node">
<title>layer10_mha</title>
<polygon fill="lightcyan" stroke="black" points="61477.2,-436.31 61196.2,-436.31 61196.2,-384.31 61477.2,-384.31 61477.2,-436.31"/>
<text text-anchor="middle" x="61336.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 10</text>
<text text-anchor="middle" x="61336.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61336.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="61336.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer9_moe_output&#45;&gt;layer10_mha -->
<g id="edge1087" class="edge">
<title>layer9_moe_output&#45;&gt;layer10_mha</title>
<path fill="none" stroke="black" d="M61336.7,-488.54C61336.7,-488.54 61336.7,-446.38 61336.7,-446.38"/>
<polygon fill="black" stroke="black" points="61340.2,-446.38 61336.7,-436.38 61333.2,-446.38 61340.2,-446.38"/>
</g>
<!-- layer9_expert0 -->
<g id="node505" class="node">
<title>layer9_expert0</title>
<polygon fill="lightcoral" stroke="black" points="58489.2,-1004.16 58268.2,-1004.16 58268.2,-941.16 58489.2,-941.16 58489.2,-1004.16"/>
<text text-anchor="middle" x="58378.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="58378.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="58378.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="58378.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="58378.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp0&#45;&gt;layer9_expert0 -->
<g id="edge610" class="edge">
<title>layer9_route_exp0&#45;&gt;layer9_expert0</title>
<path fill="none" stroke="black" d="M58378.7,-1039.87C58378.7,-1039.87 58378.7,-1014.41 58378.7,-1014.41"/>
<polygon fill="black" stroke="black" points="58382.2,-1014.41 58378.7,-1004.41 58375.2,-1014.41 58382.2,-1014.41"/>
</g>
<!-- layer9_agg_exp0 -->
<g id="node506" class="node">
<title>layer9_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="58374.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="58374.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="58374.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="58374.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="58374.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert0&#45;&gt;layer9_agg_exp0 -->
<g id="edge611" class="edge">
<title>layer9_expert0&#45;&gt;layer9_agg_exp0</title>
<path fill="none" stroke="black" d="M58378.7,-941.09C58378.7,-941.09 58378.7,-915.34 58378.7,-915.34"/>
<polygon fill="black" stroke="black" points="58382.2,-915.34 58378.7,-905.34 58375.2,-915.34 58382.2,-915.34"/>
</g>
<!-- layer9_agg_exp0&#45;&gt;layer9_moe_agg -->
<g id="edge612" class="edge">
<title>layer9_agg_exp0&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M58374.7,-831.49C58374.7,-784.97 58374.7,-711 58374.7,-711 58374.7,-711 61381.86,-711 61381.86,-711"/>
<polygon fill="black" stroke="black" points="61381.86,-714.5 61391.86,-711 61381.86,-707.5 61381.86,-714.5"/>
</g>
<!-- layer9_expert1 -->
<g id="node508" class="node">
<title>layer9_expert1</title>
<polygon fill="lightcoral" stroke="black" points="58914.2,-1004.16 58693.2,-1004.16 58693.2,-941.16 58914.2,-941.16 58914.2,-1004.16"/>
<text text-anchor="middle" x="58803.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="58803.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="58803.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="58803.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="58803.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp1&#45;&gt;layer9_expert1 -->
<g id="edge614" class="edge">
<title>layer9_route_exp1&#45;&gt;layer9_expert1</title>
<path fill="none" stroke="black" d="M58803.7,-1040.16C58803.7,-1040.16 58803.7,-1014.25 58803.7,-1014.25"/>
<polygon fill="black" stroke="black" points="58807.2,-1014.25 58803.7,-1004.25 58800.2,-1014.25 58807.2,-1014.25"/>
</g>
<!-- layer9_agg_exp1 -->
<g id="node509" class="node">
<title>layer9_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="58789.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="58789.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="58789.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="58789.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="58789.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert1&#45;&gt;layer9_agg_exp1 -->
<g id="edge615" class="edge">
<title>layer9_expert1&#45;&gt;layer9_agg_exp1</title>
<path fill="none" stroke="black" d="M58803.7,-941.09C58803.7,-941.09 58803.7,-915.34 58803.7,-915.34"/>
<polygon fill="black" stroke="black" points="58807.2,-915.34 58803.7,-905.34 58800.2,-915.34 58807.2,-915.34"/>
</g>
<!-- layer9_agg_exp1&#45;&gt;layer9_moe_agg -->
<g id="edge616" class="edge">
<title>layer9_agg_exp1&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M58789.7,-831.5C58789.7,-786.4 58789.7,-716 58789.7,-716 58789.7,-716 61341.1,-716 61341.1,-716"/>
<polygon fill="black" stroke="black" points="61341.1,-719.5 61351.1,-716 61341.1,-712.5 61341.1,-719.5"/>
</g>
<!-- layer9_expert2 -->
<g id="node511" class="node">
<title>layer9_expert2</title>
<polygon fill="lightcoral" stroke="black" points="59332.2,-1004.16 59111.2,-1004.16 59111.2,-941.16 59332.2,-941.16 59332.2,-1004.16"/>
<text text-anchor="middle" x="59221.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="59221.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="59221.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="59221.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="59221.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp2&#45;&gt;layer9_expert2 -->
<g id="edge618" class="edge">
<title>layer9_route_exp2&#45;&gt;layer9_expert2</title>
<path fill="none" stroke="black" d="M59221.7,-1040.16C59221.7,-1040.16 59221.7,-1014.25 59221.7,-1014.25"/>
<polygon fill="black" stroke="black" points="59225.2,-1014.25 59221.7,-1004.25 59218.2,-1014.25 59225.2,-1014.25"/>
</g>
<!-- layer9_agg_exp2 -->
<g id="node512" class="node">
<title>layer9_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="59204.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="59204.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="59204.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="59204.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="59204.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert2&#45;&gt;layer9_agg_exp2 -->
<g id="edge619" class="edge">
<title>layer9_expert2&#45;&gt;layer9_agg_exp2</title>
<path fill="none" stroke="black" d="M59221.7,-941.09C59221.7,-941.09 59221.7,-915.34 59221.7,-915.34"/>
<polygon fill="black" stroke="black" points="59225.2,-915.34 59221.7,-905.34 59218.2,-915.34 59225.2,-915.34"/>
</g>
<!-- layer9_agg_exp2&#45;&gt;layer9_moe_agg -->
<g id="edge620" class="edge">
<title>layer9_agg_exp2&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M59204.7,-831.58C59204.7,-787.92 59204.7,-721 59204.7,-721 59204.7,-721 61314.87,-721 61314.87,-721"/>
<polygon fill="black" stroke="black" points="61314.87,-724.5 61324.87,-721 61314.87,-717.5 61314.87,-724.5"/>
</g>
<!-- layer9_expert3 -->
<g id="node514" class="node">
<title>layer9_expert3</title>
<polygon fill="lightcoral" stroke="black" points="59747.2,-1004.16 59526.2,-1004.16 59526.2,-941.16 59747.2,-941.16 59747.2,-1004.16"/>
<text text-anchor="middle" x="59636.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="59636.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="59636.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="59636.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="59636.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp3&#45;&gt;layer9_expert3 -->
<g id="edge622" class="edge">
<title>layer9_route_exp3&#45;&gt;layer9_expert3</title>
<path fill="none" stroke="black" d="M59636.7,-1040.16C59636.7,-1040.16 59636.7,-1014.25 59636.7,-1014.25"/>
<polygon fill="black" stroke="black" points="59640.2,-1014.25 59636.7,-1004.25 59633.2,-1014.25 59640.2,-1014.25"/>
</g>
<!-- layer9_agg_exp3 -->
<g id="node515" class="node">
<title>layer9_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="59619.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="59619.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="59619.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="59619.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="59619.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert3&#45;&gt;layer9_agg_exp3 -->
<g id="edge623" class="edge">
<title>layer9_expert3&#45;&gt;layer9_agg_exp3</title>
<path fill="none" stroke="black" d="M59636.7,-941.09C59636.7,-941.09 59636.7,-915.34 59636.7,-915.34"/>
<polygon fill="black" stroke="black" points="59640.2,-915.34 59636.7,-905.34 59633.2,-915.34 59640.2,-915.34"/>
</g>
<!-- layer9_agg_exp3&#45;&gt;layer9_moe_agg -->
<g id="edge624" class="edge">
<title>layer9_agg_exp3&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M59619.7,-831.35C59619.7,-789.16 59619.7,-726 59619.7,-726 59619.7,-726 61296.41,-726 61296.41,-726"/>
<polygon fill="black" stroke="black" points="61296.41,-729.5 61306.41,-726 61296.41,-722.5 61296.41,-729.5"/>
</g>
<!-- layer9_expert4 -->
<g id="node517" class="node">
<title>layer9_expert4</title>
<polygon fill="lightcoral" stroke="black" points="60159.2,-1004.16 59938.2,-1004.16 59938.2,-941.16 60159.2,-941.16 60159.2,-1004.16"/>
<text text-anchor="middle" x="60048.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="60048.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="60048.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="60048.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="60048.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp4&#45;&gt;layer9_expert4 -->
<g id="edge626" class="edge">
<title>layer9_route_exp4&#45;&gt;layer9_expert4</title>
<path fill="none" stroke="black" d="M60048.7,-1040.16C60048.7,-1040.16 60048.7,-1014.25 60048.7,-1014.25"/>
<polygon fill="black" stroke="black" points="60052.2,-1014.25 60048.7,-1004.25 60045.2,-1014.25 60052.2,-1014.25"/>
</g>
<!-- layer9_agg_exp4 -->
<g id="node518" class="node">
<title>layer9_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="60034.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="60034.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="60034.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="60034.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="60034.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert4&#45;&gt;layer9_agg_exp4 -->
<g id="edge627" class="edge">
<title>layer9_expert4&#45;&gt;layer9_agg_exp4</title>
<path fill="none" stroke="black" d="M60048.7,-941.09C60048.7,-941.09 60048.7,-915.34 60048.7,-915.34"/>
<polygon fill="black" stroke="black" points="60052.2,-915.34 60048.7,-905.34 60045.2,-915.34 60052.2,-915.34"/>
</g>
<!-- layer9_agg_exp4&#45;&gt;layer9_moe_agg -->
<g id="edge628" class="edge">
<title>layer9_agg_exp4&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M60034.7,-831.57C60034.7,-790.87 60034.7,-731 60034.7,-731 60034.7,-731 61283.88,-731 61283.88,-731"/>
<polygon fill="black" stroke="black" points="61283.88,-734.5 61293.88,-731 61283.88,-727.5 61283.88,-734.5"/>
</g>
<!-- layer9_expert5 -->
<g id="node520" class="node">
<title>layer9_expert5</title>
<polygon fill="lightcoral" stroke="black" points="60570.2,-1004.16 60349.2,-1004.16 60349.2,-941.16 60570.2,-941.16 60570.2,-1004.16"/>
<text text-anchor="middle" x="60459.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="60459.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="60459.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="60459.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="60459.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp5&#45;&gt;layer9_expert5 -->
<g id="edge630" class="edge">
<title>layer9_route_exp5&#45;&gt;layer9_expert5</title>
<path fill="none" stroke="black" d="M60459.7,-1040.16C60459.7,-1040.16 60459.7,-1014.25 60459.7,-1014.25"/>
<polygon fill="black" stroke="black" points="60463.2,-1014.25 60459.7,-1004.25 60456.2,-1014.25 60463.2,-1014.25"/>
</g>
<!-- layer9_agg_exp5 -->
<g id="node521" class="node">
<title>layer9_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="60449.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="60449.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="60449.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="60449.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="60449.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert5&#45;&gt;layer9_agg_exp5 -->
<g id="edge631" class="edge">
<title>layer9_expert5&#45;&gt;layer9_agg_exp5</title>
<path fill="none" stroke="black" d="M60459.7,-941.09C60459.7,-941.09 60459.7,-915.34 60459.7,-915.34"/>
<polygon fill="black" stroke="black" points="60463.2,-915.34 60459.7,-905.34 60456.2,-915.34 60463.2,-915.34"/>
</g>
<!-- layer9_agg_exp5&#45;&gt;layer9_moe_agg -->
<g id="edge632" class="edge">
<title>layer9_agg_exp5&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M60449.7,-831.51C60449.7,-792.34 60449.7,-736 60449.7,-736 60449.7,-736 61275.83,-736 61275.83,-736"/>
<polygon fill="black" stroke="black" points="61275.83,-739.5 61285.83,-736 61275.83,-732.5 61275.83,-739.5"/>
</g>
<!-- layer9_expert6 -->
<g id="node523" class="node">
<title>layer9_expert6</title>
<polygon fill="lightcoral" stroke="black" points="60983.2,-1004.16 60762.2,-1004.16 60762.2,-941.16 60983.2,-941.16 60983.2,-1004.16"/>
<text text-anchor="middle" x="60872.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="60872.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="60872.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="60872.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="60872.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp6&#45;&gt;layer9_expert6 -->
<g id="edge634" class="edge">
<title>layer9_route_exp6&#45;&gt;layer9_expert6</title>
<path fill="none" stroke="black" d="M60872.7,-1039.87C60872.7,-1039.87 60872.7,-1014.41 60872.7,-1014.41"/>
<polygon fill="black" stroke="black" points="60876.2,-1014.41 60872.7,-1004.41 60869.2,-1014.41 60876.2,-1014.41"/>
</g>
<!-- layer9_agg_exp6 -->
<g id="node524" class="node">
<title>layer9_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="60864.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="60864.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="60864.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="60864.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="60864.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert6&#45;&gt;layer9_agg_exp6 -->
<g id="edge635" class="edge">
<title>layer9_expert6&#45;&gt;layer9_agg_exp6</title>
<path fill="none" stroke="black" d="M60872.7,-941.09C60872.7,-941.09 60872.7,-915.34 60872.7,-915.34"/>
<polygon fill="black" stroke="black" points="60876.2,-915.34 60872.7,-905.34 60869.2,-915.34 60876.2,-915.34"/>
</g>
<!-- layer9_agg_exp6&#45;&gt;layer9_moe_agg -->
<g id="edge636" class="edge">
<title>layer9_agg_exp6&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M61055.3,-857.96C61055.3,-827.54 61055.3,-741 61055.3,-741 61055.3,-741 61272.05,-741 61272.05,-741"/>
<polygon fill="black" stroke="black" points="61272.05,-744.5 61282.05,-741 61272.05,-737.5 61272.05,-744.5"/>
</g>
<!-- layer9_expert7 -->
<g id="node526" class="node">
<title>layer9_expert7</title>
<polygon fill="lightcoral" stroke="black" points="61391.2,-1004.16 61170.2,-1004.16 61170.2,-941.16 61391.2,-941.16 61391.2,-1004.16"/>
<text text-anchor="middle" x="61280.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="61280.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="61280.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="61280.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="61280.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp7&#45;&gt;layer9_expert7 -->
<g id="edge638" class="edge">
<title>layer9_route_exp7&#45;&gt;layer9_expert7</title>
<path fill="none" stroke="black" d="M61280.7,-1039.87C61280.7,-1039.87 61280.7,-1014.41 61280.7,-1014.41"/>
<polygon fill="black" stroke="black" points="61284.2,-1014.41 61280.7,-1004.41 61277.2,-1014.41 61284.2,-1014.41"/>
</g>
<!-- layer9_agg_exp7 -->
<g id="node527" class="node">
<title>layer9_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="61279.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="61279.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="61279.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="61279.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="61279.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert7&#45;&gt;layer9_agg_exp7 -->
<g id="edge639" class="edge">
<title>layer9_expert7&#45;&gt;layer9_agg_exp7</title>
<path fill="none" stroke="black" d="M61280.7,-941.09C61280.7,-941.09 61280.7,-915.34 61280.7,-915.34"/>
<polygon fill="black" stroke="black" points="61284.2,-915.34 61280.7,-905.34 61277.2,-915.34 61284.2,-915.34"/>
</g>
<!-- layer9_agg_exp7&#45;&gt;layer9_moe_agg -->
<g id="edge640" class="edge">
<title>layer9_agg_exp7&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M61380.02,-836.58C61380.02,-836.58 61380.02,-785.37 61380.02,-785.37"/>
<polygon fill="black" stroke="black" points="61383.52,-785.37 61380.02,-775.37 61376.52,-785.37 61383.52,-785.37"/>
</g>
<!-- layer9_expert8 -->
<g id="node529" class="node">
<title>layer9_expert8</title>
<polygon fill="lightcoral" stroke="black" points="61804.2,-1004.16 61583.2,-1004.16 61583.2,-941.16 61804.2,-941.16 61804.2,-1004.16"/>
<text text-anchor="middle" x="61693.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="61693.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="61693.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="61693.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="61693.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp8&#45;&gt;layer9_expert8 -->
<g id="edge642" class="edge">
<title>layer9_route_exp8&#45;&gt;layer9_expert8</title>
<path fill="none" stroke="black" d="M61693.7,-1039.87C61693.7,-1039.87 61693.7,-1014.41 61693.7,-1014.41"/>
<polygon fill="black" stroke="black" points="61697.2,-1014.41 61693.7,-1004.41 61690.2,-1014.41 61697.2,-1014.41"/>
</g>
<!-- layer9_agg_exp8 -->
<g id="node530" class="node">
<title>layer9_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="61694.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="61694.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="61694.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="61694.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="61694.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert8&#45;&gt;layer9_agg_exp8 -->
<g id="edge643" class="edge">
<title>layer9_expert8&#45;&gt;layer9_agg_exp8</title>
<path fill="none" stroke="black" d="M61693.7,-941.09C61693.7,-941.09 61693.7,-915.34 61693.7,-915.34"/>
<polygon fill="black" stroke="black" points="61697.2,-915.34 61693.7,-905.34 61690.2,-915.34 61697.2,-915.34"/>
</g>
<!-- layer9_agg_exp8&#45;&gt;layer9_moe_agg -->
<g id="edge644" class="edge">
<title>layer9_agg_exp8&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M61593.88,-836.58C61593.88,-836.58 61593.88,-785.37 61593.88,-785.37"/>
<polygon fill="black" stroke="black" points="61597.38,-785.37 61593.88,-775.37 61590.38,-785.37 61597.38,-785.37"/>
</g>
<!-- layer9_expert9 -->
<g id="node532" class="node">
<title>layer9_expert9</title>
<polygon fill="lightcoral" stroke="black" points="62217.2,-1004.16 61996.2,-1004.16 61996.2,-941.16 62217.2,-941.16 62217.2,-1004.16"/>
<text text-anchor="middle" x="62106.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="62106.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="62106.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="62106.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="62106.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp9&#45;&gt;layer9_expert9 -->
<g id="edge646" class="edge">
<title>layer9_route_exp9&#45;&gt;layer9_expert9</title>
<path fill="none" stroke="black" d="M62106.7,-1039.87C62106.7,-1039.87 62106.7,-1014.41 62106.7,-1014.41"/>
<polygon fill="black" stroke="black" points="62110.2,-1014.41 62106.7,-1004.41 62103.2,-1014.41 62110.2,-1014.41"/>
</g>
<!-- layer9_agg_exp9 -->
<g id="node533" class="node">
<title>layer9_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="62109.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="62109.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="62109.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="62109.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="62109.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert9&#45;&gt;layer9_agg_exp9 -->
<g id="edge647" class="edge">
<title>layer9_expert9&#45;&gt;layer9_agg_exp9</title>
<path fill="none" stroke="black" d="M62106.7,-941.09C62106.7,-941.09 62106.7,-915.34 62106.7,-915.34"/>
<polygon fill="black" stroke="black" points="62110.2,-915.34 62106.7,-905.34 62103.2,-915.34 62110.2,-915.34"/>
</g>
<!-- layer9_agg_exp9&#45;&gt;layer9_moe_agg -->
<g id="edge648" class="edge">
<title>layer9_agg_exp9&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M62109.7,-831.48C62109.7,-805.37 62109.7,-775 62109.7,-775 62109.7,-775 61603.79,-775 61603.79,-775"/>
<polygon fill="black" stroke="black" points="61603.79,-771.5 61593.79,-775 61603.79,-778.5 61603.79,-771.5"/>
</g>
<!-- layer9_expert10 -->
<g id="node535" class="node">
<title>layer9_expert10</title>
<polygon fill="lightcoral" stroke="black" points="62632.2,-1004.16 62411.2,-1004.16 62411.2,-941.16 62632.2,-941.16 62632.2,-1004.16"/>
<text text-anchor="middle" x="62521.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="62521.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="62521.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="62521.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="62521.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp10&#45;&gt;layer9_expert10 -->
<g id="edge650" class="edge">
<title>layer9_route_exp10&#45;&gt;layer9_expert10</title>
<path fill="none" stroke="black" d="M62521.7,-1039.87C62521.7,-1039.87 62521.7,-1014.41 62521.7,-1014.41"/>
<polygon fill="black" stroke="black" points="62525.2,-1014.41 62521.7,-1004.41 62518.2,-1014.41 62525.2,-1014.41"/>
</g>
<!-- layer9_agg_exp10 -->
<g id="node536" class="node">
<title>layer9_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="62524.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="62524.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="62524.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="62524.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="62524.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert10&#45;&gt;layer9_agg_exp10 -->
<g id="edge651" class="edge">
<title>layer9_expert10&#45;&gt;layer9_agg_exp10</title>
<path fill="none" stroke="black" d="M62521.7,-941.09C62521.7,-941.09 62521.7,-915.34 62521.7,-915.34"/>
<polygon fill="black" stroke="black" points="62525.2,-915.34 62521.7,-905.34 62518.2,-915.34 62525.2,-915.34"/>
</g>
<!-- layer9_agg_exp10&#45;&gt;layer9_moe_agg -->
<g id="edge652" class="edge">
<title>layer9_agg_exp10&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M62524.7,-831.47C62524.7,-803.55 62524.7,-770 62524.7,-770 62524.7,-770 61639.66,-770 61639.66,-770"/>
<polygon fill="black" stroke="black" points="61639.66,-766.5 61629.66,-770 61639.66,-773.5 61639.66,-766.5"/>
</g>
<!-- layer9_expert11 -->
<g id="node538" class="node">
<title>layer9_expert11</title>
<polygon fill="lightcoral" stroke="black" points="63046.2,-1004.16 62825.2,-1004.16 62825.2,-941.16 63046.2,-941.16 63046.2,-1004.16"/>
<text text-anchor="middle" x="62935.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="62935.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="62935.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="62935.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="62935.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp11&#45;&gt;layer9_expert11 -->
<g id="edge654" class="edge">
<title>layer9_route_exp11&#45;&gt;layer9_expert11</title>
<path fill="none" stroke="black" d="M62935.7,-1039.87C62935.7,-1039.87 62935.7,-1014.41 62935.7,-1014.41"/>
<polygon fill="black" stroke="black" points="62939.2,-1014.41 62935.7,-1004.41 62932.2,-1014.41 62939.2,-1014.41"/>
</g>
<!-- layer9_agg_exp11 -->
<g id="node539" class="node">
<title>layer9_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="62939.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="62939.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="62939.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="62939.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="62939.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert11&#45;&gt;layer9_agg_exp11 -->
<g id="edge655" class="edge">
<title>layer9_expert11&#45;&gt;layer9_agg_exp11</title>
<path fill="none" stroke="black" d="M62935.7,-941.09C62935.7,-941.09 62935.7,-915.34 62935.7,-915.34"/>
<polygon fill="black" stroke="black" points="62939.2,-915.34 62935.7,-905.34 62932.2,-915.34 62939.2,-915.34"/>
</g>
<!-- layer9_agg_exp11&#45;&gt;layer9_moe_agg -->
<g id="edge656" class="edge">
<title>layer9_agg_exp11&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M62939.7,-831.35C62939.7,-801.69 62939.7,-765 62939.7,-765 62939.7,-765 61663.73,-765 61663.73,-765"/>
<polygon fill="black" stroke="black" points="61663.73,-761.5 61653.73,-765 61663.73,-768.5 61663.73,-761.5"/>
</g>
<!-- layer9_expert12 -->
<g id="node541" class="node">
<title>layer9_expert12</title>
<polygon fill="lightcoral" stroke="black" points="63455.2,-1004.16 63234.2,-1004.16 63234.2,-941.16 63455.2,-941.16 63455.2,-1004.16"/>
<text text-anchor="middle" x="63344.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="63344.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="63344.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="63344.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="63344.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp12&#45;&gt;layer9_expert12 -->
<g id="edge658" class="edge">
<title>layer9_route_exp12&#45;&gt;layer9_expert12</title>
<path fill="none" stroke="black" d="M63344.7,-1039.87C63344.7,-1039.87 63344.7,-1014.41 63344.7,-1014.41"/>
<polygon fill="black" stroke="black" points="63348.2,-1014.41 63344.7,-1004.41 63341.2,-1014.41 63348.2,-1014.41"/>
</g>
<!-- layer9_agg_exp12 -->
<g id="node542" class="node">
<title>layer9_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="63354.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="63354.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="63354.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="63354.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="63354.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert12&#45;&gt;layer9_agg_exp12 -->
<g id="edge659" class="edge">
<title>layer9_expert12&#45;&gt;layer9_agg_exp12</title>
<path fill="none" stroke="black" d="M63344.7,-941.09C63344.7,-941.09 63344.7,-915.34 63344.7,-915.34"/>
<polygon fill="black" stroke="black" points="63348.2,-915.34 63344.7,-905.34 63341.2,-915.34 63348.2,-915.34"/>
</g>
<!-- layer9_agg_exp12&#45;&gt;layer9_moe_agg -->
<g id="edge660" class="edge">
<title>layer9_agg_exp12&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M63354.7,-831.39C63354.7,-799.99 63354.7,-760 63354.7,-760 63354.7,-760 61680.49,-760 61680.49,-760"/>
<polygon fill="black" stroke="black" points="61680.49,-756.5 61670.49,-760 61680.49,-763.5 61680.49,-756.5"/>
</g>
<!-- layer9_expert13 -->
<g id="node544" class="node">
<title>layer9_expert13</title>
<polygon fill="lightcoral" stroke="black" points="63870.2,-1004.16 63649.2,-1004.16 63649.2,-941.16 63870.2,-941.16 63870.2,-1004.16"/>
<text text-anchor="middle" x="63759.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="63759.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="63759.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="63759.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="63759.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp13&#45;&gt;layer9_expert13 -->
<g id="edge662" class="edge">
<title>layer9_route_exp13&#45;&gt;layer9_expert13</title>
<path fill="none" stroke="black" d="M63759.7,-1040.16C63759.7,-1040.16 63759.7,-1014.25 63759.7,-1014.25"/>
<polygon fill="black" stroke="black" points="63763.2,-1014.25 63759.7,-1004.25 63756.2,-1014.25 63763.2,-1014.25"/>
</g>
<!-- layer9_agg_exp13 -->
<g id="node545" class="node">
<title>layer9_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="63769.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="63769.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="63769.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="63769.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="63769.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert13&#45;&gt;layer9_agg_exp13 -->
<g id="edge663" class="edge">
<title>layer9_expert13&#45;&gt;layer9_agg_exp13</title>
<path fill="none" stroke="black" d="M63759.7,-941.09C63759.7,-941.09 63759.7,-915.34 63759.7,-915.34"/>
<polygon fill="black" stroke="black" points="63763.2,-915.34 63759.7,-905.34 63756.2,-915.34 63763.2,-915.34"/>
</g>
<!-- layer9_agg_exp13&#45;&gt;layer9_moe_agg -->
<g id="edge664" class="edge">
<title>layer9_agg_exp13&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M63769.7,-831.57C63769.7,-798.47 63769.7,-755 63769.7,-755 63769.7,-755 61691.84,-755 61691.84,-755"/>
<polygon fill="black" stroke="black" points="61691.84,-751.5 61681.84,-755 61691.84,-758.5 61691.84,-751.5"/>
</g>
<!-- layer9_expert14 -->
<g id="node547" class="node">
<title>layer9_expert14</title>
<polygon fill="lightcoral" stroke="black" points="64285.2,-1004.16 64064.2,-1004.16 64064.2,-941.16 64285.2,-941.16 64285.2,-1004.16"/>
<text text-anchor="middle" x="64174.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="64174.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="64174.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="64174.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="64174.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp14&#45;&gt;layer9_expert14 -->
<g id="edge666" class="edge">
<title>layer9_route_exp14&#45;&gt;layer9_expert14</title>
<path fill="none" stroke="black" d="M64174.7,-1040.16C64174.7,-1040.16 64174.7,-1014.25 64174.7,-1014.25"/>
<polygon fill="black" stroke="black" points="64178.2,-1014.25 64174.7,-1004.25 64171.2,-1014.25 64178.2,-1014.25"/>
</g>
<!-- layer9_agg_exp14 -->
<g id="node548" class="node">
<title>layer9_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="64184.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="64184.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="64184.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="64184.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="64184.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert14&#45;&gt;layer9_agg_exp14 -->
<g id="edge667" class="edge">
<title>layer9_expert14&#45;&gt;layer9_agg_exp14</title>
<path fill="none" stroke="black" d="M64174.7,-941.09C64174.7,-941.09 64174.7,-915.34 64174.7,-915.34"/>
<polygon fill="black" stroke="black" points="64178.2,-915.34 64174.7,-905.34 64171.2,-915.34 64178.2,-915.34"/>
</g>
<!-- layer9_agg_exp14&#45;&gt;layer9_moe_agg -->
<g id="edge668" class="edge">
<title>layer9_agg_exp14&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M64184.7,-831.58C64184.7,-796.82 64184.7,-750 64184.7,-750 64184.7,-750 61698.66,-750 61698.66,-750"/>
<polygon fill="black" stroke="black" points="61698.66,-746.5 61688.66,-750 61698.66,-753.5 61698.66,-746.5"/>
</g>
<!-- layer9_expert15 -->
<g id="node550" class="node">
<title>layer9_expert15</title>
<polygon fill="lightcoral" stroke="black" points="64700.2,-1004.16 64479.2,-1004.16 64479.2,-941.16 64700.2,-941.16 64700.2,-1004.16"/>
<text text-anchor="middle" x="64589.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="64589.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="64589.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="64589.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="64589.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer9_route_exp15&#45;&gt;layer9_expert15 -->
<g id="edge670" class="edge">
<title>layer9_route_exp15&#45;&gt;layer9_expert15</title>
<path fill="none" stroke="black" d="M64589.7,-1040.16C64589.7,-1040.16 64589.7,-1014.25 64589.7,-1014.25"/>
<polygon fill="black" stroke="black" points="64593.2,-1014.25 64589.7,-1004.25 64586.2,-1014.25 64593.2,-1014.25"/>
</g>
<!-- layer9_agg_exp15 -->
<g id="node551" class="node">
<title>layer9_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="64599.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="64599.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="64599.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="64599.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="64599.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer9_expert15&#45;&gt;layer9_agg_exp15 -->
<g id="edge671" class="edge">
<title>layer9_expert15&#45;&gt;layer9_agg_exp15</title>
<path fill="none" stroke="black" d="M64589.7,-941.09C64589.7,-941.09 64589.7,-915.34 64589.7,-915.34"/>
<polygon fill="black" stroke="black" points="64593.2,-915.34 64589.7,-905.34 64586.2,-915.34 64593.2,-915.34"/>
</g>
<!-- layer9_agg_exp15&#45;&gt;layer9_moe_agg -->
<g id="edge672" class="edge">
<title>layer9_agg_exp15&#45;&gt;layer9_moe_agg</title>
<path fill="none" stroke="black" d="M64599.7,-831.33C64599.7,-795.31 64599.7,-746 64599.7,-746 64599.7,-746 61701.55,-746 61701.55,-746"/>
<polygon fill="black" stroke="black" points="61701.55,-742.5 61691.55,-746 61701.55,-749.5 61701.55,-742.5"/>
</g>
<!-- layer10_ln1 -->
<g id="node553" class="node">
<title>layer10_ln1</title>
<polygon fill="none" stroke="black" points="64746.2,-1227.7 64465.2,-1227.7 64465.2,-1175.7 64746.2,-1175.7 64746.2,-1227.7"/>
<text text-anchor="middle" x="64605.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 10</text>
<text text-anchor="middle" x="64605.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="64605.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="64605.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer10_add1 -->
<g id="node554" class="node">
<title>layer10_add1</title>
<polygon fill="yellow" stroke="black" points="67968.2,-644.85 67687.2,-644.85 67687.2,-592.85 67968.2,-592.85 67968.2,-644.85"/>
<text text-anchor="middle" x="67827.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 10</text>
<text text-anchor="middle" x="67827.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="67827.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="67827.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_moe_output -->
<g id="node558" class="node">
<title>layer10_moe_output</title>
<polygon fill="yellow" stroke="black" points="68117.2,-540.58 67836.2,-540.58 67836.2,-488.58 68117.2,-488.58 68117.2,-540.58"/>
<text text-anchor="middle" x="67976.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 10</text>
<text text-anchor="middle" x="67976.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="67976.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="67976.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_add1&#45;&gt;layer10_moe_output -->
<g id="edge742" class="edge">
<title>layer10_add1&#45;&gt;layer10_moe_output</title>
<path fill="none" stroke="black" d="M67902.2,-592.81C67902.2,-592.81 67902.2,-550.65 67902.2,-550.65"/>
<polygon fill="black" stroke="black" points="67905.7,-550.65 67902.2,-540.65 67898.7,-550.65 67905.7,-550.65"/>
</g>
<!-- layer10_gate -->
<g id="node555" class="node">
<title>layer10_gate</title>
<polygon fill="lightgreen" stroke="black" points="68421.13,-1253.7 67962.3,-1253.7 67844.26,-1149.7 68303.1,-1149.7 68421.13,-1253.7"/>
<text text-anchor="middle" x="68132.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 10</text>
<text text-anchor="middle" x="68132.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="68132.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="68132.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer10_route_exp0 -->
<g id="node559" class="node">
<title>layer10_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="65015.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="65015.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="65015.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="65015.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="65015.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp0 -->
<g id="edge676" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp0</title>
<path fill="none" stroke="black" d="M67870.63,-1173C67120.04,-1173 65015.7,-1173 65015.7,-1173 65015.7,-1173 65015.7,-1123.8 65015.7,-1123.8"/>
<polygon fill="black" stroke="black" points="65019.2,-1123.8 65015.7,-1113.8 65012.2,-1123.8 65019.2,-1123.8"/>
</g>
<!-- layer10_route_exp1 -->
<g id="node562" class="node">
<title>layer10_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="65460.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="65460.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="65460.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="65460.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="65460.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp1 -->
<g id="edge680" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp1</title>
<path fill="none" stroke="black" d="M67864.88,-1168C67187.73,-1168 65460.7,-1168 65460.7,-1168 65460.7,-1168 65460.7,-1123.71 65460.7,-1123.71"/>
<polygon fill="black" stroke="black" points="65464.2,-1123.71 65460.7,-1113.71 65457.2,-1123.71 65464.2,-1123.71"/>
</g>
<!-- layer10_route_exp2 -->
<g id="node565" class="node">
<title>layer10_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="65885.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="65885.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="65885.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="65885.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="65885.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp2 -->
<g id="edge684" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp2</title>
<path fill="none" stroke="black" d="M67861.38,-1165C67263.59,-1165 65885.7,-1165 65885.7,-1165 65885.7,-1165 65885.7,-1123.77 65885.7,-1123.77"/>
<polygon fill="black" stroke="black" points="65889.2,-1123.77 65885.7,-1113.77 65882.2,-1123.77 65889.2,-1123.77"/>
</g>
<!-- layer10_route_exp3 -->
<g id="node568" class="node">
<title>layer10_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="66300.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="66300.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="66300.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="66300.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="66300.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp3 -->
<g id="edge688" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp3</title>
<path fill="none" stroke="black" d="M67856.94,-1161C67345.33,-1161 66300.7,-1161 66300.7,-1161 66300.7,-1161 66300.7,-1124.05 66300.7,-1124.05"/>
<polygon fill="black" stroke="black" points="66304.2,-1124.05 66300.7,-1114.05 66297.2,-1124.05 66304.2,-1124.05"/>
</g>
<!-- layer10_route_exp4 -->
<g id="node571" class="node">
<title>layer10_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="66710.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="66710.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="66710.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="66710.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="66710.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp4 -->
<g id="edge692" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp4</title>
<path fill="none" stroke="black" d="M67853.45,-1158C67439.33,-1158 66710.7,-1158 66710.7,-1158 66710.7,-1158 66710.7,-1124.14 66710.7,-1124.14"/>
<polygon fill="black" stroke="black" points="66714.2,-1124.14 66710.7,-1114.14 66707.2,-1124.14 66714.2,-1124.14"/>
</g>
<!-- layer10_route_exp5 -->
<g id="node574" class="node">
<title>layer10_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="67117.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="67117.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="67117.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="67117.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="67117.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp5 -->
<g id="edge696" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp5</title>
<path fill="none" stroke="black" d="M67848.95,-1154C67548.66,-1154 67117.7,-1154 67117.7,-1154 67117.7,-1154 67117.7,-1124.11 67117.7,-1124.11"/>
<polygon fill="black" stroke="black" points="67121.2,-1124.11 67117.7,-1114.11 67114.2,-1124.11 67121.2,-1124.11"/>
</g>
<!-- layer10_route_exp6 -->
<g id="node577" class="node">
<title>layer10_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="67523.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="67523.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="67523.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="67523.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="67523.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp6 -->
<g id="edge700" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp6</title>
<path fill="none" stroke="black" d="M67845.58,-1151C67687.77,-1151 67523.7,-1151 67523.7,-1151 67523.7,-1151 67523.7,-1123.96 67523.7,-1123.96"/>
<polygon fill="black" stroke="black" points="67527.2,-1123.96 67523.7,-1113.96 67520.2,-1123.96 67527.2,-1123.96"/>
</g>
<!-- layer10_route_exp7 -->
<g id="node580" class="node">
<title>layer10_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="67929.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="67929.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="67929.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="67929.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="67929.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp7 -->
<g id="edge704" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp7</title>
<path fill="none" stroke="black" d="M67983.96,-1149.5C67983.96,-1149.5 67983.96,-1122.25 67983.96,-1122.25"/>
<polygon fill="black" stroke="black" points="67987.46,-1122.25 67983.96,-1112.25 67980.46,-1122.25 67987.46,-1122.25"/>
</g>
<!-- layer10_route_exp8 -->
<g id="node583" class="node">
<title>layer10_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="68334.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="68334.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="68334.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="68334.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="68334.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp8 -->
<g id="edge708" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp8</title>
<path fill="none" stroke="black" d="M68280.93,-1149.5C68280.93,-1149.5 68280.93,-1122.25 68280.93,-1122.25"/>
<polygon fill="black" stroke="black" points="68284.43,-1122.25 68280.93,-1112.25 68277.43,-1122.25 68284.43,-1122.25"/>
</g>
<!-- layer10_route_exp9 -->
<g id="node586" class="node">
<title>layer10_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="68744.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="68744.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="68744.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="68744.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="68744.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp9 -->
<g id="edge712" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp9</title>
<path fill="none" stroke="black" d="M68307.25,-1153C68488.14,-1153 68744.7,-1153 68744.7,-1153 68744.7,-1153 68744.7,-1124.07 68744.7,-1124.07"/>
<polygon fill="black" stroke="black" points="68748.2,-1124.07 68744.7,-1114.07 68741.2,-1124.07 68748.2,-1124.07"/>
</g>
<!-- layer10_route_exp10 -->
<g id="node589" class="node">
<title>layer10_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="69156.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="69156.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="69156.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="69156.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="69156.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp10 -->
<g id="edge716" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp10</title>
<path fill="none" stroke="black" d="M68310.48,-1156C68603.71,-1156 69156.7,-1156 69156.7,-1156 69156.7,-1156 69156.7,-1124.15 69156.7,-1124.15"/>
<polygon fill="black" stroke="black" points="69160.2,-1124.15 69156.7,-1114.15 69153.2,-1124.15 69160.2,-1124.15"/>
</g>
<!-- layer10_route_exp11 -->
<g id="node592" class="node">
<title>layer10_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="69570.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="69570.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="69570.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="69570.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="69570.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp11 -->
<g id="edge720" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp11</title>
<path fill="none" stroke="black" d="M68314.82,-1160C68701.77,-1160 69570.7,-1160 69570.7,-1160 69570.7,-1160 69570.7,-1124.09 69570.7,-1124.09"/>
<polygon fill="black" stroke="black" points="69574.2,-1124.09 69570.7,-1114.09 69567.2,-1124.09 69574.2,-1124.09"/>
</g>
<!-- layer10_route_exp12 -->
<g id="node595" class="node">
<title>layer10_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="69984.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="69984.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="69984.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="69984.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="69984.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp12 -->
<g id="edge724" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp12</title>
<path fill="none" stroke="black" d="M68318.33,-1163C68787.67,-1163 69984.7,-1163 69984.7,-1163 69984.7,-1163 69984.7,-1123.93 69984.7,-1123.93"/>
<polygon fill="black" stroke="black" points="69988.2,-1123.93 69984.7,-1113.93 69981.2,-1123.93 69988.2,-1123.93"/>
</g>
<!-- layer10_route_exp13 -->
<g id="node598" class="node">
<title>layer10_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="70394.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="70394.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="70394.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="70394.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="70394.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp13 -->
<g id="edge728" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp13</title>
<path fill="none" stroke="black" d="M68323.12,-1167C68868.04,-1167 70394.7,-1167 70394.7,-1167 70394.7,-1167 70394.7,-1123.82 70394.7,-1123.82"/>
<polygon fill="black" stroke="black" points="70398.2,-1123.82 70394.7,-1113.82 70391.2,-1123.82 70398.2,-1123.82"/>
</g>
<!-- layer10_route_exp14 -->
<g id="node601" class="node">
<title>layer10_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="70809.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="70809.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="70809.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="70809.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="70809.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp14 -->
<g id="edge732" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp14</title>
<path fill="none" stroke="black" d="M68326.3,-1170C68941.22,-1170 70809.7,-1170 70809.7,-1170 70809.7,-1170 70809.7,-1123.71 70809.7,-1123.71"/>
<polygon fill="black" stroke="black" points="70813.2,-1123.71 70809.7,-1113.71 70806.2,-1123.71 70813.2,-1123.71"/>
</g>
<!-- layer10_route_exp15 -->
<g id="node604" class="node">
<title>layer10_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="71222.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="71222.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="71222.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="71222.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="71222.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_route_exp15 -->
<g id="edge736" class="edge">
<title>layer10_gate&#45;&gt;layer10_route_exp15</title>
<path fill="none" stroke="black" d="M68328.63,-1172C69008.22,-1172 71222.7,-1172 71222.7,-1172 71222.7,-1172 71222.7,-1123.96 71222.7,-1123.96"/>
<polygon fill="black" stroke="black" points="71226.2,-1123.96 71222.7,-1113.96 71219.2,-1123.96 71226.2,-1123.96"/>
</g>
<!-- layer10_moe_agg -->
<g id="node556" class="node">
<title>layer10_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="68126.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="68126.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 10</text>
<text text-anchor="middle" x="68126.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="68126.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="68126.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer10_ln2 -->
<g id="node557" class="node">
<title>layer10_ln2</title>
<polygon fill="none" stroke="black" points="68267.2,-644.85 67986.2,-644.85 67986.2,-592.85 68267.2,-592.85 68267.2,-644.85"/>
<text text-anchor="middle" x="68126.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 10</text>
<text text-anchor="middle" x="68126.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="68126.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="68126.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer10_moe_agg&#45;&gt;layer10_ln2 -->
<g id="edge740" class="edge">
<title>layer10_moe_agg&#45;&gt;layer10_ln2</title>
<path fill="none" stroke="black" d="M68126.7,-706.52C68126.7,-706.52 68126.7,-654.92 68126.7,-654.92"/>
<polygon fill="black" stroke="black" points="68130.2,-654.92 68126.7,-644.92 68123.2,-654.92 68130.2,-654.92"/>
</g>
<!-- layer10_ln2&#45;&gt;layer10_moe_output -->
<g id="edge741" class="edge">
<title>layer10_ln2&#45;&gt;layer10_moe_output</title>
<path fill="none" stroke="black" d="M68051.7,-592.81C68051.7,-592.81 68051.7,-550.65 68051.7,-550.65"/>
<polygon fill="black" stroke="black" points="68055.2,-550.65 68051.7,-540.65 68048.2,-550.65 68055.2,-550.65"/>
</g>
<!-- layer11_mha -->
<g id="node607" class="node">
<title>layer11_mha</title>
<polygon fill="lightcyan" stroke="black" points="68117.2,-436.31 67836.2,-436.31 67836.2,-384.31 68117.2,-384.31 68117.2,-436.31"/>
<text text-anchor="middle" x="67976.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 11</text>
<text text-anchor="middle" x="67976.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="67976.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="67976.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer10_moe_output&#45;&gt;layer11_mha -->
<g id="edge1088" class="edge">
<title>layer10_moe_output&#45;&gt;layer11_mha</title>
<path fill="none" stroke="black" d="M67976.7,-488.54C67976.7,-488.54 67976.7,-446.38 67976.7,-446.38"/>
<polygon fill="black" stroke="black" points="67980.2,-446.38 67976.7,-436.38 67973.2,-446.38 67980.2,-446.38"/>
</g>
<!-- layer10_expert0 -->
<g id="node560" class="node">
<title>layer10_expert0</title>
<polygon fill="lightcoral" stroke="black" points="65125.2,-1004.16 64904.2,-1004.16 64904.2,-941.16 65125.2,-941.16 65125.2,-1004.16"/>
<text text-anchor="middle" x="65014.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="65014.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="65014.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="65014.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="65014.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp0&#45;&gt;layer10_expert0 -->
<g id="edge677" class="edge">
<title>layer10_route_exp0&#45;&gt;layer10_expert0</title>
<path fill="none" stroke="black" d="M65014.7,-1039.87C65014.7,-1039.87 65014.7,-1014.41 65014.7,-1014.41"/>
<polygon fill="black" stroke="black" points="65018.2,-1014.41 65014.7,-1004.41 65011.2,-1014.41 65018.2,-1014.41"/>
</g>
<!-- layer10_agg_exp0 -->
<g id="node561" class="node">
<title>layer10_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="65014.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="65014.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="65014.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="65014.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="65014.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert0&#45;&gt;layer10_agg_exp0 -->
<g id="edge678" class="edge">
<title>layer10_expert0&#45;&gt;layer10_agg_exp0</title>
<path fill="none" stroke="black" d="M65014.7,-941.09C65014.7,-941.09 65014.7,-915.34 65014.7,-915.34"/>
<polygon fill="black" stroke="black" points="65018.2,-915.34 65014.7,-905.34 65011.2,-915.34 65018.2,-915.34"/>
</g>
<!-- layer10_agg_exp0&#45;&gt;layer10_moe_agg -->
<g id="edge679" class="edge">
<title>layer10_agg_exp0&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M65014.7,-831.49C65014.7,-784.97 65014.7,-711 65014.7,-711 65014.7,-711 68021.86,-711 68021.86,-711"/>
<polygon fill="black" stroke="black" points="68021.86,-714.5 68031.86,-711 68021.86,-707.5 68021.86,-714.5"/>
</g>
<!-- layer10_expert1 -->
<g id="node563" class="node">
<title>layer10_expert1</title>
<polygon fill="lightcoral" stroke="black" points="65555.2,-1004.16 65334.2,-1004.16 65334.2,-941.16 65555.2,-941.16 65555.2,-1004.16"/>
<text text-anchor="middle" x="65444.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="65444.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="65444.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="65444.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="65444.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp1&#45;&gt;layer10_expert1 -->
<g id="edge681" class="edge">
<title>layer10_route_exp1&#45;&gt;layer10_expert1</title>
<path fill="none" stroke="black" d="M65444.7,-1040.16C65444.7,-1040.16 65444.7,-1014.25 65444.7,-1014.25"/>
<polygon fill="black" stroke="black" points="65448.2,-1014.25 65444.7,-1004.25 65441.2,-1014.25 65448.2,-1014.25"/>
</g>
<!-- layer10_agg_exp1 -->
<g id="node564" class="node">
<title>layer10_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="65429.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="65429.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="65429.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="65429.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="65429.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert1&#45;&gt;layer10_agg_exp1 -->
<g id="edge682" class="edge">
<title>layer10_expert1&#45;&gt;layer10_agg_exp1</title>
<path fill="none" stroke="black" d="M65444.7,-941.09C65444.7,-941.09 65444.7,-915.34 65444.7,-915.34"/>
<polygon fill="black" stroke="black" points="65448.2,-915.34 65444.7,-905.34 65441.2,-915.34 65448.2,-915.34"/>
</g>
<!-- layer10_agg_exp1&#45;&gt;layer10_moe_agg -->
<g id="edge683" class="edge">
<title>layer10_agg_exp1&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M65429.7,-831.5C65429.7,-786.4 65429.7,-716 65429.7,-716 65429.7,-716 67981.1,-716 67981.1,-716"/>
<polygon fill="black" stroke="black" points="67981.1,-719.5 67991.1,-716 67981.1,-712.5 67981.1,-719.5"/>
</g>
<!-- layer10_expert2 -->
<g id="node566" class="node">
<title>layer10_expert2</title>
<polygon fill="lightcoral" stroke="black" points="65975.2,-1004.16 65754.2,-1004.16 65754.2,-941.16 65975.2,-941.16 65975.2,-1004.16"/>
<text text-anchor="middle" x="65864.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="65864.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="65864.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="65864.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="65864.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp2&#45;&gt;layer10_expert2 -->
<g id="edge685" class="edge">
<title>layer10_route_exp2&#45;&gt;layer10_expert2</title>
<path fill="none" stroke="black" d="M65864.7,-1040.16C65864.7,-1040.16 65864.7,-1014.25 65864.7,-1014.25"/>
<polygon fill="black" stroke="black" points="65868.2,-1014.25 65864.7,-1004.25 65861.2,-1014.25 65868.2,-1014.25"/>
</g>
<!-- layer10_agg_exp2 -->
<g id="node567" class="node">
<title>layer10_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="65844.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="65844.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="65844.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="65844.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="65844.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert2&#45;&gt;layer10_agg_exp2 -->
<g id="edge686" class="edge">
<title>layer10_expert2&#45;&gt;layer10_agg_exp2</title>
<path fill="none" stroke="black" d="M65864.7,-941.09C65864.7,-941.09 65864.7,-914.97 65864.7,-914.97"/>
<polygon fill="black" stroke="black" points="65868.2,-914.97 65864.7,-904.97 65861.2,-914.97 65868.2,-914.97"/>
</g>
<!-- layer10_agg_exp2&#45;&gt;layer10_moe_agg -->
<g id="edge687" class="edge">
<title>layer10_agg_exp2&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M65844.7,-831.58C65844.7,-787.92 65844.7,-721 65844.7,-721 65844.7,-721 67954.87,-721 67954.87,-721"/>
<polygon fill="black" stroke="black" points="67954.87,-724.5 67964.87,-721 67954.87,-717.5 67954.87,-724.5"/>
</g>
<!-- layer10_expert3 -->
<g id="node569" class="node">
<title>layer10_expert3</title>
<polygon fill="lightcoral" stroke="black" points="66390.2,-1004.16 66169.2,-1004.16 66169.2,-941.16 66390.2,-941.16 66390.2,-1004.16"/>
<text text-anchor="middle" x="66279.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="66279.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="66279.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="66279.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="66279.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp3&#45;&gt;layer10_expert3 -->
<g id="edge689" class="edge">
<title>layer10_route_exp3&#45;&gt;layer10_expert3</title>
<path fill="none" stroke="black" d="M66279.7,-1040.16C66279.7,-1040.16 66279.7,-1014.25 66279.7,-1014.25"/>
<polygon fill="black" stroke="black" points="66283.2,-1014.25 66279.7,-1004.25 66276.2,-1014.25 66283.2,-1014.25"/>
</g>
<!-- layer10_agg_exp3 -->
<g id="node570" class="node">
<title>layer10_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="66259.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="66259.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="66259.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="66259.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="66259.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert3&#45;&gt;layer10_agg_exp3 -->
<g id="edge690" class="edge">
<title>layer10_expert3&#45;&gt;layer10_agg_exp3</title>
<path fill="none" stroke="black" d="M66279.7,-941.09C66279.7,-941.09 66279.7,-914.97 66279.7,-914.97"/>
<polygon fill="black" stroke="black" points="66283.2,-914.97 66279.7,-904.97 66276.2,-914.97 66283.2,-914.97"/>
</g>
<!-- layer10_agg_exp3&#45;&gt;layer10_moe_agg -->
<g id="edge691" class="edge">
<title>layer10_agg_exp3&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M66259.7,-831.35C66259.7,-789.16 66259.7,-726 66259.7,-726 66259.7,-726 67936.41,-726 67936.41,-726"/>
<polygon fill="black" stroke="black" points="67936.41,-729.5 67946.41,-726 67936.41,-722.5 67936.41,-729.5"/>
</g>
<!-- layer10_expert4 -->
<g id="node572" class="node">
<title>layer10_expert4</title>
<polygon fill="lightcoral" stroke="black" points="66803.2,-1004.16 66582.2,-1004.16 66582.2,-941.16 66803.2,-941.16 66803.2,-1004.16"/>
<text text-anchor="middle" x="66692.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="66692.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="66692.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="66692.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="66692.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp4&#45;&gt;layer10_expert4 -->
<g id="edge693" class="edge">
<title>layer10_route_exp4&#45;&gt;layer10_expert4</title>
<path fill="none" stroke="black" d="M66692.7,-1040.16C66692.7,-1040.16 66692.7,-1014.25 66692.7,-1014.25"/>
<polygon fill="black" stroke="black" points="66696.2,-1014.25 66692.7,-1004.25 66689.2,-1014.25 66696.2,-1014.25"/>
</g>
<!-- layer10_agg_exp4 -->
<g id="node573" class="node">
<title>layer10_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="66674.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="66674.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="66674.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="66674.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="66674.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert4&#45;&gt;layer10_agg_exp4 -->
<g id="edge694" class="edge">
<title>layer10_expert4&#45;&gt;layer10_agg_exp4</title>
<path fill="none" stroke="black" d="M66692.7,-941.09C66692.7,-941.09 66692.7,-915.34 66692.7,-915.34"/>
<polygon fill="black" stroke="black" points="66696.2,-915.34 66692.7,-905.34 66689.2,-915.34 66696.2,-915.34"/>
</g>
<!-- layer10_agg_exp4&#45;&gt;layer10_moe_agg -->
<g id="edge695" class="edge">
<title>layer10_agg_exp4&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M66674.7,-831.57C66674.7,-790.87 66674.7,-731 66674.7,-731 66674.7,-731 67923.88,-731 67923.88,-731"/>
<polygon fill="black" stroke="black" points="67923.88,-734.5 67933.88,-731 67923.88,-727.5 67923.88,-734.5"/>
</g>
<!-- layer10_expert5 -->
<g id="node575" class="node">
<title>layer10_expert5</title>
<polygon fill="lightcoral" stroke="black" points="67214.2,-1004.16 66993.2,-1004.16 66993.2,-941.16 67214.2,-941.16 67214.2,-1004.16"/>
<text text-anchor="middle" x="67103.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="67103.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="67103.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="67103.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="67103.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp5&#45;&gt;layer10_expert5 -->
<g id="edge697" class="edge">
<title>layer10_route_exp5&#45;&gt;layer10_expert5</title>
<path fill="none" stroke="black" d="M67103.7,-1040.16C67103.7,-1040.16 67103.7,-1014.25 67103.7,-1014.25"/>
<polygon fill="black" stroke="black" points="67107.2,-1014.25 67103.7,-1004.25 67100.2,-1014.25 67107.2,-1014.25"/>
</g>
<!-- layer10_agg_exp5 -->
<g id="node576" class="node">
<title>layer10_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="67089.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="67089.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="67089.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="67089.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="67089.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert5&#45;&gt;layer10_agg_exp5 -->
<g id="edge698" class="edge">
<title>layer10_expert5&#45;&gt;layer10_agg_exp5</title>
<path fill="none" stroke="black" d="M67103.7,-941.09C67103.7,-941.09 67103.7,-915.34 67103.7,-915.34"/>
<polygon fill="black" stroke="black" points="67107.2,-915.34 67103.7,-905.34 67100.2,-915.34 67107.2,-915.34"/>
</g>
<!-- layer10_agg_exp5&#45;&gt;layer10_moe_agg -->
<g id="edge699" class="edge">
<title>layer10_agg_exp5&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M67089.7,-831.51C67089.7,-792.34 67089.7,-736 67089.7,-736 67089.7,-736 67915.83,-736 67915.83,-736"/>
<polygon fill="black" stroke="black" points="67915.83,-739.5 67925.83,-736 67915.83,-732.5 67915.83,-739.5"/>
</g>
<!-- layer10_expert6 -->
<g id="node578" class="node">
<title>layer10_expert6</title>
<polygon fill="lightcoral" stroke="black" points="67624.2,-1004.16 67403.2,-1004.16 67403.2,-941.16 67624.2,-941.16 67624.2,-1004.16"/>
<text text-anchor="middle" x="67513.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="67513.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="67513.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="67513.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="67513.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp6&#45;&gt;layer10_expert6 -->
<g id="edge701" class="edge">
<title>layer10_route_exp6&#45;&gt;layer10_expert6</title>
<path fill="none" stroke="black" d="M67513.7,-1040.16C67513.7,-1040.16 67513.7,-1014.25 67513.7,-1014.25"/>
<polygon fill="black" stroke="black" points="67517.2,-1014.25 67513.7,-1004.25 67510.2,-1014.25 67517.2,-1014.25"/>
</g>
<!-- layer10_agg_exp6 -->
<g id="node579" class="node">
<title>layer10_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="67504.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="67504.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="67504.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="67504.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="67504.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert6&#45;&gt;layer10_agg_exp6 -->
<g id="edge702" class="edge">
<title>layer10_expert6&#45;&gt;layer10_agg_exp6</title>
<path fill="none" stroke="black" d="M67513.7,-941.09C67513.7,-941.09 67513.7,-915.34 67513.7,-915.34"/>
<polygon fill="black" stroke="black" points="67517.2,-915.34 67513.7,-905.34 67510.2,-915.34 67517.2,-915.34"/>
</g>
<!-- layer10_agg_exp6&#45;&gt;layer10_moe_agg -->
<g id="edge703" class="edge">
<title>layer10_agg_exp6&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M67695.3,-857.96C67695.3,-827.54 67695.3,-741 67695.3,-741 67695.3,-741 67912.05,-741 67912.05,-741"/>
<polygon fill="black" stroke="black" points="67912.05,-744.5 67922.05,-741 67912.05,-737.5 67912.05,-744.5"/>
</g>
<!-- layer10_expert7 -->
<g id="node581" class="node">
<title>layer10_expert7</title>
<polygon fill="lightcoral" stroke="black" points="68035.2,-1004.16 67814.2,-1004.16 67814.2,-941.16 68035.2,-941.16 68035.2,-1004.16"/>
<text text-anchor="middle" x="67924.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="67924.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="67924.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="67924.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="67924.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp7&#45;&gt;layer10_expert7 -->
<g id="edge705" class="edge">
<title>layer10_route_exp7&#45;&gt;layer10_expert7</title>
<path fill="none" stroke="black" d="M67924.7,-1040.16C67924.7,-1040.16 67924.7,-1014.25 67924.7,-1014.25"/>
<polygon fill="black" stroke="black" points="67928.2,-1014.25 67924.7,-1004.25 67921.2,-1014.25 67928.2,-1014.25"/>
</g>
<!-- layer10_agg_exp7 -->
<g id="node582" class="node">
<title>layer10_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="67919.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="67919.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="67919.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="67919.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="67919.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert7&#45;&gt;layer10_agg_exp7 -->
<g id="edge706" class="edge">
<title>layer10_expert7&#45;&gt;layer10_agg_exp7</title>
<path fill="none" stroke="black" d="M67924.7,-941.09C67924.7,-941.09 67924.7,-915.34 67924.7,-915.34"/>
<polygon fill="black" stroke="black" points="67928.2,-915.34 67924.7,-905.34 67921.2,-915.34 67928.2,-915.34"/>
</g>
<!-- layer10_agg_exp7&#45;&gt;layer10_moe_agg -->
<g id="edge707" class="edge">
<title>layer10_agg_exp7&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M68020.02,-836.58C68020.02,-836.58 68020.02,-785.37 68020.02,-785.37"/>
<polygon fill="black" stroke="black" points="68023.52,-785.37 68020.02,-775.37 68016.52,-785.37 68023.52,-785.37"/>
</g>
<!-- layer10_expert8 -->
<g id="node584" class="node">
<title>layer10_expert8</title>
<polygon fill="lightcoral" stroke="black" points="68445.2,-1004.16 68224.2,-1004.16 68224.2,-941.16 68445.2,-941.16 68445.2,-1004.16"/>
<text text-anchor="middle" x="68334.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="68334.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="68334.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="68334.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="68334.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp8&#45;&gt;layer10_expert8 -->
<g id="edge709" class="edge">
<title>layer10_route_exp8&#45;&gt;layer10_expert8</title>
<path fill="none" stroke="black" d="M68334.7,-1039.87C68334.7,-1039.87 68334.7,-1014.41 68334.7,-1014.41"/>
<polygon fill="black" stroke="black" points="68338.2,-1014.41 68334.7,-1004.41 68331.2,-1014.41 68338.2,-1014.41"/>
</g>
<!-- layer10_agg_exp8 -->
<g id="node585" class="node">
<title>layer10_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="68334.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="68334.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="68334.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="68334.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="68334.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert8&#45;&gt;layer10_agg_exp8 -->
<g id="edge710" class="edge">
<title>layer10_expert8&#45;&gt;layer10_agg_exp8</title>
<path fill="none" stroke="black" d="M68334.7,-941.09C68334.7,-941.09 68334.7,-915.34 68334.7,-915.34"/>
<polygon fill="black" stroke="black" points="68338.2,-915.34 68334.7,-905.34 68331.2,-915.34 68338.2,-915.34"/>
</g>
<!-- layer10_agg_exp8&#45;&gt;layer10_moe_agg -->
<g id="edge711" class="edge">
<title>layer10_agg_exp8&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M68233.88,-836.58C68233.88,-836.58 68233.88,-785.37 68233.88,-785.37"/>
<polygon fill="black" stroke="black" points="68237.38,-785.37 68233.88,-775.37 68230.38,-785.37 68237.38,-785.37"/>
</g>
<!-- layer10_expert9 -->
<g id="node587" class="node">
<title>layer10_expert9</title>
<polygon fill="lightcoral" stroke="black" points="68857.2,-1004.16 68636.2,-1004.16 68636.2,-941.16 68857.2,-941.16 68857.2,-1004.16"/>
<text text-anchor="middle" x="68746.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="68746.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="68746.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="68746.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="68746.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp9&#45;&gt;layer10_expert9 -->
<g id="edge713" class="edge">
<title>layer10_route_exp9&#45;&gt;layer10_expert9</title>
<path fill="none" stroke="black" d="M68746.7,-1039.87C68746.7,-1039.87 68746.7,-1014.41 68746.7,-1014.41"/>
<polygon fill="black" stroke="black" points="68750.2,-1014.41 68746.7,-1004.41 68743.2,-1014.41 68750.2,-1014.41"/>
</g>
<!-- layer10_agg_exp9 -->
<g id="node588" class="node">
<title>layer10_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="68749.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="68749.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="68749.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="68749.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="68749.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert9&#45;&gt;layer10_agg_exp9 -->
<g id="edge714" class="edge">
<title>layer10_expert9&#45;&gt;layer10_agg_exp9</title>
<path fill="none" stroke="black" d="M68746.7,-941.09C68746.7,-941.09 68746.7,-915.34 68746.7,-915.34"/>
<polygon fill="black" stroke="black" points="68750.2,-915.34 68746.7,-905.34 68743.2,-915.34 68750.2,-915.34"/>
</g>
<!-- layer10_agg_exp9&#45;&gt;layer10_moe_agg -->
<g id="edge715" class="edge">
<title>layer10_agg_exp9&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M68749.7,-831.48C68749.7,-805.37 68749.7,-775 68749.7,-775 68749.7,-775 68243.79,-775 68243.79,-775"/>
<polygon fill="black" stroke="black" points="68243.79,-771.5 68233.79,-775 68243.79,-778.5 68243.79,-771.5"/>
</g>
<!-- layer10_expert10 -->
<g id="node590" class="node">
<title>layer10_expert10</title>
<polygon fill="lightcoral" stroke="black" points="69271.2,-1004.16 69050.2,-1004.16 69050.2,-941.16 69271.2,-941.16 69271.2,-1004.16"/>
<text text-anchor="middle" x="69160.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="69160.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="69160.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="69160.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="69160.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp10&#45;&gt;layer10_expert10 -->
<g id="edge717" class="edge">
<title>layer10_route_exp10&#45;&gt;layer10_expert10</title>
<path fill="none" stroke="black" d="M69160.7,-1039.87C69160.7,-1039.87 69160.7,-1014.41 69160.7,-1014.41"/>
<polygon fill="black" stroke="black" points="69164.2,-1014.41 69160.7,-1004.41 69157.2,-1014.41 69164.2,-1014.41"/>
</g>
<!-- layer10_agg_exp10 -->
<g id="node591" class="node">
<title>layer10_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="69164.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="69164.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="69164.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="69164.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="69164.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert10&#45;&gt;layer10_agg_exp10 -->
<g id="edge718" class="edge">
<title>layer10_expert10&#45;&gt;layer10_agg_exp10</title>
<path fill="none" stroke="black" d="M69160.7,-941.09C69160.7,-941.09 69160.7,-915.34 69160.7,-915.34"/>
<polygon fill="black" stroke="black" points="69164.2,-915.34 69160.7,-905.34 69157.2,-915.34 69164.2,-915.34"/>
</g>
<!-- layer10_agg_exp10&#45;&gt;layer10_moe_agg -->
<g id="edge719" class="edge">
<title>layer10_agg_exp10&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M69164.7,-831.47C69164.7,-803.55 69164.7,-770 69164.7,-770 69164.7,-770 68279.66,-770 68279.66,-770"/>
<polygon fill="black" stroke="black" points="68279.66,-766.5 68269.66,-770 68279.66,-773.5 68279.66,-766.5"/>
</g>
<!-- layer10_expert11 -->
<g id="node593" class="node">
<title>layer10_expert11</title>
<polygon fill="lightcoral" stroke="black" points="69685.2,-1004.16 69464.2,-1004.16 69464.2,-941.16 69685.2,-941.16 69685.2,-1004.16"/>
<text text-anchor="middle" x="69574.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="69574.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="69574.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="69574.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="69574.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp11&#45;&gt;layer10_expert11 -->
<g id="edge721" class="edge">
<title>layer10_route_exp11&#45;&gt;layer10_expert11</title>
<path fill="none" stroke="black" d="M69574.7,-1039.87C69574.7,-1039.87 69574.7,-1014.41 69574.7,-1014.41"/>
<polygon fill="black" stroke="black" points="69578.2,-1014.41 69574.7,-1004.41 69571.2,-1014.41 69578.2,-1014.41"/>
</g>
<!-- layer10_agg_exp11 -->
<g id="node594" class="node">
<title>layer10_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="69579.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="69579.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="69579.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="69579.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="69579.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert11&#45;&gt;layer10_agg_exp11 -->
<g id="edge722" class="edge">
<title>layer10_expert11&#45;&gt;layer10_agg_exp11</title>
<path fill="none" stroke="black" d="M69574.7,-941.09C69574.7,-941.09 69574.7,-915.34 69574.7,-915.34"/>
<polygon fill="black" stroke="black" points="69578.2,-915.34 69574.7,-905.34 69571.2,-915.34 69578.2,-915.34"/>
</g>
<!-- layer10_agg_exp11&#45;&gt;layer10_moe_agg -->
<g id="edge723" class="edge">
<title>layer10_agg_exp11&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M69579.7,-831.35C69579.7,-801.69 69579.7,-765 69579.7,-765 69579.7,-765 68303.73,-765 68303.73,-765"/>
<polygon fill="black" stroke="black" points="68303.73,-761.5 68293.73,-765 68303.73,-768.5 68303.73,-761.5"/>
</g>
<!-- layer10_expert12 -->
<g id="node596" class="node">
<title>layer10_expert12</title>
<polygon fill="lightcoral" stroke="black" points="70100.2,-1004.16 69879.2,-1004.16 69879.2,-941.16 70100.2,-941.16 70100.2,-1004.16"/>
<text text-anchor="middle" x="69989.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="69989.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="69989.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="69989.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="69989.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp12&#45;&gt;layer10_expert12 -->
<g id="edge725" class="edge">
<title>layer10_route_exp12&#45;&gt;layer10_expert12</title>
<path fill="none" stroke="black" d="M69989.7,-1040.16C69989.7,-1040.16 69989.7,-1014.25 69989.7,-1014.25"/>
<polygon fill="black" stroke="black" points="69993.2,-1014.25 69989.7,-1004.25 69986.2,-1014.25 69993.2,-1014.25"/>
</g>
<!-- layer10_agg_exp12 -->
<g id="node597" class="node">
<title>layer10_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="69994.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="69994.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="69994.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="69994.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="69994.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert12&#45;&gt;layer10_agg_exp12 -->
<g id="edge726" class="edge">
<title>layer10_expert12&#45;&gt;layer10_agg_exp12</title>
<path fill="none" stroke="black" d="M69989.7,-941.09C69989.7,-941.09 69989.7,-915.34 69989.7,-915.34"/>
<polygon fill="black" stroke="black" points="69993.2,-915.34 69989.7,-905.34 69986.2,-915.34 69993.2,-915.34"/>
</g>
<!-- layer10_agg_exp12&#45;&gt;layer10_moe_agg -->
<g id="edge727" class="edge">
<title>layer10_agg_exp12&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M69994.7,-831.39C69994.7,-799.99 69994.7,-760 69994.7,-760 69994.7,-760 68320.49,-760 68320.49,-760"/>
<polygon fill="black" stroke="black" points="68320.49,-756.5 68310.49,-760 68320.49,-763.5 68320.49,-756.5"/>
</g>
<!-- layer10_expert13 -->
<g id="node599" class="node">
<title>layer10_expert13</title>
<polygon fill="lightcoral" stroke="black" points="70510.2,-1004.16 70289.2,-1004.16 70289.2,-941.16 70510.2,-941.16 70510.2,-1004.16"/>
<text text-anchor="middle" x="70399.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="70399.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="70399.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="70399.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="70399.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp13&#45;&gt;layer10_expert13 -->
<g id="edge729" class="edge">
<title>layer10_route_exp13&#45;&gt;layer10_expert13</title>
<path fill="none" stroke="black" d="M70399.7,-1040.16C70399.7,-1040.16 70399.7,-1014.25 70399.7,-1014.25"/>
<polygon fill="black" stroke="black" points="70403.2,-1014.25 70399.7,-1004.25 70396.2,-1014.25 70403.2,-1014.25"/>
</g>
<!-- layer10_agg_exp13 -->
<g id="node600" class="node">
<title>layer10_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="70409.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="70409.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="70409.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="70409.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="70409.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert13&#45;&gt;layer10_agg_exp13 -->
<g id="edge730" class="edge">
<title>layer10_expert13&#45;&gt;layer10_agg_exp13</title>
<path fill="none" stroke="black" d="M70399.7,-941.09C70399.7,-941.09 70399.7,-915.34 70399.7,-915.34"/>
<polygon fill="black" stroke="black" points="70403.2,-915.34 70399.7,-905.34 70396.2,-915.34 70403.2,-915.34"/>
</g>
<!-- layer10_agg_exp13&#45;&gt;layer10_moe_agg -->
<g id="edge731" class="edge">
<title>layer10_agg_exp13&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M70409.7,-831.57C70409.7,-798.47 70409.7,-755 70409.7,-755 70409.7,-755 68331.84,-755 68331.84,-755"/>
<polygon fill="black" stroke="black" points="68331.84,-751.5 68321.84,-755 68331.84,-758.5 68331.84,-751.5"/>
</g>
<!-- layer10_expert14 -->
<g id="node602" class="node">
<title>layer10_expert14</title>
<polygon fill="lightcoral" stroke="black" points="70927.2,-1004.16 70706.2,-1004.16 70706.2,-941.16 70927.2,-941.16 70927.2,-1004.16"/>
<text text-anchor="middle" x="70816.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="70816.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="70816.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="70816.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="70816.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp14&#45;&gt;layer10_expert14 -->
<g id="edge733" class="edge">
<title>layer10_route_exp14&#45;&gt;layer10_expert14</title>
<path fill="none" stroke="black" d="M70816.7,-1040.16C70816.7,-1040.16 70816.7,-1014.25 70816.7,-1014.25"/>
<polygon fill="black" stroke="black" points="70820.2,-1014.25 70816.7,-1004.25 70813.2,-1014.25 70820.2,-1014.25"/>
</g>
<!-- layer10_agg_exp14 -->
<g id="node603" class="node">
<title>layer10_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="70824.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="70824.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="70824.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="70824.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="70824.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert14&#45;&gt;layer10_agg_exp14 -->
<g id="edge734" class="edge">
<title>layer10_expert14&#45;&gt;layer10_agg_exp14</title>
<path fill="none" stroke="black" d="M70816.7,-941.09C70816.7,-941.09 70816.7,-915.34 70816.7,-915.34"/>
<polygon fill="black" stroke="black" points="70820.2,-915.34 70816.7,-905.34 70813.2,-915.34 70820.2,-915.34"/>
</g>
<!-- layer10_agg_exp14&#45;&gt;layer10_moe_agg -->
<g id="edge735" class="edge">
<title>layer10_agg_exp14&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M70824.7,-831.58C70824.7,-796.82 70824.7,-750 70824.7,-750 70824.7,-750 68338.66,-750 68338.66,-750"/>
<polygon fill="black" stroke="black" points="68338.66,-746.5 68328.66,-750 68338.66,-753.5 68338.66,-746.5"/>
</g>
<!-- layer10_expert15 -->
<g id="node605" class="node">
<title>layer10_expert15</title>
<polygon fill="lightcoral" stroke="black" points="71340.2,-1004.16 71119.2,-1004.16 71119.2,-941.16 71340.2,-941.16 71340.2,-1004.16"/>
<text text-anchor="middle" x="71229.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="71229.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="71229.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="71229.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="71229.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer10_route_exp15&#45;&gt;layer10_expert15 -->
<g id="edge737" class="edge">
<title>layer10_route_exp15&#45;&gt;layer10_expert15</title>
<path fill="none" stroke="black" d="M71229.7,-1040.16C71229.7,-1040.16 71229.7,-1014.25 71229.7,-1014.25"/>
<polygon fill="black" stroke="black" points="71233.2,-1014.25 71229.7,-1004.25 71226.2,-1014.25 71233.2,-1014.25"/>
</g>
<!-- layer10_agg_exp15 -->
<g id="node606" class="node">
<title>layer10_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="71239.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="71239.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="71239.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="71239.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="71239.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer10_expert15&#45;&gt;layer10_agg_exp15 -->
<g id="edge738" class="edge">
<title>layer10_expert15&#45;&gt;layer10_agg_exp15</title>
<path fill="none" stroke="black" d="M71229.7,-941.09C71229.7,-941.09 71229.7,-915.34 71229.7,-915.34"/>
<polygon fill="black" stroke="black" points="71233.2,-915.34 71229.7,-905.34 71226.2,-915.34 71233.2,-915.34"/>
</g>
<!-- layer10_agg_exp15&#45;&gt;layer10_moe_agg -->
<g id="edge739" class="edge">
<title>layer10_agg_exp15&#45;&gt;layer10_moe_agg</title>
<path fill="none" stroke="black" d="M71239.7,-831.33C71239.7,-795.31 71239.7,-746 71239.7,-746 71239.7,-746 68341.55,-746 68341.55,-746"/>
<polygon fill="black" stroke="black" points="68341.55,-742.5 68331.55,-746 68341.55,-749.5 68341.55,-742.5"/>
</g>
<!-- layer11_ln1 -->
<g id="node608" class="node">
<title>layer11_ln1</title>
<polygon fill="none" stroke="black" points="71796.2,-1227.7 71515.2,-1227.7 71515.2,-1175.7 71796.2,-1175.7 71796.2,-1227.7"/>
<text text-anchor="middle" x="71655.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 11</text>
<text text-anchor="middle" x="71655.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="71655.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="71655.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer11_add1 -->
<g id="node609" class="node">
<title>layer11_add1</title>
<polygon fill="yellow" stroke="black" points="74608.2,-644.85 74327.2,-644.85 74327.2,-592.85 74608.2,-592.85 74608.2,-644.85"/>
<text text-anchor="middle" x="74467.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 11</text>
<text text-anchor="middle" x="74467.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74467.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74467.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_moe_output -->
<g id="node613" class="node">
<title>layer11_moe_output</title>
<polygon fill="yellow" stroke="black" points="74757.2,-540.58 74476.2,-540.58 74476.2,-488.58 74757.2,-488.58 74757.2,-540.58"/>
<text text-anchor="middle" x="74616.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 11</text>
<text text-anchor="middle" x="74616.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74616.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74616.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_add1&#45;&gt;layer11_moe_output -->
<g id="edge809" class="edge">
<title>layer11_add1&#45;&gt;layer11_moe_output</title>
<path fill="none" stroke="black" d="M74542.2,-592.81C74542.2,-592.81 74542.2,-550.65 74542.2,-550.65"/>
<polygon fill="black" stroke="black" points="74545.7,-550.65 74542.2,-540.65 74538.7,-550.65 74545.7,-550.65"/>
</g>
<!-- layer11_gate -->
<g id="node610" class="node">
<title>layer11_gate</title>
<polygon fill="lightgreen" stroke="black" points="75056.13,-1253.7 74597.3,-1253.7 74479.26,-1149.7 74938.1,-1149.7 75056.13,-1253.7"/>
<text text-anchor="middle" x="74767.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 11</text>
<text text-anchor="middle" x="74767.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74767.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="74767.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer11_route_exp0 -->
<g id="node614" class="node">
<title>layer11_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="71658.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="71658.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="71658.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="71658.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="71658.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp0 -->
<g id="edge743" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp0</title>
<path fill="none" stroke="black" d="M74505.52,-1173C73784.38,-1173 71824.32,-1173 71824.32,-1173 71824.32,-1173 71824.32,-1106.37 71824.32,-1106.37"/>
<polygon fill="black" stroke="black" points="71827.82,-1106.37 71824.32,-1096.37 71820.82,-1106.37 71827.82,-1106.37"/>
</g>
<!-- layer11_route_exp1 -->
<g id="node617" class="node">
<title>layer11_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="72098.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="72098.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="72098.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="72098.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="72098.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp1 -->
<g id="edge747" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp1</title>
<path fill="none" stroke="black" d="M74499.87,-1168C73823.26,-1168 72098.7,-1168 72098.7,-1168 72098.7,-1168 72098.7,-1123.71 72098.7,-1123.71"/>
<polygon fill="black" stroke="black" points="72102.2,-1123.71 72098.7,-1113.71 72095.2,-1123.71 72102.2,-1123.71"/>
</g>
<!-- layer11_route_exp2 -->
<g id="node620" class="node">
<title>layer11_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="72520.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="72520.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="72520.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="72520.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="72520.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp2 -->
<g id="edge751" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp2</title>
<path fill="none" stroke="black" d="M74496.38,-1165C73898.59,-1165 72520.7,-1165 72520.7,-1165 72520.7,-1165 72520.7,-1123.77 72520.7,-1123.77"/>
<polygon fill="black" stroke="black" points="72524.2,-1123.77 72520.7,-1113.77 72517.2,-1123.77 72524.2,-1123.77"/>
</g>
<!-- layer11_route_exp3 -->
<g id="node623" class="node">
<title>layer11_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="72934.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="72934.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="72934.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="72934.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="72934.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp3 -->
<g id="edge755" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp3</title>
<path fill="none" stroke="black" d="M74491.79,-1161C73979.9,-1161 72934.7,-1161 72934.7,-1161 72934.7,-1161 72934.7,-1124.05 72934.7,-1124.05"/>
<polygon fill="black" stroke="black" points="72938.2,-1124.05 72934.7,-1114.05 72931.2,-1124.05 72938.2,-1124.05"/>
</g>
<!-- layer11_route_exp4 -->
<g id="node626" class="node">
<title>layer11_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="73343.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="73343.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="73343.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="73343.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="73343.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp4 -->
<g id="edge759" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp4</title>
<path fill="none" stroke="black" d="M74488.48,-1158C74073.85,-1158 73343.7,-1158 73343.7,-1158 73343.7,-1158 73343.7,-1124.14 73343.7,-1124.14"/>
<polygon fill="black" stroke="black" points="73347.2,-1124.14 73343.7,-1114.14 73340.2,-1124.14 73347.2,-1124.14"/>
</g>
<!-- layer11_route_exp5 -->
<g id="node629" class="node">
<title>layer11_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="73750.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="73750.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="73750.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="73750.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="73750.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp5 -->
<g id="edge763" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp5</title>
<path fill="none" stroke="black" d="M74484.07,-1154C74183.16,-1154 73750.7,-1154 73750.7,-1154 73750.7,-1154 73750.7,-1124.11 73750.7,-1124.11"/>
<polygon fill="black" stroke="black" points="73754.2,-1124.11 73750.7,-1114.11 73747.2,-1124.11 73754.2,-1124.11"/>
</g>
<!-- layer11_route_exp6 -->
<g id="node632" class="node">
<title>layer11_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="74156.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="74156.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="74156.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="74156.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74156.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp6 -->
<g id="edge767" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp6</title>
<path fill="none" stroke="black" d="M74480.54,-1151C74321.92,-1151 74156.7,-1151 74156.7,-1151 74156.7,-1151 74156.7,-1123.96 74156.7,-1123.96"/>
<polygon fill="black" stroke="black" points="74160.2,-1123.96 74156.7,-1113.96 74153.2,-1123.96 74160.2,-1123.96"/>
</g>
<!-- layer11_route_exp7 -->
<g id="node635" class="node">
<title>layer11_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="74562.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="74562.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="74562.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="74562.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74562.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp7 -->
<g id="edge771" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp7</title>
<path fill="none" stroke="black" d="M74617.96,-1149.5C74617.96,-1149.5 74617.96,-1122.25 74617.96,-1122.25"/>
<polygon fill="black" stroke="black" points="74621.46,-1122.25 74617.96,-1112.25 74614.46,-1122.25 74621.46,-1122.25"/>
</g>
<!-- layer11_route_exp8 -->
<g id="node638" class="node">
<title>layer11_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="74972.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="74972.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="74972.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="74972.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74972.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp8 -->
<g id="edge775" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp8</title>
<path fill="none" stroke="black" d="M74917.43,-1149.5C74917.43,-1149.5 74917.43,-1122.25 74917.43,-1122.25"/>
<polygon fill="black" stroke="black" points="74920.93,-1122.25 74917.43,-1112.25 74913.93,-1122.25 74920.93,-1122.25"/>
</g>
<!-- layer11_route_exp9 -->
<g id="node641" class="node">
<title>layer11_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="75380.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="75380.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="75380.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="75380.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="75380.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp9 -->
<g id="edge779" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp9</title>
<path fill="none" stroke="black" d="M74942.13,-1153C75123.34,-1153 75380.7,-1153 75380.7,-1153 75380.7,-1153 75380.7,-1124.07 75380.7,-1124.07"/>
<polygon fill="black" stroke="black" points="75384.2,-1124.07 75380.7,-1114.07 75377.2,-1124.07 75384.2,-1124.07"/>
</g>
<!-- layer11_route_exp10 -->
<g id="node644" class="node">
<title>layer11_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="75793.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="75793.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="75793.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="75793.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="75793.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp10 -->
<g id="edge783" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp10</title>
<path fill="none" stroke="black" d="M74945.53,-1156C75239.26,-1156 75793.7,-1156 75793.7,-1156 75793.7,-1156 75793.7,-1124.15 75793.7,-1124.15"/>
<polygon fill="black" stroke="black" points="75797.2,-1124.15 75793.7,-1114.15 75790.2,-1124.15 75797.2,-1124.15"/>
</g>
<!-- layer11_route_exp11 -->
<g id="node647" class="node">
<title>layer11_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="76204.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="76204.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="76204.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="76204.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="76204.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp11 -->
<g id="edge787" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp11</title>
<path fill="none" stroke="black" d="M74950.06,-1160C75336.92,-1160 76204.7,-1160 76204.7,-1160 76204.7,-1160 76204.7,-1124.09 76204.7,-1124.09"/>
<polygon fill="black" stroke="black" points="76208.2,-1124.09 76204.7,-1114.09 76201.2,-1124.09 76208.2,-1124.09"/>
</g>
<!-- layer11_route_exp12 -->
<g id="node650" class="node">
<title>layer11_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="76618.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="76618.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="76618.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="76618.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="76618.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp12 -->
<g id="edge791" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp12</title>
<path fill="none" stroke="black" d="M74953.23,-1163C75422.31,-1163 76618.7,-1163 76618.7,-1163 76618.7,-1163 76618.7,-1123.93 76618.7,-1123.93"/>
<polygon fill="black" stroke="black" points="76622.2,-1123.93 76618.7,-1113.93 76615.2,-1123.93 76622.2,-1123.93"/>
</g>
<!-- layer11_route_exp13 -->
<g id="node653" class="node">
<title>layer11_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="77031.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="77031.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="77031.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="77031.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="77031.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp13 -->
<g id="edge795" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp13</title>
<path fill="none" stroke="black" d="M74957.8,-1167C75502.78,-1167 77031.7,-1167 77031.7,-1167 77031.7,-1167 77031.7,-1123.82 77031.7,-1123.82"/>
<polygon fill="black" stroke="black" points="77035.2,-1123.82 77031.7,-1113.82 77028.2,-1123.82 77035.2,-1123.82"/>
</g>
<!-- layer11_route_exp14 -->
<g id="node656" class="node">
<title>layer11_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="77445.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="77445.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="77445.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="77445.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="77445.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp14 -->
<g id="edge799" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp14</title>
<path fill="none" stroke="black" d="M74961.37,-1170C75576.52,-1170 77445.7,-1170 77445.7,-1170 77445.7,-1170 77445.7,-1123.71 77445.7,-1123.71"/>
<polygon fill="black" stroke="black" points="77449.2,-1123.71 77445.7,-1113.71 77442.2,-1123.71 77449.2,-1123.71"/>
</g>
<!-- layer11_route_exp15 -->
<g id="node659" class="node">
<title>layer11_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="77860.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="77860.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="77860.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="77860.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="77860.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_route_exp15 -->
<g id="edge803" class="edge">
<title>layer11_gate&#45;&gt;layer11_route_exp15</title>
<path fill="none" stroke="black" d="M74963.48,-1172C75635.87,-1172 77809.57,-1172 77809.57,-1172 77809.57,-1172 77809.57,-1122.6 77809.57,-1122.6"/>
<polygon fill="black" stroke="black" points="77813.07,-1122.6 77809.57,-1112.6 77806.07,-1122.6 77813.07,-1122.6"/>
</g>
<!-- layer11_moe_agg -->
<g id="node611" class="node">
<title>layer11_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="74766.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="74766.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 11</text>
<text text-anchor="middle" x="74766.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74766.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74766.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer11_ln2 -->
<g id="node612" class="node">
<title>layer11_ln2</title>
<polygon fill="none" stroke="black" points="74907.2,-644.85 74626.2,-644.85 74626.2,-592.85 74907.2,-592.85 74907.2,-644.85"/>
<text text-anchor="middle" x="74766.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 11</text>
<text text-anchor="middle" x="74766.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74766.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74766.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer11_moe_agg&#45;&gt;layer11_ln2 -->
<g id="edge807" class="edge">
<title>layer11_moe_agg&#45;&gt;layer11_ln2</title>
<path fill="none" stroke="black" d="M74766.7,-706.52C74766.7,-706.52 74766.7,-654.92 74766.7,-654.92"/>
<polygon fill="black" stroke="black" points="74770.2,-654.92 74766.7,-644.92 74763.2,-654.92 74770.2,-654.92"/>
</g>
<!-- layer11_ln2&#45;&gt;layer11_moe_output -->
<g id="edge808" class="edge">
<title>layer11_ln2&#45;&gt;layer11_moe_output</title>
<path fill="none" stroke="black" d="M74691.7,-592.81C74691.7,-592.81 74691.7,-550.65 74691.7,-550.65"/>
<polygon fill="black" stroke="black" points="74695.2,-550.65 74691.7,-540.65 74688.2,-550.65 74695.2,-550.65"/>
</g>
<!-- layer12_mha -->
<g id="node662" class="node">
<title>layer12_mha</title>
<polygon fill="lightcyan" stroke="black" points="74757.2,-436.31 74476.2,-436.31 74476.2,-384.31 74757.2,-384.31 74757.2,-436.31"/>
<text text-anchor="middle" x="74616.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 12</text>
<text text-anchor="middle" x="74616.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74616.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="74616.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer11_moe_output&#45;&gt;layer12_mha -->
<g id="edge1089" class="edge">
<title>layer11_moe_output&#45;&gt;layer12_mha</title>
<path fill="none" stroke="black" d="M74616.7,-488.54C74616.7,-488.54 74616.7,-446.38 74616.7,-446.38"/>
<polygon fill="black" stroke="black" points="74620.2,-446.38 74616.7,-436.38 74613.2,-446.38 74620.2,-446.38"/>
</g>
<!-- layer11_expert0 -->
<g id="node615" class="node">
<title>layer11_expert0</title>
<polygon fill="lightcoral" stroke="black" points="71766.2,-1004.16 71545.2,-1004.16 71545.2,-941.16 71766.2,-941.16 71766.2,-1004.16"/>
<text text-anchor="middle" x="71655.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="71655.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="71655.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="71655.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="71655.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp0&#45;&gt;layer11_expert0 -->
<g id="edge744" class="edge">
<title>layer11_route_exp0&#45;&gt;layer11_expert0</title>
<path fill="none" stroke="black" d="M71655.7,-1039.87C71655.7,-1039.87 71655.7,-1014.41 71655.7,-1014.41"/>
<polygon fill="black" stroke="black" points="71659.2,-1014.41 71655.7,-1004.41 71652.2,-1014.41 71659.2,-1014.41"/>
</g>
<!-- layer11_agg_exp0 -->
<g id="node616" class="node">
<title>layer11_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="71654.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="71654.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="71654.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="71654.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="71654.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert0&#45;&gt;layer11_agg_exp0 -->
<g id="edge745" class="edge">
<title>layer11_expert0&#45;&gt;layer11_agg_exp0</title>
<path fill="none" stroke="black" d="M71655.7,-941.09C71655.7,-941.09 71655.7,-915.34 71655.7,-915.34"/>
<polygon fill="black" stroke="black" points="71659.2,-915.34 71655.7,-905.34 71652.2,-915.34 71659.2,-915.34"/>
</g>
<!-- layer11_agg_exp0&#45;&gt;layer11_moe_agg -->
<g id="edge746" class="edge">
<title>layer11_agg_exp0&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M71654.7,-831.49C71654.7,-784.97 71654.7,-711 71654.7,-711 71654.7,-711 74661.86,-711 74661.86,-711"/>
<polygon fill="black" stroke="black" points="74661.86,-714.5 74671.86,-711 74661.86,-707.5 74661.86,-714.5"/>
</g>
<!-- layer11_expert1 -->
<g id="node618" class="node">
<title>layer11_expert1</title>
<polygon fill="lightcoral" stroke="black" points="72194.2,-1004.16 71973.2,-1004.16 71973.2,-941.16 72194.2,-941.16 72194.2,-1004.16"/>
<text text-anchor="middle" x="72083.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="72083.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="72083.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="72083.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="72083.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp1&#45;&gt;layer11_expert1 -->
<g id="edge748" class="edge">
<title>layer11_route_exp1&#45;&gt;layer11_expert1</title>
<path fill="none" stroke="black" d="M72083.7,-1040.16C72083.7,-1040.16 72083.7,-1014.25 72083.7,-1014.25"/>
<polygon fill="black" stroke="black" points="72087.2,-1014.25 72083.7,-1004.25 72080.2,-1014.25 72087.2,-1014.25"/>
</g>
<!-- layer11_agg_exp1 -->
<g id="node619" class="node">
<title>layer11_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="72069.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="72069.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="72069.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="72069.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="72069.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert1&#45;&gt;layer11_agg_exp1 -->
<g id="edge749" class="edge">
<title>layer11_expert1&#45;&gt;layer11_agg_exp1</title>
<path fill="none" stroke="black" d="M72083.7,-941.09C72083.7,-941.09 72083.7,-915.34 72083.7,-915.34"/>
<polygon fill="black" stroke="black" points="72087.2,-915.34 72083.7,-905.34 72080.2,-915.34 72087.2,-915.34"/>
</g>
<!-- layer11_agg_exp1&#45;&gt;layer11_moe_agg -->
<g id="edge750" class="edge">
<title>layer11_agg_exp1&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M72069.7,-831.5C72069.7,-786.4 72069.7,-716 72069.7,-716 72069.7,-716 74621.1,-716 74621.1,-716"/>
<polygon fill="black" stroke="black" points="74621.1,-719.5 74631.1,-716 74621.1,-712.5 74621.1,-719.5"/>
</g>
<!-- layer11_expert2 -->
<g id="node621" class="node">
<title>layer11_expert2</title>
<polygon fill="lightcoral" stroke="black" points="72612.2,-1004.16 72391.2,-1004.16 72391.2,-941.16 72612.2,-941.16 72612.2,-1004.16"/>
<text text-anchor="middle" x="72501.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="72501.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="72501.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="72501.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="72501.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp2&#45;&gt;layer11_expert2 -->
<g id="edge752" class="edge">
<title>layer11_route_exp2&#45;&gt;layer11_expert2</title>
<path fill="none" stroke="black" d="M72501.7,-1040.16C72501.7,-1040.16 72501.7,-1014.25 72501.7,-1014.25"/>
<polygon fill="black" stroke="black" points="72505.2,-1014.25 72501.7,-1004.25 72498.2,-1014.25 72505.2,-1014.25"/>
</g>
<!-- layer11_agg_exp2 -->
<g id="node622" class="node">
<title>layer11_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="72484.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="72484.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="72484.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="72484.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="72484.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert2&#45;&gt;layer11_agg_exp2 -->
<g id="edge753" class="edge">
<title>layer11_expert2&#45;&gt;layer11_agg_exp2</title>
<path fill="none" stroke="black" d="M72501.7,-941.09C72501.7,-941.09 72501.7,-915.34 72501.7,-915.34"/>
<polygon fill="black" stroke="black" points="72505.2,-915.34 72501.7,-905.34 72498.2,-915.34 72505.2,-915.34"/>
</g>
<!-- layer11_agg_exp2&#45;&gt;layer11_moe_agg -->
<g id="edge754" class="edge">
<title>layer11_agg_exp2&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M72484.7,-831.58C72484.7,-787.92 72484.7,-721 72484.7,-721 72484.7,-721 74594.87,-721 74594.87,-721"/>
<polygon fill="black" stroke="black" points="74594.87,-724.5 74604.87,-721 74594.87,-717.5 74594.87,-724.5"/>
</g>
<!-- layer11_expert3 -->
<g id="node624" class="node">
<title>layer11_expert3</title>
<polygon fill="lightcoral" stroke="black" points="73027.2,-1004.16 72806.2,-1004.16 72806.2,-941.16 73027.2,-941.16 73027.2,-1004.16"/>
<text text-anchor="middle" x="72916.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="72916.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="72916.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="72916.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="72916.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp3&#45;&gt;layer11_expert3 -->
<g id="edge756" class="edge">
<title>layer11_route_exp3&#45;&gt;layer11_expert3</title>
<path fill="none" stroke="black" d="M72916.7,-1040.16C72916.7,-1040.16 72916.7,-1014.25 72916.7,-1014.25"/>
<polygon fill="black" stroke="black" points="72920.2,-1014.25 72916.7,-1004.25 72913.2,-1014.25 72920.2,-1014.25"/>
</g>
<!-- layer11_agg_exp3 -->
<g id="node625" class="node">
<title>layer11_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="72899.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="72899.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="72899.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="72899.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="72899.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert3&#45;&gt;layer11_agg_exp3 -->
<g id="edge757" class="edge">
<title>layer11_expert3&#45;&gt;layer11_agg_exp3</title>
<path fill="none" stroke="black" d="M72916.7,-941.09C72916.7,-941.09 72916.7,-915.34 72916.7,-915.34"/>
<polygon fill="black" stroke="black" points="72920.2,-915.34 72916.7,-905.34 72913.2,-915.34 72920.2,-915.34"/>
</g>
<!-- layer11_agg_exp3&#45;&gt;layer11_moe_agg -->
<g id="edge758" class="edge">
<title>layer11_agg_exp3&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M72899.7,-831.35C72899.7,-789.16 72899.7,-726 72899.7,-726 72899.7,-726 74576.41,-726 74576.41,-726"/>
<polygon fill="black" stroke="black" points="74576.41,-729.5 74586.41,-726 74576.41,-722.5 74576.41,-729.5"/>
</g>
<!-- layer11_expert4 -->
<g id="node627" class="node">
<title>layer11_expert4</title>
<polygon fill="lightcoral" stroke="black" points="73439.2,-1004.16 73218.2,-1004.16 73218.2,-941.16 73439.2,-941.16 73439.2,-1004.16"/>
<text text-anchor="middle" x="73328.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="73328.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="73328.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="73328.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="73328.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp4&#45;&gt;layer11_expert4 -->
<g id="edge760" class="edge">
<title>layer11_route_exp4&#45;&gt;layer11_expert4</title>
<path fill="none" stroke="black" d="M73328.7,-1040.16C73328.7,-1040.16 73328.7,-1014.25 73328.7,-1014.25"/>
<polygon fill="black" stroke="black" points="73332.2,-1014.25 73328.7,-1004.25 73325.2,-1014.25 73332.2,-1014.25"/>
</g>
<!-- layer11_agg_exp4 -->
<g id="node628" class="node">
<title>layer11_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="73314.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="73314.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="73314.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="73314.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="73314.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert4&#45;&gt;layer11_agg_exp4 -->
<g id="edge761" class="edge">
<title>layer11_expert4&#45;&gt;layer11_agg_exp4</title>
<path fill="none" stroke="black" d="M73328.7,-941.09C73328.7,-941.09 73328.7,-915.34 73328.7,-915.34"/>
<polygon fill="black" stroke="black" points="73332.2,-915.34 73328.7,-905.34 73325.2,-915.34 73332.2,-915.34"/>
</g>
<!-- layer11_agg_exp4&#45;&gt;layer11_moe_agg -->
<g id="edge762" class="edge">
<title>layer11_agg_exp4&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M73314.7,-831.57C73314.7,-790.87 73314.7,-731 73314.7,-731 73314.7,-731 74563.88,-731 74563.88,-731"/>
<polygon fill="black" stroke="black" points="74563.88,-734.5 74573.88,-731 74563.88,-727.5 74563.88,-734.5"/>
</g>
<!-- layer11_expert5 -->
<g id="node630" class="node">
<title>layer11_expert5</title>
<polygon fill="lightcoral" stroke="black" points="73850.2,-1004.16 73629.2,-1004.16 73629.2,-941.16 73850.2,-941.16 73850.2,-1004.16"/>
<text text-anchor="middle" x="73739.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="73739.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="73739.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="73739.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="73739.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp5&#45;&gt;layer11_expert5 -->
<g id="edge764" class="edge">
<title>layer11_route_exp5&#45;&gt;layer11_expert5</title>
<path fill="none" stroke="black" d="M73739.7,-1040.16C73739.7,-1040.16 73739.7,-1014.25 73739.7,-1014.25"/>
<polygon fill="black" stroke="black" points="73743.2,-1014.25 73739.7,-1004.25 73736.2,-1014.25 73743.2,-1014.25"/>
</g>
<!-- layer11_agg_exp5 -->
<g id="node631" class="node">
<title>layer11_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="73729.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="73729.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="73729.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="73729.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="73729.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert5&#45;&gt;layer11_agg_exp5 -->
<g id="edge765" class="edge">
<title>layer11_expert5&#45;&gt;layer11_agg_exp5</title>
<path fill="none" stroke="black" d="M73739.7,-941.09C73739.7,-941.09 73739.7,-915.34 73739.7,-915.34"/>
<polygon fill="black" stroke="black" points="73743.2,-915.34 73739.7,-905.34 73736.2,-915.34 73743.2,-915.34"/>
</g>
<!-- layer11_agg_exp5&#45;&gt;layer11_moe_agg -->
<g id="edge766" class="edge">
<title>layer11_agg_exp5&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M73729.7,-831.51C73729.7,-792.34 73729.7,-736 73729.7,-736 73729.7,-736 74555.83,-736 74555.83,-736"/>
<polygon fill="black" stroke="black" points="74555.83,-739.5 74565.83,-736 74555.83,-732.5 74555.83,-739.5"/>
</g>
<!-- layer11_expert6 -->
<g id="node633" class="node">
<title>layer11_expert6</title>
<polygon fill="lightcoral" stroke="black" points="74260.2,-1004.16 74039.2,-1004.16 74039.2,-941.16 74260.2,-941.16 74260.2,-1004.16"/>
<text text-anchor="middle" x="74149.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="74149.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="74149.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="74149.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="74149.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp6&#45;&gt;layer11_expert6 -->
<g id="edge768" class="edge">
<title>layer11_route_exp6&#45;&gt;layer11_expert6</title>
<path fill="none" stroke="black" d="M74149.7,-1040.16C74149.7,-1040.16 74149.7,-1014.25 74149.7,-1014.25"/>
<polygon fill="black" stroke="black" points="74153.2,-1014.25 74149.7,-1004.25 74146.2,-1014.25 74153.2,-1014.25"/>
</g>
<!-- layer11_agg_exp6 -->
<g id="node634" class="node">
<title>layer11_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="74144.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="74144.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="74144.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="74144.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="74144.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert6&#45;&gt;layer11_agg_exp6 -->
<g id="edge769" class="edge">
<title>layer11_expert6&#45;&gt;layer11_agg_exp6</title>
<path fill="none" stroke="black" d="M74149.7,-941.09C74149.7,-941.09 74149.7,-915.34 74149.7,-915.34"/>
<polygon fill="black" stroke="black" points="74153.2,-915.34 74149.7,-905.34 74146.2,-915.34 74153.2,-915.34"/>
</g>
<!-- layer11_agg_exp6&#45;&gt;layer11_moe_agg -->
<g id="edge770" class="edge">
<title>layer11_agg_exp6&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M74335.3,-857.96C74335.3,-827.54 74335.3,-741 74335.3,-741 74335.3,-741 74552.05,-741 74552.05,-741"/>
<polygon fill="black" stroke="black" points="74552.05,-744.5 74562.05,-741 74552.05,-737.5 74552.05,-744.5"/>
</g>
<!-- layer11_expert7 -->
<g id="node636" class="node">
<title>layer11_expert7</title>
<polygon fill="lightcoral" stroke="black" points="74671.2,-1004.16 74450.2,-1004.16 74450.2,-941.16 74671.2,-941.16 74671.2,-1004.16"/>
<text text-anchor="middle" x="74560.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="74560.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="74560.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="74560.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="74560.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp7&#45;&gt;layer11_expert7 -->
<g id="edge772" class="edge">
<title>layer11_route_exp7&#45;&gt;layer11_expert7</title>
<path fill="none" stroke="black" d="M74560.7,-1039.87C74560.7,-1039.87 74560.7,-1014.41 74560.7,-1014.41"/>
<polygon fill="black" stroke="black" points="74564.2,-1014.41 74560.7,-1004.41 74557.2,-1014.41 74564.2,-1014.41"/>
</g>
<!-- layer11_agg_exp7 -->
<g id="node637" class="node">
<title>layer11_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="74559.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="74559.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="74559.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="74559.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="74559.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert7&#45;&gt;layer11_agg_exp7 -->
<g id="edge773" class="edge">
<title>layer11_expert7&#45;&gt;layer11_agg_exp7</title>
<path fill="none" stroke="black" d="M74560.7,-941.09C74560.7,-941.09 74560.7,-915.34 74560.7,-915.34"/>
<polygon fill="black" stroke="black" points="74564.2,-915.34 74560.7,-905.34 74557.2,-915.34 74564.2,-915.34"/>
</g>
<!-- layer11_agg_exp7&#45;&gt;layer11_moe_agg -->
<g id="edge774" class="edge">
<title>layer11_agg_exp7&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M74660.02,-836.58C74660.02,-836.58 74660.02,-785.37 74660.02,-785.37"/>
<polygon fill="black" stroke="black" points="74663.52,-785.37 74660.02,-775.37 74656.52,-785.37 74663.52,-785.37"/>
</g>
<!-- layer11_expert8 -->
<g id="node639" class="node">
<title>layer11_expert8</title>
<polygon fill="lightcoral" stroke="black" points="75084.2,-1004.16 74863.2,-1004.16 74863.2,-941.16 75084.2,-941.16 75084.2,-1004.16"/>
<text text-anchor="middle" x="74973.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="74973.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="74973.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="74973.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="74973.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp8&#45;&gt;layer11_expert8 -->
<g id="edge776" class="edge">
<title>layer11_route_exp8&#45;&gt;layer11_expert8</title>
<path fill="none" stroke="black" d="M74973.7,-1039.87C74973.7,-1039.87 74973.7,-1014.41 74973.7,-1014.41"/>
<polygon fill="black" stroke="black" points="74977.2,-1014.41 74973.7,-1004.41 74970.2,-1014.41 74977.2,-1014.41"/>
</g>
<!-- layer11_agg_exp8 -->
<g id="node640" class="node">
<title>layer11_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="74974.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="74974.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="74974.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="74974.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="74974.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert8&#45;&gt;layer11_agg_exp8 -->
<g id="edge777" class="edge">
<title>layer11_expert8&#45;&gt;layer11_agg_exp8</title>
<path fill="none" stroke="black" d="M74973.7,-941.09C74973.7,-941.09 74973.7,-915.34 74973.7,-915.34"/>
<polygon fill="black" stroke="black" points="74977.2,-915.34 74973.7,-905.34 74970.2,-915.34 74977.2,-915.34"/>
</g>
<!-- layer11_agg_exp8&#45;&gt;layer11_moe_agg -->
<g id="edge778" class="edge">
<title>layer11_agg_exp8&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M74873.88,-836.58C74873.88,-836.58 74873.88,-785.37 74873.88,-785.37"/>
<polygon fill="black" stroke="black" points="74877.38,-785.37 74873.88,-775.37 74870.38,-785.37 74877.38,-785.37"/>
</g>
<!-- layer11_expert9 -->
<g id="node642" class="node">
<title>layer11_expert9</title>
<polygon fill="lightcoral" stroke="black" points="75493.2,-1004.16 75272.2,-1004.16 75272.2,-941.16 75493.2,-941.16 75493.2,-1004.16"/>
<text text-anchor="middle" x="75382.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="75382.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="75382.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="75382.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="75382.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp9&#45;&gt;layer11_expert9 -->
<g id="edge780" class="edge">
<title>layer11_route_exp9&#45;&gt;layer11_expert9</title>
<path fill="none" stroke="black" d="M75382.7,-1039.87C75382.7,-1039.87 75382.7,-1014.41 75382.7,-1014.41"/>
<polygon fill="black" stroke="black" points="75386.2,-1014.41 75382.7,-1004.41 75379.2,-1014.41 75386.2,-1014.41"/>
</g>
<!-- layer11_agg_exp9 -->
<g id="node643" class="node">
<title>layer11_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="75389.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="75389.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="75389.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="75389.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="75389.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert9&#45;&gt;layer11_agg_exp9 -->
<g id="edge781" class="edge">
<title>layer11_expert9&#45;&gt;layer11_agg_exp9</title>
<path fill="none" stroke="black" d="M75382.7,-941.09C75382.7,-941.09 75382.7,-915.34 75382.7,-915.34"/>
<polygon fill="black" stroke="black" points="75386.2,-915.34 75382.7,-905.34 75379.2,-915.34 75386.2,-915.34"/>
</g>
<!-- layer11_agg_exp9&#45;&gt;layer11_moe_agg -->
<g id="edge782" class="edge">
<title>layer11_agg_exp9&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M75389.7,-831.54C75389.7,-793.92 75389.7,-741 75389.7,-741 75389.7,-741 74981.55,-741 74981.55,-741"/>
<polygon fill="black" stroke="black" points="74981.55,-737.5 74971.55,-741 74981.55,-744.5 74981.55,-737.5"/>
</g>
<!-- layer11_expert10 -->
<g id="node645" class="node">
<title>layer11_expert10</title>
<polygon fill="lightcoral" stroke="black" points="75909.2,-1004.16 75688.2,-1004.16 75688.2,-941.16 75909.2,-941.16 75909.2,-1004.16"/>
<text text-anchor="middle" x="75798.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="75798.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="75798.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="75798.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="75798.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp10&#45;&gt;layer11_expert10 -->
<g id="edge784" class="edge">
<title>layer11_route_exp10&#45;&gt;layer11_expert10</title>
<path fill="none" stroke="black" d="M75798.7,-1040.16C75798.7,-1040.16 75798.7,-1014.25 75798.7,-1014.25"/>
<polygon fill="black" stroke="black" points="75802.2,-1014.25 75798.7,-1004.25 75795.2,-1014.25 75802.2,-1014.25"/>
</g>
<!-- layer11_agg_exp10 -->
<g id="node646" class="node">
<title>layer11_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="75804.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="75804.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="75804.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="75804.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="75804.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert10&#45;&gt;layer11_agg_exp10 -->
<g id="edge785" class="edge">
<title>layer11_expert10&#45;&gt;layer11_agg_exp10</title>
<path fill="none" stroke="black" d="M75798.7,-941.09C75798.7,-941.09 75798.7,-915.34 75798.7,-915.34"/>
<polygon fill="black" stroke="black" points="75802.2,-915.34 75798.7,-905.34 75795.2,-915.34 75802.2,-915.34"/>
</g>
<!-- layer11_agg_exp10&#45;&gt;layer11_moe_agg -->
<g id="edge786" class="edge">
<title>layer11_agg_exp10&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M75804.7,-831.51C75804.7,-792.34 75804.7,-736 75804.7,-736 75804.7,-736 74977.45,-736 74977.45,-736"/>
<polygon fill="black" stroke="black" points="74977.45,-732.5 74967.45,-736 74977.45,-739.5 74977.45,-732.5"/>
</g>
<!-- layer11_expert11 -->
<g id="node648" class="node">
<title>layer11_expert11</title>
<polygon fill="lightcoral" stroke="black" points="76321.2,-1004.16 76100.2,-1004.16 76100.2,-941.16 76321.2,-941.16 76321.2,-1004.16"/>
<text text-anchor="middle" x="76210.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="76210.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="76210.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="76210.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="76210.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp11&#45;&gt;layer11_expert11 -->
<g id="edge788" class="edge">
<title>layer11_route_exp11&#45;&gt;layer11_expert11</title>
<path fill="none" stroke="black" d="M76210.7,-1040.16C76210.7,-1040.16 76210.7,-1014.25 76210.7,-1014.25"/>
<polygon fill="black" stroke="black" points="76214.2,-1014.25 76210.7,-1004.25 76207.2,-1014.25 76214.2,-1014.25"/>
</g>
<!-- layer11_agg_exp11 -->
<g id="node649" class="node">
<title>layer11_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="76219.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="76219.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="76219.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="76219.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="76219.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert11&#45;&gt;layer11_agg_exp11 -->
<g id="edge789" class="edge">
<title>layer11_expert11&#45;&gt;layer11_agg_exp11</title>
<path fill="none" stroke="black" d="M76210.7,-941.09C76210.7,-941.09 76210.7,-915.34 76210.7,-915.34"/>
<polygon fill="black" stroke="black" points="76214.2,-915.34 76210.7,-905.34 76207.2,-915.34 76214.2,-915.34"/>
</g>
<!-- layer11_agg_exp11&#45;&gt;layer11_moe_agg -->
<g id="edge790" class="edge">
<title>layer11_agg_exp11&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M76219.7,-831.57C76219.7,-790.87 76219.7,-731 76219.7,-731 76219.7,-731 74969.64,-731 74969.64,-731"/>
<polygon fill="black" stroke="black" points="74969.64,-727.5 74959.64,-731 74969.64,-734.5 74969.64,-727.5"/>
</g>
<!-- layer11_expert12 -->
<g id="node651" class="node">
<title>layer11_expert12</title>
<polygon fill="lightcoral" stroke="black" points="76740.2,-1004.16 76519.2,-1004.16 76519.2,-941.16 76740.2,-941.16 76740.2,-1004.16"/>
<text text-anchor="middle" x="76629.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="76629.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="76629.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="76629.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="76629.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp12&#45;&gt;layer11_expert12 -->
<g id="edge792" class="edge">
<title>layer11_route_exp12&#45;&gt;layer11_expert12</title>
<path fill="none" stroke="black" d="M76629.7,-1040.16C76629.7,-1040.16 76629.7,-1014.25 76629.7,-1014.25"/>
<polygon fill="black" stroke="black" points="76633.2,-1014.25 76629.7,-1004.25 76626.2,-1014.25 76633.2,-1014.25"/>
</g>
<!-- layer11_agg_exp12 -->
<g id="node652" class="node">
<title>layer11_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="76634.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="76634.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="76634.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="76634.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="76634.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert12&#45;&gt;layer11_agg_exp12 -->
<g id="edge793" class="edge">
<title>layer11_expert12&#45;&gt;layer11_agg_exp12</title>
<path fill="none" stroke="black" d="M76629.7,-941.09C76629.7,-941.09 76629.7,-915.34 76629.7,-915.34"/>
<polygon fill="black" stroke="black" points="76633.2,-915.34 76629.7,-905.34 76626.2,-915.34 76633.2,-915.34"/>
</g>
<!-- layer11_agg_exp12&#45;&gt;layer11_moe_agg -->
<g id="edge794" class="edge">
<title>layer11_agg_exp12&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M76634.7,-831.35C76634.7,-789.16 76634.7,-726 76634.7,-726 76634.7,-726 74957.08,-726 74957.08,-726"/>
<polygon fill="black" stroke="black" points="74957.08,-722.5 74947.08,-726 74957.08,-729.5 74957.08,-722.5"/>
</g>
<!-- layer11_expert13 -->
<g id="node654" class="node">
<title>layer11_expert13</title>
<polygon fill="lightcoral" stroke="black" points="77150.2,-1004.16 76929.2,-1004.16 76929.2,-941.16 77150.2,-941.16 77150.2,-1004.16"/>
<text text-anchor="middle" x="77039.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="77039.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="77039.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="77039.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="77039.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp13&#45;&gt;layer11_expert13 -->
<g id="edge796" class="edge">
<title>layer11_route_exp13&#45;&gt;layer11_expert13</title>
<path fill="none" stroke="black" d="M77039.7,-1040.16C77039.7,-1040.16 77039.7,-1014.25 77039.7,-1014.25"/>
<polygon fill="black" stroke="black" points="77043.2,-1014.25 77039.7,-1004.25 77036.2,-1014.25 77043.2,-1014.25"/>
</g>
<!-- layer11_agg_exp13 -->
<g id="node655" class="node">
<title>layer11_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="77049.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="77049.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="77049.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="77049.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="77049.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert13&#45;&gt;layer11_agg_exp13 -->
<g id="edge797" class="edge">
<title>layer11_expert13&#45;&gt;layer11_agg_exp13</title>
<path fill="none" stroke="black" d="M77039.7,-941.09C77039.7,-941.09 77039.7,-915.34 77039.7,-915.34"/>
<polygon fill="black" stroke="black" points="77043.2,-915.34 77039.7,-905.34 77036.2,-915.34 77043.2,-915.34"/>
</g>
<!-- layer11_agg_exp13&#45;&gt;layer11_moe_agg -->
<g id="edge798" class="edge">
<title>layer11_agg_exp13&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M77049.7,-831.58C77049.7,-787.92 77049.7,-721 77049.7,-721 77049.7,-721 74938.6,-721 74938.6,-721"/>
<polygon fill="black" stroke="black" points="74938.6,-717.5 74928.6,-721 74938.6,-724.5 74938.6,-717.5"/>
</g>
<!-- layer11_expert14 -->
<g id="node657" class="node">
<title>layer11_expert14</title>
<polygon fill="lightcoral" stroke="black" points="77565.2,-1004.16 77344.2,-1004.16 77344.2,-941.16 77565.2,-941.16 77565.2,-1004.16"/>
<text text-anchor="middle" x="77454.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="77454.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="77454.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="77454.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="77454.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp14&#45;&gt;layer11_expert14 -->
<g id="edge800" class="edge">
<title>layer11_route_exp14&#45;&gt;layer11_expert14</title>
<path fill="none" stroke="black" d="M77454.7,-1040.16C77454.7,-1040.16 77454.7,-1014.25 77454.7,-1014.25"/>
<polygon fill="black" stroke="black" points="77458.2,-1014.25 77454.7,-1004.25 77451.2,-1014.25 77458.2,-1014.25"/>
</g>
<!-- layer11_agg_exp14 -->
<g id="node658" class="node">
<title>layer11_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="77464.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="77464.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="77464.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="77464.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="77464.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert14&#45;&gt;layer11_agg_exp14 -->
<g id="edge801" class="edge">
<title>layer11_expert14&#45;&gt;layer11_agg_exp14</title>
<path fill="none" stroke="black" d="M77454.7,-941.09C77454.7,-941.09 77454.7,-915.34 77454.7,-915.34"/>
<polygon fill="black" stroke="black" points="77458.2,-915.34 77454.7,-905.34 77451.2,-915.34 77458.2,-915.34"/>
</g>
<!-- layer11_agg_exp14&#45;&gt;layer11_moe_agg -->
<g id="edge802" class="edge">
<title>layer11_agg_exp14&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M77464.7,-831.5C77464.7,-786.4 77464.7,-716 77464.7,-716 77464.7,-716 74912.34,-716 74912.34,-716"/>
<polygon fill="black" stroke="black" points="74912.34,-712.5 74902.34,-716 74912.34,-719.5 74912.34,-712.5"/>
</g>
<!-- layer11_expert15 -->
<g id="node660" class="node">
<title>layer11_expert15</title>
<polygon fill="lightcoral" stroke="black" points="77980.2,-1004.16 77759.2,-1004.16 77759.2,-941.16 77980.2,-941.16 77980.2,-1004.16"/>
<text text-anchor="middle" x="77869.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="77869.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="77869.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="77869.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="77869.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer11_route_exp15&#45;&gt;layer11_expert15 -->
<g id="edge804" class="edge">
<title>layer11_route_exp15&#45;&gt;layer11_expert15</title>
<path fill="none" stroke="black" d="M77869.7,-1040.16C77869.7,-1040.16 77869.7,-1014.25 77869.7,-1014.25"/>
<polygon fill="black" stroke="black" points="77873.2,-1014.25 77869.7,-1004.25 77866.2,-1014.25 77873.2,-1014.25"/>
</g>
<!-- layer11_agg_exp15 -->
<g id="node661" class="node">
<title>layer11_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="77879.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="77879.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="77879.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="77879.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="77879.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer11_expert15&#45;&gt;layer11_agg_exp15 -->
<g id="edge805" class="edge">
<title>layer11_expert15&#45;&gt;layer11_agg_exp15</title>
<path fill="none" stroke="black" d="M77869.7,-941.09C77869.7,-941.09 77869.7,-915.34 77869.7,-915.34"/>
<polygon fill="black" stroke="black" points="77873.2,-915.34 77869.7,-905.34 77866.2,-915.34 77873.2,-915.34"/>
</g>
<!-- layer11_agg_exp15&#45;&gt;layer11_moe_agg -->
<g id="edge806" class="edge">
<title>layer11_agg_exp15&#45;&gt;layer11_moe_agg</title>
<path fill="none" stroke="black" d="M77879.7,-831.49C77879.7,-784.97 77879.7,-711 77879.7,-711 77879.7,-711 74871.56,-711 74871.56,-711"/>
<polygon fill="black" stroke="black" points="74871.56,-707.5 74861.56,-711 74871.56,-714.5 74871.56,-707.5"/>
</g>
<!-- layer12_ln1 -->
<g id="node663" class="node">
<title>layer12_ln1</title>
<polygon fill="none" stroke="black" points="78233.2,-1227.7 77952.2,-1227.7 77952.2,-1175.7 78233.2,-1175.7 78233.2,-1227.7"/>
<text text-anchor="middle" x="78092.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 12</text>
<text text-anchor="middle" x="78092.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="78092.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="78092.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer12_add1 -->
<g id="node664" class="node">
<title>layer12_add1</title>
<polygon fill="yellow" stroke="black" points="81249.2,-644.85 80968.2,-644.85 80968.2,-592.85 81249.2,-592.85 81249.2,-644.85"/>
<text text-anchor="middle" x="81108.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 12</text>
<text text-anchor="middle" x="81108.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81108.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81108.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_moe_output -->
<g id="node668" class="node">
<title>layer12_moe_output</title>
<polygon fill="yellow" stroke="black" points="81399.2,-540.58 81118.2,-540.58 81118.2,-488.58 81399.2,-488.58 81399.2,-540.58"/>
<text text-anchor="middle" x="81258.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 12</text>
<text text-anchor="middle" x="81258.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81258.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81258.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_add1&#45;&gt;layer12_moe_output -->
<g id="edge876" class="edge">
<title>layer12_add1&#45;&gt;layer12_moe_output</title>
<path fill="none" stroke="black" d="M81183.7,-592.81C81183.7,-592.81 81183.7,-550.65 81183.7,-550.65"/>
<polygon fill="black" stroke="black" points="81187.2,-550.65 81183.7,-540.65 81180.2,-550.65 81187.2,-550.65"/>
</g>
<!-- layer12_gate -->
<g id="node665" class="node">
<title>layer12_gate</title>
<polygon fill="lightgreen" stroke="black" points="81700.13,-1253.7 81241.3,-1253.7 81123.26,-1149.7 81582.1,-1149.7 81700.13,-1253.7"/>
<text text-anchor="middle" x="81411.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 12</text>
<text text-anchor="middle" x="81411.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81411.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="81411.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer12_route_exp0 -->
<g id="node669" class="node">
<title>layer12_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="78295.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="78295.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="78295.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="78295.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="78295.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp0 -->
<g id="edge810" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp0</title>
<path fill="none" stroke="black" d="M81149.64,-1173C80410.29,-1173 78361.32,-1173 78361.32,-1173 78361.32,-1173 78361.32,-1121.61 78361.32,-1121.61"/>
<polygon fill="black" stroke="black" points="78364.82,-1121.61 78361.32,-1111.61 78357.82,-1121.61 78364.82,-1121.61"/>
</g>
<!-- layer12_route_exp1 -->
<g id="node672" class="node">
<title>layer12_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="78740.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="78740.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="78740.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="78740.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="78740.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp1 -->
<g id="edge814" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp1</title>
<path fill="none" stroke="black" d="M81143.98,-1168C80467.08,-1168 78740.7,-1168 78740.7,-1168 78740.7,-1168 78740.7,-1123.71 78740.7,-1123.71"/>
<polygon fill="black" stroke="black" points="78744.2,-1123.71 78740.7,-1113.71 78737.2,-1123.71 78744.2,-1123.71"/>
</g>
<!-- layer12_route_exp2 -->
<g id="node675" class="node">
<title>layer12_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="79165.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="79165.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="79165.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="79165.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="79165.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp2 -->
<g id="edge818" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp2</title>
<path fill="none" stroke="black" d="M81140.5,-1165C80542.98,-1165 79165.7,-1165 79165.7,-1165 79165.7,-1165 79165.7,-1123.77 79165.7,-1123.77"/>
<polygon fill="black" stroke="black" points="79169.2,-1123.77 79165.7,-1113.77 79162.2,-1123.77 79169.2,-1123.77"/>
</g>
<!-- layer12_route_exp3 -->
<g id="node678" class="node">
<title>layer12_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="79580.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="79580.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="79580.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="79580.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="79580.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp3 -->
<g id="edge822" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp3</title>
<path fill="none" stroke="black" d="M81136.09,-1161C80624.76,-1161 79580.7,-1161 79580.7,-1161 79580.7,-1161 79580.7,-1124.05 79580.7,-1124.05"/>
<polygon fill="black" stroke="black" points="79584.2,-1124.05 79580.7,-1114.05 79577.2,-1124.05 79584.2,-1124.05"/>
</g>
<!-- layer12_route_exp4 -->
<g id="node681" class="node">
<title>layer12_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="79990.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="79990.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="79990.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="79990.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="79990.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp4 -->
<g id="edge826" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp4</title>
<path fill="none" stroke="black" d="M81132.65,-1158C80718.82,-1158 79990.7,-1158 79990.7,-1158 79990.7,-1158 79990.7,-1124.14 79990.7,-1124.14"/>
<polygon fill="black" stroke="black" points="79994.2,-1124.14 79990.7,-1114.14 79987.2,-1124.14 79994.2,-1124.14"/>
</g>
<!-- layer12_route_exp5 -->
<g id="node684" class="node">
<title>layer12_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="80397.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="80397.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="80397.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="80397.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="80397.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp5 -->
<g id="edge830" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp5</title>
<path fill="none" stroke="black" d="M81127.89,-1154C80827.92,-1154 80397.7,-1154 80397.7,-1154 80397.7,-1154 80397.7,-1124.11 80397.7,-1124.11"/>
<polygon fill="black" stroke="black" points="80401.2,-1124.11 80397.7,-1114.11 80394.2,-1124.11 80401.2,-1124.11"/>
</g>
<!-- layer12_route_exp6 -->
<g id="node687" class="node">
<title>layer12_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="80803.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="80803.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="80803.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="80803.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="80803.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp6 -->
<g id="edge834" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp6</title>
<path fill="none" stroke="black" d="M81124.61,-1151C80967.19,-1151 80803.7,-1151 80803.7,-1151 80803.7,-1151 80803.7,-1123.96 80803.7,-1123.96"/>
<polygon fill="black" stroke="black" points="80807.2,-1123.96 80803.7,-1113.96 80800.2,-1123.96 80807.2,-1123.96"/>
</g>
<!-- layer12_route_exp7 -->
<g id="node690" class="node">
<title>layer12_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="81209.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="81209.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="81209.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="81209.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81209.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp7 -->
<g id="edge838" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp7</title>
<path fill="none" stroke="black" d="M81263.46,-1149.5C81263.46,-1149.5 81263.46,-1122.25 81263.46,-1122.25"/>
<polygon fill="black" stroke="black" points="81266.96,-1122.25 81263.46,-1112.25 81259.96,-1122.25 81266.96,-1122.25"/>
</g>
<!-- layer12_route_exp8 -->
<g id="node693" class="node">
<title>layer12_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="81614.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="81614.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="81614.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="81614.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81614.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp8 -->
<g id="edge842" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp8</title>
<path fill="none" stroke="black" d="M81560.43,-1149.5C81560.43,-1149.5 81560.43,-1122.25 81560.43,-1122.25"/>
<polygon fill="black" stroke="black" points="81563.93,-1122.25 81560.43,-1112.25 81556.93,-1122.25 81563.93,-1122.25"/>
</g>
<!-- layer12_route_exp9 -->
<g id="node696" class="node">
<title>layer12_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="82022.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="82022.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="82022.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="82022.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="82022.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp9 -->
<g id="edge846" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp9</title>
<path fill="none" stroke="black" d="M81585.97,-1153C81766.56,-1153 82022.7,-1153 82022.7,-1153 82022.7,-1153 82022.7,-1124.07 82022.7,-1124.07"/>
<polygon fill="black" stroke="black" points="82026.2,-1124.07 82022.7,-1114.07 82019.2,-1124.07 82026.2,-1124.07"/>
</g>
<!-- layer12_route_exp10 -->
<g id="node699" class="node">
<title>layer12_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="82434.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="82434.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="82434.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="82434.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="82434.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp10 -->
<g id="edge850" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp10</title>
<path fill="none" stroke="black" d="M81589.31,-1156C81882.25,-1156 82434.7,-1156 82434.7,-1156 82434.7,-1156 82434.7,-1124.15 82434.7,-1124.15"/>
<polygon fill="black" stroke="black" points="82438.2,-1124.15 82434.7,-1114.15 82431.2,-1124.15 82438.2,-1124.15"/>
</g>
<!-- layer12_route_exp11 -->
<g id="node702" class="node">
<title>layer12_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="82848.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="82848.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="82848.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="82848.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="82848.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp11 -->
<g id="edge854" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp11</title>
<path fill="none" stroke="black" d="M81594.06,-1160C81980.92,-1160 82848.7,-1160 82848.7,-1160 82848.7,-1160 82848.7,-1124.09 82848.7,-1124.09"/>
<polygon fill="black" stroke="black" points="82852.2,-1124.09 82848.7,-1114.09 82845.2,-1124.09 82852.2,-1124.09"/>
</g>
<!-- layer12_route_exp12 -->
<g id="node705" class="node">
<title>layer12_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="83262.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="83262.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="83262.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="83262.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="83262.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp12 -->
<g id="edge858" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp12</title>
<path fill="none" stroke="black" d="M81597.23,-1163C82066.31,-1163 83262.7,-1163 83262.7,-1163 83262.7,-1163 83262.7,-1123.93 83262.7,-1123.93"/>
<polygon fill="black" stroke="black" points="83266.2,-1123.93 83262.7,-1113.93 83259.2,-1123.93 83266.2,-1123.93"/>
</g>
<!-- layer12_route_exp13 -->
<g id="node708" class="node">
<title>layer12_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="83677.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="83677.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="83677.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="83677.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="83677.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp13 -->
<g id="edge862" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp13</title>
<path fill="none" stroke="black" d="M81601.97,-1167C82147.43,-1167 83677.7,-1167 83677.7,-1167 83677.7,-1167 83677.7,-1123.82 83677.7,-1123.82"/>
<polygon fill="black" stroke="black" points="83681.2,-1123.82 83677.7,-1113.82 83674.2,-1123.82 83681.2,-1123.82"/>
</g>
<!-- layer12_route_exp14 -->
<g id="node711" class="node">
<title>layer12_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="84092.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="84092.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="84092.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="84092.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="84092.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp14 -->
<g id="edge866" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp14</title>
<path fill="none" stroke="black" d="M81605.32,-1170C82220.88,-1170 84092.7,-1170 84092.7,-1170 84092.7,-1170 84092.7,-1123.71 84092.7,-1123.71"/>
<polygon fill="black" stroke="black" points="84096.2,-1123.71 84092.7,-1113.71 84089.2,-1123.71 84096.2,-1123.71"/>
</g>
<!-- layer12_route_exp15 -->
<g id="node714" class="node">
<title>layer12_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="84507.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="84507.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="84507.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="84507.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="84507.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_route_exp15 -->
<g id="edge870" class="edge">
<title>layer12_gate&#45;&gt;layer12_route_exp15</title>
<path fill="none" stroke="black" d="M81607.42,-1172C82279.58,-1172 84452.57,-1172 84452.57,-1172 84452.57,-1172 84452.57,-1122.33 84452.57,-1122.33"/>
<polygon fill="black" stroke="black" points="84456.07,-1122.33 84452.57,-1112.33 84449.07,-1122.33 84456.07,-1122.33"/>
</g>
<!-- layer12_moe_agg -->
<g id="node666" class="node">
<title>layer12_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="81407.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="81407.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 12</text>
<text text-anchor="middle" x="81407.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81407.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81407.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer12_ln2 -->
<g id="node667" class="node">
<title>layer12_ln2</title>
<polygon fill="none" stroke="black" points="81548.2,-644.85 81267.2,-644.85 81267.2,-592.85 81548.2,-592.85 81548.2,-644.85"/>
<text text-anchor="middle" x="81407.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 12</text>
<text text-anchor="middle" x="81407.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81407.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81407.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer12_moe_agg&#45;&gt;layer12_ln2 -->
<g id="edge874" class="edge">
<title>layer12_moe_agg&#45;&gt;layer12_ln2</title>
<path fill="none" stroke="black" d="M81407.7,-706.52C81407.7,-706.52 81407.7,-654.92 81407.7,-654.92"/>
<polygon fill="black" stroke="black" points="81411.2,-654.92 81407.7,-644.92 81404.2,-654.92 81411.2,-654.92"/>
</g>
<!-- layer12_ln2&#45;&gt;layer12_moe_output -->
<g id="edge875" class="edge">
<title>layer12_ln2&#45;&gt;layer12_moe_output</title>
<path fill="none" stroke="black" d="M81333.2,-592.81C81333.2,-592.81 81333.2,-550.65 81333.2,-550.65"/>
<polygon fill="black" stroke="black" points="81336.7,-550.65 81333.2,-540.65 81329.7,-550.65 81336.7,-550.65"/>
</g>
<!-- layer13_mha -->
<g id="node717" class="node">
<title>layer13_mha</title>
<polygon fill="lightcyan" stroke="black" points="81399.2,-436.31 81118.2,-436.31 81118.2,-384.31 81399.2,-384.31 81399.2,-436.31"/>
<text text-anchor="middle" x="81258.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 13</text>
<text text-anchor="middle" x="81258.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81258.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="81258.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer12_moe_output&#45;&gt;layer13_mha -->
<g id="edge1090" class="edge">
<title>layer12_moe_output&#45;&gt;layer13_mha</title>
<path fill="none" stroke="black" d="M81258.7,-488.54C81258.7,-488.54 81258.7,-446.38 81258.7,-446.38"/>
<polygon fill="black" stroke="black" points="81262.2,-446.38 81258.7,-436.38 81255.2,-446.38 81262.2,-446.38"/>
</g>
<!-- layer12_expert0 -->
<g id="node670" class="node">
<title>layer12_expert0</title>
<polygon fill="lightcoral" stroke="black" points="78405.2,-1004.16 78184.2,-1004.16 78184.2,-941.16 78405.2,-941.16 78405.2,-1004.16"/>
<text text-anchor="middle" x="78294.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="78294.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="78294.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="78294.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="78294.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp0&#45;&gt;layer12_expert0 -->
<g id="edge811" class="edge">
<title>layer12_route_exp0&#45;&gt;layer12_expert0</title>
<path fill="none" stroke="black" d="M78294.7,-1039.87C78294.7,-1039.87 78294.7,-1014.41 78294.7,-1014.41"/>
<polygon fill="black" stroke="black" points="78298.2,-1014.41 78294.7,-1004.41 78291.2,-1014.41 78298.2,-1014.41"/>
</g>
<!-- layer12_agg_exp0 -->
<g id="node671" class="node">
<title>layer12_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="78294.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="78294.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="78294.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="78294.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="78294.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert0&#45;&gt;layer12_agg_exp0 -->
<g id="edge812" class="edge">
<title>layer12_expert0&#45;&gt;layer12_agg_exp0</title>
<path fill="none" stroke="black" d="M78294.7,-941.09C78294.7,-941.09 78294.7,-915.34 78294.7,-915.34"/>
<polygon fill="black" stroke="black" points="78298.2,-915.34 78294.7,-905.34 78291.2,-915.34 78298.2,-915.34"/>
</g>
<!-- layer12_agg_exp0&#45;&gt;layer12_moe_agg -->
<g id="edge813" class="edge">
<title>layer12_agg_exp0&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M78294.7,-831.33C78294.7,-795.31 78294.7,-746 78294.7,-746 78294.7,-746 81192.84,-746 81192.84,-746"/>
<polygon fill="black" stroke="black" points="81192.84,-749.5 81202.84,-746 81192.84,-742.5 81192.84,-749.5"/>
</g>
<!-- layer12_expert1 -->
<g id="node673" class="node">
<title>layer12_expert1</title>
<polygon fill="lightcoral" stroke="black" points="78835.2,-1004.16 78614.2,-1004.16 78614.2,-941.16 78835.2,-941.16 78835.2,-1004.16"/>
<text text-anchor="middle" x="78724.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="78724.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="78724.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="78724.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="78724.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp1&#45;&gt;layer12_expert1 -->
<g id="edge815" class="edge">
<title>layer12_route_exp1&#45;&gt;layer12_expert1</title>
<path fill="none" stroke="black" d="M78724.7,-1040.16C78724.7,-1040.16 78724.7,-1014.25 78724.7,-1014.25"/>
<polygon fill="black" stroke="black" points="78728.2,-1014.25 78724.7,-1004.25 78721.2,-1014.25 78728.2,-1014.25"/>
</g>
<!-- layer12_agg_exp1 -->
<g id="node674" class="node">
<title>layer12_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="78709.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="78709.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="78709.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="78709.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="78709.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert1&#45;&gt;layer12_agg_exp1 -->
<g id="edge816" class="edge">
<title>layer12_expert1&#45;&gt;layer12_agg_exp1</title>
<path fill="none" stroke="black" d="M78724.7,-941.09C78724.7,-941.09 78724.7,-915.34 78724.7,-915.34"/>
<polygon fill="black" stroke="black" points="78728.2,-915.34 78724.7,-905.34 78721.2,-915.34 78728.2,-915.34"/>
</g>
<!-- layer12_agg_exp1&#45;&gt;layer12_moe_agg -->
<g id="edge817" class="edge">
<title>layer12_agg_exp1&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M78709.7,-831.58C78709.7,-796.82 78709.7,-750 78709.7,-750 78709.7,-750 81195.74,-750 81195.74,-750"/>
<polygon fill="black" stroke="black" points="81195.74,-753.5 81205.74,-750 81195.74,-746.5 81195.74,-753.5"/>
</g>
<!-- layer12_expert2 -->
<g id="node676" class="node">
<title>layer12_expert2</title>
<polygon fill="lightcoral" stroke="black" points="79255.2,-1004.16 79034.2,-1004.16 79034.2,-941.16 79255.2,-941.16 79255.2,-1004.16"/>
<text text-anchor="middle" x="79144.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="79144.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="79144.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="79144.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="79144.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp2&#45;&gt;layer12_expert2 -->
<g id="edge819" class="edge">
<title>layer12_route_exp2&#45;&gt;layer12_expert2</title>
<path fill="none" stroke="black" d="M79144.7,-1040.16C79144.7,-1040.16 79144.7,-1014.25 79144.7,-1014.25"/>
<polygon fill="black" stroke="black" points="79148.2,-1014.25 79144.7,-1004.25 79141.2,-1014.25 79148.2,-1014.25"/>
</g>
<!-- layer12_agg_exp2 -->
<g id="node677" class="node">
<title>layer12_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="79124.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="79124.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="79124.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="79124.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="79124.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert2&#45;&gt;layer12_agg_exp2 -->
<g id="edge820" class="edge">
<title>layer12_expert2&#45;&gt;layer12_agg_exp2</title>
<path fill="none" stroke="black" d="M79144.7,-941.09C79144.7,-941.09 79144.7,-914.97 79144.7,-914.97"/>
<polygon fill="black" stroke="black" points="79148.2,-914.97 79144.7,-904.97 79141.2,-914.97 79148.2,-914.97"/>
</g>
<!-- layer12_agg_exp2&#45;&gt;layer12_moe_agg -->
<g id="edge821" class="edge">
<title>layer12_agg_exp2&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M79124.7,-831.57C79124.7,-798.47 79124.7,-755 79124.7,-755 79124.7,-755 81202.56,-755 81202.56,-755"/>
<polygon fill="black" stroke="black" points="81202.56,-758.5 81212.56,-755 81202.56,-751.5 81202.56,-758.5"/>
</g>
<!-- layer12_expert3 -->
<g id="node679" class="node">
<title>layer12_expert3</title>
<polygon fill="lightcoral" stroke="black" points="79670.2,-1004.16 79449.2,-1004.16 79449.2,-941.16 79670.2,-941.16 79670.2,-1004.16"/>
<text text-anchor="middle" x="79559.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="79559.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="79559.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="79559.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="79559.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp3&#45;&gt;layer12_expert3 -->
<g id="edge823" class="edge">
<title>layer12_route_exp3&#45;&gt;layer12_expert3</title>
<path fill="none" stroke="black" d="M79559.7,-1040.16C79559.7,-1040.16 79559.7,-1014.25 79559.7,-1014.25"/>
<polygon fill="black" stroke="black" points="79563.2,-1014.25 79559.7,-1004.25 79556.2,-1014.25 79563.2,-1014.25"/>
</g>
<!-- layer12_agg_exp3 -->
<g id="node680" class="node">
<title>layer12_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="79539.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="79539.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="79539.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="79539.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="79539.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert3&#45;&gt;layer12_agg_exp3 -->
<g id="edge824" class="edge">
<title>layer12_expert3&#45;&gt;layer12_agg_exp3</title>
<path fill="none" stroke="black" d="M79559.7,-941.09C79559.7,-941.09 79559.7,-914.97 79559.7,-914.97"/>
<polygon fill="black" stroke="black" points="79563.2,-914.97 79559.7,-904.97 79556.2,-914.97 79563.2,-914.97"/>
</g>
<!-- layer12_agg_exp3&#45;&gt;layer12_moe_agg -->
<g id="edge825" class="edge">
<title>layer12_agg_exp3&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M79539.7,-831.39C79539.7,-799.99 79539.7,-760 79539.7,-760 79539.7,-760 81213.9,-760 81213.9,-760"/>
<polygon fill="black" stroke="black" points="81213.9,-763.5 81223.9,-760 81213.9,-756.5 81213.9,-763.5"/>
</g>
<!-- layer12_expert4 -->
<g id="node682" class="node">
<title>layer12_expert4</title>
<polygon fill="lightcoral" stroke="black" points="80083.2,-1004.16 79862.2,-1004.16 79862.2,-941.16 80083.2,-941.16 80083.2,-1004.16"/>
<text text-anchor="middle" x="79972.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="79972.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="79972.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="79972.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="79972.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp4&#45;&gt;layer12_expert4 -->
<g id="edge827" class="edge">
<title>layer12_route_exp4&#45;&gt;layer12_expert4</title>
<path fill="none" stroke="black" d="M79972.7,-1040.16C79972.7,-1040.16 79972.7,-1014.25 79972.7,-1014.25"/>
<polygon fill="black" stroke="black" points="79976.2,-1014.25 79972.7,-1004.25 79969.2,-1014.25 79976.2,-1014.25"/>
</g>
<!-- layer12_agg_exp4 -->
<g id="node683" class="node">
<title>layer12_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="79954.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="79954.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="79954.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="79954.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="79954.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert4&#45;&gt;layer12_agg_exp4 -->
<g id="edge828" class="edge">
<title>layer12_expert4&#45;&gt;layer12_agg_exp4</title>
<path fill="none" stroke="black" d="M79972.7,-941.09C79972.7,-941.09 79972.7,-915.34 79972.7,-915.34"/>
<polygon fill="black" stroke="black" points="79976.2,-915.34 79972.7,-905.34 79969.2,-915.34 79976.2,-915.34"/>
</g>
<!-- layer12_agg_exp4&#45;&gt;layer12_moe_agg -->
<g id="edge829" class="edge">
<title>layer12_agg_exp4&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M79954.7,-831.35C79954.7,-801.69 79954.7,-765 79954.7,-765 79954.7,-765 81230.67,-765 81230.67,-765"/>
<polygon fill="black" stroke="black" points="81230.67,-768.5 81240.67,-765 81230.66,-761.5 81230.67,-768.5"/>
</g>
<!-- layer12_expert5 -->
<g id="node685" class="node">
<title>layer12_expert5</title>
<polygon fill="lightcoral" stroke="black" points="80494.2,-1004.16 80273.2,-1004.16 80273.2,-941.16 80494.2,-941.16 80494.2,-1004.16"/>
<text text-anchor="middle" x="80383.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="80383.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="80383.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="80383.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="80383.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp5&#45;&gt;layer12_expert5 -->
<g id="edge831" class="edge">
<title>layer12_route_exp5&#45;&gt;layer12_expert5</title>
<path fill="none" stroke="black" d="M80383.7,-1040.16C80383.7,-1040.16 80383.7,-1014.25 80383.7,-1014.25"/>
<polygon fill="black" stroke="black" points="80387.2,-1014.25 80383.7,-1004.25 80380.2,-1014.25 80387.2,-1014.25"/>
</g>
<!-- layer12_agg_exp5 -->
<g id="node686" class="node">
<title>layer12_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="80369.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="80369.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="80369.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="80369.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="80369.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert5&#45;&gt;layer12_agg_exp5 -->
<g id="edge832" class="edge">
<title>layer12_expert5&#45;&gt;layer12_agg_exp5</title>
<path fill="none" stroke="black" d="M80383.7,-941.09C80383.7,-941.09 80383.7,-915.34 80383.7,-915.34"/>
<polygon fill="black" stroke="black" points="80387.2,-915.34 80383.7,-905.34 80380.2,-915.34 80387.2,-915.34"/>
</g>
<!-- layer12_agg_exp5&#45;&gt;layer12_moe_agg -->
<g id="edge833" class="edge">
<title>layer12_agg_exp5&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M80369.7,-831.47C80369.7,-803.55 80369.7,-770 80369.7,-770 80369.7,-770 81254.73,-770 81254.73,-770"/>
<polygon fill="black" stroke="black" points="81254.73,-773.5 81264.73,-770 81254.73,-766.5 81254.73,-773.5"/>
</g>
<!-- layer12_expert6 -->
<g id="node688" class="node">
<title>layer12_expert6</title>
<polygon fill="lightcoral" stroke="black" points="80904.2,-1004.16 80683.2,-1004.16 80683.2,-941.16 80904.2,-941.16 80904.2,-1004.16"/>
<text text-anchor="middle" x="80793.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="80793.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="80793.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="80793.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="80793.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp6&#45;&gt;layer12_expert6 -->
<g id="edge835" class="edge">
<title>layer12_route_exp6&#45;&gt;layer12_expert6</title>
<path fill="none" stroke="black" d="M80793.7,-1040.16C80793.7,-1040.16 80793.7,-1014.25 80793.7,-1014.25"/>
<polygon fill="black" stroke="black" points="80797.2,-1014.25 80793.7,-1004.25 80790.2,-1014.25 80797.2,-1014.25"/>
</g>
<!-- layer12_agg_exp6 -->
<g id="node689" class="node">
<title>layer12_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="80784.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="80784.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="80784.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="80784.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="80784.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert6&#45;&gt;layer12_agg_exp6 -->
<g id="edge836" class="edge">
<title>layer12_expert6&#45;&gt;layer12_agg_exp6</title>
<path fill="none" stroke="black" d="M80793.7,-941.09C80793.7,-941.09 80793.7,-915.34 80793.7,-915.34"/>
<polygon fill="black" stroke="black" points="80797.2,-915.34 80793.7,-905.34 80790.2,-915.34 80797.2,-915.34"/>
</g>
<!-- layer12_agg_exp6&#45;&gt;layer12_moe_agg -->
<g id="edge837" class="edge">
<title>layer12_agg_exp6&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M80975.8,-858.04C80975.8,-833.72 80975.8,-775 80975.8,-775 80975.8,-775 81290.66,-775 81290.66,-775"/>
<polygon fill="black" stroke="black" points="81290.66,-778.5 81300.66,-775 81290.66,-771.5 81290.66,-778.5"/>
</g>
<!-- layer12_expert7 -->
<g id="node691" class="node">
<title>layer12_expert7</title>
<polygon fill="lightcoral" stroke="black" points="81315.2,-1004.16 81094.2,-1004.16 81094.2,-941.16 81315.2,-941.16 81315.2,-1004.16"/>
<text text-anchor="middle" x="81204.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="81204.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="81204.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="81204.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="81204.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp7&#45;&gt;layer12_expert7 -->
<g id="edge839" class="edge">
<title>layer12_route_exp7&#45;&gt;layer12_expert7</title>
<path fill="none" stroke="black" d="M81204.7,-1040.16C81204.7,-1040.16 81204.7,-1014.25 81204.7,-1014.25"/>
<polygon fill="black" stroke="black" points="81208.2,-1014.25 81204.7,-1004.25 81201.2,-1014.25 81208.2,-1014.25"/>
</g>
<!-- layer12_agg_exp7 -->
<g id="node692" class="node">
<title>layer12_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="81199.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="81199.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="81199.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="81199.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="81199.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert7&#45;&gt;layer12_agg_exp7 -->
<g id="edge840" class="edge">
<title>layer12_expert7&#45;&gt;layer12_agg_exp7</title>
<path fill="none" stroke="black" d="M81204.7,-941.09C81204.7,-941.09 81204.7,-915.34 81204.7,-915.34"/>
<polygon fill="black" stroke="black" points="81208.2,-915.34 81204.7,-905.34 81201.2,-915.34 81208.2,-915.34"/>
</g>
<!-- layer12_agg_exp7&#45;&gt;layer12_moe_agg -->
<g id="edge841" class="edge">
<title>layer12_agg_exp7&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M81300.52,-836.58C81300.52,-836.58 81300.52,-785.37 81300.52,-785.37"/>
<polygon fill="black" stroke="black" points="81304.02,-785.37 81300.52,-775.37 81297.02,-785.37 81304.02,-785.37"/>
</g>
<!-- layer12_expert8 -->
<g id="node694" class="node">
<title>layer12_expert8</title>
<polygon fill="lightcoral" stroke="black" points="81725.2,-1004.16 81504.2,-1004.16 81504.2,-941.16 81725.2,-941.16 81725.2,-1004.16"/>
<text text-anchor="middle" x="81614.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="81614.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="81614.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="81614.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="81614.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp8&#45;&gt;layer12_expert8 -->
<g id="edge843" class="edge">
<title>layer12_route_exp8&#45;&gt;layer12_expert8</title>
<path fill="none" stroke="black" d="M81614.7,-1039.87C81614.7,-1039.87 81614.7,-1014.41 81614.7,-1014.41"/>
<polygon fill="black" stroke="black" points="81618.2,-1014.41 81614.7,-1004.41 81611.2,-1014.41 81618.2,-1014.41"/>
</g>
<!-- layer12_agg_exp8 -->
<g id="node695" class="node">
<title>layer12_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="81614.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="81614.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="81614.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="81614.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="81614.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert8&#45;&gt;layer12_agg_exp8 -->
<g id="edge844" class="edge">
<title>layer12_expert8&#45;&gt;layer12_agg_exp8</title>
<path fill="none" stroke="black" d="M81614.7,-941.09C81614.7,-941.09 81614.7,-915.34 81614.7,-915.34"/>
<polygon fill="black" stroke="black" points="81618.2,-915.34 81614.7,-905.34 81611.2,-915.34 81618.2,-915.34"/>
</g>
<!-- layer12_agg_exp8&#45;&gt;layer12_moe_agg -->
<g id="edge845" class="edge">
<title>layer12_agg_exp8&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M81514.38,-836.58C81514.38,-836.58 81514.38,-785.37 81514.38,-785.37"/>
<polygon fill="black" stroke="black" points="81517.88,-785.37 81514.38,-775.37 81510.88,-785.37 81517.88,-785.37"/>
</g>
<!-- layer12_expert9 -->
<g id="node697" class="node">
<title>layer12_expert9</title>
<polygon fill="lightcoral" stroke="black" points="82135.2,-1004.16 81914.2,-1004.16 81914.2,-941.16 82135.2,-941.16 82135.2,-1004.16"/>
<text text-anchor="middle" x="82024.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="82024.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="82024.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="82024.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="82024.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp9&#45;&gt;layer12_expert9 -->
<g id="edge847" class="edge">
<title>layer12_route_exp9&#45;&gt;layer12_expert9</title>
<path fill="none" stroke="black" d="M82024.7,-1039.87C82024.7,-1039.87 82024.7,-1014.41 82024.7,-1014.41"/>
<polygon fill="black" stroke="black" points="82028.2,-1014.41 82024.7,-1004.41 82021.2,-1014.41 82028.2,-1014.41"/>
</g>
<!-- layer12_agg_exp9 -->
<g id="node698" class="node">
<title>layer12_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="82029.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="82029.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="82029.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="82029.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="82029.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert9&#45;&gt;layer12_agg_exp9 -->
<g id="edge848" class="edge">
<title>layer12_expert9&#45;&gt;layer12_agg_exp9</title>
<path fill="none" stroke="black" d="M82024.7,-941.09C82024.7,-941.09 82024.7,-915.34 82024.7,-915.34"/>
<polygon fill="black" stroke="black" points="82028.2,-915.34 82024.7,-905.34 82021.2,-915.34 82028.2,-915.34"/>
</g>
<!-- layer12_agg_exp9&#45;&gt;layer12_moe_agg -->
<g id="edge849" class="edge">
<title>layer12_agg_exp9&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M82029.7,-831.54C82029.7,-793.92 82029.7,-741 82029.7,-741 82029.7,-741 81622.66,-741 81622.66,-741"/>
<polygon fill="black" stroke="black" points="81622.66,-737.5 81612.66,-741 81622.66,-744.5 81622.66,-737.5"/>
</g>
<!-- layer12_expert10 -->
<g id="node700" class="node">
<title>layer12_expert10</title>
<polygon fill="lightcoral" stroke="black" points="82550.2,-1004.16 82329.2,-1004.16 82329.2,-941.16 82550.2,-941.16 82550.2,-1004.16"/>
<text text-anchor="middle" x="82439.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="82439.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="82439.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="82439.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="82439.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp10&#45;&gt;layer12_expert10 -->
<g id="edge851" class="edge">
<title>layer12_route_exp10&#45;&gt;layer12_expert10</title>
<path fill="none" stroke="black" d="M82439.7,-1040.16C82439.7,-1040.16 82439.7,-1014.25 82439.7,-1014.25"/>
<polygon fill="black" stroke="black" points="82443.2,-1014.25 82439.7,-1004.25 82436.2,-1014.25 82443.2,-1014.25"/>
</g>
<!-- layer12_agg_exp10 -->
<g id="node701" class="node">
<title>layer12_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="82444.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="82444.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="82444.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="82444.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="82444.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert10&#45;&gt;layer12_agg_exp10 -->
<g id="edge852" class="edge">
<title>layer12_expert10&#45;&gt;layer12_agg_exp10</title>
<path fill="none" stroke="black" d="M82439.7,-941.09C82439.7,-941.09 82439.7,-915.34 82439.7,-915.34"/>
<polygon fill="black" stroke="black" points="82443.2,-915.34 82439.7,-905.34 82436.2,-915.34 82443.2,-915.34"/>
</g>
<!-- layer12_agg_exp10&#45;&gt;layer12_moe_agg -->
<g id="edge853" class="edge">
<title>layer12_agg_exp10&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M82444.7,-831.51C82444.7,-792.34 82444.7,-736 82444.7,-736 82444.7,-736 81618.56,-736 81618.56,-736"/>
<polygon fill="black" stroke="black" points="81618.56,-732.5 81608.56,-736 81618.56,-739.5 81618.56,-732.5"/>
</g>
<!-- layer12_expert11 -->
<g id="node703" class="node">
<title>layer12_expert11</title>
<polygon fill="lightcoral" stroke="black" points="82964.2,-1004.16 82743.2,-1004.16 82743.2,-941.16 82964.2,-941.16 82964.2,-1004.16"/>
<text text-anchor="middle" x="82853.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="82853.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="82853.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="82853.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="82853.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp11&#45;&gt;layer12_expert11 -->
<g id="edge855" class="edge">
<title>layer12_route_exp11&#45;&gt;layer12_expert11</title>
<path fill="none" stroke="black" d="M82853.7,-1040.16C82853.7,-1040.16 82853.7,-1014.25 82853.7,-1014.25"/>
<polygon fill="black" stroke="black" points="82857.2,-1014.25 82853.7,-1004.25 82850.2,-1014.25 82857.2,-1014.25"/>
</g>
<!-- layer12_agg_exp11 -->
<g id="node704" class="node">
<title>layer12_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="82859.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="82859.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="82859.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="82859.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="82859.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert11&#45;&gt;layer12_agg_exp11 -->
<g id="edge856" class="edge">
<title>layer12_expert11&#45;&gt;layer12_agg_exp11</title>
<path fill="none" stroke="black" d="M82853.7,-941.09C82853.7,-941.09 82853.7,-915.34 82853.7,-915.34"/>
<polygon fill="black" stroke="black" points="82857.2,-915.34 82853.7,-905.34 82850.2,-915.34 82857.2,-915.34"/>
</g>
<!-- layer12_agg_exp11&#45;&gt;layer12_moe_agg -->
<g id="edge857" class="edge">
<title>layer12_agg_exp11&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M82859.7,-831.57C82859.7,-790.87 82859.7,-731 82859.7,-731 82859.7,-731 81610.51,-731 81610.51,-731"/>
<polygon fill="black" stroke="black" points="81610.51,-727.5 81600.51,-731 81610.51,-734.5 81610.51,-727.5"/>
</g>
<!-- layer12_expert12 -->
<g id="node706" class="node">
<title>layer12_expert12</title>
<polygon fill="lightcoral" stroke="black" points="83379.2,-1004.16 83158.2,-1004.16 83158.2,-941.16 83379.2,-941.16 83379.2,-1004.16"/>
<text text-anchor="middle" x="83268.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="83268.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="83268.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="83268.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="83268.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp12&#45;&gt;layer12_expert12 -->
<g id="edge859" class="edge">
<title>layer12_route_exp12&#45;&gt;layer12_expert12</title>
<path fill="none" stroke="black" d="M83268.7,-1040.16C83268.7,-1040.16 83268.7,-1014.25 83268.7,-1014.25"/>
<polygon fill="black" stroke="black" points="83272.2,-1014.25 83268.7,-1004.25 83265.2,-1014.25 83272.2,-1014.25"/>
</g>
<!-- layer12_agg_exp12 -->
<g id="node707" class="node">
<title>layer12_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="83274.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="83274.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="83274.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="83274.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="83274.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert12&#45;&gt;layer12_agg_exp12 -->
<g id="edge860" class="edge">
<title>layer12_expert12&#45;&gt;layer12_agg_exp12</title>
<path fill="none" stroke="black" d="M83268.7,-941.09C83268.7,-941.09 83268.7,-915.34 83268.7,-915.34"/>
<polygon fill="black" stroke="black" points="83272.2,-915.34 83268.7,-905.34 83265.2,-915.34 83272.2,-915.34"/>
</g>
<!-- layer12_agg_exp12&#45;&gt;layer12_moe_agg -->
<g id="edge861" class="edge">
<title>layer12_agg_exp12&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M83274.7,-831.35C83274.7,-789.16 83274.7,-726 83274.7,-726 83274.7,-726 81597.98,-726 81597.98,-726"/>
<polygon fill="black" stroke="black" points="81597.98,-722.5 81587.98,-726 81597.98,-729.5 81597.98,-722.5"/>
</g>
<!-- layer12_expert13 -->
<g id="node709" class="node">
<title>layer12_expert13</title>
<polygon fill="lightcoral" stroke="black" points="83794.2,-1004.16 83573.2,-1004.16 83573.2,-941.16 83794.2,-941.16 83794.2,-1004.16"/>
<text text-anchor="middle" x="83683.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="83683.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="83683.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="83683.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="83683.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp13&#45;&gt;layer12_expert13 -->
<g id="edge863" class="edge">
<title>layer12_route_exp13&#45;&gt;layer12_expert13</title>
<path fill="none" stroke="black" d="M83683.7,-1040.16C83683.7,-1040.16 83683.7,-1014.25 83683.7,-1014.25"/>
<polygon fill="black" stroke="black" points="83687.2,-1014.25 83683.7,-1004.25 83680.2,-1014.25 83687.2,-1014.25"/>
</g>
<!-- layer12_agg_exp13 -->
<g id="node710" class="node">
<title>layer12_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="83689.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="83689.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="83689.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="83689.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="83689.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert13&#45;&gt;layer12_agg_exp13 -->
<g id="edge864" class="edge">
<title>layer12_expert13&#45;&gt;layer12_agg_exp13</title>
<path fill="none" stroke="black" d="M83683.7,-941.09C83683.7,-941.09 83683.7,-915.34 83683.7,-915.34"/>
<polygon fill="black" stroke="black" points="83687.2,-915.34 83683.7,-905.34 83680.2,-915.34 83687.2,-915.34"/>
</g>
<!-- layer12_agg_exp13&#45;&gt;layer12_moe_agg -->
<g id="edge865" class="edge">
<title>layer12_agg_exp13&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M83689.7,-831.58C83689.7,-787.92 83689.7,-721 83689.7,-721 83689.7,-721 81579.53,-721 81579.53,-721"/>
<polygon fill="black" stroke="black" points="81579.53,-717.5 81569.53,-721 81579.53,-724.5 81579.53,-717.5"/>
</g>
<!-- layer12_expert14 -->
<g id="node712" class="node">
<title>layer12_expert14</title>
<polygon fill="lightcoral" stroke="black" points="84209.2,-1004.16 83988.2,-1004.16 83988.2,-941.16 84209.2,-941.16 84209.2,-1004.16"/>
<text text-anchor="middle" x="84098.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="84098.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="84098.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="84098.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="84098.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp14&#45;&gt;layer12_expert14 -->
<g id="edge867" class="edge">
<title>layer12_route_exp14&#45;&gt;layer12_expert14</title>
<path fill="none" stroke="black" d="M84098.7,-1040.16C84098.7,-1040.16 84098.7,-1014.25 84098.7,-1014.25"/>
<polygon fill="black" stroke="black" points="84102.2,-1014.25 84098.7,-1004.25 84095.2,-1014.25 84102.2,-1014.25"/>
</g>
<!-- layer12_agg_exp14 -->
<g id="node713" class="node">
<title>layer12_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="84104.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="84104.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="84104.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="84104.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="84104.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert14&#45;&gt;layer12_agg_exp14 -->
<g id="edge868" class="edge">
<title>layer12_expert14&#45;&gt;layer12_agg_exp14</title>
<path fill="none" stroke="black" d="M84098.7,-941.09C84098.7,-941.09 84098.7,-915.34 84098.7,-915.34"/>
<polygon fill="black" stroke="black" points="84102.2,-915.34 84098.7,-905.34 84095.2,-915.34 84102.2,-915.34"/>
</g>
<!-- layer12_agg_exp14&#45;&gt;layer12_moe_agg -->
<g id="edge869" class="edge">
<title>layer12_agg_exp14&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M84104.7,-831.5C84104.7,-786.4 84104.7,-716 84104.7,-716 84104.7,-716 81553.29,-716 81553.29,-716"/>
<polygon fill="black" stroke="black" points="81553.29,-712.5 81543.29,-716 81553.29,-719.5 81553.29,-712.5"/>
</g>
<!-- layer12_expert15 -->
<g id="node715" class="node">
<title>layer12_expert15</title>
<polygon fill="lightcoral" stroke="black" points="84624.2,-1004.16 84403.2,-1004.16 84403.2,-941.16 84624.2,-941.16 84624.2,-1004.16"/>
<text text-anchor="middle" x="84513.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="84513.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="84513.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="84513.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="84513.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer12_route_exp15&#45;&gt;layer12_expert15 -->
<g id="edge871" class="edge">
<title>layer12_route_exp15&#45;&gt;layer12_expert15</title>
<path fill="none" stroke="black" d="M84513.7,-1040.16C84513.7,-1040.16 84513.7,-1014.25 84513.7,-1014.25"/>
<polygon fill="black" stroke="black" points="84517.2,-1014.25 84513.7,-1004.25 84510.2,-1014.25 84517.2,-1014.25"/>
</g>
<!-- layer12_agg_exp15 -->
<g id="node716" class="node">
<title>layer12_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="84519.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="84519.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="84519.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="84519.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="84519.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer12_expert15&#45;&gt;layer12_agg_exp15 -->
<g id="edge872" class="edge">
<title>layer12_expert15&#45;&gt;layer12_agg_exp15</title>
<path fill="none" stroke="black" d="M84513.7,-941.09C84513.7,-941.09 84513.7,-915.34 84513.7,-915.34"/>
<polygon fill="black" stroke="black" points="84517.2,-915.34 84513.7,-905.34 84510.2,-915.34 84517.2,-915.34"/>
</g>
<!-- layer12_agg_exp15&#45;&gt;layer12_moe_agg -->
<g id="edge873" class="edge">
<title>layer12_agg_exp15&#45;&gt;layer12_moe_agg</title>
<path fill="none" stroke="black" d="M84519.7,-831.49C84519.7,-784.97 84519.7,-711 84519.7,-711 84519.7,-711 81512.53,-711 81512.53,-711"/>
<polygon fill="black" stroke="black" points="81512.53,-707.5 81502.53,-711 81512.53,-714.5 81512.53,-707.5"/>
</g>
<!-- layer13_ln1 -->
<g id="node718" class="node">
<title>layer13_ln1</title>
<polygon fill="none" stroke="black" points="84872.2,-1227.7 84591.2,-1227.7 84591.2,-1175.7 84872.2,-1175.7 84872.2,-1227.7"/>
<text text-anchor="middle" x="84731.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 13</text>
<text text-anchor="middle" x="84731.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="84731.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="84731.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer13_add1 -->
<g id="node719" class="node">
<title>layer13_add1</title>
<polygon fill="yellow" stroke="black" points="87889.2,-644.85 87608.2,-644.85 87608.2,-592.85 87889.2,-592.85 87889.2,-644.85"/>
<text text-anchor="middle" x="87748.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 13</text>
<text text-anchor="middle" x="87748.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="87748.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="87748.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_moe_output -->
<g id="node723" class="node">
<title>layer13_moe_output</title>
<polygon fill="yellow" stroke="black" points="88039.2,-540.58 87758.2,-540.58 87758.2,-488.58 88039.2,-488.58 88039.2,-540.58"/>
<text text-anchor="middle" x="87898.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 13</text>
<text text-anchor="middle" x="87898.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="87898.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="87898.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_add1&#45;&gt;layer13_moe_output -->
<g id="edge943" class="edge">
<title>layer13_add1&#45;&gt;layer13_moe_output</title>
<path fill="none" stroke="black" d="M87823.7,-592.81C87823.7,-592.81 87823.7,-550.65 87823.7,-550.65"/>
<polygon fill="black" stroke="black" points="87827.2,-550.65 87823.7,-540.65 87820.2,-550.65 87827.2,-550.65"/>
</g>
<!-- layer13_gate -->
<g id="node720" class="node">
<title>layer13_gate</title>
<polygon fill="lightgreen" stroke="black" points="88340.13,-1253.7 87881.3,-1253.7 87763.26,-1149.7 88222.1,-1149.7 88340.13,-1253.7"/>
<text text-anchor="middle" x="88051.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 13</text>
<text text-anchor="middle" x="88051.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="88051.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="88051.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer13_route_exp0 -->
<g id="node724" class="node">
<title>layer13_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="84935.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="84935.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="84935.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="84935.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="84935.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp0 -->
<g id="edge877" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp0</title>
<path fill="none" stroke="black" d="M87789.6,-1173C87050.13,-1173 85000.82,-1173 85000.82,-1173 85000.82,-1173 85000.82,-1121.61 85000.82,-1121.61"/>
<polygon fill="black" stroke="black" points="85004.32,-1121.61 85000.82,-1111.61 84997.32,-1121.61 85004.32,-1121.61"/>
</g>
<!-- layer13_route_exp1 -->
<g id="node727" class="node">
<title>layer13_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="85380.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="85380.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="85380.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="85380.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="85380.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp1 -->
<g id="edge881" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp1</title>
<path fill="none" stroke="black" d="M87783.98,-1168C87107.08,-1168 85380.7,-1168 85380.7,-1168 85380.7,-1168 85380.7,-1123.71 85380.7,-1123.71"/>
<polygon fill="black" stroke="black" points="85384.2,-1123.71 85380.7,-1113.71 85377.2,-1123.71 85384.2,-1123.71"/>
</g>
<!-- layer13_route_exp2 -->
<g id="node730" class="node">
<title>layer13_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="85805.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="85805.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="85805.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="85805.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="85805.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp2 -->
<g id="edge885" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp2</title>
<path fill="none" stroke="black" d="M87780.5,-1165C87182.98,-1165 85805.7,-1165 85805.7,-1165 85805.7,-1165 85805.7,-1123.77 85805.7,-1123.77"/>
<polygon fill="black" stroke="black" points="85809.2,-1123.77 85805.7,-1113.77 85802.2,-1123.77 85809.2,-1123.77"/>
</g>
<!-- layer13_route_exp3 -->
<g id="node733" class="node">
<title>layer13_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="86220.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="86220.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="86220.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="86220.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="86220.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp3 -->
<g id="edge889" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp3</title>
<path fill="none" stroke="black" d="M87776.09,-1161C87264.76,-1161 86220.7,-1161 86220.7,-1161 86220.7,-1161 86220.7,-1124.05 86220.7,-1124.05"/>
<polygon fill="black" stroke="black" points="86224.2,-1124.05 86220.7,-1114.05 86217.2,-1124.05 86224.2,-1124.05"/>
</g>
<!-- layer13_route_exp4 -->
<g id="node736" class="node">
<title>layer13_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="86630.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="86630.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="86630.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="86630.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="86630.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp4 -->
<g id="edge893" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp4</title>
<path fill="none" stroke="black" d="M87772.65,-1158C87358.82,-1158 86630.7,-1158 86630.7,-1158 86630.7,-1158 86630.7,-1124.14 86630.7,-1124.14"/>
<polygon fill="black" stroke="black" points="86634.2,-1124.14 86630.7,-1114.14 86627.2,-1124.14 86634.2,-1124.14"/>
</g>
<!-- layer13_route_exp5 -->
<g id="node739" class="node">
<title>layer13_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="87037.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="87037.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="87037.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="87037.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="87037.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp5 -->
<g id="edge897" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp5</title>
<path fill="none" stroke="black" d="M87767.89,-1154C87467.92,-1154 87037.7,-1154 87037.7,-1154 87037.7,-1154 87037.7,-1124.11 87037.7,-1124.11"/>
<polygon fill="black" stroke="black" points="87041.2,-1124.11 87037.7,-1114.11 87034.2,-1124.11 87041.2,-1124.11"/>
</g>
<!-- layer13_route_exp6 -->
<g id="node742" class="node">
<title>layer13_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="87443.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="87443.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="87443.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="87443.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="87443.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp6 -->
<g id="edge901" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp6</title>
<path fill="none" stroke="black" d="M87764.61,-1151C87607.19,-1151 87443.7,-1151 87443.7,-1151 87443.7,-1151 87443.7,-1123.96 87443.7,-1123.96"/>
<polygon fill="black" stroke="black" points="87447.2,-1123.96 87443.7,-1113.96 87440.2,-1123.96 87447.2,-1123.96"/>
</g>
<!-- layer13_route_exp7 -->
<g id="node745" class="node">
<title>layer13_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="87849.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="87849.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="87849.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="87849.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="87849.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp7 -->
<g id="edge905" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp7</title>
<path fill="none" stroke="black" d="M87903.46,-1149.5C87903.46,-1149.5 87903.46,-1122.25 87903.46,-1122.25"/>
<polygon fill="black" stroke="black" points="87906.96,-1122.25 87903.46,-1112.25 87899.96,-1122.25 87906.96,-1122.25"/>
</g>
<!-- layer13_route_exp8 -->
<g id="node748" class="node">
<title>layer13_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="88254.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="88254.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="88254.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="88254.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="88254.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp8 -->
<g id="edge909" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp8</title>
<path fill="none" stroke="black" d="M88200.43,-1149.5C88200.43,-1149.5 88200.43,-1122.25 88200.43,-1122.25"/>
<polygon fill="black" stroke="black" points="88203.93,-1122.25 88200.43,-1112.25 88196.93,-1122.25 88203.93,-1122.25"/>
</g>
<!-- layer13_route_exp9 -->
<g id="node751" class="node">
<title>layer13_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="88664.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="88664.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="88664.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="88664.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="88664.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp9 -->
<g id="edge913" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp9</title>
<path fill="none" stroke="black" d="M88226.13,-1153C88407.34,-1153 88664.7,-1153 88664.7,-1153 88664.7,-1153 88664.7,-1124.07 88664.7,-1124.07"/>
<polygon fill="black" stroke="black" points="88668.2,-1124.07 88664.7,-1114.07 88661.2,-1124.07 88668.2,-1124.07"/>
</g>
<!-- layer13_route_exp10 -->
<g id="node754" class="node">
<title>layer13_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="89073.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="89073.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="89073.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="89073.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="89073.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp10 -->
<g id="edge917" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp10</title>
<path fill="none" stroke="black" d="M88229.42,-1156C88522.16,-1156 89073.7,-1156 89073.7,-1156 89073.7,-1156 89073.7,-1124.15 89073.7,-1124.15"/>
<polygon fill="black" stroke="black" points="89077.2,-1124.15 89073.7,-1114.15 89070.2,-1124.15 89077.2,-1124.15"/>
</g>
<!-- layer13_route_exp11 -->
<g id="node757" class="node">
<title>layer13_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="89485.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="89485.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="89485.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="89485.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="89485.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp11 -->
<g id="edge921" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp11</title>
<path fill="none" stroke="black" d="M88234.04,-1160C88620.27,-1160 89485.7,-1160 89485.7,-1160 89485.7,-1160 89485.7,-1124.09 89485.7,-1124.09"/>
<polygon fill="black" stroke="black" points="89489.2,-1124.09 89485.7,-1114.09 89482.2,-1124.09 89489.2,-1124.09"/>
</g>
<!-- layer13_route_exp12 -->
<g id="node760" class="node">
<title>layer13_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="89898.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="89898.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="89898.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="89898.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="89898.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp12 -->
<g id="edge925" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp12</title>
<path fill="none" stroke="black" d="M88237.25,-1163C88705.63,-1163 89898.7,-1163 89898.7,-1163 89898.7,-1163 89898.7,-1123.93 89898.7,-1123.93"/>
<polygon fill="black" stroke="black" points="89902.2,-1123.93 89898.7,-1113.93 89895.2,-1123.93 89902.2,-1123.93"/>
</g>
<!-- layer13_route_exp13 -->
<g id="node763" class="node">
<title>layer13_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="90312.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="90312.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="90312.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="90312.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="90312.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp13 -->
<g id="edge929" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp13</title>
<path fill="none" stroke="black" d="M88242.03,-1167C88786.71,-1167 90312.7,-1167 90312.7,-1167 90312.7,-1167 90312.7,-1123.82 90312.7,-1123.82"/>
<polygon fill="black" stroke="black" points="90316.2,-1123.82 90312.7,-1113.82 90309.2,-1123.82 90316.2,-1123.82"/>
</g>
<!-- layer13_route_exp14 -->
<g id="node766" class="node">
<title>layer13_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="90726.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="90726.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="90726.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="90726.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="90726.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp14 -->
<g id="edge933" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp14</title>
<path fill="none" stroke="black" d="M88245.15,-1170C88859.61,-1170 90726.7,-1170 90726.7,-1170 90726.7,-1170 90726.7,-1123.71 90726.7,-1123.71"/>
<polygon fill="black" stroke="black" points="90730.2,-1123.71 90726.7,-1113.71 90723.2,-1123.71 90730.2,-1123.71"/>
</g>
<!-- layer13_route_exp15 -->
<g id="node769" class="node">
<title>layer13_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="91141.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="91141.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="91141.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="91141.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="91141.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_route_exp15 -->
<g id="edge937" class="edge">
<title>layer13_gate&#45;&gt;layer13_route_exp15</title>
<path fill="none" stroke="black" d="M88247.51,-1172C88919.35,-1172 91089.57,-1172 91089.57,-1172 91089.57,-1172 91089.57,-1122.6 91089.57,-1122.6"/>
<polygon fill="black" stroke="black" points="91093.07,-1122.6 91089.57,-1112.6 91086.07,-1122.6 91093.07,-1122.6"/>
</g>
<!-- layer13_moe_agg -->
<g id="node721" class="node">
<title>layer13_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="88047.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="88047.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 13</text>
<text text-anchor="middle" x="88047.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="88047.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="88047.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer13_ln2 -->
<g id="node722" class="node">
<title>layer13_ln2</title>
<polygon fill="none" stroke="black" points="88188.2,-644.85 87907.2,-644.85 87907.2,-592.85 88188.2,-592.85 88188.2,-644.85"/>
<text text-anchor="middle" x="88047.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 13</text>
<text text-anchor="middle" x="88047.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="88047.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="88047.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer13_moe_agg&#45;&gt;layer13_ln2 -->
<g id="edge941" class="edge">
<title>layer13_moe_agg&#45;&gt;layer13_ln2</title>
<path fill="none" stroke="black" d="M88047.7,-706.52C88047.7,-706.52 88047.7,-654.92 88047.7,-654.92"/>
<polygon fill="black" stroke="black" points="88051.2,-654.92 88047.7,-644.92 88044.2,-654.92 88051.2,-654.92"/>
</g>
<!-- layer13_ln2&#45;&gt;layer13_moe_output -->
<g id="edge942" class="edge">
<title>layer13_ln2&#45;&gt;layer13_moe_output</title>
<path fill="none" stroke="black" d="M87973.2,-592.81C87973.2,-592.81 87973.2,-550.65 87973.2,-550.65"/>
<polygon fill="black" stroke="black" points="87976.7,-550.65 87973.2,-540.65 87969.7,-550.65 87976.7,-550.65"/>
</g>
<!-- layer14_mha -->
<g id="node772" class="node">
<title>layer14_mha</title>
<polygon fill="lightcyan" stroke="black" points="88039.2,-436.31 87758.2,-436.31 87758.2,-384.31 88039.2,-384.31 88039.2,-436.31"/>
<text text-anchor="middle" x="87898.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 14</text>
<text text-anchor="middle" x="87898.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="87898.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="87898.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer13_moe_output&#45;&gt;layer14_mha -->
<g id="edge1091" class="edge">
<title>layer13_moe_output&#45;&gt;layer14_mha</title>
<path fill="none" stroke="black" d="M87898.7,-488.54C87898.7,-488.54 87898.7,-446.38 87898.7,-446.38"/>
<polygon fill="black" stroke="black" points="87902.2,-446.38 87898.7,-436.38 87895.2,-446.38 87902.2,-446.38"/>
</g>
<!-- layer13_expert0 -->
<g id="node725" class="node">
<title>layer13_expert0</title>
<polygon fill="lightcoral" stroke="black" points="85045.2,-1004.16 84824.2,-1004.16 84824.2,-941.16 85045.2,-941.16 85045.2,-1004.16"/>
<text text-anchor="middle" x="84934.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="84934.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="84934.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="84934.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="84934.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp0&#45;&gt;layer13_expert0 -->
<g id="edge878" class="edge">
<title>layer13_route_exp0&#45;&gt;layer13_expert0</title>
<path fill="none" stroke="black" d="M84934.7,-1039.87C84934.7,-1039.87 84934.7,-1014.41 84934.7,-1014.41"/>
<polygon fill="black" stroke="black" points="84938.2,-1014.41 84934.7,-1004.41 84931.2,-1014.41 84938.2,-1014.41"/>
</g>
<!-- layer13_agg_exp0 -->
<g id="node726" class="node">
<title>layer13_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="84934.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="84934.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="84934.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="84934.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="84934.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert0&#45;&gt;layer13_agg_exp0 -->
<g id="edge879" class="edge">
<title>layer13_expert0&#45;&gt;layer13_agg_exp0</title>
<path fill="none" stroke="black" d="M84934.7,-941.09C84934.7,-941.09 84934.7,-915.34 84934.7,-915.34"/>
<polygon fill="black" stroke="black" points="84938.2,-915.34 84934.7,-905.34 84931.2,-915.34 84938.2,-915.34"/>
</g>
<!-- layer13_agg_exp0&#45;&gt;layer13_moe_agg -->
<g id="edge880" class="edge">
<title>layer13_agg_exp0&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M84934.7,-831.33C84934.7,-795.31 84934.7,-746 84934.7,-746 84934.7,-746 87832.84,-746 87832.84,-746"/>
<polygon fill="black" stroke="black" points="87832.84,-749.5 87842.84,-746 87832.84,-742.5 87832.84,-749.5"/>
</g>
<!-- layer13_expert1 -->
<g id="node728" class="node">
<title>layer13_expert1</title>
<polygon fill="lightcoral" stroke="black" points="85475.2,-1004.16 85254.2,-1004.16 85254.2,-941.16 85475.2,-941.16 85475.2,-1004.16"/>
<text text-anchor="middle" x="85364.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="85364.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="85364.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="85364.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="85364.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp1&#45;&gt;layer13_expert1 -->
<g id="edge882" class="edge">
<title>layer13_route_exp1&#45;&gt;layer13_expert1</title>
<path fill="none" stroke="black" d="M85364.7,-1040.16C85364.7,-1040.16 85364.7,-1014.25 85364.7,-1014.25"/>
<polygon fill="black" stroke="black" points="85368.2,-1014.25 85364.7,-1004.25 85361.2,-1014.25 85368.2,-1014.25"/>
</g>
<!-- layer13_agg_exp1 -->
<g id="node729" class="node">
<title>layer13_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="85349.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="85349.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="85349.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="85349.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="85349.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert1&#45;&gt;layer13_agg_exp1 -->
<g id="edge883" class="edge">
<title>layer13_expert1&#45;&gt;layer13_agg_exp1</title>
<path fill="none" stroke="black" d="M85364.7,-941.09C85364.7,-941.09 85364.7,-915.34 85364.7,-915.34"/>
<polygon fill="black" stroke="black" points="85368.2,-915.34 85364.7,-905.34 85361.2,-915.34 85368.2,-915.34"/>
</g>
<!-- layer13_agg_exp1&#45;&gt;layer13_moe_agg -->
<g id="edge884" class="edge">
<title>layer13_agg_exp1&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M85349.7,-831.58C85349.7,-796.82 85349.7,-750 85349.7,-750 85349.7,-750 87835.74,-750 87835.74,-750"/>
<polygon fill="black" stroke="black" points="87835.74,-753.5 87845.74,-750 87835.74,-746.5 87835.74,-753.5"/>
</g>
<!-- layer13_expert2 -->
<g id="node731" class="node">
<title>layer13_expert2</title>
<polygon fill="lightcoral" stroke="black" points="85895.2,-1004.16 85674.2,-1004.16 85674.2,-941.16 85895.2,-941.16 85895.2,-1004.16"/>
<text text-anchor="middle" x="85784.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="85784.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="85784.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="85784.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="85784.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp2&#45;&gt;layer13_expert2 -->
<g id="edge886" class="edge">
<title>layer13_route_exp2&#45;&gt;layer13_expert2</title>
<path fill="none" stroke="black" d="M85784.7,-1040.16C85784.7,-1040.16 85784.7,-1014.25 85784.7,-1014.25"/>
<polygon fill="black" stroke="black" points="85788.2,-1014.25 85784.7,-1004.25 85781.2,-1014.25 85788.2,-1014.25"/>
</g>
<!-- layer13_agg_exp2 -->
<g id="node732" class="node">
<title>layer13_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="85764.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="85764.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="85764.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="85764.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="85764.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert2&#45;&gt;layer13_agg_exp2 -->
<g id="edge887" class="edge">
<title>layer13_expert2&#45;&gt;layer13_agg_exp2</title>
<path fill="none" stroke="black" d="M85784.7,-941.09C85784.7,-941.09 85784.7,-914.97 85784.7,-914.97"/>
<polygon fill="black" stroke="black" points="85788.2,-914.97 85784.7,-904.97 85781.2,-914.97 85788.2,-914.97"/>
</g>
<!-- layer13_agg_exp2&#45;&gt;layer13_moe_agg -->
<g id="edge888" class="edge">
<title>layer13_agg_exp2&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M85764.7,-831.57C85764.7,-798.47 85764.7,-755 85764.7,-755 85764.7,-755 87842.56,-755 87842.56,-755"/>
<polygon fill="black" stroke="black" points="87842.56,-758.5 87852.56,-755 87842.56,-751.5 87842.56,-758.5"/>
</g>
<!-- layer13_expert3 -->
<g id="node734" class="node">
<title>layer13_expert3</title>
<polygon fill="lightcoral" stroke="black" points="86310.2,-1004.16 86089.2,-1004.16 86089.2,-941.16 86310.2,-941.16 86310.2,-1004.16"/>
<text text-anchor="middle" x="86199.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="86199.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="86199.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="86199.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="86199.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp3&#45;&gt;layer13_expert3 -->
<g id="edge890" class="edge">
<title>layer13_route_exp3&#45;&gt;layer13_expert3</title>
<path fill="none" stroke="black" d="M86199.7,-1040.16C86199.7,-1040.16 86199.7,-1014.25 86199.7,-1014.25"/>
<polygon fill="black" stroke="black" points="86203.2,-1014.25 86199.7,-1004.25 86196.2,-1014.25 86203.2,-1014.25"/>
</g>
<!-- layer13_agg_exp3 -->
<g id="node735" class="node">
<title>layer13_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="86179.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="86179.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="86179.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="86179.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="86179.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert3&#45;&gt;layer13_agg_exp3 -->
<g id="edge891" class="edge">
<title>layer13_expert3&#45;&gt;layer13_agg_exp3</title>
<path fill="none" stroke="black" d="M86199.7,-941.09C86199.7,-941.09 86199.7,-914.97 86199.7,-914.97"/>
<polygon fill="black" stroke="black" points="86203.2,-914.97 86199.7,-904.97 86196.2,-914.97 86203.2,-914.97"/>
</g>
<!-- layer13_agg_exp3&#45;&gt;layer13_moe_agg -->
<g id="edge892" class="edge">
<title>layer13_agg_exp3&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M86179.7,-831.39C86179.7,-799.99 86179.7,-760 86179.7,-760 86179.7,-760 87853.9,-760 87853.9,-760"/>
<polygon fill="black" stroke="black" points="87853.9,-763.5 87863.9,-760 87853.9,-756.5 87853.9,-763.5"/>
</g>
<!-- layer13_expert4 -->
<g id="node737" class="node">
<title>layer13_expert4</title>
<polygon fill="lightcoral" stroke="black" points="86723.2,-1004.16 86502.2,-1004.16 86502.2,-941.16 86723.2,-941.16 86723.2,-1004.16"/>
<text text-anchor="middle" x="86612.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="86612.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="86612.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="86612.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="86612.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp4&#45;&gt;layer13_expert4 -->
<g id="edge894" class="edge">
<title>layer13_route_exp4&#45;&gt;layer13_expert4</title>
<path fill="none" stroke="black" d="M86612.7,-1040.16C86612.7,-1040.16 86612.7,-1014.25 86612.7,-1014.25"/>
<polygon fill="black" stroke="black" points="86616.2,-1014.25 86612.7,-1004.25 86609.2,-1014.25 86616.2,-1014.25"/>
</g>
<!-- layer13_agg_exp4 -->
<g id="node738" class="node">
<title>layer13_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="86594.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="86594.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="86594.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="86594.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="86594.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert4&#45;&gt;layer13_agg_exp4 -->
<g id="edge895" class="edge">
<title>layer13_expert4&#45;&gt;layer13_agg_exp4</title>
<path fill="none" stroke="black" d="M86612.7,-941.09C86612.7,-941.09 86612.7,-915.34 86612.7,-915.34"/>
<polygon fill="black" stroke="black" points="86616.2,-915.34 86612.7,-905.34 86609.2,-915.34 86616.2,-915.34"/>
</g>
<!-- layer13_agg_exp4&#45;&gt;layer13_moe_agg -->
<g id="edge896" class="edge">
<title>layer13_agg_exp4&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M86594.7,-831.35C86594.7,-801.69 86594.7,-765 86594.7,-765 86594.7,-765 87870.67,-765 87870.67,-765"/>
<polygon fill="black" stroke="black" points="87870.67,-768.5 87880.67,-765 87870.66,-761.5 87870.67,-768.5"/>
</g>
<!-- layer13_expert5 -->
<g id="node740" class="node">
<title>layer13_expert5</title>
<polygon fill="lightcoral" stroke="black" points="87134.2,-1004.16 86913.2,-1004.16 86913.2,-941.16 87134.2,-941.16 87134.2,-1004.16"/>
<text text-anchor="middle" x="87023.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="87023.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="87023.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="87023.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="87023.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp5&#45;&gt;layer13_expert5 -->
<g id="edge898" class="edge">
<title>layer13_route_exp5&#45;&gt;layer13_expert5</title>
<path fill="none" stroke="black" d="M87023.7,-1040.16C87023.7,-1040.16 87023.7,-1014.25 87023.7,-1014.25"/>
<polygon fill="black" stroke="black" points="87027.2,-1014.25 87023.7,-1004.25 87020.2,-1014.25 87027.2,-1014.25"/>
</g>
<!-- layer13_agg_exp5 -->
<g id="node741" class="node">
<title>layer13_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="87009.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="87009.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="87009.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="87009.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="87009.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert5&#45;&gt;layer13_agg_exp5 -->
<g id="edge899" class="edge">
<title>layer13_expert5&#45;&gt;layer13_agg_exp5</title>
<path fill="none" stroke="black" d="M87023.7,-941.09C87023.7,-941.09 87023.7,-915.34 87023.7,-915.34"/>
<polygon fill="black" stroke="black" points="87027.2,-915.34 87023.7,-905.34 87020.2,-915.34 87027.2,-915.34"/>
</g>
<!-- layer13_agg_exp5&#45;&gt;layer13_moe_agg -->
<g id="edge900" class="edge">
<title>layer13_agg_exp5&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M87009.7,-831.47C87009.7,-803.55 87009.7,-770 87009.7,-770 87009.7,-770 87894.73,-770 87894.73,-770"/>
<polygon fill="black" stroke="black" points="87894.73,-773.5 87904.73,-770 87894.73,-766.5 87894.73,-773.5"/>
</g>
<!-- layer13_expert6 -->
<g id="node743" class="node">
<title>layer13_expert6</title>
<polygon fill="lightcoral" stroke="black" points="87544.2,-1004.16 87323.2,-1004.16 87323.2,-941.16 87544.2,-941.16 87544.2,-1004.16"/>
<text text-anchor="middle" x="87433.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="87433.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="87433.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="87433.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="87433.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp6&#45;&gt;layer13_expert6 -->
<g id="edge902" class="edge">
<title>layer13_route_exp6&#45;&gt;layer13_expert6</title>
<path fill="none" stroke="black" d="M87433.7,-1040.16C87433.7,-1040.16 87433.7,-1014.25 87433.7,-1014.25"/>
<polygon fill="black" stroke="black" points="87437.2,-1014.25 87433.7,-1004.25 87430.2,-1014.25 87437.2,-1014.25"/>
</g>
<!-- layer13_agg_exp6 -->
<g id="node744" class="node">
<title>layer13_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="87424.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="87424.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="87424.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="87424.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="87424.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert6&#45;&gt;layer13_agg_exp6 -->
<g id="edge903" class="edge">
<title>layer13_expert6&#45;&gt;layer13_agg_exp6</title>
<path fill="none" stroke="black" d="M87433.7,-941.09C87433.7,-941.09 87433.7,-915.34 87433.7,-915.34"/>
<polygon fill="black" stroke="black" points="87437.2,-915.34 87433.7,-905.34 87430.2,-915.34 87437.2,-915.34"/>
</g>
<!-- layer13_agg_exp6&#45;&gt;layer13_moe_agg -->
<g id="edge904" class="edge">
<title>layer13_agg_exp6&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M87615.8,-858.04C87615.8,-833.72 87615.8,-775 87615.8,-775 87615.8,-775 87930.66,-775 87930.66,-775"/>
<polygon fill="black" stroke="black" points="87930.66,-778.5 87940.66,-775 87930.66,-771.5 87930.66,-778.5"/>
</g>
<!-- layer13_expert7 -->
<g id="node746" class="node">
<title>layer13_expert7</title>
<polygon fill="lightcoral" stroke="black" points="87955.2,-1004.16 87734.2,-1004.16 87734.2,-941.16 87955.2,-941.16 87955.2,-1004.16"/>
<text text-anchor="middle" x="87844.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="87844.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="87844.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="87844.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="87844.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp7&#45;&gt;layer13_expert7 -->
<g id="edge906" class="edge">
<title>layer13_route_exp7&#45;&gt;layer13_expert7</title>
<path fill="none" stroke="black" d="M87844.7,-1040.16C87844.7,-1040.16 87844.7,-1014.25 87844.7,-1014.25"/>
<polygon fill="black" stroke="black" points="87848.2,-1014.25 87844.7,-1004.25 87841.2,-1014.25 87848.2,-1014.25"/>
</g>
<!-- layer13_agg_exp7 -->
<g id="node747" class="node">
<title>layer13_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="87839.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="87839.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="87839.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="87839.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="87839.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert7&#45;&gt;layer13_agg_exp7 -->
<g id="edge907" class="edge">
<title>layer13_expert7&#45;&gt;layer13_agg_exp7</title>
<path fill="none" stroke="black" d="M87844.7,-941.09C87844.7,-941.09 87844.7,-915.34 87844.7,-915.34"/>
<polygon fill="black" stroke="black" points="87848.2,-915.34 87844.7,-905.34 87841.2,-915.34 87848.2,-915.34"/>
</g>
<!-- layer13_agg_exp7&#45;&gt;layer13_moe_agg -->
<g id="edge908" class="edge">
<title>layer13_agg_exp7&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M87940.52,-836.58C87940.52,-836.58 87940.52,-785.37 87940.52,-785.37"/>
<polygon fill="black" stroke="black" points="87944.02,-785.37 87940.52,-775.37 87937.02,-785.37 87944.02,-785.37"/>
</g>
<!-- layer13_expert8 -->
<g id="node749" class="node">
<title>layer13_expert8</title>
<polygon fill="lightcoral" stroke="black" points="88365.2,-1004.16 88144.2,-1004.16 88144.2,-941.16 88365.2,-941.16 88365.2,-1004.16"/>
<text text-anchor="middle" x="88254.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="88254.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="88254.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="88254.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="88254.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp8&#45;&gt;layer13_expert8 -->
<g id="edge910" class="edge">
<title>layer13_route_exp8&#45;&gt;layer13_expert8</title>
<path fill="none" stroke="black" d="M88254.7,-1039.87C88254.7,-1039.87 88254.7,-1014.41 88254.7,-1014.41"/>
<polygon fill="black" stroke="black" points="88258.2,-1014.41 88254.7,-1004.41 88251.2,-1014.41 88258.2,-1014.41"/>
</g>
<!-- layer13_agg_exp8 -->
<g id="node750" class="node">
<title>layer13_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="88254.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="88254.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="88254.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="88254.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="88254.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert8&#45;&gt;layer13_agg_exp8 -->
<g id="edge911" class="edge">
<title>layer13_expert8&#45;&gt;layer13_agg_exp8</title>
<path fill="none" stroke="black" d="M88254.7,-941.09C88254.7,-941.09 88254.7,-915.34 88254.7,-915.34"/>
<polygon fill="black" stroke="black" points="88258.2,-915.34 88254.7,-905.34 88251.2,-915.34 88258.2,-915.34"/>
</g>
<!-- layer13_agg_exp8&#45;&gt;layer13_moe_agg -->
<g id="edge912" class="edge">
<title>layer13_agg_exp8&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M88154.38,-836.58C88154.38,-836.58 88154.38,-785.37 88154.38,-785.37"/>
<polygon fill="black" stroke="black" points="88157.88,-785.37 88154.38,-775.37 88150.88,-785.37 88157.88,-785.37"/>
</g>
<!-- layer13_expert9 -->
<g id="node752" class="node">
<title>layer13_expert9</title>
<polygon fill="lightcoral" stroke="black" points="88778.2,-1004.16 88557.2,-1004.16 88557.2,-941.16 88778.2,-941.16 88778.2,-1004.16"/>
<text text-anchor="middle" x="88667.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="88667.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="88667.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="88667.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="88667.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp9&#45;&gt;layer13_expert9 -->
<g id="edge914" class="edge">
<title>layer13_route_exp9&#45;&gt;layer13_expert9</title>
<path fill="none" stroke="black" d="M88667.7,-1039.87C88667.7,-1039.87 88667.7,-1014.41 88667.7,-1014.41"/>
<polygon fill="black" stroke="black" points="88671.2,-1014.41 88667.7,-1004.41 88664.2,-1014.41 88671.2,-1014.41"/>
</g>
<!-- layer13_agg_exp9 -->
<g id="node753" class="node">
<title>layer13_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="88669.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="88669.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="88669.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="88669.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="88669.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert9&#45;&gt;layer13_agg_exp9 -->
<g id="edge915" class="edge">
<title>layer13_expert9&#45;&gt;layer13_agg_exp9</title>
<path fill="none" stroke="black" d="M88667.7,-941.09C88667.7,-941.09 88667.7,-915.34 88667.7,-915.34"/>
<polygon fill="black" stroke="black" points="88671.2,-915.34 88667.7,-905.34 88664.2,-915.34 88671.2,-915.34"/>
</g>
<!-- layer13_agg_exp9&#45;&gt;layer13_moe_agg -->
<g id="edge916" class="edge">
<title>layer13_agg_exp9&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M88669.7,-831.54C88669.7,-793.92 88669.7,-741 88669.7,-741 88669.7,-741 88262.66,-741 88262.66,-741"/>
<polygon fill="black" stroke="black" points="88262.66,-737.5 88252.66,-741 88262.66,-744.5 88262.66,-737.5"/>
</g>
<!-- layer13_expert10 -->
<g id="node755" class="node">
<title>layer13_expert10</title>
<polygon fill="lightcoral" stroke="black" points="89188.2,-1004.16 88967.2,-1004.16 88967.2,-941.16 89188.2,-941.16 89188.2,-1004.16"/>
<text text-anchor="middle" x="89077.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="89077.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="89077.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="89077.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="89077.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp10&#45;&gt;layer13_expert10 -->
<g id="edge918" class="edge">
<title>layer13_route_exp10&#45;&gt;layer13_expert10</title>
<path fill="none" stroke="black" d="M89077.7,-1039.87C89077.7,-1039.87 89077.7,-1014.41 89077.7,-1014.41"/>
<polygon fill="black" stroke="black" points="89081.2,-1014.41 89077.7,-1004.41 89074.2,-1014.41 89081.2,-1014.41"/>
</g>
<!-- layer13_agg_exp10 -->
<g id="node756" class="node">
<title>layer13_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="89084.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="89084.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="89084.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="89084.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="89084.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert10&#45;&gt;layer13_agg_exp10 -->
<g id="edge919" class="edge">
<title>layer13_expert10&#45;&gt;layer13_agg_exp10</title>
<path fill="none" stroke="black" d="M89077.7,-941.09C89077.7,-941.09 89077.7,-915.34 89077.7,-915.34"/>
<polygon fill="black" stroke="black" points="89081.2,-915.34 89077.7,-905.34 89074.2,-915.34 89081.2,-915.34"/>
</g>
<!-- layer13_agg_exp10&#45;&gt;layer13_moe_agg -->
<g id="edge920" class="edge">
<title>layer13_agg_exp10&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M89084.7,-831.51C89084.7,-792.34 89084.7,-736 89084.7,-736 89084.7,-736 88258.56,-736 88258.56,-736"/>
<polygon fill="black" stroke="black" points="88258.56,-732.5 88248.56,-736 88258.56,-739.5 88258.56,-732.5"/>
</g>
<!-- layer13_expert11 -->
<g id="node758" class="node">
<title>layer13_expert11</title>
<polygon fill="lightcoral" stroke="black" points="89602.2,-1004.16 89381.2,-1004.16 89381.2,-941.16 89602.2,-941.16 89602.2,-1004.16"/>
<text text-anchor="middle" x="89491.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="89491.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="89491.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="89491.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="89491.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp11&#45;&gt;layer13_expert11 -->
<g id="edge922" class="edge">
<title>layer13_route_exp11&#45;&gt;layer13_expert11</title>
<path fill="none" stroke="black" d="M89491.7,-1040.16C89491.7,-1040.16 89491.7,-1014.25 89491.7,-1014.25"/>
<polygon fill="black" stroke="black" points="89495.2,-1014.25 89491.7,-1004.25 89488.2,-1014.25 89495.2,-1014.25"/>
</g>
<!-- layer13_agg_exp11 -->
<g id="node759" class="node">
<title>layer13_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="89499.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="89499.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="89499.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="89499.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="89499.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert11&#45;&gt;layer13_agg_exp11 -->
<g id="edge923" class="edge">
<title>layer13_expert11&#45;&gt;layer13_agg_exp11</title>
<path fill="none" stroke="black" d="M89491.7,-941.09C89491.7,-941.09 89491.7,-915.34 89491.7,-915.34"/>
<polygon fill="black" stroke="black" points="89495.2,-915.34 89491.7,-905.34 89488.2,-915.34 89495.2,-915.34"/>
</g>
<!-- layer13_agg_exp11&#45;&gt;layer13_moe_agg -->
<g id="edge924" class="edge">
<title>layer13_agg_exp11&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M89499.7,-831.57C89499.7,-790.87 89499.7,-731 89499.7,-731 89499.7,-731 88250.51,-731 88250.51,-731"/>
<polygon fill="black" stroke="black" points="88250.51,-727.5 88240.51,-731 88250.51,-734.5 88250.51,-727.5"/>
</g>
<!-- layer13_expert12 -->
<g id="node761" class="node">
<title>layer13_expert12</title>
<polygon fill="lightcoral" stroke="black" points="90016.2,-1004.16 89795.2,-1004.16 89795.2,-941.16 90016.2,-941.16 90016.2,-1004.16"/>
<text text-anchor="middle" x="89905.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="89905.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="89905.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="89905.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="89905.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp12&#45;&gt;layer13_expert12 -->
<g id="edge926" class="edge">
<title>layer13_route_exp12&#45;&gt;layer13_expert12</title>
<path fill="none" stroke="black" d="M89905.7,-1040.16C89905.7,-1040.16 89905.7,-1014.25 89905.7,-1014.25"/>
<polygon fill="black" stroke="black" points="89909.2,-1014.25 89905.7,-1004.25 89902.2,-1014.25 89909.2,-1014.25"/>
</g>
<!-- layer13_agg_exp12 -->
<g id="node762" class="node">
<title>layer13_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="89914.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="89914.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="89914.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="89914.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="89914.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert12&#45;&gt;layer13_agg_exp12 -->
<g id="edge927" class="edge">
<title>layer13_expert12&#45;&gt;layer13_agg_exp12</title>
<path fill="none" stroke="black" d="M89905.7,-941.09C89905.7,-941.09 89905.7,-915.34 89905.7,-915.34"/>
<polygon fill="black" stroke="black" points="89909.2,-915.34 89905.7,-905.34 89902.2,-915.34 89909.2,-915.34"/>
</g>
<!-- layer13_agg_exp12&#45;&gt;layer13_moe_agg -->
<g id="edge928" class="edge">
<title>layer13_agg_exp12&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M89914.7,-831.35C89914.7,-789.16 89914.7,-726 89914.7,-726 89914.7,-726 88237.98,-726 88237.98,-726"/>
<polygon fill="black" stroke="black" points="88237.98,-722.5 88227.98,-726 88237.98,-729.5 88237.98,-722.5"/>
</g>
<!-- layer13_expert13 -->
<g id="node764" class="node">
<title>layer13_expert13</title>
<polygon fill="lightcoral" stroke="black" points="90431.2,-1004.16 90210.2,-1004.16 90210.2,-941.16 90431.2,-941.16 90431.2,-1004.16"/>
<text text-anchor="middle" x="90320.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="90320.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="90320.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="90320.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="90320.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp13&#45;&gt;layer13_expert13 -->
<g id="edge930" class="edge">
<title>layer13_route_exp13&#45;&gt;layer13_expert13</title>
<path fill="none" stroke="black" d="M90320.7,-1040.16C90320.7,-1040.16 90320.7,-1014.25 90320.7,-1014.25"/>
<polygon fill="black" stroke="black" points="90324.2,-1014.25 90320.7,-1004.25 90317.2,-1014.25 90324.2,-1014.25"/>
</g>
<!-- layer13_agg_exp13 -->
<g id="node765" class="node">
<title>layer13_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="90329.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="90329.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="90329.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="90329.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="90329.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert13&#45;&gt;layer13_agg_exp13 -->
<g id="edge931" class="edge">
<title>layer13_expert13&#45;&gt;layer13_agg_exp13</title>
<path fill="none" stroke="black" d="M90320.7,-941.09C90320.7,-941.09 90320.7,-915.34 90320.7,-915.34"/>
<polygon fill="black" stroke="black" points="90324.2,-915.34 90320.7,-905.34 90317.2,-915.34 90324.2,-915.34"/>
</g>
<!-- layer13_agg_exp13&#45;&gt;layer13_moe_agg -->
<g id="edge932" class="edge">
<title>layer13_agg_exp13&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M90329.7,-831.58C90329.7,-787.92 90329.7,-721 90329.7,-721 90329.7,-721 88219.53,-721 88219.53,-721"/>
<polygon fill="black" stroke="black" points="88219.53,-717.5 88209.53,-721 88219.53,-724.5 88219.53,-717.5"/>
</g>
<!-- layer13_expert14 -->
<g id="node767" class="node">
<title>layer13_expert14</title>
<polygon fill="lightcoral" stroke="black" points="90846.2,-1004.16 90625.2,-1004.16 90625.2,-941.16 90846.2,-941.16 90846.2,-1004.16"/>
<text text-anchor="middle" x="90735.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="90735.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="90735.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="90735.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="90735.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp14&#45;&gt;layer13_expert14 -->
<g id="edge934" class="edge">
<title>layer13_route_exp14&#45;&gt;layer13_expert14</title>
<path fill="none" stroke="black" d="M90735.7,-1040.16C90735.7,-1040.16 90735.7,-1014.25 90735.7,-1014.25"/>
<polygon fill="black" stroke="black" points="90739.2,-1014.25 90735.7,-1004.25 90732.2,-1014.25 90739.2,-1014.25"/>
</g>
<!-- layer13_agg_exp14 -->
<g id="node768" class="node">
<title>layer13_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="90744.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="90744.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="90744.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="90744.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="90744.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert14&#45;&gt;layer13_agg_exp14 -->
<g id="edge935" class="edge">
<title>layer13_expert14&#45;&gt;layer13_agg_exp14</title>
<path fill="none" stroke="black" d="M90735.7,-941.09C90735.7,-941.09 90735.7,-915.34 90735.7,-915.34"/>
<polygon fill="black" stroke="black" points="90739.2,-915.34 90735.7,-905.34 90732.2,-915.34 90739.2,-915.34"/>
</g>
<!-- layer13_agg_exp14&#45;&gt;layer13_moe_agg -->
<g id="edge936" class="edge">
<title>layer13_agg_exp14&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M90744.7,-831.5C90744.7,-786.4 90744.7,-716 90744.7,-716 90744.7,-716 88193.29,-716 88193.29,-716"/>
<polygon fill="black" stroke="black" points="88193.29,-712.5 88183.29,-716 88193.29,-719.5 88193.29,-712.5"/>
</g>
<!-- layer13_expert15 -->
<g id="node770" class="node">
<title>layer13_expert15</title>
<polygon fill="lightcoral" stroke="black" points="91261.2,-1004.16 91040.2,-1004.16 91040.2,-941.16 91261.2,-941.16 91261.2,-1004.16"/>
<text text-anchor="middle" x="91150.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="91150.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="91150.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="91150.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="91150.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer13_route_exp15&#45;&gt;layer13_expert15 -->
<g id="edge938" class="edge">
<title>layer13_route_exp15&#45;&gt;layer13_expert15</title>
<path fill="none" stroke="black" d="M91150.7,-1040.16C91150.7,-1040.16 91150.7,-1014.25 91150.7,-1014.25"/>
<polygon fill="black" stroke="black" points="91154.2,-1014.25 91150.7,-1004.25 91147.2,-1014.25 91154.2,-1014.25"/>
</g>
<!-- layer13_agg_exp15 -->
<g id="node771" class="node">
<title>layer13_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="91159.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="91159.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="91159.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="91159.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="91159.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer13_expert15&#45;&gt;layer13_agg_exp15 -->
<g id="edge939" class="edge">
<title>layer13_expert15&#45;&gt;layer13_agg_exp15</title>
<path fill="none" stroke="black" d="M91150.7,-941.09C91150.7,-941.09 91150.7,-915.34 91150.7,-915.34"/>
<polygon fill="black" stroke="black" points="91154.2,-915.34 91150.7,-905.34 91147.2,-915.34 91154.2,-915.34"/>
</g>
<!-- layer13_agg_exp15&#45;&gt;layer13_moe_agg -->
<g id="edge940" class="edge">
<title>layer13_agg_exp15&#45;&gt;layer13_moe_agg</title>
<path fill="none" stroke="black" d="M91159.7,-831.49C91159.7,-784.97 91159.7,-711 91159.7,-711 91159.7,-711 88152.53,-711 88152.53,-711"/>
<polygon fill="black" stroke="black" points="88152.53,-707.5 88142.53,-711 88152.53,-714.5 88152.53,-707.5"/>
</g>
<!-- layer14_ln1 -->
<g id="node773" class="node">
<title>layer14_ln1</title>
<polygon fill="none" stroke="black" points="91512.2,-1227.7 91231.2,-1227.7 91231.2,-1175.7 91512.2,-1175.7 91512.2,-1227.7"/>
<text text-anchor="middle" x="91371.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 14</text>
<text text-anchor="middle" x="91371.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="91371.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="91371.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer14_add1 -->
<g id="node774" class="node">
<title>layer14_add1</title>
<polygon fill="yellow" stroke="black" points="94529.2,-644.85 94248.2,-644.85 94248.2,-592.85 94529.2,-592.85 94529.2,-644.85"/>
<text text-anchor="middle" x="94388.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 14</text>
<text text-anchor="middle" x="94388.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94388.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94388.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_moe_output -->
<g id="node778" class="node">
<title>layer14_moe_output</title>
<polygon fill="yellow" stroke="black" points="94679.2,-540.58 94398.2,-540.58 94398.2,-488.58 94679.2,-488.58 94679.2,-540.58"/>
<text text-anchor="middle" x="94538.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 14</text>
<text text-anchor="middle" x="94538.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94538.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94538.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_add1&#45;&gt;layer14_moe_output -->
<g id="edge1010" class="edge">
<title>layer14_add1&#45;&gt;layer14_moe_output</title>
<path fill="none" stroke="black" d="M94463.7,-592.81C94463.7,-592.81 94463.7,-550.65 94463.7,-550.65"/>
<polygon fill="black" stroke="black" points="94467.2,-550.65 94463.7,-540.65 94460.2,-550.65 94467.2,-550.65"/>
</g>
<!-- layer14_gate -->
<g id="node775" class="node">
<title>layer14_gate</title>
<polygon fill="lightgreen" stroke="black" points="94980.13,-1253.7 94521.3,-1253.7 94403.26,-1149.7 94862.1,-1149.7 94980.13,-1253.7"/>
<text text-anchor="middle" x="94691.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 14</text>
<text text-anchor="middle" x="94691.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94691.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="94691.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer14_route_exp0 -->
<g id="node779" class="node">
<title>layer14_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="91575.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="91575.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="91575.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="91575.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="91575.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp0 -->
<g id="edge944" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp0</title>
<path fill="none" stroke="black" d="M94429.6,-1173C93690.13,-1173 91640.82,-1173 91640.82,-1173 91640.82,-1173 91640.82,-1121.61 91640.82,-1121.61"/>
<polygon fill="black" stroke="black" points="91644.32,-1121.61 91640.82,-1111.61 91637.32,-1121.61 91644.32,-1121.61"/>
</g>
<!-- layer14_route_exp1 -->
<g id="node782" class="node">
<title>layer14_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="92020.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="92020.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="92020.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="92020.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="92020.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp1 -->
<g id="edge948" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp1</title>
<path fill="none" stroke="black" d="M94423.98,-1168C93747.08,-1168 92020.7,-1168 92020.7,-1168 92020.7,-1168 92020.7,-1123.71 92020.7,-1123.71"/>
<polygon fill="black" stroke="black" points="92024.2,-1123.71 92020.7,-1113.71 92017.2,-1123.71 92024.2,-1123.71"/>
</g>
<!-- layer14_route_exp2 -->
<g id="node785" class="node">
<title>layer14_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="92445.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="92445.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="92445.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="92445.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="92445.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp2 -->
<g id="edge952" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp2</title>
<path fill="none" stroke="black" d="M94420.5,-1165C93822.98,-1165 92445.7,-1165 92445.7,-1165 92445.7,-1165 92445.7,-1123.77 92445.7,-1123.77"/>
<polygon fill="black" stroke="black" points="92449.2,-1123.77 92445.7,-1113.77 92442.2,-1123.77 92449.2,-1123.77"/>
</g>
<!-- layer14_route_exp3 -->
<g id="node788" class="node">
<title>layer14_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="92860.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="92860.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="92860.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="92860.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="92860.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp3 -->
<g id="edge956" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp3</title>
<path fill="none" stroke="black" d="M94416.09,-1161C93904.76,-1161 92860.7,-1161 92860.7,-1161 92860.7,-1161 92860.7,-1124.05 92860.7,-1124.05"/>
<polygon fill="black" stroke="black" points="92864.2,-1124.05 92860.7,-1114.05 92857.2,-1124.05 92864.2,-1124.05"/>
</g>
<!-- layer14_route_exp4 -->
<g id="node791" class="node">
<title>layer14_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="93270.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="93270.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="93270.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="93270.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="93270.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp4 -->
<g id="edge960" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp4</title>
<path fill="none" stroke="black" d="M94412.65,-1158C93998.82,-1158 93270.7,-1158 93270.7,-1158 93270.7,-1158 93270.7,-1124.14 93270.7,-1124.14"/>
<polygon fill="black" stroke="black" points="93274.2,-1124.14 93270.7,-1114.14 93267.2,-1124.14 93274.2,-1124.14"/>
</g>
<!-- layer14_route_exp5 -->
<g id="node794" class="node">
<title>layer14_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="93677.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="93677.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="93677.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="93677.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="93677.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp5 -->
<g id="edge964" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp5</title>
<path fill="none" stroke="black" d="M94407.89,-1154C94107.92,-1154 93677.7,-1154 93677.7,-1154 93677.7,-1154 93677.7,-1124.11 93677.7,-1124.11"/>
<polygon fill="black" stroke="black" points="93681.2,-1124.11 93677.7,-1114.11 93674.2,-1124.11 93681.2,-1124.11"/>
</g>
<!-- layer14_route_exp6 -->
<g id="node797" class="node">
<title>layer14_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="94083.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="94083.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="94083.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="94083.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94083.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp6 -->
<g id="edge968" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp6</title>
<path fill="none" stroke="black" d="M94404.61,-1151C94247.19,-1151 94083.7,-1151 94083.7,-1151 94083.7,-1151 94083.7,-1123.96 94083.7,-1123.96"/>
<polygon fill="black" stroke="black" points="94087.2,-1123.96 94083.7,-1113.96 94080.2,-1123.96 94087.2,-1123.96"/>
</g>
<!-- layer14_route_exp7 -->
<g id="node800" class="node">
<title>layer14_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="94489.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="94489.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="94489.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="94489.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94489.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp7 -->
<g id="edge972" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp7</title>
<path fill="none" stroke="black" d="M94543.46,-1149.5C94543.46,-1149.5 94543.46,-1122.25 94543.46,-1122.25"/>
<polygon fill="black" stroke="black" points="94546.96,-1122.25 94543.46,-1112.25 94539.96,-1122.25 94546.96,-1122.25"/>
</g>
<!-- layer14_route_exp8 -->
<g id="node803" class="node">
<title>layer14_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="94894.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="94894.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="94894.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="94894.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94894.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp8 -->
<g id="edge976" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp8</title>
<path fill="none" stroke="black" d="M94840.43,-1149.5C94840.43,-1149.5 94840.43,-1122.25 94840.43,-1122.25"/>
<polygon fill="black" stroke="black" points="94843.93,-1122.25 94840.43,-1112.25 94836.93,-1122.25 94843.93,-1122.25"/>
</g>
<!-- layer14_route_exp9 -->
<g id="node806" class="node">
<title>layer14_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="95302.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="95302.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="95302.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="95302.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="95302.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp9 -->
<g id="edge980" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp9</title>
<path fill="none" stroke="black" d="M94863.93,-1151C95044.63,-1151 95302.7,-1151 95302.7,-1151 95302.7,-1151 95302.7,-1123.96 95302.7,-1123.96"/>
<polygon fill="black" stroke="black" points="95306.2,-1123.96 95302.7,-1113.96 95299.2,-1123.96 95306.2,-1123.96"/>
</g>
<!-- layer14_route_exp10 -->
<g id="node809" class="node">
<title>layer14_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="95712.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="95712.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="95712.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="95712.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="95712.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp10 -->
<g id="edge984" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp10</title>
<path fill="none" stroke="black" d="M94867.21,-1154C95159.13,-1154 95712.7,-1154 95712.7,-1154 95712.7,-1154 95712.7,-1124.11 95712.7,-1124.11"/>
<polygon fill="black" stroke="black" points="95716.2,-1124.11 95712.7,-1114.11 95709.2,-1124.11 95716.2,-1124.11"/>
</g>
<!-- layer14_route_exp11 -->
<g id="node812" class="node">
<title>layer14_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="96124.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="96124.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="96124.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="96124.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="96124.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp11 -->
<g id="edge988" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp11</title>
<path fill="none" stroke="black" d="M94871.74,-1158C95256.61,-1158 96124.7,-1158 96124.7,-1158 96124.7,-1158 96124.7,-1124.14 96124.7,-1124.14"/>
<polygon fill="black" stroke="black" points="96128.2,-1124.14 96124.7,-1114.14 96121.2,-1124.14 96128.2,-1124.14"/>
</g>
<!-- layer14_route_exp12 -->
<g id="node815" class="node">
<title>layer14_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="96537.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="96537.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="96537.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="96537.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="96537.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp12 -->
<g id="edge992" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp12</title>
<path fill="none" stroke="black" d="M94875.02,-1161C95341.65,-1161 96537.7,-1161 96537.7,-1161 96537.7,-1161 96537.7,-1124.05 96537.7,-1124.05"/>
<polygon fill="black" stroke="black" points="96541.2,-1124.05 96537.7,-1114.05 96534.2,-1124.05 96541.2,-1124.05"/>
</g>
<!-- layer14_route_exp13 -->
<g id="node818" class="node">
<title>layer14_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="96951.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="96951.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="96951.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="96951.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="96951.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp13 -->
<g id="edge996" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp13</title>
<path fill="none" stroke="black" d="M94879.53,-1165C95421.85,-1165 96951.7,-1165 96951.7,-1165 96951.7,-1165 96951.7,-1123.77 96951.7,-1123.77"/>
<polygon fill="black" stroke="black" points="96955.2,-1123.77 96951.7,-1113.77 96948.2,-1123.77 96955.2,-1123.77"/>
</g>
<!-- layer14_route_exp14 -->
<g id="node821" class="node">
<title>layer14_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="97366.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="97366.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="97366.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="97366.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="97366.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp14 -->
<g id="edge1000" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp14</title>
<path fill="none" stroke="black" d="M94883,-1168C95495.25,-1168 97366.7,-1168 97366.7,-1168 97366.7,-1168 97366.7,-1123.71 97366.7,-1123.71"/>
<polygon fill="black" stroke="black" points="97370.2,-1123.71 97366.7,-1113.71 97363.2,-1123.71 97370.2,-1123.71"/>
</g>
<!-- layer14_route_exp15 -->
<g id="node824" class="node">
<title>layer14_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="97783.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="97783.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="97783.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="97783.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="97783.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_route_exp15 -->
<g id="edge1004" class="edge">
<title>layer14_gate&#45;&gt;layer14_route_exp15</title>
<path fill="none" stroke="black" d="M94887.61,-1172C95559.78,-1172 97731.07,-1172 97731.07,-1172 97731.07,-1172 97731.07,-1122.33 97731.07,-1122.33"/>
<polygon fill="black" stroke="black" points="97734.57,-1122.33 97731.07,-1112.33 97727.57,-1122.33 97734.57,-1122.33"/>
</g>
<!-- layer14_moe_agg -->
<g id="node776" class="node">
<title>layer14_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="94687.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="94687.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 14</text>
<text text-anchor="middle" x="94687.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94687.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94687.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer14_ln2 -->
<g id="node777" class="node">
<title>layer14_ln2</title>
<polygon fill="none" stroke="black" points="94828.2,-644.85 94547.2,-644.85 94547.2,-592.85 94828.2,-592.85 94828.2,-644.85"/>
<text text-anchor="middle" x="94687.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 14</text>
<text text-anchor="middle" x="94687.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94687.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94687.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer14_moe_agg&#45;&gt;layer14_ln2 -->
<g id="edge1008" class="edge">
<title>layer14_moe_agg&#45;&gt;layer14_ln2</title>
<path fill="none" stroke="black" d="M94687.7,-706.52C94687.7,-706.52 94687.7,-654.92 94687.7,-654.92"/>
<polygon fill="black" stroke="black" points="94691.2,-654.92 94687.7,-644.92 94684.2,-654.92 94691.2,-654.92"/>
</g>
<!-- layer14_ln2&#45;&gt;layer14_moe_output -->
<g id="edge1009" class="edge">
<title>layer14_ln2&#45;&gt;layer14_moe_output</title>
<path fill="none" stroke="black" d="M94613.2,-592.81C94613.2,-592.81 94613.2,-550.65 94613.2,-550.65"/>
<polygon fill="black" stroke="black" points="94616.7,-550.65 94613.2,-540.65 94609.7,-550.65 94616.7,-550.65"/>
</g>
<!-- layer15_mha -->
<g id="node827" class="node">
<title>layer15_mha</title>
<polygon fill="lightcyan" stroke="black" points="94679.2,-436.31 94398.2,-436.31 94398.2,-384.31 94679.2,-384.31 94679.2,-436.31"/>
<text text-anchor="middle" x="94538.7" y="-424.31" font-family="Arial" font-size="10.00">MHA Layer 15</text>
<text text-anchor="middle" x="94538.7" y="-413.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94538.7" y="-402.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="94538.7" y="-391.31" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer14_moe_output&#45;&gt;layer15_mha -->
<g id="edge1092" class="edge">
<title>layer14_moe_output&#45;&gt;layer15_mha</title>
<path fill="none" stroke="black" d="M94538.7,-488.54C94538.7,-488.54 94538.7,-446.38 94538.7,-446.38"/>
<polygon fill="black" stroke="black" points="94542.2,-446.38 94538.7,-436.38 94535.2,-446.38 94542.2,-446.38"/>
</g>
<!-- layer14_expert0 -->
<g id="node780" class="node">
<title>layer14_expert0</title>
<polygon fill="lightcoral" stroke="black" points="91685.2,-1004.16 91464.2,-1004.16 91464.2,-941.16 91685.2,-941.16 91685.2,-1004.16"/>
<text text-anchor="middle" x="91574.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="91574.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="91574.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="91574.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="91574.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp0&#45;&gt;layer14_expert0 -->
<g id="edge945" class="edge">
<title>layer14_route_exp0&#45;&gt;layer14_expert0</title>
<path fill="none" stroke="black" d="M91574.7,-1039.87C91574.7,-1039.87 91574.7,-1014.41 91574.7,-1014.41"/>
<polygon fill="black" stroke="black" points="91578.2,-1014.41 91574.7,-1004.41 91571.2,-1014.41 91578.2,-1014.41"/>
</g>
<!-- layer14_agg_exp0 -->
<g id="node781" class="node">
<title>layer14_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="91574.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="91574.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="91574.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="91574.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="91574.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert0&#45;&gt;layer14_agg_exp0 -->
<g id="edge946" class="edge">
<title>layer14_expert0&#45;&gt;layer14_agg_exp0</title>
<path fill="none" stroke="black" d="M91574.7,-941.09C91574.7,-941.09 91574.7,-915.34 91574.7,-915.34"/>
<polygon fill="black" stroke="black" points="91578.2,-915.34 91574.7,-905.34 91571.2,-915.34 91578.2,-915.34"/>
</g>
<!-- layer14_agg_exp0&#45;&gt;layer14_moe_agg -->
<g id="edge947" class="edge">
<title>layer14_agg_exp0&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M91574.7,-831.33C91574.7,-795.31 91574.7,-746 91574.7,-746 91574.7,-746 94472.84,-746 94472.84,-746"/>
<polygon fill="black" stroke="black" points="94472.84,-749.5 94482.84,-746 94472.84,-742.5 94472.84,-749.5"/>
</g>
<!-- layer14_expert1 -->
<g id="node783" class="node">
<title>layer14_expert1</title>
<polygon fill="lightcoral" stroke="black" points="92116.2,-1004.16 91895.2,-1004.16 91895.2,-941.16 92116.2,-941.16 92116.2,-1004.16"/>
<text text-anchor="middle" x="92005.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="92005.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="92005.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="92005.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="92005.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp1&#45;&gt;layer14_expert1 -->
<g id="edge949" class="edge">
<title>layer14_route_exp1&#45;&gt;layer14_expert1</title>
<path fill="none" stroke="black" d="M92005.7,-1040.16C92005.7,-1040.16 92005.7,-1014.25 92005.7,-1014.25"/>
<polygon fill="black" stroke="black" points="92009.2,-1014.25 92005.7,-1004.25 92002.2,-1014.25 92009.2,-1014.25"/>
</g>
<!-- layer14_agg_exp1 -->
<g id="node784" class="node">
<title>layer14_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="91989.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="91989.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="91989.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="91989.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="91989.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert1&#45;&gt;layer14_agg_exp1 -->
<g id="edge950" class="edge">
<title>layer14_expert1&#45;&gt;layer14_agg_exp1</title>
<path fill="none" stroke="black" d="M92005.7,-941.09C92005.7,-941.09 92005.7,-915.34 92005.7,-915.34"/>
<polygon fill="black" stroke="black" points="92009.2,-915.34 92005.7,-905.34 92002.2,-915.34 92009.2,-915.34"/>
</g>
<!-- layer14_agg_exp1&#45;&gt;layer14_moe_agg -->
<g id="edge951" class="edge">
<title>layer14_agg_exp1&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M91989.7,-831.58C91989.7,-796.82 91989.7,-750 91989.7,-750 91989.7,-750 94475.74,-750 94475.74,-750"/>
<polygon fill="black" stroke="black" points="94475.74,-753.5 94485.74,-750 94475.74,-746.5 94475.74,-753.5"/>
</g>
<!-- layer14_expert2 -->
<g id="node786" class="node">
<title>layer14_expert2</title>
<polygon fill="lightcoral" stroke="black" points="92536.2,-1004.16 92315.2,-1004.16 92315.2,-941.16 92536.2,-941.16 92536.2,-1004.16"/>
<text text-anchor="middle" x="92425.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="92425.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="92425.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="92425.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="92425.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp2&#45;&gt;layer14_expert2 -->
<g id="edge953" class="edge">
<title>layer14_route_exp2&#45;&gt;layer14_expert2</title>
<path fill="none" stroke="black" d="M92425.7,-1040.16C92425.7,-1040.16 92425.7,-1014.25 92425.7,-1014.25"/>
<polygon fill="black" stroke="black" points="92429.2,-1014.25 92425.7,-1004.25 92422.2,-1014.25 92429.2,-1014.25"/>
</g>
<!-- layer14_agg_exp2 -->
<g id="node787" class="node">
<title>layer14_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="92404.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="92404.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="92404.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="92404.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="92404.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert2&#45;&gt;layer14_agg_exp2 -->
<g id="edge954" class="edge">
<title>layer14_expert2&#45;&gt;layer14_agg_exp2</title>
<path fill="none" stroke="black" d="M92425.7,-941.09C92425.7,-941.09 92425.7,-914.97 92425.7,-914.97"/>
<polygon fill="black" stroke="black" points="92429.2,-914.97 92425.7,-904.97 92422.2,-914.97 92429.2,-914.97"/>
</g>
<!-- layer14_agg_exp2&#45;&gt;layer14_moe_agg -->
<g id="edge955" class="edge">
<title>layer14_agg_exp2&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M92404.7,-831.57C92404.7,-798.47 92404.7,-755 92404.7,-755 92404.7,-755 94482.56,-755 94482.56,-755"/>
<polygon fill="black" stroke="black" points="94482.56,-758.5 94492.56,-755 94482.56,-751.5 94482.56,-758.5"/>
</g>
<!-- layer14_expert3 -->
<g id="node789" class="node">
<title>layer14_expert3</title>
<polygon fill="lightcoral" stroke="black" points="92951.2,-1004.16 92730.2,-1004.16 92730.2,-941.16 92951.2,-941.16 92951.2,-1004.16"/>
<text text-anchor="middle" x="92840.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="92840.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="92840.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="92840.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="92840.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp3&#45;&gt;layer14_expert3 -->
<g id="edge957" class="edge">
<title>layer14_route_exp3&#45;&gt;layer14_expert3</title>
<path fill="none" stroke="black" d="M92840.7,-1040.16C92840.7,-1040.16 92840.7,-1014.25 92840.7,-1014.25"/>
<polygon fill="black" stroke="black" points="92844.2,-1014.25 92840.7,-1004.25 92837.2,-1014.25 92844.2,-1014.25"/>
</g>
<!-- layer14_agg_exp3 -->
<g id="node790" class="node">
<title>layer14_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="92819.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="92819.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="92819.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="92819.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="92819.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert3&#45;&gt;layer14_agg_exp3 -->
<g id="edge958" class="edge">
<title>layer14_expert3&#45;&gt;layer14_agg_exp3</title>
<path fill="none" stroke="black" d="M92840.7,-941.09C92840.7,-941.09 92840.7,-914.97 92840.7,-914.97"/>
<polygon fill="black" stroke="black" points="92844.2,-914.97 92840.7,-904.97 92837.2,-914.97 92844.2,-914.97"/>
</g>
<!-- layer14_agg_exp3&#45;&gt;layer14_moe_agg -->
<g id="edge959" class="edge">
<title>layer14_agg_exp3&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M92819.7,-831.39C92819.7,-799.99 92819.7,-760 92819.7,-760 92819.7,-760 94493.9,-760 94493.9,-760"/>
<polygon fill="black" stroke="black" points="94493.9,-763.5 94503.9,-760 94493.9,-756.5 94493.9,-763.5"/>
</g>
<!-- layer14_expert4 -->
<g id="node792" class="node">
<title>layer14_expert4</title>
<polygon fill="lightcoral" stroke="black" points="93363.2,-1004.16 93142.2,-1004.16 93142.2,-941.16 93363.2,-941.16 93363.2,-1004.16"/>
<text text-anchor="middle" x="93252.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="93252.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="93252.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="93252.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="93252.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp4&#45;&gt;layer14_expert4 -->
<g id="edge961" class="edge">
<title>layer14_route_exp4&#45;&gt;layer14_expert4</title>
<path fill="none" stroke="black" d="M93252.7,-1040.16C93252.7,-1040.16 93252.7,-1014.25 93252.7,-1014.25"/>
<polygon fill="black" stroke="black" points="93256.2,-1014.25 93252.7,-1004.25 93249.2,-1014.25 93256.2,-1014.25"/>
</g>
<!-- layer14_agg_exp4 -->
<g id="node793" class="node">
<title>layer14_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="93234.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="93234.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="93234.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="93234.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="93234.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert4&#45;&gt;layer14_agg_exp4 -->
<g id="edge962" class="edge">
<title>layer14_expert4&#45;&gt;layer14_agg_exp4</title>
<path fill="none" stroke="black" d="M93252.7,-941.09C93252.7,-941.09 93252.7,-915.34 93252.7,-915.34"/>
<polygon fill="black" stroke="black" points="93256.2,-915.34 93252.7,-905.34 93249.2,-915.34 93256.2,-915.34"/>
</g>
<!-- layer14_agg_exp4&#45;&gt;layer14_moe_agg -->
<g id="edge963" class="edge">
<title>layer14_agg_exp4&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M93234.7,-831.35C93234.7,-801.69 93234.7,-765 93234.7,-765 93234.7,-765 94510.67,-765 94510.67,-765"/>
<polygon fill="black" stroke="black" points="94510.67,-768.5 94520.67,-765 94510.66,-761.5 94510.67,-768.5"/>
</g>
<!-- layer14_expert5 -->
<g id="node795" class="node">
<title>layer14_expert5</title>
<polygon fill="lightcoral" stroke="black" points="93774.2,-1004.16 93553.2,-1004.16 93553.2,-941.16 93774.2,-941.16 93774.2,-1004.16"/>
<text text-anchor="middle" x="93663.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="93663.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="93663.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="93663.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="93663.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp5&#45;&gt;layer14_expert5 -->
<g id="edge965" class="edge">
<title>layer14_route_exp5&#45;&gt;layer14_expert5</title>
<path fill="none" stroke="black" d="M93663.7,-1040.16C93663.7,-1040.16 93663.7,-1014.25 93663.7,-1014.25"/>
<polygon fill="black" stroke="black" points="93667.2,-1014.25 93663.7,-1004.25 93660.2,-1014.25 93667.2,-1014.25"/>
</g>
<!-- layer14_agg_exp5 -->
<g id="node796" class="node">
<title>layer14_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="93649.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="93649.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="93649.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="93649.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="93649.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert5&#45;&gt;layer14_agg_exp5 -->
<g id="edge966" class="edge">
<title>layer14_expert5&#45;&gt;layer14_agg_exp5</title>
<path fill="none" stroke="black" d="M93663.7,-941.09C93663.7,-941.09 93663.7,-915.34 93663.7,-915.34"/>
<polygon fill="black" stroke="black" points="93667.2,-915.34 93663.7,-905.34 93660.2,-915.34 93667.2,-915.34"/>
</g>
<!-- layer14_agg_exp5&#45;&gt;layer14_moe_agg -->
<g id="edge967" class="edge">
<title>layer14_agg_exp5&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M93649.7,-831.47C93649.7,-803.55 93649.7,-770 93649.7,-770 93649.7,-770 94534.73,-770 94534.73,-770"/>
<polygon fill="black" stroke="black" points="94534.73,-773.5 94544.73,-770 94534.73,-766.5 94534.73,-773.5"/>
</g>
<!-- layer14_expert6 -->
<g id="node798" class="node">
<title>layer14_expert6</title>
<polygon fill="lightcoral" stroke="black" points="94184.2,-1004.16 93963.2,-1004.16 93963.2,-941.16 94184.2,-941.16 94184.2,-1004.16"/>
<text text-anchor="middle" x="94073.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="94073.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="94073.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="94073.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="94073.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp6&#45;&gt;layer14_expert6 -->
<g id="edge969" class="edge">
<title>layer14_route_exp6&#45;&gt;layer14_expert6</title>
<path fill="none" stroke="black" d="M94073.7,-1040.16C94073.7,-1040.16 94073.7,-1014.25 94073.7,-1014.25"/>
<polygon fill="black" stroke="black" points="94077.2,-1014.25 94073.7,-1004.25 94070.2,-1014.25 94077.2,-1014.25"/>
</g>
<!-- layer14_agg_exp6 -->
<g id="node799" class="node">
<title>layer14_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="94064.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="94064.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="94064.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="94064.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="94064.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert6&#45;&gt;layer14_agg_exp6 -->
<g id="edge970" class="edge">
<title>layer14_expert6&#45;&gt;layer14_agg_exp6</title>
<path fill="none" stroke="black" d="M94073.7,-941.09C94073.7,-941.09 94073.7,-915.34 94073.7,-915.34"/>
<polygon fill="black" stroke="black" points="94077.2,-915.34 94073.7,-905.34 94070.2,-915.34 94077.2,-915.34"/>
</g>
<!-- layer14_agg_exp6&#45;&gt;layer14_moe_agg -->
<g id="edge971" class="edge">
<title>layer14_agg_exp6&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M94255.8,-858.04C94255.8,-833.72 94255.8,-775 94255.8,-775 94255.8,-775 94570.66,-775 94570.66,-775"/>
<polygon fill="black" stroke="black" points="94570.66,-778.5 94580.66,-775 94570.66,-771.5 94570.66,-778.5"/>
</g>
<!-- layer14_expert7 -->
<g id="node801" class="node">
<title>layer14_expert7</title>
<polygon fill="lightcoral" stroke="black" points="94595.2,-1004.16 94374.2,-1004.16 94374.2,-941.16 94595.2,-941.16 94595.2,-1004.16"/>
<text text-anchor="middle" x="94484.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="94484.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="94484.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="94484.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="94484.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp7&#45;&gt;layer14_expert7 -->
<g id="edge973" class="edge">
<title>layer14_route_exp7&#45;&gt;layer14_expert7</title>
<path fill="none" stroke="black" d="M94484.7,-1040.16C94484.7,-1040.16 94484.7,-1014.25 94484.7,-1014.25"/>
<polygon fill="black" stroke="black" points="94488.2,-1014.25 94484.7,-1004.25 94481.2,-1014.25 94488.2,-1014.25"/>
</g>
<!-- layer14_agg_exp7 -->
<g id="node802" class="node">
<title>layer14_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="94479.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="94479.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="94479.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="94479.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="94479.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert7&#45;&gt;layer14_agg_exp7 -->
<g id="edge974" class="edge">
<title>layer14_expert7&#45;&gt;layer14_agg_exp7</title>
<path fill="none" stroke="black" d="M94484.7,-941.09C94484.7,-941.09 94484.7,-915.34 94484.7,-915.34"/>
<polygon fill="black" stroke="black" points="94488.2,-915.34 94484.7,-905.34 94481.2,-915.34 94488.2,-915.34"/>
</g>
<!-- layer14_agg_exp7&#45;&gt;layer14_moe_agg -->
<g id="edge975" class="edge">
<title>layer14_agg_exp7&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M94580.52,-836.58C94580.52,-836.58 94580.52,-785.37 94580.52,-785.37"/>
<polygon fill="black" stroke="black" points="94584.02,-785.37 94580.52,-775.37 94577.02,-785.37 94584.02,-785.37"/>
</g>
<!-- layer14_expert8 -->
<g id="node804" class="node">
<title>layer14_expert8</title>
<polygon fill="lightcoral" stroke="black" points="95005.2,-1004.16 94784.2,-1004.16 94784.2,-941.16 95005.2,-941.16 95005.2,-1004.16"/>
<text text-anchor="middle" x="94894.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="94894.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="94894.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="94894.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="94894.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp8&#45;&gt;layer14_expert8 -->
<g id="edge977" class="edge">
<title>layer14_route_exp8&#45;&gt;layer14_expert8</title>
<path fill="none" stroke="black" d="M94894.7,-1039.87C94894.7,-1039.87 94894.7,-1014.41 94894.7,-1014.41"/>
<polygon fill="black" stroke="black" points="94898.2,-1014.41 94894.7,-1004.41 94891.2,-1014.41 94898.2,-1014.41"/>
</g>
<!-- layer14_agg_exp8 -->
<g id="node805" class="node">
<title>layer14_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="94894.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="94894.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="94894.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="94894.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="94894.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert8&#45;&gt;layer14_agg_exp8 -->
<g id="edge978" class="edge">
<title>layer14_expert8&#45;&gt;layer14_agg_exp8</title>
<path fill="none" stroke="black" d="M94894.7,-941.09C94894.7,-941.09 94894.7,-915.34 94894.7,-915.34"/>
<polygon fill="black" stroke="black" points="94898.2,-915.34 94894.7,-905.34 94891.2,-915.34 94898.2,-915.34"/>
</g>
<!-- layer14_agg_exp8&#45;&gt;layer14_moe_agg -->
<g id="edge979" class="edge">
<title>layer14_agg_exp8&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M94794.38,-836.58C94794.38,-836.58 94794.38,-785.37 94794.38,-785.37"/>
<polygon fill="black" stroke="black" points="94797.88,-785.37 94794.38,-775.37 94790.88,-785.37 94797.88,-785.37"/>
</g>
<!-- layer14_expert9 -->
<g id="node807" class="node">
<title>layer14_expert9</title>
<polygon fill="lightcoral" stroke="black" points="95415.2,-1004.16 95194.2,-1004.16 95194.2,-941.16 95415.2,-941.16 95415.2,-1004.16"/>
<text text-anchor="middle" x="95304.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="95304.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="95304.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="95304.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="95304.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp9&#45;&gt;layer14_expert9 -->
<g id="edge981" class="edge">
<title>layer14_route_exp9&#45;&gt;layer14_expert9</title>
<path fill="none" stroke="black" d="M95304.7,-1039.87C95304.7,-1039.87 95304.7,-1014.41 95304.7,-1014.41"/>
<polygon fill="black" stroke="black" points="95308.2,-1014.41 95304.7,-1004.41 95301.2,-1014.41 95308.2,-1014.41"/>
</g>
<!-- layer14_agg_exp9 -->
<g id="node808" class="node">
<title>layer14_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="95309.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="95309.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="95309.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="95309.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="95309.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert9&#45;&gt;layer14_agg_exp9 -->
<g id="edge982" class="edge">
<title>layer14_expert9&#45;&gt;layer14_agg_exp9</title>
<path fill="none" stroke="black" d="M95304.7,-941.09C95304.7,-941.09 95304.7,-915.34 95304.7,-915.34"/>
<polygon fill="black" stroke="black" points="95308.2,-915.34 95304.7,-905.34 95301.2,-915.34 95308.2,-915.34"/>
</g>
<!-- layer14_agg_exp9&#45;&gt;layer14_moe_agg -->
<g id="edge983" class="edge">
<title>layer14_agg_exp9&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M95309.7,-831.54C95309.7,-793.92 95309.7,-741 95309.7,-741 95309.7,-741 94902.66,-741 94902.66,-741"/>
<polygon fill="black" stroke="black" points="94902.66,-737.5 94892.66,-741 94902.66,-744.5 94902.66,-737.5"/>
</g>
<!-- layer14_expert10 -->
<g id="node810" class="node">
<title>layer14_expert10</title>
<polygon fill="lightcoral" stroke="black" points="95828.2,-1004.16 95607.2,-1004.16 95607.2,-941.16 95828.2,-941.16 95828.2,-1004.16"/>
<text text-anchor="middle" x="95717.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="95717.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="95717.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="95717.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="95717.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp10&#45;&gt;layer14_expert10 -->
<g id="edge985" class="edge">
<title>layer14_route_exp10&#45;&gt;layer14_expert10</title>
<path fill="none" stroke="black" d="M95717.7,-1040.16C95717.7,-1040.16 95717.7,-1014.25 95717.7,-1014.25"/>
<polygon fill="black" stroke="black" points="95721.2,-1014.25 95717.7,-1004.25 95714.2,-1014.25 95721.2,-1014.25"/>
</g>
<!-- layer14_agg_exp10 -->
<g id="node811" class="node">
<title>layer14_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="95724.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="95724.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="95724.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="95724.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="95724.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert10&#45;&gt;layer14_agg_exp10 -->
<g id="edge986" class="edge">
<title>layer14_expert10&#45;&gt;layer14_agg_exp10</title>
<path fill="none" stroke="black" d="M95717.7,-941.09C95717.7,-941.09 95717.7,-915.34 95717.7,-915.34"/>
<polygon fill="black" stroke="black" points="95721.2,-915.34 95717.7,-905.34 95714.2,-915.34 95721.2,-915.34"/>
</g>
<!-- layer14_agg_exp10&#45;&gt;layer14_moe_agg -->
<g id="edge987" class="edge">
<title>layer14_agg_exp10&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M95724.7,-831.51C95724.7,-792.34 95724.7,-736 95724.7,-736 95724.7,-736 94898.56,-736 94898.56,-736"/>
<polygon fill="black" stroke="black" points="94898.56,-732.5 94888.56,-736 94898.56,-739.5 94898.56,-732.5"/>
</g>
<!-- layer14_expert11 -->
<g id="node813" class="node">
<title>layer14_expert11</title>
<polygon fill="lightcoral" stroke="black" points="96242.2,-1004.16 96021.2,-1004.16 96021.2,-941.16 96242.2,-941.16 96242.2,-1004.16"/>
<text text-anchor="middle" x="96131.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="96131.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="96131.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="96131.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="96131.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp11&#45;&gt;layer14_expert11 -->
<g id="edge989" class="edge">
<title>layer14_route_exp11&#45;&gt;layer14_expert11</title>
<path fill="none" stroke="black" d="M96131.7,-1040.16C96131.7,-1040.16 96131.7,-1014.25 96131.7,-1014.25"/>
<polygon fill="black" stroke="black" points="96135.2,-1014.25 96131.7,-1004.25 96128.2,-1014.25 96135.2,-1014.25"/>
</g>
<!-- layer14_agg_exp11 -->
<g id="node814" class="node">
<title>layer14_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="96139.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="96139.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="96139.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="96139.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="96139.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert11&#45;&gt;layer14_agg_exp11 -->
<g id="edge990" class="edge">
<title>layer14_expert11&#45;&gt;layer14_agg_exp11</title>
<path fill="none" stroke="black" d="M96131.7,-941.09C96131.7,-941.09 96131.7,-915.34 96131.7,-915.34"/>
<polygon fill="black" stroke="black" points="96135.2,-915.34 96131.7,-905.34 96128.2,-915.34 96135.2,-915.34"/>
</g>
<!-- layer14_agg_exp11&#45;&gt;layer14_moe_agg -->
<g id="edge991" class="edge">
<title>layer14_agg_exp11&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M96139.7,-831.57C96139.7,-790.87 96139.7,-731 96139.7,-731 96139.7,-731 94890.51,-731 94890.51,-731"/>
<polygon fill="black" stroke="black" points="94890.51,-727.5 94880.51,-731 94890.51,-734.5 94890.51,-727.5"/>
</g>
<!-- layer14_expert12 -->
<g id="node816" class="node">
<title>layer14_expert12</title>
<polygon fill="lightcoral" stroke="black" points="96656.2,-1004.16 96435.2,-1004.16 96435.2,-941.16 96656.2,-941.16 96656.2,-1004.16"/>
<text text-anchor="middle" x="96545.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="96545.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="96545.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="96545.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="96545.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp12&#45;&gt;layer14_expert12 -->
<g id="edge993" class="edge">
<title>layer14_route_exp12&#45;&gt;layer14_expert12</title>
<path fill="none" stroke="black" d="M96545.7,-1040.16C96545.7,-1040.16 96545.7,-1014.25 96545.7,-1014.25"/>
<polygon fill="black" stroke="black" points="96549.2,-1014.25 96545.7,-1004.25 96542.2,-1014.25 96549.2,-1014.25"/>
</g>
<!-- layer14_agg_exp12 -->
<g id="node817" class="node">
<title>layer14_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="96554.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="96554.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="96554.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="96554.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="96554.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert12&#45;&gt;layer14_agg_exp12 -->
<g id="edge994" class="edge">
<title>layer14_expert12&#45;&gt;layer14_agg_exp12</title>
<path fill="none" stroke="black" d="M96545.7,-941.09C96545.7,-941.09 96545.7,-915.34 96545.7,-915.34"/>
<polygon fill="black" stroke="black" points="96549.2,-915.34 96545.7,-905.34 96542.2,-915.34 96549.2,-915.34"/>
</g>
<!-- layer14_agg_exp12&#45;&gt;layer14_moe_agg -->
<g id="edge995" class="edge">
<title>layer14_agg_exp12&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M96554.7,-831.35C96554.7,-789.16 96554.7,-726 96554.7,-726 96554.7,-726 94877.98,-726 94877.98,-726"/>
<polygon fill="black" stroke="black" points="94877.98,-722.5 94867.98,-726 94877.98,-729.5 94877.98,-722.5"/>
</g>
<!-- layer14_expert13 -->
<g id="node819" class="node">
<title>layer14_expert13</title>
<polygon fill="lightcoral" stroke="black" points="97071.2,-1004.16 96850.2,-1004.16 96850.2,-941.16 97071.2,-941.16 97071.2,-1004.16"/>
<text text-anchor="middle" x="96960.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="96960.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="96960.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="96960.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="96960.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp13&#45;&gt;layer14_expert13 -->
<g id="edge997" class="edge">
<title>layer14_route_exp13&#45;&gt;layer14_expert13</title>
<path fill="none" stroke="black" d="M96960.7,-1040.16C96960.7,-1040.16 96960.7,-1014.25 96960.7,-1014.25"/>
<polygon fill="black" stroke="black" points="96964.2,-1014.25 96960.7,-1004.25 96957.2,-1014.25 96964.2,-1014.25"/>
</g>
<!-- layer14_agg_exp13 -->
<g id="node820" class="node">
<title>layer14_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="96969.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="96969.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="96969.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="96969.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="96969.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert13&#45;&gt;layer14_agg_exp13 -->
<g id="edge998" class="edge">
<title>layer14_expert13&#45;&gt;layer14_agg_exp13</title>
<path fill="none" stroke="black" d="M96960.7,-941.09C96960.7,-941.09 96960.7,-915.34 96960.7,-915.34"/>
<polygon fill="black" stroke="black" points="96964.2,-915.34 96960.7,-905.34 96957.2,-915.34 96964.2,-915.34"/>
</g>
<!-- layer14_agg_exp13&#45;&gt;layer14_moe_agg -->
<g id="edge999" class="edge">
<title>layer14_agg_exp13&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M96969.7,-831.58C96969.7,-787.92 96969.7,-721 96969.7,-721 96969.7,-721 94859.53,-721 94859.53,-721"/>
<polygon fill="black" stroke="black" points="94859.53,-717.5 94849.53,-721 94859.53,-724.5 94859.53,-717.5"/>
</g>
<!-- layer14_expert14 -->
<g id="node822" class="node">
<title>layer14_expert14</title>
<polygon fill="lightcoral" stroke="black" points="97486.2,-1004.16 97265.2,-1004.16 97265.2,-941.16 97486.2,-941.16 97486.2,-1004.16"/>
<text text-anchor="middle" x="97375.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="97375.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="97375.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="97375.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="97375.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp14&#45;&gt;layer14_expert14 -->
<g id="edge1001" class="edge">
<title>layer14_route_exp14&#45;&gt;layer14_expert14</title>
<path fill="none" stroke="black" d="M97375.7,-1040.16C97375.7,-1040.16 97375.7,-1014.25 97375.7,-1014.25"/>
<polygon fill="black" stroke="black" points="97379.2,-1014.25 97375.7,-1004.25 97372.2,-1014.25 97379.2,-1014.25"/>
</g>
<!-- layer14_agg_exp14 -->
<g id="node823" class="node">
<title>layer14_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="97384.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="97384.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="97384.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="97384.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="97384.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert14&#45;&gt;layer14_agg_exp14 -->
<g id="edge1002" class="edge">
<title>layer14_expert14&#45;&gt;layer14_agg_exp14</title>
<path fill="none" stroke="black" d="M97375.7,-941.09C97375.7,-941.09 97375.7,-915.34 97375.7,-915.34"/>
<polygon fill="black" stroke="black" points="97379.2,-915.34 97375.7,-905.34 97372.2,-915.34 97379.2,-915.34"/>
</g>
<!-- layer14_agg_exp14&#45;&gt;layer14_moe_agg -->
<g id="edge1003" class="edge">
<title>layer14_agg_exp14&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M97384.7,-831.5C97384.7,-786.4 97384.7,-716 97384.7,-716 97384.7,-716 94833.29,-716 94833.29,-716"/>
<polygon fill="black" stroke="black" points="94833.29,-712.5 94823.29,-716 94833.29,-719.5 94833.29,-712.5"/>
</g>
<!-- layer14_expert15 -->
<g id="node825" class="node">
<title>layer14_expert15</title>
<polygon fill="lightcoral" stroke="black" points="97905.2,-1004.16 97684.2,-1004.16 97684.2,-941.16 97905.2,-941.16 97905.2,-1004.16"/>
<text text-anchor="middle" x="97794.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="97794.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="97794.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="97794.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="97794.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer14_route_exp15&#45;&gt;layer14_expert15 -->
<g id="edge1005" class="edge">
<title>layer14_route_exp15&#45;&gt;layer14_expert15</title>
<path fill="none" stroke="black" d="M97794.7,-1040.16C97794.7,-1040.16 97794.7,-1014.25 97794.7,-1014.25"/>
<polygon fill="black" stroke="black" points="97798.2,-1014.25 97794.7,-1004.25 97791.2,-1014.25 97798.2,-1014.25"/>
</g>
<!-- layer14_agg_exp15 -->
<g id="node826" class="node">
<title>layer14_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="97799.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="97799.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="97799.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="97799.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="97799.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer14_expert15&#45;&gt;layer14_agg_exp15 -->
<g id="edge1006" class="edge">
<title>layer14_expert15&#45;&gt;layer14_agg_exp15</title>
<path fill="none" stroke="black" d="M97794.7,-941.09C97794.7,-941.09 97794.7,-915.34 97794.7,-915.34"/>
<polygon fill="black" stroke="black" points="97798.2,-915.34 97794.7,-905.34 97791.2,-915.34 97798.2,-915.34"/>
</g>
<!-- layer14_agg_exp15&#45;&gt;layer14_moe_agg -->
<g id="edge1007" class="edge">
<title>layer14_agg_exp15&#45;&gt;layer14_moe_agg</title>
<path fill="none" stroke="black" d="M97799.7,-831.49C97799.7,-784.97 97799.7,-711 97799.7,-711 97799.7,-711 94792.53,-711 94792.53,-711"/>
<polygon fill="black" stroke="black" points="94792.53,-707.5 94782.53,-711 94792.53,-714.5 94792.53,-707.5"/>
</g>
<!-- layer15_ln1 -->
<g id="node828" class="node">
<title>layer15_ln1</title>
<polygon fill="none" stroke="black" points="98153.2,-1227.7 97872.2,-1227.7 97872.2,-1175.7 98153.2,-1175.7 98153.2,-1227.7"/>
<text text-anchor="middle" x="98012.7" y="-1215.7" font-family="Arial" font-size="10.00">LayerNorm MHA 15</text>
<text text-anchor="middle" x="98012.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="98012.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="98012.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer15_add1 -->
<g id="node829" class="node">
<title>layer15_add1</title>
<polygon fill="yellow" stroke="black" points="101168.2,-644.85 100887.2,-644.85 100887.2,-592.85 101168.2,-592.85 101168.2,-644.85"/>
<text text-anchor="middle" x="101027.7" y="-632.85" font-family="Arial" font-size="10.00">MHA Residual Add 15</text>
<text text-anchor="middle" x="101027.7" y="-621.85" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101027.7" y="-610.85" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101027.7" y="-599.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_moe_output -->
<g id="node833" class="node">
<title>layer15_moe_output</title>
<polygon fill="yellow" stroke="black" points="101317.2,-540.58 101036.2,-540.58 101036.2,-488.58 101317.2,-488.58 101317.2,-540.58"/>
<text text-anchor="middle" x="101176.7" y="-528.58" font-family="Arial" font-size="10.00">MoE Residual Add 15</text>
<text text-anchor="middle" x="101176.7" y="-517.58" font-family="Arial" font-size="10.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101176.7" y="-506.58" font-family="Arial" font-size="10.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101176.7" y="-495.58" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_add1&#45;&gt;layer15_moe_output -->
<g id="edge1077" class="edge">
<title>layer15_add1&#45;&gt;layer15_moe_output</title>
<path fill="none" stroke="black" d="M101102.2,-592.81C101102.2,-592.81 101102.2,-550.65 101102.2,-550.65"/>
<polygon fill="black" stroke="black" points="101105.7,-550.65 101102.2,-540.65 101098.7,-550.65 101105.7,-550.65"/>
</g>
<!-- layer15_gate -->
<g id="node830" class="node">
<title>layer15_gate</title>
<polygon fill="lightgreen" stroke="black" points="101616.13,-1253.7 101157.3,-1253.7 101039.26,-1149.7 101498.1,-1149.7 101616.13,-1253.7"/>
<text text-anchor="middle" x="101327.7" y="-1215.7" font-family="Arial" font-size="10.00">Gate Layer 15</text>
<text text-anchor="middle" x="101327.7" y="-1204.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101327.7" y="-1193.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
<text text-anchor="middle" x="101327.7" y="-1182.7" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer15_route_exp0 -->
<g id="node834" class="node">
<title>layer15_route_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="98228.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="98228.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 0</text>
<text text-anchor="middle" x="98228.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="98228.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="98228.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp0 -->
<g id="edge1011" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp0</title>
<path fill="none" stroke="black" d="M101065.56,-1173C100327.92,-1173 98287.82,-1173 98287.82,-1173 98287.82,-1173 98287.82,-1122.15 98287.82,-1122.15"/>
<polygon fill="black" stroke="black" points="98291.32,-1122.15 98287.82,-1112.15 98284.32,-1122.15 98291.32,-1122.15"/>
</g>
<!-- layer15_route_exp1 -->
<g id="node837" class="node">
<title>layer15_route_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="98648.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="98648.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 1</text>
<text text-anchor="middle" x="98648.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="98648.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="98648.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp1 -->
<g id="edge1015" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp1</title>
<path fill="none" stroke="black" d="M101062.26,-1170C100385.51,-1170 98648.7,-1170 98648.7,-1170 98648.7,-1170 98648.7,-1123.71 98648.7,-1123.71"/>
<polygon fill="black" stroke="black" points="98652.2,-1123.71 98648.7,-1113.71 98645.2,-1123.71 98652.2,-1123.71"/>
</g>
<!-- layer15_route_exp2 -->
<g id="node840" class="node">
<title>layer15_route_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="99058.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="99058.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 2</text>
<text text-anchor="middle" x="99058.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="99058.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="99058.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp2 -->
<g id="edge1019" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp2</title>
<path fill="none" stroke="black" d="M101058.78,-1167C100457.9,-1167 99058.7,-1167 99058.7,-1167 99058.7,-1167 99058.7,-1123.82 99058.7,-1123.82"/>
<polygon fill="black" stroke="black" points="99062.2,-1123.82 99058.7,-1113.82 99055.2,-1123.82 99062.2,-1123.82"/>
</g>
<!-- layer15_route_exp3 -->
<g id="node843" class="node">
<title>layer15_route_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="99477.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="99477.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 3</text>
<text text-anchor="middle" x="99477.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="99477.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="99477.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp3 -->
<g id="edge1023" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp3</title>
<path fill="none" stroke="black" d="M101054.23,-1163C100539.43,-1163 99477.7,-1163 99477.7,-1163 99477.7,-1163 99477.7,-1123.93 99477.7,-1123.93"/>
<polygon fill="black" stroke="black" points="99481.2,-1123.93 99477.7,-1113.93 99474.2,-1123.93 99481.2,-1123.93"/>
</g>
<!-- layer15_route_exp4 -->
<g id="node846" class="node">
<title>layer15_route_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="99887.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="99887.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 4</text>
<text text-anchor="middle" x="99887.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="99887.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="99887.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp4 -->
<g id="edge1027" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp4</title>
<path fill="none" stroke="black" d="M101050.9,-1160C100632.61,-1160 99887.7,-1160 99887.7,-1160 99887.7,-1160 99887.7,-1124.09 99887.7,-1124.09"/>
<polygon fill="black" stroke="black" points="99891.2,-1124.09 99887.7,-1114.09 99884.2,-1124.09 99891.2,-1124.09"/>
</g>
<!-- layer15_route_exp5 -->
<g id="node849" class="node">
<title>layer15_route_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="100302.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="100302.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 5</text>
<text text-anchor="middle" x="100302.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="100302.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="100302.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp5 -->
<g id="edge1031" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp5</title>
<path fill="none" stroke="black" d="M101046.26,-1156C100742.81,-1156 100302.7,-1156 100302.7,-1156 100302.7,-1156 100302.7,-1124.15 100302.7,-1124.15"/>
<polygon fill="black" stroke="black" points="100306.2,-1124.15 100302.7,-1114.15 100299.2,-1124.15 100306.2,-1124.15"/>
</g>
<!-- layer15_route_exp6 -->
<g id="node852" class="node">
<title>layer15_route_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="100712.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="100712.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 6</text>
<text text-anchor="middle" x="100712.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="100712.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="100712.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp6 -->
<g id="edge1035" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp6</title>
<path fill="none" stroke="black" d="M101042.7,-1153C100881.83,-1153 100712.7,-1153 100712.7,-1153 100712.7,-1153 100712.7,-1124.07 100712.7,-1124.07"/>
<polygon fill="black" stroke="black" points="100716.2,-1124.07 100712.7,-1114.07 100709.2,-1124.07 100716.2,-1124.07"/>
</g>
<!-- layer15_route_exp7 -->
<g id="node855" class="node">
<title>layer15_route_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="101122.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="101122.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 7</text>
<text text-anchor="middle" x="101122.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="101122.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101122.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp7 -->
<g id="edge1039" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp7</title>
<path fill="none" stroke="black" d="M101177.96,-1149.5C101177.96,-1149.5 101177.96,-1122.25 101177.96,-1122.25"/>
<polygon fill="black" stroke="black" points="101181.46,-1122.25 101177.96,-1112.25 101174.46,-1122.25 101181.46,-1122.25"/>
</g>
<!-- layer15_route_exp8 -->
<g id="node858" class="node">
<title>layer15_route_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="101532.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="101532.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 8</text>
<text text-anchor="middle" x="101532.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="101532.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101532.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp8 -->
<g id="edge1043" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp8</title>
<path fill="none" stroke="black" d="M101477.43,-1149.5C101477.43,-1149.5 101477.43,-1122.25 101477.43,-1122.25"/>
<polygon fill="black" stroke="black" points="101480.93,-1122.25 101477.43,-1112.25 101473.93,-1122.25 101480.93,-1122.25"/>
</g>
<!-- layer15_route_exp9 -->
<g id="node861" class="node">
<title>layer15_route_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="101944.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="101944.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 9</text>
<text text-anchor="middle" x="101944.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="101944.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101944.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp9 -->
<g id="edge1047" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp9</title>
<path fill="none" stroke="black" d="M101512.4,-1162C101694.17,-1162 101944.7,-1162 101944.7,-1162 101944.7,-1162 101944.7,-1123.99 101944.7,-1123.99"/>
<polygon fill="black" stroke="black" points="101948.2,-1123.99 101944.7,-1113.99 101941.2,-1123.99 101948.2,-1123.99"/>
</g>
<!-- layer15_route_exp10 -->
<g id="node864" class="node">
<title>layer15_route_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="102358.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="102358.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 10</text>
<text text-anchor="middle" x="102358.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="102358.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="102358.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp10 -->
<g id="edge1051" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp10</title>
<path fill="none" stroke="black" d="M101527.1,-1175C101826.8,-1175 102358.7,-1175 102358.7,-1175 102358.7,-1175 102358.7,-1123.72 102358.7,-1123.72"/>
<polygon fill="black" stroke="black" points="102362.2,-1123.72 102358.7,-1113.72 102355.2,-1123.72 102362.2,-1123.72"/>
</g>
<!-- layer15_route_exp11 -->
<g id="node867" class="node">
<title>layer15_route_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="102772.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="102772.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 11</text>
<text text-anchor="middle" x="102772.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="102772.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="102772.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp11 -->
<g id="edge1055" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp11</title>
<path fill="none" stroke="black" d="M101541.69,-1188C101943.93,-1188 102772.7,-1188 102772.7,-1188 102772.7,-1188 102772.7,-1123.91 102772.7,-1123.91"/>
<polygon fill="black" stroke="black" points="102776.2,-1123.91 102772.7,-1113.91 102769.2,-1123.91 102776.2,-1123.91"/>
</g>
<!-- layer15_route_exp12 -->
<g id="node870" class="node">
<title>layer15_route_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="103187.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="103187.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 12</text>
<text text-anchor="middle" x="103187.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="103187.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="103187.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp12 -->
<g id="edge1059" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp12</title>
<path fill="none" stroke="black" d="M101556.7,-1201C102053.86,-1201 103187.7,-1201 103187.7,-1201 103187.7,-1201 103187.7,-1123.82 103187.7,-1123.82"/>
<polygon fill="black" stroke="black" points="103191.2,-1123.82 103187.7,-1113.82 103184.2,-1123.82 103191.2,-1123.82"/>
</g>
<!-- layer15_route_exp13 -->
<g id="node873" class="node">
<title>layer15_route_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="103602.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="103602.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 13</text>
<text text-anchor="middle" x="103602.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="103602.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="103602.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp13 -->
<g id="edge1063" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp13</title>
<path fill="none" stroke="black" d="M101571.16,-1214C102158.05,-1214 103602.7,-1214 103602.7,-1214 103602.7,-1214 103602.7,-1124.02 103602.7,-1124.02"/>
<polygon fill="black" stroke="black" points="103606.2,-1124.02 103602.7,-1114.02 103599.2,-1124.02 103606.2,-1124.02"/>
</g>
<!-- layer15_route_exp14 -->
<g id="node876" class="node">
<title>layer15_route_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="104017.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="104017.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 14</text>
<text text-anchor="middle" x="104017.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="104017.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="104017.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp14 -->
<g id="edge1067" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp14</title>
<path fill="none" stroke="black" d="M101585.93,-1227C102259.44,-1227 104017.7,-1227 104017.7,-1227 104017.7,-1227 104017.7,-1124.02 104017.7,-1124.02"/>
<polygon fill="black" stroke="black" points="104021.2,-1124.02 104017.7,-1114.02 104014.2,-1124.02 104021.2,-1124.02"/>
</g>
<!-- layer15_route_exp15 -->
<g id="node879" class="node">
<title>layer15_route_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="104432.7" cy="-1076.93" rx="193.99" ry="36.54"/>
<text text-anchor="middle" x="104432.7" y="-1090.93" font-family="Arial" font-size="10.00">Route to Expert 15</text>
<text text-anchor="middle" x="104432.7" y="-1079.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="104432.7" y="-1068.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="104432.7" y="-1057.93" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_route_exp15 -->
<g id="edge1071" class="edge">
<title>layer15_gate&#45;&gt;layer15_route_exp15</title>
<path fill="none" stroke="black" d="M101600.86,-1240C102358.82,-1240 104432.7,-1240 104432.7,-1240 104432.7,-1240 104432.7,-1123.93 104432.7,-1123.93"/>
<polygon fill="black" stroke="black" points="104436.2,-1123.93 104432.7,-1113.93 104429.2,-1123.93 104436.2,-1123.93"/>
</g>
<!-- layer15_moe_agg -->
<g id="node831" class="node">
<title>layer15_moe_agg</title>
<ellipse fill="gold" stroke="black" cx="101326.7" cy="-743.62" rx="205.12" ry="36.54"/>
<text text-anchor="middle" x="101326.7" y="-757.62" font-family="Arial" font-size="10.00">MoE Final Aggregation 15</text>
<text text-anchor="middle" x="101326.7" y="-746.62" font-family="Arial" font-size="10.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101326.7" y="-735.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101326.7" y="-724.62" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer15_ln2 -->
<g id="node832" class="node">
<title>layer15_ln2</title>
<polygon fill="none" stroke="black" points="101467.2,-644.85 101186.2,-644.85 101186.2,-592.85 101467.2,-592.85 101467.2,-644.85"/>
<text text-anchor="middle" x="101326.7" y="-632.85" font-family="Arial" font-size="10.00">LayerNorm MoE 15</text>
<text text-anchor="middle" x="101326.7" y="-621.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101326.7" y="-610.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="101326.7" y="-599.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- layer15_moe_agg&#45;&gt;layer15_ln2 -->
<g id="edge1075" class="edge">
<title>layer15_moe_agg&#45;&gt;layer15_ln2</title>
<path fill="none" stroke="black" d="M101326.7,-706.52C101326.7,-706.52 101326.7,-654.92 101326.7,-654.92"/>
<polygon fill="black" stroke="black" points="101330.2,-654.92 101326.7,-644.92 101323.2,-654.92 101330.2,-654.92"/>
</g>
<!-- layer15_ln2&#45;&gt;layer15_moe_output -->
<g id="edge1076" class="edge">
<title>layer15_ln2&#45;&gt;layer15_moe_output</title>
<path fill="none" stroke="black" d="M101251.7,-592.81C101251.7,-592.81 101251.7,-550.65 101251.7,-550.65"/>
<polygon fill="black" stroke="black" points="101255.2,-550.65 101251.7,-540.65 101248.2,-550.65 101255.2,-550.65"/>
</g>
<!-- output -->
<g id="node882" class="node">
<title>output</title>
<polygon fill="lightblue" stroke="black" points="101313.7,-428.31 101039.7,-428.31 101039.7,-392.31 101313.7,-392.31 101313.7,-428.31"/>
<text text-anchor="middle" x="101176.7" y="-413.31" font-family="Arial" font-size="10.00">Model Output</text>
<text text-anchor="middle" x="101176.7" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_moe_output&#45;&gt;output -->
<g id="edge1093" class="edge">
<title>layer15_moe_output&#45;&gt;output</title>
<path fill="none" stroke="black" d="M101176.7,-488.54C101176.7,-488.54 101176.7,-438.5 101176.7,-438.5"/>
<polygon fill="black" stroke="black" points="101180.2,-438.5 101176.7,-428.5 101173.2,-438.5 101180.2,-438.5"/>
</g>
<!-- layer15_expert0 -->
<g id="node835" class="node">
<title>layer15_expert0</title>
<polygon fill="lightcoral" stroke="black" points="98332.2,-1004.16 98111.2,-1004.16 98111.2,-941.16 98332.2,-941.16 98332.2,-1004.16"/>
<text text-anchor="middle" x="98221.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 0</text>
<text text-anchor="middle" x="98221.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="98221.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="98221.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="98221.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp0&#45;&gt;layer15_expert0 -->
<g id="edge1012" class="edge">
<title>layer15_route_exp0&#45;&gt;layer15_expert0</title>
<path fill="none" stroke="black" d="M98221.7,-1040.16C98221.7,-1040.16 98221.7,-1014.25 98221.7,-1014.25"/>
<polygon fill="black" stroke="black" points="98225.2,-1014.25 98221.7,-1004.25 98218.2,-1014.25 98225.2,-1014.25"/>
</g>
<!-- layer15_agg_exp0 -->
<g id="node836" class="node">
<title>layer15_agg_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="98214.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="98214.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="98214.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="98214.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="98214.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert0&#45;&gt;layer15_agg_exp0 -->
<g id="edge1013" class="edge">
<title>layer15_expert0&#45;&gt;layer15_agg_exp0</title>
<path fill="none" stroke="black" d="M98221.7,-941.09C98221.7,-941.09 98221.7,-915.34 98221.7,-915.34"/>
<polygon fill="black" stroke="black" points="98225.2,-915.34 98221.7,-905.34 98218.2,-915.34 98225.2,-915.34"/>
</g>
<!-- layer15_agg_exp0&#45;&gt;layer15_moe_agg -->
<g id="edge1014" class="edge">
<title>layer15_agg_exp0&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M98214.7,-831.33C98214.7,-795.31 98214.7,-746 98214.7,-746 98214.7,-746 101111.91,-746 101111.91,-746"/>
<polygon fill="black" stroke="black" points="101111.91,-749.5 101121.91,-746 101111.91,-742.5 101111.91,-749.5"/>
</g>
<!-- layer15_expert1 -->
<g id="node838" class="node">
<title>layer15_expert1</title>
<polygon fill="lightcoral" stroke="black" points="98746.2,-1004.16 98525.2,-1004.16 98525.2,-941.16 98746.2,-941.16 98746.2,-1004.16"/>
<text text-anchor="middle" x="98635.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 1</text>
<text text-anchor="middle" x="98635.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="98635.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="98635.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="98635.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp1&#45;&gt;layer15_expert1 -->
<g id="edge1016" class="edge">
<title>layer15_route_exp1&#45;&gt;layer15_expert1</title>
<path fill="none" stroke="black" d="M98635.7,-1040.16C98635.7,-1040.16 98635.7,-1014.25 98635.7,-1014.25"/>
<polygon fill="black" stroke="black" points="98639.2,-1014.25 98635.7,-1004.25 98632.2,-1014.25 98639.2,-1014.25"/>
</g>
<!-- layer15_agg_exp1 -->
<g id="node839" class="node">
<title>layer15_agg_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="98629.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="98629.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="98629.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="98629.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="98629.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert1&#45;&gt;layer15_agg_exp1 -->
<g id="edge1017" class="edge">
<title>layer15_expert1&#45;&gt;layer15_agg_exp1</title>
<path fill="none" stroke="black" d="M98635.7,-941.09C98635.7,-941.09 98635.7,-915.34 98635.7,-915.34"/>
<polygon fill="black" stroke="black" points="98639.2,-915.34 98635.7,-905.34 98632.2,-915.34 98639.2,-915.34"/>
</g>
<!-- layer15_agg_exp1&#45;&gt;layer15_moe_agg -->
<g id="edge1018" class="edge">
<title>layer15_agg_exp1&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M98629.7,-831.58C98629.7,-796.82 98629.7,-750 98629.7,-750 98629.7,-750 101114.54,-750 101114.54,-750"/>
<polygon fill="black" stroke="black" points="101114.54,-753.5 101124.54,-750 101114.54,-746.5 101114.54,-753.5"/>
</g>
<!-- layer15_expert2 -->
<g id="node841" class="node">
<title>layer15_expert2</title>
<polygon fill="lightcoral" stroke="black" points="99162.2,-1004.16 98941.2,-1004.16 98941.2,-941.16 99162.2,-941.16 99162.2,-1004.16"/>
<text text-anchor="middle" x="99051.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 2</text>
<text text-anchor="middle" x="99051.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="99051.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="99051.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="99051.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp2&#45;&gt;layer15_expert2 -->
<g id="edge1020" class="edge">
<title>layer15_route_exp2&#45;&gt;layer15_expert2</title>
<path fill="none" stroke="black" d="M99051.7,-1040.16C99051.7,-1040.16 99051.7,-1014.25 99051.7,-1014.25"/>
<polygon fill="black" stroke="black" points="99055.2,-1014.25 99051.7,-1004.25 99048.2,-1014.25 99055.2,-1014.25"/>
</g>
<!-- layer15_agg_exp2 -->
<g id="node842" class="node">
<title>layer15_agg_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="99044.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="99044.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="99044.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="99044.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="99044.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert2&#45;&gt;layer15_agg_exp2 -->
<g id="edge1021" class="edge">
<title>layer15_expert2&#45;&gt;layer15_agg_exp2</title>
<path fill="none" stroke="black" d="M99051.7,-941.09C99051.7,-941.09 99051.7,-915.34 99051.7,-915.34"/>
<polygon fill="black" stroke="black" points="99055.2,-915.34 99051.7,-905.34 99048.2,-915.34 99055.2,-915.34"/>
</g>
<!-- layer15_agg_exp2&#45;&gt;layer15_moe_agg -->
<g id="edge1022" class="edge">
<title>layer15_agg_exp2&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M99044.7,-831.57C99044.7,-798.47 99044.7,-755 99044.7,-755 99044.7,-755 101121.64,-755 101121.64,-755"/>
<polygon fill="black" stroke="black" points="101121.64,-758.5 101131.64,-755 101121.64,-751.5 101121.64,-758.5"/>
</g>
<!-- layer15_expert3 -->
<g id="node844" class="node">
<title>layer15_expert3</title>
<polygon fill="lightcoral" stroke="black" points="99586.2,-1004.16 99365.2,-1004.16 99365.2,-941.16 99586.2,-941.16 99586.2,-1004.16"/>
<text text-anchor="middle" x="99475.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 3</text>
<text text-anchor="middle" x="99475.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="99475.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="99475.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="99475.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp3&#45;&gt;layer15_expert3 -->
<g id="edge1024" class="edge">
<title>layer15_route_exp3&#45;&gt;layer15_expert3</title>
<path fill="none" stroke="black" d="M99475.7,-1039.87C99475.7,-1039.87 99475.7,-1014.41 99475.7,-1014.41"/>
<polygon fill="black" stroke="black" points="99479.2,-1014.41 99475.7,-1004.41 99472.2,-1014.41 99479.2,-1014.41"/>
</g>
<!-- layer15_agg_exp3 -->
<g id="node845" class="node">
<title>layer15_agg_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="99459.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="99459.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="99459.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="99459.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="99459.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert3&#45;&gt;layer15_agg_exp3 -->
<g id="edge1025" class="edge">
<title>layer15_expert3&#45;&gt;layer15_agg_exp3</title>
<path fill="none" stroke="black" d="M99475.7,-941.09C99475.7,-941.09 99475.7,-915.34 99475.7,-915.34"/>
<polygon fill="black" stroke="black" points="99479.2,-915.34 99475.7,-905.34 99472.2,-915.34 99479.2,-915.34"/>
</g>
<!-- layer15_agg_exp3&#45;&gt;layer15_moe_agg -->
<g id="edge1026" class="edge">
<title>layer15_agg_exp3&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M99459.7,-831.39C99459.7,-799.99 99459.7,-760 99459.7,-760 99459.7,-760 101133,-760 101133,-760"/>
<polygon fill="black" stroke="black" points="101133,-763.5 101143,-760 101133,-756.5 101133,-763.5"/>
</g>
<!-- layer15_expert4 -->
<g id="node847" class="node">
<title>layer15_expert4</title>
<polygon fill="lightcoral" stroke="black" points="99991.2,-1004.16 99770.2,-1004.16 99770.2,-941.16 99991.2,-941.16 99991.2,-1004.16"/>
<text text-anchor="middle" x="99880.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 4</text>
<text text-anchor="middle" x="99880.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="99880.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="99880.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="99880.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp4&#45;&gt;layer15_expert4 -->
<g id="edge1028" class="edge">
<title>layer15_route_exp4&#45;&gt;layer15_expert4</title>
<path fill="none" stroke="black" d="M99880.7,-1040.16C99880.7,-1040.16 99880.7,-1014.25 99880.7,-1014.25"/>
<polygon fill="black" stroke="black" points="99884.2,-1014.25 99880.7,-1004.25 99877.2,-1014.25 99884.2,-1014.25"/>
</g>
<!-- layer15_agg_exp4 -->
<g id="node848" class="node">
<title>layer15_agg_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="99874.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="99874.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="99874.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="99874.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="99874.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert4&#45;&gt;layer15_agg_exp4 -->
<g id="edge1029" class="edge">
<title>layer15_expert4&#45;&gt;layer15_agg_exp4</title>
<path fill="none" stroke="black" d="M99880.7,-941.09C99880.7,-941.09 99880.7,-915.34 99880.7,-915.34"/>
<polygon fill="black" stroke="black" points="99884.2,-915.34 99880.7,-905.34 99877.2,-915.34 99884.2,-915.34"/>
</g>
<!-- layer15_agg_exp4&#45;&gt;layer15_moe_agg -->
<g id="edge1030" class="edge">
<title>layer15_agg_exp4&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M99874.7,-831.35C99874.7,-801.69 99874.7,-765 99874.7,-765 99874.7,-765 101149.78,-765 101149.78,-765"/>
<polygon fill="black" stroke="black" points="101149.78,-768.5 101159.78,-765 101149.78,-761.5 101149.78,-768.5"/>
</g>
<!-- layer15_expert5 -->
<g id="node850" class="node">
<title>layer15_expert5</title>
<polygon fill="lightcoral" stroke="black" points="100411.2,-1004.16 100190.2,-1004.16 100190.2,-941.16 100411.2,-941.16 100411.2,-1004.16"/>
<text text-anchor="middle" x="100300.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 5</text>
<text text-anchor="middle" x="100300.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="100300.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="100300.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="100300.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp5&#45;&gt;layer15_expert5 -->
<g id="edge1032" class="edge">
<title>layer15_route_exp5&#45;&gt;layer15_expert5</title>
<path fill="none" stroke="black" d="M100300.7,-1039.87C100300.7,-1039.87 100300.7,-1014.41 100300.7,-1014.41"/>
<polygon fill="black" stroke="black" points="100304.2,-1014.41 100300.7,-1004.41 100297.2,-1014.41 100304.2,-1014.41"/>
</g>
<!-- layer15_agg_exp5 -->
<g id="node851" class="node">
<title>layer15_agg_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="100289.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="100289.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="100289.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="100289.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="100289.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert5&#45;&gt;layer15_agg_exp5 -->
<g id="edge1033" class="edge">
<title>layer15_expert5&#45;&gt;layer15_agg_exp5</title>
<path fill="none" stroke="black" d="M100300.7,-941.09C100300.7,-941.09 100300.7,-915.34 100300.7,-915.34"/>
<polygon fill="black" stroke="black" points="100304.2,-915.34 100300.7,-905.34 100297.2,-915.34 100304.2,-915.34"/>
</g>
<!-- layer15_agg_exp5&#45;&gt;layer15_moe_agg -->
<g id="edge1034" class="edge">
<title>layer15_agg_exp5&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M100289.7,-831.47C100289.7,-803.55 100289.7,-770 100289.7,-770 100289.7,-770 101173.6,-770 101173.6,-770"/>
<polygon fill="black" stroke="black" points="101173.6,-773.5 101183.6,-770 101173.6,-766.5 101173.6,-773.5"/>
</g>
<!-- layer15_expert6 -->
<g id="node853" class="node">
<title>layer15_expert6</title>
<polygon fill="lightcoral" stroke="black" points="100818.2,-1004.16 100597.2,-1004.16 100597.2,-941.16 100818.2,-941.16 100818.2,-1004.16"/>
<text text-anchor="middle" x="100707.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 6</text>
<text text-anchor="middle" x="100707.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="100707.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="100707.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="100707.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp6&#45;&gt;layer15_expert6 -->
<g id="edge1036" class="edge">
<title>layer15_route_exp6&#45;&gt;layer15_expert6</title>
<path fill="none" stroke="black" d="M100707.7,-1040.16C100707.7,-1040.16 100707.7,-1014.25 100707.7,-1014.25"/>
<polygon fill="black" stroke="black" points="100711.2,-1014.25 100707.7,-1004.25 100704.2,-1014.25 100711.2,-1014.25"/>
</g>
<!-- layer15_agg_exp6 -->
<g id="node854" class="node">
<title>layer15_agg_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="100704.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="100704.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="100704.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="100704.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="100704.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert6&#45;&gt;layer15_agg_exp6 -->
<g id="edge1037" class="edge">
<title>layer15_expert6&#45;&gt;layer15_agg_exp6</title>
<path fill="none" stroke="black" d="M100707.7,-941.09C100707.7,-941.09 100707.7,-915.34 100707.7,-915.34"/>
<polygon fill="black" stroke="black" points="100711.2,-915.34 100707.7,-905.34 100704.2,-915.34 100711.2,-915.34"/>
</g>
<!-- layer15_agg_exp6&#45;&gt;layer15_moe_agg -->
<g id="edge1038" class="edge">
<title>layer15_agg_exp6&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M100895.3,-857.67C100895.3,-833.14 100895.3,-775 100895.3,-775 100895.3,-775 101209.78,-775 101209.78,-775"/>
<polygon fill="black" stroke="black" points="101209.78,-778.5 101219.78,-775 101209.78,-771.5 101209.78,-778.5"/>
</g>
<!-- layer15_expert7 -->
<g id="node856" class="node">
<title>layer15_expert7</title>
<polygon fill="lightcoral" stroke="black" points="101231.2,-1004.16 101010.2,-1004.16 101010.2,-941.16 101231.2,-941.16 101231.2,-1004.16"/>
<text text-anchor="middle" x="101120.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 7</text>
<text text-anchor="middle" x="101120.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="101120.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="101120.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="101120.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp7&#45;&gt;layer15_expert7 -->
<g id="edge1040" class="edge">
<title>layer15_route_exp7&#45;&gt;layer15_expert7</title>
<path fill="none" stroke="black" d="M101120.7,-1039.87C101120.7,-1039.87 101120.7,-1014.41 101120.7,-1014.41"/>
<polygon fill="black" stroke="black" points="101124.2,-1014.41 101120.7,-1004.41 101117.2,-1014.41 101124.2,-1014.41"/>
</g>
<!-- layer15_agg_exp7 -->
<g id="node857" class="node">
<title>layer15_agg_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="101119.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="101119.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="101119.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="101119.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="101119.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert7&#45;&gt;layer15_agg_exp7 -->
<g id="edge1041" class="edge">
<title>layer15_expert7&#45;&gt;layer15_agg_exp7</title>
<path fill="none" stroke="black" d="M101120.7,-941.09C101120.7,-941.09 101120.7,-915.34 101120.7,-915.34"/>
<polygon fill="black" stroke="black" points="101124.2,-915.34 101120.7,-905.34 101117.2,-915.34 101124.2,-915.34"/>
</g>
<!-- layer15_agg_exp7&#45;&gt;layer15_moe_agg -->
<g id="edge1042" class="edge">
<title>layer15_agg_exp7&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M101220.02,-836.58C101220.02,-836.58 101220.02,-785.37 101220.02,-785.37"/>
<polygon fill="black" stroke="black" points="101223.52,-785.37 101220.02,-775.37 101216.52,-785.37 101223.52,-785.37"/>
</g>
<!-- layer15_expert8 -->
<g id="node859" class="node">
<title>layer15_expert8</title>
<polygon fill="lightcoral" stroke="black" points="101644.2,-1004.16 101423.2,-1004.16 101423.2,-941.16 101644.2,-941.16 101644.2,-1004.16"/>
<text text-anchor="middle" x="101533.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 8</text>
<text text-anchor="middle" x="101533.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="101533.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="101533.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="101533.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp8&#45;&gt;layer15_expert8 -->
<g id="edge1044" class="edge">
<title>layer15_route_exp8&#45;&gt;layer15_expert8</title>
<path fill="none" stroke="black" d="M101533.7,-1039.87C101533.7,-1039.87 101533.7,-1014.41 101533.7,-1014.41"/>
<polygon fill="black" stroke="black" points="101537.2,-1014.41 101533.7,-1004.41 101530.2,-1014.41 101537.2,-1014.41"/>
</g>
<!-- layer15_agg_exp8 -->
<g id="node860" class="node">
<title>layer15_agg_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="101534.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="101534.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="101534.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="101534.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="101534.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert8&#45;&gt;layer15_agg_exp8 -->
<g id="edge1045" class="edge">
<title>layer15_expert8&#45;&gt;layer15_agg_exp8</title>
<path fill="none" stroke="black" d="M101533.7,-941.09C101533.7,-941.09 101533.7,-915.34 101533.7,-915.34"/>
<polygon fill="black" stroke="black" points="101537.2,-915.34 101533.7,-905.34 101530.2,-915.34 101537.2,-915.34"/>
</g>
<!-- layer15_agg_exp8&#45;&gt;layer15_moe_agg -->
<g id="edge1046" class="edge">
<title>layer15_agg_exp8&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M101433.88,-836.58C101433.88,-836.58 101433.88,-785.37 101433.88,-785.37"/>
<polygon fill="black" stroke="black" points="101437.38,-785.37 101433.88,-775.37 101430.38,-785.37 101437.38,-785.37"/>
</g>
<!-- layer15_expert9 -->
<g id="node862" class="node">
<title>layer15_expert9</title>
<polygon fill="lightcoral" stroke="black" points="102057.2,-1004.16 101836.2,-1004.16 101836.2,-941.16 102057.2,-941.16 102057.2,-1004.16"/>
<text text-anchor="middle" x="101946.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 9</text>
<text text-anchor="middle" x="101946.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="101946.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="101946.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="101946.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp9&#45;&gt;layer15_expert9 -->
<g id="edge1048" class="edge">
<title>layer15_route_exp9&#45;&gt;layer15_expert9</title>
<path fill="none" stroke="black" d="M101946.7,-1039.87C101946.7,-1039.87 101946.7,-1014.41 101946.7,-1014.41"/>
<polygon fill="black" stroke="black" points="101950.2,-1014.41 101946.7,-1004.41 101943.2,-1014.41 101950.2,-1014.41"/>
</g>
<!-- layer15_agg_exp9 -->
<g id="node863" class="node">
<title>layer15_agg_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="101949.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="101949.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="101949.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="101949.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="101949.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert9&#45;&gt;layer15_agg_exp9 -->
<g id="edge1049" class="edge">
<title>layer15_expert9&#45;&gt;layer15_agg_exp9</title>
<path fill="none" stroke="black" d="M101946.7,-941.09C101946.7,-941.09 101946.7,-915.34 101946.7,-915.34"/>
<polygon fill="black" stroke="black" points="101950.2,-915.34 101946.7,-905.34 101943.2,-915.34 101950.2,-915.34"/>
</g>
<!-- layer15_agg_exp9&#45;&gt;layer15_moe_agg -->
<g id="edge1050" class="edge">
<title>layer15_agg_exp9&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M101949.7,-831.57C101949.7,-803.99 101949.7,-771 101949.7,-771 101949.7,-771 101473.8,-771 101473.8,-771"/>
<polygon fill="black" stroke="black" points="101473.8,-767.5 101463.8,-771 101473.8,-774.5 101473.8,-767.5"/>
</g>
<!-- layer15_expert10 -->
<g id="node865" class="node">
<title>layer15_expert10</title>
<polygon fill="lightcoral" stroke="black" points="102472.2,-1004.16 102251.2,-1004.16 102251.2,-941.16 102472.2,-941.16 102472.2,-1004.16"/>
<text text-anchor="middle" x="102361.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 10</text>
<text text-anchor="middle" x="102361.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="102361.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="102361.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="102361.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp10&#45;&gt;layer15_expert10 -->
<g id="edge1052" class="edge">
<title>layer15_route_exp10&#45;&gt;layer15_expert10</title>
<path fill="none" stroke="black" d="M102361.7,-1039.87C102361.7,-1039.87 102361.7,-1014.41 102361.7,-1014.41"/>
<polygon fill="black" stroke="black" points="102365.2,-1014.41 102361.7,-1004.41 102358.2,-1014.41 102365.2,-1014.41"/>
</g>
<!-- layer15_agg_exp10 -->
<g id="node866" class="node">
<title>layer15_agg_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="102364.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="102364.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="102364.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="102364.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="102364.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert10&#45;&gt;layer15_agg_exp10 -->
<g id="edge1053" class="edge">
<title>layer15_expert10&#45;&gt;layer15_agg_exp10</title>
<path fill="none" stroke="black" d="M102361.7,-941.09C102361.7,-941.09 102361.7,-915.34 102361.7,-915.34"/>
<polygon fill="black" stroke="black" points="102365.2,-915.34 102361.7,-905.34 102358.2,-915.34 102365.2,-915.34"/>
</g>
<!-- layer15_agg_exp10&#45;&gt;layer15_moe_agg -->
<g id="edge1054" class="edge">
<title>layer15_agg_exp10&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M102364.7,-831.48C102364.7,-800.75 102364.7,-762 102364.7,-762 102364.7,-762 101514.55,-762 101514.55,-762"/>
<polygon fill="black" stroke="black" points="101514.55,-758.5 101504.55,-762 101514.55,-765.5 101514.55,-758.5"/>
</g>
<!-- layer15_expert11 -->
<g id="node868" class="node">
<title>layer15_expert11</title>
<polygon fill="lightcoral" stroke="black" points="102887.2,-1004.16 102666.2,-1004.16 102666.2,-941.16 102887.2,-941.16 102887.2,-1004.16"/>
<text text-anchor="middle" x="102776.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 11</text>
<text text-anchor="middle" x="102776.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="102776.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="102776.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="102776.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp11&#45;&gt;layer15_expert11 -->
<g id="edge1056" class="edge">
<title>layer15_route_exp11&#45;&gt;layer15_expert11</title>
<path fill="none" stroke="black" d="M102776.7,-1039.87C102776.7,-1039.87 102776.7,-1014.41 102776.7,-1014.41"/>
<polygon fill="black" stroke="black" points="102780.2,-1014.41 102776.7,-1004.41 102773.2,-1014.41 102780.2,-1014.41"/>
</g>
<!-- layer15_agg_exp11 -->
<g id="node869" class="node">
<title>layer15_agg_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="102779.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="102779.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="102779.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="102779.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="102779.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert11&#45;&gt;layer15_agg_exp11 -->
<g id="edge1057" class="edge">
<title>layer15_expert11&#45;&gt;layer15_agg_exp11</title>
<path fill="none" stroke="black" d="M102776.7,-941.09C102776.7,-941.09 102776.7,-915.34 102776.7,-915.34"/>
<polygon fill="black" stroke="black" points="102780.2,-915.34 102776.7,-905.34 102773.2,-915.34 102780.2,-915.34"/>
</g>
<!-- layer15_agg_exp11&#45;&gt;layer15_moe_agg -->
<g id="edge1058" class="edge">
<title>layer15_agg_exp11&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M102779.7,-831.56C102779.7,-797.46 102779.7,-752 102779.7,-752 102779.7,-752 101536.44,-752 101536.44,-752"/>
<polygon fill="black" stroke="black" points="101536.44,-748.5 101526.44,-752 101536.44,-755.5 101536.44,-748.5"/>
</g>
<!-- layer15_expert12 -->
<g id="node871" class="node">
<title>layer15_expert12</title>
<polygon fill="lightcoral" stroke="black" points="103301.2,-1004.16 103080.2,-1004.16 103080.2,-941.16 103301.2,-941.16 103301.2,-1004.16"/>
<text text-anchor="middle" x="103190.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 12</text>
<text text-anchor="middle" x="103190.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="103190.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="103190.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="103190.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp12&#45;&gt;layer15_expert12 -->
<g id="edge1060" class="edge">
<title>layer15_route_exp12&#45;&gt;layer15_expert12</title>
<path fill="none" stroke="black" d="M103190.7,-1039.87C103190.7,-1039.87 103190.7,-1014.41 103190.7,-1014.41"/>
<polygon fill="black" stroke="black" points="103194.2,-1014.41 103190.7,-1004.41 103187.2,-1014.41 103194.2,-1014.41"/>
</g>
<!-- layer15_agg_exp12 -->
<g id="node872" class="node">
<title>layer15_agg_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="103194.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="103194.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="103194.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="103194.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="103194.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert12&#45;&gt;layer15_agg_exp12 -->
<g id="edge1061" class="edge">
<title>layer15_expert12&#45;&gt;layer15_agg_exp12</title>
<path fill="none" stroke="black" d="M103190.7,-941.09C103190.7,-941.09 103190.7,-915.34 103190.7,-915.34"/>
<polygon fill="black" stroke="black" points="103194.2,-915.34 103190.7,-905.34 103187.2,-915.34 103194.2,-915.34"/>
</g>
<!-- layer15_agg_exp12&#45;&gt;layer15_moe_agg -->
<g id="edge1062" class="edge">
<title>layer15_agg_exp12&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M103194.7,-831.44C103194.7,-794.46 103194.7,-743 103194.7,-743 103194.7,-743 101541.95,-743 101541.95,-743"/>
<polygon fill="black" stroke="black" points="101541.95,-739.5 101531.95,-743 101541.95,-746.5 101541.95,-739.5"/>
</g>
<!-- layer15_expert13 -->
<g id="node874" class="node">
<title>layer15_expert13</title>
<polygon fill="lightcoral" stroke="black" points="103717.2,-1004.16 103496.2,-1004.16 103496.2,-941.16 103717.2,-941.16 103717.2,-1004.16"/>
<text text-anchor="middle" x="103606.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 13</text>
<text text-anchor="middle" x="103606.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="103606.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="103606.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="103606.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp13&#45;&gt;layer15_expert13 -->
<g id="edge1064" class="edge">
<title>layer15_route_exp13&#45;&gt;layer15_expert13</title>
<path fill="none" stroke="black" d="M103606.7,-1039.87C103606.7,-1039.87 103606.7,-1014.41 103606.7,-1014.41"/>
<polygon fill="black" stroke="black" points="103610.2,-1014.41 103606.7,-1004.41 103603.2,-1014.41 103610.2,-1014.41"/>
</g>
<!-- layer15_agg_exp13 -->
<g id="node875" class="node">
<title>layer15_agg_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="103609.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="103609.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="103609.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="103609.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="103609.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert13&#45;&gt;layer15_agg_exp13 -->
<g id="edge1065" class="edge">
<title>layer15_expert13&#45;&gt;layer15_agg_exp13</title>
<path fill="none" stroke="black" d="M103606.7,-941.09C103606.7,-941.09 103606.7,-915.34 103606.7,-915.34"/>
<polygon fill="black" stroke="black" points="103610.2,-915.34 103606.7,-905.34 103603.2,-915.34 103610.2,-915.34"/>
</g>
<!-- layer15_agg_exp13&#45;&gt;layer15_moe_agg -->
<g id="edge1066" class="edge">
<title>layer15_agg_exp13&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M103609.7,-831.31C103609.7,-791.53 103609.7,-734 103609.7,-734 103609.7,-734 101534.81,-734 101534.81,-734"/>
<polygon fill="black" stroke="black" points="101534.81,-730.5 101524.81,-734 101534.81,-737.5 101534.81,-730.5"/>
</g>
<!-- layer15_expert14 -->
<g id="node877" class="node">
<title>layer15_expert14</title>
<polygon fill="lightcoral" stroke="black" points="104132.2,-1004.16 103911.2,-1004.16 103911.2,-941.16 104132.2,-941.16 104132.2,-1004.16"/>
<text text-anchor="middle" x="104021.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 14</text>
<text text-anchor="middle" x="104021.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="104021.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="104021.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="104021.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp14&#45;&gt;layer15_expert14 -->
<g id="edge1068" class="edge">
<title>layer15_route_exp14&#45;&gt;layer15_expert14</title>
<path fill="none" stroke="black" d="M104021.7,-1039.87C104021.7,-1039.87 104021.7,-1014.41 104021.7,-1014.41"/>
<polygon fill="black" stroke="black" points="104025.2,-1014.41 104021.7,-1004.41 104018.2,-1014.41 104025.2,-1014.41"/>
</g>
<!-- layer15_agg_exp14 -->
<g id="node878" class="node">
<title>layer15_agg_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="104024.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="104024.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="104024.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="104024.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="104024.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert14&#45;&gt;layer15_agg_exp14 -->
<g id="edge1069" class="edge">
<title>layer15_expert14&#45;&gt;layer15_agg_exp14</title>
<path fill="none" stroke="black" d="M104021.7,-941.09C104021.7,-941.09 104021.7,-915.34 104021.7,-915.34"/>
<polygon fill="black" stroke="black" points="104025.2,-915.34 104021.7,-905.34 104018.2,-915.34 104025.2,-915.34"/>
</g>
<!-- layer15_agg_exp14&#45;&gt;layer15_moe_agg -->
<g id="edge1070" class="edge">
<title>layer15_agg_exp14&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M104024.7,-831.46C104024.7,-788.98 104024.7,-725 104024.7,-725 104024.7,-725 101513.72,-725 101513.72,-725"/>
<polygon fill="black" stroke="black" points="101513.72,-721.5 101503.72,-725 101513.72,-728.5 101513.72,-721.5"/>
</g>
<!-- layer15_expert15 -->
<g id="node880" class="node">
<title>layer15_expert15</title>
<polygon fill="lightcoral" stroke="black" points="104546.2,-1004.16 104325.2,-1004.16 104325.2,-941.16 104546.2,-941.16 104546.2,-1004.16"/>
<text text-anchor="middle" x="104435.7" y="-992.16" font-family="Arial" font-size="10.00">MLP Expert 15</text>
<text text-anchor="middle" x="104435.7" y="-981.16" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="104435.7" y="-970.16" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="104435.7" y="-959.16" font-family="Arial" font-size="10.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="104435.7" y="-948.16" font-family="Arial" font-size="10.00">Hidden: [tokens_per_expert, 16384]</text>
</g>
<!-- layer15_route_exp15&#45;&gt;layer15_expert15 -->
<g id="edge1072" class="edge">
<title>layer15_route_exp15&#45;&gt;layer15_expert15</title>
<path fill="none" stroke="black" d="M104435.7,-1039.87C104435.7,-1039.87 104435.7,-1014.41 104435.7,-1014.41"/>
<polygon fill="black" stroke="black" points="104439.2,-1014.41 104435.7,-1004.41 104432.2,-1014.41 104439.2,-1014.41"/>
</g>
<!-- layer15_agg_exp15 -->
<g id="node881" class="node">
<title>layer15_agg_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="104439.7" cy="-868.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="104439.7" y="-882.39" font-family="Arial" font-size="10.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="104439.7" y="-871.39" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="104439.7" y="-860.39" font-family="Arial" font-size="10.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="104439.7" y="-849.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- layer15_expert15&#45;&gt;layer15_agg_exp15 -->
<g id="edge1073" class="edge">
<title>layer15_expert15&#45;&gt;layer15_agg_exp15</title>
<path fill="none" stroke="black" d="M104435.7,-941.09C104435.7,-941.09 104435.7,-915.34 104435.7,-915.34"/>
<polygon fill="black" stroke="black" points="104439.2,-915.34 104435.7,-905.34 104432.2,-915.34 104439.2,-915.34"/>
</g>
<!-- layer15_agg_exp15&#45;&gt;layer15_moe_agg -->
<g id="edge1074" class="edge">
<title>layer15_agg_exp15&#45;&gt;layer15_moe_agg</title>
<path fill="none" stroke="black" d="M104439.7,-831.5C104439.7,-786.4 104439.7,-716 104439.7,-716 104439.7,-716 101472.21,-716 101472.21,-716"/>
<polygon fill="black" stroke="black" points="101472.21,-712.5 101462.21,-716 101472.21,-719.5 101472.21,-712.5"/>
</g>
</g>
</svg>
