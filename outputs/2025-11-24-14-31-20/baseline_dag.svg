<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="19675pt" height="1873pt"
 viewBox="0.00 0.00 19674.71 1872.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1868.72)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1868.72 19670.71,-1868.72 19670.71,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightblue" stroke="black" points="6749.85,-1864.72 6303.85,-1864.72 6303.85,-1826.72 6749.85,-1826.72 6749.85,-1864.72"/>
<text text-anchor="middle" x="6526.85" y="-1849.52" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="6526.85" y="-1834.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha0 -->
<g id="node2" class="node">
<title>mha0</title>
<polygon fill="lightcyan" stroke="black" points="6755.85,-1789.72 6297.85,-1789.72 6297.85,-1721.72 6755.85,-1721.72 6755.85,-1789.72"/>
<text text-anchor="middle" x="6526.85" y="-1774.52" font-family="Times,serif" font-size="14.00">MHA Layer 0</text>
<text text-anchor="middle" x="6526.85" y="-1759.52" font-family="Times,serif" font-size="14.00">TP=8 across 8 GPUs</text>
<text text-anchor="middle" x="6526.85" y="-1744.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6526.85" y="-1729.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- input&#45;&gt;mha0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha0</title>
<path fill="none" stroke="black" d="M6526.85,-1826.63C6526.85,-1826.63 6526.85,-1800.04 6526.85,-1800.04"/>
<polygon fill="black" stroke="black" points="6530.36,-1800.04 6526.85,-1790.04 6523.36,-1800.04 6530.36,-1800.04"/>
</g>
<!-- add1_0 -->
<g id="node3" class="node">
<title>add1_0</title>
<polygon fill="yellow" stroke="black" points="6755.85,-1684.72 6297.85,-1684.72 6297.85,-1616.72 6755.85,-1616.72 6755.85,-1684.72"/>
<text text-anchor="middle" x="6526.85" y="-1669.52" font-family="Times,serif" font-size="14.00">MHA Residual Add 0</text>
<text text-anchor="middle" x="6526.85" y="-1654.52" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6526.85" y="-1639.52" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6526.85" y="-1624.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha0&#45;&gt;add1_0 -->
<g id="edge2" class="edge">
<title>mha0&#45;&gt;add1_0</title>
<path fill="none" stroke="black" d="M6526.85,-1721.63C6526.85,-1721.63 6526.85,-1695 6526.85,-1695"/>
<polygon fill="black" stroke="black" points="6530.36,-1695 6526.85,-1685 6523.36,-1695 6530.36,-1695"/>
</g>
<!-- gate0 -->
<g id="node4" class="node">
<title>gate0</title>
<polygon fill="lightgreen" stroke="black" points="3454.43,-1579.72 2712.21,-1579.72 2521.28,-1473.72 3263.5,-1473.72 3454.43,-1579.72"/>
<text text-anchor="middle" x="2987.85" y="-1538.02" font-family="Times,serif" font-size="14.00">Gate Layer 0</text>
<text text-anchor="middle" x="2987.85" y="-1523.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="2987.85" y="-1508.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
</g>
<!-- add1_0&#45;&gt;gate0 -->
<g id="edge3" class="edge">
<title>add1_0&#45;&gt;gate0</title>
<path fill="none" stroke="black" d="M6327.65,-1616.45C6327.65,-1592.21 6327.65,-1564 6327.65,-1564 6327.65,-1564 3436.19,-1564 3436.19,-1564"/>
<polygon fill="black" stroke="black" points="3436.19,-1560.5 3426.19,-1564 3436.19,-1567.5 3436.19,-1560.5"/>
</g>
<!-- moe0 -->
<g id="node38" class="node">
<title>moe0</title>
<polygon fill="yellow" stroke="black" points="6755.85,-995.86 6297.85,-995.86 6297.85,-927.86 6755.85,-927.86 6755.85,-995.86"/>
<text text-anchor="middle" x="6526.85" y="-980.66" font-family="Times,serif" font-size="14.00">MoE Residual Add 0</text>
<text text-anchor="middle" x="6526.85" y="-965.66" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6526.85" y="-950.66" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6526.85" y="-935.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_0&#45;&gt;moe0 -->
<g id="edge45" class="edge">
<title>add1_0&#45;&gt;moe0</title>
<path fill="none" stroke="black" d="M6538.78,-1616.56C6538.78,-1616.56 6538.78,-1006.23 6538.78,-1006.23"/>
<polygon fill="black" stroke="black" points="6542.28,-1006.23 6538.78,-996.23 6535.28,-1006.23 6542.28,-1006.23"/>
</g>
<!-- route0_gpu0 -->
<g id="node5" class="node">
<title>route0_gpu0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4291.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="4291.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 0</text>
<text text-anchor="middle" x="4291.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="4291.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_gpu0 -->
<g id="edge4" class="edge">
<title>gate0&#45;&gt;route0_gpu0</title>
<path fill="none" stroke="black" d="M3289.48,-1488C3674.64,-1488 4291.85,-1488 4291.85,-1488 4291.85,-1488 4291.85,-1446.88 4291.85,-1446.88"/>
<polygon fill="black" stroke="black" points="4295.36,-1446.88 4291.85,-1436.88 4288.36,-1446.88 4295.36,-1446.88"/>
</g>
<!-- route0_gpu1 -->
<g id="node8" class="node">
<title>route0_gpu1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4955.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="4955.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 1</text>
<text text-anchor="middle" x="4955.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="4955.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_gpu1 -->
<g id="edge7" class="edge">
<title>gate0&#45;&gt;route0_gpu1</title>
<path fill="none" stroke="black" d="M3345.1,-1519C3912.42,-1519 4955.85,-1519 4955.85,-1519 4955.85,-1519 4955.85,-1446.81 4955.85,-1446.81"/>
<polygon fill="black" stroke="black" points="4959.36,-1446.81 4955.85,-1436.81 4952.36,-1446.81 4959.36,-1446.81"/>
</g>
<!-- route0_gpu2 -->
<g id="node11" class="node">
<title>route0_gpu2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="370.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="370.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 2</text>
<text text-anchor="middle" x="370.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="370.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_gpu2 -->
<g id="edge10" class="edge">
<title>gate0&#45;&gt;route0_gpu2</title>
<path fill="none" stroke="black" d="M2664.01,-1553C1963.66,-1553 370.85,-1553 370.85,-1553 370.85,-1553 370.85,-1446.86 370.85,-1446.86"/>
<polygon fill="black" stroke="black" points="374.36,-1446.86 370.85,-1436.86 367.36,-1446.86 374.36,-1446.86"/>
</g>
<!-- route0_gpu3 -->
<g id="node14" class="node">
<title>route0_gpu3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1020.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="1020.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 3</text>
<text text-anchor="middle" x="1020.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1020.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_gpu3 -->
<g id="edge13" class="edge">
<title>gate0&#45;&gt;route0_gpu3</title>
<path fill="none" stroke="black" d="M2615.28,-1526C2044.96,-1526 1020.85,-1526 1020.85,-1526 1020.85,-1526 1020.85,-1446.93 1020.85,-1446.93"/>
<polygon fill="black" stroke="black" points="1024.36,-1446.93 1020.85,-1436.93 1017.36,-1446.93 1024.36,-1446.93"/>
</g>
<!-- route0_gpu4 -->
<g id="node17" class="node">
<title>route0_gpu4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1679.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="1679.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 4</text>
<text text-anchor="middle" x="1679.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1679.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_gpu4 -->
<g id="edge16" class="edge">
<title>gate0&#45;&gt;route0_gpu4</title>
<path fill="none" stroke="black" d="M2568.6,-1500C2186.01,-1500 1679.85,-1500 1679.85,-1500 1679.85,-1500 1679.85,-1446.76 1679.85,-1446.76"/>
<polygon fill="black" stroke="black" points="1683.36,-1446.76 1679.85,-1436.76 1676.36,-1446.76 1683.36,-1446.76"/>
</g>
<!-- route0_gpu5 -->
<g id="node20" class="node">
<title>route0_gpu5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2330.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="2330.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 5</text>
<text text-anchor="middle" x="2330.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="2330.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_gpu5 -->
<g id="edge19" class="edge">
<title>gate0&#45;&gt;route0_gpu5</title>
<path fill="none" stroke="black" d="M2583.77,-1473.4C2583.77,-1473.4 2583.77,-1431.9 2583.77,-1431.9"/>
<polygon fill="black" stroke="black" points="2587.27,-1431.9 2583.77,-1421.9 2580.27,-1431.91 2587.27,-1431.9"/>
</g>
<!-- route0_gpu6 -->
<g id="node23" class="node">
<title>route0_gpu6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2987.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="2987.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 6</text>
<text text-anchor="middle" x="2987.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="2987.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_gpu6 -->
<g id="edge22" class="edge">
<title>gate0&#45;&gt;route0_gpu6</title>
<path fill="none" stroke="black" d="M2987.85,-1473.4C2987.85,-1473.4 2987.85,-1446.85 2987.85,-1446.85"/>
<polygon fill="black" stroke="black" points="2991.36,-1446.85 2987.85,-1436.85 2984.36,-1446.85 2991.36,-1446.85"/>
</g>
<!-- route0_gpu7 -->
<g id="node26" class="node">
<title>route0_gpu7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3638.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="3638.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 7</text>
<text text-anchor="middle" x="3638.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3638.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_gpu7 -->
<g id="edge25" class="edge">
<title>gate0&#45;&gt;route0_gpu7</title>
<path fill="none" stroke="black" d="M3388.94,-1526.63C3388.94,-1526.63 3388.94,-1432.27 3388.94,-1432.27"/>
<polygon fill="black" stroke="black" points="3392.44,-1432.27 3388.94,-1422.27 3385.44,-1432.27 3392.44,-1432.27"/>
</g>
<!-- experts_gpu0_layer0 -->
<g id="node6" class="node">
<title>experts_gpu0_layer0</title>
<polygon fill="lightcoral" stroke="black" points="4474.85,-1324.77 4136.85,-1324.77 4136.85,-1256.77 4474.85,-1256.77 4474.85,-1324.77"/>
<text text-anchor="middle" x="4305.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 0</text>
<text text-anchor="middle" x="4305.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="4305.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="4305.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route0_gpu0&#45;&gt;experts_gpu0_layer0 -->
<g id="edge5" class="edge">
<title>route0_gpu0&#45;&gt;experts_gpu0_layer0</title>
<path fill="none" stroke="black" d="M4305.85,-1361.61C4305.85,-1361.61 4305.85,-1335.06 4305.85,-1335.06"/>
<polygon fill="black" stroke="black" points="4309.36,-1335.06 4305.85,-1325.06 4302.36,-1335.06 4309.36,-1335.06"/>
</g>
<!-- agg0_gpu0 -->
<g id="node7" class="node">
<title>agg0_gpu0</title>
<ellipse fill="lightpink" stroke="black" cx="4319.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="4319.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 0</text>
<text text-anchor="middle" x="4319.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="4319.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu0_layer0&#45;&gt;agg0_gpu0 -->
<g id="edge6" class="edge">
<title>experts_gpu0_layer0&#45;&gt;agg0_gpu0</title>
<path fill="none" stroke="black" d="M4305.85,-1256.74C4305.85,-1256.74 4305.85,-1229.97 4305.85,-1229.97"/>
<polygon fill="black" stroke="black" points="4309.36,-1229.97 4305.85,-1219.97 4302.36,-1229.97 4309.36,-1229.97"/>
</g>
<!-- moe_agg0 -->
<g id="node29" class="node">
<title>moe_agg0</title>
<ellipse fill="gold" stroke="black" cx="5389.85" cy="-1070.34" rx="336.67" ry="37.45"/>
<text text-anchor="middle" x="5389.85" y="-1081.64" font-family="Times,serif" font-size="14.00">MoE Final Aggregation 0</text>
<text text-anchor="middle" x="5389.85" y="-1066.64" font-family="Times,serif" font-size="14.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5389.85" y="-1051.64" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- agg0_gpu0&#45;&gt;moe_agg0 -->
<g id="edge28" class="edge">
<title>agg0_gpu0&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M4319.85,-1144.58C4319.85,-1122.14 4319.85,-1098 4319.85,-1098 4319.85,-1098 5152.61,-1098 5152.61,-1098"/>
<polygon fill="black" stroke="black" points="5152.61,-1101.5 5162.61,-1098 5152.61,-1094.5 5152.61,-1101.5"/>
</g>
<!-- experts_gpu1_layer0 -->
<g id="node9" class="node">
<title>experts_gpu1_layer0</title>
<polygon fill="lightcoral" stroke="black" points="5135.85,-1324.77 4797.85,-1324.77 4797.85,-1256.77 5135.85,-1256.77 5135.85,-1324.77"/>
<text text-anchor="middle" x="4966.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 1</text>
<text text-anchor="middle" x="4966.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="4966.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="4966.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route0_gpu1&#45;&gt;experts_gpu1_layer0 -->
<g id="edge8" class="edge">
<title>route0_gpu1&#45;&gt;experts_gpu1_layer0</title>
<path fill="none" stroke="black" d="M4966.85,-1361.61C4966.85,-1361.61 4966.85,-1335.06 4966.85,-1335.06"/>
<polygon fill="black" stroke="black" points="4970.36,-1335.06 4966.85,-1325.06 4963.36,-1335.06 4970.36,-1335.06"/>
</g>
<!-- agg0_gpu1 -->
<g id="node10" class="node">
<title>agg0_gpu1</title>
<ellipse fill="lightpink" stroke="black" cx="4985.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="4985.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 1</text>
<text text-anchor="middle" x="4985.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="4985.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu1_layer0&#45;&gt;agg0_gpu1 -->
<g id="edge9" class="edge">
<title>experts_gpu1_layer0&#45;&gt;agg0_gpu1</title>
<path fill="none" stroke="black" d="M4966.85,-1256.74C4966.85,-1256.74 4966.85,-1229.97 4966.85,-1229.97"/>
<polygon fill="black" stroke="black" points="4970.36,-1229.97 4966.85,-1219.97 4963.36,-1229.97 4970.36,-1229.97"/>
</g>
<!-- agg0_gpu1&#45;&gt;moe_agg0 -->
<g id="edge29" class="edge">
<title>agg0_gpu1&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M5181.49,-1152.29C5181.49,-1152.29 5181.49,-1110.03 5181.49,-1110.03"/>
<polygon fill="black" stroke="black" points="5184.99,-1110.03 5181.49,-1100.03 5177.99,-1110.03 5184.99,-1110.03"/>
</g>
<!-- experts_gpu2_layer0 -->
<g id="node12" class="node">
<title>experts_gpu2_layer0</title>
<polygon fill="lightcoral" stroke="black" points="533.85,-1324.77 195.85,-1324.77 195.85,-1256.77 533.85,-1256.77 533.85,-1324.77"/>
<text text-anchor="middle" x="364.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 2</text>
<text text-anchor="middle" x="364.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="364.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="364.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route0_gpu2&#45;&gt;experts_gpu2_layer0 -->
<g id="edge11" class="edge">
<title>route0_gpu2&#45;&gt;experts_gpu2_layer0</title>
<path fill="none" stroke="black" d="M364.85,-1361.61C364.85,-1361.61 364.85,-1335.06 364.85,-1335.06"/>
<polygon fill="black" stroke="black" points="368.36,-1335.06 364.85,-1325.06 361.36,-1335.06 368.36,-1335.06"/>
</g>
<!-- agg0_gpu2 -->
<g id="node13" class="node">
<title>agg0_gpu2</title>
<ellipse fill="lightpink" stroke="black" cx="323.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="323.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 2</text>
<text text-anchor="middle" x="323.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="323.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu2_layer0&#45;&gt;agg0_gpu2 -->
<g id="edge12" class="edge">
<title>experts_gpu2_layer0&#45;&gt;agg0_gpu2</title>
<path fill="none" stroke="black" d="M364.85,-1256.74C364.85,-1256.74 364.85,-1229.58 364.85,-1229.58"/>
<polygon fill="black" stroke="black" points="368.36,-1229.58 364.85,-1219.58 361.36,-1229.58 368.36,-1229.58"/>
</g>
<!-- agg0_gpu2&#45;&gt;moe_agg0 -->
<g id="edge30" class="edge">
<title>agg0_gpu2&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M323.85,-1144.69C323.85,-1103.14 323.85,-1042 323.85,-1042 323.85,-1042 5159.33,-1042 5159.33,-1042"/>
<polygon fill="black" stroke="black" points="5159.33,-1045.5 5169.33,-1042 5159.33,-1038.5 5159.33,-1045.5"/>
</g>
<!-- experts_gpu3_layer0 -->
<g id="node15" class="node">
<title>experts_gpu3_layer0</title>
<polygon fill="lightcoral" stroke="black" points="1177.85,-1324.77 839.85,-1324.77 839.85,-1256.77 1177.85,-1256.77 1177.85,-1324.77"/>
<text text-anchor="middle" x="1008.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 3</text>
<text text-anchor="middle" x="1008.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="1008.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="1008.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route0_gpu3&#45;&gt;experts_gpu3_layer0 -->
<g id="edge14" class="edge">
<title>route0_gpu3&#45;&gt;experts_gpu3_layer0</title>
<path fill="none" stroke="black" d="M1008.85,-1361.61C1008.85,-1361.61 1008.85,-1335.06 1008.85,-1335.06"/>
<polygon fill="black" stroke="black" points="1012.36,-1335.06 1008.85,-1325.06 1005.36,-1335.06 1012.36,-1335.06"/>
</g>
<!-- agg0_gpu3 -->
<g id="node16" class="node">
<title>agg0_gpu3</title>
<ellipse fill="lightpink" stroke="black" cx="989.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="989.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 3</text>
<text text-anchor="middle" x="989.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="989.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu3_layer0&#45;&gt;agg0_gpu3 -->
<g id="edge15" class="edge">
<title>experts_gpu3_layer0&#45;&gt;agg0_gpu3</title>
<path fill="none" stroke="black" d="M1008.85,-1256.74C1008.85,-1256.74 1008.85,-1229.97 1008.85,-1229.97"/>
<polygon fill="black" stroke="black" points="1012.36,-1229.97 1008.85,-1219.97 1005.36,-1229.97 1012.36,-1229.97"/>
</g>
<!-- agg0_gpu3&#45;&gt;moe_agg0 -->
<g id="edge31" class="edge">
<title>agg0_gpu3&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M989.85,-1144.67C989.85,-1105.87 989.85,-1051 989.85,-1051 989.85,-1051 5091.16,-1051 5091.16,-1051"/>
<polygon fill="black" stroke="black" points="5091.16,-1054.5 5101.16,-1051 5091.16,-1047.5 5091.16,-1054.5"/>
</g>
<!-- experts_gpu4_layer0 -->
<g id="node18" class="node">
<title>experts_gpu4_layer0</title>
<polygon fill="lightcoral" stroke="black" points="1833.85,-1324.77 1495.85,-1324.77 1495.85,-1256.77 1833.85,-1256.77 1833.85,-1324.77"/>
<text text-anchor="middle" x="1664.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 4</text>
<text text-anchor="middle" x="1664.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="1664.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="1664.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route0_gpu4&#45;&gt;experts_gpu4_layer0 -->
<g id="edge17" class="edge">
<title>route0_gpu4&#45;&gt;experts_gpu4_layer0</title>
<path fill="none" stroke="black" d="M1664.85,-1361.61C1664.85,-1361.61 1664.85,-1335.06 1664.85,-1335.06"/>
<polygon fill="black" stroke="black" points="1668.36,-1335.06 1664.85,-1325.06 1661.36,-1335.06 1668.36,-1335.06"/>
</g>
<!-- agg0_gpu4 -->
<g id="node19" class="node">
<title>agg0_gpu4</title>
<ellipse fill="lightpink" stroke="black" cx="1655.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="1655.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 4</text>
<text text-anchor="middle" x="1655.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="1655.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu4_layer0&#45;&gt;agg0_gpu4 -->
<g id="edge18" class="edge">
<title>experts_gpu4_layer0&#45;&gt;agg0_gpu4</title>
<path fill="none" stroke="black" d="M1664.85,-1256.74C1664.85,-1256.74 1664.85,-1229.97 1664.85,-1229.97"/>
<polygon fill="black" stroke="black" points="1668.36,-1229.97 1664.85,-1219.97 1661.36,-1229.97 1668.36,-1229.97"/>
</g>
<!-- agg0_gpu4&#45;&gt;moe_agg0 -->
<g id="edge32" class="edge">
<title>agg0_gpu4&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M1655.85,-1144.6C1655.85,-1108.67 1655.85,-1060 1655.85,-1060 1655.85,-1060 5056.24,-1060 5056.24,-1060"/>
<polygon fill="black" stroke="black" points="5056.24,-1063.5 5066.24,-1060 5056.24,-1056.5 5056.24,-1063.5"/>
</g>
<!-- experts_gpu5_layer0 -->
<g id="node21" class="node">
<title>experts_gpu5_layer0</title>
<polygon fill="lightcoral" stroke="black" points="2494.85,-1324.77 2156.85,-1324.77 2156.85,-1256.77 2494.85,-1256.77 2494.85,-1324.77"/>
<text text-anchor="middle" x="2325.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 5</text>
<text text-anchor="middle" x="2325.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="2325.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="2325.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route0_gpu5&#45;&gt;experts_gpu5_layer0 -->
<g id="edge20" class="edge">
<title>route0_gpu5&#45;&gt;experts_gpu5_layer0</title>
<path fill="none" stroke="black" d="M2325.85,-1361.61C2325.85,-1361.61 2325.85,-1335.06 2325.85,-1335.06"/>
<polygon fill="black" stroke="black" points="2329.36,-1335.06 2325.85,-1325.06 2322.36,-1335.06 2329.36,-1335.06"/>
</g>
<!-- agg0_gpu5 -->
<g id="node22" class="node">
<title>agg0_gpu5</title>
<ellipse fill="lightpink" stroke="black" cx="2321.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="2321.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 5</text>
<text text-anchor="middle" x="2321.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="2321.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu5_layer0&#45;&gt;agg0_gpu5 -->
<g id="edge21" class="edge">
<title>experts_gpu5_layer0&#45;&gt;agg0_gpu5</title>
<path fill="none" stroke="black" d="M2325.85,-1256.74C2325.85,-1256.74 2325.85,-1229.97 2325.85,-1229.97"/>
<polygon fill="black" stroke="black" points="2329.36,-1229.97 2325.85,-1219.97 2322.36,-1229.97 2329.36,-1229.97"/>
</g>
<!-- agg0_gpu5&#45;&gt;moe_agg0 -->
<g id="edge33" class="edge">
<title>agg0_gpu5&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M2321.85,-1144.59C2321.85,-1111.97 2321.85,-1070 2321.85,-1070 2321.85,-1070 5043.12,-1070 5043.12,-1070"/>
<polygon fill="black" stroke="black" points="5043.12,-1073.5 5053.12,-1070 5043.12,-1066.5 5043.12,-1073.5"/>
</g>
<!-- experts_gpu6_layer0 -->
<g id="node24" class="node">
<title>experts_gpu6_layer0</title>
<polygon fill="lightcoral" stroke="black" points="3156.85,-1324.77 2818.85,-1324.77 2818.85,-1256.77 3156.85,-1256.77 3156.85,-1324.77"/>
<text text-anchor="middle" x="2987.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 6</text>
<text text-anchor="middle" x="2987.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="2987.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="2987.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route0_gpu6&#45;&gt;experts_gpu6_layer0 -->
<g id="edge23" class="edge">
<title>route0_gpu6&#45;&gt;experts_gpu6_layer0</title>
<path fill="none" stroke="black" d="M2987.85,-1361.61C2987.85,-1361.61 2987.85,-1335.06 2987.85,-1335.06"/>
<polygon fill="black" stroke="black" points="2991.36,-1335.06 2987.85,-1325.06 2984.36,-1335.06 2991.36,-1335.06"/>
</g>
<!-- agg0_gpu6 -->
<g id="node25" class="node">
<title>agg0_gpu6</title>
<ellipse fill="lightpink" stroke="black" cx="2987.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="2987.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 6</text>
<text text-anchor="middle" x="2987.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="2987.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu6_layer0&#45;&gt;agg0_gpu6 -->
<g id="edge24" class="edge">
<title>experts_gpu6_layer0&#45;&gt;agg0_gpu6</title>
<path fill="none" stroke="black" d="M2987.85,-1256.74C2987.85,-1256.74 2987.85,-1229.97 2987.85,-1229.97"/>
<polygon fill="black" stroke="black" points="2991.36,-1229.97 2987.85,-1219.97 2984.36,-1229.97 2991.36,-1229.97"/>
</g>
<!-- agg0_gpu6&#45;&gt;moe_agg0 -->
<g id="edge34" class="edge">
<title>agg0_gpu6&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M2987.85,-1144.71C2987.85,-1115.17 2987.85,-1079 2987.85,-1079 2987.85,-1079 5052.16,-1079 5052.16,-1079"/>
<polygon fill="black" stroke="black" points="5052.16,-1082.5 5062.16,-1079 5052.16,-1075.5 5052.16,-1082.5"/>
</g>
<!-- experts_gpu7_layer0 -->
<g id="node27" class="node">
<title>experts_gpu7_layer0</title>
<polygon fill="lightcoral" stroke="black" points="3812.85,-1324.77 3474.85,-1324.77 3474.85,-1256.77 3812.85,-1256.77 3812.85,-1324.77"/>
<text text-anchor="middle" x="3643.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 7</text>
<text text-anchor="middle" x="3643.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="3643.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="3643.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route0_gpu7&#45;&gt;experts_gpu7_layer0 -->
<g id="edge26" class="edge">
<title>route0_gpu7&#45;&gt;experts_gpu7_layer0</title>
<path fill="none" stroke="black" d="M3643.85,-1361.61C3643.85,-1361.61 3643.85,-1335.06 3643.85,-1335.06"/>
<polygon fill="black" stroke="black" points="3647.36,-1335.06 3643.85,-1325.06 3640.36,-1335.06 3647.36,-1335.06"/>
</g>
<!-- agg0_gpu7 -->
<g id="node28" class="node">
<title>agg0_gpu7</title>
<ellipse fill="lightpink" stroke="black" cx="3653.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="3653.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 7</text>
<text text-anchor="middle" x="3653.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="3653.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu7_layer0&#45;&gt;agg0_gpu7 -->
<g id="edge27" class="edge">
<title>experts_gpu7_layer0&#45;&gt;agg0_gpu7</title>
<path fill="none" stroke="black" d="M3643.85,-1256.74C3643.85,-1256.74 3643.85,-1229.97 3643.85,-1229.97"/>
<polygon fill="black" stroke="black" points="3647.36,-1229.97 3643.85,-1219.97 3640.36,-1229.97 3647.36,-1229.97"/>
</g>
<!-- agg0_gpu7&#45;&gt;moe_agg0 -->
<g id="edge35" class="edge">
<title>agg0_gpu7&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M3653.85,-1144.61C3653.85,-1118.72 3653.85,-1089 3653.85,-1089 3653.85,-1089 5087.82,-1089 5087.82,-1089"/>
<polygon fill="black" stroke="black" points="5087.82,-1092.5 5097.82,-1089 5087.82,-1085.5 5087.82,-1092.5"/>
</g>
<!-- moe_agg0&#45;&gt;moe0 -->
<g id="edge44" class="edge">
<title>moe_agg0&#45;&gt;moe0</title>
<path fill="none" stroke="black" d="M5560.23,-1038C5830.6,-1038 6327.65,-1038 6327.65,-1038 6327.65,-1038 6327.65,-1005.92 6327.65,-1005.92"/>
<polygon fill="black" stroke="black" points="6331.15,-1005.92 6327.65,-995.92 6324.15,-1005.92 6331.15,-1005.92"/>
</g>
<!-- agg0_gpu8 -->
<g id="node30" class="node">
<title>agg0_gpu8</title>
<ellipse fill="none" stroke="black" cx="5389.85" cy="-1182.29" rx="61.99" ry="18"/>
<text text-anchor="middle" x="5389.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg0_gpu8</text>
</g>
<!-- agg0_gpu8&#45;&gt;moe_agg0 -->
<g id="edge36" class="edge">
<title>agg0_gpu8&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M5389.85,-1163.8C5389.85,-1163.8 5389.85,-1117.9 5389.85,-1117.9"/>
<polygon fill="black" stroke="black" points="5393.36,-1117.9 5389.85,-1107.9 5386.36,-1117.9 5393.36,-1117.9"/>
</g>
<!-- agg0_gpu9 -->
<g id="node31" class="node">
<title>agg0_gpu9</title>
<ellipse fill="none" stroke="black" cx="5530.85" cy="-1182.29" rx="61.99" ry="18"/>
<text text-anchor="middle" x="5530.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg0_gpu9</text>
</g>
<!-- agg0_gpu9&#45;&gt;moe_agg0 -->
<g id="edge37" class="edge">
<title>agg0_gpu9&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M5530.85,-1163.8C5530.85,-1163.8 5530.85,-1114.69 5530.85,-1114.69"/>
<polygon fill="black" stroke="black" points="5534.36,-1114.69 5530.85,-1104.69 5527.36,-1114.69 5534.36,-1114.69"/>
</g>
<!-- agg0_gpu10 -->
<g id="node32" class="node">
<title>agg0_gpu10</title>
<ellipse fill="none" stroke="black" cx="5677.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="5677.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg0_gpu10</text>
</g>
<!-- agg0_gpu10&#45;&gt;moe_agg0 -->
<g id="edge38" class="edge">
<title>agg0_gpu10&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M5668.35,-1164.3C5668.35,-1164.3 5668.35,-1101.72 5668.35,-1101.72"/>
<polygon fill="black" stroke="black" points="5671.85,-1101.72 5668.35,-1091.72 5664.85,-1101.72 5671.85,-1101.72"/>
</g>
<!-- agg0_gpu11 -->
<g id="node33" class="node">
<title>agg0_gpu11</title>
<ellipse fill="none" stroke="black" cx="5830.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="5830.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg0_gpu11</text>
</g>
<!-- agg0_gpu11&#45;&gt;moe_agg0 -->
<g id="edge39" class="edge">
<title>agg0_gpu11&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M5830.85,-1164.07C5830.85,-1130.89 5830.85,-1064 5830.85,-1064 5830.85,-1064 5731.84,-1064 5731.84,-1064"/>
<polygon fill="black" stroke="black" points="5731.84,-1060.5 5721.84,-1064 5731.84,-1067.5 5731.84,-1060.5"/>
</g>
<!-- agg0_gpu12 -->
<g id="node34" class="node">
<title>agg0_gpu12</title>
<ellipse fill="none" stroke="black" cx="5983.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="5983.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg0_gpu12</text>
</g>
<!-- agg0_gpu12&#45;&gt;moe_agg0 -->
<g id="edge40" class="edge">
<title>agg0_gpu12&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M5983.85,-1164.1C5983.85,-1129.8 5983.85,-1059 5983.85,-1059 5983.85,-1059 5720.76,-1059 5720.76,-1059"/>
<polygon fill="black" stroke="black" points="5720.76,-1055.5 5710.76,-1059 5720.76,-1062.5 5720.76,-1055.5"/>
</g>
<!-- agg0_gpu13 -->
<g id="node35" class="node">
<title>agg0_gpu13</title>
<ellipse fill="none" stroke="black" cx="6136.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="6136.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg0_gpu13</text>
</g>
<!-- agg0_gpu13&#45;&gt;moe_agg0 -->
<g id="edge41" class="edge">
<title>agg0_gpu13&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M6136.85,-1164.18C6136.85,-1128.82 6136.85,-1054 6136.85,-1054 6136.85,-1054 5702.88,-1054 5702.88,-1054"/>
<polygon fill="black" stroke="black" points="5702.88,-1050.5 5692.88,-1054 5702.88,-1057.5 5702.88,-1050.5"/>
</g>
<!-- agg0_gpu14 -->
<g id="node36" class="node">
<title>agg0_gpu14</title>
<ellipse fill="none" stroke="black" cx="6289.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="6289.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg0_gpu14</text>
</g>
<!-- agg0_gpu14&#45;&gt;moe_agg0 -->
<g id="edge42" class="edge">
<title>agg0_gpu14&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M6260.06,-1166.09C6260.06,-1130.37 6260.06,-1048 6260.06,-1048 6260.06,-1048 5670.13,-1048 5670.13,-1048"/>
<polygon fill="black" stroke="black" points="5670.13,-1044.5 5660.13,-1048 5670.12,-1051.5 5670.13,-1044.5"/>
</g>
<!-- agg0_gpu15 -->
<g id="node37" class="node">
<title>agg0_gpu15</title>
<ellipse fill="none" stroke="black" cx="6442.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="6442.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg0_gpu15</text>
</g>
<!-- agg0_gpu15&#45;&gt;moe_agg0 -->
<g id="edge43" class="edge">
<title>agg0_gpu15&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M6442.85,-1164.08C6442.85,-1126.32 6442.85,-1043 6442.85,-1043 6442.85,-1043 5630.29,-1043 5630.29,-1043"/>
<polygon fill="black" stroke="black" points="5630.29,-1039.5 5620.29,-1043 5630.29,-1046.5 5630.29,-1039.5"/>
</g>
<!-- mha7 -->
<g id="node39" class="node">
<title>mha7</title>
<polygon fill="lightcyan" stroke="black" points="12158.85,-1789.72 11700.85,-1789.72 11700.85,-1721.72 12158.85,-1721.72 12158.85,-1789.72"/>
<text text-anchor="middle" x="11929.85" y="-1774.52" font-family="Times,serif" font-size="14.00">MHA Layer 7</text>
<text text-anchor="middle" x="11929.85" y="-1759.52" font-family="Times,serif" font-size="14.00">TP=8 across 8 GPUs</text>
<text text-anchor="middle" x="11929.85" y="-1744.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11929.85" y="-1729.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_7 -->
<g id="node41" class="node">
<title>add1_7</title>
<polygon fill="yellow" stroke="black" points="12158.85,-1684.72 11700.85,-1684.72 11700.85,-1616.72 12158.85,-1616.72 12158.85,-1684.72"/>
<text text-anchor="middle" x="11929.85" y="-1669.52" font-family="Times,serif" font-size="14.00">MHA Residual Add 7</text>
<text text-anchor="middle" x="11929.85" y="-1654.52" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11929.85" y="-1639.52" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11929.85" y="-1624.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha7&#45;&gt;add1_7 -->
<g id="edge47" class="edge">
<title>mha7&#45;&gt;add1_7</title>
<path fill="none" stroke="black" d="M11929.85,-1721.63C11929.85,-1721.63 11929.85,-1695 11929.85,-1695"/>
<polygon fill="black" stroke="black" points="11933.36,-1695 11929.85,-1685 11926.36,-1695 11933.36,-1695"/>
</g>
<!-- moe6 -->
<g id="node40" class="node">
<title>moe6</title>
<ellipse fill="none" stroke="black" cx="11929.85" cy="-1845.72" rx="36.29" ry="18"/>
<text text-anchor="middle" x="11929.85" y="-1842.02" font-family="Times,serif" font-size="14.00">moe6</text>
</g>
<!-- moe6&#45;&gt;mha7 -->
<g id="edge46" class="edge">
<title>moe6&#45;&gt;mha7</title>
<path fill="none" stroke="black" d="M11929.85,-1827.51C11929.85,-1827.51 11929.85,-1799.93 11929.85,-1799.93"/>
<polygon fill="black" stroke="black" points="11933.36,-1799.93 11929.85,-1789.93 11926.36,-1799.93 11933.36,-1799.93"/>
</g>
<!-- gate7 -->
<g id="node42" class="node">
<title>gate7</title>
<polygon fill="lightgreen" stroke="black" points="11221.43,-1579.72 10479.21,-1579.72 10288.28,-1473.72 11030.5,-1473.72 11221.43,-1579.72"/>
<text text-anchor="middle" x="10754.85" y="-1538.02" font-family="Times,serif" font-size="14.00">Gate Layer 7</text>
<text text-anchor="middle" x="10754.85" y="-1523.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10754.85" y="-1508.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
</g>
<!-- add1_7&#45;&gt;gate7 -->
<g id="edge48" class="edge">
<title>add1_7&#45;&gt;gate7</title>
<path fill="none" stroke="black" d="M11714.04,-1616.46C11714.04,-1577.43 11714.04,-1519 11714.04,-1519 11714.04,-1519 11122.36,-1519 11122.36,-1519"/>
<polygon fill="black" stroke="black" points="11122.36,-1515.5 11112.36,-1519 11122.36,-1522.5 11122.36,-1515.5"/>
</g>
<!-- moe7 -->
<g id="node76" class="node">
<title>moe7</title>
<polygon fill="yellow" stroke="black" points="12074.85,-995.86 11616.85,-995.86 11616.85,-927.86 12074.85,-927.86 12074.85,-995.86"/>
<text text-anchor="middle" x="11845.85" y="-980.66" font-family="Times,serif" font-size="14.00">MoE Residual Add 7</text>
<text text-anchor="middle" x="11845.85" y="-965.66" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11845.85" y="-950.66" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11845.85" y="-935.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_7&#45;&gt;moe7 -->
<g id="edge90" class="edge">
<title>add1_7&#45;&gt;moe7</title>
<path fill="none" stroke="black" d="M11735.97,-1616.46C11735.97,-1526.42 11735.97,-1290 11735.97,-1290 11735.97,-1290 11755.24,-1290 11755.24,-1290 11755.24,-1290 11755.24,-1006.05 11755.24,-1006.05"/>
<polygon fill="black" stroke="black" points="11758.74,-1006.05 11755.24,-996.05 11751.74,-1006.05 11758.74,-1006.05"/>
</g>
<!-- route7_gpu0 -->
<g id="node43" class="node">
<title>route7_gpu0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8128.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="8128.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 0</text>
<text text-anchor="middle" x="8128.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8128.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_gpu0 -->
<g id="edge49" class="edge">
<title>gate7&#45;&gt;route7_gpu0</title>
<path fill="none" stroke="black" d="M10423.6,-1549C9717.64,-1549 8128.85,-1549 8128.85,-1549 8128.85,-1549 8128.85,-1447.03 8128.85,-1447.03"/>
<polygon fill="black" stroke="black" points="8132.36,-1447.03 8128.85,-1437.03 8125.36,-1447.03 8132.36,-1447.03"/>
</g>
<!-- route7_gpu1 -->
<g id="node46" class="node">
<title>route7_gpu1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8778.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="8778.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 1</text>
<text text-anchor="middle" x="8778.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8778.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_gpu1 -->
<g id="edge52" class="edge">
<title>gate7&#45;&gt;route7_gpu1</title>
<path fill="none" stroke="black" d="M10396.73,-1534C9827.24,-1534 8778.85,-1534 8778.85,-1534 8778.85,-1534 8778.85,-1446.78 8778.85,-1446.78"/>
<polygon fill="black" stroke="black" points="8782.36,-1446.78 8778.85,-1436.78 8775.36,-1446.78 8782.36,-1446.78"/>
</g>
<!-- route7_gpu2 -->
<g id="node49" class="node">
<title>route7_gpu2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="9444.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="9444.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 2</text>
<text text-anchor="middle" x="9444.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="9444.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_gpu2 -->
<g id="edge55" class="edge">
<title>gate7&#45;&gt;route7_gpu2</title>
<path fill="none" stroke="black" d="M10342.61,-1504C9958.57,-1504 9444.85,-1504 9444.85,-1504 9444.85,-1504 9444.85,-1446.77 9444.85,-1446.77"/>
<polygon fill="black" stroke="black" points="9448.36,-1446.77 9444.85,-1436.77 9441.36,-1446.77 9448.36,-1446.77"/>
</g>
<!-- route7_gpu3 -->
<g id="node52" class="node">
<title>route7_gpu3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="10101.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="10101.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 3</text>
<text text-anchor="middle" x="10101.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10101.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_gpu3 -->
<g id="edge58" class="edge">
<title>gate7&#45;&gt;route7_gpu3</title>
<path fill="none" stroke="black" d="M10352.77,-1473.4C10352.77,-1473.4 10352.77,-1432.23 10352.77,-1432.23"/>
<polygon fill="black" stroke="black" points="10356.27,-1432.23 10352.77,-1422.23 10349.27,-1432.23 10356.27,-1432.23"/>
</g>
<!-- route7_gpu4 -->
<g id="node55" class="node">
<title>route7_gpu4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="10754.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="10754.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 4</text>
<text text-anchor="middle" x="10754.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10754.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_gpu4 -->
<g id="edge61" class="edge">
<title>gate7&#45;&gt;route7_gpu4</title>
<path fill="none" stroke="black" d="M10754.85,-1473.4C10754.85,-1473.4 10754.85,-1446.85 10754.85,-1446.85"/>
<polygon fill="black" stroke="black" points="10758.36,-1446.85 10754.85,-1436.85 10751.36,-1446.85 10758.36,-1446.85"/>
</g>
<!-- route7_gpu5 -->
<g id="node58" class="node">
<title>route7_gpu5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="11411.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="11411.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 5</text>
<text text-anchor="middle" x="11411.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11411.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_gpu5 -->
<g id="edge64" class="edge">
<title>gate7&#45;&gt;route7_gpu5</title>
<path fill="none" stroke="black" d="M11158.94,-1526.63C11158.94,-1526.63 11158.94,-1431.69 11158.94,-1431.69"/>
<polygon fill="black" stroke="black" points="11162.44,-1431.69 11158.94,-1421.69 11155.44,-1431.69 11162.44,-1431.69"/>
</g>
<!-- route7_gpu6 -->
<g id="node61" class="node">
<title>route7_gpu6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="12062.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="12062.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 6</text>
<text text-anchor="middle" x="12062.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="12062.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_gpu6 -->
<g id="edge67" class="edge">
<title>gate7&#45;&gt;route7_gpu6</title>
<path fill="none" stroke="black" d="M11056.47,-1488C11411.44,-1488 11953.17,-1488 11953.17,-1488 11953.17,-1488 11953.17,-1444.58 11953.17,-1444.58"/>
<polygon fill="black" stroke="black" points="11956.67,-1444.58 11953.17,-1434.58 11949.67,-1444.58 11956.67,-1444.58"/>
</g>
<!-- route7_gpu7 -->
<g id="node64" class="node">
<title>route7_gpu7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="12720.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="12720.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 7</text>
<text text-anchor="middle" x="12720.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="12720.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_gpu7 -->
<g id="edge70" class="edge">
<title>gate7&#45;&gt;route7_gpu7</title>
<path fill="none" stroke="black" d="M11085.3,-1504C11645.37,-1504 12720.85,-1504 12720.85,-1504 12720.85,-1504 12720.85,-1446.77 12720.85,-1446.77"/>
<polygon fill="black" stroke="black" points="12724.36,-1446.77 12720.85,-1436.77 12717.36,-1446.77 12724.36,-1446.77"/>
</g>
<!-- experts_gpu0_layer7 -->
<g id="node44" class="node">
<title>experts_gpu0_layer7</title>
<polygon fill="lightcoral" stroke="black" points="8261.85,-1324.77 7923.85,-1324.77 7923.85,-1256.77 8261.85,-1256.77 8261.85,-1324.77"/>
<text text-anchor="middle" x="8092.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 0</text>
<text text-anchor="middle" x="8092.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8092.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8092.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route7_gpu0&#45;&gt;experts_gpu0_layer7 -->
<g id="edge50" class="edge">
<title>route7_gpu0&#45;&gt;experts_gpu0_layer7</title>
<path fill="none" stroke="black" d="M8092.85,-1361.91C8092.85,-1361.91 8092.85,-1334.89 8092.85,-1334.89"/>
<polygon fill="black" stroke="black" points="8096.36,-1334.89 8092.85,-1324.89 8089.36,-1334.89 8096.36,-1334.89"/>
</g>
<!-- agg7_gpu0 -->
<g id="node45" class="node">
<title>agg7_gpu0</title>
<ellipse fill="lightpink" stroke="black" cx="8090.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="8090.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 0</text>
<text text-anchor="middle" x="8090.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8090.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu0_layer7&#45;&gt;agg7_gpu0 -->
<g id="edge51" class="edge">
<title>experts_gpu0_layer7&#45;&gt;agg7_gpu0</title>
<path fill="none" stroke="black" d="M8092.85,-1256.74C8092.85,-1256.74 8092.85,-1229.97 8092.85,-1229.97"/>
<polygon fill="black" stroke="black" points="8096.36,-1229.97 8092.85,-1219.97 8089.36,-1229.97 8096.36,-1229.97"/>
</g>
<!-- moe_agg7 -->
<g id="node67" class="node">
<title>moe_agg7</title>
<ellipse fill="gold" stroke="black" cx="8090.85" cy="-1070.34" rx="336.67" ry="37.45"/>
<text text-anchor="middle" x="8090.85" y="-1081.64" font-family="Times,serif" font-size="14.00">MoE Final Aggregation 7</text>
<text text-anchor="middle" x="8090.85" y="-1066.64" font-family="Times,serif" font-size="14.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8090.85" y="-1051.64" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- agg7_gpu0&#45;&gt;moe_agg7 -->
<g id="edge73" class="edge">
<title>agg7_gpu0&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M8090.85,-1144.7C8090.85,-1144.7 8090.85,-1118.02 8090.85,-1118.02"/>
<polygon fill="black" stroke="black" points="8094.36,-1118.02 8090.85,-1108.02 8087.36,-1118.02 8094.36,-1118.02"/>
</g>
<!-- experts_gpu1_layer7 -->
<g id="node47" class="node">
<title>experts_gpu1_layer7</title>
<polygon fill="lightcoral" stroke="black" points="8939.85,-1324.77 8601.85,-1324.77 8601.85,-1256.77 8939.85,-1256.77 8939.85,-1324.77"/>
<text text-anchor="middle" x="8770.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 1</text>
<text text-anchor="middle" x="8770.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8770.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8770.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route7_gpu1&#45;&gt;experts_gpu1_layer7 -->
<g id="edge53" class="edge">
<title>route7_gpu1&#45;&gt;experts_gpu1_layer7</title>
<path fill="none" stroke="black" d="M8770.85,-1361.61C8770.85,-1361.61 8770.85,-1335.06 8770.85,-1335.06"/>
<polygon fill="black" stroke="black" points="8774.36,-1335.06 8770.85,-1325.06 8767.36,-1335.06 8774.36,-1335.06"/>
</g>
<!-- agg7_gpu1 -->
<g id="node48" class="node">
<title>agg7_gpu1</title>
<ellipse fill="lightpink" stroke="black" cx="8756.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="8756.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 1</text>
<text text-anchor="middle" x="8756.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8756.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu1_layer7&#45;&gt;agg7_gpu1 -->
<g id="edge54" class="edge">
<title>experts_gpu1_layer7&#45;&gt;agg7_gpu1</title>
<path fill="none" stroke="black" d="M8770.85,-1256.74C8770.85,-1256.74 8770.85,-1229.97 8770.85,-1229.97"/>
<polygon fill="black" stroke="black" points="8774.36,-1229.97 8770.85,-1219.97 8767.36,-1229.97 8774.36,-1229.97"/>
</g>
<!-- agg7_gpu1&#45;&gt;moe_agg7 -->
<g id="edge74" class="edge">
<title>agg7_gpu1&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M8432.63,-1182C8425.24,-1182 8421.07,-1182 8421.07,-1182 8421.07,-1182 8421.07,-1087.66 8421.07,-1087.66"/>
<polygon fill="black" stroke="black" points="8424.57,-1087.66 8421.07,-1077.66 8417.57,-1087.66 8424.57,-1087.66"/>
</g>
<!-- experts_gpu2_layer7 -->
<g id="node50" class="node">
<title>experts_gpu2_layer7</title>
<polygon fill="lightcoral" stroke="black" points="9607.85,-1324.77 9269.85,-1324.77 9269.85,-1256.77 9607.85,-1256.77 9607.85,-1324.77"/>
<text text-anchor="middle" x="9438.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 2</text>
<text text-anchor="middle" x="9438.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="9438.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="9438.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route7_gpu2&#45;&gt;experts_gpu2_layer7 -->
<g id="edge56" class="edge">
<title>route7_gpu2&#45;&gt;experts_gpu2_layer7</title>
<path fill="none" stroke="black" d="M9438.85,-1361.61C9438.85,-1361.61 9438.85,-1335.06 9438.85,-1335.06"/>
<polygon fill="black" stroke="black" points="9442.36,-1335.06 9438.85,-1325.06 9435.36,-1335.06 9442.36,-1335.06"/>
</g>
<!-- agg7_gpu2 -->
<g id="node51" class="node">
<title>agg7_gpu2</title>
<ellipse fill="lightpink" stroke="black" cx="9422.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="9422.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 2</text>
<text text-anchor="middle" x="9422.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="9422.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu2_layer7&#45;&gt;agg7_gpu2 -->
<g id="edge57" class="edge">
<title>experts_gpu2_layer7&#45;&gt;agg7_gpu2</title>
<path fill="none" stroke="black" d="M9438.85,-1256.74C9438.85,-1256.74 9438.85,-1229.97 9438.85,-1229.97"/>
<polygon fill="black" stroke="black" points="9442.36,-1229.97 9438.85,-1219.97 9435.36,-1229.97 9442.36,-1229.97"/>
</g>
<!-- agg7_gpu2&#45;&gt;moe_agg7 -->
<g id="edge75" class="edge">
<title>agg7_gpu2&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M9295.07,-1147.77C9295.07,-1126.01 9295.07,-1102 9295.07,-1102 9295.07,-1102 8281.14,-1102 8281.14,-1102"/>
<polygon fill="black" stroke="black" points="8281.14,-1098.5 8271.14,-1102 8281.14,-1105.5 8281.14,-1098.5"/>
</g>
<!-- experts_gpu3_layer7 -->
<g id="node53" class="node">
<title>experts_gpu3_layer7</title>
<polygon fill="lightcoral" stroke="black" points="10266.85,-1324.77 9928.85,-1324.77 9928.85,-1256.77 10266.85,-1256.77 10266.85,-1324.77"/>
<text text-anchor="middle" x="10097.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 3</text>
<text text-anchor="middle" x="10097.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10097.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10097.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route7_gpu3&#45;&gt;experts_gpu3_layer7 -->
<g id="edge59" class="edge">
<title>route7_gpu3&#45;&gt;experts_gpu3_layer7</title>
<path fill="none" stroke="black" d="M10097.85,-1361.61C10097.85,-1361.61 10097.85,-1335.06 10097.85,-1335.06"/>
<polygon fill="black" stroke="black" points="10101.36,-1335.06 10097.85,-1325.06 10094.36,-1335.06 10101.36,-1335.06"/>
</g>
<!-- agg7_gpu3 -->
<g id="node54" class="node">
<title>agg7_gpu3</title>
<ellipse fill="lightpink" stroke="black" cx="10088.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="10088.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 3</text>
<text text-anchor="middle" x="10088.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10088.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu3_layer7&#45;&gt;agg7_gpu3 -->
<g id="edge60" class="edge">
<title>experts_gpu3_layer7&#45;&gt;agg7_gpu3</title>
<path fill="none" stroke="black" d="M10097.85,-1256.74C10097.85,-1256.74 10097.85,-1229.97 10097.85,-1229.97"/>
<polygon fill="black" stroke="black" points="10101.36,-1229.97 10097.85,-1219.97 10094.36,-1229.97 10101.36,-1229.97"/>
</g>
<!-- agg7_gpu3&#45;&gt;moe_agg7 -->
<g id="edge76" class="edge">
<title>agg7_gpu3&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M9985.16,-1146.61C9985.16,-1123.24 9985.16,-1097 9985.16,-1097 9985.16,-1097 8337.42,-1097 8337.42,-1097"/>
<polygon fill="black" stroke="black" points="8337.42,-1093.5 8327.42,-1097 8337.42,-1100.5 8337.42,-1093.5"/>
</g>
<!-- experts_gpu4_layer7 -->
<g id="node56" class="node">
<title>experts_gpu4_layer7</title>
<polygon fill="lightcoral" stroke="black" points="10923.85,-1324.77 10585.85,-1324.77 10585.85,-1256.77 10923.85,-1256.77 10923.85,-1324.77"/>
<text text-anchor="middle" x="10754.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 4</text>
<text text-anchor="middle" x="10754.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10754.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10754.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route7_gpu4&#45;&gt;experts_gpu4_layer7 -->
<g id="edge62" class="edge">
<title>route7_gpu4&#45;&gt;experts_gpu4_layer7</title>
<path fill="none" stroke="black" d="M10754.85,-1361.61C10754.85,-1361.61 10754.85,-1335.06 10754.85,-1335.06"/>
<polygon fill="black" stroke="black" points="10758.36,-1335.06 10754.85,-1325.06 10751.36,-1335.06 10758.36,-1335.06"/>
</g>
<!-- agg7_gpu4 -->
<g id="node57" class="node">
<title>agg7_gpu4</title>
<ellipse fill="lightpink" stroke="black" cx="10754.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="10754.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 4</text>
<text text-anchor="middle" x="10754.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10754.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu4_layer7&#45;&gt;agg7_gpu4 -->
<g id="edge63" class="edge">
<title>experts_gpu4_layer7&#45;&gt;agg7_gpu4</title>
<path fill="none" stroke="black" d="M10754.85,-1256.74C10754.85,-1256.74 10754.85,-1229.97 10754.85,-1229.97"/>
<polygon fill="black" stroke="black" points="10758.36,-1229.97 10754.85,-1219.97 10751.36,-1229.97 10758.36,-1229.97"/>
</g>
<!-- agg7_gpu4&#45;&gt;moe_agg7 -->
<g id="edge77" class="edge">
<title>agg7_gpu4&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M10754.85,-1144.63C10754.85,-1119.48 10754.85,-1091 10754.85,-1091 10754.85,-1091 8381.86,-1091 8381.86,-1091"/>
<polygon fill="black" stroke="black" points="8381.86,-1087.5 8371.86,-1091 8381.86,-1094.5 8381.86,-1087.5"/>
</g>
<!-- experts_gpu5_layer7 -->
<g id="node59" class="node">
<title>experts_gpu5_layer7</title>
<polygon fill="lightcoral" stroke="black" points="11585.85,-1324.77 11247.85,-1324.77 11247.85,-1256.77 11585.85,-1256.77 11585.85,-1324.77"/>
<text text-anchor="middle" x="11416.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 5</text>
<text text-anchor="middle" x="11416.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="11416.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="11416.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route7_gpu5&#45;&gt;experts_gpu5_layer7 -->
<g id="edge65" class="edge">
<title>route7_gpu5&#45;&gt;experts_gpu5_layer7</title>
<path fill="none" stroke="black" d="M11416.85,-1361.61C11416.85,-1361.61 11416.85,-1335.06 11416.85,-1335.06"/>
<polygon fill="black" stroke="black" points="11420.36,-1335.06 11416.85,-1325.06 11413.36,-1335.06 11420.36,-1335.06"/>
</g>
<!-- agg7_gpu5 -->
<g id="node60" class="node">
<title>agg7_gpu5</title>
<ellipse fill="lightpink" stroke="black" cx="11420.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="11420.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 5</text>
<text text-anchor="middle" x="11420.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="11420.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu5_layer7&#45;&gt;agg7_gpu5 -->
<g id="edge66" class="edge">
<title>experts_gpu5_layer7&#45;&gt;agg7_gpu5</title>
<path fill="none" stroke="black" d="M11416.85,-1256.74C11416.85,-1256.74 11416.85,-1229.97 11416.85,-1229.97"/>
<polygon fill="black" stroke="black" points="11420.36,-1229.97 11416.85,-1219.97 11413.36,-1229.97 11420.36,-1229.97"/>
</g>
<!-- agg7_gpu5&#45;&gt;moe_agg7 -->
<g id="edge78" class="edge">
<title>agg7_gpu5&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M11110.8,-1171.24C11110.8,-1145.95 11110.8,-1086 11110.8,-1086 11110.8,-1086 8406.69,-1086 8406.69,-1086"/>
<polygon fill="black" stroke="black" points="8406.69,-1082.5 8396.69,-1086 8406.69,-1089.5 8406.69,-1082.5"/>
</g>
<!-- experts_gpu6_layer7 -->
<g id="node62" class="node">
<title>experts_gpu6_layer7</title>
<polygon fill="lightcoral" stroke="black" points="12240.85,-1324.77 11902.85,-1324.77 11902.85,-1256.77 12240.85,-1256.77 12240.85,-1324.77"/>
<text text-anchor="middle" x="12071.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 6</text>
<text text-anchor="middle" x="12071.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="12071.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="12071.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route7_gpu6&#45;&gt;experts_gpu6_layer7 -->
<g id="edge68" class="edge">
<title>route7_gpu6&#45;&gt;experts_gpu6_layer7</title>
<path fill="none" stroke="black" d="M12071.85,-1361.61C12071.85,-1361.61 12071.85,-1335.06 12071.85,-1335.06"/>
<polygon fill="black" stroke="black" points="12075.36,-1335.06 12071.85,-1325.06 12068.36,-1335.06 12075.36,-1335.06"/>
</g>
<!-- agg7_gpu6 -->
<g id="node63" class="node">
<title>agg7_gpu6</title>
<ellipse fill="lightpink" stroke="black" cx="12086.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="12086.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 6</text>
<text text-anchor="middle" x="12086.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="12086.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu6_layer7&#45;&gt;agg7_gpu6 -->
<g id="edge69" class="edge">
<title>experts_gpu6_layer7&#45;&gt;agg7_gpu6</title>
<path fill="none" stroke="black" d="M12071.85,-1256.74C12071.85,-1256.74 12071.85,-1229.97 12071.85,-1229.97"/>
<polygon fill="black" stroke="black" points="12075.36,-1229.97 12071.85,-1219.97 12068.36,-1229.97 12075.36,-1229.97"/>
</g>
<!-- agg7_gpu6&#45;&gt;moe_agg7 -->
<g id="edge79" class="edge">
<title>agg7_gpu6&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M11918.93,-1150.24C11918.93,-1120.57 11918.93,-1081 11918.93,-1081 11918.93,-1081 8423.94,-1081 8423.94,-1081"/>
<polygon fill="black" stroke="black" points="8423.94,-1077.5 8413.94,-1081 8423.94,-1084.5 8423.94,-1077.5"/>
</g>
<!-- experts_gpu7_layer7 -->
<g id="node65" class="node">
<title>experts_gpu7_layer7</title>
<polygon fill="lightcoral" stroke="black" points="12900.85,-1324.77 12562.85,-1324.77 12562.85,-1256.77 12900.85,-1256.77 12900.85,-1324.77"/>
<text text-anchor="middle" x="12731.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 7</text>
<text text-anchor="middle" x="12731.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="12731.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="12731.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route7_gpu7&#45;&gt;experts_gpu7_layer7 -->
<g id="edge71" class="edge">
<title>route7_gpu7&#45;&gt;experts_gpu7_layer7</title>
<path fill="none" stroke="black" d="M12731.85,-1361.61C12731.85,-1361.61 12731.85,-1335.06 12731.85,-1335.06"/>
<polygon fill="black" stroke="black" points="12735.36,-1335.06 12731.85,-1325.06 12728.36,-1335.06 12735.36,-1335.06"/>
</g>
<!-- agg7_gpu7 -->
<g id="node66" class="node">
<title>agg7_gpu7</title>
<ellipse fill="lightpink" stroke="black" cx="12752.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="12752.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 7</text>
<text text-anchor="middle" x="12752.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="12752.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu7_layer7&#45;&gt;agg7_gpu7 -->
<g id="edge72" class="edge">
<title>experts_gpu7_layer7&#45;&gt;agg7_gpu7</title>
<path fill="none" stroke="black" d="M12731.85,-1256.74C12731.85,-1256.74 12731.85,-1229.97 12731.85,-1229.97"/>
<polygon fill="black" stroke="black" points="12735.36,-1229.97 12731.85,-1219.97 12728.36,-1229.97 12735.36,-1229.97"/>
</g>
<!-- agg7_gpu7&#45;&gt;moe_agg7 -->
<g id="edge80" class="edge">
<title>agg7_gpu7&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M12686.11,-1145.37C12686.11,-1114.33 12686.11,-1075 12686.11,-1075 12686.11,-1075 8435.04,-1075 8435.04,-1075"/>
<polygon fill="black" stroke="black" points="8435.04,-1071.5 8425.04,-1075 8435.04,-1078.5 8435.04,-1071.5"/>
</g>
<!-- moe_agg7&#45;&gt;moe7 -->
<g id="edge89" class="edge">
<title>moe_agg7&#45;&gt;moe7</title>
<path fill="none" stroke="black" d="M8416.46,-1060.63C8416.46,-1033.87 8416.46,-961 8416.46,-961 8416.46,-961 11606.85,-961 11606.85,-961"/>
<polygon fill="black" stroke="black" points="11606.85,-964.5 11616.85,-961 11606.85,-957.5 11606.85,-964.5"/>
</g>
<!-- agg7_gpu8 -->
<g id="node68" class="node">
<title>agg7_gpu8</title>
<ellipse fill="none" stroke="black" cx="6628.85" cy="-1182.29" rx="61.99" ry="18"/>
<text text-anchor="middle" x="6628.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg7_gpu8</text>
</g>
<!-- agg7_gpu8&#45;&gt;moe_agg7 -->
<g id="edge81" class="edge">
<title>agg7_gpu8&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M6628.85,-1164.25C6628.85,-1132.51 6628.85,-1070 6628.85,-1070 6628.85,-1070 7744.07,-1070 7744.07,-1070"/>
<polygon fill="black" stroke="black" points="7744.07,-1073.5 7754.07,-1070 7744.07,-1066.5 7744.07,-1073.5"/>
</g>
<!-- agg7_gpu9 -->
<g id="node69" class="node">
<title>agg7_gpu9</title>
<ellipse fill="none" stroke="black" cx="6769.85" cy="-1182.29" rx="61.99" ry="18"/>
<text text-anchor="middle" x="6769.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg7_gpu9</text>
</g>
<!-- agg7_gpu9&#45;&gt;moe_agg7 -->
<g id="edge82" class="edge">
<title>agg7_gpu9&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M6825.6,-1174.23C6825.6,-1149.27 6825.6,-1075 6825.6,-1075 6825.6,-1075 7746.77,-1075 7746.77,-1075"/>
<polygon fill="black" stroke="black" points="7746.77,-1078.5 7756.77,-1075 7746.77,-1071.5 7746.77,-1078.5"/>
</g>
<!-- agg7_gpu10 -->
<g id="node70" class="node">
<title>agg7_gpu10</title>
<ellipse fill="none" stroke="black" cx="6916.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="6916.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg7_gpu10</text>
</g>
<!-- agg7_gpu10&#45;&gt;moe_agg7 -->
<g id="edge83" class="edge">
<title>agg7_gpu10&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M6969.35,-1170.67C6969.35,-1144.07 6969.35,-1081 6969.35,-1081 6969.35,-1081 7757.98,-1081 7757.98,-1081"/>
<polygon fill="black" stroke="black" points="7757.98,-1084.5 7767.98,-1081 7757.98,-1077.5 7757.98,-1084.5"/>
</g>
<!-- agg7_gpu11 -->
<g id="node71" class="node">
<title>agg7_gpu11</title>
<ellipse fill="none" stroke="black" cx="7069.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="7069.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg7_gpu11</text>
</g>
<!-- agg7_gpu11&#45;&gt;moe_agg7 -->
<g id="edge84" class="edge">
<title>agg7_gpu11&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M7128.28,-1173.06C7128.28,-1148.96 7128.28,-1086 7128.28,-1086 7128.28,-1086 7774.97,-1086 7774.97,-1086"/>
<polygon fill="black" stroke="black" points="7774.97,-1089.5 7784.97,-1086 7774.97,-1082.5 7774.97,-1089.5"/>
</g>
<!-- agg7_gpu12 -->
<g id="node72" class="node">
<title>agg7_gpu12</title>
<ellipse fill="none" stroke="black" cx="7222.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="7222.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg7_gpu12</text>
</g>
<!-- agg7_gpu12&#45;&gt;moe_agg7 -->
<g id="edge85" class="edge">
<title>agg7_gpu12&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M7275.28,-1170.73C7275.28,-1146.16 7275.28,-1091 7275.28,-1091 7275.28,-1091 7799.89,-1091 7799.89,-1091"/>
<polygon fill="black" stroke="black" points="7799.89,-1094.5 7809.89,-1091 7799.89,-1087.5 7799.89,-1094.5"/>
</g>
<!-- agg7_gpu13 -->
<g id="node73" class="node">
<title>agg7_gpu13</title>
<ellipse fill="none" stroke="black" cx="7375.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="7375.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg7_gpu13</text>
</g>
<!-- agg7_gpu13&#45;&gt;moe_agg7 -->
<g id="edge86" class="edge">
<title>agg7_gpu13&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M7422.28,-1168.96C7422.28,-1144.98 7422.28,-1097 7422.28,-1097 7422.28,-1097 7844.2,-1097 7844.2,-1097"/>
<polygon fill="black" stroke="black" points="7844.2,-1100.5 7854.2,-1097 7844.2,-1093.5 7844.2,-1100.5"/>
</g>
<!-- agg7_gpu14 -->
<g id="node74" class="node">
<title>agg7_gpu14</title>
<ellipse fill="none" stroke="black" cx="7528.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="7528.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg7_gpu14</text>
</g>
<!-- agg7_gpu14&#45;&gt;moe_agg7 -->
<g id="edge87" class="edge">
<title>agg7_gpu14&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M7569.28,-1167.56C7569.28,-1144.38 7569.28,-1102 7569.28,-1102 7569.28,-1102 7900.63,-1102 7900.63,-1102"/>
<polygon fill="black" stroke="black" points="7900.63,-1105.5 7910.63,-1102 7900.63,-1098.5 7900.63,-1105.5"/>
</g>
<!-- agg7_gpu15 -->
<g id="node75" class="node">
<title>agg7_gpu15</title>
<ellipse fill="none" stroke="black" cx="7681.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="7681.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg7_gpu15</text>
</g>
<!-- agg7_gpu15&#45;&gt;moe_agg7 -->
<g id="edge88" class="edge">
<title>agg7_gpu15&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M7749.68,-1182C7756.31,-1182 7760.64,-1182 7760.64,-1182 7760.64,-1182 7760.64,-1087.66 7760.64,-1087.66"/>
<polygon fill="black" stroke="black" points="7764.14,-1087.66 7760.64,-1077.66 7757.14,-1087.66 7764.14,-1087.66"/>
</g>
<!-- mha8 -->
<g id="node77" class="node">
<title>mha8</title>
<polygon fill="lightcyan" stroke="black" points="12075.85,-861.86 11617.85,-861.86 11617.85,-793.86 12075.85,-793.86 12075.85,-861.86"/>
<text text-anchor="middle" x="11846.85" y="-846.66" font-family="Times,serif" font-size="14.00">MHA Layer 8</text>
<text text-anchor="middle" x="11846.85" y="-831.66" font-family="Times,serif" font-size="14.00">TP=8 across 8 GPUs</text>
<text text-anchor="middle" x="11846.85" y="-816.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11846.85" y="-801.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- moe7&#45;&gt;mha8 -->
<g id="edge91" class="edge">
<title>moe7&#45;&gt;mha8</title>
<path fill="none" stroke="black" d="M11770.19,-927.7C11770.19,-927.7 11770.19,-871.96 11770.19,-871.96"/>
<polygon fill="black" stroke="black" points="11773.69,-871.96 11770.19,-861.96 11766.69,-871.96 11773.69,-871.96"/>
</g>
<!-- moe7&#45;&gt;mha8 -->
<g id="edge181" class="edge">
<title>moe7&#45;&gt;mha8</title>
<path fill="none" stroke="black" d="M11922.52,-927.7C11922.52,-927.7 11922.52,-871.96 11922.52,-871.96"/>
<polygon fill="black" stroke="black" points="11926.02,-871.96 11922.52,-861.96 11919.02,-871.96 11926.02,-871.96"/>
<text text-anchor="middle" x="11950.35" y="-898.66" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="11950.35" y="-883.66" font-family="Times,serif" font-size="14.00">Stage 0 â†’ Stage 1</text>
</g>
<!-- add1_8 -->
<g id="node78" class="node">
<title>add1_8</title>
<polygon fill="yellow" stroke="black" points="12075.85,-756.86 11617.85,-756.86 11617.85,-688.86 12075.85,-688.86 12075.85,-756.86"/>
<text text-anchor="middle" x="11846.85" y="-741.66" font-family="Times,serif" font-size="14.00">MHA Residual Add 8</text>
<text text-anchor="middle" x="11846.85" y="-726.66" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11846.85" y="-711.66" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11846.85" y="-696.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha8&#45;&gt;add1_8 -->
<g id="edge92" class="edge">
<title>mha8&#45;&gt;add1_8</title>
<path fill="none" stroke="black" d="M11846.85,-793.77C11846.85,-793.77 11846.85,-767.14 11846.85,-767.14"/>
<polygon fill="black" stroke="black" points="11850.36,-767.14 11846.85,-757.14 11843.36,-767.14 11850.36,-767.14"/>
</g>
<!-- gate8 -->
<g id="node79" class="node">
<title>gate8</title>
<polygon fill="lightgreen" stroke="black" points="11138.43,-651.86 10396.21,-651.86 10205.28,-545.86 10947.5,-545.86 11138.43,-651.86"/>
<text text-anchor="middle" x="10671.85" y="-610.16" font-family="Times,serif" font-size="14.00">Gate Layer 8</text>
<text text-anchor="middle" x="10671.85" y="-595.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10671.85" y="-580.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
</g>
<!-- add1_8&#45;&gt;gate8 -->
<g id="edge93" class="edge">
<title>add1_8&#45;&gt;gate8</title>
<path fill="none" stroke="black" d="M11617.83,-722C11406.29,-722 11124.6,-722 11124.6,-722 11124.6,-722 11124.6,-608.95 11124.6,-608.95"/>
<polygon fill="black" stroke="black" points="11128.1,-608.95 11124.6,-598.95 11121.1,-608.95 11128.1,-608.95"/>
</g>
<!-- moe8 -->
<g id="node113" class="node">
<title>moe8</title>
<polygon fill="yellow" stroke="black" points="10743.85,-68 10285.85,-68 10285.85,0 10743.85,0 10743.85,-68"/>
<text text-anchor="middle" x="10514.85" y="-52.8" font-family="Times,serif" font-size="14.00">MoE Residual Add 8</text>
<text text-anchor="middle" x="10514.85" y="-37.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10514.85" y="-22.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10514.85" y="-7.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_8&#45;&gt;moe8 -->
<g id="edge135" class="edge">
<title>add1_8&#45;&gt;moe8</title>
<path fill="none" stroke="black" d="M11628.04,-688.74C11628.04,-632.63 11628.04,-527 11628.04,-527 11628.04,-527 10342.61,-527 10342.61,-527 10342.61,-527 10342.61,-78.28 10342.61,-78.28"/>
<polygon fill="black" stroke="black" points="10346.11,-78.28 10342.61,-68.28 10339.11,-78.28 10346.11,-78.28"/>
</g>
<!-- route8_gpu8 -->
<g id="node80" class="node">
<title>route8_gpu8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8070.85" cy="-471.38" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="8070.85" y="-482.68" font-family="Times,serif" font-size="14.00">Route to GPU 8</text>
<text text-anchor="middle" x="8070.85" y="-467.68" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8070.85" y="-452.68" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate8&#45;&gt;route8_gpu8 -->
<g id="edge94" class="edge">
<title>gate8&#45;&gt;route8_gpu8</title>
<path fill="none" stroke="black" d="M10347.7,-625C9650.45,-625 8070.85,-625 8070.85,-625 8070.85,-625 8070.85,-518.96 8070.85,-518.96"/>
<polygon fill="black" stroke="black" points="8074.36,-518.96 8070.85,-508.96 8067.36,-518.96 8074.36,-518.96"/>
</g>
<!-- route8_gpu9 -->
<g id="node83" class="node">
<title>route8_gpu9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8720.85" cy="-471.38" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="8720.85" y="-482.68" font-family="Times,serif" font-size="14.00">Route to GPU 9</text>
<text text-anchor="middle" x="8720.85" y="-467.68" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8720.85" y="-452.68" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate8&#45;&gt;route8_gpu9 -->
<g id="edge97" class="edge">
<title>gate8&#45;&gt;route8_gpu9</title>
<path fill="none" stroke="black" d="M10299.2,-598C9736.41,-598 8734.61,-598 8734.61,-598 8734.61,-598 8734.61,-519.03 8734.61,-519.03"/>
<polygon fill="black" stroke="black" points="8738.11,-519.03 8734.61,-509.03 8731.11,-519.03 8738.11,-519.03"/>
</g>
<!-- route8_gpu10 -->
<g id="node86" class="node">
<title>route8_gpu10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="9371.85" cy="-471.38" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="9371.85" y="-482.68" font-family="Times,serif" font-size="14.00">Route to GPU 10</text>
<text text-anchor="middle" x="9371.85" y="-467.68" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="9371.85" y="-452.68" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate8&#45;&gt;route8_gpu10 -->
<g id="edge100" class="edge">
<title>gate8&#45;&gt;route8_gpu10</title>
<path fill="none" stroke="black" d="M10252.26,-572C9912.89,-572 9491.15,-572 9491.15,-572 9491.15,-572 9491.15,-516.29 9491.15,-516.29"/>
<polygon fill="black" stroke="black" points="9494.65,-516.29 9491.15,-506.29 9487.65,-516.29 9494.65,-516.29"/>
</g>
<!-- route8_gpu11 -->
<g id="node89" class="node">
<title>route8_gpu11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="10021.85" cy="-471.38" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="10021.85" y="-482.68" font-family="Times,serif" font-size="14.00">Route to GPU 11</text>
<text text-anchor="middle" x="10021.85" y="-467.68" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10021.85" y="-452.68" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate8&#45;&gt;route8_gpu11 -->
<g id="edge103" class="edge">
<title>gate8&#45;&gt;route8_gpu11</title>
<path fill="none" stroke="black" d="M10271.27,-545.54C10271.27,-545.54 10271.27,-504.37 10271.27,-504.37"/>
<polygon fill="black" stroke="black" points="10274.77,-504.37 10271.27,-494.37 10267.77,-504.37 10274.77,-504.37"/>
</g>
<!-- route8_gpu12 -->
<g id="node92" class="node">
<title>route8_gpu12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="10671.85" cy="-471.38" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="10671.85" y="-482.68" font-family="Times,serif" font-size="14.00">Route to GPU 12</text>
<text text-anchor="middle" x="10671.85" y="-467.68" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10671.85" y="-452.68" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate8&#45;&gt;route8_gpu12 -->
<g id="edge106" class="edge">
<title>gate8&#45;&gt;route8_gpu12</title>
<path fill="none" stroke="black" d="M10671.85,-545.54C10671.85,-545.54 10671.85,-518.99 10671.85,-518.99"/>
<polygon fill="black" stroke="black" points="10675.36,-518.99 10671.85,-508.99 10668.36,-518.99 10675.36,-518.99"/>
</g>
<!-- route8_gpu13 -->
<g id="node95" class="node">
<title>route8_gpu13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="11322.85" cy="-471.38" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="11322.85" y="-482.68" font-family="Times,serif" font-size="14.00">Route to GPU 13</text>
<text text-anchor="middle" x="11322.85" y="-467.68" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11322.85" y="-452.68" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate8&#45;&gt;route8_gpu13 -->
<g id="edge109" class="edge">
<title>gate8&#45;&gt;route8_gpu13</title>
<path fill="none" stroke="black" d="M11072.94,-598.77C11072.94,-598.77 11072.94,-504.41 11072.94,-504.41"/>
<polygon fill="black" stroke="black" points="11076.44,-504.41 11072.94,-494.41 11069.44,-504.41 11076.44,-504.41"/>
</g>
<!-- route8_gpu14 -->
<g id="node98" class="node">
<title>route8_gpu14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="11973.85" cy="-471.38" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="11973.85" y="-482.68" font-family="Times,serif" font-size="14.00">Route to GPU 14</text>
<text text-anchor="middle" x="11973.85" y="-467.68" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11973.85" y="-452.68" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate8&#45;&gt;route8_gpu14 -->
<g id="edge112" class="edge">
<title>gate8&#45;&gt;route8_gpu14</title>
<path fill="none" stroke="black" d="M11011.19,-581C11364.57,-581 11867.17,-581 11867.17,-581 11867.17,-581 11867.17,-516.67 11867.17,-516.67"/>
<polygon fill="black" stroke="black" points="11870.67,-516.67 11867.17,-506.67 11863.67,-516.67 11870.67,-516.67"/>
</g>
<!-- route8_gpu15 -->
<g id="node101" class="node">
<title>route8_gpu15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="12627.85" cy="-471.38" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="12627.85" y="-482.68" font-family="Times,serif" font-size="14.00">Route to GPU 15</text>
<text text-anchor="middle" x="12627.85" y="-467.68" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="12627.85" y="-452.68" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate8&#45;&gt;route8_gpu15 -->
<g id="edge115" class="edge">
<title>gate8&#45;&gt;route8_gpu15</title>
<path fill="none" stroke="black" d="M11073.91,-616C11573.67,-616 12361.6,-616 12361.6,-616 12361.6,-616 12361.6,-501.49 12361.6,-501.49"/>
<polygon fill="black" stroke="black" points="12365.1,-501.49 12361.6,-491.49 12358.1,-501.49 12365.1,-501.49"/>
</g>
<!-- experts_gpu8_layer8 -->
<g id="node81" class="node">
<title>experts_gpu8_layer8</title>
<polygon fill="lightcoral" stroke="black" points="8188.85,-396.91 7850.85,-396.91 7850.85,-328.91 8188.85,-328.91 8188.85,-396.91"/>
<text text-anchor="middle" x="8019.85" y="-381.71" font-family="Times,serif" font-size="14.00">8 Experts GPU 8</text>
<text text-anchor="middle" x="8019.85" y="-366.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8019.85" y="-351.71" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8019.85" y="-336.71" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route8_gpu8&#45;&gt;experts_gpu8_layer8 -->
<g id="edge95" class="edge">
<title>route8_gpu8&#45;&gt;experts_gpu8_layer8</title>
<path fill="none" stroke="black" d="M8019.85,-434.36C8019.85,-434.36 8019.85,-407.21 8019.85,-407.21"/>
<polygon fill="black" stroke="black" points="8023.36,-407.21 8019.85,-397.21 8016.36,-407.21 8023.36,-407.21"/>
</g>
<!-- agg8_gpu8 -->
<g id="node82" class="node">
<title>agg8_gpu8</title>
<ellipse fill="lightpink" stroke="black" cx="8007.85" cy="-254.43" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="8007.85" y="-265.73" font-family="Times,serif" font-size="14.00">Aggregate GPU 8</text>
<text text-anchor="middle" x="8007.85" y="-250.73" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8007.85" y="-235.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu8_layer8&#45;&gt;agg8_gpu8 -->
<g id="edge96" class="edge">
<title>experts_gpu8_layer8&#45;&gt;agg8_gpu8</title>
<path fill="none" stroke="black" d="M8019.85,-328.88C8019.85,-328.88 8019.85,-302.11 8019.85,-302.11"/>
<polygon fill="black" stroke="black" points="8023.36,-302.11 8019.85,-292.11 8016.36,-302.11 8023.36,-302.11"/>
</g>
<!-- moe_agg8 -->
<g id="node104" class="node">
<title>moe_agg8</title>
<ellipse fill="gold" stroke="black" cx="8007.85" cy="-142.48" rx="336.67" ry="37.45"/>
<text text-anchor="middle" x="8007.85" y="-153.78" font-family="Times,serif" font-size="14.00">MoE Final Aggregation 8</text>
<text text-anchor="middle" x="8007.85" y="-138.78" font-family="Times,serif" font-size="14.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8007.85" y="-123.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- agg8_gpu8&#45;&gt;moe_agg8 -->
<g id="edge126" class="edge">
<title>agg8_gpu8&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M8007.85,-216.84C8007.85,-216.84 8007.85,-190.16 8007.85,-190.16"/>
<polygon fill="black" stroke="black" points="8011.36,-190.16 8007.85,-180.16 8004.36,-190.16 8011.36,-190.16"/>
</g>
<!-- experts_gpu9_layer8 -->
<g id="node84" class="node">
<title>experts_gpu9_layer8</title>
<polygon fill="lightcoral" stroke="black" points="8872.85,-396.91 8534.85,-396.91 8534.85,-328.91 8872.85,-328.91 8872.85,-396.91"/>
<text text-anchor="middle" x="8703.85" y="-381.71" font-family="Times,serif" font-size="14.00">8 Experts GPU 9</text>
<text text-anchor="middle" x="8703.85" y="-366.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8703.85" y="-351.71" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8703.85" y="-336.71" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route8_gpu9&#45;&gt;experts_gpu9_layer8 -->
<g id="edge98" class="edge">
<title>route8_gpu9&#45;&gt;experts_gpu9_layer8</title>
<path fill="none" stroke="black" d="M8703.85,-433.75C8703.85,-433.75 8703.85,-407.2 8703.85,-407.2"/>
<polygon fill="black" stroke="black" points="8707.36,-407.2 8703.85,-397.2 8700.36,-407.2 8707.36,-407.2"/>
</g>
<!-- agg8_gpu9 -->
<g id="node85" class="node">
<title>agg8_gpu9</title>
<ellipse fill="lightpink" stroke="black" cx="8673.85" cy="-254.43" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="8673.85" y="-265.73" font-family="Times,serif" font-size="14.00">Aggregate GPU 9</text>
<text text-anchor="middle" x="8673.85" y="-250.73" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="8673.85" y="-235.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu9_layer8&#45;&gt;agg8_gpu9 -->
<g id="edge99" class="edge">
<title>experts_gpu9_layer8&#45;&gt;agg8_gpu9</title>
<path fill="none" stroke="black" d="M8703.85,-328.88C8703.85,-328.88 8703.85,-302.11 8703.85,-302.11"/>
<polygon fill="black" stroke="black" points="8707.36,-302.11 8703.85,-292.11 8700.36,-302.11 8707.36,-302.11"/>
</g>
<!-- agg8_gpu9&#45;&gt;moe_agg8 -->
<g id="edge127" class="edge">
<title>agg8_gpu9&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M8349.63,-254C8342.24,-254 8338.07,-254 8338.07,-254 8338.07,-254 8338.07,-159.79 8338.07,-159.79"/>
<polygon fill="black" stroke="black" points="8341.57,-159.79 8338.07,-149.79 8334.57,-159.79 8341.57,-159.79"/>
</g>
<!-- experts_gpu10_layer8 -->
<g id="node87" class="node">
<title>experts_gpu10_layer8</title>
<polygon fill="lightcoral" stroke="black" points="9519.85,-396.91 9181.85,-396.91 9181.85,-328.91 9519.85,-328.91 9519.85,-396.91"/>
<text text-anchor="middle" x="9350.85" y="-381.71" font-family="Times,serif" font-size="14.00">8 Experts GPU 10</text>
<text text-anchor="middle" x="9350.85" y="-366.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="9350.85" y="-351.71" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="9350.85" y="-336.71" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route8_gpu10&#45;&gt;experts_gpu10_layer8 -->
<g id="edge101" class="edge">
<title>route8_gpu10&#45;&gt;experts_gpu10_layer8</title>
<path fill="none" stroke="black" d="M9350.85,-433.75C9350.85,-433.75 9350.85,-407.2 9350.85,-407.2"/>
<polygon fill="black" stroke="black" points="9354.36,-407.2 9350.85,-397.2 9347.36,-407.2 9354.36,-407.2"/>
</g>
<!-- agg8_gpu10 -->
<g id="node88" class="node">
<title>agg8_gpu10</title>
<ellipse fill="lightpink" stroke="black" cx="9339.85" cy="-254.43" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="9339.85" y="-265.73" font-family="Times,serif" font-size="14.00">Aggregate GPU 10</text>
<text text-anchor="middle" x="9339.85" y="-250.73" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="9339.85" y="-235.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu10_layer8&#45;&gt;agg8_gpu10 -->
<g id="edge102" class="edge">
<title>experts_gpu10_layer8&#45;&gt;agg8_gpu10</title>
<path fill="none" stroke="black" d="M9350.85,-328.88C9350.85,-328.88 9350.85,-302.11 9350.85,-302.11"/>
<polygon fill="black" stroke="black" points="9354.36,-302.11 9350.85,-292.11 9347.36,-302.11 9354.36,-302.11"/>
</g>
<!-- agg8_gpu10&#45;&gt;moe_agg8 -->
<g id="edge128" class="edge">
<title>agg8_gpu10&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M9339.85,-216.66C9339.85,-194.18 9339.85,-170 9339.85,-170 9339.85,-170 8246.46,-170 8246.46,-170"/>
<polygon fill="black" stroke="black" points="8246.46,-166.5 8236.46,-170 8246.46,-173.5 8246.46,-166.5"/>
</g>
<!-- experts_gpu11_layer8 -->
<g id="node90" class="node">
<title>experts_gpu11_layer8</title>
<polygon fill="lightcoral" stroke="black" points="10180.85,-396.91 9842.85,-396.91 9842.85,-328.91 10180.85,-328.91 10180.85,-396.91"/>
<text text-anchor="middle" x="10011.85" y="-381.71" font-family="Times,serif" font-size="14.00">8 Experts GPU 11</text>
<text text-anchor="middle" x="10011.85" y="-366.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10011.85" y="-351.71" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10011.85" y="-336.71" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route8_gpu11&#45;&gt;experts_gpu11_layer8 -->
<g id="edge104" class="edge">
<title>route8_gpu11&#45;&gt;experts_gpu11_layer8</title>
<path fill="none" stroke="black" d="M10011.85,-433.75C10011.85,-433.75 10011.85,-407.2 10011.85,-407.2"/>
<polygon fill="black" stroke="black" points="10015.36,-407.2 10011.85,-397.2 10008.36,-407.2 10015.36,-407.2"/>
</g>
<!-- agg8_gpu11 -->
<g id="node91" class="node">
<title>agg8_gpu11</title>
<ellipse fill="lightpink" stroke="black" cx="10005.85" cy="-254.43" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="10005.85" y="-265.73" font-family="Times,serif" font-size="14.00">Aggregate GPU 11</text>
<text text-anchor="middle" x="10005.85" y="-250.73" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10005.85" y="-235.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu11_layer8&#45;&gt;agg8_gpu11 -->
<g id="edge105" class="edge">
<title>experts_gpu11_layer8&#45;&gt;agg8_gpu11</title>
<path fill="none" stroke="black" d="M10011.85,-328.88C10011.85,-328.88 10011.85,-302.11 10011.85,-302.11"/>
<polygon fill="black" stroke="black" points="10015.36,-302.11 10011.85,-292.11 10008.36,-302.11 10015.36,-302.11"/>
</g>
<!-- agg8_gpu11&#45;&gt;moe_agg8 -->
<g id="edge129" class="edge">
<title>agg8_gpu11&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M9983.93,-216.97C9983.93,-190.97 9983.93,-161 9983.93,-161 9983.93,-161 8310.49,-161 8310.49,-161"/>
<polygon fill="black" stroke="black" points="8310.49,-157.5 8300.49,-161 8310.49,-164.5 8310.49,-157.5"/>
</g>
<!-- experts_gpu12_layer8 -->
<g id="node93" class="node">
<title>experts_gpu12_layer8</title>
<polygon fill="lightcoral" stroke="black" points="10840.85,-396.91 10502.85,-396.91 10502.85,-328.91 10840.85,-328.91 10840.85,-396.91"/>
<text text-anchor="middle" x="10671.85" y="-381.71" font-family="Times,serif" font-size="14.00">8 Experts GPU 12</text>
<text text-anchor="middle" x="10671.85" y="-366.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10671.85" y="-351.71" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10671.85" y="-336.71" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route8_gpu12&#45;&gt;experts_gpu12_layer8 -->
<g id="edge107" class="edge">
<title>route8_gpu12&#45;&gt;experts_gpu12_layer8</title>
<path fill="none" stroke="black" d="M10671.85,-433.75C10671.85,-433.75 10671.85,-407.2 10671.85,-407.2"/>
<polygon fill="black" stroke="black" points="10675.36,-407.2 10671.85,-397.2 10668.36,-407.2 10675.36,-407.2"/>
</g>
<!-- agg8_gpu12 -->
<g id="node94" class="node">
<title>agg8_gpu12</title>
<ellipse fill="lightpink" stroke="black" cx="10671.85" cy="-254.43" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="10671.85" y="-265.73" font-family="Times,serif" font-size="14.00">Aggregate GPU 12</text>
<text text-anchor="middle" x="10671.85" y="-250.73" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="10671.85" y="-235.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu12_layer8&#45;&gt;agg8_gpu12 -->
<g id="edge108" class="edge">
<title>experts_gpu12_layer8&#45;&gt;agg8_gpu12</title>
<path fill="none" stroke="black" d="M10671.85,-328.88C10671.85,-328.88 10671.85,-302.11 10671.85,-302.11"/>
<polygon fill="black" stroke="black" points="10675.36,-302.11 10671.85,-292.11 10668.36,-302.11 10675.36,-302.11"/>
</g>
<!-- agg8_gpu12&#45;&gt;moe_agg8 -->
<g id="edge130" class="edge">
<title>agg8_gpu12&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M10545.93,-219.7C10545.93,-189.65 10545.93,-151 10545.93,-151 10545.93,-151 8345.76,-151 8345.76,-151"/>
<polygon fill="black" stroke="black" points="8345.76,-147.5 8335.76,-151 8345.76,-154.5 8345.76,-147.5"/>
</g>
<!-- experts_gpu13_layer8 -->
<g id="node96" class="node">
<title>experts_gpu13_layer8</title>
<polygon fill="lightcoral" stroke="black" points="11496.85,-396.91 11158.85,-396.91 11158.85,-328.91 11496.85,-328.91 11496.85,-396.91"/>
<text text-anchor="middle" x="11327.85" y="-381.71" font-family="Times,serif" font-size="14.00">8 Experts GPU 13</text>
<text text-anchor="middle" x="11327.85" y="-366.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="11327.85" y="-351.71" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="11327.85" y="-336.71" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route8_gpu13&#45;&gt;experts_gpu13_layer8 -->
<g id="edge110" class="edge">
<title>route8_gpu13&#45;&gt;experts_gpu13_layer8</title>
<path fill="none" stroke="black" d="M11327.85,-433.75C11327.85,-433.75 11327.85,-407.2 11327.85,-407.2"/>
<polygon fill="black" stroke="black" points="11331.36,-407.2 11327.85,-397.2 11324.36,-407.2 11331.36,-407.2"/>
</g>
<!-- agg8_gpu13 -->
<g id="node97" class="node">
<title>agg8_gpu13</title>
<ellipse fill="lightpink" stroke="black" cx="11337.85" cy="-254.43" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="11337.85" y="-265.73" font-family="Times,serif" font-size="14.00">Aggregate GPU 13</text>
<text text-anchor="middle" x="11337.85" y="-250.73" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="11337.85" y="-235.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu13_layer8&#45;&gt;agg8_gpu13 -->
<g id="edge111" class="edge">
<title>experts_gpu13_layer8&#45;&gt;agg8_gpu13</title>
<path fill="none" stroke="black" d="M11327.85,-328.88C11327.85,-328.88 11327.85,-302.11 11327.85,-302.11"/>
<polygon fill="black" stroke="black" points="11331.36,-302.11 11327.85,-292.11 11324.36,-302.11 11331.36,-302.11"/>
</g>
<!-- agg8_gpu13&#45;&gt;moe_agg8 -->
<g id="edge131" class="edge">
<title>agg8_gpu13&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M11337.85,-216.68C11337.85,-184.02 11337.85,-142 11337.85,-142 11337.85,-142 8354.71,-142 8354.71,-142"/>
<polygon fill="black" stroke="black" points="8354.71,-138.5 8344.71,-142 8354.71,-145.5 8354.71,-138.5"/>
</g>
<!-- experts_gpu14_layer8 -->
<g id="node99" class="node">
<title>experts_gpu14_layer8</title>
<polygon fill="lightcoral" stroke="black" points="12151.85,-396.91 11813.85,-396.91 11813.85,-328.91 12151.85,-328.91 12151.85,-396.91"/>
<text text-anchor="middle" x="11982.85" y="-381.71" font-family="Times,serif" font-size="14.00">8 Experts GPU 14</text>
<text text-anchor="middle" x="11982.85" y="-366.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="11982.85" y="-351.71" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="11982.85" y="-336.71" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route8_gpu14&#45;&gt;experts_gpu14_layer8 -->
<g id="edge113" class="edge">
<title>route8_gpu14&#45;&gt;experts_gpu14_layer8</title>
<path fill="none" stroke="black" d="M11982.85,-433.75C11982.85,-433.75 11982.85,-407.2 11982.85,-407.2"/>
<polygon fill="black" stroke="black" points="11986.36,-407.2 11982.85,-397.2 11979.36,-407.2 11986.36,-407.2"/>
</g>
<!-- agg8_gpu14 -->
<g id="node100" class="node">
<title>agg8_gpu14</title>
<ellipse fill="lightpink" stroke="black" cx="12003.85" cy="-254.43" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="12003.85" y="-265.73" font-family="Times,serif" font-size="14.00">Aggregate GPU 14</text>
<text text-anchor="middle" x="12003.85" y="-250.73" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="12003.85" y="-235.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu14_layer8&#45;&gt;agg8_gpu14 -->
<g id="edge114" class="edge">
<title>experts_gpu14_layer8&#45;&gt;agg8_gpu14</title>
<path fill="none" stroke="black" d="M11982.85,-328.88C11982.85,-328.88 11982.85,-302.11 11982.85,-302.11"/>
<polygon fill="black" stroke="black" points="11986.36,-302.11 11982.85,-292.11 11979.36,-302.11 11986.36,-302.11"/>
</g>
<!-- agg8_gpu14&#45;&gt;moe_agg8 -->
<g id="edge132" class="edge">
<title>agg8_gpu14&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M12003.85,-216.67C12003.85,-181.03 12003.85,-133 12003.85,-133 12003.85,-133 8343.59,-133 8343.59,-133"/>
<polygon fill="black" stroke="black" points="8343.59,-129.5 8333.59,-133 8343.59,-136.5 8343.59,-129.5"/>
</g>
<!-- experts_gpu15_layer8 -->
<g id="node102" class="node">
<title>experts_gpu15_layer8</title>
<polygon fill="lightcoral" stroke="black" points="12825.85,-396.91 12487.85,-396.91 12487.85,-328.91 12825.85,-328.91 12825.85,-396.91"/>
<text text-anchor="middle" x="12656.85" y="-381.71" font-family="Times,serif" font-size="14.00">8 Experts GPU 15</text>
<text text-anchor="middle" x="12656.85" y="-366.71" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="12656.85" y="-351.71" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="12656.85" y="-336.71" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route8_gpu15&#45;&gt;experts_gpu15_layer8 -->
<g id="edge116" class="edge">
<title>route8_gpu15&#45;&gt;experts_gpu15_layer8</title>
<path fill="none" stroke="black" d="M12656.85,-434.05C12656.85,-434.05 12656.85,-407.03 12656.85,-407.03"/>
<polygon fill="black" stroke="black" points="12660.36,-407.03 12656.85,-397.03 12653.36,-407.03 12660.36,-407.03"/>
</g>
<!-- agg8_gpu15 -->
<g id="node103" class="node">
<title>agg8_gpu15</title>
<ellipse fill="lightpink" stroke="black" cx="12669.85" cy="-254.43" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="12669.85" y="-265.73" font-family="Times,serif" font-size="14.00">Aggregate GPU 15</text>
<text text-anchor="middle" x="12669.85" y="-250.73" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="12669.85" y="-235.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu15_layer8&#45;&gt;agg8_gpu15 -->
<g id="edge117" class="edge">
<title>experts_gpu15_layer8&#45;&gt;agg8_gpu15</title>
<path fill="none" stroke="black" d="M12656.85,-328.88C12656.85,-328.88 12656.85,-302.11 12656.85,-302.11"/>
<polygon fill="black" stroke="black" points="12660.36,-302.11 12656.85,-292.11 12653.36,-302.11 12660.36,-302.11"/>
</g>
<!-- agg8_gpu15&#45;&gt;moe_agg8 -->
<g id="edge133" class="edge">
<title>agg8_gpu15&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M12669.85,-216.77C12669.85,-177.93 12669.85,-123 12669.85,-123 12669.85,-123 8305.53,-123 8305.53,-123"/>
<polygon fill="black" stroke="black" points="8305.53,-119.5 8295.53,-123 8305.53,-126.5 8305.53,-119.5"/>
</g>
<!-- moe_agg8&#45;&gt;moe8 -->
<g id="edge134" class="edge">
<title>moe_agg8&#45;&gt;moe8</title>
<path fill="none" stroke="black" d="M8226.82,-114C8801.31,-114 10307.78,-114 10307.78,-114 10307.78,-114 10307.78,-78.39 10307.78,-78.39"/>
<polygon fill="black" stroke="black" points="10311.28,-78.39 10307.78,-68.39 10304.28,-78.39 10311.28,-78.39"/>
</g>
<!-- agg8_gpu0 -->
<g id="node105" class="node">
<title>agg8_gpu0</title>
<ellipse fill="none" stroke="black" cx="6616.85" cy="-254.43" rx="61.99" ry="18"/>
<text text-anchor="middle" x="6616.85" y="-250.73" font-family="Times,serif" font-size="14.00">agg8_gpu0</text>
</g>
<!-- agg8_gpu0&#45;&gt;moe_agg8 -->
<g id="edge118" class="edge">
<title>agg8_gpu0&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M6616.85,-236.36C6616.85,-198.43 6616.85,-114 6616.85,-114 6616.85,-114 7778.98,-114 7778.98,-114"/>
<polygon fill="black" stroke="black" points="7778.98,-117.5 7788.98,-114 7778.98,-110.5 7778.98,-117.5"/>
</g>
<!-- agg8_gpu1 -->
<g id="node106" class="node">
<title>agg8_gpu1</title>
<ellipse fill="none" stroke="black" cx="6757.85" cy="-254.43" rx="61.99" ry="18"/>
<text text-anchor="middle" x="6757.85" y="-250.73" font-family="Times,serif" font-size="14.00">agg8_gpu1</text>
</g>
<!-- agg8_gpu1&#45;&gt;moe_agg8 -->
<g id="edge119" class="edge">
<title>agg8_gpu1&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M6757.85,-236.16C6757.85,-200.04 6757.85,-123 6757.85,-123 6757.85,-123 7710.3,-123 7710.3,-123"/>
<polygon fill="black" stroke="black" points="7710.3,-126.5 7720.3,-123 7710.3,-119.5 7710.3,-126.5"/>
</g>
<!-- agg8_gpu2 -->
<g id="node107" class="node">
<title>agg8_gpu2</title>
<ellipse fill="none" stroke="black" cx="6898.85" cy="-254.43" rx="61.99" ry="18"/>
<text text-anchor="middle" x="6898.85" y="-250.73" font-family="Times,serif" font-size="14.00">agg8_gpu2</text>
</g>
<!-- agg8_gpu2&#45;&gt;moe_agg8 -->
<g id="edge120" class="edge">
<title>agg8_gpu2&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M6898.85,-236.25C6898.85,-202.38 6898.85,-133 6898.85,-133 6898.85,-133 7671.86,-133 7671.86,-133"/>
<polygon fill="black" stroke="black" points="7671.86,-136.5 7681.86,-133 7671.86,-129.5 7671.86,-136.5"/>
</g>
<!-- agg8_gpu3 -->
<g id="node108" class="node">
<title>agg8_gpu3</title>
<ellipse fill="none" stroke="black" cx="7039.85" cy="-254.43" rx="61.99" ry="18"/>
<text text-anchor="middle" x="7039.85" y="-250.73" font-family="Times,serif" font-size="14.00">agg8_gpu3</text>
</g>
<!-- agg8_gpu3&#45;&gt;moe_agg8 -->
<g id="edge121" class="edge">
<title>agg8_gpu3&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M7039.85,-236.37C7039.85,-204.58 7039.85,-142 7039.85,-142 7039.85,-142 7660.99,-142 7660.99,-142"/>
<polygon fill="black" stroke="black" points="7660.99,-145.5 7670.99,-142 7660.99,-138.5 7660.99,-145.5"/>
</g>
<!-- agg8_gpu4 -->
<g id="node109" class="node">
<title>agg8_gpu4</title>
<ellipse fill="none" stroke="black" cx="7180.85" cy="-254.43" rx="61.99" ry="18"/>
<text text-anchor="middle" x="7180.85" y="-250.73" font-family="Times,serif" font-size="14.00">agg8_gpu4</text>
</g>
<!-- agg8_gpu4&#45;&gt;moe_agg8 -->
<g id="edge122" class="edge">
<title>agg8_gpu4&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M7180.85,-236.41C7180.85,-206.78 7180.85,-151 7180.85,-151 7180.85,-151 7669.81,-151 7669.81,-151"/>
<polygon fill="black" stroke="black" points="7669.81,-154.5 7679.81,-151 7669.81,-147.5 7669.81,-154.5"/>
</g>
<!-- agg8_gpu5 -->
<g id="node110" class="node">
<title>agg8_gpu5</title>
<ellipse fill="none" stroke="black" cx="7321.85" cy="-254.43" rx="61.99" ry="18"/>
<text text-anchor="middle" x="7321.85" y="-250.73" font-family="Times,serif" font-size="14.00">agg8_gpu5</text>
</g>
<!-- agg8_gpu5&#45;&gt;moe_agg8 -->
<g id="edge123" class="edge">
<title>agg8_gpu5&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M7321.85,-236.42C7321.85,-209.27 7321.85,-161 7321.85,-161 7321.85,-161 7704.94,-161 7704.94,-161"/>
<polygon fill="black" stroke="black" points="7704.94,-164.5 7714.94,-161 7704.94,-157.5 7704.94,-164.5"/>
</g>
<!-- agg8_gpu6 -->
<g id="node111" class="node">
<title>agg8_gpu6</title>
<ellipse fill="none" stroke="black" cx="7462.85" cy="-254.43" rx="61.99" ry="18"/>
<text text-anchor="middle" x="7462.85" y="-250.73" font-family="Times,serif" font-size="14.00">agg8_gpu6</text>
</g>
<!-- agg8_gpu6&#45;&gt;moe_agg8 -->
<g id="edge124" class="edge">
<title>agg8_gpu6&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M7462.85,-236.11C7462.85,-211.28 7462.85,-170 7462.85,-170 7462.85,-170 7769.09,-170 7769.09,-170"/>
<polygon fill="black" stroke="black" points="7769.09,-173.5 7779.09,-170 7769.09,-166.5 7769.09,-173.5"/>
</g>
<!-- agg8_gpu7 -->
<g id="node112" class="node">
<title>agg8_gpu7</title>
<ellipse fill="none" stroke="black" cx="7603.85" cy="-254.43" rx="61.99" ry="18"/>
<text text-anchor="middle" x="7603.85" y="-250.73" font-family="Times,serif" font-size="14.00">agg8_gpu7</text>
</g>
<!-- agg8_gpu7&#45;&gt;moe_agg8 -->
<g id="edge125" class="edge">
<title>agg8_gpu7&#45;&gt;moe_agg8</title>
<path fill="none" stroke="black" d="M7665.78,-254C7672.88,-254 7677.64,-254 7677.64,-254 7677.64,-254 7677.64,-159.79 7677.64,-159.79"/>
<polygon fill="black" stroke="black" points="7681.14,-159.79 7677.64,-149.79 7674.14,-159.79 7681.14,-159.79"/>
</g>
<!-- mha15 -->
<g id="node114" class="node">
<title>mha15</title>
<polygon fill="lightcyan" stroke="black" points="19335.85,-1789.72 18877.85,-1789.72 18877.85,-1721.72 19335.85,-1721.72 19335.85,-1789.72"/>
<text text-anchor="middle" x="19106.85" y="-1774.52" font-family="Times,serif" font-size="14.00">MHA Layer 15</text>
<text text-anchor="middle" x="19106.85" y="-1759.52" font-family="Times,serif" font-size="14.00">TP=8 across 8 GPUs</text>
<text text-anchor="middle" x="19106.85" y="-1744.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="19106.85" y="-1729.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_15 -->
<g id="node116" class="node">
<title>add1_15</title>
<polygon fill="yellow" stroke="black" points="19335.85,-1684.72 18877.85,-1684.72 18877.85,-1616.72 19335.85,-1616.72 19335.85,-1684.72"/>
<text text-anchor="middle" x="19106.85" y="-1669.52" font-family="Times,serif" font-size="14.00">MHA Residual Add 15</text>
<text text-anchor="middle" x="19106.85" y="-1654.52" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="19106.85" y="-1639.52" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="19106.85" y="-1624.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha15&#45;&gt;add1_15 -->
<g id="edge137" class="edge">
<title>mha15&#45;&gt;add1_15</title>
<path fill="none" stroke="black" d="M19106.85,-1721.63C19106.85,-1721.63 19106.85,-1695 19106.85,-1695"/>
<polygon fill="black" stroke="black" points="19110.36,-1695 19106.85,-1685 19103.36,-1695 19110.36,-1695"/>
</g>
<!-- moe14 -->
<g id="node115" class="node">
<title>moe14</title>
<ellipse fill="none" stroke="black" cx="19106.85" cy="-1845.72" rx="42.49" ry="18"/>
<text text-anchor="middle" x="19106.85" y="-1842.02" font-family="Times,serif" font-size="14.00">moe14</text>
</g>
<!-- moe14&#45;&gt;mha15 -->
<g id="edge136" class="edge">
<title>moe14&#45;&gt;mha15</title>
<path fill="none" stroke="black" d="M19106.85,-1827.51C19106.85,-1827.51 19106.85,-1799.93 19106.85,-1799.93"/>
<polygon fill="black" stroke="black" points="19110.36,-1799.93 19106.85,-1789.93 19103.36,-1799.93 19110.36,-1799.93"/>
</g>
<!-- gate15 -->
<g id="node117" class="node">
<title>gate15</title>
<polygon fill="lightgreen" stroke="black" points="17811.43,-1579.72 17069.21,-1579.72 16878.28,-1473.72 17620.5,-1473.72 17811.43,-1579.72"/>
<text text-anchor="middle" x="17344.85" y="-1538.02" font-family="Times,serif" font-size="14.00">Gate Layer 15</text>
<text text-anchor="middle" x="17344.85" y="-1523.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="17344.85" y="-1508.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
</g>
<!-- add1_15&#45;&gt;gate15 -->
<g id="edge138" class="edge">
<title>add1_15&#45;&gt;gate15</title>
<path fill="none" stroke="black" d="M18928.54,-1616.54C18928.54,-1588.36 18928.54,-1553 18928.54,-1553 18928.54,-1553 17773.54,-1553 17773.54,-1553"/>
<polygon fill="black" stroke="black" points="17773.54,-1549.5 17763.54,-1553 17773.54,-1556.5 17773.54,-1549.5"/>
</g>
<!-- moe15 -->
<g id="node151" class="node">
<title>moe15</title>
<polygon fill="yellow" stroke="black" points="18669.85,-995.86 18211.85,-995.86 18211.85,-927.86 18669.85,-927.86 18669.85,-995.86"/>
<text text-anchor="middle" x="18440.85" y="-980.66" font-family="Times,serif" font-size="14.00">MoE Residual Add 15</text>
<text text-anchor="middle" x="18440.85" y="-965.66" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18440.85" y="-950.66" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18440.85" y="-935.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_15&#45;&gt;moe15 -->
<g id="edge180" class="edge">
<title>add1_15&#45;&gt;moe15</title>
<path fill="none" stroke="black" d="M19006.6,-1616.52C19006.6,-1477.35 19006.6,-961 19006.6,-961 19006.6,-961 18680.15,-961 18680.15,-961"/>
<polygon fill="black" stroke="black" points="18680.15,-957.5 18670.15,-961 18680.15,-964.5 18680.15,-957.5"/>
</g>
<!-- route15_gpu8 -->
<g id="node118" class="node">
<title>route15_gpu8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="14685.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="14685.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 8</text>
<text text-anchor="middle" x="14685.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14685.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_gpu8 -->
<g id="edge139" class="edge">
<title>gate15&#45;&gt;route15_gpu8</title>
<path fill="none" stroke="black" d="M17040.81,-1564C16342.94,-1564 14685.85,-1564 14685.85,-1564 14685.85,-1564 14685.85,-1447.04 14685.85,-1447.04"/>
<polygon fill="black" stroke="black" points="14689.36,-1447.04 14685.85,-1437.04 14682.36,-1447.04 14689.36,-1447.04"/>
</g>
<!-- route15_gpu9 -->
<g id="node121" class="node">
<title>route15_gpu9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="15368.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="15368.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 9</text>
<text text-anchor="middle" x="15368.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="15368.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_gpu9 -->
<g id="edge142" class="edge">
<title>gate15&#45;&gt;route15_gpu9</title>
<path fill="none" stroke="black" d="M17013.84,-1549C16451.24,-1549 15368.85,-1549 15368.85,-1549 15368.85,-1549 15368.85,-1447.03 15368.85,-1447.03"/>
<polygon fill="black" stroke="black" points="15372.36,-1447.03 15368.85,-1437.03 15365.36,-1447.03 15372.36,-1447.03"/>
</g>
<!-- route15_gpu10 -->
<g id="node124" class="node">
<title>route15_gpu10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="16034.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="16034.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 10</text>
<text text-anchor="middle" x="16034.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="16034.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_gpu10 -->
<g id="edge145" class="edge">
<title>gate15&#45;&gt;route15_gpu10</title>
<path fill="none" stroke="black" d="M16986.46,-1534C16598.61,-1534 16034.85,-1534 16034.85,-1534 16034.85,-1534 16034.85,-1446.78 16034.85,-1446.78"/>
<polygon fill="black" stroke="black" points="16038.36,-1446.78 16034.85,-1436.78 16031.36,-1446.78 16038.36,-1446.78"/>
</g>
<!-- route15_gpu11 -->
<g id="node127" class="node">
<title>route15_gpu11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="16691.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="16691.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 11</text>
<text text-anchor="middle" x="16691.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="16691.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_gpu11 -->
<g id="edge148" class="edge">
<title>gate15&#45;&gt;route15_gpu11</title>
<path fill="none" stroke="black" d="M16942.77,-1473.4C16942.77,-1473.4 16942.77,-1432.23 16942.77,-1432.23"/>
<polygon fill="black" stroke="black" points="16946.27,-1432.23 16942.77,-1422.23 16939.27,-1432.23 16946.27,-1432.23"/>
</g>
<!-- route15_gpu12 -->
<g id="node130" class="node">
<title>route15_gpu12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="17344.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="17344.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 12</text>
<text text-anchor="middle" x="17344.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="17344.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_gpu12 -->
<g id="edge151" class="edge">
<title>gate15&#45;&gt;route15_gpu12</title>
<path fill="none" stroke="black" d="M17344.85,-1473.4C17344.85,-1473.4 17344.85,-1446.85 17344.85,-1446.85"/>
<polygon fill="black" stroke="black" points="17348.36,-1446.85 17344.85,-1436.85 17341.36,-1446.85 17348.36,-1446.85"/>
</g>
<!-- route15_gpu13 -->
<g id="node133" class="node">
<title>route15_gpu13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="18001.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="18001.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 13</text>
<text text-anchor="middle" x="18001.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18001.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_gpu13 -->
<g id="edge154" class="edge">
<title>gate15&#45;&gt;route15_gpu13</title>
<path fill="none" stroke="black" d="M17748.94,-1526.63C17748.94,-1526.63 17748.94,-1431.69 17748.94,-1431.69"/>
<polygon fill="black" stroke="black" points="17752.44,-1431.69 17748.94,-1421.69 17745.44,-1431.69 17752.44,-1431.69"/>
</g>
<!-- route15_gpu14 -->
<g id="node136" class="node">
<title>route15_gpu14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="18663.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="18663.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 14</text>
<text text-anchor="middle" x="18663.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18663.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_gpu14 -->
<g id="edge157" class="edge">
<title>gate15&#45;&gt;route15_gpu14</title>
<path fill="none" stroke="black" d="M17668.19,-1500C18043.96,-1500 18613.17,-1500 18613.17,-1500 18613.17,-1500 18613.17,-1446.48 18613.17,-1446.48"/>
<polygon fill="black" stroke="black" points="18616.67,-1446.48 18613.17,-1436.48 18609.67,-1446.48 18616.67,-1446.48"/>
</g>
<!-- route15_gpu15 -->
<g id="node139" class="node">
<title>route15_gpu15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="19327.85" cy="-1399.24" rx="315.24" ry="37.45"/>
<text text-anchor="middle" x="19327.85" y="-1410.54" font-family="Times,serif" font-size="14.00">Route to GPU 15</text>
<text text-anchor="middle" x="19327.85" y="-1395.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="19327.85" y="-1380.54" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_gpu15 -->
<g id="edge160" class="edge">
<title>gate15&#45;&gt;route15_gpu15</title>
<path fill="none" stroke="black" d="M17714.77,-1526C18249.26,-1526 19174.17,-1526 19174.17,-1526 19174.17,-1526 19174.17,-1442.22 19174.17,-1442.22"/>
<polygon fill="black" stroke="black" points="19177.67,-1442.22 19174.17,-1432.22 19170.67,-1442.22 19177.67,-1442.22"/>
</g>
<!-- experts_gpu8_layer15 -->
<g id="node119" class="node">
<title>experts_gpu8_layer15</title>
<polygon fill="lightcoral" stroke="black" points="14851.85,-1324.77 14513.85,-1324.77 14513.85,-1256.77 14851.85,-1256.77 14851.85,-1324.77"/>
<text text-anchor="middle" x="14682.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 8</text>
<text text-anchor="middle" x="14682.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="14682.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="14682.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route15_gpu8&#45;&gt;experts_gpu8_layer15 -->
<g id="edge140" class="edge">
<title>route15_gpu8&#45;&gt;experts_gpu8_layer15</title>
<path fill="none" stroke="black" d="M14682.85,-1361.61C14682.85,-1361.61 14682.85,-1335.06 14682.85,-1335.06"/>
<polygon fill="black" stroke="black" points="14686.36,-1335.06 14682.85,-1325.06 14679.36,-1335.06 14686.36,-1335.06"/>
</g>
<!-- agg15_gpu8 -->
<g id="node120" class="node">
<title>agg15_gpu8</title>
<ellipse fill="lightpink" stroke="black" cx="14680.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="14680.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 8</text>
<text text-anchor="middle" x="14680.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="14680.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu8_layer15&#45;&gt;agg15_gpu8 -->
<g id="edge141" class="edge">
<title>experts_gpu8_layer15&#45;&gt;agg15_gpu8</title>
<path fill="none" stroke="black" d="M14682.85,-1256.74C14682.85,-1256.74 14682.85,-1229.97 14682.85,-1229.97"/>
<polygon fill="black" stroke="black" points="14686.36,-1229.97 14682.85,-1219.97 14679.36,-1229.97 14686.36,-1229.97"/>
</g>
<!-- moe_agg15 -->
<g id="node142" class="node">
<title>moe_agg15</title>
<ellipse fill="gold" stroke="black" cx="14680.85" cy="-1070.34" rx="336.67" ry="37.45"/>
<text text-anchor="middle" x="14680.85" y="-1081.64" font-family="Times,serif" font-size="14.00">MoE Final Aggregation 15</text>
<text text-anchor="middle" x="14680.85" y="-1066.64" font-family="Times,serif" font-size="14.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14680.85" y="-1051.64" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- agg15_gpu8&#45;&gt;moe_agg15 -->
<g id="edge171" class="edge">
<title>agg15_gpu8&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M14680.85,-1144.7C14680.85,-1144.7 14680.85,-1118.02 14680.85,-1118.02"/>
<polygon fill="black" stroke="black" points="14684.36,-1118.02 14680.85,-1108.02 14677.36,-1118.02 14684.36,-1118.02"/>
</g>
<!-- experts_gpu9_layer15 -->
<g id="node122" class="node">
<title>experts_gpu9_layer15</title>
<polygon fill="lightcoral" stroke="black" points="15523.85,-1324.77 15185.85,-1324.77 15185.85,-1256.77 15523.85,-1256.77 15523.85,-1324.77"/>
<text text-anchor="middle" x="15354.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 9</text>
<text text-anchor="middle" x="15354.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="15354.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="15354.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route15_gpu9&#45;&gt;experts_gpu9_layer15 -->
<g id="edge143" class="edge">
<title>route15_gpu9&#45;&gt;experts_gpu9_layer15</title>
<path fill="none" stroke="black" d="M15354.85,-1361.61C15354.85,-1361.61 15354.85,-1335.06 15354.85,-1335.06"/>
<polygon fill="black" stroke="black" points="15358.36,-1335.06 15354.85,-1325.06 15351.36,-1335.06 15358.36,-1335.06"/>
</g>
<!-- agg15_gpu9 -->
<g id="node123" class="node">
<title>agg15_gpu9</title>
<ellipse fill="lightpink" stroke="black" cx="15346.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="15346.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 9</text>
<text text-anchor="middle" x="15346.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="15346.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu9_layer15&#45;&gt;agg15_gpu9 -->
<g id="edge144" class="edge">
<title>experts_gpu9_layer15&#45;&gt;agg15_gpu9</title>
<path fill="none" stroke="black" d="M15354.85,-1256.74C15354.85,-1256.74 15354.85,-1229.97 15354.85,-1229.97"/>
<polygon fill="black" stroke="black" points="15358.36,-1229.97 15354.85,-1219.97 15351.36,-1229.97 15358.36,-1229.97"/>
</g>
<!-- agg15_gpu9&#45;&gt;moe_agg15 -->
<g id="edge172" class="edge">
<title>agg15_gpu9&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M15022.63,-1182C15015.24,-1182 15011.07,-1182 15011.07,-1182 15011.07,-1182 15011.07,-1087.66 15011.07,-1087.66"/>
<polygon fill="black" stroke="black" points="15014.57,-1087.66 15011.07,-1077.66 15007.57,-1087.66 15014.57,-1087.66"/>
</g>
<!-- experts_gpu10_layer15 -->
<g id="node125" class="node">
<title>experts_gpu10_layer15</title>
<polygon fill="lightcoral" stroke="black" points="16189.85,-1324.77 15851.85,-1324.77 15851.85,-1256.77 16189.85,-1256.77 16189.85,-1324.77"/>
<text text-anchor="middle" x="16020.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 10</text>
<text text-anchor="middle" x="16020.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="16020.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="16020.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route15_gpu10&#45;&gt;experts_gpu10_layer15 -->
<g id="edge146" class="edge">
<title>route15_gpu10&#45;&gt;experts_gpu10_layer15</title>
<path fill="none" stroke="black" d="M16020.85,-1361.61C16020.85,-1361.61 16020.85,-1335.06 16020.85,-1335.06"/>
<polygon fill="black" stroke="black" points="16024.36,-1335.06 16020.85,-1325.06 16017.36,-1335.06 16024.36,-1335.06"/>
</g>
<!-- agg15_gpu10 -->
<g id="node126" class="node">
<title>agg15_gpu10</title>
<ellipse fill="lightpink" stroke="black" cx="16012.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="16012.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 10</text>
<text text-anchor="middle" x="16012.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="16012.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu10_layer15&#45;&gt;agg15_gpu10 -->
<g id="edge147" class="edge">
<title>experts_gpu10_layer15&#45;&gt;agg15_gpu10</title>
<path fill="none" stroke="black" d="M16020.85,-1256.74C16020.85,-1256.74 16020.85,-1229.97 16020.85,-1229.97"/>
<polygon fill="black" stroke="black" points="16024.36,-1229.97 16020.85,-1219.97 16017.36,-1229.97 16024.36,-1229.97"/>
</g>
<!-- agg15_gpu10&#45;&gt;moe_agg15 -->
<g id="edge173" class="edge">
<title>agg15_gpu10&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M16012.85,-1144.58C16012.85,-1122.14 16012.85,-1098 16012.85,-1098 16012.85,-1098 14917.94,-1098 14917.94,-1098"/>
<polygon fill="black" stroke="black" points="14917.94,-1094.5 14907.94,-1098 14917.94,-1101.5 14917.94,-1094.5"/>
</g>
<!-- experts_gpu11_layer15 -->
<g id="node128" class="node">
<title>experts_gpu11_layer15</title>
<polygon fill="lightcoral" stroke="black" points="16852.85,-1324.77 16514.85,-1324.77 16514.85,-1256.77 16852.85,-1256.77 16852.85,-1324.77"/>
<text text-anchor="middle" x="16683.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 11</text>
<text text-anchor="middle" x="16683.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="16683.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="16683.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route15_gpu11&#45;&gt;experts_gpu11_layer15 -->
<g id="edge149" class="edge">
<title>route15_gpu11&#45;&gt;experts_gpu11_layer15</title>
<path fill="none" stroke="black" d="M16683.85,-1361.61C16683.85,-1361.61 16683.85,-1335.06 16683.85,-1335.06"/>
<polygon fill="black" stroke="black" points="16687.36,-1335.06 16683.85,-1325.06 16680.36,-1335.06 16687.36,-1335.06"/>
</g>
<!-- agg15_gpu11 -->
<g id="node129" class="node">
<title>agg15_gpu11</title>
<ellipse fill="lightpink" stroke="black" cx="16678.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="16678.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 11</text>
<text text-anchor="middle" x="16678.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="16678.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu11_layer15&#45;&gt;agg15_gpu11 -->
<g id="edge150" class="edge">
<title>experts_gpu11_layer15&#45;&gt;agg15_gpu11</title>
<path fill="none" stroke="black" d="M16683.85,-1256.74C16683.85,-1256.74 16683.85,-1229.97 16683.85,-1229.97"/>
<polygon fill="black" stroke="black" points="16687.36,-1229.97 16683.85,-1219.97 16680.36,-1229.97 16687.36,-1229.97"/>
</g>
<!-- agg15_gpu11&#45;&gt;moe_agg15 -->
<g id="edge174" class="edge">
<title>agg15_gpu11&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M16678.85,-1144.61C16678.85,-1118.72 16678.85,-1089 16678.85,-1089 16678.85,-1089 14982.99,-1089 14982.99,-1089"/>
<polygon fill="black" stroke="black" points="14982.99,-1085.5 14972.99,-1089 14982.99,-1092.5 14982.99,-1085.5"/>
</g>
<!-- experts_gpu12_layer15 -->
<g id="node131" class="node">
<title>experts_gpu12_layer15</title>
<polygon fill="lightcoral" stroke="black" points="17513.85,-1324.77 17175.85,-1324.77 17175.85,-1256.77 17513.85,-1256.77 17513.85,-1324.77"/>
<text text-anchor="middle" x="17344.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 12</text>
<text text-anchor="middle" x="17344.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="17344.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="17344.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route15_gpu12&#45;&gt;experts_gpu12_layer15 -->
<g id="edge152" class="edge">
<title>route15_gpu12&#45;&gt;experts_gpu12_layer15</title>
<path fill="none" stroke="black" d="M17344.85,-1361.61C17344.85,-1361.61 17344.85,-1335.06 17344.85,-1335.06"/>
<polygon fill="black" stroke="black" points="17348.36,-1335.06 17344.85,-1325.06 17341.36,-1335.06 17348.36,-1335.06"/>
</g>
<!-- agg15_gpu12 -->
<g id="node132" class="node">
<title>agg15_gpu12</title>
<ellipse fill="lightpink" stroke="black" cx="17344.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="17344.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 12</text>
<text text-anchor="middle" x="17344.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="17344.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu12_layer15&#45;&gt;agg15_gpu12 -->
<g id="edge153" class="edge">
<title>experts_gpu12_layer15&#45;&gt;agg15_gpu12</title>
<path fill="none" stroke="black" d="M17344.85,-1256.74C17344.85,-1256.74 17344.85,-1229.97 17344.85,-1229.97"/>
<polygon fill="black" stroke="black" points="17348.36,-1229.97 17344.85,-1219.97 17341.36,-1229.97 17348.36,-1229.97"/>
</g>
<!-- agg15_gpu12&#45;&gt;moe_agg15 -->
<g id="edge175" class="edge">
<title>agg15_gpu12&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M17344.85,-1144.71C17344.85,-1115.17 17344.85,-1079 17344.85,-1079 17344.85,-1079 15018.51,-1079 15018.51,-1079"/>
<polygon fill="black" stroke="black" points="15018.51,-1075.5 15008.51,-1079 15018.51,-1082.5 15018.51,-1075.5"/>
</g>
<!-- experts_gpu13_layer15 -->
<g id="node134" class="node">
<title>experts_gpu13_layer15</title>
<polygon fill="lightcoral" stroke="black" points="18173.85,-1324.77 17835.85,-1324.77 17835.85,-1256.77 18173.85,-1256.77 18173.85,-1324.77"/>
<text text-anchor="middle" x="18004.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 13</text>
<text text-anchor="middle" x="18004.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="18004.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="18004.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route15_gpu13&#45;&gt;experts_gpu13_layer15 -->
<g id="edge155" class="edge">
<title>route15_gpu13&#45;&gt;experts_gpu13_layer15</title>
<path fill="none" stroke="black" d="M18004.85,-1361.61C18004.85,-1361.61 18004.85,-1335.06 18004.85,-1335.06"/>
<polygon fill="black" stroke="black" points="18008.36,-1335.06 18004.85,-1325.06 18001.36,-1335.06 18008.36,-1335.06"/>
</g>
<!-- agg15_gpu13 -->
<g id="node135" class="node">
<title>agg15_gpu13</title>
<ellipse fill="lightpink" stroke="black" cx="18010.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="18010.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 13</text>
<text text-anchor="middle" x="18010.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="18010.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu13_layer15&#45;&gt;agg15_gpu13 -->
<g id="edge156" class="edge">
<title>experts_gpu13_layer15&#45;&gt;agg15_gpu13</title>
<path fill="none" stroke="black" d="M18004.85,-1256.74C18004.85,-1256.74 18004.85,-1229.97 18004.85,-1229.97"/>
<polygon fill="black" stroke="black" points="18008.36,-1229.97 18004.85,-1219.97 18001.36,-1229.97 18008.36,-1229.97"/>
</g>
<!-- agg15_gpu13&#45;&gt;moe_agg15 -->
<g id="edge176" class="edge">
<title>agg15_gpu13&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M17949.43,-1145.21C17949.43,-1112.5 17949.43,-1070 17949.43,-1070 17949.43,-1070 15027.58,-1070 15027.58,-1070"/>
<polygon fill="black" stroke="black" points="15027.58,-1066.5 15017.58,-1070 15027.58,-1073.5 15027.58,-1066.5"/>
</g>
<!-- experts_gpu14_layer15 -->
<g id="node137" class="node">
<title>experts_gpu14_layer15</title>
<polygon fill="lightcoral" stroke="black" points="18840.85,-1324.77 18502.85,-1324.77 18502.85,-1256.77 18840.85,-1256.77 18840.85,-1324.77"/>
<text text-anchor="middle" x="18671.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 14</text>
<text text-anchor="middle" x="18671.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="18671.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="18671.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route15_gpu14&#45;&gt;experts_gpu14_layer15 -->
<g id="edge158" class="edge">
<title>route15_gpu14&#45;&gt;experts_gpu14_layer15</title>
<path fill="none" stroke="black" d="M18671.85,-1361.61C18671.85,-1361.61 18671.85,-1335.06 18671.85,-1335.06"/>
<polygon fill="black" stroke="black" points="18675.36,-1335.06 18671.85,-1325.06 18668.36,-1335.06 18675.36,-1335.06"/>
</g>
<!-- agg15_gpu14 -->
<g id="node138" class="node">
<title>agg15_gpu14</title>
<ellipse fill="lightpink" stroke="black" cx="18676.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="18676.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 14</text>
<text text-anchor="middle" x="18676.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="18676.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu14_layer15&#45;&gt;agg15_gpu14 -->
<g id="edge159" class="edge">
<title>experts_gpu14_layer15&#45;&gt;agg15_gpu14</title>
<path fill="none" stroke="black" d="M18671.85,-1256.74C18671.85,-1256.74 18671.85,-1229.97 18671.85,-1229.97"/>
<polygon fill="black" stroke="black" points="18675.36,-1229.97 18671.85,-1219.97 18668.36,-1229.97 18675.36,-1229.97"/>
</g>
<!-- agg15_gpu14&#45;&gt;moe_agg15 -->
<g id="edge177" class="edge">
<title>agg15_gpu14&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M18511.43,-1149.84C18511.43,-1113.61 18511.43,-1060 18511.43,-1060 18511.43,-1060 15014.56,-1060 15014.56,-1060"/>
<polygon fill="black" stroke="black" points="15014.56,-1056.5 15004.56,-1060 15014.56,-1063.5 15014.56,-1056.5"/>
</g>
<!-- experts_gpu15_layer15 -->
<g id="node140" class="node">
<title>experts_gpu15_layer15</title>
<polygon fill="lightcoral" stroke="black" points="19507.85,-1324.77 19169.85,-1324.77 19169.85,-1256.77 19507.85,-1256.77 19507.85,-1324.77"/>
<text text-anchor="middle" x="19338.85" y="-1309.57" font-family="Times,serif" font-size="14.00">8 Experts GPU 15</text>
<text text-anchor="middle" x="19338.85" y="-1294.57" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="19338.85" y="-1279.57" font-family="Times,serif" font-size="14.00">Output: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="19338.85" y="-1264.57" font-family="Times,serif" font-size="14.00">(Sequential processing)</text>
</g>
<!-- route15_gpu15&#45;&gt;experts_gpu15_layer15 -->
<g id="edge161" class="edge">
<title>route15_gpu15&#45;&gt;experts_gpu15_layer15</title>
<path fill="none" stroke="black" d="M19338.85,-1361.61C19338.85,-1361.61 19338.85,-1335.06 19338.85,-1335.06"/>
<polygon fill="black" stroke="black" points="19342.36,-1335.06 19338.85,-1325.06 19335.36,-1335.06 19342.36,-1335.06"/>
</g>
<!-- agg15_gpu15 -->
<g id="node141" class="node">
<title>agg15_gpu15</title>
<ellipse fill="lightpink" stroke="black" cx="19342.85" cy="-1182.29" rx="323.71" ry="37.45"/>
<text text-anchor="middle" x="19342.85" y="-1193.59" font-family="Times,serif" font-size="14.00">Aggregate GPU 15</text>
<text text-anchor="middle" x="19342.85" y="-1178.59" font-family="Times,serif" font-size="14.00">Input: [tokens_per_gpu, hidden_dim=4096]</text>
<text text-anchor="middle" x="19342.85" y="-1163.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- experts_gpu15_layer15&#45;&gt;agg15_gpu15 -->
<g id="edge162" class="edge">
<title>experts_gpu15_layer15&#45;&gt;agg15_gpu15</title>
<path fill="none" stroke="black" d="M19338.85,-1256.74C19338.85,-1256.74 19338.85,-1229.97 19338.85,-1229.97"/>
<polygon fill="black" stroke="black" points="19342.36,-1229.97 19338.85,-1219.97 19335.36,-1229.97 19342.36,-1229.97"/>
</g>
<!-- agg15_gpu15&#45;&gt;moe_agg15 -->
<g id="edge178" class="edge">
<title>agg15_gpu15&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M19342.85,-1144.67C19342.85,-1105.87 19342.85,-1051 19342.85,-1051 19342.85,-1051 14979.4,-1051 14979.4,-1051"/>
<polygon fill="black" stroke="black" points="14979.4,-1047.5 14969.4,-1051 14979.4,-1054.5 14979.4,-1047.5"/>
</g>
<!-- moe_agg15&#45;&gt;moe15 -->
<g id="edge179" class="edge">
<title>moe_agg15&#45;&gt;moe15</title>
<path fill="none" stroke="black" d="M14901.18,-1042C15682.37,-1042 18273.28,-1042 18273.28,-1042 18273.28,-1042 18273.28,-1006.31 18273.28,-1006.31"/>
<polygon fill="black" stroke="black" points="18276.78,-1006.31 18273.28,-996.31 18269.78,-1006.31 18276.78,-1006.31"/>
</g>
<!-- agg15_gpu0 -->
<g id="node143" class="node">
<title>agg15_gpu0</title>
<ellipse fill="none" stroke="black" cx="13200.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="13200.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg15_gpu0</text>
</g>
<!-- agg15_gpu0&#45;&gt;moe_agg15 -->
<g id="edge163" class="edge">
<title>agg15_gpu0&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M13200.85,-1164.02C13200.85,-1125.19 13200.85,-1038 13200.85,-1038 13200.85,-1038 14500.72,-1038 14500.72,-1038"/>
<polygon fill="black" stroke="black" points="14500.72,-1041.5 14510.72,-1038 14500.72,-1034.5 14500.72,-1041.5"/>
</g>
<!-- agg15_gpu1 -->
<g id="node144" class="node">
<title>agg15_gpu1</title>
<ellipse fill="none" stroke="black" cx="13353.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="13353.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg15_gpu1</text>
</g>
<!-- agg15_gpu1&#45;&gt;moe_agg15 -->
<g id="edge164" class="edge">
<title>agg15_gpu1&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M13353.85,-1164.08C13353.85,-1126.32 13353.85,-1043 13353.85,-1043 13353.85,-1043 14440.47,-1043 14440.47,-1043"/>
<polygon fill="black" stroke="black" points="14440.47,-1046.5 14450.47,-1043 14440.47,-1039.5 14440.47,-1046.5"/>
</g>
<!-- agg15_gpu2 -->
<g id="node145" class="node">
<title>agg15_gpu2</title>
<ellipse fill="none" stroke="black" cx="13506.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="13506.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg15_gpu2</text>
</g>
<!-- agg15_gpu2&#45;&gt;moe_agg15 -->
<g id="edge165" class="edge">
<title>agg15_gpu2&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M13506.85,-1164.18C13506.85,-1127.52 13506.85,-1048 13506.85,-1048 13506.85,-1048 14400.41,-1048 14400.41,-1048"/>
<polygon fill="black" stroke="black" points="14400.41,-1051.5 14410.41,-1048 14400.41,-1044.5 14400.41,-1051.5"/>
</g>
<!-- agg15_gpu3 -->
<g id="node146" class="node">
<title>agg15_gpu3</title>
<ellipse fill="none" stroke="black" cx="13659.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="13659.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg15_gpu3</text>
</g>
<!-- agg15_gpu3&#45;&gt;moe_agg15 -->
<g id="edge166" class="edge">
<title>agg15_gpu3&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M13659.85,-1164.18C13659.85,-1128.82 13659.85,-1054 13659.85,-1054 13659.85,-1054 14367.63,-1054 14367.63,-1054"/>
<polygon fill="black" stroke="black" points="14367.63,-1057.5 14377.63,-1054 14367.63,-1050.5 14367.63,-1057.5"/>
</g>
<!-- agg15_gpu4 -->
<g id="node147" class="node">
<title>agg15_gpu4</title>
<ellipse fill="none" stroke="black" cx="13812.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="13812.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg15_gpu4</text>
</g>
<!-- agg15_gpu4&#45;&gt;moe_agg15 -->
<g id="edge167" class="edge">
<title>agg15_gpu4&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M13812.85,-1164.1C13812.85,-1129.8 13812.85,-1059 13812.85,-1059 13812.85,-1059 14349.8,-1059 14349.8,-1059"/>
<polygon fill="black" stroke="black" points="14349.8,-1062.5 14359.8,-1059 14349.8,-1055.5 14349.8,-1062.5"/>
</g>
<!-- agg15_gpu5 -->
<g id="node148" class="node">
<title>agg15_gpu5</title>
<ellipse fill="none" stroke="black" cx="13965.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="13965.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg15_gpu5</text>
</g>
<!-- agg15_gpu5&#45;&gt;moe_agg15 -->
<g id="edge168" class="edge">
<title>agg15_gpu5&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M13965.85,-1164.07C13965.85,-1130.89 13965.85,-1064 13965.85,-1064 13965.85,-1064 14339,-1064 14339,-1064"/>
<polygon fill="black" stroke="black" points="14339,-1067.5 14349,-1064 14339,-1060.5 14339,-1067.5"/>
</g>
<!-- agg15_gpu6 -->
<g id="node149" class="node">
<title>agg15_gpu6</title>
<ellipse fill="none" stroke="black" cx="14118.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="14118.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg15_gpu6</text>
</g>
<!-- agg15_gpu6&#45;&gt;moe_agg15 -->
<g id="edge169" class="edge">
<title>agg15_gpu6&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M14118.85,-1164.25C14118.85,-1132.51 14118.85,-1070 14118.85,-1070 14118.85,-1070 14334.2,-1070 14334.2,-1070"/>
<polygon fill="black" stroke="black" points="14334.2,-1073.5 14344.2,-1070 14334.2,-1066.5 14334.2,-1073.5"/>
</g>
<!-- agg15_gpu7 -->
<g id="node150" class="node">
<title>agg15_gpu7</title>
<ellipse fill="none" stroke="black" cx="14271.85" cy="-1182.29" rx="67.69" ry="18"/>
<text text-anchor="middle" x="14271.85" y="-1178.59" font-family="Times,serif" font-size="14.00">agg15_gpu7</text>
</g>
<!-- agg15_gpu7&#45;&gt;moe_agg15 -->
<g id="edge170" class="edge">
<title>agg15_gpu7&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M14339.68,-1182C14346.31,-1182 14350.64,-1182 14350.64,-1182 14350.64,-1182 14350.64,-1087.66 14350.64,-1087.66"/>
<polygon fill="black" stroke="black" points="14354.14,-1087.66 14350.64,-1077.66 14347.14,-1087.66 14354.14,-1087.66"/>
</g>
<!-- output -->
<g id="node152" class="node">
<title>output</title>
<polygon fill="lightblue" stroke="black" points="18663.85,-846.86 18217.85,-846.86 18217.85,-808.86 18663.85,-808.86 18663.85,-846.86"/>
<text text-anchor="middle" x="18440.85" y="-831.66" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="18440.85" y="-816.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- moe15&#45;&gt;output -->
<g id="edge182" class="edge">
<title>moe15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M18440.85,-927.7C18440.85,-927.7 18440.85,-857.04 18440.85,-857.04"/>
<polygon fill="black" stroke="black" points="18444.36,-857.04 18440.85,-847.04 18437.36,-857.04 18444.36,-857.04"/>
</g>
</g>
</svg>
