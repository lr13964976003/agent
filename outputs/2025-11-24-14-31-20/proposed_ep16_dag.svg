<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="32034pt" height="1053pt"
 viewBox="0.00 0.00 32033.71 1053.29" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1049.29)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1049.29 32029.71,-1049.29 32029.71,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightblue" stroke="black" points="8381.85,-1037.79 7935.85,-1037.79 7935.85,-999.79 8381.85,-999.79 8381.85,-1037.79"/>
<text text-anchor="middle" x="8158.85" y="-1022.59" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="8158.85" y="-1007.59" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha0 -->
<g id="node2" class="node">
<title>mha0</title>
<polygon fill="lightcyan" stroke="black" points="8387.85,-956.29 7929.85,-956.29 7929.85,-903.29 8387.85,-903.29 8387.85,-956.29"/>
<text text-anchor="middle" x="8158.85" y="-941.09" font-family="Times,serif" font-size="14.00">MHA Layer 0</text>
<text text-anchor="middle" x="8158.85" y="-926.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8158.85" y="-911.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- input&#45;&gt;mha0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha0</title>
<path fill="none" stroke="black" d="M8158.85,-999.47C8158.85,-999.47 8158.85,-966.49 8158.85,-966.49"/>
<polygon fill="black" stroke="black" points="8162.36,-966.49 8158.85,-956.49 8155.36,-966.49 8162.36,-966.49"/>
</g>
<!-- add1_0 -->
<g id="node4" class="node">
<title>add1_0</title>
<polygon fill="yellow" stroke="black" points="8387.85,-867.29 7929.85,-867.29 7929.85,-799.29 8387.85,-799.29 8387.85,-867.29"/>
<text text-anchor="middle" x="8158.85" y="-852.09" font-family="Times,serif" font-size="14.00">MHA Residual Add 0</text>
<text text-anchor="middle" x="8158.85" y="-837.09" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8158.85" y="-822.09" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8158.85" y="-807.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha0&#45;&gt;add1_0 -->
<g id="edge2" class="edge">
<title>mha0&#45;&gt;add1_0</title>
<path fill="none" stroke="black" d="M8158.85,-903.16C8158.85,-903.16 8158.85,-877.43 8158.85,-877.43"/>
<polygon fill="black" stroke="black" points="8162.36,-877.43 8158.85,-867.43 8155.36,-877.43 8162.36,-877.43"/>
</g>
<!-- ln1_0 -->
<g id="node3" class="node">
<title>ln1_0</title>
<polygon fill="none" stroke="black" points="12574.85,-1045.29 12116.85,-1045.29 12116.85,-992.29 12574.85,-992.29 12574.85,-1045.29"/>
<text text-anchor="middle" x="12345.85" y="-1030.09" font-family="Times,serif" font-size="14.00">LayerNorm 0</text>
<text text-anchor="middle" x="12345.85" y="-1015.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="12345.85" y="-1000.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- gate0 -->
<g id="node5" class="node">
<title>gate0</title>
<polygon fill="lightgreen" stroke="black" points="6118.43,-763.29 5376.21,-763.29 5185.28,-657.29 5927.5,-657.29 6118.43,-763.29"/>
<text text-anchor="middle" x="5651.85" y="-721.59" font-family="Times,serif" font-size="14.00">Gate Layer 0</text>
<text text-anchor="middle" x="5651.85" y="-706.59" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5651.85" y="-691.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
</g>
<!-- add1_0&#45;&gt;gate0 -->
<g id="edge3" class="edge">
<title>add1_0&#45;&gt;gate0</title>
<path fill="none" stroke="black" d="M7933.54,-798.99C7933.54,-765.65 7933.54,-720 7933.54,-720 7933.54,-720 6050.53,-720 6050.53,-720"/>
<polygon fill="black" stroke="black" points="6050.53,-716.5 6040.53,-720 6050.53,-723.5 6050.53,-716.5"/>
</g>
<!-- moe0 -->
<g id="node55" class="node">
<title>moe0</title>
<polygon fill="yellow" stroke="black" points="8387.85,-142 7929.85,-142 7929.85,-74 8387.85,-74 8387.85,-142"/>
<text text-anchor="middle" x="8158.85" y="-126.8" font-family="Times,serif" font-size="14.00">MoE Residual Add 0</text>
<text text-anchor="middle" x="8158.85" y="-111.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8158.85" y="-96.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8158.85" y="-81.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_0&#45;&gt;moe0 -->
<g id="edge69" class="edge">
<title>add1_0&#45;&gt;moe0</title>
<path fill="none" stroke="black" d="M7952.85,-798.98C7952.85,-715.21 7952.85,-507 7952.85,-507 7952.85,-507 7982.85,-507 7982.85,-507 7982.85,-507 7982.85,-152.02 7982.85,-152.02"/>
<polygon fill="black" stroke="black" points="7986.36,-152.02 7982.85,-142.02 7979.36,-152.02 7986.36,-152.02"/>
</g>
<!-- route0_exp0 -->
<g id="node6" class="node">
<title>route0_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="392.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="392.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="392.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="392.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="392.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp0 -->
<g id="edge4" class="edge">
<title>gate0&#45;&gt;route0_exp0</title>
<path fill="none" stroke="black" d="M5352.13,-750C4237.14,-750 392.85,-750 392.85,-750 392.85,-750 392.85,-631.51 392.85,-631.51"/>
<polygon fill="black" stroke="black" points="396.36,-631.51 392.85,-621.51 389.36,-631.51 396.36,-631.51"/>
</g>
<!-- route0_exp1 -->
<g id="node9" class="node">
<title>route0_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1075.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="1075.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="1075.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1075.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1075.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp1 -->
<g id="edge7" class="edge">
<title>gate0&#45;&gt;route0_exp1</title>
<path fill="none" stroke="black" d="M5326.89,-736C4281.94,-736 1075.85,-736 1075.85,-736 1075.85,-736 1075.85,-631.61 1075.85,-631.61"/>
<polygon fill="black" stroke="black" points="1079.36,-631.61 1075.85,-621.61 1072.36,-631.61 1079.36,-631.61"/>
</g>
<!-- route0_exp2 -->
<g id="node12" class="node">
<title>route0_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1741.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="1741.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="1741.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1741.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="1741.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp2 -->
<g id="edge10" class="edge">
<title>gate0&#45;&gt;route0_exp2</title>
<path fill="none" stroke="black" d="M5303.58,-723C4345.61,-723 1741.85,-723 1741.85,-723 1741.85,-723 1741.85,-631.42 1741.85,-631.42"/>
<polygon fill="black" stroke="black" points="1745.36,-631.42 1741.85,-621.42 1738.36,-631.42 1745.36,-631.42"/>
</g>
<!-- route0_exp3 -->
<g id="node15" class="node">
<title>route0_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2398.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="2398.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="2398.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2398.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="2398.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp3 -->
<g id="edge13" class="edge">
<title>gate0&#45;&gt;route0_exp3</title>
<path fill="none" stroke="black" d="M5279.88,-710C4426.12,-710 2398.85,-710 2398.85,-710 2398.85,-710 2398.85,-631.43 2398.85,-631.43"/>
<polygon fill="black" stroke="black" points="2402.36,-631.43 2398.85,-621.43 2395.36,-631.43 2402.36,-631.43"/>
</g>
<!-- route0_exp4 -->
<g id="node18" class="node">
<title>route0_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3051.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="3051.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="3051.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="3051.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3051.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp4 -->
<g id="edge16" class="edge">
<title>gate0&#45;&gt;route0_exp4</title>
<path fill="none" stroke="black" d="M5256.62,-697C4529.15,-697 3051.85,-697 3051.85,-697 3051.85,-697 3051.85,-631.42 3051.85,-631.42"/>
<polygon fill="black" stroke="black" points="3055.36,-631.42 3051.85,-621.42 3048.36,-631.42 3055.36,-631.42"/>
</g>
<!-- route0_exp5 -->
<g id="node21" class="node">
<title>route0_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3702.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="3702.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="3702.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3702.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="3702.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp5 -->
<g id="edge19" class="edge">
<title>gate0&#45;&gt;route0_exp5</title>
<path fill="none" stroke="black" d="M5231.35,-683C4658.4,-683 3702.85,-683 3702.85,-683 3702.85,-683 3702.85,-631.36 3702.85,-631.36"/>
<polygon fill="black" stroke="black" points="3706.36,-631.36 3702.85,-621.36 3699.36,-631.36 3706.36,-631.36"/>
</g>
<!-- route0_exp6 -->
<g id="node24" class="node">
<title>route0_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4352.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="4352.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="4352.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="4352.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="4352.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp6 -->
<g id="edge22" class="edge">
<title>gate0&#45;&gt;route0_exp6</title>
<path fill="none" stroke="black" d="M5207.99,-670C4831.75,-670 4352.85,-670 4352.85,-670 4352.85,-670 4352.85,-631.32 4352.85,-631.32"/>
<polygon fill="black" stroke="black" points="4356.36,-631.32 4352.85,-621.32 4349.36,-631.32 4356.36,-631.32"/>
</g>
<!-- route0_exp7 -->
<g id="node27" class="node">
<title>route0_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5002.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="5002.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="5002.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="5002.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5002.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp7 -->
<g id="edge25" class="edge">
<title>gate0&#45;&gt;route0_exp7</title>
<path fill="none" stroke="black" d="M5251.77,-656.89C5251.77,-656.89 5251.77,-612.91 5251.77,-612.91"/>
<polygon fill="black" stroke="black" points="5255.27,-612.91 5251.77,-602.91 5248.27,-612.91 5255.27,-612.91"/>
</g>
<!-- route0_exp8 -->
<g id="node30" class="node">
<title>route0_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="5651.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="5651.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="5651.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5651.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5651.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp8 -->
<g id="edge28" class="edge">
<title>gate0&#45;&gt;route0_exp8</title>
<path fill="none" stroke="black" d="M5651.85,-656.89C5651.85,-656.89 5651.85,-631.31 5651.85,-631.31"/>
<polygon fill="black" stroke="black" points="5655.36,-631.31 5651.85,-621.31 5648.36,-631.31 5655.36,-631.31"/>
</g>
<!-- route0_exp9 -->
<g id="node33" class="node">
<title>route0_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6308.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="6308.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="6308.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6308.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6308.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp9 -->
<g id="edge31" class="edge">
<title>gate0&#45;&gt;route0_exp9</title>
<path fill="none" stroke="black" d="M6055.94,-710.19C6055.94,-710.19 6055.94,-612.14 6055.94,-612.14"/>
<polygon fill="black" stroke="black" points="6059.44,-612.14 6055.94,-602.14 6052.44,-612.14 6059.44,-612.14"/>
</g>
<!-- route0_exp10 -->
<g id="node36" class="node">
<title>route0_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6964.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="6964.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="6964.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6964.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="6964.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp10 -->
<g id="edge34" class="edge">
<title>gate0&#45;&gt;route0_exp10</title>
<path fill="none" stroke="black" d="M5952.26,-671C6339.84,-671 6964.85,-671 6964.85,-671 6964.85,-671 6964.85,-631.53 6964.85,-631.53"/>
<polygon fill="black" stroke="black" points="6968.36,-631.53 6964.85,-621.53 6961.36,-631.53 6968.36,-631.53"/>
</g>
<!-- route0_exp11 -->
<g id="node39" class="node">
<title>route0_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="7621.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="7621.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="7621.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7621.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="7621.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp11 -->
<g id="edge37" class="edge">
<title>gate0&#45;&gt;route0_exp11</title>
<path fill="none" stroke="black" d="M5977.65,-685C6536.47,-685 7618.17,-685 7618.17,-685 7618.17,-685 7618.17,-631.59 7618.17,-631.59"/>
<polygon fill="black" stroke="black" points="7621.67,-631.59 7618.17,-621.59 7614.67,-631.59 7621.67,-631.59"/>
</g>
<!-- route0_exp12 -->
<g id="node42" class="node">
<title>route0_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8283.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="8283.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="8283.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8283.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8283.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp12 -->
<g id="edge40" class="edge">
<title>gate0&#45;&gt;route0_exp12</title>
<path fill="none" stroke="black" d="M5990.27,-692C6678.82,-692 8178.17,-692 8178.17,-692 8178.17,-692 8178.17,-628.79 8178.17,-628.79"/>
<polygon fill="black" stroke="black" points="8181.67,-628.79 8178.17,-618.79 8174.67,-628.79 8181.67,-628.79"/>
</g>
<!-- route0_exp13 -->
<g id="node45" class="node">
<title>route0_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8947.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="8947.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="8947.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="8947.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="8947.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp13 -->
<g id="edge43" class="edge">
<title>gate0&#45;&gt;route0_exp13</title>
<path fill="none" stroke="black" d="M6003.02,-699C6852.3,-699 8947.85,-699 8947.85,-699 8947.85,-699 8947.85,-631.48 8947.85,-631.48"/>
<polygon fill="black" stroke="black" points="8951.36,-631.48 8947.85,-621.48 8944.36,-631.48 8951.36,-631.48"/>
</g>
<!-- route0_exp14 -->
<g id="node48" class="node">
<title>route0_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="9612.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="9612.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="9612.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="9612.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="9612.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp14 -->
<g id="edge46" class="edge">
<title>gate0&#45;&gt;route0_exp14</title>
<path fill="none" stroke="black" d="M6015.63,-706C6994.83,-706 9612.85,-706 9612.85,-706 9612.85,-706 9612.85,-631.52 9612.85,-631.52"/>
<polygon fill="black" stroke="black" points="9616.36,-631.52 9612.85,-621.52 9609.36,-631.52 9616.36,-631.52"/>
</g>
<!-- route0_exp15 -->
<g id="node51" class="node">
<title>route0_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="10277.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="10277.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="10277.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="10277.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="10277.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate0&#45;&gt;route0_exp15 -->
<g id="edge49" class="edge">
<title>gate0&#45;&gt;route0_exp15</title>
<path fill="none" stroke="black" d="M6027.97,-713C7130.59,-713 10277.85,-713 10277.85,-713 10277.85,-713 10277.85,-631.31 10277.85,-631.31"/>
<polygon fill="black" stroke="black" points="10281.36,-631.31 10277.85,-621.31 10274.36,-631.31 10281.36,-631.31"/>
</g>
<!-- expert0_exp0 -->
<g id="node7" class="node">
<title>expert0_exp0</title>
<polygon fill="lightcoral" stroke="black" points="503.35,-489.12 146.35,-489.12 146.35,-421.12 503.35,-421.12 503.35,-489.12"/>
<text text-anchor="middle" x="324.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 0</text>
<text text-anchor="middle" x="324.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="324.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="324.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp0&#45;&gt;expert0_exp0 -->
<g id="edge5" class="edge">
<title>route0_exp0&#45;&gt;expert0_exp0</title>
<path fill="none" stroke="black" d="M324.85,-526.19C324.85,-526.19 324.85,-499.23 324.85,-499.23"/>
<polygon fill="black" stroke="black" points="328.36,-499.23 324.85,-489.23 321.36,-499.23 328.36,-499.23"/>
</g>
<!-- agg0_exp0 -->
<g id="node8" class="node">
<title>agg0_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="323.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="323.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="323.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="323.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="323.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp0&#45;&gt;agg0_exp0 -->
<g id="edge6" class="edge">
<title>expert0_exp0&#45;&gt;agg0_exp0</title>
<path fill="none" stroke="black" d="M324.85,-420.97C324.85,-420.97 324.85,-395.17 324.85,-395.17"/>
<polygon fill="black" stroke="black" points="328.36,-395.17 324.85,-385.17 321.36,-395.17 328.36,-395.17"/>
</g>
<!-- moe_agg0 -->
<g id="node54" class="node">
<title>moe_agg0</title>
<ellipse fill="gold" stroke="black" cx="5651.85" cy="-215.48" rx="336.67" ry="37.45"/>
<text text-anchor="middle" x="5651.85" y="-226.78" font-family="Times,serif" font-size="14.00">MoE Final Aggregation 0</text>
<text text-anchor="middle" x="5651.85" y="-211.78" font-family="Times,serif" font-size="14.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="5651.85" y="-196.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- agg0_exp0&#45;&gt;moe_agg0 -->
<g id="edge52" class="edge">
<title>agg0_exp0&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M323.85,-288.74C323.85,-244.88 323.85,-187 323.85,-187 323.85,-187 5422.64,-187 5422.64,-187"/>
<polygon fill="black" stroke="black" points="5422.64,-190.5 5432.64,-187 5422.64,-183.5 5422.64,-190.5"/>
</g>
<!-- expert0_exp1 -->
<g id="node10" class="node">
<title>expert0_exp1</title>
<polygon fill="lightcoral" stroke="black" points="1211.35,-489.12 854.35,-489.12 854.35,-421.12 1211.35,-421.12 1211.35,-489.12"/>
<text text-anchor="middle" x="1032.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 1</text>
<text text-anchor="middle" x="1032.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1032.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1032.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp1&#45;&gt;expert0_exp1 -->
<g id="edge8" class="edge">
<title>route0_exp1&#45;&gt;expert0_exp1</title>
<path fill="none" stroke="black" d="M1032.85,-525.51C1032.85,-525.51 1032.85,-499.2 1032.85,-499.2"/>
<polygon fill="black" stroke="black" points="1036.36,-499.2 1032.85,-489.2 1029.36,-499.2 1036.36,-499.2"/>
</g>
<!-- agg0_exp1 -->
<g id="node11" class="node">
<title>agg0_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="989.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="989.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="989.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="989.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="989.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp1&#45;&gt;agg0_exp1 -->
<g id="edge9" class="edge">
<title>expert0_exp1&#45;&gt;agg0_exp1</title>
<path fill="none" stroke="black" d="M1032.85,-420.97C1032.85,-420.97 1032.85,-394.73 1032.85,-394.73"/>
<polygon fill="black" stroke="black" points="1036.36,-394.73 1032.85,-384.73 1029.36,-394.73 1036.36,-394.73"/>
</g>
<!-- agg0_exp1&#45;&gt;moe_agg0 -->
<g id="edge53" class="edge">
<title>agg0_exp1&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M989.85,-288.89C989.85,-248.04 989.85,-196 989.85,-196 989.85,-196 5354.18,-196 5354.18,-196"/>
<polygon fill="black" stroke="black" points="5354.18,-199.5 5364.18,-196 5354.18,-192.5 5354.18,-199.5"/>
</g>
<!-- expert0_exp2 -->
<g id="node13" class="node">
<title>expert0_exp2</title>
<polygon fill="lightcoral" stroke="black" points="1877.35,-489.12 1520.35,-489.12 1520.35,-421.12 1877.35,-421.12 1877.35,-489.12"/>
<text text-anchor="middle" x="1698.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 2</text>
<text text-anchor="middle" x="1698.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1698.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1698.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp2&#45;&gt;expert0_exp2 -->
<g id="edge11" class="edge">
<title>route0_exp2&#45;&gt;expert0_exp2</title>
<path fill="none" stroke="black" d="M1698.85,-525.51C1698.85,-525.51 1698.85,-499.2 1698.85,-499.2"/>
<polygon fill="black" stroke="black" points="1702.36,-499.2 1698.85,-489.2 1695.36,-499.2 1702.36,-499.2"/>
</g>
<!-- agg0_exp2 -->
<g id="node14" class="node">
<title>agg0_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="1655.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="1655.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="1655.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1655.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="1655.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp2&#45;&gt;agg0_exp2 -->
<g id="edge12" class="edge">
<title>expert0_exp2&#45;&gt;agg0_exp2</title>
<path fill="none" stroke="black" d="M1698.85,-420.97C1698.85,-420.97 1698.85,-394.73 1698.85,-394.73"/>
<polygon fill="black" stroke="black" points="1702.36,-394.73 1698.85,-384.73 1695.36,-394.73 1702.36,-394.73"/>
</g>
<!-- agg0_exp2&#45;&gt;moe_agg0 -->
<g id="edge54" class="edge">
<title>agg0_exp2&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M1655.85,-288.62C1655.85,-251.29 1655.85,-206 1655.85,-206 1655.85,-206 5316.12,-206 5316.12,-206"/>
<polygon fill="black" stroke="black" points="5316.12,-209.5 5326.12,-206 5316.12,-202.5 5316.12,-209.5"/>
</g>
<!-- expert0_exp3 -->
<g id="node16" class="node">
<title>expert0_exp3</title>
<polygon fill="lightcoral" stroke="black" points="2538.35,-489.12 2181.35,-489.12 2181.35,-421.12 2538.35,-421.12 2538.35,-489.12"/>
<text text-anchor="middle" x="2359.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 3</text>
<text text-anchor="middle" x="2359.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2359.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="2359.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp3&#45;&gt;expert0_exp3 -->
<g id="edge14" class="edge">
<title>route0_exp3&#45;&gt;expert0_exp3</title>
<path fill="none" stroke="black" d="M2359.85,-525.17C2359.85,-525.17 2359.85,-499.35 2359.85,-499.35"/>
<polygon fill="black" stroke="black" points="2363.36,-499.35 2359.85,-489.35 2356.36,-499.35 2363.36,-499.35"/>
</g>
<!-- agg0_exp3 -->
<g id="node17" class="node">
<title>agg0_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="2321.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="2321.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="2321.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2321.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="2321.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp3&#45;&gt;agg0_exp3 -->
<g id="edge15" class="edge">
<title>expert0_exp3&#45;&gt;agg0_exp3</title>
<path fill="none" stroke="black" d="M2359.85,-420.97C2359.85,-420.97 2359.85,-395.17 2359.85,-395.17"/>
<polygon fill="black" stroke="black" points="2363.36,-395.17 2359.85,-385.17 2356.36,-395.17 2363.36,-395.17"/>
</g>
<!-- agg0_exp3&#45;&gt;moe_agg0 -->
<g id="edge55" class="edge">
<title>agg0_exp3&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M2321.85,-288.8C2321.85,-254.69 2321.85,-215 2321.85,-215 2321.85,-215 5305,-215 5305,-215"/>
<polygon fill="black" stroke="black" points="5305,-218.5 5315,-215 5305,-211.5 5305,-218.5"/>
</g>
<!-- expert0_exp4 -->
<g id="node19" class="node">
<title>expert0_exp4</title>
<polygon fill="lightcoral" stroke="black" points="3198.35,-489.12 2841.35,-489.12 2841.35,-421.12 3198.35,-421.12 3198.35,-489.12"/>
<text text-anchor="middle" x="3019.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 4</text>
<text text-anchor="middle" x="3019.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="3019.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3019.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp4&#45;&gt;expert0_exp4 -->
<g id="edge17" class="edge">
<title>route0_exp4&#45;&gt;expert0_exp4</title>
<path fill="none" stroke="black" d="M3019.85,-525.17C3019.85,-525.17 3019.85,-499.35 3019.85,-499.35"/>
<polygon fill="black" stroke="black" points="3023.36,-499.35 3019.85,-489.35 3016.36,-499.35 3023.36,-499.35"/>
</g>
<!-- agg0_exp4 -->
<g id="node20" class="node">
<title>agg0_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="2987.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="2987.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="2987.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2987.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="2987.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp4&#45;&gt;agg0_exp4 -->
<g id="edge18" class="edge">
<title>expert0_exp4&#45;&gt;agg0_exp4</title>
<path fill="none" stroke="black" d="M3019.85,-420.97C3019.85,-420.97 3019.85,-395.17 3019.85,-395.17"/>
<polygon fill="black" stroke="black" points="3023.36,-395.17 3019.85,-385.17 3016.36,-395.17 3023.36,-395.17"/>
</g>
<!-- agg0_exp4&#45;&gt;moe_agg0 -->
<g id="edge56" class="edge">
<title>agg0_exp4&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M2987.85,-288.77C2987.85,-258.05 2987.85,-224 2987.85,-224 2987.85,-224 5313.86,-224 5313.86,-224"/>
<polygon fill="black" stroke="black" points="5313.86,-227.5 5323.86,-224 5313.86,-220.5 5313.86,-227.5"/>
</g>
<!-- expert0_exp5 -->
<g id="node22" class="node">
<title>expert0_exp5</title>
<polygon fill="lightcoral" stroke="black" points="3856.35,-489.12 3499.35,-489.12 3499.35,-421.12 3856.35,-421.12 3856.35,-489.12"/>
<text text-anchor="middle" x="3677.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 5</text>
<text text-anchor="middle" x="3677.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3677.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3677.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp5&#45;&gt;expert0_exp5 -->
<g id="edge20" class="edge">
<title>route0_exp5&#45;&gt;expert0_exp5</title>
<path fill="none" stroke="black" d="M3677.85,-525.17C3677.85,-525.17 3677.85,-499.35 3677.85,-499.35"/>
<polygon fill="black" stroke="black" points="3681.36,-499.35 3677.85,-489.35 3674.36,-499.35 3681.36,-499.35"/>
</g>
<!-- agg0_exp5 -->
<g id="node23" class="node">
<title>agg0_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="3653.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="3653.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="3653.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3653.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="3653.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp5&#45;&gt;agg0_exp5 -->
<g id="edge21" class="edge">
<title>expert0_exp5&#45;&gt;agg0_exp5</title>
<path fill="none" stroke="black" d="M3677.85,-420.97C3677.85,-420.97 3677.85,-395.17 3677.85,-395.17"/>
<polygon fill="black" stroke="black" points="3681.36,-395.17 3677.85,-385.17 3674.36,-395.17 3681.36,-395.17"/>
</g>
<!-- agg0_exp5&#45;&gt;moe_agg0 -->
<g id="edge57" class="edge">
<title>agg0_exp5&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M3653.85,-288.84C3653.85,-262.02 3653.85,-234 3653.85,-234 3653.85,-234 5349.19,-234 5349.19,-234"/>
<polygon fill="black" stroke="black" points="5349.19,-237.5 5359.19,-234 5349.19,-230.5 5349.19,-237.5"/>
</g>
<!-- expert0_exp6 -->
<g id="node25" class="node">
<title>expert0_exp6</title>
<polygon fill="lightcoral" stroke="black" points="4514.35,-489.12 4157.35,-489.12 4157.35,-421.12 4514.35,-421.12 4514.35,-489.12"/>
<text text-anchor="middle" x="4335.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 6</text>
<text text-anchor="middle" x="4335.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="4335.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="4335.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp6&#45;&gt;expert0_exp6 -->
<g id="edge23" class="edge">
<title>route0_exp6&#45;&gt;expert0_exp6</title>
<path fill="none" stroke="black" d="M4335.85,-525.17C4335.85,-525.17 4335.85,-499.35 4335.85,-499.35"/>
<polygon fill="black" stroke="black" points="4339.36,-499.35 4335.85,-489.35 4332.36,-499.35 4339.36,-499.35"/>
</g>
<!-- agg0_exp6 -->
<g id="node26" class="node">
<title>agg0_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="4319.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="4319.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="4319.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="4319.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="4319.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp6&#45;&gt;agg0_exp6 -->
<g id="edge24" class="edge">
<title>expert0_exp6&#45;&gt;agg0_exp6</title>
<path fill="none" stroke="black" d="M4335.85,-420.97C4335.85,-420.97 4335.85,-395.17 4335.85,-395.17"/>
<polygon fill="black" stroke="black" points="4339.36,-395.17 4335.85,-385.17 4332.36,-395.17 4339.36,-395.17"/>
</g>
<!-- agg0_exp6&#45;&gt;moe_agg0 -->
<g id="edge58" class="edge">
<title>agg0_exp6&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M4319.85,-288.92C4319.85,-265.78 4319.85,-243 4319.85,-243 4319.85,-243 5413.25,-243 5413.25,-243"/>
<polygon fill="black" stroke="black" points="5413.25,-246.5 5423.25,-243 5413.25,-239.5 5413.25,-246.5"/>
</g>
<!-- expert0_exp7 -->
<g id="node28" class="node">
<title>expert0_exp7</title>
<polygon fill="lightcoral" stroke="black" points="5172.35,-489.12 4815.35,-489.12 4815.35,-421.12 5172.35,-421.12 5172.35,-489.12"/>
<text text-anchor="middle" x="4993.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 7</text>
<text text-anchor="middle" x="4993.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4993.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="4993.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp7&#45;&gt;expert0_exp7 -->
<g id="edge26" class="edge">
<title>route0_exp7&#45;&gt;expert0_exp7</title>
<path fill="none" stroke="black" d="M4993.85,-524.83C4993.85,-524.83 4993.85,-499.15 4993.85,-499.15"/>
<polygon fill="black" stroke="black" points="4997.36,-499.15 4993.85,-489.15 4990.36,-499.15 4997.36,-499.15"/>
</g>
<!-- agg0_exp7 -->
<g id="node29" class="node">
<title>agg0_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="4985.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="4985.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="4985.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4985.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="4985.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp7&#45;&gt;agg0_exp7 -->
<g id="edge27" class="edge">
<title>expert0_exp7&#45;&gt;agg0_exp7</title>
<path fill="none" stroke="black" d="M4993.85,-420.97C4993.85,-420.97 4993.85,-395.17 4993.85,-395.17"/>
<polygon fill="black" stroke="black" points="4997.36,-395.17 4993.85,-385.17 4990.36,-395.17 4997.36,-395.17"/>
</g>
<!-- agg0_exp7&#45;&gt;moe_agg0 -->
<g id="edge59" class="edge">
<title>agg0_exp7&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M5309.89,-337C5318.33,-337 5323.11,-337 5323.11,-337 5323.11,-337 5323.11,-233.83 5323.11,-233.83"/>
<polygon fill="black" stroke="black" points="5326.61,-233.83 5323.11,-223.83 5319.61,-233.83 5326.61,-233.83"/>
</g>
<!-- expert0_exp8 -->
<g id="node31" class="node">
<title>expert0_exp8</title>
<polygon fill="lightcoral" stroke="black" points="5830.35,-489.12 5473.35,-489.12 5473.35,-421.12 5830.35,-421.12 5830.35,-489.12"/>
<text text-anchor="middle" x="5651.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 8</text>
<text text-anchor="middle" x="5651.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5651.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5651.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp8&#45;&gt;expert0_exp8 -->
<g id="edge29" class="edge">
<title>route0_exp8&#45;&gt;expert0_exp8</title>
<path fill="none" stroke="black" d="M5651.85,-524.83C5651.85,-524.83 5651.85,-499.15 5651.85,-499.15"/>
<polygon fill="black" stroke="black" points="5655.36,-499.15 5651.85,-489.15 5648.36,-499.15 5655.36,-499.15"/>
</g>
<!-- agg0_exp8 -->
<g id="node32" class="node">
<title>agg0_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="5651.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="5651.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="5651.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5651.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="5651.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp8&#45;&gt;agg0_exp8 -->
<g id="edge30" class="edge">
<title>expert0_exp8&#45;&gt;agg0_exp8</title>
<path fill="none" stroke="black" d="M5651.85,-420.97C5651.85,-420.97 5651.85,-395.17 5651.85,-395.17"/>
<polygon fill="black" stroke="black" points="5655.36,-395.17 5651.85,-385.17 5648.36,-395.17 5655.36,-395.17"/>
</g>
<!-- agg0_exp8&#45;&gt;moe_agg0 -->
<g id="edge60" class="edge">
<title>agg0_exp8&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M5651.85,-288.64C5651.85,-288.64 5651.85,-263.22 5651.85,-263.22"/>
<polygon fill="black" stroke="black" points="5655.36,-263.22 5651.85,-253.22 5648.36,-263.22 5655.36,-263.22"/>
</g>
<!-- expert0_exp9 -->
<g id="node34" class="node">
<title>expert0_exp9</title>
<polygon fill="lightcoral" stroke="black" points="6491.35,-489.12 6134.35,-489.12 6134.35,-421.12 6491.35,-421.12 6491.35,-489.12"/>
<text text-anchor="middle" x="6312.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 9</text>
<text text-anchor="middle" x="6312.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6312.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6312.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp9&#45;&gt;expert0_exp9 -->
<g id="edge32" class="edge">
<title>route0_exp9&#45;&gt;expert0_exp9</title>
<path fill="none" stroke="black" d="M6312.85,-524.83C6312.85,-524.83 6312.85,-499.15 6312.85,-499.15"/>
<polygon fill="black" stroke="black" points="6316.36,-499.15 6312.85,-489.15 6309.36,-499.15 6316.36,-499.15"/>
</g>
<!-- agg0_exp9 -->
<g id="node35" class="node">
<title>agg0_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="6317.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="6317.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="6317.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6317.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6317.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp9&#45;&gt;agg0_exp9 -->
<g id="edge33" class="edge">
<title>expert0_exp9&#45;&gt;agg0_exp9</title>
<path fill="none" stroke="black" d="M6312.85,-420.97C6312.85,-420.97 6312.85,-395.17 6312.85,-395.17"/>
<polygon fill="black" stroke="black" points="6316.36,-395.17 6312.85,-385.17 6309.36,-395.17 6316.36,-395.17"/>
</g>
<!-- agg0_exp9&#45;&gt;moe_agg0 -->
<g id="edge61" class="edge">
<title>agg0_exp9&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M5993.63,-337C5986.24,-337 5982.07,-337 5982.07,-337 5982.07,-337 5982.07,-233.08 5982.07,-233.08"/>
<polygon fill="black" stroke="black" points="5985.57,-233.08 5982.07,-223.08 5978.57,-233.08 5985.57,-233.08"/>
</g>
<!-- expert0_exp10 -->
<g id="node37" class="node">
<title>expert0_exp10</title>
<polygon fill="lightcoral" stroke="black" points="7149.35,-489.12 6792.35,-489.12 6792.35,-421.12 7149.35,-421.12 7149.35,-489.12"/>
<text text-anchor="middle" x="6970.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 10</text>
<text text-anchor="middle" x="6970.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6970.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6970.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp10&#45;&gt;expert0_exp10 -->
<g id="edge35" class="edge">
<title>route0_exp10&#45;&gt;expert0_exp10</title>
<path fill="none" stroke="black" d="M6970.85,-524.83C6970.85,-524.83 6970.85,-499.15 6970.85,-499.15"/>
<polygon fill="black" stroke="black" points="6974.36,-499.15 6970.85,-489.15 6967.36,-499.15 6974.36,-499.15"/>
</g>
<!-- agg0_exp10 -->
<g id="node38" class="node">
<title>agg0_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="6983.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="6983.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="6983.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6983.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="6983.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp10&#45;&gt;agg0_exp10 -->
<g id="edge36" class="edge">
<title>expert0_exp10&#45;&gt;agg0_exp10</title>
<path fill="none" stroke="black" d="M6970.85,-420.97C6970.85,-420.97 6970.85,-395.17 6970.85,-395.17"/>
<polygon fill="black" stroke="black" points="6974.36,-395.17 6970.85,-385.17 6967.36,-395.17 6974.36,-395.17"/>
</g>
<!-- agg0_exp10&#45;&gt;moe_agg0 -->
<g id="edge62" class="edge">
<title>agg0_exp10&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M6983.85,-288.69C6983.85,-253.51 6983.85,-212 6983.85,-212 6983.85,-212 5997.11,-212 5997.11,-212"/>
<polygon fill="black" stroke="black" points="5997.11,-208.5 5987.11,-212 5997.11,-215.5 5997.11,-208.5"/>
</g>
<!-- expert0_exp11 -->
<g id="node40" class="node">
<title>expert0_exp11</title>
<polygon fill="lightcoral" stroke="black" points="7814.35,-489.12 7457.35,-489.12 7457.35,-421.12 7814.35,-421.12 7814.35,-489.12"/>
<text text-anchor="middle" x="7635.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 11</text>
<text text-anchor="middle" x="7635.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7635.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="7635.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp11&#45;&gt;expert0_exp11 -->
<g id="edge38" class="edge">
<title>route0_exp11&#45;&gt;expert0_exp11</title>
<path fill="none" stroke="black" d="M7635.85,-524.83C7635.85,-524.83 7635.85,-499.15 7635.85,-499.15"/>
<polygon fill="black" stroke="black" points="7639.36,-499.15 7635.85,-489.15 7632.36,-499.15 7639.36,-499.15"/>
</g>
<!-- agg0_exp11 -->
<g id="node41" class="node">
<title>agg0_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="7649.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="7649.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="7649.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7649.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="7649.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp11&#45;&gt;agg0_exp11 -->
<g id="edge39" class="edge">
<title>expert0_exp11&#45;&gt;agg0_exp11</title>
<path fill="none" stroke="black" d="M7635.85,-420.97C7635.85,-420.97 7635.85,-395.17 7635.85,-395.17"/>
<polygon fill="black" stroke="black" points="7639.36,-395.17 7635.85,-385.17 7632.36,-395.17 7639.36,-395.17"/>
</g>
<!-- agg0_exp11&#45;&gt;moe_agg0 -->
<g id="edge63" class="edge">
<title>agg0_exp11&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M7627.93,-288.99C7627.93,-251.94 7627.93,-207 7627.93,-207 7627.93,-207 5989.83,-207 5989.83,-207"/>
<polygon fill="black" stroke="black" points="5989.83,-203.5 5979.83,-207 5989.83,-210.5 5989.83,-203.5"/>
</g>
<!-- expert0_exp12 -->
<g id="node43" class="node">
<title>expert0_exp12</title>
<polygon fill="lightcoral" stroke="black" points="8478.35,-489.12 8121.35,-489.12 8121.35,-421.12 8478.35,-421.12 8478.35,-489.12"/>
<text text-anchor="middle" x="8299.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 12</text>
<text text-anchor="middle" x="8299.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8299.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8299.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp12&#45;&gt;expert0_exp12 -->
<g id="edge41" class="edge">
<title>route0_exp12&#45;&gt;expert0_exp12</title>
<path fill="none" stroke="black" d="M8299.85,-525.17C8299.85,-525.17 8299.85,-499.35 8299.85,-499.35"/>
<polygon fill="black" stroke="black" points="8303.36,-499.35 8299.85,-489.35 8296.36,-499.35 8303.36,-499.35"/>
</g>
<!-- agg0_exp12 -->
<g id="node44" class="node">
<title>agg0_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="8315.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="8315.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="8315.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8315.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8315.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp12&#45;&gt;agg0_exp12 -->
<g id="edge42" class="edge">
<title>expert0_exp12&#45;&gt;agg0_exp12</title>
<path fill="none" stroke="black" d="M8299.85,-420.97C8299.85,-420.97 8299.85,-395.17 8299.85,-395.17"/>
<polygon fill="black" stroke="black" points="8303.36,-395.17 8299.85,-385.17 8296.36,-395.17 8303.36,-395.17"/>
</g>
<!-- agg0_exp12&#45;&gt;moe_agg0 -->
<g id="edge64" class="edge">
<title>agg0_exp12&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M8189.93,-292.45C8189.93,-253.11 8189.93,-202 8189.93,-202 8189.93,-202 5975.94,-202 5975.94,-202"/>
<polygon fill="black" stroke="black" points="5975.94,-198.5 5965.94,-202 5975.94,-205.5 5975.94,-198.5"/>
</g>
<!-- expert0_exp13 -->
<g id="node46" class="node">
<title>expert0_exp13</title>
<polygon fill="lightcoral" stroke="black" points="9143.35,-489.12 8786.35,-489.12 8786.35,-421.12 9143.35,-421.12 9143.35,-489.12"/>
<text text-anchor="middle" x="8964.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 13</text>
<text text-anchor="middle" x="8964.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="8964.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8964.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp13&#45;&gt;expert0_exp13 -->
<g id="edge44" class="edge">
<title>route0_exp13&#45;&gt;expert0_exp13</title>
<path fill="none" stroke="black" d="M8964.85,-525.17C8964.85,-525.17 8964.85,-499.35 8964.85,-499.35"/>
<polygon fill="black" stroke="black" points="8968.36,-499.35 8964.85,-489.35 8961.36,-499.35 8968.36,-499.35"/>
</g>
<!-- agg0_exp13 -->
<g id="node47" class="node">
<title>agg0_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="8981.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="8981.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="8981.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="8981.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="8981.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp13&#45;&gt;agg0_exp13 -->
<g id="edge45" class="edge">
<title>expert0_exp13&#45;&gt;agg0_exp13</title>
<path fill="none" stroke="black" d="M8964.85,-420.97C8964.85,-420.97 8964.85,-395.17 8964.85,-395.17"/>
<polygon fill="black" stroke="black" points="8968.36,-395.17 8964.85,-385.17 8961.36,-395.17 8968.36,-395.17"/>
</g>
<!-- agg0_exp13&#45;&gt;moe_agg0 -->
<g id="edge65" class="edge">
<title>agg0_exp13&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M8981.85,-288.84C8981.85,-248.34 8981.85,-197 8981.85,-197 8981.85,-197 5954.82,-197 5954.82,-197"/>
<polygon fill="black" stroke="black" points="5954.82,-193.5 5944.82,-197 5954.82,-200.5 5954.82,-193.5"/>
</g>
<!-- expert0_exp14 -->
<g id="node49" class="node">
<title>expert0_exp14</title>
<polygon fill="lightcoral" stroke="black" points="9808.35,-489.12 9451.35,-489.12 9451.35,-421.12 9808.35,-421.12 9808.35,-489.12"/>
<text text-anchor="middle" x="9629.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 14</text>
<text text-anchor="middle" x="9629.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="9629.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="9629.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp14&#45;&gt;expert0_exp14 -->
<g id="edge47" class="edge">
<title>route0_exp14&#45;&gt;expert0_exp14</title>
<path fill="none" stroke="black" d="M9629.85,-525.17C9629.85,-525.17 9629.85,-499.35 9629.85,-499.35"/>
<polygon fill="black" stroke="black" points="9633.36,-499.35 9629.85,-489.35 9626.36,-499.35 9633.36,-499.35"/>
</g>
<!-- agg0_exp14 -->
<g id="node50" class="node">
<title>agg0_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="9647.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="9647.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="9647.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="9647.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="9647.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp14&#45;&gt;agg0_exp14 -->
<g id="edge48" class="edge">
<title>expert0_exp14&#45;&gt;agg0_exp14</title>
<path fill="none" stroke="black" d="M9629.85,-420.97C9629.85,-420.97 9629.85,-395.17 9629.85,-395.17"/>
<polygon fill="black" stroke="black" points="9633.36,-395.17 9629.85,-385.17 9626.36,-395.17 9633.36,-395.17"/>
</g>
<!-- agg0_exp14&#45;&gt;moe_agg0 -->
<g id="edge66" class="edge">
<title>agg0_exp14&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M9647.85,-288.74C9647.85,-246.55 9647.85,-192 9647.85,-192 9647.85,-192 5924.43,-192 5924.43,-192"/>
<polygon fill="black" stroke="black" points="5924.43,-188.5 5914.43,-192 5924.43,-195.5 5924.43,-188.5"/>
</g>
<!-- expert0_exp15 -->
<g id="node52" class="node">
<title>expert0_exp15</title>
<polygon fill="lightcoral" stroke="black" points="10477.35,-489.12 10120.35,-489.12 10120.35,-421.12 10477.35,-421.12 10477.35,-489.12"/>
<text text-anchor="middle" x="10298.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 15</text>
<text text-anchor="middle" x="10298.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="10298.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="10298.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route0_exp15&#45;&gt;expert0_exp15 -->
<g id="edge50" class="edge">
<title>route0_exp15&#45;&gt;expert0_exp15</title>
<path fill="none" stroke="black" d="M10298.85,-525.17C10298.85,-525.17 10298.85,-499.35 10298.85,-499.35"/>
<polygon fill="black" stroke="black" points="10302.36,-499.35 10298.85,-489.35 10295.36,-499.35 10302.36,-499.35"/>
</g>
<!-- agg0_exp15 -->
<g id="node53" class="node">
<title>agg0_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="10313.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="10313.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="10313.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="10313.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="10313.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert0_exp15&#45;&gt;agg0_exp15 -->
<g id="edge51" class="edge">
<title>expert0_exp15&#45;&gt;agg0_exp15</title>
<path fill="none" stroke="black" d="M10298.85,-420.97C10298.85,-420.97 10298.85,-395.17 10298.85,-395.17"/>
<polygon fill="black" stroke="black" points="10302.36,-395.17 10298.85,-385.17 10295.36,-395.17 10302.36,-395.17"/>
</g>
<!-- agg0_exp15&#45;&gt;moe_agg0 -->
<g id="edge67" class="edge">
<title>agg0_exp15&#45;&gt;moe_agg0</title>
<path fill="none" stroke="black" d="M10313.85,-288.74C10313.85,-244.88 10313.85,-187 10313.85,-187 10313.85,-187 5880.85,-187 5880.85,-187"/>
<polygon fill="black" stroke="black" points="5880.85,-183.5 5870.85,-187 5880.85,-190.5 5880.85,-183.5"/>
</g>
<!-- moe_agg0&#45;&gt;moe0 -->
<g id="edge68" class="edge">
<title>moe_agg0&#45;&gt;moe0</title>
<path fill="none" stroke="black" d="M5803.2,-182C6315.38,-182 7951.78,-182 7951.78,-182 7951.78,-182 7951.78,-152.4 7951.78,-152.4"/>
<polygon fill="black" stroke="black" points="7955.28,-152.4 7951.78,-142.4 7948.28,-152.4 7955.28,-152.4"/>
</g>
<!-- mha7 -->
<g id="node56" class="node">
<title>mha7</title>
<polygon fill="lightcyan" stroke="black" points="19081.85,-956.29 18623.85,-956.29 18623.85,-903.29 19081.85,-903.29 19081.85,-956.29"/>
<text text-anchor="middle" x="18852.85" y="-941.09" font-family="Times,serif" font-size="14.00">MHA Layer 7</text>
<text text-anchor="middle" x="18852.85" y="-926.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18852.85" y="-911.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_7 -->
<g id="node59" class="node">
<title>add1_7</title>
<polygon fill="yellow" stroke="black" points="19081.85,-867.29 18623.85,-867.29 18623.85,-799.29 19081.85,-799.29 19081.85,-867.29"/>
<text text-anchor="middle" x="18852.85" y="-852.09" font-family="Times,serif" font-size="14.00">MHA Residual Add 7</text>
<text text-anchor="middle" x="18852.85" y="-837.09" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18852.85" y="-822.09" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18852.85" y="-807.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha7&#45;&gt;add1_7 -->
<g id="edge71" class="edge">
<title>mha7&#45;&gt;add1_7</title>
<path fill="none" stroke="black" d="M18852.85,-903.16C18852.85,-903.16 18852.85,-877.43 18852.85,-877.43"/>
<polygon fill="black" stroke="black" points="18856.36,-877.43 18852.85,-867.43 18849.36,-877.43 18856.36,-877.43"/>
</g>
<!-- moe6 -->
<g id="node57" class="node">
<title>moe6</title>
<ellipse fill="none" stroke="black" cx="18852.85" cy="-1018.79" rx="36.29" ry="18"/>
<text text-anchor="middle" x="18852.85" y="-1015.09" font-family="Times,serif" font-size="14.00">moe6</text>
</g>
<!-- moe6&#45;&gt;mha7 -->
<g id="edge70" class="edge">
<title>moe6&#45;&gt;mha7</title>
<path fill="none" stroke="black" d="M18852.85,-1000.78C18852.85,-1000.78 18852.85,-966.55 18852.85,-966.55"/>
<polygon fill="black" stroke="black" points="18856.36,-966.55 18852.85,-956.55 18849.36,-966.55 18856.36,-966.55"/>
</g>
<!-- ln1_7 -->
<g id="node58" class="node">
<title>ln1_7</title>
<polygon fill="none" stroke="black" points="26932.85,-1045.29 26474.85,-1045.29 26474.85,-992.29 26932.85,-992.29 26932.85,-1045.29"/>
<text text-anchor="middle" x="26703.85" y="-1030.09" font-family="Times,serif" font-size="14.00">LayerNorm 7</text>
<text text-anchor="middle" x="26703.85" y="-1015.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="26703.85" y="-1000.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- gate7 -->
<g id="node60" class="node">
<title>gate7</title>
<polygon fill="lightgreen" stroke="black" points="16812.43,-763.29 16070.21,-763.29 15879.28,-657.29 16621.5,-657.29 16812.43,-763.29"/>
<text text-anchor="middle" x="16345.85" y="-721.59" font-family="Times,serif" font-size="14.00">Gate Layer 7</text>
<text text-anchor="middle" x="16345.85" y="-706.59" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="16345.85" y="-691.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
</g>
<!-- add1_7&#45;&gt;gate7 -->
<g id="edge72" class="edge">
<title>add1_7&#45;&gt;gate7</title>
<path fill="none" stroke="black" d="M18634.04,-798.99C18634.04,-765.65 18634.04,-720 18634.04,-720 18634.04,-720 16744.66,-720 16744.66,-720"/>
<polygon fill="black" stroke="black" points="16744.66,-716.5 16734.66,-720 16744.66,-723.5 16744.66,-716.5"/>
</g>
<!-- moe7 -->
<g id="node110" class="node">
<title>moe7</title>
<polygon fill="yellow" stroke="black" points="19081.85,-142 18623.85,-142 18623.85,-74 19081.85,-74 19081.85,-142"/>
<text text-anchor="middle" x="18852.85" y="-126.8" font-family="Times,serif" font-size="14.00">MoE Residual Add 7</text>
<text text-anchor="middle" x="18852.85" y="-111.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18852.85" y="-96.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18852.85" y="-81.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_7&#45;&gt;moe7 -->
<g id="edge138" class="edge">
<title>add1_7&#45;&gt;moe7</title>
<path fill="none" stroke="black" d="M18673.1,-799.28C18673.1,-799.28 18673.1,-152.36 18673.1,-152.36"/>
<polygon fill="black" stroke="black" points="18676.6,-152.36 18673.1,-142.36 18669.6,-152.36 18676.6,-152.36"/>
</g>
<!-- route7_exp0 -->
<g id="node61" class="node">
<title>route7_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="11029.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="11029.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="11029.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="11029.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11029.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp0 -->
<g id="edge73" class="edge">
<title>gate7&#45;&gt;route7_exp0</title>
<path fill="none" stroke="black" d="M16056.74,-756C14948.05,-756 11029.85,-756 11029.85,-756 11029.85,-756 11029.85,-631.71 11029.85,-631.71"/>
<polygon fill="black" stroke="black" points="11033.36,-631.71 11029.85,-621.71 11026.36,-631.71 11033.36,-631.71"/>
</g>
<!-- route7_exp1 -->
<g id="node64" class="node">
<title>route7_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="11705.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="11705.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="11705.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="11705.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="11705.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp1 -->
<g id="edge76" class="edge">
<title>gate7&#45;&gt;route7_exp1</title>
<path fill="none" stroke="black" d="M16044.09,-749C15014.87,-749 11705.85,-749 11705.85,-749 11705.85,-749 11705.85,-631.71 11705.85,-631.71"/>
<polygon fill="black" stroke="black" points="11709.36,-631.71 11705.85,-621.71 11702.36,-631.71 11709.36,-631.71"/>
</g>
<!-- route7_exp2 -->
<g id="node67" class="node">
<title>route7_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="12364.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="12364.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="12364.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="12364.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="12364.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp2 -->
<g id="edge79" class="edge">
<title>gate7&#45;&gt;route7_exp2</title>
<path fill="none" stroke="black" d="M16031.64,-742C15134.86,-742 12627.54,-742 12627.54,-742 12627.54,-742 12627.54,-609.95 12627.54,-609.95"/>
<polygon fill="black" stroke="black" points="12631.04,-609.95 12627.54,-599.95 12624.04,-609.95 12631.04,-609.95"/>
</g>
<!-- route7_exp3 -->
<g id="node70" class="node">
<title>route7_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="13018.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="13018.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="13018.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13018.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="13018.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp3 -->
<g id="edge82" class="edge">
<title>gate7&#45;&gt;route7_exp3</title>
<path fill="none" stroke="black" d="M16018.89,-735C15180.36,-735 13018.85,-735 13018.85,-735 13018.85,-735 13018.85,-631.31 13018.85,-631.31"/>
<polygon fill="black" stroke="black" points="13022.36,-631.31 13018.85,-621.31 13015.36,-631.31 13022.36,-631.31"/>
</g>
<!-- route7_exp4 -->
<g id="node73" class="node">
<title>route7_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="13709.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="13709.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="13709.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="13709.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="13709.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp4 -->
<g id="edge85" class="edge">
<title>gate7&#45;&gt;route7_exp4</title>
<path fill="none" stroke="black" d="M16004.62,-727C15291.71,-727 13709.85,-727 13709.85,-727 13709.85,-727 13709.85,-631.44 13709.85,-631.44"/>
<polygon fill="black" stroke="black" points="13713.36,-631.44 13709.85,-621.44 13706.36,-631.44 13713.36,-631.44"/>
</g>
<!-- route7_exp5 -->
<g id="node76" class="node">
<title>route7_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="14379.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="14379.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="14379.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14379.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="14379.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp5 -->
<g id="edge88" class="edge">
<title>gate7&#45;&gt;route7_exp5</title>
<path fill="none" stroke="black" d="M15916.53,-678C15338.03,-678 14379.85,-678 14379.85,-678 14379.85,-678 14379.85,-631.31 14379.85,-631.31"/>
<polygon fill="black" stroke="black" points="14383.36,-631.31 14379.85,-621.31 14376.36,-631.31 14383.36,-631.31"/>
</g>
<!-- route7_exp6 -->
<g id="node79" class="node">
<title>route7_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="15039.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="15039.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="15039.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="15039.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="15039.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp6 -->
<g id="edge91" class="edge">
<title>gate7&#45;&gt;route7_exp6</title>
<path fill="none" stroke="black" d="M15890.91,-664C15514,-664 15039.85,-664 15039.85,-664 15039.85,-664 15039.85,-631.53 15039.85,-631.53"/>
<polygon fill="black" stroke="black" points="15043.36,-631.53 15039.85,-621.53 15036.36,-631.53 15043.36,-631.53"/>
</g>
<!-- route7_exp7 -->
<g id="node82" class="node">
<title>route7_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="15693.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="15693.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="15693.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="15693.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="15693.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp7 -->
<g id="edge94" class="edge">
<title>gate7&#45;&gt;route7_exp7</title>
<path fill="none" stroke="black" d="M15944.27,-656.89C15944.27,-656.89 15944.27,-612.52 15944.27,-612.52"/>
<polygon fill="black" stroke="black" points="15947.77,-612.52 15944.27,-602.52 15940.77,-612.52 15947.77,-612.52"/>
</g>
<!-- route7_exp8 -->
<g id="node85" class="node">
<title>route7_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="16345.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="16345.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="16345.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="16345.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="16345.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp8 -->
<g id="edge97" class="edge">
<title>gate7&#45;&gt;route7_exp8</title>
<path fill="none" stroke="black" d="M16345.85,-656.89C16345.85,-656.89 16345.85,-631.31 16345.85,-631.31"/>
<polygon fill="black" stroke="black" points="16349.36,-631.31 16345.85,-621.31 16342.36,-631.31 16349.36,-631.31"/>
</g>
<!-- route7_exp9 -->
<g id="node88" class="node">
<title>route7_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="17002.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="17002.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="17002.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="17002.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="17002.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp9 -->
<g id="edge100" class="edge">
<title>gate7&#45;&gt;route7_exp9</title>
<path fill="none" stroke="black" d="M16749.94,-710.19C16749.94,-710.19 16749.94,-612.14 16749.94,-612.14"/>
<polygon fill="black" stroke="black" points="16753.44,-612.14 16749.94,-602.14 16746.44,-612.14 16753.44,-612.14"/>
</g>
<!-- route7_exp10 -->
<g id="node91" class="node">
<title>route7_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="17664.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="17664.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="17664.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="17664.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="17664.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp10 -->
<g id="edge103" class="edge">
<title>gate7&#45;&gt;route7_exp10</title>
<path fill="none" stroke="black" d="M16646.39,-671C17035.65,-671 17664.85,-671 17664.85,-671 17664.85,-671 17664.85,-631.53 17664.85,-631.53"/>
<polygon fill="black" stroke="black" points="17668.36,-631.53 17664.85,-621.53 17661.36,-631.53 17668.36,-631.53"/>
</g>
<!-- route7_exp11 -->
<g id="node94" class="node">
<title>route7_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="18328.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="18328.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="18328.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="18328.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18328.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp11 -->
<g id="edge106" class="edge">
<title>gate7&#45;&gt;route7_exp11</title>
<path fill="none" stroke="black" d="M16671.63,-685C17231.96,-685 18318.67,-685 18318.67,-685 18318.67,-685 18318.67,-631.26 18318.67,-631.26"/>
<polygon fill="black" stroke="black" points="18322.17,-631.26 18318.67,-621.26 18315.17,-631.26 18322.17,-631.26"/>
</g>
<!-- route7_exp12 -->
<g id="node97" class="node">
<title>route7_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="18993.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="18993.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="18993.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="18993.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="18993.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp12 -->
<g id="edge109" class="edge">
<title>gate7&#45;&gt;route7_exp12</title>
<path fill="none" stroke="black" d="M16684.03,-692C17374.16,-692 18880.17,-692 18880.17,-692 18880.17,-692 18880.17,-628.12 18880.17,-628.12"/>
<polygon fill="black" stroke="black" points="18883.67,-628.12 18880.17,-618.12 18876.67,-628.12 18883.67,-628.12"/>
</g>
<!-- route7_exp13 -->
<g id="node100" class="node">
<title>route7_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="19651.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="19651.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="19651.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="19651.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="19651.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp13 -->
<g id="edge112" class="edge">
<title>gate7&#45;&gt;route7_exp13</title>
<path fill="none" stroke="black" d="M16696.92,-699C17548.01,-699 19651.85,-699 19651.85,-699 19651.85,-699 19651.85,-631.48 19651.85,-631.48"/>
<polygon fill="black" stroke="black" points="19655.36,-631.48 19651.85,-621.48 19648.36,-631.48 19655.36,-631.48"/>
</g>
<!-- route7_exp14 -->
<g id="node103" class="node">
<title>route7_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="20308.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="20308.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="20308.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="20308.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="20308.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp14 -->
<g id="edge115" class="edge">
<title>gate7&#45;&gt;route7_exp14</title>
<path fill="none" stroke="black" d="M16709.37,-706C17688.72,-706 20308.85,-706 20308.85,-706 20308.85,-706 20308.85,-631.52 20308.85,-631.52"/>
<polygon fill="black" stroke="black" points="20312.36,-631.52 20308.85,-621.52 20305.36,-631.52 20312.36,-631.52"/>
</g>
<!-- route7_exp15 -->
<g id="node106" class="node">
<title>route7_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="20976.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="20976.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="20976.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="20976.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="20976.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate7&#45;&gt;route7_exp15 -->
<g id="edge118" class="edge">
<title>gate7&#45;&gt;route7_exp15</title>
<path fill="none" stroke="black" d="M16721.89,-713C17825.25,-713 20976.85,-713 20976.85,-713 20976.85,-713 20976.85,-631.31 20976.85,-631.31"/>
<polygon fill="black" stroke="black" points="20980.36,-631.31 20976.85,-621.31 20973.36,-631.31 20980.36,-631.31"/>
</g>
<!-- expert7_exp0 -->
<g id="node62" class="node">
<title>expert7_exp0</title>
<polygon fill="lightcoral" stroke="black" points="11200.35,-489.12 10843.35,-489.12 10843.35,-421.12 11200.35,-421.12 11200.35,-489.12"/>
<text text-anchor="middle" x="11021.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 0</text>
<text text-anchor="middle" x="11021.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="11021.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11021.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp0&#45;&gt;expert7_exp0 -->
<g id="edge74" class="edge">
<title>route7_exp0&#45;&gt;expert7_exp0</title>
<path fill="none" stroke="black" d="M11021.85,-524.83C11021.85,-524.83 11021.85,-499.15 11021.85,-499.15"/>
<polygon fill="black" stroke="black" points="11025.36,-499.15 11021.85,-489.15 11018.36,-499.15 11025.36,-499.15"/>
</g>
<!-- agg7_exp0 -->
<g id="node63" class="node">
<title>agg7_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="11017.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="11017.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="11017.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="11017.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11017.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp0&#45;&gt;agg7_exp0 -->
<g id="edge75" class="edge">
<title>expert7_exp0&#45;&gt;agg7_exp0</title>
<path fill="none" stroke="black" d="M11021.85,-420.97C11021.85,-420.97 11021.85,-395.17 11021.85,-395.17"/>
<polygon fill="black" stroke="black" points="11025.36,-395.17 11021.85,-385.17 11018.36,-395.17 11025.36,-395.17"/>
</g>
<!-- moe_agg7 -->
<g id="node109" class="node">
<title>moe_agg7</title>
<ellipse fill="gold" stroke="black" cx="16345.85" cy="-215.48" rx="336.67" ry="37.45"/>
<text text-anchor="middle" x="16345.85" y="-226.78" font-family="Times,serif" font-size="14.00">MoE Final Aggregation 7</text>
<text text-anchor="middle" x="16345.85" y="-211.78" font-family="Times,serif" font-size="14.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="16345.85" y="-196.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- agg7_exp0&#45;&gt;moe_agg7 -->
<g id="edge121" class="edge">
<title>agg7_exp0&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M11017.85,-288.9C11017.85,-255.51 11017.85,-217 11017.85,-217 11017.85,-217 15999.54,-217 15999.54,-217"/>
<polygon fill="black" stroke="black" points="15999.54,-220.5 16009.54,-217 15999.54,-213.5 15999.54,-220.5"/>
</g>
<!-- expert7_exp1 -->
<g id="node65" class="node">
<title>expert7_exp1</title>
<polygon fill="lightcoral" stroke="black" points="11875.35,-489.12 11518.35,-489.12 11518.35,-421.12 11875.35,-421.12 11875.35,-489.12"/>
<text text-anchor="middle" x="11696.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 1</text>
<text text-anchor="middle" x="11696.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="11696.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11696.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp1&#45;&gt;expert7_exp1 -->
<g id="edge77" class="edge">
<title>route7_exp1&#45;&gt;expert7_exp1</title>
<path fill="none" stroke="black" d="M11696.85,-524.83C11696.85,-524.83 11696.85,-499.15 11696.85,-499.15"/>
<polygon fill="black" stroke="black" points="11700.36,-499.15 11696.85,-489.15 11693.36,-499.15 11700.36,-499.15"/>
</g>
<!-- agg7_exp1 -->
<g id="node66" class="node">
<title>agg7_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="11683.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="11683.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="11683.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="11683.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="11683.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp1&#45;&gt;agg7_exp1 -->
<g id="edge78" class="edge">
<title>expert7_exp1&#45;&gt;agg7_exp1</title>
<path fill="none" stroke="black" d="M11696.85,-420.97C11696.85,-420.97 11696.85,-395.17 11696.85,-395.17"/>
<polygon fill="black" stroke="black" points="11700.36,-395.17 11696.85,-385.17 11693.36,-395.17 11700.36,-395.17"/>
</g>
<!-- agg7_exp1&#45;&gt;moe_agg7 -->
<g id="edge122" class="edge">
<title>agg7_exp1&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M11683.85,-288.92C11683.85,-257.39 11683.85,-222 11683.85,-222 11683.85,-222 16004.31,-222 16004.31,-222"/>
<polygon fill="black" stroke="black" points="16004.31,-225.5 16014.31,-222 16004.31,-218.5 16004.31,-225.5"/>
</g>
<!-- expert7_exp2 -->
<g id="node68" class="node">
<title>expert7_exp2</title>
<polygon fill="lightcoral" stroke="black" points="12533.35,-489.12 12176.35,-489.12 12176.35,-421.12 12533.35,-421.12 12533.35,-489.12"/>
<text text-anchor="middle" x="12354.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 2</text>
<text text-anchor="middle" x="12354.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="12354.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="12354.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp2&#45;&gt;expert7_exp2 -->
<g id="edge80" class="edge">
<title>route7_exp2&#45;&gt;expert7_exp2</title>
<path fill="none" stroke="black" d="M12354.85,-524.83C12354.85,-524.83 12354.85,-499.15 12354.85,-499.15"/>
<polygon fill="black" stroke="black" points="12358.36,-499.15 12354.85,-489.15 12351.36,-499.15 12358.36,-499.15"/>
</g>
<!-- agg7_exp2 -->
<g id="node69" class="node">
<title>agg7_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="12349.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="12349.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="12349.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="12349.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="12349.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp2&#45;&gt;agg7_exp2 -->
<g id="edge81" class="edge">
<title>expert7_exp2&#45;&gt;agg7_exp2</title>
<path fill="none" stroke="black" d="M12354.85,-420.97C12354.85,-420.97 12354.85,-395.17 12354.85,-395.17"/>
<polygon fill="black" stroke="black" points="12358.36,-395.17 12354.85,-385.17 12351.36,-395.17 12358.36,-395.17"/>
</g>
<!-- agg7_exp2&#45;&gt;moe_agg7 -->
<g id="edge123" class="edge">
<title>agg7_exp2&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M12349.85,-288.77C12349.85,-259.21 12349.85,-227 12349.85,-227 12349.85,-227 16015.18,-227 16015.18,-227"/>
<polygon fill="black" stroke="black" points="16015.18,-230.5 16025.18,-227 16015.18,-223.5 16015.18,-230.5"/>
</g>
<!-- expert7_exp3 -->
<g id="node71" class="node">
<title>expert7_exp3</title>
<polygon fill="lightcoral" stroke="black" points="13195.35,-489.12 12838.35,-489.12 12838.35,-421.12 13195.35,-421.12 13195.35,-489.12"/>
<text text-anchor="middle" x="13016.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 3</text>
<text text-anchor="middle" x="13016.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13016.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13016.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp3&#45;&gt;expert7_exp3 -->
<g id="edge83" class="edge">
<title>route7_exp3&#45;&gt;expert7_exp3</title>
<path fill="none" stroke="black" d="M13016.85,-524.83C13016.85,-524.83 13016.85,-499.15 13016.85,-499.15"/>
<polygon fill="black" stroke="black" points="13020.36,-499.15 13016.85,-489.15 13013.36,-499.15 13020.36,-499.15"/>
</g>
<!-- agg7_exp3 -->
<g id="node72" class="node">
<title>agg7_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="13015.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="13015.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="13015.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13015.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13015.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp3&#45;&gt;agg7_exp3 -->
<g id="edge84" class="edge">
<title>expert7_exp3&#45;&gt;agg7_exp3</title>
<path fill="none" stroke="black" d="M13016.85,-420.97C13016.85,-420.97 13016.85,-395.17 13016.85,-395.17"/>
<polygon fill="black" stroke="black" points="13020.36,-395.17 13016.85,-385.17 13013.36,-395.17 13020.36,-395.17"/>
</g>
<!-- agg7_exp3&#45;&gt;moe_agg7 -->
<g id="edge124" class="edge">
<title>agg7_exp3&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M13015.85,-288.82C13015.85,-261.21 13015.85,-232 13015.85,-232 13015.85,-232 16033.73,-232 16033.73,-232"/>
<polygon fill="black" stroke="black" points="16033.73,-235.5 16043.73,-232 16033.73,-228.5 16033.73,-235.5"/>
</g>
<!-- expert7_exp4 -->
<g id="node74" class="node">
<title>expert7_exp4</title>
<polygon fill="lightcoral" stroke="black" points="13874.35,-489.12 13517.35,-489.12 13517.35,-421.12 13874.35,-421.12 13874.35,-489.12"/>
<text text-anchor="middle" x="13695.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 4</text>
<text text-anchor="middle" x="13695.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="13695.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13695.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp4&#45;&gt;expert7_exp4 -->
<g id="edge86" class="edge">
<title>route7_exp4&#45;&gt;expert7_exp4</title>
<path fill="none" stroke="black" d="M13695.85,-524.83C13695.85,-524.83 13695.85,-499.15 13695.85,-499.15"/>
<polygon fill="black" stroke="black" points="13699.36,-499.15 13695.85,-489.15 13692.36,-499.15 13699.36,-499.15"/>
</g>
<!-- agg7_exp4 -->
<g id="node75" class="node">
<title>agg7_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="13681.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="13681.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="13681.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="13681.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="13681.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp4&#45;&gt;agg7_exp4 -->
<g id="edge87" class="edge">
<title>expert7_exp4&#45;&gt;agg7_exp4</title>
<path fill="none" stroke="black" d="M13695.85,-420.97C13695.85,-420.97 13695.85,-395.17 13695.85,-395.17"/>
<polygon fill="black" stroke="black" points="13699.36,-395.17 13695.85,-385.17 13692.36,-395.17 13699.36,-395.17"/>
</g>
<!-- agg7_exp4&#45;&gt;moe_agg7 -->
<g id="edge125" class="edge">
<title>agg7_exp4&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M13681.85,-288.78C13681.85,-263.2 13681.85,-237 13681.85,-237 13681.85,-237 16060.17,-237 16060.17,-237"/>
<polygon fill="black" stroke="black" points="16060.17,-240.5 16070.17,-237 16060.17,-233.5 16060.17,-240.5"/>
</g>
<!-- expert7_exp5 -->
<g id="node77" class="node">
<title>expert7_exp5</title>
<polygon fill="lightcoral" stroke="black" points="14542.35,-489.12 14185.35,-489.12 14185.35,-421.12 14542.35,-421.12 14542.35,-489.12"/>
<text text-anchor="middle" x="14363.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 5</text>
<text text-anchor="middle" x="14363.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14363.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="14363.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp5&#45;&gt;expert7_exp5 -->
<g id="edge89" class="edge">
<title>route7_exp5&#45;&gt;expert7_exp5</title>
<path fill="none" stroke="black" d="M14363.85,-525.17C14363.85,-525.17 14363.85,-499.35 14363.85,-499.35"/>
<polygon fill="black" stroke="black" points="14367.36,-499.35 14363.85,-489.35 14360.36,-499.35 14367.36,-499.35"/>
</g>
<!-- agg7_exp5 -->
<g id="node78" class="node">
<title>agg7_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="14347.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="14347.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="14347.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14347.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="14347.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp5&#45;&gt;agg7_exp5 -->
<g id="edge90" class="edge">
<title>expert7_exp5&#45;&gt;agg7_exp5</title>
<path fill="none" stroke="black" d="M14363.85,-420.97C14363.85,-420.97 14363.85,-395.17 14363.85,-395.17"/>
<polygon fill="black" stroke="black" points="14367.36,-395.17 14363.85,-385.17 14360.36,-395.17 14367.36,-395.17"/>
</g>
<!-- agg7_exp5&#45;&gt;moe_agg7 -->
<g id="edge126" class="edge">
<title>agg7_exp5&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M14347.85,-288.68C14347.85,-265.21 14347.85,-242 14347.85,-242 14347.85,-242 16097.82,-242 16097.82,-242"/>
<polygon fill="black" stroke="black" points="16097.82,-245.5 16107.82,-242 16097.82,-238.5 16097.82,-245.5"/>
</g>
<!-- expert7_exp6 -->
<g id="node80" class="node">
<title>expert7_exp6</title>
<polygon fill="lightcoral" stroke="black" points="15205.35,-489.12 14848.35,-489.12 14848.35,-421.12 15205.35,-421.12 15205.35,-489.12"/>
<text text-anchor="middle" x="15026.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 6</text>
<text text-anchor="middle" x="15026.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="15026.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="15026.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp6&#45;&gt;expert7_exp6 -->
<g id="edge92" class="edge">
<title>route7_exp6&#45;&gt;expert7_exp6</title>
<path fill="none" stroke="black" d="M15026.85,-524.83C15026.85,-524.83 15026.85,-499.15 15026.85,-499.15"/>
<polygon fill="black" stroke="black" points="15030.36,-499.15 15026.85,-489.15 15023.36,-499.15 15030.36,-499.15"/>
</g>
<!-- agg7_exp6 -->
<g id="node81" class="node">
<title>agg7_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="15013.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="15013.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="15013.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="15013.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="15013.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp6&#45;&gt;agg7_exp6 -->
<g id="edge93" class="edge">
<title>expert7_exp6&#45;&gt;agg7_exp6</title>
<path fill="none" stroke="black" d="M15026.85,-420.97C15026.85,-420.97 15026.85,-395.17 15026.85,-395.17"/>
<polygon fill="black" stroke="black" points="15030.36,-395.17 15026.85,-385.17 15023.36,-395.17 15030.36,-395.17"/>
</g>
<!-- agg7_exp6&#45;&gt;moe_agg7 -->
<g id="edge127" class="edge">
<title>agg7_exp6&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M15013.85,-288.86C15013.85,-267.45 15013.85,-247 15013.85,-247 15013.85,-247 16153.79,-247 16153.79,-247"/>
<polygon fill="black" stroke="black" points="16153.79,-250.5 16163.79,-247 16153.79,-243.5 16153.79,-250.5"/>
</g>
<!-- expert7_exp7 -->
<g id="node83" class="node">
<title>expert7_exp7</title>
<polygon fill="lightcoral" stroke="black" points="15865.35,-489.12 15508.35,-489.12 15508.35,-421.12 15865.35,-421.12 15865.35,-489.12"/>
<text text-anchor="middle" x="15686.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 7</text>
<text text-anchor="middle" x="15686.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="15686.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="15686.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp7&#45;&gt;expert7_exp7 -->
<g id="edge95" class="edge">
<title>route7_exp7&#45;&gt;expert7_exp7</title>
<path fill="none" stroke="black" d="M15686.85,-524.83C15686.85,-524.83 15686.85,-499.15 15686.85,-499.15"/>
<polygon fill="black" stroke="black" points="15690.36,-499.15 15686.85,-489.15 15683.36,-499.15 15690.36,-499.15"/>
</g>
<!-- agg7_exp7 -->
<g id="node84" class="node">
<title>agg7_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="15679.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="15679.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="15679.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="15679.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="15679.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp7&#45;&gt;agg7_exp7 -->
<g id="edge96" class="edge">
<title>expert7_exp7&#45;&gt;agg7_exp7</title>
<path fill="none" stroke="black" d="M15686.85,-420.97C15686.85,-420.97 15686.85,-395.17 15686.85,-395.17"/>
<polygon fill="black" stroke="black" points="15690.36,-395.17 15686.85,-385.17 15683.36,-395.17 15690.36,-395.17"/>
</g>
<!-- agg7_exp7&#45;&gt;moe_agg7 -->
<g id="edge128" class="edge">
<title>agg7_exp7&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M16004.08,-337C16011.47,-337 16015.64,-337 16015.64,-337 16015.64,-337 16015.64,-233.08 16015.64,-233.08"/>
<polygon fill="black" stroke="black" points="16019.14,-233.08 16015.64,-223.08 16012.14,-233.08 16019.14,-233.08"/>
</g>
<!-- expert7_exp8 -->
<g id="node86" class="node">
<title>expert7_exp8</title>
<polygon fill="lightcoral" stroke="black" points="16524.35,-489.12 16167.35,-489.12 16167.35,-421.12 16524.35,-421.12 16524.35,-489.12"/>
<text text-anchor="middle" x="16345.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 8</text>
<text text-anchor="middle" x="16345.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="16345.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16345.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp8&#45;&gt;expert7_exp8 -->
<g id="edge98" class="edge">
<title>route7_exp8&#45;&gt;expert7_exp8</title>
<path fill="none" stroke="black" d="M16345.85,-524.83C16345.85,-524.83 16345.85,-499.15 16345.85,-499.15"/>
<polygon fill="black" stroke="black" points="16349.36,-499.15 16345.85,-489.15 16342.36,-499.15 16349.36,-499.15"/>
</g>
<!-- agg7_exp8 -->
<g id="node87" class="node">
<title>agg7_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="16345.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="16345.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="16345.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="16345.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="16345.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp8&#45;&gt;agg7_exp8 -->
<g id="edge99" class="edge">
<title>expert7_exp8&#45;&gt;agg7_exp8</title>
<path fill="none" stroke="black" d="M16345.85,-420.97C16345.85,-420.97 16345.85,-395.17 16345.85,-395.17"/>
<polygon fill="black" stroke="black" points="16349.36,-395.17 16345.85,-385.17 16342.36,-395.17 16349.36,-395.17"/>
</g>
<!-- agg7_exp8&#45;&gt;moe_agg7 -->
<g id="edge129" class="edge">
<title>agg7_exp8&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M16345.85,-288.64C16345.85,-288.64 16345.85,-263.22 16345.85,-263.22"/>
<polygon fill="black" stroke="black" points="16349.36,-263.22 16345.85,-253.22 16342.36,-263.22 16349.36,-263.22"/>
</g>
<!-- expert7_exp9 -->
<g id="node89" class="node">
<title>expert7_exp9</title>
<polygon fill="lightcoral" stroke="black" points="17185.35,-489.12 16828.35,-489.12 16828.35,-421.12 17185.35,-421.12 17185.35,-489.12"/>
<text text-anchor="middle" x="17006.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 9</text>
<text text-anchor="middle" x="17006.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="17006.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="17006.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp9&#45;&gt;expert7_exp9 -->
<g id="edge101" class="edge">
<title>route7_exp9&#45;&gt;expert7_exp9</title>
<path fill="none" stroke="black" d="M17006.85,-524.83C17006.85,-524.83 17006.85,-499.15 17006.85,-499.15"/>
<polygon fill="black" stroke="black" points="17010.36,-499.15 17006.85,-489.15 17003.36,-499.15 17010.36,-499.15"/>
</g>
<!-- agg7_exp9 -->
<g id="node90" class="node">
<title>agg7_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="17011.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="17011.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="17011.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="17011.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="17011.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp9&#45;&gt;agg7_exp9 -->
<g id="edge102" class="edge">
<title>expert7_exp9&#45;&gt;agg7_exp9</title>
<path fill="none" stroke="black" d="M17006.85,-420.97C17006.85,-420.97 17006.85,-395.17 17006.85,-395.17"/>
<polygon fill="black" stroke="black" points="17010.36,-395.17 17006.85,-385.17 17003.36,-395.17 17010.36,-395.17"/>
</g>
<!-- agg7_exp9&#45;&gt;moe_agg7 -->
<g id="edge130" class="edge">
<title>agg7_exp9&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M16687.63,-337C16680.24,-337 16676.07,-337 16676.07,-337 16676.07,-337 16676.07,-233.08 16676.07,-233.08"/>
<polygon fill="black" stroke="black" points="16679.57,-233.08 16676.07,-223.08 16672.57,-233.08 16679.57,-233.08"/>
</g>
<!-- expert7_exp10 -->
<g id="node92" class="node">
<title>expert7_exp10</title>
<polygon fill="lightcoral" stroke="black" points="17849.35,-489.12 17492.35,-489.12 17492.35,-421.12 17849.35,-421.12 17849.35,-489.12"/>
<text text-anchor="middle" x="17670.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 10</text>
<text text-anchor="middle" x="17670.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="17670.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="17670.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp10&#45;&gt;expert7_exp10 -->
<g id="edge104" class="edge">
<title>route7_exp10&#45;&gt;expert7_exp10</title>
<path fill="none" stroke="black" d="M17670.85,-524.83C17670.85,-524.83 17670.85,-499.15 17670.85,-499.15"/>
<polygon fill="black" stroke="black" points="17674.36,-499.15 17670.85,-489.15 17667.36,-499.15 17674.36,-499.15"/>
</g>
<!-- agg7_exp10 -->
<g id="node93" class="node">
<title>agg7_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="17677.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="17677.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="17677.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="17677.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="17677.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp10&#45;&gt;agg7_exp10 -->
<g id="edge105" class="edge">
<title>expert7_exp10&#45;&gt;agg7_exp10</title>
<path fill="none" stroke="black" d="M17670.85,-420.97C17670.85,-420.97 17670.85,-395.17 17670.85,-395.17"/>
<polygon fill="black" stroke="black" points="17674.36,-395.17 17670.85,-385.17 17667.36,-395.17 17674.36,-395.17"/>
</g>
<!-- agg7_exp10&#45;&gt;moe_agg7 -->
<g id="edge131" class="edge">
<title>agg7_exp10&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M17677.85,-288.69C17677.85,-253.51 17677.85,-212 17677.85,-212 17677.85,-212 16691.11,-212 16691.11,-212"/>
<polygon fill="black" stroke="black" points="16691.11,-208.5 16681.11,-212 16691.11,-215.5 16691.11,-208.5"/>
</g>
<!-- expert7_exp11 -->
<g id="node95" class="node">
<title>expert7_exp11</title>
<polygon fill="lightcoral" stroke="black" points="18514.35,-489.12 18157.35,-489.12 18157.35,-421.12 18514.35,-421.12 18514.35,-489.12"/>
<text text-anchor="middle" x="18335.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 11</text>
<text text-anchor="middle" x="18335.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="18335.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18335.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp11&#45;&gt;expert7_exp11 -->
<g id="edge107" class="edge">
<title>route7_exp11&#45;&gt;expert7_exp11</title>
<path fill="none" stroke="black" d="M18335.85,-524.83C18335.85,-524.83 18335.85,-499.15 18335.85,-499.15"/>
<polygon fill="black" stroke="black" points="18339.36,-499.15 18335.85,-489.15 18332.36,-499.15 18339.36,-499.15"/>
</g>
<!-- agg7_exp11 -->
<g id="node96" class="node">
<title>agg7_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="18343.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="18343.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="18343.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="18343.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="18343.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp11&#45;&gt;agg7_exp11 -->
<g id="edge108" class="edge">
<title>expert7_exp11&#45;&gt;agg7_exp11</title>
<path fill="none" stroke="black" d="M18335.85,-420.97C18335.85,-420.97 18335.85,-395.17 18335.85,-395.17"/>
<polygon fill="black" stroke="black" points="18339.36,-395.17 18335.85,-385.17 18332.36,-395.17 18339.36,-395.17"/>
</g>
<!-- agg7_exp11&#45;&gt;moe_agg7 -->
<g id="edge132" class="edge">
<title>agg7_exp11&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M18321.93,-288.99C18321.93,-251.94 18321.93,-207 18321.93,-207 18321.93,-207 16683.83,-207 16683.83,-207"/>
<polygon fill="black" stroke="black" points="16683.83,-203.5 16673.83,-207 16683.83,-210.5 16683.83,-203.5"/>
</g>
<!-- expert7_exp12 -->
<g id="node98" class="node">
<title>expert7_exp12</title>
<polygon fill="lightcoral" stroke="black" points="19180.35,-489.12 18823.35,-489.12 18823.35,-421.12 19180.35,-421.12 19180.35,-489.12"/>
<text text-anchor="middle" x="19001.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 12</text>
<text text-anchor="middle" x="19001.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="19001.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="19001.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp12&#45;&gt;expert7_exp12 -->
<g id="edge110" class="edge">
<title>route7_exp12&#45;&gt;expert7_exp12</title>
<path fill="none" stroke="black" d="M19001.85,-524.83C19001.85,-524.83 19001.85,-499.15 19001.85,-499.15"/>
<polygon fill="black" stroke="black" points="19005.36,-499.15 19001.85,-489.15 18998.36,-499.15 19005.36,-499.15"/>
</g>
<!-- agg7_exp12 -->
<g id="node99" class="node">
<title>agg7_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="19009.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="19009.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="19009.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="19009.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="19009.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp12&#45;&gt;agg7_exp12 -->
<g id="edge111" class="edge">
<title>expert7_exp12&#45;&gt;agg7_exp12</title>
<path fill="none" stroke="black" d="M19001.85,-420.97C19001.85,-420.97 19001.85,-395.17 19001.85,-395.17"/>
<polygon fill="black" stroke="black" points="19005.36,-395.17 19001.85,-385.17 18998.36,-395.17 19005.36,-395.17"/>
</g>
<!-- agg7_exp12&#45;&gt;moe_agg7 -->
<g id="edge133" class="edge">
<title>agg7_exp12&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M18883.93,-292.45C18883.93,-253.11 18883.93,-202 18883.93,-202 18883.93,-202 16669.94,-202 16669.94,-202"/>
<polygon fill="black" stroke="black" points="16669.94,-198.5 16659.94,-202 16669.94,-205.5 16669.94,-198.5"/>
</g>
<!-- expert7_exp13 -->
<g id="node101" class="node">
<title>expert7_exp13</title>
<polygon fill="lightcoral" stroke="black" points="19838.35,-489.12 19481.35,-489.12 19481.35,-421.12 19838.35,-421.12 19838.35,-489.12"/>
<text text-anchor="middle" x="19659.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 13</text>
<text text-anchor="middle" x="19659.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="19659.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="19659.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp13&#45;&gt;expert7_exp13 -->
<g id="edge113" class="edge">
<title>route7_exp13&#45;&gt;expert7_exp13</title>
<path fill="none" stroke="black" d="M19659.85,-524.83C19659.85,-524.83 19659.85,-499.15 19659.85,-499.15"/>
<polygon fill="black" stroke="black" points="19663.36,-499.15 19659.85,-489.15 19656.36,-499.15 19663.36,-499.15"/>
</g>
<!-- agg7_exp13 -->
<g id="node102" class="node">
<title>agg7_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="19675.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="19675.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="19675.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="19675.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="19675.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp13&#45;&gt;agg7_exp13 -->
<g id="edge114" class="edge">
<title>expert7_exp13&#45;&gt;agg7_exp13</title>
<path fill="none" stroke="black" d="M19659.85,-420.97C19659.85,-420.97 19659.85,-395.17 19659.85,-395.17"/>
<polygon fill="black" stroke="black" points="19663.36,-395.17 19659.85,-385.17 19656.36,-395.17 19663.36,-395.17"/>
</g>
<!-- agg7_exp13&#45;&gt;moe_agg7 -->
<g id="edge134" class="edge">
<title>agg7_exp13&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M19675.85,-288.84C19675.85,-248.34 19675.85,-197 19675.85,-197 19675.85,-197 16648.82,-197 16648.82,-197"/>
<polygon fill="black" stroke="black" points="16648.82,-193.5 16638.82,-197 16648.82,-200.5 16648.82,-193.5"/>
</g>
<!-- expert7_exp14 -->
<g id="node104" class="node">
<title>expert7_exp14</title>
<polygon fill="lightcoral" stroke="black" points="20503.35,-489.12 20146.35,-489.12 20146.35,-421.12 20503.35,-421.12 20503.35,-489.12"/>
<text text-anchor="middle" x="20324.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 14</text>
<text text-anchor="middle" x="20324.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="20324.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="20324.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp14&#45;&gt;expert7_exp14 -->
<g id="edge116" class="edge">
<title>route7_exp14&#45;&gt;expert7_exp14</title>
<path fill="none" stroke="black" d="M20324.85,-525.17C20324.85,-525.17 20324.85,-499.35 20324.85,-499.35"/>
<polygon fill="black" stroke="black" points="20328.36,-499.35 20324.85,-489.35 20321.36,-499.35 20328.36,-499.35"/>
</g>
<!-- agg7_exp14 -->
<g id="node105" class="node">
<title>agg7_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="20341.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="20341.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="20341.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="20341.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="20341.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp14&#45;&gt;agg7_exp14 -->
<g id="edge117" class="edge">
<title>expert7_exp14&#45;&gt;agg7_exp14</title>
<path fill="none" stroke="black" d="M20324.85,-420.97C20324.85,-420.97 20324.85,-395.17 20324.85,-395.17"/>
<polygon fill="black" stroke="black" points="20328.36,-395.17 20324.85,-385.17 20321.36,-395.17 20328.36,-395.17"/>
</g>
<!-- agg7_exp14&#45;&gt;moe_agg7 -->
<g id="edge135" class="edge">
<title>agg7_exp14&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M20341.85,-288.74C20341.85,-246.55 20341.85,-192 20341.85,-192 20341.85,-192 16618.43,-192 16618.43,-192"/>
<polygon fill="black" stroke="black" points="16618.43,-188.5 16608.43,-192 16618.43,-195.5 16618.43,-188.5"/>
</g>
<!-- expert7_exp15 -->
<g id="node107" class="node">
<title>expert7_exp15</title>
<polygon fill="lightcoral" stroke="black" points="21173.35,-489.12 20816.35,-489.12 20816.35,-421.12 21173.35,-421.12 21173.35,-489.12"/>
<text text-anchor="middle" x="20994.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 15</text>
<text text-anchor="middle" x="20994.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="20994.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="20994.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route7_exp15&#45;&gt;expert7_exp15 -->
<g id="edge119" class="edge">
<title>route7_exp15&#45;&gt;expert7_exp15</title>
<path fill="none" stroke="black" d="M20994.85,-525.17C20994.85,-525.17 20994.85,-499.35 20994.85,-499.35"/>
<polygon fill="black" stroke="black" points="20998.36,-499.35 20994.85,-489.35 20991.36,-499.35 20998.36,-499.35"/>
</g>
<!-- agg7_exp15 -->
<g id="node108" class="node">
<title>agg7_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="21007.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="21007.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="21007.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="21007.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21007.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert7_exp15&#45;&gt;agg7_exp15 -->
<g id="edge120" class="edge">
<title>expert7_exp15&#45;&gt;agg7_exp15</title>
<path fill="none" stroke="black" d="M20994.85,-420.97C20994.85,-420.97 20994.85,-395.17 20994.85,-395.17"/>
<polygon fill="black" stroke="black" points="20998.36,-395.17 20994.85,-385.17 20991.36,-395.17 20998.36,-395.17"/>
</g>
<!-- agg7_exp15&#45;&gt;moe_agg7 -->
<g id="edge136" class="edge">
<title>agg7_exp15&#45;&gt;moe_agg7</title>
<path fill="none" stroke="black" d="M21007.85,-288.74C21007.85,-244.88 21007.85,-187 21007.85,-187 21007.85,-187 16574.85,-187 16574.85,-187"/>
<polygon fill="black" stroke="black" points="16574.85,-183.5 16564.85,-187 16574.85,-190.5 16574.85,-183.5"/>
</g>
<!-- moe_agg7&#45;&gt;moe7 -->
<g id="edge137" class="edge">
<title>moe_agg7&#45;&gt;moe7</title>
<path fill="none" stroke="black" d="M16497.2,-182C17009.38,-182 18645.78,-182 18645.78,-182 18645.78,-182 18645.78,-152.4 18645.78,-152.4"/>
<polygon fill="black" stroke="black" points="18649.28,-152.4 18645.78,-142.4 18642.28,-152.4 18649.28,-152.4"/>
</g>
<!-- mha15 -->
<g id="node111" class="node">
<title>mha15</title>
<polygon fill="lightcyan" stroke="black" points="29775.85,-956.29 29317.85,-956.29 29317.85,-903.29 29775.85,-903.29 29775.85,-956.29"/>
<text text-anchor="middle" x="29546.85" y="-941.09" font-family="Times,serif" font-size="14.00">MHA Layer 15</text>
<text text-anchor="middle" x="29546.85" y="-926.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="29546.85" y="-911.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_15 -->
<g id="node114" class="node">
<title>add1_15</title>
<polygon fill="yellow" stroke="black" points="29775.85,-867.29 29317.85,-867.29 29317.85,-799.29 29775.85,-799.29 29775.85,-867.29"/>
<text text-anchor="middle" x="29546.85" y="-852.09" font-family="Times,serif" font-size="14.00">MHA Residual Add 15</text>
<text text-anchor="middle" x="29546.85" y="-837.09" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="29546.85" y="-822.09" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="29546.85" y="-807.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- mha15&#45;&gt;add1_15 -->
<g id="edge140" class="edge">
<title>mha15&#45;&gt;add1_15</title>
<path fill="none" stroke="black" d="M29546.85,-903.16C29546.85,-903.16 29546.85,-877.43 29546.85,-877.43"/>
<polygon fill="black" stroke="black" points="29550.36,-877.43 29546.85,-867.43 29543.36,-877.43 29550.36,-877.43"/>
</g>
<!-- moe14 -->
<g id="node112" class="node">
<title>moe14</title>
<ellipse fill="none" stroke="black" cx="29546.85" cy="-1018.79" rx="42.49" ry="18"/>
<text text-anchor="middle" x="29546.85" y="-1015.09" font-family="Times,serif" font-size="14.00">moe14</text>
</g>
<!-- moe14&#45;&gt;mha15 -->
<g id="edge139" class="edge">
<title>moe14&#45;&gt;mha15</title>
<path fill="none" stroke="black" d="M29546.85,-1000.78C29546.85,-1000.78 29546.85,-966.55 29546.85,-966.55"/>
<polygon fill="black" stroke="black" points="29550.36,-966.55 29546.85,-956.55 29543.36,-966.55 29550.36,-966.55"/>
</g>
<!-- ln1_15 -->
<g id="node113" class="node">
<title>ln1_15</title>
<polygon fill="none" stroke="black" points="30064.85,-1045.29 29606.85,-1045.29 29606.85,-992.29 30064.85,-992.29 30064.85,-1045.29"/>
<text text-anchor="middle" x="29835.85" y="-1030.09" font-family="Times,serif" font-size="14.00">LayerNorm 15</text>
<text text-anchor="middle" x="29835.85" y="-1015.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="29835.85" y="-1000.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- gate15 -->
<g id="node115" class="node">
<title>gate15</title>
<polygon fill="lightgreen" stroke="black" points="27506.43,-763.29 26764.21,-763.29 26573.28,-657.29 27315.5,-657.29 27506.43,-763.29"/>
<text text-anchor="middle" x="27039.85" y="-721.59" font-family="Times,serif" font-size="14.00">Gate Layer 15</text>
<text text-anchor="middle" x="27039.85" y="-706.59" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="27039.85" y="-691.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_experts=16]</text>
</g>
<!-- add1_15&#45;&gt;gate15 -->
<g id="edge141" class="edge">
<title>add1_15&#45;&gt;gate15</title>
<path fill="none" stroke="black" d="M29328.04,-798.93C29328.04,-775.99 29328.04,-750 29328.04,-750 29328.04,-750 27492.73,-750 27492.73,-750"/>
<polygon fill="black" stroke="black" points="27492.74,-746.5 27482.73,-750 27492.73,-753.5 27492.74,-746.5"/>
</g>
<!-- moe15 -->
<g id="node165" class="node">
<title>moe15</title>
<polygon fill="yellow" stroke="black" points="29775.85,-142 29317.85,-142 29317.85,-74 29775.85,-74 29775.85,-142"/>
<text text-anchor="middle" x="29546.85" y="-126.8" font-family="Times,serif" font-size="14.00">MoE Residual Add 15</text>
<text text-anchor="middle" x="29546.85" y="-111.8" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="29546.85" y="-96.8" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="29546.85" y="-81.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- add1_15&#45;&gt;moe15 -->
<g id="edge207" class="edge">
<title>add1_15&#45;&gt;moe15</title>
<path fill="none" stroke="black" d="M29367.1,-799.28C29367.1,-799.28 29367.1,-152.36 29367.1,-152.36"/>
<polygon fill="black" stroke="black" points="29370.6,-152.36 29367.1,-142.36 29363.6,-152.36 29370.6,-152.36"/>
</g>
<!-- route15_exp0 -->
<g id="node116" class="node">
<title>route15_exp0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="21712.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="21712.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="21712.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="21712.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="21712.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp0 -->
<g id="edge142" class="edge">
<title>gate15&#45;&gt;route15_exp0</title>
<path fill="none" stroke="black" d="M26750.62,-756C25640.28,-756 21712.85,-756 21712.85,-756 21712.85,-756 21712.85,-631.71 21712.85,-631.71"/>
<polygon fill="black" stroke="black" points="21716.36,-631.71 21712.85,-621.71 21709.36,-631.71 21716.36,-631.71"/>
</g>
<!-- route15_exp1 -->
<g id="node119" class="node">
<title>route15_exp1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="22429.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="22429.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="22429.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="22429.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="22429.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp1 -->
<g id="edge145" class="edge">
<title>gate15&#45;&gt;route15_exp1</title>
<path fill="none" stroke="black" d="M26738.27,-749C25713.68,-749 22429.85,-749 22429.85,-749 22429.85,-749 22429.85,-631.71 22429.85,-631.71"/>
<polygon fill="black" stroke="black" points="22433.36,-631.71 22429.85,-621.71 22426.36,-631.71 22433.36,-631.71"/>
</g>
<!-- route15_exp2 -->
<g id="node122" class="node">
<title>route15_exp2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="23112.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="23112.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="23112.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="23112.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="23112.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp2 -->
<g id="edge148" class="edge">
<title>gate15&#45;&gt;route15_exp2</title>
<path fill="none" stroke="black" d="M26725.54,-742C25794.06,-742 23112.85,-742 23112.85,-742 23112.85,-742 23112.85,-631.57 23112.85,-631.57"/>
<polygon fill="black" stroke="black" points="23116.36,-631.57 23112.85,-621.57 23109.36,-631.57 23116.36,-631.57"/>
</g>
<!-- route15_exp3 -->
<g id="node125" class="node">
<title>route15_exp3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="23778.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="23778.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="23778.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="23778.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="23778.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp3 -->
<g id="edge151" class="edge">
<title>gate15&#45;&gt;route15_exp3</title>
<path fill="none" stroke="black" d="M26713,-735C25886.58,-735 23778.85,-735 23778.85,-735 23778.85,-735 23778.85,-631.31 23778.85,-631.31"/>
<polygon fill="black" stroke="black" points="23782.36,-631.31 23778.85,-621.31 23775.36,-631.31 23782.36,-631.31"/>
</g>
<!-- route15_exp4 -->
<g id="node128" class="node">
<title>route15_exp4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="24435.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="24435.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="24435.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="24435.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="24435.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp4 -->
<g id="edge154" class="edge">
<title>gate15&#45;&gt;route15_exp4</title>
<path fill="none" stroke="black" d="M26698.76,-727C25992.6,-727 24435.85,-727 24435.85,-727 24435.85,-727 24435.85,-631.44 24435.85,-631.44"/>
<polygon fill="black" stroke="black" points="24439.36,-631.44 24435.85,-621.44 24432.36,-631.44 24439.36,-631.44"/>
</g>
<!-- route15_exp5 -->
<g id="node131" class="node">
<title>route15_exp5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="25088.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="25088.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="25088.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="25088.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="25088.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp5 -->
<g id="edge157" class="edge">
<title>gate15&#45;&gt;route15_exp5</title>
<path fill="none" stroke="black" d="M26610.49,-678C26036.06,-678 25088.85,-678 25088.85,-678 25088.85,-678 25088.85,-631.31 25088.85,-631.31"/>
<polygon fill="black" stroke="black" points="25092.36,-631.31 25088.85,-621.31 25085.36,-631.31 25092.36,-631.31"/>
</g>
<!-- route15_exp6 -->
<g id="node134" class="node">
<title>route15_exp6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="25739.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="25739.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="25739.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="25739.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="25739.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp6 -->
<g id="edge160" class="edge">
<title>gate15&#45;&gt;route15_exp6</title>
<path fill="none" stroke="black" d="M26585.18,-664C26210.3,-664 25739.85,-664 25739.85,-664 25739.85,-664 25739.85,-631.53 25739.85,-631.53"/>
<polygon fill="black" stroke="black" points="25743.36,-631.53 25739.85,-621.53 25736.36,-631.53 25743.36,-631.53"/>
</g>
<!-- route15_exp7 -->
<g id="node137" class="node">
<title>route15_exp7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="26389.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="26389.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="26389.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="26389.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="26389.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp7 -->
<g id="edge163" class="edge">
<title>gate15&#45;&gt;route15_exp7</title>
<path fill="none" stroke="black" d="M26639.27,-656.89C26639.27,-656.89 26639.27,-612.91 26639.27,-612.91"/>
<polygon fill="black" stroke="black" points="26642.77,-612.91 26639.27,-602.91 26635.77,-612.91 26642.77,-612.91"/>
</g>
<!-- route15_exp8 -->
<g id="node140" class="node">
<title>route15_exp8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="27039.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="27039.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="27039.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="27039.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="27039.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp8 -->
<g id="edge166" class="edge">
<title>gate15&#45;&gt;route15_exp8</title>
<path fill="none" stroke="black" d="M27039.85,-656.89C27039.85,-656.89 27039.85,-631.31 27039.85,-631.31"/>
<polygon fill="black" stroke="black" points="27043.36,-631.31 27039.85,-621.31 27036.36,-631.31 27043.36,-631.31"/>
</g>
<!-- route15_exp9 -->
<g id="node143" class="node">
<title>route15_exp9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="27696.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="27696.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="27696.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="27696.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="27696.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp9 -->
<g id="edge169" class="edge">
<title>gate15&#45;&gt;route15_exp9</title>
<path fill="none" stroke="black" d="M27443.94,-710.19C27443.94,-710.19 27443.94,-612.14 27443.94,-612.14"/>
<polygon fill="black" stroke="black" points="27447.44,-612.14 27443.94,-602.14 27440.44,-612.14 27447.44,-612.14"/>
</g>
<!-- route15_exp10 -->
<g id="node146" class="node">
<title>route15_exp10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="28358.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="28358.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="28358.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="28358.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="28358.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp10 -->
<g id="edge172" class="edge">
<title>gate15&#45;&gt;route15_exp10</title>
<path fill="none" stroke="black" d="M27338.74,-670C27727.87,-670 28358.85,-670 28358.85,-670 28358.85,-670 28358.85,-631.32 28358.85,-631.32"/>
<polygon fill="black" stroke="black" points="28362.36,-631.32 28358.85,-621.32 28355.36,-631.32 28362.36,-631.32"/>
</g>
<!-- route15_exp11 -->
<g id="node149" class="node">
<title>route15_exp11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="29022.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="29022.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="29022.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="29022.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="29022.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp11 -->
<g id="edge175" class="edge">
<title>gate15&#45;&gt;route15_exp11</title>
<path fill="none" stroke="black" d="M27362.04,-683C27921.31,-683 29012.67,-683 29012.67,-683 29012.67,-683 29012.67,-631.36 29012.67,-631.36"/>
<polygon fill="black" stroke="black" points="29016.17,-631.36 29012.67,-621.36 29009.17,-631.36 29016.17,-631.36"/>
</g>
<!-- route15_exp12 -->
<g id="node152" class="node">
<title>route15_exp12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="29687.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="29687.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="29687.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="29687.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="29687.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp12 -->
<g id="edge178" class="edge">
<title>gate15&#45;&gt;route15_exp12</title>
<path fill="none" stroke="black" d="M27387.26,-697C28081.49,-697 29574.17,-697 29574.17,-697 29574.17,-697 29574.17,-628.25 29574.17,-628.25"/>
<polygon fill="black" stroke="black" points="29577.67,-628.25 29574.17,-618.25 29570.67,-628.25 29577.67,-628.25"/>
</g>
<!-- route15_exp13 -->
<g id="node155" class="node">
<title>route15_exp13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="30352.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="30352.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="30352.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="30352.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="30352.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp13 -->
<g id="edge181" class="edge">
<title>gate15&#45;&gt;route15_exp13</title>
<path fill="none" stroke="black" d="M27410.61,-710C28215.51,-710 30051.17,-710 30051.17,-710 30051.17,-710 30051.17,-597.33 30051.17,-597.33"/>
<polygon fill="black" stroke="black" points="30054.67,-597.33 30051.17,-587.33 30047.67,-597.33 30054.67,-597.33"/>
</g>
<!-- route15_exp14 -->
<g id="node158" class="node">
<title>route15_exp14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="31018.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="31018.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="31018.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="31018.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="31018.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp14 -->
<g id="edge184" class="edge">
<title>gate15&#45;&gt;route15_exp14</title>
<path fill="none" stroke="black" d="M27434.09,-723C28439.24,-723 31018.85,-723 31018.85,-723 31018.85,-723 31018.85,-631.42 31018.85,-631.42"/>
<polygon fill="black" stroke="black" points="31022.36,-631.42 31018.85,-621.42 31015.36,-631.42 31022.36,-631.42"/>
</g>
<!-- route15_exp15 -->
<g id="node161" class="node">
<title>route15_exp15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="31684.85" cy="-573.2" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="31684.85" y="-592" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="31684.85" y="-577" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="31684.85" y="-562" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="31684.85" y="-547" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- gate15&#45;&gt;route15_exp15 -->
<g id="edge187" class="edge">
<title>gate15&#45;&gt;route15_exp15</title>
<path fill="none" stroke="black" d="M27457.44,-736C28598.59,-736 31684.85,-736 31684.85,-736 31684.85,-736 31684.85,-631.61 31684.85,-631.61"/>
<polygon fill="black" stroke="black" points="31688.36,-631.61 31684.85,-621.61 31681.36,-631.61 31688.36,-631.61"/>
</g>
<!-- expert15_exp0 -->
<g id="node117" class="node">
<title>expert15_exp0</title>
<polygon fill="lightcoral" stroke="black" points="21890.35,-489.12 21533.35,-489.12 21533.35,-421.12 21890.35,-421.12 21890.35,-489.12"/>
<text text-anchor="middle" x="21711.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 0</text>
<text text-anchor="middle" x="21711.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="21711.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21711.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp0&#45;&gt;expert15_exp0 -->
<g id="edge143" class="edge">
<title>route15_exp0&#45;&gt;expert15_exp0</title>
<path fill="none" stroke="black" d="M21711.85,-524.83C21711.85,-524.83 21711.85,-499.15 21711.85,-499.15"/>
<polygon fill="black" stroke="black" points="21715.36,-499.15 21711.85,-489.15 21708.36,-499.15 21715.36,-499.15"/>
</g>
<!-- agg15_exp0 -->
<g id="node118" class="node">
<title>agg15_exp0</title>
<ellipse fill="lightpink" stroke="black" cx="21711.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="21711.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 0</text>
<text text-anchor="middle" x="21711.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="21711.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="21711.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp0&#45;&gt;agg15_exp0 -->
<g id="edge144" class="edge">
<title>expert15_exp0&#45;&gt;agg15_exp0</title>
<path fill="none" stroke="black" d="M21711.85,-420.97C21711.85,-420.97 21711.85,-395.17 21711.85,-395.17"/>
<polygon fill="black" stroke="black" points="21715.36,-395.17 21711.85,-385.17 21708.36,-395.17 21715.36,-395.17"/>
</g>
<!-- moe_agg15 -->
<g id="node164" class="node">
<title>moe_agg15</title>
<ellipse fill="gold" stroke="black" cx="27039.85" cy="-215.48" rx="336.67" ry="37.45"/>
<text text-anchor="middle" x="27039.85" y="-226.78" font-family="Times,serif" font-size="14.00">MoE Final Aggregation 15</text>
<text text-anchor="middle" x="27039.85" y="-211.78" font-family="Times,serif" font-size="14.00">Input: 16Ã—[batch_size=128, seq_len=10000, hidden_dim=4096]</text>
<text text-anchor="middle" x="27039.85" y="-196.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- agg15_exp0&#45;&gt;moe_agg15 -->
<g id="edge190" class="edge">
<title>agg15_exp0&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M21711.85,-288.9C21711.85,-255.51 21711.85,-217 21711.85,-217 21711.85,-217 26693.54,-217 26693.54,-217"/>
<polygon fill="black" stroke="black" points="26693.54,-220.5 26703.54,-217 26693.54,-213.5 26693.54,-220.5"/>
</g>
<!-- expert15_exp1 -->
<g id="node120" class="node">
<title>expert15_exp1</title>
<polygon fill="lightcoral" stroke="black" points="22582.35,-489.12 22225.35,-489.12 22225.35,-421.12 22582.35,-421.12 22582.35,-489.12"/>
<text text-anchor="middle" x="22403.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 1</text>
<text text-anchor="middle" x="22403.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="22403.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="22403.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp1&#45;&gt;expert15_exp1 -->
<g id="edge146" class="edge">
<title>route15_exp1&#45;&gt;expert15_exp1</title>
<path fill="none" stroke="black" d="M22403.85,-525.17C22403.85,-525.17 22403.85,-499.35 22403.85,-499.35"/>
<polygon fill="black" stroke="black" points="22407.36,-499.35 22403.85,-489.35 22400.36,-499.35 22407.36,-499.35"/>
</g>
<!-- agg15_exp1 -->
<g id="node121" class="node">
<title>agg15_exp1</title>
<ellipse fill="lightpink" stroke="black" cx="22377.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="22377.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 1</text>
<text text-anchor="middle" x="22377.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="22377.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="22377.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp1&#45;&gt;agg15_exp1 -->
<g id="edge147" class="edge">
<title>expert15_exp1&#45;&gt;agg15_exp1</title>
<path fill="none" stroke="black" d="M22403.85,-420.97C22403.85,-420.97 22403.85,-395.17 22403.85,-395.17"/>
<polygon fill="black" stroke="black" points="22407.36,-395.17 22403.85,-385.17 22400.36,-395.17 22407.36,-395.17"/>
</g>
<!-- agg15_exp1&#45;&gt;moe_agg15 -->
<g id="edge191" class="edge">
<title>agg15_exp1&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M22377.85,-288.92C22377.85,-257.39 22377.85,-222 22377.85,-222 22377.85,-222 26698.31,-222 26698.31,-222"/>
<polygon fill="black" stroke="black" points="26698.31,-225.5 26708.31,-222 26698.31,-218.5 26698.31,-225.5"/>
</g>
<!-- expert15_exp2 -->
<g id="node123" class="node">
<title>expert15_exp2</title>
<polygon fill="lightcoral" stroke="black" points="23257.35,-489.12 22900.35,-489.12 22900.35,-421.12 23257.35,-421.12 23257.35,-489.12"/>
<text text-anchor="middle" x="23078.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 2</text>
<text text-anchor="middle" x="23078.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="23078.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23078.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp2&#45;&gt;expert15_exp2 -->
<g id="edge149" class="edge">
<title>route15_exp2&#45;&gt;expert15_exp2</title>
<path fill="none" stroke="black" d="M23078.85,-525.17C23078.85,-525.17 23078.85,-499.35 23078.85,-499.35"/>
<polygon fill="black" stroke="black" points="23082.36,-499.35 23078.85,-489.35 23075.36,-499.35 23082.36,-499.35"/>
</g>
<!-- agg15_exp2 -->
<g id="node124" class="node">
<title>agg15_exp2</title>
<ellipse fill="lightpink" stroke="black" cx="23043.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="23043.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 2</text>
<text text-anchor="middle" x="23043.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="23043.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23043.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp2&#45;&gt;agg15_exp2 -->
<g id="edge150" class="edge">
<title>expert15_exp2&#45;&gt;agg15_exp2</title>
<path fill="none" stroke="black" d="M23078.85,-420.97C23078.85,-420.97 23078.85,-395.17 23078.85,-395.17"/>
<polygon fill="black" stroke="black" points="23082.36,-395.17 23078.85,-385.17 23075.36,-395.17 23082.36,-395.17"/>
</g>
<!-- agg15_exp2&#45;&gt;moe_agg15 -->
<g id="edge192" class="edge">
<title>agg15_exp2&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M23043.85,-288.77C23043.85,-259.21 23043.85,-227 23043.85,-227 23043.85,-227 26709.18,-227 26709.18,-227"/>
<polygon fill="black" stroke="black" points="26709.18,-230.5 26719.18,-227 26709.18,-223.5 26709.18,-230.5"/>
</g>
<!-- expert15_exp3 -->
<g id="node126" class="node">
<title>expert15_exp3</title>
<polygon fill="lightcoral" stroke="black" points="23922.35,-489.12 23565.35,-489.12 23565.35,-421.12 23922.35,-421.12 23922.35,-489.12"/>
<text text-anchor="middle" x="23743.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 3</text>
<text text-anchor="middle" x="23743.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="23743.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23743.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp3&#45;&gt;expert15_exp3 -->
<g id="edge152" class="edge">
<title>route15_exp3&#45;&gt;expert15_exp3</title>
<path fill="none" stroke="black" d="M23743.85,-525.17C23743.85,-525.17 23743.85,-499.35 23743.85,-499.35"/>
<polygon fill="black" stroke="black" points="23747.36,-499.35 23743.85,-489.35 23740.36,-499.35 23747.36,-499.35"/>
</g>
<!-- agg15_exp3 -->
<g id="node127" class="node">
<title>agg15_exp3</title>
<ellipse fill="lightpink" stroke="black" cx="23709.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="23709.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 3</text>
<text text-anchor="middle" x="23709.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="23709.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="23709.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp3&#45;&gt;agg15_exp3 -->
<g id="edge153" class="edge">
<title>expert15_exp3&#45;&gt;agg15_exp3</title>
<path fill="none" stroke="black" d="M23743.85,-420.97C23743.85,-420.97 23743.85,-395.17 23743.85,-395.17"/>
<polygon fill="black" stroke="black" points="23747.36,-395.17 23743.85,-385.17 23740.36,-395.17 23747.36,-395.17"/>
</g>
<!-- agg15_exp3&#45;&gt;moe_agg15 -->
<g id="edge193" class="edge">
<title>agg15_exp3&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M23709.85,-288.82C23709.85,-261.21 23709.85,-232 23709.85,-232 23709.85,-232 26727.73,-232 26727.73,-232"/>
<polygon fill="black" stroke="black" points="26727.73,-235.5 26737.73,-232 26727.73,-228.5 26727.73,-235.5"/>
</g>
<!-- expert15_exp4 -->
<g id="node129" class="node">
<title>expert15_exp4</title>
<polygon fill="lightcoral" stroke="black" points="24584.35,-489.12 24227.35,-489.12 24227.35,-421.12 24584.35,-421.12 24584.35,-489.12"/>
<text text-anchor="middle" x="24405.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 4</text>
<text text-anchor="middle" x="24405.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="24405.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="24405.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp4&#45;&gt;expert15_exp4 -->
<g id="edge155" class="edge">
<title>route15_exp4&#45;&gt;expert15_exp4</title>
<path fill="none" stroke="black" d="M24405.85,-525.17C24405.85,-525.17 24405.85,-499.35 24405.85,-499.35"/>
<polygon fill="black" stroke="black" points="24409.36,-499.35 24405.85,-489.35 24402.36,-499.35 24409.36,-499.35"/>
</g>
<!-- agg15_exp4 -->
<g id="node130" class="node">
<title>agg15_exp4</title>
<ellipse fill="lightpink" stroke="black" cx="24375.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="24375.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 4</text>
<text text-anchor="middle" x="24375.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="24375.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="24375.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp4&#45;&gt;agg15_exp4 -->
<g id="edge156" class="edge">
<title>expert15_exp4&#45;&gt;agg15_exp4</title>
<path fill="none" stroke="black" d="M24405.85,-420.97C24405.85,-420.97 24405.85,-395.17 24405.85,-395.17"/>
<polygon fill="black" stroke="black" points="24409.36,-395.17 24405.85,-385.17 24402.36,-395.17 24409.36,-395.17"/>
</g>
<!-- agg15_exp4&#45;&gt;moe_agg15 -->
<g id="edge194" class="edge">
<title>agg15_exp4&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M24375.85,-288.78C24375.85,-263.2 24375.85,-237 24375.85,-237 24375.85,-237 26754.17,-237 26754.17,-237"/>
<polygon fill="black" stroke="black" points="26754.17,-240.5 26764.17,-237 26754.17,-233.5 26754.17,-240.5"/>
</g>
<!-- expert15_exp5 -->
<g id="node132" class="node">
<title>expert15_exp5</title>
<polygon fill="lightcoral" stroke="black" points="25243.35,-489.12 24886.35,-489.12 24886.35,-421.12 25243.35,-421.12 25243.35,-489.12"/>
<text text-anchor="middle" x="25064.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 5</text>
<text text-anchor="middle" x="25064.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="25064.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="25064.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp5&#45;&gt;expert15_exp5 -->
<g id="edge158" class="edge">
<title>route15_exp5&#45;&gt;expert15_exp5</title>
<path fill="none" stroke="black" d="M25064.85,-525.17C25064.85,-525.17 25064.85,-499.35 25064.85,-499.35"/>
<polygon fill="black" stroke="black" points="25068.36,-499.35 25064.85,-489.35 25061.36,-499.35 25068.36,-499.35"/>
</g>
<!-- agg15_exp5 -->
<g id="node133" class="node">
<title>agg15_exp5</title>
<ellipse fill="lightpink" stroke="black" cx="25041.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="25041.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 5</text>
<text text-anchor="middle" x="25041.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="25041.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="25041.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp5&#45;&gt;agg15_exp5 -->
<g id="edge159" class="edge">
<title>expert15_exp5&#45;&gt;agg15_exp5</title>
<path fill="none" stroke="black" d="M25064.85,-420.97C25064.85,-420.97 25064.85,-395.17 25064.85,-395.17"/>
<polygon fill="black" stroke="black" points="25068.36,-395.17 25064.85,-385.17 25061.36,-395.17 25068.36,-395.17"/>
</g>
<!-- agg15_exp5&#45;&gt;moe_agg15 -->
<g id="edge195" class="edge">
<title>agg15_exp5&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M25041.85,-288.68C25041.85,-265.21 25041.85,-242 25041.85,-242 25041.85,-242 26791.82,-242 26791.82,-242"/>
<polygon fill="black" stroke="black" points="26791.82,-245.5 26801.82,-242 26791.82,-238.5 26791.82,-245.5"/>
</g>
<!-- expert15_exp6 -->
<g id="node135" class="node">
<title>expert15_exp6</title>
<polygon fill="lightcoral" stroke="black" points="25902.35,-489.12 25545.35,-489.12 25545.35,-421.12 25902.35,-421.12 25902.35,-489.12"/>
<text text-anchor="middle" x="25723.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 6</text>
<text text-anchor="middle" x="25723.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="25723.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="25723.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp6&#45;&gt;expert15_exp6 -->
<g id="edge161" class="edge">
<title>route15_exp6&#45;&gt;expert15_exp6</title>
<path fill="none" stroke="black" d="M25723.85,-525.17C25723.85,-525.17 25723.85,-499.35 25723.85,-499.35"/>
<polygon fill="black" stroke="black" points="25727.36,-499.35 25723.85,-489.35 25720.36,-499.35 25727.36,-499.35"/>
</g>
<!-- agg15_exp6 -->
<g id="node136" class="node">
<title>agg15_exp6</title>
<ellipse fill="lightpink" stroke="black" cx="25707.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="25707.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 6</text>
<text text-anchor="middle" x="25707.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="25707.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="25707.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp6&#45;&gt;agg15_exp6 -->
<g id="edge162" class="edge">
<title>expert15_exp6&#45;&gt;agg15_exp6</title>
<path fill="none" stroke="black" d="M25723.85,-420.97C25723.85,-420.97 25723.85,-395.17 25723.85,-395.17"/>
<polygon fill="black" stroke="black" points="25727.36,-395.17 25723.85,-385.17 25720.36,-395.17 25727.36,-395.17"/>
</g>
<!-- agg15_exp6&#45;&gt;moe_agg15 -->
<g id="edge196" class="edge">
<title>agg15_exp6&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M25707.85,-288.86C25707.85,-267.45 25707.85,-247 25707.85,-247 25707.85,-247 26847.79,-247 26847.79,-247"/>
<polygon fill="black" stroke="black" points="26847.79,-250.5 26857.79,-247 26847.79,-243.5 26847.79,-250.5"/>
</g>
<!-- expert15_exp7 -->
<g id="node138" class="node">
<title>expert15_exp7</title>
<polygon fill="lightcoral" stroke="black" points="26560.35,-489.12 26203.35,-489.12 26203.35,-421.12 26560.35,-421.12 26560.35,-489.12"/>
<text text-anchor="middle" x="26381.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 7</text>
<text text-anchor="middle" x="26381.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="26381.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26381.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp7&#45;&gt;expert15_exp7 -->
<g id="edge164" class="edge">
<title>route15_exp7&#45;&gt;expert15_exp7</title>
<path fill="none" stroke="black" d="M26381.85,-524.83C26381.85,-524.83 26381.85,-499.15 26381.85,-499.15"/>
<polygon fill="black" stroke="black" points="26385.36,-499.15 26381.85,-489.15 26378.36,-499.15 26385.36,-499.15"/>
</g>
<!-- agg15_exp7 -->
<g id="node139" class="node">
<title>agg15_exp7</title>
<ellipse fill="lightpink" stroke="black" cx="26373.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="26373.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 7</text>
<text text-anchor="middle" x="26373.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="26373.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="26373.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp7&#45;&gt;agg15_exp7 -->
<g id="edge165" class="edge">
<title>expert15_exp7&#45;&gt;agg15_exp7</title>
<path fill="none" stroke="black" d="M26381.85,-420.97C26381.85,-420.97 26381.85,-395.17 26381.85,-395.17"/>
<polygon fill="black" stroke="black" points="26385.36,-395.17 26381.85,-385.17 26378.36,-395.17 26385.36,-395.17"/>
</g>
<!-- agg15_exp7&#45;&gt;moe_agg15 -->
<g id="edge197" class="edge">
<title>agg15_exp7&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M26697.82,-337C26705.99,-337 26710.61,-337 26710.61,-337 26710.61,-337 26710.61,-233.45 26710.61,-233.45"/>
<polygon fill="black" stroke="black" points="26714.11,-233.45 26710.61,-223.45 26707.11,-233.45 26714.11,-233.45"/>
</g>
<!-- expert15_exp8 -->
<g id="node141" class="node">
<title>expert15_exp8</title>
<polygon fill="lightcoral" stroke="black" points="27218.35,-489.12 26861.35,-489.12 26861.35,-421.12 27218.35,-421.12 27218.35,-489.12"/>
<text text-anchor="middle" x="27039.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 8</text>
<text text-anchor="middle" x="27039.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="27039.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="27039.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp8&#45;&gt;expert15_exp8 -->
<g id="edge167" class="edge">
<title>route15_exp8&#45;&gt;expert15_exp8</title>
<path fill="none" stroke="black" d="M27039.85,-524.83C27039.85,-524.83 27039.85,-499.15 27039.85,-499.15"/>
<polygon fill="black" stroke="black" points="27043.36,-499.15 27039.85,-489.15 27036.36,-499.15 27043.36,-499.15"/>
</g>
<!-- agg15_exp8 -->
<g id="node142" class="node">
<title>agg15_exp8</title>
<ellipse fill="lightpink" stroke="black" cx="27039.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="27039.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 8</text>
<text text-anchor="middle" x="27039.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="27039.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="27039.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp8&#45;&gt;agg15_exp8 -->
<g id="edge168" class="edge">
<title>expert15_exp8&#45;&gt;agg15_exp8</title>
<path fill="none" stroke="black" d="M27039.85,-420.97C27039.85,-420.97 27039.85,-395.17 27039.85,-395.17"/>
<polygon fill="black" stroke="black" points="27043.36,-395.17 27039.85,-385.17 27036.36,-395.17 27043.36,-395.17"/>
</g>
<!-- agg15_exp8&#45;&gt;moe_agg15 -->
<g id="edge198" class="edge">
<title>agg15_exp8&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M27039.85,-288.64C27039.85,-288.64 27039.85,-263.22 27039.85,-263.22"/>
<polygon fill="black" stroke="black" points="27043.36,-263.22 27039.85,-253.22 27036.36,-263.22 27043.36,-263.22"/>
</g>
<!-- expert15_exp9 -->
<g id="node144" class="node">
<title>expert15_exp9</title>
<polygon fill="lightcoral" stroke="black" points="27880.35,-489.12 27523.35,-489.12 27523.35,-421.12 27880.35,-421.12 27880.35,-489.12"/>
<text text-anchor="middle" x="27701.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 9</text>
<text text-anchor="middle" x="27701.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="27701.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="27701.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp9&#45;&gt;expert15_exp9 -->
<g id="edge170" class="edge">
<title>route15_exp9&#45;&gt;expert15_exp9</title>
<path fill="none" stroke="black" d="M27701.85,-524.83C27701.85,-524.83 27701.85,-499.15 27701.85,-499.15"/>
<polygon fill="black" stroke="black" points="27705.36,-499.15 27701.85,-489.15 27698.36,-499.15 27705.36,-499.15"/>
</g>
<!-- agg15_exp9 -->
<g id="node145" class="node">
<title>agg15_exp9</title>
<ellipse fill="lightpink" stroke="black" cx="27705.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="27705.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 9</text>
<text text-anchor="middle" x="27705.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="27705.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="27705.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp9&#45;&gt;agg15_exp9 -->
<g id="edge171" class="edge">
<title>expert15_exp9&#45;&gt;agg15_exp9</title>
<path fill="none" stroke="black" d="M27701.85,-420.97C27701.85,-420.97 27701.85,-395.17 27701.85,-395.17"/>
<polygon fill="black" stroke="black" points="27705.36,-395.17 27701.85,-385.17 27698.36,-395.17 27705.36,-395.17"/>
</g>
<!-- agg15_exp9&#45;&gt;moe_agg15 -->
<g id="edge199" class="edge">
<title>agg15_exp9&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M27381.63,-337C27374.24,-337 27370.07,-337 27370.07,-337 27370.07,-337 27370.07,-233.08 27370.07,-233.08"/>
<polygon fill="black" stroke="black" points="27373.57,-233.08 27370.07,-223.08 27366.57,-233.08 27373.57,-233.08"/>
</g>
<!-- expert15_exp10 -->
<g id="node147" class="node">
<title>expert15_exp10</title>
<polygon fill="lightcoral" stroke="black" points="28544.35,-489.12 28187.35,-489.12 28187.35,-421.12 28544.35,-421.12 28544.35,-489.12"/>
<text text-anchor="middle" x="28365.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 10</text>
<text text-anchor="middle" x="28365.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="28365.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28365.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp10&#45;&gt;expert15_exp10 -->
<g id="edge173" class="edge">
<title>route15_exp10&#45;&gt;expert15_exp10</title>
<path fill="none" stroke="black" d="M28365.85,-524.83C28365.85,-524.83 28365.85,-499.15 28365.85,-499.15"/>
<polygon fill="black" stroke="black" points="28369.36,-499.15 28365.85,-489.15 28362.36,-499.15 28369.36,-499.15"/>
</g>
<!-- agg15_exp10 -->
<g id="node148" class="node">
<title>agg15_exp10</title>
<ellipse fill="lightpink" stroke="black" cx="28371.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="28371.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 10</text>
<text text-anchor="middle" x="28371.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="28371.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="28371.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp10&#45;&gt;agg15_exp10 -->
<g id="edge174" class="edge">
<title>expert15_exp10&#45;&gt;agg15_exp10</title>
<path fill="none" stroke="black" d="M28365.85,-420.97C28365.85,-420.97 28365.85,-395.17 28365.85,-395.17"/>
<polygon fill="black" stroke="black" points="28369.36,-395.17 28365.85,-385.17 28362.36,-395.17 28369.36,-395.17"/>
</g>
<!-- agg15_exp10&#45;&gt;moe_agg15 -->
<g id="edge200" class="edge">
<title>agg15_exp10&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M28371.85,-288.92C28371.85,-265.78 28371.85,-243 28371.85,-243 28371.85,-243 27278.46,-243 27278.46,-243"/>
<polygon fill="black" stroke="black" points="27278.46,-239.5 27268.46,-243 27278.46,-246.5 27278.46,-239.5"/>
</g>
<!-- expert15_exp11 -->
<g id="node150" class="node">
<title>expert15_exp11</title>
<polygon fill="lightcoral" stroke="black" points="29209.35,-489.12 28852.35,-489.12 28852.35,-421.12 29209.35,-421.12 29209.35,-489.12"/>
<text text-anchor="middle" x="29030.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 11</text>
<text text-anchor="middle" x="29030.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="29030.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="29030.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp11&#45;&gt;expert15_exp11 -->
<g id="edge176" class="edge">
<title>route15_exp11&#45;&gt;expert15_exp11</title>
<path fill="none" stroke="black" d="M29030.85,-524.83C29030.85,-524.83 29030.85,-499.15 29030.85,-499.15"/>
<polygon fill="black" stroke="black" points="29034.36,-499.15 29030.85,-489.15 29027.36,-499.15 29034.36,-499.15"/>
</g>
<!-- agg15_exp11 -->
<g id="node151" class="node">
<title>agg15_exp11</title>
<ellipse fill="lightpink" stroke="black" cx="29037.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="29037.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 11</text>
<text text-anchor="middle" x="29037.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="29037.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="29037.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp11&#45;&gt;agg15_exp11 -->
<g id="edge177" class="edge">
<title>expert15_exp11&#45;&gt;agg15_exp11</title>
<path fill="none" stroke="black" d="M29030.85,-420.97C29030.85,-420.97 29030.85,-395.17 29030.85,-395.17"/>
<polygon fill="black" stroke="black" points="29034.36,-395.17 29030.85,-385.17 29027.36,-395.17 29034.36,-395.17"/>
</g>
<!-- agg15_exp11&#45;&gt;moe_agg15 -->
<g id="edge201" class="edge">
<title>agg15_exp11&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M29015.93,-288.84C29015.93,-262.02 29015.93,-234 29015.93,-234 29015.93,-234 27342.49,-234 27342.49,-234"/>
<polygon fill="black" stroke="black" points="27342.49,-230.5 27332.49,-234 27342.49,-237.5 27342.49,-230.5"/>
</g>
<!-- expert15_exp12 -->
<g id="node153" class="node">
<title>expert15_exp12</title>
<polygon fill="lightcoral" stroke="black" points="29874.35,-489.12 29517.35,-489.12 29517.35,-421.12 29874.35,-421.12 29874.35,-489.12"/>
<text text-anchor="middle" x="29695.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 12</text>
<text text-anchor="middle" x="29695.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="29695.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="29695.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp12&#45;&gt;expert15_exp12 -->
<g id="edge179" class="edge">
<title>route15_exp12&#45;&gt;expert15_exp12</title>
<path fill="none" stroke="black" d="M29695.85,-524.83C29695.85,-524.83 29695.85,-499.15 29695.85,-499.15"/>
<polygon fill="black" stroke="black" points="29699.36,-499.15 29695.85,-489.15 29692.36,-499.15 29699.36,-499.15"/>
</g>
<!-- agg15_exp12 -->
<g id="node154" class="node">
<title>agg15_exp12</title>
<ellipse fill="lightpink" stroke="black" cx="29703.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="29703.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 12</text>
<text text-anchor="middle" x="29703.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="29703.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="29703.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp12&#45;&gt;agg15_exp12 -->
<g id="edge180" class="edge">
<title>expert15_exp12&#45;&gt;agg15_exp12</title>
<path fill="none" stroke="black" d="M29695.85,-420.97C29695.85,-420.97 29695.85,-395.17 29695.85,-395.17"/>
<polygon fill="black" stroke="black" points="29699.36,-395.17 29695.85,-385.17 29692.36,-395.17 29699.36,-395.17"/>
</g>
<!-- agg15_exp12&#45;&gt;moe_agg15 -->
<g id="edge202" class="edge">
<title>agg15_exp12&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M29577.93,-292.69C29577.93,-261.02 29577.93,-224 29577.93,-224 29577.93,-224 27377.76,-224 27377.76,-224"/>
<polygon fill="black" stroke="black" points="27377.76,-220.5 27367.76,-224 27377.76,-227.5 27377.76,-220.5"/>
</g>
<!-- expert15_exp13 -->
<g id="node156" class="node">
<title>expert15_exp13</title>
<polygon fill="lightcoral" stroke="black" points="30539.35,-489.12 30182.35,-489.12 30182.35,-421.12 30539.35,-421.12 30539.35,-489.12"/>
<text text-anchor="middle" x="30360.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 13</text>
<text text-anchor="middle" x="30360.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="30360.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30360.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp13&#45;&gt;expert15_exp13 -->
<g id="edge182" class="edge">
<title>route15_exp13&#45;&gt;expert15_exp13</title>
<path fill="none" stroke="black" d="M30360.85,-524.83C30360.85,-524.83 30360.85,-499.15 30360.85,-499.15"/>
<polygon fill="black" stroke="black" points="30364.36,-499.15 30360.85,-489.15 30357.36,-499.15 30364.36,-499.15"/>
</g>
<!-- agg15_exp13 -->
<g id="node157" class="node">
<title>agg15_exp13</title>
<ellipse fill="lightpink" stroke="black" cx="30369.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="30369.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 13</text>
<text text-anchor="middle" x="30369.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="30369.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="30369.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp13&#45;&gt;agg15_exp13 -->
<g id="edge183" class="edge">
<title>expert15_exp13&#45;&gt;agg15_exp13</title>
<path fill="none" stroke="black" d="M30360.85,-420.97C30360.85,-420.97 30360.85,-395.17 30360.85,-395.17"/>
<polygon fill="black" stroke="black" points="30364.36,-395.17 30360.85,-385.17 30357.36,-395.17 30364.36,-395.17"/>
</g>
<!-- agg15_exp13&#45;&gt;moe_agg15 -->
<g id="edge203" class="edge">
<title>agg15_exp13&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M30369.85,-288.8C30369.85,-254.69 30369.85,-215 30369.85,-215 30369.85,-215 27386.71,-215 27386.71,-215"/>
<polygon fill="black" stroke="black" points="27386.71,-211.5 27376.71,-215 27386.71,-218.5 27386.71,-211.5"/>
</g>
<!-- expert15_exp14 -->
<g id="node159" class="node">
<title>expert15_exp14</title>
<polygon fill="lightcoral" stroke="black" points="31205.35,-489.12 30848.35,-489.12 30848.35,-421.12 31205.35,-421.12 31205.35,-489.12"/>
<text text-anchor="middle" x="31026.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 14</text>
<text text-anchor="middle" x="31026.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="31026.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="31026.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp14&#45;&gt;expert15_exp14 -->
<g id="edge185" class="edge">
<title>route15_exp14&#45;&gt;expert15_exp14</title>
<path fill="none" stroke="black" d="M31026.85,-524.83C31026.85,-524.83 31026.85,-499.15 31026.85,-499.15"/>
<polygon fill="black" stroke="black" points="31030.36,-499.15 31026.85,-489.15 31023.36,-499.15 31030.36,-499.15"/>
</g>
<!-- agg15_exp14 -->
<g id="node160" class="node">
<title>agg15_exp14</title>
<ellipse fill="lightpink" stroke="black" cx="31035.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="31035.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 14</text>
<text text-anchor="middle" x="31035.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="31035.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="31035.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp14&#45;&gt;agg15_exp14 -->
<g id="edge186" class="edge">
<title>expert15_exp14&#45;&gt;agg15_exp14</title>
<path fill="none" stroke="black" d="M31026.85,-420.97C31026.85,-420.97 31026.85,-395.17 31026.85,-395.17"/>
<polygon fill="black" stroke="black" points="31030.36,-395.17 31026.85,-385.17 31023.36,-395.17 31030.36,-395.17"/>
</g>
<!-- agg15_exp14&#45;&gt;moe_agg15 -->
<g id="edge204" class="edge">
<title>agg15_exp14&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M31035.85,-288.62C31035.85,-251.29 31035.85,-206 31035.85,-206 31035.85,-206 27375.59,-206 27375.59,-206"/>
<polygon fill="black" stroke="black" points="27375.59,-202.5 27365.59,-206 27375.59,-209.5 27375.59,-202.5"/>
</g>
<!-- expert15_exp15 -->
<g id="node162" class="node">
<title>expert15_exp15</title>
<polygon fill="lightcoral" stroke="black" points="31871.35,-489.12 31514.35,-489.12 31514.35,-421.12 31871.35,-421.12 31871.35,-489.12"/>
<text text-anchor="middle" x="31692.85" y="-473.92" font-family="Times,serif" font-size="14.00">MLP Expert 15</text>
<text text-anchor="middle" x="31692.85" y="-458.92" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="31692.85" y="-443.92" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="31692.85" y="-428.92" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert, hidden_dim=4096]</text>
</g>
<!-- route15_exp15&#45;&gt;expert15_exp15 -->
<g id="edge188" class="edge">
<title>route15_exp15&#45;&gt;expert15_exp15</title>
<path fill="none" stroke="black" d="M31692.85,-524.83C31692.85,-524.83 31692.85,-499.15 31692.85,-499.15"/>
<polygon fill="black" stroke="black" points="31696.36,-499.15 31692.85,-489.15 31689.36,-499.15 31696.36,-499.15"/>
</g>
<!-- agg15_exp15 -->
<g id="node163" class="node">
<title>agg15_exp15</title>
<ellipse fill="lightpink" stroke="black" cx="31701.85" cy="-337.04" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="31701.85" y="-355.84" font-family="Times,serif" font-size="14.00">Aggregate from Expert 15</text>
<text text-anchor="middle" x="31701.85" y="-340.84" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="31701.85" y="-325.84" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert, hidden_dim=4096]</text>
<text text-anchor="middle" x="31701.85" y="-310.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- expert15_exp15&#45;&gt;agg15_exp15 -->
<g id="edge189" class="edge">
<title>expert15_exp15&#45;&gt;agg15_exp15</title>
<path fill="none" stroke="black" d="M31692.85,-420.97C31692.85,-420.97 31692.85,-395.17 31692.85,-395.17"/>
<polygon fill="black" stroke="black" points="31696.36,-395.17 31692.85,-385.17 31689.36,-395.17 31696.36,-395.17"/>
</g>
<!-- agg15_exp15&#45;&gt;moe_agg15 -->
<g id="edge205" class="edge">
<title>agg15_exp15&#45;&gt;moe_agg15</title>
<path fill="none" stroke="black" d="M31701.85,-288.89C31701.85,-248.04 31701.85,-196 31701.85,-196 31701.85,-196 27337.53,-196 27337.53,-196"/>
<polygon fill="black" stroke="black" points="27337.53,-192.5 27327.53,-196 27337.53,-199.5 27337.53,-192.5"/>
</g>
<!-- moe_agg15&#45;&gt;moe15 -->
<g id="edge206" class="edge">
<title>moe_agg15&#45;&gt;moe15</title>
<path fill="none" stroke="black" d="M27258.82,-187C27833.31,-187 29339.78,-187 29339.78,-187 29339.78,-187 29339.78,-152.42 29339.78,-152.42"/>
<polygon fill="black" stroke="black" points="29343.28,-152.42 29339.78,-142.42 29336.28,-152.42 29343.28,-152.42"/>
</g>
<!-- output -->
<g id="node166" class="node">
<title>output</title>
<polygon fill="lightblue" stroke="black" points="29769.85,-38 29323.85,-38 29323.85,0 29769.85,0 29769.85,-38"/>
<text text-anchor="middle" x="29546.85" y="-22.8" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="29546.85" y="-7.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_dim=4096]</text>
</g>
<!-- moe15&#45;&gt;output -->
<g id="edge208" class="edge">
<title>moe15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M29546.85,-73.84C29546.85,-73.84 29546.85,-48.01 29546.85,-48.01"/>
<polygon fill="black" stroke="black" points="29550.36,-48.01 29546.85,-38.01 29543.36,-48.01 29550.36,-48.01"/>
</g>
</g>
</svg>
