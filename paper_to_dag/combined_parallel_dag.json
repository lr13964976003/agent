{
  "nodes": [
    {"id": "dp_input",      "type": "input",  "gpu": null, "shape": [32, 1024], "comp": "data_aggregation"},
    {"id": "dp_split",      "type": "agg",    "gpu": null, "shape": [4, 1024], "comp": "data_aggregation"},
    {"id": "pp_stage0",     "type": "compute", "gpu": 0,  "shape": [4, 1024, 4096], "comp": "computation"},
    {"id": "pp_comm0",      "type": "comm",    "gpu": 0,  "shape": [4, 1024, 4096], "comp": "communication", "style": "dashed"},
    {"id": "pp_stage1",     "type": "compute", "gpu": 4,  "shape": [4, 1024, 4096], "comp": "computation"},
    {"id": "tp_reduce",     "type": "agg",    "gpu": 8,  "shape": [4, 1024, 4096], "comp": "data_aggregation"},
    {"id": "ep_dispatch",   "type": "comm",    "gpu": 8,  "shape": [1, 1024, 4096], "comp": "communication", "style": "dashed"},
    {"id": "ep_final",      "type": "compute", "gpu": 12, "shape": [1, 1024, 4096], "comp": "computation"},
    {"id": "output_cp",     "type": "output", "gpu": null, "shape": [1, 1024], "comp": "data_aggregation"}
  ],
  "edges": [
    ["dp_input", "dp_split"],
    ["dp_split", "pp_stage0"],
    ["pp_stage0", "pp_comm0"],
    ["pp_comm0", "pp_stage1"],
    ["pp_stage1", "tp_reduce"],
    ["tp_reduce", "ep_dispatch"],
    ["ep_dispatch", "ep_final"],
    ["ep_final", "output_cp"]
  ]
}