digraph MoE_Baseline_TP8_PP2 {
	rankdir=TB size="20,30"
	node [fillcolor=lightblue shape=rectangle style=filled]
	input [label="Input\nbatch_size=128, seq_len=10000, d_model=4096" fillcolor=lightgreen shape=ellipse]
	l0_attn_tp0_gpu0 [label="Attention\nL0 TP0\nGPU0\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp1_gpu1 [label="Attention\nL0 TP1\nGPU1\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp2_gpu2 [label="Attention\nL0 TP2\nGPU2\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp3_gpu3 [label="Attention\nL0 TP3\nGPU3\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp4_gpu4 [label="Attention\nL0 TP4\nGPU4\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp5_gpu5 [label="Attention\nL0 TP5\nGPU5\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp6_gpu6 [label="Attention\nL0 TP6\nGPU6\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp7_gpu7 [label="Attention\nL0 TP7\nGPU7\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l0_moe_tp0_gpu0 [label="MoE\nL0 E0-1\nGPU0\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp1_gpu1 [label="MoE\nL0 E2-3\nGPU1\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp2_gpu2 [label="MoE\nL0 E4-5\nGPU2\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp3_gpu3 [label="MoE\nL0 E6-7\nGPU3\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp4_gpu4 [label="MoE\nL0 E8-9\nGPU4\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp5_gpu5 [label="MoE\nL0 E10-11\nGPU5\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp6_gpu6 [label="MoE\nL0 E12-13\nGPU6\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp7_gpu7 [label="MoE\nL0 E14-15\nGPU7\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l1_attn_tp0_gpu0 [label="Attention\nL1 TP0\nGPU0\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp1_gpu1 [label="Attention\nL1 TP1\nGPU1\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp2_gpu2 [label="Attention\nL1 TP2\nGPU2\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp3_gpu3 [label="Attention\nL1 TP3\nGPU3\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp4_gpu4 [label="Attention\nL1 TP4\nGPU4\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp5_gpu5 [label="Attention\nL1 TP5\nGPU5\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp6_gpu6 [label="Attention\nL1 TP6\nGPU6\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp7_gpu7 [label="Attention\nL1 TP7\nGPU7\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l1_moe_tp0_gpu0 [label="MoE\nL1 E0-1\nGPU0\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp1_gpu1 [label="MoE\nL1 E2-3\nGPU1\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp2_gpu2 [label="MoE\nL1 E4-5\nGPU2\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp3_gpu3 [label="MoE\nL1 E6-7\nGPU3\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp4_gpu4 [label="MoE\nL1 E8-9\nGPU4\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp5_gpu5 [label="MoE\nL1 E10-11\nGPU5\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp6_gpu6 [label="MoE\nL1 E12-13\nGPU6\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp7_gpu7 [label="MoE\nL1 E14-15\nGPU7\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l2_attn_tp0_gpu0 [label="Attention\nL2 TP0\nGPU0\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp1_gpu1 [label="Attention\nL2 TP1\nGPU1\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp2_gpu2 [label="Attention\nL2 TP2\nGPU2\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp3_gpu3 [label="Attention\nL2 TP3\nGPU3\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp4_gpu4 [label="Attention\nL2 TP4\nGPU4\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp5_gpu5 [label="Attention\nL2 TP5\nGPU5\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp6_gpu6 [label="Attention\nL2 TP6\nGPU6\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp7_gpu7 [label="Attention\nL2 TP7\nGPU7\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l2_moe_tp0_gpu0 [label="MoE\nL2 E0-1\nGPU0\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp1_gpu1 [label="MoE\nL2 E2-3\nGPU1\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp2_gpu2 [label="MoE\nL2 E4-5\nGPU2\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp3_gpu3 [label="MoE\nL2 E6-7\nGPU3\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp4_gpu4 [label="MoE\nL2 E8-9\nGPU4\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp5_gpu5 [label="MoE\nL2 E10-11\nGPU5\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp6_gpu6 [label="MoE\nL2 E12-13\nGPU6\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp7_gpu7 [label="MoE\nL2 E14-15\nGPU7\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l3_attn_tp0_gpu0 [label="Attention\nL3 TP0\nGPU0\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp1_gpu1 [label="Attention\nL3 TP1\nGPU1\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp2_gpu2 [label="Attention\nL3 TP2\nGPU2\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp3_gpu3 [label="Attention\nL3 TP3\nGPU3\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp4_gpu4 [label="Attention\nL3 TP4\nGPU4\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp5_gpu5 [label="Attention\nL3 TP5\nGPU5\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp6_gpu6 [label="Attention\nL3 TP6\nGPU6\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp7_gpu7 [label="Attention\nL3 TP7\nGPU7\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l3_moe_tp0_gpu0 [label="MoE\nL3 E0-1\nGPU0\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp1_gpu1 [label="MoE\nL3 E2-3\nGPU1\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp2_gpu2 [label="MoE\nL3 E4-5\nGPU2\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp3_gpu3 [label="MoE\nL3 E6-7\nGPU3\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp4_gpu4 [label="MoE\nL3 E8-9\nGPU4\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp5_gpu5 [label="MoE\nL3 E10-11\nGPU5\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp6_gpu6 [label="MoE\nL3 E12-13\nGPU6\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp7_gpu7 [label="MoE\nL3 E14-15\nGPU7\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l4_attn_tp0_gpu0 [label="Attention\nL4 TP0\nGPU0\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp1_gpu1 [label="Attention\nL4 TP1\nGPU1\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp2_gpu2 [label="Attention\nL4 TP2\nGPU2\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp3_gpu3 [label="Attention\nL4 TP3\nGPU3\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp4_gpu4 [label="Attention\nL4 TP4\nGPU4\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp5_gpu5 [label="Attention\nL4 TP5\nGPU5\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp6_gpu6 [label="Attention\nL4 TP6\nGPU6\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp7_gpu7 [label="Attention\nL4 TP7\nGPU7\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l4_moe_tp0_gpu0 [label="MoE\nL4 E0-1\nGPU0\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp1_gpu1 [label="MoE\nL4 E2-3\nGPU1\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp2_gpu2 [label="MoE\nL4 E4-5\nGPU2\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp3_gpu3 [label="MoE\nL4 E6-7\nGPU3\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp4_gpu4 [label="MoE\nL4 E8-9\nGPU4\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp5_gpu5 [label="MoE\nL4 E10-11\nGPU5\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp6_gpu6 [label="MoE\nL4 E12-13\nGPU6\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp7_gpu7 [label="MoE\nL4 E14-15\nGPU7\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l5_attn_tp0_gpu0 [label="Attention\nL5 TP0\nGPU0\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp1_gpu1 [label="Attention\nL5 TP1\nGPU1\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp2_gpu2 [label="Attention\nL5 TP2\nGPU2\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp3_gpu3 [label="Attention\nL5 TP3\nGPU3\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp4_gpu4 [label="Attention\nL5 TP4\nGPU4\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp5_gpu5 [label="Attention\nL5 TP5\nGPU5\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp6_gpu6 [label="Attention\nL5 TP6\nGPU6\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp7_gpu7 [label="Attention\nL5 TP7\nGPU7\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l5_moe_tp0_gpu0 [label="MoE\nL5 E0-1\nGPU0\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp1_gpu1 [label="MoE\nL5 E2-3\nGPU1\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp2_gpu2 [label="MoE\nL5 E4-5\nGPU2\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp3_gpu3 [label="MoE\nL5 E6-7\nGPU3\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp4_gpu4 [label="MoE\nL5 E8-9\nGPU4\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp5_gpu5 [label="MoE\nL5 E10-11\nGPU5\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp6_gpu6 [label="MoE\nL5 E12-13\nGPU6\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp7_gpu7 [label="MoE\nL5 E14-15\nGPU7\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l6_attn_tp0_gpu0 [label="Attention\nL6 TP0\nGPU0\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp1_gpu1 [label="Attention\nL6 TP1\nGPU1\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp2_gpu2 [label="Attention\nL6 TP2\nGPU2\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp3_gpu3 [label="Attention\nL6 TP3\nGPU3\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp4_gpu4 [label="Attention\nL6 TP4\nGPU4\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp5_gpu5 [label="Attention\nL6 TP5\nGPU5\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp6_gpu6 [label="Attention\nL6 TP6\nGPU6\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp7_gpu7 [label="Attention\nL6 TP7\nGPU7\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l6_moe_tp0_gpu0 [label="MoE\nL6 E0-1\nGPU0\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp1_gpu1 [label="MoE\nL6 E2-3\nGPU1\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp2_gpu2 [label="MoE\nL6 E4-5\nGPU2\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp3_gpu3 [label="MoE\nL6 E6-7\nGPU3\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp4_gpu4 [label="MoE\nL6 E8-9\nGPU4\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp5_gpu5 [label="MoE\nL6 E10-11\nGPU5\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp6_gpu6 [label="MoE\nL6 E12-13\nGPU6\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp7_gpu7 [label="MoE\nL6 E14-15\nGPU7\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l7_attn_tp0_gpu0 [label="Attention\nL7 TP0\nGPU0\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp1_gpu1 [label="Attention\nL7 TP1\nGPU1\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp2_gpu2 [label="Attention\nL7 TP2\nGPU2\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp3_gpu3 [label="Attention\nL7 TP3\nGPU3\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp4_gpu4 [label="Attention\nL7 TP4\nGPU4\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp5_gpu5 [label="Attention\nL7 TP5\nGPU5\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp6_gpu6 [label="Attention\nL7 TP6\nGPU6\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp7_gpu7 [label="Attention\nL7 TP7\nGPU7\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l7_moe_tp0_gpu0 [label="MoE\nL7 E0-1\nGPU0\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp1_gpu1 [label="MoE\nL7 E2-3\nGPU1\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp2_gpu2 [label="MoE\nL7 E4-5\nGPU2\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp3_gpu3 [label="MoE\nL7 E6-7\nGPU3\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp4_gpu4 [label="MoE\nL7 E8-9\nGPU4\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp5_gpu5 [label="MoE\nL7 E10-11\nGPU5\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp6_gpu6 [label="MoE\nL7 E12-13\nGPU6\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp7_gpu7 [label="MoE\nL7 E14-15\nGPU7\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l8_attn_tp0_gpu8 [label="Attention\nL8 TP0\nGPU8\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp1_gpu9 [label="Attention\nL8 TP1\nGPU9\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp2_gpu10 [label="Attention\nL8 TP2\nGPU10\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp3_gpu11 [label="Attention\nL8 TP3\nGPU11\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp4_gpu12 [label="Attention\nL8 TP4\nGPU12\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp5_gpu13 [label="Attention\nL8 TP5\nGPU13\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp6_gpu14 [label="Attention\nL8 TP6\nGPU14\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp7_gpu15 [label="Attention\nL8 TP7\nGPU15\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l8_moe_tp0_gpu8 [label="MoE\nL8 E0-1\nGPU8\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp1_gpu9 [label="MoE\nL8 E2-3\nGPU9\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp2_gpu10 [label="MoE\nL8 E4-5\nGPU10\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp3_gpu11 [label="MoE\nL8 E6-7\nGPU11\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp4_gpu12 [label="MoE\nL8 E8-9\nGPU12\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp5_gpu13 [label="MoE\nL8 E10-11\nGPU13\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp6_gpu14 [label="MoE\nL8 E12-13\nGPU14\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp7_gpu15 [label="MoE\nL8 E14-15\nGPU15\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l9_attn_tp0_gpu8 [label="Attention\nL9 TP0\nGPU8\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp1_gpu9 [label="Attention\nL9 TP1\nGPU9\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp2_gpu10 [label="Attention\nL9 TP2\nGPU10\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp3_gpu11 [label="Attention\nL9 TP3\nGPU11\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp4_gpu12 [label="Attention\nL9 TP4\nGPU12\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp5_gpu13 [label="Attention\nL9 TP5\nGPU13\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp6_gpu14 [label="Attention\nL9 TP6\nGPU14\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp7_gpu15 [label="Attention\nL9 TP7\nGPU15\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l9_moe_tp0_gpu8 [label="MoE\nL9 E0-1\nGPU8\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp1_gpu9 [label="MoE\nL9 E2-3\nGPU9\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp2_gpu10 [label="MoE\nL9 E4-5\nGPU10\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp3_gpu11 [label="MoE\nL9 E6-7\nGPU11\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp4_gpu12 [label="MoE\nL9 E8-9\nGPU12\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp5_gpu13 [label="MoE\nL9 E10-11\nGPU13\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp6_gpu14 [label="MoE\nL9 E12-13\nGPU14\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp7_gpu15 [label="MoE\nL9 E14-15\nGPU15\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l10_attn_tp0_gpu8 [label="Attention\nL10 TP0\nGPU8\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp1_gpu9 [label="Attention\nL10 TP1\nGPU9\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp2_gpu10 [label="Attention\nL10 TP2\nGPU10\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp3_gpu11 [label="Attention\nL10 TP3\nGPU11\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp4_gpu12 [label="Attention\nL10 TP4\nGPU12\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp5_gpu13 [label="Attention\nL10 TP5\nGPU13\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp6_gpu14 [label="Attention\nL10 TP6\nGPU14\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp7_gpu15 [label="Attention\nL10 TP7\nGPU15\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l10_moe_tp0_gpu8 [label="MoE\nL10 E0-1\nGPU8\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp1_gpu9 [label="MoE\nL10 E2-3\nGPU9\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp2_gpu10 [label="MoE\nL10 E4-5\nGPU10\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp3_gpu11 [label="MoE\nL10 E6-7\nGPU11\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp4_gpu12 [label="MoE\nL10 E8-9\nGPU12\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp5_gpu13 [label="MoE\nL10 E10-11\nGPU13\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp6_gpu14 [label="MoE\nL10 E12-13\nGPU14\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp7_gpu15 [label="MoE\nL10 E14-15\nGPU15\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l11_attn_tp0_gpu8 [label="Attention\nL11 TP0\nGPU8\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp1_gpu9 [label="Attention\nL11 TP1\nGPU9\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp2_gpu10 [label="Attention\nL11 TP2\nGPU10\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp3_gpu11 [label="Attention\nL11 TP3\nGPU11\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp4_gpu12 [label="Attention\nL11 TP4\nGPU12\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp5_gpu13 [label="Attention\nL11 TP5\nGPU13\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp6_gpu14 [label="Attention\nL11 TP6\nGPU14\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp7_gpu15 [label="Attention\nL11 TP7\nGPU15\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l11_moe_tp0_gpu8 [label="MoE\nL11 E0-1\nGPU8\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp1_gpu9 [label="MoE\nL11 E2-3\nGPU9\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp2_gpu10 [label="MoE\nL11 E4-5\nGPU10\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp3_gpu11 [label="MoE\nL11 E6-7\nGPU11\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp4_gpu12 [label="MoE\nL11 E8-9\nGPU12\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp5_gpu13 [label="MoE\nL11 E10-11\nGPU13\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp6_gpu14 [label="MoE\nL11 E12-13\nGPU14\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp7_gpu15 [label="MoE\nL11 E14-15\nGPU15\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l12_attn_tp0_gpu8 [label="Attention\nL12 TP0\nGPU8\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp1_gpu9 [label="Attention\nL12 TP1\nGPU9\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp2_gpu10 [label="Attention\nL12 TP2\nGPU10\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp3_gpu11 [label="Attention\nL12 TP3\nGPU11\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp4_gpu12 [label="Attention\nL12 TP4\nGPU12\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp5_gpu13 [label="Attention\nL12 TP5\nGPU13\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp6_gpu14 [label="Attention\nL12 TP6\nGPU14\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp7_gpu15 [label="Attention\nL12 TP7\nGPU15\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l12_moe_tp0_gpu8 [label="MoE\nL12 E0-1\nGPU8\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp1_gpu9 [label="MoE\nL12 E2-3\nGPU9\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp2_gpu10 [label="MoE\nL12 E4-5\nGPU10\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp3_gpu11 [label="MoE\nL12 E6-7\nGPU11\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp4_gpu12 [label="MoE\nL12 E8-9\nGPU12\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp5_gpu13 [label="MoE\nL12 E10-11\nGPU13\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp6_gpu14 [label="MoE\nL12 E12-13\nGPU14\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp7_gpu15 [label="MoE\nL12 E14-15\nGPU15\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l13_attn_tp0_gpu8 [label="Attention\nL13 TP0\nGPU8\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp1_gpu9 [label="Attention\nL13 TP1\nGPU9\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp2_gpu10 [label="Attention\nL13 TP2\nGPU10\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp3_gpu11 [label="Attention\nL13 TP3\nGPU11\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp4_gpu12 [label="Attention\nL13 TP4\nGPU12\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp5_gpu13 [label="Attention\nL13 TP5\nGPU13\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp6_gpu14 [label="Attention\nL13 TP6\nGPU14\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp7_gpu15 [label="Attention\nL13 TP7\nGPU15\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l13_moe_tp0_gpu8 [label="MoE\nL13 E0-1\nGPU8\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp1_gpu9 [label="MoE\nL13 E2-3\nGPU9\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp2_gpu10 [label="MoE\nL13 E4-5\nGPU10\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp3_gpu11 [label="MoE\nL13 E6-7\nGPU11\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp4_gpu12 [label="MoE\nL13 E8-9\nGPU12\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp5_gpu13 [label="MoE\nL13 E10-11\nGPU13\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp6_gpu14 [label="MoE\nL13 E12-13\nGPU14\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp7_gpu15 [label="MoE\nL13 E14-15\nGPU15\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l14_attn_tp0_gpu8 [label="Attention\nL14 TP0\nGPU8\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp1_gpu9 [label="Attention\nL14 TP1\nGPU9\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp2_gpu10 [label="Attention\nL14 TP2\nGPU10\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp3_gpu11 [label="Attention\nL14 TP3\nGPU11\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp4_gpu12 [label="Attention\nL14 TP4\nGPU12\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp5_gpu13 [label="Attention\nL14 TP5\nGPU13\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp6_gpu14 [label="Attention\nL14 TP6\nGPU14\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp7_gpu15 [label="Attention\nL14 TP7\nGPU15\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l14_moe_tp0_gpu8 [label="MoE\nL14 E0-1\nGPU8\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp1_gpu9 [label="MoE\nL14 E2-3\nGPU9\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp2_gpu10 [label="MoE\nL14 E4-5\nGPU10\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp3_gpu11 [label="MoE\nL14 E6-7\nGPU11\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp4_gpu12 [label="MoE\nL14 E8-9\nGPU12\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp5_gpu13 [label="MoE\nL14 E10-11\nGPU13\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp6_gpu14 [label="MoE\nL14 E12-13\nGPU14\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp7_gpu15 [label="MoE\nL14 E14-15\nGPU15\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l15_attn_tp0_gpu8 [label="Attention\nL15 TP0\nGPU8\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp1_gpu9 [label="Attention\nL15 TP1\nGPU9\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp2_gpu10 [label="Attention\nL15 TP2\nGPU10\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp3_gpu11 [label="Attention\nL15 TP3\nGPU11\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp4_gpu12 [label="Attention\nL15 TP4\nGPU12\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp5_gpu13 [label="Attention\nL15 TP5\nGPU13\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp6_gpu14 [label="Attention\nL15 TP6\nGPU14\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp7_gpu15 [label="Attention\nL15 TP7\nGPU15\nIn:[128,10000,4,128]\nOut:[128,10000,4,128]" fillcolor=lightcoral]
	l15_moe_tp0_gpu8 [label="MoE\nL15 E0-1\nGPU8\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp1_gpu9 [label="MoE\nL15 E2-3\nGPU9\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp2_gpu10 [label="MoE\nL15 E4-5\nGPU10\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp3_gpu11 [label="MoE\nL15 E6-7\nGPU11\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp4_gpu12 [label="MoE\nL15 E8-9\nGPU12\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp5_gpu13 [label="MoE\nL15 E10-11\nGPU13\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp6_gpu14 [label="MoE\nL15 E12-13\nGPU14\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp7_gpu15 [label="MoE\nL15 E14-15\nGPU15\nIn:[128,10000,4096]\nOut:[128,10000,4096]" fillcolor=lightyellow]
	input -> l0_attn_tp0_gpu0
	input -> l0_attn_tp1_gpu1
	input -> l0_attn_tp2_gpu2
	input -> l0_attn_tp3_gpu3
	input -> l0_attn_tp4_gpu4
	input -> l0_attn_tp5_gpu5
	input -> l0_attn_tp6_gpu6
	input -> l0_attn_tp7_gpu7
	l0_attn_tp0_gpu0 -> l0_moe_tp0_gpu0
	l0_attn_tp1_gpu1 -> l0_moe_tp1_gpu1
	l0_attn_tp2_gpu2 -> l0_moe_tp2_gpu2
	l0_attn_tp3_gpu3 -> l0_moe_tp3_gpu3
	l0_attn_tp4_gpu4 -> l0_moe_tp4_gpu4
	l0_attn_tp5_gpu5 -> l0_moe_tp5_gpu5
	l0_attn_tp6_gpu6 -> l0_moe_tp6_gpu6
	l0_attn_tp7_gpu7 -> l0_moe_tp7_gpu7
	l0_allreduce [label="TP All-Reduce\nLayer 0" fillcolor=lightgray shape=parallelogram]
	l0_moe_tp0_gpu0 -> l0_allreduce
	l0_allreduce -> l1_attn_tp0_gpu0
	l0_moe_tp1_gpu1 -> l0_allreduce
	l0_allreduce -> l1_attn_tp1_gpu1
	l0_moe_tp2_gpu2 -> l0_allreduce
	l0_allreduce -> l1_attn_tp2_gpu2
	l0_moe_tp3_gpu3 -> l0_allreduce
	l0_allreduce -> l1_attn_tp3_gpu3
	l0_moe_tp4_gpu4 -> l0_allreduce
	l0_allreduce -> l1_attn_tp4_gpu4
	l0_moe_tp5_gpu5 -> l0_allreduce
	l0_allreduce -> l1_attn_tp5_gpu5
	l0_moe_tp6_gpu6 -> l0_allreduce
	l0_allreduce -> l1_attn_tp6_gpu6
	l0_moe_tp7_gpu7 -> l0_allreduce
	l0_allreduce -> l1_attn_tp7_gpu7
	l1_attn_tp0_gpu0 -> l1_moe_tp0_gpu0
	l1_attn_tp1_gpu1 -> l1_moe_tp1_gpu1
	l1_attn_tp2_gpu2 -> l1_moe_tp2_gpu2
	l1_attn_tp3_gpu3 -> l1_moe_tp3_gpu3
	l1_attn_tp4_gpu4 -> l1_moe_tp4_gpu4
	l1_attn_tp5_gpu5 -> l1_moe_tp5_gpu5
	l1_attn_tp6_gpu6 -> l1_moe_tp6_gpu6
	l1_attn_tp7_gpu7 -> l1_moe_tp7_gpu7
	l1_allreduce [label="TP All-Reduce\nLayer 1" fillcolor=lightgray shape=parallelogram]
	l1_moe_tp0_gpu0 -> l1_allreduce
	l1_allreduce -> l2_attn_tp0_gpu0
	l1_moe_tp1_gpu1 -> l1_allreduce
	l1_allreduce -> l2_attn_tp1_gpu1
	l1_moe_tp2_gpu2 -> l1_allreduce
	l1_allreduce -> l2_attn_tp2_gpu2
	l1_moe_tp3_gpu3 -> l1_allreduce
	l1_allreduce -> l2_attn_tp3_gpu3
	l1_moe_tp4_gpu4 -> l1_allreduce
	l1_allreduce -> l2_attn_tp4_gpu4
	l1_moe_tp5_gpu5 -> l1_allreduce
	l1_allreduce -> l2_attn_tp5_gpu5
	l1_moe_tp6_gpu6 -> l1_allreduce
	l1_allreduce -> l2_attn_tp6_gpu6
	l1_moe_tp7_gpu7 -> l1_allreduce
	l1_allreduce -> l2_attn_tp7_gpu7
	l2_attn_tp0_gpu0 -> l2_moe_tp0_gpu0
	l2_attn_tp1_gpu1 -> l2_moe_tp1_gpu1
	l2_attn_tp2_gpu2 -> l2_moe_tp2_gpu2
	l2_attn_tp3_gpu3 -> l2_moe_tp3_gpu3
	l2_attn_tp4_gpu4 -> l2_moe_tp4_gpu4
	l2_attn_tp5_gpu5 -> l2_moe_tp5_gpu5
	l2_attn_tp6_gpu6 -> l2_moe_tp6_gpu6
	l2_attn_tp7_gpu7 -> l2_moe_tp7_gpu7
	l2_allreduce [label="TP All-Reduce\nLayer 2" fillcolor=lightgray shape=parallelogram]
	l2_moe_tp0_gpu0 -> l2_allreduce
	l2_allreduce -> l3_attn_tp0_gpu0
	l2_moe_tp1_gpu1 -> l2_allreduce
	l2_allreduce -> l3_attn_tp1_gpu1
	l2_moe_tp2_gpu2 -> l2_allreduce
	l2_allreduce -> l3_attn_tp2_gpu2
	l2_moe_tp3_gpu3 -> l2_allreduce
	l2_allreduce -> l3_attn_tp3_gpu3
	l2_moe_tp4_gpu4 -> l2_allreduce
	l2_allreduce -> l3_attn_tp4_gpu4
	l2_moe_tp5_gpu5 -> l2_allreduce
	l2_allreduce -> l3_attn_tp5_gpu5
	l2_moe_tp6_gpu6 -> l2_allreduce
	l2_allreduce -> l3_attn_tp6_gpu6
	l2_moe_tp7_gpu7 -> l2_allreduce
	l2_allreduce -> l3_attn_tp7_gpu7
	l3_attn_tp0_gpu0 -> l3_moe_tp0_gpu0
	l3_attn_tp1_gpu1 -> l3_moe_tp1_gpu1
	l3_attn_tp2_gpu2 -> l3_moe_tp2_gpu2
	l3_attn_tp3_gpu3 -> l3_moe_tp3_gpu3
	l3_attn_tp4_gpu4 -> l3_moe_tp4_gpu4
	l3_attn_tp5_gpu5 -> l3_moe_tp5_gpu5
	l3_attn_tp6_gpu6 -> l3_moe_tp6_gpu6
	l3_attn_tp7_gpu7 -> l3_moe_tp7_gpu7
	l3_allreduce [label="TP All-Reduce\nLayer 3" fillcolor=lightgray shape=parallelogram]
	l3_moe_tp0_gpu0 -> l3_allreduce
	l3_allreduce -> l4_attn_tp0_gpu0
	l3_moe_tp1_gpu1 -> l3_allreduce
	l3_allreduce -> l4_attn_tp1_gpu1
	l3_moe_tp2_gpu2 -> l3_allreduce
	l3_allreduce -> l4_attn_tp2_gpu2
	l3_moe_tp3_gpu3 -> l3_allreduce
	l3_allreduce -> l4_attn_tp3_gpu3
	l3_moe_tp4_gpu4 -> l3_allreduce
	l3_allreduce -> l4_attn_tp4_gpu4
	l3_moe_tp5_gpu5 -> l3_allreduce
	l3_allreduce -> l4_attn_tp5_gpu5
	l3_moe_tp6_gpu6 -> l3_allreduce
	l3_allreduce -> l4_attn_tp6_gpu6
	l3_moe_tp7_gpu7 -> l3_allreduce
	l3_allreduce -> l4_attn_tp7_gpu7
	l4_attn_tp0_gpu0 -> l4_moe_tp0_gpu0
	l4_attn_tp1_gpu1 -> l4_moe