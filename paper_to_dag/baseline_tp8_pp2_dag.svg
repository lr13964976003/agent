<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Baseline_TP8_PP2 Pages: 1 -->
<svg width="755pt" height="3861pt"
 viewBox="0.00 0.00 755.00 3861.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3857.48)">
<title>Baseline_TP8_PP2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3857.48 751,-3857.48 751,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="373.5" cy="-3826.61" rx="265.74" ry="26.74"/>
<text text-anchor="middle" x="373.5" y="-3830.41" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="373.5" y="-3815.41" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_0_mha_tp8 -->
<g id="node2" class="node">
<title>layer_0_mha_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-3763.74 0,-3763.74 0,-3695.74 747,-3695.74 747,-3763.74"/>
<text text-anchor="middle" x="373.5" y="-3748.54" font-family="Times,serif" font-size="14.00">Layer 0 MHA</text>
<text text-anchor="middle" x="373.5" y="-3733.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-3718.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-3703.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- input&#45;&gt;layer_0_mha_tp8 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-3799.69C373.5,-3791.72 373.5,-3782.73 373.5,-3773.93"/>
<polygon fill="black" stroke="black" points="377,-3773.77 373.5,-3763.77 370,-3773.77 377,-3773.77"/>
</g>
<!-- layer_0_mlp_tp8 -->
<g id="node3" class="node">
<title>layer_0_mlp_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-3659.74 0,-3659.74 0,-3576.74 747,-3576.74 747,-3659.74"/>
<text text-anchor="middle" x="373.5" y="-3644.54" font-family="Times,serif" font-size="14.00">Layer 0 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-3629.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-3614.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-3599.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-3584.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_0_mha_tp8&#45;&gt;layer_0_mlp_tp8 -->
<g id="edge2" class="edge">
<title>layer_0_mha_tp8&#45;&gt;layer_0_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-3695.59C373.5,-3687.54 373.5,-3678.74 373.5,-3670.08"/>
<polygon fill="black" stroke="black" points="377,-3670.02 373.5,-3660.02 370,-3670.02 377,-3670.02"/>
</g>
<!-- layer_1_mha_tp8 -->
<g id="node4" class="node">
<title>layer_1_mha_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-3540.74 0,-3540.74 0,-3472.74 747,-3472.74 747,-3540.74"/>
<text text-anchor="middle" x="373.5" y="-3525.54" font-family="Times,serif" font-size="14.00">Layer 1 MHA</text>
<text text-anchor="middle" x="373.5" y="-3510.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-3495.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-3480.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_0_mlp_tp8&#45;&gt;layer_1_mha_tp8 -->
<g id="edge3" class="edge">
<title>layer_0_mlp_tp8&#45;&gt;layer_1_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-3576.47C373.5,-3568.26 373.5,-3559.6 373.5,-3551.3"/>
<polygon fill="black" stroke="black" points="377,-3551.04 373.5,-3541.04 370,-3551.04 377,-3551.04"/>
</g>
<!-- layer_1_mlp_tp8 -->
<g id="node5" class="node">
<title>layer_1_mlp_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-3436.74 0,-3436.74 0,-3353.74 747,-3353.74 747,-3436.74"/>
<text text-anchor="middle" x="373.5" y="-3421.54" font-family="Times,serif" font-size="14.00">Layer 1 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-3406.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-3391.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-3376.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-3361.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_1_mha_tp8&#45;&gt;layer_1_mlp_tp8 -->
<g id="edge4" class="edge">
<title>layer_1_mha_tp8&#45;&gt;layer_1_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-3472.59C373.5,-3464.54 373.5,-3455.74 373.5,-3447.08"/>
<polygon fill="black" stroke="black" points="377,-3447.02 373.5,-3437.02 370,-3447.02 377,-3447.02"/>
</g>
<!-- layer_2_mha_tp8 -->
<g id="node6" class="node">
<title>layer_2_mha_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-3317.74 0,-3317.74 0,-3249.74 747,-3249.74 747,-3317.74"/>
<text text-anchor="middle" x="373.5" y="-3302.54" font-family="Times,serif" font-size="14.00">Layer 2 MHA</text>
<text text-anchor="middle" x="373.5" y="-3287.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-3272.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-3257.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_1_mlp_tp8&#45;&gt;layer_2_mha_tp8 -->
<g id="edge5" class="edge">
<title>layer_1_mlp_tp8&#45;&gt;layer_2_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-3353.47C373.5,-3345.26 373.5,-3336.6 373.5,-3328.3"/>
<polygon fill="black" stroke="black" points="377,-3328.04 373.5,-3318.04 370,-3328.04 377,-3328.04"/>
</g>
<!-- layer_2_mlp_tp8 -->
<g id="node7" class="node">
<title>layer_2_mlp_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-3213.74 0,-3213.74 0,-3130.74 747,-3130.74 747,-3213.74"/>
<text text-anchor="middle" x="373.5" y="-3198.54" font-family="Times,serif" font-size="14.00">Layer 2 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-3183.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-3168.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-3153.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-3138.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_2_mha_tp8&#45;&gt;layer_2_mlp_tp8 -->
<g id="edge6" class="edge">
<title>layer_2_mha_tp8&#45;&gt;layer_2_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-3249.59C373.5,-3241.54 373.5,-3232.74 373.5,-3224.08"/>
<polygon fill="black" stroke="black" points="377,-3224.02 373.5,-3214.02 370,-3224.02 377,-3224.02"/>
</g>
<!-- layer_3_mha_tp8 -->
<g id="node8" class="node">
<title>layer_3_mha_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-3094.74 0,-3094.74 0,-3026.74 747,-3026.74 747,-3094.74"/>
<text text-anchor="middle" x="373.5" y="-3079.54" font-family="Times,serif" font-size="14.00">Layer 3 MHA</text>
<text text-anchor="middle" x="373.5" y="-3064.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-3049.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-3034.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_2_mlp_tp8&#45;&gt;layer_3_mha_tp8 -->
<g id="edge7" class="edge">
<title>layer_2_mlp_tp8&#45;&gt;layer_3_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-3130.47C373.5,-3122.26 373.5,-3113.6 373.5,-3105.3"/>
<polygon fill="black" stroke="black" points="377,-3105.04 373.5,-3095.04 370,-3105.04 377,-3105.04"/>
</g>
<!-- layer_3_mlp_tp8 -->
<g id="node9" class="node">
<title>layer_3_mlp_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-2990.74 0,-2990.74 0,-2907.74 747,-2907.74 747,-2990.74"/>
<text text-anchor="middle" x="373.5" y="-2975.54" font-family="Times,serif" font-size="14.00">Layer 3 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-2960.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-2945.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-2930.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-2915.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_3_mha_tp8&#45;&gt;layer_3_mlp_tp8 -->
<g id="edge8" class="edge">
<title>layer_3_mha_tp8&#45;&gt;layer_3_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-3026.59C373.5,-3018.54 373.5,-3009.74 373.5,-3001.08"/>
<polygon fill="black" stroke="black" points="377,-3001.02 373.5,-2991.02 370,-3001.02 377,-3001.02"/>
</g>
<!-- layer_4_mha_tp8 -->
<g id="node10" class="node">
<title>layer_4_mha_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-2871.74 0,-2871.74 0,-2803.74 747,-2803.74 747,-2871.74"/>
<text text-anchor="middle" x="373.5" y="-2856.54" font-family="Times,serif" font-size="14.00">Layer 4 MHA</text>
<text text-anchor="middle" x="373.5" y="-2841.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-2826.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-2811.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_3_mlp_tp8&#45;&gt;layer_4_mha_tp8 -->
<g id="edge9" class="edge">
<title>layer_3_mlp_tp8&#45;&gt;layer_4_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-2907.47C373.5,-2899.26 373.5,-2890.6 373.5,-2882.3"/>
<polygon fill="black" stroke="black" points="377,-2882.04 373.5,-2872.04 370,-2882.04 377,-2882.04"/>
</g>
<!-- layer_4_mlp_tp8 -->
<g id="node11" class="node">
<title>layer_4_mlp_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-2767.74 0,-2767.74 0,-2684.74 747,-2684.74 747,-2767.74"/>
<text text-anchor="middle" x="373.5" y="-2752.54" font-family="Times,serif" font-size="14.00">Layer 4 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-2737.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-2722.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-2707.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-2692.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_4_mha_tp8&#45;&gt;layer_4_mlp_tp8 -->
<g id="edge10" class="edge">
<title>layer_4_mha_tp8&#45;&gt;layer_4_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-2803.59C373.5,-2795.54 373.5,-2786.74 373.5,-2778.08"/>
<polygon fill="black" stroke="black" points="377,-2778.02 373.5,-2768.02 370,-2778.02 377,-2778.02"/>
</g>
<!-- layer_5_mha_tp8 -->
<g id="node12" class="node">
<title>layer_5_mha_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-2648.74 0,-2648.74 0,-2580.74 747,-2580.74 747,-2648.74"/>
<text text-anchor="middle" x="373.5" y="-2633.54" font-family="Times,serif" font-size="14.00">Layer 5 MHA</text>
<text text-anchor="middle" x="373.5" y="-2618.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-2603.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-2588.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_4_mlp_tp8&#45;&gt;layer_5_mha_tp8 -->
<g id="edge11" class="edge">
<title>layer_4_mlp_tp8&#45;&gt;layer_5_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-2684.47C373.5,-2676.26 373.5,-2667.6 373.5,-2659.3"/>
<polygon fill="black" stroke="black" points="377,-2659.04 373.5,-2649.04 370,-2659.04 377,-2659.04"/>
</g>
<!-- layer_5_mlp_tp8 -->
<g id="node13" class="node">
<title>layer_5_mlp_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-2544.74 0,-2544.74 0,-2461.74 747,-2461.74 747,-2544.74"/>
<text text-anchor="middle" x="373.5" y="-2529.54" font-family="Times,serif" font-size="14.00">Layer 5 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-2514.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-2499.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-2484.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-2469.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_5_mha_tp8&#45;&gt;layer_5_mlp_tp8 -->
<g id="edge12" class="edge">
<title>layer_5_mha_tp8&#45;&gt;layer_5_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-2580.59C373.5,-2572.54 373.5,-2563.74 373.5,-2555.08"/>
<polygon fill="black" stroke="black" points="377,-2555.02 373.5,-2545.02 370,-2555.02 377,-2555.02"/>
</g>
<!-- layer_6_mha_tp8 -->
<g id="node14" class="node">
<title>layer_6_mha_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-2425.74 0,-2425.74 0,-2357.74 747,-2357.74 747,-2425.74"/>
<text text-anchor="middle" x="373.5" y="-2410.54" font-family="Times,serif" font-size="14.00">Layer 6 MHA</text>
<text text-anchor="middle" x="373.5" y="-2395.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-2380.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-2365.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_5_mlp_tp8&#45;&gt;layer_6_mha_tp8 -->
<g id="edge13" class="edge">
<title>layer_5_mlp_tp8&#45;&gt;layer_6_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-2461.47C373.5,-2453.26 373.5,-2444.6 373.5,-2436.3"/>
<polygon fill="black" stroke="black" points="377,-2436.04 373.5,-2426.04 370,-2436.04 377,-2436.04"/>
</g>
<!-- layer_6_mlp_tp8 -->
<g id="node15" class="node">
<title>layer_6_mlp_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-2321.74 0,-2321.74 0,-2238.74 747,-2238.74 747,-2321.74"/>
<text text-anchor="middle" x="373.5" y="-2306.54" font-family="Times,serif" font-size="14.00">Layer 6 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-2291.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-2276.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-2261.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-2246.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_6_mha_tp8&#45;&gt;layer_6_mlp_tp8 -->
<g id="edge14" class="edge">
<title>layer_6_mha_tp8&#45;&gt;layer_6_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-2357.59C373.5,-2349.54 373.5,-2340.74 373.5,-2332.08"/>
<polygon fill="black" stroke="black" points="377,-2332.02 373.5,-2322.02 370,-2332.02 377,-2332.02"/>
</g>
<!-- layer_7_mha_tp8 -->
<g id="node16" class="node">
<title>layer_7_mha_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-2202.74 0,-2202.74 0,-2134.74 747,-2134.74 747,-2202.74"/>
<text text-anchor="middle" x="373.5" y="-2187.54" font-family="Times,serif" font-size="14.00">Layer 7 MHA</text>
<text text-anchor="middle" x="373.5" y="-2172.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-2157.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-2142.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_6_mlp_tp8&#45;&gt;layer_7_mha_tp8 -->
<g id="edge15" class="edge">
<title>layer_6_mlp_tp8&#45;&gt;layer_7_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-2238.47C373.5,-2230.26 373.5,-2221.6 373.5,-2213.3"/>
<polygon fill="black" stroke="black" points="377,-2213.04 373.5,-2203.04 370,-2213.04 377,-2213.04"/>
</g>
<!-- layer_7_mlp_tp8 -->
<g id="node17" class="node">
<title>layer_7_mlp_tp8</title>
<polygon fill="lightcoral" stroke="black" points="747,-2098.74 0,-2098.74 0,-2015.74 747,-2015.74 747,-2098.74"/>
<text text-anchor="middle" x="373.5" y="-2083.54" font-family="Times,serif" font-size="14.00">Layer 7 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-2068.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-2053.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="373.5" y="-2038.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-2023.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_7_mha_tp8&#45;&gt;layer_7_mlp_tp8 -->
<g id="edge16" class="edge">
<title>layer_7_mha_tp8&#45;&gt;layer_7_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-2134.59C373.5,-2126.54 373.5,-2117.74 373.5,-2109.08"/>
<polygon fill="black" stroke="black" points="377,-2109.02 373.5,-2099.02 370,-2109.02 377,-2109.02"/>
</g>
<!-- stage0_to_stage1 -->
<g id="node18" class="node">
<title>stage0_to_stage1</title>
<polygon fill="orange" stroke="black" points="373.5,-1979.74 182.5,-1926.74 373.5,-1873.74 564.5,-1926.74 373.5,-1979.74"/>
<text text-anchor="middle" x="373.5" y="-1938.04" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="373.5" y="-1923.04" font-family="Times,serif" font-size="14.00">Stage 0 → Stage 1</text>
<text text-anchor="middle" x="373.5" y="-1908.04" font-family="Times,serif" font-size="14.00">GPU 7 → GPU 8</text>
</g>
<!-- layer_7_mlp_tp8&#45;&gt;stage0_to_stage1 -->
<g id="edge17" class="edge">
<title>layer_7_mlp_tp8&#45;&gt;stage0_to_stage1</title>
<path fill="none" stroke="black" d="M373.5,-2015.58C373.5,-2007.44 373.5,-1998.72 373.5,-1990.04"/>
<polygon fill="black" stroke="black" points="377,-1989.91 373.5,-1979.91 370,-1989.91 377,-1989.91"/>
</g>
<!-- layer_8_mha_tp8 -->
<g id="node19" class="node">
<title>layer_8_mha_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-1837.74 0,-1837.74 0,-1769.74 747,-1769.74 747,-1837.74"/>
<text text-anchor="middle" x="373.5" y="-1822.54" font-family="Times,serif" font-size="14.00">Layer 8 MHA</text>
<text text-anchor="middle" x="373.5" y="-1807.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-1792.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-1777.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- stage0_to_stage1&#45;&gt;layer_8_mha_tp8 -->
<g id="edge18" class="edge">
<title>stage0_to_stage1&#45;&gt;layer_8_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-1873.72C373.5,-1865.17 373.5,-1856.38 373.5,-1848.06"/>
<polygon fill="black" stroke="black" points="377,-1847.83 373.5,-1837.83 370,-1847.83 377,-1847.83"/>
</g>
<!-- layer_8_mlp_tp8 -->
<g id="node20" class="node">
<title>layer_8_mlp_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-1733.74 0,-1733.74 0,-1650.74 747,-1650.74 747,-1733.74"/>
<text text-anchor="middle" x="373.5" y="-1718.54" font-family="Times,serif" font-size="14.00">Layer 8 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-1703.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-1688.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-1673.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-1658.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_8_mha_tp8&#45;&gt;layer_8_mlp_tp8 -->
<g id="edge19" class="edge">
<title>layer_8_mha_tp8&#45;&gt;layer_8_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-1769.59C373.5,-1761.54 373.5,-1752.74 373.5,-1744.08"/>
<polygon fill="black" stroke="black" points="377,-1744.02 373.5,-1734.02 370,-1744.02 377,-1744.02"/>
</g>
<!-- layer_9_mha_tp8 -->
<g id="node21" class="node">
<title>layer_9_mha_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-1614.74 0,-1614.74 0,-1546.74 747,-1546.74 747,-1614.74"/>
<text text-anchor="middle" x="373.5" y="-1599.54" font-family="Times,serif" font-size="14.00">Layer 9 MHA</text>
<text text-anchor="middle" x="373.5" y="-1584.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-1569.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-1554.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_8_mlp_tp8&#45;&gt;layer_9_mha_tp8 -->
<g id="edge20" class="edge">
<title>layer_8_mlp_tp8&#45;&gt;layer_9_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-1650.47C373.5,-1642.26 373.5,-1633.6 373.5,-1625.3"/>
<polygon fill="black" stroke="black" points="377,-1625.04 373.5,-1615.04 370,-1625.04 377,-1625.04"/>
</g>
<!-- layer_9_mlp_tp8 -->
<g id="node22" class="node">
<title>layer_9_mlp_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-1510.74 0,-1510.74 0,-1427.74 747,-1427.74 747,-1510.74"/>
<text text-anchor="middle" x="373.5" y="-1495.54" font-family="Times,serif" font-size="14.00">Layer 9 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-1480.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-1465.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-1450.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-1435.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_9_mha_tp8&#45;&gt;layer_9_mlp_tp8 -->
<g id="edge21" class="edge">
<title>layer_9_mha_tp8&#45;&gt;layer_9_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-1546.59C373.5,-1538.54 373.5,-1529.74 373.5,-1521.08"/>
<polygon fill="black" stroke="black" points="377,-1521.02 373.5,-1511.02 370,-1521.02 377,-1521.02"/>
</g>
<!-- layer_10_mha_tp8 -->
<g id="node23" class="node">
<title>layer_10_mha_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-1391.74 0,-1391.74 0,-1323.74 747,-1323.74 747,-1391.74"/>
<text text-anchor="middle" x="373.5" y="-1376.54" font-family="Times,serif" font-size="14.00">Layer 10 MHA</text>
<text text-anchor="middle" x="373.5" y="-1361.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-1346.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-1331.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_9_mlp_tp8&#45;&gt;layer_10_mha_tp8 -->
<g id="edge22" class="edge">
<title>layer_9_mlp_tp8&#45;&gt;layer_10_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-1427.47C373.5,-1419.26 373.5,-1410.6 373.5,-1402.3"/>
<polygon fill="black" stroke="black" points="377,-1402.04 373.5,-1392.04 370,-1402.04 377,-1402.04"/>
</g>
<!-- layer_10_mlp_tp8 -->
<g id="node24" class="node">
<title>layer_10_mlp_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-1287.74 0,-1287.74 0,-1204.74 747,-1204.74 747,-1287.74"/>
<text text-anchor="middle" x="373.5" y="-1272.54" font-family="Times,serif" font-size="14.00">Layer 10 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-1257.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-1242.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-1227.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-1212.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_10_mha_tp8&#45;&gt;layer_10_mlp_tp8 -->
<g id="edge23" class="edge">
<title>layer_10_mha_tp8&#45;&gt;layer_10_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-1323.59C373.5,-1315.54 373.5,-1306.74 373.5,-1298.08"/>
<polygon fill="black" stroke="black" points="377,-1298.02 373.5,-1288.02 370,-1298.02 377,-1298.02"/>
</g>
<!-- layer_11_mha_tp8 -->
<g id="node25" class="node">
<title>layer_11_mha_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-1168.74 0,-1168.74 0,-1100.74 747,-1100.74 747,-1168.74"/>
<text text-anchor="middle" x="373.5" y="-1153.54" font-family="Times,serif" font-size="14.00">Layer 11 MHA</text>
<text text-anchor="middle" x="373.5" y="-1138.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-1123.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-1108.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_10_mlp_tp8&#45;&gt;layer_11_mha_tp8 -->
<g id="edge24" class="edge">
<title>layer_10_mlp_tp8&#45;&gt;layer_11_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-1204.47C373.5,-1196.26 373.5,-1187.6 373.5,-1179.3"/>
<polygon fill="black" stroke="black" points="377,-1179.04 373.5,-1169.04 370,-1179.04 377,-1179.04"/>
</g>
<!-- layer_11_mlp_tp8 -->
<g id="node26" class="node">
<title>layer_11_mlp_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-1064.74 0,-1064.74 0,-981.74 747,-981.74 747,-1064.74"/>
<text text-anchor="middle" x="373.5" y="-1049.54" font-family="Times,serif" font-size="14.00">Layer 11 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-1034.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-1019.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-1004.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-989.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_11_mha_tp8&#45;&gt;layer_11_mlp_tp8 -->
<g id="edge25" class="edge">
<title>layer_11_mha_tp8&#45;&gt;layer_11_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-1100.59C373.5,-1092.54 373.5,-1083.74 373.5,-1075.08"/>
<polygon fill="black" stroke="black" points="377,-1075.02 373.5,-1065.02 370,-1075.02 377,-1075.02"/>
</g>
<!-- layer_12_mha_tp8 -->
<g id="node27" class="node">
<title>layer_12_mha_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-945.74 0,-945.74 0,-877.74 747,-877.74 747,-945.74"/>
<text text-anchor="middle" x="373.5" y="-930.54" font-family="Times,serif" font-size="14.00">Layer 12 MHA</text>
<text text-anchor="middle" x="373.5" y="-915.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-900.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-885.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_11_mlp_tp8&#45;&gt;layer_12_mha_tp8 -->
<g id="edge26" class="edge">
<title>layer_11_mlp_tp8&#45;&gt;layer_12_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-981.47C373.5,-973.26 373.5,-964.6 373.5,-956.3"/>
<polygon fill="black" stroke="black" points="377,-956.04 373.5,-946.04 370,-956.04 377,-956.04"/>
</g>
<!-- layer_12_mlp_tp8 -->
<g id="node28" class="node">
<title>layer_12_mlp_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-841.74 0,-841.74 0,-758.74 747,-758.74 747,-841.74"/>
<text text-anchor="middle" x="373.5" y="-826.54" font-family="Times,serif" font-size="14.00">Layer 12 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-811.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-796.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-781.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-766.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_12_mha_tp8&#45;&gt;layer_12_mlp_tp8 -->
<g id="edge27" class="edge">
<title>layer_12_mha_tp8&#45;&gt;layer_12_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-877.59C373.5,-869.54 373.5,-860.74 373.5,-852.08"/>
<polygon fill="black" stroke="black" points="377,-852.02 373.5,-842.02 370,-852.02 377,-852.02"/>
</g>
<!-- layer_13_mha_tp8 -->
<g id="node29" class="node">
<title>layer_13_mha_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-722.74 0,-722.74 0,-654.74 747,-654.74 747,-722.74"/>
<text text-anchor="middle" x="373.5" y="-707.54" font-family="Times,serif" font-size="14.00">Layer 13 MHA</text>
<text text-anchor="middle" x="373.5" y="-692.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-677.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-662.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_12_mlp_tp8&#45;&gt;layer_13_mha_tp8 -->
<g id="edge28" class="edge">
<title>layer_12_mlp_tp8&#45;&gt;layer_13_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-758.47C373.5,-750.26 373.5,-741.6 373.5,-733.3"/>
<polygon fill="black" stroke="black" points="377,-733.04 373.5,-723.04 370,-733.04 377,-733.04"/>
</g>
<!-- layer_13_mlp_tp8 -->
<g id="node30" class="node">
<title>layer_13_mlp_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-618.74 0,-618.74 0,-535.74 747,-535.74 747,-618.74"/>
<text text-anchor="middle" x="373.5" y="-603.54" font-family="Times,serif" font-size="14.00">Layer 13 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-588.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-573.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-558.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-543.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_13_mha_tp8&#45;&gt;layer_13_mlp_tp8 -->
<g id="edge29" class="edge">
<title>layer_13_mha_tp8&#45;&gt;layer_13_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-654.59C373.5,-646.54 373.5,-637.74 373.5,-629.08"/>
<polygon fill="black" stroke="black" points="377,-629.02 373.5,-619.02 370,-629.02 377,-629.02"/>
</g>
<!-- layer_14_mha_tp8 -->
<g id="node31" class="node">
<title>layer_14_mha_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-499.74 0,-499.74 0,-431.74 747,-431.74 747,-499.74"/>
<text text-anchor="middle" x="373.5" y="-484.54" font-family="Times,serif" font-size="14.00">Layer 14 MHA</text>
<text text-anchor="middle" x="373.5" y="-469.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-454.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-439.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_13_mlp_tp8&#45;&gt;layer_14_mha_tp8 -->
<g id="edge30" class="edge">
<title>layer_13_mlp_tp8&#45;&gt;layer_14_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-535.47C373.5,-527.26 373.5,-518.6 373.5,-510.3"/>
<polygon fill="black" stroke="black" points="377,-510.04 373.5,-500.04 370,-510.04 377,-510.04"/>
</g>
<!-- layer_14_mlp_tp8 -->
<g id="node32" class="node">
<title>layer_14_mlp_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-395.74 0,-395.74 0,-312.74 747,-312.74 747,-395.74"/>
<text text-anchor="middle" x="373.5" y="-380.54" font-family="Times,serif" font-size="14.00">Layer 14 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-365.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-350.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-335.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-320.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_14_mha_tp8&#45;&gt;layer_14_mlp_tp8 -->
<g id="edge31" class="edge">
<title>layer_14_mha_tp8&#45;&gt;layer_14_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-431.59C373.5,-423.54 373.5,-414.74 373.5,-406.08"/>
<polygon fill="black" stroke="black" points="377,-406.02 373.5,-396.02 370,-406.02 377,-406.02"/>
</g>
<!-- layer_15_mha_tp8 -->
<g id="node33" class="node">
<title>layer_15_mha_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-276.74 0,-276.74 0,-208.74 747,-208.74 747,-276.74"/>
<text text-anchor="middle" x="373.5" y="-261.54" font-family="Times,serif" font-size="14.00">Layer 15 MHA</text>
<text text-anchor="middle" x="373.5" y="-246.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-231.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-216.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_14_mlp_tp8&#45;&gt;layer_15_mha_tp8 -->
<g id="edge32" class="edge">
<title>layer_14_mlp_tp8&#45;&gt;layer_15_mha_tp8</title>
<path fill="none" stroke="black" d="M373.5,-312.47C373.5,-304.26 373.5,-295.6 373.5,-287.3"/>
<polygon fill="black" stroke="black" points="377,-287.04 373.5,-277.04 370,-287.04 377,-287.04"/>
</g>
<!-- layer_15_mlp_tp8 -->
<g id="node34" class="node">
<title>layer_15_mlp_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="747,-172.74 0,-172.74 0,-89.74 747,-89.74 747,-172.74"/>
<text text-anchor="middle" x="373.5" y="-157.54" font-family="Times,serif" font-size="14.00">Layer 15 MLP+Experts</text>
<text text-anchor="middle" x="373.5" y="-142.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="373.5" y="-127.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="373.5" y="-112.54" font-family="Times,serif" font-size="14.00">16 experts colocated</text>
<text text-anchor="middle" x="373.5" y="-97.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_15_mha_tp8&#45;&gt;layer_15_mlp_tp8 -->
<g id="edge33" class="edge">
<title>layer_15_mha_tp8&#45;&gt;layer_15_mlp_tp8</title>
<path fill="none" stroke="black" d="M373.5,-208.59C373.5,-200.54 373.5,-191.74 373.5,-183.08"/>
<polygon fill="black" stroke="black" points="377,-183.02 373.5,-173.02 370,-183.02 377,-183.02"/>
</g>
<!-- output -->
<g id="node35" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="373.5" cy="-26.87" rx="265.74" ry="26.74"/>
<text text-anchor="middle" x="373.5" y="-30.67" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="373.5" y="-15.67" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_15_mlp_tp8&#45;&gt;output -->
<g id="edge34" class="edge">
<title>layer_15_mlp_tp8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M373.5,-89.49C373.5,-81.02 373.5,-72.15 373.5,-63.87"/>
<polygon fill="black" stroke="black" points="377,-63.76 373.5,-53.76 370,-63.76 377,-63.76"/>
</g>
</g>
</svg>
