<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="995pt"
 viewBox="0.00 0.00 1440.00 995.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.39 0.39) rotate(0) translate(4 2527.36)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2527.36 3658,-2527.36 3658,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage1</title>
<path fill="none" stroke="black" d="M1049,-1597.45C1049,-1597.45 3634,-1597.45 3634,-1597.45 3640,-1597.45 3646,-1603.45 3646,-1609.45 3646,-1609.45 3646,-2428.41 3646,-2428.41 3646,-2434.41 3640,-2440.41 3634,-2440.41 3634,-2440.41 1049,-2440.41 1049,-2440.41 1043,-2440.41 1037,-2434.41 1037,-2428.41 1037,-2428.41 1037,-1609.45 1037,-1609.45 1037,-1603.45 1043,-1597.45 1049,-1597.45"/>
<text text-anchor="middle" x="2341.5" y="-2425.21" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (GPUs 0&#45;8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage2</title>
<path fill="none" stroke="black" d="M1420,-1045.29C1420,-1045.29 3263,-1045.29 3263,-1045.29 3269,-1045.29 3275,-1051.29 3275,-1057.29 3275,-1057.29 3275,-1577.45 3275,-1577.45 3275,-1583.45 3269,-1589.45 3263,-1589.45 3263,-1589.45 1420,-1589.45 1420,-1589.45 1414,-1589.45 1408,-1583.45 1408,-1577.45 1408,-1577.45 1408,-1057.29 1408,-1057.29 1408,-1051.29 1414,-1045.29 1420,-1045.29"/>
<text text-anchor="middle" x="2341.5" y="-1574.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (GPUs 9&#45;17)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage3</title>
<path fill="none" stroke="black" d="M720,-582.12C720,-582.12 2563,-582.12 2563,-582.12 2569,-582.12 2575,-588.12 2575,-594.12 2575,-594.12 2575,-1025.29 2575,-1025.29 2575,-1031.29 2569,-1037.29 2563,-1037.29 2563,-1037.29 720,-1037.29 720,-1037.29 714,-1037.29 708,-1031.29 708,-1025.29 708,-1025.29 708,-594.12 708,-594.12 708,-588.12 714,-582.12 720,-582.12"/>
<text text-anchor="middle" x="1641.5" y="-1022.09" font-family="Times,serif" font-size="14.00">Pipeline Stage 3 (GPUs 18&#45;26)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage4</title>
<path fill="none" stroke="black" d="M20,-8C20,-8 1863,-8 1863,-8 1869,-8 1875,-14 1875,-20 1875,-20 1875,-562.12 1875,-562.12 1875,-568.12 1869,-574.12 1863,-574.12 1863,-574.12 20,-574.12 20,-574.12 14,-574.12 8,-568.12 8,-562.12 8,-562.12 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="941.5" y="-558.92" font-family="Times,serif" font-size="14.00">Pipeline Stage 4 (GPUs 27&#45;34)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="2341" cy="-2485.88" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="2341" y="-2497.18" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2341" y="-2482.18" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2341" y="-2467.18" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- embed -->
<g id="node2" class="node">
<title>embed</title>
<polygon fill="lightcoral" stroke="black" points="2565.5,-2409.41 2116.5,-2409.41 2116.5,-2356.41 2565.5,-2356.41 2565.5,-2409.41"/>
<text text-anchor="middle" x="2341" y="-2394.21" font-family="Times,serif" font-size="14.00">Embedding (GPU&#45;0)</text>
<text text-anchor="middle" x="2341" y="-2379.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048]</text>
<text text-anchor="middle" x="2341" y="-2364.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- input&#45;&gt;embed -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M2341,-2448.14C2341,-2438.88 2341,-2428.96 2341,-2419.74"/>
<polygon fill="black" stroke="black" points="2344.5,-2419.71 2341,-2409.71 2337.5,-2419.71 2344.5,-2419.71"/>
</g>
<!-- norm1_1 -->
<g id="node3" class="node">
<title>norm1_1</title>
<polygon fill="lightblue" stroke="black" points="2565.5,-2320.41 2116.5,-2320.41 2116.5,-2267.41 2565.5,-2267.41 2565.5,-2320.41"/>
<text text-anchor="middle" x="2341" y="-2305.21" font-family="Times,serif" font-size="14.00">LayerNorm (GPU&#45;0)</text>
<text text-anchor="middle" x="2341" y="-2290.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2341" y="-2275.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- embed&#45;&gt;norm1_1 -->
<g id="edge2" class="edge">
<title>embed&#45;&gt;norm1_1</title>
<path fill="none" stroke="black" d="M2341,-2356.27C2341,-2348.29 2341,-2339.34 2341,-2330.79"/>
<polygon fill="black" stroke="black" points="2344.5,-2330.66 2341,-2320.66 2337.5,-2330.66 2344.5,-2330.66"/>
</g>
<!-- attn_qkv_1 -->
<g id="node4" class="node">
<title>attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="2568,-2231.41 2114,-2231.41 2114,-2178.41 2568,-2178.41 2568,-2231.41"/>
<text text-anchor="middle" x="2341" y="-2216.21" font-family="Times,serif" font-size="14.00">QKV Projection (GPU&#45;0)</text>
<text text-anchor="middle" x="2341" y="-2201.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2341" y="-2186.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=32]</text>
</g>
<!-- norm1_1&#45;&gt;attn_qkv_1 -->
<g id="edge3" class="edge">
<title>norm1_1&#45;&gt;attn_qkv_1</title>
<path fill="none" stroke="black" d="M2341,-2267.27C2341,-2259.29 2341,-2250.34 2341,-2241.79"/>
<polygon fill="black" stroke="black" points="2344.5,-2241.66 2341,-2231.66 2337.5,-2241.66 2344.5,-2241.66"/>
</g>
<!-- attn_score_1 -->
<g id="node5" class="node">
<title>attn_score_1</title>
<polygon fill="lightblue" stroke="black" points="2568,-2142.41 2114,-2142.41 2114,-2089.41 2568,-2089.41 2568,-2142.41"/>
<text text-anchor="middle" x="2341" y="-2127.21" font-family="Times,serif" font-size="14.00">Attention Scores (GPU&#45;0)</text>
<text text-anchor="middle" x="2341" y="-2112.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=32]</text>
<text text-anchor="middle" x="2341" y="-2097.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=32]</text>
</g>
<!-- attn_qkv_1&#45;&gt;attn_score_1 -->
<g id="edge4" class="edge">
<title>attn_qkv_1&#45;&gt;attn_score_1</title>
<path fill="none" stroke="black" d="M2341,-2178.27C2341,-2170.29 2341,-2161.34 2341,-2152.79"/>
<polygon fill="black" stroke="black" points="2344.5,-2152.66 2341,-2142.66 2337.5,-2152.66 2344.5,-2152.66"/>
</g>
<!-- attn_out_1 -->
<g id="node6" class="node">
<title>attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="2565.5,-2053.41 2116.5,-2053.41 2116.5,-2000.41 2565.5,-2000.41 2565.5,-2053.41"/>
<text text-anchor="middle" x="2341" y="-2038.21" font-family="Times,serif" font-size="14.00">Attention Output (GPU&#45;0)</text>
<text text-anchor="middle" x="2341" y="-2023.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=32]</text>
<text text-anchor="middle" x="2341" y="-2008.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- attn_score_1&#45;&gt;attn_out_1 -->
<g id="edge5" class="edge">
<title>attn_score_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M2341,-2089.27C2341,-2081.29 2341,-2072.34 2341,-2063.79"/>
<polygon fill="black" stroke="black" points="2344.5,-2063.66 2341,-2053.66 2337.5,-2063.66 2344.5,-2063.66"/>
</g>
<!-- gate_1 -->
<g id="node7" class="node">
<title>gate_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2794.12,-1964.41 2073.31,-1964.41 1887.88,-1858.41 2608.69,-1858.41 2794.12,-1964.41"/>
<text text-anchor="middle" x="2341" y="-1922.71" font-family="Times,serif" font-size="14.00">Expert Gate (GPU&#45;0)</text>
<text text-anchor="middle" x="2341" y="-1907.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2341" y="-1892.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, experts=128]</text>
</g>
<!-- attn_out_1&#45;&gt;gate_1 -->
<g id="edge6" class="edge">
<title>attn_out_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M2341,-2000.15C2341,-1992.45 2341,-1983.66 2341,-1974.67"/>
<polygon fill="black" stroke="black" points="2344.5,-1974.5 2341,-1964.5 2337.5,-1974.5 2344.5,-1974.5"/>
</g>
<!-- expert_1_0 -->
<g id="node8" class="node">
<title>expert_1_0</title>
<ellipse fill="lightgreen" stroke="black" cx="1362" cy="-1784.93" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="1362" y="-1796.23" font-family="Times,serif" font-size="14.00">Expert 0 (GPU&#45;0)</text>
<text text-anchor="middle" x="1362" y="-1781.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1362" y="-1766.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_1&#45;&gt;expert_1_0 -->
<g id="edge7" class="edge">
<title>gate_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1931.84,-1858.38C1812.77,-1843.24 1687.17,-1827.27 1584.28,-1814.19"/>
<polygon fill="black" stroke="black" points="1584.44,-1810.68 1574.08,-1812.89 1583.56,-1817.63 1584.44,-1810.68"/>
</g>
<!-- expert_1_1 -->
<g id="node9" class="node">
<title>expert_1_1</title>
<ellipse fill="lightgreen" stroke="black" cx="2015" cy="-1784.93" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="2015" y="-1796.23" font-family="Times,serif" font-size="14.00">Expert 1 (GPU&#45;0)</text>
<text text-anchor="middle" x="2015" y="-1781.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2015" y="-1766.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_1&#45;&gt;expert_1_1 -->
<g id="edge9" class="edge">
<title>gate_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2204.64,-1858.34C2175.01,-1847.03 2144.17,-1835.25 2116.19,-1824.57"/>
<polygon fill="black" stroke="black" points="2117.41,-1821.29 2106.82,-1820.99 2114.91,-1827.83 2117.41,-1821.29"/>
</g>
<!-- expert_1_2 -->
<g id="node10" class="node">
<title>expert_1_2</title>
<ellipse fill="lightgreen" stroke="black" cx="2668" cy="-1784.93" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="2668" y="-1796.23" font-family="Times,serif" font-size="14.00">Expert 2 (GPU&#45;0)</text>
<text text-anchor="middle" x="2668" y="-1781.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2668" y="-1766.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_1&#45;&gt;expert_1_2 -->
<g id="edge11" class="edge">
<title>gate_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2477.78,-1858.34C2507.5,-1847.03 2538.43,-1835.25 2566.5,-1824.57"/>
<polygon fill="black" stroke="black" points="2567.8,-1827.82 2575.9,-1820.99 2565.31,-1821.28 2567.8,-1827.82"/>
</g>
<!-- expert_1_3 -->
<g id="node11" class="node">
<title>expert_1_3</title>
<ellipse fill="lightgreen" stroke="black" cx="3321" cy="-1784.93" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="3321" y="-1796.23" font-family="Times,serif" font-size="14.00">Expert 3 (GPU&#45;0)</text>
<text text-anchor="middle" x="3321" y="-1781.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3321" y="-1766.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_1&#45;&gt;expert_1_3 -->
<g id="edge13" class="edge">
<title>gate_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2634.7,-1873.1C2783.5,-1854.2 2961.23,-1831.63 3098.54,-1814.19"/>
<polygon fill="black" stroke="black" points="3099.29,-1817.62 3108.77,-1812.89 3098.41,-1810.67 3099.29,-1817.62"/>
</g>
<!-- expert_agg_1 -->
<g id="node12" class="node">
<title>expert_agg_1</title>
<polygon fill="orange" stroke="black" points="2806.5,-1711.45 2065.99,-1711.45 1875.5,-1605.45 2616.01,-1605.45 2806.5,-1711.45"/>
<text text-anchor="middle" x="2341" y="-1669.75" font-family="Times,serif" font-size="14.00">Expert Aggregation (GPU&#45;0)</text>
<text text-anchor="middle" x="2341" y="-1654.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2341" y="-1639.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- expert_1_0&#45;&gt;expert_agg_1 -->
<g id="edge8" class="edge">
<title>expert_1_0&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1573.83,-1757C1707.24,-1740.03 1881.78,-1717.84 2030.67,-1698.91"/>
<polygon fill="black" stroke="black" points="2031.41,-1702.34 2040.89,-1697.61 2030.53,-1695.4 2031.41,-1702.34"/>
</g>
<!-- expert_1_1&#45;&gt;expert_agg_1 -->
<g id="edge10" class="edge">
<title>expert_1_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2106.68,-1748.92C2134.12,-1738.45 2164.93,-1726.68 2194.95,-1715.22"/>
<polygon fill="black" stroke="black" points="2196.58,-1718.34 2204.67,-1711.51 2194.08,-1711.8 2196.58,-1718.34"/>
</g>
<!-- expert_1_2&#45;&gt;expert_agg_1 -->
<g id="edge12" class="edge">
<title>expert_1_2&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2576.04,-1748.92C2548.39,-1738.4 2517.35,-1726.58 2487.1,-1715.07"/>
<polygon fill="black" stroke="black" points="2488.34,-1711.79 2477.75,-1711.51 2485.85,-1718.34 2488.34,-1711.79"/>
</g>
<!-- expert_1_3&#45;&gt;expert_agg_1 -->
<g id="edge14" class="edge">
<title>expert_1_3&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M3108.96,-1757C3007,-1744.05 2881.05,-1728.05 2760.85,-1712.78"/>
<polygon fill="black" stroke="black" points="2761.09,-1709.28 2750.73,-1711.5 2760.21,-1716.23 2761.09,-1709.28"/>
</g>
<!-- comm_s1_s2 -->
<g id="node13" class="node">
<title>comm_s1_s2</title>
<ellipse fill="red" stroke="black" cx="2341" cy="-1510.37" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="2341" y="-1529.17" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="2341" y="-1514.17" font-family="Times,serif" font-size="14.00">GPU&#45;8 → GPU&#45;9</text>
<text text-anchor="middle" x="2341" y="-1499.17" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2341" y="-1484.17" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- expert_agg_1&#45;&gt;comm_s1_s2 -->
<g id="edge15" class="edge">
<title>expert_agg_1&#45;&gt;comm_s1_s2</title>
<path fill="none" stroke="black" d="M2341,-1605.13C2341,-1593.35 2341,-1580.79 2341,-1568.81"/>
<polygon fill="black" stroke="black" points="2344.5,-1568.48 2341,-1558.48 2337.5,-1568.48 2344.5,-1568.48"/>
</g>
<!-- norm2_1 -->
<g id="node14" class="node">
<title>norm2_1</title>
<polygon fill="lightblue" stroke="black" points="2565.5,-1426.29 2116.5,-1426.29 2116.5,-1373.29 2565.5,-1373.29 2565.5,-1426.29"/>
<text text-anchor="middle" x="2341" y="-1411.09" font-family="Times,serif" font-size="14.00">LayerNorm (GPU&#45;9)</text>
<text text-anchor="middle" x="2341" y="-1396.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2341" y="-1381.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- comm_s1_s2&#45;&gt;norm2_1 -->
<g id="edge16" class="edge">
<title>comm_s1_s2&#45;&gt;norm2_1</title>
<path fill="none" stroke="black" d="M2341,-1462.06C2341,-1453.56 2341,-1444.82 2341,-1436.7"/>
<polygon fill="black" stroke="black" points="2344.5,-1436.47 2341,-1426.47 2337.5,-1436.47 2344.5,-1436.47"/>
</g>
<!-- attn_qkv_2 -->
<g id="node15" class="node">
<title>attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="2568,-1337.29 2114,-1337.29 2114,-1284.29 2568,-1284.29 2568,-1337.29"/>
<text text-anchor="middle" x="2341" y="-1322.09" font-family="Times,serif" font-size="14.00">QKV Projection (GPU&#45;9)</text>
<text text-anchor="middle" x="2341" y="-1307.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2341" y="-1292.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=32]</text>
</g>
<!-- norm2_1&#45;&gt;attn_qkv_2 -->
<g id="edge17" class="edge">
<title>norm2_1&#45;&gt;attn_qkv_2</title>
<path fill="none" stroke="black" d="M2341,-1373.15C2341,-1365.17 2341,-1356.22 2341,-1347.67"/>
<polygon fill="black" stroke="black" points="2344.5,-1347.54 2341,-1337.54 2337.5,-1347.54 2344.5,-1347.54"/>
</g>
<!-- gate_2 -->
<g id="node16" class="node">
<title>gate_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2794.12,-1248.29 2073.31,-1248.29 1887.88,-1142.29 2608.69,-1142.29 2794.12,-1248.29"/>
<text text-anchor="middle" x="2341" y="-1206.59" font-family="Times,serif" font-size="14.00">Expert Gate (GPU&#45;9)</text>
<text text-anchor="middle" x="2341" y="-1191.59" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2341" y="-1176.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, experts=128]</text>
</g>
<!-- attn_qkv_2&#45;&gt;gate_2 -->
<g id="edge18" class="edge">
<title>attn_qkv_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M2341,-1284.03C2341,-1276.33 2341,-1267.54 2341,-1258.55"/>
<polygon fill="black" stroke="black" points="2344.5,-1258.38 2341,-1248.38 2337.5,-1258.38 2344.5,-1258.38"/>
</g>
<!-- expert_2_0 -->
<g id="node17" class="node">
<title>expert_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1865.5,-1106.29 1416.5,-1106.29 1416.5,-1053.29 1865.5,-1053.29 1865.5,-1106.29"/>
<text text-anchor="middle" x="1641" y="-1091.09" font-family="Times,serif" font-size="14.00">Expert 0 (GPU&#45;9)</text>
<text text-anchor="middle" x="1641" y="-1076.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1641" y="-1061.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_2&#45;&gt;expert_2_0 -->
<g id="edge19" class="edge">
<title>gate_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2020.19,-1142.27C1947.13,-1130.42 1872.35,-1118.3 1808.72,-1107.98"/>
<polygon fill="black" stroke="black" points="1809.04,-1104.49 1798.61,-1106.34 1807.92,-1111.4 1809.04,-1104.49"/>
</g>
<!-- expert_2_1 -->
<g id="node18" class="node">
<title>expert_2_1</title>
<polygon fill="lightgreen" stroke="black" points="2332.5,-1106.29 1883.5,-1106.29 1883.5,-1053.29 2332.5,-1053.29 2332.5,-1106.29"/>
<text text-anchor="middle" x="2108" y="-1091.09" font-family="Times,serif" font-size="14.00">Expert 1 (GPU&#45;9)</text>
<text text-anchor="middle" x="2108" y="-1076.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2108" y="-1061.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_2&#45;&gt;expert_2_1 -->
<g id="edge20" class="edge">
<title>gate_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2234.05,-1142.19C2211.95,-1131.42 2189.38,-1120.43 2169.57,-1110.78"/>
<polygon fill="black" stroke="black" points="2170.9,-1107.53 2160.38,-1106.3 2167.83,-1113.83 2170.9,-1107.53"/>
</g>
<!-- expert_2_2 -->
<g id="node19" class="node">
<title>expert_2_2</title>
<polygon fill="lightgreen" stroke="black" points="2799.5,-1106.29 2350.5,-1106.29 2350.5,-1053.29 2799.5,-1053.29 2799.5,-1106.29"/>
<text text-anchor="middle" x="2575" y="-1091.09" font-family="Times,serif" font-size="14.00">Expert 2 (GPU&#45;9)</text>
<text text-anchor="middle" x="2575" y="-1076.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2575" y="-1061.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_2&#45;&gt;expert_2_2 -->
<g id="edge21" class="edge">
<title>gate_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2448.41,-1142.19C2470.61,-1131.42 2493.27,-1120.43 2513.17,-1110.78"/>
<polygon fill="black" stroke="black" points="2514.93,-1113.81 2522.4,-1106.3 2511.87,-1107.52 2514.93,-1113.81"/>
</g>
<!-- expert_2_3 -->
<g id="node20" class="node">
<title>expert_2_3</title>
<polygon fill="lightgreen" stroke="black" points="3266.5,-1106.29 2817.5,-1106.29 2817.5,-1053.29 3266.5,-1053.29 3266.5,-1106.29"/>
<text text-anchor="middle" x="3042" y="-1091.09" font-family="Times,serif" font-size="14.00">Expert 3 (GPU&#45;9)</text>
<text text-anchor="middle" x="3042" y="-1076.09" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3042" y="-1061.09" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_2&#45;&gt;expert_2_3 -->
<g id="edge22" class="edge">
<title>gate_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2620.57,-1149.02C2706.39,-1135.13 2798.13,-1120.27 2874.03,-1107.98"/>
<polygon fill="black" stroke="black" points="2874.85,-1111.4 2884.16,-1106.34 2873.73,-1104.49 2874.85,-1111.4"/>
</g>
<!-- comm_s2_s3 -->
<g id="node21" class="node">
<title>comm_s2_s3</title>
<ellipse fill="red" stroke="black" cx="1641" cy="-958.2" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="1641" y="-977" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="1641" y="-962" font-family="Times,serif" font-size="14.00">GPU&#45;17 → GPU&#45;18</text>
<text text-anchor="middle" x="1641" y="-947" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1641" y="-932" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- expert_2_0&#45;&gt;comm_s2_s3 -->
<g id="edge23" class="edge">
<title>expert_2_0&#45;&gt;comm_s2_s3</title>
<path fill="none" stroke="black" d="M1641,-1053.13C1641,-1042.41 1641,-1029.49 1641,-1016.7"/>
<polygon fill="black" stroke="black" points="1644.5,-1016.52 1641,-1006.52 1637.5,-1016.52 1644.5,-1016.52"/>
</g>
<!-- norm3_1 -->
<g id="node22" class="node">
<title>norm3_1</title>
<polygon fill="lightblue" stroke="black" points="1865.5,-874.12 1416.5,-874.12 1416.5,-821.12 1865.5,-821.12 1865.5,-874.12"/>
<text text-anchor="middle" x="1641" y="-858.92" font-family="Times,serif" font-size="14.00">LayerNorm (GPU&#45;18)</text>
<text text-anchor="middle" x="1641" y="-843.92" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1641" y="-828.92" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- comm_s2_s3&#45;&gt;norm3_1 -->
<g id="edge24" class="edge">
<title>comm_s2_s3&#45;&gt;norm3_1</title>
<path fill="none" stroke="black" d="M1641,-909.89C1641,-901.39 1641,-892.65 1641,-884.54"/>
<polygon fill="black" stroke="black" points="1644.5,-884.3 1641,-874.3 1637.5,-884.3 1644.5,-884.3"/>
</g>
<!-- gate_3 -->
<g id="node23" class="node">
<title>gate_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2094.12,-785.12 1373.31,-785.12 1187.88,-679.12 1908.69,-679.12 2094.12,-785.12"/>
<text text-anchor="middle" x="1641" y="-743.42" font-family="Times,serif" font-size="14.00">Expert Gate (GPU&#45;18)</text>
<text text-anchor="middle" x="1641" y="-728.42" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1641" y="-713.42" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, experts=128]</text>
</g>
<!-- norm3_1&#45;&gt;gate_3 -->
<g id="edge25" class="edge">
<title>norm3_1&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M1641,-820.86C1641,-813.17 1641,-804.37 1641,-795.39"/>
<polygon fill="black" stroke="black" points="1644.5,-795.22 1641,-785.22 1637.5,-795.22 1644.5,-795.22"/>
</g>
<!-- expert_3_0 -->
<g id="node24" class="node">
<title>expert_3_0</title>
<polygon fill="lightgreen" stroke="black" points="1165.5,-643.12 716.5,-643.12 716.5,-590.12 1165.5,-590.12 1165.5,-643.12"/>
<text text-anchor="middle" x="941" y="-627.92" font-family="Times,serif" font-size="14.00">Expert 0 (GPU&#45;18)</text>
<text text-anchor="middle" x="941" y="-612.92" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="941" y="-597.92" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_3&#45;&gt;expert_3_0 -->
<g id="edge26" class="edge">
<title>gate_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1320.19,-679.1C1247.13,-667.26 1172.35,-655.13 1108.72,-644.81"/>
<polygon fill="black" stroke="black" points="1109.04,-641.32 1098.61,-643.17 1107.92,-648.23 1109.04,-641.32"/>
</g>
<!-- expert_3_1 -->
<g id="node25" class="node">
<title>expert_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1632.5,-643.12 1183.5,-643.12 1183.5,-590.12 1632.5,-590.12 1632.5,-643.12"/>
<text text-anchor="middle" x="1408" y="-627.92" font-family="Times,serif" font-size="14.00">Expert 1 (GPU&#45;18)</text>
<text text-anchor="middle" x="1408" y="-612.92" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1408" y="-597.92" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_3&#45;&gt;expert_3_1 -->
<g id="edge27" class="edge">
<title>gate_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1534.05,-679.02C1511.95,-668.25 1489.38,-657.26 1469.57,-647.61"/>
<polygon fill="black" stroke="black" points="1470.9,-644.37 1460.38,-643.13 1467.83,-650.66 1470.9,-644.37"/>
</g>
<!-- expert_3_2 -->
<g id="node26" class="node">
<title>expert_3_2</title>
<polygon fill="lightgreen" stroke="black" points="2099.5,-643.12 1650.5,-643.12 1650.5,-590.12 2099.5,-590.12 2099.5,-643.12"/>
<text text-anchor="middle" x="1875" y="-627.92" font-family="Times,serif" font-size="14.00">Expert 2 (GPU&#45;18)</text>
<text text-anchor="middle" x="1875" y="-612.92" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1875" y="-597.92" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_3&#45;&gt;expert_3_2 -->
<g id="edge28" class="edge">
<title>gate_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1748.41,-679.02C1770.61,-668.25 1793.27,-657.26 1813.17,-647.61"/>
<polygon fill="black" stroke="black" points="1814.93,-650.65 1822.4,-643.13 1811.87,-644.35 1814.93,-650.65"/>
</g>
<!-- expert_3_3 -->
<g id="node27" class="node">
<title>expert_3_3</title>
<polygon fill="lightgreen" stroke="black" points="2566.5,-643.12 2117.5,-643.12 2117.5,-590.12 2566.5,-590.12 2566.5,-643.12"/>
<text text-anchor="middle" x="2342" y="-627.92" font-family="Times,serif" font-size="14.00">Expert 3 (GPU&#45;18)</text>
<text text-anchor="middle" x="2342" y="-612.92" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2342" y="-597.92" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_3&#45;&gt;expert_3_3 -->
<g id="edge29" class="edge">
<title>gate_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1920.57,-685.85C2006.39,-671.96 2098.13,-657.11 2174.03,-644.82"/>
<polygon fill="black" stroke="black" points="2174.85,-648.23 2184.16,-643.18 2173.73,-641.32 2174.85,-648.23"/>
</g>
<!-- comm_s3_s4 -->
<g id="node28" class="node">
<title>comm_s3_s4</title>
<ellipse fill="red" stroke="black" cx="941" cy="-495.04" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="941" y="-513.84" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="941" y="-498.84" font-family="Times,serif" font-size="14.00">GPU&#45;26 → GPU&#45;27</text>
<text text-anchor="middle" x="941" y="-483.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="941" y="-468.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- expert_3_0&#45;&gt;comm_s3_s4 -->
<g id="edge30" class="edge">
<title>expert_3_0&#45;&gt;comm_s3_s4</title>
<path fill="none" stroke="black" d="M941,-589.97C941,-579.24 941,-566.32 941,-553.53"/>
<polygon fill="black" stroke="black" points="944.5,-553.36 941,-543.36 937.5,-553.36 944.5,-553.36"/>
</g>
<!-- norm4_1 -->
<g id="node29" class="node">
<title>norm4_1</title>
<polygon fill="lightblue" stroke="black" points="1165.5,-410.95 716.5,-410.95 716.5,-357.95 1165.5,-357.95 1165.5,-410.95"/>
<text text-anchor="middle" x="941" y="-395.75" font-family="Times,serif" font-size="14.00">LayerNorm (GPU&#45;27)</text>
<text text-anchor="middle" x="941" y="-380.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="941" y="-365.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- comm_s3_s4&#45;&gt;norm4_1 -->
<g id="edge31" class="edge">
<title>comm_s3_s4&#45;&gt;norm4_1</title>
<path fill="none" stroke="black" d="M941,-446.73C941,-438.22 941,-429.49 941,-421.37"/>
<polygon fill="black" stroke="black" points="944.5,-421.13 941,-411.13 937.5,-421.13 944.5,-421.13"/>
</g>
<!-- gate_4 -->
<g id="node30" class="node">
<title>gate_4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1394.12,-321.95 673.31,-321.95 487.88,-215.95 1208.69,-215.95 1394.12,-321.95"/>
<text text-anchor="middle" x="941" y="-280.25" font-family="Times,serif" font-size="14.00">Expert Gate (GPU&#45;27)</text>
<text text-anchor="middle" x="941" y="-265.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="941" y="-250.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, experts=128]</text>
</g>
<!-- norm4_1&#45;&gt;gate_4 -->
<g id="edge32" class="edge">
<title>norm4_1&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M941,-357.7C941,-350 941,-341.2 941,-332.22"/>
<polygon fill="black" stroke="black" points="944.5,-332.05 941,-322.05 937.5,-332.05 944.5,-332.05"/>
</g>
<!-- expert_4_0 -->
<g id="node31" class="node">
<title>expert_4_0</title>
<polygon fill="lightgreen" stroke="black" points="465.5,-179.95 16.5,-179.95 16.5,-126.95 465.5,-126.95 465.5,-179.95"/>
<text text-anchor="middle" x="241" y="-164.75" font-family="Times,serif" font-size="14.00">Expert 0 (GPU&#45;27)</text>
<text text-anchor="middle" x="241" y="-149.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="241" y="-134.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_4&#45;&gt;expert_4_0 -->
<g id="edge33" class="edge">
<title>gate_4&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M620.19,-215.94C547.13,-204.09 472.35,-191.96 408.72,-181.65"/>
<polygon fill="black" stroke="black" points="409.04,-178.15 398.61,-180.01 407.92,-185.06 409.04,-178.15"/>
</g>
<!-- expert_4_1 -->
<g id="node32" class="node">
<title>expert_4_1</title>
<polygon fill="lightgreen" stroke="black" points="932.5,-179.95 483.5,-179.95 483.5,-126.95 932.5,-126.95 932.5,-179.95"/>
<text text-anchor="middle" x="708" y="-164.75" font-family="Times,serif" font-size="14.00">Expert 1 (GPU&#45;27)</text>
<text text-anchor="middle" x="708" y="-149.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="708" y="-134.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_4&#45;&gt;expert_4_1 -->
<g id="edge34" class="edge">
<title>gate_4&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M834.05,-215.85C811.95,-205.09 789.38,-194.1 769.57,-184.45"/>
<polygon fill="black" stroke="black" points="770.9,-181.2 760.38,-179.97 767.83,-187.49 770.9,-181.2"/>
</g>
<!-- expert_4_2 -->
<g id="node33" class="node">
<title>expert_4_2</title>
<polygon fill="lightgreen" stroke="black" points="1399.5,-179.95 950.5,-179.95 950.5,-126.95 1399.5,-126.95 1399.5,-179.95"/>
<text text-anchor="middle" x="1175" y="-164.75" font-family="Times,serif" font-size="14.00">Expert 2 (GPU&#45;27)</text>
<text text-anchor="middle" x="1175" y="-149.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1175" y="-134.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_4&#45;&gt;expert_4_2 -->
<g id="edge35" class="edge">
<title>gate_4&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1048.41,-215.85C1070.61,-205.09 1093.27,-194.1 1113.17,-184.45"/>
<polygon fill="black" stroke="black" points="1114.93,-187.48 1122.4,-179.97 1111.87,-181.18 1114.93,-187.48"/>
</g>
<!-- expert_4_3 -->
<g id="node34" class="node">
<title>expert_4_3</title>
<polygon fill="lightgreen" stroke="black" points="1866.5,-179.95 1417.5,-179.95 1417.5,-126.95 1866.5,-126.95 1866.5,-179.95"/>
<text text-anchor="middle" x="1642" y="-164.75" font-family="Times,serif" font-size="14.00">Expert 3 (GPU&#45;27)</text>
<text text-anchor="middle" x="1642" y="-149.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1642" y="-134.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_4&#45;&gt;expert_4_3 -->
<g id="edge36" class="edge">
<title>gate_4&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1220.57,-222.69C1306.39,-208.79 1398.13,-193.94 1474.03,-181.65"/>
<polygon fill="black" stroke="black" points="1474.85,-185.06 1484.16,-180.01 1473.73,-178.15 1474.85,-185.06"/>
</g>
<!-- output -->
<g id="node35" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="333" cy="-53.48" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="333" y="-64.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="333" y="-49.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="333" y="-34.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- expert_4_0&#45;&gt;output -->
<g id="edge37" class="edge">
<title>expert_4_0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M265.17,-126.71C273.32,-118.04 282.65,-108.1 291.74,-98.42"/>
<polygon fill="black" stroke="black" points="294.32,-100.78 298.61,-91.1 289.22,-95.99 294.32,-100.78"/>
</g>
</g>
</svg>
